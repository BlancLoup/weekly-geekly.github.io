<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Configure Eclipse PyDev for debugging Python 3.x with honest Unicode and Cyrillic</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One day, on a cold winter evening, I suddenly remembered that I had not shared a simple secret how to achieve simple Python happiness beyond the limit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Configure Eclipse PyDev for debugging Python 3.x with honest Unicode and Cyrillic</h1><div class="post__text post__text-html js-mediator-article">  One day, on a cold winter evening, I suddenly remembered that I had not shared a simple secret how to achieve simple Python happiness beyond the limits of an ASCII reservation in such a wonderful-free IDE like Eclipse with the PyDev plugin.  And happiness with debugging and honest Unicode, which means the following: if you call your variable Cyrillic, you can see its value by setting a breakpoint, write a couple of lines of text in Russian and nothing will fall off. <br>  Yes, dear reader, Eclipse PyDev is not very friendly with characters outside of 0x7F and debugging likes to fall off every time you try to read the value of a Cyrillic variable.  Yes, what's there, just pointing the mouse at a Unicode character leads to fatal consequences when debugging code written in Python 3.x (UTF-8).  If your file system settings are different from UTF-8, congratulations, you cannot even run your script.  I mean exactly what, for example under Windows, your wonderful script with a single word in Russian will simply disable PyDev. <br>  Maybe I overdid it, exaggerating, do not worry, we can fix it ourselves, just by reading this small instruction.  As a reward, we will receive a free development tool, quite convenient, fantastically flexible in settings and improvements, up to development in several languages, with the built-in versioning tool. <br>  Under the cut instructions and indecent size images. <br><a name="habracut"></a><br><h4>  We are preparing the spaceport </h4><br>  Our future universal spaceship called Eclipse is downloaded without Python development tools, for this there is an Eclipse PyDev extension, we will install it immediately after downloading.  <a href="http://www.eclipse.org/downloads/">From the download page,</a> select the version of Eclipse you like.  I would recommend ‚ÄúEclipse IDE for C / C ++ Developers‚Äù, after all, Python works very well with extensions in C / C ++, and the code itself is perfectly integrated into C ++ thanks to the Boost.Python library. <br>  When the download is complete, unzip the eclipse folder to any location on your computer that is consistent with your feng shui. <br>  Just run eclipse \ eclipse, most likely it will just start, but if you have never used the JDK before, it will request it for work, it will not start without it.  The JDK is the Java Development Kit, downloaded from the Oracle website, from <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">this download page</a> . <br>  When you start, Eclipse asks where to save all the projects to it, point it to your Workspace (remember this word, you need to look for it in the settings menu).  Finally, after booting, this Java child will show you your Welcome, don't be scared, just close it. <br>  Somehow this will look like this at the end of our excursion: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/02c/bec/713/02cbec713959f5f828e12b322bf80a82.png" alt="image"><br><br>  In the meantime, let's start with the most important, with the fact that the fuss is with encoding.  The most important thing is to make sure that your default workplace is set to UTF-8 encoding. <br>  Go to the menu <b>Window =&gt; Preferences</b> select there <b>General =&gt; Workspace</b> at the very bottom of the page you need to specify the " <b>Text file encoding</b> " parameter, if it is not set in UTF-8 by default, write this string value in the <b>Other</b> field, as shown in the picture: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/00f/a13/2fe/00fa132feb514ad7998f0b856222c680.png" alt="image"><br><br>  So we have everything to start developing the application.  Oh no, not everything, Python is still nothing to write and debug.  Need a PyDev plugin. <br><br><h4>  Getting ready for landing on Python-3 </h4><br>  Installing PyDev is probably the easiest part of the job of setting up a workplace. <br>  Go to the " <b>Help =&gt; Eclipse Marketplace ...</b> " menu and type <b>PyDev</b> in the search bar and click the [ <b>Install</b> ] button in the found plugin <br><br><img src="https://habrastorage.org/getpro/habr/post_images/65c/7fb/35c/65c7fb35c66c69a0f06518a235b05f7f.png" alt="image"><br><br>  After that, we agree with everything, we are waiting for the download and installation, then we will be offered to restart Eclipse, and why restart, they are asked. <br>  After installation, we are invited to play hide and seek with the installed environment - Perspective (Perspective) for development in Python, I will tell you where to find it, at the same time I will switch to the PyDev perspective.  In the upper right corner there is a row of small buttons for switching perspectives, usually there is something like C ++, Debug, Java, SVN and a little scarlet plus sign to the left of them, so you need to click on it to add PyDev perspective. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/792/344/f04/792344f048a15e57bfca2aa495a52b6a.png" alt="image"><br><br>  In the Open Perspective window that opens, select the Python development environment ‚Äî freshly installed PyDev. <br>  We have to switch to the PyDev perspective right after the selection. Some changes should occur in the menu and in the main window, which you may not notice right away, but they switch the creation of new projects and files and the debugging process to the Python development mode. <br>  Almost everything.  We are ready to set up and launch our first Python 3 project in Eclipse PyDev. <br><br><h4>  First project </h4><br>  Well, let's create it, our first project. <br>  Menu File =&gt; New =&gt; PyDev Project, fill in the name, choose the version of Python 3.x and now the most important thing: you need to specify where the Python interpreter is located, for this you need to click on the link "Please configure an interpreter ..." <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3a5/476/644/3a5476644a6b1eefbe43b9540d1bd2a0.png" alt="image"><br><br>  Everything, we can click Finish. <br><br><h4>  Our first script </h4><br>  It's time to try to run our script, and at the same time find out what this article is for. <br>  The ‚ÄúFile =&gt; New =&gt; PyDev module‚Äù menu, or simply right-click on the ‚ÄúNew =&gt; PyDev module‚Äù project, give our new script a name and click Finish. <br>  The script file will automatically be created in the encoding specified in the Workspace settings that we set at the very beginning.  In Python 3.x, all code is standard UTF-8 encoded. <br>  To check Unicode support, we write this script: <br><br><pre><code class="python hljs"> = <span class="hljs-string"><span class="hljs-string">"  !.."</span></span> print()</code> </pre> <br>  It's time to debug it! <br>  Zhmakayem on the green beetle (De-Bug) or simply F11.  Choose Python Run (this is clearly not a unit test).  Go‚Ä¶ <br>  ... We arrived! .. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/029/43e/045/02943e045d95a0183ff3d61460113d9a.png" alt="image"><br><br>  Hehe, but for free! <br>  We look into the file where we fell and see a banal jamb with the encoding in <b>_pydev_execfile.py</b> <br>  Open it by reference in the Eclipse console frame. <br>  The very first line in the file seems to hint that for Python 3.x here it‚Äôs not just a horse that was not lying, even the pony didn‚Äôt fit. <br>  This is what our wonderful file looks like: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#We must redefine it in Py3k if it's not already there def execfile(file, glob=None, loc=None): if glob is None: import sys glob = sys._getframe().f_back.f_globals if loc is None: loc = glob stream = open(file, 'rb') try: encoding = None #Get encoding! for _i in range(2): line = stream.readline() #Should not raise an exception even if there are no more contents #Must be a comment line if line.strip().startswith(b'#'): #Don't import re if there's no chance that there's an encoding in the line if b'coding' in line: import re p = re.search(br"coding[:=]\s*([-\w.]+)", line) if p: try: encoding = p.group(1).decode('ascii') break except: encoding = None finally: stream.close() if encoding: stream = open(file, encoding=encoding) else: stream = open(file) try: contents = stream.read() finally: stream.close() exec(compile(contents+"\n", file, 'exec'), glob, loc) #execute the script</span></span></code> </pre> <br><br>  With a critical eye, we look around the battlefield and find several jambs: <br>  1. For Python 3.x encoding, there will always be None, which is fatal in Windows where the file system settings are far from UTF-8, and indeed it is wrong to require the first line to specify the encoding from a file with Python code 3, which is always UTF-8. <br>  It is ruled by the banal check sys.version_info [0]&gt; = 3 <br>  2. For files starting with BOM, the first character is not truncated, and compile is very sensitive to everything extra, it simply does not understand the characters at the beginning of the script. <br>  Without going into subtleties, you can quickly fix everything for example like this: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execfile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(file, glob=None, loc=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> glob <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: glob = sys._getframe().f_back.f_globals <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> loc <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: loc = glob <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> sys.version_info[<span class="hljs-number"><span class="hljs-number">0</span></span>] &gt;= <span class="hljs-number"><span class="hljs-number">3</span></span>: encoding = <span class="hljs-string"><span class="hljs-string">'utf-8'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: stream = open(file, <span class="hljs-string"><span class="hljs-string">'rb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: encoding = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-comment"><span class="hljs-comment">#Get encoding! for _i in range(2): line = stream.readline() #Should not raise an exception even if there are no more contents #Must be a comment line if line.strip().startswith(b'#'): #Don't import re if there's no chance that there's an encoding in the line if b'coding' in line: import re p = re.search(br"coding[:=]\s*([-\w.]+)", line) if p: try: encoding = p.group(1).decode('ascii') break except: encoding = None finally: stream.close() if encoding: stream = open(file, encoding=encoding) else: stream = open(file) try: contents = stream.read() if sys.version_info[0] &gt;= 3 and contents.startswith('\uFEFF'): contents = contents[1:] #Remove BOM finally: stream.close() exec(compile(contents+"\n", file, 'exec'), glob, loc) #execute the script</span></span></code> </pre><br><br>  After this little fix, everything is just fine with us.  It remains to tell about debugging and a small parameter, without which our starship will not take off beyond the execution of the code. <br><br><h4>  Debug mode and Unicode </h4><br>  Put a breakpoint on the second line, we will look at the contents of the variable <b>word</b> - this is done by double clicking on the area to the left of the desired line of code. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/152/39f/7ba/15239f7ba24303e01413a1ee39aab71f.png" alt="image"><br><br>  We start the debugging mode on F11 or by clicking on the green bug in the toolbar.  We get up at breakpoint. <br>  (By the way, lyrical digression, when switching to a Debug perspective, take a couple of minutes, drag everything unnecessary down.) <br>  Now we try to do the following: hover the mouse over the variable <b>word</b> .  After all, you probably wonder what's inside? .. <br>  ... oh, they fell again! .. This time, completely mysteriously - the script's work was completed, but the process of debugging itself died in torment. <br>  But for free! .. <br>  Although everything is pretty simple here - go to eclipse.ini next to the executable module and add the line there: <br><br><pre> <code class="python hljs">-Dfile.encoding=UTF<span class="hljs-number"><span class="hljs-number">-8</span></span></code> </pre><br>  Save the yinch, restart Eclipse for the changes to take effect. <br>  Everything. <br>  You can now debug as much as you want! <br>  Call the variables even Cyrillic, even in Hindi, call in Russian classes and methods, whatever! <br>  I'm not saying that this is right, I just give you this opportunity, or rather, I‚Äôm returning what was taken away by the voracious free Eclipse PyDev. <br><br><h4>  useful links </h4><br>  I decided to give a link to the archive with the Eclipse PyDev configured for development in Python 3.x: <a href="http://www.megafileupload.com/en/file/388534/eclipse-7z.html">eclipse.7z (~ 171 MB)</a> <br>  After downloading, you will still have to do the following: <br>  1) - migrate the Workspace folder <br>  2) - configure in Window =&gt; Prefereces =&gt; General =&gt; Workspace encoding UTF-8 <br>  3) - open the PyDev perspective (initially hidden) through the Open Perspective <br>  4) - when creating the first project, specify the location of the Python interpreter <br><br><h4>  Conclusion </h4><br>  You probably ask me why I didn‚Äôt immediately, in the first paragraph, download a ready-made archive with patched Eclipse with PyDev. <br>  I will answer that I decided to share the experience of an uncomplicated, but very useful solution, giving an impressive PROFIT in development in Python 3.x. <br>  It costs you nothing to go through the steps and get a great development tool, and at the same time understand some subtleties in the work of Python 3 and the difference with the old and not always good Python 2.x. <br>  Remember: you have no reason to limit yourself to ASCII and generally limit yourself to anything. <br>  Good luck in your development! </div><p>Source: <a href="https://habr.com/ru/post/167559/">https://habr.com/ru/post/167559/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../167543/index.html">Non-entity page in SonataAdminBundle</a></li>
<li><a href="../167547/index.html">Nexus 4 reappeared on sale from $ 300</a></li>
<li><a href="../167549/index.html">In Russia, it is proposed to introduce blocking of information on the network at the request of the copyright holder</a></li>
<li><a href="../167551/index.html">IOS 6.1 Video Review</a></li>
<li><a href="../167557/index.html">Impressions of the Highscreen Alpha GT smartphone</a></li>
<li><a href="../167561/index.html">From Facebook HackerCup 2011 to Facebook Internship</a></li>
<li><a href="../167565/index.html">Sports and Android: life-saving applications</a></li>
<li><a href="../167571/index.html">Epic Citadel on Unreal Engine 3 showed what Android is capable of</a></li>
<li><a href="../167573/index.html">Listeners in Ext.NET</a></li>
<li><a href="../167575/index.html">GeForce Experience is available for download.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>