<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Non-standard clustering 4: Self-Organizing Maps, subtleties, improvements, comparison with t-SNE</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part One - Affinity Propagation 
 Part Two - DBSCAN 
 Part Three - Time Series Clustering 
 Part Four - Self-Organizing Maps (SOM) 
 Part Five - Growi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Non-standard clustering 4: Self-Organizing Maps, subtleties, improvements, comparison with t-SNE</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://habrahabr.ru/post/321216/">Part One - Affinity Propagation</a> <br>  <a href="https://habrahabr.ru/post/322034/">Part Two - DBSCAN</a> <br>  <a href="https://habrahabr.ru/post/334220/">Part Three - Time Series Clustering</a> <br>  Part Four - Self-Organizing Maps (SOM) <br>  <a href="https://habrahabr.ru/post/340360/">Part Five - Growing Neural Gas (GNG)</a> <br><br>  Self-organizing maps (SOM, Kohonen self-organizing maps) is a familiar classical construction.  They are often commemorated in machine-learning courses under the sauce, ‚Äúand yet neural networks can do this.‚Äù  SOM managed to survive the take-off in 1990-2000: then they were predicted a great future and created new and new modifications.  However, in the 21st century, SOM is gradually receding into the background.  Although new developments in the field of self-organizing maps are still underway (mostly in Finland, the birthplace of Kohonen), even in the native field of visualization and clustering of the Kohonen map data is increasingly inferior to t-SNE. <br><br>  Let's try to understand the intricacies of SOMs, and find out if they were deservedly forgotten. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/59/df/6e/59df6eb1d2995155764753.jpeg"></div><br><a name="habracut"></a><br><h3>  The basic ideas of the algorithm </h3><br>  In brief, let me remind you the standard learning algorithm SOM [1].  Hereinafter <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> X </script>  ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">d</span><span class="MJXp-mtext" id="MJXp-Span-5">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.717ex" height="2.057ex" viewBox="0 -780.1 4183.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-74" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-69" x="1135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-6D" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-65" x="2359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-73" x="2825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-4E" x="3295" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> d \ times N </script>  ) - matrix with input data, where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-12"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> N </script>  - the number of elements in the data set, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.216ex" height="2.057ex" viewBox="0 -780.1 523.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-64" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> d </script>  - the dimension of the data. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.435ex" height="2.057ex" viewBox="0 -780.1 1048.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-57" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> W </script>  - matrix of scales ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-18"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">d</span><span class="MJXp-mtext" id="MJXp-Span-20">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.095ex" height="2.057ex" viewBox="0 -780.1 4346.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-74" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-69" x="1135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-6D" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-65" x="2359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-73" x="2825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-4D" x="3295" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> d \ times M </script>  ) where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.057ex" viewBox="0 -780.1 1051.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-4D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> M </script>  - the number of neurons in the map. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mtext" id="MJXp-Span-30">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.734ex" height="1.937ex" viewBox="0 -728.2 1607.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-65" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-74" x="716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-61" x="1078" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> \ eta </script>  - learning speed <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-34"><span class="MJXp-mtext" id="MJXp-Span-35">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.86ex" height="2.298ex" viewBox="0 -728.2 2953.5 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-61" x="2424" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> \ sigma </script>  - coefficient of cooperation (see below), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.776ex" height="2.057ex" viewBox="0 -780.1 764.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-45" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> E </script>  - the number of epochs. <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.924ex" height="2.057ex" viewBox="0 -780.1 828.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-44" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> D </script>  ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">M</span><span class="MJXp-mtext" id="MJXp-Span-47">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.321ex" height="2.057ex" viewBox="0 -780.1 4874.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-74" x="1301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-69" x="1663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-6D" x="2008" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-65" x="2887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-73" x="3353" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/338868/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhmu-3EN9wetCUwkKiKP5UI1UFpPQ#MJMATHI-4D" x="3823" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> M \ times M </script>  ) - matrix of distances between neurons in the layer.  I draw your attention that the last matrix is ‚Äã‚Äãnot the same as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-54"><span class="MJXp-mtext" id="MJXp-Span-55">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">t</span><span class="MJXp-mtext" id="MJXp-Span-60">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-61"><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-63">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">c</span><span class="MJXp-mrow" id="MJXp-Span-67"><span class="MJXp-msubsup" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-70" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-72">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">c</span><span class="MJXp-mrow" id="MJXp-Span-76"><span class="MJXp-msubsup" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-79" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-80">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">t</span><span class="MJXp-mtext" id="MJXp-Span-86">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-87"><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> \ left \ | \ vec {w_i} - \ vec {w_j} \ right \ | </script>  .  <i>For neurons there are two distances</i> : the distance in the layer ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> D </script>  ) and the difference between the values. <br><br>  Also note that although neurons are often drawn for convenience as if they were ‚Äústrung‚Äù on a square grid, this does not mean that they are stored as a tensor. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mtext" id="MJXp-Span-92">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">t</span><span class="MJXp-mrow" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">M</span></span><span class="MJXp-mtext" id="MJXp-Span-99">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">s</span><span class="MJXp-mtext" id="MJXp-Span-105">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">t</span><span class="MJXp-mrow" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">M</span></span><span class="MJXp-mtext" id="MJXp-Span-112">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> \ sqrt {M} \ times \ sqrt {M} \ times d </script>  .  Mesh personifies <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> D </script>  . <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/cf/83/59cf837e73c2f996868662.png"></div><br>  We introduce immediately <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-121"><span class="MJXp-mtext" id="MJXp-Span-122">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> \ gamma </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-mtext" id="MJXp-Span-129">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> \ alpha </script>  - indicators of the attenuation of the learning rate and the attenuation of cooperation, respectively.  Although strictly speaking they are not mandatory, without them it is almost impossible to come together to a decent result. <br><br>  Algorithm 1 (standard SOM learning algorithm): <br>  Entrance: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> X </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-137"><span class="MJXp-mtext" id="MJXp-Span-138">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> \ eta </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-142"><span class="MJXp-mtext" id="MJXp-Span-143">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> \ sigma </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-149"><span class="MJXp-mtext" id="MJXp-Span-150">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> \ gamma </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-mtext" id="MJXp-Span-157">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ alpha </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> E </script><br><ol><li>  Initialize <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> W </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> E </script>  time: <br><br><ol><li>  Shuffle index list randomly order: = shuffle ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-169"><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-171">0</span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-173">1</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-175">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">s</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">N</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-183">2</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">N</span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-187">1</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> [0, 1, \ dots, N-2, N-1] </script>  ) </li><li>  For each <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> idx </script>  from order: <br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-193"><span class="MJXp-mtext" id="MJXp-Span-194">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">c</span><span class="MJXp-mrow" id="MJXp-Span-198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">x</span></span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">X</span><span class="MJXp-mo" id="MJXp-Span-202" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">x</span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ vec {x}: = X [idx] </script>  // Take a random vector from X </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">i</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mtext" id="MJXp-Span-210">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">g</span><span class="MJXp-mtext" id="MJXp-Span-214">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">i</span><span class="MJXp-msubsup" id="MJXp-Span-217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-219" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-220"><span class="MJXp-mtext" id="MJXp-Span-221">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">t</span><span class="MJXp-mtext" id="MJXp-Span-226">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-227"><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-229">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">c</span><span class="MJXp-mrow" id="MJXp-Span-233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">x</span></span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-236">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">c</span><span class="MJXp-mrow" id="MJXp-Span-240"><span class="MJXp-msubsup" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-243" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-244">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">t</span><span class="MJXp-mtext" id="MJXp-Span-250">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-251"><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> i: = \ arg \ min_j {\ left \ | \ vec {x} - \ vec {w_j} \ right \ |} </script>  // Find the number of the neuron nearest to it </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-253"><span class="MJXp-mtext" id="MJXp-Span-254">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">j</span><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-265" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-msubsup" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-271" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-274" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-277"><span class="MJXp-mo" id="MJXp-Span-278">/</span></span><span class="MJXp-mtext" id="MJXp-Span-279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">m</span><span class="MJXp-msubsup" id="MJXp-Span-284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-286" style="vertical-align: 0.5em;">2</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> \ forall j: h_ {ij}: = e ^ {D_ {ij} / \ sigma ^ 2} </script>  // Find the coefficient of proximity of neurons on the grid.  Notice that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-287"><span class="MJXp-msubsup" id="MJXp-Span-288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-290" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> h_ {ii} </script>  always 1 </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-293"><span class="MJXp-mtext" id="MJXp-Span-294">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">j</span><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-303">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">c</span><span class="MJXp-mrow" id="MJXp-Span-307"><span class="MJXp-msubsup" id="MJXp-Span-308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-310" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mtext" id="MJXp-Span-312">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">c</span><span class="MJXp-mrow" id="MJXp-Span-316"><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-319" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-321">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">a</span><span class="MJXp-msubsup" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-327" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-331">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">c</span><span class="MJXp-mrow" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">x</span></span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-338">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">c</span><span class="MJXp-mrow" id="MJXp-Span-342"><span class="MJXp-msubsup" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-345" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> \ forall j: \ vec {w_j}: = \ vec {w_j} + \ eta h_ {ij} (\ vec {x} - \ vec {w_j}) </script></li></ol></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mtext" id="MJXp-Span-348">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> \ eta </script>  : = <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-352"><span class="MJXp-mtext" id="MJXp-Span-353">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> \ gamma </script><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-359"><span class="MJXp-mtext" id="MJXp-Span-360">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> \ eta </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-364"><span class="MJXp-mtext" id="MJXp-Span-365">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> \ sigma </script>  : = <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-371"><span class="MJXp-mtext" id="MJXp-Span-372">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> \ alpha </script><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-378"><span class="MJXp-mtext" id="MJXp-Span-379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> \ sigma </script></li></ol></li></ol><br>  Each era of learning, we iterate over the elements of the input dataset.  For each item we find the one closest to it. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> x </script>  neuron, then we update its weight and the weight of all its neighbors according to the layer depending on the distance to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> x </script>  and the coefficient of cooperation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-389"><span class="MJXp-mtext" id="MJXp-Span-390">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> \ sigma </script>  .  The more <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-396"><span class="MJXp-mtext" id="MJXp-Span-397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> \ sigma </script>  , the more neurons effectively update the weights at each step.  The picture below is a graphic interpretation of steps A1.2.2.1-A1.2.2.4 for the case when <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-403"><span class="MJXp-mtext" id="MJXp-Span-404">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> \ sigma </script>  large (1) and when small (2) with the same learning speed and the nearest vector. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/cf/93/59cf933004413743672660.png"></div><br>  In the first case <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-410"><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-413" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> h_ {ij} </script>  close to one and to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-416"><span class="MJXp-mtext" id="MJXp-Span-417">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">c</span><span class="MJXp-mrow" id="MJXp-Span-421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> \ vec {x} </script>  not only the nearest vector moves, but also its first neighbor and even, slightly less, the second neighbor.  In the second case, the same neighbors move quite a bit.  Note that in both cases the fourth vector with the same <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mtext" id="MJXp-Span-424">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">t</span><span class="MJXp-mtext" id="MJXp-Span-429">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-430"><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-432">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">c</span><span class="MJXp-mrow" id="MJXp-Span-436"><span class="MJXp-msubsup" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-439" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">c</span><span class="MJXp-mrow" id="MJXp-Span-445"><span class="MJXp-msubsup" id="MJXp-Span-446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-448" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-449">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">t</span><span class="MJXp-mtext" id="MJXp-Span-455">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-456"><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ left \ | \ vec {w_i} - \ vec {w_j} \ right \ | </script>  from the nearest vector, but with a much larger <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-458"><span class="MJXp-msubsup" id="MJXp-Span-459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-461" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> D_ {ij} </script>  does not move. <br><br>  Several epochs of learning Kohonen maps for clarity: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/cf/cd/59cfcd3383eb2112984603.png"></div><br>  If my brief reminder algorithm was not enough, read <a href="https://habrahabr.ru/post/334810/">this</a> article, where the steps in A1 are discussed in more detail. <br><br>  Thus, the main ideas of SOM: <br><br><ul><li>  Forcing the introduction of some order between neurons. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> D </script>  gently transferred to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> W </script>  into the data space. </li><li>  Winner Takes All (WTA) Strategy.  At each step of the training, we determine the closest ‚Äúwinning‚Äù neuron and, based on this knowledge, weights are updated. </li><li>  Cooperation turns into egoism <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-468"><span class="MJXp-mtext" id="MJXp-Span-469">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">w</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> \ rightarrow </script>  global approximate adjustment develops into an exact local.  Until <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-480"><span class="MJXp-mtext" id="MJXp-Span-481">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> \ sigma </script>  big, the noticeable part is updated <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> W </script>  and the WTA strategy is not so visible when <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-489"><span class="MJXp-mtext" id="MJXp-Span-490">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> \ sigma </script>  tends to zero <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">w</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> w </script>  updated one by one. </li></ul><br>  Immediately suggests several trivial modifications: <br><br><ul><li>  It is not necessary to use a Gaussian to calculate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-498"><span class="MJXp-msubsup" id="MJXp-Span-499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-501" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> h_ {ij} </script>  in step A1.2.2.3.  The first candidate for alternatives is the Cauchy distribution.  As you know, it has heavier tails: more neurons will change at the stage of cooperation. </li><li>  Damping <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mtext" id="MJXp-Span-505">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ eta </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-509"><span class="MJXp-mtext" id="MJXp-Span-510">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> \ sigma </script>  do not have to be exponential.  The attenuation curve in the form of a sigmoid or a Gaussian branch can give the algorithm more time for a coarse adjustment. </li><li>  It is not necessary to spin in a loop exactly <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> E </script>  time.  You can stop the iteration if the values ‚Äã‚Äãof W will not change over several epochs. </li><li>  Training resembles the usual SGD.  "Reminds", because there is no energy function that this process would optimize [2].  Strict math spoils us step A1.2.2.1 - taking the nearest vector.  There are modifications SOM, where the energy is still there, but we already go into the details.  The point is that it does not interfere with using at step A1.2.2.4 instead of the usual updates of the weights, say, Nesterov's momentum (Nesterov momentum). </li><li>  Adding small random perturbations to the gradient, although of less benefit than in the case of ordinary multilayer neural networks, still looks like a useful technique for avoiding saddle points [3]. </li><li>  Self-organizing maps support learning by subsamples (batches) [1].  Their use allows you to train faster and smoother skip bad configurations. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> W </script></li><li>  Do not forget about the normalization of input values ‚Äã‚Äãand the use of the weights vector of input variables, if you know that some features are more important than others. </li></ul><br><h3>  Neuron topology </h3><br>  A slightly less obvious modification of self-organizing cards, in which their strength and uniqueness consist, but which is constantly forgotten, lies in the initialization stage <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61"> W </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> D </script>  .  In the examples, the Kohonen layer is constantly depicted as a grid, but this is by no means necessary.  On the contrary, it is strongly advised to adjust the relative position of the neurons ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> D </script>  ) in the data layer. <br><br>  At a minimum, instead of a regular grid, it is better to use a hexagonal one: a square grid distorts the results in favor of straight lines, and it is less pleasant to look at than a hexagonal one.  If it is assumed that the data is cyclic, it is worth initializing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> D </script>  as if neurons are on a tape or even on a torus (see figure below, number 1).  If you are trying to fit three-dimensional data in the SOM that does not necessarily fall on the hyperfolding, you should use the ‚Äúfleecy carpet‚Äù structure (2).  If it is known that some clusters can defend far from others, try the ‚Äúpetal‚Äù layer structure (3).  It‚Äôs very good if the data is known to have a certain hierarchy: then it‚Äôs possible to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> D </script>  You can take the distance matrix of the graph of this hierarchy (4). <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/cf/da/59cfdadaa9b9b864797749.png"></div><br>  Generally, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> D </script>  limited to your imagination, knowledge of the data and convenience of the subsequent visualization of neurons.  Because of the latter factor, it is not worth doing, for example, the Kohonen cubic layer.  Establishing your own order between neurons is a powerful tool, but remember that the more complex the structure <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> D </script>  the harder it is to initialize initial weights in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> W </script>  and the more likely it is to get the so-called torsion (kink) in the Kohonen layer at the output.  Torsion is a learning defect when <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> W </script>  globally match <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> D </script>  and the data, with the exception of some special points in which the layer is twisted, stretches unnaturally or is divided between two clusters.  In this case, the SOM learning algorithm cannot get out of this state without destroying an already established structure.  It is easy to see that torsion is an analogue of a deep local minimum in the training of ordinary neural networks. <br><br>  An abstract example of the classic torsion: <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/cf/e0/59cfe0d92a773228718780.png"></div><br>  An example of a twist on synthetic data when trying to fit a long curve into clusters.  The upper left and right petals look believable, but the allocated space spoils the order. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/cf/d6/59cfd6e7906aa076302624.png"></div><br>  By initializing the weights in the layer at random, you practically guarantee yourself a bad result at the output.  Must be constructed <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71"> W </script>  so that in each specific area the density of neurons approximately corresponds to the density of the data.  Alas, without extrasensory abilities or additional information about dataset, this is quite difficult to do. <br><img src="https://habrastorage.org/webt/59/da/52/59da521bb6b93459693762.png"><br>  Therefore, it is often necessary to do so that the neurons are simply uniformly scattered throughout the data space without intersections (as in the figure in the middle), and put up with the fact that not in all areas the density of neurons will correspond to data density. <br><br><h3>  Winner relaxation / winner enhancing </h3><br>  This idea was originally proposed by Kohonen [1], and then summarized by his followers [4].  What if you take away or add to the update of the neuron, the winner of the update of its neighbors?  Mathematically, it looks like this: Step A1.2.2.4 for the winner's neuron is replaced by <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-542"><span class="MJXp-mtext" id="MJXp-Span-543">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">c</span><span class="MJXp-mrow" id="MJXp-Span-547"><span class="MJXp-msubsup" id="MJXp-Span-548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-550" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mtext" id="MJXp-Span-552">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">c</span><span class="MJXp-mrow" id="MJXp-Span-556"><span class="MJXp-msubsup" id="MJXp-Span-557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-559" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-561">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">a</span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-567">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">c</span><span class="MJXp-mrow" id="MJXp-Span-571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">x</span></span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-574">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">c</span><span class="MJXp-mrow" id="MJXp-Span-578"><span class="MJXp-msubsup" id="MJXp-Span-579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-581" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-584">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">a</span><span class="MJXp-mtext" id="MJXp-Span-591">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">u</span><span class="MJXp-msubsup" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-596" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">j</span><span class="MJXp-mtext" id="MJXp-Span-598">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-603"><span class="MJXp-msubsup" id="MJXp-Span-604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-606" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-610">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">c</span><span class="MJXp-mrow" id="MJXp-Span-614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">x</span></span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-617">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">c</span><span class="MJXp-mrow" id="MJXp-Span-621"><span class="MJXp-msubsup" id="MJXp-Span-622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-624" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-626" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-72"> \ vec {w_i}: = \ vec {w_i} + \ eta ((\ vec {x} - \ vec {w_i}) + \ lambda \ sum_ {j \ neq i} {h_ {ij} (\ vec { x} - \ vec {w_j})}) </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-627"><span class="MJXp-mtext" id="MJXp-Span-628">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> \ lambda </script>  - Relaxation option.  Updates of the remaining neurons remain unchanged or a part of the relaxing term is added to them.  Sounds weird;  it turns out that if <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-635"><span class="MJXp-mtext" id="MJXp-Span-636">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">a</span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-644">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-74"> \ lambda <0 </script>  and the neuron has many neighbors, it can even roll back from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-645"><span class="MJXp-mtext" id="MJXp-Span-646">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">c</span><span class="MJXp-mrow" id="MJXp-Span-650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75"> \ vec {x} </script>  ?  If you do not use the top limit on the length of the vector, it is: <br><img src="https://habrastorage.org/webt/59/da/5d/59da5d577fe01100198893.png"><br>  With a negative <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-652"><span class="MJXp-mtext" id="MJXp-Span-653">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76"> \ lambda </script>  a neuron seems to be pulling its neighbors to itself, and if positive, it tends to jump out of their surroundings.  The difference is especially noticeable at the beginning of training.  Here is an example of the SOM state after the first epoch for the same initial configuration and negative, zero and positive <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-660"><span class="MJXp-mtext" id="MJXp-Span-661">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77"> \ lambda </script>  respectively: <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/da/93/59da93b03f52e304511176.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/da/93/59da93afeb1ba927895143.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/da/93/59da93b00a289774261607.png"></div><br>  Due to the effects described above <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-668"><span class="MJXp-mtext" id="MJXp-Span-669">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">a</span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-677">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> \ lambda <0 </script>  neurons scatter more broadly when <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-678"><span class="MJXp-mtext" id="MJXp-Span-679">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">a</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-687">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-79"> \ lambda> 0 </script>  - drawn out.  Accordingly, in the first case, the coating will be more uniform, and in the second, small isolated clusters and outliers will have a greater effect.  In the latter case, a possible torsion is also visible at the top of the graph.  The literature advises <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-688"><span class="MJXp-mtext" id="MJXp-Span-689">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">a</span><span class="MJXp-mtext" id="MJXp-Span-696">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">n</span><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-700" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-701">1</span><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mn" id="MJXp-Span-703">1</span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> \ lambda \ in [-1; 1] </script>  , but I found that good results can be obtained even with much larger in modulus values.  Please note that the added item includes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-705"><span class="MJXp-msubsup" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-708" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81"> h_ {ij} </script>  which in turn depends on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-711"><span class="MJXp-mtext" id="MJXp-Span-712">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82"> \ sigma </script>  .  Consequently, the above-described technique will play a large role at the beginning of training - at the stage of cooperation. <br><br><h3>  Cluster refinement phase </h3><br>  It often happens that after the main loop of the algorithm it turns out that even though the SOM neurons cling to something, their density on the clusters is quite comparable with the density in places where there are no clusters.  Analyzing in such conditions is quite difficult.  Narni Manukyan and the team propose [5] a rather simple solution: after the main algorithm, run another neuron fitting cycle. <br><br>  Algorithm 2, Cluster refinement phase (cluster adjustment phase): <br>  Entrance: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-83"> X </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-720"><span class="MJXp-mtext" id="MJXp-Span-721">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">t</span><span class="MJXp-msubsup" id="MJXp-Span-724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-726" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> \ eta_ {CR} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-729"><span class="MJXp-mtext" id="MJXp-Span-730">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">m</span><span class="MJXp-msubsup" id="MJXp-Span-735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-737" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85"> \ sigma_ {CR} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-740"><span class="MJXp-mtext" id="MJXp-Span-741">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">m</span><span class="MJXp-msubsup" id="MJXp-Span-746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-748" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86"> \ gamma_ {CR} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-751"><span class="MJXp-mtext" id="MJXp-Span-752">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">h</span><span class="MJXp-msubsup" id="MJXp-Span-757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-759" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87"> \ alpha_ {CR} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-762"><span class="MJXp-msubsup" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-765" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> E_ {CR} </script><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-msubsup" id="MJXp-Span-769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-771" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89"> E_ {CR} </script>  time: <br><br><ol><li>  Shuffle index list randomly order: = shuffle ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-774"><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-776">0</span><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-778">1</span><span class="MJXp-mo" id="MJXp-Span-779" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-780">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">s</span><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">N</span><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-788">2</span><span class="MJXp-mo" id="MJXp-Span-789" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">N</span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-792">1</span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90"> [0, 1, \ dots, N-2, N-1] </script>  ) </li><li>  For each <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91"> idx </script>  from order: <br><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-798"><span class="MJXp-mtext" id="MJXp-Span-799">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">c</span><span class="MJXp-mrow" id="MJXp-Span-803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">x</span></span><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">X</span><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">x</span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-92-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-92"> \ vec {x}: = X [idx] </script>  // Take a random vector from X </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-812"><span class="MJXp-mtext" id="MJXp-Span-813">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">j</span><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-824" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-msubsup" id="MJXp-Span-828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-830" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-831">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">t</span><span class="MJXp-mtext" id="MJXp-Span-836">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-837"><span class="MJXp-mo" id="MJXp-Span-838">|</span></span><span class="MJXp-mtext" id="MJXp-Span-839">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">c</span><span class="MJXp-mrow" id="MJXp-Span-843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">x</span></span><span class="MJXp-mo" id="MJXp-Span-845">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-846">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">c</span><span class="MJXp-mrow" id="MJXp-Span-850"><span class="MJXp-msubsup" id="MJXp-Span-851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-853" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-854">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">t</span><span class="MJXp-mtext" id="MJXp-Span-860">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-861"><span class="MJXp-mo" id="MJXp-Span-862">|</span></span><span class="MJXp-mrow" id="MJXp-Span-863"><span class="MJXp-mo" id="MJXp-Span-864">/</span></span><span class="MJXp-mtext" id="MJXp-Span-865">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">m</span><span class="MJXp-msubsup" id="MJXp-Span-870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-875">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">R</span></span></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-93-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-93"> \ forall j: h_ {ij}: = e ^ {\ left \ | \ vec {x} - \ vec {w_j} \ right \ | / \ sigma_ {CR} ^ 2} </script>  // Find the coefficient of proximity of neurons to the selected data element </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-876"><span class="MJXp-mtext" id="MJXp-Span-877">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">j</span><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-886">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">c</span><span class="MJXp-mrow" id="MJXp-Span-890"><span class="MJXp-msubsup" id="MJXp-Span-891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-893" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mtext" id="MJXp-Span-895">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">c</span><span class="MJXp-mrow" id="MJXp-Span-899"><span class="MJXp-msubsup" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-902" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-904">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">t</span><span class="MJXp-msubsup" id="MJXp-Span-907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-909" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">R</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-914" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-918">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">c</span><span class="MJXp-mrow" id="MJXp-Span-922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">x</span></span><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-925">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">c</span><span class="MJXp-mrow" id="MJXp-Span-929"><span class="MJXp-msubsup" id="MJXp-Span-930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-932" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-94-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-94"> \ forall j: \ vec {w_j}: = \ vec {w_j} + \ eta_ {CR} h_ {ij} (\ vec {x} - \ vec {w_j}) </script></li></ol></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-934"><span class="MJXp-mtext" id="MJXp-Span-935">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">t</span><span class="MJXp-msubsup" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-940" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-95-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-95"> \ eta_ {CR} </script>  : = <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-943"><span class="MJXp-mtext" id="MJXp-Span-944">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">m</span><span class="MJXp-msubsup" id="MJXp-Span-949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-951" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-96-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-96"> \ gamma_ {CR} </script><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-954"><span class="MJXp-mtext" id="MJXp-Span-955">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">t</span><span class="MJXp-msubsup" id="MJXp-Span-958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-960" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-97-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-97"> \ eta_ {CR} </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-963"><span class="MJXp-mtext" id="MJXp-Span-964">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">m</span><span class="MJXp-msubsup" id="MJXp-Span-969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-971" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-98-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-98"> \ sigma_ {CR} </script>  : = <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-974"><span class="MJXp-mtext" id="MJXp-Span-975">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">h</span><span class="MJXp-msubsup" id="MJXp-Span-980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-982" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-99-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-99"> \ alpha_ {CR} </script><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-985"><span class="MJXp-mtext" id="MJXp-Span-986">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">m</span><span class="MJXp-msubsup" id="MJXp-Span-991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-993" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-100-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-100"> \ sigma_ {CR} </script></li></ol></li></ol><br>  Although the algorithm looks and is very similar to A1, note that now we are not looking for the nearest neuron, but simply push all neurons to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-101-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-101"> x </script>  .  Due to interaction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-998"><span class="MJXp-mtext" id="MJXp-Span-999">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">c</span><span class="MJXp-mrow" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">x</span></span><span class="MJXp-mo" id="MJXp-Span-1005" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1006">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">c</span><span class="MJXp-mrow" id="MJXp-Span-1010"><span class="MJXp-msubsup" id="MJXp-Span-1011"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1013" style="vertical-align: -0.4em;">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-102-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-102"> \ vec {x} - \ vec {w_j} </script>  in the exponent in A2.2.2.2 and at the stage of updating the weights only the neurons that are in a certain ring from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1014"><span class="MJXp-mtext" id="MJXp-Span-1015">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">c</span><span class="MJXp-mrow" id="MJXp-Span-1019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-103-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-103"> \ vec {x} </script>  .  For clarity, look at the five epochs of adjustment: <br><img src="https://habrastorage.org/webt/59/de/0e/59de0e548fc91031463114.png"><br>  More accurately: the more fine tuning is in the CR phase, the better the clusters are visible, but the more local information about the cluster shape is lost.  After several epochs, only data on the elongation of clots remains.  CR can collapse several folds located nearby, and when too large <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1021"><span class="MJXp-mtext" id="MJXp-Span-1022">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">m</span><span class="MJXp-msubsup" id="MJXp-Span-1027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1029" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-104-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-104"> \ sigma_ {CR} </script>  , you risk just spoiling the structure obtained in the main step, as in the picture below: <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/de/0e/59de0e546ffbe557868703.png"></div><br>  However, the last problem can be avoided if we take some function instead of an exponent, which after some maximum value turns to 0. <br><br>  The authors of the article advise to use the same instead of a separate parameter of learning speed. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1032"><span class="MJXp-mtext" id="MJXp-Span-1033">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">m</span><span class="MJXp-msubsup" id="MJXp-Span-1038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1040" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-105-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-105"> \ sigma_ {CR} </script>  but it frankly doesn't work: if <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1043"><span class="MJXp-mtext" id="MJXp-Span-1044">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">m</span><span class="MJXp-msubsup" id="MJXp-Span-1049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1051" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">R</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-106-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-106"> \ sigma_ {CR} </script>  large (of the order of unity), the algorithm goes hand in hand, if small (0.01), then nothing is updated at all.  Strange, perhaps, they had some good data or a fitted vector of importance of variables? <br><br><h3>  Visualization, Rectifying SOM </h3><br>  So far, I have not said a word about data clustering using SOM.  Built with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-107-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-107"> D </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-108-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-108"> W </script>  the grid is a fun visualization, but by itself it says nothing about the number of clusters.  Moreover, I would even say that beautiful multicolored grids that you can google at the request of ‚ÄúSOM visualization‚Äù are more likely a reception for press releases and popular articles than a really useful thing. <br><br>  The easiest way to determine the number of data bunches in a crease is to look thoughtfully at a so-called <a href="http://users.ics.aalto.fi/jhollmen/dippa/node24.html">U-matrix</a> .  This is a kind of visualization of Kohonen maps, where the distance between them is shown along with the values ‚Äã‚Äãof the neurons.  This way you can easily determine where the clusters are in contact, and where the border lies. <br><br>  A more interesting way is to run over the resulting matrix. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-109-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-109"> W </script>  some other clustering algorithm.  For example, <a href="https://habrahabr.ru/post/322034/">DBSCAN is suitable</a> , especially with the CR modification of the SOM described above.  The distance function of the second algorithm should be combined from the distance along the grid in the layer ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110"> D </script>  ) and the real distance between neurons ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1062"><span class="MJXp-mtext" id="MJXp-Span-1063">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">t</span><span class="MJXp-mtext" id="MJXp-Span-1068">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1069"><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1071">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">c</span><span class="MJXp-mrow" id="MJXp-Span-1075"><span class="MJXp-msubsup" id="MJXp-Span-1076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1078" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1080">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">c</span><span class="MJXp-mrow" id="MJXp-Span-1084"><span class="MJXp-msubsup" id="MJXp-Span-1085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1087" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1088">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">t</span><span class="MJXp-mtext" id="MJXp-Span-1094">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1095"><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111"> \ left \ | \ vec {w_i} - \ vec {w_j} \ right \ | </script>  ) so as not to lose topological information about the crease. <br><br>  But more advanced seems to be the accumulation of relevant information about clusters right while the main algorithm is running.  Ehren Golge and Pinar Daigulu suggest [6] to remember every epoch of the basic algorithm operation how many times the neuron was activated (i.e., the neuron turned out to be the winner or its weight was updated, because the neuron closest in layer was the winner), and , whether the neuron person represents a cluster or hangs in empty space. <br><br>  Algorithm 3, Rectifying SOM (A1 with changes): <br>  Entrance: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1097"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-112"> X </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1099"><span class="MJXp-mtext" id="MJXp-Span-1100">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113"> \ eta </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1104"><span class="MJXp-mtext" id="MJXp-Span-1105">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114"> \ sigma </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1111"><span class="MJXp-mtext" id="MJXp-Span-1112">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115"> \ gamma </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1118"><span class="MJXp-mtext" id="MJXp-Span-1119">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116"> \ alpha </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117"> E </script><br><ol><li>  Initialize <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118"> W </script></li><li>  Initialize <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">s</span><span class="MJXp-mo" id="MJXp-Span-1132" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1133">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">c</span><span class="MJXp-mrow" id="MJXp-Span-1137"><span class="MJXp-mn" id="MJXp-Span-1138">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-119-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-119"> Es = \ vec {0} </script>  // Excitement score - full account of neuron excitation </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-120-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-120"> E </script>  time: <br><br><ol><li>  Initialize <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">W</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">C</span><span class="MJXp-mo" id="MJXp-Span-1144" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1145">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">c</span><span class="MJXp-mrow" id="MJXp-Span-1149"><span class="MJXp-mn" id="MJXp-Span-1150">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-121-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-121"> WC = \ vec {0} </script>  // Win count - the account of the excitation of the neuron in the current era </li><li>  Shuffle index list randomly order: = shuffle ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1151"><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1153">0</span><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1155">1</span><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1157">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">s</span><span class="MJXp-mo" id="MJXp-Span-1162" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">N</span><span class="MJXp-mo" id="MJXp-Span-1164" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1165">2</span><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">N</span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1169">1</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-122-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-122"> [0, 1, \ dots, N-2, N-1] </script>  ) </li><li>  For each <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-123-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-123"> idx </script>  from order: <br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1175"><span class="MJXp-mtext" id="MJXp-Span-1176">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">c</span><span class="MJXp-mrow" id="MJXp-Span-1180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">x</span></span><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">X</span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">x</span><span class="MJXp-mo" id="MJXp-Span-1188" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-124-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-124"> \ vec {x}: = X [idx] </script>  // Take a random vector from X </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">i</span><span class="MJXp-mo" id="MJXp-Span-1191" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mtext" id="MJXp-Span-1192">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">g</span><span class="MJXp-mtext" id="MJXp-Span-1196">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">i</span><span class="MJXp-msubsup" id="MJXp-Span-1199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1201" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-1202"><span class="MJXp-mtext" id="MJXp-Span-1203">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">t</span><span class="MJXp-mtext" id="MJXp-Span-1208">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1209"><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1211">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">c</span><span class="MJXp-mrow" id="MJXp-Span-1215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">x</span></span><span class="MJXp-mo" id="MJXp-Span-1217" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1218">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">c</span><span class="MJXp-mrow" id="MJXp-Span-1222"><span class="MJXp-msubsup" id="MJXp-Span-1223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1225" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1226">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">t</span><span class="MJXp-mtext" id="MJXp-Span-1232">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1233"><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-125-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-125"> i: = \ arg \ min_j {\ left \ | \ vec {x} - \ vec {w_j} \ right \ |} </script>  // Find the number of the neuron nearest to it </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-mtext" id="MJXp-Span-1236">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">j</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-1245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1247" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1250" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-msubsup" id="MJXp-Span-1251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1253" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255" style="margin-right: 0.05em;">D</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1256" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1259"><span class="MJXp-mo" id="MJXp-Span-1260">/</span></span><span class="MJXp-mtext" id="MJXp-Span-1261">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">m</span><span class="MJXp-msubsup" id="MJXp-Span-1266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1268" style="vertical-align: 0.5em;">2</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-126-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-126"> \ forall j: h_ {ij}: = e ^ {D_ {ij} / \ sigma ^ 2} </script>  // Find the coefficient of proximity of neurons on the grid.  Notice that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1269"><span class="MJXp-msubsup" id="MJXp-Span-1270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1272" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-127-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-127"> h_ {ii} </script>  always 1 </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1275"><span class="MJXp-mtext" id="MJXp-Span-1276">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">j</span><span class="MJXp-mo" id="MJXp-Span-1284" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-1285">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">c</span><span class="MJXp-mrow" id="MJXp-Span-1289"><span class="MJXp-msubsup" id="MJXp-Span-1290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1292" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1293" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mtext" id="MJXp-Span-1294">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">c</span><span class="MJXp-mrow" id="MJXp-Span-1298"><span class="MJXp-msubsup" id="MJXp-Span-1299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1301" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1303">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">a</span><span class="MJXp-msubsup" id="MJXp-Span-1307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1309" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1312" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1313">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">c</span><span class="MJXp-mrow" id="MJXp-Span-1317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">x</span></span><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">c</span><span class="MJXp-mrow" id="MJXp-Span-1324"><span class="MJXp-msubsup" id="MJXp-Span-1325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1327" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1328" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-128-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-128"> \ forall j: \ vec {w_j}: = \ vec {w_j} + \ eta h_ {ij} (\ vec {x} - \ vec {w_j}) </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1329"><span class="MJXp-mtext" id="MJXp-Span-1330">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">j</span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">W</span><span class="MJXp-msubsup" id="MJXp-Span-1340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341" style="margin-right: 0.05em;">C</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1342" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1344" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">W</span><span class="MJXp-msubsup" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347" style="margin-right: 0.05em;">C</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1348" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1353" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-129-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-129"> \ forall j: WC_ {j}: = WC_ {j} + h_ {ij} </script>  // Update the current activation account </li></ol></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1356"><span class="MJXp-mtext" id="MJXp-Span-1357">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-130-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-130"> \ eta </script>  : = <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1361"><span class="MJXp-mtext" id="MJXp-Span-1362">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">a</span><span class="MJXp-mtext" id="MJXp-Span-1368">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-131-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-131"> \ gamma \ eta </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1372"><span class="MJXp-mtext" id="MJXp-Span-1373">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-132-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-132"> \ sigma </script>  : = <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1379"><span class="MJXp-mtext" id="MJXp-Span-1380">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">a</span><span class="MJXp-mtext" id="MJXp-Span-1386">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-133-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-133"> \ alpha \ sigma </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1392"><span class="MJXp-mtext" id="MJXp-Span-1393">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">j</span><span class="MJXp-mo" id="MJXp-Span-1401" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">S</span><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">S</span><span class="MJXp-mo" id="MJXp-Span-1407" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">W</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">C</span><span class="MJXp-mrow" id="MJXp-Span-1410"><span class="MJXp-mo" id="MJXp-Span-1411" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mtext" id="MJXp-Span-1412">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-134-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-134"> \ forall j: ES: = ES + WC / \ eta </script>  // Accumulate the total score </li></ol></li></ol><br>  The more often the neuron is the winner, the greater the likelihood that it is somewhere in the thick of the cluster, and not outside it.  Note that the total count of neurons accumulates with a multiplier. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1416"><span class="MJXp-mn" id="MJXp-Span-1417">1</span><span class="MJXp-mrow" id="MJXp-Span-1418"><span class="MJXp-mo" id="MJXp-Span-1419" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mtext" id="MJXp-Span-1420">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-135-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-135"> 1 / \ eta </script>  : the lower the learning speed, the more weight WC will have.  This is done so that the last epochs of the cycle contribute more than the first.  This can be done in other ways, so slightly attach to this particular form. <br><br>  ES is a dimensionless quantity, its absolute values ‚Äã‚Äãdo not have a special meaning.  Simply, the greater the value, the greater the chance that the neuron clings to something meaningful.  After the end of A3, the resulting vector should be somehow normalized.  After applying ES to the neurons, you will get something like this: <br><img src="https://habrastorage.org/webt/59/de/1d/59de1ded90455656719511.png"><br>  Large red dots represent neurons with a high score of arousal, small red-violet ones with a small one.  Please note that the RSOM is sensitive to the method of final processing of ES and to clusters of different density in the data (see the lower right corner of the picture).  Make sure that you specify more epochs than is necessary for the convergence of the algorithm, so that ES accurately has time to accumulate the correct values. <br><br>  It is best, of course, to use both the RSOM and the additional clustering atop and viewing the visualization with the eyes. <br><br><h3>  Other </h3><br>  The review did not enter <br><br><ul><li>  Modifications of SOM for working with categorical data [7], sequences, pictures, and other types of data that are non-native to SOM, [1]. </li><li>  Work related to the time asymmetry of the proximity functions of neurons on the grid. <br>  The author argues that it allows you to deal with torsion [8]. </li><li>  Studies related to control over the extent of data coverage by neurons (fight against distortions at the edges of the dataset) [9]. </li><li>  The accumulation of information about the importance of certain inputs [10]. </li><li>  Data coding using SOM [1]. </li><li>  Clever ways to initialize <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-136-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-136"> W </script>  [11] [12]. </li><li>  Ability to add an additional component of <a href="https://ru.wikipedia.org/wiki/%25D0%25A3%25D0%25BF%25D1%2580%25D1%2583%25D0%25B3%25D0%25B0%25D1%258F_%25D0%25BA%25D0%25B0%25D1%2580%25D1%2582%25D0%25B0">elasticity</a> .  Elasticity is an analogue of regularization in ordinary neural networks, prohibiting configurations that are too complicated. </li><li>  Emission detection.  A rather simple idea: after a certain epoch, when the map has already more or less converged, you can begin to check whether the distance from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-137-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-137"> x </script>  to the nearest neuron.  If for several epochs the distance is greater than the specified parameter and does not change, you can mark the sample data as an outlier (and alternatively, even exclude from the update step).  Minus: detects outliers only ‚Äúoutside‚Äù dataset, but not in its thickness. </li><li>  Many other interesting, but too special things. </li></ul><br><h3>  Comparison of SOM and t-SNE </h3><br><table border="1"><tbody><tr><th></th><th>  SOM </th><th>  t-SNE </th></tr><tr><td>  Complexity </td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">O</span><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">M</span><span class="MJXp-mo" id="MJXp-Span-1435" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-138-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-138"> O (dENM) </script></td><td>  Barnes-Hut t-SNE with kNN optimization - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">O</span><span class="MJXp-mo" id="MJXp-Span-1438" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">N</span><span class="MJXp-mtext" id="MJXp-Span-1442">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">g</span><span class="MJXp-mrow" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">N</span></span><span class="MJXp-mo" id="MJXp-Span-1448" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-139-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-139"> O (dEN \ log {N}) </script>  , but other implementations may be more computationally intensive, right up to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-1451" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1456" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1457" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-140-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-140"> O (dEN ^ 2) </script></td></tr><tr><td>  The number of hyperparameters </td><td>  3-5, perhaps much more + distance matrix on neurons.  Mandatory number of epochs, learning rate and the initial rate of cooperation.  Also, the attenuation of the learning rate and the coefficient of cooperation are often indicated, but they almost never cause problems. </td><td>  3-4, maybe more + metrics on data.  Mandatory number of epochs, learning rate and perplexity, often occurs early exaggeration.  Perplexity is quite magical, definitely have to tinker with it. </td></tr><tr><td>  Resolution of the resulting visualization </td><td>  There are no more elements than neurons ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-141-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-141"> M </script>  ) </td><td>  There are no more elements than the elements in the data set ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-142-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-142"> N </script>  ) </td></tr><tr><td>  Visualization topology </td><td>  Any, you only need to provide a matrix of distances between neurons. </td><td>  Only ordinary plane or three-dimensional space </td></tr><tr><td>  Pre-study, expansion of structure </td><td>  There are quite trivial to implement </td><td>  Not </td></tr><tr><td>  Support for additional transform layers </td><td>  There is, you can put as many densely connected or convolutional layers as possible in front of the Kohonen layer and train with ordinary backprop </td><td>  No, only manual data conversion and feature-engeneering </td></tr><tr><td>  Preferred cluster types </td><td>  By default, it perfectly displays clusters in the form of two-dimensional folds and exotic clusters.  We need tricks to visualize well structures with dimensions greater than two. </td><td>  Remarkably displays the hypers.  Hyperfolds and exotic ones are a bit worse, it strongly depends on the distance function. </td></tr><tr><td>  Preferred dimension of data space </td><td>  Depends on the data, but the more, the worse.  The algorithm may degrade even with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467"><font style="vertical-align: inherit;">q </font></span><span class="MJXp-mn" id="MJXp-Span-1468"><font style="vertical-align: inherit;">4</font></span></font><span class="MJXp-mtext" id="MJXp-Span-1464">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-1468"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-143-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-143"> d \ geq 4 </script>  , since a hyper-folder formed by neurons has too many degrees of freedom. </td><td>  Any, until the curse of dimension </td></tr><tr><td>  Problems with the initial data </td><td>  It is necessary to initialize the neuron weights.  This can be technically difficult in the case of a nonstandard distance matrix between neurons (especially the ‚Äúgraph‚Äù type topology) </td><td>  Not </td></tr><tr><td>  Emission problems </td><td>  Yes, especially if they are unevenly distributed </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No, on visualization they will also be emissions. </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Effects at the edges of the data distribution </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Part of the data remains under-covered SOM </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Almost invisible </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Problems with false positive clusters </font></font></td><td>  Not </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What else </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cluster size in visualization </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bears semantic load </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Almost always means nothing </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Distance between clusters in visualization </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bears semantic load </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Often means nothing </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cluster density in visualization </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usually has a meaning, but can be misleading in case of poor initialization </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Often means nothing </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cluster form in visualization </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bears semantic load </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Can deceive </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> How difficult it is to assess the quality of clustering </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Very difficult :( </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Very difficult :( </font></font></td></tr></tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It would seem that SOM wins in computational complexity, but you shouldn‚Äôt rejoice ahead of time without seeing </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1469"><span class="MJXp-msubsup" id="MJXp-Span-1470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1472" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> under the O-large.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-144-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-144">N^2</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> depends on the desired resolution of the self-organizing map, which depends on the spread and heterogeneity of the data, which, in turn, implicitly depends on</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-145-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-145"> M </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-146-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-146"> N </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-147-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-147"> d </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> So in real life, complexity is something like </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-1481" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1485" style="vertical-align: 0.5em;"><span class="MJXp-mfrac" id="MJXp-Span-1486" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1487"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1488"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> E</font></font></span><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-148-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-148">O(dN^{\frac{3}{2}}E)</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The following table shows the strengths and weaknesses of the SOM and t-SNE. </font><font style="vertical-align: inherit;">It is easy to understand why self-organizing maps have given way to other clustering methods: although visualization with Kohonen maps is more meaningful, it allows the growth of new neurons and setting the desired topology on neurons, the degradation of the algorithm with large</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> strongly undermines the demand for SOM in modern data science. </font><font style="vertical-align: inherit;">In addition, if visualization using t-SNE can be used immediately, self-organizing maps need post-processing and / or additional visualization efforts. </font><font style="vertical-align: inherit;">An additional negative factor - problems with initialization</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-149-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-149"> d </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and torsion. </font><font style="vertical-align: inherit;">Does this mean that self-organizing maps are a thing of the past data science?</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-150-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-150">W</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font> Not really.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No, no, yes, and sometimes it is necessary to process not very multidimensional data - for this it is possible to use SOM. </font><font style="vertical-align: inherit;">The visualizations are really pretty and spectacular. </font><font style="vertical-align: inherit;">If you do not be lazy to apply the refinement of the algorithm, SOM perfectly finds clusters on hyperlinks.</font></font><br><br>  Thanks for attention.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I hope my article will inspire someone to create new SOM-visualizations. </font></font><a href="https://github.com/Siarshai/MicroSOM/tree/master"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> you can download the code with a minimal example of SOM with the main optimizations proposed in the article and look at the animated map training. Next time I will try to consider the ‚Äúneural gas‚Äù algorithm, which is also based on competitive learning. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1]: Self-Organizing Maps, book; Teuvo Kohonen </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[2]: Energy functions for self-organizing maps; Tom Heskesa, Theoretical Foundation SNN, University of Nijmegen </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[3]: </font></font><a href="http://bair.berkeley.edu/blog/2017/08/31/saddle-efficiency/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bair.berkeley.edu/blog/2017/08/31/saddle-efficiency</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [4]: Winner-Relaxing Self-Organizing Maps, Jens Christian Claussen</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[5]: Data-Driven Cluster Reinforcement and Sparsely-Matched Self-Organizing Maps; Narine Manukyan, Margaret J. Eppstein, and Donna M. Rizzo </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[6]: Recording text from Web Images; Eren Golge &amp; Pinar Duygulu </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[7]: An Alternative Approach for Binary and Categorical Self-Organizing Maps; Alessandra Santana, Alessandra Morais, Marcos G. Quiles </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[8]: Temporally Asymmetric Learning Multi-Winner Self-Organizing Maps </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[9]: Magnification Control in Self-Organizing Maps and Neural Gas; Thomas Villmann, Jens Christian Claussen </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[10]: Embedded Selection for Self-Organizing Maps; Ryotaro Kamimural, Taeko Kamimura</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[11]: Initialization Issues in Self-organizing Maps; </font><font style="vertical-align: inherit;">Iren Valova, George Georgiev, Natacha Gueorguieva, Jacob Olsona </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[12]: Self-organizing Map Initialization; </font><font style="vertical-align: inherit;">Mohammed Attik, Laurent Bougrain, Frederic Alexandre</font></font></div><p>Source: <a href="https://habr.com/ru/post/338868/">https://habr.com/ru/post/338868/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338858/index.html">How to make gif-animation for Behance and Dribbble?</a></li>
<li><a href="../338860/index.html">We attack DHCP part 2. DHCP + WiFi = MiTM</a></li>
<li><a href="../338862/index.html">DPI-digest: information security, virtualization and regulation</a></li>
<li><a href="../338864/index.html">We attack DHCP part 3. DHCP + Apple = MiTM</a></li>
<li><a href="../338866/index.html">Deploying Magento 2 Development Applications</a></li>
<li><a href="../338870/index.html">Optimizing TensorFlow on modern Intel architectures</a></li>
<li><a href="../338872/index.html">Startups from Russia: ITMO University Digest</a></li>
<li><a href="../338874/index.html">What is the difference between designing a metro station and designing a cottage?</a></li>
<li><a href="../338876/index.html">Koadic - like Empire, only without powershell</a></li>
<li><a href="../338880/index.html">Time to kill the web</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>