<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Convert desktop app to appx using Desktop Bridge</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With the release of Visual Studio 2017, you should be able to convert existing .NET / Win32 projects into the Windows Store application in a more comf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Convert desktop app to appx using Desktop Bridge</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/9c0/679/59b/9c067959b5f143dfbf6b3b6238b36518.jpg"></div><br>  With the release of Visual Studio 2017, you should be able to convert existing .NET / Win32 projects into the Windows Store application in a more comfortable way. <br><br>  However, now to create an appx package from a .NET application, it is not at all necessary to install the 2017th studio.  Enough SDK installed for Windows 10 and Visual Studio 2015 with Developer Command Prompt.  What is good is the fact that after the Anniversary Update it is no longer necessary to download the image of the dozens and install some third-party software, if you have the source code of the project or the executable file. <br><br>  I suggest creating an appx package from a .NET application using the <a href="https://developer.microsoft.com/ru-ru/windows/bridges/desktop">Desktop Bridge (ex. Project Centennial)</a> . <br><a name="habracut"></a><br><h4>  How can you do it now? </h4><br>  Create a root directory with the name, say, WPF2UWPApp.  Let the name not confuse you, you can convert not only WPF applications, but also WinForms, Win32 and even VB6. <br>  In this folder, copy the executable file of the application and all the necessary libraries. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Next, inside the folder, create an AppxManifest.xml file with similar content inside: <br><br><div class="spoiler">  <b class="spoiler_title">The contents of my AppxManifest.xml file</b> <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Package</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/appx/manifest/foundation/windows10"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:uap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/appx/manifest/uap/windows10"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:rescap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Identity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"WPF2UWPApp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ProcessorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Publisher</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CN=AlexejSommer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0.0.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DisplayName</span></span></span><span class="hljs-tag">&gt;</span></span>Simple WPF UWP App<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DisplayName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PublisherDisplayName</span></span></span><span class="hljs-tag">&gt;</span></span>Alexej Sommer<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PublisherDisplayName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Simple converted from WPF to UWP application<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Logo</span></span></span><span class="hljs-tag">&gt;</span></span>Assets\SampleAppx.150x150.png<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Logo</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Resource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en-us"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetDeviceFamily</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Windows.Desktop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MinVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"10.0.14393.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MaxVersionTested</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"10.0.14393.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Capabilities</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rescap:Capability</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"runFullTrust"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Capabilities</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Applications</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"WPF2UWPApp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Executable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DemoWPFApp.exe"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">EntryPoint</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Windows.FullTrustApplication"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uap:VisualElements</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BackgroundColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#464646"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DisplayName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Simple WPF UWP App"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Square150x150Logo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Assets\SampleAppx.150x150.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Square44x44Logo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Assets\SampleAppx.44x44.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Simple converted from WPF to UWP application"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uap:DefaultTile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Wide310x150Logo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Assets\Wide310x150Logo.png"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uap:VisualElements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Applications</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Package</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  In the manifest, we use a minimal set of logos.  The 3 files SampleAppx.44x44.png, SampleAppx.150x150.png and Wide310x150Logo.png with the corresponding name permissions must be located inside the Assets subdirectory. <br><br>  I am not going to publish this application in the Store, so I specified an arbitrary value as the CN publisher, and not associated with my Store account.  As you may have noticed, I am not an insider now and am using the last stable build of tens - 10.0.14393.0 <br><br>  Once again the structure: <br><br>  Inside the root directory is the AppxManifest.xml manifest file, the application file (in my case, this is the DemoWPFApp.exe file) and other supporting files and libraries.  In addition, inside there is an Assets folder with logo files.  At a minimum, these are the SampleAppx.44x44.png, SampleAppx.150x150.png, and Wide310x150Logo.png files.  After creating the structure and editing the contents of the AppxManifest.xml file, you can start creating the application package. <br><br>  Before creating a package, you can test the correctness of the manifest and the attached files by installing the application as a universal one, using its manifest.  For a test installation, open PowerShell and execute the command (being in the same directory as the AppxManifest file) <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>-AppxPackage -Register ".\AppxManifest.xml"</code> </pre> <br>  The -Register parameter registers the application in development mode.  In order to register the finished application, you must also use the ‚ÄìDisableDevelopmentMode parameter. <br><br>  The application will be installed as if it was installed from a ready-made appx package or downloaded from the Store.  A link to it will even appear in the Start menu.  Such testing is especially convenient if you add some UWP functionality to a .NET application and want to test it right away. <br><br>  Let's return to the application packaging in appx.  To do this, open the Developer Command Prompt.  Run the following command, which creates the appx file: <br><br><pre> <code class="hljs perl">makeappx <span class="hljs-keyword"><span class="hljs-keyword">pack</span></span> -d <span class="hljs-string"><span class="hljs-string">"D:\WPF2UWPApp"</span></span> -p <span class="hljs-string"><span class="hljs-string">"D:\WPF2UWPApp\WPF2UWPApp.appx"</span></span></code> </pre> <br>  Copy the certificate file from the finished project or create a test certificate as described here: <a href="https://msdn.microsoft.com/en-us/windows/uwp/porting/desktop-to-uwp-signing">Sign an app converted with the Desktop Bridge</a> <br><br>  The MakeCert utility is inside the bin SDK folder.  On my machine, this is C: \ Program Files (x86) \ Windows Kits \ 10 \ bin \ x64. The command syntax is: <br><br><pre> <code class="hljs xml">MakeCert.exe -r -h 0 -n "CN=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">publisher_name</span></span></span><span class="hljs-tag">&gt;</span></span>" -eku 1.3.6.1.5.5.7.3.3 -pe -sv <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">my.pvk</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">my.cer</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The name of the publisher CN in the manifest must match the name in the certificate.  The ‚Äìeku 1.3.6.1.5.5.7.3.3 parameter is an enhanced key usage object identifier (OID), which is used to sign the code (szOID_PKIX_KP_CODE_SIGNING).  Detailed information on the MakeCert parameters can be found on its <a href="https://msdn.microsoft.com/ru-ru/library/windows/desktop/aa386968.aspx">MSDN page</a> .  There is also information that the utility is outdated and instead it is now recommended to use a PowerShell cmdlet called New-SelfSignedCertificate.  However, even in the latest examples of using the Desktop Bridge, a MakeCert is still used. <br><br>  In my case, the command is: <br><br><pre> <code class="hljs objectivec">MakeCert.exe -r -h <span class="hljs-number"><span class="hljs-number">0</span></span> -n <span class="hljs-string"><span class="hljs-string">"CN=AlexejSommer"</span></span> -eku <span class="hljs-number"><span class="hljs-number">1.3</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> -pe -sv alexkey.pvk alexkey.cer</code> </pre> <br>  Note again that the CN is exactly the same as in the manifest.  If you are prompted for a password, you can enter it or click None.  Official documentation suggests not to use a password. <br><br><img src="https://habrastorage.org/files/fa9/eea/a79/fa9eeaa7961443dbab90300a4c4d20c5.PNG"><br><br>  Next, move both the public and private keys to the certificate: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">pvk2pfx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.exe</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-pvk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">alexkey</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.pvk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-spc</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">alexkey</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.cer</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-pfx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">alexcert</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.pfx</span></span></code> </pre> <br>  Now, using <a href="https://msdn.microsoft.com/ru-ru/library/8s9b9yaz(v%3Dvs.110).aspx">SignTool,</a> you can sign our appx package with a certificate.  Both files (alexcert.pfx and WPF2UWPApp.appx) should be located in the current folder: <br><br><pre> <code class="hljs mel">signtool.exe <span class="hljs-keyword"><span class="hljs-keyword">sign</span></span> /a /v /fd SHA256 /f <span class="hljs-string"><span class="hljs-string">"alexcert.pfx"</span></span> <span class="hljs-string"><span class="hljs-string">"WPF2UWPApp.appx"</span></span></code> </pre> <br>  If you decide to use a password, then the / p parameter will be added. <br><br><pre> <code class="hljs mel">signtool.exe <span class="hljs-keyword"><span class="hljs-keyword">sign</span></span> /a /v /fd SHA256 /f <span class="hljs-string"><span class="hljs-string">"alexcert.pfx"</span></span> /p <span class="hljs-string"><span class="hljs-string">"&lt;&gt;"</span></span> <span class="hljs-string"><span class="hljs-string">"WPF2UWPApp.appx"</span></span></code> </pre> <br>  If you hurry now and try to install appx, then most likely during the installation you will receive an error message: <br><br><blockquote>  You need to either install a new certificate for this application package, or a new application package with trusted certificates.  Your system administrator or application developer can help.  The certificate chain has been processed, but completed in a root certificate that is not trusted (0x800B0109) </blockquote><br>  The fact is that: <br><br><blockquote>  For Windows to consider the certificate trusted, the certificate must be located in the <b>Certificates</b> node <b>(local computer)&gt; Trusted Root Certification Authorities&gt; Certificates</b> or <b>Certificates (local computer)&gt; Trustees&gt; Certificates</b> . </blockquote><br>  So, before installing the application, you need to install a certificate.  Double click on the certificate install it in the local computer storage <br><br><div class="spoiler">  <b class="spoiler_title">How to install the certificate in pictures</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/952/546/db9/952546db907c42a996a92777e5d70035.PNG"><br><img src="https://habrastorage.org/files/c69/884/ba4/c69884ba46754c9c9b629fb20225e76b.PNG"><br><img src="https://habrastorage.org/files/8f3/339/015/8f3339015b79405ca0ec686ba6e024f7.PNG"><br><img src="https://habrastorage.org/files/a6d/38c/6cc/a6d38c6cce5f4ee0b3a353b2cc4ca07f.PNG"><br><img src="https://habrastorage.org/files/a14/c24/f24/a14c24f2400c4e398bf9881a492f2745.PNG"><br></div></div><br>  After installing the certificate, you can install the application itself by clicking on the appx file <br><br><img src="https://habrastorage.org/files/342/0ea/58d/3420ea58d45f4146add613ba221ce7f9.PNG"><br><br>  The bulb on the screenshot is the logo of my demo application. <br><br><h4>  How can this be done in Visual Studio 2017 </h4><br>  At the moment, Visual Studio 2017 is in the Release Candidate stage.  To automatically create an appx package, you need to install the <a href="http://go.microsoft.com/fwlink/%3FLinkId%3D797871">Desktop to UWP Packaging Project</a> extension. <br><br>  Open an existing project.  Add the following project type to the solution: <br><br><img src="https://habrastorage.org/files/b11/3e6/fcb/b113e6fcbfb04e099c130dfd56454659.PNG"><br><br>  Create a PackageLayout folder.  Inside it, create an Assets folder.  In the PackageLayout folder, add the AppxManifest.xml manifest file (for now, you need to create the file manually).  In Assets, copy the files SampleAppx.44x44.png, SampleAppx.150x150.png and Wide310x150Logo.png. <br><br>  Do not forget that it is necessary not only to copy the files, but also to add them to the Visual Studio project. <br><br>  The structure of our solution will be as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7e7/83b/f17/7e783bf17fd743edbfc985623053431b.PNG"></div><br>  In the project properties, specify the PackageLayout folder.  If you did everything correctly, then in the Start Up Tile field you will be able to choose a tile from the drop-down list. <br><br><img src="https://habrastorage.org/files/f78/ab6/61f/f78ab661fdd0440dbaf6d3b1d505c6f4.PNG"><br><br>  Now let's look at the contents of the AppXPackageFileList.xml file.  By default it is: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ToolsVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"14.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/developer/msbuild/2003"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- &lt;PropertyGroup&gt; &lt;MyProjectOutputPath&gt;C:\MyProject\MyProject\bin&lt;/MyProjectOutputPath&gt; &lt;/PropertyGroup&gt; &lt;ItemGroup&gt; &lt;LayoutFile Include="$(MyProjectOutputPath)\x86\Debug\MyProject.exe"&gt; &lt;PackagePath&gt;$(PackageLayout)\MyProject.exe&lt;/PackagePath&gt; &lt;/LayoutFile&gt; &lt;/ItemGroup&gt; --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  As a result of the edits, you get something like this: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ToolsVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"14.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/developer/msbuild/2003"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyProjectOutputPath</span></span></span><span class="hljs-tag">&gt;</span></span>$(PackageLayout)\..\..\DemoWPFApp\bin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyProjectOutputPath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LayoutFile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(MyProjectOutputPath)\Debug\DemoWPFApp.exe"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackagePath</span></span></span><span class="hljs-tag">&gt;</span></span>$(PackageLayout)\DemoWPFApp.exe<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackagePath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LayoutFile</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Here, the directory from which .NET application files will be taken is set as MyProjectOutputPath.  Climbing up two levels (that is what \ .. \ .. \) from the PackageLayout is the DemoWPFApp directory, inside which is the bin directory.  That is, the folder is taken from the second draft decision. <br><br>  Now it‚Äôs enough to assign the Desktop to UWP Packaging project to be auto-downloadable, run the project to run F5 and ... we have to get appx at the output.  But so far it does not work.  Tbd  We are waiting for release. <br><br>  As you can see, some of the handmade work is still there.  You still need to manually create a directory structure, create a manifest, and modify the AppXPackageFileList file.  I hope that in the release all this is automated. <br><br>  Similar English article: <a href="https://blogs.msdn.microsoft.com/appconsult/2016/10/28/desktop-bridge-manually-converting-a-desktop-application/">Desktop Bridge - Manually converting a desktop application</a> <br><br><h4>  Alternatives </h4><br>  Microsoft is actively working with partners to be able to simultaneously create both msi and appx installers.  More information can be found at the following links: <br><br>  ¬ª <a href="https://www.firegiant.com/products/wix-expansion-pack/appx/%3Futm_source%3Dmsftblog%26utm_medium%3Dreferral%26utm_campaign%3Dappx">FireGiant WIX toolset extensions</a> <br>  ¬ª <a href="http://www.flexerasoftware.com/producer/products/software-installation/installshield-software-installer/">Flexera Software's InstallShield</a> <br>  ¬ª <a href="http://www.advancedinstaller.com/uwp-app-package.html">Advanced Installer</a> <br>  ¬ª <a href="https://www.installaware.com/appx.htm">InstallAware APPX Builder</a> <br><br>  In addition, Embarcadero <a href="https://www.embarcadero.com/products/rad-studio/windows-10-store-desktop-bridge">announced support for the Desktop Bridge</a> in its Embarcadero RAD Studio. <br><br><hr><br><h4>  Why do you need it? </h4><br>  I will give some obvious options: <br><br>  1. Publish the application to the Store. <br>  2. Application Lifecycle.  Universal applications can be installed and removed many times, without fear that they will leave behind any garbage. <br>  3. The ability to add functionality to the .NET application that is available for UWP applications. <br>  4. Distribution and testing through the <a href="https://msdn.microsoft.com/windows/uwp/debug-test-perf/device-portal">device portal</a> .  Ops will thank you. </div><p>Source: <a href="https://habr.com/ru/post/316490/">https://habr.com/ru/post/316490/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316480/index.html">SmartDigest # 1. What to read or the best of books in a week</a></li>
<li><a href="../316482/index.html">Deploy OpenSource Puppet 4 with multiple puppet masters. Part II. Puppet Masters Setup</a></li>
<li><a href="../316484/index.html">How to use PVS-Studio for free</a></li>
<li><a href="../316486/index.html">Deploy OpenSource Puppet 4 with multiple puppet masters. Part III. Setting up puppet-db with Puppet</a></li>
<li><a href="../316488/index.html">We invite to Azov Developers Meetup conference - December 10 in Taganrog</a></li>
<li><a href="../316492/index.html">History of programming languages: Delphi is more than just a language</a></li>
<li><a href="../316494/index.html">The Six Brains of UX Design</a></li>
<li><a href="../316496/index.html">Search for Use Case for SIEM</a></li>
<li><a href="../316498/index.html">Release DBMS InterSystems Cach√© 2016.2</a></li>
<li><a href="../316500/index.html">The loudest cyber attacks on critical infrastructures</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>