<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ORM in cis magento</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After reading this post habrahabr.ru/post/303028/#first_unread . I wondered why many developers are in no hurry to use it? And why do people have the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ORM in cis magento</h1><div class="post__text post__text-html js-mediator-article">  After reading this post <a href="https://habrahabr.ru/post/303028/">habrahabr.ru/post/303028/#first_unread</a> .  I wondered why many developers are in no hurry to use it?  And why do people have the impression that they are smarter than those who developed and supported this functionality for years.  And you guessed it, let's talk about ORM! <br><a name="habracut"></a><br>  The fact is that magento is built on the MVC pattern, and this is no secret to anyone.  Consider the model, because the model is the private implementation of the Entity manager.  Suppose we have a table `` mymodule_mytable '`, and the corresponding model` `mymodule / mytable'`. <br>  Get the model: <br><br><pre><code class="php hljs">$myModule = Mage::getModel(<span class="hljs-string"><span class="hljs-string">'mymodule/mytable'</span></span>)</code> </pre> <br><br>  When initializing the model.  Magento automatically creates setters and heters, more precisely, they are implemented using the magic methods `__set ()` and `__get ()`.  For example, our essence (a table in the database) has the fields  ªid, first_name, last_name` 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Next, consider the daily operations on the tables: <br>  1. Creating the insert line in mysql, on the Magen object dialect, it will look like this <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { $myModule -&gt;setFirstName(<span class="hljs-string"><span class="hljs-string">'myFirstName'</span></span>) -&gt;setLastName(<span class="hljs-string"><span class="hljs-string">'myLastName'</span></span>) -&gt;save(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> $error) { <span class="hljs-comment"><span class="hljs-comment">// error loging }</span></span></code> </pre><br>  2. Fetching a string from the database, fields for  ªid`: <br><pre> <code class="php hljs"> $myModule-&gt;load($id);</code> </pre><br>  3. Line changes <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { $myModule -&gt;load($id) -&gt;setFirstName(<span class="hljs-string"><span class="hljs-string">'MyFirst'</span></span>) -&gt;save(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> $error) { <span class="hljs-comment"><span class="hljs-comment">//loging error }</span></span></code> </pre><br><br>  4. Transactions <br><pre> <code class="php hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... $adapter = $this-&gt;_getWriteAdapter(); // ... $adapter-&gt;beginTransaction() try { $myModel-&gt;setFirstName('MyFirstName')-&gt;save(); $adapter-&gt;commit(); } catch(Exception $error) { $adapter-&gt;rollback(); }</span></span></code> </pre><br><br>  These are the basic properties of the model. I guess you ask, how can you get a certain amount of data using ORM?  The fact is that Magento has a collection implementation.  Create a separate file for uploading the collection.  Here I must, make a small digression, if your model works with a database, then it will definitely have the implementation of resource, and collection.  I understand that it was necessary to write in the beginning.  But I did not do that.  Since we are talking about ORM. <br><br>  Let's continue to consider ORM operations on tables: <br><br>  5. Selection of all fields from the table: <br><pre> <code class="php hljs"> $myCollection = $myModel-&gt;getCollection()-&gt;load();</code> </pre><br><br>  6. Filtering fields <br><pre> <code class="php hljs"> $myCollection = $myModel-&gt;getCollection(); $myCollection-&gt;addFieldToFilter(<span class="hljs-string"><span class="hljs-string">'first_name'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'eq'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'MyFirstName'</span></span> )); $myEntityes = $myCollection-&gt;load();</code> </pre><br>  I will not consider all available methods they are similar to mysql `like, in, notlike, regexp, notin` and dr.  all this is in the documentation. <br><br>  7. Selection of certain fields <br><pre> <code class="php hljs"> $myCollection-&gt;addFieldToSelect( <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'id'</span></span>,<span class="hljs-string"><span class="hljs-string">'first_name'</span></span>); )</code> </pre><br><br>  And where do you say join?  With join it is more difficult since in most cases we have to create an EAV model, Entity-attribute-value (entity value attributes).  For most tasks, we need to create an EAV model in which certain attributes of our entity will be stored.  join in code is a kind of caste, since at some point in development we have `id | first_name | last_name` and after some improvements we arrive at` id | first_name | last_name | data1 | data2 ... data322`, and then the developer suddenly decides , make another table that will be joinit for modifying and writing, any additional fields.  In the end, we come to the fact that we cannot simply solve elementary tasks without changing the table, not correcting the `join` and queries ... <br>  As races EAV solves this problem, you can easily add an attribute and work with it, you can enable the user to add new attributes, and shine that you have something somewhere to fall off or change ... <br>  And on this I will finish, if the article is interesting, I will write a sequel about the creation of the eav model, and the use of such models ... <br>  PS If only someone would unsubscribe why minus ... </div><p>Source: <a href="https://habr.com/ru/post/304606/">https://habr.com/ru/post/304606/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304596/index.html">Introducing 3CX v15 Release Candidate</a></li>
<li><a href="../304598/index.html">Design stages, mistakes and advantages</a></li>
<li><a href="../304600/index.html">We get a domain name, DNS and SSL certificate free then</a></li>
<li><a href="../304602/index.html">We are developing a real-time fulltext-search system for error-logs based on ClickHouse from Yandex</a></li>
<li><a href="../304604/index.html">Spryker performance and scalability concept</a></li>
<li><a href="../304608/index.html">Making a cool single page application on basis.js - part 2</a></li>
<li><a href="../304612/index.html">Seminars on introducing everything: from verilog and digital logic to micro-architecture of embedded processors and RTOS</a></li>
<li><a href="../304616/index.html">A polynomial algorithm for a combinatorial problem (P = NP?)</a></li>
<li><a href="../304618/index.html">OctoberCMS Stable Release</a></li>
<li><a href="../304620/index.html">The digest of interesting materials for the mobile developer # 160 (June 27-July 3)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>