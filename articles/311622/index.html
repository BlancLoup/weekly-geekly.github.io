<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ATM attacks: past, present and future</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In a post about the Internet of Things, I, with almost my sword, carried it to that and ATMs - by the criteria of autonomous work and the availability...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ATM attacks: past, present and future</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/db1/af4/716/db1af47164024010b991dba9683b7189.jpg" align="right">  In a post about the <a href="https://habrahabr.ru/company/kaspersky/blog/311076/">Internet of Things,</a> I, with almost my sword, carried it to that and ATMs - by the criteria of autonomous work and the availability of a permanent connection to the Internet.  In general, everything is as it is, but if we move from words to deeds ‚Äî that is, to the real specifics of protecting ATMs from hacking, then immediately a lot of uncomfortable details arise.  A modern ATM is a full-fledged computer, honed to perform one specific task, but suitable for running any code, including malicious one.  The ATM is enclosed and in contact with a variety of sensors and specialized devices through which the ATM can be hacked.  Or you can not crack it by intercepting the control of the cash dispenser or the keyboard for entering the PIN code. <br><br>  There are many scenarios when something goes wrong with an ATM - many, and most are based not on a theoretical analysis of potential vulnerabilities, but on the practice of parsing real attacks.  The banking sector as a whole is much more secure than other industries, but cybercriminals have more attention to it: real money is at stake.  Nevertheless, it would be nice to somehow systematize the weak points of the banking infrastructure, which the laboratory specialists Olga Kochetova and Alexey Osipov recently took up. <br><br>  As is the case with the <a href="https://habrahabr.ru/company/kaspersky/blog/309260/">history of the investigation of the Lurk campaign</a> , this text is a free retelling of the original sources.  For details, I send to them: this is a review <a href="https://securelist.ru/analysis/obzor/29354/future-attack-scenarios-against-atm-authentication-systems/">article</a> on Securelist in Russian, the <a href="https://securelist.com/files/2016/09/Future_ATM_attacks_report_eng.pdf">study</a> ‚ÄúFuture attack scenarios on communication systems interacting with ATMs‚Äù in English, a brief <a href="https://securelist.com/files/2016/09/Descriptions_of_attacks_eng.pdf">squeeze out of</a> there - only a description of attacks and countermeasures, as well as earlier publications: <a href="https://securelist.ru/blog/issledovaniya/28631/atm-infector/">description of</a> malware Skimer and Target Attack on <a href="https://securelist.ru/blog/issledovaniya/23950/tyupkin-manipulirovanie-bankomatami-s-pomoshhyu-vredonosnogo-po/">Tyupkin</a> ATMs. <br><a name="habracut"></a><br><h3>  Do you remember how it all started </h3><br>  ATM attacks are not exactly a new topic.  The first version of the Skimer malware appeared in 2008-2009.  The attack is directed directly to ATMs: in one of the current versions (Skimer exists and is developing today) after an ATM is infected, it can be controlled by inserting a prepared card with a ‚Äúkey‚Äù on the magnetic stripe into the ATM. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/hOcFy02c7x0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i>His blessing!</i> <br><br>  In accordance with its name, Skimer can activate data collection from cards inserted into an ATM, but it can also be used to directly steal cash - the corresponding command is provided in the control menu.  Skimer is embedded in the legitimate SpiService.exe process, as a result of which it gets full access to <a href="https://en.wikipedia.org/wiki/CEN/XFS">XFS</a> - a universal client-server architecture for financial applications for Windows-based systems. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8b2/4de/7fe/8b24de7fea4802324af341ae2de61edb.jpg"></div><br><br>  Unlike Skimer, the Tyupkin attack, which was investigated at the Lab in 2014, does not use prepared maps.  Instead, it is possible to activate the malicious code at a certain time of the day, and even at this time, control of the ATM can be intercepted only after entering a dynamic authorization code.  The consequences of a successful attack, however, are about the same: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/QZvdPM_h2o8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h3>  Carbanak and Company </h3><br>  Actually, the most interesting in these two examples is the process of infection, which sometimes has to be restored from the recordings of surveillance cameras.  In the case of Tyupkin, the malware was installed from a CD (!), That is, there was physical access to the inside of the ATM.  This is an obvious attack vector with equally obvious flaws.  But he is not the only one. <br><br>  In the Carbanak campaign, the <a href="https://securelist.ru/blog/issledovaniya/25106/bolshoe-bankovskoe-ograblenie-apt-kampaniya-carbanak/">details of</a> which were revealed by the experts of ‚ÄúLaboratories‚Äù in February of last year, ATMs are used last of all, silently giving the cache on command from the center, without any manipulations on the spot.  The infrastructure of the victims was compromised due to which the main damage was caused, as they say, by bank transfer.  When losses are measured in hundreds of millions of dollars, cash ceases to play a significant role. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wUU8bAVgx80" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  The trend was developed this year: in February, we <a href="https://securelist.com/blog/research/73638/apt-style-bank-robberies-increase-with-metel-gcman-and-carbanak-2-0-attacks/">told</a> about three new attacks, two of which were focused on cashless theft of funds.  Only one campaign (Metel) provided for the withdrawal of funds through ATMs, but no one hacked the devices themselves.  Technically, the transaction (withdrawing money from the account) was legitimate, but after it the card balance was rolled back to its previous value.  The modern version of the indispensable penny was operated, as in the case of other attacks, at night, preferably at the weekend. <br><br><img src="https://habrastorage.org/files/ca5/8ed/ed7/ca58eded777c44a1bef4c8ba0c275c8e.png"><br><br>  Cybercriminals will attack the root infrastructure of financial organizations as long as they have such an opportunity, that is, until it becomes vulnerable.  As the <a href="https://threatpost.ru/swift-network-doubles-down-on-security/16357/">story of</a> robbery through the SWIFT interbank transfer system shows, even the critical elements of the financial infrastructure are not always properly protected (doesn‚Äôt it turn out that ATM protection is sometimes better?).  I want to believe that this is not for long.  Given that cybercrime about ATMs and does not think to forget, they claim the dubious privilege of the long-term headache of financial industry. <br><br><h3>  Which way <i>to be afraid</i> ? </h3><br>  In their analysis of future vectors of attacks on ATMs, our experts are not limited to the immediate theft of cash.  To this understandable goal, we add the theft of customer data for the subsequent removal of funds in larger volumes with less chance of being lit up on a surveillance camera.  But that's not all.  If you look closely, it will not be possible to find a place in the entire IT- ‚Äústrapping‚Äù of an ATM network that cannot be attacked. <br><br>  An interesting example is the biometric identification of customers - a relatively new technology that allows you to either replace or supplement the standard means of authorization - by PIN code, using NFC, and so on.  Theft of biometric data is theoretically possible through appropriately doped skimmers (if biometrics comes again to the rake, passed earlier with card readers), through an attack like Man-in-the-middle (when the ATM starts sending data to someone else‚Äôs processing server), or through an attack on the infrastructure of a financial institution. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8c5/4e6/bc7/8c54e6bc775e4a6e88eb8bcfbc822ddd.png"></div><br><br>  Further use of biometrics for theft of funds is still questionable, and is not described in detail.  But there is an important nuance: if cybercriminals learn to do this, we will get an analogue of the situation with cloned credit cards, but without the possibility of ‚Äúreissue‚Äù (fingerprints, voice, etc.).  Not the fact that you have to reinvent fingerprint simulators: in a separate chapter of the study, there are scenarios of attacks on PIN-pads, during which data can be intercepted, or may be replaced, with a forced deactivation of encryption.  Is it possible to implement this for a biometric sensor?  Why not. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/6b8/f84/8a5/6b8f848a55ea4200ad7aae361985f3d7.png"></div><br><br><h3>  What to do? </h3><br>  The report does not address the issue of obsolete hardware in ATMs - although this presents a certain problem from a security point of view, solutions even exist for ancient devices.  In general, an integrated approach to threat scenarios implies an equally diverse list of measures to prevent them.  At least in three areas: network, software and hardware (plus it is desirable not to forget about training for staff).  For all three, there is an obvious need for secure data transfer at all stages and verification of authenticity - otherwise situations are possible when a ‚Äúforeign‚Äù control module is simply connected to the cash dispenser.  Separately, for the program part, strict control over the launch of unauthorized code is proposed: for ATMs, unlike conventional computers, this is relatively easy to implement.  Finally, at the network level, the isolation of network segments from each other is mandatory: so that there are not enough common situations when an ATM is directly accessible from the Internet as a result of a configuration error. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ac5/eae/121/ac5eae121cf345c29d66bb0d0a7edf51.jpg"></div><br>  <i>Guess the axis according to Adobe Reader</i> <br><br>  Although some of the attack scenarios shown in the report are (for now) theoretical, together with ‚Äúpractical‚Äù they add up to an interesting picture.  Financial institutions have to deal with both specific threats (an attack on SWIFT, Carbanak - hacking with knowledge of internal processes), and commonly used ones (phishing, exploitation of vulnerabilities, configuration errors, etc.).  Add here traditional skimmers, physical hacking of ATMs, difficulties with updating software and hardware (my own proof is in the photo above).  On the one hand, all this makes one giant vulnerability.  On the other hand, there are a lot of resources for protection, even if they are financial, although expert ones.  So, in the future, the financial sector can bring us both new examples of high-profile cyber cracks and truly innovative protection models. <br><br>  <i>Disclaimer: This column is based on real events, but still reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/311622/">https://habr.com/ru/post/311622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311608/index.html">What VPS hosting really is and how to choose a reliable VPS provider</a></li>
<li><a href="../311612/index.html">Digest about clouds, network technologies and service development</a></li>
<li><a href="../311614/index.html">Linux Piter # 2 is close</a></li>
<li><a href="../311616/index.html">Browsers and app specific security mitigation. Part 2. Internet Explorer and Edge</a></li>
<li><a href="../311618/index.html">96 cores and optimization code ant search route</a></li>
<li><a href="../311626/index.html">Enable h264 video support on Firefox 49 on Windows XP</a></li>
<li><a href="../311628/index.html">The Ministry of Industry and Trade has published lists of manufacturers who will receive government subsidies for the development of electronics</a></li>
<li><a href="../311630/index.html">DBMS - Data Security</a></li>
<li><a href="../311632/index.html">How to teach students a course / diploma project or build a "tower" from the second floor</a></li>
<li><a href="../311636/index.html">Northern California court denied Oracle a petition for a new trial in a case against Google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>