<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CodingFuture + Puppet. Part III: Install Puppet Server (cfpuppetserver)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In short: 


1. cfpuppetserver - Puppet Server + PuppetDB + PostgreSQL + r10k + librarian-puppet automatic configuration module 
2. Brief Introduction...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CodingFuture + Puppet. Part III: Install Puppet Server (cfpuppetserver)</h1><div class="post__text post__text-html js-mediator-article"><h1 id="vkratce">  In short: </h1><br><blockquote><ol><li>  <strong><a href="https://forge.puppetlabs.com/codingfuture/cfpuppetserver">cfpuppetserver</a></strong> - Puppet Server + PuppetDB + PostgreSQL + r10k + librarian-puppet automatic configuration module </li><li>  Brief Introduction to Puppet </li><li>  Describes initial deployment from scratch </li></ol><br></blockquote><a name="habracut"></a><br><h2 id="tematicheskiy-cikl">  Thematic cycle: </h2><br><ul><li>  <em><a href="https://habrahabr.ru/post/277085/">Part I: network and network filter (cfnetwork + cffirehol)</a></em> </li><li>  <em><a href="https://habrahabr.ru/post/277309/">Part II: Access and Standard Environment (cfauth + cfsystem)</a></em> </li><li>  <strong><em>Part III: Install Puppet Server (cfpuppetserver)</em></strong> </li><li>  <em><a href="https://habrahabr.ru/post/279375/">Part IV: Centralized Management (cftotalcontrol)</a></em> </li><li>  <em><a href="https://habrahabr.ru/post/305108/">Part V: Databases (cfdb)</a></em> </li><li>  <em><a href="https://habrahabr.ru/post/320244/">Part VI: Topical Blacklists and Secure Knock</a></em> </li></ul><br><p>  <strong>Some lyrics.</strong>  It would seem that the whole cycle should be started with this article, but the target audience is more experienced users of the Open Source products of Puppet Labs, who are not satisfied with the separate little-integrated modules with Puppet Forge.  As with any case of the ‚Äúlibrary vs. framework‚Äù, the cost is to follow the author‚Äôs worldview of the integrated solution. </p><br><h1 id="nemnogo-o-principe-raboty-puppet">  A little bit about how Puppet works </h1><br><p>  Puppet is first and foremost a specific language for the declarative specification of the final state of the system.  For comparison, the GNU Makefile is extremely suitable, where, in addition to directly describing dependencies, there is the possibility of starting to the fullest. </p><br><p>  Abstraction Puppet is about the following ( <strong>disrupting templates - forget everything you knew about the terms in programming!</strong> ). </p><br><ul><li>  <strong>A node</strong> is a collection of configurations for a specific target system.  In fact, this is a special case of the class. </li><li>  <strong>A class</strong> is a set of declarative logic that is included in the node configuration or other classes.  The class has neither instances nor methods, but there are parameters and variables defined inside logic.  In fact, this is more a procedure that can inherit another procedure by a banal code extension and not quite a banal scope of variables. </li><li> <strong>Type (type)</strong> - but it already looks more like a classic class - it assumes instances with a name and definitely specified parameters, but nothing more.  A concrete type implementation can be written in the form of a Puppet script via <code>define</code> , which creates instances of other types or as an extension to Ruby with a flight of fancy. </li><li>  <strong>A resource</strong> is actually the named instances of the Types.  The name of each resource is unique within a specific type within a node (directory) configuration. </li><li>  <strong>Variables</strong> - well, in short, these are constants ... Up to the version of Puppet 4, with their scope, it was still worse.  Now it is adequate: for use from outside the place of definition, a fully qualified identifier is required, except for the case of class inheritance. </li></ul><br><p>  Puppet can be used for local deployment without a network and related infrastructure.  This can be used to create container images.  There is even a whole line of campaigners for abandoning the centralized server. </p><br><p>  In the ideologically correct key, the Puppet infrastructure consists of an agent ‚Äî a privileged service on the target system and a server that distributes valuable instructions in the form of declarative resource directories upon request from agents.  Security is implemented at the level of a private public key infrastructure ( <a href="https://en.wikipedia.org/wiki/X.509">X.509</a> ).  Simply put, the same mechanisms as in HTTPS, but with its own CA and mandatory verification of the client certificate. </p><br><p>  In a simplified form, the deployment procedure looks like this: </p><br><ol><li>  Processing using TLS and X.509 (establishing a connection, updating the CRL, checking certificate limits, etc.) </li><li>  The agent receives fact generators from the server with caching and all the tasks (more precisely, everything from the lib / folders in modules is pulled).  It‚Äôs easy to add your Ruby script to collect information of interest. </li><li>  The agent collects facts about the target system and sends to the server.  All facts can be easily viewed manually through <code>puppet facts</code> .  These facts are available as global variables. </li><li>  The server makes a directory of resources and sends it to the agent.  Under this lies a whole layer of different concepts. </li><li>  The agent pulls everything you need from the server and brings the system to the specified form.  The agent himself does not know how to deal with resources, he relies on the implementation of providers (the semantic translation will be the "embodiment", and not the supplier) of specific types of resources.  Some providers are standard and come in Puppet packages, while the rest are pulled out of the modules. </li></ol><br><p>  For tasting all the charms, there are additional buns in the form: </p><br><ul><li>  <strong>A module</strong> is a collection of declarative Puppet scripts, Ruby extensions for Puppet, files, file templates, Hiera data, and more.  A more correct term would be "package." </li><li>  <strong>Environment (Environment)</strong> - a set of scripts, modules and Hiera data.  With the complexity of the infrastructure, it was inevitably necessary to separate the configuration beyond the standard division by nodes.  Basically, this is required for pilot innovations and banal access control (when not all admins have access to all IT infrastructure nodes). </li><li>  <strong>Hiera</strong> is a hierarchical database.  Such a formulation can be very daunting.  This is probably why it was changed in the documentation of later versions.  In fact, it is an extremely simple and convenient mechanism for pulling a configuration out of <a href="http://yaml.org/">YAML</a> or JSON files.  The hierarchy consists in the ability to specify the order of reading a set of configuration files - i.e.  hierarchy / priority of these files. <br><ul><li>  In addition to pulling data on a function call, Puppet pulls out the class parameters by default, which is the main highlight. </li><li>  Of course, Hiera supports the interpolation of facts and even the calling of special functions. </li><li>  Puppet 4.3 implemented the same functionality again to support not only the global database, but also the local one for the Environment and the Module, although the author has already found several problems in their implementation ( <a href="https://tickets.puppetlabs.com/browse/PUP-5983">PUP-5983</a> , <a href="https://tickets.puppetlabs.com/browse/PUP-5952">PUP-5952</a> and <a href="https://tickets.puppetlabs.com/browse/PUP-5899">PUP-5899</a> ), which were Puppet Labs is instantly fixed. </li><li>  Several strategies for extracting values ‚Äã‚Äãfrom all files across the hierarchy are supported: <br><ul><li>  <code>first</code> - the first priority value is given </li><li>  <code>unique</code> - collects all values ‚Äã‚Äãinto a one-dimensional array and removes duplicates </li><li>  <code>hash</code> - unites all found YAML Hash.  Duplicate keys are selected by priority. </li><li>  <code>deep</code> - essentially a recursive version of hash </li></ul></li><li>  The beauty is that the sampling strategy can be set as when calling the <code>lookup()</code> function, since  and in any hierarchy file using the special key <a href="https://docs.puppetlabs.com/puppet/latest/reference/lookup_quick.html">lookup_options</a> , which is actively used in the <a href="https://forge.puppetlabs.com/codingfuture/cfnetwork">cfnetwork</a> module. </li></ul></li><li>  <strong>PuppetDB</strong> is essentially a business logic layer around a relational database (PostgreSQL) that allows you to save reports of facts and deployments and export resources for later import into directories on other nodes or select through special functions.  There is also a web muzzle in the form of Puppet Dashboard. </li><li>  <strong>X.509 PKI</strong> is the already mentioned certificate infrastructure, which is extremely convenient to use for other services without the need to manage a separate infrastructure. </li><li>  <strong>MCollective</strong> seems to be a useful thing for the event launch of tasks on a server farm, but the author has a certain lack of confidence in the security of a particular solution. </li><li>  <strong>Puppet Forge</strong> is an open <a href="https://forge.puppetlabs.com/">platform</a> for publishing and downloading Modules. </li><li>  some other features in the form of controlling external devices such as Cisco equipment and deployment on bare hardware, but this is another story </li></ul><br><h1 id="zametki-po-bezopasnosti-i-dostupnosti">  Security and Availability Notes </h1><br><p>  It is required to understand that Puppet Server becomes a vulnerability of the entire IT infrastructure, since  determines the final configuration of all systems.  In special cases, it makes sense to do the separation - a separate server for critical infrastructure elements with extremely limited access and manual updating, and the second for everything else. </p><br><p>  Availability Puppet Server determines the ability to manage the entire infrastructure.  It makes sense to place Puppet Server on a virtual machine in a more reliable and quickly recoverable third-party cloud than its own capabilities.  Or, you should install multiple servers. </p><br><p>  In any case, do not install other services on the system where Puppet Server with gadgets will be deployed.  Virtualization and containerization to help you. </p><br><h3 id="multi-master-neskolko-obosoblennyh-puppet-server">  Multi-master (several separate Puppet Server) </h3><br><ul><li>  In this case, only one server acts as a CA (Certificate Authority) - its inaccessibility means the impossibility to add new nodes. <br><ul><li>  Puppet allows the use of third-party X.509 infrastructure, if the built-in does not suit. </li></ul></li><li>  All configuration (Environment) should be stored in the version control system and deployed on each server simultaneously. </li><li>  The only thing in common is the PostgreSQL database, the organization of which high availability is beyond the scope of this article. </li><li>  The <a href="https://forge.puppetlabs.com/codingfuture/cfpuppetserver">cfpuppetserver</a> module supports installations as a primary (with CA) and as a secondary server. </li></ul><br><h1 id="chto-znachimoe-izmenilos-s-bolee-staryh-versiy">  What significant has changed from older versions </h1><br><p>  The <a href="https://docs.puppetlabs.com/puppet/4.0/reference/release_notes.html">manufacturer has a</a> full description. </p><br><ul><li>  All services moved to JVM, JRuby and Jetty.  Beyond the obvious advantages of integration, there are downsides to memory consumption. </li><li>  Added lambda functions for processing collections - now there is no need to cut crutches on Ruby or pervert through create_resources () </li><li>  The EPP template processing tool has appeared - essentially the same <a href="http://apidock.com/ruby/ERB">ERB</a> , but with Puppet DSL instead of Ruby, </li><li>  The default configuration file directory structure has changed greatly. </li><li>  Data Providers support has appeared for Environments and Modules (hacks are no longer required). </li><li>  Diminishing the role of the global Hiera.  A new associated command is the <code>puppet lookup</code> . </li></ul><br><h1 id="ustanovka">  Installation </h1><br><p>  This process is quite primitive, but requires adherence to a certain sequence of steps.  Since doing it manually is a thankless task, the author will teach the bad, namely, download incomprehensible scripts from the Internet and run as root on his system. </p><br><p>  The three main components of the server are Puppet Server, PuppetDB and PostgreSQL itself.  They can all be pushed into one node or split into two or three systems.  Puppet Server and Puppet DB can be run multiple times, but PostgeSQL is a single point of failure.  There are various approaches to replication and clustering of PostgeSQL. A convenient approach in the case of primary and secondary servers will be Master + Read-Only Slave, which is supported in PuppetDB itself as the main and read-only database node, but automating this configuration takes time and therefore has not yet Included in the <code>cfpuppetserver</code> module. </p><br><p>  Directly, the configuration can be simply stored at least on the file system along with Puppet Server, but this is how to write scripts on the combat web server.  The best solution is the git repository.  The <a href="https://github.com/puppetlabs/r10k">r10k</a> utility can pull out all the branches of the repository and deploy them to the Puppet Server as separate Environments.  <code>r10k</code> is <a href="https://tickets.puppetlabs.com/browse/RK-3">bad</a> enough with dependency pulling, so <a href="http://www.rubydoc.info/gems/librarian-puppet">librarian-puppet is</a> used on top.  It is worth noting immediately that the main canonical environment of Puppet is "production".  Therefore, in the configuration repository, you should use a branch called "production" and not "master". </p><br><h2 id="sistemnye-trebovaniya">  System requirements </h2><br><p>  For iron <a href="https://docs.puppetlabs.com/puppet/latest/reference/system_requirements.html">described by the manufacturer</a> .  The <code>cfpuppetserver</code> module <code>cfpuppetserver</code> only supports Debian Jessie + and Ubuntu Trusty +. </p><br><h2 id="konfiguraciya-v-git">  Configuration in git </h2><br><p>  For the r10k itself, the placement of the repository does not really matter - the main thing is its availability.  For example, for testing purposes, the repository can be placed on the same system with access via <code>file://</code> .  A good start would be an example of the <a href="https://github.com/codingfuture/puppet-exampleenv">codingfuture / puppet-exampleenv configuration</a> . </p><br><ol><li>  <code>git clone https://github.com/codingfuture/puppet-exampleenv my-puppet-conf &amp;&amp; cd my-puppet-conf</code> repository: <code>git clone https://github.com/codingfuture/puppet-exampleenv my-puppet-conf &amp;&amp; cd my-puppet-conf</code> </li><li>  Set the general admin access settings, using the hints in the comments: <br><ul><li> <code>$EDITOR data/common.yaml</code> </li> </ul></li><li>  Create a node configuration: <br><ul><li>  <code>$MY_DOMAIN</code> - root domain name (for example, example.org) </li><li>  <code>$HOST_NAME</code> - the name of the client node without a domain </li><li> <code>mkdir data/$MY_DOMAIN</code> </li> <li> <code>cp data/example.com/puppet.yaml data/${MY_DOMAIN}/puppet.yaml</code> </li> <li>  <code>$EDITOR nano -w data/${MY_DOMAIN}/puppet.yaml</code> - setting up a node with Puppet Server according to the prompts in the comments </li><li> <code>cp data/example.com/host.yaml data/${MY_DOMAIN}/${HOST_NAME}.yaml</code> </li> <li>  <code>$EDITOR nano -w data/${MY_DOMAIN}/${HOST_NAME}.yaml</code> - setting up an arbitrary node using the prompts in the comments </li></ul></li><li>  We push on own Git the server or we make available locally on a node with Puppet Server through rsync or scp.  The local repository is convenient as an intermediate step until the Git server is deployed from the Puppet itself.  In a sense, it resembles a compiler build in several steps. </li></ol><br><h2 id="stavim-s-nulya-na-chistoy-sisteme">  We put from scratch on a clean system </h2><br><p>  The <code>cfpuppetserver</code> module allows <code>cfpuppetserver</code> to install everything using the Puppet tool itself, but for the initial installation, the basic operations are duplicated by the Bash script. </p><br><p>  On the target system: </p><br><ol><li>  Download the installation script: <code>wget https://raw.githubusercontent.com/codingfuture/puppet-cfpuppetserver/master/setup_puppetserver.sh</code> </li><li>  Check the script and frown: <code>less setup_puppetserver.sh</code> </li><li>  Run: <code>bash setup_puppetserver.sh &lt;repo_uri&gt; puppet.${MY_DOMAIN}</code> . <br><ul><li>  Example with remote repository: <code>bash setup_puppetserver.sh ssh://git@git.example.com/puppet-conf</code> </li><li>  Example with local: <code>bash setup_puppetserver.sh file:///root/puppetconf/</code> </li></ul></li><li>  We look how the system puffs up and does not install everything very quickly. </li><li>  If remote repository: <br><ul><li>  Create a ssh key at root: <code>ssh-keygen -t rsa -b 2048</code> </li><li>  We register the public key <code>/root/.ssh/id_rsa.pub</code> on a remote Git server ... </li><li>  ... and in the same place we configure Git hook with a call of the following command: <code>/usr/bin/ssh -T deploypuppet@puppet.${MY_DOMAIN} ./puppetdeploy.sh</code> </li></ul></li><li>  Run the manual configuration deployment: <code>/etc/puppetlabs/deploy.sh</code> </li><li>  Trying how it works on the server itself: <code>/opt/puppetlabs/bin/puppet agent --test</code> </li><li>  Check network settings, network filter and SSH access </li></ol><br><h2 id="dobavlyaem-upravlyaemye-uzly">  Add managed nodes </h2><br><ol><li>  The full name of the Puppet Server should be accessible via DNS on the managed host or should be ‚Äúsewn up‚Äù in / etc / hosts. <br><ul><li>  Example: <code>echo "128.1.1.1 puppet.example.com" &gt;&gt; /etc/hosts</code> </li></ul></li><li>  On the node with Puppet Server, run the following script <code>/opt/codingfuture/bin/cf_gen_puppet_client_init ${HOST_NAME}.${MY_DOMAIN}</code> . </li><li>  The result is copied entirely and pasted into the command line on the target system. </li><li>  We are waiting for the execution to finish and run <code>/opt/puppetlabs/bin/puppet agent --test</code> .  When you first start, a certificate signing request will be generated. </li><li>  Go to the Puppet Server node to sign the certificate. <br><ul><li>  <code>puppet cert list</code> - we verify the signature of the certificate for greater paranoia. </li><li>  <code>puppet cert sign ${HOST_NAME}.${MY_DOMAIN}</code> - in fact, we sign the certificate. </li></ul></li><li>  Go back to the managed node and run: / opt / puppetlabs / bin / puppet agent - test` again.  This will force the deployment procedure. </li><li>  We are waiting until the end of the deployment via Puppet Agent. </li><li>  Everything, you have a minimal Puppet infrastructure ready! </li></ol><br><div class="spoiler">  <b class="spoiler_title">Sample output / opt / codingfuture / bin / cf_gen_puppet_client_init</b> <div class="spoiler_text"><pre> <code class="bash hljs">bash &lt;&lt;EOT <span class="hljs-comment"><span class="hljs-comment">#!/bin/bash http_proxy= if test "\$(id -un)" != 'root'; then echo 'This script must run as root' exit 1 fi if test ! -z ""; then echo -n &gt;/etc/cflocation fi if test ! -z ""; then echo -n &gt;/etc/cflocationpool fi if test ! -z "\$http_proxy"; then export http_proxy export https_proxy="\$http_proxy" export HTTP_PROXY="\$http_proxy" export HTTPS_PROXY="\$http_proxy" fi echo host.example.com &gt; /etc/hostname hostname host.example.com if ! which lsb-release | read; then apt-get install lsb-release fi codename=\$(lsb_release -cs) if test -z "\$codename"; then echo "Failed to detect correct codename" exit 1 fi wget https://apt.puppetlabs.com/puppetlabs-release-pc1-\${codename}.deb dpkg -i puppetlabs-release-pc1-\${codename}.deb mkdir -p /etc/puppetlabs/puppet cat &gt; /etc/puppetlabs/puppet/puppet.conf &lt;&lt;EOF [main] certname = host.example.com server = puppet.example.com ca_server = puppet.example.com environment = production EOF apt-get update &amp;&amp; apt-get install puppet-agent while ! /opt/puppetlabs/bin/puppet agent --test --wairforcert 120; do echo "Please go to puppetserver and exec the following command when we wait for key" echo "&gt; puppet cert sign host.example.com" echo "Use CTRL+C to stop cycle, if fails due to different reasons" sleep 5 done EOT</span></span></code> </pre> </div></div><br><h1 id="opisanie-modulya">  Module Description </h1><br><h2 id="polnyy-spisok-parametrov-bash-skripta-iznachalnoy-ustanovki">  Full list of Bash parameters of the initial installation script </h2><br><pre> <code class="hljs objectivec">~<span class="hljs-meta"><span class="hljs-meta"># ./setup_puppetserver.sh Usage: ./setup_puppetserver.sh </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;r10k_repo_url&gt;</span></span></span><span class="hljs-meta"> [</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;certname=hostname&gt;</span></span></span><span class="hljs-meta"> [</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;cflocation&gt;</span></span></span><span class="hljs-meta"> [</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;cflocationpool&gt;</span></span></span><span class="hljs-meta"> [</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;http_proxy&gt;</span></span></span><span class="hljs-meta">] ] ] ]</span></span></code> </pre> <br><ul><li>  <code>r10k_repo_url</code> - Git URI repository </li><li>  <code>certname</code> - FQDN of the node </li><li>  <code>cflocation</code> - initialization of the fact cf_location </li><li>  <code>cflocationpool</code> - initialize the cf_location_pool fact </li><li>  <code>http_proxy</code> - proxy server for HTTP and HTTPS requests </li></ul><br><h2 id="polnyy-spisok-parametrov-bash-skripta-inicializacii-klienta-puppet">  Full list of Bash parameters for the Puppet Client Initialization Script </h2><br><pre> <code class="hljs objectivec">~<span class="hljs-meta"><span class="hljs-meta"># /opt/codingfuture/bin/cf_gen_puppet_client_init Usage: cf_gen_puppet_client_init </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;certname&gt;</span></span></span><span class="hljs-meta"> [</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;cflocation&gt;</span></span></span><span class="hljs-meta"> [</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;cflocationpool&gt;</span></span></span><span class="hljs-meta"> [</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;http_proxy&gt;</span></span></span><span class="hljs-meta">]]]</span></span></code> </pre> <br><p>  The value of the parameters is the same as in the previous script. </p><br><h2 id="klass-cfpuppetserver">  <code>cfpuppetserver</code> class </h2><br><ul><li>  <code>deployuser = 'deploypuppet'</code> - username for automatic deployment of configuration updates </li><li>  <code>deployuser_auth_keys = undef</code> - list of keys for $ deployuser </li><li>  <code>repo_url = undef</code> - repository URI (example: ssh: // user @ host / repo or file: /// some / path) </li><li>  <code>puppetserver = true</code> - whether to install the Puppet Server component on this node </li><li>  <code>puppetdb = true</code> - whether to install the PuppetDB component on this node </li><li>  <code>puppetdb_port = 8081</code> - port for PuppetDB </li><li>  <code>setup_postgresql = true</code> - whether to install the PostgreSQL component on this node (only if the PuppetDB installation is enabled) </li><li>  <code>service_face = 'any'</code> - the name of the <code>cfnetwork::iface</code> for accepting incoming connections </li><li>  <code>puppetserver_mem = auto</code> - RAM under Puppet Server in megabytes (minimum 192MB) </li><li>  <code>puppetdb_mem = auto</code> - RAM under PuppetDB in megabytes (minimum 192MB) </li><li>  <code>postgresql_mem = auto</code> - RAM under PostgreSQL in megabytes (at least 128MB) </li></ul><br><h2 id="klass-cfpuppetserverpuppetdb">  class <code>cfpuppetserver::puppetdb</code> </h2><br><ul><li>  <code>postgresql_host = 'localhost'</code> - database address </li><li>  <code>postgresql_listen = $postgresql_host</code> - the value goes directly to PostgreSQL <code>listen_addresses</code> </li><li>  <code>postgresql_port = 5432</code> - database port </li><li>  <code>postgresql_user = 'puppetdb'</code> - PuppetDB user in database </li><li>  <code>postgresql_pass = 'puppetdb'</code> is the password of the PuppetDB user in the database </li><li>  <code>postgresql_ssl = false</code> - enable connection encryption based on Puppet PKI certificates </li></ul><br><h2 id="klass-cfpuppetserverpuppetserver">  class <code>cfpuppetserver::puppetserver</code> </h2><br><ul><li>  <code>autosign = false</code> - DO NOT use in a combat environment, except in the DMZ.  There is only to automate testing. </li><li>  <code>global_hiera_config = 'cfpuppetserver/hiera.yaml'</code> - the path to the default Hiera configuration file according to the canons of Puppet (the first component is the module name, the rest is the path under the <code>files/</code> folder in the module) </li></ul><br><p>  <strong>UPD 2016-03-12</strong> <br>  Updated the name of the client initialization generation script (cf_gen_puppet_client_init). </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/278163/">https://habr.com/ru/post/278163/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278129/index.html">Azure Backup Server - free DPM</a></li>
<li><a href="../278137/index.html">PHP Digest number 80 - interesting news, materials and tools (February 14 - 28, 2016)</a></li>
<li><a href="../278151/index.html">Pathfinding: A simple implementation of a funnel algorithm (Funnel Algorithm)</a></li>
<li><a href="../278153/index.html">Part 1. Installing and Configuring a Reputable DNS Server Based on the PowerDNS Solution // Basic Installation</a></li>
<li><a href="../278159/index.html">Debian's RISC under QEMU</a></li>
<li><a href="../278165/index.html">Best practices Richard Siddeway Powershell in depth</a></li>
<li><a href="../278167/index.html">HTTP / 2: getting ready for the transition</a></li>
<li><a href="../278169/index.html">How to shoot yourself in Kotlin</a></li>
<li><a href="../278171/index.html">Simple checksum calculation</a></li>
<li><a href="../278173/index.html">ASP.NET Core + Docker: Cooking Together</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>