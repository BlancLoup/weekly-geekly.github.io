<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Exceptions and myths about them</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is not the first time that I encounter an inflexible attitude to raising exceptions. It is to raise, because to intercept the majority of the opi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Exceptions and myths about them</h1><div class="post__text post__text-html js-mediator-article">  This is not the first time that I encounter an inflexible attitude to raising exceptions.  It is to raise, because to intercept the majority of the opinion is the same: intercept only when you can actually handle.  Raising is perceived as something exceptional, out of the ordinary.  When they see a throw, they start telling a bunch of stories about how ... <br><a name="habracut"></a><br>  Remember how to deal with fear?  Catch one minute during which you give free rein to all your emotions.  Then you say ‚Äúenough‚Äù and plunge into problems with your head.  A minute has passed. <br><br>  First, let's find out what kind of animal it is.  I highlight the following properties: <br><ul><li>  impossible to ignore the offensive; </li><li>  several handlers in one place; </li><li>  leakage through any number of nested calls; </li><li>  independent, passed to the handler, data structure - remember the hresult, the call macros of com-functions and other rubbish, due to its existence to the absence (or unwillingness to use) of exception mechanisms </li></ul><br>  And that's all.  All sorts of losses in performance, the complexity of control are context-sensitive (or more often simply contrived) and require proof in each particular case. <br><br>  For example: search the file. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>int FindSymbol(TextReader reader, char symb) <br> { <br> char cur; <br> int pos; <br> while (cur = (char)reader.Read()) <br> { <br> if (cur == 'a') <br> throw new FormatException(); <br> pos ++; <br> if (cur == symb) <br> return pos; <br> } <br> throw new MyException(); } <br> }</code> <br> <br><br>  The following options for exiting the function are defined: <br><ul><li>  required data found (return pos) </li><li>  the file has a wrong format (throw) </li><li>  file ended (reader raises an exception) </li></ul><br>  The last version of the function is the most controversial.  Usually, programmers are very resourceful in justifying their decisions, and may find a bunch of pros and cons: inefficiency, the client code needs to know the implementation details, the wrong format is an error, etc.  All this is true, but not the main thing.  The main argument for is sufficiency. <br><br>  The client no longer needs to analyze a complex result, he asked to find the text - they found him;  if not, he won't even know about it. <br><br>  Another example: the user clicks the cancel button.  Again, you can discuss the topic for a long time - why was this mechanism originally created? <br><br>  But if it is and is suitable for the logic of "cancel" - it is silly not to use it. <br>  When I needed to glue the sills at home, without thinking twice, I used the book ‚ÄúWpf ...‚Äù by M.Mac-Donald as a cargo.  So why in other cases do I do otherwise? <br><br>  How do you feel about small features?  I now believe that others simply do not have the right to exist.  With such an attitude, there are occasional situations that without raising exceptions, they simply go nowhere.  For example, you need to exit the loop located above the call stack.  Do not pass the same flag to complete in the end.  Or pass ... <br>  If the cycle is not located at the previous level of the call stack, but above?  All code without a throw turns into an analysis of the results of the functions.  Comes to the ridiculous - methods checking the results of the work of other functions are highlighted.  You sit and think about rolling back unexpectedly ‚Äúincorrect‚Äù refactoring.  But everything changes when they come: the code starts to be deleted two or three lines at a time (and if I slowed down <br>  long enough, both methods and classes are deleted) <br><br>  And here is another interesting ‚Äúflavor‚Äù - a large number of conditional operators.  When the analysis begins before performing any action, ‚Äúis it possible to do it‚Äù.  Let us leave alone algorithms consisting of several operations that separately make the state of the system uncertain.  If you started to do - break into a cake, but finish!  I'm not talking about them.  Although here, if desired, you can find acceptable solutions.  So, the smell of a larger number of conditional operators: well, for example, when analyzing the set of input data before performing the operation or checking the validity of the data structure, or ... well, you never know what else.  In general, we look at each data element and decide whether it is suitable for our great goals, and then we carry them out.  Is not it stupid?  You can immediately try to implement our plans.  And all that is necessary is to assume that an exception may occur at this site, due to our unwillingness to clutter up the code with garbage. <br><br>  The main argument of opponents of this attitude to raising exceptions is a performance slump.  It is silly to argue with this - the conditional operator is several times more efficient.  But there is one ‚Äúbut‚Äù: the problem must be proved on real data.  Suppose a piece of code is really critical.  Oh God!  - now you have to spend a couple of hours refactoring.  Not days, but hours.  Remember how Fowler spoke about his attitude to design: ‚Äú... I'm trying to determine how difficult it will be to refactor from one design to another.  If the difficulties are not visible, then I, without thinking too much about the choice, stop at the simplest. ‚Äù <br><br>  If we assume that we accept this bold idea, then it remains to determine the order of refactoring: <br><ol><li>  Select the method from the body of the method raising the exception. </li><li>  We define the criterion in the signature of the selected method, which will show that in a different situation we would raise an exception. </li><li>  We modify the original method so that, depending on the criterion, it raises an exception.  We will call the original method "method with an exception", and selected - "method without exception." </li><li>  Create an extension method (copy) from a method without exception. </li><li>  Replace the body of the extension method with the method call with the exception. </li><li>  We block the propagation of an exception through the extension method and, depending on the ascent, we recharge or reset the criterion. </li><li>  Add a method to the interface with the method signature without exception.  In implementations of these methods, we call the extension method.  If the method is not part of the external interface (with respect to the class), so much the better.  This item can be skipped. </li><li>  We replace method calls with exceptions with methods without exception.  In interface implementations, this is mandatory (otherwise it should not have begun), in other cases, if desired.  The replacement code should look like this: call the method without exception, analysis of the criterion. </li><li>  Create an extension method from a method with an exception.  Its structure should already be true.  It remains only to make it work. </li><li>  Replace the remaining callbacks with exceptions with extensions without exception. </li><li>  Remove from the interface methods with exceptions and extensions without exception.  Extensions with exceptions if possible. </li></ol><br><br>  Here is how it will look in the code. <br><ul><li>  Source: <br> <code>class SrcClass <br> { <br> public void Exec() <br> { <br> throw new MyException(); <br> } <br> }</code> </li> <li>  After the third step: <br> <code>class SrcClass <br> { <br> public void Exec() <br> { <br> if (!TryExec()) <br> throw new MyException(); <br> } <br> public bool TryExec() <br> { <br> return false; <br> } <br> }</code> </li> <li>  After the ninth step: <br> <code>class SrcClass <br> { <br> public void Exec() <br> { <br> if (!TryExec()) <br> throw new MyException(); <br> } <br> public bool TryExec() <br> { <br> return false; <br> } <br> } <br> <br> static class SrcClassHelper <br> { <br> public static bool TryExecHelp(this SrcClass src) <br> { <br> try <br> { <br> src.Exec(); <br> return true; <br> } <br> catch (MyException) <br> { <br> return false; <br> } <br> } <br> public static void Exec(this SrcClass src) <br> { <br> if (!src.TryExec()) <br> throw new MyException(); <br> } <br> }</code> </li> <li>  Finishing: <br> <code>class SrcClass <br> { <br> public bool TryExec() <br> { <br> return false; <br> } <br> } <br> <br> static class SrcClassHelper <br> { <br> public static void Exec(this SrcClass src) <br> { <br> if (!src.TryExec()) <br> throw new MyException(); <br> } <br> }</code> </li> </ul><br><br>  In principle, everything.  I hope I managed to dispel at least some of the fears about raising the exceptions, and now when such a need arises you will be more loyal to choose a solution.  And most likely, choose a simpler one.  So, your receiver will scold you with less frenzy (it‚Äôs possible that I‚Äôll be one). <br></div><p>Source: <a href="https://habr.com/ru/post/119016/">https://habr.com/ru/post/119016/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../119008/index.html">Offline way to store password</a></li>
<li><a href="../119009/index.html">Optimize PNG and JPEG without losing quality. Part 1</a></li>
<li><a href="../119010/index.html">Schedule of articles on Habr√© (for any week)</a></li>
<li><a href="../119011/index.html">Apache 2 under supervision. Monitoring the system load web server</a></li>
<li><a href="../119013/index.html">Project refactoring in SVN using ANT</a></li>
<li><a href="../119017/index.html">And once again about the responsibility</a></li>
<li><a href="../119019/index.html">Notepad service Springpad is now offline</a></li>
<li><a href="../119020/index.html">We distribute free invitations to the presentation of the flagship smartphone Samsung Galaxy S II</a></li>
<li><a href="../119022/index.html">Google I / O 2011: Android Honeycomb 3.1, Ice Cream Sandwich and other SHOCKING news</a></li>
<li><a href="../119023/index.html">Notes on ProgressDialog or how to correctly show progress</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>