<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Recursive Functions - Creating Your Own Mathematics (Scala)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, Habr! 

 With such a claim heading, I want to start an article about one of the many models of calculus (Computational model) - recurs...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Recursive Functions - Creating Your Own Mathematics (Scala)</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, Habr! <br><br>  With such a claim heading, I want to start an article about one of the many models of calculus (Computational model) - <a href="http://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B0%25D1%2581%25D1%2582%25D0%25B8%25D1%2587%25D0%25BD%25D0%25BE_%25D1%2580%25D0%25B5%25D0%25BA%25D1%2583%25D1%2580%25D1%2581%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2584%25D1%2583%25D0%25BD%25D0%25BA%25D1%2586%25D0%25B8%25D1%258F">recursive functions</a> .  In the first part of this post we will examine (in brief, for everything is painted on Wikipedia) the theoretical component of this model (primitive recursion), in the second half we will try to implement this model into life (partially) using the Scala language. <br><br><h4>  1. Recursive functions - what is it? </h4><br><a name="habracut"></a><br>  Everyone knows the phrase "Turing Machine" - a model of calculus, created by the British mathematician, logician, cryptographer and just a good man, <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D1%258C%25D1%258E%25D1%2580%25D0%25B8%25D0%25BD%25D0%25B3,_%25D0%2590%25D0%25BB%25D0%25B0%25D0%25BD">Alan Turing</a> .  This model is one of the most famous and popular models of calculus among <a href="http://en.wikipedia.org/wiki/Computability">many</a> .  However, more recently, other models have begun to be popularized, such as lyabmda-calculus and mu-recursion. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And yet, what is a recursive function? <br>  Imagine that you have an abstract computer in front of you that does not know (for the time being) such operations as addition of two numbers, subtraction, differentiation and integration.  How to work with such a machine?  How to teach her to count? <br>  To begin with, let's define the basic functionality that this machine should have: <br><ul><li>  A set of basic mathematical functions: <br><br>  - Zero (x) = 0: for each given argument x, the function returns 0 <br><br>  - Succ (x) = x + 1: for each x, the function returns x + 1 <br><br>  - Family of projection functions <img src="https://habrastorage.org/getpro/habr/post_images/5db/df5/d50/5dbdf5d5056dfac1317121bb82579fe5.png" alt="image">  where <img src="https://habrastorage.org/getpro/habr/post_images/882/76a/ba8/88276aba84acb93be6fe8e4c24b7eaec.png" alt="image">  : for any n arguments, returns the one that takes the m position. <br></li><li>  A set of operations that we can apply to these functions: <br><br>  - Composition of functions (superposition): (f ‚Ä¢ g) (x) = f (g (x)); <br><br>  - Primitive recursion: Suppose there is a function f (x1, x2, ..., xn) of n variables, and a function g (X1, X2, ..., Xn, Xn + 1, Xn + 2) of n + 2 variables .  Then we can set the function h (X1, X2, .... Xn, Xn + 1) in n + 1 variables: <br><br>  h (X1, X2, ..., Xn, 0) = f (X1, X2, ..., Xn); <br>  h (X1, X2, ..., Xn, i + 1) = g (X1, X2, ..., Xn, i, h (X1, X2, ..., Xn, i)); <br></li></ul><br><br>  That's all that our abstract computer can do.  The main thing in this list, you guessed it, is a primitive recursion.  To make it clearer, we set ourselves the task, for example, to implement the addition function of two numbers a and b: <br><br>  Sum (a, b): <br>  Sum (a, 0) = I (a); <br>  Sum (a, i + 1) = Succ (F (a, i, Sum (a, i))) where F is the projection of the third argument, that is, in this case, F returns Sum (a, i); <br><br>  Everything!  Now we can add two numbers and we are very happy about it. <br>  By the way, maybe someone had a question, why is it so difficult to paint Sum (a, i + 1), and why not just write Sum (a, i + 1) = Succ (Sum (a, i)).  The answer is: by definition, the recursive function should have as arguments all arguments (except for iterative) of the desired function (in our case, it is a), also an iterative argument reduced by one (in our case, i), and the recursive call Sum itself (a i).  This is done for the ability to work with non-primitive recursion (the iteration goes on two or more arguments). <br><br>  As you understand, in the same way we can create a function of deceleration, degree, etc.  All these examples are very well written on Wikipedia, and we will implement them in the second part of the article.  In any case, we can already define an infinite set of primitive-recursive functions: <br><br>  F = {f0, f1, f2, f3, ...} is an infinite countable set of functions defined as follows: <br><br>  f0 (0, y) = Succ (y); <br>  f [n + 1] (x, y): f [n + 1] (0, y) = y;  f [n + 1] (i + 1, y) = fn (y, f [n + 1] (i, y)); <br><br>  This is primitive recursion. <br>  I will not dive deeper and tell what a <a href="http://en.wikipedia.org/wiki/%25CE%259C-recursive_function">Œº-recursive function is</a> , everything is very nicely written on Wikipedia, especially since we have enough primitive recursion to start implementing our own ... mathematics! <br><br><h4>  2. Primitive recursion on Scala </h4><br><br>  To begin with, we need to define what is a number?  Create the abstract class MyNumber: <br><pre><code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyNumber</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isNatural: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isNeg: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isZero: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isInf: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">+</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">-</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">*</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">/</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">^</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">&lt;</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">&gt;</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">==</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">neg</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">abs</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pre</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">suc</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> num: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> denum: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gcd</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span></span>(): <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toInteger</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(isNatural) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.asInstanceOf[<span class="hljs-type"><span class="hljs-type">MyInteger</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> (num / denum).asInstanceOf[<span class="hljs-type"><span class="hljs-type">MyInteger</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toFraction</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">Fraction</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(isNatural) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Fraction</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toInteger) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.asInstanceOf[<span class="hljs-type"><span class="hljs-type">Fraction</span></span>] }</code> </pre> <br><br>  As you can see, we will have two child classes, Fraction and MyInteger: <br><pre> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyInteger</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyNumber</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isNatural = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isNeg: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isZero: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isInf: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">+</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b.isNatural) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> plusInt b.toInteger <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> plusFrac b.toFraction <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plusInt</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plusFrac</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">Fraction</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toFraction + b <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">-</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b.isNatural) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> minusInt b.toInteger <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> minusFrac b.toFraction <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minusInt</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minusFrac</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">Fraction</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toFraction - b <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">*</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b.isNatural) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> multInt b.toInteger <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> multFrac b.toFraction <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">multInt</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">multFrac</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">Fraction</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toFraction * b <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">/</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b.isNatural) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> divInt b.toInteger <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> divFrac b.toFraction <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">divInt</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">divFrac</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">Fraction</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toFraction / b <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">^</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b.isNatural) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> powInt b.toInteger <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> powFrac b.toFraction <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">powInt</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">powFrac</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">Fraction</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-comment"><span class="hljs-comment">//TODO def &lt;(b: MyNumber): Boolean = if (b.isNatural) this lessThanInt b.toInteger else this lessThanFrac b.toFraction protected def lessThanInt(b: MyInteger): Boolean private def lessThanFrac(b: Fraction): Boolean = this.toFraction &lt; b def &gt;(b: MyNumber): Boolean = if (b.isNatural) this biggerThanInt b.toInteger else this biggerThanFrac b.toFraction protected def biggerThanInt(b: MyInteger): Boolean private def biggerThanFrac(b: Fraction): Boolean = this.toFraction &gt; b def ==(b: MyNumber): Boolean = if (b.isNatural) this equalsInt b.toInteger else this equalsFrac b.toFraction protected def equalsInt(b: MyInteger): Boolean private def equalsFrac(b: Fraction): Boolean = this.toFraction == b def pre: MyInteger def suc: MyInteger val num: MyInteger = null val denum: MyInteger = null def neg: MyNumber def abs: MyNumber = if (!isNeg || isZero) this else this neg def gcd(b: MyNumber): MyNumber = if (b.isNatural) this gcdPrivate b.abs.toInteger else (new Zero).pre private def gcdPrivate(b: MyNumber): MyNumber = { def iter(a: MyNumber, b: MyNumber): MyNumber = { if (b == (new Zero)) a else iter(b, a.toInteger mod b.toInteger) } iter(this, b) } def mod(b: MyInteger): MyNumber = { def iter(a: MyNumber, b: MyNumber): MyNumber = { if (b.isNeg) this mod b.abs.toInteger else if (!b.isNatural) (new Zero).pre else if (a &lt; b) if (a.isNeg) a + b else a else iter(if (a.isNeg) a + b else a - b, b) } iter(this, b) } override def toString: String = { def iter(nb: MyInteger, accu: Int): Int = { if (nb isZero) accu else if (nb isNeg) iter(nb.suc.toInteger, accu - 1) else iter(nb.pre.toInteger, accu + 1) } if(this.isInf) "Inf" else iter(this, 0).toString() } }</span></span></code> </pre> <br><br>  To define Integer, we need the concept of the following number (Suc), previous (Pre), zero (Zero) and infinity (PosInf): <br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class"> extends </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> { val isZero = true val isNeg = false val isInf = false protected def plusInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = b protected def minusInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = b neg protected def multInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = this protected def divInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PosInf</span></span></span><span class="hljs-class"> else if(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isInf</span></span></span><span class="hljs-class">) new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class"> else this protected def powInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = this.suc protected def powFrac(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fraction</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = this.suc protected def lessThanInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = !b.isNeg &amp;&amp; !b.isZero protected def biggerThanInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = b.isNeg &amp;&amp; !b.isZero protected def equalsInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = b.isZero def pre: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> = new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pre</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">) def suc: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> = new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Suc</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">) def neg = this } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PosInf</span></span></span><span class="hljs-class"> extends </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> { val isZero = false val isNeg = false val isInf = true protected def plusInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = this protected def minusInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = this protected def multInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = this protected def divInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = this protected def powInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = this protected def powFrac(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fraction</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = this protected def lessThanInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = false protected def biggerThanInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = true protected def equalsInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = b.isInf def pre: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> = this def suc: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> = this def neg = this } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pre</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nb</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">) extends </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> { val isZero = false val isNeg = true val isInf = false protected def plusInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class">) this - (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">neg</span></span></span><span class="hljs-class">) else if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) accu else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suc</span></span></span><span class="hljs-class">) } iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">) } protected def minusInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class">) (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> + (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">neg</span></span></span><span class="hljs-class">)) else if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) accu else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">) } iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">) } protected def multInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">neg</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">).neg } protected def divInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PosInf</span></span></span><span class="hljs-class"> else if(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isInf</span></span></span><span class="hljs-class">) new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class"> else if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class">) this.abs / b.abs else (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">abs</span></span></span><span class="hljs-class"> / </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">).neg protected def powInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = if(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">!=</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">)(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">neg</span></span></span><span class="hljs-class"> ^ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">).neg else (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">).suc protected def powFrac(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fraction</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">).pre //</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TODO</span></span></span><span class="hljs-class"> protected def lessThanInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = a.isZero || b.isZero match { case true =&gt; !(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) &amp;&amp; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) case false =&gt; iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suc</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suc</span></span></span><span class="hljs-class">) } if (!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class"> || </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) true else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) } protected def biggerThanInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = a.isZero || b.isZero match { case true =&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) &amp;&amp; !(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) case false =&gt; iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suc</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suc</span></span></span><span class="hljs-class">) } if (!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class"> || </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) false else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) } protected def equalsInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = !(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> &lt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) &amp;&amp; !(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> &gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) def pre: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> = new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pre</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">) def suc: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> = nb def neg = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nb</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> = { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nb</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) accu else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nb</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suc</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suc</span></span></span><span class="hljs-class">) } iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">) } } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Suc</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nb</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">) extends </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> { val isZero = false val isNeg = false val isInf = false protected def plusInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class">) this - (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">neg</span></span></span><span class="hljs-class">) else if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) accu else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suc</span></span></span><span class="hljs-class">) } iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) } protected def minusInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class">) this + (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">neg</span></span></span><span class="hljs-class">) else if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) accu else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">) } iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">) } protected def multInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) accu else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">) } if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class"> else { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> &lt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class">) iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">neg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">toInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">).neg else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">) } else { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class">) iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">neg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">toInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">).neg else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">) } } } protected def divInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">count</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) count else if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class">) count.pre else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> - </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">count</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">suc</span></span></span><span class="hljs-class">) } if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PosInf</span></span></span><span class="hljs-class"> else if(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isInf</span></span></span><span class="hljs-class">) new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class"> else if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class">) iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">abs</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">).neg else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">) } protected def powInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) accu else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">) } if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">).suc else { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class">) new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fraction</span></span></span><span class="hljs-class">((</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">).suc, iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">neg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">toInteger</span></span></span><span class="hljs-class">, (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">).suc).toInteger) else new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fraction</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">iter</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">).suc).toInteger) } } protected def powFrac(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fraction</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyNumber</span></span></span><span class="hljs-class"> = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">).pre //</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TODO</span></span></span><span class="hljs-class"> protected def lessThanInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = a.isZero || b.isZero match { case true =&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) &amp;&amp; !(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) case false =&gt; iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">) } if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class"> || </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) false else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) } protected def biggerThanInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = a.isZero || b.isZero match { case true =&gt; !(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) &amp;&amp; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) case false =&gt; iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">) } if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNeg</span></span></span><span class="hljs-class"> || </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) true else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) } protected def equalsInt(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = !(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> &lt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) &amp;&amp; !(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> &gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) def pre: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> = nb def suc: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> = new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Suc</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">) def neg = { def iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nb</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MyInteger</span></span></span><span class="hljs-class"> = { if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nb</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isZero</span></span></span><span class="hljs-class">) accu else iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nb</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accu</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pre</span></span></span><span class="hljs-class">) } iter(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Zero</span></span></span><span class="hljs-class">) } }</span></span></code> </pre> <br><br>  The Fraction class is somewhat easier, because it is completely based on MyInteger: <br><pre> <code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Fraction</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">x: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">MyInteger</span></span></span></span><span class="hljs-class"><span class="hljs-params">, y: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">MyInteger</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyNumber</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span></span>(x: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span>) = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>(x, (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Zero</span></span>).suc) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isNatural: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isNeg: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> = (x.isNeg &amp;&amp; !y.isNeg) || (!x.isNeg &amp;&amp; y.isNeg) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isZero: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> = x.isZero <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isInf: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> = x.isInf || y.isInf <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">+</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> plus b.toFraction <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plus</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">Fraction</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Fraction</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num * b.denum + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum * b.num).toInteger, (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum * b.denum).toInteger) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">-</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> minus b.toFraction <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minus</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">Fraction</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Fraction</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num * b.denum - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum * b.num).toInteger, (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum * b.denum).toInteger) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">*</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> mult b.toFraction <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mult</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">Fraction</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Fraction</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num * b.num).toInteger, (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum * b.denum).toInteger) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">/</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> div b.toFraction <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">div</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">Fraction</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Fraction</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num * b.denum).toInteger, (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum * b.num).toInteger) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">^</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!b.isNatural) (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Zero</span></span>).pre <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Fraction</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num ^ b.toInteger).toInteger, (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum ^ b.toInteger).toInteger) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">&lt;</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">Boolean</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num.isNeg) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b.num.isNeg) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.neg &gt; b.neg <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isZero) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b.isZero || b.num.isNeg) <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b.num.isNeg || b.isZero) <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num * b.denum &lt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum * b.num } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">&gt;</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">Boolean</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num.isNeg){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(b.num.isNeg) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.neg &lt; b.neg <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isZero){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(b.isZero || !b.num.isNeg) <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(b.num.isNeg || b.isZero) <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num * b.denum &gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum * b.num } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">==</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">Boolean</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!b.isNatural)(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num == b.num) &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum == b.denum) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == b.toFraction <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">neg</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Fraction</span></span>(num.neg.toInteger, denum) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">abs</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Fraction</span></span>(num.abs.toInteger, denum) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pre</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span> = sys.error(<span class="hljs-string"><span class="hljs-string">"Predicat of fraction"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">suc</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span> = sys.error(<span class="hljs-string"><span class="hljs-string">"Successor of fraction"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> num = ((<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isNeg)x.abs.neg <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> x.abs) / (x.abs gcd y.abs)).toInteger <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> denum = (y.abs / (x.abs gcd y.abs)).toInteger <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gcd</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.denum gcd (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Zero</span></span>).suc <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span></span>(b: <span class="hljs-type"><span class="hljs-type">MyInteger</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Zero</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span></span>(): <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(num.isZero) <span class="hljs-number"><span class="hljs-number">0.</span></span>toString() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isInf) <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(denum == (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Zero</span></span>).suc) num.toString() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> num + <span class="hljs-string"><span class="hljs-string">"/"</span></span> + denum }</code> </pre> <br><br>  That's all!  We now have natural and fractional numbers, and a set of simple operations (note, not a single use of the native classes!) <br><br>  By the same principle, you can create data structures for the latter-day numbers: <br><pre> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MySet</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span></span>(elem: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span></span>(elem: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">union</span></span></span></span>(set: <span class="hljs-type"><span class="hljs-type">MySet</span></span>): <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intersec</span></span></span></span>(set: <span class="hljs-type"><span class="hljs-type">MySet</span></span>): <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contains</span></span></span></span>(elem: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">Boolean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">linearSearch</span></span></span></span>(elem: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mergeSort</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">merge</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quickSort</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">timSort</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">binaryTreeSort</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span></span>(pos: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">take</span></span></span></span>(n: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drop</span></span></span></span>(n: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">map</span></span></span></span>(p: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> =&gt; <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">filter</span></span></span></span>(p: <span class="hljs-type"><span class="hljs-type">MyNumber</span></span> =&gt; <span class="hljs-type"><span class="hljs-type">Boolean</span></span>): <span class="hljs-type"><span class="hljs-type">MySet</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">flat</span></span></span></span>(p: (<span class="hljs-type"><span class="hljs-type">MyNumber</span></span>, <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>) =&gt; <span class="hljs-type"><span class="hljs-type">MyNumber</span></span>): <span class="hljs-type"><span class="hljs-type">MyNumber</span></span></code> </pre> <br><br>  Yes, and a lot of things can be done with recursive functions, even create your own universe.  "With blackjack and whores."  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/139755/">https://habr.com/ru/post/139755/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../139748/index.html">Analogue of the Step Pattern and Asynchronous Call Nesting</a></li>
<li><a href="../139750/index.html">Virtual girl takes money from users of mobile devices based on Android</a></li>
<li><a href="../139751/index.html">Experience using a 3600 mAh battery for the HTC Sensation smartphone</a></li>
<li><a href="../139752/index.html">If you still think whether to do business on the Internet or not</a></li>
<li><a href="../139753/index.html">We hang the server through PHP</a></li>
<li><a href="../139757/index.html">Tips for yourself in the past</a></li>
<li><a href="../139759/index.html">Boat for playing stone, paper, scissors</a></li>
<li><a href="../139760/index.html">Car Satellite Alarm on STM32F1</a></li>
<li><a href="../139763/index.html">My view on GTD or how to synchronize my tasks on several platforms in the absence of the Internet</a></li>
<li><a href="../139765/index.html">Short comparison 11n vs 11ac vs 11ad. And what services will we see in the future</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>