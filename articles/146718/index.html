<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Java 8 Lambda vs LambdaJ vs Guava vs Iterative approach</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the middle of 2013, Java 8 comes out with a lambda expression implementation. Lambda expressions provide ample opportunities for application of fun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Java 8 Lambda vs LambdaJ vs Guava vs Iterative approach</h1><div class="post__text post__text-html js-mediator-article">  In the middle of 2013, Java 8 comes out with a lambda expression implementation.  Lambda expressions provide ample opportunities for application of functional programming style.  True, the functional style can be used today in JDK 7, 6 or 5 using the <a href="http://code.google.com/p/lambdaj/">LambdaJ</a> and <a href="http://code.google.com/p/guava-libraries/">Guava</a> libraries. <br><table><tbody><tr><th></th><th>  <b>Iterative</b> </th><th>  <b>Lambdaj</b> </th><th>  <b>JDK 8 lambda</b> </th><th>  <b>Guava</b> </th></tr><tr><th>  Print all brands </th><td>  <b>79</b> </td><td>  472 * </td><td>  113 </td><td>  <b>79</b> </td></tr><tr><th>  Select all sales of a Ferrari </th><td>  <b>25</b> </td><td>  146 </td><td>  44 </td><td>  31 </td></tr><tr><th>  Find buys of youngest person </th><td>  <b>1,209</b> </td><td>  1,775 </td><td>  1,242 </td><td>  1.218 </td></tr><tr><th>  Find the most costly sale </th><td>  <b>eight</b> </td><td>  123 </td><td>  55 </td><td>  72 </td></tr><tr><th>  Sum costs where both are males </th><td>  <b>23</b> </td><td>  973 * </td><td>  40 </td><td>  45 </td></tr><tr><th>  Age of youngest who bought for&gt; 50,000 </th><td>  1,521 </td><td>  2.576 * </td><td>  1,560 </td><td>  <b>1.511</b> </td></tr><tr><th>  Sort sales by cost </th><td>  <b>350</b> </td><td>  1,187 </td><td>  473 </td><td>  453 </td></tr><tr><th>  Extract cars original cost </th><td>  <b>29</b> </td><td>  61 </td><td>  31 </td><td>  31 </td></tr><tr><th>  Index cars by brand </th><td>  <b>57</b> </td><td>  70 </td><td>  89 </td><td>  415 </td></tr><tr><th>  Group sales by buyers and sellers </th><td>  2,586 </td><td>  3.748 * </td><td>  2,862 </td><td>  <b>1.601</b> </td></tr><tr><th>  Find most bought car </th><td>  <b>744</b> </td><td>  1.023 * </td><td>  CRASH </td><td>  1,435 </td></tr></tbody></table><a name="habracut"></a><br>  Guava is a fairly extensive library, but its core is made up of classes for working with collections, the library itself has grown out of google-collections.  These classes implement everything for working with collections, which is missing in the JDK today.  If you take a closer look at JDK 8, you always get the feeling that this or that new feature already exists in guava.  It is possible that the developers of the eighth java relied precisely on the experience of the guava. <br><br>  LamdaJ, despite its name, does not provide the ability to write lambda expressions, it is rather a library for working with collections.  It gives you the ability to filter, convert, group items of collections, while the code is very compact and readable.  It is implemented by means of reflection and glib, and it is obvious that one has to pay for productivity with productivity.  About LambdaJ already wrote on <a href="http://habrahabr.ru/post/118041/">Habr√©</a> . <br><br>  In JDK 8, lambda expressions will be implemented already at the compiler level and will be converted to bytecode at the compilation stage, therefore, theoretically, the performance of such code should be higher. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Performance comparison </h4><br>  In order to practically compare the performance of lambda expressions from JDK 8 with LambdaJ, Guava and the usual iterative approach, LambdaJ performance tests were taken and analogs were written on JDK 8 and Guava. <br><br>  The initial test code for the iterative variant and LambdaJ was not touched, the test names are saved in English to avoid confusion.  The testing methodology is as follows: tests are run in 100 passes, where each test is run 100,000 times, the total time taken to complete each pass is measured and averaged. <br><br>  Not all LambdaJ tests were launched in JRE 8, they are marked with an asterisk in the table, the results for them were measured in JRE 7. In one test, the lambda expression dropped the virtual machine completely. <br><br>  The tests were performed on a computer with the following configuration: Core i5 760 2.8 GHz 8 GB Win 7 sp-1 64 bit lambda-8-b45-windows-x64-24_jun_2012 jdk-7u4-windows-x64. <br><br>  As a result, the best results were given by the iterative code, Guava and JDK lambda.  They give quite comparable results.  In general, we can say that lambda expressions provide a completely satisfactory replacement for iterations and anonymous classes.  Both JDK 8, Guava, and the iterative approach give very similar results, but LamdaJ is almost an order of magnitude behind, the reason most likely lies in the wide use of reflection. <br><br>  It should be noted that Guava and JDK lambda have one feature when working with collections.  They often return not the copied collection, but its live view, which postpones the calculations until the time it accesses the elements of this view.  Therefore, in the tests, all the live views were clearly converted into collections.  Otherwise, some tests would give a result of almost 0 milliseconds.  I also have to say that in real life no one demands to make a choice in favor of any approach, for example, Guava will be perfectly combined with lambda expressions. <br><br><h4>  Example </h4><br>  For an example of how the source code for each of the approaches looks like, you can look at the <a href="">FindAgeOfYoungestWhoBoughtForMoreThan50000Test</a> test.  In this test, a list of car dealership sales is given, and in this list is the age of the youngest buyer who made the purchase for more than 50,000 any money. <br><br><h6>  Iterative approach </h6><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age = Integer.MAX_VALUE; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Sale sale : db.getSales()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sale.getCost() &gt; <span class="hljs-number"><span class="hljs-number">50000.00</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> buyerAge = sale.getBuyer().getAge(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buyerAge &lt; age) { age = buyerAge; } } }</code> </pre> <br><h6>  LambdaJ </h6><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age = Lambda.min(forEach(select(db.getSales(), having(on(Sale.class).getCost(), greaterThan(<span class="hljs-number"><span class="hljs-number">50000.00</span></span>)))).getBuyer(), on(Person.class).getAge());</code> </pre><br><h6>  JDK 8 lambda </h6><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age = Collections.min(db.getSales() .filter((Sale sale)-&gt;sale.getCost() &gt; <span class="hljs-number"><span class="hljs-number">50000.00</span></span>) .&lt;Integer&gt;map((Sale sale)-&gt;sale.getBuyer().getAge()) .into(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;Integer&gt;()));</code> </pre><br><h6>  Guava </h6><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age = Collections.min(transform(filter(db.getSales(), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Predicate&lt;Sale&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">apply</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Sale input)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> input.getCost() &gt; <span class="hljs-number"><span class="hljs-number">50000.00</span></span>; } }), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Function&lt;Sale, Integer&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Integer </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">apply</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Sale input)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> input.getBuyer().getAge(); } }));</code> </pre><br><br><h4>  Links </h4><br><ul><li>  Test source code <a href="https://github.com/dmalch/lambda-comparison">github.com/dmalch/lambda-comparison</a> </li><li>  LamdaJ performance analysis <a href="http://code.google.com/p/lambdaj/wiki/PerformanceAnalysis">code.google.com/p/lambdaj/wiki/PerformanceAnalysis</a> </li><li>  Download JDK 8 without lambda expressions <a href="http://jdk8.java.net/download.html">jdk8.java.net/download.html</a> </li><li>  Download JDK 8 with lambda expressions <a href="http://jdk8.java.net/lambda/">jdk8.java.net/lambda</a> </li><li>  Article on Habr√© about LamdaJ <a href="http://code.google.com/p/lambdaj/">code.google.com/p/lambdaj</a> </li></ul><br><br><h4>  Update </h4><br>  On the advice of <a href="https://habrahabr.ru/users/theshade/" class="user_link">TheShade,</a> I made changes to the testing procedure: I added warming up and calculation of confidence intervals.  Results changed as follows: <br><table><tbody><tr><th></th><th>  <b>Iterative</b> </th><th>  <b>Lambdaj</b> </th><th>  <b>JDK 8 lambda</b> </th><th>  <b>Guava</b> </th></tr><tr><th>  Print all brands </th><td>  <b>797.3</b> </td><td>  4,436.6 * </td><td>  1,073.2 </td><td>  912.1 </td></tr><tr><th>  Select all sales of a Ferrari </th><td>  471.1 </td><td>  1,359.6 </td><td>  398.5 </td><td>  <b>341.7</b> </td></tr><tr><th>  Find buys of youngest person </th><td>  <b>12,102.4</b> </td><td>  17.436.2 </td><td>  12,267.4 </td><td>  <b>12,144.5</b> </td></tr><tr><th>  Find the most costly sale </th><td>  <b>89.7</b> </td><td>  1,237.2 </td><td>  742.8 </td><td>  676.6 </td></tr><tr><th>  Sum costs where both are males </th><td>  <b>173.7</b> </td><td>  8,979.8 * </td><td>  372.7 </td><td>  394.5 </td></tr><tr><th>  Age of youngest who bought for&gt; 50,000 </th><td>  11,971.2 </td><td>  28,091.9 * </td><td>  <b>11,672.1</b> </td><td>  15,975.6 </td></tr><tr><th>  Sort sales by cost </th><td>  <b>3.261</b> </td><td>  12,566.1 </td><td>  4,558.8 </td><td>  <b>3,242.5</b> </td></tr><tr><th>  Extract cars original cost </th><td>  292.1 </td><td>  628 </td><td>  322.8 </td><td>  <b>213.1</b> </td></tr><tr><th>  Index cars by brand </th><td>  <b>548.8</b> </td><td>  672.1 </td><td>  867.8 </td><td>  4,324.6 </td></tr><tr><th>  Group sales by buyers and sellers </th><td>  25,986.3 </td><td>  39,339.3 * </td><td>  28,109.2 </td><td>  <b>15,068.9</b> </td></tr><tr><th>  Find most bought car </th><td>  <b>7,378.3</b> </td><td>  9,317.2 * </td><td>  CRASH </td><td>  10,002.1 </td></tr></tbody></table></div><p>Source: <a href="https://habr.com/ru/post/146718/">https://habr.com/ru/post/146718/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146710/index.html">Happlink - Interest Interaction Network</a></li>
<li><a href="../146714/index.html">Nokia Developer Days: Day One</a></li>
<li><a href="../146715/index.html">Online games: how to pay, what to pay?</a></li>
<li><a href="../146716/index.html">Crowdfunding as a course for a young fighter</a></li>
<li><a href="../146717/index.html">Triggers - Rescuers</a></li>
<li><a href="../146719/index.html">Touch-lynch. Mascotte iPhone</a></li>
<li><a href="../146720/index.html">What's new in Parallels Plesk Panel 11</a></li>
<li><a href="../146721/index.html">The web version of the Google Play app store has been updated.</a></li>
<li><a href="../146722/index.html">XXEncode format on VBA, or how to load a binary into a document</a></li>
<li><a href="../146726/index.html">Google Chrome comes to iPhone and iPad</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>