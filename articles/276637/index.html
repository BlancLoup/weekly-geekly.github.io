<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We start and we emulate Windows on Raspberry Pi by means of QEMU</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most likely this is the first Russian-language manual about setting up QEMU on Raspberry. 

 Some time ago, I set about trying to launch some kind of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We start and we emulate Windows on Raspberry Pi by means of QEMU</h1><div class="post__text post__text-html js-mediator-article">  <i>Most likely this is the first Russian-language manual about setting up QEMU on Raspberry.</i> <br><br>  Some time ago, I set about trying to launch some kind of Windows system on my Raspberry Pi 2.  At first, I wanted to know if it was possible to install it, simply by writing to the SDCARD and inserting it into a ‚Äúraspberry‚Äù, but this was not realized ... <br><br>  After I began to look for an opportunity to run through some emulators.  Stumbled upon QEMU and began to dig with it.  I tried to run the emulator for a very long time, almost everything I found on the forums was written in English, and there was ‚Äúat a minimum‚Äù information, and there were very few people who started it.  After several unsuccessful attempts to launch QEMU, I decided to write on w3bsit3-dns.com in the topic on Raspberry.  They helped me there, and I successfully started Windows 98 (almost perfect ...).  I ran it on Raspibiane (Debian). <br><a name="habracut"></a><br>  Let's start, open the terminal and register it: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="objectivec hljs">sudo apt-get install sudo apt-get uprage sudo apt-get install git zlib1g-dev libsdl1<span class="hljs-number"><span class="hljs-number">.2</span></span>-dev libpixman<span class="hljs-number"><span class="hljs-number">-1</span></span><span class="hljs-number"><span class="hljs-number">-0</span></span> libpixman<span class="hljs-number"><span class="hljs-number">-1</span></span>-dev</code> </pre> <br>  It is advisable to do all this through <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">putty</a> , so that all the characters exactly match what is written. <br><br>  Go ahead: <br><br><pre> <code class="objectivec hljs">git clone git:<span class="hljs-comment"><span class="hljs-comment">//git.qemu-project.org/qemu.git</span></span></code> </pre><br>  The team begins to download the "insides" of the emulator, this process does not take much time. <br><br><img src="http://i.imgur.com/0nKyhd5.png" alt="image"><br><br>  After the file is downloaded and unpacked, a folder (location / home /% username% / qemu) will appear, in which all the files that are necessary for the emulator to work will be located.  After everything has been downloaded and unpacked, we prescribe this: <br><br><pre> <code class="objectivec hljs">cd qemu ./configure --target-list=<span class="hljs-string"><span class="hljs-string">"i386-softmmu"</span></span> --enable-sdl --prefix=/usr</code> </pre><br>  The configuration process begins, it does not take much time (~ 30-60 seconds).  Now we need to start the debugging process: <br><br><pre> <code class="objectivec hljs">sudo make</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text">  After entering the command, debugging will begin, it looks like this: <br><br><img src="http://i.imgur.com/IFGTNzY.png" alt="image"><br></div></div><br>  Debugging can continue indefinitely, (~ 15-20 minutes).  The last thing we have to do is tweak the configs and debug it. <br><br><pre> <code class="objectivec hljs">sudo nano /home/pi/qemu/tcg/arm/tcg-target.c sudo nano /home/pi/qemu/tcg/i386/tcg-target.c</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text">  Sometimes when executing the above commands, the system creates a new file, then we exit the editor and open the necessary configs with our hands. <br><br><img src="http://i.imgur.com/WSKcMCJ.png" alt="image"><br></div></div><br>  Hold Ctrl + W, the search string opens, enter: static void tcg_out_addi.  We change on static inline void tcg_out_addi.  Go to the second configuration, just call the search string and enter this text: static void tcg_out_opc and change to static inline void tcg_out_opc.  If you have not found any of the lines, then we do nothing, but simply close the config and perform the next step (I did not find the required line in the first config, but the emulator works fine for me). <br><br>  If you are done with replacing strings, continue to torment our ‚Äúraspberry‚Äù: <br><br><pre> <code class="objectivec hljs">sudo make sudo make install</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="http://i.imgur.com/gTyDi9Y.png" alt="image"><br></div></div><br>  The emulator setup is complete.  We now turn to the launch of the system.  As far as I know, the emulator supports these image formats: <br><br>  .img - System image. <br>  .vhd - Virtual "hard" <br>  .iso - Disk Image. <br><br>  You can download images of the systems you are interested in <a href="http://4pda.ru/forum/index.php%3Fshowtopic%3D318284">here</a> , there is also an instruction for creating your own system image. <br><br>  I collected on Yandex.Disk <a href="https://yadi.sk/d/C1_i7JMknhfUa">all the images</a> that run on QEMU and are taken from the topic, the link to which is given above.  It is worth noting that the name of the Linux KDE image contains the password from the user. <br><br>  We proceed to launch the system.  We write to the console: <br><br><pre> <code class="objectivec hljs">qemu-system-i386    (-hda, -fda, -cdrom) .img -m _-___(  ).</code> </pre><br>  If all settings are correct, the system image should start loading. <br><br>  <i>This photo, how to screen in Linux, I have not mastered.</i> <br><br><div class="spoiler">  <b class="spoiler_title">Result</b> <div class="spoiler_text"><img src="https://pp.vk.me/c627331/v627331561/2c985/OHbgwVJ8QuA.jpg" alt="image"><br><br><img src="https://pp.vk.me/c627331/v627331561/2c97b/yEAelPaDwqw.jpg" alt="image"><br></div></div><br>  QEMU can emulate not only i386 processors, but also other "platforms", more: <br><br><pre> <code class="objectivec hljs">ls /usr/bin/qemu*</code> </pre><br>  This query brings up a list of QEMU commands: <br><br><pre> <code class="objectivec hljs">qemu-system-i386 --help</code> </pre><br>  Play around with the settings of QEMU, he himself has not fully figured out with him.  It is worth considering that I started the system using the resources of only one ‚Äúraspberry‚Äù core, while the computer was loaded by 25-26% (running Win98).  I read on the forums about multi-threading QEMU with the image of the system, but did not understand how to force the emulator to use resources of more than one core.  Again, play around with the settings and maybe you will understand how to configure multithreading (do not forget to write in the comments how you did it). </div><p>Source: <a href="https://habr.com/ru/post/276637/">https://habr.com/ru/post/276637/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276623/index.html">Through a filtering proxy using a script in the name of the moon</a></li>
<li><a href="../276629/index.html">Security Week 05: difficult numbers in socat, Virustotal checks the BIOS for bookmarks, the secret life of WiFi modules</a></li>
<li><a href="../276631/index.html">Game Designer Skills</a></li>
<li><a href="../276633/index.html">Compact OS for ARM processors</a></li>
<li><a href="../276635/index.html">Building a glass of quotes (FullOrderBook) based on historical data</a></li>
<li><a href="../276641/index.html">nopCommerce CMS on ASP.NET MVC: review of the functionality of the new version</a></li>
<li><a href="../276643/index.html">Controller for T-SDN</a></li>
<li><a href="../276645/index.html">Improving education in universities on information security / IT</a></li>
<li><a href="../276649/index.html">Angular 2 versus Aurelia side by side</a></li>
<li><a href="../276651/index.html">Google has thrown out an ad blocker from Google Play</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>