<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Different configs for production mode and debug mode. Two in one</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear habrakrady. 
 From your own experience, you probably already know how important it is to minimize the changes that the debugging mode intr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Different configs for production mode and debug mode. Two in one</h1><div class="post__text post__text-html js-mediator-article">  Hello, dear habrakrady. <br>  From your own experience, you probably already know how important it is to minimize the changes that the debugging mode introduces to your application code.  If you are accompanying a fairly large and already running project, then all the more you understand the importance of quick debugging, in which you don‚Äôt have to clean up any changes made for ease of development. <br>  Investigating the possibilities of Yii, my friend did not find the functional that realizes this possibility, and set out to fix it.  In this topic, we will learn how quickly and safely for your application to change the config (its working version) to the needs of the developer.  Details - under the cut. <br>  <b>It just became known that this is in the Yii Kukbook.</b> <br><a name="habracut"></a><br><h4>  Problem </h4><br>  You do not want to have multiple configs.  This is inconvenient, because when adding a project, you will have to change all the parameters in the new config that were changed for greater convenience at the design stage each time.  It is much more convenient to have one working version of the config, and change it for the time of development. <br><h4>  Decision </h4><br>  And the solution is very simple: we don‚Äôt need to create a copy of the config if we can use inheritance by applying it to the array returned by the config file.  Each instance of the application, called from the local computer, will be created with the local version of the config, and the instance created by the request from the remote computer will start with the parameters from the working version. <br>  Let us turn to examples.  Here is the updated input file of our application - index.php: <br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $yii=dirname(<span class="hljs-keyword"><span class="hljs-keyword">__FILE__</span></span>).<span class="hljs-string"><span class="hljs-string">'/../yii/framework/yii.php'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'REMOTE_ADDR'</span></span>]==<span class="hljs-string"><span class="hljs-string">'127.0.0.1'</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   , defined('YII_DEBUG') or define('YII_DEBUG',true); defined('YII_TRACE_LEVEL') or define('YII_TRACE_LEVEL',3); //     $config=dirname(__FILE__).'/protected/config/develop.php'; } else { //        $config=dirname(__FILE__).'/protected/config/main.php'; } require_once($yii); Yii::createWebApplication($config)-&gt;run();</span></span></code> </pre> <br>  Now let's look at the file '/protected/config/develop.php' mentioned above.  If you look closely at its logic, you will understand that there is no invention of a bicycle, and the whole idea is very simple and consists of inheriting arrays: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//    //     ,      function array_extends(array $array1, array $array2) { foreach($array2 as $key=&gt;$value) { if(is_int($key)) $array1[]=$value; else if(empty($array1[$key]) || !is_array($value)) $array1[$key]=$value; else if(is_array($value)) $array1[$key]=array_extends($array1[$key], $value); } return $array1; } //        //,  ,       //         return array_extends(include('main.php'), array( //   'name'=&gt;'Local version', 'import'=&gt;array( //      import 'application.extensions.yiidebugtb.*' 'application.extensions.yiidebugtb.* ), 'modules'=&gt;array( //   gii   ?     'gii'=&gt;array( 'class'=&gt;'system.gii.GiiModule', 'password'=&gt;'password', ... ), ), 'components'=&gt;array( 'db'=&gt;array( //  connectionString      'connectionString' =&gt; 'mysql:host=localhost;dbname=mycms', //         . 'username' =&gt; 'root', //         . 'password' =&gt; '', //    'enableProfiling'=&gt;true, /* 'tablePrefix' =&gt; 'tbl_',          */ ), 'log'=&gt;array( //          'routes'=&gt;array( array( 'class'=&gt;'XWebDebugRouter', ... ), array( 'class'=&gt;'CWebLogRoute', ... ), ) ), ), ));</span></span></code> </pre> <br>  I think everyone who has come across the Yii Framework has certainly dealt with the protected / config / main.php file, but I will nevertheless explain: this file returns an array of parameters that ultimately apply to the running application instance.  For clarity, I will provide a very abbreviated code sample from this file: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'name'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'Working Version'</span></span>, ... <span class="hljs-string"><span class="hljs-string">'import'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'application.models.*'</span></span>, <span class="hljs-string"><span class="hljs-string">'application.components.*'</span></span>, ), <span class="hljs-string"><span class="hljs-string">'modules'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-comment"><span class="hljs-comment">// uncomment the following to enable the Gii tool 'admin', ), ... // application components 'components'=&gt;array( 'db'=&gt;array( 'connectionString' =&gt; 'mysql:host=localhost;dbname=host_db', 'emulatePrepare' =&gt; true, 'username' =&gt; 'hosh_login', 'password' =&gt; 'hosh_password', 'charset' =&gt; 'utf8', 'tablePrefix' =&gt; 'tbl_', ), 'log'=&gt;array( 'class'=&gt;'CLogRouter', 'routes'=&gt;array( array( 'class'=&gt;'CFileLogRoute', 'levels'=&gt;'error, warning', ), ), ), ), ... );</span></span></code> </pre> <br>  As you can see, the idea is really very simple, but it can be very useful, especially with regard to projects that are already running. <br><br>  TheAlien suggested that this solution is already implemented <a href="http://yiiframework.ru/doc/cookbook/ru/install.many.configs">link</a> <br><br>  Thanks for attention. </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/125677/">https://habr.com/ru/post/125677/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../125672/index.html">Microsoft will add support for HTML5 and JavaScript to Office 15</a></li>
<li><a href="../125673/index.html">Original captcha. Part 2 - Continuation</a></li>
<li><a href="../125674/index.html">Refund for pre-installed OEM Windows. End of story</a></li>
<li><a href="../125675/index.html">DebConf11: Conference Summary</a></li>
<li><a href="../125676/index.html">Waiting for the result in the multithread application - who uses what?</a></li>
<li><a href="../125681/index.html">How WebsiteDefender Works</a></li>
<li><a href="../125683/index.html">This year will be published source Doom III</a></li>
<li><a href="../125684/index.html">Connecting the Community</a></li>
<li><a href="../125685/index.html">How to create a company with a short history of operating activities</a></li>
<li><a href="../125687/index.html">OpenCL: we waited - version 1.1 from nVidia, but what's new?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>