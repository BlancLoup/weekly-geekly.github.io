<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PHDays III CTF: An Inside Look (Part 2)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue our story about the preparation of CTF competitions, which took place at the Positive Hack Days forum. Today we will talk about creating t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PHDays III CTF: An Inside Look (Part 2)</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/pt/blog/186800/"><img src="https://habrastorage.org/storage2/483/1aa/443/4831aa443a5fc1fafc5f48394bed281a.png" align="left"></a>  We continue our story about the preparation of CTF competitions, which took place at the Positive Hack Days forum.  Today we will talk about creating the interface, usability (usability), as well as the development of visualization of the course of competitions. <br><br>  <a href="http://habrahabr.ru/company/pt/blog/186310/">First part</a> <br><br><h4>  User interface </h4><br>  A very important part of developing CTF was creating a user interface for commands (UI).  With it, players must carry out all actions related to game mechanics.  From personal experience, we knew that the overall impression of CTF largely depends on the quality of the UI, so we took the design and usability very seriously. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The UI was a web application that communicated with the jury system through MongoDB and AMQP-RPC.  As a basis, we chose a bundle of Pyramid + Nginx.  Notification system was implemented on Flask. <br><br>  UI requirements were as follows: <br><ol><li>  <i>Interactivity</i> .  In the context of CTF, it is very important to promptly receive notifications about game events: about changes in the state of services, the appearance of new tasks, operations with resources, etc. We have tried to do everything to keep the system up to date with users. </li><li>  <i>Speed ‚Äã‚Äãperformance</i>  As already mentioned, the responsiveness of the interface can decide the outcome of the game.  In most cases, the application processes requests immediately, without tugging once again the jury system, or making it deferred.  For example, verification of decisions was made without recourse to the Jury system. </li><li>  <i>Fault tolerance</i> .  The UI architecture allowed to deploy the system on several hosts, transparently to users.  However, this was not needed in the game, since we had a fairly powerful server. </li><li>  <i>Safety</i>  As in all other components, you had to be ready for attacks from the teams.  The UI was as isolated as possible from other system components.  For example, access to the database was read-only, and communication with the Jury System was carried out through AMQP. </li></ol><br><h4>  Usability </h4><br>  The most important task of the UI is to provide participants with an intuitive interface.  We did not cherish unrealizable hopes and understood that for the participants of CTF any legend and entourage fade into the background.  The most important thing is the solution of tasks, and the user interface should not distract the players.  Usability was one of the main priorities, and therefore we changed the design five times. <br><br>  The first versions of the UI were performed in bright colors, with flat minimalist elements.  Subsequently, we painted the interface for better perception, and also changed the background to a dark one to support the entourage of computer games (as it turned out, the design of almost all games is made against a dark background).  The illustrations of the monsters from the comic fit very well into the design of the page with the tasks, but apart from this, the UI was no longer connected with the legend. <br><br>  Current game events were displayed as vk.com-style pop-up messages.  In addition, you could see the event log from the very beginning of the game. <br><br> <a href=""><img src="https://habrastorage.org/storage2/2d7/450/026/2d7450026cb094a9c62b12b968c93416.png"></a> <br><br> <a href=""><img src="https://habrastorage.org/storage2/0e9/bac/8ae/0e9bac8aefa0d1f0fcacba894d523978.png"></a> <br><br> <a href=""><img src="https://habrastorage.org/storage2/f06/0c1/bb1/f060c1bb13f98da7d2e3f381e53d94ab.png"></a> <br><br> <a href=""><img src="https://habrastorage.org/storage2/7d0/6f7/12a/7d06f712a905b676e29778a73e03a62d.png"></a> <br><br>  <i>Evolution of the Scorbord Interface</i> <br><br> <a href=""><img src="https://habrastorage.org/storage2/9af/a68/30a/9afa6830add2c1bf398e50f5b59dfff4.png"></a> <br><br>  <i>The final version of the page with tasks</i> <br><br><h4>  Visualizer </h4><br>  From the very first days of the development of CTF, it was decided that visualization of the gameplay is absolutely necessary.  First of all, it is necessary in order to attract as many outsiders as possible and embed hacker contests in the context of the PHDays III forum. <br><br><h5>  Concept </h5><br>  To begin with, it was necessary to understand what events the viewers should show so that they would be interested to observe what was happening, and at the same time so that the process was as informative as possible. <br><br>  Events were divided into two categories: <br><br><ul><li>  Attack on the service.  It can occur in a very large number (up to 138,240 events per game). </li><li>  The remaining events.  Occur infrequently - decision task (up to 250 per game), killing the boss (4 per game), getting achivka (up to 391 per game) </li></ul><br>  Frequent events should be displayed so that they are not too annoying, occur in the background, and make a variety of gameplay.  Rare events should be made as visible as possible so that they are not lost on the background of frequent ones. <br><br>  After analyzing all the events, comparing them with the invented legend and game mechanics, we developed a working visualizer concept: <br><br><ul><li>  Events occur on the world map D'Errorim (top view). </li><li>  Each team has its own castle - a place where the heroes of the team live. </li><li>  Near the castle are five mines, where teams extract resources. </li><li>  Each team has its own flying creature (dragon), which is designed to visualize all active events. </li><li>  In the center of the map are 25 houses, displaying the task. </li><li>  In addition to the houses, there are also three common gold mines. </li></ul><br><img src="https://habrastorage.org/storage2/808/34d/605/80834d605d2d5f1a2647691bd5d216b8.png"><br><br>  <i>Map D'Errorim from the visualizer</i> <br><br>  Event visualization: <br><br><ol><li>  <i>Attack on the service</i> .  The dragon cyclically flies through all the mines that the team attacked in the last round.  Flying up to the mine, he begins to attack the mine, making several laps over it.  Thus, all dragons continuously fly around the map, displaying attacks made in the last round. </li><li>  <i>Solution Taska</i> .  The dragon interrupts his route and flies to attack the house corresponding to the solved task.  In this case, all but the dragon and the house is obscured, thereby highlighting this important event. </li><li>  <i>Killing the boss</i>  When the boss's lifetime has expired and it became clear which teams were able to overcome him, their dragons interrupt their way and fly to the attack.  After some time, the boss breaks into bloody pieces and dragons fly whoever. </li><li>  <i>Getting achivki</i> .  On top of the screen is a stamp with the name of the achivka and the team that received it. </li></ol><br>  However, visualization of events by itself is not enough for them to be interesting to observe.  We still need a lot of beautiful animated graphics, we need a dynamic view of the map.  The camera should periodically change its position, smoothly approach the places where events occur, and move back, ‚Äúfollow‚Äù the actions of the dragons and show the entire map.  In general, the camera should be ‚Äúalive‚Äù, anticipate interesting moments for the viewer and point him at them. <br><br><h5>  Expanding boundaries </h5><br>  After the first concept was ready and it was time to start working on the creation of the application, an idea came to us: what if we made a mobile and online version of the visualizer?  Nowadays, this is a very promising direction that will help attract and interest much more viewers!  It would be great and unusual if the course of the CTF could be observed from anywhere in the world where there is access to the Internet - this has not happened before! <br><br>  The idea was received with great enthusiasm.  However, this in turn not only complicated the design of the project, but also added the need for interactive user interaction.  It was decided to create a manual camera control mode, namely scrolling and zoom using the touch interface. <br><br>  In addition to viewing the map, the user needs the ability to view the overall rating and information about each team, as well as the ability to follow the dragon of a particular team. <br><br> <a href=""><img src="https://habrastorage.org/storage2/05d/721/534/05d7215341c15756a2d1479b47cf9e9d.png"></a> <br><br>  <i>Interactive Visualizer Interface</i> <br><br> <a href=""><img src="https://habrastorage.org/storage2/d64/01c/253/d6401c253496888b775a28c45ce76fca.png"></a> <br><br>  <i>Team rating in the visualizer</i> <br><br> <a href=""><img src="https://habrastorage.org/storage2/c42/e72/434/c42e724342a090da60472f3d0e076cbf.png"></a> <br><br>  <i>Team profile in the visualizer</i> <br><br><h4>  Architecture </h4><br>  When all the requirements for the system have been thought out, it's time to start developing the project architecture.  It was immediately clear that the application is distributed and consists of several links: <br><br><ul><li>  <b>a service</b> that receives events from the Jury system; </li><li>  <b>a web application</b> that returns game events and game status to clients; </li><li>  <b>client</b> visualizing game events; </li></ul><br><img src="https://habrastorage.org/storage2/2f9/91f/a83/2f991fa83d47684040c070a629e2d4ac.png"><br><br>  <i>Schematic representation of the visualizer architecture</i> <br><br>  By the time the visualizer started designing, work was underway on the Jury system and the players' user interface, and the AMQP message queue for transferring game events and the MongoDB database for storing the system state were already selected as communication channels.  Messages between the client and the server, it was decided to send in JSON, because it is very convenient and quite compact. <br><br>  The first link of the visualizer is service.  When an event enters the queue, the AMQP service must convert it from the format of the jury system to the format of the client application, as well as update the game state.  All received information is stored in MS SQL database. <br>  The second link is a web application that receives client requests and returns events and system status from a database in JSON format. <br><br>  The last link is the client of the visualizer, an application that queries the server for a list of events and states and displays the received data in accordance with the concept described above. <br><br><h4>  Selection of development tools </h4><br>  The server part of the visualizer (both the service and the web application) was written for the .NET platform in C #.  The tools were chosen mostly because of the preferences of the developer who was involved in this task.  C # is powerful enough and at the same time simple language, well suited for the implementation of such applications, so the development went quickly and without any problems.  The choice of MS SQL Server DBMS was also due to the simplicity of interaction with C # tools. <br><br>  The client part is essentially an ordinary computer game, but without the ability to control the player, so based on the requirements, it was necessary to find a cross-platform game engine running Android, iOS and HTML5.  We considered the possibilities of different engines, but none of them could fully satisfy our needs.  Variants with writing custom code for each platform using the same API were dismissed immediately, since there was no time to write three different projects.  It also turned out that games written in ‚Äúpure‚Äù HTML5 are quite demanding of performance, and there is no way to run them on older devices.  We were almost desperate to find something more or less appropriate when Game Maker: Studio came across. <br><br>  Game Maker is an environment that uses its own C-like GML programming language, sharpened specifically for designing games with a built-in map editor, image editor, and many other useful features.  Moreover, the GMS bundle includes a whole set of compilers for machine code of various platforms, including Windows, OS X, Linux (Ubuntu), HTML5 (JavaScript), iOS, Android version 2.2 and higher, Windows Phone.  We were also pleased with the performance compared to other engines (25-30 fps on HTC Desire with Android 2.3.5).  The only negative is that the product is not free, but there were no problems with the purchase of a license. <br><br>  As a result, everyone agreed that Game Maker is perfect for our tasks, and the development phase began. <br><br> <a href=""><img src="https://habrastorage.org/storage2/cc7/ea9/7c8/cc7ea97c86f708e7debd6b644ca18cc9.png"></a> <br><br>  <i>Developing a client visualizer in Game Maker: Studio</i> <br><br><h4>  Development </h4><br>  Development began six weeks before the start of PHDays III.  But considering that the application should have been validated in the App Store and Google Play, the deadline is exactly one month!  Work went on day and night, in heat and cold.  For all 30 days, two people worked on the visualizer unabated.  Since the server part is in some way just a message translator, there were practically no difficulties with it.  However, we counted on a large number of requests from customers, so caching was implemented, and the amount of traffic forwarded was also minimized. <br><br>  The situation was different with the client, because an unusual programming language was used with its own specifics, with its own API and its own laws. <br><br>  The most unusual part of client development was the creation of a touchscreen interface with scrolling and zoom.  By default, Game Maker provides primitives for working with a multi-touch interface, but the scrolling and scaling of the map had to be developed from scratch.  There is the concept of ‚Äúvisible level region‚Äù with various parameters, such as coordinates, area dimensions, rotation angle, etc. By changing the listed parameters depending on the position of the cursor, it turned out to achieve very good results.  It was also necessary to take into account that the resolution and aspect ratio on different devices can vary greatly, therefore, when the application is initialized, various correction factors are calculated for correct operation and display of all parts of the interface. <br><br>  Another problem was the incorrect display of the effects in the version of the application HTML5.  It turned out that the particle system built into Game Maker, when building games under HTML5, in principle, does not allow the use of additive blending of colors (additive blending) and does not know how to paint particles in different colors if the browser does not support WebGL.  In this regard, we had to create our own particle system, which uses the functions of working with sprites.  Since it was necessary to ensure fast operation of the application on old mobile devices, the particle system turned out to be quite fast and functioned perfectly on all platforms, including HTML5. <br><br>  The final changes in the client part of the visualizer were made a day before the project was completed.  Nevertheless, everything turned out exactly as planned from the very beginning!  In addition to the hard work and insane enthusiasm of the developers, Game Maker helped to meet the short term, in which (despite the peculiarities in the work) a clear and logical interface, good documentation and many features that greatly facilitate the development of games. <br><br><img src="https://habrastorage.org/storage2/bd6/4fa/e4c/bd64fae4cd1e3643d18506708a0801fc.png"><br><br>  <i>Google Play Store Visualizer Page</i> <br><br>  During the whole development process, we did not forget about testing.  At the initial stages, each part of the system was debugged separately, then test games were conducted (there were five of them in total).  Final testing was conducted the day before the game already at the forum site at the World Trade Center. <br><br><h4>  Conclusion </h4><br>  Before the start of the competition, a lot of gray hair added to all of us an unpleasant technical failure: the electrical network could not bear the load when all the teams turned on.  Fortunately, this problem was quickly eliminated with the help of a new electrical panel, and then everything went pretty smoothly.  As a result, the Dutch team Eindbazen became the winner of PHDays CTF, the Americans from PPP were the second, and our compatriots from the team More Smoked Leet Chicken took the third place. <br><br>  That's all.  We hope you were interested to learn about the process of creating the game.  We will be happy to answer questions in the comments.  Thanks for attention! <br><br>  Authors: <a href="https://habrahabr.ru/users/slim_d0g/" class="user_link">slim_d0g</a> <a href="https://habrahabr.ru/users/blackzert/" class="user_link">blackzert</a> <a href="https://habrahabr.ru/users/muodov/" class="user_link">muodov</a> <a href="https://habrahabr.ru/users/ki11obyte/" class="user_link">ki11obyte</a> <a href="https://habrahabr.ru/users/asperka/" class="user_link">Asperka</a> <br><br>  PS A detailed description of the preparation process of the game (including testing) and the full legend of the competition <a href="http://phdays.ru/upload/ctf/ARTICLE_CTF_DEV_v2.pdf">are available</a> on the official PHDays website. </div><p>Source: <a href="https://habr.com/ru/post/186800/">https://habr.com/ru/post/186800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../186786/index.html">DVRs as an attempt to solve all the problems of tech companies</a></li>
<li><a href="../186788/index.html">Sum optimization in PostgreSQL</a></li>
<li><a href="../186792/index.html">CloudEngine. Application for leadership from Huawei. Part 1</a></li>
<li><a href="../186794/index.html">"Pioneers" of the moon race</a></li>
<li><a href="../186796/index.html">Extended ‚ÄúHello! World "on the Flask microform</a></li>
<li><a href="../186804/index.html">Microsoft Smart Watch: Empire Strikes Back</a></li>
<li><a href="../186806/index.html">OpenMCAPI: simultaneous launch of Linux and RTOS on multi-core processors</a></li>
<li><a href="../186812/index.html">Moving beyond the boundaries of the Windows 8 Modern-Application container</a></li>
<li><a href="../186814/index.html">Elon Musk will soon present the project of a new system of passenger transport Hyperloop</a></li>
<li><a href="../186818/index.html">Migration of PROXMOX VE 3.0 to software RAID1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>