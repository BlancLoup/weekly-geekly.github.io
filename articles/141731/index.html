<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic BusyIndicator for asynchronous operations and not only</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Using such a component as BusyIndicator will bring pleasant (process indication) and useful (control lock) qualities into our application. However, un...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic BusyIndicator for asynchronous operations and not only</h1><div class="post__text post__text-html js-mediator-article"> Using such a component as <a href="http://wpftoolkit.codeplex.com/wikipage%3Ftitle%3DBusyIndicator%26referringTitle%3DHome">BusyIndicator will</a> bring pleasant (process indication) and useful (control lock) qualities into our application.  However, until recently, I rarely used it, because  during the asynchronous receiving of the data source, it was necessary to constantly write additional code for switching on / off.  When working synchronously, the situation seems to be simplified, but using the <a href="http://ru.wikipedia.org/wiki/Model-View-ViewModel">MVVM model</a> still requires additional gestures.  Especially if the <code>BusyIndicator</code> added at the very end of form development. <br><br>  Therefore, I decided to automate this process as much as possible so that I would not have to write a single line of code.  So: <br><a name="habracut"></a><br>  <u><b>Formulation of the problem:</b></u> <br><ol><li>  Provide automatic display for any lists that use the value of the <code>ItemsSource</code> property as a data source. </li><li>  A sign that the data is received will be considered as not an empty value of the <code>ItemsSource</code> property. </li><li>  As a <code>BusyIndicator</code> you can use any control as long as it has the <code>boolean</code> <code>IsBusy</code> property. </li><li>  All additional coding should be implemented in the form view (View) and the XAML code should have the following pattern: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BusyIndicator</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemsSource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding DataList, IsAsync=true}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BusyIndicator</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></li></ol><br>  The IsAsync <code>IsAsync=true</code> binding property in the example can be omitted, in this case, the reasoning is not particularly changed, but in this article I will give examples of the exact data acquisition, since  if process indication is required, data acquisition takes considerable time, and if so, then we don‚Äôt want our application to freeze, and if so, then our asynchronous binding is all.  Moreover, it costs us nothing to implement it: IsAsync = true in XAML and in the ViewModel code: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IEnumerable _dataList = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IEnumerable DataList { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_dataList == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) _dataList = Model.GetDataList(...); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _dataList; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_dataList == <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; _dataList = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; NotifyPropertyChanged(<span class="hljs-string"><span class="hljs-string">"DataList"</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshDataList</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { DataList = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first thing that occurred to me (and it even worked visually) was to write something like this: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BusyIndicator</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IsBusy</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding DataList, IsAsync=true, Converter={StaticResource NullToBool}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemsSource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding DataList, IsAsync=true}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BusyIndicator</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  <i><b>Well, who can immediately criticize this code?</b></i> <br><br>  So I didn‚Äôt like it either.  Debugging confirmed my concerns: getting the list happened twice - for <code>BusyIndicator</code> and for the list. <br><br>  ‚ÄúDo not worry!‚Äù - I said and slightly changed the method of obtaining the list: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> _dataListSync = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> nbject(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IEnumerable _dataList = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IEnumerable DataList { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> (_dataListSync) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_dataList == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) _dataList = Model.GetDataList(...); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _dataList; } } }</code> </pre><br><br>  Now the data acquisition happened once and everything worked as it was intended, but I didn't like this method anyway. <br><br>  Firstly, you need to register the converter, secondly, write quite a few identical <i>bukaffs</i> , not forgetting to synchronize the bindings of the list and the indicator, if something changes, thirdly, I‚Äôm not sure that getting the <code>DataList</code> for the indicator will <b>always be</b> called <b>before</b> receiving <code>DataList</code> for the list. <br><br>  The next idea was to use <code>attached property</code> . <br><br>  Until now, I have not been given the opportunity to understand this deeply with a real interesting example, so in the next article, <a href="http://habrahabr.ru/post/142127/">Creating Attached Property for BusyIndicator,</a> I will tell <a href="http://habrahabr.ru/post/142127/">you step by step</a> what I did. <br><br>  <i>Thanks to those who read to the end.</i> </div><p>Source: <a href="https://habr.com/ru/post/141731/">https://habr.com/ru/post/141731/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141726/index.html">You also do not like grupon?</a></li>
<li><a href="../141727/index.html">ACL in FreeSWITCH</a></li>
<li><a href="../141728/index.html">Droider Show # 35. iPad mini and UFO</a></li>
<li><a href="../141729/index.html">We remove the "noise" in situations</a></li>
<li><a href="../141730/index.html">EQalization: eliminating frequency conflicts</a></li>
<li><a href="../141732/index.html">Wikipedia switches from Google Maps to OpenStreetMap</a></li>
<li><a href="../141733/index.html">Website development on the portal WebProfessionals.ru with 70% discount</a></li>
<li><a href="../141737/index.html">Startup for adults</a></li>
<li><a href="../141738/index.html">Total BANAN, or wonders of spoofing poppy addresses in Win7</a></li>
<li><a href="../141739/index.html">How to promote the "Social Network Ark", if this is a fantastic trilogy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>