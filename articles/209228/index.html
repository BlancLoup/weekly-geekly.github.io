<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a client MVC application using RequireJS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As a web developer, you probably often wrote JavaScript code in one file, and when the amount of code gets bigger and bigger, it is difficult to maint...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a client MVC application using RequireJS</h1><div class="post__text post__text-html js-mediator-article">  As a web developer, you probably often wrote JavaScript code in one file, and when the amount of code gets bigger and bigger, it is difficult to maintain.  To solve this problem, you can divide your code into several files, add additional script tags and use global variables to access functions declared in other files.  But it pollutes the global namespace and for each file, an additional HTTP request reduces bandwidth, which increases page load time. <br><br>  If this is familiar to you, you probably realized the need to reorganize your frontend code, especially if you are creating a large-scale web application with thousands of lines of JavaScript code.  We need to reorganize all this confusion in order to make the code easier to maintain.  A new method is to use script loaders.  Many implementations can be found on the Internet, but we will take one of the best ones, called RequireJS. <br><br>  In this step-by-step instruction, you will learn how to build a simple MVC (Model - View - Controller) application using RequireJS.  You will not need any prior knowledge in loading scripts, we will look at the basics in this article. <br><a name="habracut"></a><br><h4>  Introduction </h4><br><h5>  What is RequireJS and how cool it is </h5><br>  RequireJS is an implementation of AMD (Asynchronous Module Definition), an API for declaring modules and their asynchronous loading on the fly when they are needed.  This is the development of James Burke (James Burke) and it reached version 1.0 after two years of development.  RequireJS helps you organize your code using modules and will manage asynchronous and parallel loading of your files for you.  Since the scripts are loaded only when necessary and in parallel, this reduces the page load time, which is very cool! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  MVC on the frontend? </h5><br>  MVC is a well-known pattern for organizing code on the server side, making it modular and supported.  What can be said about its use on the front end?  Can we apply this pattern on javascript?  If you only use JavaScript to animate, test several forms or a few simple methods that do not require many lines of code (say, less than 100 lines), there is no need to structure files using MVC, and probably there is no need to use RequireJS.  However, if you are creating a large web application with many different views, definitely, yes! <br><br><h5>  Create an application </h5><br>  To show how to organize MVC code using RequireJS, we will create a very simple application with 2 views: <br><ul><li>  The first view is a list of users (represented by the name attribute), </li><li>  The second view will allow you to add a user. </li></ul><br><br>  Here is what it will look like: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bbb/3dd/ff3/bbb3ddff332c41598599e0dafeb059e4.png"><br><br>  The business logic will be very simple, so you can focus on understanding what really matters: code structuring.  And since it is so simple, I highly recommend that you try to run this example in parallel with reading the article.  It won't take long, and if you have never resorted to modular programming or using RequireJS before, this example will help you become a more professional programmer.  Seriously, it's worth it. <br><br><h5>  HTML and CSS </h5><br>  This is the text of the HTML file that we will use in the example: <br><br><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!doctype html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>A simple MVC structure<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"css/style.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>My users<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nav</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#list"</span></span></span><span class="hljs-tag">&gt;</span></span>List<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> - <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#add"</span></span></span><span class="hljs-tag">&gt;</span></span>Add<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nav</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"app"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-main</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js/main"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js/require.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  Navigation in our application will be the <i>nav</i> menu links, which will be present on each page of the application, and all the magic of the MVC application will occur in the element <i>&lt;div id = "app"&gt; &lt;/ div&gt;</i> .  We also included RequireJS (which you can download <a href="http://requirejs.org/docs/download.html">here</a> ) at the bottom of the <i>body</i> .  You may notice a special attribute on the <i>script</i> tag: <i>data-main = "js / main"</i> .  The value assigned to this attribute is used by RequireJS as the entry point of the entire application. <br><br>  Let's also add some styles: <br><br><pre> <code class="css hljs"><span class="hljs-selector-id"><span class="hljs-selector-id">#container</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">font-family</span></span>:Calibri, Helvetica, serif; <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>:<span class="hljs-number"><span class="hljs-number">#444</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>:<span class="hljs-number"><span class="hljs-number">200px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>:<span class="hljs-number"><span class="hljs-number">100px</span></span> auto <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>:<span class="hljs-number"><span class="hljs-number">30px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border</span></span>:<span class="hljs-number"><span class="hljs-number">1px</span></span> solid <span class="hljs-number"><span class="hljs-number">#ddd</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>:<span class="hljs-number"><span class="hljs-number">#f6f6f6</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">-webkit-border-radius</span></span>:<span class="hljs-number"><span class="hljs-number">4px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">-moz-border-radius</span></span>:<span class="hljs-number"><span class="hljs-number">4px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-radius</span></span>:<span class="hljs-number"><span class="hljs-number">4px</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">h1</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">nav</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">text-align</span></span>:center; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">20px</span></span>; }</code> </pre><br><br><h5>  Remembering OOP: What is a module? </h5><br>  In object-oriented JavaScript programming, there is a very common pattern called Module Template.  It is used to encapsulate methods and attributes in objects (which are ‚Äúmodules‚Äù) to avoid contamination of the global namespace.  It is also used to partially imitate classes from other OOP languages, such as Java or PHP.  An example of how you can define a simple MyMath module in our main.js file: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> MyMath = (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//       return { //     add:function(a, b){ return a + b; } }; })(); console.log(MyMath.add(1, 2));</span></span></code> </pre><br><br>  Public methods are declared using the object in literal notation, which is not very convenient.  Alternatively, you can use the Module Discovery Template, which returns private attributes and methods: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> MyMath = (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//         : function add(a, b){ return a + b; } return { add:add //        ! }; })(); console.log(MyMath.add(1, 2));</span></span></code> </pre><br><br>  I will use the Module Discovery Template for the rest of the article. <br><br><h4>  RequireJS </h4><br><h5>  Module Description with RequireJS </h5><br>  In the previous section, we defined a module in a variable for its further call.  This is just one way to declare a module.  We will now look at another method used by RequireJS.  The goal of RequireJS is to split our JavaScript files for easier maintenance, so let's create the file <i>MyMath.js</i> to define our module <i>MyMath</i> , in the same folder as <i>main.js</i> : <br><br><pre> <code class="javascript hljs">define(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">add</span></span>:add }; });</code> </pre><br><br>  Instead of declaring a variable, we simply put the module as a parameter to the <i>define</i> function.  This function is defined in RequireJS and it makes our module accessible from outside. <br><br><h5>  Module loading in the main file </h5><br>  Let's go back to our <i>main.js</i> file.  RequireJS provides another function called <i>require</i> , which we use to call our module <i>MyMath</i> .  This is how our <i>main.js</i> looks like now: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>([<span class="hljs-string"><span class="hljs-string">'MyMath'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">MyMath</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(MyMath.add(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)); });</code> </pre><br><br>  The call to the <i>MyMath</i> module <i>is</i> now wrapped in a <i>require</i> function that takes two parameters: <br><ul><li>  An array of modules that we want to load, declared paths to them relative to the entry point (remember the <i>data-main</i> attribute in HTML) and without the .js extension, </li><li>  The function is called after these dependencies are loaded.  The modules will be passed as parameters to this function, so you can simply call these parameters as module names. </li></ul><br><br>  Now you can reload the page.  Just like that you call a method from another file!  Yes, it was very simple and now you are ready for the big and awesome MVC architecture (which works just like the definition of the module you just made, so be sure you can handle it perfectly!). <br><br><h4>  MVC structure </h4><br>  <i><b>Important note</b> : In this tutorial we will simulate the MVC structure, often used on the server side, in which one controller corresponds to the representation.</i>  <i>In front-end development, it is common to use several views with one controller.</i>  <i>In this case, the representations are visual components, such as buttons or input fields.</i>  <i>MVC JavaScript frameworks such as Backbone use a different approach, which is not the purpose of this article.</i>  <i>My goal is not to create a real MVC framework, but simply to show how RequireJS can be used in a structure that many of you are familiar with.</i> <br><br>  Let's start by creating folders and files for our project.  We will use models to present data, business logic will be concentrated in the controllers, and these controllers will invoke certain views to display the pages.  What do you think?  We need 3 folders: Models, Controllers and Views.  Given the simplicity of our application, we will have 2 controllers, 2 views and 1 model.  Our javascript folder now looks like this: <br><br><ul><li>  Controllers <br><ul><li>  AddController.js </li><li>  ListController.js </li></ul><br></li><li>  Models <br><ul><li>  User.js </li></ul><br></li><li>  Views <br><ul><li>  AddView.js </li><li>  ListView.js </li></ul><br></li><li>  main.js </li><li>  require.js </li></ul><br><br>  So the structure is ready.  Let's start with the implementation of the simplest part: this is a model. <br><br><h4>  Model: User.js </h4><br>  In this example, <i>user</i> is a simple class with one name attribute: <br><br><pre> <code class="javascript hljs">define(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name || <span class="hljs-string"><span class="hljs-string">'Default name'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> User; });</code> </pre><br><br>  If we now return to our <i>main.js</i> file, we can now declare a dependency on User in the <i>require</i> method, and manually create a set of users for this example: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>([<span class="hljs-string"><span class="hljs-string">'Models/User'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">User</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> users = [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">'Barney'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">'Cartman'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">'Sheldon'</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, len = users.length; i &lt; len; i++){ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(users[i].name); } localStorage.users = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(users); });</code> </pre><br><br>  Then we serialize an array of users in JSON and store it in the HTML5 local storage to make them available as in a database: <br><br><img src="http://habrastorage.org/storage3/80f/512/510/80f512510a643a1e520900690f37395f.png"><br><br>  <i><b>Note</b> : to serialize JSON with the stringify method and deserialize with the parse method, you need any polyfill library, so that the example would work in IE7 and earlier.</i>  <i>For this you can use the Douglas Crockford json2.js library from the <a href="https://github.com/douglascrockford/JSON-js">Github repository</a> .</i> <br><br><h5>  We display the list of users </h5><br>  It's time to show the list of users in the interface of our application.  For this we will use <i>ListController.js</i> and <i>ListView.js</i> .  Obviously, these two components are related.  There are many ways to do this, but to keep our example simple, I suggest: The <i>ListView</i> will have a <i>render</i> method and our <i>ListController</i> will simply get users from the local repository and call the <i>render</i> method of the <i>ListView</i> , passing users as a parameter.  So obviously, <i>ListController</i> needs a dependency on <i>ListView</i> . <br><br>  Just as in <i>require</i> , you can pass an array of dependencies to <i>define</i> if the module depends on other modules.  Let's also create a <i>start</i> method (or with some other name that seems meaningful to you, such as <i>run</i> or <i>main</i> ) to describe the main controller behavior in it: <br><br><pre> <code class="javascript hljs">define([<span class="hljs-string"><span class="hljs-string">'Views/ListView'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ListView</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> users = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(localStorage.users); ListView.render({<span class="hljs-attr"><span class="hljs-attr">users</span></span>:users}); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">start</span></span>:start }; });</code> </pre><br><br>  Here we deserialize the list of users from the local repository and pass it to the <i>render</i> method as an object.  Now, all we need to do is implement the <i>render</i> method in <i>ListView.js</i> : <br><br><pre> <code class="javascript hljs">define(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">parameters</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> appDiv = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'app'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> users = parameters.users; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> html = <span class="hljs-string"><span class="hljs-string">'&lt;ul&gt;'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, len = users.length; i &lt; len; i++){ html += <span class="hljs-string"><span class="hljs-string">'&lt;li&gt;'</span></span> + users[i].name + <span class="hljs-string"><span class="hljs-string">'&lt;/li&gt;'</span></span>; } html += <span class="hljs-string"><span class="hljs-string">'&lt;/ul&gt;'</span></span>; appDiv.innerHTML = html; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">render</span></span>:render }; });</code> </pre><br><br>  This method simply loops through the users and combines their names into an HTML string that we insert into the element. <br><br>  <i><b>Important</b> : Using HTML in a JavaScript file, as in this example, is not the best solution, because it is very difficult to maintain.</i>  <i>Instead, you should look at the templates.</i>  <i>Templates are an elegant way to insert data into HTML.</i>  <i>There are many good template engines on the Internet.</i>  <i>For example, you can use <a href="https://github.com/jquery/jquery-tmpl">jQuery-tmpl</a> or <a href="https://github.com/jquery/jquery-tmpl">mustache.js</a> .</i>  <i>But this is beyond the scope of this article, and would add complexity to the current architecture, I preferred to make it as simple as possible.</i> <br><br>  Now, all we need to do is ‚Äúrun‚Äù our <i>ListController</i> module.  To do this, let's declare it as a dependency in our <i>main.js</i> file, and call the <i>ListController.start ()</i> method: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>([<span class="hljs-string"><span class="hljs-string">'Models/User'</span></span>, <span class="hljs-string"><span class="hljs-string">'Controllers/ListController'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">User, ListController</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> users = [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">'Barney'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">'Cartman'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">'Sheldon'</span></span>)]; localStorage.users = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(users); ListController.start(); });</code> </pre><br><br>  Now you can refresh the page to see this wonderful list of users: <br><br><img src="http://habrastorage.org/storage3/bd8/087/7cd/bd80877cd9fd54176a97fe96d8c4b4ac.png"><br><br>  Yes it works!  Congratulations, if you followed an example in parallel and got the same result! <br><br>  <i><b>Note</b> : At the moment, we can only manually declare the controller that we want to run, since we do not have any routing system yet.</i>  <i>But we will soon create one very simple.</i> <br><br><h5>  Add user </h5><br>  Now we need the ability to add users to the list.  We will display a simple input field and a button, with an event handler when you click on the button in which we will add the user to the local storage.  Let's start with <i>AddController</i> , as in the previous section.  This file will be very simple, since we do not have parameters to pass them to the view.  This is <i>AddController.js</i> : <br><br><pre> <code class="javascript hljs">define([<span class="hljs-string"><span class="hljs-string">'Views/AddView'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AddView</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ AddView.render(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">start</span></span>:start }; });</code> </pre><br><br>  And the corresponding representation: <br><br><pre> <code class="javascript hljs">define(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">parameters</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> appDiv = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'app'</span></span>); appDiv.innerHTML = <span class="hljs-string"><span class="hljs-string">'&lt;input id="user-name" /&gt;&lt;button id="add"&gt;Add this user&lt;/button&gt;'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">render</span></span>:render }; });</code> </pre><br><br>  Now you can declare <i>AddController</i> as a dependency in the main file and call its <i>start</i> method to see the expected representation: <br><br><img src="http://habrastorage.org/storage3/291/50c/c46/29150cc46b2a2ab204fc11d84a4439b0.png"><br><br>  But since we do not yet have a link to button events, this presentation is not very useful ... Let's work on it.  I have a question for you: Where should we place the logic to handle this event?  In the view or in the controller?  If we post in a view, this will be the right place to add a subscription to an event, but placing business logic in a view will be a very bad practice.  Placing the logic in the controller seems to be the best idea, even if it is not perfect, because we don‚Äôt want to see here any mention of html elements that relate to the view. <br><br>  <i><b>Note</b> : the best way would be to place event handlers in the view that would call business logic methods located in the controller or in a dedicated event module.</i>  <i>This is easy to do, but it would complicate the example, and I do not want you to get confused.</i>  <i>Try it for practice!</i> <br><br>  As I said, let's put all the logic of the event in the controller.  We need to create the <i>bindEvents</i> function in <i>AddController</i> and call it after the view has finished displaying the HTML: <br><br><pre> <code class="javascript hljs">define([<span class="hljs-string"><span class="hljs-string">'Views/AddView'</span></span>, <span class="hljs-string"><span class="hljs-string">'Models/User'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AddView, User</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ AddView.render(); bindEvents(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bindEvents</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'add'</span></span>).addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> users = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(localStorage.users); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> userName = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'user-name'</span></span>).value; users.push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(userName)); localStorage.users = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(users); <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>([<span class="hljs-string"><span class="hljs-string">'Controllers/ListController'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ListController</span></span></span><span class="hljs-function">)</span></span>{ ListController.start(); }); }, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">start</span></span>:start }; });</code> </pre><br><br>  In <i>bindEvents</i> , we simply add an event listener for the click on the <i>#add</i> button (feel free to use your own function if you are working with <i>attachEvent</i> in IE - or just using jQuery).  When the button is clicked, we get a row of users from the local repository, deserialize it to get an array, add a new user with the name contained in the input field <i># user-name</i> , and put the updated array of users into the local repository.  After that, we finally load the <i>ListController</i> to execute its <i>start</i> method, and we can see the result: <br><br><img src="http://habrastorage.org/storage3/b1e/859/2fd/b1e8592fded2edccadf85786c37f9673.png"><br><br>  Wonderful!  It's time for you to get some rest; you did a good job if you followed the example with me. <br><br><h4>  Navigating between views using routes </h4><br>  Our small application is cool, but it's really bad that we still cannot navigate between views to add new users.  Not enough routing system.  If you have previously worked with server MVC frameworks, you are probably familiar with such a system.  Each URL leads to a presentation.  However, now we are on the client side, and the situation is slightly different.  Single-page JavaScript applications like this use a hash to navigate between different parts of the application.  In our case, we want to display two different views when these URLs open: <br><ul><li>  <a href="http://localhost/">localhost / # list</a> </li><li>  <a href="http://localhost/">localhost / # add</a> </li></ul><br><br>  This will allow you to bookmark each page of the application. <br><br>  <i><b>Note</b> : Firefox, Chrome and Opera have good HTML5 history management support (PushState, popState, replaceState), which avoids working with hashes.</i> <br><br><h5>  Browser functionality and compatibility </h5><br>  History management and hash navigation can be a weak point if you require good compatibility with older browsers.  Depending on the browsers that you want to support, you can consider various ways to track routes: <br><ul><li>  <a href="http://caniuse.com/">Only the most advanced browsers</a> : HTML5 history management, </li><li>  <a href="http://caniuse.com/">Most modern browsers</a> : HTML5 hash change event, </li><li>  Older browsers: Manual monitoring of hash changes, </li><li>  Very old browsers: Manual monitoring and iframe hack. </li></ul><br><br>  In our case, we use simple manual monitoring, which is fairly easy to implement.  All we have to do is check the hash change every n milliseconds, and run some functions in case a change is detected. <br><br>  <i><b>Note</b> : A jQuery plugin is also available to control this process.</i> <br><br><h5>  Routes and Main Routing Loop </h5><br>  Let's create a <i>Router.js</i> file next to <i>main.js</i> to control the routing logic.  At the beginning of this file, we need to declare our routes and set the default route if it is not listed in the URL.  We can, for example, use a simple array of route objects that contain hashes and their corresponding controllers that need to be loaded.  We also need <i>defaultRoute</i> if the hash is not in the URL: <br><br><pre> <code class="javascript hljs">define(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> routes = [{<span class="hljs-attr"><span class="hljs-attr">hash</span></span>:<span class="hljs-string"><span class="hljs-string">'#list'</span></span>, <span class="hljs-attr"><span class="hljs-attr">controller</span></span>:<span class="hljs-string"><span class="hljs-string">'ListController'</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">hash</span></span>:<span class="hljs-string"><span class="hljs-string">'#add'</span></span>, <span class="hljs-attr"><span class="hljs-attr">controller</span></span>:<span class="hljs-string"><span class="hljs-string">'AddController'</span></span>}]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> defaultRoute = <span class="hljs-string"><span class="hljs-string">'#list'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> currentHash = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startRouting</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash || defaultRoute; setInterval(hashCheck, <span class="hljs-number"><span class="hljs-number">100</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">startRouting</span></span>:startRouting }; });</code> </pre><br><br>  When the <i>startRouting</i> method is <i>called</i> , it sets the default value of the hash to the URL and starts the repeated call of the <i>hashCheck</i> method, which we have not yet implemented.  The <i>currentHash</i> variable will be used to store the current hash value if a change was detected. <br><br><h5>  Check hash changes </h5><br>  This is the <i>hashCheck</i> function, which is called every 100 milliseconds: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hashCheck</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash != currentHash){ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, currentRoute; currentRoute = routes[i++];){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash == currentRoute.hash) loadController(currentRoute.controller); } currentHash = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash; } }</code> </pre><br><br>  <i>hashCheck</i> simply checks if the hash has changed from <i>currentHash</i> , and if it matches one of the routes, it calls <i>loadController</i> with the corresponding controller name. <br><br><h5>  Loading the desired controller </h5><br>  Finally, <i>loadController</i> simply calls the <i>require function</i> to load the controller module and calls its <i>start</i> function: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadController</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">controllerName</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>([<span class="hljs-string"><span class="hljs-string">'Controllers/'</span></span> + controllerName], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">controller</span></span></span><span class="hljs-function">)</span></span>{ controller.start(); }); }</code> </pre><br><br>  So, the final version of the <i>Router.js</i> file looks like this: <br><br><pre> <code class="javascript hljs">define(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> routes = [{<span class="hljs-attr"><span class="hljs-attr">hash</span></span>:<span class="hljs-string"><span class="hljs-string">'#list'</span></span>, <span class="hljs-attr"><span class="hljs-attr">controller</span></span>:<span class="hljs-string"><span class="hljs-string">'ListController'</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">hash</span></span>:<span class="hljs-string"><span class="hljs-string">'#add'</span></span>, <span class="hljs-attr"><span class="hljs-attr">controller</span></span>:<span class="hljs-string"><span class="hljs-string">'AddController'</span></span>}]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> defaultRoute = <span class="hljs-string"><span class="hljs-string">'#list'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> currentHash = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startRouting</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash || defaultRoute; setInterval(hashCheck, <span class="hljs-number"><span class="hljs-number">100</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hashCheck</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash != currentHash){ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, currentRoute; currentRoute = routes[i++];){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash == currentRoute.hash) loadController(currentRoute.controller); } currentHash = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadController</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">controllerName</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>([<span class="hljs-string"><span class="hljs-string">'Controllers/'</span></span> + controllerName], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">controller</span></span></span><span class="hljs-function">)</span></span>{ controller.start(); }); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">startRouting</span></span>:startRouting }; });</code> </pre><br><br><h5>  Using a new routing system </h5><br>  All we have to do is load this module in our main file and call the <i>startRouting</i> method: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>([<span class="hljs-string"><span class="hljs-string">'Models/User'</span></span>, <span class="hljs-string"><span class="hljs-string">'Router'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">User, Router</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> users = [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">'Barney'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">'Cartman'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">'Sheldon'</span></span>)]; localStorage.users = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(users); Router.startRouting(); });</code> </pre><br><br>  If we want to move in our application from one controller to another, we can simply replace the current <i>window.hash</i> with the hash of the route of another controller.  In our case, we still manually load the <i>ListController</i> from <i>AddController</i> instead of using our new routing system: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>([<span class="hljs-string"><span class="hljs-string">'Controllers/ListController'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ListController</span></span></span><span class="hljs-function">)</span></span>{ ListController.start(); });</code> </pre><br><br>  Let's replace these three lines with a simple hash update: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.hash = <span class="hljs-string"><span class="hljs-string">'#list'</span></span>;</code> </pre><br><br>  That's all!  Our application now has a functional routing system!  You can move from one view to another, go back, do whatever you want with the hash in the URL, and the correct controller will load if the corresponding routes are announced in the router. <br><br>  Here is a <a href="http://verekia.com/demo/require-js/">link</a> to the online demo of this application. <br><br><h4>  findings </h4><br>  You can be proud of yourself, you have written the MVC application without using any frameworks!  We only used RequireJS to merge our files, this is the only essential tool to build a modular structure.  So what are the next steps?  If you like the minimalist approach in the DIY style, as in this example, you can enrich our little framework with new features as your application grows and new technical needs appear.  Here are some options for future steps: <br><br><ul><li>  Integrate templating system, </li><li>  Create a small external library to put into it everything that is not directly related to your application (for example, the routing system) to be able to use it in other projects, </li><li>  Describe in the form of objects a model, a view and a representation in this library, </li><li>  Create a new abstraction layer for retrieving data from various sources (RESTful API, LocalStorage, IndexedDB ...). </li></ul><br><br>  This example is great for learning, but our framework is not really ready for use in real projects.  If you are too lazy to add the functionality listed above (and this list is not exhaustive!), You can start exploring one of the existing MVC frameworks.  Here are some of the most popular: <br><br><ul><li>  <a href="http://documentcloud.github.com/backbone/">Backbone</a> </li><li>  <a href="http://javascriptmvc.com/">Javascript mvc</a> </li><li>  <a href="http://www.sproutcore.com/">Sproutcore</a> </li><li>  <a href="http://www.sencha.com/products/extjs/">Extjs</a> </li><li>  <a href="http://knockoutjs.com/">Knockout</a> </li></ul><br><br>  <a href="http://verekia.com/requirejs/build-simple-client-side-mvc-app-require-js">Original article in English</a> . </div><p>Source: <a href="https://habr.com/ru/post/209228/">https://habr.com/ru/post/209228/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209216/index.html">Additional physical modeling techniques in Teradata</a></li>
<li><a href="../209218/index.html">The best time to learn microcontrollers</a></li>
<li><a href="../209220/index.html">What unites NASA, Oculus Rift and Kinect 2?</a></li>
<li><a href="../209224/index.html">Happy Birthday, Wikipedia!</a></li>
<li><a href="../209226/index.html">How to move from java to scala in your project</a></li>
<li><a href="../209230/index.html">HuGu - the collective player of Vkontakte music on node.js</a></li>
<li><a href="../209232/index.html">Chef Patterns and Antipatterns</a></li>
<li><a href="../209234/index.html">GreenCubes: from Minecraft to MMORPG for 4 (?) Years</a></li>
<li><a href="../209236/index.html">AWS Test Drive - Amazon's Sandbox</a></li>
<li><a href="../209238/index.html">Test Kitchen for beginners</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>