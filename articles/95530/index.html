<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MiTM for GPRS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Everyone has their own secrets ... someone has a secret correspondence with a loved one, someone has multi-million banking operations, someone has pri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MiTM for GPRS</h1><div class="post__text post__text-html js-mediator-article">  Everyone has their own secrets ... someone has a secret correspondence with a loved one, someone has multi-million banking operations, someone has private pictures on their mobile :) <br><br>  Yes, and it doesn‚Äôt matter what secrets the most important thing is, that practically everyone has them.  With today's frantic pace of life, it is increasingly necessary to use data transfer on the road, often via mobile devices.  It‚Äôs good if the relatively ‚Äúsecure‚Äù BlackBerry is used as a mobile terminal, and what if it is a ‚Äúregular‚Äù phone with GPRS / EDGE output. <br><br><a name="habracut"></a><br><h4>  Intro </h4><br>  Have you ever wondered, and how secure is data transmission via GPRS / EDGE technology through the operator's mobile network? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We will not say that the operator can disable interface encryption for the duration of the tests, or the operator can use the weaker encryption protocol [GEA - GPRS Encryption Algorithm], which will allow the use of radio interface encryption defects and intercept and analyze data transmission.  In this article we will talk about one seemingly unlikely, but fully realistic, threat ‚Äî an insider incursion. <br><br>  So what do we have ... <br><br><h4>  Scheme </h4><br>  A simplified wiring diagram for the GPRS / EDGE packet architecture is presented in the diagram below: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/daf/0a8/175/daf0a8175e93266622a8f13eabc35db3.jpg" alt="image"></div><br>  Suppose, purely hypothetically, that an operator has ‚Äúwound up‚Äù an operator who is very interested in collecting confidential information from mobile data transfer users. <br><br>  Suppose also.  that our insider has access to the Gn interface.  The Gn interface is a direct link from <a href="http://ru.wikipedia.org/wiki/SGSN">SGSN</a> 'and on the <a href="http://ru.wikipedia.org/wiki/GGSN">GGSN</a> , the bandwidth is selected based on the existing load, usually two (to ensure duplication) 1000-fullduplex Ethernet link. <br><br>  For more specificity, let's set additional initial conditions: <br><ol><li>  The operator uses encryption of the radio interface from the subscriber to the SGSN'a - GEA-1,2,3 algorithms. <br><blockquote>  In principle, in this situation, it doesn‚Äôt matter whether the encryption algorithm is applied before SGSN, since  Our insider will try to ‚Äúcatch‚Äù information on the Gn interface, which in most cases is not encrypted. </blockquote><br></li><li>  The subscriber transmits data without stream encryption, i.e.  connects <b>NOT</b> via VPN [L2TP, PPTP, IPSec]. <br><blockquote>  This moment is quite important to our insider, because  if the subscriber encrypts the data stream with software, then on the Gn interface the insider will ‚Äúsee‚Äù the encrypted stream.  This measure, of course, does not give a 100% guarantee of the security of data transmission, but the methods that our insider will take will be much more complicated and ultimately will be based on the value of the possible information.  Consideration of these methods is beyond the scope of this article. </blockquote><br></li><li>  An insider has direct access to SGSN or GGSN. <br><blockquote>  One of the conditions necessary for our insider is access to one of the network elements within the PS Core Network (packet network) - SGSN or GGSN.  What does this provide an insider?  The simplest thing that comes to mind is to establish a duplication of data flow over the Gn interface [port SPANing] on the Ethernet interface, to which you can connect using a laptop, since  Behind the ‚Äúborder‚Äù of SGSN is the already ‚Äúclean‚Äù IP Backbone operator.  A more sophisticated method is setting up filters on the network element itself for a specific subscriber.  Subscriber identification can be carried out by <a href="http://ru.wikipedia.org/wiki/IMSI">IMSI</a> , <a href="http://ru.wikipedia.org/wiki/TMSI">TMSI</a> , P-TMSI, <a href="http://ru.wikipedia.org/wiki/IMEI">IMEI</a> , <a href="http://ru.wikipedia.org/wiki/MSISDN">MSISDN</a> , or by IP / X.25 addresses assigned to the subscriber in the mobile network of the operator. </blockquote><br></li></ol><br>  Let us now consider a non-trivial situation in order to understand what an insider can do on an operator‚Äôs network, having access to one or several network elements and taking into account the initial conditions we have set. <br><br><h4>  Collection of confidential information from an online stream </h4><br>  An insider connection scheme in the operator‚Äôs network is shown in the diagram below (the diagram shows several connection diagrams for the insider‚Äôs laptop, but only one connection will be sufficient to collect confidential information): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/f1d/1e4/8ee/f1d1e48eede37d5e8b0839d527dd6ccb.jpg" alt="image"></div><br>  Suppose that our insider uses the console utility from Wireshak'a - tshark. <br><br>  An example filter, ‚Äúconcocted‚Äù in haste to intercept subscriber packets destined for one of the popular social networks, will look like this: <br><br> <code>tshark.exe -i 6 -B 16 -n -R "(http.host == "login.vk.com") &amp;&amp; (http.request.method == "POST")" -V -l -T text -wd:\dump -a filesize:16000 -b filesize:16000 -b files:2 -S &gt;&gt; d:\vpass_db.txt</code> <br> <br>  I think it makes no sense to describe the parameters of the tshark.exe utility, who are interested can be found <a href="http://www.wireshark.org/docs/man-pages/tshark.html">here</a> .  A little ‚Äúclean‚Äù file: <br><br> <code>type vps.txt | findstr /I /L "email %40 pass" | findstr /V "Referer" | sort &gt;&gt; passdb.txt</code> <br> <br>  If an insider has access to one of the SGSN or GGSN network elements, then having completed all the above steps, he can carry out a kind of <a href="http://ru.wikipedia.org/wiki/MITM">MITM</a> attack by duplicating part of the stream to another port, connecting a laptop to this port.  Thus, having carried out such an attack, our insider will collect logins / passwords from a popular social network, thereby obtaining confidential information of subscribers of a mobile operator. <br><br><h4>  Outro </h4><br>  Naturally, many may say that I have not told anything new in this article, because  any system administrator in a large company can also easily compromise any user by putting it ‚Äúin pencil‚Äù, but I just wanted to say that you should not forget about the precautions when transferring important information to you, even if you use packet data transmission with the help of technologies GPRS / EDGE ... <br><br>  <b>PS: the whole article is based only on my fantasies and has nothing to do with reality, but is intended only to familiarize with possible methods of removing traces from the Gn interface.</b>  <b>I do not call to commit unlawful actions aimed at the collection and disclosure of confidential information relating both to the cellular operator, and information relating to personal data of subscribers.</b> <br><br>  <b><i>A small assistant:</i></b> <br><br>  <b>BSC</b> - Base Station Controller <br>  <b>BTS</b> - Base Transceiver Station <br>  <b>EDGE</b> - Enhanced Data rates for GSM Evolution <br>  <b>GGSN</b> - Gateway GPRS Support Node <br>  <b>GPRS</b> - General Packet Radio Service <br>  <b>IMEI</b> - International Mobile Equipment Identity <br>  <b>IMSI</b> - International Mobile Subscriber Identity <br>  <b>ISDN</b> - Integrated Services Digital Network <br>  <b>L2TP</b> - Layer 2 Tunneling Protocol <br>  <b>MS</b> - Mobile Station <br>  <b>MSISDN</b> - Mobile Station ISDN Number <br>  <b>PPTP</b> - Point-to-Point Tunneling Protocol <br>  <b>PS</b> - Packet Switched <br>  <b>P-TMSI</b> - Packet TMSI <br>  <b>SGSN</b> - Serving GPRS Support Node <br>  <b>TMSI</b> - Temporary Mobile Subscriber Identity <br>  <b>VPN</b> - Virtual private network <br><br> <a href="http://fastgoogle.ru/microcounter/microcounter.php%3Faction%3Dresults%26id%3D1012"><img src="http://fastgoogle.ru/microcounter/counter/1012.gif"></a> </div><p>Source: <a href="https://habr.com/ru/post/95530/">https://habr.com/ru/post/95530/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../95518/index.html">New laptops from ASUS and Lamborghini</a></li>
<li><a href="../95520/index.html">Automotive X-Prize: 25 applicants for 10 million</a></li>
<li><a href="../95521/index.html">Useful and interesting modules for Drupal 6.xx + Tips and Tricks (Part III)</a></li>
<li><a href="../95526/index.html">2000 hours alone, or as an RSS reader was made / I am a robocop</a></li>
<li><a href="../95528/index.html">Do not rush to upgrade your HTC Hero to Android 2.1</a></li>
<li><a href="../95535/index.html">What does the coming day prepare for us? Or start-up parties in the summer</a></li>
<li><a href="../95538/index.html">Memory structuring</a></li>
<li><a href="../95540/index.html">Google Maps offers a stroll to Edinburgh through France and Belgium</a></li>
<li><a href="../95541/index.html">Make3D from one photo, part 1</a></li>
<li><a href="../95542/index.html">Radio technology of the 21st century</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>