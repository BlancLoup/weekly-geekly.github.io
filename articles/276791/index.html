<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Export, import to Node.JS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It seems, everything is simple and clear: 



var module = require("./some_module.js"); module.f(); // console.log(module.obj); // module(); //   
 To...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Export, import to Node.JS</h1><div class="post__text post__text-html js-mediator-article">  It seems, everything is simple and clear: <br><br><pre><code class="hljs coffeescript">var <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"./some_module.js"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.f(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.obj); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   </code> </pre> <br>  To export something in the module itself, you need to register: <br><br><pre> <code class="hljs lua">exports.f = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">123</span></span>; }; exports.obj = { name: <span class="hljs-string"><span class="hljs-string">"Foobar"</span></span>, age: <span class="hljs-number"><span class="hljs-number">33</span></span> }; //   ,      //     ! module.exports = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"I have not a name"</span></span>; }</code> </pre> <br>  Why not always work? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The answer to this question lies in understanding the work of the require () function. <a name="habracut"></a><br><br>  When calling require (), as I understood, it creates an object called exports, reads the transferred file into a variable, and executes all the code from that variable.  After that, it returns us the exports object that was modified during the execution of the code. <br><br>  Let's try to create our own require () function.  To simplify the perception, we will pass to our function not the file name, but already, as it were, the contents of the file as a string variable.  Let's call her script. <br><br>  The definition of our require function will look like this: <br><br><pre> <code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">require</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">script</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> exports = {}; <span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(script); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> exports; }</code> </pre> <br>  But what if we need to export an unnamed object?  Remember <code>module.exports = function() {}</code> ?  Add an object with the name module, and assign its object to its exports property. <br><br>  Our require function is a bit more complicated: <br><br><pre> <code class="hljs java"><span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">require</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(script)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> = {}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> = {}; eval(script); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span>; }</code> </pre> <br>  Run the test: <br><br><pre> <code class="hljs ruby">var script = <span class="hljs-string"><span class="hljs-string">"exports.foo = 'foo'; exports.bar = 'bar';"</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   var foobar = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(script); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  console.log(foobar.foo); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> : foo console.log(foobar.bar); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> : bar</code> </pre> <br>  Works! <br><br>  We start the test with the export of an unnamed object: <br><br><pre> <code class="hljs ruby">var script = <span class="hljs-string"><span class="hljs-string">"module.exports = function() { return 'foobar'; }"</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   var foobar = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(script); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  console.log(foobar()); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> : foobar</code> </pre> <br>  It works too. <br><br>  We start the test with the export of anonymous object and named objects of the module: <br><br><pre> <code class="hljs ruby">var script = <span class="hljs-string"><span class="hljs-string">"exports.arr = [1, 2, 3]; module.exports = function() { return 'foobar'; }"</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   var foobar = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(script); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  console.log(foobar()); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> : foobar console.log(foobar.arr); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> : undefined</code> </pre> <br>  Does not work! <br><br>  By the way, it does not work when using the standard node.js require () function.  This shows that our function is not much different from it, and we are on the right track. <br><br>  But how can we export both untitled and named objects?  The answer is that you only need to use module.exports, moreover, named objects are necessarily exported after unnamed. <br><br>  We will correct the previous example: <br><br><pre> <code class="hljs ruby">var script = <span class="hljs-string"><span class="hljs-string">"module.exports = function() { return 'foobar'; }\n"</span></span> + <span class="hljs-string"><span class="hljs-string">"module.exports.arr = [1, 2, 3];\n"</span></span> + <span class="hljs-string"><span class="hljs-string">"module.exports.result = 'Ok'\n"</span></span>; var foobar = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(script); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  console.log(foobar()); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> : foobar console.log(foobar.arr); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> : [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] console.log(foobar.result); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> : Ok</code> </pre> <br>  Works! <br><br>  I hope that my examples, dear reader, helped you to understand more deeply the mechanism of export-import of modules to node.js.  At first glance, it is very simple, as the developers themselves write about.  But without an understanding of how the built-in function requires (), sometimes you find yourself alone with the wonderful results of your code. <br></div><p>Source: <a href="https://habr.com/ru/post/276791/">https://habr.com/ru/post/276791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276781/index.html">REST + RPC API based service technology is done in turbo mode</a></li>
<li><a href="../276783/index.html">The digest of news from the world of development on Unity</a></li>
<li><a href="../276785/index.html">Business Studio System Analysis</a></li>
<li><a href="../276787/index.html">Bookmark in OS X, extending battery life for selected applications</a></li>
<li><a href="../276789/index.html">Oracle fixes serious Java vulnerability for Windows</a></li>
<li><a href="../276793/index.html">The book "Swift. Basics of developing applications for iOS ¬ª</a></li>
<li><a href="../276795/index.html">Manage Hyper-V Failover Clusters with 5nine Manager</a></li>
<li><a href="../276799/index.html">We sell our dropDown ViewController (aka iOS 8 Mail app) in 200 lines</a></li>
<li><a href="../276801/index.html">In simple words about a particle filter</a></li>
<li><a href="../276803/index.html">IaaS trends brief</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>