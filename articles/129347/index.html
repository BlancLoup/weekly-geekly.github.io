<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Computer-to-computer connection over the Internet with dynamic IP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Very often we hear that establishing a computer-to-computer connection over the Internet with dynamic IPs is impossible without an external server. 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Computer-to-computer connection over the Internet with dynamic IP</h1><div class="post__text post__text-html js-mediator-article">  Very often we hear that establishing a computer-to-computer connection over the Internet with dynamic IPs is impossible without an external server. <br>  And also thought, until a certain time.  Then my suspicions crept in ... And after I learned a lot <s>and secret</s> things. <br><br>  However, Skype, ICQ to transfer files, torrents, in the end, somehow use a direct connection. <br>  How?  That's what I want to tell. <br><br>  <i>All matches are random, the numbers were originally invented.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  In fact, without an external server this is really unreal.  But there are "hacks" and "fashion" that will help us. <br>  I will chew hard.  Some of my explanations may not coincide with reality, but this is done to make it clear how and what works, since in practice this knowledge is enough. <br><br><h4>  Theory </h4><br><br>  NAT is what gives each of us the ability to connect to the Internet who sits with IPv4.  If you give each computer an IPv4 address, they are not enough. <br>  NAT allows us to hide certain services only for the network ... And precisely because of it we cannot, in the majority, reach the computer from the Internet. <br><br>  Imagine that you are connecting to an FTP server in passive mode. <br>  Your external address: 43.12.102.14 <br>  Your internal address: 192.168.0.2 <br>  Your NAT Address: 192.168.0.1 <br><br>  You create a TCP connection with your IP 192.168.0.2, create a request for an address with a 21 port. <br><br>  Next, the request goes to your NAT, which creates a correspondence in its small table: TCP connection is an internal IP 192.168.0.2, port 21. <br>  Externally, he also creates a port, for example, 54321 with his address. <br>  And redirects your request to the FTP server on port 21. <br>  The FTP server, receiving the request, sees that the request is set to IP 43.12.102.14 and port 54321. <br>  Now, for the duration of the connection, this port is a redirector to your computer on port 21 for a TCP connection. <br>  As soon as you close the connection, the port hangs from 3-10 seconds and is removed from the NAT table. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/275/035/404/27503540466eb6091dac00fcf8de3887.png"><br><br>  Most UDP connections and TCP connections in programs are created via data hacks, constantly maintaining the connection. <br><br><h4>  Practice </h4><br><br>  Let me explain how to create a connection between computers when you are sitting, for example, in ICQ. <br><br>  You initially create a connection with the ICQ server, which opens you a port on a computer, for example, 5191. On another computer, the port also opens with the number 5191. <br>  The IP and ports of these users in NAT will look, for example, like this: <br>  1 user: 43.12.102.14 light6742 <br>  2 user: 43.12.102.15:61782 <br><br>  After that, the ICQ server reports to each client their external IP address and external port. <br>  User 1 makes a connection to this external IP: Port (43.12.102.15:61782) and goes to the internal port 5191. <br>  User 2 agrees to connect to IP: Port of user 1 (43.12.102.15:61782), which is forwarded from NAT to user 1 on port 5191. Next, the files are sent and the connection is closed.  After some time, NAT, seeing that the external and internal ports are no longer in use and the connection is closed, removes this port in order to use it for other connections. <br><br>  In the picture it will look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/379/db7/d42/379db7d42c45d5e876c5a7cf6efbf09f.png"><br><br><h4>  How to implement? </h4><br><br>  Of course, not every one of us at the beginning of his career had an external server that would tell each user its external IP address and port. <br><br>  But for these solutions there are own implementations, for example, <a href="http://ru.wikipedia.org/wiki/STUN">STUN</a> servers, which are worldwide, even public. <br>  In the majority, they are created for the UDP protocol, which is used in the same torrents.  However, there are <a href="http://nutss.gforge.cis.cornell.edu/stunt.php">STUNT</a> servers for TCP protocol implementation. <br><br>  Create, create, all in your hands. <br><br>  PS: Not all NATs are able to provide such a connection, however, most closed NATs that monitor IP connections are not used in the provision of service providers. <br><br>  UDP: in this context, dynamic IPs, are called IP addresses that are not external, but are issued by higher NAT. </div><p>Source: <a href="https://habr.com/ru/post/129347/">https://habr.com/ru/post/129347/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../129341/index.html">Do you use SSL certificates for your domains?</a></li>
<li><a href="../129342/index.html">LiveStreet and ORM</a></li>
<li><a href="../129343/index.html">Learning to write userscript</a></li>
<li><a href="../129344/index.html">Rendering Python directories with NetworkX</a></li>
<li><a href="../129346/index.html">Analysis of software performance using mathematical experiment planning</a></li>
<li><a href="../129349/index.html">BitTorrent learns to "get out of the way", giving the channel for other purposes</a></li>
<li><a href="../12935/index.html">Integrating google maps</a></li>
<li><a href="../129350/index.html">Samsung Galaxy Tab 7.7 - Attempt # 2</a></li>
<li><a href="../129351/index.html">In Skitch for Android appeared framing and smoothing lines</a></li>
<li><a href="../129355/index.html">Dropad A8X - interesting price / performance ratio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>