<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Customizing Magento using Event / Observer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For 2 years of working with Magento, I have met many times when changing a module for my needs, developers often change the module itself (block, mode...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Customizing Magento using Event / Observer</h1><div class="post__text post__text-html js-mediator-article">  For 2 years of working with Magento, I have met many times when changing a module for my needs, developers often change the module itself (block, model, helper), while not using the possibilities provided by Magento itself.  Magento is a product that is very convenient for third-party developers, in terms of additions and changes to the basic logic, and provides great opportunities for developers who implement this system. <br><br><a name="habracut"></a><br>  To customize magento, you can use the rewriting of methods in blocks and modules (this is the most common method), but you can use another way - the creation of an observer and a new event. <br><br>  To begin with, if you decide to use the monitoring mechanism, you will need to disable compilation.  Next, it is best to create a new module in which you will supplement or modify the standard logic, and define an event in it with an observer.  Creating a module is described in several other articles on habr, so I will not describe the full structure of the module, and I will limit myself to the most necessary. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For example: <br>  after successfully adding a product to the card, we want to change the standard behavior of the checkout module.  Instead of redirecting to the designated place, return json data for the ajax module. <br><br>  Create a new module structure and add a part of the code to the <b>global</b> part of the <b>config.xml</b> : <br><pre><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">global</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">events</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">checkout_cart_add_product_complete</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">observers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ajax_addtocart_complete</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>singleton<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">class</span></span></span><span class="hljs-tag">&gt;</span></span>ajaxcart/observer<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">method</span></span></span><span class="hljs-tag">&gt;</span></span>addToCartComplete<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">method</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ajax_addtocart_complete</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">observers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">checkout_cart_add_product_complete</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">events</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">global</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  Consider this part in more detail. <br><pre> <code class="hljs matlab">&lt;<span class="hljs-keyword"><span class="hljs-keyword">events</span></span>&gt;</code> </pre>  - indicates magento that we will use our own event in our <br><br><pre> <code class="hljs haskell">&lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre>  - set how the observer model will be called.  You can also specify model and object <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">checkout_cart_add_product_complete</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  - we specify what event to listen <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">observers</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  - in this block we define our own event <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ajax_addtocart_complete</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  - we create our own event (the name is any, but it would be better to call it so that it would be clear that we would not get confused later) <br><br><pre> <code class="hljs ruby">&lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ajaxcart</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">observer</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre>  - the path to the model, where our method specified in the event will lie <br><br><pre> <code class="hljs pgsql">&lt;<span class="hljs-keyword"><span class="hljs-keyword">method</span></span>&gt;addtocartcomplete&lt;/<span class="hljs-keyword"><span class="hljs-keyword">method</span></span>&gt;</code> </pre>  - directly the method itself in the class indicated above. <br><br>  That is, with this part, we indicated that when ‚Äúcheckout_cart_add_product_complete‚Äù occurs, the addToCartComplete method should be called with ajaxcart / observer. <br>  Then we create our model in our new module and add the method there. <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-class"><span class="hljs-keyword"><span class="php"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-class"><span class="hljs-title">My_Model_ObserverModel</span></span></span></span></span><span class="php">{ </span><span class="hljs-function"><span class="hljs-keyword"><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="php"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-function"><span class="hljs-title">addToCartComplete</span></span></span></span><span class="hljs-params"><span class="php"><span class="hljs-function"><span class="hljs-params">($observer)</span></span></span></span></span><span class="php">{ Mage::getSingleton(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'checkout/session'</span></span></span><span class="php">)-&gt;setNoCartRedirect(</span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">true</span></span></span><span class="php">); $response[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'sidebarcart'</span></span></span><span class="php">] = Mage::helper(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'helperName'</span></span></span><span class="php">)-&gt;renderSidebarCart(); Mage::app()-&gt;getFrontController()-&gt;getResponse()-&gt;setBody(Mage::helper(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'core'</span></span></span><span class="php">)-&gt;jsonEncode($response)); } }</span></span></code> </pre><br><br>  Here we indicate to the checkout module that we do not need to redirect.  Also, for example, I added a call to a custom function that renders the Mage_Checkout_Block_Cart_Sidebar block in html, and then return this html as a json of our javascript function. <br><br>  To understand how it works, let's take a look at the event that we are listening to ‚Äúcheckout_cart_add_product_complete‚Äù. <br><br>  When the product is added to the card, the public function <b>addAction ()</b> from <b>Mage_Checkout_CartController is called.</b> <br>  If the item has been successfully added, it is executed. <br><br><pre> <code class="hljs php">Mage::dispatchEvent(<span class="hljs-string"><span class="hljs-string">'checkout_cart_add_product_complete'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'product'</span></span> =&gt; $product, <span class="hljs-string"><span class="hljs-string">'request'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getRequest(), <span class="hljs-string"><span class="hljs-string">'response'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getResponse()) );</code> </pre><br>  What is really happening.  At this point, all events are collected for all modules that have been waiting for 'checkout_cart_add_product_complete' and are executed in order of priority. <br><br>  Also, all the parameters that are passed through Mage :: dispatchEvent also go to your addToCartComplete method.  In the current example, the test you receive the product itself, which was added, as well as the Response and Request object.  To know exactly what arguments are passed to our event created, you must find the call of the event that we are listening to, and see the additional arguments. <br><br>  It should be noted that it is not always possible to find a suitable system event in magento.  Sometimes it simply does not have the necessary part of logic and then it is precisely necessary to use the block or model redefinition. <br><br>  The example is quite simple and primitive - but knowing how events work, you can use them for the benefit of yourself and other developers who will come to your place. </div><p>Source: <a href="https://habr.com/ru/post/138933/">https://habr.com/ru/post/138933/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138927/index.html">JavaScript Conference</a></li>
<li><a href="../138929/index.html">Huawei at the MWC 2012</a></li>
<li><a href="../138930/index.html">Application Developer Days conference will be in May</a></li>
<li><a href="../138931/index.html">LG Optimus Vu at MWC 2012</a></li>
<li><a href="../138932/index.html">Bash-script with gui for playing video from Vkontakte in a regular player</a></li>
<li><a href="../138934/index.html">Search engine YossarianLives searches for metaphors</a></li>
<li><a href="../138937/index.html">Nokia 808 PureView - new 41 megapixel camera phone</a></li>
<li><a href="../138938/index.html">2 in 1: sound amplifier and "home" power supply</a></li>
<li><a href="../138939/index.html">JUST - JavaScript Template Engine</a></li>
<li><a href="../138940/index.html">A simple indicator of the keyboard layout in C ++</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>