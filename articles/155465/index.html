<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Easy way to create Unity Lens for Ubuntu (translation)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article is devoted to the new Ubuntu Unity environment feature - the lens. What is a lens in Unity? Simply put, a lens is an area of ‚Äã‚Äãthe main me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Easy way to create Unity Lens for Ubuntu (translation)</h1><div class="post__text post__text-html js-mediator-article">  The article is devoted to the new Ubuntu Unity environment feature - the lens.  What is a lens in Unity?  Simply put, a lens is an area of ‚Äã‚Äãthe main menu where the user can search for local and network content.  About how you can simply create it is discussed in this article.  Original text <a href="http://developer.ubuntu.com/2012/04/how-to-create-a-wikipedia-unity-lens-for-ubuntu/">from here</a> (eng.) <br><br><h3>  Requirements </h3><br><br>  So, to create a lens, we need: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      * <b>Ubuntu 12.04 LTS</b> - <a href="http://releases.ubuntu.com/12.04/">get Ubuntu</a> ‚Ä∫ <br>  * <b>Quickly</b> - <a href="http://apt.ubuntu.com/p/quickly">install free quickly</a> ‚Ä∫ <br>  * <b>Quickly Lens</b> template - <a href="http://apt.ubuntu.com/p/quickly-unity-lens-template">install Quickly Lens template</a> ‚Ä∫ <br><br><h3>  Creating a lens </h3><br><br>  To begin with, we will write a lens that looks for among Wikipedia articles.  Creating a lens begins with a simple step - creating a project. <a name="habracut"></a>  To do this, press Ctrl + Alt + T and in the terminal window that appears, enter the following commands: <br><br><pre><code class="bash hljs">quickly create unity-lens wikipedia <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> wikipedia</code> </pre> <br><img src="http://ubuntuone.com/0cnPeaXsNj1BdgUYJwUirl" alt="image"><br>  Let's get started! <br><br><pre> <code class="bash hljs">quickly edit</code> </pre> <br><br>  This command will open three files in your default text editor, we are only interested in <b>__init__.py</b> <br><br>  The first thing we need is the Meta class.  This is our lens description.  See: <br><pre> <code class="python hljs">    <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Meta</span></span></span><span class="hljs-class">:</span></span>    name = <span class="hljs-string"><span class="hljs-string">'Wikipedia'</span></span>    description = <span class="hljs-string"><span class="hljs-string">'Wikipedia Lens'</span></span>    search_hint = <span class="hljs-string"><span class="hljs-string">'Search Wikipedia'</span></span>    icon = <span class="hljs-string"><span class="hljs-string">'wikipedia.svg'</span></span>    search_on_blank=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre><br>  To begin with, since we are making a simple lens, everything can be left unchanged. <br><br>  The lens needs categories for the visual separation of different types of results.  For Wikipedia, we will need only one category, which we will call ‚ÄúArticles‚Äù <br>  After the Meta class, we see the following lines of code: <br><pre> <code class="python hljs">    example_category = ListViewCategory(<span class="hljs-string"><span class="hljs-string">"Examples"</span></span>, <span class="hljs-string"><span class="hljs-string">'help'</span></span>)</code> </pre><br>  We will modify it for our needs. <br>  * First, we will change the category name to articles_category <br>  * Then, we have the choice between ListView and IconView for a different view of the results within the category.  We choose: ListView <br>  * We also need to give a display name for our category.  It's simple: Articles <br>  * And finally, we need to select an icon for our category and we will take it from the system workspace, namely: dialog-information-symbolic <br>  As a result, we get the line: <br><pre> <code class="python hljs">    articles_category = ListViewCategory(<span class="hljs-string"><span class="hljs-string">"Articles"</span></span>, <span class="hljs-string"><span class="hljs-string">"dialog-information-symbolic"</span></span>)</code> </pre><br><br>  The internal architecture of the lens is ready, now we begin to design the search. <br>  The standard template code demonstrates how the result hits the lens: <br><pre> <code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">search</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, search, results)</span></span></span><span class="hljs-function">:</span></span>    <span class="hljs-comment"><span class="hljs-comment"># </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Add your search results    results.append('https://wiki.ubuntu.com/Unity/Lenses/Singlet',    'ubuntu-logo',    self.example_category,    "text/html",    'Learn More',    'Find out how to write your Unity Lens',    'https://wiki.ubuntu.com/Unity/Lenses/Singlet')    pass</span></span></code> </pre><br><br>  ... but we want to ask Wikipedia ... <br><br><h3>  Wikipedia Search </h3><br><br>  Let's make a new function that is designed to perform a search.  We do this as follows. <br><br>  We will call our function wikipedia_query.  It will take the search string from the user as an argument.  We will also take two more Python modules for our needs: urllib2 for sending an HTTP request to the network and simplejson for processing data from Wikipedia. <br><br>  At the very beginning of our file, we connect the necessary modules using the import command <br><pre> <code class="python hljs">    <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib2    <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> simplejson</code> </pre><br><br>  Then, in the WikipediaLens (SingleScopeLens) class, our main class, we add a wiki variable that simplifies our code: <br><pre> <code class="python hljs">    wiki = <span class="hljs-string"><span class="hljs-string">"http://en.wikipedia.org"</span></span></code> </pre><br>  And create a function <br><pre> <code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wikipedia_query</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, search)</span></span></span><span class="hljs-function">:</span></span></code> </pre><br>  where <b>search</b> is the string that the user enters into the search box.  We need to adjust it a little bit, before sending Wikipedia, replace the spaces with ‚Äú|‚Äù, otherwise Vika will not understand our request. <br><pre> <code class="python hljs">    search = search.replace(<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"|"</span></span>)</code> </pre><br>  We create our query using the open Wikipedia API. <br><pre> <code class="python hljs">    url = (<span class="hljs-string"><span class="hljs-string">"%s/w/api.php?action=opensearch&amp;limit=25&amp;format=json&amp;search=%s"</span></span> % (self.wiki, search))</code> </pre> <br>  And we output the result to the results variable, which is in json, for this we use the simplejson module <br><pre> <code class="python hljs">    results = simplejson.loads(urllib2.urlopen(url).read())</code> </pre><br>  We add a debugging output to understand what we are doing: <br><pre> <code class="python hljs">    <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Searching Wikipedia for %s"</span></span> % (search)</code> </pre><br>  And we finish our work on the function of displaying the results, respectively <br><pre> <code class="python hljs">    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> results[<span class="hljs-number"><span class="hljs-number">1</span></span>]</code> </pre><br><br>  Our wikipedia_query function looks almost right, we need to add more try and except to prevent errors (network errors, results, etc.).  To do this, we create an informational message and an empty output. <br><pre> <code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wikipedia_query</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,search)</span></span></span><span class="hljs-function">:</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>:    search = search.replace(<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"|"</span></span>)    url = (<span class="hljs-string"><span class="hljs-string">"%s/w/api.php?action=opensearch&amp;limit=25&amp;format=json&amp;search=%s"</span></span> % (self.wiki, search))    results = simplejson.loads(urllib2.urlopen(url).read())    <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Searching Wikipedia"</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> results[<span class="hljs-number"><span class="hljs-number">1</span></span>]    <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> (IOError, KeyError, urllib2.URLError, urllib2.HTTPError, simplejson.JSONDecodeError):    <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Error : Unable to search Wikipedia"</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> []</code> </pre><br><br>  Now we need to connect a freshly written function to a long-existing search. <br><pre> <code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">search</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, search, results)</span></span></span><span class="hljs-function">:</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> article <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.wikipedia_query(search):    results.append(<span class="hljs-string"><span class="hljs-string">"%s/wiki/%s"</span></span> % (self.wiki, article),    <span class="hljs-string"><span class="hljs-string">"http://upload.wikimedia.org/wikipedia/commons/6/63/Wikipedia-logo.png"</span></span>,    self.articles_category,    <span class="hljs-string"><span class="hljs-string">"text/html"</span></span>,    article,    <span class="hljs-string"><span class="hljs-string">"Wikipedia Article"</span></span>,    <span class="hljs-string"><span class="hljs-string">"%s/wiki/%s"</span></span> % (self.wiki, article))    <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre><br><br>  It works like this: the search request is sent to <i>wikipedia_query</i> , sent to wikipedia, the response in JSON is returned to <i>wikipedia_query</i> , passed to <i>search</i> and displayed in the lens.  To understand what is happening in results.append it is very important to look at the output in the lens.  It is passed to Unity by the pattern: <br><pre> <code class="python hljs">    results.append (url,    icon,    category,    mime-type,    text,    comment,    drag <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> drop url)</code> </pre><br><br>  <b>That's all ready!</b> <br><br><h3>  Use lenses </h3><br><br>  Now the most long-awaited moment has come - we are starting to use a lens! <br>  Enter commands in the terminal: <br><br><pre> <code class="bash hljs">sudo quickly install quickly run</code> </pre><br><br><h3>  Lens installation </h3><br><br>  After successfully testing and debugging the lens, you can finally install it into the system.  To do this, briefly talk about its internal structure.  Lenses require at least three files for their work: a .lens file containing basic information about the lens;  an executable file (daemon) that does all the work and a .service file containing the name of the lens and the path to the executable file.  A setup.py file has been created in the project folder to install them into the system. <br>  I used the following commands to install: <br><br><pre> <code class="bash hljs">chmod 777 setup.py ./setup.py build sudo ./setup.py install</code> </pre><br><br><img src="http://ubuntuone.com/5JQcKebRzvLKwDySc5jBHZ" alt="image"><br><br><h4>  Links </h4><br>  * <a href="http://vasilisc.com/unity-lens-scope">Read a detailed article about the structure of lenses and their creation</a> (rus.) <br>  * <a href="http://developer.ubuntu.com/resources/platform/unity/">Learn more about Unity and related technologies</a> . <br>  * <a href="http://developer.ubuntu.com/resources/technologies/lenses-and-scopes/">Learn more about Unity lenses</a> . <br>  * <a href="http://developer.ubuntu.com/resources/platform/api/">Unity API</a> <br>  * <a href="http://www.mediawiki.org/wiki/API:Opensearch">Wikipedia opensearch API</a> <br>  * <a href="http://paste.ubuntu.com/907519/">Lens made for this manual.</a> <br>  * <a href="http://skai-falkorr.blogspot.com/2012/04/overview-lens-dash.html">Selection of lenses for Dash</a> </div><p>Source: <a href="https://habr.com/ru/post/155465/">https://habr.com/ru/post/155465/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../155447/index.html">Custom CSS Filters</a></li>
<li><a href="../155449/index.html">Curiosity sent the first soil sample for internal research</a></li>
<li><a href="../155451/index.html">A scientific journal in mathematics accepted an article from the text generator Mathgen</a></li>
<li><a href="../155459/index.html">A look from Google on site optimization</a></li>
<li><a href="../155461/index.html">There's More Than One Way To Do It</a></li>
<li><a href="../155467/index.html">Introduction to CMake</a></li>
<li><a href="../155469/index.html">9 core issues in a developer‚Äôs career</a></li>
<li><a href="../155471/index.html">Holographic properties of bit-reversible permutation</a></li>
<li><a href="../155473/index.html">About unmanned vehicles or why I do not want to live in a "smart house"</a></li>
<li><a href="../155475/index.html">New tricks SMS scam</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>