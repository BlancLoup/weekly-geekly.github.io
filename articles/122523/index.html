<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using Access Control Service 2.0 for authorization in your applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When developing your web application or service, there is always the question of how to authorize users. Once again ask them to enter their data and e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using Access Control Service 2.0 for authorization in your applications</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/storage1/5a1186af/96e0507a/59442e56/9464370a.png"></div><br>  When developing your web application or service, there is always the question of how to authorize users.  Once again ask them to enter their data and e-mail and remember the next password? <br><br>  It would be great to be able to give users who already have accounts in popular social networks or network services to log in to our resource, without having to re-enter all the data. <br><a name="habracut"></a><br><br>  In this topic, I want to tell with a simple example how to use the Access Control Services service, available within the Windows Azure platform, to organize authorization for accounts in other network services. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, let's begin. <br><br>  First we need to configure our Access Control Services to work with the test application. <br><br>  We go to the management portal of our subscription to Windows Azure, go to the section Service Bus, Access Control &amp; Caching: <br><br><img src="https://habrastorage.org/storage1/09fd1821/a80b5c6b/aae85530/646b8fdb.png"><br><br>  And create a new namespace for the Access Control service: <br><br><img src="https://habrastorage.org/storage1/ac95b83c/bb037d28/f60747b9/4350cc83.png"><br><br>  In our case, I created the habratest namespace.  Let's wait for the end of the creation of the namespace and proceed to configure it for use by our application. <br><img src="https://habrastorage.org/storage1/cc4a4fbb/e1fe6168/e440f842/5a95ac72.png"><br><br>  After clicking on the icon with the signature Access Control Service, which is indicated by the arrow in the previous figure, we will go to the portal to configure our newly created namespace. <br><br>  Configure the namespace for our future application.  To do this, select the menu item Relying party applications and in the central part click on Add. <br><br><img src="https://habrastorage.org/storage1/101c3c86/45cfc0cd/d6168938/1f997352.png"><br><br>  Fill in the displayed form: <br><img src="https://habrastorage.org/storage1/6daf2b8b/69165110/f1aab8ae/b36795c0.png"><br><br>  Name: HabraTest <br>  Mode: leave the setting Enter settings manually - we will configure our application in Visual Studio <br>  Realm: <pre>  http: // localhost: 7778 / </pre>  - this is the URL where our application will be published. <br>  Return URL: <pre>  http: // localhost: 7778 / </pre>  - in our case matches the main URL <br><br>  All other settings can be left as default.  By default, only one provider is connected: Windows Live ID, but in the settings you can add Google, Yahoo !, Facebook and WS-Federation. <br><br>  Having finished the settings, click the Save button at the bottom of the form. <br><br>  To add additional providers in the left column, select the Identity providers and then select Add in the central part.  The add providers interface will be displayed. <br><br><img src="https://habrastorage.org/storage1/378e82cb/41728875/5f9c972e/0564e9e9.png"><br><br>  I will add Google and Yahoo! <br><br>  When adding providers, you can specify which previously configured applications to add them to. <br><br><img src="https://habrastorage.org/storage1/c9082ddc/ec643cc1/06858370/e4b5395c.png"><br><br>  I will add both providers to my HabraTest test application. <br><br>  Now you need to configure the rules.  To do this, go to the section Rule groups: <br><br><img src="https://habrastorage.org/storage1/92395e15/76a47987/0fbebaf2/63ffba4c.png"><br><br>  Click on the Default Rule Group for HabraTest and on the next page generate the rules: <br><br><img src="https://habrastorage.org/storage1/e5962ce6/0d7316f1/ef899cd1/cd5c8b02.png"><br><img src="https://habrastorage.org/storage1/fb23cc2d/dee86ceb/1c7e2332/47a3900e.png"><br><br>  Save the generated rules. <br><br><img src="https://habrastorage.org/storage1/7bf2656a/9118a474/e0207f01/0fa1f97e.png"><br><br>  Now we‚Äôll go to the Application integration section and copy it to the Endpoint reference notebook on the WS-Federation Metadata. <br><br><img src="https://habrastorage.org/storage1/87c409e8/a6616e43/def92cf7/bb355ae3.png"><br><br>  This completes the configuration of the Access Control service for the test application. <br><br>  Let's start Visual Studio and create a project in it based on the ASP.NET MVC 3 template. When creating, select the Internet Application and View Engine and leave Razor. <br><br>  I called my application HabraTest. <br><br>  We configure our application so that it works on the port specified in the Access Control settings of the service.  To do this, in the project settings, in the Web tab, leave the use of the Use Visual Studio Development Server and set the Specific Port setting to 7778: <br><br><img src="https://habrastorage.org/storage1/376121c7/80ff6364/2194bd69/f0c0a03e.png"><br><br>  Remember to save your changes. <br><br>  Now we connect our Access Control service to our application.  To do this, add to the STS Reference project (right-click on the solution in Solution Explorer and select Add STS Reference ...) from the menu. <br><br>  In the dialog box that opens, in the Application URI field, you must enter the URI of our application. <pre>  http: // localhost: 7778 / </pre>  and click Next. <br><br>  A warning will appear that we are using an insecure connection.  Since this is a test application, we ignore it. <br><br>  In the next step of the wizard, select Use an existing STS and specify the Access Control Service saved after the settings, Endpoint Reference. <br><br><img src="https://habrastorage.org/storage2/816/4db/379/8164db379fde524a6595a8ef6af275f9.png"><br><br>  And then click Next until the end of the wizard, leaving all the default settings (we do this, because the default settings are suitable for the higher test application, in the case of a real application, you must select the appropriate settings at each step of the wizard). <br><br>  In order for our application to correctly process the data received from the authorization service, we need to add the following settings to the configuration file: <br><br><pre>  &lt;httpRuntime requestValidationMode = "2.0" /&gt; </pre><br><br>  Now you can run our application.  The choice of authentication provider is displayed: <br><br><img src="https://habrastorage.org/storage1/f1a643f4/3712dd0a/ddb5dd52/9275a8dd.png"><br><br>  And after authentication by the selected provider, we will get access to the site: <br><img src="https://habrastorage.org/storage1/b61fad76/405e4c10/3477eea0/59f69af2.png"><br><br>  So, using only the settings, we were able to add authentication to our site from several providers. <br><br>  This is just the beginning of work, as, of course, additional development is necessary in order to integrate Access Control services more closely with our services. <br><br>  Using Access Control is not limited to web services only.  How it can be used for authentication in applications on Windows Phone 7 can be viewed in the latest release of <a href="http://watoolkitwp7.codeplex.com/">Windows Azure Toolkit for Windows Phone 7</a> , a brief overview of one of the first versions of which can be read <a href="http://habrahabr.ru/company/microsoft/blog/118569/">in Habr√©.</a> </div><p>Source: <a href="https://habr.com/ru/post/122523/">https://habr.com/ru/post/122523/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122514/index.html">Spark: data mining up to 30x faster Hadoop</a></li>
<li><a href="../122515/index.html">RIA Novosti gave the first hundred photos from its archives to Wikimedia Commons</a></li>
<li><a href="../122518/index.html">The first Nokia phone on WP7</a></li>
<li><a href="../122519/index.html">Infographics: Microsoft vs. Apple The history of development</a></li>
<li><a href="../122520/index.html">Sony continues to fight "hackers"</a></li>
<li><a href="../122524/index.html">Google AdSense or wood chopping - chips fly</a></li>
<li><a href="../122525/index.html">New model reader Lbook V60</a></li>
<li><a href="../122528/index.html">Auto-generating APK with various data from the command line using Ant</a></li>
<li><a href="../122529/index.html">MTBF - where does a million hours MTBF come from?</a></li>
<li><a href="../122530/index.html">Dataflow architecture. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>