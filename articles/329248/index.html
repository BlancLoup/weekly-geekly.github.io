<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Clever blocking bypass in Ukraine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article describes how to set up a free service Zaborona.Help to bypass website blocking in Ukraine. 

 The peculiarity of the configuration is tha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Clever blocking bypass in Ukraine</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/ac9/2c6/961/ac92c69611a72a1a4885d80bc1bc92cf.png" alt="image"><br>  The article describes how to set up a free service <a href="https://zaborona.help/">Zaborona.Help</a> to bypass website blocking in Ukraine. <br><br>  The peculiarity of the configuration is that <b>only</b> traffic <b>to blocked networks is</b> routed through VPN <b>, other sites work directly</b> .  It works on all major platforms: Windows, Linux, iOS, MacOS, Android. <br><br>  VPN does not affect Internet speed, does not replace IP for other sites and does not interfere with the operation of online games, voice traffic, etc. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  The problems of popular bypass locks </h4><br><ul><li>  <b>Browser plug</b> - <b>ins</b> - do not work for mobile applications, they proxy all traffic through their servers.  Have access to the content of the page and threaten security. </li><li>  <b>Regular VPNs</b> route all traffic through their servers.  Affects the speed of the Internet, increase delays, replaces the IP for all sites. </li><li>  <b>Proxy browsers</b> do not allow to bypass the blocking of mobile applications. </li></ul><br>  The configuration process is described on the example of <b>OpenVPN</b> and can be easily repeated in a few minutes. <br><br>  Settings on the client side are performed using a single configuration file and do not require manual entry of addresses and passwords. <br><a name="habracut"></a><br><h2>  Server selection </h2><br>  The VPN server must have good connectivity at the network level with your ISP so that delays are minimal, as well as with the resources you plan to visit through this VPN.  Datacenters in the USA, China, Japan are not the best choice. <br><br>  I will give several options that I chose for the service Zaborona.help: <br><br><hr><br>  <b><a href="https://linode.com/">Linode.com</a></b> - cool and reliable hosting with good channels. <br><br>  <b>Pros:</b> <br><br><ul><li>  Gigabit channel, good connectivity in Europe </li><li>  Routing unit / 64 IPv6 addresses.  You can issue real IPs directly to VPN clients. </li></ul><br>  <b>Minuses:</b> <br><br><ul><li>  The minimum cost is $ 5 </li><li>  1TB of outgoing traffic at the minimum rate </li><li>  $ 20 for each terabyte of over-limit </li></ul><br><hr><br>  <b><a href="https://www.scaleway.com/">Scaleway.com</a></b> - cheap hosting with unlimited traffic. <br><br>  <b>Pros:</b> <br><br><ul><li>  The minimum price for a server is ‚Ç¨ 3 </li><li>  Unlimited traffic, 200Mbit / s </li><li>  Datacenter in Poland (close to Ukraine) </li></ul><br>  <b>Minuses:</b> <br><br><ul><li>  One IPv6 address per server (how stupid!) </li><li>  Not the best connectivity with locked resources </li></ul><br><hr><br>  For reliability, several servers from both providers are used at once.  Balancing is done primitively, at the DNS level. <br><br>  The service domain to which <b>vpn.zaborona.help</b> clients are <b>connected</b> has several A-records directed to all servers at once.  This allows you to evenly spread clients across servers.  The minimum TTL of records allows you to quickly remove the problem server from the general list and redirect clients. <br><br><h2>  List of blocked services </h2><br>  From the <a href="http://www.president.gov.ua/documents/1332017-21850">presidential decree of Ukraine ‚Ññ133 / 2017 there</a> is a list of companies subject to blocking.  Knowing this list, you can make a list of all IP ranges owned by these companies. <br><br>  To do this, you can use the service <a href="http://bgp.he.net/">bgp.he.net</a> <br>  Here's what the BGP announcements of Yandex look like <a href="http://bgp.he.net/AS13238">bgp.he.net/AS13238#_prefixes</a> <br>  We collect all the necessary ranges.  Neighboring networks are combined into one range to reduce the total number of routes on the client. <br><br>  At the output we get the following list excluding IPv6 ranges: <br><br><div class="spoiler">  <b class="spoiler_title">Network list routed through Zaborona VPN server</b> <div class="spoiler_text">  # Vkontakte <br>  - 87.240.128.0/18 <br>  93.186.224.0/20 <br>  95.142.192.0/20 <br>  95.213.0.0/18 <br>  185.29.130.0/24 <br>  185.32.248.0/22 <br><br>  2a00: bdc0 :: / 36 <br>  2a00: bdc0: e003 :: / 48 <br>  2a00: bdc0: e004 :: / 46 <br>  2a00: bdc0: e008 :: / 48 <br>  2a00: bdc0: f000 :: / 36 <br><br>  # Yandex <br>  - 5.45.192.0/18 <br>  5.255.192.0/18 <br>  37.9.64.0/18 <br>  37.140.128.0/18 <br>  77.75.152.0/22 <br>  77.75.159.0/24 <br>  77.88.0.0/18 <br>  84.201.128.0/18 <br>  87.250.224.0/19 <br>  93.158.128.0/18 <br>  95.108.128.0/17 <br>  100.43.64.0/19 <br>  109.235.160.0/21 <br>  130.193.32.0/19 <br>  141.8.128.0/18 <br>  178.154.128.0/17 <br>  185.32.185.0/24 <br>  185.32.186.0/24 <br>  185.71.76.0/22 <br>  199.21.96.0/22 <br>  199.36.240.0/22 <br>  213.180.192.0/19 <br><br>  2001: 678: 384 :: / 48 <br>  2620: 10f: d000 :: / 44 <br>  2a02: 6b8 :: / 32 <br>  2a02: 5180 :: / 32 <br><br>  # Mail.ru <br>  - 5.61.16.0/21 <br>  5.61.232.0/21 <br>  79.137.157.0/24 <br>  79.137.183.0/24 <br>  94.100.176.0/20 <br>  95.163.32.0/19 <br>  95.163.248.0/21 <br>  128.140.168.0/21 <br>  178.22.88.0/21 <br>  178.237.16.0/20 <br>  185.5.136.0/22 <br>  185.16.148.0/22 <br>  185.16.244.0/22 <br>  188.93.56.0/21 <br>  194.186.63.0/24 <br>  195.211.20.0/22 <br>  195.218.168.0/24 <br>  217.20.144.0/20 <br>  217.69.128.0/20 <br>  178.22.91.0/24 <br>  178.22.92.0/23 <br>  185.16.244.0/23 <br>  195.211.128.0/22 <br>  208.87.94.0/24 <br><br>  2a00: 1148 :: / 32 <br>  2a00: b4c0 :: / 32 <br><br>  # Kaspersky Lab <br>  - 77.74.176.0/22 <br>  77.74.181.0/24 <br>  77.74.183.0/24 <br>  93.159.228.0/22 <br>  185.54.220.0/23 <br>  185.85.12.0/24 <br>  185.85.14.0/23 <br>  77.74.176.0/21 <br>  91.103.64.0/21 <br>  93.159.224.0/21 <br><br>  2a03: 2480 :: / 33 <br></div></div><br>  This list changes extremely rarely, so it will not be difficult to update it if necessary. <br><br><h2>  OpenVPN setup </h2><br>  OpenVPN 2.4 will be used on the server.  It is recommended to use this version.  In the repositories of Ubuntu LTS version of OpenVPN 2.3, therefore, you can install the required version by connecting the official <a href="https://community.openvpn.net/openvpn/wiki/OpenvpnSoftwareRepos">openvpn repository</a> . <br><br><h3>  Certificate issuance </h3><br>  The easiest way to generate certificates is to use the <a href="https://github.com/ValdikSS/easy-rsa-ipsec">easy-rsa</a> utility.  This fork from <a href="https://habrahabr.ru/users/valdikss/" class="user_link">ValdikSS</a> allows <a href="https://habrahabr.ru/users/valdikss/" class="user_link">you</a> to generate certificates that are simultaneously suitable for both OpenVPN and Ipsec. <br><br><div class="spoiler">  <b class="spoiler_title">Key generation with easy-rsa</b> <div class="spoiler_text"><pre><code>$ git clone https://github.com/ValdikSS/easy-rsa-ipsec.git
$ cd easy-rsa-ipsec/easyrsa3
$ ./easyrsa init-pki

init-pki complete; you may now create a CA or requests.

$ ./easyrsa build-ca nopass
Generating a 2048 bit RSA private key
‚Ä¶
Common Name (eg: your user, host, or server name) [Easy-RSA CA]:Cool VPN Server
‚Ä¶

$ ./easyrsa build-server-full zaborona.help nopass
Generating a 2048 bit RSA private key
‚Ä¶
Write out database with 1 new entries
Data Base Updated

#    public   .    .
$ ./easyrsa build-client-full public nopass    
Generating a 2048 bit RSA private key
‚Ä¶
Write out database with 1 new entries
Data Base Updated
</code></pre><br>
</div></div><br>
       :<br>
<br>
<b> : </b><br>
<br>
<i>easyrsa3/pki/ca.crt</i> ‚Äî  <br>
<i>easyrsa3/pki/issued/zaborona.help.crt</i> ‚Äî  <br>
<i>easyrsa3/pki/private/zaborona.help.key</i> ‚Äî    <br>
<br>
<b> : </b><br>
<br>
<i>easyrsa3/pki/ca.crt</i> ‚Äî  <br>
<i>easyrsa3/pki/issued/public.crt</i> ‚Äî  <br>
<i>easyrsa3/pki/private/public.key</i> ‚Äî  <br>
<br>
<h3> </h3><br>
         .             VPN .  - <b>0.0.0.0</b>     .<br>
<br>
       DNS    ,     ,   ,       VPN. <br>
<br>
<div class="spoiler"><b class="spoiler_title">  OpenVPN</b><div class="spoiler_text"><pre><code>mode server
proto tcp

dev-type tun #   tun,      L2 
dev zaborona #  tun   

topology subnet
server 192.168.224.0 255.255.252.0 #  IP  .   ,      
server-ipv6 2a01:7e01:e001:77:8000::/65 #  IPv6 . ,       ipv6   

push "dhcp-option DNS 8.8.8.8" # DNS 
push "route 8.8.8.8"  #      VPN

push "dhcp-option DNS 74.82.42.42" # HE.net DNS    
push "route 74.82.42.42" # Route to HE.net DNS

txqueuelen 250
keepalive 300 900
persist-tun
persist-key

cipher AES-128-CBC
ncp-ciphers AES-128-GCM

user nobody
duplicate-cn

# log logs/openvpn.log
#status logs/status.log 30

ca ca.crt
cert zaborona.help.crt
key zaborona.help.key
dh dh2048.pem


# Routes

# Yandex network
push "route 5.45.192.0 255.255.192.0"
push "route 5.255.192.0 255.255.192.0"
push "route 37.9.64.0 255.255.192.0"
push "route 37.140.128.0 255.255.192.0"
push "route 77.88.0.0 255.255.192.0"
push "route 84.201.128.0 255.255.192.0"
push "route 87.250.224.0 255.255.224.0"
push "route 93.158.128.0 255.255.192.0"
push "route 95.108.128.0 255.255.128.0"
push "route 100.43.64.0 255.255.224.0"
push "route 130.193.32.0 255.255.224.0"
push "route 141.8.128.0 255.255.192.0"
push "route 178.154.128.0 255.255.128.0"
push "route 199.21.96.0 255.255.252.0"
push "route 199.36.240.0 255.255.252.0"
push "route 213.180.192.0 255.255.224.0"

push "route-ipv6 2620:10f:d000::/44"
push "route-ipv6 2a02:6b8::/32"

# Mail.ru network
push "route 5.61.16.0 255.255.248.0"
push "route 5.61.232.0 255.255.248.0"
push "route 79.137.157.0 255.255.255.0"
push "route 79.137.183.0 255.255.255.0"
push "route 94.100.176.0 255.255.240.0"
push "route 95.163.32.0 255.255.224.0"
push "route 95.163.248.0 255.255.248.0"
push "route 128.140.168.0 255.255.248.0"
push "route 178.22.88.0 255.255.248.0"
push "route 178.237.16.0 255.255.240.0"
push "route 185.5.136.0 255.255.252.0"
push "route 185.16.148.0 255.255.252.0"
push "route 185.16.244.0 255.255.252.0"
push "route 188.93.56.0 255.255.248.0"
push "route 194.186.63.0 255.255.255.0"
push "route 195.211.20.0 255.255.252.0"
push "route 195.218.168.0 255.255.255.0"
push "route 217.20.144.0 255.255.240.0"
push "route 217.69.128.0 255.255.240.0"

push "route-ipv6 2a00:1148::/32"
push "route-ipv6 2a00:a300::/32"
push "route-ipv6 2a00:b4c0::/32"

# VK.com network
push "route 87.240.128.0 255.255.192.0"
push "route 93.186.224.0 255.255.240.0"
push "route 95.142.192.0 255.255.240.0"
push "route 95.213.0.0 255.255.192.0"
push "route 185.32.248.0 255.255.252.0"

push "route-ipv6 2a00:bdc0::/36"
push "route-ipv6 2a00:bdc0:e006::/48"

# Kaspersky network
push "route 77.74.176.0 255.255.252.0"
push "route 77.74.181.0 255.255.255.0"
push "route 77.74.183.0 255.255.255.0"
push "route 93.159.228.0 255.255.252.0"
push "route 185.54.220.0 255.255.254.0"
push "route 185.85.12.0 255.255.255.0"
push "route 185.85.14.0 255.255.254.0"
</code></pre><br>
</div></div><br>
        /etc/openvpn<br>
<br>
<code>zaborona.conf ‚Äî  <br>
ca.crt ‚Äî  <br>
zaborona.help.crt ‚Äî  <br>
zaborona.help.key ‚Äî  <br>
</code><br>
<h3> </h3><br>
     ,    ,        .<br>
<br>
<div class="spoiler"><b class="spoiler_title">   .ovpn</b><div class="spoiler_text"><pre><code>nobind
client

#  .       DNS.
remote vpn.zaborona.help

remote-cert-tls server
cipher AES-128-CBC
setenv opt ncp-ciphers AES-128-GCM
setenv opt block-outside-dns
dev tun
proto tcp

&lt;ca&gt;
  easyrsa3/pki/ca.crt
&lt;/ca&gt;

&lt;cert&gt;
  easyrsa3/pki/issued/public.crt
&lt;/cert&gt;

&lt;key&gt;
  easyrsa3/pki/private/public.key 
&lt;/key&gt;
</code></pre><br>
</div></div><br>
<h2></h2><br>
        :  OpenVPN      . <br>
<br>
   c      :<br>
<br>
<a href="https://zaborona.help/windows.html">Windows</a><br>
<a href="https://zaborona.help/macos.html">MacOS</a><br>
<a href="https://zaborona.help/apple.html">iOS</a><br>
<a href="https://zaborona.help/android.html">Android</a><br>
<br>
  ,    ,   <a href="https://github.com/zhovner/zaborona_help/">Github</a>.  -    ,    pull request-. <br>
<br>
,     VPN    ,   .     ,     .</div><p>Source: <a href="https://habr.com/ru/post/329248/">https://habr.com/ru/post/329248/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../329238/index.html">We do GraphQL API on PHP and MySQL. Part 2: Mutations, Variables, Validation and Security</a></li>
<li><a href="../329240/index.html">JSF 2 + Maven + Jetty. Training</a></li>
<li><a href="../329242/index.html">Avoiding Hell with Monads</a></li>
<li><a href="../329244/index.html">What addresses do we see in traceroute</a></li>
<li><a href="../329246/index.html">Loading real landscapes in unity 3d</a></li>
<li><a href="../329250/index.html">Artists map, awkward search for links in the data and how to reinvent the wheel</a></li>
<li><a href="../329252/index.html">Golos - study in practice. First conclusions</a></li>
<li><a href="../329254/index.html">Passing type map to function</a></li>
<li><a href="../329256/index.html">Selenium under Windows: everything from the beginning</a></li>
<li><a href="../329258/index.html">Backend I / O Performance: Node vs. PHP vs. Java vs. Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>