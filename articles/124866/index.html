<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Saving the "broken" portable hard drive with a TrueCrypt-container</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anamnesis 
 For the theft of personal data, portable-applications, ScrapBook database and Archivarius 3000 indexes between two fixed points of presenc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Saving the "broken" portable hard drive with a TrueCrypt-container</h1><div class="post__text post__text-html js-mediator-article"><h4>  Anamnesis </h4><br>  For the theft of personal data, portable-applications, ScrapBook database and Archivarius 3000 indexes between two fixed points of presence, the SuperFlash was created, a portable 2.5 "Toshiba MK2552GSX hard drive in the ViPowER VP-352518 with USB and SATA interfaces with cryptocontainer inside.  However, " <i>trouble came, from where it was not expected!</i> ". <br><br>  In open form, in the root of the section were the distribution kit <b>TrueCrypt 7.0a</b> and the portable installation <b>KeePass Password Safe of the</b> latest version with a password database.  All the rest of the place is given under the <b>crypto-container</b> in the form of a file.  The container password is stored in the KeePass database. <br><br>  Submounting at the points of presence - by <b>nnCron</b> scripts by time or by connecting the corresponding USB-drive with auto- <b>filling of the</b> password input dialog using the <b>nnCron + KeePas</b> s <b>connection</b> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  In one non-red day, the hard drive <s>ordered</s> began to give the order for a long life.  Reading errors, freezes, chilling sounds of the heads of the hard drive and other "charms".  After the crypto-container was unmounted, the disk as a USB drive did not want to be unmounted voluntarily.  There would be to show respect for the opinion of the piece of iron, to subdue pride and reboot, but ... We are all strong in our back mind ... The disk was removed "on hot."  And in vain. <br><br><h4>  Diagnostics </h4><br>  At first, there was a hope to cope with regular means. <br>  The next time you connect and mount the cryptocontainer, <b>TrueCrypt</b> first discovered the trouble: <br><img src="https://habrastorage.org/getpro/habr/post_images/706/5c7/bc5/7065c7bc5419cf0199d84b4f1d3d27e4.png" alt="image"><br><br>  Even if it is prudent to choose "No", Windows will still insert its 5 kopecks: <br><img src="https://habrastorage.org/getpro/habr/post_images/070/83d/651/07083d651546c34d57c334700986a3d2.png" alt="image"><br><br>  At once I will say that scanning a connected cryptocontainer in the presence of failed clusters on a physical disk does not bear any benefit.  Unsuccessful experiments with error correction by means of Windows and the cryptocontainer volume (T), and the basic hard disk did not eliminate the problems: the checks were stuck at a high percentage or even ‚Äúflew off‚Äù. <br><br>  An unsuccessful attempt to copy an unmounted cryptocontainer showed that the problem was deeper - either NTFS was destroyed, or ‚Äúclusters‚Äù fell down. <br><br><h4>  Symptomatic treatment </h4><br>  Attempts to copy information using Winsows 'regular tools ( <b>xcopy</b> in error message suppression mode) and <b>Total Commander</b> ' a (with creating an <b>nnCron</b> script for <i>auto-pressing ‚ÄúOk‚Äù</i> in the dialog of an undisguised message about the inability to read the file issued for each case and not having the ‚ÄúSkip all ") Strongly tightened.  A lot of files were not copied.  So, probably bad-blocks. <br><br><h4>  Treatment </h4><br>  On second thought, another version of salvation was invented, which is possible by improvised means (and which eventually led to the successful completion of the mission): <br><ol><li>  Copy the container file as a ‚Äúbroken‚Äù file to a new safe place. </li><li>  Connect the copied container. </li><li>  "Cure" him and pull him out info. </li></ol><br>  For the first stage, the plugin for <b>Total Commander is</b> selected from <b>Bad Copy</b> and Dmitry Sergeev‚Äôs <b>nscopy.exe (Non-Stop Copy v1.04)</b> .  More precisely, this plugin is made on its basis.  Despite the year 2006 and the cessation of development, there seems to be nothing to improve there, the program copes so well with its tasks. <br>  <i><b>Attention</b> : the container must not be mounted!</i>  <i>Otherwise, nscopy will not be able to access it.</i> <br><br>  So, on one panel - the desired disk with a cryptocontainer ( <b>MyDocs.tc</b> ), opened through the <b>Bad Copy</b> plugin, on the other - a safe place for a new storage of the cryptocontainer.  <b>F5, Ok</b> - load the file with a plugin (we start the recovery process): <br><img src="https://habrastorage.org/getpro/habr/post_images/e31/80d/c99/e3180dc99e1215a770ea678f42de6302.png" alt="image"><br><br>  The download dialog appears, but the progress bar does not grow: <br><img src="https://habrastorage.org/getpro/habr/post_images/ba9/f7e/904/ba9f7e90436759c3785c095091c2ce8c.png" alt="image"><br><br>  This is necessary, because parallel and imperceptibly, the main <b>nscopy</b> window was <b>launched</b> : <br><img src="https://habrastorage.org/getpro/habr/post_images/bf2/fba/5c6/bf2fba5c6cd7de373820ae611feb01b8.png" alt="image"><br><br>  In the process of scanning, 2 files were created: of the same name with a cryptocontainer and &lt;s_ takim_zhe_name&gt; .nsc.  The ‚Äúsaved‚Äù container from the very beginning of the operation is the same size as the original file - disk space is reserved.  So to say, "to avoid." <br><br>  NSCopy has a good howto.txt in the distribution, which is described, for example, as: <ol><li>  batch copy directories; </li><li>  integrate into Explorer context menu. </li></ol><br>  The readme.txt file describes in detail the options for using the program.  In my case, the following came in handy: <br>  <i>‚Äú <b>Detailing</b> .</i>  <i>Each bad segment is copied by sector to the first bad sector, first moving from the beginning of the bad section, then from the end of the bad section in the opposite direction.</i>  <i>As a result, with a small investment of time, a more accurate picture of the localization of groups of bad sectors is obtained.</i> <i><br></i>  <i><b>Precise detail.</b></i>  <i>The program tries to copy every sector in all bad sites.</i>  <i>At the end of this stage, you get a real picture of bad sectors.</i> <i><br></i>  <i><b>Copy bad sectors.</b></i>  <i>The program tries to copy every bad sector, while making several consecutive attempts at reading.</i>  <i>The number of attempts is determined by the option ‚ÄúAttempts to copy a bad sector‚Äù.</i>  <i>The ability of a program to copy information from poorly readable sectors is based on this, since in some cases (for example, an old or badly recorded CD-R disc) there is a possibility that the sector will still be read. ‚Äù</i> <br><br>  NSCopy, among other things, can be controlled from the command line. <br><br>  I will explain at once why I describe this program in such detail and do not provide alternatives. <br><ol><li>  Shock from what happened.  All thoughts - to restore.  Immediately after the incident - there was no time for perfectionism. </li><li>  NSCopy already stood in Total.  Like a legacy of DVD times. </li><li>  There was no need for an alternative - the method worked and everything worked out. </li><li>  Post-mortem googling did not produce any results - somehow it was not very large in the market for recovering broken files from storage media.  None of the programs found has passed the stage of critical thinking about the name and evaluation of the version number and the release date of the latest latest version.  Not impressed, in short. </li></ol><br>  <i>(‚ÄúIn the meantime, on the yacht‚Äú Trouble ‚Äù...‚Äù)</i> For 99% of the recovery, the damage picture is, in principle, almost completely visible.  Several single failed clusters and several dense groups.  That's where, when copying, the chilling soul of any IT-person sounds like ‚ÄúHsch-shch shch-tshin !!!‚Äù. <br><br>  A few hours of waiting and - finish.  And in my case (mb. This exception) up to 100% never came.  I waited a long time and, at my own risk and risk, I still pressed ‚ÄúStop‚Äù.  It didn‚Äôt lead to anything fatal, since NSCopy is written quite reliably and steadily - after all, but it‚Äôs just sharpened for such an unreliable thing as bad drives.  The author in readme.txt himself says - recovery algorithms work consistently.  The further - the more information is restored, but it will take more time.  <b>Decide for yourself when to stop.</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/93d/ac3/53e/93dac353ed78eca0c52f73389f135a36.png" alt="image"><br><br>  After stopping at 99% Non-Stop Copy, the recovered cryptocontainer was copied unchanged once more for reliability, and then mounted in the usual way.  TrueCrypt again found an incorrect shutdown.  Now you can safely go on experiments. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f53/61c/0fb/f5361c0fb8c96f0e8c8cf17d4dd78d2c.png" alt="image"><br><br>  Another warning: <br><img src="https://habrastorage.org/getpro/habr/post_images/c4d/12a/926/c4d12a926cf520ec29931ee9187a1b42.png" alt="image"><br><br>  One more thing: <br><img src="https://habrastorage.org/getpro/habr/post_images/a10/243/b55/a10243b55fb18c34f27304ea665a2933.png" alt="image"><br><br>  And finally, the check starts: <br><img src="https://habrastorage.org/getpro/habr/post_images/9d8/4be/4e1/9d84be4e103b7e5f2e72219400fb12c1.png" alt="image"><br><br>  Starting the recovery using regular Windows tools (including checking for failed clusters) was successful and ended quickly. <br>  Oddly enough, when copying files from the restored cryptocontainer to the newly created one, <u>all the</u> files were read without any problems.  That is, there are no irreversibly lost files, although partial corruption of the contents is not excluded. <br><br>
<h4>  Prevention (results) </h4><br>  It seems that this time I got off with a slight fright.  From the positive: <br><ol><li>  Updated superflesh hardware - now 500 GB instead of 250.  Now I will do it regularly.  In any case, my nerves are more expensive ~ 1600r.  for a new screw every 1-1.5 years. </li><li>  He worked out the method of restoring broken cryptocontainers. </li><li>  Worked out the migration procedure from one SuperFLASH to another and work in a temporary mode of limited mobility. </li><li>  He revealed the ‚Äúnarrow‚Äù places of his workflow, where obligatory duplication of portable-software is necessary in order not to fall out of online and out of life / work.  For example, an IM client with customized accounts, a ScrapBook with work materials, a MyLifeOrganized database with tasks / tasks. </li></ol></div><p>Source: <a href="https://habr.com/ru/post/124866/">https://habr.com/ru/post/124866/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../124856/index.html">Game Theory and the Sprague-Grande Function</a></li>
<li><a href="../124860/index.html">PostSharp. Problem solving logging and auditing</a></li>
<li><a href="../124861/index.html">Working with the mind, not with your hands: an example of increased text editing performance in Emacs</a></li>
<li><a href="../124863/index.html">Collecting network equipment configuration and storing them in SVN</a></li>
<li><a href="../124864/index.html">Apache HTTP Server: Serving Multiple HTTPS Hosts on the Same IP Address</a></li>
<li><a href="../124867/index.html">Firefox 6 will support a number of properties from the draft CSS3 Text module</a></li>
<li><a href="../124869/index.html">2D Collision Handling Using LibCanvas</a></li>
<li><a href="../124871/index.html">Task complexity assessment</a></li>
<li><a href="../124872/index.html">Neighbors - will the IM + geosocial network take off?</a></li>
<li><a href="../124873/index.html">OpenCL under C # is easy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>