<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Car Tutorial Guide (Unity3d): Exploring an Alternative Physical Model (part 1 of 3)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Before we begin, I want to warn you that this is not a translation of the official guide, but my personal guide to installing physics on a car. 

 Par...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Car Tutorial Guide (Unity3d): Exploring an Alternative Physical Model (part 1 of 3)</h1><div class="post__text post__text-html js-mediator-article">  Before we begin, I want to warn you that this is not a translation of the official guide, but my personal guide to installing physics on a car. <br><br>  <a href="http://habrahabr.ru/post/247667/">Part 1</a> <br>  <a href="http://habrahabr.ru/post/248185/">Part 2</a> <br>  <a href="http://habrahabr.ru/post/248995/">Part 3</a> <br><br><h3>  Exploring an alternative physical model: </h3><br>  <a href="http://habrahabr.ru/post/250953/">Part 2</a> <br>  <a href="http://habrahabr.ru/post/252427/"><s>Part 3</s></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The official guide said about the physics of the car, which has a simplified model and has many shortcomings that can be read at the very end <a href="http://habrahabr.ru/post/248995/">Part 3 of the</a> manual.  Or watch this video: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/7e_0FUxn0IA%3Ffeature%3Doembed&amp;xid=17259,15700021,15700043,15700186,15700190,15700253&amp;usg=ALkJrhg6v_WiFBxlqHnXqTxxet86UX301g" frameborder="0" allowfullscreen=""></iframe><br><a name="Link_2"></a><br>  <b>PS For those who have exported the models, we can immediately proceed to setting up the vehicle <a href="https://habr.com/ru/post/249363/">Transition</a> , and also can view the video on the vehicle settings (in addition to the article):</b> <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/3uogS8Sq9X8%3Ffeature%3Doembed&amp;xid=17259,15700021,15700043,15700186,15700190,15700253&amp;usg=ALkJrhhrtyXUsLcv8FpFQ_Vlg_XMv3EY9g" frameborder="0" allowfullscreen=""></iframe><br><br>  So let's get started in order. <br><br>  First, download the scripts that we need ( <a href="https://drive.google.com/file/d/0B0yoFhs5yYibTHMzYUNUdUk1MkE/view%3Fusp%3Dsharing">download</a> ), each script contains comments, we briefly examine the description of each script.  To have a general idea. <br><br><h1>  We study the script description. </h1><br>  <b>AerodynamicResistance.cs</b> : This script must be added to each car in order to calculate the aerodynamic friction of the car. <br><br>  <b>AntiRollBar.cs</b> : Add, if necessary, to mimic the anti-roll bar for better handling. <br><br>  <b>CarController.cs</b> : script to handle driving.  This script is required for each car.  You can edit this script if you want to change driving or implement AI.  Also sets some characteristics of the car body, such as the center of gravity and inertia. <br><br>  <b>CarCamera.cs</b> : Script for the camera.  Which after the settings will follow our cars. <br><br>  <b>Drivetrain.cs</b> : car engine and transmission.  This script contains the gearbox and engine.  One of the scripts needed in the car. <br><br>  <b>SoundController.cs</b> : A simple class to play car sounds and other sounds.  This script must be added to the car. <br><br>  <b>TractionHelper.cs</b> : If necessary, add this script to the car to make it more sustainable. <br><br>  <b>Wheel.cs</b> : This script simulates tire models and wheel suspension, and acts as a replacement in Unity for the built-in component Wheel Collider. <br><br>  <b>Wing.cs</b> : Add one script or more than one if you want to simulate the downforce of aerodynamics for your car. <br><br><h2>  Car preparation </h2><br>  In fact, this is the most important part, I ran into a number of problems in the work of car physics due to improper export.  And so let's first get acquainted with the coordinate system of the right-sided and left-sided. <br><br>  <b>Blender</b> uses a <b>right-handed</b> coordinate <b>system</b> with the Z axis pointing up.  This coordinate system is used by almost all <b>CAD systems</b> .  See the picture: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/472/61d/31d/47261d31dc512fec583d523df3bda314.png" alt="image"><br><br>  <b>Unity3d,</b> like almost any other game engine, uses a left-sided coordinate system.  When Y is up, X is sideways, Z is forward.  See the picture: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f11/e37/7e2/f11e377e22dd90301dba98ba229ded37.jpg" alt="image"><br><br>  Therefore, first for the correct export of the car, we must understand for ourselves that Z + it will be the direction in the game when the car moves forward, (Z-) is the direction when the car moves backwards.  (X + -) is the direction of turning sideways - but this is in <b>Unity</b> , which uses the <b>left-side coordinate system</b> .  And in the <b>right-hand coordinate system</b> (Blender, 3ds max) Y + it will be the direction when the car is looking forward and (X + -) is the direction to the side.  This means that the car must stand in the scene as shown, otherwise wait for problems with physics: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9dc/f7d/563/9dcf7d56350b1ac033dc6606c94971eb.jpg" alt="image"><br><br>  All rotation parameters must be set to 0 for further work and for Mesh (Mesh) to be generated correctly, you need to set the Scale as default.  To do this, we will do the following in Blender. <br><br>  1) Select all objects in the scene (A key) <br>  2) <b>Object&gt; Apply&gt; Rotate &amp; Scale.</b> <br><br>  See the picture: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d34/3b5/69c/d343b569c4a6311168dd421e3493ac59.jpg" alt="image"><br><br>  Now all the rotation parameters are taken and set to <b>0</b> .  And <b>scaling</b> parameters <b>(Scale) are</b> set to default <b>(1)</b> .  See the picture: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/94d/c34/5f3/94dc345f3157d219ba12c23220956e19.jpg" alt="image"><br><br>  Now we can make ‚ÄúRight export‚Äù from the right-side coordinate system to the left-side coordinate system. <br><br>  1) Select all objects (A key) <br>  2) Click the sequence <b>R&gt; X&gt; -90</b> . <br>  3) <b>Object&gt; Apply&gt; Rotate.</b> <br>  4) Click the sequence <b>R&gt; X&gt; 90</b> . <br><br>  Be sure to do in this sequence.  Next, export the model to Unity.  <b>File&gt; Export&gt; FBX</b> with the following settings: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb9/04c/215/fb904c2152abfd06871ac4354e0ba7f6.jpg" alt="image"><br><br>  After exporting the model, go to the folder with this model and copy the <b>Textures</b> folder (the folder with textures) and our <b>FBX file</b> .  In the <b>Assets</b> folder of our project.  This will allow <b>Unity to</b> import the model directly with the textures that were configured in <b>Blender</b> . <br><br>  Game resources: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eb0/4a5/b58/eb04a5b581503b7f8e817ce2af1346cf.jpg" alt="image"><br><br><a name="Link_1"></a><br><h2>  Car setup </h2><br>  <a href="https://habr.com/ru/post/249363/">Video on setting up the car (addition to the article)</a> <br><br>  Create a Prefab and drop our object in the Prefab. <br>  1) <b>Assets</b> tab <b>&gt; Create&gt; Prefab</b> <br>  2) Rename new prefab to Car <br>  3) <b>Using the</b> D &amp; D drag method of our Asset <b>Vaz_2106_mesh</b> into our Prefab named Car. <br>  4) D &amp; D's drag and drop method from our Prefab named Car onto the stage. <br><br>  The structure of Prefab Car is as follows: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ba/f84/861/7baf8486163cda50dd24a039443b3cea.jpg" alt="image"><br><br>  <b>VAZ2106_Car_body</b> - Contains many elements, these are doors and headlights and bumpers, etc. (simplified structure of the car) <br>  <b>VAZ2106_Car_window</b> - Car windows. <br>  <b>VAZ2106_WheelFL</b> - Front left wheel. <br>  <b>VAZ2106_WheelFR</b> - Front right wheel. <br>  <b>VAZ2106_WheelRL</b> - Rear left wheel. <br>  <b>VAZ2106_WheelRR</b> - Rear right wheel. <br><br>  Now add physics to our car. <br>  1) Select our object - the car (I have this Car). <br>  2) Let's go to the <b>Inspector</b> tab and click the <b>Add component&gt; Physics&gt; Rigidbody button</b> . <br>  3) Go to the component <b>Rigidbody</b> and make the settings (preferably more close to the original model). <br><br>  In my case, the total weight of the car is 1445 kg.  Mass = 1445. All other characteristics set to 0. because they are responsible for resistance.  And for the resistance we will have to answer a separate script <b>AerodynamicResistance.cs</b> . <br><br>  <b>Your Rigidbody</b> settings should be something like this: <br><br><img src="https://habrastorage.org/files/3ea/d53/9f1/3ead539f138e45d2a490fdda0a8bc4be.png" alt="image"><br><br>  In addition to the mass of the car. <br><br><h2>  Making wheels </h2><br>  Create an empty object for each of the wheels - (you need to apply the <b>Wheel</b> script to each individual wheel). <br><br>  1) Right click on our car Prefabs&gt; Create Empty <br>  2) Rename our empty object named <b>GameObject</b> to <b>WheelFL</b> (by analogy with <b>VAZ2106_WheelFL</b> ) <br>  3) Change the X, Y, Z coordinates of the <b>WheelFL</b> object to the coordinates of the <b>VAZ2106_WheelFL</b> object, and change the coordinates of the <b>VAZ2106_WheelFL</b> object to 0. <br>  4) Drag and drop D &amp; D our <b>VAZ2106_WheelFL</b> into the <b>WheelFL</b> object. <br>  5) Repeat paragraph 1-4 3 more times changing the name of the <b>GameObject</b> in accordance with our wheels. <br><br>  We should have the following file structure: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b00/914/c6f/b00914c6f70a89acaeb88746a9ffbca1.jpg" alt="image"><br><br>  Next, add the Wheel.cs script to our wheels. <br>  1) <b>Select WheelFL</b> go to the <b>inspector</b> tab. <br>  2) Click the <b>Add component&gt; Script&gt; Wheel</b> button. <br>  3) Repeat steps 1-2 more 3 times to <b>WheelFR, WheelRL, WheelRR</b> . <br><br>  Each wheel should have the following structure of components: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b00/914/c6f/b00914c6f70a89acaeb88746a9ffbca1.jpg" alt="image"><br><br>  Settings for wheels. <br><br>  1) WheelFL: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/079/1d5/8b9/0791d58b9a75634b27e07228623206a1.jpg" alt="image"><br><br>  2) WheelFR: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/632/0ea/a65/6320eaa65bfd2aed3934ab4d3a9f17ff.jpg" alt="image"><br><br>  3) WheelRL: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f22/4d2/4c5/f224d24c5e9142f254e7fef6935bce63.jpg" alt="image"><br><br>  4) WheelRR: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ac1/075/13d/ac107513de6ebc75e9da79746889f307.jpg" alt="image"><br><br>  Basic settings here: <br><br>  <b>Radius</b> : - the radius of the wheel, the value must be selected depending on the size of the wheel. <br>  <b>Suspresion Travel</b> : - car suspension, in the last parts it was discussed in more detail about this. <br>  <b>Dumping</b> : - spring stiffness. <br><br>  The remaining settings are also very important, but I think they will be discussed in the next section. <br><br>  With wheels finished. <br><br><h2>  Adding a center of gravity and a car collider </h2><br><h3>  Creating a center of gravity </h3><br>  1) Right click on the Prefabs of our car&gt; <b>Create Empty</b> . <br>  2) Rename our empty object with the name <b>GameObject</b> to <b>CoG</b> (abbreviation center of gravity). <br>  3) Set the coordinates in the <b>Transform</b> component of the <b>CoG</b> object as in the figures. <br><br>  It should look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/84f/695/a6f/84f695a6f1e45a71f24504d37554793e.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/b13/b19/a77/b13b19a779d39943c938618ab46388e1.jpg" alt="image"><br><br>  The center of gravity should approximately be ahead slightly above the bottom of the car.  but in principle for each car is individually configured.  All this will be debugged during testing. <br><br><h3>  Creating <b>Collider</b> for Car Body </h3><br>  1) Right click on our car Prefabs&gt; <b>Create Empty</b> <br>  2) Rename our empty object named <b>GameObject</b> to <b>Collider_body</b> <br>  3) Add a <b>Box Collider</b> component.  (Add component&gt; Physics&gt; Box Collider) <br>  4) Make the settings of the components as in the figure.  Maybe you will have other settings, see how the <b>Box collider</b> should cover. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/870/fca/df0/870fcadf044df3a297d98dbf700958fb.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/03e/0ed/f21/03e0edf21d266376da8844e459214592.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/0ac/723/175/0ac7231752c71da0e450bbdbd6d8d0ee.jpg" alt="image"><br><br>  Collider needed to create collisions and the correct physics of the car. <br><br><h3>  Creating a <b>Collider</b> for a Car Roof </h3><br>  1) Right click on the Prefabs of our car&gt; <b>Create Empty</b> . <br>  2) Rename our empty object named <b>GameObject</b> to <b>Collider_head</b> . <br>  3) Add a <b>Box Collider</b> component (Add component&gt; Physics&gt; Box Collider). <br>  4) Make the settings of the components as in the figure.  Maybe you will have other settings, see how the <b>Box collider</b> should cover. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b95/df9/363/b95df9363e84fc9603b91f13a0714398.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/347/512/cc7/347512cc7160baa29ad644f1357b8c5b.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/0a6/749/8b0/0a67498b0b02225e3482e3364dfe4c48.jpg" alt="image"><br><br>  The collider is needed for what would, if an object falls on the roof of the car, so that it interacts with the roof and not with the body of the car. <br><br>  In the end, you should get something like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3e8/59c/8ca/3e859c8cadeb43143fab3caa49ac3f9a.jpg" alt="image"><br><br>  Of course, you can use Mesh Collider, but Mesh Collider will require more resources than primitive objects.  You decide. <br><br><h2>  Create and configure the car </h2><br>  So, we have partially dealt with the wheels, we will adjust the wheel settings later, and now we will add components to our Prefab car. <br><br>  1) Select the prefab of the car. <br>  2) On the <b>inspector</b> tab <b>,</b> click the <b>Add Component&gt; Script&gt; Car Controller</b> button. <br><br>  Add CarController script and Drivetrain script dependent on it. <br><br>  3) Click the <b>Add Component&gt; Script&gt; Sound Controller</b> button. <br>  4) Click the <b>Add Component&gt; Script&gt; Anti Roll bar</b> button. <br>  5) Repeat paragraph 4. <br>  6) Click the <b>Add Component&gt; Script&gt; Aerodynamic Resistance</b> button. <br>  7) Click the <b>Add Component&gt; Script&gt; Traction Helper</b> button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/730/6ad/75f/7306ad75f0a20c4f8ca562a8730a0136.jpg" alt="image"><br><br>  After adding scripts, we make the following settings for our scripts. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/443/e14/d9e/443e14d9e22a2442a3cfed41d07a136f.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/92a/6b2/60f/92a6b260fb20fa39bd636cd79165bd1c.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/179/ad5/d1c/179ad5d1c496ccf0332608ebb637eac7.jpg" alt="image"><br><br><h2>  Main Camera - Settings </h2><br>  It remains the last part, we will make the settings of our camera. <br><br>  1) Click the <b>Add Component&gt; Script&gt; Car Camera</b> button. <br>  Make the following setting: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f21/596/797/f21596797483b135fbb0373b32825f04.jpg" alt="image"><br><br>  Target - the object on which the camera will be oriented. <br>  Height - The height of the camera. <br>  Distance_to_back - distance from object to camera. <br>  Distance_from_back - distance from object to camera after vehicle acceleration (approach effect). <br><br>  Naturally, all these settings must be configured for each car individually.  A description of all the settings is not given, because I still understand them, and did not want to describe the parameters in which 100% is not sure.  However, this guide may be the starting point for creating your own car model. </div><p>Source: <a href="https://habr.com/ru/post/249363/">https://habr.com/ru/post/249363/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../249347/index.html">Invitation to FOSDEM 2015</a></li>
<li><a href="../249351/index.html">Features of creating NSString</a></li>
<li><a href="../249357/index.html">A compass pointing to the north, or how trigonometry came in handy to me</a></li>
<li><a href="../249359/index.html">Blowfish on guard ivi</a></li>
<li><a href="../249361/index.html">Using TypeScript (using the example of angularjs) in Visual Studio 2015</a></li>
<li><a href="../249367/index.html">Templater - template manager and tweaker for MantisBT</a></li>
<li><a href="../249369/index.html">Why companies do not know how to handle money</a></li>
<li><a href="../249371/index.html">Making the game 2048 on AngularJS</a></li>
<li><a href="../249373/index.html">How to untangle noodles without falling into depression</a></li>
<li><a href="../249375/index.html">We decipher the formula of the Habr-rating or the restoration of functional dependencies according to the empirical data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>