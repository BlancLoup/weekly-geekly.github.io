<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Exchange 2007/2010, sending letters to domain users who have external mailing addresses</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is an interesting bug, and maybe even a feature in Exchange 2007/2010 with sending letters to a user who has an external mailbox. 

 Prehistory ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Exchange 2007/2010, sending letters to domain users who have external mailing addresses</h1><div class="post__text post__text-html js-mediator-article">  There is an interesting bug, and maybe even a feature in Exchange 2007/2010 with sending letters to a user who has an external mailbox. <br><br><h5>  <b>Prehistory</b> </h5><br><br>  Suppose you have some OU in your domain, which is needed to authorize third-party users to whom you do not allocate the mailbox of your domain, but they use their own.  Let's call this OU - External.  This is usually required if you work with any partners and provide them with access to some resources of your organization. <br>  When you open a new user in this OU, you specify its external e-mail address, say username@externaldomain.com, and naturally you want this user to be able to be on mailing lists and receive all emails that are generated by different systems automatically, and also be available for users from other OUs in the address book and other users had the opportunity to send him letters in the usual way by selecting the recipient in Outluk. <br>  So, it is impossible to make such standard Exchange tools! <a name="habracut"></a>  Mail is simply not sent to external addresses, if such is specified in AD by the user.  I rummaged through a bunch of articles and the only way I‚Äôve found and that Microsoft authoritatively recommends to <a href="http://technet.microsoft.com/en-us/magazine/ff381469.aspx">Technet</a> is a discovery for each such user and also a mail contact to which all mail will be sent.  (Here <a href="http://www.msexchange.org/tutorials/mf015.html">is the</a> process in the pictures) Just think about it - open contact with the same data for each existing user plus changing the letter in the name or the last name, since such an object already exists in the form of the user and AD will not let you create a duplicate.  And then also set the forward from the user to the contact.  I'm sorry, but this is idiocy and crutches.  It is official crutches. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  <b>Learning the mat part</b> </h5><br><br>  Having a little idea about the structure of the data and attributes of LDAP, I went to study the list of attributes that Exchange uses and which we will need to solve the problem. <br>  So, we need an LDAP Attribute Editor, which can be accessed from the AD Users &amp; Computers, View -&gt; Advanced Features console.  Then we find the right user and open the Attribute Editor tab. <br><br><h5>  <b>For the file!</b> </h5><br><br>  Next we find the attribute - <b>'proxyAddresses</b> ' and add the values: <br><br> <code>SMTP:username@externaldomain.com <br> X400:C=US;A=LOCALDOMAIN;P=LOCALDOMAIN;O=Exchange;S=Surname;G=Name;</code> <br> <br>  Where appropriate username@externaldomain.com is the user's external mailbox, and X400 will allow us to use MTA (mail transfer agent) for this user.  (C = Country, A = Administrative Control Domain, P = Private Control Domain, O = Organization, S = Last Name, G = First Name) <br><br>  Find the attribute <b>'targetAddress'</b> and add values <br><br> <code>SMTP:username@externaldomain.com</code> <br> <br>  In the attribute <b>'legacyExchangeDN'</b> add <br><br> <code>/o=LOCALDOMAIN/ou=First Administrative Group/cn=Recipients/cn=NameSurname</code> <br> <br>  And fill in accordance with the name of your organization (domain) <br><br>  In principle, this is enough to make mail routing to external addresses of local users. <br><br><h5>  <b>Tuning</b> </h5><br><br>  Find the attribute <b>'mAPIRecipient'</b> and set its value to FALSE.  This disables the rich text, styles and design of letters for Autluk.  If you do not do this, then users are not an outlook, but webmail or other email programs that do not know how to format letters in Rich Text will receive, by attaching, the Winmail.dat file, which contains these styles. <br><br>  Now, if we want this user to be displayed in the GAL (Global Addres List) in the organization‚Äôs global contact list, we do the following: <br><br>  Find the <b>'showInAddressBook'</b> attribute and add the following three entries there: <br><br> <code>CN=All Users,CN=All Address Lists,CN=Address Lists Container,CN=ORGANIZATION,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=DOMAIN,DC=com <br> <br> CN=Default Global Address List,CN=All Global Address Lists,CN=Address Lists Container,CN=ORGANIZATION,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=DOMAIN,DC=com <br> <br> CN=All Contacts,CN=All Address Lists,CN=Address Lists Container,CN=ORGANIZATION,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=DOMAIN,DC=com</code> <br> <br>  Naturally, the values ‚Äã‚Äãof the organization and the domain you will need to change to your own. <br>  You can also make a simple PowerShell script that will automatically edit the necessary attributes. <br><br>  LDAP Attribute Help - <a href="http://www.computerperformance.co.uk/Logon/LDAP_attributes_active_directory.htm">www.computerperformance.co.uk/Logon/LDAP_attributes_active_directory.htm</a> <br>  <a href="http://msdn.microsoft.com/en-us/library/ms675090">msdn.microsoft.com/en-us/library/ms675090</a> (v = vs.85) </div><p>Source: <a href="https://habr.com/ru/post/145681/">https://habr.com/ru/post/145681/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145674/index.html">"Random Millionaire" received from the bank $ 7.7 million by mistake</a></li>
<li><a href="../145677/index.html">Connecting Access Points to a Cisco Wi-Fi Controller</a></li>
<li><a href="../145678/index.html">Practical tasks from unity3dstudent.com</a></li>
<li><a href="../145679/index.html">ObjectDB - database management system for Java applications</a></li>
<li><a href="../145680/index.html">Website development with responsive design</a></li>
<li><a href="../145682/index.html">Algorithms of sorting. Gnome Sort on C</a></li>
<li><a href="../145683/index.html">Static analysis of PHP code using HipHop</a></li>
<li><a href="../145685/index.html">Weekly Digest # 7: Simple-Science - Simple Experiments</a></li>
<li><a href="../145688/index.html">Startup: what not to do or learn from the mistakes of others</a></li>
<li><a href="../145689/index.html">Dirty stress test nginx vs apache</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>