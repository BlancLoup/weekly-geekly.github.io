<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Document generator docx and xlsx</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A year ago, a regular customer once again addressed me. ‚ÄúManagers are idiots,‚Äù he said indignantly. - The staff turnover is huge, it takes months to t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Document generator docx and xlsx</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/cf2/19e/416/cf219e416c58616e85a6b76217966f80.png" alt="image"><br><br>  A year ago, a regular customer once again addressed me.  ‚ÄúManagers are idiots,‚Äù he said indignantly.  - The staff turnover is huge, it takes months to train everyone.  And then they make mistakes. ‚Äù <br><br>  Only after such an emotional prelude did the task follow: ‚ÄúIt is necessary that when ordering from the site, an already formed package of documents in MS Office formats should arrive: an order form, an invoice for payment, a receipt, and a specification‚Äù. <br><a name="habracut"></a><br>  The task itself is close to the article <a href="http://habrahabr.ru/post/119551/">"PHP + Word"</a> .  But the LiveDocx service did not suit us.  First, it was assumed that most of the documents should be in Excel.  Secondly, payment "to the West" from Russia was and is problematic.  Thirdly, the customer had a lot of ideas and helpers that this or a similar service would hardly have realized.  For example, a complex table, with a breakdown of goods into categories. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Since there are several websites at the customer, it was decided to build a separate system - its own document generation service, to which the websites would apply at the time of the order. <br><br>  The basis of the future code was the ideas from the same Habrostat above, as well as the publication <a href="http://habrahabr.ru/post/140352/">‚ÄúDisassemble xlsx in PHP without ready libraries‚Äù</a> . <br><br>  As a result, for the month of work, the ‚Äúdocument generator‚Äù was created and launched. <br><br>  What he can do: <br><br><ul><li>  generate a docx document by template by directly replacing the template tag with data; </li><li>  do the same with xlsx templates; </li><li>  expand the tables in xlsx and fill them with incoming data from the array; </li><li>  insert subtitles, breaking the table into groups; </li><li>  insert links - single, or as table contents; </li></ul><br><br>  What the generator currently does not know how: <br><br><ul><li>  work with different data types - all cells are filled as strings.  For this reason, it is not possible to use excel formulas in a template that would operate on the data entered; </li><li>  insert images; </li><li>  change formatting - it is completely defined in the template. </li></ul><br>  In this form, he worked for a year now.  Problems for this period arose mainly only with the client part - from the store.  Although this does not mean that the script "generator" is perfect.  Today it is run in only one real task. <br><br>  Soon the idea arose that this product could be useful to other people.  So, a new domain was registered, a copy of the document generator was installed on it and a small website was created on which you can ‚Äútouch‚Äù the script, fill in your template and exploit it until <i>it withstands the iron</i> . <br><br>  Today I received permission from the customer to post a project on Gitkhab and publish this article, which I hasten to use. <br><br>  Check the script can be a <a href="http://f-document.ru/%3Fc%3Ddemo">demo example</a> . <br><br>  The source code is available in the <a href="https://github.com/floppox/f-document">repository</a> . </div><p>Source: <a href="https://habr.com/ru/post/254537/">https://habr.com/ru/post/254537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254525/index.html">I want from API a line, and a point, and a point</a></li>
<li><a href="../254527/index.html">Android - Custom View or ToggleButton 4x4</a></li>
<li><a href="../254529/index.html">Comparison of online consultants for the site: flour choice</a></li>
<li><a href="../254531/index.html">Programming Philosophy 6 - Product and Project</a></li>
<li><a href="../254533/index.html">Tarantool 1.6 - let's get started</a></li>
<li><a href="../254541/index.html">We work with Compound File</a></li>
<li><a href="../254543/index.html">Research on IT leadership factors</a></li>
<li><a href="../254545/index.html">Damage to the stack in one of the NSString methods</a></li>
<li><a href="../254549/index.html">Coub goes to strike</a></li>
<li><a href="../254551/index.html">4th generation SCADA system: AggreGate SCADA / HMI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>