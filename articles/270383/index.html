<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Java Programmer Cheat Sheet 4. Java Stream API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Despite the fact that Java 8 has been released for a long time, not all programmers use its new features, someone stops the fact that work projects ar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Java Programmer Cheat Sheet 4. Java Stream API</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/post/270383/"><img src="https://habrastorage.org/files/0b7/b18/760/0b7b1876026c4aa78b926fe5a9027c72.jpg"></a> <br><br>  Despite the fact that Java 8 has been released for a long time, not all programmers use its new features, someone stops the fact that work projects are too difficult to translate from Java 7 or even Java 6, use someone in their GWT projects, Someone is doing projects for Android and does not want or can not use third-party libraries to implement lambdas and Stream Api.  However, knowledge of lambdas and Stream Api for a Java programmer is often required at interviews, well, it will just be useful when switching to a project that uses Java 8. I would like to offer you a brief cheat sheet on Stream Api with practical examples of implementing various tasks with a new functional approach.  Knowledge of lambda and functional programming is not required (I tried to give examples so that everything was clear), the level of the most basic knowledge of Java and above. <br><br>  Also, since this is a cheat sheet, the article can be used to quickly recall how a particular feature of the Java Stream Api works.  A brief listing of the features of the main functions is given at the beginning of the article. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">For those who do not know what Stream Api is.</b> <div class="spoiler_text">  Stream API is a new way to work with data structures in a functional style.  Most often, using stream in Java 8 works with collections, but in fact this mechanism can be used for a wide variety of data. <br><br>  Stream Api allows you to write processing of data structures in the style of SQL, if earlier the task to get the sum of all odd numbers from the collection was solved by the following code: <br><pre><code class="java hljs">Integer sumOddOld = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(Integer i: collection) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(i % <span class="hljs-number"><span class="hljs-number">2</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span>) { sumOddOld += i; } }</code> </pre> <br>  Then with the help of Stream Api you can solve this problem in a functional style: <br><pre> <code class="java hljs"> Integer sumOdd = collection.stream().filter(o -&gt; o % <span class="hljs-number"><span class="hljs-number">2</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span>).reduce((s1, s2) -&gt; s1 + s2).orElse(<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br>  Moreover, Stream Api allows solving the task in parallel only by changing stream () to parallelStream () without any extra code, i.e. <br><pre> <code class="java hljs"> Integer sumOdd = collection.parallelStream().filter(o -&gt; o % <span class="hljs-number"><span class="hljs-number">2</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span>).reduce((s1, s2) -&gt; s1 + s2).orElse(<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br>  Already makes the code parallel, without any semaphores, synchronizations, risks of deadlocks, etc. <br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">General table of contents 'cheat sheets'</b> <div class="spoiler_text">  <a href="https://habrahabr.ru/post/265061/">1. JPA and Hibernate in questions and answers</a> <br>  <a href="https://habrahabr.ru/post/266821/">2. Three hundred fifty most popular non-mobile Java opensource projects on github</a> <br>  <a href="https://habrahabr.ru/company/luxoft/blog/256877/">3. Collections in Java (standard, guava, apache, trove, gs-collections, and others</a> <br>  <a href="https://habrahabr.ru/company/luxoft/blog/270383/">4. Java Stream API</a> <br>  <a href="https://habrahabr.ru/company/luxoft/blog/272025/">5. Two hundred and fifty Russian-language teaching videos of lectures and reports on Java.</a> <br>  <a href="https://habrahabr.ru/company/luxoft/blog/280784/">6. List of useful links for Java programmer</a> <br>  7 Typical tasks <br>  <a href="https://habrahabr.ru/post/278233/">7.1 Optimum way to convert an InputStream to a string</a> <br>  <a href="https://habrahabr.ru/post/278313/">7.2 The most productive way to bypass the Map, count the number of occurrences of the substring</a> <br>  <a href="https://habrahabr.ru/company/luxoft/blog/280782/">8. Libraries for working with Json (Gson, Fastjson, LoganSquare, Jackson, JsonPath and others)</a> <br></div></div><br><br>  Let's start from the beginning, namely the creation of stream objects in Java 8. <br><br><h2>  <b>I. Ways to create streams</b> </h2><br>  Here are some ways to create a stream. <br><table><tbody><tr><th>  The way to create stream </th><th>  Creation Template </th><th>  Example </th></tr><tr><td>  1. Classic: Creating a stream from the collection </td><td>  collection.  <b>stream</b> () </td><td><pre> <code class="java hljs">Collection&lt;String&gt; collection = Arrays.asList(<span class="hljs-string"><span class="hljs-string">"a1"</span></span>, <span class="hljs-string"><span class="hljs-string">"a2"</span></span>, <span class="hljs-string"><span class="hljs-string">"a3"</span></span>); Stream&lt;String&gt; streamFromCollection = collection.stream();</code> </pre></td></tr><tr><td>  2. Creating a stream from values </td><td>  <b>Stream.of</b> ( <i>value1</i> , ... <b>valueN</b> ) </td><td><pre> <code class="java hljs">Stream&lt;String&gt; streamFromValues = Stream.of(<span class="hljs-string"><span class="hljs-string">"a1"</span></span>, <span class="hljs-string"><span class="hljs-string">"a2"</span></span>, <span class="hljs-string"><span class="hljs-string">"a3"</span></span>);</code> </pre></td></tr><tr><td>  3. Creating a stream from an array </td><td>  <b>Arrays.stream</b> ( <i>array</i> ) </td><td><pre> <code class="java hljs">String[] array = {<span class="hljs-string"><span class="hljs-string">"a1"</span></span>,<span class="hljs-string"><span class="hljs-string">"a2"</span></span>,<span class="hljs-string"><span class="hljs-string">"a3"</span></span>}; Stream&lt;String&gt; streamFromArrays = Arrays.stream(array);</code> </pre></td></tr><tr><td>  4. Creating a stream from a file (each line in the file will be a separate element in the stream) </td><td>  <b>Files.lines</b> ( <i>file_path</i> ) </td><td><pre> <code class="java hljs">Stream&lt;String&gt; streamFromFiles = Files.lines(Paths.get(<span class="hljs-string"><span class="hljs-string">"file.txt"</span></span>))</code> </pre></td></tr><tr><td>  5. Creating a stream from a string </td><td>  "line".  <b>chars</b> () </td><td><pre> <code class="java hljs">IntStream streamFromString = <span class="hljs-string"><span class="hljs-string">"123"</span></span>.chars()</code> </pre></td></tr><tr><td>  6. Using Stream.builder </td><td>  Stream.  <b>builder</b> ().  <b>add</b> (...) .... <b>build</b> () </td><td><pre> <code class="java hljs">Stream.builder().add(<span class="hljs-string"><span class="hljs-string">"a1"</span></span>).add(<span class="hljs-string"><span class="hljs-string">"a2"</span></span>).add(<span class="hljs-string"><span class="hljs-string">"a3"</span></span>).build()</code> </pre></td></tr><tr><td>  7. Creating a parallel stream </td><td>  collection.  <b>parallelStream</b> () </td><td><pre> <code class="java hljs">Stream&lt;String&gt; stream = collection.parallelStream();</code> </pre><br></td></tr><tr><td>  8. Creating endless streams using Stream.iterate <br></td><td>  <b>Stream.iterate</b> ( <b>start_condition</b> , <i>expression_generation</i> ) </td><td><pre> <code class="java hljs">Stream&lt;Integer&gt; streamFromIterate = Stream.iterate(<span class="hljs-number"><span class="hljs-number">1</span></span>, n -&gt; n + <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre></td></tr><tr><td>  9. Creating Endless Stream with Stream.generate </td><td>  <b>Stream.generate</b> ( <b>generation_express</b> ) </td><td><pre> <code class="java hljs">Stream&lt;String&gt; streamFromGenerate = Stream.generate(() -&gt; <span class="hljs-string"><span class="hljs-string">"a1"</span></span>)</code> </pre></td></tr></tbody></table><br>  In principle, except for the last two ways to create a stream, everything is no different from the usual ways of creating collections.  The last two methods are used to generate infinite streams, the initial condition is set in iterate and the expression getting the next value from the previous one, that is, Stream.iterate (1, n -&gt; n + 1) will produce the values ‚Äã‚Äã1, 2, 3, 4, ... N Stream.generate is used to generate constant and random values, it just gives out the values ‚Äã‚Äãcorresponding to the expression, in this example, it will produce an infinite number of ‚Äúa1‚Äù values. <br><div class="spoiler">  <b class="spoiler_title">For those who do not know lambda</b> <div class="spoiler_text">  The expression n -&gt; n + 1 is just an analogue of the expression Integer func (Integer n) {return n + 1;}, and the expression () -&gt; "a1" is analogous to the expression String func () {return "a1";} wrapped in anonymous class. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">More detailed examples</b> <div class="spoiler_text">  Also this example can be found on <a href="">github</a> 'e <br><pre> <code class="java hljs"> System.out.println(<span class="hljs-string"><span class="hljs-string">"Test buildStream start"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     Stream&lt;String&gt; streamFromValues = Stream.of("a1", "a2", "a3"); System.out.println("streamFromValues = " + streamFromValues.collect(Collectors.toList())); //  streamFromValues = [a1, a2, a3] //     String[] array = {"a1","a2","a3"}; Stream&lt;String&gt; streamFromArrays = Arrays.stream(array); System.out.println("streamFromArrays = " + streamFromArrays.collect(Collectors.toList())); //  streamFromArrays = [a1, a2, a3] Stream&lt;String&gt; streamFromArrays1 = Stream.of(array); System.out.println("streamFromArrays1 = " + streamFromArrays1.collect(Collectors.toList())); //  streamFromArrays = [a1, a2, a3] //     (        ) File file = new File("1.tmp"); file.deleteOnExit(); PrintWriter out = new PrintWriter(file); out.println("a1"); out.println("a2"); out.println("a3"); out.close(); Stream&lt;String&gt; streamFromFiles = Files.lines(Paths.get(file.getAbsolutePath())); System.out.println("streamFromFiles = " + streamFromFiles.collect(Collectors.toList())); //  streamFromFiles = [a1, a2, a3] //     Collection&lt;String&gt; collection = Arrays.asList("a1", "a2", "a3"); Stream&lt;String&gt; streamFromCollection = collection.stream(); System.out.println("streamFromCollection = " + streamFromCollection.collect(Collectors.toList())); //  streamFromCollection = [a1, a2, a3] //      IntStream streamFromString = "123".chars(); System.out.print("streamFromString = "); streamFromString.forEach((e)-&gt;System.out.print(e + " , ")); //  streamFromString = 49 , 50 , 51 , System.out.println(); //   Stream.builder Stream.Builder&lt;String&gt; builder = Stream.builder(); Stream&lt;String&gt; streamFromBuilder = builder.add("a1").add("a2").add("a3").build(); System.out.println("streamFromBuilder = " + streamFromBuilder.collect((Collectors.toList()))); //  streamFromFiles = [a1, a2, a3] //    //   Stream.iterate Stream&lt;Integer&gt; streamFromIterate = Stream.iterate(1, n -&gt; n + 2); System.out.println("streamFromIterate = " + streamFromIterate.limit(3).collect(Collectors.toList())); //  streamFromIterate = [1, 3, 5] //   Stream.generate Stream&lt;String&gt; streamFromGenerate = Stream.generate(() -&gt; "a1"); System.out.println("streamFromGenerate = " + streamFromGenerate.limit(3).collect(Collectors.toList())); //  streamFromGenerate = [a1, a1, a1] //    Stream&lt;String&gt; streamEmpty = Stream.empty(); System.out.println("streamEmpty = " + streamEmpty.collect(Collectors.toList())); //  streamEmpty = [] //      Stream&lt;String&gt; parallelStream = collection.parallelStream(); System.out.println("parallelStream = " + parallelStream.collect(Collectors.toList())); //  parallelStream = [a1, a2, a3]</span></span></code> </pre><br></div></div><br><br><h2>  <b>Ii.</b>  <b>Streaming Methods</b> </h2><br>  The Java Stream API offers two kinds of methods: <br>  1. Conveyor - return another stream, that is, they work as a builder, <br>  2. Terminal - return another object, such as a collection, primitives, objects, Optional, etc. <br><br><div class="spoiler">  <b class="spoiler_title">What are the differences between conveyor and terminal methods?</b> <div class="spoiler_text">  <b>The general rule</b> is that a stream can have as many pipeline calls as possible and at the end one terminal, all pipeline methods are lazily executed and until the terminal method is called no action actually occurs, just like creating a Thread or Runnable object , but do not call it start. <br><br>  In general, this mechanism is similar to constructing SQL queries, there can be any number of nested Selects and only one result in the end.  For example, in the expression collection.stream (). Filter ((s) -&gt; s.contains ("1")). Skip (2) .findFirst (), filter and skip are pipelined, and findFirst is terminal, it returns the object Optional and this ends work with stream. <br></div></div><br><br><h3>  <b>2.1 Brief description of conveyor methods of working with streams</b> </h3><br><table><tbody><tr><th width="140">  Stream method </th><th>  Description </th><th width="420">  Example </th></tr><tr><td>  <b>filter</b> </td><td>  Filters records, returns only records that match the condition. </td><td>  collection.stream (). filter ("a1" :: equals) .count () </td></tr><tr><td>  <b>skip</b> </td><td>  Lets skip the first N items. </td><td>  collection.stream (). skip (collection.size () - 1) .findFirst (). orElse ("1") </td></tr><tr><td>  <b>distinct</b> </td><td>  Returns a stream without duplicates (for the equals method) </td><td>  collection.stream (). distinct (). collect (Collectors.toList ()) </td></tr><tr><td>  <b>map</b> </td><td>  Converts every element of stream </td><td>  collection.stream (). map ((s) -&gt; s + "_1"). collect (Collectors.toList ()) </td></tr><tr><td>  <b>peek</b> </td><td>  Returns the same stream, but applies a function to each element of the stream. </td><td>  collection.stream (). map (String :: toUpperCase) .peek ((e) -&gt; System.out.print ("," + e)). <br>  collect (Collectors.toList ()) </td></tr><tr><td>  <b>limit</b> </td><td>  Allows you to limit the sample to a certain number of first elements. </td><td>  collection.stream (). limit (2) .collect (Collectors.toList ()) </td></tr><tr><td>  <b>sorted</b> </td><td>  Allows you to sort the values ‚Äã‚Äãeither in natural order or by specifying the Comparator </td><td>  collection.stream (). sorted (). collect (Collectors.toList ()) </td></tr><tr><td>  <b>mapToInt</b> , <br>  <b>mapToDouble</b> , <br>  <b>mapToLong</b> </td><td>  Analogue map, but returns a numeric stream (that is, a stream of numeric primitives) </td><td>  collection.stream (). mapToInt ((s) -&gt; Integer.parseInt (s)). toArray () </td></tr><tr><td>  <b>flatmap</b> <br>  <b>flatMapToInt</b> , <br>  <b>flatMapToDouble</b> , <br>  <b>flatMapToLong</b> </td><td>  It looks like a map, but it can create several </td><td>  collection.stream (). flatMap ((p) -&gt; Arrays.asList (p.split (",")). stream ()). toArray (String [] :: new) </td></tr></tbody></table><br><br><h3>  <b>2.2 Brief description of terminal methods of working with streams</b> </h3><br><table><tbody><tr><th width="120">  Stream method </th><th>  Description </th><th width="450">  Example </th></tr><tr><td>  <b>findFirst</b> </td><td>  Returns the first element from the stream (returns Optional) </td><td>  collection.stream (). findFirst (). orElse ("1") </td></tr><tr><td>  <b>findAny</b> </td><td>  Returns any suitable element from the stream (returns Optional) </td><td>  collection.stream (). findAny (). orElse ("1") </td></tr><tr><td>  <b>collect</b> </td><td>  Presentation of results in the form of collections and other data structures </td><td>  collection.stream (). filter ((s) -&gt; s.contains ("1")). collect (Collectors.toList ()) </td></tr><tr><td>  <b>count</b> </td><td>  Returns the number of elements in the stream. </td><td>  collection.stream (). filter ("a1" :: equals) .count () </td></tr><tr><td>  <b>anyMatch</b> </td><td>  Returns true if the condition is true for at least one element. </td><td>  collection.stream (). anyMatch ("a1" :: equals) </td></tr><tr><td>  <b>noneMatch</b> </td><td>  Returns true if the condition is not met for one element. </td><td>  collection.stream (). noneMatch ("a8" :: equals) </td></tr><tr><td>  <b>allMatch</b> </td><td>  Returns true if the condition is true for all items. </td><td>  collection.stream (). allMatch ((s) -&gt; s.contains ("1")) </td></tr><tr><td>  <b>min</b> </td><td>  Returns the minimum element, uses a comparator as a condition </td><td>  collection.stream (). min (String :: compareTo) .get () </td></tr><tr><td>  <b>max</b> </td><td>  Returns the maximum element, uses a comparator as a condition </td><td>  collection.stream (). max (String :: compareTo) .get () </td></tr><tr><td>  <b>forEach</b> </td><td>  Applies a function to each stream object, order when executed in parallel is not guaranteed. </td><td>  set.stream (). forEach ((p) -&gt; p.append ("_ 1")); </td></tr><tr><td>  <b>forEachOrdered</b> </td><td>  Applies a function to each stream object, preserving the order of the elements guarantees </td><td>  list.stream (). forEachOrdered ((p) -&gt; p.append ("_ new")); </td></tr><tr><td>  <b>toArray</b> </td><td>  Returns an array of stream values </td><td>  collection.stream (). map (String :: toUpperCase) .toArray (String [] :: new); </td></tr><tr><td>  <b>reduce</b> </td><td>  Allows you to perform aggregate functions on the entire collection and return a single result. </td><td>  collection.stream (). reduce ((s1, s2) -&gt; s1 + s2) .orElse (0) </td></tr></tbody></table><br>  Pay attention to the methods findFirst, findAny, anyMatch are short-circuiting methods, that is, bypassing streams is organized in such a way as to find a suitable element as quickly as possible, and not to bypass the entire original stream. <br><br><h3>  <b>2.3 Brief description of additional methods for numeric streams</b> </h3><br><table><tbody><tr><th width="100">  Stream method </th><th>  Description </th><th width="450">  Example </th></tr><tr><td>  <b>sum</b> </td><td>  Returns the sum of all numbers. </td><td>  collection.stream (). mapToInt ((s) -&gt; Integer.parseInt (s)). sum () </td></tr><tr><td>  <b>average</b> </td><td>  Returns the arithmetic average of all numbers. </td><td>  collection.stream (). mapToInt ((s) -&gt; Integer.parseInt (s)). average () </td></tr><tr><td>  <b>mapToObj</b> </td><td>  Converts a numeric stream back to an object. </td><td>  intStream.mapToObj ((id) -&gt; new Key (id)). toArray () </td></tr></tbody></table><br><br><h3>  <b>2.4 Several other useful streaming methods</b> </h3><br><table><tbody><tr><th width="100">  Stream method </th><th>  Description </th></tr><tr><td>  <b>isParallel</b> </td><td>  Find out if the stream is parallel </td></tr><tr><td>  <b>parallel</b> </td><td>  Return a parallel stream, if the stream is already parallel, it can return itself </td></tr><tr><td>  <b>sequential</b> </td><td>  Return a consecutive stream, if the stream is already consistent, it can return itself </td></tr></tbody></table><br>  With the help of methods parallel and sequential, you can determine which operations can be parallel, and which only sequential.  You can also make a parallel stream from any serial stream and vice versa, that is: <br><pre> <code class="java hljs">collection.stream(). peek(...). <span class="hljs-comment"><span class="hljs-comment">//   parallel(). map(...). //    , sequential(). reduce(...) //   </span></span></code> </pre><br><br>  <b>Attention</b> : it is not recommended to use parallel streams for any long operations (retrieving data from the database, network connections), since all parallel streams work with one fork / join pool and such long operations can stop all parallel streams in the JVM from for the lack of available threads in the pool, i.e.  parallel streams should be used only for short operations, where the count goes on for milliseconds, but not for those where the count can go on for seconds and minutes. <br><br><h2>  <b>Iii.</b>  <b>Examples of working with stream methods</b> </h2><br>  Consider working with methods on various tasks that are usually required when working with collections. <br><br><h3>  <b>3.1 Examples of using filter, findFirst, findAny, skip, limit and count</b> </h3><br>  <b>Condition</b> : a collection of Arrays.asList strings is given ("a1", "a2", "a3", "a1"), let's see how it can be processed using the filter, findFirst, findAny, skip and count methods: <br><table><tbody><tr><th width="300">  Task </th><th>  Sample code </th><th width="90">  Result </th></tr><tr><td>  Return the number of occurrences of the object "a1" </td><td>  collection.stream (). filter ("a1" :: equals) .count () </td><td>  2 </td></tr><tr><td>  Return the first element of the collection, or 0 if the collection is empty </td><td>  collection.stream (). findFirst (). orElse ("0") </td><td>  a1 </td></tr><tr><td>  Return the last element of the collection or ‚Äúempty‚Äù if the collection is empty. </td><td>  collection.stream (). skip (collection.size () - 1) .findAny (). orElse ("empty") </td><td>  a1 </td></tr><tr><td>  Find an item in the collection equal to "a3" or throw an error </td><td>  collection.stream (). filter ("a3" :: equals) .findFirst (). get () </td><td>  a3 </td></tr><tr><td>  Return the third element of the collection in order </td><td>  collection.stream (). skip (2) .findFirst (). get () </td><td>  a3 </td></tr><tr><td>  Return two items starting from the second </td><td>  collection.stream (). skip (1) .limit (2) .toArray () </td><td>  [a2, a3] </td></tr><tr><td>  Select all items by pattern </td><td>  collection.stream (). filter ((s) -&gt; s.contains ("1")). collect (Collectors.toList ()) </td><td>  [a1, a1] </td></tr></tbody></table><br>  <b>Notice</b> that the findFirst and findAny methods return a new type, Optional, introduced in Java 8, in order to avoid a NullPointerException.  The filter method is convenient to use to select only a specific set of values, and the skip method allows you to skip a certain number of elements. <br><div class="spoiler">  <b class="spoiler_title">If you do not know lambda</b> <div class="spoiler_text">  The expression "a3" :: equals is an analogue of boolean func (s) {return "a3" .equals (s);}, and (s) -&gt; s.contains ("1") is an analogue of boolean func (s) {return s.contains ("1");} wrapped in an anonymous class. <br></div></div><br>  <b>Condition</b> : a collection of the People class is given (with the fields name ‚Äî name, age ‚Äî age, sex ‚Äî gender), of the form Arrays.asList (new People (‚ÄúVasya‚Äù, 16, Sex.MAN), new People (‚ÄúPetya‚Äù, 23, Sex.MAN), new People (‚ÄúElena‚Äù, 42, Sex.WOMEN), new People (‚ÄúIvan Ivanovich‚Äù, 69, Sex.MAN)).  Let's see examples of how to work with this class: <br><br><table><tbody><tr><th width="300">  Task </th><th>  Sample code </th><th width="90">  Result </th></tr><tr><td>  Select men-conscripts (from 18 to 27 years) </td><td>  peoples.stream (). filter ((p) -&gt; p.getAge ()&gt; = 18 &amp;&amp; p.getAge () &lt;27 <br>  &amp;&amp; p.getSex () == Sex.MAN) .collect (Collectors.toList ()) </td><td>  [{name = 'Peter', age = 23, sex = MAN}] </td></tr><tr><td>  Find the average age among men </td><td>  peoples.stream (). filter ((p) -&gt; p.getSex () == Sex.MAN). <br>  mapToInt (People :: getAge) .average (). getAsDouble () </td><td>  36.0 </td></tr><tr><td>  Find the number of potentially working people in the sample (i.e., from 18 years old and considering that women are 55, and men are 60) </td><td>  peoples.stream (). filter ((p) -&gt; p.getAge ()&gt; = 18) .filter ( <br>  (p) -&gt; (p.getSex () == Sex.WOMEN &amp;&amp; p.getAge () &lt;55) ||  (p.getSex () == Sex.MAN &amp;&amp; p.getAge () &lt;60)). count () </td><td>  2 </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">Detailed examples</b> <div class="spoiler_text">  Also this example can be found on github'e: <a href="">first class</a> and <a href="">second class</a> <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">// filter -  stream,     ,    // count -      // collect -  stream       // mapToInt -      (,  ) private static void testFilterAndCount() { System.out.println(); System.out.println("Test filter and count start"); Collection&lt;String&gt; collection = Arrays.asList("a1", "a2", "a3", "a1"); Collection&lt;People&gt; peoples = Arrays.asList( new People("", 16, Sex.MAN), new People("", 23, Sex.MAN), new People("", 42, Sex.WOMEN), new People(" ", 69, Sex.MAN) ); //     long count = collection.stream().filter("a1"::equals).count(); System.out.println("count = " + count); //  count = 2 //      List&lt;String&gt; select = collection.stream().filter((s) -&gt; s.contains("1")).collect(Collectors.toList()); System.out.println("select = " + select); //  select = [a1, a1] //  - List&lt;People&gt; militaryService = peoples.stream().filter((p)-&gt; p.getAge() &gt;= 18 &amp;&amp; p.getAge() &lt; 27 &amp;&amp; p.getSex() == Sex.MAN).collect(Collectors.toList()); System.out.println("militaryService = " + militaryService); //  militaryService = [{name='', age=23, sex=MAN}] //      double manAverageAge = peoples.stream().filter((p) -&gt; p.getSex() == Sex.MAN). mapToInt(People::getAge).average().getAsDouble(); System.out.println("manAverageAge = " + manAverageAge); //  manAverageAge = 36.0 //  -      (..  18        55 ,    60) long peopleHowCanWork = peoples.stream().filter((p) -&gt; p.getAge() &gt;= 18).filter( (p) -&gt; (p.getSex() == Sex.WOMEN &amp;&amp; p.getAge() &lt; 55) || (p.getSex() == Sex.MAN &amp;&amp; p.getAge() &lt; 60)).count(); System.out.println("peopleHowCanWork = " + peopleHowCanWork); //  manAverageAge = 2 } // findFirst -   Optional    // skip -  N   ( N  ) // collect  stream       private static void testFindFirstSkipCount() { Collection&lt;String&gt; collection = Arrays.asList("a1", "a2", "a3", "a1"); System.out.println("Test findFirst and skip start"); //     String first = collection.stream().findFirst().orElse("1"); System.out.println("first = " + first); //  first = a1 //     String last = collection.stream().skip(collection.size() - 1).findAny().orElse("1"); System.out.println("last = " + last ); //  last = a1 //     String find = collection.stream().filter("a3"::equals).findFirst().get(); System.out.println("find = " + find); //  find = a3 //       String third = collection.stream().skip(2).findFirst().get(); System.out.println("third = " + third); //  third = a3 System.out.println(); System.out.println("Test collect start"); //      List&lt;String&gt; select = collection.stream().filter((s) -&gt; s.contains("1")).collect(Collectors.toList()); System.out.println("select = " + select); //  select = [a1, a1] } //  Limit        private static void testLimit() { System.out.println(); System.out.println("Test limit start"); Collection&lt;String&gt; collection = Arrays.asList("a1", "a2", "a3", "a1"); //     List&lt;String&gt; limit = collection.stream().limit(2).collect(Collectors.toList()); System.out.println("limit = " + limit); //  limit = [a1, a2] //       List&lt;String&gt; fromTo = collection.stream().skip(1).limit(2).collect(Collectors.toList()); System.out.println("fromTo = " + fromTo); //  fromTo = [a2, a3] //     String last = collection.stream().skip(collection.size() - 1).findAny().orElse("1"); System.out.println("last = " + last ); //  last = a1 } private enum Sex { MAN, WOMEN } private static class People { private final String name; private final Integer age; private final Sex sex; public People(String name, Integer age, Sex sex) { this.name = name; this.age = age; this.sex = sex; } public String getName() { return name; } public Integer getAge() { return age; } public Sex getSex() { return sex; } @Override public String toString() { return "{" + "name='" + name + '\'' + ", age=" + age + ", sex=" + sex + '}'; } }</span></span></code> </pre><br></div></div><br><br><h3>  <b>3.2 Examples of using distinct</b> </h3><br>  The distinct method returns stream without duplicates, while for an ordered stream (for example, a list-based collection), the order is stable, for an unordered stream, order is not guaranteed.  Consider the results of the collection on the Collection ordered ordered = Arrays.asList ("a1", "a2", "a2", "a3", "a1", "a2", "a2") and Collection nonOrdered = new HashSet &lt;&gt; (ordered ). <br><table><tbody><tr><th width="300">  Task </th><th>  Sample code </th><th width="150">  Result </th></tr><tr><td>  Getting a collection without duplicates from an unordered stream </td><td>  nonOrdered.stream (). distinct (). collect (Collectors.toList ()) </td><td>  [a1, a2, a3] - <br>  order is not guaranteed </td></tr><tr><td>  Getting a collection without duplicates from streamlined stream </td><td>  ordered.stream (). distinct (). collect (Collectors.toList ()); </td><td>  [a1, a2, a3] - <br>  order is guaranteed </td></tr></tbody></table><br><br>  <b>Note:</b> <br>  1. If you use distinct with a class that has equals redefined, you must also correctly override hashCode according to the equals / hashCode contract (the most important thing is that hashCode for all equals objects returns the same value), otherwise the distinct may not remove duplicates (similarly like using HashSet / HashMap), <br>  2. If you use parallel streams and you don‚Äôt care about the order of elements after removing duplicates - it‚Äôs much better for performance to do first stream unordered with unordered (), and only then use distinct (), since maintaining sorting stability while parallel streaming is rather expensive. resources and distinct () on an ordered stream will be executed much longer than with an unordered, <br><br><div class="spoiler">  <b class="spoiler_title">Detailed examples</b> <div class="spoiler_text">  Also this example can be found on <a href="">github'e</a> <br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//  distinct  stream  ,      (,    list)   ,   -    //  collect  stream       private static void testDistinct() { System.out.println(); System.out.println("Test distinct start"); Collection&lt;String&gt; ordered = Arrays.asList("a1", "a2", "a2", "a3", "a1", "a2", "a2"); Collection&lt;String&gt; nonOrdered = new HashSet&lt;&gt;(ordered); //     List&lt;String&gt; distinct = nonOrdered.stream().distinct().collect(Collectors.toList()); System.out.println("distinct = " + distinct); //  distinct = [a1, a2, a3] -    List&lt;String&gt; distinctOrdered = ordered.stream().distinct().collect(Collectors.toList()); System.out.println("distinctOrdered = " + distinctOrdered); //  distinct = [a1, a2, a3] -   }</span></span></code> </pre><br></div></div><br><br><h3>  <b>3.3 Examples of using Match functions (anyMatch, allMatch, noneMatch)</b> </h3><br>  <b>Condition</b> : a collection of Arrays.asList strings is given ("a1", "a2", "a3", "a1"), let's see how it can be processed using the Match function <br><br><table><tbody><tr><th width="300">  Task </th><th>  Sample code </th><th width="90">  Result </th></tr><tr><td>  Find whether there is at least one "a1" element in the collection. </td><td>  collection.stream (). anyMatch ("a1" :: equals) </td><td>  true </td></tr><tr><td>  Find whether there is at least one ‚Äúa8‚Äù item in the collection. </td><td>  collection.stream (). anyMatch ("a8" :: equals) </td><td>  false </td></tr><tr><td>  Find whether there is a symbol "1" for all elements of the collection. </td><td>  collection.stream (). allMatch ((s) -&gt; s.contains ("1")) </td><td>  false </td></tr><tr><td>  Check that there are no ‚Äúa7‚Äù items in the collection. </td><td>  collection.stream (). noneMatch ("a7" :: equals) </td><td>  true </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">Detailed examples</b> <div class="spoiler_text">  Also this example can be found on <a href="">github'e</a> <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//  anyMatch -  true,         //  noneMatch -  true,         //  allMatch -  true,       private static void testMatch() { System.out.println(); System.out.println("Test anyMatch, allMatch, noneMatch start"); Collection&lt;String&gt; collection = Arrays.asList("a1", "a2", "a3", "a1"); //           boolean isAnyOneTrue = collection.stream().anyMatch("a1"::equals); System.out.println("anyOneTrue " + isAnyOneTrue); //  true boolean isAnyOneFalse = collection.stream().anyMatch("a8"::equals); System.out.println("anyOneFlase " + isAnyOneFalse); //  false //          boolean isAll = collection.stream().allMatch((s) -&gt; s.contains("1")); System.out.println("isAll " + isAll); //  false //    boolean isNotEquals = collection.stream().noneMatch("a7"::equals); System.out.println("isNotEquals " + isNotEquals); //  true }</span></span></code> </pre><br></div></div><br><br><h3> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.4 Examples of using Map functions (map, mapToInt, FlatMap, FlatMapToInt)</font></font></b> </h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condition</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : two collections, collection1 = Arrays.asList ("a1", "a2", "a3", "a1") and collection2 = Arrays.asList ("1.2.0", "4.5"), are given Let's see how it can be processed using various map functions.</font></font><br><br><table><tbody><tr><th width="300">  Task </th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sample code </font></font></th><th width="90">  Result </th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Add "_1" to each element of the first collection </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection1.stream (). map ((s) -&gt; s + "_1"). collect (Collectors.toList ()) </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [a1_1, a2_1, a3_1, a1_1] </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In the first collection, remove the first character and return an array of numbers (int []) </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection1.stream (). mapToInt ((s) -&gt; Integer.parseInt (s.substring (1))). toArray () </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [1, 2, 3, 1] </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> From the second collection get all the numbers listed, separated by commas from all the elements. </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection2.stream (). flatMap ((p) -&gt; Arrays.asList (p.split (",")). stream ()). toArray (String [] :: new) </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [1, 2, 0, 4, 5] </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> From the second collection to get the sum of all the numbers separated by commas </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection2.stream (). flatMapToInt ((p) -&gt; Arrays.asList (p.split (",")). stream (). mapToInt (Integer :: parseInt)). sum () </font></font></td><td>  12 </td></tr></tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Please note: all map functions can return an object of another type (class), that is, map can work with a stream of lines, and output Stream from Integer values ‚Äã‚Äãor get the People class, and return the Office class, where these people work, etc. p., flatMap (flatMapToInt, etc.) should return a stream with one, several or no elements for each element of the incoming stream (see the last two examples) for output. </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detailed examples</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Also this example can be found on </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github'e</font></font></a> <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//  Map     ,  stream    private static void testMap() { System.out.println(); System.out.println("Test map start"); Collection&lt;String&gt; collection = Arrays.asList("a1", "a2", "a3", "a1"); //     List&lt;String&gt; transform = collection.stream().map((s) -&gt; s + "_1").collect(Collectors.toList()); System.out.println("transform = " + transform); //  transform = [a1_1, a2_1, a3_1, a1_1] //       List&lt;Integer&gt; number = collection.stream().map((s) -&gt; Integer.parseInt(s.substring(1))).collect(Collectors.toList()); System.out.println("number = " + number); //  transform = [1, 2, 3, 1] } //  MapToInt -     ,  stream     private static void testMapToInt() { System.out.println(); System.out.println("Test mapToInt start"); Collection&lt;String&gt; collection = Arrays.asList("a1", "a2", "a3", "a1"); //       int[] number = collection.stream().mapToInt((s) -&gt; Integer.parseInt(s.substring(1))).toArray(); System.out.println("number = " + Arrays.toString(number)); //  number = [1, 2, 3, 1] } //  FlatMap -   Map -    ,    stream  private static void testFlatMap() { System.out.println(); System.out.println("Test flat map start"); Collection&lt;String&gt; collection = Arrays.asList("1,2,0", "4,5"); //    ,      collection String[] number = collection.stream().flatMap((p) -&gt; Arrays.asList(p.split(",")).stream()).toArray(String[]::new); System.out.println("number = " + Arrays.toString(number)); //  number = [1, 2, 0, 4, 5] } //  FlatMapToInt -   MapToInt -    ,    stream  private static void testFlatMapToInt() { System.out.println(); System.out.println("Test flat map start"); Collection&lt;String&gt; collection = Arrays.asList("1,2,0", "4,5"); //     ,      collection int sum = collection.stream().flatMapToInt((p) -&gt; Arrays.asList(p.split(",")).stream().mapToInt(Integer::parseInt)).sum(); System.out.println("sum = " + sum); //  sum = 12 }</span></span></code> </pre><br></div></div><br><br><h3> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.5 Examples of using the Sorted function</font></font></b> </h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condition</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : two collections of strings Arrays.asList ("a1", "a4", "a3", "a2", "a1", "a4") and a collection of people of the class People are given (with fields name - name, age - age , sex - gender), of the type of Arrays.asList (new People (‚ÄúVasya‚Äù, 16, Sex.MAN), new People (‚ÄúPeter‚Äù, 23, Sex.MAN), new People (‚ÄúElena‚Äù, 42, Sex. WOMEN), new People (‚ÄúIvan Ivanovich‚Äù, 69, Sex.MAN)). </font><font style="vertical-align: inherit;">Let's see examples of how to sort them:</font></font><br><br><table><tbody><tr><th width="300">  Task </th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sample code </font></font></th><th width="130">  Result </th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sort the string collection alphabetically </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection.stream (). sorted (). collect (Collectors.toList ()) </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [a1, a1, a2, a3, a4, a4] </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sort the string collection alphabetically in reverse order. </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection.stream (). sorted ((o1, o2) -&gt; -o1.compareTo (o2)). collect (Collectors.toList ()) </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [a4, a4, a3, a2, a1, a1] </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sort the collection of strings alphabetically and remove duplicates </font></font></td><td> collection.stream().sorted().distinct().collect(Collectors.toList()) </td><td> [a1, a2, a3, a4] </td></tr><tr><td>            </td><td> collection.stream().sorted((o1, o2) -&gt; -o1.compareTo(o2)).distinct().collect(Collectors.toList()) </td><td> [a4, a3, a2, a1] </td></tr><tr><td>          </td><td> peoples.stream().sorted((o1,o2) -&gt; -o1.getName().compareTo(o2.getName())).collect(Collectors.toList()) </td><td> [{''}, {' '}, {''}, {''}] <br></td></tr><tr><td>      ,     </td><td> peoples.stream().sorted((o1, o2) -&gt; o1.getSex() != o2.getSex()? o1.getSex(). <br> compareTo(o2.getSex()): o1.getAge().compareTo(o2.getAge())).collect(Collectors.toList()) </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [{'Vasya'}, {'Petya'}, {'Ivan Ivanovich'}, {'Elena'}] </font></font></td></tr></tbody></table><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detailed examples</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Also this example can be found on </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github'e</font></font></a> <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//  Sorted       ,   Comparator private static void testSorted() { System.out.println(); System.out.println("Test sorted start"); // ************    Collection&lt;String&gt; collection = Arrays.asList("a1", "a4", "a3", "a2", "a1", "a4"); //     List&lt;String&gt; sorted = collection.stream().sorted().collect(Collectors.toList()); System.out.println("sorted = " + sorted); //  sorted = [a1, a1, a2, a3, a4, a4] //        List&lt;String&gt; sortedDistinct = collection.stream().sorted().distinct().collect(Collectors.toList()); System.out.println("sortedDistinct = " + sortedDistinct); //  sortedDistinct = [a1, a2, a3, a4] //        List&lt;String&gt; sortedReverse = collection.stream().sorted((o1, o2) -&gt; -o1.compareTo(o2)).collect(Collectors.toList()); System.out.println("sortedReverse = " + sortedReverse); //  sortedReverse = [a4, a4, a3, a2, a1, a1] //           List&lt;String&gt; distinctReverse = collection.stream().sorted((o1, o2) -&gt; -o1.compareTo(o2)).distinct().collect(Collectors.toList()); System.out.println("distinctReverse = " + distinctReverse); //  sortedReverse = [a4, a3, a2, a1] // ************    //    Collection&lt;People&gt; peoples = Arrays.asList( new People("", 16, Sex.MAN), new People("", 23, Sex.MAN), new People("", 42, Sex.WOMEN), new People(" ", 69, Sex.MAN) ); //        Collection&lt;People&gt; byName = peoples.stream().sorted((o1,o2) -&gt; -o1.getName().compareTo(o2.getName())).collect(Collectors.toList()); System.out.println("byName = " + byName); // byName = [{name='', age=23, sex=MAN}, {name=' ', age=69, sex=MAN}, {name='', age=42, sex=WOMEN}, {name='', age=16, sex=MAN}] //    ,     Collection&lt;People&gt; bySexAndAge = peoples.stream().sorted((o1, o2) -&gt; o1.getSex() != o2.getSex() ? o1.getSex(). compareTo(o2.getSex()) : o1.getAge().compareTo(o2.getAge())).collect(Collectors.toList()); System.out.println("bySexAndAge = " + bySexAndAge); // bySexAndAge = [{name='', age=16, sex=MAN}, {name='', age=23, sex=MAN}, {name=' ', age=69, sex=MAN}, {name='', age=42, sex=WOMEN}] } private enum Sex { MAN, WOMEN } private static class People { private final String name; private final Integer age; private final Sex sex; public People(String name, Integer age, Sex sex) { this.name = name; this.age = age; this.sex = sex; } public String getName() { return name; } public Integer getAge() { return age; } public Sex getSex() { return sex; } @Override public String toString() { return "{" + "name='" + name + '\'' + ", age=" + age + ", sex=" + sex + '}'; } @Override public boolean equals(Object o) { if (this == o) return true; if (!(o instanceof People)) return false; People people = (People) o; return Objects.equals(name, people.name) &amp;&amp; Objects.equals(age, people.age) &amp;&amp; Objects.equals(sex, people.sex); } @Override public int hashCode() { return Objects.hash(name, age, sex); } }</span></span></code> </pre><br></div></div><br><br><h3> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.6 Examples of using Max and Min functions</font></font></b> </h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condition</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : a collection of Arrays.asList strings is given ("a1", "a2", "a3", "a1"), and a collection of the Peoples class from past examples of the Sorted and Filter functions.</font></font><br><br><table><tbody><tr><th width="300">  Task </th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sample code </font></font></th><th width="90">  Result </th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Find the maximum value among the row collection </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection.stream (). max (String :: compareTo) .get () </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a3 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Find the minimum value among the row collection </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection.stream (). min (String :: compareTo) .get () </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a1 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Find a person with a maximum age. </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peoples.stream (). max ((p1, p2) -&gt; p1.getAge (). compareTo (p2.getAge ())). get () </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {name = 'Ivan Ivanovich', age = 69, sex = MAN} </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Find a person with a minimum age </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peoples.stream (). min ((p1, p2) -&gt; p1.getAge (). compareTo (p2.getAge ())). get () </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {name = 'Vasya', age = 16, sex = MAN} </font></font></td></tr></tbody></table><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detailed examples</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Also this example can be found on </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github'e</font></font></a> <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//  max   ,      //  min   ,      private static void testMinMax() { System.out.println(); System.out.println("Test min and max start"); // ************    Collection&lt;String&gt; collection = Arrays.asList("a1", "a2", "a3", "a1"); //    String max = collection.stream().max(String::compareTo).get(); System.out.println("max " + max); //  a3 //    String min = collection.stream().min(String::compareTo).get(); System.out.println("min " + min); //  a1 // ************     //    Collection&lt;People&gt; peoples = Arrays.asList( new People("", 16, Sex.MAN), new People("", 23, Sex.MAN), new People("", 42, Sex.WOMEN), new People(" ", 69, Sex.MAN) ); //      People older = peoples.stream().max((p1, p2) -&gt; p1.getAge().compareTo(p2.getAge())).get(); System.out.println("older " + older); //  {name=' ', age=69, sex=MAN} //      People younger = peoples.stream().min((p1, p2) -&gt; p1.getAge().compareTo(p2.getAge())).get(); System.out.println("younger " + younger); //  {name='', age=16, sex=MAN} } private enum Sex { MAN, WOMEN } private static class People { private final String name; private final Integer age; private final Sex sex; public People(String name, Integer age, Sex sex) { this.name = name; this.age = age; this.sex = sex; } public String getName() { return name; } public Integer getAge() { return age; } public Sex getSex() { return sex; } @Override public String toString() { return "{" + "name='" + name + '\'' + ", age=" + age + ", sex=" + sex + '}'; } @Override public boolean equals(Object o) { if (this == o) return true; if (!(o instanceof People)) return false; People people = (People) o; return Objects.equals(name, people.name) &amp;&amp; Objects.equals(age, people.age) &amp;&amp; Objects.equals(sex, people.sex); } @Override public int hashCode() { return Objects.hash(name, age, sex); } }</span></span></code> </pre><br></div></div><br><br><h3> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.7 Examples of using ForEach and Peek functions</font></font></b> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Both ForEach and Peek essentially do the same thing, change the properties of objects in the stream, the only difference between them is that ForEach is terminal and it finishes working with the stream while Peek is pipelining and work with the stream continues. </font><font style="vertical-align: inherit;">For example, there is a collection:</font></font><pre> <code class="java hljs"> Collection&lt;StringBuilder&gt; list = Arrays.asList(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"a1"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"a2"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"a3"</span></span>));</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And you need to add "_new" to each element, then for ForEach the code will be </font></font><br><pre> <code class="java hljs"> list.stream().forEachOrdered((p) -&gt; p.append(<span class="hljs-string"><span class="hljs-string">"_new"</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// list -  [a1_new, a2_new, a3_new]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and for peek the code will be </font></font><br><pre> <code class="java hljs"> List&lt;StringBuilder&gt; newList = list.stream().peek((p) -&gt; p.append(<span class="hljs-string"><span class="hljs-string">"_new"</span></span>)).collect(Collectors.toList()); <span class="hljs-comment"><span class="hljs-comment">//  list  newList  [a1_new, a2_new, a3_new]</span></span></code> </pre><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detailed examples</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Also this example can be found on </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github'e</font></font></a> <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//  ForEach             private static void testForEach() { System.out.println(); System.out.println("For each start"); Collection&lt;String&gt; collection = Arrays.asList("a1", "a2", "a3", "a1"); //        System.out.print("forEach = "); collection.stream().map(String::toUpperCase).forEach((e) -&gt; System.out.print(e + ",")); //  forEach = A1,A2,A3,A1, System.out.println(); Collection&lt;StringBuilder&gt; list = Arrays.asList(new StringBuilder("a1"), new StringBuilder("a2"), new StringBuilder("a3")); list.stream().forEachOrdered((p) -&gt; p.append("_new")); System.out.println("forEachOrdered = " + list); //  forEachOrdered = [a1_new, a2_new, a3_new] } //  Peek    ,           private static void testPeek() { System.out.println(); System.out.println("Test peek start"); Collection&lt;String&gt; collection = Arrays.asList("a1", "a2", "a3", "a1"); //        System.out.print("peak1 = "); List&lt;String&gt; peek = collection.stream().map(String::toUpperCase).peek((e) -&gt; System.out.print(e + ",")). collect(Collectors.toList()); System.out.println(); //  peak1 = A1,A2,A3,A1, System.out.println("peek2 = " + peek); //  peek2 = [A1, A2, A3, A1] Collection&lt;StringBuilder&gt; list = Arrays.asList(new StringBuilder("a1"), new StringBuilder("a2"), new StringBuilder("a3")); List&lt;StringBuilder&gt; newList = list.stream().peek((p) -&gt; p.append("_new")).collect(Collectors.toList()); System.out.println("newList = " + newList); //  newList = [a1_new, a2_new, a3_new] }</span></span></code> </pre><br></div></div><br><br><h3> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.8 Examples of using the Reduce function</font></font></b> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The reduce method allows you to perform aggregate functions on the entire collection (such as the sum, finding the minimum or maximum value, etc.), it returns one value for the stream, the function takes two arguments ‚Äî the value obtained in the previous steps and the current value. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condition</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Given a collection of numbers Arrays.asList (1, 2, 3, 4, 2) perform several actions on them using reduce.</font></font><br><br><table><tbody><tr><th width="300">  Task </th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sample code </font></font></th><th width="90">  Result </th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Get the sum of numbers or return 0 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection.stream (). reduce ((s1, s2) -&gt; s1 + s2) .orElse (0) </font></font></td><td>  12 </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Return maximum or -1 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection.stream (). reduce (Integer :: max) .orElse (-1) </font></font></td><td>  four </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Return the sum of odd numbers or 0 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection.stream (). filter (o -&gt; o% 2! = 0) .reduce ((s1, s2) -&gt; s1 + s2) .orElse (0) </font></font></td><td>  four </td></tr></tbody></table><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detailed examples</font></font></b> <div class="spoiler_text">       <a href="">github'e</a> <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//  reduce        (  ,       ..) //    Optional  // map -      (,     ) // mapToInt -      (,    int) private static void testReduce() { System.out.println(); System.out.println("Test reduce start"); // ************     Collection&lt;Integer&gt; collection = Arrays.asList(1, 2, 3, 4, 2); //   Integer sum = collection.stream().reduce((s1, s2) -&gt; s1 + s2).orElse(0); //  stream Api Integer sumOld = 0; //    for(Integer i: collection) { sumOld += i; } System.out.println("sum = " + sum + " : " + sumOld); //  sum = 12 : 12 //   Integer max1 = collection.stream().reduce((s1, s2) -&gt; s1 &gt; s2 ? s1 : s2).orElse(0); //  stream Api Integer max2 = collection.stream().reduce(Integer::max).orElse(0); //  stream Api  Integer::max Integer maxOld = null; //    for(Integer i: collection) { maxOld = maxOld != null &amp;&amp; maxOld &gt; i? maxOld: i; } maxOld = maxOld == null? 0 : maxOld; System.out.println("max = " + max1 + " : " + max2 + " : " + maxOld); //  max1 = 4 : 4 : 4 //   Integer min = collection.stream().reduce((s1, s2) -&gt; s1 &lt; s2 ? s1 : s2).orElse(0); //  stream Api Integer minOld = null; //    for(Integer i: collection) { minOld = minOld != null &amp;&amp; minOld &lt; i? minOld: i; } minOld = minOld == null? 0 : minOld; System.out.println("min = " + min+ " : " + minOld); //  min = 1 : 1 //    Integer last = collection.stream().reduce((s1, s2) -&gt; s2).orElse(0); //  stream Api Integer lastOld = null; //    for(Integer i: collection) { lastOld = i; } lastOld = lastOld == null? 0 : lastOld; System.out.println("last = " + last + " : " + lastOld); //  last = 2 : 2 //   ,   2 Integer sumMore2 = collection.stream().filter(o -&gt; o &gt; 2).reduce((s1, s2) -&gt; s1 + s2).orElse(0); //  stream Api Integer sumMore2Old = 0; //    for(Integer i: collection) { if(i &gt; 2) { sumMore2Old += i; } } System.out.println("sumMore2 = " + sumMore2 + " : " + sumMore2Old); //  sumMore2 = 7 : 7 //     Integer sumOdd = collection.stream().filter(o -&gt; o % 2 != 0).reduce((s1, s2) -&gt; s1 + s2).orElse(0); //  stream Api Integer sumOddOld = 0; //    for(Integer i: collection) { if(i % 2 != 0) { sumOddOld += i; } } System.out.println("sumOdd = " + sumOdd + " : " + sumOddOld); //  sumOdd = 4 : 4 // ************     //    Collection&lt;People&gt; peoples = Arrays.asList( new People("", 16, Sex.MAN), new People("", 23, Sex.MAN), new People("", 42, Sex.WOMEN), new People(" ", 69, Sex.MAN) ); //     int oldMan = peoples.stream().filter((p) -&gt; p.getSex() == Sex.MAN).map(People::getAge).reduce((s1, s2) -&gt; s1 &gt; s2 ? s1 : s2).get(); System.out.println("oldMan = " + oldMan); //  69 //             int younger = peoples.stream().filter((p) -&gt; p.getName().contains("")).mapToInt(People::getAge).reduce((s1, s2) -&gt; s1 &lt; s2 ? s1 : s2).orElse(0); System.out.println("younger = " + younger); //  23 } private enum Sex { MAN, WOMEN } private static class People { private final String name; private final Integer age; private final Sex sex; public People(String name, Integer age, Sex sex) { this.name = name; this.age = age; this.sex = sex; } public String getName() { return name; } public Integer getAge() { return age; } public Sex getSex() { return sex; } @Override public String toString() { return "{" + "name='" + name + '\'' + ", age=" + age + ", sex=" + sex + '}'; } @Override public boolean equals(Object o) { if (this == o) return true; if (!(o instanceof People)) return false; People people = (People) o; return Objects.equals(name, people.name) &amp;&amp; Objects.equals(age, people.age) &amp;&amp; Objects.equals(sex, people.sex); } @Override public int hashCode() { return Objects.hash(name, age, sex); } }</span></span></code> </pre><br></div></div><br><br><h3> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.9 Examples of using the toArray and collect functions</font></font></b> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If everything is simple with toArray, you can either call toArray () to get Object [], or toArray (T [] :: new) - by getting an array of type T, then collect allows you to convert many values ‚Äã‚Äãinto a collection, map or any other type . </font><font style="vertical-align: inherit;">To do this, use static methods from Collectors, for example, the conversion to List will be stream.collect (Collectors.toList ()). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's look at static methods from Collectors:</font></font><br><table><tbody><tr><th width="200">  Method </th><th>  Description </th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toList, toCollection, toSet </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> represent stream in the form of a list, collection or set </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toConcurrentMap, toMap </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> let you convert stream to map </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> averagingInt, averagingDouble, averagingLong </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> return average </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> summingInt, summingDouble, summingLong </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> returns amount </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> summarizingInt, summarizingDouble, summarizingLong </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> return SummaryStatistics with different aggregate values </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partitioningBy </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> splits the collection into two parts according to the condition and returns them as Map &lt;Boolean, List&gt; </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> groupingBy </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> splits the collection into several parts and returns Map &lt;N, List &lt;T &gt;&gt; </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mapping </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> additional value conversions for complex collectors </font></font></td></tr></tbody></table><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now let's look at working with collect and toArray with examples: </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condition:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Given the collection of numbers Arrays.asList (1, 2, 3, 4), consider the work of collect and toArray with it</font></font><br><table><tbody><tr><th width="300">  Task </th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sample code </font></font></th><th width="150">  Result </th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Get the sum of odd numbers </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> numbers.stream (). collect (Collectors.summingInt (((p) -&gt; p% 2 == 1? p: 0))) </font></font></td><td>  four </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Subtract 1 from each item and get the average </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> numbers.stream (). collect (Collectors.averagingInt ((p) -&gt; p - 1)) </font></font></td><td>  1.5 </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Add to the numbers 3 and get statistics </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> numbers.stream (). collect (Collectors.summarizingInt ((p) -&gt; p + 3)) </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IntSummaryStatistics {count = 4, sum = 22, min = 4, average = 5.5, max = 7} </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Divide numbers into even and odd </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> numbers.stream (). collect (Collectors.partitioningBy ((p) -&gt; p% 2 == 0)) </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {false = [1, 3], true = [2, 4]} </font></font></td></tr></tbody></table><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condition:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Given a collection of Arrays.asList strings ("a1", "b2", "c3", "a1"), consider the work of collect and toArray with it</font></font><br><table><tbody><tr><th width="300">  Task </th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sample code </font></font></th><th width="120">  Result </th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Getting a list without duplicates </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> strings.stream (). distinct (). collect (Collectors.toList ()) </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [a1, b2, c3] </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Get an array of strings without duplicates and in upper case </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> strings.stream (). distinct (). map (String :: toUpperCase) .toArray (String [] :: new) </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {A1, B2, C3} </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Combine all elements in one line through the separator: and wrap tags &lt;b&gt; ... &lt;/ b&gt; </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> strings.stream (). collect (Collectors.joining (":", "&lt;b&gt;", "&lt;/ b&gt;")) </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &lt;b&gt; a1: b2: c3: a1 &lt;/ b&gt; </font></font></td></tr><tr><td>   map,    ,    </td><td> strings.stream().distinct().collect(Collectors.toMap((p) -&gt; p.substring(0, 1), (p) -&gt; p.substring(1, 2))) </td><td> {a=1, b=2, c=3} </td></tr><tr><td>   map,      </td><td> strings.stream().collect(Collectors.groupingBy((p) -&gt; p.substring(0, 1))) </td><td> {a=[a1, a1], b=[b2], c=[c3]} </td></tr><tr><td>   map,           : </td><td> strings.stream().collect(Collectors.groupingBy((p) -&gt; p.substring(0, 1), Collectors.mapping((p) -&gt; p.substring(1, 2), Collectors.joining(":")))) </td><td> {a=1:1, b=2, c=3} </td></tr></tbody></table><br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">      <a href="">github'e</a> <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//  collect  stream       //     Collectors: // toList, toCollection, toSet -     ,    // toConcurrentMap, toMap -     map,    // averagingInt, averagingDouble, averagingLong -    // summingInt, summingDouble, summingLong -   // summarizingInt, summarizingDouble, summarizingLong -  SummaryStatistics     // partitioningBy -             Map&lt;Boolean, List&gt; // groupingBy -       Map&lt;N, List&lt;T&gt;&gt;,  T -   , N -   // mapping -      Collector' private static void testCollect() { System.out.println(); System.out.println("Test distinct start"); // ********    Collection&lt;String&gt; strings = Arrays.asList("a1", "b2", "c3", "a1"); //        List&lt;String&gt; distinct = strings.stream().distinct().collect(Collectors.toList()); System.out.println("distinct = " + distinct); //  distinct = [a1, b2, c3] //        String[] array = strings.stream().distinct().map(String::toUpperCase).toArray(String[]::new); System.out.println("array = " + Arrays.asList(array)); //  array = [A1, B2, C3] //         :    &lt;b&gt; ... &lt;/b&gt; String join = strings.stream().collect(Collectors.joining(" : ", "&lt;b&gt; ", " &lt;/b&gt;")); System.out.println("join = " + join); //  &lt;b&gt; a1 : b2 : c3 : a1 &lt;/b&gt; //   map,    ,    Map&lt;String, String&gt; map = strings.stream().distinct().collect(Collectors.toMap((p) -&gt; p.substring(0, 1), (p) -&gt; p.substring(1, 2))); System.out.println("map = " + map); //  map = {a=1, b=2, c=3} //   map,      Map&lt;String, List&lt;String&gt;&gt; groups = strings.stream().collect(Collectors.groupingBy((p) -&gt; p.substring(0, 1))); System.out.println("groups = " + groups); //  groups = {a=[a1, a1], b=[b2], c=[c3]} //   map,               : Map&lt;String, String&gt; groupJoin = strings.stream().collect(Collectors.groupingBy((p) -&gt; p.substring(0, 1), Collectors.mapping((p) -&gt; p.substring(1, 2), Collectors.joining(":")))); System.out.println("groupJoin = " + groupJoin); //  groupJoin = groupJoin = {a=1/1, b=2, c=3} // ********    Collection&lt;Integer&gt; numbers = Arrays.asList(1, 2, 3, 4); //     long sumOdd = numbers.stream().collect(Collectors.summingInt(((p) -&gt; p % 2 == 1 ? p : 0))); System.out.println("sumOdd = " + sumOdd); //  sumEven = 4 //     1    double average = numbers.stream().collect(Collectors.averagingInt((p) -&gt; p - 1)); System.out.println("average = " + average); //  average = 1.5 //    3    IntSummaryStatistics statistics = numbers.stream().collect(Collectors.summarizingInt((p) -&gt; p + 3)); System.out.println("statistics = " + statistics); //  statistics = IntSummaryStatistics{count=4, sum=22, min=4, average=5.500000, max=7} //      IntSummaryStatistics long sumEven = numbers.stream().collect(Collectors.summarizingInt((p) -&gt; p % 2 == 0 ? p : 0)).getSum(); System.out.println("sumEven = " + sumEven); //  sumEven = 6 //       Map&lt;Boolean, List&lt;Integer&gt;&gt; parts = numbers.stream().collect(Collectors.partitioningBy((p) -&gt; p % 2 == 0)); System.out.println("parts = " + parts); //  parts = {false=[1, 3], true=[2, 4]} }</span></span></code> </pre><br></div></div><br><br><h3> <b>3.10    Collector'a</b> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition to the Collectors already defined in Collectors, you can also create your own Collector. Let's consider an example of how to create it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Method for defining a custom Collector:</font></font><br><br><pre> <code class="java hljs">Collector&lt;_, _, _&gt; ollector = Collector.of( __, ___, ___, [___] );</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As can be seen from the code above, for the implementation of your Collector, you need to define three or four methods (method_of the last_processing_accumulator is not necessary). </font><font style="vertical-align: inherit;">Consider the following code, which we wrote before Java 8, to combine all the rows in the collection:</font></font><br><br><pre> <code class="java hljs"> StringBuilder b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-comment"><span class="hljs-comment">// __ for(String s: strings) { b.append(s).append(" , "); // ___, } String joinBuilderOld = b.toString(); // ___</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And similar code to be written in Java 8 </font></font><br><br><pre> <code class="java hljs">String joinBuilder = strings.stream().collect( Collector.of( StringBuilder::<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>, <span class="hljs-comment"><span class="hljs-comment">// __ (b ,s) -&gt; b.append(s).append(" , "), // ___, (b1, b2) -&gt; b1.append(b2).append(" , "), // ___ StringBuilder::toString // ___ ) );</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In general, the three methods are easy to understand from the code above, we wrote them practically at every processing of collections, but what is the connection_two_accumulator method? </font><font style="vertical-align: inherit;">This is the method that is needed for parallel processing of Collector, in this case, when a parallel stream is used, the collection can be divided into two parts (or more parts), each of which will have its own StringBuilder battery and then it will be necessary to combine them, then the code to Java 8 with 2 threads it will be like this:</font></font><br><br><pre> <code class="java hljs"> StringBuilder b1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-comment"><span class="hljs-comment">// ___1 for(String s: stringsPart1) { // stringsPart1 -    strings b1.append(s).append(" , "); // ___, } StringBuilder b2 = new StringBuilder(); // ___2 for(String s: stringsPart2) { // stringsPart2 -    strings b2.append(s).append(" , "); // ___, } StringBuilder b = b1.append(b2).append(" , "), // ___ String joinBuilderOld = b.toString(); // ___</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Let's write your analog Collectors.toList () to work with string stream: </font></font><br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//    toList Collector&lt;String, List&lt;String&gt;, List&lt;String&gt;&gt; toList = Collector.of( ArrayList::new, //    List::add, //     (l1, l2) -&gt; { l1.addAll(l2); return l1; } //        ); //           List&lt;String&gt; distinct1 = strings.stream().distinct().collect(toList);</span></span></code> </pre><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detailed examples</font></font></b> <div class="spoiler_text">       <a href="">github'e</a> <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//   Collector,        StringBuilder Collector&lt;String,StringBuilder, String&gt; stringBuilderCollector = Collector.of( StringBuilder::new, //    (b ,s) -&gt; b.append(s).append(" , "), //     (b1, b2) -&gt; b1.append(b2).append(" , "), //        StringBuilder::toString // ,     ); String joinBuilder = strings.stream().collect(stringBuilderCollector); System.out.println("joinBuilder = " + joinBuilder); //  joinBuilder = a1 , b2 , c3 , a1 , //  Collector'   JDK7   StringBuilder b = new StringBuilder(); //    for(String s: strings) { b.append(s).append(" , "); //     } String joinBuilderOld = b.toString(); // ,     System.out.println("joinBuilderOld = " + joinBuilderOld); //  joinBuilderOld = a1 , b2 , c3 , a1 , //    toList         Collector&lt;String, List&lt;String&gt;, List&lt;String&gt;&gt; toList = Collector.of( ArrayList::new, //    List::add, //     (l1, l2) -&gt; { l1.addAll(l2); return l1; } //        ); List&lt;String&gt; distinct1 = strings.stream().distinct().collect(toList); System.out.println("distinct1 = " + distinct1); //  distinct1 = [a1, b2, c3]</span></span></code> </pre><br></div></div><br><h2>  <b>Iv.</b>  <b>Conclusion</b> </h2><br>  That's all.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I hope my small cheat sheet for working with stream api was useful for you. </font><font style="vertical-align: inherit;">All source code is on </font></font><a href="https://github.com/Vedenin/java_collections_overview/tree/master/src/com/github/vedenin/rus/stream_api"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , good luck writing good code. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> List of other articles where you can read more about Stream Api: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. </font></font><a href="http://www.oracle.com/technetwork/articles/java/ma14-java-se-8-streams-2177646.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processing Data with Java SE 8 Streams, Part 1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from Oracle, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. </font></font><a href="http://www.oracle.com/technetwork/articles/java/architect-streams-pt2-2227132.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processing Data with Java SE 8 Streams, Part 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from Oracle, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. </font></font><a href="http://prologistic.com.ua/polnoe-rukovodstvo-po-java-8-stream.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Complete Java 8 manual Stream</font></font></a> <br><br>  <b>PPS</b> I also advise you to look at my opensource project <a href="https://github.com/Vedenin/useful-java-links/tree/master/link-rus">useful-java-links</a> - perhaps the most comprehensive collection of useful Java libraries, frameworks and Russian-language instructional videos.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is also a similar </font></font><a href="https://github.com/Vedenin/useful-java-links/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">English version of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this project and I‚Äôm starting the opensource </font></font><a href="https://github.com/Vedenin/useful-java-links/tree/master/helloworlds"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sub-project of Hello world</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to prepare a collection of simple examples for different Java libraries in one maven project (I will be grateful for any help).</font></font><br><br><div class="spoiler">  <b class="spoiler_title">General table of contents 'cheat sheets'</b> <div class="spoiler_text">  <a href="https://habrahabr.ru/post/265061/">1. JPA and Hibernate in questions and answers</a> <br>  <a href="https://habrahabr.ru/post/266821/">2. Three hundred fifty most popular non-mobile Java opensource projects on github</a> <br>  <a href="https://habrahabr.ru/company/luxoft/blog/256877/">3. Collections in Java (standard, guava, apache, trove, gs-collections, and others</a> <br>  <a href="https://habrahabr.ru/company/luxoft/blog/270383/">4. Java Stream API</a> <br>  <a href="https://habrahabr.ru/company/luxoft/blog/272025/">5. Two hundred and fifty Russian-language teaching videos of lectures and reports on Java.</a> <br>  <a href="https://habrahabr.ru/company/luxoft/blog/280784/">6. List of useful links for Java programmer</a> <br>  7 Typical tasks <br>  <a href="https://habrahabr.ru/post/278233/">7.1 Optimum way to convert an InputStream to a string</a> <br>  <a href="https://habrahabr.ru/post/278313/">7.2 The most productive way to bypass the Map, count the number of occurrences of the substring</a> <br>  <a href="https://habrahabr.ru/company/luxoft/blog/280782/">8. Libraries for working with Json (Gson, Fastjson, LoganSquare, Jackson, JsonPath and others)</a> <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/270383/">https://habr.com/ru/post/270383/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270371/index.html">Error Handling in Rust</a></li>
<li><a href="../270373/index.html">Impact analysis on the example of corporate data warehouse infrastructure</a></li>
<li><a href="../270377/index.html">Magento 2.0 Release Candidate Released</a></li>
<li><a href="../270379/index.html">Half a Century to "Universal Machine Languages" (1966‚Äì2016): Past, Present, Future</a></li>
<li><a href="../270381/index.html">TvOS application development</a></li>
<li><a href="../270387/index.html">NSA recognized the possibility of using zero-day exploits for cyber attacks</a></li>
<li><a href="../270389/index.html">Font Lato: Sketch vs Android Studio</a></li>
<li><a href="../270391/index.html">Increase system fault tolerance by nodejs</a></li>
<li><a href="../270393/index.html">ZeroNights HackQuest 2015</a></li>
<li><a href="../270395/index.html">Tibero part 2. Relocation of the project from Oracle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>