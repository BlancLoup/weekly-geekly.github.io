<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We decorate the desktop with random wallpapers with GoodFon</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I was sitting one evening, there was nothing to do, and I decided to slightly diversify my desktop by writing a small script writing a random picture ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We decorate the desktop with random wallpapers with GoodFon</h1><div class="post__text post__text-html js-mediator-article">  I was sitting one evening, there was nothing to do, and I decided to slightly diversify my desktop by writing a small script writing a random picture with <a href="http://www.goodfon.ru/">GoodFon</a> .  I chose a simple language - simple, scripting, powerful, namely, incomparable Python. <br><br>  If you want to make yourself and your desktop nice - the details under the cut. <br><a name="habracut"></a><br><br>  Since python is a cross-platform language, this script will work not only under linux, but also under windows. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, let's begin. <br><br><h4>  Materiel </h4><br><br>  GoodFon has already done some of the work for us by implementing the ability to view random wallpapers on the site.  So we don‚Äôt have to select them by the method of parsing a heap of pages.  We can only climb on the page with a random wallpaper, select one of the pictures and put it on your desktop as wallpaper.  Goodfon has one drawback - an unregistered user can download no more than 10 EMNIP images per day, but we don‚Äôt need more. <br><br><h4>  Implementation </h4><br><br>  I decided to make the script more interesting than just performing my function, so it will be replete with slightly excessive "communication" with the user. <br><br>  First we connect the necessary ones. <br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> win32api <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GetSystemMetrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os.path <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> subprocess <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span></code> </pre> <br><br>  I have this script made in two versions, I will tell about the second in the next post, so as not to make the post too long, but in the first version there is a blank for the second, namely the ‚Äúdefault mode‚Äù described in a separate function.  The mode of operation is selected by the configuration text file conf.txt. <br><br>  First we need to determine the screen resolution, so that the image is selected in it, and not in the maximum size.  To do this, we will use the winAPI GetSystemMetrics function. <br><br><pre> <code class="hljs swift"><span class="hljs-built_in"><span class="hljs-built_in">print</span></span> <span class="hljs-string"><span class="hljs-string">"   - "</span></span>, <span class="hljs-type"><span class="hljs-type">GetSystemMetrics</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-string"><span class="hljs-string">"x"</span></span>, <span class="hljs-type"><span class="hljs-type">GetSystemMetrics</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  where 0 and 1 are the resolutions for height and width, respectively. <br><br>  We omit the part of the code where we read the file, select the mode of operation, and so on, since this is not so important, we will go straight to choosing, downloading and installing images on the wallpaper. <br><br><pre> <code class="hljs python"> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"  .   ..."</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"    ..."</span></span> page = urllib2.urlopen(<span class="hljs-string"><span class="hljs-string">"http://www.goodfon.ru/mix.html"</span></span>) html = page.read() p = re.compile(<span class="hljs-string"><span class="hljs-string">r"/wallpaper/[0-9]+\.html"</span></span>) allWal = p.findall(html) walInd = random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">41</span></span>) p2 = re.compile(<span class="hljs-string"><span class="hljs-string">r"[0-9]+"</span></span>) walIndex = p2.findall(allWal[walInd]) newUrl = <span class="hljs-string"><span class="hljs-string">"http://www.goodfon.ru/image/"</span></span> + walIndex[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-string"><span class="hljs-string">"-"</span></span> + str(GetSystemMetrics(<span class="hljs-number"><span class="hljs-number">0</span></span>)) + <span class="hljs-string"><span class="hljs-string">"x"</span></span> + str (GetSystemMetrics(<span class="hljs-number"><span class="hljs-number">1</span></span>)) + <span class="hljs-string"><span class="hljs-string">".jpg"</span></span> filename = walIndex[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-string"><span class="hljs-string">"-"</span></span> + str(GetSystemMetrics(<span class="hljs-number"><span class="hljs-number">0</span></span>)) + <span class="hljs-string"><span class="hljs-string">"x"</span></span> + str(GetSystemMetrics(<span class="hljs-number"><span class="hljs-number">1</span></span>)) + <span class="hljs-string"><span class="hljs-string">".jpg"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> filename <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">" ,  ..."</span></span> jpeg = urllib2.urlopen(newUrl) outputJpeg = open(filename, <span class="hljs-string"><span class="hljs-string">'wb'</span></span>) outputJpeg.write(jpeg.read()) outputJpeg.close() <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">" .  ..."</span></span> wallpaperPath = os.path.abspath(os.curdir) + <span class="hljs-string"><span class="hljs-string">"\\"</span></span> + filename cmd = <span class="hljs-string"><span class="hljs-string">"WallpaperChanger.exe"</span></span> + <span class="hljs-string"><span class="hljs-string">" "</span></span> + wallpaperPath subprocess.Popen(cmd, shell = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">" .  !"</span></span> time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre> <br><br>  Here we follow the link of <a href="http://www.goodfon.ru/mix.html">random wallpapers</a> , read the page and use regular expressions to pull out links to pages with pictures from it.  The link to the image itself consists of a link to the page with the image + resolution in the 1900x800 format + the .jpg extension.  After this, a completely simple step remains - to create an image file, read the deleted file into it and set it as wallpaper. <br><br>  I had to tinker with the last point, because, according to Google, installing wallpaper in Windows 7 is not as simple as, say, in XP.  During the search for a solution to the problem, I came across an example where a small application, WallpaperChanger, was used for this, which I used.  To do this, you need to run the application itself, specifying our downloaded file as an argument. <br><br>  Everything, the work of the script is completed, and we have random wallpapers on our table.  Such a script can be put in autoload, and each time you start your computer you will have a new wallpaper =) <br><br>  In order to transfer it to Linux, you need to change all a couple of lines, namely, instead of winAPI to determine whether to use the functions of X (or which others, I did not go into this topic, because there was no point), but to install wallpaper, for example, feh. <br><br>  <a href="http://pastebin.com/ZJGpyy0M">Whole script</a> <br>  <a href="http://ifolder.ru/27547505">WallpaperChanger</a> </div><p>Source: <a href="https://habr.com/ru/post/134521/">https://habr.com/ru/post/134521/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134512/index.html">Object-Oriented Gin Installer Development</a></li>
<li><a href="../134515/index.html">Thesaurus Rutes: Structure and Applications - New Workshop in the ABBYY Open Series</a></li>
<li><a href="../134517/index.html">TOR: Negligence of leadership</a></li>
<li><a href="../134518/index.html">Critical error in the method of processing SMS messages in Windows Phone 7</a></li>
<li><a href="../134520/index.html">Co-ownership and domain management</a></li>
<li><a href="../134522/index.html">HTC Titan - all-aluminum shell</a></li>
<li><a href="../134523/index.html">"Protect" mp3 files on amazon.com</a></li>
<li><a href="../134524/index.html">MongoDB: Creating, updating and deleting documents</a></li>
<li><a href="../134525/index.html">Firefox does not fit in 32-bit address space</a></li>
<li><a href="../134526/index.html">Arduino in production *</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>