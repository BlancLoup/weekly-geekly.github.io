<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Animation in Angular Applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No serious application can do without animation in one form or another. Animation makes applications more modern, beautiful, and often more understand...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Animation in Angular Applications</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ph/ta/8x/phta8x3dkounvuivesfmic3w44y.jpeg" width="736" height="567"><br><p><br>  No serious application can do without animation in one form or another.  Animation makes applications more modern, beautiful, and often more understandable, improving the spatial orientation within the application.  Without feedback, it is sometimes difficult to understand what happened when we clicked on an item.  Previously, if you need to add animation to the application, I used CSS-animation and in general I was almost satisfied. </p><br><p>  After the transition of our product to Angular 2+, we were faced with the fact that Angulyar provides its own mechanism for describing animation.  Since Angulyar fully owns DOM transactions, he can simplify the description of the animation and we decided to try to abandon the animation on CSS.  On the whole, it was interesting to see what came of it.  For almost a year of project development, we have not switched back to CSS-animation, and I can say that you can live quite successfully with Angulyar‚Äôs animation.  In this article I will tell you how to use animation in projects on Angular 2+ and about features that are still not described in the official guide for some reason. <a name="habracut"></a></p><br><h3 id="nastroyka-animacii">  Animation setting </h3><br><p>  Animation in Angulyar is based on Web Animations API - this is the standard that gives JS flexibility, while maintaining the performance of CSS-animation.  You can read more about this API <a href="http://danielcwilson.com/blog/2015/07/animations-part-1/">here</a> .  In browsers that support this standard, the animation uses the same mechanism as for CSS-animation, and therefore the performance should be no worse.  In other browsers you need to use <a href="https://github.com/web-animations/web-animations-js">polyfil</a> .  Starting from the sixth version of Angulyar, if you don‚Äôt use AnimationBuilder directly (which is rarely needed), you no longer need to turn on the polyfill - Angulyar will switch to using CSS animation for unsupported browsers. </p><br><p>  For our experiments with animation, we will create a simple ToDo-application and add the necessary animation to it, using only the capabilities of Angulyar.  You can see the complete application code in the <a href="https://github.com/KyKyPy3/todo">repository</a> , but here I will provide only the part directly related to the animation. </p><br><p>  Before we begin to deal with the animation, we need to add the ability to use the animation mechanism in the project.  To do this, you just need to include <em>BrowserAnimationsModule</em> in the project, and all the animation options will be available to us.  In total, Angulyar has two animation- <em>related modules</em> ‚Äî <em>BrowserAnimationsModule</em> and <em>NoopAnimationsModule</em> .  The second is needed in order to disable the animation when testing the component. </p><br><h3 id="bazovoe-ispolzovanie-animacii-v-angular">  Basic use of animation in Angular </h3><br><p>  So, in the ToDo application, we need the following animation: </p><br><ul><li>  When the user marks some task as completed, this item should be animated to switch to the new state.  Fair and reverse action. </li><li>  Adding or deleting new tasks in the list should be animated. </li></ul><br><p>  Here is what it will look like: </p><br><img src="https://habrastorage.org/webt/oz/sa/de/ozsade_6pb4cbfqfss4q77dklra.gif"><br><p><br></p><br><p>  What is animated is understandable, now let's consider how we do it.  The whole animation of Angulyar is described in the component metadata.  We will animate the TodoItem component, and we will add our animation to it.  To create an animation in Angulyar, a number of entities are used that we need to import from the animation module ‚Äî trigger, state, style, animate, transition, keyframes.  Let's look at why we need each of them before adding animation.  All information, of course, can be found in the documentation of Angulyar, but without basic concepts we cannot go to more complex situations. </p><br><p>  <strong>trigger</strong> - allows you to bind your animation to a component or to DOM elements inside the component.  In addition to specifying the name of the trigger, we can also set all animation states and describe transitions between different states.  After adding a trigger to the component's metadata, it must be bound to the component or to the elements in the template that will be animated.  How this is done, we will look at later.  Typically, creating a trigger looks like this: </p><br><pre><code class="hljs kotlin"><span class="hljs-meta"><span class="hljs-meta">@Component({ selector: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'my-component'</span></span></span><span class="hljs-meta">, templateUrl: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'my-component-tpl.html'</span></span></span><span class="hljs-meta">, animations: [ trigger(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"myAnimationTrigger"</span></span></span><span class="hljs-meta">, [ state(...)</span></span>, state(...), transition(...), transition(...) ]) ] }) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br><p>  <strong>state</strong> - allows you to specify the state of the component that will be used in the animation, specifying the state name and style set for the state.  In fact, the whole animation of Angulyar is a finite state machine, where the transition from one state to another occurs: </p><br><pre> <code class="hljs kotlin"><span class="hljs-meta"><span class="hljs-meta">@Component({ selector: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'my-component'</span></span></span><span class="hljs-meta">, templateUrl: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'my-component-tpl.html'</span></span></span><span class="hljs-meta">, animations: [ trigger(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"myAnimationTrigger"</span></span></span><span class="hljs-meta">, [ state(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'collapsed'</span></span></span><span class="hljs-meta">, style({ height: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'0px'</span></span></span><span class="hljs-meta">, color: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'maroon'</span></span></span><span class="hljs-meta">, borderColor: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'maroon'</span></span></span><span class="hljs-meta"> })</span></span>), state(<span class="hljs-string"><span class="hljs-string">'expanded'</span></span>, style({ height: <span class="hljs-string"><span class="hljs-string">'*'</span></span>, borderColor: <span class="hljs-string"><span class="hljs-string">'green'</span></span>, color: <span class="hljs-string"><span class="hljs-string">'green'</span></span> })) ]) ] }) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br><p>  You need to understand that the state parameters will be applied on the element while it is in this state. </p><br><p>  <strong>style</strong> - allows you to describe a list of CSS parameters and their values ‚Äã‚Äãthat will be used in the animation or in the state of the component, specified through the state.  You can only animate the parameters that the browser considers animated.  An example of how style is used, we saw above in the description of the state function.  But before we go further, I want to highlight one important point in setting the values ‚Äã‚Äãof CSS parameters. </p><br><p>  Sometimes it happens that you do not know what parameter value will be during the execution of your application - for example, the height or width of the element.  In this case, it is quite difficult to animate the changes of such a parameter through CSS, but in Angular it is quite easy to solve - you need to use '*' as the value of the parameter.  Then Angulyar will take the value from the DOM. </p><br><p>  <strong>animate</strong> - the main function of animation.  When using it, you need to set timing parameters and / or style parameters that will change during the animation.  The important point is that the style options specified in the animate will only be active at the time of the animation.  But when it ends, they will return to those dictated by the state of the element in the DOM, unless, of course, at the end of the animation the component is in one of the states described by state.  Animation timing parameters can take on different values ‚Äã‚Äãthat should be familiar to you from CSS animation: </p><br><pre> <code class="hljs lisp">animate(<span class="hljs-number"><span class="hljs-number">500</span></span>, style(...)) animate(<span class="hljs-string"><span class="hljs-string">"1s"</span></span>, style(...)) animate(<span class="hljs-string"><span class="hljs-string">"100ms 0.5s"</span></span>, style(...)) animate(<span class="hljs-string"><span class="hljs-string">"5s ease"</span></span>, style(...)) animate(<span class="hljs-string"><span class="hljs-string">"5s 10ms cubic-bezier(.17,.67,.88,.1)"</span></span>, style(...))</code> </pre> <br><p>  <strong>transition</strong> - allows you to describe the sequence of transitions between the states of the element being animated.  The first parameter we define when the animation starts.  We can then specify animation parameters using animate and style.  To determine the parameters for starting the animation, we can use the following options: </p><br><ul><li>  transition ("on =&gt; off", animate (...)) - will start the animation when the trigger transitions from the 'on' state to the 'off' state </li><li>  transition ("on &lt;=&gt; off", animate (...)) - will start the animation when going from 'on' to 'off' and back </li><li>  transition ("* =&gt; off", animate (...)) - starts the animation when switching from any state to the off state.  It is also possible to indicate the reverse direction 'on =&gt; *'. </li><li>  transition ("void =&gt; *", animate (...)) - will start the animation when the element is added to the DOM.  When specifying a reverse transaction, '* =&gt; void', the animation will start when the item is removed from the DOM </li></ul><br><p>  Also, as the parameters for starting the animation, you can specify the function to which the animation parameters will be transferred, where there are fields fromState and toState.  Based on the values ‚Äã‚Äãof these fields, you can decide whether to run the animation.  If the function returns true, the animation will start. </p><br><p>  In the Angulyar animation engine, there are still some aliases for defining transitions: enter / leave and increment / decrement.  The first pair, in fact, is similar to the version * =&gt; void and void =&gt; *, and the second allows you to start the animation when the trigger value has decreased or increased by one.  This is convenient, for example, when implementing the image slider component: by changing the index of the current image, you will control the animation of the component. </p><br><p>  By default, all animation specified in the transaction will be executed sequentially.  If you need to perform parallel animation, you need to use the group function and wrap the animation in it: </p><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">group</span></span>([ animate(<span class="hljs-string"><span class="hljs-string">"1s"</span></span>, { background: <span class="hljs-string"><span class="hljs-string">"black"</span></span> })) animate(<span class="hljs-string"><span class="hljs-string">"2s"</span></span>, { <span class="hljs-keyword"><span class="hljs-keyword">color</span></span>: <span class="hljs-string"><span class="hljs-string">"white"</span></span> })) ])</code> </pre> <br><p>  There is also a sequence function that will start the animation sequentially, but it is usually not used, as it is implied by default. </p><br><p>  <strong>keyframes</strong> - allows you to determine how the animation will behave at various stages of the animation time.  To do this, you have a scale from 0 to 1, and you can specify at what stage of this gap and how the styles of your animated element should look.  For example, in this way you can implement a bounce-animation element: </p><br><pre> <code class="hljs lisp">transition('* =&gt; bouncing', [ animate('<span class="hljs-number"><span class="hljs-number">300</span></span>ms ease-in', keyframes([ style({transform: 'translate3d(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>)', offset: <span class="hljs-number"><span class="hljs-number">0</span></span>}), style({transform: 'translate3d(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">-10</span></span>px,<span class="hljs-number"><span class="hljs-number">0</span></span>)', offset: <span class="hljs-number"><span class="hljs-number">0.5</span></span>}), style({transform: 'translate3d(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>)', offset: <span class="hljs-number"><span class="hljs-number">1</span></span>}) ])) ])</code> </pre> <br><p>  So, we looked at the basic functions of animation in Angulyar.  But before we begin to animate our ToDo list, we need to consider two more things: how to connect the animation to the component and how to track the transitions of the component from one state to another. </p><br><p>  There are two ways to connect an animation to a component: hang the animation on an element in the component template or hang the animation on the component itself.  To hang an animation on an element in a template, simply add an attribute to the element with an animation trigger and transfer the desired state to it: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> [@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">myAnimationTrigger</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myStatusExp"</span></span></span><span class="hljs-tag">&gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  In this example, the variable myStatusExp is defined in the component, and when it changes, the animation will run if the necessary transitions to the transition are specified. </p><br><p>  If you need to throw the animation on the component itself, you can use the decorator @HostBinding for this: </p><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@HostBinding(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'@myAnimationTrigger'</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> myStatusExp; }</code> </pre> <br><p>  The last thing left to consider is how to track the change in animation in the component.  To do this, you can hang handlers on the animation trigger, at the start and stop animation: </p><br><pre> <code class="hljs perl">&lt;todo-item *ngFor=<span class="hljs-string"><span class="hljs-string">"let item of items"</span></span> (@myAnimationTrigger.start)=<span class="hljs-string"><span class="hljs-string">"animationStarted($event)"</span></span> (@myAnimationTrigger.done)=<span class="hljs-string"><span class="hljs-string">"animationDone($event)"</span></span> [@myAnimationTrigger]=<span class="hljs-string"><span class="hljs-string">"myStatusExp"</span></span>&gt; &lt;<span class="hljs-regexp"><span class="hljs-regexp">/todo-item&gt;</span></span></code> </pre> <br><p>  As a result, at the start or end of the animation, Angular will call our handlers and pass an AnimationEvent with the following contents: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">AnimationEvent</span></span> { fromState: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> toState: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> totalTime: number phaseName: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> element: any triggerName: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> disabled: boolean }</code> </pre> <br><p>  As you can see, the event contains a lot of data about the animation.  Usually a subscription to the end of the animation is useful to perform some action, for example, to remove a modal window from the DOM. </p><br><p>  So, we have considered the basic methods with the help of which animation is described in Angular.  Now let's add animation to our component's metadata: </p><br><pre> <code class="hljs kotlin"><span class="hljs-meta"><span class="hljs-meta">@Component({ ... animations: [ trigger(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'stateAnimation'</span></span></span><span class="hljs-meta">, [ state(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'incomplete'</span></span></span><span class="hljs-meta">, style({ </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'color'</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'black'</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'text-decoration'</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'none'</span></span></span><span class="hljs-meta"> })</span></span>), state(<span class="hljs-string"><span class="hljs-string">'complete'</span></span>, style({ <span class="hljs-string"><span class="hljs-string">'color'</span></span>: <span class="hljs-string"><span class="hljs-string">'#d9d9d9'</span></span>, <span class="hljs-string"><span class="hljs-string">'text-decoration'</span></span>: <span class="hljs-string"><span class="hljs-string">'line-through'</span></span> })), transition(<span class="hljs-string"><span class="hljs-string">'incomplete =&gt; complete'</span></span>, [ style({ <span class="hljs-string"><span class="hljs-string">'text-decoration'</span></span>: <span class="hljs-string"><span class="hljs-string">'line-through'</span></span> }), animate(<span class="hljs-string"><span class="hljs-string">'0.2s'</span></span>) ]), transition(<span class="hljs-string"><span class="hljs-string">'complete =&gt; incomplete'</span></span>, [ style({ <span class="hljs-string"><span class="hljs-string">'text-decoration'</span></span>: <span class="hljs-string"><span class="hljs-string">'none'</span></span> }), animate(<span class="hljs-string"><span class="hljs-string">'0.2s'</span></span>) ]) ]), trigger(<span class="hljs-string"><span class="hljs-string">'todoAnimation'</span></span>, [ transition(<span class="hljs-string"><span class="hljs-string">':enter'</span></span>, [ style({ height: <span class="hljs-number"><span class="hljs-number">0</span></span> }), animate(<span class="hljs-string"><span class="hljs-string">'0.3s ease-in'</span></span>, style({ height: <span class="hljs-string"><span class="hljs-string">'*'</span></span> })) ]), transition(<span class="hljs-string"><span class="hljs-string">':leave'</span></span>, [ animate(<span class="hljs-string"><span class="hljs-string">'0.3s ease-out'</span></span>, style({ transform: <span class="hljs-string"><span class="hljs-string">'scale(0)'</span></span> })) ]), ]) ] ... }) export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TodoItemComponent</span></span></span><span class="hljs-class"> </span></span>{ ... <span class="hljs-meta"><span class="hljs-meta">@HostBinding(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'@todoAnimation'</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-meta"><span class="hljs-meta">@HostBinding(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'@stateAnimation'</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> state() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.todo.completed ? <span class="hljs-string"><span class="hljs-string">'complete'</span></span> : <span class="hljs-string"><span class="hljs-string">'incomplete'</span></span>; } ... }</code> </pre> <br><p>  The full code can be seen in the <a href="https://github.com/KyKyPy3/todo">repository</a> in the base-animation branch. </p><br><p>  Let's take a look at what the animation code does.  We create two animation triggers: one to animate the state change of the task (stateAnimation), and the second to animate the addition or removal of tasks from the list (todoAnimation). </p><br><p>  Let's start with the second trigger.  In it we set two transitions of the component state.  When an element appears in the DOM, we set the initial height of the element to 0 and animate the height change to a value that is determined by the element's content.  When removing an element from the DOM, we apply a scale transformation from the runtime state equal to 1 to the final equal to 0. Everything is quite simple. </p><br><p>  Now let's look at the first trigger.  In it, we first define two component states ‚Äî incomplete and complete ‚Äî and specify the styles for these states.  As I said above, these styles will be active in the component while it is in the state.  Then we set two transitions between these states, where we first apply the styles to the component (so that the user can immediately see part of the changed styles), and then animate the remaining parameters. </p><br><p>  So, we added the necessary animation to our application, but after playing a little, we realized that there is a problem: we wanted our animation to work only when the user performs some actions on the task list, but it also works when the task list filter changes and when you first fill the list with tasks.  This is because our ngFor directive rearranges our list when the filter changes. </p><br><img src="https://habrastorage.org/webt/60/qp/ct/60qpctlgddm6apa3lgp05ndrj8o.gif"><br><p><br></p><br><p>  After some thought, we understand that we need to somehow turn off the animation for a while, while we change the task list, and Angulyar gives us this opportunity.  To do this, add the attribute [@ .disabled] to the template of the TodoList component: </p><br><pre> <code class="hljs javascript">&lt;ul <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"todo-list"</span></span> [@.disabled]=<span class="hljs-string"><span class="hljs-string">"disableAnimation"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">app-todo-item</span></span></span></span><span class="xml"><span class="hljs-tag"> *</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ngFor</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"let todo of todos; trackBy: trackById"</span></span></span></span><span class="xml"><span class="hljs-tag"> [</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">todo</span></span></span></span><span class="xml"><span class="hljs-tag">]=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"todo"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">app-todo-item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  By changing the values ‚Äã‚Äãof the disableAnimation component variable, we can enable and disable the animation of the TodoItem components.  You can see the code for controlling the value of the disableAnimation variable in the source code in the repository. </p><br><p>  An important point: if the animation is disabled, the handlers for starting and stopping the animation will still be called.  To understand whether they were called when the animation was disabled, you need to use the disabled parameter in the animation event.  If it is true, then the animation has been disabled. </p><br><p>  Now our animation works as it should, but this is far from the limit of the possibilities of animation in Angulyar.  Let's look at what else can be done and what is not yet described in the animation guide. </p><br><h3 id="vynos-animacii-iz-komponentov-i-ispolzovanie-parametrov">  Moving animations from components and using parameters </h3><br><p>  Within the framework of a product, animation is often repeated in several components, differing only in the parameters of this animation ‚Äî the animation timings or the initial and final values.  In order not to duplicate the animation many times, there are two solutions. </p><br><p>  The first thing that comes to mind is to put a function in a separate file, which, based on the parameters passed, will return the result of creating an animation trigger using the trigger function.  Here's what it looks like: </p><br><pre> <code class="hljs pgsql">export const todoAnimation = (<span class="hljs-keyword"><span class="hljs-keyword">timing</span></span>, enterStart, enterStop, leaveStop) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span>(<span class="hljs-string"><span class="hljs-string">'todoAnimation'</span></span>, [ transition(<span class="hljs-string"><span class="hljs-string">':enter'</span></span>, [ style({ height: enterStart }), animate(<span class="hljs-keyword"><span class="hljs-keyword">timing</span></span>, style({ height: enterStop })) ]), transition(<span class="hljs-string"><span class="hljs-string">':leave'</span></span>, [ animate(<span class="hljs-keyword"><span class="hljs-keyword">timing</span></span>, style({ <span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>: <span class="hljs-string"><span class="hljs-string">'scale('</span></span> + leaveStop + <span class="hljs-string"><span class="hljs-string">')'</span></span> })) ]) ]); }</code> </pre> <br><p>  This solution is quite working, but starting from the fourth version of Angulyar, two possibilities have been added that allow reuse of animation - setting parameters for animation functions and using animation through useAnimation.  Let's look at them in order. </p><br><p>  So, starting from the 4th version, the following functions support the setting of animation parameters: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">state</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[...]</span></span>, { <span class="hljs-comment"><span class="hljs-comment">/* options */</span></span> }) <span class="hljs-selector-tag"><span class="hljs-selector-tag">transition</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[...]</span></span>, { <span class="hljs-comment"><span class="hljs-comment">/* options */</span></span> }) <span class="hljs-selector-tag"><span class="hljs-selector-tag">sequence</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[...]</span></span>, { <span class="hljs-comment"><span class="hljs-comment">/* options */</span></span> }) <span class="hljs-selector-tag"><span class="hljs-selector-tag">group</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[...]</span></span>, { <span class="hljs-comment"><span class="hljs-comment">/* options */</span></span> }) <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[...]</span></span>, { <span class="hljs-comment"><span class="hljs-comment">/* options */</span></span> }) <span class="hljs-selector-tag"><span class="hljs-selector-tag">animation</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[...]</span></span>, { <span class="hljs-comment"><span class="hljs-comment">/* options */</span></span> }) <span class="hljs-selector-tag"><span class="hljs-selector-tag">useAnimation</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[...]</span></span>, { <span class="hljs-comment"><span class="hljs-comment">/* options */</span></span> }) <span class="hljs-selector-tag"><span class="hljs-selector-tag">animateChild</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[...]</span></span>, { <span class="hljs-comment"><span class="hljs-comment">/* options */</span></span> })</code> </pre> <br><p>  We have not yet considered a number of functions from this list, but do not worry: we will talk about them later.  The parameters of the functions in this list are different.  For example, the transition, sequence, group, and animation functions can take two parameters as options: delay and params. </p><br><p>  The delay parameter allows you to delay the launch of the animation.  Values ‚Äã‚Äãcannot be percent or negative. </p><br><p>  The params parameter allows you to pass parameters to the function, which will be substituted into the values ‚Äã‚Äãwhen using a specific animation function.  How this happens, we will see below in the examples. </p><br><p>  As parameters now it is possible to use only timing parameters or style value parameters.  The state function can only accept the params parameter, which is logical, since the delay is useless for it. </p><br><p>  The parameters of the remaining functions will be discussed later.  Another important point: if you use the substitution of parameters in the function, then you must specify the default values, otherwise Angulyar will give an error. </p><br><p>  Let's rewrite the animation function using parameters: </p><br><pre> <code class="hljs pgsql">export const todoAnimation = (<span class="hljs-keyword"><span class="hljs-keyword">timing</span></span>, enterStart, enterStop, leaveStop) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span>(<span class="hljs-string"><span class="hljs-string">'todoAnimation'</span></span>, [ transition(<span class="hljs-string"><span class="hljs-string">':enter'</span></span>, [ style({ height: "{{ enterStart }}" }), animate("{{ timing }}", style({ height: "{{ enterStop }}" })) ], { params: { enterStart: <span class="hljs-number"><span class="hljs-number">0</span></span>, enterStop: <span class="hljs-number"><span class="hljs-number">1</span></span>, timings: <span class="hljs-string"><span class="hljs-string">'0.3s'</span></span> } }), transition(<span class="hljs-string"><span class="hljs-string">':leave'</span></span>, [ animate(<span class="hljs-keyword"><span class="hljs-keyword">timing</span></span>, style({ <span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>: <span class="hljs-string"><span class="hljs-string">'scale({{ leaveStop }})'</span></span> })) ], { params: { leaveStop: <span class="hljs-number"><span class="hljs-number">0</span></span>, timings: <span class="hljs-string"><span class="hljs-string">'0.3s'</span></span> }}) ]); }</code> </pre> <br><p>  Another important point: the transferred animation parameters will be substituted at the moment of the animation launch and cannot be changed during the animation. <br>  It is also important that the parameters of the animation can be transferred at the time of launching the animation.  It will look something like this: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> [@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fadeAnimation</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{value: 'fadeIn', params: { start: 0, end: 1, timing: 1000 } }"</span></span></span><span class="hljs-tag"> &gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  The second feature that was added in version 4 is a set of two functions, animation and useAnimation.  The first allows you to describe the animation, and the second - to use it in the component metadata.  Here is what it would look like if there were fadeIn / fadeOut animations in the component: </p><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { animation, style, animate } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@angular/animations"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fadeAnimation = animation([ style({ <span class="hljs-attr"><span class="hljs-attr">opacity</span></span>: <span class="hljs-string"><span class="hljs-string">"{{ from }}"</span></span> }), animate(<span class="hljs-string"><span class="hljs-string">"{{ time }}"</span></span>, style({ <span class="hljs-attr"><span class="hljs-attr">opacity</span></span>: <span class="hljs-string"><span class="hljs-string">"{{ to }}"</span></span> })) ], { <span class="hljs-attr"><span class="hljs-attr">time</span></span>: <span class="hljs-string"><span class="hljs-string">"1s"</span></span>, <span class="hljs-attr"><span class="hljs-attr">to</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">from</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> })</code> </pre> <br><p>  Now use the animation in the component: </p><br><pre> <code class="hljs python"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {useAnimation, transition} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@angular/animations"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {fadeAnimation} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./animations"</span></span>; ... transition(<span class="hljs-string"><span class="hljs-string">'* =&gt; fadeIn'</span></span>, [ useAnimation(fadeAnimation, { <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, to: <span class="hljs-number"><span class="hljs-number">1</span></span>, time: <span class="hljs-string"><span class="hljs-string">'1s easy-in'</span></span> }) ]), transition(<span class="hljs-string"><span class="hljs-string">'* =&gt; fadeOut'</span></span>, [ useAnimation(fadeAnimation, { <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, to: <span class="hljs-number"><span class="hljs-number">0</span></span>, time: <span class="hljs-string"><span class="hljs-string">'1s easy-out'</span></span> }) ])</code> </pre> <br><p>  As you can see, when describing the animation through animate, we specified values ‚Äã‚Äãfor all parameters.  If when using animation through useAnimation some parameter is not passed, then the parameter specified by us in animation as default will be used.  Before we use the new animation features, we need to consider two more new features. </p><br><h3 id="funkcii-query-i-stager">  Query and stager functions </h3><br><p>  The query function is very similar to element.querySelectorAll.  It allows you to select elements from the DOM and start animation on them with a pack or change the styling of these elements.  This will allow us to move the animation from the TodoItem component to a higher level in TodoList and make the animation more flexible, for example, to start the animation of each even item.  Here is the use of the query function: </p><br><pre> <code class="hljs lisp">query('*', style({ opacity: <span class="hljs-number"><span class="hljs-number">0</span></span> })) query('div, .inner, #id', [ animate(<span class="hljs-number"><span class="hljs-number">1000</span></span>, style({ opacity: <span class="hljs-number"><span class="hljs-number">1</span></span> })) ])</code> </pre> <br><p>  The first parameter is the selector by which the elements will be selected.  The following selector options are currently supported: </p><br><ul><li>  Regular CSS selector - classic CSS selectors can be used as a selector, for example, such a query ('div, #id, .class, [attr], a + b') </li><li>  Use of aliases: enter and: leave - allows you to select elements added or deleted in the DOM Angular. </li><li>  @triggerName or @ * - allows you to select either elements with a given trigger, or all elements that have any trigger set </li><li>  : animating - allows you to select all the elements that are currently animated </li><li>  : self - allow you to select the element against which the query is called </li></ul><br><p>  All of the above selectors can be combined, for example, like this: </p><br><pre> <code class="hljs lisp">query('<span class="hljs-symbol"><span class="hljs-symbol">:self</span></span>, .record<span class="hljs-symbol"><span class="hljs-symbol">:enter</span></span>, .record<span class="hljs-symbol"><span class="hljs-symbol">:leave</span></span>, @subTrigger', [...])</code> </pre> <br><p>  As you can see, this provides many opportunities for creating more complex animation elements. </p><br><p>  The query function can also take parameters when it is used and in addition to the delay and params parameters, which we talked about above, it also supports two more ‚Äî optional and limit. </p><br><p>  By default, if there is not a single element under your selector, an exception will be generated.  If for you the absence of elements is not an erroneous situation, you can set the optional parameter to true.  In this case, the absence of elements will be considered a normal situation. </p><br><p>  The second parameter, limit, allows you to select not all items via query, but only a specified number.  If you specify a negative value in the limit parameter, the items will be selected from the bottom of the list. </p><br><p>  The second function, stagger, is useful when used together with the query-animation in this case.  Suppose that we have a code that shows messages to the user through ngFor: </p><br><pre> <code class="hljs django"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> [@</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">notificationAnimation</span></span></span></span><span class="xml"><span class="hljs-tag">]=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"notifications.length"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> *</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ngFor</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"let notification of notifications"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ notification }}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  And there is an animation of fade on the added elements through the use of query: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span>(<span class="hljs-string"><span class="hljs-string">'notificationAnimation'</span></span>, [ transition(<span class="hljs-string"><span class="hljs-string">'* =&gt; *'</span></span>, [ query(<span class="hljs-string"><span class="hljs-string">':enter'</span></span>, [ style({ opacity: <span class="hljs-number"><span class="hljs-number">0</span></span> }), animate(<span class="hljs-string"><span class="hljs-string">'1s'</span></span>, style({ opacity: <span class="hljs-number"><span class="hljs-number">1</span></span> })) ]) ]) ])</code> </pre> <br><p>  If we launch the application, we will see that the appearance of the list of notifications occurs at the same time, and this is not at all what we would like.  We would like the notifications to appear in turns, with a slight delay, and also disappear.  To implement this effect, we can use the stagger function: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span>(<span class="hljs-string"><span class="hljs-string">'notificationAnimation'</span></span>, [ transition(<span class="hljs-string"><span class="hljs-string">'* =&gt; *'</span></span>, [ query(<span class="hljs-string"><span class="hljs-string">':enter'</span></span>, stagger(<span class="hljs-string"><span class="hljs-string">'100ms'</span></span>, [ animate(<span class="hljs-string"><span class="hljs-string">'1s'</span></span>, style({ opacity: <span class="hljs-number"><span class="hljs-number">1</span></span> })) ]) ]) ])</code> </pre> <br><p>  The stagger function will add a delay before starting the animation of our elements, which will make their appearance smoother and more accurate.  To make the disappearance of notifications smooth as well, the behavior of the stagger function should be reversed.  To do this, we can either specify a negative value in the parameters of the function call, or simply add a reverse parameter: </p><br><pre> <code class="hljs swift">stagger('100ms <span class="hljs-built_in"><span class="hljs-built_in">reverse</span></span>', [...])</code> </pre> <br><p>  So let's rewrite task animation using the query function.  To do this, move it from the TodoItem component to the TodoList component: </p><br><pre> <code class="hljs java"><span class="hljs-meta"><span class="hljs-meta">@Component</span></span>({ selector: <span class="hljs-string"><span class="hljs-string">'app-todo-list'</span></span>, templateUrl: <span class="hljs-string"><span class="hljs-string">'./todo-list.component.html'</span></span>, styleUrls: [<span class="hljs-string"><span class="hljs-string">'./todo-list.component.css'</span></span>], animations: [ trigger(<span class="hljs-string"><span class="hljs-string">'todoList'</span></span>, [ transition(<span class="hljs-string"><span class="hljs-string">'* =&gt; *'</span></span>, [ query(<span class="hljs-string"><span class="hljs-string">':enter'</span></span>, [ style({ height: <span class="hljs-number"><span class="hljs-number">0</span></span> }), animate(<span class="hljs-string"><span class="hljs-string">'0.3s ease-in'</span></span>, style({ height: <span class="hljs-string"><span class="hljs-string">'*'</span></span> })) ], { optional: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }), query(<span class="hljs-string"><span class="hljs-string">':leave'</span></span>, [ animate(<span class="hljs-string"><span class="hljs-string">'0.3s ease-out'</span></span>, style({ transform: <span class="hljs-string"><span class="hljs-string">'scale(0)'</span></span> })) ], { optional: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }) ]) ]) ] }) export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TodoListComponent</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnInit</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AfterViewInit</span></span></span><span class="hljs-class"> </span></span>{ ... }</code> </pre> <br><p>  And connect it in the template of our to-do list: </p><br><pre> <code class="hljs javascript">&lt;ul <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"todo-list"</span></span> [@.disabled]=<span class="hljs-string"><span class="hljs-string">"disableAnimation"</span></span> [@todoList]=<span class="hljs-string"><span class="hljs-string">"todos.length"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">app-todo-item</span></span></span></span><span class="xml"><span class="hljs-tag"> *</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ngFor</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"let todo of todos; trackBy: trackById"</span></span></span></span><span class="xml"><span class="hljs-tag"> [</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">todo</span></span></span></span><span class="xml"><span class="hljs-tag">]=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"todo"</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">itemRemoved</span></span></span></span><span class="xml"><span class="hljs-tag">)=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"remove($event)"</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">itemModified</span></span></span></span><span class="xml"><span class="hljs-tag">)=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"update($event)"</span></span></span></span><span class="xml"><span class="hljs-tag"> &gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">app-todo-item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  Having played with the animation, we will see that the appearance of the elements works as it should, but the removal of tasks from the list is worked out without animation.  This is due to the fact that the restructuring of the to-do list occurs before we have time to animate.  Before you fix the problem, you need to consider another innovation of animation. </p><br><h3 id="animaciya-dochernih-elementov">  Animating children </h3><br><p>  If an application needs to animate several groups of elements at the same time, and one of the groups is the parent in the DOM for the second, then the animation of the parent elements will take precedence over the animation of the children, and the animation of the child elements will be disabled.  Suppose that in the component template there is the following code: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> [@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">parentAnimation</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"exp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span>Hello<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> [@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">childAnimation</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"exp"</span></span></span><span class="hljs-tag">&gt;</span></span> one <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> [@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">childAnimation</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"exp"</span></span></span><span class="hljs-tag">&gt;</span></span> two <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> [@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">childAnimation</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"exp"</span></span></span><span class="hljs-tag">&gt;</span></span> three <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  As you can see, the parent and child animations start when the same component variable changes, i.e.  at the same time.         ,      . </p><br><p>    ,       animateChild,         .         : </p><br><pre> <code class="hljs scala"><span class="hljs-meta"><span class="hljs-meta">@Component</span></span>({ selector: <span class="hljs-symbol"><span class="hljs-symbol">'parent</span></span>-child-component', animations: [ trigger(<span class="hljs-symbol"><span class="hljs-symbol">'parentAnimatio</span></span>n', [ transition(<span class="hljs-symbol"><span class="hljs-symbol">'false</span></span> =&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span>', [ query(<span class="hljs-symbol"><span class="hljs-symbol">'heade</span></span>r', [ style({ opacity: <span class="hljs-number"><span class="hljs-number">0</span></span> }), animate(<span class="hljs-number"><span class="hljs-number">500</span></span>, style({ opacity: <span class="hljs-number"><span class="hljs-number">1</span></span> })) ]), query('<span class="hljs-meta"><span class="hljs-meta">@childAnimation</span></span>', [ animateChild() ]) ]) ]), trigger(<span class="hljs-symbol"><span class="hljs-symbol">'childAnimatio</span></span>n', [ transition(<span class="hljs-symbol"><span class="hljs-symbol">'false</span></span> =&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span>', [ style({ opacity: <span class="hljs-number"><span class="hljs-number">0</span></span> }), animate(<span class="hljs-number"><span class="hljs-number">500</span></span>, style({ opacity: <span class="hljs-number"><span class="hljs-number">1</span></span> })) ]) ]) ] })</code> </pre> <br><p>  animateChild    :     ,       ,    ‚Äî  duration.            ,      ,  0   . </p><br><p>          animateChild()  ,        .         ,      : </p><br><pre> <code class="hljs javascript">&lt;ul <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"todo-list"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> *</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ngFor</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"let todo of todos; trackBy: trackById"</span></span></span></span><span class="xml"><span class="hljs-tag"> @</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">todoList</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">app-todo-item</span></span></span></span><span class="xml"><span class="hljs-tag"> @</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">todoItem</span></span></span></span><span class="xml"><span class="hljs-tag"> [</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">todo</span></span></span></span><span class="xml"><span class="hljs-tag">]=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"todo"</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">itemRemoved</span></span></span></span><span class="xml"><span class="hljs-tag">)=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"remove($event)"</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">itemModified</span></span></span></span><span class="xml"><span class="hljs-tag">)=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"update($event)"</span></span></span></span><span class="xml"><span class="hljs-tag"> &gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">app-todo-item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>      : </p><br><pre> <code class="hljs pgsql">@Component({ selector: <span class="hljs-string"><span class="hljs-string">'app-todo-list'</span></span>, templateUrl: <span class="hljs-string"><span class="hljs-string">'./todo-list.component.html'</span></span>, styleUrls: [<span class="hljs-string"><span class="hljs-string">'./todo-list.component.css'</span></span>], animations: [ <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span>(<span class="hljs-string"><span class="hljs-string">'todoList'</span></span>, [ transition(<span class="hljs-string"><span class="hljs-string">':enter, :leave'</span></span>, [ query(<span class="hljs-string"><span class="hljs-string">'@*'</span></span>, animateChild()) ]) ]), <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span>(<span class="hljs-string"><span class="hljs-string">'todoItem'</span></span>, [ transition(<span class="hljs-string"><span class="hljs-string">':enter'</span></span>, [ useAnimation(enterAnimation) ]), transition(<span class="hljs-string"><span class="hljs-string">':leave'</span></span>, [ useAnimation(leaveAnimation) ]) ]) ] })</code> </pre> <br><p>         ,   ,         DOM.       <a href="https://github.com/KyKyPy3/todo"></a>   child-animation. </p><br><p>        .  animateChild   ,                  .        ,           . </p><br><h3 id="ispolzovanie-pleera-animacii">    </h3><br><p>  ,              . </p><br><p> ,     ,      ,      ,   ,      .    ,   . </p><br><p> ,     ,       ,       .     ,      ,     .         , ,            . </p><br><p>  ,    ,       DI.                  .     : </p><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { AnimationBuilder } from <span class="hljs-string"><span class="hljs-string">"@angular/animations"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Component({...})</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyCmp</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">public</span></span> builder: AnimationBuilder) {} animate() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> factory = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.builder.build([ <span class="hljs-comment"><span class="hljs-comment">//     ]); const player = factory.create(this.someElement); player.play(); } }</span></span></code> </pre> <br><p>           ,  : </p><br><p>     ‚Äì play, pause, restart, finish, reset. ,    ,   .         ,   onDone(fn: () =&gt; void): void  onStart(fn: () =&gt; void): void. </p><br><p>           ,        -,        . </p><br><p>  , ,    ,      .       ,   ,       animation-player  . </p><br><img src="https://habrastorage.org/webt/h-/gj/ky/h-gjkyaxsss8noz7rjpv7yjfi3s.gif"><br><p><br>     .    -     : </p><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> percentage(p: number) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> lastPercentage = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._percentage; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._percentage = p; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.player) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.player.destroy(); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> factory = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._builder.build([ style({ width: lastPercentage + <span class="hljs-string"><span class="hljs-string">'%'</span></span> }), animate(<span class="hljs-string"><span class="hljs-string">'777ms cubic-bezier(.35, 0, .25, 1)'</span></span>, style({ width: p + <span class="hljs-string"><span class="hljs-string">'%'</span></span> })) ]); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.player = factory.create(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadingBar.nativeElement, {}); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.player.play(); }</code> </pre> <br><p>  ,   .     ,     ,    .    .     ,         ,      .  ,  .    ,         .           ,              . </p><br><h3 id="animaciya-cherez-routing">    </h3><br><p> ,          DOM  .   .      ,             . </p><br><p>  , -    router-outlet         ,  ,  ,    router-outlet,   .        router-outlet        .        ?     ,    : </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> [@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">routeAnimation</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prepRouteState(routerOutlet)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">router-outlet</span></span></span><span class="hljs-tag"> #</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">routerOutlet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"outlet"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  ,      prepRouteState,           : </p><br><pre> <code class="hljs ruby">@Component({ <span class="hljs-symbol"><span class="hljs-symbol">animations:</span></span> [ trigger(<span class="hljs-string"><span class="hljs-string">'routeAnimation'</span></span>, [ transition(<span class="hljs-string"><span class="hljs-string">'homePage =&gt; supportPage'</span></span>, [ <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ... ]), transition(<span class="hljs-string"><span class="hljs-string">'supportPage =&gt; homePage'</span></span>, [ <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ... ]) ]) ] }) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppComponent</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">prepRouteState</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">outlet</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">any</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">outlet</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">activatedRouteData</span></span></span><span class="hljs-class">['</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">animation</span></span></span><span class="hljs-class">'] || '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">firstPage</span></span></span><span class="hljs-class">';</span></span> } }</code> </pre> <br><p>            , ,  data,    : </p><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ROUTES = [ { path: <span class="hljs-string"><span class="hljs-string">''</span></span>, component: HomePageComponent, <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>: { animation: <span class="hljs-string"><span class="hljs-string">'homePage'</span></span> } }, { path: <span class="hljs-string"><span class="hljs-string">'support'</span></span>, component: SupportPageComponent, <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>: { animation: <span class="hljs-string"><span class="hljs-string">'supportPage'</span></span> } } ]</code> </pre> <br><p> ,       : </p><br><pre> <code class="hljs kotlin"><span class="hljs-meta"><span class="hljs-meta">@Component({ ... animations: [ trigger(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'routeAnimation'</span></span></span><span class="hljs-meta">, [ transition(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'completed &lt;=&gt; all, active &lt;=&gt; all, active &lt;=&gt; completed'</span></span></span><span class="hljs-meta">, [ query(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">':self'</span></span></span><span class="hljs-meta">, style({ height: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'*'</span></span></span><span class="hljs-meta">, width: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'*'</span></span></span><span class="hljs-meta"> })</span></span>), query(<span class="hljs-string"><span class="hljs-string">':enter, :leave'</span></span>, style({ position: <span class="hljs-string"><span class="hljs-string">'relative'</span></span> })), query(<span class="hljs-string"><span class="hljs-string">':leave'</span></span>, style({ transform: <span class="hljs-string"><span class="hljs-string">'scale(1)'</span></span> })), query(<span class="hljs-string"><span class="hljs-string">':enter'</span></span>, style({ transform: <span class="hljs-string"><span class="hljs-string">'scale(0)'</span></span> })), group([ query(<span class="hljs-string"><span class="hljs-string">':leave'</span></span>, group([ animate(<span class="hljs-string"><span class="hljs-string">'0.4s cubic-bezier(.35,0,.25,1)'</span></span>, style({ transform: <span class="hljs-string"><span class="hljs-string">'scale(0)'</span></span> })), animateChild() ])), query(<span class="hljs-string"><span class="hljs-string">':enter'</span></span>, group([ animate(<span class="hljs-string"><span class="hljs-string">'0.4s cubic-bezier(.35, 0, .25, 1)'</span></span>, style({ transform: <span class="hljs-string"><span class="hljs-string">'scale(1)'</span></span> })), animateChild() ])) ]), query(<span class="hljs-string"><span class="hljs-string">':self'</span></span>, style({ height: <span class="hljs-string"><span class="hljs-string">'*'</span></span>, width: <span class="hljs-string"><span class="hljs-string">'*'</span></span> })), ]) ]) ] }) export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppComponent</span></span></span><span class="hljs-class"> </span></span>{ prepRouteState(outlet: any) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (outlet.isActivated) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> outlet.activatedRoute.<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.getValue()[<span class="hljs-string"><span class="hljs-string">'status'</span></span>] || <span class="hljs-string"><span class="hljs-string">'all'</span></span>; } } }</code> </pre> <br><p>  ,      .        all   active,   . ,   ,     .       :self,         DOM.  ,   query(':self', style({ height: '*', width: '*' })),       ,       DOM   .          . </p><br><p>     ,     DOM,   ‚Äî .       enter/leave.   ,      ,      group.           ,        . </p><br><p>  ,       ‚Äî  animateChild    ,       ,     .      <a href="https://github.com/KyKyPy3/todo"></a>    . </p><br><h3 id="zaklyuchenie">  Conclusion </h3><br><p>     ,     . ,    ,      ,    ,        , ,       .        ,         ,      .           -. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/353150/">https://habr.com/ru/post/353150/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353140/index.html">Installing IP PBX 3CX in Microsoft Azure Cloud</a></li>
<li><a href="../353142/index.html">Mixed reality helps find places for bases on Mars</a></li>
<li><a href="../353144/index.html">Literary Archiver</a></li>
<li><a href="../353146/index.html">The story about the blockchain and a little bit about bitcoins</a></li>
<li><a href="../353148/index.html">Telephony integration with MoiSklad service</a></li>
<li><a href="../353152/index.html">Rustam Mehmandarov and Alexander Tarasov - semantic wonders and automation of experiments on jug.msk.ru</a></li>
<li><a href="../353156/index.html">FusionPBX, or cool again, FreeSWITCH</a></li>
<li><a href="../353160/index.html">Proof-of-Proof-of-Work on the fingers. On the way to a sensible blockchain</a></li>
<li><a href="../353162/index.html">Phone + CRM: The Benefits of Collaboration</a></li>
<li><a href="../353164/index.html">Where does a quality strategy begin and why is it needed in product management?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>