<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Geolocation in Windows 7 without GPS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Have you seen a lot of laptops that are equipped with a GPS sensor? Approximate estimates can be found here , 58 pieces out of 4380, that is 1.3%. Fra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Geolocation in Windows 7 without GPS</h1><div class="post__text post__text-html js-mediator-article">  Have you seen a lot of laptops that are equipped with a GPS sensor?  Approximate estimates can be found <a href="">here</a> , 58 pieces out of 4380, that is 1.3%.  Frankly speaking - not much.  It‚Äôs hard to name all the reasons why manufacturers do not equip laptops with an inexpensive chip, but our note is about how to equip your laptop with geolocation functionality, even if you don‚Äôt have a GPS sensor.  And at the same time you will learn how very simple it is to get your coordinates programmatically. <br><a name="habracut"></a><br><h4>  Talk about the weather? </h4><br>  Do you use a weather gadget in Windows 7?  Until recently, I did not use it, because it was too lazy to drive another city into my hand (and I travel a lot).  The option to automatically determine my coordinates did not work. <br><img src="https://habrastorage.org/storage/habraeffect/5b/74/5b74e99d6e894080a2d4d0ff03f6c76f.png" alt="Windows 7 Weather Gadget Settings"><br>  The thing is that this gadget is trying to determine your coordinates through the <a href="http://msdn.microsoft.com/en-us/library/dd318953(VS.85).aspx">Windows7 Sensor API</a> .  And requires a sensor driver.  Recently, preparing a presentation for the Platform 2011, I came across the <a href="http://www.geosenseforwindows.com/">Geosense</a> sensor, which very well determines the coordinates.  For weather service, they are 100% suitable. <br><img src="https://habrastorage.org/storage/habraeffect/08/25/0825697105bdd8d87fb654f69b79a0e5.png" alt="Windows 7 Weather Gadget"><br>  In fact, the accuracy is high, it works on the basis of the Google Location Service (WiFi and IP base) and I managed to test it in at least three places: <br><ul><li>  WTC at Krasnopresnenskaya using WiFi which was in the hotel.  He determined the location with accuracy to the building. </li><li>  Likewise, the location was wonderful when I was connected by cable (IP) to ITC. </li><li>  In Uglich, I determined the location via WiFi with accuracy to the house </li><li>  Now I sit in Sheremetyevo D and again I determined the location with accuracy to the terminal. </li></ul><br>  Do not forget to only configure this sensor as the default one, since the Orion sensor in Russia, unfortunately, does not work accurately enough. <img src="https://habrastorage.org/storage/habraeffect/e8/2f/e82fea5c20bacf7e0f59cb8f5e53895a.png" alt="Geolocation Sensor Settings"><br><br><h4>  We determine the coordinates programmatically. </h4><br>  <i><em>Excuse me, sir, where are we?</em></i> <i><em><br></em></i>  <i><em>-You are in the balloon basket, gentlemen.</em></i> <i><em><br></em></i>  <i><em>Holmes, in a whisper: -Watson, I bet that this person is a programmer.</em></i> <i><em><br></em> <br></i> <br><br>  The Windows 7 Sensor API is also implemented in the .NET Framework 4.0.  You just need to write literally 3 lines of code to understand where you are: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage/habraeffect/cf/9a/cf9a45cd77ccc0d198083d4700ccffce.png" alt="Location Program Code"><br>  I am now in Sheremetyevo D, connected to the Terminal-D WiFi-Free hotspot and this is what this program returns to me: <br><img src="https://habrastorage.org/storage/habraeffect/07/a2/07a2f30c2fc2b186377d6d232bd1c474.png" alt="Geolocation results in BingMaps"><br><br><h4>  Little about security </h4><br>  Of course, in Windows 7 it is possible to set permissions to use this API.  If your application is trying to determine the coordinates, a warning will appear: <br><img src="https://habrastorage.org/storage/habraeffect/f6/18/f618fc350fe5155d4d972751a47319db.png" alt="Enable sensor"><br>  You can also configure user access: <br><img src="https://habrastorage.org/storage/habraeffect/ee/33/ee33c0afd6425a121ffc2af6a3e95174.png" alt="Configuration of sensors for users"><br>  All calls to the geolocation API are recorded in the log: <br><img src="https://habrastorage.org/storage/habraeffect/32/de/32de52802a8a88b8ab06fea951fe894b.png" alt="image"><br><br><h4>  Summary </h4><br>  Of course, such geolocation does not replace GPS at all.  First of all, because of the accuracy, and sometimes there are mistakes.  But it can help out when GPS is not working (in buildings, in conditions of poor signal) and if you have an Internet connection.  And as for determining the weather or other contextual services (for example, in social applications) is suitable for sure. <br><br>  You can download the <a href="http://code.msdn.microsoft.com/Windows-7-Geolocation-API-25585fac">source</a> code for a simple console application using the Geolocation API from the MSDN Code Gallery at <a href="http://code.msdn.microsoft.com/Windows-7-Geolocation-API-25585fac">code.msdn.microsoft.com/Windows-7-Geolocation-API-25585fac</a> </div><p>Source: <a href="https://habr.com/ru/post/108548/">https://habr.com/ru/post/108548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../108541/index.html">Base GeoIP - countries and cities</a></li>
<li><a href="../108542/index.html">Synchronize asynchronous calls. WaitSync</a></li>
<li><a href="../108543/index.html">WikiLeaks moved from Swedish servers</a></li>
<li><a href="../108544/index.html">How to choose a room for an online store in real</a></li>
<li><a href="../108547/index.html">GC Reform, Creative Commons and Social Influence</a></li>
<li><a href="../108550/index.html">Competition on difficult problems for programmers</a></li>
<li><a href="../108551/index.html">Intel is working on a 1000-core processor</a></li>
<li><a href="../108553/index.html">Social engineering on Facebook and beyond. Analysis of the new "vulnerability"</a></li>
<li><a href="../108556/index.html">Not another social network or how we decided to create our own social network.</a></li>
<li><a href="../108558/index.html">Current education picture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>