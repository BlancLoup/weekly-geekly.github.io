<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Let's beat Ruby together! Drop ten</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this drop, we will once again delve into the PLO, figuring out new methods of working with classes, objects, modules that will definitely come in h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Let's beat Ruby together! Drop ten</h1><div class="post__text post__text-html js-mediator-article">  In this drop, we will once again delve into the PLO, figuring out new methods of working with classes, objects, modules that will definitely come in handy in serious programming. <br><br><h4>  Multiple constructors </h4><br>  What if we want to have multiple constructors for an object?  Nothing prevents us from creating additional class methods that return new objects.  In the following example, we describe cats with five parameters: weight, height, and three per color.  We will create additional methods that define certain types of cats ‚Äúby default‚Äù (for example, a black cat or a fat cat): <br><br><a name="habracut"></a><blockquote><code><font color="blue">class</font> <font color="#0000bb">SuperCat <br> <br></font> <font color="blue">def</font> <font color="#4e009b">initialize</font> <font color="gray">(</font> height, weight, tail_color, head_color, legs_color <font color="gray">) <br></font> <font color="#0000c4">@height</font> , <font color="#0000c4">@weight</font> , <font color="#0000c4">@tail_color</font> , <font color="#0000c4">@head_color</font> , <font color="#0000c4">@legs_color</font> = height, weight, tail_color, head_color, legs_color <br> <font color="blue">end <br> <br> def</font> <font color="#4e009b">SuperCat</font> . <font color="#4e009b">white_cat</font> <font color="gray">(</font> height, weight <font color="gray">) <br></font> new <font color="gray">(</font> height, weight, <font color="maroon">"white"</font> , <font color="maroon">"white"</font> , <font color="maroon">"white"</font> <font color="gray">) <br></font> <font color="blue">end <br> <br> def</font> <font color="#4e009b">SuperCat</font> . <font color="#4e009b">black_cat</font> <font color="gray">(</font> height, weight <font color="gray">) <br></font> new <font color="gray">(</font> height, weight, <font color="maroon">"black"</font> , <font color="maroon">"black"</font> , <font color="maroon">"black"</font> <font color="gray">) <br></font> <font color="blue">end <br> <br> def</font> <font color="#4e009b">SuperCat</font> . <font color="#4e009b">big_cat</font> <font color="gray">(</font> tail_color, head_color, legs_color <font color="gray">) <br></font> new <font color="gray">(</font> 100, 100, tail_color, head_color, legs_color <font color="gray">) <br></font> <font color="blue">end <br> <br> end <br></font> a = <font color="gray">SuperCat</font> . <font color="#8f20ff">new</font> <font color="gray">(</font> 10, 15, <font color="maroon">"white"</font> , <font color="maroon">"black"</font> , <font color="maroon">"white"</font> <font color="gray">) <br></font> b = <font color="gray">SuperCat</font> . <font color="#8f20ff">black_cat</font> <font color="gray">(</font> 13, 20 <font color="gray">) <br></font> c = <font color="gray">SuperCat</font> . <font color="#8f20ff">big_cat</font> <font color="gray">(</font> <font color="maroon">"white"</font> , <font color="maroon">"red"</font> , <font color="maroon">"red"</font> <font color="gray">) <br></font> p <font color="gray">(</font> a <font color="gray">)</font> ; p <font color="gray">(</font> b <font color="gray">)</font> ; p <font color="gray">(</font> c <font color="gray">)</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Does the word ‚Äúconstructor‚Äù take place here?  We will leave this question to lawyers :) <br><br><h4>  The development of designers </h4><br>  Objects are becoming more complex, they collect more and more attributes that must be initialized when creating an object.  The constructs responsible for this become lengthy and burdensome, forcing us to recalculate the parameters and wrap the lines. <br><br>  One way to handle this complexity is to pass a <strong>block</strong> to the <code>initialize</code> method.  Then we can use the block to initialize the object.  We will use the <code>instance_eval</code> method instead of <code>eval:</code> <blockquote> <code><font color="blue">class</font> <font color="#0000bb">HyperCat <br></font> attr_accessor <font color="#c60000">:name</font> , <br> <font color="#c60000">:height</font> , <font color="#c60000">:weight</font> , <font color="#c60000">:age</font> , <br> <font color="#c60000">:tail_color</font> , <font color="#c60000">:head_color</font> , <font color="#c60000">:legs_color <br> <br></font> <font color="blue">def</font> <font color="#4e009b">initialize</font> <font color="gray">(</font> &amp;block <font color="gray">) <br></font> instance_eval &amp;block <br> <font color="blue">end <br> <br></font> <font color="green">#  ... <br></font> <font color="blue">end <br> <br></font> pussy = <font color="gray">HyperCat</font> . <font color="#8f20ff">new</font> <font color="blue">do <br> self</font> . <font color="#8f20ff">name</font> = <font color="maroon">"Pussy" <br></font> <font color="blue">self</font> . <font color="#8f20ff">height</font> = 10 <br> <font color="blue">self</font> . <font color="#8f20ff">weight</font> = 12 <br> <font color="blue">self</font> . <font color="#8f20ff">age</font> = 3.2 <br> <font color="blue">self</font> . <font color="#8f20ff">tail_color</font> = <font color="maroon">"gray" <br></font> <font color="blue">self</font> . <font color="#8f20ff">head_color</font> = <font color="maroon">"gray" <br></font> <font color="blue">self</font> . <font color="#8f20ff">legs_color</font> = <font color="maroon">"white" <br></font> <font color="blue">end <br> <br></font> p pussy</code> </blockquote> <br>  We use accessors in attributes, so it‚Äôs easier to pass values ‚Äã‚Äãto them.  We also need to refer to <code>self</code> , because the value assignment method always takes an explicit receiver to create a local variable. <br><br><h4>  Method access control </h4><br>  In Ruby, an object is basically determined by the interface it provides, the method by which it becomes available to others.  However, when writing a class, we often need auxiliary methods used inside the class, but dangerous if they are accessible from the outside.  This is where the <code>Module</code> <code>private</code> method will help us. <br><br>  We can use <code>private</code> two ways.  If you call private without parameters in the body of the class, all the methods below will become private.  Or you can pass the list of methods as symbols as <code>private</code> parameters: <blockquote> <code><font color="blue">class</font> <font color="#0000bb">Bank <br></font> <font color="blue">def</font> <font color="#4e009b">open_safe <br></font> <font color="green"># ... <br></font> <font color="blue">end <br> <br> def</font> <font color="#4e009b">close_safe <br></font> <font color="green"># ... <br></font> <font color="blue">end <br> <br></font> private <font color="#c60000">:open_safe</font> , <font color="#c60000">:close_safe <br> <br></font> <font color="blue">def</font> <font color="#4e009b">make_withdrawal</font> <font color="gray">(</font> amount <font color="gray">) <br></font> <font color="blue">if</font> access_allowed <br> open_safe <br> get_cash <font color="gray">(</font> amount <font color="gray">) <br></font> close_safe <br> <font color="blue">end <br> end <br> <br></font> <font color="green">#  -  <br> <br></font> private <br> <br> <font color="blue">def</font> <font color="#4e009b">get_cash <br></font> <font color="green"># ... <br></font> <font color="blue">end <br> <br> def</font> <font color="#4e009b">access_allowed <br></font> <font color="green"># ... <br></font> <font color="blue">end <br> end</font></code> </blockquote> <br><br><h4>  Copying objects </h4><br>  The <code>clone</code> and <code>dup</code> methods create copies of the caller.  The <code>dup</code> method only copies the contents of an object, while <code>clone</code> takes things like the singleton classes associated with an object: <blockquote> <code>s1 = <font color="maroon">"cat" <br> <br></font> <font color="blue">def</font> <font color="#4e009b">s1</font> . <font color="#4e009b">upcase <br></font> <font color="maroon">"CaT" <br></font> <font color="blue">end <br> <br></font> s1_dup = s1. <font color="#8f20ff">dup <br></font> s1_clone = s1. <font color="#8f20ff">clone <br></font> s1 <font color="green">#=&gt; "cat" <br></font> s1_dup. <font color="#8f20ff">upcase</font> <font color="green">#=&gt; "CAT" (   ) <br></font> s1_clone. <font color="#8f20ff">upcase</font> <font color="green">#=&gt; "CaT"</font></code> </blockquote> <br><br><h4>  Going deep into modules </h4><br>  Let's look one drop back and remember what modules are and how to use them, in particular, let us pay attention to the impurities and the example given there. <br>  But what happens when mixed with our module methods?  If you think that they will be included as class methods, then Ruby does not do that.  To do this, you can do this: <blockquote> <code><font color="blue">module</font> <font color="#5c5c5c">MyMod <br> <br></font> <font color="blue">def</font> <font color="#4e009b">meth <br></font> puts <font color="maroon">"  " <br></font> puts <font color="maroon">"   ." <br></font> <font color="blue">end <br> <br> end <br> <br> class</font> <font color="#0000bb">MyClass <br> <br></font> <font color="blue">class</font> <font color="#0000bb">&lt;&lt;</font> <font color="blue">self</font> <font color="green">#  self  MyClass <br></font> include <font color="gray">MyMod <br></font> <font color="blue">end <br> <br> end</font></code> </blockquote> <br>  Here the <code>extend</code> method is useful to us - with it the example becomes much simpler: <blockquote> <code><font color="blue">class</font> <font color="#0000bb">MyClass <br></font> extend <font color="gray">MyMod <br></font> <font color="blue">end <br></font> <font color="gray">MyClass</font> . <font color="#8f20ff">meth <br></font></code> </blockquote><br><br><h4>  Creating Structs </h4><br>  Sometimes we just need to group some data without further processing.  We can create a class: <blockquote> <code><font color="blue">class</font> <font color="#0000bb">ExtraCat <br> <br></font> attr_accessor <font color="#c60000">:name</font> , <font color="#c60000">:age</font> , <font color="#c60000">:weight <br> <br></font> <font color="blue">def</font> <font color="#4e009b">initialize</font> <font color="gray">(</font> name, age, weight <font color="gray">) <br></font> <font color="#0000c4">@name</font> , <font color="#0000c4">@age</font> , <font color="#0000c4">@weight</font> = name, age, weight <br> <font color="blue">end <br> <br> end <br> <br></font> lucky = <font color="gray">ExtraCat</font> . <font color="#8f20ff">new</font> <font color="gray">(</font> <font color="maroon">"Lucky"</font> , 2, 4 <font color="gray">)</font></code> </blockquote>  This, of course, works, but here are some repetitions.  That's why the <code>Struct</code> class came in handy.  As <code>attr_accessor</code> defines the necessary methods for us, and <code>Struct</code> defines classes that contain the same attributes.  These classes are called <b>structure templates</b> . <br><blockquote> <code><font color="gray">ExtraCat</font> = <font color="gray">Struct</font> . <font color="#8f20ff">new</font> <font color="gray">(</font> <font color="maroon">"ExtraCat"</font> , <font color="#c60000">:name</font> , <font color="#c60000">:age</font> , <font color="#c60000">:weight</font> <font color="gray">) <br></font> lucky = <font color="gray">ExtraCat</font> . <font color="#8f20ff">new</font> <font color="gray">(</font> <font color="maroon">"Lucky"</font> , 2, 4 <font color="gray">)</font></code> </blockquote> <br><h4>  Epilogue </h4><br>  In general, I scored more for study, so that the rails again go (laid?) Forest :) Hold on, beginners, but it should be so - but then it will be easier, I promise!  Yes, and finally, I built the code highlighting, it turns out, all I had to do was Windows Live Writer + Visual Studio + VSPaste + HTML Snippet + PowerGREP + regular expressions + some pen work :( But now I can make you happy with nice code, correct spelling and no longer afraid of losing articles;) And, of course, all articles of the cycle are waiting for you on the <a href="http://habrahabr.ru/blogs/starting_programming/">Startup Programmer</a> blog </div><p>Source: <a href="https://habr.com/ru/post/49418/">https://habr.com/ru/post/49418/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../49406/index.html">BitTorrent Tracker based on Django</a></li>
<li><a href="../49407/index.html">Personality 2.0. Part One: Putting up a profile. Interview with the creator of retaggr.com.</a></li>
<li><a href="../49408/index.html">100,000 articles in Knol</a></li>
<li><a href="../49411/index.html">We learn Java. First cup</a></li>
<li><a href="../49414/index.html">Ideal editor or friend of Notepad ++ with SFTP</a></li>
<li><a href="../49421/index.html">Are the booty guys kinky? writing a morphological analyzer in Python</a></li>
<li><a href="../49428/index.html">We master Python. Ounce Zero. Introduction</a></li>
<li><a href="../49431/index.html">As we were not taken in Yandex.Catalog on a paid basis</a></li>
<li><a href="../49432/index.html">.NET StockTrader Sample Application</a></li>
<li><a href="../49433/index.html">OpenDesktop.org introduces the possibility of selling content.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>