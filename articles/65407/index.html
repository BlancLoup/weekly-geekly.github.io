<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parsim URL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to share one useful utility written in pure JavaScript, the URL. In fact, this is a small URL parser, which works almost like window.location ,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parsim URL</h1><div class="post__text post__text-html js-mediator-article"> I want to share one useful utility written in pure JavaScript, the URL.  In fact, this is a small URL parser, which works almost like <code>window.location</code> , but does not reload the browser page during manipulations. <br><br>  And at the same time I will say a few words about getters &amp; setters in JavaScript. <br><br>  <strong>UPD1:</strong> at the request of the workers, I will bring up examples here: <br><blockquote> <code><a href="https://my.site.com/absolute/path.php%3Fa%3D8"></a> <a href="https://another.site.com/"></a> <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">//   URL = 'http://my.site.com/somepath/'</font> <br> <font color="#0000ff">var</font> u = <font color="#0000ff">new</font> URL( <font color="#A31515">'relative/path/index.html'</font> ) <br> u.href <font color="#008000">// my.site.com/somepath/relative/path/index.html</font> <br> u.href = <font color="#A31515">'/absolute/path.php?a=8#some-hash'</font> <br> u.href <font color="#008000">// my.site.com/absolute/path.php?a=8#some-hash</font> <br> u.hash <font color="#008000">// #some-hash</font> <br> u.protocol = <font color="#A31515">'https:'</font> <br> u.href <font color="#008000">// my.site.com/absolute/path.php?a=8#some-hash</font> <br> u.host = <font color="#A31515">'another.site.com:8080'</font> <br> u.href <font color="#008000">// another.site.com:8080/absolute/path.php?a=8#some-hash</font> <br> u.port <font color="#008000">// 8080</font> <br> <font color="#008000">//   ,   </font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  It works in FF3 + (maybe in 2+, I have not tried it) and in <strong>IE6 +</strong> (and this is my know-how :-)). <br>  The article also contains a fully cross-browser implementation, but in use it is a bit more cumbersome: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">//   URL = 'http://my.site.com/somepath/'</font> <br> <font color="#0000ff">var</font> u = <font color="#0000ff">new</font> URL( <font color="#A31515">'relative/path/index.html'</font> ) <br> u.href() <font color="#008000">// my.site.com/somepath/relative/path/index.html</font> <br> u.href( <font color="#A31515">'/absolute/path.php?a=8#some-hash'</font> ) <br> u.href() <font color="#008000">// my.site.com/absolute/path.php?a=8#some-hash</font> <br> <font color="#008000">//  ..</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Yes, and I give my listing completely, sorry, it should be so. <br><br><a name="habracut"></a><br>  <strong>UPD2:</strong> briefly explain the purpose of my library: <br>  This tulza originated precisely from practical needs. <br>  And I have already seen several <em>handicraft</em> developments of a similar purpose in large JS projects, such as TinyMCE.  In RTE, you often deal with links to resources.  And these links need to be processed in real-time. <br><br>  Specifically, I had to parse the current URL and change / add a new parameter to the search, followed by a redirect. <br><br>  You can think of more. <br><br><h2>  Problem </h2><br>  What is the problem?  The problem is that: <br><ol><li>  We cannot use the <code>window.location</code> object, since  it reloads the current page with the slightest change </li><li>  We cannot create another similar object through the <code>Location</code> constructor - atat!  prohibited by browsers! </li><li>  The object itself is rather non-trivial in behavior. </li><li>  Well, I did not find any finished implementation :) </li></ol><br>  I mentioned the non-trivial behavior.  Here it is: <br><br><img width="429" src="http://img132.imageshack.us/img132/6664/connections.png" alt="Figure: Link URL Parts"><br><br>  When changing any part of the URL, others should be updated. <br><br><h2>  Parsing </h2><br>  As a matter of fact, I will create a semblance of <code>window.location</code> , so I‚Äôm <code>window.location</code> symbols from there.  Let us examine an example: <br><br><img width="675" height="136" src="http://img132.imageshack.us/img132/4001/parts.png" alt="Figure: Parse URL Parts"><br><br>  No comments :) <br><br><h2>  No matter how cool you can do without RegExp </h2><br>  The main work will be done, of course, by Regular Expression: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> pattern = <font color="#A31515">"^(([^:/\\?#]+):)?(//(([^:/\\?#]*)(?::([^/\\?#]*))?))?([^\\?#]*)(\\?([^#]*))?(#(.*))?$"</font> ;</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Now in more detail: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> pattern = <br> <font color="#008000">// Match #0. URL  (#0 -  HREF,   window.location).</font> <br> <font color="#008000">// , #0 == "https://example.com:8080/some/path/index.html?p=1&amp;q=2&amp;r=3#some-hash"</font> <br> <font color="#A31515">"^"</font> + <br> <font color="#008000">// Match #1 &amp; #2. SCHEME (#1 -  PROTOCOL,   window.location).</font> <br> <font color="#008000">// , #1 == "https:", #2 == "https"</font> <br> <font color="#A31515">"(([^:/\\?#]+):)?"</font> + <br> <font color="#008000">// Match #3-#6. AUTHORITY (#4 = HOST, #5 = HOSTNAME  #6 = PORT,   window.location)</font> <br> <font color="#008000">// , #3 == "//example.com:8080", #4 == "example.com:8080", #5 == "example.com", #6 == "8080"</font> <br> <font color="#A31515">"("</font> + <br> <font color="#A31515">"//(([^:/\\?#]*)(?::([^/\\?#]*))?)"</font> + <br> <font color="#A31515">")?"</font> + <br> <font color="#008000">// Match #7. PATH (#7 = PATHNAME,   window.location).</font> <br> <font color="#008000">// , #7 == "/some/path/index.html"</font> <br> <font color="#A31515">"([^\\?#]*)"</font> + <br> <font color="#008000">// Match #8 &amp; #9. QUERY (#8 = SEARCH,   window.location).</font> <br> <font color="#008000">// , #8 == "?p=1&amp;q=2&amp;r=3", #9 == "p=1&amp;q=2&amp;r=3"</font> <br> <font color="#A31515">"(\\?([^#]*))?"</font> + <br> <font color="#008000">// Match #10 &amp; #11. FRAGMENT (#10 = HASH,   window.location).</font> <br> <font color="#008000">// , #10 == "#some-hash", #11 == "some-hash"</font> <br> <font color="#A31515">"(#(.*))?"</font> + <font color="#A31515">"$"</font> ;</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  As you might guess, this RegExp will work not only in JavaScript, but also in hundreds of other languages.  Use on health!  ;) <br><br><h2>  Attempt # 1 </h2><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">function</font> URL(url) { <br> url = url || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .parse(url); <br> } <br> URL.prototype = { <br> <font color="#008000">//   this.href,      this.parse()</font> <br> href: <font color="#A31515">""</font> , <br> <font color="#008000">//   -  ,      this.update()</font> <br> protocol: <font color="#A31515">""</font> , <br> host: <font color="#A31515">""</font> , <br> hostname: <font color="#A31515">""</font> , <br> port: <font color="#A31515">""</font> , <br> pathname: <font color="#A31515">""</font> , <br> search: <font color="#A31515">""</font> , <br> hash: <font color="#A31515">""</font> , <br> <br> parse: <font color="#0000ff">function</font> (url) { <br> url = url || <font color="#0000ff">this</font> .href; <br> <font color="#0000ff">var</font> pattern = <font color="#A31515">"^(([^:/\\?#]+):)?(//(([^:/\\?#]*)(?::([^/\\?#]*))?))?([^\\?#]*)(\\?([^#]*))?(#(.*))?$"</font> ; <br> <font color="#0000ff">var</font> rx = <font color="#0000ff">new</font> RegExp(pattern); <br> <font color="#0000ff">var</font> parts = rx.exec(url); <br> <br> <font color="#0000ff">this</font> .href = parts[0] || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .protocol = parts[1] || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .host = parts[4] || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .hostname = parts[5] || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .port = parts[6] || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .pathname = parts[7] || <font color="#A31515">"/"</font> ; <br> <font color="#0000ff">this</font> .search = parts[8] || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .hash = parts[10] || <font color="#A31515">""</font> ; <br> <br> <font color="#0000ff">this</font> .update(); <br> }, <br> <br> update: <font color="#0000ff">function</font> () { <br> <font color="#008000">//   protocol -   ,  </font> <br> <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .protocol) <br> <font color="#0000ff">this</font> .protocol = window.location.protocol; <br> <br> <font color="#008000">//   relative pathname/URL -   relative,  ""  </font> <br> <font color="#0000ff">this</font> .pathname = <font color="#0000ff">this</font> .pathname.replace(/^\s*/g, <font color="#A31515">''</font> ); <br> <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .host &amp;&amp; <font color="#0000ff">this</font> .pathname &amp;&amp; !/^\ <font color="#008000">//.test(this.pathname)) {</font> <br> <font color="#008000">//  ,    .      .</font> <br> <font color="#0000ff">var</font> _p = window.location.pathname.split( <font color="#A31515">'/'</font> ); <br> _p[_p.length - 1] = <font color="#0000ff">this</font> .pathname; <br> <font color="#0000ff">this</font> .pathname = _p.join( <font color="#A31515">'/'</font> ); <br> }; <br> <br> <font color="#008000">//   hostname -   ,  </font> <br> <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .hostname) <br> <font color="#0000ff">this</font> .hostname = window.location.hostname; <br> <br> <font color="#0000ff">this</font> .host = <font color="#0000ff">this</font> .hostname + (( <font color="#A31515">""</font> + <font color="#0000ff">this</font> .port) ? <font color="#A31515">":"</font> + <font color="#0000ff">this</font> .port : <font color="#A31515">""</font> ); <br> <font color="#0000ff">this</font> .href = <font color="#0000ff">this</font> .protocol + <font color="#A31515">'//'</font> + <font color="#0000ff">this</font> .host + <font color="#0000ff">this</font> .pathname + <font color="#0000ff">this</font> .search + <font color="#0000ff">this</font> .hash; <br> }, <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">*     window.location.    URL.</font> <br> <font color="#008000">*/</font> <br> assign: <font color="#0000ff">function</font> (url) { <br> <font color="#0000ff">this</font> .parse(url); <br> window.location.assign( <font color="#0000ff">this</font> .href); <br> }, <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">*     window.location.    URL,     history</font> <br> <font color="#008000">*/</font> <br> replace: <font color="#0000ff">function</font> (url) { <br> <font color="#0000ff">this</font> .parse(url); <br> window.location.replace( <font color="#0000ff">this</font> .href); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><h3>  In details </h3><br><ul><li>  As you can see, there are habitual for <code>window.location</code> attributes <code>href, port, hash</code> , etc. </li><li>  The methods familiar to <code>window.location</code> are also present: <code>assign(...), replace(...)</code> </li><li>  The <strong><code>parse(...)</code></strong> method does the main work - parsing the URL into its component parts. </li><li>  And the <strong><code>update(...)</code></strong> method <strong><code>update(...)</code></strong> - updates all parts, if one of them has been changed. </li></ul><br>  Everything would be fine, but we oblige the user to <em>constantly call <code>update(...)</code> and <code>parse(...)</code></em> after changing any part of the URL (for example, port).  It's horrible.  After all, the user can forget to do it, and then everything flies to Tartar. <br><br>  Unfortunately, in this implementation it does not go away.  But you can do everything differently :) <br><br><h2>  Attempt # 2 </h2><br>  And now I will propose an acceptable option.  We need getters &amp; setters.  The most obvious way is to create (for <code>getProtocol() &amp; setProtocol(newProtocol)</code> ) <code>getProtocol() &amp; setProtocol(newProtocol)</code> methods for each parameter.  But I do not like this approach because of its bulkiness. <br><br>  Let's do it in more javascript way.  There will be one <code>protocol(...)</code> method and if we call it without parameters, then this is getter, and if with one parameter, then setter. <br><br>  We will hide the real data in the closure. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> URL; <br> <br> <font color="#008000">//     .  , ..     parseURL  updateURL.</font> <br> ( <font color="#0000ff">function</font> () { <br> <br> URL = <font color="#0000ff">function</font> (url) { <br> <font color="#008000">// , .     URL - , .</font> <br> <font color="#0000ff">var</font> href, protocol, host, hostname, port, pathname, search, hash; <br> <br> <font color="#008000">//    -      ,    .</font> <br> <font color="#008000">// Get/set href -  set  parseURL.call(this),</font> <br> <font color="#008000">// ..   parseURL    URL - this.</font> <br> <font color="#0000ff">this</font> .href = <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> val != <font color="#A31515">"undefined"</font> ) { <br> href = val; <br> parseURL.call( <font color="#0000ff">this</font> ); <br> } <br> <font color="#0000ff">return</font> href; <br> } <br> <br> <font color="#008000">// Get/set protocol</font> <br> <font color="#008000">//  set href, set protocol  updateURL.call(this),    .</font> <br> <font color="#0000ff">this</font> .protocol = <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> val != <font color="#A31515">"undefined"</font> ) { <br> <font color="#008000">//  -  protocol  ,   window.location</font> <br> <font color="#0000ff">if</font> (!val) <br> val = protocol || window.location.protocol; <br> protocol = val; <br> updateURL.call( <font color="#0000ff">this</font> ); <br> } <br> <font color="#0000ff">return</font> protocol; <br> } <br> <br> <font color="#008000">// Get/set host</font> <br> <font color="#008000">//    ,  host, hostname  port -   .</font> <br> <font color="#008000">//       set host.</font> <br> <font color="#0000ff">this</font> .host = <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> val != <font color="#A31515">"undefined"</font> ) { <br> val = val || <font color="#A31515">''</font> ; <br> <font color="#0000ff">var</font> v = val.split( <font color="#A31515">':'</font> ); <br> <font color="#0000ff">var</font> h = v[0], p = v[1] || <font color="#A31515">''</font> ; <br> host = val; <br> hostname = h; <br> port = p; <br> updateURL.call( <font color="#0000ff">this</font> ); <br> } <br> <font color="#0000ff">return</font> host; <br> } <br> <br> <font color="#008000">// Get/set hostname</font> <br> <font color="#008000">//    host, hostname  port.</font> <br> <font color="#0000ff">this</font> .hostname = <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> val != <font color="#A31515">"undefined"</font> ) { <br> <font color="#0000ff">if</font> (!val) <br> val = hostname || window.location.hostname; <br> hostname = val; <br> host = val + (( <font color="#A31515">""</font> + port) ? <font color="#A31515">":"</font> + port : <font color="#A31515">""</font> ); <br> updateURL.call( <font color="#0000ff">this</font> ); <br> } <br> <font color="#0000ff">return</font> hostname; <br> } <br> <br> <font color="#008000">// Get/set port</font> <br> <font color="#008000">//    host, hostname  port.</font> <br> <font color="#0000ff">this</font> .port = <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> val != <font color="#A31515">"undefined"</font> ) { <br> port = val; <br> host = hostname + (( <font color="#A31515">""</font> + port) ? <font color="#A31515">":"</font> + port : <font color="#A31515">""</font> ); <br> updateURL.call( <font color="#0000ff">this</font> ); <br> } <br> <font color="#0000ff">return</font> port; <br> } <br> <br> <font color="#008000">// Get/set pathname</font> <br> <font color="#008000">//  pathname .    </font> <br> <font color="#008000">// relative pathname, ..    set' pathname,</font> <br> <font color="#008000">//        '/',   .</font> <br> <font color="#0000ff">this</font> .pathname = <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> val != <font color="#A31515">"undefined"</font> ) { <br> <font color="#0000ff">if</font> (val.indexOf( <font color="#A31515">"/"</font> ) != 0) { <font color="#008000">// relative url</font> <br> <font color="#0000ff">var</font> _p = (pathname || window.location.pathname).split( <font color="#A31515">"/"</font> ); <br> _p[_p.length - 1] = val; <br> val = _p.join( <font color="#A31515">"/"</font> ); <br> } <br> pathname = val; <br> updateURL.call( <font color="#0000ff">this</font> ); <br> } <br> <font color="#0000ff">return</font> pathname; <br> } <br> <br> <font color="#008000">// Get/set search</font> <br> <font color="#0000ff">this</font> .search = <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> val != <font color="#A31515">"undefined"</font> ) { <br> search = val; <br> } <br> <font color="#0000ff">return</font> search; <br> } <br> <br> <font color="#008000">// Get/set hash</font> <br> <font color="#0000ff">this</font> .hash = <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> val != <font color="#A31515">"undefined"</font> ) { <br> hash = val; <br> } <br> <font color="#0000ff">return</font> hash; <br> } <br> <br> url = url || <font color="#A31515">""</font> ; <br> parseURL.call( <font color="#0000ff">this</font> , url); <br> } <br> <br> URL.prototype = { <br> <font color="#008000">/**</font> <br> <font color="#008000">*     window.location.    URL.</font> <br> <font color="#008000">*/</font> <br> assign: <font color="#0000ff">function</font> (url) { <br> parseURL.call( <font color="#0000ff">this</font> , url); <br> window.location.assign( <font color="#0000ff">this</font> .href()); <br> }, <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">*     window.location.    URL,     history</font> <br> <font color="#008000">*/</font> <br> replace: <font color="#0000ff">function</font> (url) { <br> parseURL.call( <font color="#0000ff">this</font> , url); <br> window.location.replace( <font color="#0000ff">this</font> .href()); <br> } <br> } <br> <br> <font color="#008000">//  ,   URL  .</font> <br> <font color="#008000">//     -    URL.</font> <br> <font color="#008000">//    , ..       .</font> <br> <font color="#0000ff">function</font> parseURL(url) { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> ._innerUse) <br> <font color="#0000ff">return</font> ; <br> <br> url = url || <font color="#0000ff">this</font> .href(); <br> <font color="#0000ff">var</font> pattern = <font color="#A31515">"^(([^:/\\?#]+):)?(//(([^:/\\?#]*)(?::([^/\\?#]*))?))?([^\\?#]*)(\\?([^#]*))?(#(.*))?$"</font> ; <br> <font color="#0000ff">var</font> rx = <font color="#0000ff">new</font> RegExp(pattern); <br> <font color="#0000ff">var</font> parts = rx.exec(url); <br> <br> <font color="#008000">// Prevent infinite recursion</font> <br> <font color="#0000ff">this</font> ._innerUse = <font color="#0000ff">true</font> ; <br> <br> <font color="#0000ff">this</font> .href(parts[0] || <font color="#A31515">""</font> ); <br> <font color="#0000ff">this</font> .protocol(parts[1] || <font color="#A31515">""</font> ); <br> <font color="#008000">//this.host(parts[4] || "");</font> <br> <font color="#0000ff">this</font> .hostname(parts[5] || <font color="#A31515">""</font> ); <br> <font color="#0000ff">this</font> .port(parts[6] || <font color="#A31515">""</font> ); <br> <font color="#0000ff">this</font> .pathname(parts[7] || <font color="#A31515">"/"</font> ); <br> <font color="#0000ff">this</font> .search(parts[8] || <font color="#A31515">""</font> ); <br> <font color="#0000ff">this</font> .hash(parts[10] || <font color="#A31515">""</font> ); <br> <br> delete <font color="#0000ff">this</font> ._innerUse; <br> <br> updateURL.call( <font color="#0000ff">this</font> ); <br> } <br> <br> <font color="#008000">//  ,   URL   .</font> <br> <font color="#008000">//     -     URL.</font> <br> <font color="#008000">//    , ..       .</font> <br> <font color="#008000">// ,     ,     setter'.</font> <br> <font color="#0000ff">function</font> updateURL() { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> ._innerUse) <br> <font color="#0000ff">return</font> ; <br> <br> <font color="#008000">// Prevent infinite recursion</font> <br> <font color="#0000ff">this</font> ._innerUse = <font color="#0000ff">true</font> ; <br> <br> <font color="#0000ff">this</font> .href( <font color="#0000ff">this</font> .protocol() + <font color="#A31515">'//'</font> + <font color="#0000ff">this</font> .host() + <font color="#0000ff">this</font> .pathname() + <font color="#0000ff">this</font> .search() + <font color="#0000ff">this</font> .hash()); <br> <br> delete <font color="#0000ff">this</font> ._innerUse; <br> } <br> <br> })()</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  In general, the code is self-documented, so I will explain only the key points: <br><ul><li>  The prototype has been depleted of 2 methods <code>parse(...)</code> and <code>update(...)</code> , which were rendered, respectively, in the <code>parseURL(...)</code> and <code>updateURL(...)</code> functions </li><li>  Also, all data ( <code>href, port, host</code> , etc.) left the prototype, and settled in the closure created by the constructor.  And work with them now goes through getters &amp; setters </li></ul><br><h2>  Examples </h2><br>  Well, immediately to the examples.  After all, the main thing - to see this thing in action. <br><blockquote> <code><a href="http://my.site.com/somepath/relative/path/index.html"></a> <a href="http://my.site.com/absolute/path.php%3Fa%3D8"></a> <a href="https://my.site.com/absolute/path.php%3Fa%3D8"></a> <a href="https://another.site.com/"></a> <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">//   URL = 'http://my.site.com/somepath/'</font> <br> <font color="#0000ff">var</font> u = <font color="#0000ff">new</font> URL( <font color="#A31515">'relative/path/index.html'</font> ) <br> u.href() <font color="#008000">// my.site.com/somepath/relative/path/index.html</font> <br> u.href( <font color="#A31515">'/absolute/path.php?a=8#some-hash'</font> ) <br> u.href() <font color="#008000">// my.site.com/absolute/path.php?a=8#some-hash</font> <br> u.hash() <font color="#008000">// #some-hash</font> <br> u.protocol( <font color="#A31515">'https:'</font> ) <br> u.href() <font color="#008000">// my.site.com/absolute/path.php?a=8#some-hash</font> <br> u.host( <font color="#A31515">'another.site.com:8080'</font> ) <br> u.href() <font color="#008000">// another.site.com:8080/absolute/path.php?a=8#some-hash</font> <br> u.port() <font color="#008000">// 8080</font> <br> <font color="#008000">//   ,   </font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Like this.  Everything is working. <br>  In general, this is quite a working version.  Let's call it version 1.0 final. <br>  Now let's move on to version 2.0 alpha, or tru getters and setters come into play. <br><br><h2>  Attempt number 3 </h2><br>  I will give the code, and then I will consider the interesting moments. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> URL; <br> <br> ( <font color="#0000ff">function</font> () { <br> <font color="#0000ff">var</font> isIE = window.navigator.userAgent.indexOf( <font color="#A31515">'MSIE'</font> ) != -1; <br> <br> URL = <font color="#0000ff">function</font> (url) { <br> <font color="#0000ff">var</font> data = {href: <font color="#A31515">''</font> , protocol: <font color="#A31515">''</font> , host: <font color="#A31515">''</font> , hostname: <font color="#A31515">''</font> , port: <font color="#A31515">''</font> , pathname: <font color="#A31515">''</font> , search: <font color="#A31515">''</font> , hash: <font color="#A31515">''</font> }; <br> <br> <font color="#0000ff">var</font> gs = { <br> getHref: <font color="#0000ff">function</font> () { <br> <font color="#0000ff">return</font> data.href; <br> }, <br> setHref: <font color="#0000ff">function</font> (val) { <br> data.href = val; <br> parseURL.call( <font color="#0000ff">this</font> ); <br> <font color="#0000ff">return</font> data.href; <br> }, <br> <br> getProtocol: <font color="#0000ff">function</font> () { <br> <font color="#0000ff">return</font> data.protocol; <br> }, <br> setProtocol: <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> (!val) <br> val = data.protocol || window.location.protocol; <font color="#008000">// update || init</font> <br> data.protocol = val; <br> updateURL.call( <font color="#0000ff">this</font> ); <br> <font color="#0000ff">return</font> data.protocol; <br> }, <br> <br> getHost: <font color="#0000ff">function</font> () { <br> <font color="#0000ff">return</font> data.host; <br> }, <br> setHost: <font color="#0000ff">function</font> (val) { <br> val = val || <font color="#A31515">''</font> ; <br> <font color="#0000ff">var</font> v = val.split( <font color="#A31515">':'</font> ); <br> <font color="#0000ff">var</font> h = v[0], p = v[1] || <font color="#A31515">''</font> ; <br> data.host = val; <br> data.hostname = h; <br> data.port = p; <br> updateURL.call( <font color="#0000ff">this</font> ); <br> <font color="#0000ff">return</font> data.host; <br> }, <br> <br> getHostname: <font color="#0000ff">function</font> () { <br> <font color="#0000ff">return</font> data.hostname; <br> }, <br> setHostname: <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> (!val) <br> val = data.hostname || window.location.hostname; <font color="#008000">// update || init</font> <br> data.hostname = val; <br> data.host = val + (( <font color="#A31515">""</font> + data.port) ? <font color="#A31515">":"</font> + data.port : <font color="#A31515">""</font> ); <br> updateURL.call( <font color="#0000ff">this</font> ); <br> <font color="#0000ff">return</font> data.hostname; <br> }, <br> <br> getPort: <font color="#0000ff">function</font> () { <br> <font color="#0000ff">return</font> data.port; <br> }, <br> setPort: <font color="#0000ff">function</font> (val) { <br> data.port = val; <br> data.host = data.hostname + (( <font color="#A31515">""</font> + data.port) ? <font color="#A31515">":"</font> + data.port : <font color="#A31515">""</font> ); <br> updateURL.call( <font color="#0000ff">this</font> ); <br> <font color="#0000ff">return</font> data.port; <br> }, <br> <br> getPathname: <font color="#0000ff">function</font> () { <br> <font color="#0000ff">return</font> data.pathname; <br> }, <br> setPathname: <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">if</font> (val.indexOf( <font color="#A31515">"/"</font> ) != 0) { <font color="#008000">// relative url</font> <br> <font color="#0000ff">var</font> _p = (data.pathname || window.location.pathname).split( <font color="#A31515">"/"</font> ); <br> _p[_p.length - 1] = val; <br> val = _p.join( <font color="#A31515">"/"</font> ); <br> } <br> data.pathname = val; <br> updateURL.call( <font color="#0000ff">this</font> ); <br> <font color="#0000ff">return</font> data.pathname; <br> }, <br> <br> getSearch: <font color="#0000ff">function</font> () { <br> <font color="#0000ff">return</font> data.search; <br> }, <br> setSearch: <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">return</font> data.search = val; <br> }, <br> <br> getHash: <font color="#0000ff">function</font> () { <br> <font color="#0000ff">return</font> data.hash; <br> }, <br> setHash: <font color="#0000ff">function</font> (val) { <br> <font color="#0000ff">return</font> data.hash = val; <br> } <br> }; <br> <br> <font color="#0000ff">if</font> (isIE) { <font color="#008000">// IE5.5+</font> <br> <font color="#0000ff">var</font> el= <font color="#0000ff">document</font> .createElement( <font color="#A31515">'div'</font> ); <br> el.style.display= <font color="#A31515">'none'</font> ; <br> <font color="#0000ff">document</font> .body.appendChild(el); <br> el.assign = URL.prototype.assign; <br> el.replace = URL.prototype.replace; <br> <font color="#0000ff">var</font> keys = [ <font color="#A31515">"href"</font> , <font color="#A31515">"protocol"</font> , <font color="#A31515">"host"</font> , <font color="#A31515">"hostname"</font> , <font color="#A31515">"port"</font> , <font color="#A31515">"pathname"</font> , <font color="#A31515">"search"</font> , <font color="#A31515">"hash"</font> ]; <br> el.onpropertychange= <font color="#0000ff">function</font> (){ <br> <font color="#0000ff">var</font> pn = <font color="#0000ff">event</font> .propertyName; <br> <font color="#0000ff">var</font> pv = <font color="#0000ff">event</font> .srcElement[ <font color="#0000ff">event</font> .propertyName]; <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> ._holdOnMSIE || pn == <font color="#A31515">'_holdOnMSIE'</font> ) <br> <font color="#0000ff">return</font> pv; <br> <font color="#0000ff">this</font> ._holdOnMSIE = <font color="#0000ff">true</font> ; <br> <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0, l = keys.length; i &lt; l; i++) <br> el[keys[i]] = data[keys[i]]; <br> <font color="#0000ff">this</font> ._holdOnMSIE = <font color="#0000ff">false</font> ; <br> <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0, l = keys.length; i &lt; l; i++) { <br> <font color="#0000ff">var</font> key = keys[i]; <br> <font color="#0000ff">if</font> (pn == key) { <br> <font color="#0000ff">var</font> sKey = <font color="#A31515">'set'</font> + key.substr(0, 1).toUpperCase() + key.substr(1); <br> <font color="#0000ff">return</font> gs[sKey].call(el, pv); <br> } <br> } <br> } <br> url = url || <font color="#A31515">""</font> ; <br> parseURL.call(el, url); <br> <font color="#0000ff">return</font> el; <br> } <font color="#0000ff">else</font> <font color="#0000ff">if</font> (URL.prototype.__defineSetter__) { <font color="#008000">// FF</font> <br> <font color="#0000ff">var</font> keys = [ <font color="#A31515">"href"</font> , <font color="#A31515">"protocol"</font> , <font color="#A31515">"host"</font> , <font color="#A31515">"hostname"</font> , <font color="#A31515">"port"</font> , <font color="#A31515">"pathname"</font> , <font color="#A31515">"search"</font> , <font color="#A31515">"hash"</font> ]; <br> <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0, l = keys.length; i &lt; l; i++) { <br> ( <font color="#0000ff">function</font> (i) { <br> <font color="#0000ff">var</font> key = keys[i]; <br> <font color="#0000ff">var</font> gKey = <font color="#A31515">'get'</font> + key.substr(0, 1).toUpperCase() + key.substr(1); <br> <font color="#0000ff">var</font> sKey = <font color="#A31515">'set'</font> + key.substr(0, 1).toUpperCase() + key.substr(1); <br> URL.prototype.__defineGetter__(key, gs[gKey]); <br> URL.prototype.__defineSetter__(key, gs[sKey]); <br> })(i); <br> } <br> url = url || <font color="#A31515">""</font> ; <br> parseURL.call( <font color="#0000ff">this</font> , url); <br> } <br> } <br> <br> URL.prototype = { <br> assign: <font color="#0000ff">function</font> (url) { <br> parseURL.call( <font color="#0000ff">this</font> , url); <br> window.location.assign( <font color="#0000ff">this</font> .href); <br> }, <br> <br> replace: <font color="#0000ff">function</font> (url) { <br> parseURL.call( <font color="#0000ff">this</font> , url); <br> window.location.replace( <font color="#0000ff">this</font> .href); <br> } <br> } <br> <br> <font color="#0000ff">function</font> parseURL(url) { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> ._innerUse) <br> <font color="#0000ff">return</font> ; <br> <br> url = url || <font color="#0000ff">this</font> .href; <br> <font color="#0000ff">var</font> pattern = <font color="#A31515">"^(([^:/\\?#]+):)?(//(([^:/\\?#]*)(?::([^/\\?#]*))?))?([^\\?#]*)(\\?([^#]*))?(#(.*))?$"</font> ; <br> <font color="#0000ff">var</font> rx = <font color="#0000ff">new</font> RegExp(pattern); <br> <font color="#0000ff">var</font> parts = rx.exec(url); <br> <br> <font color="#008000">// Prevent infinite recursion</font> <br> <font color="#0000ff">this</font> ._innerUse = <font color="#0000ff">true</font> ; <br> <br> <font color="#0000ff">this</font> .href = parts[0] || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .protocol = parts[1] || <font color="#A31515">""</font> ; <br> <font color="#008000">//this.host = parts[4] || "";</font> <br> <font color="#0000ff">this</font> .hostname = parts[5] || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .port = parts[6] || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .pathname = parts[7] || <font color="#A31515">"/"</font> ; <br> <font color="#0000ff">this</font> .search = parts[8] || <font color="#A31515">""</font> ; <br> <font color="#0000ff">this</font> .hash = parts[10] || <font color="#A31515">""</font> ; <br> <br> <font color="#0000ff">if</font> (!isIE) <br> delete <font color="#0000ff">this</font> ._innerUse; <br> <font color="#0000ff">else</font> <br> <font color="#0000ff">this</font> ._innerUse = <font color="#0000ff">false</font> ; <br> <br> updateURL.call( <font color="#0000ff">this</font> ); <br> } <br> <br> <font color="#0000ff">function</font> updateURL() { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> ._innerUse) <br> <font color="#0000ff">return</font> ; <br> <br> <font color="#008000">// Prevent infinite recursion</font> <br> <font color="#0000ff">this</font> ._innerUse = <font color="#0000ff">true</font> ; <br> <br> <font color="#0000ff">this</font> .href = <font color="#0000ff">this</font> .protocol + <font color="#A31515">'//'</font> + <font color="#0000ff">this</font> .host + <font color="#0000ff">this</font> .pathname + <font color="#0000ff">this</font> .search + <font color="#0000ff">this</font> .hash; <br> <br> <font color="#0000ff">if</font> (!isIE) <br> delete <font color="#0000ff">this</font> ._innerUse; <br> <font color="#0000ff">else</font> <br> <font color="#0000ff">this</font> ._innerUse = <font color="#0000ff">false</font> ; <br> } <br> <br> })()</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Consider creating getters / setters: <br><ul><li>  <strong>Firefox case:</strong> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> keys = [ <font color="#A31515">"href"</font> , <font color="#A31515">"protocol"</font> , <font color="#A31515">"host"</font> , <font color="#A31515">"hostname"</font> , <font color="#A31515">"port"</font> , <font color="#A31515">"pathname"</font> , <font color="#A31515">"search"</font> , <font color="#A31515">"hash"</font> ]; <br> <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0, l = keys.length; i &lt; l; i++) { <br> ( <font color="#0000ff">function</font> (i) { <br> <font color="#0000ff">var</font> key = keys[i]; <br> <font color="#0000ff">var</font> gKey = <font color="#A31515">'get'</font> + key.substr(0, 1).toUpperCase() + key.substr(1); <br> <font color="#0000ff">var</font> sKey = <font color="#A31515">'set'</font> + key.substr(0, 1).toUpperCase() + key.substr(1); <br> URL.prototype.__defineGetter__(key, gs[gKey]); <br> URL.prototype.__defineSetter__(key, gs[sKey]); <br> })(i); <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Use the magic <code>URL.prototype.__defineGetter__</code> and <code>URL.prototype.__defineSetter__</code> .  As a result, we will have pseudo-attributes <code>url.href, url.path</code> , etc., changing which handler functions will actually be called. <br></li><li>  <strong>Case for Internet Explorer:</strong> here begins the dance with a tambourine.  IE &lt;8 versions do not have getter / setter mechanisms at all.  However, there is a wonderful event - <code>onpropertchange</code> .  There is nothing left to use.  However, a complication arises - this event is present only in DOM elements, and even then only when these elements are <strong>already included in the DOM model</strong> .  Well, so do: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> el = <font color="#0000ff">document</font> .createElement( <font color="#A31515">'div'</font> ); <br> el.style.display = <font color="#A31515">'none'</font> ; <br> <font color="#0000ff">document</font> .body.appendChild(el); <br> <font color="#008000">// ...</font> <br> el.onpropertychange = <font color="#0000ff">function</font> (){ <br> <font color="#0000ff">var</font> pn = <font color="#0000ff">event</font> .propertyName; <font color="#008000">//   </font> <br> <font color="#0000ff">var</font> pv = <font color="#0000ff">event</font> .srcElement[ <font color="#0000ff">event</font> .propertyName]; <font color="#008000">//   </font> <br> <font color="#008000">// ...</font> <br> } <br> <font color="#008000">// ...</font> <br> <font color="#0000ff">return</font> el; <font color="#008000">//   el. ..   new URL(...)</font> <br> <font color="#008000">//     URL,   DIV.</font> <br> <font color="#008000">// ,    , ..  </font> <br> <font color="#008000">//   instanceof.    ,  IE,  :)</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br></li></ul><br><h2>  Examples number 2 </h2><br><blockquote> <code><a href="http://my.site.com/somepath/relative/path/index.html"></a> <a href="http://my.site.com/absolute/path.php%3Fa%3D8"></a> <a href="https://my.site.com/absolute/path.php%3Fa%3D8"></a> <a href="https://another.site.com/"></a> <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">//   URL = 'http://my.site.com/somepath/'</font> <br> <font color="#0000ff">var</font> u = <font color="#0000ff">new</font> URL( <font color="#A31515">'relative/path/index.html'</font> ) <br> u.href <font color="#008000">// my.site.com/somepath/relative/path/index.html</font> <br> u.href = <font color="#A31515">'/absolute/path.php?a=8#some-hash'</font> <br> u.href <font color="#008000">// my.site.com/absolute/path.php?a=8#some-hash</font> <br> u.hash <font color="#008000">// #some-hash</font> <br> u.protocol = <font color="#A31515">'https:'</font> <br> u.href <font color="#008000">// my.site.com/absolute/path.php?a=8#some-hash</font> <br> u.host = <font color="#A31515">'another.site.com:8080'</font> <br> u.href <font color="#008000">// another.site.com:8080/absolute/path.php?a=8#some-hash</font> <br> u.port <font color="#008000">// 8080</font> <br> <font color="#008000">//   ,   </font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Works in FF3 +, IE6 +.  You can screw for Safari / Chrome.  What about Opera - not sure.  RTFM required. <br><br><h2>  Like this </h2><br>  I hope I did something useful and not wasted my day on writing this article :-) <br>  PS: yes, I think to write a separate article dedicated to getters and setters in different browsers.  Firefox doesn‚Äôt live by one thing (small PR: in order not to load Habrahabr with my stream of thoughts - welcome to my blog - <a href="http://web-by-kott.blogspot.com/">http://web-by-kott.blogspot.com/</a> . There‚Äôs still something deserted, but I‚Äôm just I'm starting) </div><p>Source: <a href="https://habr.com/ru/post/65407/">https://habr.com/ru/post/65407/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../65391/index.html">Third dimension password protection</a></li>
<li><a href="../65399/index.html">For some visitors, Wikipedia completely stopped loading, while for others, only Wikimediaire pictures stopped.</a></li>
<li><a href="../65401/index.html">New site using Google services</a></li>
<li><a href="../65404/index.html">Habr does not give the password</a></li>
<li><a href="../65406/index.html">You want to promote your product (library or set of components). Your actions?</a></li>
<li><a href="../65408/index.html">CodeIgniter + lighttpd = CNC</a></li>
<li><a href="../65410/index.html">How to write a word in the password field so that it would be visible?</a></li>
<li><a href="../65414/index.html">And the reaper, and the Swiss, and the dude igrets - an expert in Internet technology</a></li>
<li><a href="../65415/index.html">The future of Russia according to MTS</a></li>
<li><a href="../65416/index.html">Dante's Inferno: Boss Fight</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>