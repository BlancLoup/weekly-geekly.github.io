<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Artificial Intelligence and Neural Networks for .NET Developers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artificial intelligence is now one of the most discussed topics and the main engine of digital business transformation. Microsoft‚Äôs AI strategy includ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Artificial Intelligence and Neural Networks for .NET Developers</h1><div class="post__text post__text-html js-mediator-article"><p>  Artificial intelligence is now one of the most discussed topics and the main engine of digital business transformation.  Microsoft‚Äôs AI strategy includes democratizing AI for developers, i.e.  providing easy-to-use frameworks and services for solving intellectual problems.  This article describes how .NET-developers can use the capabilities of AI in their projects: from ready-made cognitive services running in the cloud, to learning neural networks in .NET-languages ‚Äã‚Äãand running complex neural network models on compact devices like Raspberry Pi. </p><br><p>  The prototype of the article was the <a href="http://2017.dotnext-moscow.ru/2017/msk/talks/3emvrfszfcuieigqe0cimq/">presentation by Dmitry Soshnikov</a> at the <a href="http://dotnext.ru/">DotNext</a> 2017 Moscow Conference.  Dmitry is a technological evangelist of Microsoft, which is involved in the popularization of modern software development technologies among novice developers.  He specializes in the field of the Internet of Things, in the development of universal Windows applications, in the field of functional programming and on the .NET platform (F #, Roslyn).  I personally spent dozens of hackathons throughout Russia, helped many student startups to start their projects in various fields.  Associate Professor, Ph.D., leads classes at MIPT and MAI, a member of the Russian Association of Artificial Intelligence, in the summer - the leading chair of computer technology at the UNIO-R children's camp. </p><br><blockquote>  Caution traffic!  In this post there is a huge number of pictures - slides and screenshots from a video in 720p format. </blockquote><br><iframe width="560" height="315" src="https://www.youtube.com/embed/E4mP1slv4oI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><p>  In this article we will talk about artificial intelligence.  Why is it fashionable to talk about him now?  Because it is a range of technologies that is changing the world very quickly. </p><br><p>  Such an example of changing the world is McDonalds.  And in America, and we have MacAuto.  We have a man sitting there who takes orders.  And already 20 years ago in America it was decided that there is no need for a person there, you need to replace it with an operator who sits in India - it will be much cheaper.  He will talk to visitors on the phone, drive it all into the computer, the order will be prepared, and the American will not have to pay.  The American sitting in the window is very expensive.  Such a solution has reduced prices: hamburgers have become cheaper, people have become less healthy - all is well.  The last step in this direction was taken when they realized that a person was not needed there at all.  You can take it and replace it with a speech recognition algorithm.  Such a project more than a year ago did our colleagues from the American Microsoft. </p><br><p>  On the Internet there are videos in which you can try to make out what a person hears in the window of McDonalds, and feel the depth of the suffering of this person.  He can not hear anything: there are noises, cars are passing, and he is forced to recognize it.  It turns out that the AI ‚Äã‚Äãdoes it better than a person, because a person gets tired. </p><br><img src="https://habrastorage.org/webt/kq/xb/ra/kqxbrajy3wmu0zhelepzrcee-0k.png"><br><p>  In the case of ordering, the conversation with the operator goes on a completely specific topic; no one will talk about the meaning of life with such a window.  When the menu is clear, when the words are clear, the computer recognizes the person better.  In 2016, Microsoft made a statement that they finally made a speech recognition algorithm that works better than humans.  He was tested and confirmed that it was really better. </p><br><p>  In 2015, the computer began to recognize certain images - road signs.  Conventionally, out of a thousand pictures, a computer finds road signs better than a person.  Why?  Probably, it bothers a person somewhere in the middle, but not a computer.  But the result is the result: the computer copes better with such tasks. </p><br><p>  Here is a list of Microsoft's achievements in the field of AI, they are impressive. </p><br><img src="https://habrastorage.org/webt/db/om/de/dbomdezwotvwfar7seujjvysaoq.png"><br><p>  Microsoft is ahead of the rest.  Now research is being conducted on how to use FPGA chips programmed in the cloud in order to run neural networks on them.  The range of solutions here is big. </p><br><p>  What is the overall strategy of the company?  What is Microsoft doing in the field of AI? </p><br><p>  First, of course, injects into products.  Power BI, HoloLens - a lot of recognition is now attached to it.  And in PowerPoint there are many places where AI is used.  For example, there is a button ‚Äúdesign a slide for me‚Äù, it is called ‚ÄúDesign ideas‚Äù and offers design for simple slides.  This is the result of machine learning and the use of AI technologies.  Or if you insert a picture in PowerPoint, it is generated a signature in a natural language - what is shown on it.  So that later, if you export it somewhere on the web, the corresponding tags were correctly inserted.  It would seem a trifle, but nice. </p><br><p>  AI is introduced into products, research is being carried out, how it can be used more effectively in the cloud, and - most importantly for developers - the democratization of AI is happening to make it easier to use. </p><br><img src="https://habrastorage.org/webt/w9/wv/qf/w9wvqfzpxevg7cjijkys0124zby.png"><br><p>  There are cognitive services.  They can simply be used for basic tasks that have to be solved, such as image processing.  For example, we want to introduce in our product such functionality that it automatically inserts a caption to the picture.  It is easy - there is a ready-made cloud service: we give it a picture, it returns the description in English.  If we want to introduce machine translation into our product, everything is also very simple: we use the Bing Translator service, we receive translation from almost any language into any language.  These features are available to everyone. </p><br><p>  Within the framework of democratization, there are four main areas: cognitive services, bots, machine learning - Azure ML, neural networks - Microsoft Cognitive Toolkit.  Let us dwell on the last two. </p><br><img src="https://habrastorage.org/webt/rc/hs/dj/rchsdjmfdzoxclzldqp_mcsoji4.png"><br><p>  The basic idea of ‚Äã‚Äãmachine learning is that the computer on the data itself learns how to do something. </p><br><p>  For example, we want to learn to recognize a person‚Äôs emotions from a photograph.  How can I do that? </p><br><img src="https://habrastorage.org/webt/0j/h2/jg/0jh2jgx2jequg7fd1cosvckgtfg.png"><br><p>  If we think about how to write an algorithm, it is clear that we will very quickly get into a dead end.  For example, we do not quite know how to accurately distinguish surprise from fear: the eyes are round in both cases.  It is not clear how to do this algorithmically.  And if we take a lot of photos, then, probably, we can somehow automatically do it on them.  How?  Firstly, it is important for us to identify some basic signs from a photo ‚Äî go to some numerical indicators.  Because photography is an abstract thing with many details.  But we can, for example, recognize the position of the eyes, the position of the corners of the lips, go to the numerical things that can be presented in a table.  Then it can be submitted to the input of machine learning, so that the algorithm finds a pattern in them and builds a model, which can then make predictions to us.  Then we take the face, select the same signs in it, feed the model to the input, and the model tells us that, for example, this is a person who is 80% happy, 20% something else. </p><br><img src="https://habrastorage.org/webt/3a/vi/mn/3avimn44cszyp4nhcjwjco060nc.png"><br><p>  If we talk about terminology, then artificial intelligence is a common topic in which we do something that copes with human tasks.  Machine learning is a part of AI, when the algorithm is not written by us, but it is written on the basis of data processing.  Neural networks are one particular case of machine learning.  And inside the neural networks there is still a trendy term ‚Äúdeep learning‚Äù, when neural networks are deep.  In general, neural networks are now crowding out the rest of the algorithms, because many complex problems are solved with the help of this very ‚Äúdeep learning‚Äù. </p><br><img src="https://habrastorage.org/webt/_m/bu/u_/_mbuu_d52bwl1yqwjioqwzsaay4.png"><br><p> As for the tools: how do people who do deep learning live?  They have two languages: Python and R. Why did Python become popular for data scientists?  It so happens that there are some very good libraries written, naturally, in C ++ (because otherwise they would be slow), but for which there is a very good Python wrapper.  And so it turned out to be convenient to use Python as gluing together different libraries.  And since there are already many libraries for machine learning, it so happened that you can just pick them up and start using them. </p><br><p>  For neural networks the same.  When everyone started to implement their libraries, they thought: "All data scientists write in Python, so we also need to do all the libraries in Python."  So there was a large number of libraries that support Python.  Even Microsoft has made support for Python for our CNTK library, and has not done .NET support for a long time. </p><br><p>  The R language is still more interesting: R has a ready-made Comprehensive R Archive Network, in which there are a bunch of ready-made libraries for all occasions.  You just need to learn this language and one hundred thousand other libraries. </p><br><p>  And what about a person who has never come across this? </p><br><img src="https://habrastorage.org/webt/fm/dl/ww/fmdlwwjvjnmh4j5qn8y9mzz3h4a.png"><br><p>  On the one hand, you can go to study, but you don't want to.  Since I have to work with neural networks, when I work with Python, I‚Äôm not exactly deeply disgusted, but it‚Äôs hard for me.  Psychologically, it is very difficult after typed beautiful .NET languages ‚Äã‚Äãto switch to an untyped language, in which errors are not checked and they become clear when you are already running everything.  Feeling as if you program without a hand. </p><br><p>  Let's see what tools are in the .NET world in order to solve the problems of machine learning and training of neural networks. </p><br><img src="https://habrastorage.org/webt/c6/7q/9y/c67q9yylxx9kwwpydhj_gj22-ey.png"><br><p>  Let's start with the question: ‚ÄúIs it difficult to write something yourself?  What if it's easy? " </p><br><img src="https://habrastorage.org/webt/fj/mn/ul/fjmnulrviygktf7ebrqgjl0rohi.png"><br><p>  And take this classic task: recognizing handwritten numbers.  There is a ready dataset out of 50000-70000 handwritten numbers, which were written by some employees of the US statistics department.  This data is publicly available and they are presented as 28 by 28 pixel images.  This task seems to be not too difficult, but, on the other hand, it is not too simple, some not quite toy, not forecasting the price of an apartment in Moscow.  It is not very clear how to approach it.  Let's see how this problem can be solved and how effectively and well it can be done. </p><br><p>  What is the simplest solution that comes to mind?  We have 50,000 examples, then someone wrote some number and said: ‚ÄúAnd what is this figure?‚Äù How can we figure out which one?  We can simply compare with all 50,000 and take the one that best suits.  How to compare?  You can read the difference in brightness in pixels. </p><br><img src="https://habrastorage.org/webt/wa/um/tl/waumtl4yugcgei6pytkvwckwjuk.png"><br><p>  Such an algorithm is called ‚ÄúK Nearest Neighbors‚Äù with K equal to 1. Let's see if it is difficult to program it. </p><br><img src="https://habrastorage.org/webt/mh/zv/yf/mhzvyfh05zbqcepqcn8qwh4fdiq.png"><br><p>  At the same time, I will show you one good tool that all data scientists use is called Jupyter Notebook.  This is a very handy tool that allows you to combine program text on the web with some text written in Markdown.  It looks like this. </p><br><img src="https://habrastorage.org/webt/o-/6j/p_/o-6jp_awupewihbzpc8kesquaio.png"><br><p>  I have a cell-text, then there is a cell-code that I can execute.  Since Jupyter Notebook is a tool from the Python world, it supports Python and R well, but you can tie it to support other languages: C #, F #, even Prolog.  At the same time, Microsoft said: ‚ÄúAnd let us present these Jupyter Notebooks in our cloud ready.‚Äù  On good, if you want to install it yourself, you need to put Python, Jupyter on your computer, run it all and continue to open it in your browser.  And Microsoft provides ready-made Notebooks in the cloud, you go to notebooks.azure.com - and you can start working: log in with your Microsoft account and you can create these same Notebooks with code.  This code will be executed in the cloud for free, but with certain restrictions.  For example, data can be taken only from certain places: from the cloud or from GitHub.  These Notebooks and Microsoft support Python, R, and F #.  C # is not, and F # is supported.  Why?  Because F # is better? </p><br><p>  Actually, because for F # there is already ready beautiful good support.  For C # there is a similar tool called Xamarin Workbook.  This is kind of a similar thing, it works locally on your computer, but it also allows you to combine code with text.  Combining the code with the text is very cool, because everything is clear right away, all the steps are described. </p><br><p>  We take these images of numbers, which are presented in the form of CSV (Comma-Separated Values).  At the same time, in each line the first element is the written number itself, and the rest is an array of 784 numbers, each of which is the brightness of the corresponding pixel.  And this matrix of numbers is laid out in a long line of numbers.  I described on F # a function that takes these values ‚Äã‚Äãfrom the Internet, reads and returns us such long lines. </p><br><img src="https://habrastorage.org/webt/1p/1x/wy/1p1xwyckh5vsjq2iekf7-z5zrm0.png"><br><p> Now, in order to do something about it, we will put it into arrays and divide it into two parts: we will have <code>train_sample</code> ‚Äî this is a training sample, and <code>test_sample</code> ‚Äî this is for testing.  Conventionally, we will take 50,000 trainers and some thousands for verification.  And we bring them to a convenient form: we will present them in the form of pairs.  In the pair we will have a digit and an array of the remaining pixels.  And there are many such couples. </p><br><p>  Next, how do we find the nearest one?  In order to find the closest one, we need to determine the distance.  To determine the distance, we describe the distance function, which takes two arrays with images, traverses these arrays, counts the difference of squares and then their sum.  That is, this Cartesian distance, we simply do not extract the root.  It shows proximity: if the arrays are the same, it shows zero, if slightly different, there will be some number.  And in order to find the corresponding figure, we take all our <code>train_data</code> - 50000 - then we search for which of them the minimum distance is, and take the corresponding figure.  The code is simple.  Then we run, and it works. </p><br><img src="https://habrastorage.org/webt/ns/-m/rk/ns-mrkwxamoslmbkshkfzw95rns.png"><br><p>  We take test data.  In this case, I take the top three entries and try to recognize: the eight is recognized as 8, the seven as 7, two as 2. This is good, it inspires hope.  If we go further through the entire test sample, we get 94% correct recognition.  This is, in principle, very good. </p><br><p>  94% - then you can do almost nothing, although we wrote only a few lines. </p><br><img src="https://habrastorage.org/webt/r2/l6/fp/r2l6fpxwofehrnnr0yesioi6amm.png"><br><p>  And if we want to do the same in C #? </p><br><p>  Show if someone does not know.  Visual Studio has a great tool called C # Interactive.  This is a console in which you can execute C # directly like this: selected a piece of text, pressed a key and it is executed in the console.  If I want to do the same in C #, what will it look like? </p><br><pre> <code class="hljs go">#r <span class="hljs-string"><span class="hljs-string">"SciSharp.dll"</span></span> using SciSharp; using static System.Console; class Digit { public <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] Image; public <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Label; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fn = @<span class="hljs-string"><span class="hljs-string">"train.csv"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = File.ReadLines(fn); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = from z in f.Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>) let zz = z.Split(<span class="hljs-string"><span class="hljs-string">','</span></span>).Select(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.Parse) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Digit { Label = zz.First(), Image = zz.Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>).toArray(); }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> train = data.Take(<span class="hljs-number"><span class="hljs-number">10000</span></span>).toArray(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> test = data.Skip(<span class="hljs-number"><span class="hljs-number">10000</span></span>).Take(<span class="hljs-number"><span class="hljs-number">1000</span></span>).toArray(); Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[ ],<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[ ],<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; dist = (a, b) =&gt; a.Zip(b, (x, y) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x - y); } ).Sum(); Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[ ], <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; classify = (im) =&gt; train.MindBy(d =&gt; dist(d.Image, im)).Label; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>, correct = <span class="hljs-number"><span class="hljs-number">0</span></span>; foreach (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> z in test) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = classify(z.Image); WriteLine(<span class="hljs-string"><span class="hljs-string">"{0} =&gt; {1}"</span></span>, z.Label, n); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (z.Label == n) correct++; count++; }</code> </pre> <br><p>  That's all.  Then I can run it and enjoy the result.  Numbers are recognized slowly, because for each digit you need to view 50,000 records (in our case, not 50,000, but 10,000 records).  Therefore, for the practical application of such an algorithm is not very well suited.  We wrote it quickly, it works not so badly, but still very slowly.  In general, it would be good for machine learning to build such a model that will work quickly, it will somehow encapsulate the essence of the process: not every time to compare it with all the initial data, but to find some regularity.  Therefore, of course, it is better to use some other algorithms. </p><br><img src="https://habrastorage.org/webt/bb/fq/fm/bbfqfmdnyt8_s7yzwsbeqdzg2lq.png"><br><p>  Thus, we smoothly proceed to the next episode. </p><br><img src="https://habrastorage.org/webt/jl/uv/14/jluv14fahonmtruh_bxczmxqqgm.png"><br><p>  In order not to program them yourself, you need to see if there are any ready-made libraries.  And here it turns out that for .NET there is a good library called Accord.NET. </p><br><img src="https://habrastorage.org/webt/wx/bs/me/wxbsmet8ihxv50zdkes-onrkjzu.png"><br><p>  In order to do machine learning, we need to be able to operate well with matrices, statistics, various statistical functions.  And Accord.NET contains the corresponding elements.  There is a fragment that is responsible for statistics, there is an algorithm that is responsible for genetic algorithms, for neural networks, processing of sound, images.  There are also useful features that allow you to build a graph.  A data scientist often needs to take and see how data depends on each other. </p><br><p>  For this, I will write a program, I have a blank in which WriteLine is written.  This is the same code that already was.  He reads all the data to me, breaks it into a test and training sample.  And then I use Accord.NET to draw these numbers on the screen.  There is such a beautiful feature - ImageBox.Show, which allows you to draw something. </p><br><pre> <code class="hljs kotlin">#r <span class="hljs-string"><span class="hljs-string">"SciSharp.dll"</span></span> using SciSharp; using static System.Console; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Digit</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int[] Image; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int Label; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fn = @<span class="hljs-string"><span class="hljs-string">"train.csv"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = File.ReadLines(fn); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = from z <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f.Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>) let zz = z.Split(<span class="hljs-string"><span class="hljs-string">','</span></span>).Select(int.Parse) select new Digit { Label = zz.First(), Image = zz.Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>).toArray(); }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> train = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.Take(<span class="hljs-number"><span class="hljs-number">10000</span></span>).toArray(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> test = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.Skip(<span class="hljs-number"><span class="hljs-number">10000</span></span>).Take(<span class="hljs-number"><span class="hljs-number">1000</span></span>).toArray(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>; i++) { ImageBox.show(train[i].Image.Select(x =&gt; x / <span class="hljs-number"><span class="hljs-number">256.0</span></span>).toArray(), <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>); }</code> </pre> <br><p>  And now let's apply some learning algorithm to them.  For starters, the same KNearestNeighbours classifier.  How does it look on the Accord? </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> classifier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KNearestNeighbors(<span class="hljs-number"><span class="hljs-number">1</span></span>); classifer.Learn( (<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> train <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> x.Image.Select(z=&gt;(<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)z).toArray()).toArray(), (<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> train <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> x.Label).toArray());</code> </pre> <br><p>  We simply say: ‚ÄúWe want to create a KNearestNeighbours classifier with K equal to one‚Äù.  By the way, in the KNN algorithm, what does this K mean?  In the general case, we take not just the nearest available figure, but we take, for example, the five closest ones and look for the one that occurs most often among them.  The number 4 can be similar three times by 4 and two times by 1. And then we take 4. The increase in this class makes the recognition a bit better, but it greatly reduces efficiency.  Therefore, we take 1 and say: "Classifier.Learn.  Please learn.  And we give him our data.  The data in this case had to be cut, because I had to separately transfer the matrix of images and separately the matrix of the corresponding numbers.  This Accord is so arranged that two arrays are passed to it. </p><br><p>  Then you can see how it works. </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> z <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> test) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = classifer.Decide(z.Image.Select(t=&gt;(<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)t)).toArray()); WriteLine(<span class="hljs-string"><span class="hljs-string">"{0} =&gt; {1}"</span></span>, z.Label, n); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (z.Label == n) correct++; count++; }</code> </pre> <br><p>  It works, it seems, a little bit faster than what we saw before, but not much.  If 5000 numbers wait so long it will be long enough.  But the accuracy of recognition does not change, because we used the same algorithm.  But we did not write it ourselves manually, but took the finished implementation. </p><br><p>  What good is this approach?  Now we can use some other classifier instead.  For example, I will delete this classifier and take the so-called classifier Support vector machine.  This is another class of algorithms. </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> svm = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MuliclassSupportVectorLearning&lt;Linear&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> classifier = svm.Lean( (<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> train <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> x.Image.Select(z=&gt;(<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)z).toArray()).toArray(), (<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> train <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> x.Label).toArray());</code> </pre> <br><p>  How are they arranged?  In terms of machine learning, this task is called a classification task, when there are objects and need to be assigned to one of 10 classes.  And the Support vector machine takes these classes.  If they are presented in some graphical form in the state space, it will be text, clouds of some multidimensional points.  Imagine a point in space with a dimension of 784, each point corresponds to its own digit.  They need to somehow be divided.  The idea of ‚Äã‚Äãthe Support vector machine algorithm is to build such a plane that will as much as possible stand apart from the elements of these classes, which will best separate them.  But it is best to separate in terms of perpendicular omitted.  That is, any classification task is a task to build a plane that will be best divided.  If we look at the perpendicular from the nearest point to this plane and minimize this distance, the Support vector machine will draw the corresponding plane. </p><br><p>  We replaced just two lines.  In fact, the name of the algorithm has changed. </p><br><p>  Run, now the algorithm will take some time to learn.  Here the situation is, in a sense, the opposite of what we saw.  If the previous algorithm was not trained, it was just immediately ready to classify the numbers, but it did this for a very long time, because the work itself took place in the classification process, here this algorithm is first trained.  He chooses the coefficients of these hyperplanes.  And so a certain time passes while he does it.  But then he begins to recognize very quickly.  So fast that we can see in a few seconds how these 1000 or 5000 test data will all count.  And we see that the accuracy is about 91.8%, a little less. </p><br><img src="https://habrastorage.org/webt/ge/c-/3x/gec-3xmxnn70o5u7y7yaqyttc20.png"><br><p>  What is good Accord?  There are many different algorithms in it, and it is very easy to try them, we can replace one algorithm with another, just by replacing the constructor, and further the principles of their work are quite similar.  If you have a machine learning task, then this is a good second step to get started.  The first step is Microsoft's Azure Machine Learning in the cloud, which does not require programming at all.  There you can just visually experiment with the data.  And the second step for those who know .NET is Accord.NET. </p><br><img src="https://habrastorage.org/webt/z6/cu/e5/z6cue5_wmjihtwn8uaowcuano8m.png"><br><p>  We understand that for the area where all sorts of libraries like SciPy or Scikit-learn are used in Python, their equivalent for the .NET world is Accord.NET. </p><br><p>  Let's go to neural networks. </p><br><img src="https://habrastorage.org/webt/nj/0x/cl/nj0xclkrfr3z-8pttceczh_hdmc.png"><br><p>  Let's talk a little bit about what neural networks are all about.  The most important thing to know about them is that in recent years, many have considered neural networks to be synonymous with AI in general.  When people say artificial intelligence, neural networks immediately pop up in their heads.  All Microsoft cognitive services are based on neural networks and look like magic.  Imagine: you give her a photo, and she describes what is depicted in English.  How can I do that?  In my opinion, this is a miracle. </p><br><img src="https://habrastorage.org/webt/wp/y6/vm/wpy6vmeb4uptihxtyh7zofln2-g.png"><br><p>  But at the same time, from a mathematical point of view, we understand that this miracle is only a way of constructing some function that optimally approximates a certain cloud of points in a very multidimensional space.  That is, it turns out such a strange situation: on the one hand, from the point of view of mathematics, nothing strange happens.  Everything seems to be very clear.  On the other hand, for some reason this solves such interesting problems. </p><br><p>  Even lately, I began to sleep badly at night, because I am beginning to think: ‚ÄúIs my brain, is it like that too?  Maybe he also just approximates the function? ‚ÄùAnd for some reason this makes me depressed. </p><br><p>  Everything looks like magic.  It is very important to understand that for serious tasks, such as converting a picture into text, you need very large computational resources.  This is most likely either a cloud or powerful video cards, but they have already ceased to be available, because cryptocurrency has already bought everything.  And this is also sad.  But in the cloud cars remained. </p><br><img src="https://habrastorage.org/webt/ao/xf/4s/aoxf4swu03rtimzzrsi2mm-bjrs.png"><br><p>  How is the neural network?  The neural network, in a sense, resembles the architecture of the human brain.  There are neurons in the human brain that are connected to each other, and these connections in the learning process change their conductance, their weights.  Therefore, from a programmatic point of view, we obtain such a construction, in which there is a certain number of inputs, each of which may have some numerical value.  Then there are some intermediate layers, where, for example, we take the signal from this previous layer, from the input and sum up with certain weight coefficients.  Here we get some number, then we summarize from the next layer of the input and as a result we get some kind of output. </p><br><p>  For example, for the recognition problem on a cat or dog photo.  What do we give to the entrance?  At the entrance we submit a photo.  Each entrance - it will be a separate pixel of the photo, and the output will be two: either a cat or a dog.  And there will be a certain number of layers in the middle. </p><br><p>  And then what do we need to do?  Adjusting the weights so that this neural network gives the correct output for the input.  If we submit a picture at the beginning, it is obvious that it will produce some random numbers at the output.  If the coefficients there were random, then it will give a certain number.  And we say, "No, please, let's adjust the weights so that it looks more like a cat."  And for this we use some algorithms. </p><br><p>  There is an algorithm for back propagation of errors, which allows you to adjust the weight.  Next we show the following example - we adjust the weights again.  And so we do many, many times for a very large number of examples.  From the point of view of mathematics, very simple things happen here.  If we imagine that this layer of output of this layer is some vector, then, in essence, we multiply this input vector x by some matrix, then add some more shift and apply some non-linear function to it.  As a matter of fact, we do for each layer such multiplication of a matrix by a vector.  Everything is very simple. </p><br><p>  But why do we use a nonlinear function?  Partly to get a number in a certain range.  But there is a very killer argument.  If it were not there, it would all look just like a product of matrices, and the product of matrices is equivalent to any one matrix.  If we take the input vector, multiply by one matrix, then by another - it is as if we simply multiplied two matrices and then called the number for this product of matrices.  Therefore, if we didn‚Äôt add a nonlinear function, the number of layers would not affect, everything would be as one layer.  And so, by adding non-linearity, it becomes like a decomposition in a row.  And when this expansion in a series, we can approximate an arbitrary function.  And if this were not, we could approximate only convex linear manifolds.  Therefore, it is very important that we add a non-linear function.  In this case, nonlinear functions are also different. </p><br><p>  Previously, it was customary to do such beautiful non-linear functions, which are called "sigmoid", it has now become fashionable to make a non-linear function as a linear function.  That is, it is half linear: it is linear more than 0, and less than 0 it is 0. Why?  Because it turns out to be effective in implementation.  Its derivative is considered easy, although it is a poor derivative.  However, such functions are often used. </p><br><img src="https://habrastorage.org/webt/5_/ul/sf/5_ulsfjg63mfurxjnczmit1hhm8.png"><br><p>  How can we implement a neural network?  We can program it manually, this task is also not super complicated, but not very pleasant.  What else is important: since we want to teach all this on graphics processors, if you do it well, you need to go into learning graphic matrix multiplications on hardware - this is all already becoming difficult. </p><br><p>  Therefore, it usually uses some ready-made frameworks.  There is Google's TensorFlow, which is a major competitor and is generally used by everyone.  There are a few others. </p><br><img src="https://habrastorage.org/webt/p4/26/g0/p426g0tdlgerbg4mztrvsh_hgfg.png"><br><p>  Accord also has a neural network; we can lock a neural network here by simply taking and changing this algorithm.  Everything will be a little different. </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> nn = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActivationNetwork(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SigmoidFunction(<span class="hljs-number"><span class="hljs-number">0.1</span></span>), <span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> learn = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BackPropagationLearning(nn); nn.Randomize(); WriteLine(<span class="hljs-string"><span class="hljs-string">"StartingLearning"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ep=<span class="hljs-number"><span class="hljs-number">0</span></span>; ep&lt;<span class="hljs-number"><span class="hljs-number">50</span></span>, ep++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> err = learn.RunEpoch((<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> train <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> x.Image.Select(t=&gt;(<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)t/<span class="hljs-number"><span class="hljs-number">256.0</span></span>).toArray(), (<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> train <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> x.Label.ToOneHot10(<span class="hljs-number"><span class="hljs-number">10</span></span>).ToDoubleArray()).toArray() ) WriteLine(<span class="hljs-string"><span class="hljs-string">$"Epoch=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{ep}</span></span></span><span class="hljs-string">, Error=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{err}</span></span></span><span class="hljs-string">"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count=<span class="hljs-number"><span class="hljs-number">0</span></span>, correct=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> test) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = nn.Compute(v.Image.Select(t=&gt;(<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)t/<span class="hljs-number"><span class="hljs-number">256.0</span></span>).toArray()); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> z = n.MaxIndex(); WriteLine(<span class="hljs-string"><span class="hljs-string">"{0} =&gt; {1}"</span></span>), z, v.Label); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (z == v.Label) correct++; count++; } WriteLine(<span class="hljs-string"><span class="hljs-string">"Done, {0} of {1} correct ({2}%)"</span></span>, correct, count, (<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)count * <span class="hljs-number"><span class="hljs-number">100</span></span>);</code> </pre> <br><p>  There is such a problem with a neural network: when we do it, it does not always work very well, because there are different learning parameters.  In this case, this is the width of this Activation Function itself.  It‚Äôs not very good that we did from 0 to 1, maybe it would be better to do from -1 to 1 so that it was in the negative zone.  If we used, for example, a nonlinear function, but a semilinear one, then it is precisely important for us that it be in the negative zone.  There are different subtleties.  And the first attempt is not always successful. </p><br><p>  At each stage of training, I type an error that remains.  It brings the output closer to what is needed, but at the same time there is still some kind of mistake, and the learning process decreases all the time.  However, sometimes it starts to increase - this is a sure sign that something has probably gone wrong, and it is already worth stopping training.  There is also the problem of retraining, when the network is retrained, it starts to predict worse. </p><br><p>  For example, we run a test of the above code, and we get 88.3%.  This is not very good, but not very bad. </p><br><p>  But until we see that the neural networks are much better than what was. </p><br><p>  However, in Accord you can learn neural networks, but you don‚Äôt need to, because there are specialized frameworks that are better. </p><br><p>  Our Microsoft Cognitive Toolkit, what is it beautiful about?  It can be used on the GPU, on clusters of computers on the GPU - in all possible cases.  In addition, it is open source, rapidly and actively developing.  It is so actively developing that, for example, until September it did not allow to train neural networks on .NET, and now it already allows. </p><br><img src="https://habrastorage.org/webt/do/2n/9q/do2n9qy4oxaql1hbpvrejkbebuw.png"><br><p>  Initially, he had two training modes: you could describe the network architecture in a special language called BrainScript, and feed the original data and this Script utility on the command line and say: ‚ÄúPlease teach me a neural network.‚Äù  It all happened on the command line, and then the model file was recorded, which could be taken and used from some of my C # project, Python, on anything. </p><br><p>  But then, as if obeying the dictates of fashion, transferred the learning process in Python.  In fact, this is not so bad, because everything is more flexible, you can create various clever network architectures, you do not need to learn the new language BrainScript.  But until September 2017, the main mode of using CNTK was: taught in Python, and you can use it with .NET. </p><br><p>  But we always, when we are doing some project and we want the customer to show the result, we wrap the neural network in a bot.  Then take a picture of the picture, and the network gives the result.  A bot is written in C #, it is easy to embed neural network calculations into it, and learning has always been in Python and in a virtual machine in the cloud. </p><br><img src="https://habrastorage.org/webt/l8/rh/0w/l8rh0wlkjf_s2tysxnhio6zuiz4.png"><br><p>  If you want to experiment with the cloud, there are ready-made machines in the cloud called Data Science Virtual Machine.  When you create it, it turns out the machine on which all the necessary software is installed, mainly in Python. </p><br><img src="https://habrastorage.org/webt/tc/g3/bm/tcg3bmombyrg425cziouyombv0w.png"><br><p>  I will repeat a little bit: before, the basic learning mode was this: either we use BrainScript, or we learn the neural network in Python, we get the file and then use it from .NET.  And all this works on top of a certain library in C ++.  Both that, and another: both training, and calculation. </p><br><p>  In September, special APIs were added to support learning.  Why is this possible?  Why are there no such competitors? </p><br><img src="https://habrastorage.org/webt/16/d-/rb/16d-rbvss_67ghr9eghvf4ckkda.png"><br><p>    ,   CNTK:       ?           ,   ,          .    ,   ,   .      ,   ,    ,    . </p><br><p>   CNTK   ,    -   .  ,    :     .   , ,     ,        , , .        -  . ,    :       ,       -,      ,        ,  -  .             ,      transformations,      -  . </p><br><p>       CNTK.      ‚Äî   ,          .  ,    ,   ,    .     ,   ,  ,  ,   ,    .      . </p><br><p>   CNTK   API  ,      .    ,       ,  : ¬´ -  , -, - ¬ª.  Layers API. </p><br><p>     CNTK,    C++,     API  Python   .NET. </p><br><p>   ?    TensorFlow. TensorFlow       C++, , ,   .       Python. ,   ,       ,     .   TensorFlow      .NET.  ,     TensorFlow  C#,   . </p><br><p>            Keras.  TensorFlow,    ,      ,  Keras   ,   CNTK  Layer API.             . </p><br><p>   Keras    , CNTK    .        Keras,       CNTK  TensorFlow,     -  . </p><br><img src="https://habrastorage.org/webt/ig/nj/pm/ignjpmd_9rim7ylkyi7xpu6u7mq.png"><br><p>   ,     CNTK       . </p><br><p>        ,    .    ?      ,   float,     256     ‚Äî   ,       0  1. </p><br><pre> <code class="hljs kotlin">#r <span class="hljs-string"><span class="hljs-string">"SciSharp.dll"</span></span> using SciSharp; using static System.Console; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Digit</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> float[] Image; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int Label; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fn = @<span class="hljs-string"><span class="hljs-string">"train.csv"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = File.ReadLines(fn); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = from z <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f.Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>) let zz = z.Split(<span class="hljs-string"><span class="hljs-string">','</span></span>).Select(int.Parse) select new Digit { Label = zz.First(), Image = zz.Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>).Select(x=&gt;x/<span class="hljs-number"><span class="hljs-number">256f</span></span>).toArray(); }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> train = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.Take(<span class="hljs-number"><span class="hljs-number">10000</span></span>).toArray(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> test = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.Skip(<span class="hljs-number"><span class="hljs-number">10000</span></span>).Take(<span class="hljs-number"><span class="hljs-number">1000</span></span>).toArray();</code> </pre><br><p>    ,     CNTK?       . </p><br><pre> <code class="hljs cs">DeviceDescriptor device = DeviceDescriptor.CPUDevice; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> inputDim = <span class="hljs-number"><span class="hljs-number">784</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> outputDim = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputShape = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NDShape(<span class="hljs-number"><span class="hljs-number">1</span></span>, inputDim); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> outputShape = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NDShape(<span class="hljs-number"><span class="hljs-number">1</span></span>, outputDim);</code> </pre> <br><p> -,  ,      CPU.   ,      784 ‚Äî  28  28,    ‚Äî 10, 10 .    Shape. Shape ‚Äî    .       NDShape   .    . </p><br><pre> <code class="hljs pgsql">Variable features = Variable.InputVariable(inputShape, DataType.Float); Variable label = Variable.InputVariable(outputShape, DataType.Float); var W = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Parameter(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span>[] { outputDim, inputDim }, DataType.Float, <span class="hljs-number"><span class="hljs-number">1</span></span>, device, "w"} ); var b = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Parameter(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span>[] { outputDim }, DataType.Float, <span class="hljs-number"><span class="hljs-number">1</span></span>, device, "b"} ) var z = CNTKLib.Times(W, features) + b;</code> </pre> <br><p>    ?        .     ?    ,    ,    . ,       Variables,  .     variable,   features ‚Äî   ,    768,   ,   lable,    10.    .    . ,    ,   ,       ,   . </p><br><p> ,    ‚Äî W ‚Äî     10  768.      10,   outputDim.      .   ,   ,  ‚Äî Z,   W    + b.        .  Everything. </p><br><p>   : ¬´ ,         - , ,  ¬ª. </p><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> loss = CNTLib.CrossEntropyWithSoftmax(z, <span class="hljs-keyword"><span class="hljs-keyword">label</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> evalError = CNTKLib.ClassificationError(z, <span class="hljs-keyword"><span class="hljs-keyword">label</span></span>);</code> </pre> <br><p> ,      CrossEntropyWithSoftmax,    ,   .  . </p><br><p>      ,     .   <a href="https://youtu.be/E4mP1slv4oI%3Ft%3D50m19s">   </a> ).   Learner,        Trainer. Trainer      ,   Learner,     60   : ¬´Trainer.Train¬ª. </p><br><p>     . </p><br><img src="https://habrastorage.org/webt/mx/sy/t4/mxsyt4egrikomtalkn9-srfmaz8.png"><br><p>  :       ?      ,    ,    ,       ,       .     Python?   .    Python - ,  .       Python,   C# ‚Äî   . </p><br><img src="https://habrastorage.org/webt/-r/0v/cz/-r0vczd1cdvjkwweplelz8gq6-w.png"><br><p>   .   ?    .        ?         1500,   - .   ,     .     ,      .     94% . </p><br><img src="https://habrastorage.org/webt/on/78/hl/on78hlfhcd4xwm-wyfqahzfuni4.png"><br><p>       .  , , ,         ?   ‚Äî     ?      ,      . </p><br><img src="https://habrastorage.org/webt/d2/l6/0s/d2l60smcuk0m8l1jioczkqjzhgg.png"><br><p>       ,   ¬´ ¬ª.   ?    ,          . ,      ,       .        ,            ,   .      .    ,  ,    ,        ,    .    .   ,        ,      .     ,     98%. </p><br><img src="https://habrastorage.org/webt/gr/c8/ct/grc8ctfab4o1a_mqdj2iwhiixos.png"><br><p>     - . </p><br><img src="https://habrastorage.org/webt/nf/2l/ct/nf2lctyb8glp2jvqxrtqxkrw1w4.png"><br><p>      ,     .    Convolution.           28  28  1 ‚Äî      28  28    ‚Äî   14  14  4.     4 ,     -  ,       ,      ,    .      ,   14  14  4  7  7  8.        . </p><br><img src="https://habrastorage.org/webt/lk/nn/ye/lknnye7kpvrfvwu4p97zukynqzq.png"><br><p>   -  .       ,     5    .  : ¬´  ,   , ,      ?¬ª  : ¬´ ,   20 ,  ¬ª.    ,   .         ,     : ¬´   !    - !¬ª   ,    ,     . </p><br><p>       ,       ,      ,      ,    .   ,       ,    .   ,        ,    ,    ,    500-1500 ,   .  , , ,   ,     ,     ‚Äî   .  ,   ,   .   ,  . </p><br><img src="https://habrastorage.org/webt/re/85/yj/re85yjpaog8ywuokjpua6kusmfo.png"><br><p>   C#,  ,     (  Python),    ‚Äî     6 .  3  ,    5  5 ‚Äî         32  32 .   . 3    3  . </p><br><p>  Python        ,    ,      50,  75. , , ,    .  0,8 ,  0,4 ,  0,65 .    ,       3-4 ,   . </p><br><h1 id="chto-smotret-dalshe">   ? </h1><br><p>   : </p><br><ul><li><a href="http://aka.ms/neuroworkshop"></a> <a href="http://aka.ms/neuroworkshop">http://aka.ms/neuroworkshop</a> </li><li><a href="http://github.com/shwars/neuroworkshop"></a> <a href="http://github.com/shwars/neuroworkshop">http://github.com/shwars/neuroworkshop</a> </li></ul><br><p> F# API  CNTK: </p><br><ul><li><a href="http://github.com/mathias-brandewinder/CNTK.FSharp"></a> <a href="http://github.com/mathias-brandewinder/CNTK.FSharp">http://github.com/mathias-brandewinder/CNTK.FSharp</a> </li></ul><br><p>     ,     ,          .   ,       .   ‚Äî ,       .   4, -,  6.    ,  Notebook'  Python   ,   .     .     ,      Coursera  - . </p><br><p>   ‚Äî  ,    ,      - .  CNTK,  ,   ,      F#.   C#   ,   F#.   .     ,    .   GitHub   ,    .  ,   ,   ,     ‚Äî   2017      C#,     , ,       . </p><br><img src="https://habrastorage.org/webt/yj/lp/en/yjlpenvehjgyqttbl0fv-mwxu4y.png"><br><p> , , .   ?  .NET   ,        .     ,  Azure Notebooks,  C# Interactive,   Xamarin Workbooks ‚Äî , ,    .  ,      Microsoft    ‚Äî CNTK,      C#,            ,       .    ,    10-15  ,     . </p><br><blockquote>  Minute advertising.  As you probably know, we do conferences.  The nearest .NET conference - <a href="https://dotnext-piter.ru/">DotNext 2018 Piter</a> .  It will be held April 22-23, 2018 in St. Petersburg.  What reports are there - you can see in <a href="https://www.youtube.com/watch%3Fv%3DMpFEkVPbgiU%26amp%3Blist%3DPLtWrKx3nUGBeYn-pSCjEgBPL90SvpylZL">our archive on YouTube</a> .  At the conference, it will be possible to chat live with the speakers and the best experts on .NET in special discussion zones after each report.  In short, come in, we are waiting for you. </blockquote></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/352138/">https://habr.com/ru/post/352138/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352128/index.html">ES6: useful tips and non-obvious techniques</a></li>
<li><a href="../352130/index.html">What tools for teamwork make ordinary employees of the Dream Team?</a></li>
<li><a href="../352132/index.html">SOA: send a request to the server? What could be easier?</a></li>
<li><a href="../352134/index.html">Once again about JetBrains Open Day in Moscow</a></li>
<li><a href="../352136/index.html">As I was looking for the perfect tool for designing conversational interfaces, or Finding the Holy Grail</a></li>
<li><a href="../352144/index.html">How to speed up PostgreSQL 10</a></li>
<li><a href="../352146/index.html">IPv6 in every home: Your own IPv6 broker server (6in4)</a></li>
<li><a href="../352148/index.html">Hello, Rails</a></li>
<li><a href="../352150/index.html">Keys in React. Cook properly</a></li>
<li><a href="../352152/index.html">Paul Graham: how to share shares in a startup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>