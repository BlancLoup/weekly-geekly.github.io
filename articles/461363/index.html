<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kettle and voice assistants. The beginning of a great friendship</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What do we have at a given time in the GA world? Known fact: each of the large IT companies has its own tool for working with smart homes. And each ve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Kettle and voice assistants. The beginning of a great friendship</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/lk/a3/rh/lka3rhuphajcjx25rj3w-eqv_1g.png"><br><br>  What do we have at a given time in the <abbr title="Voice assistant">GA</abbr> world?  Known fact: each of the large IT companies has its own tool for working with smart homes.  And each vendor provides its own API for those interested in integration.  And at the initial stage, it even pays developers for new skills (actions, skills, etc. - in accordance with the vendor's terminology). <br><br>  The most convenient and practical service to date, according to our experts, is Amazon Alexa.  She has more opportunities for detailed skill formation than Google Assistant, Yandex "Alice", Mail.Ru "Maroussia", Tinkoff "Oleg" and others.  For Alexa, a device is a parametric virtual entity, as a result of which skills can be customized for each device individually.  For example, in addition to water temperature, you can specify consumables that the assistant will offer to buy on Amazon.  But, unfortunately, Alexa does not currently support the Russian language and does not work on the territory of the Russian Federation, so this GA is useless for a Russian user.  At Google and Yandex, the assistant is more ‚Äúnatural‚Äù - it receives and responds to commands in the ‚Äúhuman‚Äù language, can conduct a dialogue with the user, which makes this GA more pleasant to use.  The only serious drawback of Google was that its Actions did not support the Russian language.  However, from July 24, 2019, Google Actions have been working in ‚Äúphones‚Äù in Russian, so colleagues have eliminated this drawback. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is all right.  And if we want to integrate one device with several GA? <br><a name="habracut"></a><br>  It's possible.  Using the device. <br><br>  A device is an entity with its behavior in the system.  This is a common principle for all vendors.  And here it is worth stopping, here all the fun begins.  The differences are in the approaches.  For example, Google and Yandex are trying to standardize the management of technology.  That is, now it is necessary to write code not for each individual device, but one program for the entire series is enough.  And even if the firmware changes, you will have to change the code once, which is very convenient.  Our company already has integration with Google, Yandex, Amazon.  Technique <a href="https://readyforsky.com/ru/blog/umnoy-tekhnikoy-s-tekhnologiey-ready-for-sky-teper-mozhno-upravlyat-s-pomoshchyu-golosovykh-komand/">listens to Alice</a> , Alex and Google Assistant.  Earlier we showed <a href="https://habr.com/ru/company/readyforsky/blog/434806/">that inside voice assistants</a> . <br><br><h3>  <b>Where did the voice assistants come from?</b> </h3><br>  One of the most advanced speech recognition systems in the world belongs to Google, its history began back in 2002.  The company released Voice Search, on the basis of which the Google Assistant was developed.  In 2016, he was presented at the presentation of Google I / O.  Google Home is one of the 'surfaces' for the Google Assistant.  Now the accuracy of speech recognition of their GA is estimated at 95% and almost inferior to people. <br><br>  Alexa's voice assistant was introduced by Amazon in 2014. The Amazon Echo smart column, which can control a large number of devices within a smart home, was also presented there. <br><br>  Yandex SpeechKit - Yandex speech recognition system.  It is used in 400+ applications.  The company also embeds its GA - Alice - in browsers and electronic devices.  The Russian company introduced its GA in 2017, and already in the fall of 2018, Yandex launched its Yandex.Station smart column. <br><br><h3>  <b>Our experts say that by the hundred and fifty-sixth year ...</b> </h3><br>  We are joking, so far only by 2020.  A bit about statistics: <br><br><ol><li>  In 2017, approximately 33 million voice-controlled devices were registered worldwide; </li><li>  Western experts called voice search one of the <a href="https://alamedaim.com/seo-trends/">top 3 SEO trends in 2017</a> ; </li><li>  For 2018, Google Assistant works on 400 million devices worldwide.  And this figure is only growing; </li><li>  According to the <a href="https://blog.globalwebindex.net/chart-of-the-day/25-of-16-24s-use-voice-search-on-mobile/">Global Web Index</a> , 25% of people aged 16 to 24 use voice search from mobile devices; </li><li>  According to forecasts by <a href="https://www.campaignlive.co.uk/article/just-say-it-future-search-voice-personal-digital-assistants/1392459">Comscore</a> , by 2020, 50% of requests will be made by voice; </li><li>  According to 2018 <a href="https://www.walkersands.com/resources/the-future-of-retail-2018/">research by WalkerSands</a> , every fifth user of a smart speaker from Amazon bought with it, and a third planned to do it next year; </li><li>  According to a <a href="https://www.pwc.com/us/en/advisory-services/publications/consumer-intelligence-series/pwc-voice-assistants.pdf">PWC study</a> , 71% of users who search the web would prefer to type in voices rather than manually. </li></ol><br>  As you can understand, the tendency to use GA is increasing, which suggests that it is time to take a vendor and launch your own assistant.  For us, the key to it is the ability to control smart devices, which will distinguish SkyFriend from other assistants. <br><br><h3>  <b>And let's integrate!</b> </h3><br>  BUT also our task is to work with the existing vendor approach and further adapt it to our specific technology control protocol.  We follow the path of standardization, practical application, perceiving the device as a set of skills: each kettle can boil water (skill), also it can heat it to the desired temperature (skill), maintain this temperature for a given time, etc. For example, ‚ÄúOn / Off‚Äù command is standard for any device.  The task is to transfer this command from the service to our protocol.  What is the peculiarity of our protocol?  It connects different voice assistants (now three, in the future - all large ones) and allows them all to work with devices, including at the same time.  Communication is one to many.  The only question is how exactly will we adapt our protocol to all approaches? <br><br>  We'll see.  Separate projects for each GA are: <br><br><ul><li>  Increased staff </li><li>  A lot of code and legacy in the future; </li><li>  Inability to scale. </li></ul><br>  When new assistants appear on the market, it will be necessary to proportionally increase the staff and volume of work.  It is logical that we refused this option.  However, despite the different approaches for each voice assistant, they can find something in common - what they basically work with is skill, trait, skill.  The names are different, but the essence is the same.  So, the task is to develop your ‚Äúskill‚Äù, which will be perceived by assistants.  In the future, you will only need to add new vendors, which solves the issue of scaling.  We will also keep in mind that a significant amount of our equipment uses BLE vehicles, which dictates architectural features. <br><br>  We have developed two microservices that work in pairs. <br><br><img src="https://habrastorage.org/webt/zw/lo/zf/zwlozfjr3y51a2mc_rqpemr-biq.png"><br><br>  The first is the command layer.  Its task: to carry out conversion (mapping) between the vendor API and our protocol.  It works like this: a specific request for an assistant is mapping for our skill - mapping for a device protocol.  With this approach, it is easy to add new skills: mapping is performed for the final R4S protocol - the code is transferred to the second service.  The last item may be excluded when transmitting a command over Wi-Fi. <br><br>  The second service or transport layer is used for: <br><br><ol><li>  Establishing a session with a client gateway; </li><li>  Raising and maintaining a Bluetooth connection; </li><li>  Reception / transmission of commands from the first service. </li></ol><br>  This service is part of a higher level entity: BT-device plus gateway-intermediary, working on the principle: receiving commands via the Internet - sending via BT.  Wireless connections may be unreliable.  Why?  The radio channel can be limited by environmental parameters - thick concrete walls, etc. ... As a result, the devices can "fall off" in an elementary way, therefore maintaining a stable connection becomes an important task for the transport layer. <br><br><img src="https://habrastorage.org/webt/fq/ui/ti/fquiti2wm64hfky4de4zy7hd9qe.jpeg"><br><br>  Connection policy can be different: <br><br>  1. Continuous communication support. <br><br>  <b>Pros</b> : minimum delay in executing GA commands. <br>  <b>Cons</b> : expensive for traffic and power consumption;  there is a limit on the number of simultaneously connected devices (in this generation Bluetooth 4.0 / 4.2 - six, in Bluetooth 5.0 up to twenty).  It will also require additional server resources. <br><br>  2. Connection on demand. <br><br>  <b>Pros</b> : connecting almost does not require traffic and charge. <br>  <b>Cons</b> : a high delay in the execution of commands plus the execution itself is not guaranteed (the connection may "fall off" or be unsuccessful).  With this approach, we do not fit while waiting for the GA to answer.  The session ended and the end. <br><br>  The question also remains - the command is received and worked out, BUT what to do with the connection further: disconnect or keep on.  Note that Apple HomeKit works exactly the same way when working with BLE terminal devices (via Apple TV or iPad as a gateway).  It looks like this - the first time you try to send a command, the process takes quite a long time (or better, noticeable to the user), but subsequent commands are executed almost instantly.  After the user‚Äôs work with the device is completed, the operating system ‚Äúsets up‚Äù the session after a reasonable amount of time, and then the process is repeated as new. <br><br><h3>  <b>However, that is not all.</b> </h3><br>  <b>Difficulty 1</b> .  Gateway routing. <br><br><img src="https://habrastorage.org/webt/dp/tp/s9/dptps9c65buopbiskgfiki3bhpi.png"><br><br>  If there are several gateways in the room, the question arises - which one to connect to, and which gateway to which device is connected.  Now everything works according to the principle - whoever succeeds is connected.  Implementation is not always successful, since the nearest (and therefore capable of more reliable connection) gateway may be busy in the used time slot.  Then the one who is free and capable is connected.  This happens without regard to the quality of communication.  Therefore, it is important to build a hierarchy and a scheme of work so that the user is as comfortable as possible. <br><br>  <b>Difficulty 2</b> .  Lots of users. <br><br>  This is a situation where multiple users can use one gateway or device at the same time.  Of course with a high level of security.  For example, from different GAs or from GAs and user phones.  A swarm of questions: which device to turn on first if GA commands contradict each other, which command is a priority and must be executed earlier, etc. Partially our problem is solved by the Redis service - a database in which user sessions, device statuses and transceiver are stored commands and serving data bus between the first and second services.  But this is where the solution to the problem stops. <br><br>  What have we done?  We made SkyFriend.  This is our own development, a voice assistant for technology management, which will also support the Russian language.  A key feature of our GA is that it is designed for direct interaction with smart Ready for Sky technology without additional instruments.  The device is two in one - the assistant is combined with the gateway, which will receive information either through the commands that the user sends from his smartphone, or directly by voice.  Plus SkyFriend has additional features that will allow it to compete with those that already exist.  He can turn on reminders upon request, he can determine the user's geolocation, search for information on Wikipedia, recommend films, make toasts, read news, answer questions, tell the time and weather in any city in the world, play ‚ÄúRiddles‚Äù and ‚ÄúCities‚Äù with the user , make jokes.  Buying tickets and ordering a taxi is still at the alpha test stage.  And this is only part of the functionality. <br><br>  More recently, Google announced the work of its column on a similar architecture - the execution script is loaded directly into the Google Home column.  Winning on the side of the user is to reduce the time it takes to execute instructions.  You do not need to send it to the server of the manufacturer of the equipment; it flies directly to the column from the Google server through the same communication channel and is executed there. <br><br>  However, Google still does not support other transports - Bluetooth, ZigBe, Z-Wave, RF, etc.  directly on the column, and SkyFriend supports Bluetooth 5.0. <br><br>  What else do we have left?  Work with system resources - add memory, processor power, etc.  And we are ready to offer users a new GA quality. <br><br><h3>  What can we say in conclusion? </h3><br>  GA is a trend, it‚Äôs convenient, it‚Äôs practical.  The topic is new, comprehensive, it has many issues that are still difficult to solve.  Especially alone.  Therefore, we invite you to a discussion. <br><br>  What will happen next?  And then there will be our new article on SkyFriend architecture.  We will tell and show everything.  But then. <br><br>  PS Suggestions and reviews can be left in the comments. </div><p>Source: <a href="https://habr.com/ru/post/461363/">https://habr.com/ru/post/461363/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461351/index.html">Kaleidoscope as in childhood</a></li>
<li><a href="../461353/index.html">4 business rules of David Jan</a></li>
<li><a href="../461355/index.html">DIY digital business transformation</a></li>
<li><a href="../461359/index.html">Geo-location and geolocation: mega-tool</a></li>
<li><a href="../461361/index.html">Bigger and more powerful: how we ensured the operation of new equipment in MediaTek data center</a></li>
<li><a href="../461365/index.html">Mastering Computer Vision - 8 Basic Steps</a></li>
<li><a href="../461367/index.html">How a graduate of Fiztekh opened the largest programming school in Armenia</a></li>
<li><a href="../46137/index.html">Program and questions. Linux teacher training</a></li>
<li><a href="../461373/index.html">GoLand 2019.2: support for function calls during debugging, improved color schemes, custom Postfix Completion</a></li>
<li><a href="../461379/index.html">Museum DataArt. US Robotics Modems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>