<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implementing multilingualism on Laravel 5 by the framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, I decided to take a closer look at the increasingly popular Laravel framework, the benefit of the documentation and articles on it is...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implementing multilingualism on Laravel 5 by the framework</h1><div class="post__text post__text-html js-mediator-article">  Not so long ago, I decided to take a closer look at the increasingly popular Laravel framework, the benefit of the documentation and articles on it is enough.  But what kind of training without practice?  It was decided to transfer to it a rather simple, self-written site, which quietly hung on the hosting itself and did not bring trouble. <br><br>  One of the features of the site was the switching of the interface language, implemented by the yaml dictionary file and a simple parser.  To transfer it to the logic of the framework was a matter of mechanical rather than creative, but getting it to remember the chosen language turned out to be a little more difficult.  Below I present my version of the implementation of this task. <br><a name="habracut"></a><br><h4>  Configuring Application Configuration </h4><br>  First you need to specify the desired locale and add an array of languages ‚Äã‚Äãwe use in config / app.php <br><pre><code class="php hljs"><span class="hljs-string"><span class="hljs-string">'locale'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'ru'</span></span>, <span class="hljs-comment"><span class="hljs-comment">#      'locales' =&gt; ['ru', 'en'], # ,      . #     .</span></span></code> </pre> <br><h4>  Create dictionaries </h4><br>  Dictionaries in Laravel are just php arrays.  How to create them is well described in the <a href="http://laravel.com/docs/5.1/localization">documentation</a> .  We need a dictionary for each language used in the application.  We create in resources / lang a folder for each language (I have only two, en and ru) and in each folder we create our own dictionary, for example, messages.php.  I don‚Äôt need to explain how to use them in templates. <br><br><h4>  Create Middleware </h4><br>  By default, Laravel is always loaded with the language selected in the configuration.  To change it, we need to intercept the request before it receives the view and set the language using the App :: setLocale (); method.  Middleware is such a piece of code that will be executed every time a user requests a page and allows us to do it.  In it, we will check which language the user has already selected (we specify it in the user‚Äôs session) if he has already visited our site, and if there is no one, add the default language to the session (for example, ru). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the same time, we will verify that the language selected by the user is valid (for this we have indicated the available languages ‚Äã‚Äãin the configuration earlier). <br><br>  Using the console and artisan we create middleware for our switch.  Let's call it, for example, Locale. <br><br><pre> <code class="bash hljs">php artisan make:middleware Locale</code> </pre><br>  And we write our code to the handle method.  Here the variables specified in the config will be useful. <br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($request, Closure $next)</span></span></span><span class="hljs-function"> </span></span>{ $raw_locale = Session::get(<span class="hljs-string"><span class="hljs-string">'locale'</span></span>); <span class="hljs-comment"><span class="hljs-comment">#       , #        . if (in_array($raw_locale, Config::get('app.locales'))) { # ,         $locale = $raw_locale; # (  - ) } #     $locale. else $locale = Config::get('app.locale'); #         App::setLocale($locale); #    return $next($request); #      }</span></span></code> </pre><br>  Do not forget to add to the beginning of the file <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Config</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Session</span></span>;</code> </pre><br><br><h4>  We register our Middleware </h4><br>  In the app / Http / Kernel.php file, we add the StartSession middleware (for initializing the session, thanks to <a href="https://habr.com/users/hovdev/" class="user_link">hovdev</a> for the hint) and our middleware to the end of the array so that it <a href="https://habr.com/users/hovdev/" class="user_link">runs</a> every time the application is loaded. <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $middleware = [ ... \Illuminate\Session\Middleware\StartSession::class, \App\Http\Middleware\Locale::class, ];</code> </pre><br><h4>  Create a route to switch language </h4><br>  Register the path by which we will switch the language in the user session.  For this purpose, I chose a link like mysite / setlocale / en.  When you click on it, we change the value of lang (previously installed by our middleware) to the one indicated at the end of the link.  Along the way, we check that the selected language is valid by a familiar method and redirect the user to the same page from which the script was called. <br><br><pre> <code class="php hljs">Route::get(<span class="hljs-string"><span class="hljs-string">'setlocale/{locale}'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($locale)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (in_array($locale, \Config::get(<span class="hljs-string"><span class="hljs-string">'app.locales'</span></span>))) { <span class="hljs-comment"><span class="hljs-comment"># ,       Session::put('locale', $locale); #        locale } return redirect()-&gt;back(); #   &lt;s&gt;&lt;/s&gt;     });</span></span></code> </pre><br>  That's all. </div><p>Source: <a href="https://habr.com/ru/post/264435/">https://habr.com/ru/post/264435/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264425/index.html">CometQL - api of work from comets server using MySQL protocol</a></li>
<li><a href="../264427/index.html">Limited offer: a cloud server in the Netherlands and the United States at the price of hosting, cheaper ip-address</a></li>
<li><a href="../264429/index.html">Destroy everything</a></li>
<li><a href="../264431/index.html">Embarcadero Announces Purchase of Raize Components</a></li>
<li><a href="../264433/index.html">Natural genetic algorithm or evidence of the evolution of living organisms in C ++</a></li>
<li><a href="../264437/index.html">The digest of interesting materials from the world of web development and IT for the last week? 171 (August 3 - 10, 2015)</a></li>
<li><a href="../264439/index.html">PAP - old, but not useless !?</a></li>
<li><a href="../264441/index.html">ARM programming on Pascal</a></li>
<li><a href="../264443/index.html">Parsing a Word document to pictures or a story about pre-diploma weekdays</a></li>
<li><a href="../264445/index.html">How does ecology affect data center cooling</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>