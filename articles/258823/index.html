<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How Yandex built a data center from scratch</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This spring we received permission to operate our new data center. The first, for whom everything, even the building, was designed and built by the Ya...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How Yandex built a data center from scratch</h1><div class="post__text post__text-html js-mediator-article">  This spring we received permission to operate our new data center.  The first, for whom everything, even the building, was designed and built by the Yandex team from scratch.  For the 18 years that people have been searching on the Internet by Yandex, we have come a long way from the server under the table of one of our developers to building a data center, where we use our own equipment.  On the way, we had several data centers in Russia, into which we rebuilt the factories and workshops that had once stopped their work. <br><br> <a href="http://habrahabr.ru/company/yandex/blog/258823/"><img src="https://habrastorage.org/getpro/habr/post_images/6c7/035/485/6c703548558e1d02f7d77bafa57f7e15.jpg"></a> <br><br>  When we chose a place where you can build a data center from scratch, the cold climate was one of the most important factors.  But it was in the course of this construction that we found a technological solution that allows us to operate the DC in a warmer climate.  Now we are planning to build our next data center in the Vladimir region.  And now we have all the opportunities to create a data center in Russia, which will become one of the most advanced in the world. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this post we want to tell how we designed the DC, what difficulties our team encountered during the construction process, how the commissioning proceeded, what are the features of Yandex data centers, and how heat recovery, which you could already hear, was arranged. <br><a name="habracut"></a><br><h3>  Need </h3><br>  As we <a href="http://habrahabr.ru/company/yandex/blog/243033/">have already said</a> , the architecture of the company's services allows organizing redundancy at the level of data centers, rather than subsystems, which gives greater flexibility in choosing solutions and reduces the redundancy of systems and associated costs. <br><br>  The data center and server architecture are designed as a single system, therefore, the operating parameters of engineering systems may differ from conventional ones - in particular, alternative uninterruptible power supplies can be used and the cumbersome cooling solutions can be abandoned due to the expansion of the allowable temperature range.  All this leads to increased efficiency and lower total cost of ownership of infrastructure. <br><br>  One of the metrics of data center efficiency is <a href="http://en.wikipedia.org/wiki/Power_usage_effectiveness">PUE</a> .  However, speaking of our DC, we are not going to put it at the forefront.  First, we have no reason to measure PUE with our colleagues, and second, the existing differences in the method of measuring this parameter do not allow a comparison even between our own DCs. <br><br>  However, the very essence of the PUE parameter is extremely important for Yandex.  Commercial data centers can afford not to skimp on construction and equipment, knowing that in the end the client will pay for everything.  In our case, we are our own client, so the low total cost of ownership of DC (TCO) is perhaps the most important criterion when choosing solutions in a company. <br><br>  And of course, our team wants not only to increase the area for the installation of new racks, but also to feel professional pride in what we are doing. <br><br><h3>  Idea </h3><br>  Prior to the design of the Finnish data center, we managed to build (and partially close) 10 data centers.  During the construction of the next DC, each time we tried to use the most interesting solutions that appeared on the market at that moment.  This led to a wide variety of implementations, but now it allows us to choose the best solutions not on the basis of advertising catalogs, but using the experience gained in the company and the results of our own experiments. <br><br>  The basic idea behind the Finnish DC project is simple: it is the use of direct free cooling 100% of the time.  Direct freecooling (server cooling with outside air) makes it possible to abandon the use of not only heat exchangers with chilled water or other suitable coolant, but also simpler devices, like <a href="http://en.wikipedia.org/wiki/Thermal_wheel">the Kyoto wheel</a> , which stands in one of our DCs.  In the new data center, we take the air from the street, run it through the servers and release it on the street, simultaneously selecting a part for mixing in the cold season.  Our server hardware today is quietly working not only in the range of 20-24 degrees, which was recently the very ‚ÄúASHRAE window‚Äù, but also at higher and lower temperatures.  Therefore, there is no need to install capricious and expensive cooling systems, you can simply choose a region in which the average annual temperature is lower and spray water on the hottest days to lower the intake air temperature by a few degrees ‚Äî this is called <a href="https://en.wikipedia.org/wiki/Adiabatic_process">adiabatic</a> cooling. <br><br><img src="https://habrastorage.org/files/677/153/529/67715352981945ab98341b4b431bee0a.jpeg"><br>  <i>Adiabatic chamber and drift eliminators behind it</i> <br><br>  Those of you who have studied the design of DC, Facebook, which has been repeatedly published on the Internet, will find many analogies.  But we must immediately stipulate that this is only a coincidence.  When the concept of our DC was ready, we had a chance to visit one of the DC social networks, and we were surprised to learn that our colleagues had just implemented a project that was almost identical to ours. <br><br><img src="https://habrastorage.org/files/479/ffa/e64/479ffae64b1d4e9a919d5955ebbc1c0e.jpg"><br><br>  Of course, the specifics of Oregon and Finland influenced the differences, but the principle of blowing air from the street is so simple and obvious that there is nothing surprising in the similarity of concepts.  On the other hand, we noted with pleasure that in some ways our project will be even more interesting. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/0b7/cf7/986/0b7cf7986e6c4aaab23fa7d2e625a983.jpg"></div><br>  <i>Diesel generators and dynamic ups</i> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/228/4a0/78e/2284a078e1664abfbd17e0bdafd70ecb.jpeg"></div><br><br>  For example, a less complex adiabatic cooling system and the use of dynamic rotary UPS (DRIB) instead of a combination of diesel and classic battery UPS. <br><br><img src="https://habrastorage.org/files/f4b/527/c80/f4b527c801e2493ca10a95ff39ec72b9.jpg"><br><br>  As can be seen from the illustration, cold air enters from the street (on the right side of the picture) into the mixing chambers, from where, after filtration, the fan walls are forced through the humidification module down into the cold corridors. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/daf/119/6fd/daf1196fd1ac4e44aafd643a8f5e9cba.jpg"></div><br>  <i>First row of filters</i> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/85d/848/8d2/85d8488d24164139b3de6be49aa35e73.jpg"></div><br>  <i>Second row of filters and intake fans</i> <br><br>  From the hot corridors the air enters the space of the second floor, which plays the role of a kind of buffer, from where a part goes to the mixing chambers. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/141/1e0/5ad/1411e05adce84e0cae9820bd842bfec6.jpg"></div><br>  <i>The mixing chamber of external and exhaust air to achieve the optimum temperature</i> <br><br><img src="https://habrastorage.org/files/1d8/1f1/067/1d81f10670a24620960beb8762fa45da.png"><br><br>  Hot air that is not used in mixing by exhaust fans is discharged from the other side of the building. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/6f0/12b/c13/6f012bc133d54a3c8f09e194a8d9b367.jpg"></div><br>  <i>Inside the "hot corridor"</i> <br><br>  The solution is really very simple, but it involves the use of equipment that can operate at an appropriate temperature and humidity, which is difficult to achieve for commercial data centers. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/afb/ef2/463/afbef24631294513b29a836bf8478751.jpg"></div><br>  <i>Servers in work</i> <br><br>  As the first operating experience has shown, we still have considerable potential for improvement.  We realized that it is possible to simplify the constructive building, completely abandon the use of water in the DC and, finally, expand the geography of construction up to the central regions of Russia.  Thanks to this, we will be able to build our next data center in the Vladimir region, whose climate is much warmer than the Finnish one. <br><br><h3>  Why Finland? </h3><br>  This question is the second most popular question we have to answer.  The answer is so simple that it is even a bit awkward to talk about it. <br><br>  The fact is that the unofficial talisman of Yandex is an elk (‚ÄúOur elk!‚Äù).  There are two countries all over the world in which these animals are valued and cherished - Sweden and Finland.  But since Facebook has already been built in Sweden, we still have our northern neighbors.  From the whole country we chose a city, on the arms of which there was an elk.  So the die was cast, and we decided to build in M√§nts√§l√§. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/05b/32c/179/05b32c1798e33a0dbf4bd4861cbfefce.png"><br><br>  However, one moose is still not enough.  The most important criteria by which selection was made at that time were the available electrical power (Finland‚Äôs highly stable power grid was built many years ago for the pulp and paper mill, which are sensitive to the quality of the supply voltage), good accessibility of optical lines, engineers eager for work and, of course, the cold northern climate , in terms of which it was possible to abandon the chillers and honestly use your favorite free cooling. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ed2/3fc/153/ed23fc153f1240ca8c2dc2c56c0f8d19.jpeg"></div><br><br>  It should be noted that working with local partners was a real pleasure.  Thus, a construction permit is obtained within one month (sic!), And the road, water, heat and power lines arise on the borders of the site in an incredibly short time. <br><br>  In addition, we have implemented with the local authorities, so to speak, for the soul, a project for heat recovery.  Having installed heat exchangers in the place of exhaust hot air, we heat the coolant and transfer it to the urban heating system.  For the municipality to bring the water heated in this way with heat pumps to the required temperature turned out to be cheaper than building an additional boiler house for new districts of the city. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ff0/926/ab0/ff0926ab08ef4c56b80265f8428e6030.jpeg"></div><br>  <i>Actually heat exchangers</i> <br><br>  We presented this solution in March at <a href="http://en.wikipedia.org/wiki/CeBIT">CeBit</a> (this year combined with <a href="http://www.datacenterdynamics.com/">Datacenter Dynamics</a> ), and it attracted great attention - the subject of energy efficient technologies is very relevant today.  On May 27, M√§nts√§l√§ won the Best Heat Pump City in Europe prize. <br><br><h3>  Design </h3><br>  If you do not touch the content of the documentation, then already in the process of designing we faced with some interesting features of work in Finland. <br><br>  There is no such rigid formalization of the design and composition of documents to which we are used.  Speaking quite simply, the documentation specification should be exactly the same so that the contractor could get all the necessary information.  To some extent, facilitated communication with the licensing authorities, which expressed their approval, based on how they understood the document, without paying attention to the completeness and design. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/629/8dc/293/6298dc2932944ddcb0105d2c6fdcda44.jpeg"></div><br>  <i>Under the roof where air intake takes place</i> <br><br>  Some of the representatives of the authorities did not seek to express their personal opinion about the project.  The fire inspector, for example, was satisfied if the submitted package of documents contained a visa for a certified consulting company.  Such a signature meant for him that the project had already been verified and complied with all local regulations. <br><br>  On the other hand, the majority of small contractors refused to even estimate the cost of the work if the drawings did not state everything to the last screw.  Such an approach puzzled not only us, but also our partners from other countries.  As a result, many drawings contain much more information than we would expect to see. <br><br><img src="https://habrastorage.org/files/787/e94/2dd/787e942dd75043e5a1a7a1b4a3f30412.jpg"><br><br>  When implementing the project, we used a three-dimensional model of the building, in which all the equipment was placed, cable routes were carried out, etc. It took some time to get used to this tool, but then it was very convenient to work with the model - it was possible to quickly solve some problems with mixing systems that were not immediately obvious in a two-dimensional representation. <br><br><img src="https://habrastorage.org/files/0df/529/704/0df529704d2f438c877303a1b69e6fba.jpg"><br><br>  Also, our colleagues taught us to use the online project to collect comments on the project, so that one could be sure that the comments would not be lost and would be regularly viewed at project meetings. <br><br><h3>  Building </h3><br>  On the extraordinary adventures of Russian customers in Finland could write a separate large article.  But the main conclusion is simple: the success of such projects is determined by the ability to overcome differences in the mentality and culture of the participants.  And the greatest responsibility lies with us at the time of choosing a partner who can reconcile these differences.  There are a lot of examples.  The most amusing, perhaps, the following. <br><br><img src="https://habrastorage.org/files/e7a/6ed/9d5/e7a6ed9d549546d1851461539e53949e.jpg"><br>  <i>Start of construction</i> <br><br>  Finnish construction works from seven in the morning to three or four days.  Imagine our bewilderment when the Russian team, returning from dinner, sees a friendly crowd of builders who have already completed their work shift today.  The remaining half a day we see an almost deserted construction site, and against this background, the statements of the Finnish partners look a little strange, complaining that they have no time to meet the deadlines, although they are trying very hard. <br><br><img src="https://habrastorage.org/files/d5d/e48/851/d5de48851f5e42e698b409999a56fc6f.jpg"><br>  <i>Construction of steel structures</i> <br><br>  At the level of an ordinary worker, Finnish construction quality is not too different from what we are used to.  A significant increase in quality occurs when adding several levels of professional foremen, supervisors and managers.  And although the price of the ‚Äúmanagerial component‚Äù is a shock, the result is very good. <br><br>  And of course, it is impossible not to mention the legendary Finnish July, when the whole country quits work and begins to rest.  In some companies it makes no sense to even call - in the office there is not a single soul.  Since we are accustomed to consider these rare fine days as the ideal time to complete many construction works, this attitude on the part of contractors seemed to us like frank sabotage. <br><br><img src="https://habrastorage.org/files/899/c08/092/899c08092c7a4220bce3b7cccf8883ea.jpg"><br>  <i>The frame is ready</i> <br><br>  But the most important lesson of this construction was the realization that projects of this scale require a very special approach.  The way you organize a construction site has a disproportionately large effect on the outcome of the project than what you build.  We saw that in another country people work differently.  This does not mean that they are doing something bad - just different.  It seems that we managed to understand each other, and most importantly, we got an excellent result together. <br><br><h3>  Commissioning </h3><br>  Perhaps the main thing that distinguishes this project from all the previous ones is an understanding from the very beginning of the importance of a full-scale commissioning (NDP).  For high-quality commissioning of the object, and therefore, to minimize problems during operation, we still had a whole phase of the project called Commissioning during the design period.  Reluctantly, we gave Commissioning two months, knowing that the commissioning of a ready-made DC will be postponed to these two months, and at the same time realizing that it will pay off in the future.  Indeed, a number of flaws were found during the commissioning process.  Nothing serious, but they would have brought additional trouble to the maintenance service. <br><br>  Not only Russian, but also international experience shows that commissioning of a DC is still an unusual phenomenon.  At best, disparate suppliers bring individual test programs, and then the operation group, together with the general contractor, drives off five or six of the most critical situations, usually associated with starting diesel engines and switching inputs. <br><br>  A full description of the process deserves a separate story, so here we only mention that we have planned and carried out all five steps of the NDP with careful documentation of the results. <br><br>  Commissioning performed a specially trained team.  Formally, they were employees of the general contractor, but in fact acted independently, assessing the quality of work, including their colleagues.  The operation service already formed by that time also took a huge part in commissioning.  Naturally, representatives of the Moscow office were closely following the test results. <br><br>  This approach was relatively new to us.  We appreciated its capabilities and now we don‚Äôt even imagine how to start without it. <br><br><h3>  Exploitation </h3><br>  Interestingly, we started the recruitment and training of the maintenance service long before the installation of engineering systems.  This allowed us to spend more time searching for really good specialists, to partially attract them even for the design period: unfortunately, this led to a change in the project at the last moment, but it reduced the project‚Äôs isolation from the needs of living people who will spend this DC more than one year.  At some stages of commissioning, the operational service performed testing on its own under the supervision of the responsible party. <br><br><img src="https://habrastorage.org/files/4ef/5b9/9d5/4ef5b99d59354ea1a30f5314034884fe.jpg"><br>  <i>Entrance to the office</i> <br><br>  In Finland, much attention is paid to the issues of certification of specialists - it is simply illegal to perform certain types of work without proven qualifications.  The second serious moment is the observance of the norms of labor protection and ecology.  Therefore, in our team, the corresponding specialist appeared second in a row, and we could be sure that we would not violate strict legal norms even by accident.  Also, a significant time lag allowed us to carry out all the required training and certification even before the start of operation, that is, in general ‚Äúon the job‚Äù. <br><br><img src="https://habrastorage.org/files/fad/099/f01/fad099f01f02482897aa007a9c1e4a28.jpg"><br>  <i>Back side of the data center building</i> <br><br>  In general, I would like to note the great interest of future attendants in their work.  We are confident in the team that we scored, despite the fact that the data center, especially at this level, was seen by most of the guys for the first time. <br><br>  It should be noted that now the Department of Operation Yandex is becoming a truly international team.  This will not only allow the company to continue developing new teamwork skills, but will also oblige to raise the bar for an existing service. <br><br><h3>  What's next? </h3><br>  Next we have plans to expand the already built sites, as well as the construction of a new data center, which promises to be even more progressive.  Our goal is to make it one of the best in the world. </div><p>Source: <a href="https://habr.com/ru/post/258823/">https://habr.com/ru/post/258823/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258809/index.html">Hello, SaaS | Remote work 2</a></li>
<li><a href="../258811/index.html">New experimental C ++ operators</a></li>
<li><a href="../258815/index.html">Docker workflow</a></li>
<li><a href="../258817/index.html">Simulation of aircraft flap fault scenarios using Wolfram SystemModeler</a></li>
<li><a href="../258819/index.html">Fungi hunting is a suspicious hobby</a></li>
<li><a href="../258825/index.html">Œª-calculus and LISP</a></li>
<li><a href="../258827/index.html">Moving KodiCMS from the Kohana Framework to Laravel 5</a></li>
<li><a href="../258831/index.html">HP Helion Rack - a solution for the rapid deployment of a private cloud based on OpenStack</a></li>
<li><a href="../258833/index.html">Displaying the content of iOS applications in Google Search results and other good news</a></li>
<li><a href="../258841/index.html">Criteria for the quality of video analytics. Part 4</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>