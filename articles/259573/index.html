<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Whether it is necessary to move to a hosting in Russia, or Fault tolerance on 242-FZ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago, a Failover conference was held in Moscow, which was devoted to such an important issue as ensuring the resiliency of online services. A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Whether it is necessary to move to a hosting in Russia, or Fault tolerance on 242-FZ</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/5df/311/418/5df311418e684619a644361aee3d18d0.png"><br><br>  Some time ago, a <a href="http://www.failoverconf.ru/conf2015/">Failover</a> conference was held in Moscow, which was devoted to such an important issue as ensuring the resiliency of online services.  A day before the audience 19 speakers spoke, telling a lot of interesting things for developers, testers and operators.  We decided that such useful materials should not ‚Äúgather dust‚Äù in the archive and should become the property of an even wider public.  And we will start with the speech of Sergey Ryzhikov, entitled ‚ÄúDo I need to move to hosting in Russia, or Fault tolerance for 242-FZ.‚Äù <br><a name="habracut"></a><br>  The theme sounds pretty weird.  Let's argue about what is at stake.  I noticed that when the conversation about transferring hosting to Russia comes, many people start to talk emotionally.  Like a doctor who treats his child and cannot make rational decisions.  Therefore, first of all I urge you not to give in to emotions and to look at what is happening as far as possible.  Around the world today there is a tendency when all states begin to regulate the Internet in its most diverse manifestations.  Why is this done and is there anything unusual in it?  When does the need to regulate anything ever arise? <br><br>  When a phenomenon becomes important for people and the state, there is a need for regulation.  This is done in order to avoid negative consequences that can have a serious impact on the economy, society, and people's lives.  And the importance of the same Internet today is difficult to overestimate.  Let's assume that TCP / IP has somehow ceased to function.  Your company will be able to continue its activities?  Can you do something without an email?  Hardly. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The activities of government agencies and businesses depend on the functioning of the Internet, which has gradually become an absolutely indispensable component.  And there are people, I stress, not only in our country who are responsible for regulating this most important channel of communication. <br><br>  I will cite as an example such a topic as crimes related to the Internet.  Over the past 10 years, I have repeatedly communicated with the various state policing agencies themselves.  I watched their evolution, from a complete inability to do something, even when they were provided with all the data up to IP addresses, to a serious adequate response, ability to make a decision and find intruders. <br><br>  We all - both companies and individuals - are counting on the protection of the state, and it should be able to do this in various fields, including on the web.  But regulating the Internet is quite problematic, and the state is constantly trying to figure out how to do it.  Surprisingly, in normal conditions, citizens react poorly to regulation on the Internet, but at the same time they easily agree to this after acts of terrorism or large scandals with the loss of personal information.  After all, such things clearly show people the scale of what can happen to them. <br><br><h3>  How is this in the world? </h3><br>  I will give a few examples.  Once again, let us discuss this topic calmly and rationally, without considering ourselves as residents of a particular country. <br><br>  Great Chinese Firewall.  It originated in 2003, was blocked by Twitter, Facebook, Instagram, Google+, YouTube, etc.  There is an excellent lecture on the website <a href="http://www.ted.com/">www.ted.com</a> - ‚Äú <a href="http://www.ted.com/talks/michael_anti_behind_the_great_firewall_of_china">Behind the Great China Firewall</a> ‚Äù.  From it you can find out how the Chinese live in these conditions, about the national equivalents of all social services, how this internal ecosystem is regulated and works.  But such a situation, as in China, is possible with the existence of differences in ideologies. <br><br>  Germany.  Very conservative society.  On the one hand, everything is easy, nobody forbids anything, but the law obliges to place servers in countries that comply with the European standard for storing personal data.  And these include Canada, Switzerland, Argentina, Guernsey and the Isle of Man (who among you knows about Guernsey without the help of Google?). <br><br>  In the US, most of the restrictions were introduced after September 11.  The president has almost unlimited powers; since 2002, special services have gained access to telephone conversations, electronic correspondence and much more.  The law contains very vague wording: "If there is reason to believe that it can be a threat to state security."  This can often be interpreted in such a way that no order is needed to request the data stored on the servers.  This is such a large-scale phenomenon that large companies simply make access to IMAP for special services. <br><br><h3>  Law 242-FZ </h3><br>  And what about Russia?  Let's remember how the first law appeared, expanding the powers of Roskomnadzor.  Everyone feared that many sites would be closed with its introduction, but this did not happen.  Why then took the law?  Officials from Roskomnadzor emphasized that the law was aimed at building relationships with a number of companies, so that there was some kind of legislative framework that would ensure the legitimacy of certain requirements.  And this approach is used throughout the world.  That is, the law is always the negotiating position of the state in dialogue with business. <br><br>  So, from September 1, 2015, we will have to store personal data in Russia.  The law contains limitations and exceptions that regulate the procedure for dealing with various data formats.  And, of course, there are many unclear formulations.  It is not very clear what ‚Äúpersonal data‚Äù is.  Someone will say that this information allows you to uniquely identify.  But in the modern world a variety of things can be used to identify people. <br><br>  For example, in German law there is a very interesting point that data intended for different tasks should be processed separately.  This means that it is impossible to use the information collected with the help of one service for any tasks within another service.  Let's say you can't use the SMS you sent to determine your location.  And such things must be formulated as accurately and unambiguously as possible so that they cannot be bypassed or interpreted in favor of some side. <br><br><h3>  Consequences of ambiguity and understatement of laws </h3><br>  It is necessary to understand that no serious market participant will agree to work on hacked schemes.  The basic rule of all Western companies: "We will comply with the laws of the country, so as not to risk business."  But for IT-specialists, it is typical to argue in the key ‚ÄúWe will outsmart everyone‚Äù  For example, let's take the Russian IP, we will make a tunnel and will not transfer any data.  How do you guess that they, in fact, are not in Russia?  But the state structures compensate for the lack of their own competence by attracting specialists from outside.  For example, enter into contracts with companies that do analysis, transcript or some other things. <br><br>  The second way to circumvent the law is ‚ÄúWe will place part of the data in Russia and then transfer it to the‚Äú western ‚Äùcloud‚Äù.  This scheme has not yet received distribution, and large companies prefer not to risk it.  In any case, in my opinion this is a temporary solution. <br><br>  I also want to touch on another aspect that generally goes beyond the law, this is a matter of integrity with customers.  We, as IT specialists, traditionally trust in Western IT companies.  Customers now began to ask questions about where we store personal data, where our servers are located.  Everyone decides for himself - to lie or not.  But customers will not tolerate if you do not fulfill the law.  It should also be remembered that the degree of your compliance with this law may be reflected in the loss of personal data.  If they are stolen from your overseas server and published, you will fall under the distribution for violating the law. <br><br><h3>  Moving "Bitrix24" </h3><br>  Every time when it comes to this, we are asked one question: ‚ÄúWhat will you do?  You are sitting at Amazon, where will you go? ‚ÄùMore than 70 thousand companies are actively working with the Bitrix24 system every day.  We have two data centers in the USA, in the Amazon, they serve North and South America and provide fault tolerance.  We also have two servers in Ireland, they serve Europe, Ukraine, Russia, Kazakhstan and Belarus. <br><br>  We used a simplified architecture, we are actively using the Amazon balancer.  In case of failure of one data center, we switch to the second.  Data centers operate in master-master mode, they are interchangeable.  Cloud files are located in several data centers, bases are in two, web sites are scaled. <br><br>  For example, in the USA, depending on the load, a cluster can contain 25-40 machines each, in Europe - up to 75, not counting the auxiliary group.  This is not much, given that our customers are companies.  And to conduct an aggressive pricing policy allows us precisely competent scaling.  We pay exactly for the amount of resources that are necessary for the work of our clients at the moment.  Therefore, we cannot move to physical equipment and pay a fixed amount, it will destroy our financial model.  We will have to either raise prices, or redo something.  Therefore, we decided to use two data centers in Russia.  Our position - we do not violate the law and do not cheat our customers. <br><br><h3>  How we chose the provider </h3><br>  We needed providers with at least two data centers so that we could repeat the scheme used today.  And we made our balancer before the start of the search for data centers. <br><br>  It was necessary to decide on what we will be located - on physical equipment or on a virtual system?  The last option is closer to us, since we are using it now, in this case, handling is much higher.  Even if we switch to hardware, we still deploy our virtual infrastructure from above.  Based on this, it was decided to look for a provider capable of providing a virtual layer that is understandable and reliable.  We also needed cloud file storage, but with them in Russia is not very good. <br><br>  What else was critically important? <br><br><ul><li>  Virtual machines with arbitrary disk configurations.  This is necessary for our database, which we shardim, very well compacted. </li><li>  Dynamic pricing, because without it we will not be able to provide the current price level. </li><li> API to enable, disable, create, and in the data centers we need, etc. </li></ul><br>  We are one of the largest Amazon customers in Russia.  Unfortunately, we have to migrate, since Amazon has not yet decided to deploy the Russian version of the service.  This is their position: ‚ÄúWe will not break the law of any country.  If legislation changes, we either comply with it, or we leave. ‚Äù  But we must pay tribute to them, they help us in every way possible to migrate. <br><br>  So, Amazon has disappeared, as well as all serious players on the market, with the exception of those not represented in Russia.  I had to repeatedly adjust the list of requirements.  For example, we initially set the condition that the virtualizer must be non-commercial, but almost all use VMware, occasionally there is Xen.  There was another requirement that sounded like this: "The company should not be investment."  Why?  Because if the investment runs out, then the business will end.  There were plenty of such examples. <br><br>  The following criterion: the company must be of medium size, which allows you to maintain the necessary degree of flexibility in making decisions.  And this should be its main business focus.  We met great providers who, as it turned out, make money on a completely different basis.  It was important for us to understand, because the move is hectic, expensive and I want to do it as rarely as possible.  We are demanding, capricious customers, but still there are those who have satisfied all our needs.  A short list was formed, from which, as a result, a partner was chosen, which we will not name yet. <br><br><ul><li>  Cloud4Y </li><li>  Dataline </li><li>  IT Grad </li><li>  Oncloud </li><li>  Clouds </li></ul><br><h3>  How are we moving </h3><br><ul><li>  <b>The first stage</b> .  We transfer the balancer, we solve the technical problem of increasing the speed of access for customers.  This has already been done.  The balancer not only balances, but also completely caches graphics, statics, does SSL termination, keeps speedy and much more.  Due to this, we almost completely closed the question regarding the speed of the service. </li><li>  <b>The second stage</b> .  We are doing it now.  In two data centers, we are raising the database, doing the skilling infrastructure.  And since the balancer is already our own, we will transfer part of the traffic from it to experienced servers.  And the first to start using the Russian infrastructure are those customers who use Bitrix24 for free.  By the way, our exactingness to the quality of the transport system has already helped to identify several problems for operators of higher uplinks, they have already been eliminated. </li><li>  <b>The third stage</b> .  Registration will begin in the new infrastructure.  The goal is to ensure the entry into force of the law to ensure the operation of six data centers, two of which will be located in Russia. </li></ul><br>  Once again, I‚Äôll emphasize that we will be divided into regions within the project: domain.com, Brazil, Spain will be located in American data centers (because it is more focused on South America), in Ireland - Germany and Ukraine, and Russia will move the Russian partners. <br><br>  Thanks for attention!  If you have questions, welcome to comments. </div><p>Source: <a href="https://habr.com/ru/post/259573/">https://habr.com/ru/post/259573/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259561/index.html">A selection of courses on the development of games from Microsoft</a></li>
<li><a href="../259563/index.html">Localization RC (C ++, MFC, Win32)</a></li>
<li><a href="../259565/index.html">Talking with first customers</a></li>
<li><a href="../259567/index.html">Setting an object property using lambda expressions</a></li>
<li><a href="../259569/index.html">BSON injection in MongoDB adapter for Ruby</a></li>
<li><a href="../259575/index.html">Watch networks of the past</a></li>
<li><a href="../259577/index.html">Integration of symfony 2 and google calendar</a></li>
<li><a href="../259579/index.html">Controlling the volume of a multi-zone amplifier with an Android and Arduino application</a></li>
<li><a href="../259583/index.html">OpenCV 3.0 release with Python 3 support</a></li>
<li><a href="../259589/index.html">Loading models, traits</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>