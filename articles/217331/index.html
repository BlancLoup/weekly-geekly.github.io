<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Enigma algorithm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this community, I found many articles about the well-known Enigma encryption machine, but none of them described the detailed algorithm for its wor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Enigma algorithm</h1><div class="post__text post__text-html js-mediator-article">  In this community, I found many articles about the well-known Enigma encryption machine, but none of them described the detailed algorithm for its work.  Surely many will say that it does not need to be advertised - I hope that it will be useful for someone to find out about it. <a name="habracut"></a>  How did it all start?  During the First World War, the Playfair cipher was very popular.  Its essence was that the letters of the Latin alphabet were written in a square of 5x5, after which the letters of the original alphabet were divided into pairs.  Further, using the square as the key, these bigrams were replaced by others according to a certain algorithm.  The advantage of this cipher was that it did not require additional devices, and, as a rule, by the time the message was decrypted, it was no longer relevant.  Another way to secret writing was Jefferson's coder. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/499/64b/8e0/49964b8e0a56a3561b8f1c418a2f50ee.gif" alt="image"></div><br><br>  This device consisted of a certain number of disks strung on a single axis (usually there were 36 disks).  Each of them was divided into 26 parts, each of which denoted a letter.  The letters on the disks were arranged randomly.  The operator, by rotating the dial, would type in the desired message, and then rewrite another line.  The person who received this message should have exactly the same device with the exact same arrangement of letters.  Both methods were relatively good for those times, but given that humanity has entered the 20th century, it became necessary to mechanize the encryption process.  In 1920, the Dutch inventor Alexander Koch invented the first rotary encryption machine.  Then, German inventors received a patent for it, who improved it and put it into production, called “Enigma” (from Greek. - Mystery).  Thus, this machine was acquired by many companies that wanted to keep their correspondence secret.  This was the whole genius of Enigma - everyone knew the encryption algorithm, but no one could find the right key, since the number of possible combinations exceeded 15 quadrillion.  If you want to know how the Enigma was hacked, I advise you to read Simon Singh’s book The Book of Ciphers.  Summarizing all the above, I want to say that the Enigma cipher was a certain mixture of the Jefferson coder and Caesar cipher. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So let's get down to learning the algorithm.  On this <a href="">site</a> there is a very good simulator, which in an accessible and visual form shows the whole process entirely.  Let's look at the principle of the three-rotor Enigma.  It had three compartments for accommodating three rotors and an additional compartment for accommodating the reflector.  In total, during the Second World War, eight rotors and four reflectors were manufactured, but at the same time exactly as much as the machine was designed.  Each rotor had 26 sections, which corresponded to a separate letter of the alphabet, as well as 26 contacts for interaction with neighboring rotors.  As soon as the operator clicked on the desired letter, the electrical circuit was closed, as a result of which an encrypted letter appeared.  The circuit was closed at the expense of the reflector. <br><br><div style="text-align:center;"><img src="http://upload.wikimedia.org/wikipedia/commons/6/6c/Enigma-action.svg" alt="image"></div><br><br>  The figure shows an illustration of pressing the “A” key followed by decoding into the letter “G”.  After entering the letter, the rightmost rotor moved forward, thereby changing the key.  So how was one letter replaced with another?  As I said before, eight different rotors were designed for the Enigma.  Within each of these, 26 different commutations were installed.  <a href="http://www.codesandciphers.org.uk/enigma/rotorspec.htm">Here</a> is a detailed specification for each of them.  For example, if the letter “N” entered the input of the first rotor, then the output should be only “W” and no other letter is greater.  Had this letter on the second rotor, it would have already been transformed into “T”, etc.  That is, each rotor performed a clear task in terms of communication.  And what role did the rings play?  Consider the following example.  Install rotors III, II, and I, and the order of the rings is “C”, “U”, and “Q”. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d31/533/d3d/d31533d3d81001098a7978cbf1e4f8a2.jpg" alt="image"></div><br><br>  Press the "A" key.  The rightmost rotor will turn forward one step, that is, the letter “Q” will turn into “R”.  The rotor in the middle will also turn forward on the letter “V”, but I will tell about this a little later.  So, our letter “A” begins the journey from the first compartment, in which the rotor I is installed and on which the letter “R” is already displayed.  Already before entering the first rotor, the letter undergoes its first transformation, namely: addition with the letter “R” modulo 26. In fact, this is Caesar's cipher.  If you number all the letters from 0 to 25, then the letter "A" will be just the same zero.  Hence, the result of the addition will be the letter "R".  Further, we all know that in the first compartment is the rotor I, and in its design it is incorporated that the letter “R” always goes into “U”.  Now in line the second compartment with the rotor II.  Again, before hitting the second rotor, now the letter “U” changes in a slightly different algorithm: the <b>difference between the</b> values ​​of the subsequent rotor and the previous one is added to it.  I will explain.  On the second rotor, the letter “V” awaits us, and on the previous one, “R”, the difference is four letters, and they are added to our letter “U”.  Therefore, on the second rotor comes the letter "Y".  Further, according to the table, we find that in the second rotor the letter “Y” corresponds to “O”.  Then again we look at the difference between the letters "C" and "V" - it is equal to seven.  So, we shift the letter “O” by seven positions and get “V”.  In the rotor III "V" goes to "M".  Before getting to the reflector, the letter “C” is subtracted from our letter, transforming it into the letter “K”.  Next comes the reflection.  If you notice, large cyclic groups form in each rotor, for example: (A - E - L - T - P - H - Q - X - R - U), and in the reflector they are divided into pairs: (A - Y) (B - R) (C - U), etc.  This is done so that later it can be decrypted.  Suppose that a reflector B is installed, in which “K” is replaced with “N” (and vice versa).  Half way passed.  Now we again add the value of the letter "C", thereby obtaining the letter "P".  Here, on the contrary, in the line of the third rotor we find the “P” and look, in pressing which letter it would appear.  This is the letter "H".  Conversion in the third rotor is complete.  Now the difference between the letters “C” and “V”, that is, seven, is subtracted from this letter.  We get the letter "A".  In the second rotor, it goes into itself, so leave it unchanged.  Next, subtract the difference between the letters "V" and "R", that is, the four, and we get the letter "W".  In the first rotor, its conversion back is mapped to the letter “N”.  It remains only to subtract from it the letter "R" and get the desired letter "W".  As you can see, the algorithm of the machine was not as difficult as it seemed.  To improve the cipher, the Germans introduced a patch panel, which allowed the letters to be interchanged in pairs.  If we combine the letters “Q” and “W”, then entering the same “A” we would get “Q”, since in fact it should be “W”, but it is replaced by the letter “Q”.  Here is the attached chart of action. <br><img src="https://habrastorage.org/getpro/habr/post_images/af2/871/f34/af2871f3400f36b9dd8f11f4d945c03f.png" alt="image"><br>  It remains only to tell about the displacement of the rotors relative to each other.  The right-hand rotor always turned when the key was pressed one step.  For example, for rotor I, this position is equal to the letter "R".  That is why in our example the second rotor turned: the first rotor went through the letter "R".  Further, having passed through a certain position, the right rotor set in motion the left one step.  In more advanced models, the left rotor scrolled two or even three times. <br><br>  In conclusion, I will say that <a href="http://enigmacrack.com/">here</a> are collected some materials on cracking Enigma, which may be useful.  I hope that this article is useful to someone. </div><p>Source: <a href="https://habr.com/ru/post/217331/">https://habr.com/ru/post/217331/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../217317/index.html">Algorithms for video processing processor TI DM368</a></li>
<li><a href="../217319/index.html">Computer vision library CCV 0.6 with new image classifier</a></li>
<li><a href="../217321/index.html">PVS-Studio now supports any build system on Windows and any compiler. Easy and out of the box</a></li>
<li><a href="../217325/index.html">Automatic update of C # programs</a></li>
<li><a href="../217327/index.html">Attacks in time - a fairy tale or a real threat?</a></li>
<li><a href="../217333/index.html">Once again about the leak of atoms and the VCL bug</a></li>
<li><a href="../217337/index.html">ATM. On the other side of the wire</a></li>
<li><a href="../217339/index.html">Running a tmux window adapted for convenient work with Ruby on Rails</a></li>
<li><a href="../217341/index.html">JSSamePHP: I know PHP, but I need JavaScript</a></li>
<li><a href="../217343/index.html">The index of the sequence of assembly operations. Improving the productivity of workers in assembly plants with a laser pointer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>