<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cloud video surveillance from a webcam and router</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you want to install a video surveillance system at home, but having studied the prices for cameras and DVRs, this idea disappears, then let's consi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cloud video surveillance from a webcam and router</h1><div class="post__text post__text-html js-mediator-article">  If you want to install a video surveillance system at home, but having studied the prices for cameras and DVRs, this idea disappears, then let's consider a budget option using a webcam and a router. <br><br>  We will need: <br><br><ul><li>  TP-Link TL-MR3020 router </li><li>  webcam (with MJPEG support) </li><li>  USB hub </li><li>  USB stick </li></ul><br>  A webcam and a USB flash drive are connected to the USB port of the router via a USB hub.  WebGlazok firmware is installed on the router.  The firmware is based on OpenWrt and uses the Motion Motion Detection program. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We get a simple video surveillance system with <b>motion detection</b> and <b>cloud storage</b> , which does not require a computer, a DVR and a white IP address. <br><a name="habracut"></a><br>  Available features: <br><br><ul><li>  motion detection in specified areas with a recording of 2 frames per second </li><li>  saving frames at a given time interval </li><li>  archive storage on a USB flash drive </li><li>  archive recording to the cloud (optional) </li></ul><br>  Of course, 2 frames per second is rather not video surveillance, but photo surveillance, but for many tasks this is enough. <br><br>  For what you can use this system: <br><br><ul><li>  Supervision in the apartment, the house, at the dacha </li><li>  Babysitting </li><li>  Pet Looking </li><li>  Control over employees in the office </li><li>  Visual control over the equipment (heating devices, gas equipment, etc.) </li></ul><br><h2>  How to build and configure the system </h2><br><ol><li>  Download the latest version of the WebGlazok firmware from the <a href="https://webglazok.com/diy/firmware">official site.</a> </li><li>  Go to the control panel of the router at <a href="http://192.168.0.254/">192.168.0.254</a> </li><li>  We perform the firmware update of the router, indicating the downloaded firmware: <br><br><div class="spoiler">  <b class="spoiler_title">Router software update</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/6b0/513/fbf/6b0513fbf4224aab92acd5f1f8bd70c1.png" alt="image"><br></div></div><br></li><li>  Move the switch on the router to the AP position, the router will create a Wi-Fi network named WebGlazok.com_XXX <br><br><div class="spoiler">  <b class="spoiler_title">Switch on the router</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/77c/968/301/77c9683017604fb5828bb0afbb30a9cf.jpg" alt="image"><br></div></div><br></li><li>  Connect to this network, the password is the MAC address of the router (printed on the case) </li><li>  Go to the control panel of the router at <a href="http://192.168.1.1/">192.168.1.1</a> , login admin, password admin. </li><li>  In the control panel, we set the sensitivity of motion detection, motion zones and frame acquisition interval: <br><br><div class="spoiler">  <b class="spoiler_title">Control panel of the router with firmware WebGlazok</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/f89/6d9/7c2/f896d97c2ae9495baa42eb402892452e.png" alt="image"><br></div></div><br></li><li>  It is advisable to specify a Wi-Fi network to connect to the Internet, it is necessary to synchronize time and send pictures to the cloud </li></ol><br><h2>  How the system works </h2><br>  The router analyzes the image from the camera and, when it detects motion, saves frames to a USB flash drive at a speed of 1-2 frames per second.  In the absence of motion, frames are saved over a specified time interval. <br><br>  JPEG footage is stored on a flash drive in folders with the following structure /cam1/date/hours/filed.jpg <br><br>  For example: /cam1/20170403/1540/20170403154400-00_s4_s.o.jpg <br><br>  Images are stored in 2 copies - preview and full-size photo.  You can view the recorded footage through the computer by inserting a USB flash drive into it. <br><br>  In my experience using a 16 GB flash drive is enough for about 2 weeks of archive storage in the presence of movements in about 5% of cases of the total time.  After the memory is full, old frames are deleted from the flash drive. <br><br>  The system can work completely autonomously and without connecting to the Internet. <br><br>  However, this model of the router has no built-in clock, so the time on the frames is set incorrectly.  When the power is turned off, the time ‚Äústops‚Äù. <br><br>  To solve this problem, the router must be connected to the Internet via Wi-Fi.  Then time is synchronized via the Internet.  Traffic is almost not consumed.  Even a weak 2G internet will do.  Outside the city, the Internet can be distributed via a 3G / 4G router or a regular router with a connected 3G / 4G modem. <br><br><h2>  Autonomous work </h2><br>  The router works from the USB power connector, so if there is no 220 V power outlet, it can be powered, for example, from a mobile battery (paverbank). <br><br>  The power supply voltage of the router is 5 V, the measured current strength when the camera is running is 0.6 A, the power is 3 W.  Thus, a USB paverbank with a capacity of 10,000 mAh (36 W / h) is enough for 12 hours of system operation. <br><br>  You can also connect a car battery with a converter from 12 V to 5 V. <br><br><h2>  If you need online viewing </h2><br>  Watching footage on a flash drive is not very convenient.  To find the event of interest, you need to scroll through all the files on your computer. <br><br>  The router with the WebGlazok firmware has the ability to save frames to the cloud and glue them into the video sequence there.  And you can view the camera through a browser or mobile application.  However, this service is paid and costs 199 rubles per month (as of April 2017). <br><br>  To store the archive of your camera in the cloud, you need to connect the router to the Internet via Wi-Fi, as well as register the camera on WebGlazok.com and get the device key. <br><br>  In your account, the camera activity tape and the camera image are displayed.  The detected movements are marked in red on the tape. <br><br>  Camera settings are also made from the personal account: <br><br><ul><li>  motion sensor sensitivity </li><li>  motion detection zones </li><li>  frame retention interval </li><li>  Notification settings </li></ul><br>  Notifications about movements with attached frames, alerts about disconnection of the camera from the network and loss of the signal come to the mail. <br><br>  The router sends to the cloud low-resolution frames (previews), which take 5-20 KB each.  Therefore, little traffic is spent.  This resolution is enough to view the situation, but for a detailed view you need a frame with full resolution. <br><br><div class="spoiler">  <b class="spoiler_title">Frame preview</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/190/537/946/19053794698f402990c5ca924e2037ac.png" alt="image"><br></div></div><br>  In your personal account (in a browser or a mobile application), if you stop a preview frame for more than 2 seconds, a request is sent to the router to get a full-size high-resolution frame.  The router searches for this frame on a USB flash drive and sends it to the cloud.  The process takes 10-30 seconds depending on the speed of the Internet, after which the preview frame in your account changes to full-size (HD).  When you re-request, the HD frame already opens quickly, as it is already stored in the cloud. <br><br><div class="spoiler">  <b class="spoiler_title">HD frame</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/951/036/e2f/951036e2f4354606a7ffb633337d3f41.png" alt="image"><br></div></div><br>  Table of ratios of frame resolution and frame preview: <br><br><blockquote>  Camera Resolution / Preview Resolution <br>  640x480 / 320x240 <br>  1280x720 / 320x180 <br>  1280x960 / 320x240 <br>  1920x1080 / 240x135 <br>  1600x1200 / 200x150 </blockquote><br><h2>  Connecting IP cameras </h2><br>  The webcam is inexpensive and compact, easy to connect and install.  However, if you need night shooting and editing outdoors, then you can‚Äôt do without an IP camera. <br><br>  The WebGlazok system also supports the connection of IP cameras that connect to the router via the LAN port or via Wi-Fi. <br><br>  All that is required from the IP camera is a JPEG image or an MJPEG stream.  Modern IP cameras that support the ONVIF protocol can give a snapshot. <br><br>  All motion detection analytics also occur on the router.  You can buy a cheap Chinese camera on Aliexpress for 1300-1800 rubles. <br><br><h2>  Final cost </h2><br>  So, how much does a kit of such video surveillance cost?  As a webcam, we take the popular Logitech C270 model with a resolution of 1280x720. <br><br>  Prices for April 2017: <br><br><ol><li>  TP-Link TL-MR3020 router - <b>1200</b> rub. </li><li>  webcam Logitech C270 HD Webcam - <b>1300</b> rubles. </li><li>  USB hub - <b>300</b> rubles </li><li>  USB stick 16 GB - <b>400</b> rub. </li></ol><br>  <b>Total 3200 rubles.</b> <br><br>  If you need to connect to the camera cloud service, then there will be additional costs: <br><br><ul><li>  <b>199</b> rub.  per month for cloud storage </li><li>  Internet payment, about 2 GB per month </li></ul><br>  Many people already have a USB hub and a USB flash drive, and this model of router and webcam is very popular and you can buy them with your hands 2 times cheaper than the market value. </div><p>Source: <a href="https://habr.com/ru/post/325722/">https://habr.com/ru/post/325722/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325710/index.html">How to set up the next generation extended protection in the corporate network</a></li>
<li><a href="../325714/index.html">Cross a hedgehog (Marathon) with a snake (Spring Cloud). Episode 1</a></li>
<li><a href="../325716/index.html">Life without SDL. Winter 2017</a></li>
<li><a href="../325718/index.html">Big Data for car dealers and automakers: from idea to monetization</a></li>
<li><a href="../325720/index.html">Intel Media SDK has become an open source project.</a></li>
<li><a href="../325724/index.html">Everything in Openwork: Parallels RAS Integration into Microsoft Azure</a></li>
<li><a href="../325726/index.html">Siberia? The Bears? Code! Or how we visited CodeFest</a></li>
<li><a href="../325728/index.html">How to love machine learning and stop suffering</a></li>
<li><a href="../325730/index.html">The problem of using CompletableFuture in multiple threads and its solution</a></li>
<li><a href="../325732/index.html">From developers - to Solution Architects: the story of one transformation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>