<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experienced trivia-9, or ‚ÄúYou are sick! How will we treat? ‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The continuation of "experienced trifles." Previous parts can be read here . 

 From time to time, every system administrator needs to check a ‚Äúsuspic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experienced trivia-9, or ‚ÄúYou are sick! How will we treat? ‚Äù</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/4d113fb4/968eca85/3bfc8ad2/5cb32ffb.jpg" alt="image" align="left">  The continuation of "experienced trifles."  Previous parts can be read <a href="http://habrahabr.ru/tag/%25D0%25BE%25D0%25BF%25D1%258B%25D1%2582%25D0%25BD%25D1%258B%25D0%25B5%2520%25D0%25BC%25D0%25B5%25D0%25BB%25D0%25BE%25D1%2587%25D0%25B8/">here</a> . <br><br>  From time to time, every system administrator needs to check a ‚Äúsuspicious‚Äù computer for malware.  Either weird traffic is coming from it, or weird windows are getting out, or worse, some WinLock were caught.  I will talk about a simple, almost step by step express method that we offer to our new supporters.  Someone may find it incomplete or too simple; nevertheless, many problems can be identified with its help.  And to understand the problem is half the solution.  In any case, I will be glad to read in the comments your additions and useful tips on this issue. <br><br><a name="habracut"></a><br>  In general, to explore the computer for the "search of infection", this occupation is fascinating, but ungrateful.  Often, the time you spend searching and treating is much longer than the time you would spend completely reinstalling your computer while preserving data. <br>  Examining a computer closely can be done only for the sake of your own education / pleasure, or in a situation when it contains non-portable software (software whose settings nobody knows how to transfer to a new computer, or it is very time-consuming / resource intensive).  Considering this, we tried to ensure that the test was as fast and low-cost as possible.  If it is impossible to understand the problem by it, the computer is often reinstalled, or in particularly important cases, it is given to the senior admins for a closer examination. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Another important point is that in order for an inexperienced sapper to correctly ‚Äúcheck‚Äù an infected computer, you first need to train him to understand what is ‚Äúnormal‚Äù in it and what is not, for this purpose we first give them a freshly installed, clean computer with an approximate set of our internal ON, and they train on it.  Stupidly banish all the tests, and see what happens.  They accumulate a so-called.  ‚ÄúClean computer template‚Äù.  They see with their own eyes the triggers of test utilities for ordinary things that are present even on deliberately clean computers (for example, AVZ creeps terribly if the computer has Symantec Endpoint Protection, etc.).  In the future, when checking in real conditions, these "deviations" are quite easily noticed. <br><ol><li>  Run on an <a href="http://z-oleg.com/secur/avz/download.php">AVZ</a> machine with fresh bases.  In the parameters set: Heuristics - max, Advanced analysis, Blocking user rootkits - depending on the importance of the machine.  In general, it is better to start by simply starting the check and look at the result without blocking anything.  Check the SPI configuration, open TCP \ UDP ports using the same AVZ.  Examine the result, compare it with the output from a clean machine, weed out known programs that have a triggering effect (antiviruses, PuntoSwitcher a la interceptors, etc.).  Analyze the difference, if any. </li><li>  "For fans" you can go through the items on the SERVIS menu in AVZ.  Search for gray (unidentified) lines by Program Files, Documents And Settings, Windows.  Try to understand what it is and why.  On important computers it is better to look at ALL items (Managers ..., dispatchers ..., etc.) of the SERVICE menu. </li><li>  Launch <a href="http://technet.microsoft.com/ru-ru/sysinternals/bb963902">Autoruns</a> from Sysinternals.  Enable option Verify Code Signature.  Analyze the result on the subject of "strangeness", pay attention to the ways, names, descriptions in the columns Publisher and Description. </li><li>  Check already executed tasks using <a href="http://technet.microsoft.com/ru-ru/sysinternals/bb896653">Process Explorer</a> from Sysinternals.  Pay attention to the path to the program being launched (you need to enable it additionally in the View - Select Columns menu </li></ol><br><img src="https://habrastorage.org/storage1/a40045e0/5aa1c7ff/0b9e5f2c/30c8427b.jpg" alt="image" align="right">  Performing the described procedures and a careful analysis of the results obtained allows you to make a decision about what to do next: clean the computer or allow it to be reinstalled.  The process of cleaning the system is almost always unconventional, creative.  Other infections are quite difficult to withdraw, they are deeply prescribed in the services, monitor the removal of themselves from the avran-ways, replace the shell, etc.  In the end, there are rootkits.  Be prepared for the fact that the final cleaning path is likely to have a good look, the easiest way is likely to be incomplete.  If you still decide, then you can clean the system, for example, like this: <br><ol><li>  Disable System Restore.  check that all restore points are cleared.  Traditionally, this is a favorite "bomb shelter" for all sorts of infections. </li><li>  Clean everything possible using AVZ (make sure to enable AVZ-Guard mode (AVZ blocks third-party software launch and allows you to run software only from its interface), start everything you need from AVZ, troubleshoot the wizard ‚Äî clean the system, deferred file deletion , rootkit blocking, etc.) </li><li>  After (!) Blocking rootkits using AVZ, in AVZ-Guard mode, start and carefully examine the output of the Autoruns utility from Sysinternals.  Malware is usually either written in the ‚Äúregistry branches that are running‚Äù, or they replace the shell.  Here will help experience, keen eye and "pattern of a clean car" </li><li>  Manually clear the profile of an infected user: <ul><li>  Temporary folders (% User% \ Local Settings \ Temp) </li><li>  Browser cache (% User% \ Local Settings \ Temporary Internet Files \ Content.IE5) </li><li>  Browser history (% User% \ Local Settings \ History \ History.IE5) </li><li>  Reset the internet explorer to default (browser service properties-advanced-reset) </li><li>  In Internet Explorer, check add-ons (service-properties of the browser-program-add-on).  Extra disable / delete. </li><li>  <i>(Note that after these actions, the current user will lose the history of visits, saved passwords, cookies, etc.)</i> </li><li>  Similarly, browse third-party browser profiles if the user uses them. </li></ul></li><li>  Check the system variables (type SET in the command line), especially pay attention to the PATH, clean it if necessary, but be careful not to delete the necessary one.  This will help the training "clean system pattern." </li><li>  Check SYSTEM-LOG from the last boot (system log from event 6009-6005).  Pay attention to errors when starting services and running drivers. </li><li>  You can run portable versions of popular anti-viruses, for example, <a href="http://www.freedrweb.com/download%2Bcureit/gr/">DrWeb Cure IT</a> (it is free only for personal use, remember this) or a <a href="http://devbuilds.kaspersky-labs.com/devbuilds/AVPTool">version from Kaspersky Lab</a> .  Such anti-virus utilities are updated regularly, and each time you will most likely have to download them again with fresh databases.  They can check not everything, but only the Documents And Settings, Program Files, Windows folders. </li><li>  If the result is not satisfactory, boot from any live CD (Bart-pe, Alkid-LiveCD, Hiren BootCD, etc.) and check it with the same antivirus tools. </li><li>  Check the files in the Windows and Windows \ System32 folders for their dates.  Pay special attention to files that are changed on the day or the day before the infection.  If they have the correct names, and at first glance, they are needed for the system to work - replace them with similar ones from the neighboring system (note that you can do it with the same systems that are at least approximately the same. You cannot change the userinit.exe file from WinXPSp2 for the same WinXPSP3 file, etc. </li></ol><br><br>  If you still could not cure the machine, try to contact the profile branches of the forums, for example <a href="http://virusinfo.info/forumdisplay.php%3Ff%3D46">Virusinfo</a> , and if they did not help there, seriously think about reinstalling the system, since  you can cure a trojan, but you will spend a lot of time and there will most likely be no guarantees for a complete cure.  And you could spend the time spent on this occupation with much greater benefit. <br><br>  Upd: For more clarity, I will add: the machines that are being investigated in this way are ALREADY disconnected from the network, they are taken from them (if they can be taken).  This rapid method was written to train the personnel in order to quickly and with minimal effort, inexperienced supporters make a decision: should the computer be cured or should it be reinstalled. <br><br>  To be continued </div><p>Source: <a href="https://habr.com/ru/post/122670/">https://habr.com/ru/post/122670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122665/index.html">The dangers of learning in Java</a></li>
<li><a href="../122666/index.html">Publishing world</a></li>
<li><a href="../122667/index.html">rescue initrd in cloud selective</a></li>
<li><a href="../122668/index.html">Experienced trivia-7, or "Mergers and acquisitions in the Group Policy"</a></li>
<li><a href="../122669/index.html">Experienced trivia-8, or "Mail three on VBS"</a></li>
<li><a href="../122671/index.html">Experienced trivia-10, or "DFS and fault tolerance"</a></li>
<li><a href="../122675/index.html">Interview with Andrew Price</a></li>
<li><a href="../122676/index.html">Bitstorm: the easiest bittorrentovy tracker in the world</a></li>
<li><a href="../122677/index.html">Australians are developing a laptop that will recharge from keystrokes</a></li>
<li><a href="../122679/index.html">AMD Fusion 11 Developer Summit - as it was, part 2 (details about the C ++ AMP platform)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>