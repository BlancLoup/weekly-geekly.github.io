<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic password management in Active Directory</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once I got tired of it all ... 
 Probably, in most cases, the creativity of system administrators begins with this phrase. As a result, we see (althou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic password management in Active Directory</h1><div class="post__text post__text-html js-mediator-article">  <i>Once I got tired of it all ...</i> <br>  Probably, in most cases, the creativity of system administrators begins with this phrase.  As a result, we see (although, more correctly, we don‚Äôt even notice) the emergence of many small programs that perform their exact and well-defined tasks in one large system. <br><br>  A similar story happened to me (and it happens regularly).  Not to say that I invented something new and outstanding.  Rather, on the contrary, he took advantage of the work of his colleagues found in the Internet and in the storehouses of the wisdom of Habr.  But I managed to combine them to solve a very specific and quite interesting task.  Next, I will describe a specific solution to the specific task of managing user passwords in Active Directory.  More precisely, the automation of checking the expiration of these passwords and the generation of new passwords.  As a gratitude to my colleagues, I found it necessary to publish this decision here, in the hope that it will be useful to someone or serve as a source of new ideas. <br><a name="habracut"></a><br>  So, there is a certain organization with a powerful and extensive branch network.  There are a lot of branches all over our immense Motherland and they are all different-sized.  Most of them are included in the corporate network with a domain structure, but many are connected according to the home-office principle.  In addition, many employees are constantly on long trips without the ability to connect to a domain network and to the Internet in general. <br><br>  As a result, the problem of expired passwords often occurs.  The company's policy prohibits perpetual passwords, and the requirements with stringent passwords are rather severe, which makes it difficult for users to invent and replace them.  Accordingly, they happily put their headache on IT support, calling and demanding to change their already invalid password.  Regularly.  I'm tired. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So what did I want to do?  I need a tool that: <br>  ‚Ä¢ itself checked the expiration of the user's password; <br>  ‚Ä¢ previously warned him about the date of the password change by e-mail; <br>  ‚Ä¢ offered the user a new password option; <br>  ‚Ä¢ if the user did not have time to change the password, automatically replaced it with a new one; <br>  ‚Ä¢ Notify the user about the new password via SMS. <br><br>  The interest was to solve this problem with the best available means, without attracting third-party services and services.  Well, there was no desire to choose tariffs and packages.  But there was a free GSM modem.  And Almighty PowerShell. <br><br>  The result is a script, or rather two scripts.  Why is it so explained simply - it happened historically.  The fact is that password checking is performed by a script on a virtual machine located in one branch office, and another machine located in the opposite part of the country is sending SMS notifications.  Because of the conditions of the mobile operator, otherwise it was unprofitable. <br><br>  Further I cite both scripts entirely, which I commented as much as possible.  They look a little curly.  I didn‚Äôt have a particular need to comb them, because they work well and in this form: <br><br><pre><code class="hljs smalltalk">#    ,     , #      email, #   ,     . # #   . <span class="hljs-string"><span class="hljs-string">$d</span></span>t=<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Date</span></span> -<span class="hljs-type"><span class="hljs-type">Format</span></span> <span class="hljs-comment"><span class="hljs-comment">"dd-MM-yyyy"</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>etupFolder = <span class="hljs-comment"><span class="hljs-comment">"c:\Active_Directory\Log"</span></span> <span class="hljs-type"><span class="hljs-type">New</span></span>-<span class="hljs-type"><span class="hljs-type">Item</span></span> -<span class="hljs-type"><span class="hljs-type">ItemType</span></span> directory -<span class="hljs-type"><span class="hljs-type">Path</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>etupFolder -<span class="hljs-type"><span class="hljs-type">Force</span></span> | out-null #    <span class="hljs-string"><span class="hljs-string">$g</span></span>lobal:logfilename=<span class="hljs-comment"><span class="hljs-comment">"C:\Active_Directory\Log\"</span></span>+<span class="hljs-string"><span class="hljs-string">$d</span></span>t+<span class="hljs-comment"><span class="hljs-comment">"_LOG.log"</span></span> [int]<span class="hljs-string"><span class="hljs-string">$g</span></span>lobal:errorcount=<span class="hljs-number"><span class="hljs-number">0</span></span> #   [int]<span class="hljs-string"><span class="hljs-string">$g</span></span>lobal:warningcount=<span class="hljs-number"><span class="hljs-number">0</span></span> #   function global:<span class="hljs-type"><span class="hljs-type">Write</span></span>-log #     -    . {param(<span class="hljs-string"><span class="hljs-string">$m</span></span>essage,[string]<span class="hljs-string"><span class="hljs-string">$t</span></span>ype=<span class="hljs-comment"><span class="hljs-comment">"info"</span></span>,[string]<span class="hljs-string"><span class="hljs-string">$l</span></span>ogfile=<span class="hljs-string"><span class="hljs-string">$g</span></span>lobal:logfilename,[switch]<span class="hljs-string"><span class="hljs-string">$s</span></span>ilent) <span class="hljs-string"><span class="hljs-string">$d</span></span>t=<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Date</span></span> -<span class="hljs-type"><span class="hljs-type">Format</span></span> <span class="hljs-comment"><span class="hljs-comment">"dd.MM.yyyy HH:mm:ss"</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg=<span class="hljs-string"><span class="hljs-string">$d</span></span>t + <span class="hljs-comment"><span class="hljs-comment">"`t"</span></span> + <span class="hljs-string"><span class="hljs-string">$t</span></span>ype + <span class="hljs-comment"><span class="hljs-comment">"`t"</span></span> + <span class="hljs-string"><span class="hljs-string">$m</span></span>essage #: <span class="hljs-number"><span class="hljs-number">01.01</span></span><span class="hljs-number"><span class="hljs-number">.2001</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span> [tab] error [tab]  <span class="hljs-type"><span class="hljs-type">Out</span></span>-<span class="hljs-type"><span class="hljs-type">File</span></span> -<span class="hljs-type"><span class="hljs-type">FilePath</span></span> <span class="hljs-string"><span class="hljs-string">$l</span></span>ogfile -<span class="hljs-type"><span class="hljs-type">InputObject</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg -<span class="hljs-type"><span class="hljs-type">Append</span></span> -encoding unicode if (-not <span class="hljs-string"><span class="hljs-string">$s</span></span>ilent.<span class="hljs-type"><span class="hljs-type">IsPresent</span></span>) { switch ( <span class="hljs-string"><span class="hljs-string">$t</span></span>ype.toLower() ) { <span class="hljs-comment"><span class="hljs-comment">"error"</span></span> { <span class="hljs-string"><span class="hljs-string">$g</span></span>lobal:errorcount++ write-host <span class="hljs-string"><span class="hljs-string">$m</span></span>sg -<span class="hljs-type"><span class="hljs-type">ForegroundColor</span></span> red } <span class="hljs-comment"><span class="hljs-comment">"warning"</span></span> { <span class="hljs-string"><span class="hljs-string">$g</span></span>lobal:warningcount++ write-host <span class="hljs-string"><span class="hljs-string">$m</span></span>sg -<span class="hljs-type"><span class="hljs-type">ForegroundColor</span></span> yellow } <span class="hljs-comment"><span class="hljs-comment">"completed"</span></span> { write-host <span class="hljs-string"><span class="hljs-string">$m</span></span>sg -<span class="hljs-type"><span class="hljs-type">ForegroundColor</span></span> green } <span class="hljs-comment"><span class="hljs-comment">"info"</span></span> { write-host <span class="hljs-string"><span class="hljs-string">$m</span></span>sg } default { write-host <span class="hljs-string"><span class="hljs-string">$m</span></span>sg } } } } #    function global:<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">RandomPassword</span></span> { &lt;#    <span class="hljs-type"><span class="hljs-type">PasswordLength</span></span> -   #&gt; [<span class="hljs-type"><span class="hljs-type">CmdletBinding</span></span>()] param( [<span class="hljs-type"><span class="hljs-type">Parameter</span></span>(<span class="hljs-type"><span class="hljs-type">Position</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-type"><span class="hljs-type">Mandatory</span></span>=<span class="hljs-string"><span class="hljs-string">$t</span></span>rue, <span class="hljs-type"><span class="hljs-type">ValueFromPipeline</span></span>=<span class="hljs-string"><span class="hljs-string">$t</span></span>rue)] [<span class="hljs-type"><span class="hljs-type">ValidateRange</span></span>(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>)] [<span class="hljs-type"><span class="hljs-type">Int</span></span>] <span class="hljs-string"><span class="hljs-string">$P</span></span>asswordLength ) <span class="hljs-type"><span class="hljs-type">Begin</span></span>{} <span class="hljs-type"><span class="hljs-type">Process</span></span>{ <span class="hljs-string"><span class="hljs-string">$n</span></span>umberchars=<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-number"><span class="hljs-number">.9</span></span> | % {<span class="hljs-string"><span class="hljs-string">$_</span></span>.<span class="hljs-type"><span class="hljs-type">ToString</span></span>()} <span class="hljs-string"><span class="hljs-string">$l</span></span>ochars = [char]<span class="hljs-string"><span class="hljs-string">'a'</span></span> .. [char]<span class="hljs-string"><span class="hljs-string">'z'</span></span> | % {[char]<span class="hljs-string"><span class="hljs-string">$_</span></span>} <span class="hljs-string"><span class="hljs-string">$h</span></span>ichars = [char]<span class="hljs-string"><span class="hljs-string">'A'</span></span> .. [char]<span class="hljs-string"><span class="hljs-string">'Z'</span></span> | % {[char]<span class="hljs-string"><span class="hljs-string">$_</span></span>} <span class="hljs-string"><span class="hljs-string">$p</span></span>unctchars = [char[]](<span class="hljs-number"><span class="hljs-number">33.</span></span><span class="hljs-number"><span class="hljs-number">.47</span></span>) <span class="hljs-string"><span class="hljs-string">$P</span></span>asswordArray = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Random</span></span> -<span class="hljs-type"><span class="hljs-type">InputObject</span></span> @(<span class="hljs-string"><span class="hljs-string">$h</span></span>ichars + <span class="hljs-string"><span class="hljs-string">$l</span></span>ochars + <span class="hljs-string"><span class="hljs-string">$n</span></span>umberchars + <span class="hljs-string"><span class="hljs-string">$p</span></span>unctchars) -<span class="hljs-type"><span class="hljs-type">Count</span></span> <span class="hljs-string"><span class="hljs-string">$P</span></span>asswordLength <span class="hljs-string"><span class="hljs-string">$c</span></span>har1 = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Random</span></span> -<span class="hljs-type"><span class="hljs-type">InputObject</span></span> <span class="hljs-string"><span class="hljs-string">$h</span></span>ichars <span class="hljs-string"><span class="hljs-string">$c</span></span>har2 = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Random</span></span> -<span class="hljs-type"><span class="hljs-type">InputObject</span></span> <span class="hljs-string"><span class="hljs-string">$l</span></span>ochars <span class="hljs-string"><span class="hljs-string">$c</span></span>har3 = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Random</span></span> -<span class="hljs-type"><span class="hljs-type">InputObject</span></span> <span class="hljs-string"><span class="hljs-string">$n</span></span>umberchars <span class="hljs-string"><span class="hljs-string">$c</span></span>har4 = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Random</span></span> -<span class="hljs-type"><span class="hljs-type">InputObject</span></span> <span class="hljs-string"><span class="hljs-string">$p</span></span>unctchars <span class="hljs-string"><span class="hljs-string">$R</span></span>ndIndexArray = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Random</span></span> (<span class="hljs-number"><span class="hljs-number">0.</span></span>.(<span class="hljs-string"><span class="hljs-string">$P</span></span>asswordLength<span class="hljs-number"><span class="hljs-number">-1</span></span>)) -<span class="hljs-type"><span class="hljs-type">Count</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-string"><span class="hljs-string">$P</span></span>asswordArray[<span class="hljs-string"><span class="hljs-string">$R</span></span>ndIndexArray[<span class="hljs-number"><span class="hljs-number">0</span></span>]] = <span class="hljs-string"><span class="hljs-string">$c</span></span>har1 <span class="hljs-string"><span class="hljs-string">$P</span></span>asswordArray[<span class="hljs-string"><span class="hljs-string">$R</span></span>ndIndexArray[<span class="hljs-number"><span class="hljs-number">1</span></span>]] = <span class="hljs-string"><span class="hljs-string">$c</span></span>har2 <span class="hljs-string"><span class="hljs-string">$P</span></span>asswordArray[<span class="hljs-string"><span class="hljs-string">$R</span></span>ndIndexArray[<span class="hljs-number"><span class="hljs-number">2</span></span>]] = <span class="hljs-string"><span class="hljs-string">$c</span></span>har3 <span class="hljs-string"><span class="hljs-string">$P</span></span>asswordArray[<span class="hljs-string"><span class="hljs-string">$R</span></span>ndIndexArray[<span class="hljs-number"><span class="hljs-number">3</span></span>]] = <span class="hljs-string"><span class="hljs-string">$c</span></span>har4 return [system.string]::<span class="hljs-type"><span class="hljs-type">Join</span></span>(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">$P</span></span>asswordArray) } <span class="hljs-type"><span class="hljs-type">End</span></span>{} } <span class="hljs-symbol"><span class="hljs-symbol">#SMTP</span></span>    <span class="hljs-string"><span class="hljs-string">$s</span></span>mtpServer = <span class="hljs-comment"><span class="hljs-comment">"mail.domain.local"</span></span> #   <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = new-object <span class="hljs-type"><span class="hljs-type">Net</span></span>.<span class="hljs-type"><span class="hljs-type">Mail</span></span>.<span class="hljs-type"><span class="hljs-type">MailMessage</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sgr = new-object <span class="hljs-type"><span class="hljs-type">Net</span></span>.<span class="hljs-type"><span class="hljs-type">Mail</span></span>.<span class="hljs-type"><span class="hljs-type">MailMessage</span></span> #    <span class="hljs-string"><span class="hljs-string">$s</span></span>mtp = new-object <span class="hljs-type"><span class="hljs-type">Net</span></span>.<span class="hljs-type"><span class="hljs-type">Mail</span></span>.<span class="hljs-type"><span class="hljs-type">SmtpClient</span></span>(<span class="hljs-string"><span class="hljs-string">$s</span></span>mtpServer) #     <span class="hljs-type"><span class="hljs-type">Function</span></span> <span class="hljs-type"><span class="hljs-type">EmailStructure</span></span>(<span class="hljs-string"><span class="hljs-string">$t</span></span>o,<span class="hljs-string"><span class="hljs-string">$e</span></span>xpiryDate,<span class="hljs-string"><span class="hljs-string">$u</span></span>pn) { <span class="hljs-string"><span class="hljs-string">$m</span></span>sg.<span class="hljs-type"><span class="hljs-type">IsBodyHtml</span></span> = <span class="hljs-string"><span class="hljs-string">$t</span></span>rue <span class="hljs-string"><span class="hljs-string">$m</span></span>sg.<span class="hljs-type"><span class="hljs-type">From</span></span> = <span class="hljs-comment"><span class="hljs-comment">"ITHelpDesk@domain.local"</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg.<span class="hljs-type"><span class="hljs-type">To</span></span>.<span class="hljs-type"><span class="hljs-type">Clear</span></span>() <span class="hljs-string"><span class="hljs-string">$m</span></span>sg.<span class="hljs-type"><span class="hljs-type">To</span></span>.<span class="hljs-type"><span class="hljs-type">Add</span></span>(<span class="hljs-string"><span class="hljs-string">$t</span></span>o) <span class="hljs-string"><span class="hljs-string">$m</span></span>sg.<span class="hljs-type"><span class="hljs-type">Subject</span></span> = <span class="hljs-comment"><span class="hljs-comment">"Password expiration notice"</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg.<span class="hljs-type"><span class="hljs-type">Body</span></span> = <span class="hljs-comment"><span class="hljs-comment">"&lt;html&gt;&lt;body&gt;&lt;font face='Arial'&gt;This is an automatically generated message from Company IT Service.&lt;br&gt;&lt;br&gt; &lt;b&gt;Please note that the password for your account &lt;i&gt;&lt;u&gt;domain\$upn&lt;/u&gt;&lt;/i&gt; will expire on $expiryDate.&lt;/b&gt;&lt;br&gt;&lt;br&gt; System automatically generated a new password for you. &lt;br&gt; You can use password - &lt;b&gt;$generated_password&lt;/b&gt;&lt;br&gt; Please change your password immediately or at least before this date as you will be unable to access the service without contacting your administrator.&lt;br&gt; If you will not change your password, System set it automatically.&lt;br&gt; &lt;/font&gt;&lt;/body&gt;&lt;/html&gt;"</span></span>} #     <span class="hljs-type"><span class="hljs-type">Function</span></span> <span class="hljs-type"><span class="hljs-type">EmailStructureReport</span></span>(<span class="hljs-string"><span class="hljs-string">$t</span></span>o) { <span class="hljs-string"><span class="hljs-string">$m</span></span>sgr.<span class="hljs-type"><span class="hljs-type">IsBodyHtml</span></span> = <span class="hljs-string"><span class="hljs-string">$t</span></span>rue <span class="hljs-string"><span class="hljs-string">$m</span></span>sgr.<span class="hljs-type"><span class="hljs-type">From</span></span> = <span class="hljs-comment"><span class="hljs-comment">"PasswordChecker@domain.local"</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sgr.<span class="hljs-type"><span class="hljs-type">To</span></span>.<span class="hljs-type"><span class="hljs-type">Add</span></span>(<span class="hljs-string"><span class="hljs-string">$t</span></span>o) <span class="hljs-string"><span class="hljs-string">$m</span></span>sgr.<span class="hljs-type"><span class="hljs-type">Subject</span></span> = <span class="hljs-comment"><span class="hljs-comment">"Script running report"</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sgr.<span class="hljs-type"><span class="hljs-type">Body</span></span> = <span class="hljs-comment"><span class="hljs-comment">"&lt;html&gt;&lt;body&gt;&lt;font face='Arial'&gt;&lt;b&gt;This is a daily report.&lt;br&gt; &lt;br&gt;Script for check expiried passwords has successfully completed its work. &lt;br&gt;$NotificationCounter users have recieved notifications:&lt;br&gt; &lt;br&gt;$ListOfAccounts&lt;br&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/body&gt;&lt;/html&gt;"</span></span>} #      <span class="hljs-type"><span class="hljs-type">Active</span></span> <span class="hljs-type"><span class="hljs-type">Directory</span></span> <span class="hljs-type"><span class="hljs-type">Import</span></span>-<span class="hljs-type"><span class="hljs-type">Module</span></span> activedirectory #      ,       <span class="hljs-string"><span class="hljs-string">$N</span></span>otificationCounter = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-string"><span class="hljs-string">$O</span></span>U = <span class="hljs-comment"><span class="hljs-comment">"OU=Russia,DC=local,DC=domain"</span></span> <span class="hljs-string"><span class="hljs-string">$A</span></span>DAccounts = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">ADUser</span></span> -<span class="hljs-type"><span class="hljs-type">LDAPFilter</span></span> <span class="hljs-comment"><span class="hljs-comment">"(objectClass=user)"</span></span> -searchbase <span class="hljs-string"><span class="hljs-string">$O</span></span>U -properties <span class="hljs-type"><span class="hljs-type">PasswordExpired</span></span>, employeeNumber, <span class="hljs-type"><span class="hljs-type">PasswordNeverExpires</span></span>, <span class="hljs-type"><span class="hljs-type">PasswordLastSet</span></span>, <span class="hljs-type"><span class="hljs-type">Mail</span></span>, mobile, <span class="hljs-type"><span class="hljs-type">Enabled</span></span> | <span class="hljs-type"><span class="hljs-type">Where</span></span>-object {<span class="hljs-string"><span class="hljs-string">$_</span></span>.<span class="hljs-type"><span class="hljs-type">Enabled</span></span> -eq <span class="hljs-string"><span class="hljs-string">$t</span></span>rue -and <span class="hljs-string"><span class="hljs-string">$_</span></span>.<span class="hljs-type"><span class="hljs-type">PasswordNeverExpires</span></span> -eq <span class="hljs-string"><span class="hljs-string">$f</span></span>alse} #    foreach (<span class="hljs-string"><span class="hljs-string">$A</span></span>DAccount in <span class="hljs-string"><span class="hljs-string">$A</span></span>DAccounts) #    { <span class="hljs-string"><span class="hljs-string">$a</span></span>ccountFGPP = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">ADUserResultantPasswordPolicy</span></span> <span class="hljs-string"><span class="hljs-string">$A</span></span>DAccount if (<span class="hljs-string"><span class="hljs-string">$a</span></span>ccountFGPP -ne <span class="hljs-string"><span class="hljs-string">$n</span></span>ull) { <span class="hljs-string"><span class="hljs-string">$m</span></span>axPasswordAgeTimeSpan = <span class="hljs-string"><span class="hljs-string">$a</span></span>ccountFGPP.<span class="hljs-type"><span class="hljs-type">MaxPasswordAge</span></span> } else { <span class="hljs-string"><span class="hljs-string">$m</span></span>axPasswordAgeTimeSpan = (<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">ADDefaultDomainPasswordPolicy</span></span>).<span class="hljs-type"><span class="hljs-type">MaxPasswordAge</span></span> } #    <span class="hljs-string"><span class="hljs-string">$s</span></span>amAccountName = <span class="hljs-string"><span class="hljs-string">$A</span></span>DAccount.samAccountName <span class="hljs-string"><span class="hljs-string">$u</span></span>serEmailAddress = <span class="hljs-string"><span class="hljs-string">$A</span></span>DAccount.mail <span class="hljs-string"><span class="hljs-string">$u</span></span>serPrincipalName = <span class="hljs-string"><span class="hljs-string">$A</span></span>DAccount.<span class="hljs-type"><span class="hljs-type">UserPrincipalName</span></span> <span class="hljs-string"><span class="hljs-string">$u</span></span>serStorePassword = <span class="hljs-string"><span class="hljs-string">$A</span></span>DAccount.employeeNumber <span class="hljs-string"><span class="hljs-string">$u</span></span>sermobile = <span class="hljs-string"><span class="hljs-string">$A</span></span>DAccount.mobile #    ,     if (<span class="hljs-string"><span class="hljs-string">$A</span></span>DAccount.<span class="hljs-type"><span class="hljs-type">PasswordExpired</span></span>) { #      <span class="hljs-type"><span class="hljs-type">AD</span></span> #     ,     - <span class="hljs-type"><span class="hljs-type">Pa</span></span><span class="hljs-string"><span class="hljs-string">$$</span></span>w0rd if (<span class="hljs-string"><span class="hljs-string">$u</span></span>serStorePassword -eq <span class="hljs-string"><span class="hljs-string">$N</span></span>ULL -or <span class="hljs-string"><span class="hljs-string">$u</span></span>seStorePassword -eq <span class="hljs-comment"><span class="hljs-comment">" "</span></span>) { <span class="hljs-string"><span class="hljs-string">$u</span></span>serStorePassword = <span class="hljs-comment"><span class="hljs-comment">"Pa$$w0rd"</span></span> } #     <span class="hljs-string"><span class="hljs-string">$n</span></span>ewpwd = <span class="hljs-type"><span class="hljs-type">ConvertTo</span></span>-<span class="hljs-type"><span class="hljs-type">SecureString</span></span> -<span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-string"><span class="hljs-string">$u</span></span>serStorePassword -<span class="hljs-type"><span class="hljs-type">AsPlainText</span></span> ‚Äì<span class="hljs-type"><span class="hljs-type">Force</span></span> <span class="hljs-type"><span class="hljs-type">Set</span></span>-<span class="hljs-type"><span class="hljs-type">ADAccountPassword</span></span> -<span class="hljs-type"><span class="hljs-type">Identity</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>amAccountName -<span class="hljs-type"><span class="hljs-type">NewPassword</span></span> <span class="hljs-string"><span class="hljs-string">$n</span></span>ewpwd ‚Äì<span class="hljs-type"><span class="hljs-type">Reset</span></span> #         <span class="hljs-type"><span class="hljs-type">TXT</span></span>  if (<span class="hljs-string"><span class="hljs-string">$u</span></span>sermobile -ne <span class="hljs-string"><span class="hljs-string">$N</span></span>ULL) { <span class="hljs-string"><span class="hljs-string">$S</span></span>MSfile=<span class="hljs-comment"><span class="hljs-comment">"C:\ActiveDirectory\SMS_notice.txt"</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>MSMessage=<span class="hljs-string"><span class="hljs-string">$u</span></span>sermobile + <span class="hljs-comment"><span class="hljs-comment">","</span></span> + <span class="hljs-string"><span class="hljs-string">$u</span></span>serStorePassword <span class="hljs-type"><span class="hljs-type">Out</span></span>-<span class="hljs-type"><span class="hljs-type">File</span></span> -<span class="hljs-type"><span class="hljs-type">FilePath</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>MSfile -<span class="hljs-type"><span class="hljs-type">InputObject</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>MSMessage -<span class="hljs-type"><span class="hljs-type">Append</span></span> -encoding unicode } #     write-log <span class="hljs-comment"><span class="hljs-comment">"for $samAccountName will set a stored password - $userStorePassword. Message send to mobile - $usermobile"</span></span> write-log <span class="hljs-comment"><span class="hljs-comment">"---------------------------------------------------------------------------------------------------------"</span></span> #    <span class="hljs-type"><span class="hljs-type">AD</span></span> <span class="hljs-type"><span class="hljs-type">Set</span></span>-<span class="hljs-type"><span class="hljs-type">ADUser</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>amAccountName -employeeNumber <span class="hljs-string"><span class="hljs-string">$n</span></span>ull } else #   ,     ,   <span class="hljs-string"><span class="hljs-string">$D</span></span>aysToExpireDD  <span class="hljs-number"><span class="hljs-number">2</span></span> { <span class="hljs-string"><span class="hljs-string">$E</span></span>xpiryDate = <span class="hljs-string"><span class="hljs-string">$A</span></span>DAccount.<span class="hljs-type"><span class="hljs-type">PasswordLastSet</span></span> + <span class="hljs-string"><span class="hljs-string">$m</span></span>axPasswordAgeTimeSpan <span class="hljs-string"><span class="hljs-string">$T</span></span>odaysDate = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Date</span></span> <span class="hljs-string"><span class="hljs-string">$D</span></span>aysToExpire = <span class="hljs-string"><span class="hljs-string">$E</span></span>xpiryDate - <span class="hljs-string"><span class="hljs-string">$T</span></span>odaysDate #     <span class="hljs-type"><span class="hljs-type">DaysToExpireDD</span></span>    <span class="hljs-string"><span class="hljs-string">$D</span></span>aysToExpireDD = <span class="hljs-string"><span class="hljs-string">$D</span></span>aysToExpire.<span class="hljs-type"><span class="hljs-type">ToString</span></span>() -<span class="hljs-type"><span class="hljs-type">Split</span></span> (<span class="hljs-comment"><span class="hljs-comment">"\S{17}$"</span></span>) if ((<span class="hljs-string"><span class="hljs-string">$D</span></span>aysToExpire.<span class="hljs-type"><span class="hljs-type">Days</span></span> -le <span class="hljs-number"><span class="hljs-number">2</span></span>)) { <span class="hljs-type"><span class="hljs-type">Write</span></span>-log <span class="hljs-comment"><span class="hljs-comment">"The password for account $samAccountName expires on: $ExpiryDate. Days left: $DaysToExpireDD #      $generated_password $generated_password = Get-RandomPassword 10 write-log "</span></span><span class="hljs-type"><span class="hljs-type">Generated</span></span> password: <span class="hljs-string"><span class="hljs-string">$s</span></span>amAccountName - <span class="hljs-string"><span class="hljs-string">$g</span></span>enerated_password<span class="hljs-comment"><span class="hljs-comment">" write-log "</span></span>-----------------------------------------------------------------------------------------<span class="hljs-comment"><span class="hljs-comment">" #      e AD.    employeeNumber Set-ADUser $samAccountName -employeeNumber $generated_password #      if ($userEmailAddress) #      . { EmailStructure $userEmailAddress $expiryDate $samAccountName $smtp.Send($msg) write-log "</span></span><span class="hljs-type"><span class="hljs-type">NOTIFICATION</span></span> - <span class="hljs-string"><span class="hljs-string">$s</span></span>amAccountName :: e-mail was sent to <span class="hljs-string"><span class="hljs-string">$u</span></span>serEmailAddress<span class="hljs-comment"><span class="hljs-comment">" $NotificationCounter = $NotificationCounter + 1 $ListOfAccounts = $ListOfAccounts + $samAccountName + "</span></span> - <span class="hljs-string"><span class="hljs-string">$D</span></span>aysToExpireDD days left. <span class="hljs-type"><span class="hljs-type">Sent</span></span> to <span class="hljs-string"><span class="hljs-string">$u</span></span>serEmailAddress&lt;br&gt;<span class="hljs-comment"><span class="hljs-comment">" } } } } #     ,    SMS #    If (Test-Path $SMSfile) { Copy-Item -Path $SMSfile -Destination \\SMS-Send-Server.domain.local\C$\ActiveDirectory\SMS_notice.txt #       Remove-Item $SMSfile } #     Write-log "</span></span><span class="hljs-type"><span class="hljs-type">SENDING</span></span> <span class="hljs-type"><span class="hljs-type">REPORT</span></span> <span class="hljs-type"><span class="hljs-type">TO</span></span> <span class="hljs-type"><span class="hljs-type">IT</span></span> <span class="hljs-type"><span class="hljs-type">DEPARTMENT</span></span><span class="hljs-comment"><span class="hljs-comment">" EmailStructureReport("</span></span><span class="hljs-type"><span class="hljs-type">ITHelpdesk</span></span>@domain.local<span class="hljs-comment"><span class="hljs-comment">") $smtp.Send($msgr)</span></span></code> </pre> <br>  We will add this script to the Windows Task Scheduler, setting it up for execution at the right time.  For example, at night. <br><br>  Unfortunately, the script checks expired passwords at the time of its execution.  So if the password expires in the afternoon, it will not take it into account.  But we don‚Äôt need it, because during working hours the employee can change the password on his own. <br><br>  As a result, we get a list of mobile numbers of users who have a new password.  We will send this list to the server to which the GSM modem is connected.  And there the following script will deal with this list. <br><br><pre> <code class="hljs smalltalk"># #            # # ,      <span class="hljs-string"><span class="hljs-string">$s</span></span>ms_text_filename = <span class="hljs-comment"><span class="hljs-comment">"SMS_notice.txt"</span></span> <span class="hljs-string"><span class="hljs-string">$P</span></span>athToSmsPrepareToSend = <span class="hljs-comment"><span class="hljs-comment">"C:\ActiveDirectory"</span></span> + <span class="hljs-comment"><span class="hljs-comment">"\"</span></span> + <span class="hljs-string"><span class="hljs-string">$s</span></span>ms_text_filename <span class="hljs-string"><span class="hljs-string">$d</span></span>t=<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Date</span></span> -<span class="hljs-type"><span class="hljs-type">Format</span></span> <span class="hljs-comment"><span class="hljs-comment">"dd.MM.yyyy"</span></span> # ,       <span class="hljs-string"><span class="hljs-string">$o</span></span>f=<span class="hljs-comment"><span class="hljs-comment">"C:\ActiveDirectory\Log\"</span></span>+<span class="hljs-string"><span class="hljs-string">$d</span></span>t+<span class="hljs-comment"><span class="hljs-comment">"_LOG.log"</span></span> #     <span class="hljs-type"><span class="hljs-type">If</span></span> (<span class="hljs-type"><span class="hljs-type">Test</span></span>-<span class="hljs-type"><span class="hljs-type">Path</span></span> <span class="hljs-string"><span class="hljs-string">$P</span></span>athToSmsPrepareToSend) { <span class="hljs-string"><span class="hljs-string">$S</span></span>MS = <span class="hljs-type"><span class="hljs-type">Import</span></span>-<span class="hljs-type"><span class="hljs-type">Csv</span></span> <span class="hljs-string"><span class="hljs-string">$P</span></span>athToSmsPrepareToSend -<span class="hljs-type"><span class="hljs-type">Header</span></span> mobile, newpassword #       foreach (<span class="hljs-string"><span class="hljs-string">$S</span></span>M in <span class="hljs-string"><span class="hljs-string">$S</span></span>MS) { # <span class="hljs-string"><span class="hljs-string">$m</span></span>obileForSMS = <span class="hljs-string"><span class="hljs-string">$S</span></span>M.mobile # <span class="hljs-string"><span class="hljs-string">$p</span></span>asswordFroSMS = <span class="hljs-string"><span class="hljs-string">$S</span></span>M.newpassword # echo <span class="hljs-string"><span class="hljs-string">$m</span></span>obileForSMS #    <span class="hljs-type"><span class="hljs-type">SerialPort</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort = new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">IO</span></span>.<span class="hljs-type"><span class="hljs-type">Ports</span></span>.<span class="hljs-type"><span class="hljs-type">SerialPort</span></span> #    ,     &lt;# !!!!!! <span class="hljs-type"><span class="hljs-type">USB</span></span>-   <span class="hljs-type"><span class="hljs-type">COM</span></span> .   ,        .   <span class="hljs-type"><span class="hljs-type">GSM</span></span>-   <span class="hljs-type"><span class="hljs-type">USB</span></span> ,   <span class="hljs-type"><span class="hljs-type">COM</span></span>  . #&gt; <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">PortName</span></span> = <span class="hljs-comment"><span class="hljs-comment">"COM3"</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">BaudRate</span></span> = <span class="hljs-number"><span class="hljs-number">115200</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">WriteTimeout</span></span> = <span class="hljs-number"><span class="hljs-number">500</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">ReadTimeout</span></span> = <span class="hljs-number"><span class="hljs-number">3000</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">DtrEnable</span></span> = <span class="hljs-comment"><span class="hljs-comment">"true"</span></span> #   # <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">Open</span></span>() #        #       <span class="hljs-string"><span class="hljs-string">$p</span></span>honeNumber = [<span class="hljs-type"><span class="hljs-type">Regex</span></span>]::replace(<span class="hljs-string"><span class="hljs-string">$S</span></span>M.mobile,<span class="hljs-string"><span class="hljs-string">'\s'</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-string"><span class="hljs-string">$t</span></span>extMessage = <span class="hljs-comment"><span class="hljs-comment">"Your new password - "</span></span> + <span class="hljs-string"><span class="hljs-string">$S</span></span>M.newpassword try { <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">Open</span></span>() } catch { #  <span class="hljs-number"><span class="hljs-number">5</span></span>     <span class="hljs-type"><span class="hljs-type">Sleep</span></span> -<span class="hljs-type"><span class="hljs-type">Milliseconds</span></span> <span class="hljs-number"><span class="hljs-number">500</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">Open</span></span>() } <span class="hljs-type"><span class="hljs-type">If</span></span> (<span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">IsOpen</span></span> -eq <span class="hljs-string"><span class="hljs-string">$t</span></span>rue) { #  ,     <span class="hljs-type"><span class="hljs-type">AT</span></span>- <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">Write</span></span>(<span class="hljs-comment"><span class="hljs-comment">"AT+CMGF=1`r`n"</span></span>) <span class="hljs-type"><span class="hljs-type">Sleep</span></span> -<span class="hljs-type"><span class="hljs-type">Milliseconds</span></span> <span class="hljs-number"><span class="hljs-number">500</span></span> #     #       #   &lt;<span class="hljs-type"><span class="hljs-type">CL</span></span>&gt;   <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">Write</span></span>(<span class="hljs-comment"><span class="hljs-comment">"AT+CMGS=`"</span></span><span class="hljs-string"><span class="hljs-string">$p</span></span>honeNumber`<span class="hljs-comment"><span class="hljs-comment">"`r`n"</span></span>) #      <span class="hljs-type"><span class="hljs-type">Sleep</span></span> -<span class="hljs-type"><span class="hljs-type">Milliseconds</span></span> <span class="hljs-number"><span class="hljs-number">500</span></span> #      <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">Write</span></span>(<span class="hljs-comment"><span class="hljs-comment">"$textMessage`r`n"</span></span>) <span class="hljs-type"><span class="hljs-type">Sleep</span></span> -<span class="hljs-type"><span class="hljs-type">Milliseconds</span></span> <span class="hljs-number"><span class="hljs-number">500</span></span> #    <span class="hljs-type"><span class="hljs-type">Ctrl</span></span>+<span class="hljs-type"><span class="hljs-type">Z</span></span>    . <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">Write</span></span>(<span class="hljs-string"><span class="hljs-string">$(</span></span>[char] <span class="hljs-number"><span class="hljs-number">26</span></span>)) # ,     <span class="hljs-type"><span class="hljs-type">Sleep</span></span> -<span class="hljs-type"><span class="hljs-type">Milliseconds</span></span> <span class="hljs-number"><span class="hljs-number">500</span></span> } #   <span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">Close</span></span>() if (<span class="hljs-string"><span class="hljs-string">$s</span></span>erialPort.<span class="hljs-type"><span class="hljs-type">IsOpen</span></span> -eq <span class="hljs-string"><span class="hljs-string">$f</span></span>alse) { #     <span class="hljs-string"><span class="hljs-string">$d</span></span>ts=<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Date</span></span> -<span class="hljs-type"><span class="hljs-type">Format</span></span> <span class="hljs-comment"><span class="hljs-comment">"dd.MM.yyyy HH:mm:ss"</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg=<span class="hljs-string"><span class="hljs-string">$d</span></span>ts+<span class="hljs-comment"><span class="hljs-comment">" :Message "</span></span>+<span class="hljs-string"><span class="hljs-string">$t</span></span>extMessage+<span class="hljs-comment"><span class="hljs-comment">" send to "</span></span>+ <span class="hljs-string"><span class="hljs-string">$p</span></span>honeNumber <span class="hljs-type"><span class="hljs-type">Out</span></span>-<span class="hljs-type"><span class="hljs-type">File</span></span> -<span class="hljs-type"><span class="hljs-type">FilePath</span></span> <span class="hljs-string"><span class="hljs-string">$o</span></span>f -<span class="hljs-type"><span class="hljs-type">InputObject</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg -<span class="hljs-type"><span class="hljs-type">Append</span></span> -encoding unicode } <span class="hljs-type"><span class="hljs-type">Sleep</span></span> -<span class="hljs-type"><span class="hljs-type">Milliseconds</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> } #      #         <span class="hljs-string"><span class="hljs-string">$n</span></span>ewname =<span class="hljs-string"><span class="hljs-string">$d</span></span>t+<span class="hljs-comment"><span class="hljs-comment">"_"</span></span>+<span class="hljs-string"><span class="hljs-string">$s</span></span>ms_text_filename rename-item -path <span class="hljs-string"><span class="hljs-string">$P</span></span>athToSmsPrepareToSend -newname <span class="hljs-string"><span class="hljs-string">$n</span></span>ewname } #    <span class="hljs-type"><span class="hljs-type">Else</span></span> #      { #    ,       <span class="hljs-string"><span class="hljs-string">$d</span></span>ts=<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Date</span></span> -<span class="hljs-type"><span class="hljs-type">Format</span></span> <span class="hljs-comment"><span class="hljs-comment">"dd.MM.yyyy HH:mm:ss"</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg=<span class="hljs-string"><span class="hljs-string">$d</span></span>ts + <span class="hljs-comment"><span class="hljs-comment">" :No data to send SMS"</span></span> <span class="hljs-type"><span class="hljs-type">Out</span></span>-<span class="hljs-type"><span class="hljs-type">File</span></span> -<span class="hljs-type"><span class="hljs-type">FilePath</span></span> <span class="hljs-string"><span class="hljs-string">$o</span></span>f -<span class="hljs-type"><span class="hljs-type">InputObject</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg -<span class="hljs-type"><span class="hljs-type">Append</span></span> -encoding unicode }</code> </pre><br>  Scripts tested in combat conditions and showed their best side. <br><br>  I will not explain why I did this, because the task was quite specific.  And the decision was quite specific. <br><br>  But I will welcome any advice on how to improve or optimize the scripts. <br><br>  <b>UPD:</b> <br>  I got an interesting error. <br>  Importing passwords from a text file is based on the Import-Csv function, which rightly considers the comma as a field separator. <br>  And the password generator quite actively uses the comma as one of the special characters. <br>  As a result, the password was set to normal length, as expected, but in the SMS the user got a ‚Äúcropped‚Äù password. <br>  The solution is simple: if you cannot use a comma, we will use an asterisk (they love it more than punctuation) <br>  Add a line immediately after generating the password: <br><pre> <code class="hljs perl">$generated_password = $generated_password_comma -replace <span class="hljs-string"><span class="hljs-string">","</span></span>,<span class="hljs-string"><span class="hljs-string">"*"</span></span></code> </pre><br><br>  An annoying trifle, unreasoned in advance ( <i>mea culpa</i> ), and the trust of users has shattered great. </div><p>Source: <a href="https://habr.com/ru/post/255197/">https://habr.com/ru/post/255197/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255187/index.html">How to change font name</a></li>
<li><a href="../255189/index.html">The global importance of English, German, Russian, Chinese and other languages ‚Äã‚Äãon the Internet (Data Mining)</a></li>
<li><a href="../255191/index.html">Bindings from vendor bundle to the working project Symfony2</a></li>
<li><a href="../255193/index.html">The story of an attempt to become a startup or give a project in Open Source</a></li>
<li><a href="../255195/index.html">Manipulating the BEM structure with Bemy</a></li>
<li><a href="../255199/index.html">We turn from STM32F103 to K1986BE92QI. Or the first acquaintance with the Russian microcontroller</a></li>
<li><a href="../255201/index.html">Habr, hello from the ringcloud cloud</a></li>
<li><a href="../255203/index.html">New in Cach√© 2015.1: SQL Index on Array Property Elements</a></li>
<li><a href="../255205/index.html">Homomorphic encryption</a></li>
<li><a href="../255207/index.html">Complete energy autonomy or how to survive with solar panels in the outback (part 4. Made in Russia)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>