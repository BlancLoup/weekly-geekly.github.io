<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Marriage Task and Returns Mode</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bektrekinge - a mechanism for solving quasi problems. Allows you to choose either 1 acceptable alternative or the best. 

 The essence of the return m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Marriage Task and Returns Mode</h1><div class="post__text post__text-html js-mediator-article"> Bektrekinge - a mechanism for solving quasi problems.  Allows you to choose either 1 acceptable alternative or the best. <br><a name="habracut"></a><br>  The essence of the return mode is as follows.  In the program there are points "forks" - points at which it is necessary to choose one of the behaviors ("alternatives").  In the future, it may be that the chosen option is ‚Äúunsuccessful‚Äù and you need to return to the fork and select some other alternative. <br><br>  Bektrekkinga feature is that there is a rollback on management, as well as data.  When a program is rolled back, the program ‚Äúforgets‚Äù everything that it did as a result of choosing an unsuccessful alternative - the data restores its previous values, all the consequences of choosing an alternative are canceled.  After the rollback, take the next alternative and re-perform all the actions.  We check which alternatives are acceptable to us.  If all alternatives fail in this fork, the failure propagates to the overlying fork. <br><br>  Bektreking provides: <br>  - rollback control; <br>  - rollback by data; <br>  - enumeration of the list of alternatives. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are actions not subject to rollback.  Example: print on screen, printer, etc. <br><br>  Forks can be divided into local (visible only in its subroutine) and global (even the subroutine is complete, the fork is visible). <br>  Therefore, it is possible rollback entry into the procedure.  The procedure is completely restored, all local variables, their values ‚Äã‚Äãand the history of their values ‚Äã‚Äãare restored. <br><br>  Variants of the organization: <br>  - data and actions can be selected as alternatives;  (array of procedural labels) <br><br>  - list of alternatives: fixed, dynamically calculated, may not be stored at all; <br><br>  - automatic reordering of the set of alternatives. <br>  Predict which alternative will bring success.  (prediction requires resources.).  but turning over alternatives we will come to the result. <br><br>  - perhaps the absence of the design ‚Äúfailure‚Äù;  (there is a design for establishing a fork or not) <br><br>  - rollback is possible: to the nearest fork, to the specified statically / dynamically, automatic determination of the desired fork; <br>  If we have sifted through all the alternatives, then we are failing to spread to the top. <br>  In order not to roll back in steps, but to the one you want is necessary: <br>  1. mark all fork and roll back <br>  2. rollback to a fork is determined dynamically. <br><br>  - automatic detection of fork. <br>  Rollback within the program <br>  Rollback to a Called Subroutine <br>  Rollback to complete subroutine. <br>  If it is possible to roll back to the fork after the completion of the procedure, then the outer fork. <br>  Irreversible action - actions that are not canceled during a rollback may exist, may not exist. <br>  - it is possible to disable the return mode, dynamically / statically, fully / partially; <br><br>  - can be associated with a message failure signal, and the possibility of program analysis. <br><br>  There are languages ‚Äã‚Äãthat, in their implementation, support bektreking (Prolog, Plener).  Within the framework of this article, I will consider emulation of the return mode in languages ‚Äã‚Äãthat do not explicitly support it.  In the article for writing listing, I will use Pascal-like pseudocode, so as not to be distracted by the syntax. <br><br>  Scheme for the implementation of bektrekinga procedurally-oriented language. <br>  In this approach, the forks are emulated using recursion, and enumerating alternatives using a cycle. <br> <code>procedure TryAlt(N:trazvilka; var uspeh:boolean); <br> begin <br> {  } <br> uspeh:=false; <br> repeat {  } <br> if { } then begin { } <br> if { (  )} then <br> uspeh:=true <br> else begin <br> try(N+1;uspeh);{   } <br> if uspeh then <br> {   } <br> { } <br> end; <br> end; <br> until uspeh or    <br> end.</code> <br> <br><h4>  The problem of stable marriages <br></h4><br>  Suppose that two disjoint sets A and B are given of equal size n.  It is required to find a set of n &lt;a, b&gt; pairs - such that a from A and b from B satisfy some constraints.  Distribution criteria may be many.  We consider one of them, which is called the rule of stable marriages. <br>  Let A be a set of men, and B a set of women.  Every man and woman indicated their preferred partners.  If couples are formed in such a way that there are a man and a woman who are husband and wife, but who would prefer each other to their actual spouses, then this distribution will be unstable.  If there are no such pairs, then the distribution is stable.  It should be noted that the list of distributions remains unchanged even after the distribution is made in pairs. <br>  A possible direction for finding a solution is to try to distribute the pairs of the two sets one by one into pairs until both sets are exhausted.  To solve this problem, we use the backtreaming scheme, slightly modifying it in the direction of simplification. <br><br> <code>Procedure tryMan (m : man); <br> Var <br> R : rang; <br> Begin <br> If m &lt; n then <br> For r := 1 to n do begin <br>  r-     m <br> If  then begin <br>  ; <br> Try (  m); <br>  ; <br> End; <br> end; <br> else <br>    <br> end; <br></code> <br>  Baseline data is represented by two matrices indicating the preferences of men and women. <br> <code>Var <br> womanForMan : array [1..n,1..n] of woman <br> manForWoman : array [1..n,1..n] of man</code> <br>  Accordingly, womanForMan [m, r] is a woman in the list of male m in r-th place.  Similarly, manForWoman [w, r] is a man in the list of woman w in r-th place. <br>  The result is represented by an array of woman so that woman [m] denotes the spouse of male m.  For symmetry, we introduce man such that man [w] denotes the spouse of the man w.  In fact, the man array is redundant since it contains information already contained in a woman.  Information in the man and woman arrays is needed to determine the stability of the intended set of marriages.  Since this set is built step by step by connecting the individuals into pairs and checking the stability after each alleged marriage, the man and woman arrays are needed before all the components are defined.  To keep track of which components are already defined, we introduce boolean arrays: <br>  singleMan, SingleWoman: array [1..n] of Boolean <br>  the truth of the component means that the corresponding man (woman) is free. <br>  they can be used to clarify the predicate is admissible as a singleWoman [w] conjunction &amp; the marriage is stable, where the predicate marriage is stable has yet to be defined. <br><br>  The key task now is to clarify the algorithm for determining stability.  The first feature to keep in mind is that, by definition, stability follows from a comparison of ranks (that is, positions in a list of preferences).  However, nowhere in our collection of data defined so far, there are no directly accessible ranks of men and women.  Of course, they can be calculated from the womanForMan and manForWoman values, but since stability calculation is a very frequent operation, it is advisable to provide more direct access to this information.  To do this, we introduce two matrices, <br>  Rmw: array [man, woman] of rang; <br>  Rwm: array [woman, man] of rang; <br>  In this case, rmw [m, w] denotes the rank of a woman w in the list of male m, and rwm [w, m] is the rank of male m in the list of female w.  The values ‚Äã‚Äãof these auxiliary matrices do not change and can be determined at the very beginning by the values ‚Äã‚Äãof womanForMan and manForWoman. <br>  Now the predicate Marriage is stable can be calculated exactly following its definition.  Let me remind you that we need to check the ability to connect by marriage m and w, where w = womanForMan [m, r].  To begin with, suppose that such a marriage is permissible, and then we will try to detect interference with the stability of this marriage.  There may be two such interferences: <br>  1) There may be a woman pw with a rank higher than that of w, according to m, and who herself prefers m to her husband; <br>  2) There may be a pm man with a rank higher than that of m, according to w, and who himself prefers w to his wife <br>  To detect interference of the first kind, compare the ranks rwm [pw, m] and rwm [pw, man [pw]] for all women that m prefers w, that is, for all pw = womanForMan [m, i] such that i &lt; r.  We are in fact all women pw are already married, since, had any of them not yet been married, m would have chosen her even earlier.  To detect interference of the second kind, you need to check all candidates pm, which w prefers over their current pair m, that is, all men pm = manForWoman [w, i], i &lt;rwm [w, m], by analogy with the first case, however Do not forget to miss the comparison with the subject woman [pm], where pm is not yet married.  This is ensured by checking pm &lt;m, since we know that all men up to m are married. <br><br>  The full text of the stability check procedure looks like this. <br> <code>Function stable(m, w, r : integer) : Boolean; <br> Var <br> Pw, pm, I, lim : integer; <br> S : Boolean; <br> <br> Begin <br> I := 0; s := true; <br> Repeat <br> Inc(i); <br> If i&lt;r then begin <br> Pw := womanForMan[m,i]; <br> If not(singleWoman[pw]) then <br> S := rwm[pw,m] &gt;rwmn[pw,man[pw]]; <br> End; <br> Until (i=r) or (not(s)); <br> <br> I := ;0 lim := rwm[w,m]; <br> Repeat <br> Inc(i); <br> If I &lt; lim then begin <br> Pm := manForWoman[w,i]; <br> If pm&lt;m then <br> S := rmw[pm,w]&gt;rmw[pm,woman[pm] <br> End; <br> Until (i=lim) or (nor(s)); <br> End; <br></code> <br><h4>  Conclusion </h4><br>  This algorithm generates all possible solutions and can be modified in such a way that either the solution is optimal for men, or for women, or average.  It all depends on the purpose for which this algorithm is used. </div><p>Source: <a href="https://habr.com/ru/post/126438/">https://habr.com/ru/post/126438/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126432/index.html">Writing a ‚Äúdraftsman‚Äù for iPhone on HTML5 Canvas</a></li>
<li><a href="../126433/index.html">Ramos W6HD - replacing a paladin or tablet for $ 100</a></li>
<li><a href="../126435/index.html">GitHub now allows editing code with syntax highlighting.</a></li>
<li><a href="../126436/index.html">Debian Project 18 years</a></li>
<li><a href="../126437/index.html">Service selection of names and names from idea to implementation or Django as an excellent platform for startups. Continuation</a></li>
<li><a href="../126440/index.html">Linux Mint 11 LXDE Released</a></li>
<li><a href="../126441/index.html">New tablet Samsung Galaxy Tab 10.1</a></li>
<li><a href="../126442/index.html">Chinese online store from the inside</a></li>
<li><a href="../126443/index.html">Jelastic - easy and fast swap domains between environments</a></li>
<li><a href="../126445/index.html">International startup acceleration</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>