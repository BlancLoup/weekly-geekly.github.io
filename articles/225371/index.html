<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cubietruck. Cozy home server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently bought just such beauty. 
 I played with Android on it and decided to make a home server to replace RaspberryPI. 

 * The picture is not mine...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cubietruck. Cozy home server</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/1a9/c3a/e83/1a9c3ae831419e5ed62b0c44e5c86a15.jpg"><br>  Recently bought just such beauty. <br>  I played with Android on it and decided to make a home server to replace RaspberryPI. <br><a name="habracut"></a><br>  <i>* The picture is not mine ... if I take out the trash - I will make my own.</i> <br><blockquote><h6>  From the author, i.e.  me: <br>  Do not judge strictly, this is my first article. <br>  I will be glad to constructive criticism and help from more skilled users! <br>  Thank you in advance! </h6><br>  Based on - <a href="http://www.cubieforums.com/index.php/topic,1650.0.html">http://www.cubieforums.com/index.php/topic,1650.0.html</a> <a href="http://www.cubieforums.com/index.php/topic,1650.0.html"><br></a> </blockquote><br>  Well, let's start perhaps! <br><h5><ol><li>  Introduction </li><li>  System Installation <br><ul><li>  Installing the system in NAND </li><li>  Installing the system on SD </li><li>  Transferring the system to SATA </li><li>  Transferring the system to NAND </li></ul></li><li>  First start <br><ul><li>  SSH port change </li><li>  Network configuration </li><li>  Set time zone </li><li>  Auto mount HDD partition </li></ul></li><li>  Server Tuning <br><ul><li>  Installing Nginx + php5-fpm + mysql </li><li>  Installing the Transmission Client Torrent </li><li>  Install samba </li></ul></li><li>  Remote control Ajenti / Webmin </li></ol><br></h5><br><br><h4>  1. Introduction </h4><br>  The main task was to replace the raspberry with something more nimble and with a normal access speed to the hard disk, since  The main purpose of this server is file server, media server, torrent. <br>  Stopped at Cubietruck, she is the same Cubieboard3. <br>  Characteristics already slipped on <a href="http://habrahabr.ru/post/186576/">habrahabr.ru/post/186576</a> <br>  In addition, I bought a 1TB SATA HDD <a href="http://www.thg.ru/storage/obzor_hitachi_travelstar_7k1000_test/print.html">Hitachi 7K1000</a> <br>  <i>Since</i>  <i>on Habr√© did not see a complete guide to setting up this device, I decided to make my guide with go and geishas.</i> <i><br></i> <br><br><h4>  2. System installation </h4><br>  For CubieTruck'a there are several different distributions. <br>  Today I will consider installing and configuring Cubian. <br><h4>  Installing the system in NAND </h4><br>  <i>I personally do not like this installation option because</i>  <i>NAND has a limited number of write / rewrite cycles, and if you have a SQL server, these cycles will end very quickly.</i>  <i>IMHO!</i> <br>  Download the required image <a href="http://dl.cubieboard.org/software/a20-cubietruck/">here.</a> <br><h6>  If you are a Linux user, then: </h6><br>  Take LinuxSuite <a href="http://docs.cubieboard.org/tutorials/common/livesuit_installation_guide">from here</a> (there are 32 and 64-bit versions) <br>  Launch Livesuite <br><pre><code class="bash hljs">$ ~/Bin/LiveSuit/LiveSuit.sh</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">screen</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/072/9c5/176/0729c5176e64d0685aae99cfa111ec1b.png"></div></div><br>  Choose a fill image <br><div class="spoiler">  <b class="spoiler_title">screen</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/1a7/f6b/580/1a7f6b5801cba3b2e2c2dae888492262.png"></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Put the device in FEL mode <br>  1. Clamp the FEL button <br><div class="spoiler">  <b class="spoiler_title">screen</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/62d/7f5/f7e/62d7f5f7e759e715f257dc03b14cca01.png"></div></div><br>  2. Plug the miniusb cable into the board and wait for a request from Livesuite. <br>  ATTENTION: many USB ports will not give the necessary power to the board, so before clicking ‚ÄúYes‚Äù - connect the board to the power supply (5V is recommended at least 3A) <br>  3. Click "Yes" <br><div class="spoiler">  <b class="spoiler_title">screen</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/191/cd6/807/191cd68070296b0720f3f185e848ac03.png"></div></div><br><br>  Wait until the image is completely poured onto your device. <br><div class="spoiler">  <b class="spoiler_title">screen</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/2a3/690/671/2a36906715485219a4a1281c02dcd648.png"></div></div><br>  Now you can disconnect the device from the PC and run it separately)) <br><br><h6>  If you are a Windows user, then: </h6><br>  - Take <a href="http://docs.cubieboard.org/tutorials/common/livesuit_installation_guide">from here</a> PhoenixSuite. <br><br>  Launch PhoenixSuite: <br><div class="spoiler">  <b class="spoiler_title">screen</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/034/ea9/958/034ea99586345d5b486f2e6231bb36b3.png"></div></div><br>  Choose a fill image <br><div class="spoiler">  <b class="spoiler_title">screen</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/93f/dd2/c96/93fdd2c96faeb030b4f0cd818d704502.png"></div></div><br>  Put the device in EFL mode <br>  1. Clamp the EFL button <br><div class="spoiler">  <b class="spoiler_title">screen</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/62d/7f5/f7e/62d7f5f7e759e715f257dc03b14cca01.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">screen</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/217/cb1/9e1/217cb19e104dd8b2691b8aa628f05ff3.png"></div></div><br>  2. Plug the miniusb cable into the board and wait for a request from Livesuite. <br>  ATTENTION: many USB ports will not give the necessary power to the board, so before clicking ‚ÄúYes‚Äù - connect the board to the power supply (5V is recommended at least 3A) <br>  3. Click "Yes" <br><br>  Wait until the image is completely poured onto your device. <br>  Now you can disconnect the device from the PC and run it separately. <br><br><h4>  Installing the system on an SD card </h4><br>  Download the desired image <a href="http://cubian.org/downloads/">from here</a> : <br>  I will use the Cubian distribution for example. <br>  If you have Linux: <br>  Unzip the downloaded archive. <br>  Write the image to your SD card <br><pre> <code class="bash hljs">dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=__ of=/dev/_sd_ bs=4096; sync</code> </pre><br>  For example: <br><pre> <code class="bash hljs">dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/home/pupkin/Cubian-base-r5-a20-ct.img of=/dev/sdb1 bs=4096; sync</code> </pre><br>  When finished, you can pull out the card and install it in your Cubietruck. <br><br>  If you are a Windows user: <br>  - Download Image writer, <a href="">github.com/downloads/openSUSE/kiwi/ImageWriter.exe</a> or <a href="http://cubieplayer.github.io/Cubian/tools/%3B">cubieplayer.github.io/Cubian/tools/;</a> <br>  - Unzip the file; <br>  - Rename the file from img to raw (the program finds only such an extension). <br>  - Write the image to your SD card: <br><br><h4>  Transferring the system to SATA disk </h4><br>  To transfer the system from the NAND partition to the SATA disk, you need to execute several commands: <br>  log in as root <br><pre> <code class="bash hljs">sudo su - root</code> </pre><br>  create folders for mounting partitions <br><pre> <code class="bash hljs">mkdir /tmp/1 /tmp/target</code> </pre><br>  mount the NAND partition <br><pre> <code class="bash hljs">mount /dev/nandb /tmp/1</code> </pre><br>  Format SATA partition in ext4 <br><pre> <code class="bash hljs">mkfs.ext4 /dev/sda1</code> </pre><br>  we mount SATA section <br><pre> <code class="bash hljs">mount /dev/sda1 /tmp/target</code> </pre><br>  Moving the system <br><pre> <code class="bash hljs">(<span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /tmp/1; tar --backup -c *) |tar -C /tmp/target -xv</code> </pre><br>  Changing download settings <br><pre> <code class="bash hljs">mount /dev/nanda /mnt/ nano /mnt/uEnv.txt</code> </pre><br>  (Replace root = / dev / sda1) <br>  As a result, the file should look like this: <br><pre> <code class="bash hljs">cat /mnt/uEnv.txt root=/dev/sda1 extraargs=console=tty0 hdmi.audio=EDID:0 disp.screen0_output_mode=EDID:1280x720p50 rootwait panic=10 rootfstype=ext4 rootflags=discard</code> </pre><br>  Sync our changes <br><pre> <code class="bash hljs">sync</code> </pre><br>  Unmount the partition <br><pre> <code class="bash hljs">umount /mnt</code> </pre><br>  and reboot! <br><pre> <code class="bash hljs">reboot</code> </pre><br><br><h4>  Transferring the system from the SD card to the NAND partition </h4><br>  After copying the image and booting from the SD card, you can transfer your system to the NAND partition using one simple command: <br><pre> <code class="bash hljs">sudo ~/nandinstall/install.sh</code> </pre><br><br>  If there is no such script in your distribution, you can download and install it: <br><pre> <code class="bash hljs">apt-get install cubian-nandinstall &amp;&amp; sudo cubian-nandinstall</code> </pre><br><br><h4>  3. First start </h4><br>  So, going into my home router, I saw that my cube got the address 192.168.0.108 <br>  Connect to it.  If you connect from a Linux machine, then open the terminal and write <br><br><pre> <code class="bash hljs">ssh -p 36000 192.168.0.108 -l cubie</code> </pre><br>  Where 36000 is the port for an SSH connection.  For security reasons, a non-standard port has been selected, how to change it <a href="https://habr.com/ru/post/225371/">is</a> written <a href="https://habr.com/ru/post/225371/">here</a> .  cubie is a username, password is also cubie <br>  After that, the connection should go through and a message will appear about adding the SSH connection key to the key database.  It appears only once, when adding a new key + device combination.  We write yes. <br>  If you connect from a Windows machine, then select an SSH client to your taste, in most cases, it is Putty. <br><br>  Connect and first change the user password: <br><pre> <code class="bash hljs">sudo passwd cubie</code> </pre><br>  And we create a root user, which was absent by default for security reasons, but we will need it later, so create it now: <br><pre> <code class="bash hljs">sudo passwd root</code> </pre><br><br><h5><a name="ssh"></a>  Change SSH port </h5><br>  If you are not satisfied with the port 36000 for SSH access, you can change it to the standard port 22: <br>  Open the file / etc / ssh / sshd_config <br><pre> <code class="bash hljs">sudo nano /etc/ssh/sshd_config</code> </pre><br>  Find the line <br><pre> <code class="bash hljs">Port 36000</code> </pre><br>  Change to <br><pre> <code class="bash hljs">Port 22</code> </pre><br>  Now the cube is available like this: <br><pre> <code class="bash hljs">ssh cubie@192.168.0.108</code> </pre><br><br><h5>  Network configuration </h5><br>  By default, the settings are stored in the / etc / network / interfaces file. <br>  Let's see what we have: <br><pre> <code class="bash hljs">sudo cat /etc/network/interfaces</code> </pre><br>  We see the default network configuration <br><pre> <code class="bash hljs">auto eth0 allow-hotplug eth0 iface eth0 inet dhcp</code> </pre><br>  auto eth0 means autoconfiguring the interface when booting <br>  allow-hotplug eth0 and iface eth0 inet dhcp means that when the Linux kernel detects the eth0 physical interface, the allow-hotplug line will raise it, and the iface line will assign it a DHCP address. <br>  Attention!  This configuration sets the network address by DHCP if the cable is connected at boot.  If the cable was not connected at boot, the download is blocked for one minute to wait for DHCP timeout.  Thus, if you don‚Äôt need a wired network at all, then comment out or delete the auto eth0 line in / etc / network / interfaces, this will save you some time at boot. <br>  To comment out just add # before auto eth0, it looks like #auto eth0 <br>  You can still raise and configure the interface manually by running the command <br><pre> <code class="bash hljs">ifup eth0</code> </pre><br>  If you need to register a permanent address to the cube, here is an example configuration <br><pre> <code class="bash hljs">allow-hotplug eth0 iface eth0 inet static address 192.168.1.110 netmask 255.255.255.0 gateway 192.168.1.1 dns-nameservers 192.168.1.1</code> </pre>  <i>Although I am more inclined to automatically assign the address from the router.</i> <br><br>  <b>Wifi setup</b> <br>  Module loading <br><pre> <code class="bash hljs">modprobe bcmdhd</code> </pre><br><br>  In order for the wi-fi autorun to load when the system starts, add the line ‚Äúbcmdhd‚Äù to the end of the <b>/ etc / modules</b> file. <br><br>  Examples of commands for using wi-fi: <br><pre> <code class="bash hljs">iwlist scan iwconfig wlan0 essid <span class="hljs-string"><span class="hljs-string">"ssid"</span></span> key xxxx iwconfig wlan0 ifconfig wlan0 up dhclient wlan0</code> </pre><br><br><h5>  Set time zone </h5><br>  Set the time zone <br><pre> <code class="bash hljs">dpkg-reconfigure tzdata</code> </pre><br>  We add servers: <br><pre> <code class="bash hljs">sudo nano /etc/ntp.conf</code> </pre><br><pre> <code class="bash hljs">server 0.debian.pool.ntp.org iburst server 1.debian.pool.ntp.org iburst server 0.ru.pool.ntp.org iburst server 1.ru.pool.ntp.org iburst</code> </pre><br>  - you can get the nearest servers from here - <a href="http://www.pool.ntp.org/">www.pool.ntp.org</a> <br><pre> <code class="bash hljs">sudo /etc/init.d/ntp start</code> </pre><br><br><h5>  Auto mount HDD partition </h5><br>  There are already a huge number of articles on mounting partitions, but since  I also need it, add to complete the picture. <br><br>  Create a folder where the HDD will be mounted <br><pre> <code class="bash hljs">sudo mkdir /media/files</code> </pre><br>  We give read / write access for all users. <br><pre> <code class="bash hljs">sudo chmod 777 /media/files</code> </pre><br>  To see which sections we write on hdd <br><pre> <code class="bash hljs">sudo fdisk -l</code> </pre><br>  We look at the end and see about the following <br><div class="spoiler">  <b class="spoiler_title">fdsik -l</b> <div class="spoiler_text"><pre>  Disk / dev / sda: 1000.2 GB, 1000204886016 bytes
 255 heads, 63 sectors / track, 121601 cylinders, total 1953525168 sectors
 Units = sectors of 1 * 512 = 512 bytes
 Sector size (logical / physical): 512 bytes / 4096 bytes
 I / O size (minimum / optimal): 4096 bytes / 4096 bytes
 Disk identifier: 0x673511d7<font></font>
<font></font>
    Device Boot Start End Blocks Id System
 / dev / sda1 2048 33556479 16777216 83 Linux
 / dev / sda2 33556480 1953525167 959984344 5 Extended
 / dev / sda5 33558528 1953525167 959983320 83 Linux
</pre></div></div><br>  I have three partitions on the HDD, I will mount the third (/ dev / sda5) <br>  Find out the UUID of our section: <br><pre> <code class="bash hljs">sudo blkid</code> </pre><br>  Example output: <br><div class="spoiler">  <b class="spoiler_title">blkid</b> <div class="spoiler_text"><pre> / dev / nanda: SEC_TYPE = "msdos" LABEL = "Volumn" TYPE = "vfat"
 / dev / nandb: UUID = "fc870bf6-cf02-4f17-aab6-a2ee56137668" TYPE = "ext4"
 / dev / sda1: UUID = "df0f786f-4b74-4710-a128-412b81a6bece" TYPE = "ext4"
 / dev / sda5: UUID = "4dc5f707-d7fa-4a48-ad32-efddb23cbf97" TYPE = "ext4"
</pre></div></div><br>  We need the line / dev / sda5, copy everything in quotes <pre> <b>
</b>  <b>4dc5f707-d7fa-4a48-ad32-efddb23cbf97</b> <b>
</b> </pre><br>  <b>Remember you have this line will be different!</b> <br>  Next, open / etc / fstab: <br><pre> <code class="bash hljs">sudo nano /etc/fstab</code> </pre><br>  Add to the very end: <br><pre> <code class="bash hljs">UUID=4dc5f707-d7fa-4a48-ad32-efddb23cbf97 /media/files ext4 defaults,acl,user,user_xattr,errors=remount-ro</code> </pre><br>  <i>* exhibit attributes to your liking</i> <br>  Records are separated either by a space or a tab <br>  Reboot: <br><pre> <code class="bash hljs">sudo reboot</code> </pre><br>  After reboot check <br><pre> <code class="bash hljs">mount</code> </pre><br><div class="spoiler">  <b class="spoiler_title">mount</b> <div class="spoiler_text">  / dev / root on / type ext4 (rw, relatime, discard, data = ordered) <br>  devtmpfs on / dev type devtmpfs (rw, relatime, size = 934508k, nr_inodes = 137526, mode = 755) <br>  tmpfs on / run type tmpfs (rw, nosuid, noexec, relatime, size = 186924k, mode = 755) <br>  tmpfs on / run / lock type tmpfs (rw, nosuid, nodev, noexec, relatime, size = 5120k) <br>  proc on / proc type proc (rw, nosuid, nodev, noexec, relatime) <br>  sysfs on / sys type sysfs (rw, nosuid, nodev, noexec, relatime) <br>  tmpfs on / run / shm type tmpfs (rw, nosuid, nodev, noexec, relatime, size = 373840k) <br>  devpts on / dev / pts type devpts (rw, nosuid, noexec, relatime, gid = 5, mode = 620, ptmxmode = 000) <br>  tmpfs on / tmp type tmpfs (rw, relatime) <br>  tmpfs on / var / tmp type tmpfs (rw, relatime) <br>  / dev / sda5 on / media / files type ext4 (rw, nosuid, nodev, noexec, relatime, errors = remount-ro, data = ordered) <br></div></div><br>  We see that the third section is mounted in the desired folder. <br><br><h4>  4. Setting up the server </h4><br>  Well, since my cube is still a server, we set up samba, nginx, transmission. <br>  You can use the script <a href="https://github.com/igorpecovnik/Debian-micro-home-server">github.com/igorpecovnik/Debian-micro-home-server</a> <br><pre> <code class="bash hljs">sudo apt-get -y install git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/igorpecovnik/Debian-micro-home-server chmod +x ./Debian-micro-home-server/install.sh <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ./Debian-micro-home-server sudo ./install.sh</code> </pre><br>  Or install just what you need <br><h5>  Installing Nginx + php5-fpm + mysql </h5><br>  Install nginx: <br><pre> <code class="bash hljs">sudo apt-get install nginx</code> </pre><br>  Run <br><pre> <code class="bash hljs">sudo /etc/init.d/nginx start</code> </pre><br>  Open the browser, write the address of the cube. <br>  We see the following inscription <br><br>  <b>Welcome to nginx!</b> <br><br>  Server is running <br>  For example, our sites will be stored on an already mounted hard disk. <br>  For this you need to fix the nginx config <br><pre> <code class="bash hljs">sudo nano /etc/nginx/sites-available/default</code> </pre><br>  Find the line <br><pre> <code class="bash hljs">root /usr/share/nginx/www</code> </pre><br>  Change to <br><pre> <code class="bash hljs">root /media/files/www</code> </pre><br>  Save, close the gear <br>  Do not forget to give nginx user access to the folder: <br><pre> <code class="bash hljs">sudo chown www-data -R /media/files/www/ sudo chmod 0755 -R /media/files/www/</code> </pre><br>  Restart nginx <br><pre> <code class="bash hljs">sudo /etc/init.d/nginx restart</code> </pre><br>  or <br><pre> <code class="bash hljs">sudo service nginx restart</code> </pre><br>  For static sites, this is, in principle, sufficient. <br>  If you need php scripts - continue to edit / etc / nginx / sites-available / default <br>  Find the line in the file: <br><pre> <code class="bash hljs">index index.html index.htm</code> </pre><br>  Through the space we add <br><pre> <code class="bash hljs">index.php</code> </pre><br>  Now enable <b>php processing</b> . <br><div class="spoiler">  <b class="spoiler_title">Find the block</b> <div class="spoiler_text"><pre> # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
         #
         #location ~ \ .php $ {
         # fastcgi_split_path_info ^ (. + \. php) (/.+) $;
         # # NOTE: You should have "cgi.fix_pathinfo = 0;"  in php.ini
         #
         # # With php5-cgi alone:
         # fastcgi_pass 127.0.0.1:9000;
         # # With php5-fpm:
         # fastcgi_pass unix: /var/run/php5-fpm.sock;
         # fastcgi_index index.php;
         # include fastcgi_params;
         #} </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Change to</b> <div class="spoiler_text"><pre> # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
         #
         location ~ \ .php $ {
                fastcgi_split_path_info ^ (. + \. php) (/.+) $;
         # # NOTE: You should have "cgi.fix_pathinfo = 0;"  in php.ini
         #
         # # With php5-cgi alone:
         # fastcgi_pass 127.0.0.1:9000;
         # # With php5-fpm:
                fastcgi_pass unix: /var/run/php5-fpm.sock;
                fastcgi_index index.php;
                include fastcgi_params;
         } </pre><br></div></div><br>  Install <b>mysql</b> <br><pre> <code class="bash hljs">sudo apt-get -y install mysql-client mysql-server openssl libsasl2-modules</code> </pre><br>  Install php5-fpm and modules <br><pre> <code class="bash hljs">sudo apt-get install -y php5-fpm sudo apt-get install -y php5-mysql php5-curl php5-gd php5-intl php-pear php5-imagick php5-imap php5-mcrypt php5-memcache php5-memcached php5-ming php5-ps php5-pspell php5-recode php5-snmp php5-sqlite php5-tidy php5-xmlrpc php5-xsl memcached sudo apt-get install -y php-apc sudo apt-get install -y fcgiwrap</code> </pre><br><br><h4>  Installing the Transmission Client Torrent </h4><br>  Transmission-daemon installation <br><pre> <code class="bash hljs">sudo apt-get install transmission-daemon</code> </pre><br>  After the installation is completed, the service automatically starts with the default settings, stop it <br><pre> <code class="bash hljs">sudo /etc/init.d/transmission-daemon stop</code> </pre><br>  or <br><pre> <code class="bash hljs">service transmission-daemon stop</code> </pre><br>  Now edit the config <br><pre> <code class="bash hljs">sudo nano /etc/transmission-daemon/settings.json</code> </pre><br>  All parameters will not be considered, the most basic <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"download-dir"</span></span>: <span class="hljs-string"><span class="hljs-string">"/var/lib/transmission-daemon/downloads"</span></span></code> </pre><br>  Upload Files Path <br>  Change to your, for example: <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"download-dir"</span></span>: <span class="hljs-string"><span class="hljs-string">"/mnt/hdd"</span></span></code> </pre><br>  <i>Ps I hope you have a hard drive mounted on this path</i> <br><br>  We allow forwarding, remembering to enable UPnP in our router <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"port-forwarding-enabled"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>,</code> </pre><br>  Change to <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"port-forwarding-enabled"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span></code> </pre><br><br>  If you want to log in to the web interface with a password, leave: <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"rpc-enabled"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span></code> </pre><br>  otherwise change to: <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"rpc-enabled"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> </pre><br><br>  Delete everything in quotes, write the desired password instead.  The password when the daemon starts is encrypted. <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"rpc-password"</span></span>: <span class="hljs-string"><span class="hljs-string">"{f40c259f547fb2b99f7faa1e27d6e9b31905e9c1DcVjhWHD"</span></span></code> </pre><br>  For example: <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"rpc-password"</span></span>: <span class="hljs-string"><span class="hljs-string">"cubietruck"</span></span></code> </pre><br><br>  The port on which we hang the web interface <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"rpc-port"</span></span>: <span class="hljs-number"><span class="hljs-number">9091</span></span></code> </pre><br><br>  Username: <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"rpc-username"</span></span>: <span class="hljs-string"><span class="hljs-string">"transmission"</span></span></code> </pre><br>  change to your favorite: <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"rpc-username"</span></span>: <span class="hljs-string"><span class="hljs-string">"pupkin"</span></span></code> </pre><br><br>  We leave, if we want to access to the web interface only from the local machine: <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"rpc-whitelist-enabled"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span></code> </pre><br>  otherwise we change <br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"rpc-whitelist-enabled"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> </pre><br><br>  Save the config <br><br>  We start service <br><pre> <code class="bash hljs">sudo /etc/init.d/transmission-daemon start</code> </pre><br>  or <br><pre> <code class="bash hljs">service transmission-daemon start</code> </pre><br><br>  Now we‚Äôll check if the service and web interface started, open the address in the browser <pre> <code class="html hljs xml">http://ip__:9091</code> </pre> <br>  If we see an invitation to enter a login and password, then the transmission works. <br><br><h4>  Install samba </h4><br><pre> <code class="bash hljs">sudo apt-get install samba samba-common-bin</code> </pre><br>  Since my cube is in the home network, I decided not to set a password for access to folders, but simply set up a public sharing for the entire network. <br>  To do this, open the smb.conf file: <br><pre> <code class="bash hljs">sudo nano /etc/samba/smb.conf</code> </pre><br><br>  Instead of all the existing content we write: <br><pre> <code class="bash hljs">[global] workgroup = WORKGROUP guest ok = yes netbios name = cubieT security = share browseable = yes [files] path = /media/files writeable = yes browseable = yes</code> </pre>  &lt; <br><br>  We save.  Restart Samba: <br><pre> <code class="bash hljs">sudo /etc/init.d/samba restart</code> </pre><br><br>  From this point on, a new cubieT device has appeared on your network, which has a files folder. <br>  In it, you can create any files that can be viewed on the entire network using a browser. <br><br><h4>  5. Remote control Ajenti / Webmin </h4><br>  <b>Webmin</b> , the market leader in free server administration software, has many plug-ins for every taste. <br>  Consider installing it. <br>  Add the Webmin repository to the repository list <br><pre> <code class="bash hljs">sudo nano /etc/apt/sources.list</code> </pre><br><br>  Insert at the end of the list the following lines <br><pre> <code class="bash hljs">deb http://download.webmin.com/download/repository sarge contrib deb http://webmin.mirror.somersettechsolutions.co.uk/repository sarge contrib</code> </pre><br>  Save, exit the editor. <br>  Add the repository key to the list of keys, for this you need to be under the root. <br>  Turn on the superuser, go to the root home folder, download the key, install. <br><pre> <code class="bash hljs">sudo su <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /root wget http://www.webmin.com/jcameron-key.asc apt-key add jcameron-key.asc</code> </pre><br><br>  Update the list of packages, install webmin <br><pre> <code class="bash hljs">sudo apt-get update &amp;&amp; apt-get install webmin</code> </pre><br>  All dependencies will be installed automatically. <br><br>  We open the browser, we write <pre> <code class="html hljs xml">https://ip__:10000</code> </pre> <br>  The browser swears and offers to leave the site, but we add the site to the trusted zone and enter. <br>  We try to first enter the user cubie, if not, then the root. <br><br>  You can disable encryption (https): <br>  Open webmin configuration file <br><pre> <code class="bash hljs">sudo nano /etc/webmin/miniserv.conf</code> </pre><br>  find the line <br><pre> <code class="java hljs">ssl=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  1 change to 0 <br>  Restart webmin <br><pre> <code class="bash hljs">sudo /etc/init.d/webmin restart</code> </pre><br>  Now webmin works at <pre> <code class="html hljs xml">http://ip__:10000</code> </pre> <br><br>  If you are not comfortable with webmin, you can try ajenti.  Moreover, no additional movements need to be done, ajenti is already installed in Cubian, you just need to update the system and it will work. <br>  After upgrading the system will be available at <pre> <code class="html hljs xml">http://ip__:8000</code> </pre> <br><br>  *** Plans to deal with GPIO features, since  On Malinka, a small data logger was organized from the DHT22 and DS18B20 sensors. </div><p>Source: <a href="https://habr.com/ru/post/225371/">https://habr.com/ru/post/225371/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225361/index.html">Microsoft Remote Desktop is already on the new Lumia</a></li>
<li><a href="../225363/index.html">Logging messages with Easylogging ++</a></li>
<li><a href="../225365/index.html">How to turn ordinary sites into adaptive?</a></li>
<li><a href="../225367/index.html">30 useful services for web developer</a></li>
<li><a href="../225369/index.html">WWDC 2014. Wednesday News</a></li>
<li><a href="../225375/index.html">ECS LIVA: Mini PC with Intel Bay Trail for $ 180</a></li>
<li><a href="../225381/index.html">OpenSSL: New Vulnerability: Ability to perform a MITM attack (CVE-2014-0224)</a></li>
<li><a href="../225383/index.html">Record of the webinar "What's new in Kerio Connect 8.3"</a></li>
<li><a href="../225385/index.html">"Rain", Slon.ru and "Big City" will unite into a holding and will hold an IPO on the Moscow Stock Exchange</a></li>
<li><a href="../225387/index.html">The history of the gaming market, part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>