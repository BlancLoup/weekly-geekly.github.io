<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Templating in PHP using lambda functions and closures</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Starting with php 5.3, we have a great opportunity to use closures and anonymous functions. They, along with the alternative syntax, are very convenie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Templating in PHP using lambda functions and closures</h1><div class="post__text post__text-html js-mediator-article">  Starting with php 5.3, we have a great opportunity to use closures and anonymous functions.  They, along with the alternative syntax, are very convenient for use in templating (of course, except when the coder does not need to be given access to php), and templates based on them are fast, easily converted to accelerator bytecode, can support block inheritance, do not require compilation and caching, support skins and are very convenient in development. <br>  It is assumed that the reader has experience with template engines, such as twig.  Details under the cut. <br><a name="habracut"></a><br>  To begin with, we will define semantics and syntax. <br>  1) The lambda functions in the template will be called instructions, and we will write them in capital letters; <br>  2) System and service variables in the template begin with an underscore character; <br>  3) All other variables in the template are its direct arguments and are written with a lowercase letter. <br><br>  The template engine is a service object that has a render method: <br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($_template,array $_data=array</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span><span class="hljs-function"><span class="hljs-params">,$_skin=null,$_type=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'php'</span></span></span></span><span class="hljs-function"><span class="hljs-params">,&amp;$_buffer=null)</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br>  In the namespace of this method will be all the most interesting. <br>  To begin with, we define variables and declare several instructions with closures in it, at the end we add processing of the result: <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($_template,array $_data=array</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span><span class="hljs-function"><span class="hljs-params">,$_skin=null,$_type=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'php'</span></span></span></span><span class="hljs-function"><span class="hljs-params">,&amp;$_buffer=null)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_skin)) $_skin = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;api-&gt;cfg[<span class="hljs-string"><span class="hljs-string">'default_skin'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$_filename = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getFile($_template,$_skin,$_type)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>; $_parent = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; $_api = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;api; <span class="hljs-comment"><span class="hljs-comment">//           $R = function($name) use ($_template, $_skin) { echo "/res/t/{$_skin}/{$_template}/$name"; }; //     $BEGIN = function($blockname) { ob_start(); }; //     $END = function($blockname) use (&amp;$_buffer,$_parent) { if (isset($_buffer[$blockname])) { ob_end_clean(); echo $_buffer[$blockname]; } else { $_buffer[$blockname] = isset($_parent)?ob_get_clean():ob_get_flush(); } }; //     $EXTEND = function($template,$type=null) use (&amp;$_parent) { if ($template) $_parent =array($template,$type); }; //      $INCLUDE = function($template,$type=null) use ($_data,$_api,$_skin) { if ($template) echo $_api-&gt;templater-&gt;exec($template,$_data,$_skin,$type); }; //  css-   dom- $CLASS = function() use ($_template,$_skin) { echo "t-{$_template} s-{$_skin}"; }; if (!isset($this-&gt;instructions)) $this-&gt;instructions = $this-&gt;getInstructions(); //      $V = function(&amp;$var,$default='',$raw=false) use ($api) { if (isset($var)) { if (is_scalar($var)) echo $raw?$var:htmlspecialchars($var); else $api-&gt;templater-&gt;dump($var); } else { echo $raw?$default:htmlspecialchars($default); } }; //      $GV = function(&amp;$var,$default='') { if (isset($var)) return $var; else return $default; }, extract($_data); //   -   -  ( ,   ) if (!isset($_language)) $_language = $this-&gt;api-&gt;cfg['default_language']; $L = function(&amp;$stringhash,$default=array('?')) use ($_language,$_api) { if (!isset($stringhash)) $stringhash = $default; if (is_string($stringhash)) { echo htmlspecialchars($stringhash); return; } if (isset($stringhash[$_language[0]])) echo htmlspecialchars($stringhash[$_language[0]]); elseif (isset($stringhash[$_api-&gt;cfg['default_language'][0]])) echo htmlspecialchars($stringhash[$_api-&gt;cfg['default_language'][0]]); else echo htmlspecialchars(reset($stringhash)); }; extract($this-&gt;instructions); ob_start(); include $_filename; $content = ob_get_clean(); if ($_parent) $content = $this-&gt;exec($_parent[0],$_data,$_skin,$_parent[1],$_buffer); return $content; }</span></span></code> </pre><br><br>  Inheritance and redefinition of blocks works as follows: <br>  1) If the $ EXTEND () instruction is specified at the beginning of the template, then the extensible template is specified by the ‚Äúancestor‚Äù of the current template. <br>  2) At the beginning of the inherited block ("$ BEGIN ()"), the write buffer opens.  The name in the parameter is needed only for semantics; <br>  3) When the inherited block is completed, the write buffer is thrown into the output, or the existing stored buffer is thrown out if it was filled (here is a nuance: both the ancestor and the descendant are executed, but one is output; in practice this is not essential); 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Thus, the child is first rendered, then the ancestor.  If there are blocks in the ancestor defined in the descendant, then they are not output, but are replaced by the descendant blocks.  At the same time, the ancestor's skin is taken from the descendant skin (set when the render is called).  There can be more than two levels of ancestor-child relationship, as a result of the render function there will be only the last block with the specified name. <br><br>  The $ V, $ L, and $ GV instructions accept only variables (using the change permission "&amp;", which is necessary in order to exclude warnings to a non-existent variable; the variable inside the lambda function will be null) <br><br>  The $ R instruction is used to display resources bound to a template.  For example: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span><span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>($GV($pictures,<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>()) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $picture):<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;img src=<span class="hljs-string"><span class="hljs-string">"&lt;?$R($picture)?&gt;"</span></span>/&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span><span class="hljs-keyword"><span class="hljs-keyword">endforeach</span></span>;<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  Additional instructions (for example, work with constants, etc.) can be transferred to the method via extract ($ this-&gt; instructions), this array of lambda functions is formed dynamically. <br><br>  Example of a template (the class is used in the html tag to indicate height: 100% in one of the skins, for example): <br><pre> <code class="php hljs">&lt;!DOCTYPE html&gt; &lt;html <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="&lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CLASS</span></span></span><span class="hljs-class">()?&gt;" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="&lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">V</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_id</span></span></span><span class="hljs-class">)?&gt;"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">head</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">meta</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">http</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">equiv</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Content</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Type</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">text</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">html</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">charset</span></span></span><span class="hljs-class">=</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UTF</span></span></span><span class="hljs-class">-8"/&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">&gt;&lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">L</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">,</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">en</span></span></span><span class="hljs-class">'=&gt;'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">No</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">','</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ru</span></span></span><span class="hljs-class">'=&gt;' '))?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">link</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rel</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stylesheet</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">href</span></span></span><span class="hljs-class">="/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">res</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">css</span></span></span><span class="hljs-class">?&lt;?=$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_api</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">build</span></span></span><span class="hljs-class">?&gt;" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">text</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">css</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">media</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">all</span></span></span><span class="hljs-class">" /&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">text</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">javascript</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">src</span></span></span><span class="hljs-class">="/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">res</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">jquery</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">js</span></span></span><span class="hljs-class">?&lt;?=$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_api</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">build</span></span></span><span class="hljs-class">?&gt;"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">text</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">javascript</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">src</span></span></span><span class="hljs-class">="/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">res</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">js</span></span></span><span class="hljs-class">?&lt;?=$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_api</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">build</span></span></span><span class="hljs-class">?&gt;"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">text</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">javascript</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">src</span></span></span><span class="hljs-class">="/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">res</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">frontend</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">js</span></span></span><span class="hljs-class">?&lt;?=$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_api</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">build</span></span></span><span class="hljs-class">?&gt;"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">head</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">body</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">header</span></span></span><span class="hljs-class">&gt; &lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BEGIN</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">header</span></span></span><span class="hljs-class">')?&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;&lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">L</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">,</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">en</span></span></span><span class="hljs-class">'=&gt;'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">No</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">','</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ru</span></span></span><span class="hljs-class">'=&gt;' '))?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SLOT</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">langswitch</span></span></span><span class="hljs-class">)?&gt; &lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">END</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">header</span></span></span><span class="hljs-class">')?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">header</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BEGIN</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">')?&gt; &lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">L</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">,</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">en</span></span></span><span class="hljs-class">'=&gt;'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">No</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">','</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ru</span></span></span><span class="hljs-class">'=&gt;' '))?&gt; &lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">END</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">')?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">footer</span></span></span><span class="hljs-class">&gt; &lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BEGIN</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">footer</span></span></span><span class="hljs-class">')?&gt; &lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SLOT</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">menu_footer</span></span></span><span class="hljs-class">)?&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">copy</span></span></span><span class="hljs-class">"&gt; &lt;?=</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">date</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Y</span></span></span><span class="hljs-class">')?&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyProject</span></span></span><span class="hljs-class"> &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">info</span></span></span><span class="hljs-class">"&gt; &lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">=</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">en</span></span></span><span class="hljs-class">'=&gt;'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Generated</span></span></span><span class="hljs-class">','</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ru</span></span></span><span class="hljs-class">'=&gt;'');$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">L</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">)?&gt;: &lt;?=</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">date</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">r</span></span></span><span class="hljs-class">')?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">&gt; &lt;?$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">END</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">footer</span></span></span><span class="hljs-class">')?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">footer</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">body</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">html</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre><br><br>  An example of using a template engine when building css: <br><pre> <code class="hljs css">. {<span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">"&lt;?$R('bg.png')?&gt;"</span></span>)} . &gt; <span class="hljs-selector-class"><span class="hljs-selector-class">.left</span></span> {<span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: &lt;?$<span class="hljs-built_in"><span class="hljs-built_in">C</span></span>(<span class="hljs-string"><span class="hljs-string">'left-margin'</span></span>)?&gt;; <span class="hljs-attribute"><span class="hljs-attribute">border</span></span>: <span class="hljs-number"><span class="hljs-number">1px</span></span> &lt;?$<span class="hljs-built_in"><span class="hljs-built_in">C</span></span>(<span class="hljs-string"><span class="hljs-string">'border-color'</span></span>)?&gt; solid;}</code> </pre><br>  Here $ C is a manual for working with constants.  Thanks to templating, you can make cycles in style files, embed coordinate calculation functions, expand css files, enable on the server side, and much more.  Styles start with a dot, because the css collector replaces the dot at the beginning of the line with the template block selector, so block layout is supported. <br><br>  In the same way, you can pass javascript files through the template engine when assembling project components.  For example, this is convenient for substituting paths to ajax requests and other links using the $ PATH ('route_name', $ args) instruction. <br><br>  All template resources must be collected by the collector in folders, and all css and js templates are prefixed by prefix selectors (see "$ CLASS ()") and glued into one (well, two) files in the add.  I will tell about these mechanisms separately in other articles. <br><br>  I note that this approach exists in the prototype within the framework of the working system, which I, for obvious reasons, will not describe in the article, and is experimental.  The main goal was to reduce development time losses due to the long compilation (twig) of a large number of templates, while maintaining acceptable performance.  Therefore, I am happy to read about the nuances and pitfalls of this approach from experienced people in the comments. </div><p>Source: <a href="https://habr.com/ru/post/136516/">https://habr.com/ru/post/136516/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136508/index.html">Samsung was not interested in buying RIM</a></li>
<li><a href="../136510/index.html">Announced date and venue of JavaOne Russia 2012</a></li>
<li><a href="../136513/index.html">Seminar Unisender: e-mail, SMS and social networks</a></li>
<li><a href="../136514/index.html">Axxerion received ISAE 3402 Type II certification</a></li>
<li><a href="../136515/index.html">ReactOS celebrates jubilee build 55000</a></li>
<li><a href="../136517/index.html">What is ITSM?</a></li>
<li><a href="../136518/index.html">Encapsulation - black box?</a></li>
<li><a href="../136520/index.html">Automatic spell checker in EXCEL</a></li>
<li><a href="../136525/index.html">LESS: programmable style language</a></li>
<li><a href="../136527/index.html">LG Electronics in 2012. Plans and business tasks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>