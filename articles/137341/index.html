<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Access the operating system clipboard from a web application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="You may need to use the operating system clipboard directly from the web application page in the browser. Having studied the information a little, it ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Access the operating system clipboard from a web application</h1><div class="post__text post__text-html js-mediator-article">  You may need to use the operating system clipboard directly from the web application page in the browser.  Having studied the information a little, it can be found that it is impossible to do this directly from the HTML page using javascript due to the security policy. Specifically, writing to it can be used for bad purposes by hackers.  There are several workarounds; you can find many references and examples about them. <br><a name="habracut"></a><br><h4>  <b>Overview of options</b> </h4><br><h5>  Individual approach </h5><br>  Each browser has its own context menu, which has access to the page and can be invoked on top of the page logic, and if necessary copy the selected text of the page element.  In Firefox, this is implemented through the standard <a href="http://kb.mozillazine.org/Granting_JavaScript_access_to_the_clipboard">clipboard helper</a> plugin, so you can interact with it.  IE has direct access through <a href="http://msdn.microsoft.com/en-us/library/ie/ms535220%2528v%3Dvs.85%2529.aspx">window.clipboardData</a> , which is a security violation.  In other browsers there is no specific solution. <br>  <b>disadvantages</b> <br>  - for each browser you need to write your own implementation, and not all browsers have such an opportunity. <br><br><h5>  Adobe Flash </h5><br>  Use Flash (an old, proven method) that allows you to work with ClipBoard.  For this purpose, for example, javascript code <a href="http://code.google.com/p/zeroclipboard/">ZeroClipBoard</a> (one js and one swf files) was created, used by many as a ready-made solution. <br>  <b>Disadvantages</b> : <br>  - Flash is gradually becoming an unpopular technology and may cease to be a standard due to the arrival of HTML5 <br>  - by default it does not allow working with a local site, you need to configure Flash Player for this for each user <br>  - it is necessary to use ‚Äúcrossdomain.xml‚Äù to allow cross-domain access <br><br><h5>  Microsoft Silverlight </h5><br>  Using Silverlight, which, like Flash, allows you to access ClipBoard through its context. <br>  <b>Disadvantages</b> : <br>  - Silverlight is also not pure HTML, so non-fans of this technology may refuse this solution, but it is gaining its momentum and becoming popular. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>Implementation via Silverlight</b> </h4><br>  In this article I will talk about the third option, and we can use Silverlight to access the DOM page and vice versa.  For this, from the Silverlight side, we will use a button and a text field. <br>  Why so, you ask?  Why button, not Ctrl + C?  The fact is that the Silverlight container will only respond to the Ctrl + C keystroke if this key is inside the container (Silverlight is in focus), and we have a key on the page.  Secondly, Silverlight has one, but significant limitation when accessing the ClipBoard, this can be done, but only from the Silverlight context and only from the user's filing, i.e.  a button or any other event not available from javascript (private) must be pressed, otherwise it would be no different from accessing directly from javascript (only through calling the silverlight method). <br>  The button will write text to the ClipBoard.  But how to this event to transmit the specified text.  To do this, you first need to get this text.  You can call the javascript method, which returns the selected text as a result.  From silverlight, you can call the javascript method, and pass it the parameter values ‚Äã‚Äãvia HtmlPage.Window.Invoke, but you cannot directly get the result, so I used a text field in which the called javascript can write the result. <br><br>  The order of work is as follows: <br><ol><li>  Button click in Silverlight </li><li>  Calling the javascript method from the button method that reads the desired value and copies the text field to the Silverligh </li><li>  Return to Javascript Method </li><li>  Return to the silverlight button method </li><li>  Reading a value from a text field and writing it to the clipboard. </li></ol><br><h5>  Silverlight side </h5><br><br>  Create a silverlight-project type application, where there are two objects <br>  App.xaml - initialization <br>  &lt;Your ClipBoard class&gt; .xaml - a class that implements access to ClipBoard <br><br>  On the page of your class we create two controls - a button that will click to copy to the clipboard and an invisible field.  Markup example <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Grid</font> <font color="#ff0000">x:Name</font> <font color="#0000ff">="LayoutRoot"</font> <font color="#ff0000">Background</font> <font color="#0000ff">="White"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Grid.RowDefinitions</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RowDefinition</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Grid.RowDefinitions</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Button</font> <font color="#ff0000">Margin</font> <font color="#0000ff">="0,0,0,0"</font> <font color="#ff0000">Click</font> <font color="#0000ff">="Copy"</font> <font color="#ff0000">Content</font> <font color="#0000ff">="Copy"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="20"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="20"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">TextBlock</font> <font color="#ff0000">x:Name</font> <font color="#0000ff">="txtText"</font> <font color="#ff0000">Margin</font> <font color="#0000ff">="0"</font> <font color="#ff0000">Text</font> <font color="#0000ff">="{Binding Text}"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="0"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="0"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  And class logic <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[ScriptableType] <br> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> ClipBoardBase : UserControl <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> JavascriptFunctionName; <br> <font color="#0000ff">public</font> ClipBoardBase() <br> { <br> InitializeComponent(); <br> HtmlPage.RegisterScriptableObject( <font color="#A31515">"silverlightClipBoard"</font> , <font color="#0000ff">this</font> ); <br> JavascriptFunctionName = <font color="#A31515">""</font> ; <br> } <br> [ScriptableMember] <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> CopyToTextEdit( <font color="#0000ff">string</font> text) <br> { <br> txtText.Text = text; <br> } <br> [ScriptableMember] <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> Copy( <font color="#0000ff">object</font> sender, RoutedEventArgs e) <br> { <br> HtmlPage.Window.Invoke(JavascriptFunctionName); <br> Clipboard.SetText(txtText.Text); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  <b>[ScriptableType]</b> and <b>[ScriptableMember]</b> - mandatory for the class and method if you want to access them from the page <br>  <b>HtmlPage.RegisterScriptableObject (‚ÄúsilverlightClipBoard‚Äù, this)</b> - an object is registered under the specified name on the page and can be accessed (see below) <br>  <b>JavascriptFunctionName</b> is the name of the function that is called to write the value to the text field for further copying to the clipboard. <br>  <b>CopyToTextEdit</b> - will be called from the page to record the result in the text field <br>  <b>Copy</b> - button pressing method, at the end it copies to the clipboard <br><br>  This is all that is needed from the side of silverlight, as a result you get a xap file - a silverlight container that you need to put on the server. <br><br><h5>  By javascript </h5><br>  It is necessary: <br><ul><li>  prepare and create a Silverlight object on the page </li><li>  prepare and create a function that will read the copied value from the page and write it into the silverlight text field </li></ul><br><br>  Silverlight.js file is used for adding - supplied by Microsoft <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> silverlightdiv = <font color="#0000ff">document</font> .createElement( <font color="#A31515">'div'</font> ); <br> b = <font color="#0000ff">new</font> Object(); <br> b.source = <font color="#A31515">'  xap-'</font> ; <br> b.properties = {}; <br> b.properties.version = <font color="#A31515">'4.0.50303'</font> ; <br> b.parentElement = silverlightparent; <br> b.id = <font color="#A31515">'silverlightClipBoardElement'</font> ; <br> b.initParams = <font color="#A31515">'JavascriptFunctionName=silverlightClipBoardCopyToEdit'</font> ; <br> Silverlight.createObjectEx(b); <br> silverlightClipBoardElement = <font color="#0000ff">document</font> .getElementById( <font color="#A31515">'silverlightClipBoardElement'</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  <b>Silverlight.createObjectEx</b> - creates an object on the page <br>  <b>b.source</b> - relative path to the xap file <br>  <b>b.parentElement</b> - parent DOM element <br>  <b>b.id</b> - by it you can find the object in which the container is located <br>  <b>b.initParams</b> - the initial parameters will be transferred to the class constructor, set in the form 'key1 = value1; key2 = value2', they can be subtracted, I thus pass the name of the function that will work on the javascript side <br>  <b>silverlightClipBoardElement</b> - a global variable for accessing an object <br>  There are other options that you can read about <a href="http://msdn.microsoft.com/ru-ru/library/cc838126%2528v%3Dvs.95%2529.aspx">here.</a> <br>  and now the function for working with Silverlight <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">silverlightClipBoardCopyToEdit = <font color="#0000ff">function</font> () { <br> <font color="#0000ff">var</font> CopyValue; <br> <font color="#008000">//        CopyValue</font> <br> silverlightClipBoardElement.content.silverlightClipBoard.CopyToTextEdit(CopyValue); <br> };</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Look at how you can access the method. For this, for a silverlightClipBoardElement DOM object, we refer to the object registered under the name silverlightClipBoard (see the constructor of the silverlight class) and then to the method by passing the coveted CopyValue. <br><br><h4>  Links </h4><br>  <a href="http://habrahabr.ru/blogs/silverlight/46501/">Silverlight and Javascript interaction</a> <br>  <a href="http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2009/11/18/silverlight-4-rough-notes-clipboard-access.aspx">Work with OS clipboard from Silverlight</a> </div><p>Source: <a href="https://habr.com/ru/post/137341/">https://habr.com/ru/post/137341/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137333/index.html">When need RVM, and when enough rbenv</a></li>
<li><a href="../137334/index.html">Using vkontakte js api for semi-automatic posting of messages from rss feeds</a></li>
<li><a href="../137336/index.html">Translator from Delphi to javascript</a></li>
<li><a href="../137338/index.html">Treemap, deputies income, and language processing</a></li>
<li><a href="../137339/index.html">Sliding in two - no, in four directions</a></li>
<li><a href="../137342/index.html">50 tips for developing flawless design iOS apps</a></li>
<li><a href="../137343/index.html">Change images</a></li>
<li><a href="../137344/index.html">Unisender seminar on email, SMS and SMM integration: photo report</a></li>
<li><a href="../137345/index.html">Demonstration of design - how to present the work so that it arouses appetite</a></li>
<li><a href="../137346/index.html">Megaupload will save files for another 2 weeks.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>