<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>EMC XtremIO and VDI. Effective, but still raw stuff</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The third day ended our two-week test period of EMC XtremIO . 
 CROC has already shared his impressions of this experience, but mostly in the form of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>EMC XtremIO and VDI. Effective, but still raw stuff</h1><div class="post__text post__text-html js-mediator-article">  The third day ended our two-week test period of <a href="http://russia.emc.com/storage/xtremio/index.htm">EMC XtremIO</a> . <br>  <a href="http://habrahabr.ru/company/croc/blog/220319/">CROC has already shared</a> his impressions of this experience, but mostly in the form of synthetic test results and enthusiastic statements that, in relation to any storage system, looks impressive, but not very informative.  I am currently working in the customer, not in the integrator, the application aspect is more important to us, so the testing was organized in an appropriate manner.  But in order. <br><br><h4>  general information </h4><br>  XtremIO is a new (relatively) product from EMC, more precisely, from XtremIO, purchased by EMC.  It is an All-Flash array consisting of five modules - two single-unit Intel servers as controllers, two Eaton UPSs and one 25-disk shelf.  All of the above is combined in a brick (brick) - a unit of expansion XtremIO. <br>  The killer feature of the solution is on-the-fly deduplication.  This fact was especially interesting to us, because we use VDI with full clones and we have a lot of them.  Marketing promised that all will fit into one brick (brik capacity - 7.4 TB).  At the moment, on a regular array, they occupy almost 70+ TB. <br>  I forgot to photograph the subject matter of the story, but in <a href="http://habrahabr.ru/company/croc/blog/214139/">KROK's post you</a> can see everything in detail.  I‚Äôm even sure that this is the same array. <br><a name="habracut"></a><br><h4>  Installation and configuration </h4><br>  The device came mounted in a mini-wreck.  Thoughtlessly we went to take it together and almost burst out, just dragging from the car into the cart.  Having disassembled into components, however, I moved it to the data center and mounted it alone without too much difficulty.  Installation of the slide proposes a large number of screws to be screwed in, so I had to spend a lot of time with a screwdriver in the ‚ÄúG‚Äù position, but the switching pleased me - all cables of necessary and sufficient length were easily inserted and removed, but they were protected from accidental tearing.  (This fact was positively noted after testing another flash storage system - Violin - in which the cable connecting two neighboring sockets for some reason was made one and a half meters long, and inserting one of the ethernet patch cords cannot be pulled out without an additional flat tool, for example, a screwdriver) . <br>  A specially trained engineer arrived to tune the subject.  It was very interesting to find out that at the moment the update of the control software is happening with data loss.  Adding a new brik to the system - too.  Departure of two disks at once also leads to data loss (without loss the second disk can be lost after a rebuild), but this is promised to be fixed in the next update.  As for me, it would be better to do the first two points in a normal way. <br>  To fully configure and manage the array, the system requires a dedicated server (XMS - XtremeIO Management Server).  It can be ordered as a physical addition to the kit (I suppose, by increasing the cost of the solution by the price of the weight equivalent of this server in gold), or you can simply deploy the virtual machine (linux) from the template.  After that, you need to put into it an archive with software and install it.  And then set up using a half dozen default uchetok.  In general, the initial configuration process differs from the usual storage configuration and is not to say that it is in the direction of relief.  I hope it will be finalized. <br><br><h4>  Operation, deduplication and problem situation </h4><br>  Without further ado, as a test, we decided to transfer part of the combat VDI to the device under test and see what happens.  Especially interested in the effectiveness of dedupu.  I didn‚Äôt believe in the 10: 1 ratio, because even though we have complete clones, profiles and some user data lie inside the VM (although their volume is often small relative to the OS), and I‚Äôm just skeptical about claimed miracles. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first transferred 36 VMs occupied 1.95 TB on the datastore, and 0.64 TB on the disks.  The deduplication ratio is 2.7: 1.  True, the first batch consisted of virtual desktops of IT department representatives who especially like to keep everything inside their PC, no matter if it is physical or virtual.  Many even have extra drives.  As the system is filled with all new machines, the coefficient has grown, but not significantly, without jerks.  Here's an example of a screenshot of a system with a hundred virtual locks: <br><img src="https://habrastorage.org/getpro/habr/post_images/d4d/cb9/8fc/d4dcb98fcedbd303dea7d55cbe2adf3d.png"><br><br>  But 450: <br><img src="https://habrastorage.org/getpro/habr/post_images/353/754/c39/353754c3900475fb57100a8a360351f4.png"><br><br>  The average vmdk size is 43 GB.  Inside - Windows 7 EE. <br><br>  I decided to stop on this amount and turn a new test - create a new datastor and score it with ‚Äúclean‚Äù clones, freshly deployed from a template, checking both the deployment time and dedup.  The results are impressive: <br>  100 clones created; <br>  datastor 4 TB full; <br>  the amount of disk space occupied increased by 10 GB. <br><br>  Screenshot (compare with previous): <br><img src="https://habrastorage.org/getpro/habr/post_images/263/479/2d4/2634792d47a06f88942b659b08280714.png"><br><br>  Here is the full results tab: <br><img src="https://habrastorage.org/getpro/habr/post_images/de3/879/0bd/de38790bd7cd72a5b018a80e63f157b4.png"><br><br>  There was also a thought to include these 100 clones and see a) how the system behaves in bootstrap, b) how the dedupus ratio will change after switching on and some time of the clean system operation.  However, these activities had to be postponed, because something happened that can be called unpleasant behavior.  One of the five LUNs was blocked and staked the entire cluster. <br>  We have to admit that the reason lies in the features of the configuration of hosts.  Due to the use of IBM SVC as a storage aggregator (it‚Äôs not okay), the hosts had to disable Hardware Assist Lock - an essential element of VAAI, which allows you to block not the entire datastor when changing metadata, but a small sector of it.  So why LUN was blocked is understandable.  Why he did not unlock - not very.  And it is completely incomprehensible why it did not unblock even after it was disconnected from all hosts (it was necessary, because until we did this, not a single VM could turn on or emigrate, but as luck would have it, at that very moment someone from Very Important People of the company needed to rebuild their cars) and passed all imaginable and inconceivable timeouts.  According to the old-timers, this behavior was observed on the old IBM DSxxxx, but they had a special LUN unlock button for such cases. <br>  There is no such button here, as a result, 89 people were left without access to their desktops for three hours, and we were already thinking about restarting the array and were looking for the safest and most reliable way to this (alternately restarting the controllers did not help). <br>  EMC support helped, who at first took out the necessary engineer from their depths, who then checked and looked through all the tabs and consoles for a long time, and the solution itself was simple and elegant: <br><br>  <i>vmkfstools --lock lunreset /vmfs/devices/disks/vml.02000000006001c230d8abfe000ff76c198ddbc13e504552432035</i> <br><br>  that is, the command to unlock from any host. <br>  Live and learn. <br><br>  For the next week, I frantically transferred desktops back to HDD storage, setting all tests aside for later-if-if-then-time.  There is no time left, since the array was taken away two days earlier than the promised time, since the next tester was not in Moscow, but Ufa (the surprise and orderliness in the return procedure costs separate non-fully standard statements). <br><br><h4>  Summary </h4><br>  Ideologically, I liked the solution.  If we slightly finish our VDI infrastructure by bringing user data to a file server, then we can place all of our 70 TB if not on one, then on two or three bricks.  That is, 12-18 units against the whole rack.  Could not, of course, not like the speed of svMotion and clone deployment (less than a minute).  However, it is still damp.  Data loss when updating and scaling cannot be considered acceptable in the enterprise.  And the moment with the reservation lock was also embarrassing. <br>  On the other hand, it somehow looks like an unfinished Nutanix.  The last truth can only be assessed by presentations, but they are always beautiful. <br>  And about the price.  CROC, in his posts, wrote about some incomprehensible figure of 28 million.  I heard about six and a half, and it was not yet the minimum.  Although I have no access to price negotiations nowadays, so I‚Äôll not take it for sure. </div><p>Source: <a href="https://habr.com/ru/post/228107/">https://habr.com/ru/post/228107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../228095/index.html">Zabbix 2.2: Monitoring the temperature of the Windows processor of the machine</a></li>
<li><a href="../228099/index.html">Inventing a bike or finding a missing ID value in a MySQL table</a></li>
<li><a href="../228101/index.html">Problems and prospects of ensuring the safety of civil aviation</a></li>
<li><a href="../228103/index.html">Web Application Firewall (ModSecurity) in action</a></li>
<li><a href="../228105/index.html">Upshifting for a programmer in Thailand</a></li>
<li><a href="../228109/index.html">Efficient energy management in the data center</a></li>
<li><a href="../228115/index.html">Disaster Recovery Planning. Part Three - Final</a></li>
<li><a href="../228121/index.html">DIY projection screen</a></li>
<li><a href="../228123/index.html">Online Store Migration: Testing Your Shop on a Different Platform</a></li>
<li><a href="../228125/index.html">Reactive programming for Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>