<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Recreating fonts from a CRT screen</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The study of glyphs on the terminals DEC VT100 and VT220 

 Recently, I got a little carried away with analog media emulation: I wanted to recreate th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Recreating fonts from a CRT screen</h1><div class="post__text post__text-html js-mediator-article">  <i>The study of glyphs on the terminals DEC VT100 and VT220</i> <br><br>  Recently, I got a little carried away with analog media emulation: I wanted to recreate the raster graphics of CRTs, like on the ‚Äúglass terminals‚Äù of the past, such as the cult VT series from Digital Equipment Corporation (DEC).  In the process, a number of questions arose about the features of displaying fonts in pixel graphics of a CRT.  I wonder how the fonts actually looked like and is it possible to reconstruct them according to specifications? <br><br><img src="https://habrastorage.org/webt/y3/qh/t4/y3qht4lf3uu5uqkqdlk6rj0f-sg.png"><br>  <i><font color="gray">Modern TrueType fonts recreate the VT220 glyphs.</font></i>  <i><font color="gray">Keep in mind that VT terminals supported two resolution modes: one for 132 characters per line and one for 80 characters (char-matrix 9 √ó 10 and 10 √ó 10, respectively), in the latter the interval is extended by one pixel</font></i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Due to the abundance of technical information on sites like <a href="https://vt100.net/dec/vt220/glyphs">vt100.net</a> and <a href="http://bitsavers.org/pdf/dec/terminal/">bitsavers.org,</a> you can easily determine the appearance of those fonts.  For example, we can restore the glyphs from the firmware of the terminals.  There are even TrueType fonts that repeat the VT220: <a href="http://sensi.org/~svo/glasstty/">Glass TTY VT220</a> with raster lines and <a href="">DEC Terminal Modern</a> with modern, smooth outlines (in the illustration above). <br><a name="habracut"></a><br>  Upon closer inspection, these fonts are significantly different from each other, but none of them look right.  Comparing with the photos of this VT100, there are noticeable differences not only in the font density, but also in the size and shape of the contours and in the overall ‚Äúfeel‚Äù of the font.  However, the terminal photos also cannot convey the real feeling of font density, because it strongly depends on the shooting parameters: <br><br><img src="https://habrastorage.org/webt/f6/t5/zi/f6t5zipsa1icpxbc8jerhj3hxcs.jpeg"><br>  <i><font color="gray">Adventure game Colossal CavePhoto on the VT100 screen.</font></i>  <i><font color="gray">Photo: <a href="https://en.wikipedia.org/wiki/File:Vt100-adventure.jpg">Wikipedia, Dave Fisher</a> , 2008, Wikimedia Commons (edited NL).</font></i> <br><br><img src="https://habrastorage.org/webt/x7/mp/or/x7mpor5pzdlcxnipb56fgjrsm_s.jpeg"><br>  <i><font color="gray">Displays a list of directories on the VT100.</font></i>  <i><font color="gray">Photo: <a href="https://www.flickr.com/photos/54568729%40N00/9636183501">Jason Scott</a> , 2013. Creative Commons (edited NL).</font></i> <br><br>  Since the photos do not really help, it's time to look at the firmware. <br><br><h1>  Firmware </h1><br>  There are copies of the ROM, you can simply extract from there real fonts that will perfectly match the original, right? .. What can go wrong? <br><br><img src="https://habrastorage.org/webt/jb/tc/nt/jbtcntimehavutnlbkme3kk8_ru.png"><br>  <i><font color="gray">The contents of the ROM from VT100 terminals (left) and VT220 (right).</font></i>  <i><font color="gray">The VT200 division was performed by Paul Flo Williams, <a href="https://vt100.net/dec/vt220/glyphs">vt100.net</a> (2008).</font></i>  <i><font color="gray">VT100 supplemented by me, N. L.).</font></i>  <i><font color="gray">The symbols 'a', 'c', 'g', '2', '6', '7', '9', '@', '%', '{', '}', '|' , '¬∞' and the form of control characters (‚êâ ‚êç ‚êä ‚ê§ ‚êã).</font></i>  <i><font color="gray">In addition, VT220 more characters</font></i> <br><br>  It also looks wrong.  Obviously, the glyphs stretch vertically to about double the height, but this is not the only distortion.  The characters just don't look right.  For example, look at the 'p' and 'q' or the offset of the points of the downward right stroke of the 'k', not to mention the funny outlines of the '6' and '9' on the VT100 or the distorted '2'!  Moreover, upon closer inspection, the symbol matrix is ‚Äã‚Äãonly 8 √ó 10, while we expected at least 9 √ó 10 (and 10 √ó 10 for the mode with 80 columns), as described in the specifications.  This is clearly not what is displayed on the screen. <br><br><h1>  Phosphorus </h1><br>  Let's take another look at the manuals, in particular <a href="https://vt100.net/docs/vt100-tm/ek-vt100-tm-002.pdf">the VT100 Series Technical Manual</a> (2nd edition, EK-VT100-TM-002; DEC, Maynard, Massachsetts, 1979).  It indicates that the matter is in the delay of the phosphor (phosphorus): <br><br><img src="https://habrastorage.org/webt/jx/hj/bp/jxhjbpuolfxlznuwuy4swjaxli8.png"><br>  <i><font color="gray">Pulse duration and phosphorus activation profile for VT100 and VT200 (VT100 Series Technical Manual, EK-VT100-TM-002, p. 4-78).</font></i>  <i><font color="gray">Keep in mind that the profiles of the signal pulses are highly idealized and in analog reality they are also oblique</font></i> <br><br>  The time of full activation of the phosphor is actually longer than the pulse duration for one pixel (40 nanoseconds).  This means that if we try to display only one pixel, the phosphor at that particular place will never reach its full level of activation, which will lead to a blurred image of different brightness between the dimmer, thinner areas and the denser, thicker.  Therefore, typography is forced to adjust, producing double-duration pulses (80 ns) in order to provide a clear image and legible text. <br><br><img src="https://habrastorage.org/webt/mb/ts/i7/mbtsi7hleah73ui8i5icki9jczq.png"><br>  <i><font color="gray">Single and double pulses and phosphor activation (from there, edited by NL)</font></i> <br><br><h1>  Point Stretching Scheme </h1><br>  For this purpose, VT terminals use a special dot stretching method: individual rows of the matrix of characters from ROM are modified on the fly, extending any active pixel pulses by another pixel.  Where in the ROM one pixel, there will be two on the screen.  Where two in a row, displays three. <br><br>  Thus, our 8 √ó 10 matrix expands to the expected 9 √ó 10 (or 10 √ó 10 in the 80-column mode, where the last pixel for drawing lines is stretched by one more pulse). <br><br><img src="https://habrastorage.org/webt/uw/ft/m2/uwftm2o-ua4zckayml2_t0pmsym.png"><br>  <i><font color="gray">Stretching points in VT100 and VT200 (VT100 Series Technical Manual, EK-VT100-TM-002, p. 4-78)</font></i> <br><br>  However, this results in different results for characters of regular size and double width!  Thanks to the wonders of stretching points in one font, two fonts are contained, each of which has a detalization that depends on the screen size! <br><br><img src="https://habrastorage.org/webt/ra/fw/03/rafw034u4t10ij1_t5qidmuvx88.png"><br><ol><li>  As in rom <br></li><li>  Single width with dot stretching <br></li><li>  Double width with stretching points <br></li><li>  Single width with stretching points and delay (phosphor) <br></li><li>  Double width with stretching points and delay (phosphor) </li></ol><br>  (1, 2, 3 according to Paul Flo Williams, <a href="https://vt100.net/dec/vt220/glyphs">vt100.net</a> , 4 and 5 added by me, NL) <br><br>  It is fundamentally important that the image (2) gives dotted strokes, which differ from clear lines in modern font reconstructions.  But if we add sine and cosine graphs of the activation of the phosphor (Fig. 4 and 5, as well as a diagram with the activation graph above), we get a more accurate version of the actual display on the screen (remember that VT100 and VT220 show quite noticeable raster lines). <br><br><img src="https://habrastorage.org/webt/ld/0t/pi/ld0tpixi_wnpxj4rojloxszhlbk.png"><br>  <i><font color="gray">Samples of characters VT220 (mode 80 columns).</font></i> <i><font color="gray"><br><br></font></i> <ol><li>  As in rom <br></li><li>  Single width with dot stretching <br></li><li>  Added phosphor activation charts <br></li><li>  Added phosphor glow </li></ol><br>  <i><font color="gray">(1 and 23 according to Paul Flo Williams, <a href="https://vt100.net/dec/vt220/glyphs">vt100.net</a> , 3, 4 and negative added by me, N. L.)</font></i> <br><br>  There is a rather extreme example of how the carrier dictates the appearance of a typographical form, or, on the other hand, how the design of glyphs is created taking into account the carrier and its specific technological limitations to achieve the desired typography.  Looking at the effects of phosphor activation, delay and luminescence, it becomes clear why different photos of VT terminal screens show different font widths, depending on the shutter speed on the camera, while the overall font smoothness is maintained. <br><br>  Here is another representation of the fonts in the ROM with the use of the described effects that better resemble the real image from the screen: <br><br><img src="https://habrastorage.org/webt/pp/ti/57/ppti57nawm_vucjof_hpejdika0.png"><br>  <i><font color="gray">Visible VT100 glyphs (left) and VT220 (right)</font></i> <br><br>  Below are the VT100 double width characters compared to normal single width characters (black on white, as well as negative, as seen from the screen): <br><br><img src="https://habrastorage.org/webt/2a/0x/le/2a0xleueenpzyyfvfbiofkenobu.png"><br><br><h1>  Pictures from the workbench </h1><br>  And, finally, two images from my desktop ‚Äúworkbench‚Äù, on which I try to recreate the screen of the analog terminal in a web browser using HTML5 and the canvas API.  Maybe a bit of a retro-blur, but you get the idea: <br><br><img src="https://habrastorage.org/webt/eb/re/fk/ebrefkqficqooxj_bi108wvglyq.png"><br>  <i><font color="gray">VT100 emulation (screenshot)</font></i> <br><br><img src="https://habrastorage.org/webt/rp/wk/ab/rpwkabj6rb_hbzl2sstf2odhqwa.png"><br>  <i><font color="gray">VT220 emulation (screenshot)</font></i> <br><br>  And that's all for today ... </div><p>Source: <a href="https://habr.com/ru/post/446598/">https://habr.com/ru/post/446598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446578/index.html">A programming language that fits on a postcard</a></li>
<li><a href="../446582/index.html">Reflections on solar hosting for bees</a></li>
<li><a href="../446586/index.html">Network settings from FreeRadius via DHCP</a></li>
<li><a href="../446590/index.html">39 new features that will be available in Java 12</a></li>
<li><a href="../446592/index.html">Checking the source code of Roslyn</a></li>
<li><a href="../446602/index.html">Maximum direct current through field effect transistor</a></li>
<li><a href="../446604/index.html">ESET: new delivery schemes for OceanLotus cyber group backdoor</a></li>
<li><a href="../446606/index.html">Check how well you know about additive technologies.</a></li>
<li><a href="../446608/index.html">Overcoming the third law of organizational gravity</a></li>
<li><a href="../446612/index.html">The moment we started to believe in innovation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>