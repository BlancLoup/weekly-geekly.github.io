<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Semaphore App. Ruby on Rails. Continuous integration / delivery</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 Having run through Habr, I surprisingly did not find a single article about a full-fledged team workflow using various magical quirks in th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Semaphore App. Ruby on Rails. Continuous integration / delivery</h1><div class="post__text post__text-html js-mediator-article"><h3>  Foreword </h3><br>  Having run through Habr, I surprisingly did not find a single article about a full-fledged team workflow using various magical quirks in the spirit of Continuous Integration &amp; Continuous delivery, various Github - HipChat (Slack) - CI - Staging and Production via Continuous Delivery, and other things although I may just not be able to search. <br><br><img src="https://habrastorage.org/files/814/f0b/286/814f0b286ccc4db88d6b9617eb8bcc98.png"><br><br>  But still, I wanted to share my, albeit little experience, to talk about various buns that make life easier for the team working on one project together, how this can be combined into one streamlined system and reduce the number of unpleasant feelings in the lower back during time of work on the project. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, under the cut - analysis of CI service SemaphoreApp, a little about integration with other services and other pleasures that simplify our lives. <br><a name="habracut"></a><br><h3>  The essence </h3><br>  You know, I will not explain in detail what CI is, why it is needed, and other general things, because many gentlemen had already explained them to me, and well, clearly, let's say, here: <a href="http://habrahabr.ru/post/82724/">‚ÄúIntroduction to Continuous Integration‚Äù</a> . <br><br>  And now, to the main point, let's connect our Rails app to Semaphore. <br><br>  Our great task is to go through an intuitive registration, but we still go through it, with comments and pictures. <br><br><h5>  Sign up </h5><br>  We go to semaphoreci.com, and the cool uncle will brag to us how cool it is to deploy for production. <br><br><img src="https://habrastorage.org/files/79f/ba3/0f8/79fba30f86214aa6a7f2e062dd95f624.png"><br><br>  We have a choice between GitHub and Bitbucket.  In fact, Semaphore supports a bunch of Atlassian products - Bitbucket, Hipchat, Jira. <br><br>  Not so bad. <br><br><img src="https://habrastorage.org/files/cbe/ae4/07f/cbeae407f329483e9f6d1a7cd4c635c0.png"><br><br>  Then just select the project and the branch you want to build. <br><br><img src="https://habrastorage.org/files/972/5fc/4a4/9725fc4a446647f9ba46454530983db1.png"><br><br>  We will be offered to make the initial project settings.  Of the proposed languages ‚Äã‚Äã- Ruby, Clojure, JS, PHP, Go, and the mythical language "Other." <br><br>  There are variations from the database used. <br><br><img src="https://habrastorage.org/files/042/40a/c7d/04240ac7dced4ed4af508c3720b3f4ec.png"><br><br>  And - everything.  You have your CI, 5.times {puts 'hooraaay!'  } <br><br><img src="https://habrastorage.org/files/c64/bab/9b6/c64bab9b64db424cbfa2e21889a51385.png"><br><br>  In fact - the easiest, just poke the buttons.  The complexity of the whole integration with other services will depend on your ability to press CTRL + C and CTRL + V.  Well, and read in English.  Level of confident PC user, accountant-translator. <br><br>  And, by the way - integration with GitHub and Bitbucket has already happened.  If your build fails, you can still make a merge pull-request.  And get over the ears from the team leader, for the boneless build. <br><br><img src="https://habrastorage.org/files/ad3/dde/124/ad3dde124b404b94bf0b415eddf3a843.png"><br><br>  By the way, if you have conflicting branches, then after the build, even the last one, Semaphore will not allow you to confuse your conflicting PR until you do git rebase -i your_integration_branch, and fix all conflicts. <br><br>  Well, if you have the green light, and, as in the right team, you were reviewed by your pull-request, and set to OK - you can press the cherished button and brag on the stand-by next day. <br><br><img src="https://habrastorage.org/files/2bc/3db/10c/2bc3db10c63f445ba5954cbcd6d0581b.png"><br><br><h5>  Communication </h5><br>  So, let's move on to the next part of our system - alerts about successful / unsuccessful builds, and just about intra-team communication. <br><br>  Mass variations, I suggested just HipChat or Slack.  Why - both are free, Slack looks nicer, but limited integrations (only 5), their size is smaller than that of HipChat.  HipChat - unlimited integrations, but in general - the same Slack, it just looks boring.  Not for fashionable startups. <br><br>  A small example with all the integrations that I did in the same room Hypchat. <br><br><img src="https://habrastorage.org/files/912/32b/e1f/91232be1f5194ceea5e0ed07eff6ed3d.png"><br><br>  Actually, here all the logs of what happened with the project.  And this is not all that can be integrated there.  Errors with Airbrake, NewRelic alerts, and many many more. <br><br>  Now we can see what Semaphore can do.  The list of settings in the studio. <br><br><img src="https://habrastorage.org/files/20f/b76/e93/20fb76e932a044e99419ec414f633f13.png"><br><br>  Build settings, configs, ENV vars, repository information, you can set priority branches for builds, run builds on a schedule (did not think of why), deployment (about which later), the Notifications tab, which, with a couple of copy-pasts, sets up alerts to you by email / hipchat room / slack room / another_where, and so on. <br><br>  For Hipchat, you just need to know the room name, or room ID, and token, which are easily generated in the HipChat settings.  It is worth driving - and the notification service is ready.  Easy. <br><br>  Well, of course there are webhooks if you need to set up alerts somewhere else. <br><br><h5>  Continuous deployment </h5><br>  But perhaps it‚Äôs worth completing my story on a note of Continuous Deployment with Heroku. <br><br>  That purple message in the picture with integrations in HipChat was the notification from Heroku about the successful delay.  Although, I didn‚Äôt do anything with my hands, I just had my pull-request, which was reviewed.  Semaphore did everything for me, and I can imagine myself the successful uncle who offered us to use this service. <br><br>  Let's say we already have a Rails application, and there is a Heroku server, and our workflow is to do a branch, write a feature, write tests, run tests in a branch, push a branch into integration, drive all integration tests.  If successful - git push heroku. <br><br>  In truth, it would take me less time to push for styling with Continuous Delivery than to describe the workflow. <br><br>  Let's start with integration - settings, Deployment tab, Add Server.  We are offered a choice. <br><br><img src="https://habrastorage.org/files/eff/87b/9d7/eff87b9d783540c0aac9d72755379cf1.png"><br><br>  I decided on heroku, your choice is yours.  Then we are offered to choose the type of deployment: automatic or manual.  The first deployment is every_successful_bild, which means if the build is not successful, it will not go anywhere, and the second way provides you with a briefcase with a red button, by pressing which the build will be sent to your server.  We are lazy, besides, our server should be considered for staging, and auto-warming will also be used for staging.  For prodakshen better already on the button. <br><br>  Then we will be offered to choose a branch for deployment and enter the Heroku API key.  And then it all is able to. <br><br>  You can also add a heroku add-on - Deploy Hooks, in which there is a HipChat hook that will notify you of successful or unsuccessful deployments.  Although there will not be unsuccessful deployes, if the build fails, I repeat - there will be no deployment. <br><br>  I hope someone will find this useful. </div><p>Source: <a href="https://habr.com/ru/post/253403/">https://habr.com/ru/post/253403/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253391/index.html">DUMP-2015 Conference: Serverside.Experience and Serverside.Knowledge section</a></li>
<li><a href="../253393/index.html">As we with third-graders programmed the address garland</a></li>
<li><a href="../253395/index.html">Mongoose rake</a></li>
<li><a href="../253397/index.html">Dagaz: Kicks to common sense (part 4)</a></li>
<li><a href="../253401/index.html">Analysis of the tasks of the warm-up training round of the Russian Code Cup 2015</a></li>
<li><a href="../253405/index.html">The Golden App mobile application competition has started</a></li>
<li><a href="../253407/index.html">CNC machine with advanced functionality</a></li>
<li><a href="../253413/index.html">Installing gitolite on a Centos server</a></li>
<li><a href="../253419/index.html">Visualization of equipment performance statistics with R - Shiny</a></li>
<li><a href="../253421/index.html">Making the code cleaner: Recommendations for preparing changes to the Linux kernel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>