<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Legends of virus construction: In the vise of an encoder</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Summer 1994 was remembered by many. What is it remembered? The answer is not complicated, although more than 15 years have passed, these three lines m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Legends of virus construction: In the vise of an encoder</h1><div class="post__text post__text-html js-mediator-article"><img src="http://sprockets.ru/pic/cyfers.png" align="right" alt="cyfers"><br>  Summer 1994 was remembered by many.  What is it remembered?  The answer is not complicated, although more than 15 years have passed, these three lines may cause discomfort for some of the readers ‚Äúunder the spoon‚Äù: <br><br> <code>Dis is one half. <br> Press any key to continue‚Ä¶ <br> <br> Did you leave the room? <br></code> <br><br>  If you didn‚Äôt see it live, let me describe the sensations that see those lines: <i>bewilderment</i> (about 1 minute), <i>banal fear</i> (~ 2 minutes), <i>feverish flow of thoughts</i> ( <i>what is it? What to do?</i> - on average 5 10 minutes), <i>anger</i> ( <i>what the hell ...?</i> ) And again a <i>hectic flow of thoughts and actions</i> (where is this fucking floppy with the <i>Web</i> ?), These are about the borderline emotional feelings felt by the owners of the infected machines. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you have not yet guessed, then it is a virus that most people remember as - <b>OneHalf</b> , although it is also known by other names - <i>Slovak Bomber, Explosion-II, Freelove</i> . <a name="habracut"></a><br><br>  The virus was first detected in May 1994 in the United States and Europe, but it was already late and the virus had already spread widely throughout the world.  <b>OneHalf was</b> distributed mainly through removable media (then it was mostly floppy disks).  It is extremely remarkable in its properties even now, and at that time it was a new word in the craft of virmasters, if so to speak of course. <br><br>  Firstly, <b>OneHalf</b> is polymorphic (not the first and far from the last, but modern viruses without polymorphism simply do not survive, for the ignorant polymorphic is considered such a virus, each new copy of which may not coincide with the previous byte in one byte), secondly, the virus was file-boot (infecting the <a href="http://ru.wikipedia.org/wiki/%25D0%2593%25D0%25BB%25D0%25B0%25D0%25B2%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B7%25D0%25B0%25D0%25B3%25D1%2580%25D1%2583%25D0%25B7%25D0%25BE%25D1%2587%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B7%25D0%25B0%25D0%25BF%25D0%25B8%25D1%2581%25D1%258C">MBR</a> and <i>boot</i> sectors of the diskettes, as well as <i>COM</i> and <i>EXE</i> files), thirdly, the virus body was encrypted, fourthly, before creating normal countermeasures, <b>OneHalf</b> destroyed the data, and last but not least, stealth functionality built into the virus by  allowed him to remain invisible to the system. <br><br><h3>  Now let's look at some of the details. </h3><br><br>  The encrypted virus body of <i>3544 bytes</i> in the infected file is located after the end of the file, and the infected file contains 10 <i>‚Äúspots‚Äù of the decoder</i> code and the <i>‚Äúspots‚Äù</i> allocation table, which is located at the beginning of the file and also contains information about the beginning offset of the virus body from the beginning a file. <br><br>  <b>Infected file (increment length 3544 bytes):</b> <br><ul><li>  Table of the placement of "spots" code decryptor </li><li>  "Spots" that contain the decrypter of the virus body </li><li>  Body of the infected file </li><li>  Encrypted virus body </li></ul><br><br><h3>  File infection mechanism </h3><br><br>  The epidemic was transmitted by <i>floppy-manual</i> method.  When the infected system accessed the diskette for recording, OneHalf intercepted it and checked the size, name (did not touch the files with the names <i>SCAN, CLEAN, FINDVIRU, GUARD, NOD, VSAFE, MSAV, CHKDSK, AIDS, ADINF, WEB</i> ) and the infection of the file.  If the size, name did not match the algorithm, or the file was already infected, the infection was not made.  If the file was clean and complied with the requirements of the virus, then it was infected. <br><br>  10 empty places ( <i>‚Äúspots‚Äù</i> ) were created in the file for recording the decryptor, while Vir created them in a random order, with a single condition - at least 10 bytes between the nearest <i>‚Äúspots‚Äù</i> .  The routing table for placing the <i>‚Äúspots‚Äù</i> of the decrypter code was located at the beginning of the file, it also stored a random key with which the virus body was encrypted, which was at the end of the infected file.  If for some reason the recording did not succeed, the <i>‚Äúspots‚Äù were</i> destroyed and the file remained clean, otherwise the infected file was written to a floppy disk, waiting for its next victim. <br><br><h3>  Computer infection mechanism </h3><br><br>  When using an infected diskette (booting from it or launching an infected file), the virus, using the <b>Int12h</b> own interrupt <b>handler,</b> estimated the size of free RAM and the presence of its copy in it ‚Äî the <b>Int21h</b> interrupt. <br><br>  If there was no virus in the memory and it is more than 4 [kB], he looked for signs of infection with the <i>MBR</i> , if there were none, he infected the <i>MBR</i> .  To do this, he replaced his original virus load handler in place of the original <i>MBR</i> , then recorded 7 sectors of his body code in 7 sectors from the end of the zero track of the disk in hidden sectors, and after all this, the original <i>MBR</i> in the eighth sector from the end of the zero track of the disk.  After writing his body to disk or when an already infected <i>MBR was</i> detected, <b>OneHalf</b> checked the memory and, in the absence of its copy, copied it from disk to memory. <br><br>  After the virus was loaded into the operative, the steering wheel was in his hands.  Next, the villain read the lower bound of the encrypted track from the <i>MBR</i> and, if it did not reach track 7 from the beginning, then vir encrypted two tracks up from the lower boundary of the already encrypted one, using the <i>random</i> key contained in the <i>MBR</i> .  If the encryption was successful, the new value of the lower bound of the encrypted tracks was recorded in the <i>MBR</i> .  (for work, he used his interrupt handlers <a href="http://www.codenet.ru/progr/dos/int_0001.php">Int01h</a> , <a href="http://www.codenet.ru/progr/dos/int_0011.php">Int12h</a> , <a href="http://www.codenet.ru/progr/dos/int_0021.php">Int1Ch</a> , <a href="http://www.codenet.ru/progr/dos/int_0012.php">Int13h</a> , <a href="http://www.codenet.ru/progr/dos/int_0026.php">Int21h</a> , <a href="http://www.codenet.ru/progr/dos/int_0034.php">Int24h</a> ).  If the lower limit reached the 7th track, no encryption was performed to avoid damage to the system disk areas. <br><br>  Then <b>OneHalf</b> analyzed three parameters: encryption of half of the disk, the multiplicity of the system date of four, and the parity of the infection counter (contained in the body of the virus itself);  with a positive test, the message was displayed: <br><br> <code>Dis is one half. <br> Press any key to continue‚Ä¶ <br></code> <br><br>  and the malware was waiting for the pressing of the <i>‚ÄúAny‚Äù</i> key. <br><br>  If the parameter check is negative (i.e., half of the disk is not encrypted, the counter is odd, or the system date is not suitable), then the message was not displayed, and the virus gave control to the original loader until the next computer boot, while <i>maintaining its interrupt handlers</i> . <br><br>  When working, the user did not notice anything, because <b>OneHalf</b> , who was sitting in his memory, intercepted calls to already encrypted tracks and decrypted them on the fly without any brakes, hid the decrease in RAM size and the increment in the length of infected files for all programs except <b>CHKDSK</b> and <b>Norton Commander</b> , but this is nothing it did so because, when trying to trace a virus in memory, it 100% hung the system in a <i>loop without exiting</i> with the help of its <i>int01h</i> interrupt <i>handler</i> . <br><br>  Depending on the modification of <b>OneHalf, the</b> sizes of increments of the infected files varied, 3544, 3577 or 3518 bytes, in connection with which the antivirus databases of the version called <i>OneHalf.3544, OneHalf.3577 and OneHalf.3518</i> . <br><br>  Also in different versions of <b>OneHalf,</b> when encrypting half of the disk, different messages were <b>displayed</b> on the display: <br><br> <code>Dis is one half. <br> Press any key to continue ‚Ä¶ <br> <br> Dis is TWO HALF. <br> Fucks any key to Goping‚Ä¶ <br> <br> HET ‚Äî u3uke u ucTopuu B pacnucaHuu uy7! <br> <br> Disk is Tpu half. <br> (Bepx, Hu3 u Pe6po) <br> <br> Dis is 3 HALF !. <br> Fucks any key to LoHing‚Ä¶ <br> <br> A cup of Beer ?. <br> See you later‚Ä¶</code> <br> <br><h3>  Wrestling </h3><br><br>  Why did this epidemic occur?  I think that was the case.  The virus was born somewhere in the winter of 1994, closer to the spring there was a massive spread that continued for several months unnoticed by users and developers of antiviruses.  The first news about the fatal lines on the display screens appeared only in May-June, since for a full encryption of a 0.5-GB hard drive, it was necessary to restart the computer about 500 times, which took several months during normal PC operation.  Therefore, <b>OneHalf</b> was missed, and the epidemic dispersed, almost becoming a pandemic. <br><br>  What is important is that to get rid of the virus it was not enough to simply rewrite the <i>MBR</i> , which would only lead to the loss of a key to encrypted data, and as a result, to data loss.  For guaranteed deliverance, a delicate work of the antivirus tools was needed, both for neutralizing and decoding data. <br><br>  The spread of the virus and its modifications occurred for several more years, but not at such an explosive pace, even now it still roams the old diskettes and rare computers. <br><img src="http://sprockets.ru/pic/OneHalf.png" alt="Onehalf"><br><br><h2>  PS </h2><br><img src="http://root.loopback.su/habralogger/empty.gif"><br>  What can I summarize here?  In general, not so long ago, I realized the fact that at school and at the university we were not in vain set up <i>‚Äújibs‚Äù</i> (two :) if they fired, that we did not check the diskettes just inserted into the drive for viruses, oh, not for nothing ... <br><br>  ‚Üí OneHalf on <b><a href="http://www.f-secure.com/v-descs/one_half.shtml">f-secure</a></b> site <br>  ‚Üí OneHalf on <b><a href="http://www.securelist.com/ru/viruses/encyclopedia%3Fvirusid%3D19554">securelist</a></b> <br>  ‚Üí OneHalf on <b><a href="http://www.viruslist.com/en/viruses/encyclopedia%3Fvirusid%3D19555">viruslist</a></b> <br>  ‚Üí About OneHalf on the <b><a href="http://www.ci.ru/inform12_97/onehalf.htm">‚ÄúComputer-Inform‚Äù</a></b> pages <br>  ‚Üí <b><a href="http://www.csie.ntu.edu.tw/~wcchen/asm98/asm/proj/b85506050/ORIGIN/ONEHAL~1.HTM">Essay</a></b> Kaspersky's <b><a href="http://www.csie.ntu.edu.tw/~wcchen/asm98/asm/proj/b85506050/ORIGIN/ONEHAL~1.HTM">Essay</a></b> on the OneHalf virus <b>[ENG]</b> </div><p>Source: <a href="https://habr.com/ru/post/74373/">https://habr.com/ru/post/74373/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../74368/index.html">Search for remote administration tool</a></li>
<li><a href="../74369/index.html">Open safe</a></li>
<li><a href="../74370/index.html">The first international forum of investors and Internet projects "Elba"</a></li>
<li><a href="../74371/index.html">Does RCC need for Habr's sandbox?</a></li>
<li><a href="../74372/index.html">Onkyo p305 Review (or OEM-nettop on ION-e)</a></li>
<li><a href="../74374/index.html">How to take my money from the Yandex wallet. Part 2.1. Running</a></li>
<li><a href="../74376/index.html">Fasting divine spark</a></li>
<li><a href="../74377/index.html">Windows Seven and many layouts</a></li>
<li><a href="../74379/index.html">radikal.ru has once again banned the use of the service on torrents.ru</a></li>
<li><a href="../74380/index.html">Actual threat data for 2009</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>