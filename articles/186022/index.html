<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About the organization of a network workspace in a small network at the level of virtual servers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, habrazhiteli! In this article, I will describe the structure that I had in the course of thinking about setting up a virtual workspace for a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About the organization of a network workspace in a small network at the level of virtual servers</h1><div class="post__text post__text-html js-mediator-article">  Good day, habrazhiteli!  In this article, I will describe the structure that I had in the course of thinking about setting up a virtual workspace for a network with a small number of users (the department at the university).  Main tasks: hosting of the cathedral site (Drupal), own repository and wiki, file sharing (or network drive), access to the network outside the premises of the department. <br><br>  This work has two objectives: <br><ul><li>  learn the opinion of experienced system administrators about this approach to setting up the workspace (please, criticize) </li><li>  in case the approach is incorrect, the article will nevertheless remain a list of technologies, among which someone can find suitable ones for him (for example, I have not heard about ownCloud for some reason) </li></ul><br><br>  The system used is Ubuntu 12.04 Server x64.  Physical server configuration: i5 second generation, 8 GB RAM, HDD 5400 1 TB. <br><a name="habracut"></a><br><h2>  Instruments </h2><br>  <a href="https://drupal.org/">Drupal</a> .  Historically (tm), that the site works on CMS Drupal.  Drupal is written in PHP, provides a choice of which database to use to store content.  Setting up Drupal with MySQL and nginx on Ubuntu 12.04, for example, <a href="http://bikulov.org/post/49094056366/ubuntu-server-12-04-drupal-7-nginx-mysql">here</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://rhodecode.org/">RhodeCode</a> A web application for working with the Git and Mercurial repositories.  He has some problems in the internal structure (for example, hanging a hook on an event in RhodeCode is more complicated than in a bare Mercurial).  However, you will not come across them until you get inside, and this may not be necessary.  Setup <a href="http://bikulov.org/post/34548785558/setting-up-rhodecode-on-ubuntu-12-04">Instructions</a> for Ubuntu 12.04 with nginx. <br><br>  <a href="https://www.dokuwiki.org/">DokuWiki</a> Wiki system does not use a database, but stores pages as files on a hard disk.  Moreover, when you add a file to disk, it appears in the wiki, and vice versa.  It is very convenient if you want to write an application for working with a wiki, and there is no time and desire to deal with <a href="https://www.dokuwiki.org/devel:xmlrpc">XML-RPC</a> .  Setup <a href="https://www.dokuwiki.org/install:nginx">Instructions</a> for Ubuntu 12.04 with nginx. <br><br>  <a href="http://owncloud.org/">ownCloud</a> Online file storage on your own server (i.e. ‚ÄúDropbox equivalent‚Äù).  Allows you to view PDF inside and listen to audio files, has clients for various platforms. <br><br>  <a href="http://wiki.nginx.org/Main">nginx Nginx is used</a> as a web server.  This is less convenient in terms of installing from repositories, since  the same Drupal in turnips Ubuntu uses Apache, so the first one has to be installed by hand. <br><br>  <a href="http://www.openldap.org/">OpenLDAP</a> Domain Analog in Windows.  Centralized work with user accounts.  In due time, I suffered with its setting (I don‚Äôt remember already why).  Therefore, I offer you two guides that work exactly: <a href="http://www.server-world.info/en/note%3Fos%3DUbuntu_12.04%26p%3Dldap%26f%3D1">server</a> and <a href="http://www.server-world.info/en/note%3Fos%3DUbuntu_12.04%26p%3Dldap%26f%3D2">client</a> . <br><br>  <a href="http://ru.wikipedia.org/wiki/VPN">VPN</a> A good <a href="https://help.ubuntu.com/lts/serverguide/openvpn.html">guide</a> to setting up a VPN is in the Ubuntu server manual. <br><br>  <a href="https://www.virtualbox.org/">VirtualBox</a> Virtualization technology does not play a role.  In this paper, VirtualBox was chosen for the following reasons: I could not find why using VirtualBox on the combat server is bad - I have uptime on it reaches 2 months (then reboot to install updates), I haven‚Äôt met any glitches.  I will not argue, as I stumble upon the shortcomings - <a href="http://blog.sleeplessbeastie.eu/2012/04/29/virtualbox-convert-raw-image-to-vdi-and-otherwise/">convert</a> vdi to raw and switch to Xen. <br><br>  <a href="http://labs.bittorrent.com/experiments/sync.html">Bittorrent Sync</a> Backup is <a href="http://habrahabr.ru/post/184702/">implemented</a> using Bittorrent Sync.  For data security (code is closed!) It is proposed to use <a href="http://askubuntu.com/questions/95920/encrypt-tar-gz-file-on-create">hybrid asymmetric encryption</a> .  Asymmetric encryption is expensive, therefore, hybrid: a long key is generated, which is saved to a file.  With this key, a large file is encrypted.  The file with the key itself is then encrypted asymmetrically. <br><br><h2>  Network structure </h2><br><br><img src="https://habrastorage.org/storage2/eb8/373/9c5/eb83739c585c6f52d885dcb02b17ac59.png"><br><br>  In the simplest case, all virtual machines are located on the same physical server.  This option will be described later.  It uses 4 virtual systems and one host (hostserver) installed directly on the hardware. <br><br>  The virtual systems identified in the vmserver-web scheme, vmserver-dev and vmserver-drive only host a specific web application.  The motivation for sharing is as follows: Drupal turns the main and slightly changing site, DokuWiki / RhodeCode is used in active mode, several similar viral machines can be created for different purposes, ownCloud hung my home server a couple of times, I would like to separate it from the rest. <br><br>  The vmserver-net virtual machine is running customized LDAP and VPN.  Network connection for all virtual machines - NAT.  All virtual machines are connected connected via VPN.  For vmserver-net, the specified VPN and LDAP ports have been forwarded from the host system. <br><br>  When requesting via http / https, the request is parsed by nginx on the host machine and, depending on the address, is forwarded via internal VPN to the correct virtual machine.  Using VPN allows the network to remain functional even if the vmserver-web, vmserver-dev and vmserver-drive are physically located somewhere else.  Just add new virtual systems, you only need to modify the nginx config. <br><br>  Now a little about security: backup and encryption.  Ssh access for all machines is allowed only by key.  Outside VPN only ssh of the host machine sticks out.  Access to virtual machines via ssh is possible only within your VPN.  Backup is the following set of operations on the host machine: pause the virtual machine, compress the image with gzip and hybrid encrypt the resulting archive.  The encrypted archive and file are placed in a folder synchronized via btsync between several physical machines.  (Based on stackoverflow, I suggest convenient scripts: <a href="https://gist.github.com/anonymous/5954872">initialization</a> (installing necessary packages and generating a key with a given name), <a href="https://gist.github.com/anonymous/5954886">encryption and decryption</a> (in the case of encryption, you must specify the file to encrypt and the public key, the original file will be deleted. In the case of decryption, you must specify the file and the private key, the encrypted file will be deleted. The file name with the symmetric encryption key will be automatically determined.). <br><br>  When backing up virtual machines is a very large overhead, but deploying such a backup is very easy.  And synchronization within your physical network of 3 GB per day seems insignificant (approximately as much as 4 archives of systems now). <br><br><h2>  Conclusion </h2><br>  The described approach allows, in my opinion, to achieve modularity and security when organizing a virtual workspace.  Preserving functionality when transferring any of the purple (vmserver-web, vmserver-dev or vmserver-drive) virtual machines to another physical machine provides scalability. <br><br>  On the other hand, in the comments I would like to hear the opinion of the community about this way of organizing virtual servers, the tools used and the questions indicated in the introduction. </div><p>Source: <a href="https://habr.com/ru/post/186022/">https://habr.com/ru/post/186022/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../186010/index.html">Big report from InfoCom - mega-interesting exhibition of screens</a></li>
<li><a href="../186014/index.html">Background replacement in Gimpa - working solution</a></li>
<li><a href="../186018/index.html">Big survey on mobile operating systems</a></li>
<li><a href="../18602/index.html">The problem of two pills</a></li>
<li><a href="../186020/index.html">Mobile web development: some features and tips</a></li>
<li><a href="../186026/index.html">Service monitoring the status of services in the cloud and alert administrators</a></li>
<li><a href="../186028/index.html">How to use mood</a></li>
<li><a href="../18603/index.html">Wonderful potatoes :) To everyone who is bored, have fun!</a></li>
<li><a href="../186034/index.html">Parallels Plesk Panel 11.5: what has appeared in the new version</a></li>
<li><a href="../186036/index.html">Testing the proposed value using the principles of a lean start-up and client development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>