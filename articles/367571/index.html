<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Making your own Z-Wave device based on Z-Uno</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Z-Wave protocol is very popular, and there is a huge variety of compatible devices. However, everyone who has ever automated their home, faced wit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Making your own Z-Wave device based on Z-Uno</h1><div class="post__text post__text-html js-mediator-article">  The Z-Wave protocol is very popular, and there is a huge variety of compatible devices.  However, everyone who has ever automated their home, faced with the fact that something is still missing. <br><br>  Someone lacks a pressure sensor, someone has a rain sensor, someone wants a device for 6 relays in one case, and also on batteries.  And someone just needs to control the iRobot Roomba through the Z-Wave. <br><br>  But all this is not in Z-Wave (and in other protocols, too), and manufacturers are not in a hurry to fulfill all your dreams. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We heard your pain and created the perfect combine.  Meet the Z-Uno, which combines simplicity and versatility.  Z-Uno is Arduino in the world of Z-Wave.  On this board you can collect all your dream devices and more. <br><img src="https://habrastorage.org/files/623/c2f/3dc/623c2f3dcf77484eaabca667e946a739.png"><a name="habracut"></a><br>  About the creation of the device Z-Wave and the difficulties associated with this, I <a href="http://geektimes.ru/company/zwave/blog/268602">wrote recently</a> .  Obviously, no one will develop their own device for themselves - this is too difficult and expensive.  But imagine if you are given access to the periphery of the Z-Wave chip, an open source compiler, a simple IDE, easy access to the Z-Wave network, certified functionality and the ability to work with any other Z-Wave device. <br><br>  And so we made it available in our new Z-Uno device (it is more correct to call Z-Uno a platform, not a device, because there are a lot of devices on this small board).  The idea behind Z-Uno is simple: <br><br>  You write C code in the Arduino style directly in the Arduino IDE.  The same medium is used to download your code via USB (it is also possible to upload a new code via radio via Z-Wave controllers - the so-called <abbr title="Over-the-air">OTA</abbr> flashing).  Your code controls all the legs as in Arduino.  The familiar Arduino feature set is supplemented with specific features for working with the Z-Wave network ‚Äî receiving and sending commands.  All the difficulties of Z-Wave are hidden under the hood of Z-Uno. <br><br>  We give an example of an unusual device.  For example, you want to remotely water your favorite flower, and also include lighting.  Well, he is very dear to you, and you want to turn on the watering yourself, and not automatically, in order to feel your involvement in the care of the plant.  To do this, you will take a soil moisture sensor, as well as a relay to turn on watering and LED strip for lighting.  But do not want to pull the wires to the flower.  How to be?  Connect to one of the Z-Uno ADC our humidity sensor, relays to digital outputs, and lighting to PWM.  The value from the ADC will be transmitted via Z-Wave in the form of a ‚Äúmulti-level sensor‚Äù (Sensor Multilevel), the relay will be represented via a ‚Äúbinary switch‚Äù (Switch Binary), and the regulator of the LED tape through a ‚Äúmulti-level switch‚Äù (Switch Multilevel).  Z-Wave controllers immediately pick up the data provided in this form, display them in the interface and allow you to remotely control. <br><br>  This is how the sensor, relay and dimmer connection to Z-Uno will look like (for simplicity, I didn‚Äôt draw either the details of connecting the irrigation relay or the dimmable LED ribbon control circuit - it is assumed that you already have this part of the circuitry by assembling a prototype on Arduino ).  This device will be powered by a micro-USB port Z-Uno, and 3.3 V for the Z-Uno itself and a soil moisture sensor are obtained thanks to the built-in DC-DC converter. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/53f/d9e/050/53fd9e050e3142aaafa0507e7f66ff95.png" width="500"></div><br><br><div class="spoiler">  <b class="spoiler_title">The code of our program for Z-Uno will look like this.</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> moistPin = A1; <span class="hljs-comment"><span class="hljs-comment">//         int feedPin = 14; //      int lightPin = PWM2; //     int dimLevel = 0; //      int moistLevel = 0; //       int moistLevelHist = 50; //     (          ) int moistLevelCritical = 300; //  ,          ZUNO_SETUP_CHANNELS( ZUNO_SENSOR_MULTILEVEL_MOISTURE(moistureGetter), //      -,   ZUNO_SWITCH_BINARY(feedGetter, feedSetter), //      -     ZUNO_SWITCH_MULTILEVEL(lightGetter, lightSetter) //     -     ); ZUNO_SETUP_ASSOCIATIONS( ZUNO_ASSOCIATION_GROUP_SET_VALUE //  -  Z-Wave     ); void setup() { //    pinMode(feedPin, OUTPUT); //        digitalWrite(feedPin, LOW); analogWrite(lightPin, dimLevel); } void loop() { int moistLevelNew = analogRead(moistPin); if (moistLevelNew &lt; moistLevel - moistLevelHist || moistLevelNew &gt; moistLevel + moistLevelHist) { //     if (((moistLevel &gt; moistLevelCritical) &amp;&amp; (moistLevelNew &lt; moistLevelCritical)) || ((moistLevel &lt; moistLevelCritical) &amp;&amp; (moistLevelNew &gt; moistLevelCritical))) { zunoSendToGroupSetValueCommand(CTRL_GROUP_1, moistLevel &lt; moistLevelCritical); //  ,   } moistLevel = moistLevelNew; zunoSendReport(CHANNEL_1); //     (   1) } delay(60*1000); } byte moistureGetter(void) { byte tmpLevel = moistLevel / 9; //   0 () - 900 ( )  0-100% ( 10-) if (tmpLevel &gt; 100) tmpLevel = 100; return tmpLevel; } void feedSetter(byte value) { digitalWrite(feedPin, value ? HIGH : LOW); } byte feedGetter() { return digitalRead(feedPin); } void lightSetter(byte value) { dimLevel = (value &gt; 99) ? 99 : value; //       (        ) analogWrite(lightPin, dimLevel*255/99); } byte lightGetter() { return dimLevel; }</span></span></code> </pre> <br>  The code is well commented.  The meaning of some lines will be described in more detail below. <br></div></div><br><br>  Thus, we just wrote a code similar to what you had for the Arduino, to read the humidity values ‚Äã‚Äãand to change the state of the legs controlling the relays, and also described the channels for Z-Wave and tied them to the values ‚Äã‚Äãobtained.  The rest of the work on data transfer Z-Uno will do for you.  Mobile applications and remote access provided by Z-Wave central controllers will allow you to control watering from anywhere in the world from the same interface that controls the rest of your smart home. <br><br>  View of our watering device in the Z-Way / RaZberry interface: <br><img src="https://habrastorage.org/files/380/e6e/7ba/380e6e7ba14a4f9b95e0399ca9987c46.png"><br><br>  View of our watering device in the Fibaro Home Center 2 and Home Center Lite interface: <br><img src="https://habrastorage.org/files/823/65a/3dd/82365a3dd82d4bdd942e7e2eeff64c6f.png"><br><br>  The view of our irrigation device in the Vera Edge interface (it is clear that the exotic soil moisture sensor is not shown, but replacing with relative humidity solves the problem in this case): <br><img src="https://habrastorage.org/files/6bb/829/18e/6bb82918ed7a42efa76ed67986a54032.png"><br><br>  View of our watering device in the Zipato ZipaBox interface: <br><img src="https://habrastorage.org/files/73f/afe/bd6/73fafebd6f7843b0bc35aa6545f01987.png"><br><br><h4>  Some bare facts about Z-Uno </h4><br>  Z-Uno is based on the Mitsumi WML-C85 module (versions with WML-C84 or ZM5101 can also be found).  Almost all the legs and functions we provide to the user through a convenient API as close as possible to the Arduino language.  Therefore, the characteristics of the Z-Uno are very similar to those of the SD3502, ZM5101 and WML-C84. <br><br>  <i>Note that Z-Uno is a booming project.</i>  <i>Italicized stated goals.</i>  <i>As implementation and testing we will mark them in</i> normal font.  The <abbr title="star">*</abbr> symbol indicates partially implemented functions (move the mouse to display a comment). <br><br><img src="https://habrastorage.org/files/348/d76/60c/348d7660c4b544b89dc637fae802e5bc.png" align="right" width="300"><h5>  Specifications: </h5><br><ul><li>  28 kB of flash memory for your sketches </li><li>  4kB RAM, </li><li>  Z-Wave radio transceiver on channels 9.6, 40 and 100 kbps, </li><li>  22 GPIO (some overlap with other functions), </li><li>  4 ADC, </li><li>  5 PWM <abbr title="so far only 4 of 5 are available">*</abbr> , </li><li>  2 UART <abbr title="while only 1 is available">*</abbr> , </li><li>  1 USB (in serial mode), </li><li>  <i>64 kByte EEPROM</i> , </li><li>  <i>1 SPI (master or slave modes)</i> </li><li>  <i>4 IR controllers and 1 IR receiver with learning function,</i> </li><li>  <i>1 TRIAC / ZEROX dimming controllers,</i> </li><li>  1 interrupt <abbr title="While the device simply wakes up from it, there is no ISR yet">*</abbr> , </li><li>  <i>2 timers (16 MHz or from an external source)</i> , </li><li>  <i>I2C (software on the legs GPIO)</i> , </li><li>  <i>1-wire (software on the legs GPIO)</i> , </li><li>  <i>8x6 button scanner (including in deep sleep mode)</i> , </li><li>  2 service LEDs, 1 service button, </li><li>  1 custom LED (like pin 13 for Arduino). </li></ul><br>  Z-Uno pinout (click to <a href="">view large picture</a> ): <br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/files/697/991/4ed/6979914edee84c729ba64a4a3f0084b8.gif"></a> </div><br><br><h5>  Power Modes: </h5><br><ul><li>  USB 5 V, external 3 V, external 4-15 V or 3 V battery, </li><li>  always online, sleeping or <abbr title="Frequently listening">FLiRS</abbr> , </li></ul><br><h5>  Z-Wave features: </h5><br><ul><li>  Z-Wave Plus Compliance </li><li>  All Z-Wave frequencies (due to different SAW filters there will be 3 types of Z-Uno) </li><li>  Support for 128-bit AES encryption boxes described in the Z-Wave protocol </li><li>  Update firmware and bootloader via USB or radio (Z-Wave OTA), </li><li>  MultiChannel (10 user channels - each channel provides one function, see below), </li><li>  10 groups of associations to control other devices </li><li>  The ability to control the radio Z-Wave relays, dimmers, locks, running scenes, </li></ul><br>  Each user channel can contain one of the following classes of Z-Wave commands: <br><ul><li>  Binary Switch (for relay), </li><li>  Multilevel Switch (for dimmers, blinds), </li><li>  <i>Color Switch (for colored lamps)</i> , </li><li>  Binary Sensor and Notification (for detectors and alarms), </li><li>  Multilevel Sensor (for sensors that return a numeric value), </li><li>  <i>Meter (for counters)</i> . </li></ul><br><br><h4>  Installing and configuring Z-Uno programming environment </h4><br>  Custom sketches are uploaded to Z-Uno directly from the Arduino IDE.  To work with Z-Uno, you need to install the corresponding package, which contains the compiler, the loader, the libraries and the .h files of the Z-Uno project.  This is done from the Board Manager recently introduced in the Arduino IDE.  For the Z-Uno package to appear in the list in the card manager, you need to go to the settings and enter a link to the description of the Z-Uno packages in the Additional Boards Manager URLs field: <a href="">http://z-uno.z-wave.me/files/z- uno / package_z-wave.me_index.json</a> .  Next, go to Tools -&gt; Board -&gt; Boards manager and install the package for Z-Uno. <br><br>  <b>Important!</b>  At the moment, only the penultimate <a href="https://www.arduino.cc/en/Main/OldSoftwareReleases">Arduino IDE 1.6.5 is</a> supported. <br><br>  After installing the Z-Uno package, the Z-Wave&gt; Me Z-Uno item will appear in the Tools list in the list of boards, and the Z-Uno Programmer in the list of programmers.  Select the desired port (COM port for Windows, ttyACM port for Linux and cu.usbmodem for OS X).  The Burn Bootloader item allows you to update the Z-Uno sketch bootloader and the Z-Wave stack (see Z-Uno architecture below) to the latest version included in the Z-Uno package. <br><br>  A tick will also appear in the menu to enable encryption (Security command class) and compact packet sending (MultiCommand command class).  These features are not supported by some controllers.  In addition, in the same list, you can select the frequency of Z-Uno operation (note that the SAW filter is in any case tuned to one of the three frequency ranges, i.e. if you select an unsuitable frequency, the radio communication distance will be significantly lower!). <br><br>  In the File-&gt; Examples menu, examples specific to Z-Uno will also appear.  You can start exploring the possibilities of Z-Uno. <br><br><div class="spoiler">  <b class="spoiler_title">The whole process in pictures</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/653/ce0/4c4/653ce04c42ae42cb96f937b15513175d.png"><br><img src="https://habrastorage.org/files/ed4/436/8c2/ed44368c27514cb991d535e8a0daf01b.png"><br><img src="https://habrastorage.org/files/356/b91/ed0/356b91ed00484bb08dd36152fbc979a6.png"><br><img src="https://habrastorage.org/files/b44/62c/290/b4462c290b064d09b860eb9224686cce.png"></div></div><br><br>  Detailed <a href="http://z-uno.z-wave.me/install">installation instructions are</a> presented on the Z-Uno project website. <br><br><h4>  What else can be done on Z-Uno? </h4><br>  Here you need to use your imagination.  Here are a few ideas: <br><ul><li>  Battery operated switch </li><li>  Dimmer Twister (Rotary Dimmer), </li><li>  Sensor temperature, humidity, light, voltage, distance, pressure, rain, ... </li><li>  Counter, dry contact sensor, low voltage relay, </li><li>  IR remote, </li><li>  LED driver </li><li>  Engine management, </li><li>  Button panel (keyboard) on batteries, </li><li>  Converter from Z-Wave to other protocols (any sensors connected via SPI / UART / I2C / 1-wire buses). </li></ul><br><br><h4>  Z-Uno and Z-Wave </h4><br>  Creating your own devices based on Z-Uno you do not need to study all the documentation of the Z-Wave protocol and ZM5101 microcontrollers.  However, you will need some minimal knowledge about Z-Wave to correctly describe the functions you need in the sketch. <br><br><h5>  <abbr title="Channels">Channels</abbr> </h5><br>  In order to present several functions in one device, channels (occasionally called <abbr title="instance">‚Äúinstances‚Äù</abbr> ) are described in the Z-Wave protocol.  In Z-Uno, we use this concept to create complex devices.  Each Z-Uno channel provides one of the functions declared by the user.  How many functions are described, so many channels will be.  Use the macro <a href="http://z-uno.z-wave.me/Reference/ZUNO_SETUP_CHANNELS">ZUNO_SETUP_CHANNELS</a> to describe the number and types of channels. <br><br><div class="spoiler">  <b class="spoiler_title">For example, this is how we describe a device for measuring humidity and turning on watering and lighting.</b> <div class="spoiler_text"><pre> <code class="cpp hljs">ZUNO_SETUP_CHANNELS( ZUNO_SENSOR_MULTILEVEL_MOISTURE(moistureGetter), ZUNO_SWITCH_BINARY(feedGetter, feedSetter), ZUNO_SWITCH_MULTILEVEL(lightGetter, lightSetter) );</code> </pre> <br>  This code describes three channels.  The first will contain a class of commands Sensor Multilevel and transmit the value of soil moisture, the second will control irrigation, and the third will provide a light switch. <br></div></div><br><br><h5>  <abbr title="Associations">Associations</abbr> </h5><br>  Z-Uno itself will send status reports on the channels to the controller (when calling zunoSendReport (channel number)).  However, Z-Uno can also control other Z-Wave devices.  To simplify configuration, the concept of an association group (or just an association) is described in the Z-Wave protocol.  An association group is a list of network devices to which a certain command will be sent upon the occurrence of a specific event.  The type of command and events are programmed in the device, while the list of recipients can be easily changed from the interface of the Z-Wave controllers. <br><br>  The macro <a href="http://z-uno.z-wave.me/Reference/ZUNO_SETUP_ASSOCIATIONS">ZUNO_SETUP_ASSOCIATIONS</a> allows <a href="http://z-uno.z-wave.me/Reference/ZUNO_SETUP_ASSOCIATIONS">you</a> to determine the number of groups available in the device and the type of command to be sent for each group (relay control, dimmer, or running scenes). <br><br><div class="spoiler">  <b class="spoiler_title">For example, this is how we describe a group to control another device such as a relay.</b> <div class="spoiler_text">  At the top of the project file: <br><pre> <code class="cpp hljs">ZUNO_SETUP_ASSOCIATIONS(ZUNO_ASSOCIATION_GROUP_SET_VALUE);</code> </pre> <br>  and in the right place in the code: <br><pre> <code class="cpp hljs">zunoSendToGroupSetValueCommand(CTRL_GROUP_1, );</code> </pre> </div></div><br><br><h5>  Power management </h5><br>  Z-Wave protocol is designed so that it is possible to create devices with very low power consumption and to power them from batteries.  Most Z-Wave sensors have been working on a battery pack for over a year.  However, for this purpose, the device must remain in the ‚Äúsleep‚Äù state most of the time, occasionally waking up to measure sensor values ‚Äã‚Äãand send reports.  Such devices are called <abbr title="sleeping"><b>"sleeping</b></abbr> . <abbr title="sleeping"><b>"</b></abbr> <br><br>  On the one hand, to make the device battery-powered, and on the other - to be able to control it in real time (without waiting for waking up), Z-Wave introduced another type of power management: <b>‚Äúoften listening‚Äù</b> devices or <abbr title="Frequently Listening Routing Slave">FLiRS</abbr> .  These devices wake up once a second to check the air for the ‚Äúwake-up packet‚Äù and immediately go to sleep if there is nothing for them.  Communication with such devices will take a little longer - before sending the right command, you need to send a special ‚Äúwake-up packet‚Äù within one second.  During this time, the network will be silenced, but after waking up, the device will promptly respond to commands before going to sleep.  In this mode, the device is able to live on a set of batteries for about a year.  Typical devices that require this mode are battery-powered relays, sirens, door locks. <br><br>  All constantly powered devices, such as dimmers, relays and other performers, are <abbr title="always listening"><b>‚Äúconstantly listening‚Äù</b></abbr> .  This means that they are always available, always listen to the broadcast and act as repeaters for other devices, forming a <abbr title="mesh network">mesh network</abbr> . <br><br>  Z-Uno supports all three power modes.  Power mode can be defined by the macro <a href="http://z-uno.z-wave.me/Reference/ZUNO_SETUP_SLEEPING_MODE">ZUNO_SETUP_SLEEPING_MODE</a> . <br><br>  <b>Important!</b>  When changing the parameters or the number of channels, association groups or power mode, you must exclude Z-Uno from the network and re-enable it in the network.  This is caused by the requirement of the Z-Wave protocol not to change its characteristics on the fly. <br><br><h5>  Learn more about Z-Wave </h5><br>  The information mentioned here should be enough to create your own Z-Wave device, but a deeper understanding never hurts.  You can read more <a href="http://geektimes.ru/company/zwave/blog/257684/">in this article</a> , as well as <a href="http://rus.z-wave.me/shop/additional/kniga-osnovy-z-wave/">in the book "Basics of Z-Wave" by</a> Christian Petz. <br><br><h4>  Controller Compatibility </h4><br>  We make Z-Uno fully up-to-date with the latest Z-Wave Plus standard.  However, alas, it does not guarantee full performance in all controllers.  Alas, many controllers require ‚Äúpatterns‚Äù to support specific devices.  Writing such templates is difficult or even impossible (the controller manufacturer may not be able to load its template).  And some controllers do limit the displayed functions of the device to three or four controls.  This greatly limits the ability to use Z-Uno. <br><br>  Immediately, we note that our own Z-Way controller supports any version of Z-Uno-based devices right out of the box.  No, we did not do special support for Z-Uno and did not write any templates.  It's just that the Z-Way is written this way, and it is enough for it that the device is certified and complies with the Z-Wave protocol. <br><br>  So far, we have tested Z-Uno with Z-Way (full compatibility), Fibaro (up to four functions), Vera Edge (exotic sensors are not supported), Zipato (little tested, but so far no problems have been noticed).  We hope that the manufacturers of controllers will improve the work of the controllers and support for the functions included in the standard Z-Wave. <br><br><h4>  Z-Uno Internal </h4><br><img src="https://habrastorage.org/files/60b/586/efe/60b586efe12147bba19ea5a936da2080.png" align="right">  I would like to mention how the Z-Uno is arranged inside.  The Z-Uno executable code consists of four parts: <br><br>  <b>The custom code</b> , also <abbr title="sketch">known</abbr> as the <abbr title="sketch">‚Äúsketch‚Äù</abbr> , is your code written in <a href="http://z-uno.z-wave.me/Reference">simplified C language</a> and loaded into Z-Uno via Arduino IDE.  User code controls all the "legs" and the logic of the device.  You decide how to connect this or that periphery! <br><br>  <b>The custom code loader</b> implements the Z-Wave application level in accordance with the user settings, determines the channels and groups of associations, sets the sleep mode.  It also controls the service LEDs and handles the service buttons necessary to turn on the device in the network, reset and transfer to the ‚Äúrecovery‚Äù mode (the mode in which the user code is not loaded).  But the main role of the loader is to call the User Code when retrieving the Set (set value) and Get (request value) packets from the Z-Wave network, as well as calling the loop function all the time while lower levels are not occupied.  This level is the main part of the core of the Z-Uno firmware. <br><br>  <b>The Z-Wave application layer</b> maps user-defined Z-Uno channels, functions, and associations to Z-Wave command classes, ensuring compliance with the Z-Wave Plus standard.  This level also provides features such as firmware upgrades, USB and radio ( <abbr title="Over-the-wire">OTW</abbr> and <abbr title="Over-the-air">OTA</abbr> ), AES encryption of all radio packets, monitoring radio signal strength, measuring battery charge, periodic waking up, and announces basic device information to the network. <br><br>  <b>The Z-Wave network layer is</b> based on the Sigma Designs SDK (version 6.5x), which implements the network and radio layers of the Z-Wave protocol, establishing reliable two-way <abbr title="cellular">mesh</abbr> communication in the smart home network.  This level is engaged in the calculation of routes, ensuring the delivery of packets to recipients, even outside the direct line of sight, performs forwarding (routing) and receiving packets. <br><br>  Custom code (sketch) is compiled into the Arduino IDE with the Z-Uno Core Libraries libraries, which must be installed via the Arduino Board Manager.  Like Arduino sketches, Z-Uno sketches are common firmware compiled for the corresponding microcontroller.  However, compared to Arduino based on Atmel microcontrollers, Z-Uno is based on a Z-Wave chip, i.e.  8051 architecture. Therefore, instead of avg-gcc, the <a href="http://sdcc.sourceforge.net/">sdcc</a> compiler is used to build Z-Uno <a href="http://sdcc.sourceforge.net/">sketches</a> . <br><br>  There is one more difference from Arduino sketches: Z-Uno sketches should interact with the levels below.  This interaction is carried out through the Z-Uno Core Libraries, with which the Z-Uno sketches are compiled. <br><br>  As already mentioned, the User Code can be downloaded via the Arduino IDE via USB (using the Upload button), as well as via radio via the Z-Wave controller, which supports firmware updates in devices. <br><br>  All lower levels (User Code Loader, Z-Wave Application Level and Z-Wave Network Layer - all together) can also be updated via USB from the Arduino IDE (using the ‚ÄúUpload Bootloader‚Äù menu item) or also via radio via the Z-Wave controller. <br><br>  Note that these lower layers are compiled with the Z-Wave SDK libraries using the Keil C51 compiler, while custom code is compiled using sdcc.  I think we will write a separate article about how we crossed a hedgehog with a snake.  After all, these compilers even have slightly different conventions and ABI function calls. <br><br><h4>  Disadvantages of Z-Uno </h4><br>  We tried to make the perfect product, but it doesn't always work out well;) <br><br>  Alas, the first released version does not fit on one breadboard (due to the size of the battery, we could not reduce the charge).  But the next version will be narrower and fit on one standard layout. <br><br>  Also in the current version we miscalculated with the choice of the battery - the current one is not able to properly power the device in FLiRS mode.  The following will not have a battery on board, but only a cable for connecting an external battery. <br><br>  Also, the current board does not have protection against connecting both the battery and external power at the same time.  This is reminiscent of the protective paper in the battery compartment.  But it will be fixed. <br><br>  As you can see, these shortcomings are important, but not critical for most functions.  The rest of the device turned out very versatile and is suitable for creating a variety of sensors and actuators. <br><br>  It is also worth noting that, unlike the Arduino, the Z-Uno has 3 V on its feet, not 5 V. This should be taken into account in order not to burn the entrances. <br><br>  After a few workshops, we realized that the product was still difficult: those who are familiar with Arduino should familiarize themselves with the ecosystem of Z-Wave devices and the interface of Z-Wave controllers, and those who are familiar with Z-Wave should have basic knowledge S. Fortunately, the intersection of the subsets of these people is very large. <br><br><h4>  What Z-Uno is not </h4><br><ul><li>  Z-Uno is a single device (with multiple channels).  Those.  there can be no full gateway between Z-Wave and other Z-Uno technology (for this purpose, there is a Bridge Controller in Z-Wave). </li><li>  Z-Uno is a subsidiary Z-Wave device and cannot be a controller (that is, build and administer a network).  However, through associations, Z-Uno can control other devices. </li><li>  Z-Uno is not a complete device - you will need to connect sensors (for example, from a list compatible with Arduino) and program work with them. </li></ul><br><br><h4>  Project Development and Plans </h4><br>  As I mentioned, Z-Uno is a fast-paced project.  We set ourselves a very ambitious goal, and confidently step towards it.  Here is a brief outline of the project for the coming months: <br><ul><li>  January - syntax cleaning, preparation for Z-Wave Plus certification. </li><li>  February - Z-Wave Plus certification, adding EEPROM functions, with <abbr title="Section XRAM, eating even in a dream">NZ XRAM</abbr> memory. </li><li>  March - adding protocols SPI, I <sup>2</sup> C, 1-wire. </li><li>  April - release of the updated version of the board (for the 865-870 MHz band - Z-Wave frequencies for Russia, Europe, Malaysia, India, ...) </li><li>  May and further - adding new functions in order of priority (based on the wishes of users). </li><li>  somewhere in the fall - release versions of the board for other regions. </li></ul><br><br><h5>  Follow the news! </h5><br>  All information about the project is published on the website <a href="http://z-uno.z-wave.me/">z-uno.z-wave.me</a> .  There is also a description of the functions of the C programming language and code examples (in English). <br><br>  We also have an English-language <a href="http://forum.z-wave.me/viewforum.php%3Ff%3D3427">forum</a> dedicated to Z-Uno. <br><br>  The Z-Uno Core Libraries code <a href="https://github.com/Z-Wave-Me/Z-Uno-Core">is available on github</a> . <br><br>  We accept information on errors and suggestions through github: you can <a href="https://github.com/Z-Wave-Me/Z-Uno-Core/issues">create a ticket and report a problem</a> . <br><br><h4>  Well, where to buy? </h4><br>  Z-Uno is already available (for the time being only in Russia) with our <a href="http://www.5smart.ru/collection/super-deals/product/z-uno-2">5 smart</a> partners, who give 5% to all Z-Wave devices for a GT_ZUNO coupon within a week after this publication.  We hope, soon Z-Uno will appear in other stores. <br><br>  The recommended retail price of 3500 rubles. <br><br>  Details of the project on the website <a href="http://z-uno.z-wave.me/">z-uno.z-wave.me</a> . <br><br><img src="https://habrastorage.org/files/411/4a5/0b9/4114a50b96ac43f799c7c8bbdfeed878.png"></div><p>Source: <a href="https://habr.com/ru/post/367571/">https://habr.com/ru/post/367571/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../367561/index.html">Programming Technology ARM Cortex-M0 +</a></li>
<li><a href="../367563/index.html">Fetch Robotics introduces Fetch and Freight robots: your warehouse will now be automated.</a></li>
<li><a href="../367565/index.html">Univer Kaspersky 2020 - an application to improve the information security of users of the social network VKontakte</a></li>
<li><a href="../367567/index.html">6 years of observing gamma-radiation sources in the Universe: video from NASA</a></li>
<li><a href="../367569/index.html">The American company Sealed Air has released a film with bubbles that do not burst</a></li>
<li><a href="../367573/index.html">Reddit has a global strike of moderators</a></li>
<li><a href="../367575/index.html">The power system of Ukraine really attacked the attackers: the conclusions of SANS</a></li>
<li><a href="../367577/index.html">DIY Hikaru Skirt</a></li>
<li><a href="../367579/index.html">PowerDot miostimulator review: compact and manageable</a></li>
<li><a href="../367581/index.html">The last attempt to contact the Philae module on the comet Churyumov-Gerasimenko was unsuccessful</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>