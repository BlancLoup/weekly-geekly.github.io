<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>LSB steganography</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once upon a time I wrote my first post on Habr√© . And that post was devoted to a very interesting problem, namely steganography. Of course, the soluti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>LSB steganography</h1><div class="post__text post__text-html js-mediator-article">  Once <a href="http://habrahabr.ru/blogs/personal/100709/">upon a</a> time I wrote my <a href="http://habrahabr.ru/blogs/personal/100709/">first post on Habr√©</a> .  And that post was devoted to a very interesting problem, namely steganography.  Of course, the solution proposed in that old topic cannot be called steganography in the true sense of the word.  This is just a game with file formats, but, nevertheless, quite an interesting game. <br><br>  Today we will try to dig a little deeper and consider the LSB algorithm.  If you're interested, you are welcome under the cat.  (Under the cut traffic: about a megabyte.) <br><a name="habracut"></a><br>  First of all, you need to make a small introduction.  Everyone knows that the purpose of cryptography is to make it impossible to read secret information.  Of course, cryptography has its own uses, but there is another approach to data protection.  You can not encrypt information, but to pretend that we do not have it.  This is what steganography is invented for.  Wikipedia assures us that, ‚Äústeganography (from the Greek. Œ£œÑŒµŒ≥Œ±ŒΩŒøœÉ - hidden and Greek. ŒìœÅŒ±œÜœâ - I write, literally‚Äú secret writing ‚Äù) - is the science of the hidden transfer of information by keeping in secret the very fact of transmission. <br><br>  Of course, no one forbids combining cryptographic and steganographic methods.  Moreover, in practice they do this, but our task is to understand the basics.  If you carefully study the article from Wikipedia, you can learn that the so-called steganography algorithms appear.  container and message.  A container is any information that helps to hide our secret message. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In our case, the container will be a picture in BMP format.  To begin, consider the structure of this file.  The file can be divided into 4 parts: the file header, image header, palette, and the image itself.  For our purposes, you need to know only what is written in the title. <br><br>  The first two bytes of the header are the BM signature, then the double word contains the file size in bytes, the next 4 bytes are reserved and must contain zeros, and finally, another double word contains the offset from the beginning of the file to the image bytes.  In a 24-bit bmp file, each pixel is encoded with three bytes of BGR. <br><br>  Now we know how to get to the image, it remains to understand how we can write down the information we need.  For this we need the LSB method.  The essence of the method is as follows: we replace the low-order bits in bytes responsible for color coding.  Suppose if the next byte of our secret message is 11001011, and the bytes in the image are ... 11101100 01001110 01111100 0101100111 ..., then the encoding will look like this.  We will break the secret message byte into 4 two-bit parts: 11, 00, 10, 11, and replace with the received fragments the lower bits of the image: ... 111011 <b>11</b> 010011 <b>0</b> 0 011111 <b>1</b> 0 0101100111 ....  Such a replacement is generally not noticeable to the human eye.  Moreover, many old output devices will not even be able to display such minor changes. <br><br>  It is clear that it is possible to change not only 2 low bits, but also any number of them.  Here is the following pattern: the more bits we change, the more information we can hide, and the more noise in the original image it will cause.  For example, here are two images: <br><br><img src="http://imgex.com/images/619flag.bmp" alt="image"><br><img src="http://imgex.com/images/508caroll.bmp" alt="image"><br><br>  With all my desire, I was never able to see the differences between them, and nevertheless, in the second image, using the described method, the poem ‚ÄúSnark Hunt‚Äù by Lewis Carroll was hidden.  If you have read this far, then you will certainly be interested in learning about the implementation.  She is pretty simple, but I will immediately warn you that everything has been done in Delphi.  There are two reasons for this: 1. I consider Delphi to be a good language;  2. This program was born, in the process of preparing a course on the basics of machine vision, and the guys with whom I read this course, so far nothing but Delphi know.  For those who are not familiar with the syntax, one thing should be clarified: shl x - bitwise left shift by x, shr x - bitwise right shift by x. <br><br>  We consider that we write the text stored in the string into the container and replace the lower two bytes: <br>  Code to write: <br><br><blockquote>  <font color="#000000">for</font> i <font color="#000066">:</font> <font color="#000066">=</font> <font color="#0000ff">1</font> <font color="#000000">to</font> <font color="#000066">length</font> <font color="#000066">(</font> <font color="#000066">str</font> <font color="#000066">)</font> <font color="#000000">do</font> <br>  <font color="#000000">begin</font> <br>  l1 <font color="#000066">:</font> <font color="#000066">=</font> <font color="#000066">byte</font> <font color="#000066">(</font> <font color="#000066">str</font> <font color="#000066">[</font> i <font color="#000066">]</font> <font color="#000066">)</font> <font color="#000000">shr</font> <font color="#0000ff">6</font> <font color="#000066">;</font> <br>  l2 <font color="#000066">:</font> <font color="#000066">=</font> <font color="#000066">byte</font> <font color="#000066">(</font> <font color="#000066">str</font> <font color="#000066">[</font> i <font color="#000066">]</font> <font color="#000066">)</font> <font color="#000000">shl</font> <font color="#0000ff">2</font> <font color="#000066">;</font>  l2 <font color="#000066">:</font> <font color="#000066">=</font> l2 <font color="#000000">shr</font> <font color="#0000ff">6</font> <font color="#000066">;</font> <br>  l3 <font color="#000066">:</font> <font color="#000066">=</font> <font color="#000066">byte</font> <font color="#000066">(</font> <font color="#000066">str</font> <font color="#000066">[</font> i <font color="#000066">]</font> <font color="#000066">)</font> <font color="#000000">shl</font> <font color="#0000ff">4</font> <font color="#000066">;</font>  l3 <font color="#000066">:</font> <font color="#000066">=</font> l3 <font color="#000000">shr</font> <font color="#0000ff">6</font> <font color="#000066">;</font> <br>  l4 <font color="#000066">:</font> <font color="#000066">=</font> <font color="#000066">byte</font> <font color="#000066">(</font> <font color="#000066">str</font> <font color="#000066">[</font> i <font color="#000066">]</font> <font color="#000066">)</font> <font color="#000000">shl</font> <font color="#0000ff">6</font> <font color="#000066">;</font>  l4 <font color="#000066">:</font> <font color="#000066">=</font> l4 <font color="#000000">shr</font> <font color="#0000ff">6</font> <font color="#000066">;</font> <br><br>  f <font color="#000066">.</font>  <font color="#006600">ReadBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">Position</font> <font color="#000066">:</font> <font color="#000066">=</font> f <font color="#000066">.</font>  <font color="#006600">Position</font> <font color="#000066">-</font> <font color="#0000ff">1</font> <font color="#000066">;</font> <br>  tmp <font color="#000066">:</font> <font color="#000066">=</font> <font color="#000066">(</font> <font color="#000066">(</font> tmp <font color="#000000">shr</font> <font color="#0000ff">2</font> <font color="#000066">)</font> <font color="#000000">shl</font> <font color="#0000ff">2</font> <font color="#000066">)</font> <font color="#000066">+</font> l1 <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">WriteBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br><br>  f <font color="#000066">.</font>  <font color="#006600">ReadBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">Position</font> <font color="#000066">:</font> <font color="#000066">=</font> f <font color="#000066">.</font>  <font color="#006600">Position</font> <font color="#000066">-</font> <font color="#0000ff">1</font> <font color="#000066">;</font> <br>  tmp <font color="#000066">:</font> <font color="#000066">=</font> <font color="#000066">(</font> <font color="#000066">(</font> tmp <font color="#000000">shr</font> <font color="#0000ff">2</font> <font color="#000066">)</font> <font color="#000000">shl</font> <font color="#0000ff">2</font> <font color="#000066">)</font> <font color="#000066">+</font> l2 <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">WriteBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br><br>  f <font color="#000066">.</font>  <font color="#006600">ReadBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">Position</font> <font color="#000066">:</font> <font color="#000066">=</font> f <font color="#000066">.</font>  <font color="#006600">Position</font> <font color="#000066">-</font> <font color="#0000ff">1</font> <font color="#000066">;</font> <br>  tmp <font color="#000066">:</font> <font color="#000066">=</font> <font color="#000066">(</font> <font color="#000066">(</font> tmp <font color="#000000">shr</font> <font color="#0000ff">2</font> <font color="#000066">)</font> <font color="#000000">shl</font> <font color="#0000ff">2</font> <font color="#000066">)</font> <font color="#000066">+</font> l3 <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">WriteBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br><br>  f <font color="#000066">.</font>  <font color="#006600">ReadBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">Position</font> <font color="#000066">:</font> <font color="#000066">=</font> f <font color="#000066">.</font>  <font color="#006600">Position</font> <font color="#000066">-</font> <font color="#0000ff">1</font> <font color="#000066">;</font> <br>  tmp <font color="#000066">:</font> <font color="#000066">=</font> <font color="#000066">(</font> <font color="#000066">(</font> tmp <font color="#000000">shr</font> <font color="#0000ff">2</font> <font color="#000066">)</font> <font color="#000000">shl</font> <font color="#0000ff">2</font> <font color="#000066">)</font> <font color="#000066">+</font> l4 <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">WriteBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br><br>  <font color="#000000">end</font> <font color="#000066">;</font> </blockquote><br>  read code: <br><blockquote>  <font color="#000000">for</font> i <font color="#000066">:</font> <font color="#000066">=</font> <font color="#0000ff">1</font> <font color="#000000">to</font> MsgSize <font color="#000000">do</font> <br>  <font color="#000000">begin</font> <br>  f <font color="#000066">.</font>  <font color="#006600">ReadBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br>  l1 <font color="#000066">:</font> <font color="#000066">=</font> tmp <font color="#000000">shl</font> <font color="#0000ff">6</font> <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">ReadBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br>  l2 <font color="#000066">:</font> <font color="#000066">=</font> tmp <font color="#000000">shl</font> <font color="#0000ff">6</font> <font color="#000066">;</font>  l2 <font color="#000066">:</font> <font color="#000066">=</font> l2 <font color="#000000">shr</font> <font color="#0000ff">2</font> <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">ReadBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br>  l3 <font color="#000066">:</font> <font color="#000066">=</font> tmp <font color="#000000">shl</font> <font color="#0000ff">6</font> <font color="#000066">;</font>  l3 <font color="#000066">:</font> <font color="#000066">=</font> l3 <font color="#000000">shr</font> <font color="#0000ff">4</font> <font color="#000066">;</font> <br>  f <font color="#000066">.</font>  <font color="#006600">ReadBuffer</font> <font color="#000066">(</font> tmp <font color="#000066">,</font> <font color="#0000ff">1</font> <font color="#000066">)</font> <font color="#000066">;</font> <br>  l4 <font color="#000066">:</font> <font color="#000066">=</font> tmp <font color="#000000">shl</font> <font color="#0000ff">6</font> <font color="#000066">;</font>  l4 <font color="#000066">:</font> <font color="#000066">=</font> l4 <font color="#000000">shr</font> <font color="#0000ff">6</font> <font color="#000066">;</font> <br>  <font color="#000066">str</font> <font color="#000066">:</font> <font color="#000066">=</font> <font color="#000066">str</font> <font color="#000066">+</font> <font color="#000066">char</font> <font color="#000066">(</font> l1 <font color="#000066">+</font> l2 <font color="#000066">+</font> l3 <font color="#000066">+</font> l4 <font color="#000066">)</font> <font color="#000066">;</font> <br>  <font color="#000000">end</font> <font color="#000066">;</font> </blockquote><br><br>  Well, for the very lazy - a <a href="">link to the program and its source code</a> . <br><br>  Thank. </div><p>Source: <a href="https://habr.com/ru/post/112976/">https://habr.com/ru/post/112976/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../112966/index.html">Rewrite project from Zend Framework to Rails</a></li>
<li><a href="../112968/index.html">Moving from SVN to Mercurial: personal experience</a></li>
<li><a href="../112969/index.html">So we put a factory into your algorithm or how not to consider factorials</a></li>
<li><a href="../112973/index.html">33needs allows you to become a startup investor</a></li>
<li><a href="../112974/index.html">ACM ICPC World Programming Championship Final moved</a></li>
<li><a href="../112977/index.html">Visually about the execution thread in Node.js</a></li>
<li><a href="../112978/index.html">Google accuses Bing of copying its search results</a></li>
<li><a href="../112982/index.html">Google competitors in Europe: Yandex and Seznam</a></li>
<li><a href="../112984/index.html">OpenStore - free build online store based on Drupal and Ubercart</a></li>
<li><a href="../112988/index.html">Mentioner. Partnership system</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>