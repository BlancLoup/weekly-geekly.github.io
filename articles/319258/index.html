<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Oracle APEX: Interactive Report with Checkboxes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article describes the process of creating a page in the Oracle APEX environment with an interactive report in which you can mark the entries for ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Oracle APEX: Interactive Report with Checkboxes</h1><div class="post__text post__text-html js-mediator-article">  This article describes the process of creating a page in the Oracle APEX environment with an interactive report in which you can mark the entries for further processing.  Supposed to <br>  that the reader has basic knowledge of the APEX development environment and the Oracle database. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/1fd/520/439/1fd52043905745d8822413caf38ef099.PNG" alt="image"></div><br>  A report with the ability to mark individual records for processing is a very convenient thing, but unfortunately it has not yet been implemented out of the box.  APEX API has apex_item.checkbox2 function that allows you to show checkboxes in the report, but the programmer has to process them.  The processing is greatly complicated by the fact that in a multipage report, checkboxes exist only for the current page, and when navigating between report pages, the values ‚Äã‚Äãof the checked checkboxes need to be saved somewhere.  In this case, the APEX collection is used for this. <br><a name="habracut"></a><br>  A few words about the APEX collection.  The APEX collection is a named data structure that exists within a user session, designed to manipulate data when building complex data entry forms, wizards, etc. The structure resembles a table of 50 attributes of type VARCHAR2 (4000), 5 attributes of type Number 5, 5 attributes of type Date, 1 attribute of type XML, 1 attribute of type BLOB and 1 attribute of type CLOB.  Work with the collection through the PL / SQL API APEX_COLLECTION. <br><br>  <u>So, on the page we will use such tricks and tricks:</u> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  checkboxes in the report will add using the function apex_item.checkbox2. </li><li>  We will process the checkbox state using the javascript function called from Dynamic Action. </li><li>  we will keep the state of checkboxes in the APEX collection, for this we will call the OnDemand AJAX procedure for writing to the collection. </li></ul><br>  We assume that we already have a page with an interactive report based on the request: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">descr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> geo</code> </pre> <br>  where id is the primary key field of the table.  We will pass it as an attribute of the checkbox to the collection, and we will use it when processing the marked records. <br><br>  <u><b>P.1</b> Create a process on the page:</u> <br><br>  Create ‚Üí Page Component ‚Üí Process ‚Üí <br>  Process type: <b>PL / SQL code</b> <br>  Name: <b>AJAX_UpdateChBoxCollection</b> <br>  Point: <b>Ajax Callback</b> <br>  PL / SQL Page Process is filled with the following code: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> l_value varchar2(<span class="hljs-number"><span class="hljs-number">4000</span></span>); l_seq_id number := 0; seq number := 0; l_collection_name constant varchar2(30) := 'CHBOXCOLL'; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-comment"><span class="hljs-comment">------------------------------------------------------------------ -- Get the value of the global var which was set by JavaScript ------------------------------------------------------------------ l_value := apex_application.g_x01; ------------------------------------------------------------------------ -- If our collection named doesn't exist yet, create it ------------------------------------------------------------------------ if apex_collection.collection_exists( l_collection_name ) = FALSE then apex_collection.create_collection( p_collection_name =&gt; l_collection_name ); end if; --------------------------------------------------------------------- -- See if the specified value is already present in the collection --------------------------------------------------------------------- for c1 in (select seq_id from apex_collections where collection_name = l_collection_name and c001 = l_value) loop l_seq_id := c1.seq_id; exit; end loop; ------------------------------------------------------------------- -- If the current value was not found in the colleciton, add it. -- Otherwise, delete it from the collection. ------------------------------------------------------------------- -- Htp.Prn('Seq:'||l_seq_id); if l_seq_id = 0 then begin seq := apex_collection.add_member( p_collection_name =&gt; l_collection_name, p_c001 =&gt; l_value ); -- Htp.Prn(' Set:'||l_value||' seq_id:'||seq); end; else begin apex_collection.delete_member( p_collection_name =&gt; l_collection_name, p_seq =&gt; l_seq_id ); -- Htp.Prn(' Rst:'||l_value); end; end if; commit; end;</span></span></code> </pre><br>  This procedure creates a collection named "CHBOXCOLL" if it has not yet been created, <br>  and adds / deletes an entry in the collection for the state that changed the checkbox.  The name of the collection is written everywhere caps.  It must be unique.  As a result, the collection will have attributes of the selected records. <br><br>  <u><b>A.2</b> Next, add to the page the javascript code of the function that will call this process:</u> <br><br>  Edit Page ‚Üí JavaScript ‚Üí Function and Global Variable Declaration <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ajax_call_func</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">val</span></span></span><span class="hljs-function">) </span></span>{ apex.server.process( <span class="hljs-string"><span class="hljs-string">"AJAX_UpdateChBoxCollection"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">x01</span></span>: val}, { <span class="hljs-attr"><span class="hljs-attr">dataType</span></span>: <span class="hljs-string"><span class="hljs-string">"text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">success</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> pData </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(pData); } } ); };</code> </pre><br>  This function will call the previously created function with the name ‚ÄúAJAX_UpdateChBoxCollection‚Äù and pass the value ‚Äúval‚Äù to it via the global variable apex_application.g_x01. <br>  The ‚Äútext‚Äù result can be returned from the ‚ÄúAJAX_UpdateChBoxCollection‚Äù procedure when <br>  using the function Htp.Prn ('some kind of result'). <br><br>  <u><b>P.3</b> Create checkboxes in the report, for this we edit the query as follows:</u> <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> apex_item.checkbox2(p_idx =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>, p_value =&gt; <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>, p_attributes =&gt; <span class="hljs-string"><span class="hljs-string">'class="chbox_UpdColl"'</span></span>, p_checked_values =&gt; a.c001) cbox, <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">descr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> geo,apex_collections a <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> a.c001 (+)= <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a.collection_name (+)= <span class="hljs-string"><span class="hljs-string">'CHBOXCOLL'</span></span></code> </pre><br>  In this case, the query adds a column based on the function apex_item.checkbox2, <br>  as well as our collection associated with our table by id.  We only need the collection to get the state of the checkbox when the page is initially loaded and when switching between report pages.  The type of checkbox column should be ‚ÄúStandart report column‚Äù. <br><br>  I will briefly describe the used parameters apex_item.checkbox2: <br><br>  <b>p_idx =&gt; 1</b> <br><br>  variable number APEX_APPLICATION 1 corresponds to F01;  2 - F02 and TP. <br><br>  <b>p_value =&gt; id</b> <br><br>  the value that will be passed to the collection, in this case, this is the table "id" field <br><br>  <b>p_attributes =&gt; 'class = "chbox_UpdColl"'</b> <br><br>  HTML attributes, in this case, the class = tag ‚Äúchbox_UpdColl‚Äù is used, which is then used as a jQuery selector in Dynamic Action. <br><br>  <b>p_checked_values ‚Äã‚Äã=&gt; a.c001</b> <br><br>  uses the value from the collection to indicate the state of the checkbox <br><br>  For clarity, let's add another report based on a Sql query, which we will call Collecton and which will show us the contents of the collection: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> a.seq_id,a.c001 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> apex_collections a <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> a.collection_name (+)= <span class="hljs-string"><span class="hljs-string">'CHBOXCOLL'</span></span></code> </pre> <br>  <u><b>P.4</b> We will create a Dynamic Action which will be triggered by a change in the state of the checkbox and call the JavaScript function created in <b>P.3</b> :</u> <br><br>  Event: <b>Change</b> <br>  Selection Type: <b>jQuery Selector</b> <br>  jQuery Selector: <b>.chbox_UpdColl</b> <br>  Condition: <b>none</b> <br><br>  Action: <b>Execute JavaScript Code</b> <br>  Fire When Event Result Is: <b>True</b> <br>  Fire On Page Load: <b>False</b> <br>  Code: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $checkBox = $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.triggeringElement); ajax_call_func( $checkBox.val() );</code> </pre><br>  The jQuery Selector field records the value of the 'class' attribute from the parameters of the apex_item.checkbox2 function in <b>Clause 3</b> .  Before it is necessary to put an end. <br><br>  Add one more action to the created Dynamic Action - updating the collection report after clicking on the checkbox: <br><br>  Action: <b>Refresh</b> <br>  Selection Type: <b>Region</b> <br>  Region: <b>Collecton</b> <br><br>  The checkbox functionality is already working; all that remains is to add a handler to the checkbox-marked entries.  I am going to arrange an example of such a handler with sequential extraction of data from the collection using the cursor and writing them to a file as a separate article. <br><br>  The basic idea is drawn <a href="http://www.talkapex.com/2015/09/report-with-checkboxes-update.html">here</a> .  The author saves the checked checkboxes in the Item list on the page. <br>  The disadvantage is that the maximum length of the stored list is 4000 characters.  Using the collection in our case removes this restriction. <br><br>  The use of Ajax Callback in APEX is well written <a href="http://www.stock.zp.ua/simple-example-of-ajax-in-apex/">here</a> . <br><br>  The code was tested on the site apex.oracle.com on Application Express 5.1.0.00.45 <br>  Wishes and constructive criticism is welcome. </div><p>Source: <a href="https://habr.com/ru/post/319258/">https://habr.com/ru/post/319258/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319248/index.html">Skype Out vs Out vs Tviggo vs Signal</a></li>
<li><a href="../319250/index.html">Why are VR shots so lame, and what to do about it?</a></li>
<li><a href="../319252/index.html">Puzzle on STL associative containers or How to solve one problem in eight very different ways</a></li>
<li><a href="../319254/index.html">"How do games": a two-hour talk about the monetization of online games</a></li>
<li><a href="../319256/index.html">First steps with STM32 and mikroC compiler for ARM architecture - Part 2, continued</a></li>
<li><a href="../319260/index.html">Develop and publish a game for Android in a week</a></li>
<li><a href="../319262/index.html">Comparative analysis of traffic balancing methods</a></li>
<li><a href="../319264/index.html">What should be hosting?</a></li>
<li><a href="../319266/index.html">"Breaking Bad 2", Dark Forester - a game at a distance of a small plus</a></li>
<li><a href="../319268/index.html">Experience creating a mutation testing tool for Erlang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>