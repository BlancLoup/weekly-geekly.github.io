<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Neural networks on JS. Creating a network from scratch</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neural networks are now in trend. Every day we read about how they learn to write comments on the Internet, bargain in the markets, handle photos. The...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Neural networks on JS. Creating a network from scratch</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/92f/934/b9e/92f934b9eeb54118add65b70e59101fc.jpg" alt="KDPV about neural networks"></p><br><p>  Neural networks are now in trend.  Every day we read about how they learn to write comments on the Internet, bargain in the markets, handle photos.  The list is endless.  When I first looked at the scale of the code that sets it in motion, I was scared and wanted not to see these sources anymore. </p><br><p>  But the innate curiosity and enthusiasm brought me to the point that I became one of the developers of Synaptic - a framework project for building neural networks on JS with 3k + stars on GitHub.  Now we are working with the author of the framework to create Synaptic 2.0 with GPU and WebWorker acceleration and with the support of almost all the main features of any decent NN framework. </p><br><p>  As a result, it turned out that neural networks are easy, they work on fairly simple principles that are easy to understand and reproduce.  The most difficult task is learning, but almost always use ready-made algorithms for this, and copying them is not very difficult. <br>  Proving is easy.  Below in the article the implementation of a neural network from scratch without any libraries. </p><a name="habracut"></a><br><p>  For a start - a little background. </p><br><p>  At the end of October, I gave a report at the #ITsubbotnik event in St. Petersburg and began a topic that I decided to continue here.  Let's talk about how to write from scratch neural network in JavaScript. </p><br><p>  If you were on the first part of my speech or watched it on <a href="https://www.youtube.com/watch%3Fv%3DPusDheGpO5M">youtube</a> , you can skip the next few paragraphs - this is a brief retelling of it. </p><br><h2 id="chto-takoe-neyronnaya-set">  What is a neural network? </h2><br><p>  The best of the definitions I heard from one sophisticated person at the conference.  He said that neural networks are just a beautiful name that was invented, because it is more difficult to get a grant for the definition of the ‚Äúchain of matrix operations‚Äù. </p><br><p>  In general, this very accurately describes the real situation with neural networks.  This is a cool and powerful technology, but the HYIP around it is more than real information.  The same Google Brain that does things like <a href="https://geektimes.ru/post/281998/">‚Äúthe neural network invented the encryption algorithm‚Äù</a> is consistently ridiculed for them in the thematic communities, since there are no radically new ideas in such things, and they are made, first of all, to attract attention and public relations. the company. </p><br><p>  To explain what a network is, you need to go a little distance. </p><br><p>  From the point of view of Data Scientists (still there is the point of view of neuroscientists, for example) the neural network is one of the tools for modeling a physical process.  And any of the modeling tools works as follows: </p><br><ul><li>  we make a significant number of observations </li><li>  we collect key information for each of these observations </li><li>  from this information we get knowledge </li><li>  through this knowledge we find a solution </li></ul><br><h2 id="lineynaya-zavisimost">  Linear dependence </h2><br><p>  As an example, you can take the metallurgy.  Imagine that we have an alloy of 2 metals.  If we take 80% of cast iron and 20% of aluminum (for example), a beam of such an alloy will break if one ton is pressed against it.  If we take 70% + 30% - it will break if it presses 2 tons.  60% + 40% - 3 tons. </p><br><p>  It can be assumed that the option 50% + 50% should withstand 4 tons.  In life, everything works a little differently, but simplifying - you can imagine that it works that way. </p><br><p>  In real life, this usually leads to the fact that a huge number of observations already exist, and on the basis of them you can build some kind of mathematical model that would give, for example, such an answer - what characteristics would a metal have from such and such components, for example. </p><br><p>  One of the easiest and most effective tools is linear regression.  The example above ‚Äî where% in the alloy is directly proportional to the maximum load ‚Äî is a linear regression. </p><br><p>  In general, linear regression is as follows: </p><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">predict</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x1, x2, x3..., xN</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> weights.x1 * x1 + weights.x2 * x2 + ... + weights.xN * xN + weights.bias; }</code> </pre> <br><p>  It is worth remembering the term "weight", weight.  In further examples, it will also be used.  The weight (or significance) of each parameter is called its significance in our predictive model ‚Äî and both the neural network and linear regression are all models for prediction. </p><br><p>  The weight of ‚Äúbias‚Äù, or translated into Russian, ‚Äúshift‚Äù is an additional parameter that characterizes the value at zero. </p><br><p>  For example, in the well-known (albeit not very correct) formula "the correct weight should be equal to height - 100" - <code>weight = height - 100</code> - bias is equal to -100, and the weight of growth - to one. </p><br><h2 id="nelineynaya-zavisimost">  Nonlinear dependence </h2><br><p>  Sometimes there are situations when we need to find dependencies of higher orders. </p><br><p>  One of the good examples to study is the dataset (dataset) of the Titanic with statistics on surviving people. </p><br><p>  If you play with <a href="https://www.jasondavies.com/parallel-sets/">interactive visualization</a> , you can see that on average women survived more.  However, if you delve into the details, we note that among the crew and the third class - the survival rate was much less.  To build a more accurate predictive model, we need to somehow write down in it - "if it is a woman and she is from class 1, then she had a + 10% chance of surviving." </p><br><p>  The guys from science have proposed a simple scheme - to call such parameters additional features and use them in the original function.  That is, to our x1, x2, x3, and so on, one more xN + 1 is added, which is 1 if it is a woman from the first class, and 0 if not.  Then more and more parameters appear, and we begin to take all this into account in our calculations. </p><br><p>  How can the function "if a <em>condition</em> , then 1, otherwise 0" be described in the language of mathematics? </p><br><p>  If we solve the problem in the forehead, making an analogue of the ternary operator, then we will have a function, the schedule for which looks like this: </p><br><p><img src="https://habrastorage.org/files/d66/4ff/ee8/d664ffee8f3a46e7bfb7e39f7039b864.png" alt="hlim chart"></p><br><p>  But you can get smarter, leaving a bunch of loopholes.  The fact is that it is difficult to work with such a schedule.  Because of the gap from it, it is impossible, for example, to take a derivative, or to perform a dozen more interesting tricks.  Therefore, instead of such a "broken" function, continuous and continuously increasing functions are usually used, for example, sigmoid - <code>1 / (1 + Math.E ** -x)</code> .  It looks like this: </p><br><p><img src="https://habrastorage.org/files/2a4/56f/23e/2a456f23efe54f508677cdcbc5274c7f.png" alt="sigmoid plot"></p><br><p>  It works very similar - in -1 the value is close to 0, and in 1 it is close to 1, but we get more effective feedback: by the obtained value we can understand how close or far we are from the correct answer - unlike the original broken line a function by which we can only understand whether we answered correctly or were wrong: if we received 1 and expected 0, then we did not know how much we should move to the left on the schedule in order to get all the same 0. </p><br><p>  This function is called the activation function. </p><br><p>  As a result, we get a new parameter through the function of the form </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> activation_sigmoid = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.exp(-x)); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">predict</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x1, x2, x3..., xN</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> activation_sigmoid( weights.x1 * x1 + weights.x2 * x2 + ... + weights.xN * xN + weights.bias); }</code> </pre> <br><p>  This function is called the perceptron. </p><br><p>  A perceptron is the simplest type of neural network, having no hidden layers.  In a visual presentation, it looks something like this: </p><br><p><img src="https://upload.wikimedia.org/wikipedia/ru/b/ba/Single_layer_perceptron.png" alt="graphical representation of the perceptron"></p><br><p>  If you look at the picture from the article "neural network" on Wikipedia, then you can see a very large similarity: </p><br><p><img src="https://upload.wikimedia.org/wikipedia/commons/3/3d/Neural_network.svg" alt="neural network graph"></p><br><p>  And we come to the definition of a neural network in terms of implementation. </p><br><p>  The classical neural network is just a chain of alternately linear and nonlinear transformations of input data.  There are exceptions, but usually they just have a more cunning (read, non-linear) network structure. </p><br><p>  In the simplest and most ‚Äúcanonical‚Äù case - not to mention image recognition or word processing - the neural network is a set of layers, each of which consists of neurons.  Each of the neurons summarizes all the parameters from the previous layer with some weights specific to this neuron, and then passes the sum through the activation function. </p><br><p>  If it seemed too complicated, just read further: in the code it looks much simpler. </p><br><h2 id="neyronnaya-set-v-kode">  Neural network in the code </h2><br><p>  With neural networks, the most popular example is the implementation of <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BB%25D0%25BE%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25BF%25D0%25BE_%25D0%25BC%25D0%25BE%25D0%25B4%25D1%2583%25D0%25BB%25D1%258E_2">XOR</a> , this is a kind of Hello World for data science learners. </p><br><p>  The feature of XOR is that it is the simplest non-linear function ‚Äî it cannot be implemented as a linear regression (read, you cannot draw a line through all the values). </p><br><p>  Dataset for her looks like this: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = [ {<span class="hljs-attr"><span class="hljs-attr">input</span></span>: [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-attr"><span class="hljs-attr">output</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">input</span></span>: [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-attr"><span class="hljs-attr">output</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">input</span></span>: [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-attr"><span class="hljs-attr">output</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">input</span></span>: [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-attr"><span class="hljs-attr">output</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>}, ];</code> </pre> <br><p>  So, we need to somehow implement XOR exclusively using additions and a nonlinear function, which takes one number as input. </p><br><p>  This is how the implementation looks like (so far without a neural network): </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> activation = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x &gt;= <span class="hljs-number"><span class="hljs-number">.5</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x1, x2</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> h1 = activation(-x1 + x2); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> h2 = activation(+x1 - x2); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> activation(h1 + h2); }</code> </pre> <br><p>  Where h1 and h2 are hidden parameters. </p><br><p>  Or, if you try to add weight, it turns out: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> activation = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x &gt;= <span class="hljs-number"><span class="hljs-number">.5</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> weights = { <span class="hljs-attr"><span class="hljs-attr">x1_h1</span></span>: <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-attr"><span class="hljs-attr">x1_h2</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">x2_h1</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">x2_h2</span></span>: <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-attr"><span class="hljs-attr">bias_h1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">bias_h2</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x1, x2</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> h1 = activation( weights.x1_h1 * x1 + weights.x2_h1 * x2 + weights.bias_h1); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> h2 = activation( weights.x1_h2 * x1 + weights.x2_h2 * x2 + weights.bias_h2); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> activation(h1 + h2); }</code> </pre> <br><p>  What does our neural network function look like?  Well, we replace weights with random values. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rand = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> weights = { <span class="hljs-attr"><span class="hljs-attr">i1_h1</span></span>: rand(), <span class="hljs-attr"><span class="hljs-attr">i2_h1</span></span>: rand(), <span class="hljs-attr"><span class="hljs-attr">bias_h1</span></span>: rand(), <span class="hljs-attr"><span class="hljs-attr">i1_h2</span></span>: rand(), <span class="hljs-attr"><span class="hljs-attr">i2_h2</span></span>: rand(), <span class="hljs-attr"><span class="hljs-attr">bias_h2</span></span>: rand(), <span class="hljs-attr"><span class="hljs-attr">h1_o1</span></span>: rand(), <span class="hljs-attr"><span class="hljs-attr">h2_o1</span></span>: rand(), <span class="hljs-attr"><span class="hljs-attr">bias_o1</span></span>: rand(), };</code> </pre> <br><p>  When we try to start a network, we get porridge. </p><br><p>  Now we are faced with the task of ‚Äúfinding the most correct weights‚Äù.  Why did we do this? </p><br><p>  In the case of XOR, we know the exact logic by which this function should work, but in the case of real conditions, we almost never understand how the process that we are trying to describe works, and we only have a set of observations, our data.  We teach the neural network to reproduce this ‚Äúblack box‚Äù that we contacted, and it usually does quite well with a sufficient number of nodes in hidden layers.  Moreover, it has been mathematically proven that a single-layer network with an infinite number of neurons can "emulate" absolutely any function with infinitely large accuracy (the universal approximator theorem). </p><br><p>  Let's go back to finding the right weights.  To accomplish it, we first need to understand what we want to reduce.  We need some kind of function that allows us to determine how badly we made a mistake.  And when trying to change our weights - to understand whether we are moving in the right direction or not. </p><br><p>  Two functions are most popular for these tasks: <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25BD%25D0%25B0%25D0%25B8%25D0%25BC%25D0%25B5%25D0%25BD%25D1%258C%25D1%2588%25D0%25B8%25D1%2585_%25D0%25BA%25D0%25B2%25D0%25B0%25D0%25B4%25D1%2580%25D0%25B0%25D1%2582%25D0%25BE%25D0%25B2">the least squares method</a> , when the average of error squares is taken (it is convenient for regression problems, when the output is a value, for example, between 0 and 1, or 10 values ‚Äã‚Äãfrom -100 to 1250 - the main thing they may be in this range) and so on.  <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B5%25D1%2580%25D0%25B5%25D0%25BA%25D1%2580%25D1%2591%25D1%2581%25D1%2582%25D0%25BD%25D0%25B0%25D1%258F_%25D1%258D%25D0%25BD%25D1%2582%25D1%2580%25D0%25BE%25D0%25BF%25D0%25B8%25D1%258F">LogLoss or cross-entropy</a> , a logarithmic loss estimate that is effective for classification tasks when we try, for example, to determine which of the numbers or letters our neural network sees. </p><br><p>  For XOR, we will use the mean of squares of errors. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> _ = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'lodash'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> calculateError = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> _.mean(data.map(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{input: [i1, i2], output: y}</span></span></span><span class="hljs-function">) =&gt;</span></span> (nn(i1, i2) - y) ** <span class="hljs-number"><span class="hljs-number">2</span></span>));</code> </pre> <br><h2 id="uchene---svet">  Learning is light </h2><br><p>  It's time to learn our network. </p><br><p>  Stepping back a bit, we should figure out how linear regression ‚Äúlearns‚Äù.  It works as follows - we have the same MSE (mean squared error), and we are trying to reduce it.  If we recall the course of mathematics, the graph of the square from X looks like this: </p><br><p><img src="https://habrastorage.org/files/a8d/7a1/4b5/a8d7a14b5ae24d9785e91562cbc721c7.png" alt="just a parabola"></p><br><p>  And our task is to slide to the very minimum of this parabola. </p><br><p>  To slide to this minimum - we need to look around and understand where we have a mistake more, and where less.  And then move downward.  This can be done numerically (see the value for +1 and for -1 and calculate where to go), or you can mathematically by taking a derivative that characterizes the rate of change of the function.  In other words, if an error increases with an increase in any parameter, the error derivative will be positive (we are on the right side of the parabola), and vice versa.  We add the derivative multiplied by our weights to our own weights, and step by step we approach the answer with the smallest error until we get bored or reach a local minimum.  Speaking even simpler - if we take a derivative and it is positive, then for this particular value, with an increase in the value at the input, the error will increase, and with decreasing it will decrease. </p><br><p>  If you imagine it visually, it will look something like this: </p><br><p><img src="https://camo.githubusercontent.com/678d5e1c27d759385223d5a5e28c5dd6edfa9294/68747470733a2f2f686162726173746f726167652e6f72672f66696c65732f3963652f3539332f3464392f39636535393334643936336434663431623839336433323932356237393166612e676966"><br>  <em>In the comments write that initially this picture from the <a href="https://ru.coursera.org/learn/machine-learning">course Andrew Ng</a></em> </p><br><p>  If we represent our error function as (f (x) - y) * <em>2, then its derivative will be equal to 2</em> (f (x) - y) f '(x).  <a href="https://www.wolframalpha.com/input/%3Fi%3Ddx(f(x)-y">Proof</a> ) </p><br><p>  Since the neural network of fully connected layers (that is, the one we are talking about now) is just a chain of such linear regressions, we only need to calculate this derivative for each layer and multiply our weight coefficients on it. </p><br><h2 id="vzhivuyu">  Live </h2><br><p>  Probably, it's time to just show the code with an explanation of what is happening. </p><br><p>  Embedding this amount of code in Habr is a rather cruel task, so I put the code with a large number of comments on RunKit: </p><br><p>  <a href="https://runkit.com/jabher/neural-network-from-scratch-in-js">https://runkit.com/jabher/neural-network-from-scratch-in-js</a> </p><br><p>  and in Russian: </p><br><p>  <a href="https://runkit.com/jabher/neural-network-from-scratch-in-js---ru">https://runkit.com/jabher/neural-network-from-scratch-in-js---ru</a> </p><br><p>  and just in case - duplicate code in <a href="https://gist.github.com/Jabher/8ad6e4289ad64cac9577d7a26e588c59">gist.github.com</a> </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Of course, neural networks are much more complex.  You can, for example, see the <a href="https://transcranial.github.io/keras-js/">Inception 3</a> scheme, which recognizes the images in the picture.  In such networks, there are many tricky layers that both work and train harder than what we saw now, but the essence remains the same - multiply the matrices, calculate the error, unscrew the error in the opposite direction. </p><br><p>  And if you want to participate in the development of a framework for neural networks, <a href="https://github.com/cazala/synaptic/issues/140">connect to us with Cazala</a> . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/317050/">https://habr.com/ru/post/317050/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317034/index.html">How to patch a kernel without rebooting: livepatch, kpatch and Canonical Livepatch Service</a></li>
<li><a href="../317036/index.html">How blockchain transforms digital marketing</a></li>
<li><a href="../317038/index.html">Dynamic email</a></li>
<li><a href="../317044/index.html">Why corporate funds can earn more on investment than consumer?</a></li>
<li><a href="../317048/index.html">Limit the speed of traffic. Policer or shaper, what to use on the net?</a></li>
<li><a href="../317052/index.html">Android developers have reduced the size of updates by an average of 65%</a></li>
<li><a href="../317054/index.html">6 free CDNs to speed up and improve the security of your site</a></li>
<li><a href="../317056/index.html">Internet of Things protocol stack</a></li>
<li><a href="../317058/index.html">Colocation as an option to save on the deployment of its own infrastructure and solving technical problems</a></li>
<li><a href="../317060/index.html">Remote (dev) tools do it yourself - interview with Roman Dvornov (Avito)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>