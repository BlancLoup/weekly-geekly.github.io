<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>National characters in the addresses - a paradise for phishing?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 On the material of this small little article I made another, similar subject, which I read for a long time. And I decided to play around a b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>National characters in the addresses - a paradise for phishing?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/bv/r4/fd/bvr4fdkv12ltqazlx2jm9qbmj3y.jpeg"><br><br>  Hello! <br><br>  On the material of this small little article I made another, similar subject, which I read for a long time.  And I decided to play around a bit with a randomly caught topic and dedicate the habronarod to my games. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It will be today mainly about the zone.  And we will play with the site of the distinguished President of the Russian Federation, for which he thanks a lot! <br><br>  Of course, these "games" can be scaled for any other site with national characters in domain names.  And in general, this article is not a way to hack into the President‚Äôs website, but simply to prove and discuss some point, which is quite possible that can be effectively used by intruders. <br><a name="habracut"></a><br><br>  <strong><i>INTRODUCTION</i></strong> <br>  So it is <a href="http://ru.wikipedia.org/wiki/.%25D1%2580%25D1%2584">done</a> !  On May 12, 2010, the glorious existence of the zone began. The first pioneers of which were the sites <a href="http://xn--d1abbgf6aiiy.xn--p1ai/">http: //president.rf</a> and <a href="http://xn--80aealotwbjpid2k.xn--p1ai/">http: //regovitelstvo.rf. A</a> PR company was active in purchasing domain names, many became their happy owners, with sweet Cyrillic alphabet in the address.  In principle, we already have <a href="http://xn--i1aeb2e.xn--p1ai/">http: //mail.rf</a> , <a href="http://xn--d1acpjx3f.xn--p1ai/">http: //yandeks.rf</a> ... Nice.  But there are other thoughts ... <br><br>  <strong><i>THEORY</i></strong> <br>  As you know, in the zone. RF there is a possibility of introducing the name Cyrillic.  This is a prime example of our research today - <a href="http://xn--d1abbgf6aiiy.xn--p1ai/">President.RF</a> <br>  When entering a name in the address bar of the Firefox browser and launching, the user has the opportunity to notice the rapid appearance of a strange combination: <a href="http://xn--d1abbgf6aiiy.xn--p1ai/">xn - d1abbgf6aiiy.xn - p1ai</a> - what you see is the conversion of a Cyrillic alphabet that is not understandable for DNS systems into a clear Latin script <a href="http://ru.wikipedia.org/wiki/IDN">in the IDN representation</a> .  In fact, for the DNS as it was not, there is no <strong>president</strong> . <strong>RF</strong> , there is only a strange, but understandable to the system name <strong>xn - d1abbf6aiiy.xn - p1ai</strong> .  At the same time, the prefix <strong>xn--</strong> unequivocally indicates that the name is represented in a peculiar encoding called <a href="http://ru.wikipedia.org/wiki/Punycode">Punnycode</a> . <br><br>  <strong><i>Proof of concept</i></strong> <br>  I looked at all this for a long time and suddenly remembered - and yet the multitude of Latin letters is the same as in writing with the Cyrillic alphabet!  In total, ‚ÄúPresident. RF‚Äù can appear in several variants, since the letters ‚Äúe‚Äù and ‚Äúp‚Äù are absolutely identical in shape, but different for the system.  These letters in the name four, respectively, we have 2 ^ 4 = 16 variants of ‚ÄúPresident. RF‚Äù, indistinguishable to the eye!  The only difference between them is punnycode. <br><br>  We will use a convenient <a href="http://idnaconv.phlymail.de/%3Flang%3Den">online converter</a> to illustrate our idea (I will not give all 16 options, but I will do four illustrative ones): <br><br>  <a href="http://xn--d1abbgf6aiiy.xn--p1ai/">http: //president.rf</a> = <a href="http://xn--d1abbgf6aiiy.xn--p1ai/">http: //xn-- d1abbgf6aiiy.xn--p1ai</a> (this is the real site of the President) <br>  <a href="http://xn--p-htbcbig1bj8a.xn--p1ai/">http: //president.rf</a> = <a href="http://xn--p-htbcbig1bj8a.xn--p1ai/">http: //xn--p-htbcbig1bj8a.xn--p1ai</a> (fake number 1) <br>  <a href="http://xn--e-htbdgf6aiiy.xn--p1ai/">http: //prezident.rf</a> = <a href="http://xn--e-htbdgf6aiiy.xn--p1ai/">http: //xn--e-htbdgf6aiiy.xn--p1ai</a> (fake ‚Ññ2) <br>  <a href="http://xn--pee-oddog1bj8a.xn--p1ai/">http: //prezident.rf</a> = <a href="http://xn--pee-oddog1bj8a.xn--p1ai/">http: //xn--pee-oddog1bj8a.xn--p1ai</a> (fake ‚Ññ3) <br><br>  As you can see, there is no difference in the ‚ÄúRussian‚Äù name.  But these are different hosts, both in punnycode and in nature.  You can see that something is wrong, you can use Latin letters between hyphens, for example, "xn-- <strong>pee</strong> -oddog1bj8a.xn", but who will notice them? <br><br>  <strong><i>FINDINGS</i></strong> <br>  As a result, we have just the perfect phishing trap: when a website is compromised, the attacker very quickly gets all the information that the user usually enters on his original website. <br><br>  At the time of writing the post, I did not find any restrictions, that in such IDN domains it is impossible in principle to use Latin letters.  The examples at the top lead to a page stating that at the moment there are no corresponding host IP addresses with the specified domain names.  That is, they have not bought them yet.  How long?  ;) <br><br>  <i><b>Morality:</b></i> <i><br></i>  <i>‚ÄúHow many languages ‚Äã‚Äãdo you know - so many times you are a man‚Äù by Anton Chekhov</i> <br><br>  PS At the moment from the site President.RF an automatic redirection to the kremlin.ru is being carried out.  So this article should be considered a Proof of concept - but with a possible development;) </div><p>Source: <a href="https://habr.com/ru/post/107034/">https://habr.com/ru/post/107034/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../107026/index.html">Preparing screenshots for documentation in GIMP (part 2)</a></li>
<li><a href="../107027/index.html">3D tag cloud on html 5</a></li>
<li><a href="../107029/index.html">Award to outstanding IT journalists!</a></li>
<li><a href="../107030/index.html">Slightly more about loading self-made OS - write a bootloader</a></li>
<li><a href="../107033/index.html">Unobvious in Intel business</a></li>
<li><a href="../107037/index.html">Bredolab at gunpoint</a></li>
<li><a href="../107038/index.html">Color coding servers</a></li>
<li><a href="../107039/index.html">Re: The story of one copyist. Russia is important every</a></li>
<li><a href="../107042/index.html">FVD Suite 2.5.1 - If not download, then write it down!</a></li>
<li><a href="../107043/index.html">Register on icq.com or how to find out your UIN?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>