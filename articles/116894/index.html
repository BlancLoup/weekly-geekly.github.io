<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Nginx + uWSGI + Django, one of the launch options</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article describes one of the ways to deploy Django-projects, in conjunction Nginx + uWSGI on Unix-like operating systems. Testing, as well as fur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Nginx + uWSGI + Django, one of the launch options</h1><div class="post__text post__text-html js-mediator-article">  This article describes one of the ways to deploy Django-projects, in conjunction Nginx + uWSGI on Unix-like operating systems.  Testing, as well as further operational maintenance was performed on FreeBSD, but on Linux the process will be similar, except for a few minor points. <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  One day, on the job site, it became necessary to launch Web applications written in Django (Python).  During the search, a large number of similar articles were found describing the launch of Django projects using Nginx + uWSGI.  The authors considered the launch of one particular Django project, which had its own xml configuration file for uWSGI worker (s), as well as a separate socket / port for interacting with Nginx.  As a result, when adding a new Django project, it will be necessary to reconfigure the uWSGI worker (s) already for this application (even if using copy-paste, but still).  Unfortunately, this method is not universal, and with this configuration, there is no single, familiar <s>FreeBSD to</s> me, means of controlling a running daemon, a single management point.  As a result, after searching in the Internet and studying the official wiki of the uWSGI project, the following launch method was developed (fundamental differences): <ul><li>  Uniform, generalized configuration xml-file for uWSGI-worker (s); </li><li>  The specific parameters described for each Django project in the xml configuration file for the uWSGI worker (s) are transferred to the Nginx locations and are transferred to the NWex UWSGI workers. </li></ul><h5>  Application Directory </h5><br>  It is assumed to use a single directory in which a conglomerate of Django projects will be deployed, in my case this is / usr / local / www.  For example, the contents of the directory will be something like: <br> <code># ls -la /usr/local/www/ <br> ... <br> drwxr-xr-x ... app1 <br> drwxr-xr-x ... app2 <br> drwxr-xr-x ... appN <br> -rw-r--r-- ... webapp.xml</code> <br> <br><h5>  Nginx setup </h5><br>  Setting up locations is done on the basis of the principle that one Django project is one location. <br><br>  nginx.conf: <pre>         location / {
                 uwsgi_pass unix: ///tmp/uwsgi.sock;
                 include uwsgi_params;<font></font>
<font></font>
                 uwsgi_param UWSGI_SCRIPT webapp;
                 uwsgi_param UWSGI_CHDIR / usr / local / www / app1;
         }<font></font>
<font></font>
         location / app2 {
                 uwsgi_pass unix: ///tmp/uwsgi.sock;
                 include uwsgi_params;<font></font>
<font></font>
                 uwsgi_param SCRIPT_NAME / app2;
                 uwsgi_param UWSGI_SCRIPT webapp;
                 uwsgi_param UWSGI_CHDIR / usr / local / www / app2;<font></font>
<font></font>
         }<font></font>
<font></font>
         location / appN {
                 uwsgi_pass unix: ///tmp/uwsgi.sock;
                 include uwsgi_params;<font></font>
<font></font>
                 uwsgi_param SCRIPT_NAME / appN;
                 uwsgi_param UWSGI_SCRIPT webapp;
                 uwsgi_param UWSGI_CHDIR / usr / local / www / appN;<font></font>
<font></font>
         }
</pre><br>  In this configuration location: <br><ul><li>  The parameter ‚ÄúSCRIPT_NAME / appN‚Äù corresponds to the parameter of the xml configuration file of the uWSGI-worker (s) ‚Äú <pre>  &lt;app mountpoint = "/ appN"&gt; ... &lt;/ app&gt; </pre>  "And denotes the context of a Django project; </li><li>  The ‚ÄúUWSGI_SCRIPT webapp‚Äù parameter corresponds to the webapp parameter and indicates the entry point to the Django project (about the entry point into the application just below); </li><li>  The ‚ÄúUWSGI_CHDIR / usr / local / www / appN‚Äù parameter corresponds to the / usr / local / www / appN parameter and designates the directory with the Django project. </li></ul><h5>  Webapp.xml configuration file </h5><br>  The configuration xml file for uWSGI worker (s) webapp.xml is located in the / usr / local / www directory. <br><br>  webapp.xml: <pre>  &lt;uwsgi&gt;
         &lt;socket&gt; /tmp/uwsgi.sock &lt;/ socket&gt;
         &lt;process&gt; 1 &lt;/ process&gt;<font></font>
<font></font>
         &lt;master /&gt;
         &lt;enable-threads /&gt;<font></font>
<font></font>
         &lt;uid&gt; 80 &lt;/ uid&gt;
         &lt;gid&gt; 80 &lt;/ gid&gt;<font></font>
<font></font>
         &lt;pidfile&gt; /var/run/uwsgi.pid &lt;/ pidfile&gt;
 &lt;/ uwsgi&gt; </pre><br><h5>  Django Project Entry Point </h5><br>  It is important that in each app1, app2, appN directory there is a webapp file, which is the entry point to the Django project.  The uWSGI-worker runs the webapp, and the webapp in turn starts the WSGI handler in the Django project. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is what the webapp for app1 looks like: <pre> # - * - coding: iso-8859-1 - * -<font></font>
<font></font>
 import sys, os
 import django.core.handlers.wsgi<font></font>
<font></font>
 sys.path.insert (0, '/ usr / local / www / app1')
 os.environ ['DJANGO_SETTINGS_MODULE'] = 'settings'<font></font>
<font></font>
 application = django.core.handlers.wsgi.WSGIHandler ()
</pre><br><h4>  Instead of conclusion </h4><br>  At this setting ends.  Now, to run uWSGI-worker (s) serving all Django-projects, just run the following command: <br>  # uwsgi -s /tmp/uwsgi.sock -x /usr/local/www/webapp.xml <br><br>  On FreeBSD, the launch can be organized more beautifully than on Linux: <br>  /etc/rc.conf: <br>  uwsgi_enable = "YES" <br>  uwsgi_flags = "- x /usr/local/www/webapp.xml" <br><br>  # / usr / local / etc / uwsgi start <br><br>  With this configuration, just unpack the Django project into the working directory, add the template location to Nginx and restart the Nginx and uWSGI daemons. <br><br><h5>  Used <s>literature</s> blogs </h5><br>  <a href="http://projects.unbit.it/uwsgi/wiki/RunOnNginx">projects.unbit.it/uwsgi/wiki/RunOnNginx</a> <br>  <a href="http://projects.unbit.it/uwsgi/wiki/Example">projects.unbit.it/uwsgi/wiki/Example</a> <br>  <a href="http://projects.unbit.it/uwsgi/wiki/Emperor">projects.unbit.it/uwsgi/wiki/Emperor</a> <br><br>  <a href="http://wiki.diphost.ru/Category:WSGI">http://wiki.diphost.ru/Category:WSGI</a> <br>  <a href="http://blog.zacharyvoase.com/2010/03/05/django-uwsgi-nginx/">blog.zacharyvoase.com/2010/03/05/django-uwsgi-nginx</a> <br>  <a href="http://www.westphahl.net/blog/2010/4/8/running-django-nginx-and-uwsgi/">www.westphahl.net/blog/2010/4/8/running-django-nginx-and-uwsgi</a> <br>  <a href="http://posterous.adambard.com/start-to-finish-serving-mysql-backed-django-w">posterous.adambard.com/start-to-finish-serving-mysql-backed-django-w</a> <br>  <a href="http://brandonkonkle.com/blog/2010/sep/14/django-uwsgi-and-nginx/">brandonkonkle.com/blog/2010/sep/14/django-uwsgi-and-nginx</a> <br>  <a href="http://www.jeremybowers.com/blog/post/5/django-nginx-and-uwsgi-production-serving-millions-page-views/">www.jeremybowers.com/blog/post/5/django-nginx-and-uwsgi-production-serving-millions-page-views</a> <br>  <a href="http://www.cherokee-project.com/doc/cookbook_uwsgi.html">www.cherokee-project.com/doc/cookbook_uwsgi.html</a> </div><p>Source: <a href="https://habr.com/ru/post/116894/">https://habr.com/ru/post/116894/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116889/index.html">[Translation] Theft of data due to the latest features of Windows and Mac OS X</a></li>
<li><a href="../116890/index.html">Acoustics. Orthodynamic Emitters</a></li>
<li><a href="../116891/index.html">Boodler Sound Landscape Generator</a></li>
<li><a href="../116892/index.html">Multi-threaded application under Tornado</a></li>
<li><a href="../116893/index.html">Mangrove, Ventech Capital and ABRT have invested in oktogo.ru</a></li>
<li><a href="../116895/index.html">Service development: Classmates, VKontakte, ethics vs. aesthetics</a></li>
<li><a href="../116896/index.html">PHPUnit && ordered tests</a></li>
<li><a href="../116898/index.html">Run third-party code in the sandbox</a></li>
<li><a href="../116899/index.html">The first public version of Appcelerator Titanium Studio has been released.</a></li>
<li><a href="../116902/index.html">Skype phone booth at Tallinn Airport</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>