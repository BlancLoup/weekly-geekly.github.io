<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Easy integration of MS Project and Redmine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Epigraph 


 ‚ÄúIf I‚Äôd put Nikanor Ivanovich‚Äôs lips on Ivan Kuzmich‚Äôs nose, take some kind of swagger, like Balthazar‚Äôs Balthazarych, and, perhaps, add ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Easy integration of MS Project and Redmine</h1><div class="post__text post__text-html js-mediator-article"><h4 id="epigraf">  Epigraph </h4><br><p>  <em>‚ÄúIf I‚Äôd put Nikanor Ivanovich‚Äôs lips on Ivan Kuzmich‚Äôs nose, take some kind of swagger, like Balthazar‚Äôs Balthazarych, and, perhaps, add Ivan Pavlovich‚Äôs prettiness to it, I‚Äôd have to immediately decide.‚Äù</em> N.V.  Gogol.  Marriage. </p><br><p><img src="https://habrastorage.org/webt/nx/cv/ga/nxcvgacl4ywzb0ypkmtx5y1wtj0.png"></p><br><p>  There are two well-known and very different project management tools: MS Project and Redmine.  Each of them has its advantages, and these advantages could perfectly complement each other. </p><br><p>  I want to offer to your attention a small utility called P2R, which allows, without any installation and with a minimum of settings, to provide online synchronization of projects in MS Project and Redmine.  It is available <a href="https://github.com/asiventsev/project2redmine">at</a> . </p><a name="habracut"></a><br><p>  What is good Project: </p><br><ul><li>  It is convenient to edit the project as a whole in document mode - a spreadsheet.  Plus, several projects can be quickly merged into a consolidated one and see as a whole.  (In Redmine, project tasks are edited one at a time through the task form). </li><li>  All sorts of diversity and flexibility of connections between tasks (in Redmine communications are implemented minimalist). </li><li>  Control of resource loading and the ability to automatically distribute tasks on the calendar, taking into account connections and resource loading.  Including "non-human" resources such as equipment, premises, etc.  (In Redmine, this is nothing, the tool was created for another.) </li></ul><br><p>  What is good for Redmine: </p><br><ul><li>  A free product on Ruby on Rails, fairly simple, well customizable and extensible, with an active community, a large selection of plug-ins, actively developed. </li><li>  Web and teamwork.  As a result, it is very convenient to record the progress of work on each task, including the change log, correspondence and discussions on the task, files, individual reports on hours spent, etc. (Project has nothing to do with this.) </li></ul><br><p>  It would be convenient to prepare projects in MS Project, send them for execution to Redmine, receive actual deadlines of tasks and estimated / spent hours from there, compare them with previously saved baseline, make adjustments if necessary.  (Especially convenient, for example, in a situation like at work: there is a flow of projects with a regular structure, which need to be formed according to templates, slightly specified and given to work.) </p><br><p>  There are Rredmine plugins for this integration.  But they do the integration through uploading-loading xml-files, but I want it without files and simpler. </p><br><p>  The proposed P2R script is written in ruby ‚Äã‚Äãand works with MS Project via OLE, and with Redfmine via API.  If ruby ‚Äã‚Äãis not installed, you can take the same script compiled in .exe (it lies in the downloads folder, formed by the ocra utility). </p><br><p>  Preparing an MSP project for publishing and synchronization requires a minimum of actions. </p><br><ol><li>  P2R stores Redmine task IDs in the Hyperlink attribute of MSP tasks.  To mark a task for publishing, you need to put 0 in this attribute.  After publishing, P2R will automatically change this field to the real task ID and at the same time form the correct URL in the HyperlinkAddress attribute, so the link will be clickable.  (Understandably, the MSP project must then be saved, it is not automatically saved.) </li><li>  P2R stores Redmine user IDs also in the Hyperlink attribute of MSP resources.  To associate this resource with the Redmine user, you need to get the user ID from the Redmine admin.  (The admin has access to the list of users and can see their IDs, for example, in the links in the list). </li><li>  P2R takes access parameters to Redmine from a special task called ‚ÄúRedmine Synchronization‚Äù.  Such a task should be created and put the access parameters in the ‚ÄúNotes‚Äù field in the YAML format according to the sample (the values ‚Äã‚Äãof the parameters, of course, should be replaced with their own): <br><br><pre><code class="plaintext hljs">redmine_host: 192.168.10.10 redmine_port: 3000 redmine_api_key: a21e583e7670b1fc79378441d485b9608e4c2dc4c redmine_project_uuid: test task_default_redmine_tracker_id: 4 resource_default_redmine_role_id: 4</code> </pre> </li></ol><br><p>  After that, the project is ready for synchronization.  The purpose of the parameters is clear from their names. </p><br><p>  The <code>redmine_project_uuid</code> parameter contains a unique project code that you need to think up in accordance with the Redmine rules, which can be found through the settings page of any project.  If the ‚ÄúUnprocessable Entry‚Äù error occurs when creating a project, you most likely have chosen an incorrect project uuid. </p><br><p>  The <code>task_default_redmine_tracker_id</code> parameter <code>task_default_redmine_tracker_id</code> optional.  If you omit it, the default track will be set from the Redmine settings. </p><br><p>  If you want to not create a new project in Redmine, but connect an existing one, do the following: </p><br><ol><li>  Add the <code>redmine_project_id</code> parameter to the Redmine Synchronization settings and put the Redmine project ID there. This is not uuid!  This integer is the ID of the record in the Redmine database.  You can find this ID, for example, in the project card in XML or JSON format (for the above example, you can get it at <a href="">http://192.168.10.10.06000/projects/test.json</a> ). </li><li>  For tasks to be synchronized with existing ones in Redmine, put in the Hyperlink field not zeros, but their real Redmine ID. </li></ol><br><p>  There is a small limitation with the assignment of resources to the task: </p><br><ul><li>  Since in Redmine you can assign only one executor to a task, the script will scold and stop when it detects more than one resource marked for synchronization in the MSP task.  (1) It is possible that in future versions this behavior will be replaced by a more gentle one, such as issuing a warning and a random selection of one of.  (2) Resources that are not synchronized can be assigned as many as you like, P2R ignores them. </li></ul><br><p>  The following synchronization algorithm has been implemented: </p><br><ul><li>  The name of the task, the structure of subordination and the person in charge have priority on the MSP side, i.e.  they need to be edited in MS Project, and the changes will go to Redmine during synchronization. </li><li>  The beginning of the task, the end, the effort (estimate and actual) take precedence on the Redmine side and go to MSP during synchronization. </li></ul><br><p>  There is also a problem with labor costs: in MSP, labor costs, actual labor costs and the percentage of performance are strictly related to the formula, while in Redmine, they are set independently.  That is, it was estimated at 10 hours, spent 40 hours and at the same time completed the task by 30%.  In life, it happens, and Redmine does not mind.  The solution chosen is: </p><br><ul><li>  Actual costs are always written as they are. </li><li>  If the actual costs are more than the estimate and the completion percentage is 0, ignore the estimate. </li><li>  If the actual costs are greater than the estimate and the percentage of completion is not 0, then we calculate the new estimate after the fact and percentage of completion. </li></ul><br><p>  So the sync process looks like this: </p><br><ol><li>  We open our project in MS Project and leave it active. </li><li>  If we want, we start the idle run of P2R and see what changes there will be. </li><li>  We start the actual synchronization: with the ‚Äìe key. </li></ol><br><p>  The working directory from which the script is run does not matter. </p><br><p>  You can make the script run on a timer, and synchronization will become completely automatic. </p><br><p>  Thank you for attention. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/452982/">https://habr.com/ru/post/452982/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452960/index.html">For all the answer! Consumer Driven Contracts through the eyes of a developer</a></li>
<li><a href="../452962/index.html">The main cause of accidents in data centers - laying between the computer and the chair</a></li>
<li><a href="../452966/index.html">The mindfulness myth: a ‚Äúneurocentric‚Äù view of meditation</a></li>
<li><a href="../452974/index.html">Asynchronous programming (full course)</a></li>
<li><a href="../452980/index.html">ARM CBD-N - Day X will come soon, who did not prepare himself to blame</a></li>
<li><a href="../452984/index.html">Arduino and Raspberry outlaw</a></li>
<li><a href="../452986/index.html">Postgres Locks: 7 Tips for Working with Locks</a></li>
<li><a href="../452992/index.html">CATIA CAD on the 3DEXPERIENCE platform helped recreate Leonardo da Vinci's warship</a></li>
<li><a href="../452994/index.html">Onboarding as a sale of faith in the product and breaking the growth of conversion - the experience of Revolut and Wrike</a></li>
<li><a href="../452996/index.html">Learning Data Science inside the company and thematic meeting in Voronezh</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>