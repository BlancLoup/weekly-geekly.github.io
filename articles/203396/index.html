<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Preparing video for sound design. Which codec to choose</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The material of the article reflects the personal experience of the author and does not pretend to scientific accuracy. I will be glad to any correcti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Preparing video for sound design. Which codec to choose</h1><div class="post__text post__text-html js-mediator-article">  The material of the article reflects the personal experience of the author and does not pretend to scientific accuracy.  I will be glad to any corrections and additions.  For those who do not want to read further, the correct answer to the main question: MJPEG. <br><br><h5>  Introduction </h5><br>  Clients often prefer archaic ways of transmitting design materials and cases where a 5-minute film sent by mail attachment compressed to 20 MB is not uncommon.  The material for familiarization becomes the material for the work, which entails a number of unobvious problems, the main of which are low image detail (caused by excessive compression) and the use of video codecs that are not intended for audio editing. <br><br>  Low detailing, pixelation and general motion blur make it difficult for the sound engineer to work at the very beginning, when there is an assessment of the plot and visual elements of the film that can be voiced.  Hence, there is such a problem as an aesthetic mismatch, when, for example, a plastic (by design) object is sounded as metal or glass. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Poor picture quality also makes it difficult for the sound engineer to determine the beginning and completion of dynamic visual events, which leads to their vague synchronization with audio.  But most often, the lag or sound ahead of the picture is related to the features of the video codec that was used in the audomontage process, which will be discussed below. <br><a name="habracut"></a><br><h5>  general information </h5><br>  But first, some information about what a video file is all about.  In short, this container is a metafile that contains several streams of data.  Streams include audio, video, images, subtitles, menus, chapter information, metadata, tags, etc.  Inside the container there can be several streams of the same type at once (for example, 2 video tracks, 3 audio tracks, subtitles in several languages), and each of them can be compressed with different codecs.  Here it is worth recalling the terms: <br><br><ul><li>  <b>mux</b> - packing multiple streams in one container </li><li>  <b>demux</b> - extract streams from container to separate files </li><li>  <b>remux</b> - replacing one or more threads in a container </li></ul><br>  All these operations are without loss of quality, i.e.  they have no effect on the contents of the streams. <br><br>  AVI, FLV, MOV, MP4, MKV, OGG, TS, WebM - these are not video codecs, but containers - the video file extension almost does not reflect the nature of the content.  Video codecs are DivX, XVid, H.264, MPEG, MJPEG, Theora, VP9 and they are of three types: <b>lossy</b> , <b>lossless</b> and <b>intra-only</b> .  It is codecs that determine image quality and suitability for audio editing.  About intra-only will be discussed below, and the principles of the first two types are well described in <a href="http://habrahabr.ru/post/111244/">this article</a> .  In short, the codec divides the video stream into groups of frames ( <b>G</b> group <b>O</b> f <b>P</b> ictures) and to reduce the file size, only the first frame (i-frame) is fully stored in each GOP, and the rest (b- and p-frames) contain Only information about changes in the picture.  As a result, the structure of each GOP looks like this: ibbpbbpbbp.  The more compressed the video, the higher the threshold for passing changes to b- and p-frames.  The longer the GOP, the more problems there will be with rewinding (sticky frames, etc.).  Hence the conclusion: for audio editing, lossy and lossless codecs are conditionally suitable only if the video was converted with a small GOP value. <br><br><h5>  Synchronization </h5><br>  Synchronization of streams is carried out through timestamps (timestamps), which are generated by the codec during (de) coding.  If an error occurs at that moment, the codec skips such frames and assigns the timestamp of the problematic packet to the next non-problematic one.  As a result, out of sync the ‚Äúbroken‚Äù stream with the others occurs.  When re-converting such a file to lossy / lossless format, the effect may increase. <br><br><h5>  Intra-frame </h5><br>  A distinctive feature of the intra-frame codecs is that each frame of the stream is a key (i-frame).  Inadequate intermediate frames are missing.  One of the most popular codecs of this type is <a href="http://ru.wikipedia.org/wiki/MJPEG">MJPEG (Motion JPEG)</a> .  It converts a video into a sequence of independently compressed JPEG images. <br><br>  Pros MJPEG: <br><br><ul><li>  fast conversion speed </li><li>  smooth rewind </li><li>  suitable for audio editing </li></ul><br>  Minuses: <br><br><ul><li>  file size can be quite large </li></ul><br>  You can convert any video file to MJPEG using the <a href="http://ffmpeg.org/">ffmpeg</a> utility.  The command will be something like this: <br><br><pre><code class="dos hljs">ffmpeg -i input.avi -c:v mjpeg -q:v <span class="hljs-number"><span class="hljs-number">1</span></span> -c:a <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> output.mov</code> </pre> <br>  In order not to perform this operation every time from the command line, create a script like this (for Windows) and simply drag and drop video files onto it (several can be done at once): <br><br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-variable"><span class="hljs-variable">%%A</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (%*) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> ffmpeg -i <span class="hljs-variable"><span class="hljs-variable">%%A</span></span> -c:v mjpeg -q:v <span class="hljs-number"><span class="hljs-number">1</span></span> -c:a <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> "<span class="hljs-variable"><span class="hljs-variable">%%~</span></span>nA"_mjpeg.mov</code> </pre> <br>  For convenience, a shortcut to this script can be thrown into the SendTo folder (in the shortcut properties you will need to clear the ‚ÄúStart in‚Äù field). <br><br><h5>  Finally </h5><br>  In advance, ask the client to send the video in good quality (not very compressed lossy or lossless), then convert any video sent to MJPEG and do the voice acting for this format.  When the sound is ready, remux the client video by adding your audio track to the container.  Some containers have limitations, for example, MP4 does not support audio streams in PCM (WAV / AIFF), the sound in this case will have to be transferred to MP3 or ALAC.  Detailed table of compatibility is on <a href="http://en.wikipedia.org/wiki/Comparison_of_container_formats">Wikipedia</a> . </div><p>Source: <a href="https://habr.com/ru/post/203396/">https://habr.com/ru/post/203396/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../203372/index.html">Say thanks to WINAMP ‚Ä¢ thxwinamp.com</a></li>
<li><a href="../203374/index.html">Someone made a $ 160 million bitcoin transaction</a></li>
<li><a href="../203376/index.html">Home all-in-one server - success story</a></li>
<li><a href="../203386/index.html">Query optimization. Basics of EXPLAIN in PostgreSQL (Part 2)</a></li>
<li><a href="../203394/index.html">Achiver: what's what</a></li>
<li><a href="../203398/index.html">There is an error in almost all implementations of binary search and merge sort</a></li>
<li><a href="../203400/index.html">The digest of interesting materials from the world of web development and IT for the last week No. 84 (November 16 - 23, 2013)</a></li>
<li><a href="../203402/index.html">ThL W8s - a powerful smartphone with glass protection Gorilla Glass 3</a></li>
<li><a href="../203406/index.html">How Stack Overflow Works - Iron</a></li>
<li><a href="../203408/index.html">From idea to App Store: 24 hours, 2 applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>