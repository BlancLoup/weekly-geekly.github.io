<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Traffic Inspector: full reboot</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! Almost 12 years ago, we, the company Smart-Soft , released the first version of its flagship product, Traffic Inspector . During this time, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Traffic Inspector: full reboot</h1><div class="post__text post__text-html js-mediator-article">  <b>Hi, Habr!</b>  Almost 12 years ago, we, the company <a href="http://www.smart-soft.ru/ru/">Smart-Soft</a> , released the first version of its flagship product, <a href="http://www.smart-soft.ru/ru/products/Traffic-Inspector/"><b>Traffic Inspector</b></a> .  During this time, it has evolved from a regular proxy server to a universal security gateway, combining proxy, email, antispam, web servers with Phishing Blocker service modules, RBL, RAS Dialer, NetPolice content filtering plug-in, advanced CCC system certification and FSTEC, and the possibility of accounting for different types of traffic (IMAP, SMTP, POP, NAT and proxy). <br><br>  As with any serious product, over the course of evolution, Traffic Inspector was flawed.  Today we summarize the work on the mistakes that has been carried out by specialists of our company over the past couple of years. <br><br> <a href="http://habrahabr.ru/company/smart_soft/blog/254741/"><img src="https://habrastorage.org/files/c42/dd3/c5b/c42dd3c5b2aa49c688a5854c4f095ccf.png"></a> <br><a name="habracut"></a><br><h2>  <font color="#0c5aa5">Low stability Traffic Inspector</font> </h2><br>  The central component of Traffic Inspector is a network driver responsible for the direct removal of traffic data and its transfer to the program service.  The driver code is executed in kernel mode, and any errors are fraught with "falling into the blue screen", a forced reboot and loss of all unsaved data.  For customers, it is important that a program of this class (Internet gateway) can be operated on the principle of ‚Äúset-set-up-forget‚Äù.  The code and error messages were analyzed, the problem of low driver stability was successfully solved in early 2014 - ‚Äúblue screens‚Äù are now a rare phenomenon. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/27e/cd2/602/27ecd2602bda49849627990fd4c8dea5.png"><br>  <i>The rest of the <a href="http://www.smart-soft.ru/ru/products/Traffic-Inspector/Screenshots/">screenshots of the</a> application</i> <br><br>  Alexander Yamashkin, head of development department, about driver work: <br><br><img src="https://habrastorage.org/files/217/114/0db/2171140db4e14dd2bb38bf795be85c4e.jpg" align="left">  <i>It is known that the lower the level of the reference model (OSI) on which protection is implemented, the more transparent it is for applications.</i>  <i>However, by reducing this level, the set of available mechanisms decreases and the ‚Äúcost of error‚Äù is higher.</i>  <i>For a guaranteed analysis of all packets passing through the network interfaces, NDIS was chosen for the link level, but the cost of the error was a BSOD.</i>  <i>We spent a lot of time analyzing errors in order to say with a large degree of confidence that at the moment driver problems are possible only in the event of a conflict with third-party drivers.</i> <br><br><h2>  <font color="#0c5aa5">Poor Traffic Inspector Performance</font> </h2><br>  64-bit processors appeared in 2003.  At the same time, Traffic Inspector remained a 32-bit in the Smart-Soft for a long ten years, which was often the cause of dissatisfaction among the system administrators.  32-bit platforms and software have a number of significant limitations: support for no more than 4 TB of hard disk space, support for no more than 3 GB of RAM and no more than 2 GB for the user space of the application.  Traffic Inspector proxy server (implemented as part of the service) is designed for active use of available memory.  The 32-bit version of the service often quickly ‚Äúconsumed‚Äù limited memory resources, rested against the memory ceiling, the program could not open more than 4096 threads in the system, the system hung under load and the proxy started to slow down a lot.  The most important improvement of the program is the release of the 64-bit version of the service, released at the end of 2013.  In the new version there are both x86 and x64 versions and the user himself determines which one to install.  You can forget about past memory problems, and now the proxy can easily handle up to 1000 simultaneous HTTP requests. <br><br>  Alexander Yamashkin on the implementation of work on 64-bit platforms: <br><br>  <i>Now there are both 32-bit and 64-bit versions of the program, and the user himself determines which one to install (at the moment 70-80% of installations fall on the 64-bit one).</i>  <i>Using the latter removes the limitations imposed by the operating system on the amount of memory in 2 GB, which can be allocated to the process, and therefore there are no errors that occur when it is impossible to allocate the next memory block to the process.</i> <br><br><h2>  <font color="#0c5aa5">Slow web portal and reporting in Traffic Inspector</font> </h2><br>  The Traffic Inspector web portal provides the generation of network operation reports and other aspects of network statistics.  Many customers acquired Traffic Inspector for this very purpose - statistical data collection and reporting.  One could understand their disappointment when the process of forming even a simple report could drag on for a long time.  This problem was overcome by translating the web portal to PHP and related technologies. <br><br>  Alexander Yamashkin about the translation of the portal in PHP: <br><br>  <i>Prior to version 3.0.1, the portal was written in C # c using the .Net Framework.</i>  <i>In addition to changing the interpreter, a report preparation service was implemented, into which all the reporting logic was moved.</i>  <i>The portal now has only one function - the GUI.</i> <br><br>  In addition to speeding up the work of the portal, database distribution and data storage for a long period of time were introduced: <br><br>  <i>If you need to store data for a large interval, we recommend the use of third-party DBMS.</i>  <i>But even with them from time to time there were problems.</i>  <i>Imagine the complexity of servicing a 1.5 TB database in MS SQL, while 90% of this data is not used.</i>  <i>Therefore, in 3.0.2, the database dividing mechanism was implemented, when, at the end of the period (month / quarter / half year / year - specified by the administrator), the database, including SQLite, is disconnected from operational work and is used only when requesting reports for the specified period.</i> <br><br><img src="https://habrastorage.org/files/69e/660/67e/69e66067e88241d785c7666ee5448bfa.jpg"><br><br><h2>  <font color="#0c5aa5">Ease of use Traffic Inspector</font> </h2><br>  Many customers who first encountered the Traffic Inspector program often talked about the great complexity in its development and the incomprehensible interface.  Recently, a number of efforts have been made to improve the usability of the program. <br><br>  Significantly changed the interface Traffic Inspector.  Now use the various elements of the program has become easier and more convenient.  In the new structure of the console tree, the elements are more logical and convenient.  The content of the pages for the main nodes of the console tree has been completely redesigned (Objects, Traffic Accounting, Users and Groups, Rules, Services, Settings).  As a result, the administrator of the Traffic Inspector program receives simple and convenient control over all the program's features, comprehensive information about its settings and links for solving basic administrative tasks.  The new system of adding users and a number of wizards make the initial setup of the program as easy as possible. <br><br>  Alexander Yamashkin about the new user addition system: <br><br>  <i>The system, fixing access to the Internet from a user not registered in the program, can either automatically create an account based on the specified parameters, or create a request for the administrator, who can only confirm the creation of a new account and assign the necessary access rules.</i> <br><br><h2>  <font color="#0c5aa5">New to Traffic Inspector 3.0.2</font> </h2><br>  The latest changes in the program will be commented by the head of the development department Alexander Yamashkin: <br><br>  <i>The main improvements were related to the reports and the new registration system, the remaining ones were rather specific.</i>  <i>For example:</i> <i><br><br></i> <ul><li>  Implemented the ability to view requests blocked by access rules.  This will allow both to understand the reason for blocking, and to see which users tried to access prohibited resources. </li><li>  Display of extended information when a resource is blocked, which is included in the Unified Register of Domain Names containing information, the distribution of which in the Russian Federation is prohibited. </li><li>  Work was done to minimize the installer, by eliminating the signatures of the anti-virus database and the library of anti-virus modules.  This data will be loaded when the modules are first used. </li><li>  Produced work on optimizing the speed of building reports.  Not only were all requests processed, but the data hashing system was implemented in the report generation service. </li></ul><br><h2>  <font color="#0c5aa5">Future plans to change Traffic Inspector</font> </h2><br>  This will tell Alexander Yamashkin and Vaidas Damoshevichyus, CTO and partner of the company Smart-Soft. <br><br>  Alexander Yamashkin: <br><br>  <i>I really want to make the process of creating rules for access to information resources as simple and understandable as a sophisticated and novice administrator.</i> <br><br>  Vaidas Damoshevichus: <br><br><img src="https://habrastorage.org/files/bad/d34/1af/badd341af45b447fa3c1d9393aa7ef08.jpg" align="left">  <i>Now we are actively exploring technological solutions for classifications of packages at the seventh level (Layer 7) - we are looking for what we could integrate into the Traffic Inspector.</i>  <i>After successful integration to our users, we will present a new functionality.</i>  <i>When it will be?</i>  <i>Then, when we ourselves will be satisfied with the results of integration, since we set high quality indicators for ourselves.</i>  <i>We also did not forget about the reports - we want to improve them and make not just reports, but a set of analytical tools that will help system administrators to monitor and monitor network anomalies.</i> <br><br><h2>  <font color="#0c5aa5">Conclusion</font> </h2><br>  The company Smart-Soft took into account the shortcomings of its software and carried out work to eliminate.  The program moved to the 64-bit platform, significantly increasing the performance of individual components.  Numerous corrections and additions touched most aspects of the program.  The new Traffic Inspector is a multifunctional <a href="http://www.smart-soft.ru/ru/products/Traffic-Inspector/Features/internet-shlyuz/">Internet gateway of a</a> new generation with modern functionality, but at the same time an interface that every user can understand. <br><br>  <b>PS:</b> If there is something that we have not said, suggestions for correction, we will be glad to hear your comments. </div><p>Source: <a href="https://habr.com/ru/post/254741/">https://habr.com/ru/post/254741/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254727/index.html">Asynchronous work with Tarantool on Python</a></li>
<li><a href="../254731/index.html">Improving xaml: Bindable Converters, Switch Converter, Sets</a></li>
<li><a href="../254733/index.html">Using Asterisk to receive data from security systems</a></li>
<li><a href="../254737/index.html">Talking panda or what can be done with FFmpeg and OpenCV on Android</a></li>
<li><a href="../254739/index.html">Techno-Designed Alarm Clock - Arduino Based Desk Clock</a></li>
<li><a href="../254743/index.html">Stepic seeking talents</a></li>
<li><a href="../254747/index.html">Comparison of deep learning libraries on the example of the handwriting numbers classification problem</a></li>
<li><a href="../254749/index.html">Bubot is a very easy Python 3 framework for robot programming and home automation.</a></li>
<li><a href="../254751/index.html">How Wheatfield Diffie helped Bob and Alice trick Eve</a></li>
<li><a href="../254753/index.html">Determine the weight of chess pieces by regression analysis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>