<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Network Device Detection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Scanning a network with building a list of devices and their properties, such as a list of network interfaces, and then removing data in monitoring sy...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Network Device Detection</h1><div class="post__text post__text-html js-mediator-article">  Scanning a network with building a list of devices and their properties, such as a list of network interfaces, and then removing data in monitoring systems, if you do not delve into what is happening, it may seem special, computer magic.  How does it work - under the cut. <br><br><img src="https://habrastorage.org/webt/i4/up/z2/i4upz2hs-11sfk1k6wpwfoz29gs.jpeg"><br><a name="habracut"></a><blockquote>  <b>Disclaimer</b> <br>  The author does not have a specialized education associated with the administration of networks, so there are probably inaccuracies and not all that is mentioned is mentioned. <br></blockquote><h3>  Detection </h3><br>  To detect a device, i.e.  determine if there is anything on the selected ip-address, you can apply the following methods: <br><br><ul><li>  <b>ping scan</b> <br>  Oddly enough, this is the easiest and most common way. <br></li><li>  <b>Check open TCP ports</b> <br>  If the ping response is disabled on the device, you can try to establish a connection using a TCP port.  In view of the fact that there are many ports and checking each of them takes considerable time, only the most common ones are usually checked, for example.  80 or 443 used for the web interface of the device. </li><li>  <b>Verifying the operation of UDP services</b> <br>  The UDP protocol does not send confirmation of receipt of the request and therefore, in general, UDP port scanning is not possible.  However, you can try to interrogate services that listen on the UDP port and send a response to the request, for example.  <a href="https://ru.wikipedia.org/wiki/SNMP">SNMP</a> (port 161) or <a href="https://ru.wikipedia.org/wiki/Intelligent_Platform_Management_Interface">IPMI</a> (port 623).  In case a response other than a timeout is received, the device is detected. </li><li>  <b>ARP scanning</b> <br>  In addition to the usual <a href="https://ru.wikipedia.org/wiki/ICMP">ICMP</a> requests that use the ping utilities, for devices in the same L2 broadcast domain, you can use faster <a href="https://ru.wikipedia.org/wiki/Arping">arping</a> . The MAC address of the requestor ‚Äù, and if a response is received, the device is considered detected. </li><li> <b>CDP / LLDP</b> <br>  If the network uses the <a href="https://ru.wikipedia.org/wiki/LLDP">LLDP</a> protocol (or CDP equivalent), then devices can collect information about their neighbors that can be considered detected.  This data is available via SNMP. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I note that the information about the neighbors together with the <code>traceroute</code> results can serve as the basis for building a physical map of the network. </li><li>  <b>NetBIOS scan</b> <br>  The <a href="https://ru.wikipedia.org/wiki/NetBIOS">NetBIOS protocol</a> can be used to search for Windows machines, for example using the <code>nbtscan</code> utility. </li><li>  <b>DHCP logs</b> (suggested by <a href="https://habrahabr.ru/users/alexanster/" class="user_link">alexanster</a> ) <br>  In the DHCP server logs there is information about issuing ip-addresses to MAC-addresses.  For recent entries in the log, we can assume that these devices are detected. </li><li>  <b>ARPWatch</b> (suggested by <a href="https://habrahabr.ru/users/alexanster/" class="user_link">alexanster</a> , described by <a href="https://habrahabr.ru/users/tahkuct/" class="user_link">TaHKucT</a> ) <br>  Arpwatch keeps track of pairs of IP addresses - MAC addresses, recording new, missing and changed pairs to the log.  Devices trapped in the log can be considered detected. <br></li><li>  <b>Analysis of switch FDB tables</b> (suggested by <a href="https://habrahabr.ru/users/mickvav/" class="user_link">mickvav</a> ) <br>  FDB tables (Forwarding DataBase) of managed switches contain data on switching of MAC addresses of subscribers and devices, i.e.  corresponding to the MAC address of the device - switch port. <br><br>  Data is available via <a href="https://habrahabr.ru/post/213247/">SNMP</a> and telnet, and can be used when building a physical network map. </li></ul><br><h3>  Collection of information </h3><br>  After the device is detected, you can proceed to gathering information about it. <br>  Using the ARP protocol, you can get a MAC address via ip, and a probable manufacturer can get it (some equipment allows changing the address, so the method is not very reliable).  Then you can use the <a href="https://ru.wikipedia.org/wiki/Nmap">nmap</a> utility, which scans the open ports, compares with its database of fingerprints and <a href="https://nmap.org/man/ru/man-os-detection.html">makes an assumption</a> about the operating system used, its version and device type. <br><br><div class="spoiler">  <b class="spoiler_title">Getting device type and operating system using nmap</b> <div class="spoiler_text"><pre> <code class="dos hljs">nmap -O -v <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Starting Nmap <span class="hljs-number"><span class="hljs-number">7</span></span>.<span class="hljs-number"><span class="hljs-number">60</span></span> ( https://nmap.org ) <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> <span class="hljs-number"><span class="hljs-number">2018</span></span>-<span class="hljs-number"><span class="hljs-number">03</span></span>-<span class="hljs-number"><span class="hljs-number">04</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span> RTZ <span class="hljs-number"><span class="hljs-number">2</span></span> (ceia) Initiating ARP <span class="hljs-built_in"><span class="hljs-built_in">Ping</span></span> Scan <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span> Scanning <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> [<span class="hljs-number"><span class="hljs-number">1</span></span> port] Completed ARP <span class="hljs-built_in"><span class="hljs-built_in">Ping</span></span> Scan <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">70</span></span>s elapsed (<span class="hljs-number"><span class="hljs-number">1</span></span> total hosts) Initiating Parallel DNS resolution of <span class="hljs-number"><span class="hljs-number">1</span></span> host. <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span> Completed Parallel DNS resolution of <span class="hljs-number"><span class="hljs-number">1</span></span> host. <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">00</span></span>s elapsed Initiating SYN Stealth Scan <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span> Scanning <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> [<span class="hljs-number"><span class="hljs-number">1000</span></span> ports] Discovered open port <span class="hljs-number"><span class="hljs-number">80</span></span>/tcp on <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Discovered open port <span class="hljs-number"><span class="hljs-number">49152</span></span>/tcp on <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Discovered open port <span class="hljs-number"><span class="hljs-number">1900</span></span>/tcp on <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Completed SYN Stealth Scan <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">13</span></span>s elapsed (<span class="hljs-number"><span class="hljs-number">1000</span></span> total ports) Initiating OS detection (try #<span class="hljs-number"><span class="hljs-number">1</span></span>) against <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Retrying OS detection (try #<span class="hljs-number"><span class="hljs-number">2</span></span>) against <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> WARNING: OS didn't match until try #<span class="hljs-number"><span class="hljs-number">2</span></span> Nmap scan report <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Host is up (<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">00</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">997</span></span> closed ports PORT STATE SERVICE <span class="hljs-number"><span class="hljs-number">80</span></span>/tcp open http <span class="hljs-number"><span class="hljs-number">1900</span></span>/tcp open upnp <span class="hljs-number"><span class="hljs-number">49152</span></span>/tcp open unknown MAC Address: A0:F3:C1:<span class="hljs-number"><span class="hljs-number">35</span></span>:<span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span> (Tp-link Technologies) Device <span class="hljs-built_in"><span class="hljs-built_in">type</span></span>: WAP Running: Linux <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span>.X OS CPE: cpe:/o:linux:linux_kernel:<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span>.<span class="hljs-number"><span class="hljs-number">36</span></span> OS details: DD-WRT v24-sp1 (Linux <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span>.<span class="hljs-number"><span class="hljs-number">36</span></span>) Network Distance: <span class="hljs-number"><span class="hljs-number">1</span></span> hop</code> </pre> </div></div><br>  To obtain more detailed information on the device, you will need one of the following methods: <br><br><ul><li>  <b>SNMP</b> <br>  <a href="https://ru.wikipedia.org/wiki/SNMP">SNMP is</a> almost always supported by routers and switches;  available in Windows (the corresponding service is disabled by default);  Linux requires the installation of the snmpd daemon.  Apparently the last third version is quite difficult to implement, so the previous version 2c is still relevant, although not recommended because of the lack of encryption during data transfer.  The protocol works on the 161 UDP port of the device. <br><br>  You can use the <a href="http://www.net-snmp.org/">Net-SNMP</a> utility package to work with <a href="http://www.net-snmp.org/">SNMP</a> .  To get, for example, a description of the device, you must specify the protocol version, the password for reading (community read, public by default) and the address in SNMP notation called the OID (object identificator) and consisting of numbers and points.  All addresses of the device can be represented as a tree, where the addresses are sorted in lexicographical order.  The protocol allows you to request the current value at the address, as well as the addresses following the current one. <br><br><div class="spoiler">  <b class="spoiler_title">Getting device description using snmpget</b> <div class="spoiler_text"><pre> <code class="dos hljs">snmpget -v <span class="hljs-number"><span class="hljs-number">2</span></span>c -c public <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">102</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> SNMPv2-MIB::sysDescr.<span class="hljs-number"><span class="hljs-number">0</span></span> = STRING: Linux debian <span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">16</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">4</span></span>-<span class="hljs-number"><span class="hljs-number">586</span></span> #<span class="hljs-number"><span class="hljs-number">1</span></span> Debian <span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">16</span></span>.<span class="hljs-number"><span class="hljs-number">43</span></span>-<span class="hljs-number"><span class="hljs-number">2</span></span>+deb8u2 (<span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">26</span></span>) i686</code> </pre> </div></div><br>  The standard set of addresses is very limited and contains a description of the device, contacts, location and uptime.  The remaining addresses depend on the device manufacturer and can be obtained by scanning, for example, using the snmpwalk utility.  Fortunately, Linux and Windows have typical addresses for network interfaces and CPU / memory load, so all they need to know (or be able to determine) is the operating system used. <br><br><div class="spoiler">  <b class="spoiler_title">Getting Linux disk descriptions using snmpwalk</b> <div class="spoiler_text"><pre> <code class="dos hljs">snmpwalk -v <span class="hljs-number"><span class="hljs-number">2</span></span>c -c public <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">102</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">2021</span></span>.<span class="hljs-number"><span class="hljs-number">9</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> UCD-SNMP-MIB::dskPath.<span class="hljs-number"><span class="hljs-number">1</span></span> = STRING: / UCD-SNMP-MIB::dskPath.<span class="hljs-number"><span class="hljs-number">2</span></span> = STRING: /var UCD-SNMP-MIB::dskPath.<span class="hljs-number"><span class="hljs-number">3</span></span> = STRING: / UCD-SNMP-MIB::dskPath.<span class="hljs-number"><span class="hljs-number">4</span></span> = STRING: /run UCD-SNMP-MIB::dskPath.<span class="hljs-number"><span class="hljs-number">5</span></span> = STRING: /dev/shm UCD-SNMP-MIB::dskPath.<span class="hljs-number"><span class="hljs-number">6</span></span> = STRING: /run/lock UCD-SNMP-MIB::dskPath.<span class="hljs-number"><span class="hljs-number">7</span></span> = STRING: /sys/<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>/cgroup</code> </pre> </div></div><div class="spoiler">  <b class="spoiler_title">Getting Windows disk descriptions using snmpwalk</b> <div class="spoiler_text"><pre> <code class="dos hljs">snmpwalk -v <span class="hljs-number"><span class="hljs-number">2</span></span>c -c public localhost <span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">25</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> HOST-RESOURCES-MIB::hrStorageDescr.<span class="hljs-number"><span class="hljs-number">1</span></span> = STRING: C:\ <span class="hljs-built_in"><span class="hljs-built_in">Label</span></span>: Serial Number a65ceb77 HOST-RESOURCES-MIB::hrStorageDescr.<span class="hljs-number"><span class="hljs-number">2</span></span> = STRING: D:\ <span class="hljs-built_in"><span class="hljs-built_in">Label</span></span>: Serial Number ded9f83e HOST-RESOURCES-MIB::hrStorageDescr.<span class="hljs-number"><span class="hljs-number">3</span></span> = STRING: E:\ <span class="hljs-built_in"><span class="hljs-built_in">Label</span></span>: Serial Number <span class="hljs-number"><span class="hljs-number">8</span></span>e764a1 HOST-RESOURCES-MIB::hrStorageDescr.<span class="hljs-number"><span class="hljs-number">4</span></span> = STRING: I:\ HOST-RESOURCES-MIB::hrStorageDescr.<span class="hljs-number"><span class="hljs-number">5</span></span> = STRING: Virtual Memory HOST-RESOURCES-MIB::hrStorageDescr.<span class="hljs-number"><span class="hljs-number">6</span></span> = STRING: Physical Memory</code> </pre> </div></div></li><li>  <b>WMI</b> <br>  <a href="https://ru.wikipedia.org/wiki/WMI">WMI</a> technology is an enhanced and adapted for Windows implementation of the <a href="https://en.wikipedia.org/wiki/Web-Based_Enterprise_Management">WBEM</a> standard that allows you to remotely not only read parameters, but also control the device.  WMI runs on top of <a href="https://ru.wikipedia.org/wiki/%25D0%25A3%25D0%25B4%25D0%25B0%25D0%25BB%25D1%2591%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B2%25D1%258B%25D0%25B7%25D0%25BE%25D0%25B2_%25D0%25BF%25D1%2580%25D0%25BE%25D1%2586%25D0%25B5%25D0%25B4%25D1%2583%25D1%2580">RPC</a> (TCP port 135) and <a href="https://ru.wikipedia.org/wiki/DCOM">DCOM</a> (on an arbitrary TCP port above 1024), and is actively used in <a href="https://ru.wikipedia.org/wiki/Windows_PowerShell">Power Shell</a> scripts (previously Windows Script Host). <br><br>  Data can be queried, of course, only from Windows machines. <br><br><div class="spoiler">  <b class="spoiler_title">Get RAM information in PowerShell</b> <div class="spoiler_text"><pre> <code class="dos hljs">Get-WmiObject win32_OperatingSystem |%{"Total Physical Memory: {<span class="hljs-number"><span class="hljs-number">0</span></span>}KB`nFree Physical Memory : {<span class="hljs-number"><span class="hljs-number">1</span></span>}KB`nTotal Virtual Memory : {<span class="hljs-number"><span class="hljs-number">2</span></span>}KB`nFree Virtual Memory : {<span class="hljs-number"><span class="hljs-number">3</span></span>}KB" -f $_.totalvisiblememorysize, $_.freephysicalmemory, $_.totalvirtualmemorysize, $_.freevirtualmemory} Total Physical Memory: <span class="hljs-number"><span class="hljs-number">2882040</span></span>KB Free Physical Memory : <span class="hljs-number"><span class="hljs-number">612912</span></span>KB Total Virtual Memory : <span class="hljs-number"><span class="hljs-number">5762364</span></span>KB Free Virtual Memory : <span class="hljs-number"><span class="hljs-number">1778140</span></span>KB</code> </pre> </div></div><br>  There is also a console utility <a href="https://blogs.technet.microsoft.com/askperf/2012/02/17/useful-wmic-queries/">wmic</a> and its <a href="https://www.krenger.ch/blog/wmi-commands-from-linux/">Linux port.</a> <br><br><div class="spoiler">  <b class="spoiler_title">Getting device maker with wmic</b> <div class="spoiler_text"><pre> <code class="dos hljs">wmic /USER:admin /PASSWORD:mypassword /NODE:"<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">100</span></span>" computersystem get Manufacturer Manufacturer Gigabyte Technology Co., Ltd.</code> </pre> </div></div></li><li>  <b>Agent monitoring system, for example.</b>  <b>Zabbix or Check_MK</b> <br>  If possible, a small program is installed on the device that runs in the background and collects data.  The advantage of using agents is that data acquisition is unified regardless of the hardware and operating system used by the device, and it is also possible to collect data available only locally (for example, the result of the console program). </li><li>  <b>Ssh</b> <br>  Initially, data on <a href="https://ru.wikipedia.org/wiki/SSH">SSH</a> can be obtained from Linux and iOS devices.  For Windows and Android, you will need to install an SSH server. <br><br><div class="spoiler">  <b class="spoiler_title">Getting CPU information over SSH</b> <div class="spoiler_text"><pre> <code class="dos hljs">cat /proc/cpuinfo processor : <span class="hljs-number"><span class="hljs-number">0</span></span> Processor : AArch64 Processor rev <span class="hljs-number"><span class="hljs-number">4</span></span> (aarch64) Hardware : sun50iw1p1 BogoMIPS : <span class="hljs-number"><span class="hljs-number">48</span></span>.<span class="hljs-number"><span class="hljs-number">00</span></span> Features : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid CPU implementer : <span class="hljs-number"><span class="hljs-number">0</span></span>x41 CPU architecture: <span class="hljs-number"><span class="hljs-number">8</span></span> CPU variant : <span class="hljs-number"><span class="hljs-number">0</span></span>x0 CPU part : <span class="hljs-number"><span class="hljs-number">0</span></span>xd03 CPU revision : <span class="hljs-number"><span class="hljs-number">4</span></span> processor : <span class="hljs-number"><span class="hljs-number">1</span></span> ...</code> </pre> <br></div></div></li><li>  <b>Requesting data from a management service</b> , such as a virtual machine <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D0%25B8%25D0%25BF%25D0%25B5%25D1%2580%25D0%25B2%25D0%25B8%25D0%25B7%25D0%25BE%25D1%2580">hypervisor</a> </li></ul><br><h3>  How it works on the example of Zabbix </h3><br>  As you know, <a href="https://ru.wikipedia.org/wiki/Zabbix">Zabbix</a> can independently discover new devices on the network and automatically poll some of their parameters.  This is called - <a href="https://www.zabbix.com/documentation/4.0/ru/manual/discovery/low_level_discovery">Low Level Discovery</a> . <br><br>  Device discovery is defined by <a href="https://www.zabbix.com/documentation/4.0/ru/manual/discovery/network_discovery/rule">network discovery rules</a> that combine the detection methods listed earlier, determine whether a device is available and which template to apply to it (the device description is usually examined).  The template contains a list of properties that can be obtained from the device, as well as rules for the detection and creation of new, executed on a timer. <br><br>  In the case of SNMP, this might look something like this: enumerate all the child elements of the <abbr title="network interface status list"><code>1.3.6.1.2.1.2.2.1.8</code></abbr> node (detection rule) and for each element found (the number placed in <code>{#SNMPINDEX}</code> ) add new metrics set via prototypes of data elements, <abbr title="how many bytes were received"><code>1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}</code></abbr> and <abbr title="how many bytes were sent"><code>1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}</code></abbr> , if they are not already there.  Read more <a href="https://habrahabr.ru/company/zabbix/blog/193460/">here</a> . <br><br>  In the case of an agent, the rule will look a little different: request one of the discovery properties from the agent, for example <code>system.cpu.discovery</code> , get a list of processors in the form of json <br><br><pre> <code class="hljs json">[ {<span class="hljs-attr"><span class="hljs-attr">"NUMBER"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"STATUS"</span></span>: <span class="hljs-string"><span class="hljs-string">"online"</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">"NUMBER"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"STATUS"</span></span>: <span class="hljs-string"><span class="hljs-string">"online"</span></span>} ]</code> </pre> <br>  and for each element add <code>system.cpu.load[{#CPU.NUMBER}]</code> , if there is no such metric yet.  It should be noted that Zabbix-agent allows you to create your own elements ( <code>UserParameter</code> ), which can be requested, and therefore you can easily implement, for example, finding files and tracking their size in a given folder.  Read more <a href="https://habrahabr.ru/post/194980/">here</a> . <br><br><h3>  Conclusion </h3><br>  As you can see everything is quite simple and there is no magic.  If you know any other ways to detect devices or get their properties, please report them. </div><p>Source: <a href="https://habr.com/ru/post/350394/">https://habr.com/ru/post/350394/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350384/index.html">Selection: 12 services to protect against DDoS-attacks</a></li>
<li><a href="../350386/index.html">Java 8 and Strategy pattern</a></li>
<li><a href="../350388/index.html">Examining DB and DBMS with T-SQL</a></li>
<li><a href="../350390/index.html">Proper bookmarking: how to work more efficiently and memorize more</a></li>
<li><a href="../350392/index.html">Cuckoo 2.0. We collect the best open source platform for analyzing malicious files</a></li>
<li><a href="../350396/index.html">Implement fast 2D shadows in Unity using 1D shadow mapping</a></li>
<li><a href="../350398/index.html">Native dependency inversion in TypeScript and React</a></li>
<li><a href="../350402/index.html">The most appropriate ways to learn new software</a></li>
<li><a href="../350406/index.html">Own data in the system crash dump of Windows</a></li>
<li><a href="../350408/index.html">Digitalization and reality. Should I change something?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>