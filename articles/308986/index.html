<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Meet p5.js</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have been a front end developer for over 5 years and always try to keep up with all the news. I remember that two years ago I became interested in J...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Meet p5.js</h1><div class="post__text post__text-html js-mediator-article"><p>  I have been a front end developer for over 5 years and always try to keep up with all the news.  I remember that two years ago I became interested in JavaScript graphics.  And then for a couple of months I started doing research about graphics in JavaScript, since I had a project on D3.js then.  First, I started learning Canvas and SVG, which is part of HTML5, but I also need to write code in JS, for example, I had a project to customize an expensive watch on Canvas.  The next project with graphics was with D3.js. It was quite simple, it was necessary to show graphs in D3.js on the basis of all the company's sales data.  My latest gafi-based project will be on p5.js and I decided to find out everything about it, and in this publication I want to share my research about this p5.js. </p><br><p>  <a href="http://p5js.org/">P5.js</a> was created by the Processing team in 2014.  This is a javascript library with particular emphasis on visual art.  The goal of P5.js coincides with the original purpose of Processing - it is to lower the threshold for entering programming for artists, designers, and teachers.  With P5.js, you can easily create an infinitely large number of options for displaying information: from web format, static pictures for printing, to animated and interactive schemes. </p><br><p>  <a href="http://processing.org/">Processing</a> was created in 2001 with the goal of teaching non-programmers programming, but since then it has become the main language for tens of thousands of artists and designers.  P5.js renders PDE files with Processing Source Code.  When using this library, the programmer may not know JavaScript at all.  Details on the differences between Processing and p5 can be found in this <a href="http://www.sitepoint.com/processing-js-vs-p5-js-whats-difference/">article</a> . </p><br><p>  Canvas is used for rendering, and p5.js supports working with sound and video.  P5.js includes a set of objects, functions, constants with which you can create arbitrary forms.  The whole range of p5.js features can be found in the directory on the <a href="http://p5js.org/reference/">official site</a> . </p><a name="habracut"></a><br><p>  P5 setup () is executed once the project is loaded, so this is the ideal place to initialize.  You can connect the library from the server or CDN: </p><br><pre><code class="javascript hljs">&lt;script src=<span class="hljs-string"><span class="hljs-string">"../p5.min.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script src=<span class="hljs-string"><span class="hljs-string">"//cdn.jsdelivr.net/p5.js/0.0.0/p5.min.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  Let's create our first project on p5.js.  Our goal is to create a drawing tool that transforms a simple image into an area of ‚Äã‚Äãanimated stars.  To begin with, we define several global variables and write setup ().  Each individual graphic work in p5.js is called a ‚Äúsketch‚Äù, and each sketch consists of at least two functions ‚Äî setup and draw. </p><br><p>  You can upload files here. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hintImage, skyImage, stars = []; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{... }</code> </pre><br><p>  Inside our setup () function, we will create a canvas and hide the mouse cursor so that we can draw from ourselves.  P5 adds an outline around the default form, in our case, we need to disable the lines. </p><br><pre> <code class="javascript hljs">createCanvas(<span class="hljs-number"><span class="hljs-number">800</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>); noCursor(); noStroke();</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/e6c/e1f/830/e6ce1f8302328cd43001f382005e9c29.jpg" alt="image"><br><br><p>  Next, we upload two images.  One will serve as a background - in our case, the scene of the night sky.  Another is the ‚Äúhint‚Äù image.  The idea is to put most of the stars on the black pixels of our hint image to recreate the background scene design.  These images are fairly easy to create using the p5 drawing tools, but for brevity, we will use static images. </p><br><pre> <code class="javascript hljs">hintImage = loadImage(<span class="hljs-string"><span class="hljs-string">"//bit.ly/hintImage"</span></span>); skyImage = loadImage(<span class="hljs-string"><span class="hljs-string">"//bit.ly/skyImage"</span></span>);</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/afe/848/0ce/afe8480ce590e05023472f7f7cb3c631.jpg" alt="image"><br><br><p>  Another key function is draw ().  It is called in a continuous loop, which is useful for animation. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{... }</code> </pre><br><p>  In the Draw function, our first task is to fill the canvas with a background image.  P5 does not clear the canvas between draw () calls automatically, so we have to do it every frame, because in the end we get strange accumulation effects.  To place the loaded image on the canvas, use the image () function and give it the x and y coordinates to determine the location. </p><br><pre> <code class="javascript hljs">image(skyImage, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br><p>  Next, we capture the current location of the mouse and save it as p5.Vector using createVector ().  This object includes convenient functions for working with points in space, but we will mainly use it as a container. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> position = createVector(mouseX, mouseY);</code> </pre><br><p>  Using the newly saved mouse position, we can draw our cursor.  We set the cursor color using fill (), passing in the RGB values ‚Äã‚Äãand will use ellipse () to draw a circle at the mouse. </p><br><pre> <code class="javascript hljs">fill(<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">192</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); ellipse(position.x, position.y, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>);</code> </pre><br><p>  Using mouseIsPressed, we will make new stars be drawn while the mouse is being clamped.  While gripping the mouse, we need to calculate a good place for the next star.  We do this with a special function called findPixel (), which we will define later. </p><br><p>  As soon as we have a signal, we will create a new copy of the Star object and press it to the end of our stellar array.  And if the total number of stars exceeds 2000, we will begin to throw away the oldest of them. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mouseIsPressed) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> target = findPixel(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> star = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Star(position, target); stars.push(star); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stars.length &gt; <span class="hljs-number"><span class="hljs-number">2000</span></span>) stars.shift(); }</code> </pre><br><p>  At the end, we go through our array of stars and call update () and draw () on each of them.  We will look at these methods later. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; stars.length; i++) { stars[i].update(); stars[i].draw(); }</code> </pre><br><p>  Now setup () and draw () are in place, and we will work on auxiliary functions and objects.  First, we will define a function that finds a place for each new star.  All we have to do is check the random pixels in our image using get () to see if they are black or white. </p><br><p>  In fact, we should only look at the value of red, since in both cases the RGB values ‚Äã‚Äãmatch. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findPixel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x, y; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">15</span></span>; i++) { x = floor(random(hintImage.width)); y = floor(random(hintImage.height)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (red(hintImage.get(x,y)) &lt; <span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> createVector(x,y); }</code> </pre><br><p>  Now we need a reusable container that stores information about each star, and will also update and draw them.  In JavaScript, there is no classic way to create classes in the traditional sense of the word, but we can get the same result by defining a function and setting it up for our own needs. </p><br><p>  Each star has several properties (initial position, final location and diameter randomly generated), we define them in the ‚Äúconstructor function‚Äù, which is called for each new star created in our drawing cycle. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Star</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">position, target</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position = position; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target = target; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.diameter = random(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>); }</code> </pre><br><p>  Next, we will add an update () method for the Star function, which will use p5.Vector lerp () to calculate the new position between the current and target positions of the star.  In this case, we move at 4% of the remaining distance at each iteration. </p><br><pre> <code class="javascript hljs">Star.prototype.update = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position = p5.Vector.lerp( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target, <span class="hljs-number"><span class="hljs-number">0.04</span></span> ); };</code> </pre><br><p>  And finally, the draw () method, which draws a star on the canvas.  Once again, we use fill () and ellipse (), although this time we call fill () with an alpha value for transparency. </p><br><p>  To give stars a spark, the alpha value is determined using the noise () function.  This returns the Perlin noise value for the specified coordinates, that is, you get a smooth, random number sequence.  In the third parameter, we enter a value based on time; with it, the noise will be animated for some time. </p><br><pre> <code class="javascript hljs">Star.prototype.draw = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> alpha = noise( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target.x, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target.y, millis()/<span class="hljs-number"><span class="hljs-number">1000.0</span></span> ); fill(<span class="hljs-number"><span class="hljs-number">255</span></span>, alpha * <span class="hljs-number"><span class="hljs-number">255</span></span>); ellipse( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position.x, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position.y, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.diameter, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.diameter ); };</code> </pre><br><p>  This is what we ended up with: </p><br><img src="http://eugenecozac.com/p5/3.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  With this, the work on our first sketch is finished. </p><br><p>  Another good example of working with p5.js can be viewed in this <a href="https://www.livecoding.tv/hanswillem/videos/4ob6A-making-a-wallstreet-crash-synthesizer-in-p5js-7">video</a> . </p><br><p>  Reference material: </p><br><ul><li>  <a href="http://processing.org/reference/">Processing</a> </li><li>  <a href="http://processingjs.org/reference/">Processing.js</a> </li><li>  <a href="http://p5js.org/reference/">P5.js</a> </li></ul><br><p>  In conclusion, p5.js was a good discovery for me, and I hope that all my research helped me learn more about p5.js, and my first test project will be a good example for getting familiar with this JS framework. </p></div><p>Source: <a href="https://habr.com/ru/post/308986/">https://habr.com/ru/post/308986/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../308976/index.html">A gift for September 1 to all fans of digital circuitry and computer architecture</a></li>
<li><a href="../308978/index.html">Sort a huge file with an array with a known data dictionary</a></li>
<li><a href="../308980/index.html">Input lag during rendering and how to win</a></li>
<li><a href="../308982/index.html">Sorry, we are launching a new product.</a></li>
<li><a href="../308984/index.html">Everyone will die, and I will stay: replication and disaster recovery to the cloud using Veeam Cloud Connect Replication</a></li>
<li><a href="../308988/index.html">Go to 2FA (Two-Factor Authentication for ASA SSL VPN)</a></li>
<li><a href="../308990/index.html">Intel Software Conference 2016. September, Moscow, St. Petersburg</a></li>
<li><a href="../308992/index.html">The era of ‚ÄúPost-Let's Encrypt‚Äù. Who still needs to pay for SSL certificates?</a></li>
<li><a href="../308994/index.html">Baidu has published the PaddlePaddle depth learning toolkit demo.</a></li>
<li><a href="../308996/index.html">TargetSummit Moscow 2016 in a week</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>