<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>I was just obliged to check the project ICQ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I can not get past the open source messenger ICQ. This is a cult project, and when the source codes appeared on the GitHub website, the question, when...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>I was just obliged to check the project ICQ</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/da3/270/2d2/da32702d2deef86f282e1d32bf46208b.png" alt="PVS-Stusiop and ICQ" align="left">  I can not get past the open source messenger ICQ.  This is a cult project, and when the source codes appeared on the GitHub website, the question, when we check it with PVS-Studio, became just a matter of time.  Of course, we have many other interesting projects that are awaiting verification.  For example, we recently checked out GCC, GDB, Mono.  Now, finally, it came to ICQ. <br><br><h2>  ICQ </h2><br>  <a href="https://icq.com/">ICQ</a> (from English I seek you) is a centralized instant messaging service, currently owned by the Mail.ru Group investment fund.  The number of ICQ users is decreasing, but still this application is extremely popular and widely known among the IT community. <br><br>  ICQ is a small project by the standards of programmers.  I counted in it 165 thousand lines of code.  For comparison, the bare core of the PVS-Studio analyzer for analyzing C ++ code is implemented using 206 thousand lines of code.  The bare C ++ analyzer core is definitely a small project. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Of the interesting is a small percentage of comments.  SourceMonitor's utility claims that in the ICQ source code only 1.7% of the lines are comments. <br><br>  ICQ sources are available for download on github: <a href="https://github.com/mailru/icqdesktop">https://github.com/mailru/icqdesktop</a> . <br><a name="habracut"></a><br><h2>  Check </h2><br>  I naturally analyzed the code with the help of the <a href="http://www.viva64.com/ru/pvs-studio/">PVS-Studio</a> code analyzer.  At first, I wanted to try checking ICQ in Linux to demonstrate the capabilities of the new version of the PVS-Studio for Linux analyzer.  But the temptation to simply open the <i>icq.sln</i> project using Visual Studio was too great.  I succumbed to this temptation and my laziness, so today there will be no stories about Linux. <br><br>  The analyzer issued only 48 first-level warnings and 29 second-level warnings.  That's not a lot.  Apparently, the small size of the project and the fact that the code is written with high quality affects.  I think a huge number of users have an effect on good quality, thanks to which most of the shortcomings have been eliminated.  Nevertheless, I wrote out some errors that I want to share with readers.  Perhaps some other analyzer warnings also reveal errors, but it is difficult for me to judge this.  I choose the most simple and understandable code fragments to me. <br><br>  <b>The number of false positives.</b>  Often they ask a question about the percentage of false positives, and we try to give an answer when we can understand how things are.  We are not trying to hide something, but when we have a big project in front of us, it‚Äôs a difficult and ungrateful job to give an assessment. <br><br>  In this article I wrote out 19 warnings, and, apparently, they all indicate errors.  Perhaps, in fact, the analyzer found more errors.  For example, the analyzer issued 33 warnings that not all class members are initialized in the constructor.  Some of these warnings may indicate real errors, but I didn‚Äôt deal with them.  I am not familiar with the project and will spend too much time trying to understand whether a non-initialized member is a mistake or not.  Therefore, for the sake of simplicity, let's assume that there are 19 real errors. <br><br>  In total, the analyzer issued 77 warnings (level 1 and 2).  Of these, at least 19 indicate real errors. This means that the percentage of false positives is 75%.  This is, of course, not perfect, but a good result.  Every 4th analyzer message revealed an error in the code. <br><br><h3>  Insidious switch </h3><br>  Let's start with the classic error known to all C and C ++ programmers.  I think it was done by each of us.  This is a forgotten <i>break</i> <i>statement</i> inside a <i>switch</i> block. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> core::im_container::fromInternalProxySettings2Voip(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (proxySettings.proxy_type_) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: voipProxySettings.type = VoipProxySettings::kProxyType_Http; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>: voipProxySettings.type = VoipProxySettings::kProxyType_Socks4; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: voipProxySettings.type = VoipProxySettings::kProxyType_Socks5; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>: voipProxySettings.type = VoipProxySettings::kProxyType_Socks4a; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: voipProxySettings.type = VoipProxySettings::kProxyType_None; } .... }</code> </pre> <br>  The PVS-Studio analyzer generates several warnings of the same type here, but I will give only one of them in the article: <a href="http://www.viva64.com/ru/d/0108/">V519</a> The 'voipProxySettings.type' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 171, 172. core im_container.cpp 172 <br><br>  In the process of writing code here, we completely forgot about <i>break</i> .  Regardless of the value of the <i>proxySettings.proxy_type_</i> variable, the result will always be assignment: <br><br><pre> <code class="cpp hljs">voipProxySettings.type = VoipProxySettings::kProxyType_None;</code> </pre> <br>  <b>Potential null pointer dereference</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">QPixmap* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnserializeAvatar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(core::coll_helper* helper)</span></span></span><span class="hljs-function"> </span></span>{ .... core::istream* stream = helper-&gt;get_value_as_stream(<span class="hljs-string"><span class="hljs-string">"avatar"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> size = stream-&gt;size(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stream) { result-&gt;loadFromData(stream-&gt;read(size), size); stream-&gt;reset(); } .... }</code> </pre> <br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0205/">warning</a> : <a href="http://www.viva64.com/ru/d/0205/">V595</a> The 'stream' pointer was used before it was verified against nullptr.  Check lines: 62, 63. gui contact.cpp 62 <br><br>  The <i>if (stream)</i> check indicates that the <i>stream</i> pointer may be zero.  If it happens that this pointer really will have a zero value, then there will be a confusion.  The fact is that even before checking the pointer is used in the expression <i>stream-&gt; size ()</i> .  There will be a dereferencing of the null pointer. <br><br>  In the ICQ code, the analyzer found several more similar code sections.  I will not describe them in order not to increase the size of the article.  I will list only the warnings themselves: <br><br><ul><li>  V595 The 'stream' pointer was used against it.  Check lines: 1315, 1316. core im_container.cpp 1315 </li><li>  V595 The 'core_connector_' pointer was used before it was verified against nullptr.  Check lines: 279, 285. gui core_dispatcher.cpp 279 </li><li>  V595 The 'Shadow_' pointer was used before it was counted against nullptr.  Check lines: 625, 628. gui mainwindow.cpp 625 </li><li>  V595 The 'chatMembersModel_' pointer was verified against nullptr.  Check lines: 793, 796. gui menupage.cpp 793 </li></ul><br><h3>  Linux programmer detected </h3><br>  Most likely, the following code fragment was written by a Linux programmer, and this code worked for him.  However, if this code is compiled in Visual C ++, it will be incorrect. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">receive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* _message, ....)</span></span></span><span class="hljs-function"> override </span></span>{ wprintf(<span class="hljs-string"><span class="hljs-string">L"receive message = %s\r\n"</span></span>, _message); .... }</code> </pre> <br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0176/">warning</a> : <a href="http://www.viva64.com/ru/d/0176/">V576</a> Incorrect format.  Consider the second argument of the wprintf function.  Wchar_t type symbols is expected.  coretest coretest.cpp 50 <br><br>  Visual C ++ has an unpleasant feature that it interprets non-standard line format for printing wide characters.  In Visual C ++, it is assumed that% s is intended to print a string of type <i>const wchar_t *</i> .  Therefore, from the point of view of Visual C ++, the code is correct: <br><br><pre> <code class="cpp hljs">wprintf(<span class="hljs-string"><span class="hljs-string">L"receive message = %S\r\n"</span></span>, _message);</code> </pre> <br>  Beginning with Visual Studio 2015, this solution is proposed to write portable code.  For compatibility with ISO C (C99), you should specify the <i>_CRT_STDIO_ISO_WIDE_SPECIFIERS</i> macro to the preprocessor. <br><br>  In this case, the code: <br><br><pre> <code class="cpp hljs">wprintf(<span class="hljs-string"><span class="hljs-string">L"receive message = %s\r\n"</span></span>, _message);</code> </pre> <br>  is correct.  The analyzer knows about <i>_CRT_STDIO_ISO_WIDE_SPECIFIERS</i> and takes it into account when analyzing. <br><br>  By the way, if you <i>enable</i> ISO C compatibility mode (the <i>_CRT_STDIO_ISO_WIDE_SPECIFIERS</i> macro is <i>declared</i> ), you can return the old cast in certain places using the <i>% Ts</i> format specifier. <br><br>  This whole story with wide characters is quite confusing.  To better understand the issue, we suggest to get acquainted with the following links: <br><br><ul><li>  <a href="https://bugzilla.mozilla.org/show_bug.cgi%3Fid%3D1121290">Bug 1121290 - distinguish specifying family of functions</a> </li><li>  <a href="https://connect.microsoft.com/VisualStudio/Feedback/Details/1039772">MBCS to Unicode conversion in swprintf</a> </li><li>  <a href="http://stackoverflow.com/questions/10000723/visual-studio-swprintf-is-making-all-my-s-formatters-want-wchar-t-instead-of">Visual Studio swprintf is making all my format s formatters want wchar_t * instead of char *</a> </li></ul><br>  <b>A typo in the condition</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> core::im_container::on_voip_call_message(....) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == <span class="hljs-string"><span class="hljs-string">"update"</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == <span class="hljs-string"><span class="hljs-string">"voip_set_window_offsets"</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == <span class="hljs-string"><span class="hljs-string">"voip_reset"</span></span>) { .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">"audio_playback_mute"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> mode = _params.get_value_as_string(<span class="hljs-string"><span class="hljs-string">"mute"</span></span>); im-&gt;on_voip_set_mute(mode == <span class="hljs-string"><span class="hljs-string">"on"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { assert(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); } }</code> </pre> <br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0137/">warning</a> : <a href="http://www.viva64.com/ru/d/0137/">V547</a> Expression '"audio_playback_mute"' is always true.  core im_container.cpp 329 <br><br>  As I understand it, in the last condition you forgot to write <i>type ==</i> .  Error, I think, is not critical, since in fact all variants of the <i>type</i> value are considered.  The programmer does not assume that you can get into the else-branch and wrote <i>assert (false)</i> in it.  However, this code is still incorrect, and it was worth it to show the reader. <br><br>  <b>Strange comparisons</b> <br><br><pre> <code class="cpp hljs">.... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _actual_vol; .... <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Ui::VolumeControl::_updateSlider() { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_audioPlaybackDeviceMuted || _actual_vol &lt;= <span class="hljs-number"><span class="hljs-number">0.0001f</span></span>) { .... }</code> </pre> <br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0308/">warning</a> : <a href="http://www.viva64.com/ru/d/0308/">V674</a> The '0.0001f' literal of the 'float' type is compared to the value of the 'int' type.  Consider inspecting the '_actual_vol &lt;= 0.0001f' expression.  gui videopanel.cpp 190 <br><br>  The <i>_actual_vol</i> variable is an integer type variable, so there is no point in comparing it with the constant <i>0.0001f</i> .  There is some kind of mistake.  Perhaps you need to compare some other variable. <br><br>  Nearby there are several more strange comparisons: <br><br><ul><li>  V674 The '0.0001f' literal of the 'float' type is compared to a value of the 'int' type.  Consider inspecting the '_actual_vol &lt;= 0.0001f' expression.  gui videopanel.cpp 196 </li><li>  V674 The '0.0001f' literal of the 'float' type is compared to a value of the 'int' type.  Consider inspecting the '_actual_vol &lt;= 0.0001f' expression.  gui videopanel.cpp 224 </li><li>  V674 The '0.0001f' literal of the 'float' type is compared to a value of the 'int' type.  Consider inspecting the '_actual_vol &lt;= 0.0001f' expression.  gui videopanel.cpp 226 </li><li>  V674 The '0.0001f' literal of the 'float' type is compared to a value of the 'int' type.  Consider inspecting the '_actual_vol &lt;= 0.0001f' expression.  gui videopanel.cpp 246 </li><li>  V674 The '0.0001f' literal of the 'float' type is compared to a value of the 'int' type.  Consider inspecting the '_actual_vol &lt;= 0.0001f' expression.  gui videopanel.cpp 248 </li></ul><br><h3>  Loss of accuracy </h3><br>  Often write expressions like <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> A = <span class="hljs-number"><span class="hljs-number">5</span></span> / <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre> <br>  expecting to get <i>2.5f</i> in variable <i>A.</i>  At the same time, they forget that integer division actually occurs and the result will be the number <i>2.0f</i> .  We see a similar situation in the ICQ code: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QSize</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">width</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">height</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span></span>; .... }; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> BackgroundWidget::paintEvent(QPaintEvent *_e) { .... QSize pixmapSize = pixmapToDraw_.size(); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> yOffset = -(pixmapSize.height() - currentSize_.height()) / <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> xOffset = -(pixmapSize.width() - currentSize_.width()) / <span class="hljs-number"><span class="hljs-number">2</span></span>; .... }</code> </pre> <br>  Warnings: <br><br><ul><li>  <a href="http://www.viva64.com/ru/d/0254/">V636</a> The expression was an implicitly cast from 'int' type to 'float' type.  Consider using a fractional part.  An example: double A = (double) (X) / Y ;.  gui backgroundwidget.cpp 28 <br><br></li><li>  V636 The expression was an implicitly cast from 'int' type to 'float' type.  Consider using a fractional part.  An example: double A = (double) (X) / Y ;.  gui backgroundwidget.cpp 29 </li></ul><br>  Such defects lead to the fact that somewhere an image looks imperfect and shifted by 1 pixel. <br><br>  A couple more warnings: <br><br><ul><li>  V636 The '- (height - currentSize_.height ()) / 2' expression was implicitly cast from 'int' type to 'float' type.  Consider using a fractional part.  An example: double A = (double) (X) / Y ;.  gui backgroundwidget.cpp 42 <br><br></li><li>  V636 The '- (width - currentSize_.width ()) / 2' expression was implicitly cast from 'int' type to 'float' type.  Consider using a fractional part.  An example: double A = (double) (X) / Y ;.  gui backgroundwidget.cpp 49 </li></ul><br>  <b>And some more suspicious code</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> base64::base64_decode(<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *source, <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> length, <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *dst) { <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> cursor =<span class="hljs-number"><span class="hljs-number">0xFF00FF00</span></span>, temp =<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>,size =<span class="hljs-number"><span class="hljs-number">0</span></span>; cursor = <span class="hljs-number"><span class="hljs-number">0</span></span>; .... }</code> </pre> <br>  PVS-Studio warning: V519 The 'cursor' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 51, 53. core hmac_sha_base64.cpp 53 <br><br>  What is suspicious here is that first we assign the variable <i>cursor the</i> value <i>0xFF00FF00</i> , and then immediately assign the value <i>0</i> .  I'm not saying that this code exactly contains an error.  But agree that this is strange, and the text of the program should be changed. <br><br>  Finally, another piece of strange code: <br><br><pre> <code class="cpp hljs">QSize ContactListItemDelegate::sizeHint(....) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!membersModel) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (membersModel-&gt;is_short_view_) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> QSize(width, ContactList::ContactItemHeight()); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> QSize(width, ContactList::ContactItemHeight()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> QSize(width, ContactList::ContactItemHeight()); }</code> </pre> <br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0112/">warning</a> : <a href="http://www.viva64.com/ru/d/0112/">V523</a> The 'then' statement is equivalent to the 'else' statement.  contactlistitemdelegate.cpp 148 <br><br>  Note that at the end of the function, all <i>return statements</i> return the same value.  This code can be shortened to: <br><br><pre> <code class="cpp hljs">QSize ContactListItemDelegate::sizeHint(....) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!membersModel) { .... } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> QSize(width, ContactList::ContactItemHeight()); }</code> </pre> <br>  As you can see, this code is redundant or contains some kind of error. <br><br><h2>  Conclusion </h2><br>  Today I decided not to repeat once again that the main value of static analysis in its regular use and so on.  For a change I will tell about several links which can interest the reader. <br><br><ol><li>  All programmers who use Twitter, I suggest to follow me: <a href="https://twitter.com/Code_Analysis">@Code_Analysis</a> .  I not only publish links to our articles, but in general I try to keep track of interesting materials on C ++ and programming in general.  And it seems to me that I often manage to provide the audience with interesting material.  Here is one of the latest <a href="https://twitter.com/Code_Analysis/status/775592229234761728">examples</a> . <br><br></li><li>  We got Instagram: <a href="https://www.instagram.com/pvsstudio/">pvsstudio</a> .  At a minimum, it will help interest students to do our practice and generally show potential employees that we have a creative team.  Well, the reader can also sign his wife / girlfriend on us, so that she, too, can be programmed, at least in this form :). <br><br></li><li>  Many people do not know how many well-known projects we have checked and that you can look through <a href="http://www.viva64.com/ru/inspections/">interesting articles</a> on this topic.  Examples of projects: GCC, MSBuild, CryEngine V, FreeBSD, Qt, LibreOffice, VirtualBox. </li></ol><br><div style="text-align:center;"> <a href="http://www.viva64.com/en/b/0434/"><img src="https://habrastorage.org/getpro/habr/post_images/35e/064/ddf/35e064ddf91f5d99b620384893909ff7.png"></a> </div><br>  If you want to share this article with an English-speaking audience, then please use the link to the translation: Andrey Karpov.  <a href="http://www.viva64.com/en/b/0434/">I just had to check the ICQ project</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Read the article and have a question?</b> <div class="spoiler_text">  Often our articles are asked the same questions.  We collected answers to them here: <a href="http://www.viva64.com/ru/a/0085/">Answers to questions from readers of articles about PVS-Studio, version 2015</a> .  Please review the list. <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/311648/">https://habr.com/ru/post/311648/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311636/index.html">Northern California court denied Oracle a petition for a new trial in a case against Google</a></li>
<li><a href="../311640/index.html">How to make toast and visualize IT systems at the same time</a></li>
<li><a href="../311642/index.html">What you need to know, be able to and understand, so as not to have problems finding a job as a pythonist</a></li>
<li><a href="../311644/index.html">Three nannies for ProLiant</a></li>
<li><a href="../311646/index.html">Windows Server 2016 in Azure Pack Infrastructure: Virtual Jobs in 10 Minutes</a></li>
<li><a href="../311650/index.html">How we updated the contact center of a large bank in 2 months: migration without jambs (almost)</a></li>
<li><a href="../311652/index.html">The book "Distributed Algorithms. Intuitive approach "</a></li>
<li><a href="../311654/index.html">What should not forget the developer</a></li>
<li><a href="../311656/index.html">Layout of responsive emails: Problems and solutions</a></li>
<li><a href="../311658/index.html">Selection of a DBMS for a mobile Delphi application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>