<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ascetic web: prototype flea market on go and js</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone, I want to share the result of thinking on the topic - what could be a modern web application. As an example, consider the design of a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ascetic web: prototype flea market on go and js</h1><div class="post__text post__text-html js-mediator-article"><p> <a href=""><img src="https://habrastorage.org/webt/jl/lq/qo/jllqqo3xn1mthylxxodb2-digfw.png" alt="screenshot"></a> </p><br><p>  Hello everyone, I want to share the result of thinking on the topic - what could be a modern web application.  As an example, consider the design of a bulletin board for comics.  In a sense, the product in question is designed for an audience of geeks and their sympathizers, which allows for freedom in the interface.  The technical component, on the contrary, requires attention to trifles. </p><br><p>  Truth be told, I do not understand anything in comics, but I like flea markets, especially in forum format, which were popular in zero.  Hence, the assumption (possibly false), from which the subsequent conclusions flow, only one - the main type of interaction with the application - viewing, secondary - placement of announcements and discussion. </p><br><p>  Our goal is to create a simple application, without <del>  technical know-how </del>  extra whistles, however, corresponding to modern realities.  Basic requirements that I would like to achieve: </p><a name="habracut"></a><br><ol><li><p>  Server part: </p><br><p>  a) Performs the functions of saving, validating, sending user data to the client <br>  b) The above operations consume an acceptable amount of resources (time, incl.) <br>  c) Application and data are protected from popular attack vectors. <br>  d) It has a simple API for third-party clients and inter-server communication. <br>  e) Cross-platform, simple deployment </p><br></li><li><p>  Client part: </p><br><p>  a) Provides the necessary functionality for creating and consuming content. <br>  b) The interface is convenient for regular use, the minimum way to any action, the maximum amount of data on the screen <br>  c) Out of communication with the server, all possible functions are available in this situation. <br>  d) The interface displays the current version of the status and content, without rebooting and waiting <br>  e) Restarting the application does not affect its state. <br>  e) If possible, reuse DOM elements and JS code <br>  g) We will not use third-party libraries and frameworks in runtime. <br>  h) Layout is semantic for accessibility, parsers, etc. <br>  i) Navigation through the main content is available using the URL and keyboard </p><br></li></ol><br><p>  In my opinion, the logical requirements, and most modern applications in varying degrees, meet these conditions.  Let's see what happens with us (link to source code and demo at the end of the post). </p><br><div class="spoiler">  <b class="spoiler_title">Warnings:</b> <div class="spoiler_text"><ul><li>  I would like to apologize to the authors of the images used in the demo without permissions, as well as Goess G. </li><li>  The author is not a real programmer, I do not advise using the code or techniques used in this project, if you do not know what you are doing. </li><li>  I apologize for the style of the code, it was possible to write more readable and obvious, but it is not fun.  A project for the soul and for a friend, as is as they say. </li><li>  I also apologize for the literacy rate, especially in the English text.  Years Speak Frome May Hart. </li><li>  The performance of the presented prototype was tested in [chromium 70;  linux x86_64;  1366x768], I will be very grateful to users of other platforms and devices for error messages. </li><li>  This is a prototype and a proposed topic for discussion - approaches and principles, I ask you to accompany all the criticism of the implementation and the aesthetic side with arguments. </li></ul></div></div><br><h2 id="server">  Server </h2><br><p>  The language for the server is golang.  Simple, fast language with excellent standard library and documentation ... a bit annoying.  The initial choice fell on elixir / erlang, but since I already knew go (relatively), it was decided not to complicate (and the necessary packages were only for go). </p><br><p>  The use of web frameworks in the go-community is not encouraged (justifiably, we must admit), we choose a compromise and use <a href="https://github.com/labstack/echo">labstack / echo microframe</a> , thereby reducing the amount of routine and, it seems to me, not much losing in performance. </p><br><p>  We use <a href="http://github.com/tidwall/buntdb">tidwall / buntdb</a> as the database.  Firstly, the embedded solution is more convenient and reduces overhead, secondly in-memory + key / value - <del>  fashionable, stylish </del>  fast and no need for cache.  We store and give data in JSON, validating only when changed. </p><br><p>  On the second generation i3, the built-in logger shows the execution time for different requests from 0.5 to 10 ms.  Running wrk on the same machine also shows sufficient results for our purposes: </p><br><pre><code class="plaintext hljs">‚ûú comico git:(master) wrk -t2 -c500 -d60s http://localhost:9001/pub/mtimes Running 1m test @ http://localhost:9001/pub/mtimes 2 threads and 500 connections Thread Stats Avg Stdev Max +/- Stdev Latency 20.74ms 16.68ms 236.16ms 72.69% Req/Sec 13.19k 627.43 15.62k 73.58% 1575522 requests in 1.00m, 449.26MB read Requests/sec: 26231.85 Transfer/sec: 7.48MB</code> </pre> <br><pre> <code class="plaintext hljs">‚ûú comico git:(master) wrk -t2 -c500 -d60s http://localhost:9001/pub/goods Running 1m test @ http://localhost:9001/pub/goods 2 threads and 500 connections Thread Stats Avg Stdev Max +/- Stdev Latency 61.79ms 65.96ms 643.73ms 86.48% Req/Sec 5.26k 705.24 7.88k 70.31% 628215 requests in 1.00m, 8.44GB read Requests/sec: 10454.44 Transfer/sec: 143.89MB</code> </pre> <br><h3 id="struktura-proekta">  Project structure </h3><br><p>  The <u>comico / model</u> package is divided into three files: <br>  model.go - contains a description of data types and common functions: create / update (buntdb does not distinguish between these operations and the presence of a record we check manually), validation, deletion, getting one record and getting a list; <br>  rules.go - contains validation rules for a specific type and logging function; <br>  files.go - work with images. <br>  The Mtimes type stores data on the last change of other types in the database, thus informing the client what data has changed. </p><br><p>  The <u>comico / bd</u> package contains generalized functions for interacting with the database: creating, deleting, selecting, etc. Buntdb saves all changes to the file (in our case once per second), in text format, which is convenient in some situations.  The database file is not edited; changes in case of success are added to the end of the transaction.  All my attempts to violate the integrity of the data were unsuccessful, in the worst case, the changes are lost in the last second. <br>  In our implementation, each type corresponds to a separate database in a separate file (except for logs that are stored exclusively in memory and are reset when reset).  This is largely due to the convenience of backup and administration, a small plus - the transaction opened for editing blocks access to only one type of data. <br>  This package can be easily replaced by a similar one using another database, SQL for example.  To do this, simply implement the following functions: </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Exist</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key, val </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, pattern </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(str </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, err error)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadOne</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(str </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, err error)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Renew</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err error, newId </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span></code> </pre> <br><p>  The <u>comico / cnst package</u> contains some constants necessary in all packages (data types, action types, user types).  In addition, this package contains all human-readable messages with which our server will respond to the outside world. </p><br><p>  The <u>comico / server</u> package contains routing information.  Also, just a couple of lines (thanks to the Echo developers), authorization using JWT, CORS headers, CSP headers, logger, static distribution, gzip, ACME auto-certificate, etc. are configured. </p><br><h3 id="tochki-vhoda-api">  API entry points </h3><br><table><thead><tr><th>  URL </th><th>  Data </th><th>  Description </th></tr></thead><tbody><tr><td>  get / pub / (goods | posts | users | cmnts | files) </td><td>  - </td><td>  Getting an array of current ads, posts, users, comments, files </td></tr><tr><td>  get / pub / mtimes </td><td>  - </td><td>  Getting the last modified time for each data type </td></tr><tr><td>  post / pub / login </td><td>  {id *: login, pass *: password} </td><td>  Returns the JWT token and its duration </td></tr><tr><td>  post / pub / pass </td><td>  {id *, pass *} </td><td>  Creates a new user if the data is correct. </td></tr><tr><td>  put / api / pass </td><td>  {id *, pass *} </td><td>  Password update </td></tr><tr><td>  post | put / api / goods </td><td>  {id *, auth *, title *, type *, price *, text *, images: [], Table: {key: value}} </td><td>  Create / Update Advertisement </td></tr><tr><td>  post | put / api / posts </td><td>  {id *, auth *, title *, type *, text *} </td><td>  Create / update forum post </td></tr><tr><td>  post | put / api / users </td><td>  {id *, title, type, status, scribes: [], ignores: [], Table: {key: value}} </td><td>  Create / update user </td></tr><tr><td>  post / api / cmnts </td><td>  {id *, auth *, owner *, type *, to, text *} </td><td>  Creating a comment </td></tr><tr><td>  delete / api / (goods | posts | users | cmnts) / [id] </td><td>  - </td><td>  Deletes an entry with id id </td></tr><tr><td>  get / api / activity </td><td>  - </td><td>  Updates the time of the last reading of incoming comments for the current user. </td></tr><tr><td>  get / api / (subscribe | ignore) / [tag] </td><td>  - </td><td>  Adds or deletes (if available) the user tag in the list of subscriptions / ignore </td></tr><tr><td>  post / api / upload / (goods | users) </td><td>  multipart (name, file) </td><td>  Uploads a user's photo / avatar </td></tr></tbody></table><br><p>  * - required fields <br>  api - requires authorization, pub - no </p><br><p>  When a get request does not match the above, the server searches for a file in the static directory (for example, / img / * - images, /index.html - client). <br>  Any point api with success returns a response code of 200, with an error of 400 or 404 and a short message if necessary. <br>  Access rights are simple: creating a record is available to an authorized user, editing the author and moderator, the admin can edit and assign moderators. <br>  The API is equipped with the simplest anti-vandal: actions are logged along with the user‚Äôs id and IP, and, in case of frequent access, an error is returned asking to wait a bit (useful against password guessing). </p><br><h2 id="klient">  Customer </h2><br><p>  I like the concept of a reactive web, I think that most modern sites / applications should be done either within the framework of this concept, or completely static.  On the other hand, an uncomplicated website with megabytes of JS-code can not fail.  In my opinion, this (and not only) problem can be solved by Svelte.  This framework (or rather, the language for building reactive interfaces) is not inferior to the necessary functionality of the same Vue, but has an undeniable advantage - the components are compiled into vanilla JS, which reduces both the size of the bundle and the load on the virtual machine (bundle.min.js.gz our flea market is modest, by today's standards, 24KB).  Details you can learn from the official <a href="https://svelte.technology/guide">documentation</a> . </p><br><p>  We choose SvelteJS for the client part of our flea market, we wish Rich Harris all the best and further development of the project! </p><br><p>  PS I do not want to offend anyone.  I am sure that for each specialist and each project their own toolkit is suitable. </p><br><h3 id="klient--dannye">  Customer / Data </h3><br><h4 id="url">  URL </h4><br><p>  Use for navigation.  We will not imitate a multi-page document; instead, we use page hash with query parameters.  For transitions, you can use the usual &lt;a&gt; without js. </p><br><p>  Sections correspond to data types: <u>/ # goods</u> , <u>/ # posts</u> , <u>/ # users</u> . <br>  Parameters <u>:? Id =</u> <em>entry_id</em> <u>,? Page =</u> <em>page_number</em> <u>,? Search =</u> <em>search_query</em> . </p><br><p>  A few examples: </p><br><ul><li>  <u>/ # posts? id = 1542309643 &amp; page = 999 &amp; search = {auth: anon}</u> - <em>posts</em> section, post id - <em>1542309643</em> , comments page - <em>999</em> , search query - <em>{auth: anon}</em> </li><li>  <u>/ # goods? page = 2 &amp; search = siddhartha</u> - <em>goods</em> section, section page - <em>2</em> , search query - <em>siddhartha</em> </li><li>  <u>/ # goods? search = wer {key: value} t</u> - the <em>goods</em> section, the search query - consists of searching for the substring <em>wert</em> in the header or ad text and substring <em>value</em> in the <em>key</em> property of the table part of the advertisement </li><li>  <u>/ # goods? search = {model: 100, display: 256}</u> - I think everything is clear by analogy </li></ul><br><p>  The parsing and url generation functions in our implementation look like this: </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'hashchange'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hash = location.hash.slice(<span class="hljs-number"><span class="hljs-number">1</span></span>).split(<span class="hljs-string"><span class="hljs-string">'?'</span></span>), result = {} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!hash[<span class="hljs-number"><span class="hljs-number">1</span></span>]) hash[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str</span></span></span><span class="hljs-function"> =&gt;</span></span> { str = str.split(<span class="hljs-string"><span class="hljs-string">'='</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!str[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp;&amp; !!str[<span class="hljs-number"><span class="hljs-number">1</span></span>]) result[<span class="hljs-built_in"><span class="hljs-built_in">decodeURI</span></span>(str[<span class="hljs-number"><span class="hljs-number">0</span></span>]).toLowerCase()] = <span class="hljs-built_in"><span class="hljs-built_in">decodeURI</span></span>(str[<span class="hljs-number"><span class="hljs-number">1</span></span>]).toLowerCase() }) result.type = hash[<span class="hljs-number"><span class="hljs-number">0</span></span>] || <span class="hljs-string"><span class="hljs-string">'goods'</span></span> store.set({ <span class="hljs-attr"><span class="hljs-attr">hash</span></span>: result }) }) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">goto</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ type, id, page, search }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { hash } = store.get(), args = <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>], query = [] <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-string"><span class="hljs-string">'id'</span></span>, <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'search'</span></span>).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = args[key] !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> ? args[key] : hash[key] || <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value !== <span class="hljs-literal"><span class="hljs-literal">null</span></span>) query.push(key + <span class="hljs-string"><span class="hljs-string">'='</span></span> + value) }) location.hash = (type || hash.type || <span class="hljs-string"><span class="hljs-string">'goods'</span></span>) + (!!query.length ? <span class="hljs-string"><span class="hljs-string">'?'</span></span> + query.join(<span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>) : <span class="hljs-string"><span class="hljs-string">''</span></span>) }</code> </pre> <br><h4 id="api">  API </h4><br><p>  For data exchange with the server we will use fetch api.  To download updated posts at short intervals, make a request to <em>/ pub / mtimes</em> , if the last modified time for any type is different from the local one, download the list of this type.  Yes, it was possible to implement update notification via SSE or WebSocket and incremental upload, but in this case we can do without it.  What we did: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GET</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">type</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(location.origin + <span class="hljs-string"><span class="hljs-string">'/pub/'</span></span> + type) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">ok</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> })) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type === <span class="hljs-string"><span class="hljs-string">'mtimes'</span></span>) store.set({ <span class="hljs-attr"><span class="hljs-attr">online</span></span>: response.ok }) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.ok ? <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> response.json() : [] } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkUpdate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">type, mtimes, updates = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> local = store.get()._mtimes, net = mtimes || <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> GET(<span class="hljs-string"><span class="hljs-string">'mtimes'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!net[type] || local[type] === net[type]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = updates[<span class="hljs-string"><span class="hljs-string">'_'</span></span> + type] = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> GET(type) local[type] = net[type]; updates._mtimes = local <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!value &amp;&amp; !!value.sort) store.set(updates) } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkUpdates</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> checkUpdates(), <span class="hljs-number"><span class="hljs-number">30000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mtimes = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> store.GET(<span class="hljs-string"><span class="hljs-string">'mtimes'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-string"><span class="hljs-string">'users'</span></span>, <span class="hljs-string"><span class="hljs-string">'goods'</span></span>, <span class="hljs-string"><span class="hljs-string">'posts'</span></span>, <span class="hljs-string"><span class="hljs-string">'cmnts'</span></span>, <span class="hljs-string"><span class="hljs-string">'files'</span></span>) .forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">type</span></span></span><span class="hljs-function"> =&gt;</span></span> checkUpdate(type, mtimes)) }</code> </pre> <br><p>  For filtering and pagination, we use Svelte computed properties based on navigation data.  The direction of the calculated values ‚Äã‚Äãis as follows: <strong>items</strong> (arrays of entries coming from the server) =&gt; <strong>ignoredItems</strong> (filtered entries based on the current user‚Äôs ignore list) =&gt; <strong>scribedItems</strong> (filters entries by the list of subscriptions, if this mode is activated) =&gt; <strong>curItem</strong> and <strong>curItems</strong> (calculates current entries depending on the section) =&gt; <strong>filteredItems</strong> (filters records depending on the search query, if there is one record - filters comments to it) =&gt; <strong>maxPage</strong> (calculates the number of pages at the rate of 12 records / comments per page) =&gt; <strong>pagedItem</strong> (returns the final array h  entries / comments based on the current page number). </p><br><p>  Comments and images ( <strong>comments</strong> and <strong>_images</strong> ) are calculated separately, grouped by type and owner-record. </p><br><p>  Calculations happen automatically and only when the related data changes, intermediate data are constantly in memory.  In this regard, we make an unpleasant conclusion - for a large amount of information and / or its frequent updating a large amount of resources can be spent. </p><br><h4 id="cache">  Cache </h4><br><p>  According to the decision to make an offline application, we implement the storage of records and some aspects of the state in localStorage, image files in CacheStorage.  Working with localStorage is extremely simple, agree that the properties with the "_" prefix are automatically saved when changed and restored upon reboot.  Then our solution might look like this: </p><br><pre> <code class="javascript hljs">store.on(<span class="hljs-string"><span class="hljs-string">'state'</span></span>, ({ changed, current }) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(changed).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">prop</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!prop.indexOf(<span class="hljs-string"><span class="hljs-string">'_'</span></span>)) localStorage.setItem(prop, <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(current[prop])) }) }) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; localStorage.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> prop = localStorage.key(i) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(localStorage.getItem(prop) || <span class="hljs-string"><span class="hljs-string">'null'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!value &amp;&amp; !prop.indexOf(<span class="hljs-string"><span class="hljs-string">'_'</span></span>)) state[prop] = value } store.set(state) }</code> </pre> <br><p>  The files are a bit more complicated.  First of all, we will use the list of all actual files (with creation time) coming from the server.  When updating this list, we compare it with the old values, we place the new files in CacheStorage, the outdated ones are deleted from there: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheImages</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newFiles</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> oldFiles = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(localStorage.getItem(<span class="hljs-string"><span class="hljs-string">'_files'</span></span>) || <span class="hljs-string"><span class="hljs-string">'[]'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> cache = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> caches.open(<span class="hljs-string"><span class="hljs-string">'comico'</span></span>) oldFiles.forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">file</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!~newFiles.indexOf(file)) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [ id, type ] = file.split(<span class="hljs-string"><span class="hljs-string">':'</span></span>) cache.delete(<span class="hljs-string"><span class="hljs-string">`/img/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${type}</span></span></span><span class="hljs-string">_</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${id}</span></span></span><span class="hljs-string">_sm.jpg`</span></span>) }}) newFiles.forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">file</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!~oldFiles.indexOf(file)) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [ id, type ] = file.split(<span class="hljs-string"><span class="hljs-string">':'</span></span>), src = <span class="hljs-string"><span class="hljs-string">`/img/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${type}</span></span></span><span class="hljs-string">_</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${id}</span></span></span><span class="hljs-string">_sm.jpg`</span></span> cache.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Request(src, { <span class="hljs-attr"><span class="hljs-attr">cache</span></span>: <span class="hljs-string"><span class="hljs-string">'no-cache'</span></span> })) }}) }</code> </pre> <br><p>  Then you need to override the behavior of fetch so that the file is taken from CacheStorage without a connection to the server.  To do this, you have to use the ServiceWorker.  At the same time, we will configure saving the cache of other files to work out of communication with the server: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CACHE = <span class="hljs-string"><span class="hljs-string">'comico'</span></span>, FILES = [ <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-string"><span class="hljs-string">'/bundle.css'</span></span>, <span class="hljs-string"><span class="hljs-string">'/bundle.js'</span></span> ] self.addEventListener(<span class="hljs-string"><span class="hljs-string">'install'</span></span>, (e) =&gt; { e.waitUntil(caches.open(CACHE).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cache</span></span></span><span class="hljs-function"> =&gt;</span></span> cache.addAll(FILES)) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> self.skipWaiting())) }) self.addEventListener(<span class="hljs-string"><span class="hljs-string">'fetch'</span></span>, (e) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> r = e.request <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (r.method !== <span class="hljs-string"><span class="hljs-string">'GET'</span></span> || !!~r.url.indexOf(<span class="hljs-string"><span class="hljs-string">'/pub/'</span></span>) || !!~r.url.indexOf(<span class="hljs-string"><span class="hljs-string">'/api/'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!~r.url.lastIndexOf(<span class="hljs-string"><span class="hljs-string">'_sm.jpg'</span></span>) &amp;&amp; e.request.cache !== <span class="hljs-string"><span class="hljs-string">'no-cache'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> e.respondWith(fromCache(r)) e.respondWith(toCache(r)) }) <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromCache</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">await</span></span> caches.open(CACHE)).match(request) || <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Response(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, { <span class="hljs-attr"><span class="hljs-attr">status</span></span>: <span class="hljs-number"><span class="hljs-number">404</span></span> }) } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toCache</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(request).catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> fromCache(request)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!response &amp;&amp; response.ok) (<span class="hljs-keyword"><span class="hljs-keyword">await</span></span> caches.open(CACHE)).put(request, response.clone()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response }</code> </pre> <br><p>  It looks a bit clumsy, but performs its functions. </p><br><h3 id="klient--interfeys">  Client / Interface </h3><br><p>  Component structure: <br>  index.html |  main.js <br>  == <u>header.html</u> - contains a logo, status bar, main menu, lower navigation menu, commenting form <br>  == <u>aside.html</u> - is a container for all modal components <br>  ==== <u>goodForm.html</u> - form for adding and editing ads <br>  ==== <u>userForm.html</u> - the form of editing the current user <br>  ====== <u>tableForm.html</u> - a fragment of the form for entering tabular data <br>  ==== <u>postForm.html</u> - form for the forum post <br>  ==== <u>login.html</u> - login / registration form <br>  ==== <u>activity.html</u> - displays comments addressed to the current user <br>  ==== <u>goodImage.html</u> - view the main and additional photo ads <br>  == <u>main.html</u> - the container for the main content <br>  ==== <u>goods.html</u> - a list card or a single ad <br>  ==== <u>users.html</u> - the same for users <br>  ==== <u>posts.html</u> - I think it is clear <br>  ==== <u>cmnts.html</u> - list of comments for the current record <br>  ====== <u>cmntsPager.html</u> - pagination for comments </p><br><ul><li>  In each component, we try to minimize the number of html tags. </li><li>  Classes are used only as an indicator of state. </li><li>  Similar functions are placed in the store (svelte store properties and methods can be used directly from the components by adding the prefix '$' to them). </li><li>  Most functions expect a user event or change of certain properties, manipulate the state data, save the result of their work back to the state, and end.  Thus, small coherence and extensibility of the code is achieved. </li><li>  For visible speed of transitions and other UI-events, we separate out possible manipulations with data occurring in the background and actions associated with the interface, which in turn uses the current result of the calculations, rearranging, if necessary, the rest of the work will be kindly performed by the framework. </li><li>  The data of the filled form is saved in localStorage for each input in order to prevent their loss. </li><li>  In all components, we use an immutable mode in which the property object is considered to be changed only when a new reference is received, regardless of changing fields, thus speeding up our applications a little, even if the code is slightly increased. </li></ul><br><h3 id="klient--upravlenie">  Client / Management </h3><br><p>  To control using the keyboard use the following combinations: <br>  <strong>Alt + s</strong> / <strong>Alt + a</strong> - toggles the page of records forward / backward; for one record it switches the page of comments. <br>  <strong>Alt + w</strong> / <strong>Alt + q</strong> - moves to the next / previous entry (if any), works in list mode, single entry and image viewing <br>  <strong>Alt + x</strong> / <strong>Alt + z</strong> - scrolls the page down / up.  In the image viewer mode, toggles the image forward / backward. <br>  <strong>Escape</strong> - closes the modal window, if open, returns to the list, if a single entry is open, cancels the search query in list mode <br>  <strong>Alt + c</strong> - focuses on the search field or enter a comment, depending on the current mode <br>  <strong>Alt + v</strong> - enables / disables photo viewing for a single ad. <br>  <strong>Alt + r</strong> - opens / closes the list of incoming comments for an authorized user. <br>  <strong>Alt + t</strong> - switches light / dark themes <br>  <strong>Alt + g</strong> - list of ads <br>  <strong>Alt + u</strong> - users <br>  <strong>Alt + p</strong> - forum <br>  I know that in many browsers these combinations are used by the browser itself, but for my chrome I couldn‚Äôt think of something more convenient.  I will be glad to your suggestions. </p><br><p>  In addition to the keyboard, of course, you can use the browser console.  For example, <em>store.goBack ()</em> , <em>store.nextPage ()</em> , <em>store.prevPage ()</em> , <em>store.nextItem ()</em> , <em>store.prevItem ()</em> , <em>store.search (stringValue)</em> , <em>store.checkUpdate ('goods' ||' users' || 'posts' ||' files' || 'cmnts')</em> - do what the name implies;  <em>store.get (). comments</em> and <em>store.get () ._ images</em> - returns grouped files and comments;  <em>store.get (). ignoredItems</em> and <em>store.get (). scribedItems</em> are lists of entries that you are ignoring and tracking.  A complete list of all intermediate and calculated data is available from <em>store.get ()</em> .  I don‚Äôt think that this can seriously be necessary for someone, but, for example, it seemed to me quite convenient to filter the records by user and delete from the console. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  On this familiarity with the project can be completed, more details can be found in the source code.  As a result, we have a fairly fast and compact application, with most validators, checkers for security, speed, availability, etc., it shows good results without targeted optimization. <br>  I would like to know the opinion of the community how justifiably used in the prototype approaches to the organization of applications, what could be the pitfalls, what would you have implemented in a fundamentally different way? <br>  Source code, sample installation instructions and demo by <a href="https://github.com/ddidwyll/comico">reference</a> (please <del>  to beat </del>  test under the Criminal Code of the Russian Federation). </p><br><p>  P.S.  A little mercantile in the end.  Tell me with this level really start programming for money?  If not, what to look for in the first place, if so, tell me where they are now looking for an interesting job on a similar stack.  Thank. </p><br><p>  Postpostcriptum  A little more about money and work.  How do you get such an idea: suppose a person is ready to work on an interesting project for any salary, however, data on tasks and their payment will be publicly available (accessibility is desirable and a code for assessing the quality of performance), if the payment is significantly lower than the market, the employer's competitors can offer a lot of money for performing their tasks, if higher - many performers will be able to offer their services at a lower price.  Would not such a scheme in some situations more optimally and fairly balance the market (IT)? </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/435908/">https://habr.com/ru/post/435908/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435898/index.html">What to think on the NALSD interview</a></li>
<li><a href="../435900/index.html">Encapsulate it</a></li>
<li><a href="../435902/index.html">It is not so easy to take and write SELECT, if the vendor does not allow ... but we still write</a></li>
<li><a href="../435904/index.html">AI translated brain activity to speech</a></li>
<li><a href="../435906/index.html">Pacemaker + DRBD (Dual primary) + ctdb cluster storage</a></li>
<li><a href="../435910/index.html">Why did BSD lose in the battle with GNU / Linux?</a></li>
<li><a href="../435912/index.html">The main problems of the development of modern interfaces</a></li>
<li><a href="../435914/index.html">Pack ASP.NET Core Applications with Docker</a></li>
<li><a href="../435916/index.html">Hacking VC, two-factor authentication will not save</a></li>
<li><a href="../435920/index.html">Developer Cookbook: DDD Recipes (Part 4, Structures)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>