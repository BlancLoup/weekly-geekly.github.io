<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Web telephony. Solution Overview</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will talk about what are the methods of implementing voice communications for web-projects . 
 The article is an overview and focuse...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Web telephony. Solution Overview</h1><div class="post__text post__text-html js-mediator-article"><img src="http://smages.com/i/7d/4b/7d4b54e019edee6b1930761be959a1e7.jpg" alt="Phone" align="left">  In this article I will talk about what are the methods of implementing voice communications for <strong>web-projects</strong> . <br>  The article is an overview and focused on a wide range of readers.  However, anyone will find all the necessary links to deepen the essence of the issue. <br><br>  <b>The following tasks will be considered:</b> <br><ol><li>  One to one voice communication between site users. </li><li>  Voice conference, that is, the conversation of more than 2 interlocutors. </li><li>  Calls to landlines and mobile phones from the browser. </li></ol>  I repeat and say that all problems are solved within the framework of the <strong>web environment</strong> .  The main condition: users do not need to install additional software, <strong>only the browser and Flash Player</strong> . <br><a name="habracut"></a><br><h2>  Introduction </h2><br>  First of all, it is worth understanding what technologies are at our disposal.  If you are realistic, then in fact the only option is to use Flash.  Yes, there are other technologies, but, unfortunately, they are all much less common.  While Flash is installed <a href="http://www.adobe.com/products/player_census/flashplayer/">at almost everyone</a> . <br><br>  What is good about Flash is convenient work with streaming audio-video.  There are two main methods of working with audio streams in Flash applications: <br><ul><li>  Using media server (media streaming server).  In this case, all voice traffic passes through the server.  The server can be <a href="http://www.adobe.com/ru/products/flashmediaserver/">Flash Media Server</a> or <a href="http://osflash.org/red5">Red5</a> (open source). <br>  <strong>Advantages:</strong> good traffic throughput (firewall and NAT is not a hindrance). <br>  <strong>Disadvantages:</strong> server load, longer response time, the ability to use only TCP. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </li><li>  New P2P-protocol <a href="http://en.wikipedia.org/wiki/Real_Time_Media_Flow_Protocol">RTMFP</a> , implemented in Flash Player 10. <br>  <strong>Advantages:</strong> built on the basis of the UDP protocol, good quality of communication, no load on the server. <br>  <strong>Disadvantages:</strong> poor passability through the firewall and NAT (about 60% of users), requires Flash Player 10 version. </li></ul>  The optimal solution today: dynamically determine the possibility of using the P2P protocol;  use it if possible, otherwise use the first option. <br>  There is also hope that in the near future, Flash servers will allow the use of the UDP protocol to communicate with client applications.  In this case, many of the shortcomings of the first solution will disappear.  Let me remind you that TCP protocol guarantees data delivery, but UDP does not.  For real-time voice traffic transmission, data accuracy is not required, guaranteed delivery time and resistance to periodic transmission channel failures are required.  That is why the UDP protocol is preferred in this case. <br><br>  Let us turn to more specific things. <br><br><h2>  One on one voice communication </h2><br>  From the point of view of the developer, the two options for implementing audio transmission (with and without relay through the server) are not very different.  In both cases, an external server is required.  However, in the case of P2P, the server performs only a supporting role in establishing a connection.  All voice traffic goes directly from client to client.  The server for establishing the P2P connection is called <a href="http://labs.adobe.com/technologies/stratus/">Stratus</a> .  Soon its functionality will be built into Flash Media Server (and, apparently, Red5).  Now the only option is to use the public beta service from Adobe. <br><br>  An excellent article on the use of the new P2P protocol is <a href="http://www.adobe.com/devnet/flashplayer/articles/rtmfp_stratus_app.html">here</a> . <br>  An example implementation is <a href="http://labs.adobe.com/technologies/stratus/samples/">here</a> . <br><br>  When using a relay server, the task is standard for the Flash environment.  What is in this case, that in the case of P2P, the main idea is that each of the interlocutors <strong>publishes the</strong> outgoing audio stream and <strong>subscribes</strong> to the incoming one.  Data is transmitted using the <a href="http://ru.wikipedia.org/wiki/RTMP">RTMP</a> protocol (RTMFP, in the case of P2P). <br><br>  One of the key problems in the implementation of one-on-one voice communication is the signaling of users about incoming calls.  If the user is the initiator of the call, he knows at what point he initiates the transmission and reception of voice traffic.  As for the user being called, it requires some way to notify him about it.  How to solve this problem is a question of a specific application. <br><ul><li>  <strong>Option 1.</strong> Use asynchronous requests that are performed periodically.  For example, 1 time per second.  The response to the request should contain a sign that there is an incoming call and it is necessary to make a decision whether to answer it.  Then, configure the incoming and outgoing audio streams. </li><li>  <strong>Option 2.</strong> <a href="http://en.wikipedia.org/wiki/Comet_%2528programming%2529">Comet-architecture</a> , when the client keeps a constant connection to the server and receives a response only when a certain event has occurred.  In this case, the incoming call. </li></ul>  Both options imply the use of server-side basic web development tools (for example, php).  Although, in principle, a media server can be adapted for this task.  On the client side, JavaScript or Flash can be used. <br>  In the case of one-to-one voice communication, it is sufficient to simply implement the scheme, which above was called the optimal one.  That is, use P2P when possible, otherwise - a media server. <br><br><h2>  Conference organization </h2><br>  When organizing conferences, almost nothing changes.  Only now all participants of the conference subscribe to the audio stream of any user at once. <br>  Again, it is possible to implement both through the server and using P2P.  But in this case, the probability that P2P will not function is higher for the simple reason that there are not two participants in the exchange, but more: it will not work for anyone. <br><br><h2>  Calls to landlines and mobile phones </h2><br>  Perhaps the most interesting topic of consideration.  To solve the problem, the <a href="http://ru.wikipedia.org/wiki/SIP">SIP-</a> gateway of any IP-telephony operator is used.  The scheme of work here is as follows: <br><ol><li>  Two-way audio data transfer is organized between the client Flash application and the media server using the <a href="http://ru.wikipedia.org/wiki/RTMP">RTMP</a> protocol. </li><li>  On the side of the media server, transcoding of voice traffic occurs.  That is, audio transcoding from one codec to another.  Flash supports two voice codecs: <a href="http://ru.wikipedia.org/wiki/Nellymoser">Nellymoser</a> and <a href="http://speex.org/">SPEEX</a> (from version 10). <br>  Also, the media server should be able to work with the SIP protocol stack. </li><li>  Thus, a bridge is built on the media server side: Flash Player &lt;-&gt; SIP. </li></ol>  <a href="http://code.google.com/p/red5phone/">Red5phone</a> is an open source project that implements the described scheme.  The project is rather raw, but is a good starting point. <br><br><h2>  Working examples </h2><br>  One-on-one voice communication using the P2P protocol is implemented in the <a href="http://online.vkontakte.ru/">VKontakte</a> social network application. Online, authored by me. <br>  A technical platform was also implemented for making calls from the application to landline and mobile phones via the SIP gateway.  However, the public access technology has not been launched. <br>  An example of the implementation of a bunch of Flash &lt;-&gt; SIP: <a href="http://www.flaphone.com/">flaphone project</a> . <br><br><h2>  Applications </h2><br>  The technologies described have a variety of uses.  For example, the use of the CMS system within the engine or the organization of the telephone support service on the company's website, online store. </div><p>Source: <a href="https://habr.com/ru/post/70885/">https://habr.com/ru/post/70885/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../70870/index.html">More free SMS in Mail.Ru Agent</a></li>
<li><a href="../70874/index.html">About habrarating</a></li>
<li><a href="../70878/index.html">How do (o, i) e house (e, i) e animals (o, s) do you have?</a></li>
<li><a href="../70881/index.html">Habratulz: now under FF 3.5+</a></li>
<li><a href="../70884/index.html">Automate database changes in .NET</a></li>
<li><a href="../70890/index.html">Habrarazvod?</a></li>
<li><a href="../70891/index.html">Fastening tabs</a></li>
<li><a href="../70893/index.html">A device that allows you to interact with a computer using physical objects</a></li>
<li><a href="../70894/index.html">Hello from the year 1988</a></li>
<li><a href="../70897/index.html">Brizzly.com is a great addition to twitter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>