<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Deployment your software for OS Inferno</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unfortunately, there is no built-in mechanism for distributing and installing additional software in OS Inferno . If you have written a module for Lim...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Deployment your software for OS Inferno</h1><div class="post__text post__text-html js-mediator-article">  Unfortunately, there is no built-in mechanism for distributing and installing additional software in <a href="http://code.google.com/p/inferno-os/">OS Inferno</a> .  If you have written a module for <a href="http://www.vitanuova.com/inferno/limbo.html">Limbo</a> or a full-fledged application, and you want to share it, then there are few distribution options: <br><ol><li>  just upload your files to any site, and let users manually install them to their system wherever and how </li><li> use the same mkfile / mkconfig files that are used by standard modules and applications in <code>/appl/</code> </li></ol><br>  As you understand, the first option is, in fact, not an option.  :) This is a return to the cave.  The second option is used, for example, for all software in <a href="http://www.ueber.net/code/">the mjl repository</a> .  But this approach also has unpleasant limitations caused by the fact that your files are simply copied to the system directories <code>/dis/</code> , <code>/module/</code> , etc. as a result.  (just like standard modules and applications from <code>/appl/</code> ): <br><ul><li>  if * nix is ‚Äã‚Äãused as the host OS, and Inferno is installed system-wide by root or your distribution package's package manager, then to install additional modules / applications, you need root privileges (either <code>sudo mk</code> on the host OS, or <code>sudo emu</code> and native <code>mk</code> ) </li><li>  Global installation is inconvenient if you want to use a modified version of these modules / applications for your application. </li><li>  global installation is inconvenient if different applications need different versions of the same module (mjl solves this problem in the traditional * nix way by adding the major version number to the module name, which is not very elegant and leads to names like ‚Äúutil0.m‚Äù) </li><li>  Uninstallation turns into a non-trivial operation, which ultimately leads to littering of system directories. </li><li>  names of modules / applications of different developers may conflict (however, this problem exists in * nix / win, and it can be circumvented using subdirectories in <code>/dis/</code> and <code>/module/</code> with the name of the developer or his site) </li></ul><br>  I want to propose an alternative approach based on the DJB's <a href="http://cr.yp.to/slashpackage/management.html">slashpackage</a> .  <b>Update:</b> this approach was recently adopted by infferno developers, so that it can already be considered not alternative, but official.  :) <br><a name="habracut"></a><br><h4>  Directory structure </h4><br><ol><li>  Create a global catalog for all 3rd-party software <code>/opt/</code> .  <b>Update: The</b> directory already exists in the current version of Inferno. </li><li>  Separate subdirectories for each developer / organization are created in <code>/opt/</code> , and subdirectories for each module / application are created in them to avoid name conflicts between different developers (eg <code>/opt/powerman/hashtable/</code> ). </li><li>  A directory structure similar to the system one is created in the directory with the module / application: <br><ul><li> <code>dis/</code> </li> <li> <code>dis/lib/</code> </li> <li> <code>module/</code> </li> <li> <code>appl/cmd/</code> </li> <li> <code>appl/lib/</code> </li> <li>  etc.  if necessary </li></ul></li></ol><br>  In this approach, all 3rd-party modules / applications should search for their files and files of other non-standard modules / applications inside the <code>/opt/</code> directory. <br><br><h4>  Package management </h4><br><h5>  Installation </h5><br>  With this approach, to install a new module / application system-wide (ie, from root), one command is enough!  For example, if the module / application is laid out in the Mercurial repository on <a href="http://code.google.com/hosting/">Google Code</a> : <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># hg clone https://inferno-contrib-hashtable.googlecode.com/hg/ $INFERNO_ROOT/opt/powerman/hashtable</span></span></code> </pre><br>  A regular user installation locally requires two commands (it is assumed that a subdirectory opt / powerman / has been created in the user's home directory in advance): <br><pre> <code class="bash hljs">$ hg <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://inferno-contrib-hashtable.googlecode.com/hg/ opt/powerman/hashtable ; <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> opt /opt</code> </pre><br>  The fact is that the repository already contains compiled .dis files in the subdirectories of <code>dis/</code> and <code>dis/lib/</code> , and with this approach, after copying the directory with the module / application to <code>/opt/</code> its .dis files automatically appear exactly where and should be after the "installation". <br><br><h5>  Select a specific version / use a modified version </h5><br>  In order for your application to use the wrong version of the 3rd-party module / application, which by default is in <code>/opt/</code> , it is enough to connect the necessary version to <code>/opt/</code> before launching your application (and thanks to namespaces in Inferno this will not affect other applications that just need the default version): <br><pre> <code class="bash hljs">; <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> ./my-modified-hashtable/ /opt/powerman/hashtable/ ; ./my-app</code> </pre><br><h5>  (Re) build package </h5><br>  To compile and install (for example, if you made local changes to the 3rd-party code of a module / application), run <code>mk install</code> in its directory (for example, <code>/opt/powerman/hashtable/</code> ).  In this case, compiled dis-files will be installed in the <code>dis/</code> subdirectory of this module / application. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Update </h5><br>  It depends on how the package is distributed, but in general it comes down to one or two commands.  For example, for the same Mercurial it comes down to normal <br><pre> <code class="bash hljs">$ hg pull $ hg update</code> </pre><br>  in the <code>opt/powerman/hashtable/</code> directory.  In this case, from the repository will be pulled up including.  updated .dis files in <code>opt/powerman/hashtable/dis/</code> , and this is essentially a package upgrade. <br><br><h5>  Uninstall </h5><br>  There is simply no place.  I think you have already guessed how this is done, but I cannot deny myself the pleasure to write it: <br><pre> <code class="bash hljs">; rm -r /opt/powerman/hashtable</code> </pre><br><h5>  Get a list of installed 3rd-party software </h5><br><pre> <code class="bash hljs">; ls /opt/*</code> </pre><br><h5>  Get the list of files included in the package </h5><br>  Oh, this is a complicated operation, without a database in any way - why are we worse than rpm / apt / portage?  :) <br><pre> <code class="bash hljs">; fs <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> /opt/powerman/hashtable/</code> </pre><br><h4>  Use of these modules / applications </h4><br>  As you can see, managing such packages to the user is really easy and convenient.  Now let's see how to use them. <br><br><h5>  Applications </h5><br><pre> <code class="bash hljs">; /opt/powerman/retrymount/dis/retrymount</code> </pre><br>  Is it a bit long?  It can be shortened with the help of the sh functions (function definitions should be entered once in the profile): <br><pre> <code class="bash hljs">; fn retrymount { /opt/powerman/retrymount/dis/retrymount $* } ; retrymount</code> </pre><br>  <b>Update:</b> Another method is described below, see /opt/setup.sh. <br><br><h5>  Modules </h5><br><pre> <code class="bash hljs">include <span class="hljs-string"><span class="hljs-string">"opt/powerman/hashtable/module/hashtable.m"</span></span>; load HashTable HashTable-&gt;PATH;</code> </pre><br>  This will immediately work if the modules are installed locally, i.e.  in the subdirectory <code>opt/</code> .  If the modules are installed globally at <code>/opt/</code> , then you need to run limbo with the <code>-I/</code> option for the native limbo, or <code>-I$INFERNO_ROOT</code> when starting limbo from the host OS.  This can also be configured once, for example for the native limbo: <br><pre> <code class="bash hljs">; fn limbo { <span class="hljs-built_in"><span class="hljs-built_in">builtin</span></span> limbo -I/ $* }</code> </pre><br><h4>  Development of these modules / applications </h4><br>  To create a package installed in <code>/opt/</code> you need to follow a few simple rules: <br><br><h5>  module / hashtable.m file: </h5><br><pre> <code class="bash hljs">PATH: con <span class="hljs-string"><span class="hljs-string">"/opt/powerman/hashtable/dis/lib/hashtable.dis"</span></span>;</code> </pre><br><h5>  appl / {lib, cmd} / *. b-file: </h5><br><pre> <code class="bash hljs">include <span class="hljs-string"><span class="hljs-string">"../../module/hashtable.m"</span></span>; load HashTable HashTable-&gt;PATH;</code> </pre><br><h5>  mkfile: </h5><br>  All paths are relative, for example: <br><pre> <code class="bash hljs">MODULES=\ ../../module/hashtable.m\ DISBIN=../../dis/lib</code> </pre><br><h4>  /opt/setup.sh </h4><br>  <b>Update!</b> <br>  Another option for using 3rd-party modules and applications is to connect them using bind from <code>/opt/</code> to standard directories.  How to do this simply and universally is not entirely clear, but there is a partial solution.  The script shown below (I usually keep it in <code>/opt/setup.sh</code> ) will connect all the commands and man pages from <code>/opt/*</code> to <code>/dis/</code> and <code>/man/</code> .  Thus, the teams can be run simply by name, without a full path like <code>/opt/powerman/retrymount/dis/retrymount</code> and the documentation for 3rd-party applications and modules can be viewed using standard tools. <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/dis/sh -n load std for d in /opt/*/man/* /opt/*/*/man/* { or {ftest -d $d} {raise continue} n := `{basename $d} bind -b $d /man/$n } for d in /opt/*/dis/* /opt/*/*/dis/* { or {ftest -d $d} {raise continue} n := `{basename $d} and {~ $n lib} {raise continue} and {~ $n cmd} {n=''} bind -b $d /dis/$n }</span></span></code> </pre><br>  <b>Update2!</b> <br>  The improved version of the above <code>/opt/setup.sh</code> now available as an <a href="http://code.google.com/p/inferno-opt-setup/">inferno-opt-setup</a> project.  The functionality is divided into two scripts: <code>/opt/setup/cmd</code> and <code>/opt/setup/man</code> , which can be used independently. <br>  In addition, a selection of mkfiles similar to the standard ones, but supporting work with / opt-projects, and recommended for use in your projects, was developed if they either use / opt-modules or are installed in / opt: <a href="http://code.google.com/p/inferno-opt-mkfiles/">inferno-opt-mkfiles themselves</a> . <br><br><h4>  Examples </h4><br>  Several simple modules / applications written in this style can be found by searching <a href="http://code.google.com/hosting/search%3Fq%3Dinferno%2Bcontrib%26btn%3DSearch%2Bprojects">for ‚Äúinferno contrib‚Äù on Google Code</a> . <br><br>  <b>Update:</b> An example / opt project has been laid out for use as a template for a quick start of their projects: <a href="http://code.google.com/p/inferno-opt-skel/source/detail%3Fr%3Dc13f46c1f8fc3bb7b4a23f73e3a86e437b231316">inferno-opt-skel</a> . <br><br><h4>  Links </h4><br>  <a href="http://powerman.name/Inferno/Limbo.html">Russian language description Limbo</a> <br>  <a href="http://inferno.execbit.ru/wiki.wsgi/Inferno%2520OS">Russian wiki for OS Inferno, translations of documentation</a> </div><p>Source: <a href="https://habr.com/ru/post/87460/">https://habr.com/ru/post/87460/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../87448/index.html">Simplify the perception of the product: Practical steps</a></li>
<li><a href="../87450/index.html">Silverlight Localization</a></li>
<li><a href="../87452/index.html">Script for dividing music CD images into tracks and converting to FLAC format</a></li>
<li><a href="../87455/index.html">Pi day!</a></li>
<li><a href="../87459/index.html">Default search on iPad?</a></li>
<li><a href="../87461/index.html">Aviary is available in Google Apps</a></li>
<li><a href="../87462/index.html">Comparing video quality via HTML5 and Flash using YouTube as an example using Chrome 5.0.342.3 dev and Win 7 browser</a></li>
<li><a href="../87464/index.html">Extension authors, browser hackers, meet js-ctypes</a></li>
<li><a href="../87467/index.html">HabrTree - minimizing script</a></li>
<li><a href="../87471/index.html">Improving notify-send. Adding a new message to the previous one</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>