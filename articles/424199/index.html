<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We build simple GraphQL API server on express and nodeJS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I offer to read the free translation of a small article on the practical application of GraphQL. The original is available by reference ( En ). 

 A f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We build simple GraphQL API server on express and nodeJS</h1><div class="post__text post__text-html js-mediator-article">  I offer to read the free translation of a small article on the practical application of GraphQL.  The original is available by reference ( <a href="https://scotch.io/%40codediger/build-a-simple-graphql-api-server-with-express-and-nodejs">En</a> ). <br><br><h3>  A few words about GraphQL </h3><br>  GraphQL is a query language for an API that offers a declarative approach to getting data.  It allows clients to request only the necessary data from the web server and nothing superfluous.  Designed back in 2012 by Facebook, which is still supported, GraphQL was used by many other large and not-so-great companies.  Among others, Yelp, Shopify and Github. <br><br>  When using REST APIs, requests are usually sent to several addresses to get all the necessary data in the application.  GraphQL API, on the other hand, allows you to send the entire request to an address indicating what data you would like to receive with this request.  Therefore, by the way, GraphQL is great when used in a slow mobile connection. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      API versions can be a headache for development teams.  With GraphQL you can not worry about it.  GraphQL allows you to add new fields and types (this will be discussed later) to your GraphQL API, without affecting existing queries; old and unused fields can be hidden from API clients.  Using a single evolving version, GraphQL API provides your application with constant access to new API implementations and provides a clean and easily supported code base. <br><a name="habracut"></a><br><h3>  Prerequisite </h3><br>  Before you begin, make sure you have Node version 6 and later installed.  The version can be checked with the command: <br><br><pre><code class="bash hljs">node -v</code> </pre> <br>  If you don't have a Node installed, go to the URL: <a href="https://nodejs.org/">https://nodejs.org/</a> and follow the installation instructions. <br><br><h3>  Setup GraphQL and Express </h3><br>  A simple way to create a Graph API server is to use Express, a popular framework for Node.js.  Install Express using npm: <br><br><pre> <code class="bash hljs">npm init npm install express --save</code> </pre> <br>  Then set `graphql` and` express-graphql`: <br><br><pre> <code class="bash hljs">npm install graphql express-graphql --save</code> </pre> <br>  So, the initial folder structure is as follows: <br><br> <code>|---- node_modules <br> |---- package.json</code> <br> <h3>  Quick Start in GraphQL API </h3><br>  In this small section, we will attempt to quickly create a simple GraphQL API.  This is important for further narration, so that it becomes clear to you what we are doing, what the API created with the help of GraphQL is.  If some moments seem difficult and incomprehensible, do not worry, we will return to them. <br><br>  So now we are going to use the `buildSchema` object from` graphql` to create a 'schema'.  Create an example.js file in our folder. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { buildSchema } = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'graphql'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> graphqlHTTP = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express-graphql'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> port = <span class="hljs-number"><span class="hljs-number">3000</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*         GraphQL */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> schema = buildSchema(<span class="hljs-string"><span class="hljs-string">` type Query { postTitle: String, blogTitle: String } `</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* root      endpoint'a */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> root = { <span class="hljs-attr"><span class="hljs-attr">postTitle</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Build a Simple GraphQL Server With Express and NodeJS'</span></span>; }, <span class="hljs-attr"><span class="hljs-attr">blogTitle</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'scotch.io'</span></span>; } }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = express(); app.use(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, graphqlHTTP({ <span class="hljs-attr"><span class="hljs-attr">schema</span></span>: schema, <span class="hljs-attr"><span class="hljs-attr">rootValue</span></span>: root, <span class="hljs-attr"><span class="hljs-attr">graphiql</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-comment"><span class="hljs-comment">//  true,   GraphiQL })); // ( IDE       endpoint'), //  endpoint' GraphQL   app.listen(port); console.log('GraphQL API server running at localhost: ' + port);</span></span></code> </pre> <br>  Now you can run `example.js` in the terminal: <br><br><pre> <code class="bash hljs">node example.js</code> </pre> <br>  Now on localhost: 3000 you can detect GraphiQL.  It allows you to test your API in a browser.  It supports autofilling and makes assumptions for you based on the types and fields available in your schema. <br><br><img src="https://habrastorage.org/webt/qm/m4/kq/qmm4kqzmkisczszbjgjqzd05osm.png" alt="image"><br><br>  Now let's request our schema for `blogTitle`: <br><br><img src="https://habrastorage.org/webt/hf/ox/zz/hfoxzzcsff8vlatrc5giv9ho3aw.png" alt="image"><br><br>  Just like that, you can request the GraphQL API. <br><br><h3>  Introduction </h3><br>  Now you understand how GraphQL works and we can start a deeper theme. <br>  Start by creating a GraphQL server based on Express.  Now, in our folder, create the `src` folder, and in it create and save the` schema.js` file.  This file will look like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Authors  Posts     // JSON     const Authors = require('./data/authors'); const Posts = require('./data/posts'); let { //    GraphQL,      GraphQLString, GraphQLList, GraphQLObjectType, /*          */ GraphQLNonNull, //        GraphQLSchema } = require('graphql');</span></span></code> </pre> <br>  Next, create a `data` folder in the` src` folder.  In it we will place 2 files: 'authors.js' and 'posts.js'. <br><br>  The content of these files is quite large, so you can not take them <a href="https://github.com/ladanovn/Simple-GraphQL-API/tree/master/src/data">from the link to Github</a> or under the spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">authors.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Authors = [ { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">'8dlx7ak38fd39dv79ad'</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Orinami Olatunji'</span></span>, <span class="hljs-attr"><span class="hljs-attr">twitterHandle</span></span>: <span class="hljs-string"><span class="hljs-string">'@orinami_'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">'jd3kd03d0w9a0l35rh74'</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Ojima Udale'</span></span>, <span class="hljs-attr"><span class="hljs-attr">twitterHandle</span></span>: <span class="hljs-string"><span class="hljs-string">'@uncooloj'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">'0hy894hf0dlkfh9oinv'</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Xabi Alonso'</span></span>, <span class="hljs-attr"><span class="hljs-attr">twitterHandle</span></span>: <span class="hljs-string"><span class="hljs-string">'@alonso'</span></span> } ]; <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = Authors;</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">posts.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Posts = [ {<span class="hljs-string"><span class="hljs-string">'id'</span></span>:<span class="hljs-string"><span class="hljs-string">'0176413761b289e6d64c2c14a758c1c7'</span></span>,<span class="hljs-string"><span class="hljs-string">'author_id'</span></span>:<span class="hljs-string"><span class="hljs-string">'0hy894hf0dlkfh9oinv'</span></span>,<span class="hljs-string"><span class="hljs-string">'author'</span></span>:<span class="hljs-string"><span class="hljs-string">'alonso'</span></span>, <span class="hljs-string"><span class="hljs-string">'category'</span></span>:<span class="hljs-string"><span class="hljs-string">'meteor'</span></span>,<span class="hljs-string"><span class="hljs-string">'body'</span></span>:<span class="hljs-string"><span class="hljs-string">'Most developers and companies use two different apps for the marketing website and for the app itself. Thus, they can update each of the apps without affecting the other. [Stripe](https://stripe.com/), [Digital Ocean](https://www.digitalocean.com/) and many other companies follow this technique. Most Meteor apps also do the same.\n\nSo, in a scenario like this, sometimes we need to show the login state of the app on the landing page too. For an example, see our Kadira home page (\u003chttps://kadira.io\u003e). If you are logged into the Kadira app (\u003chttps://ui.kadira.io\u003e), we show a button with "Open Kadira UI" on the home page, which replaces the login button.\n\n[![Login State Example on Kadira](https://cldup.com/q9nKu_OIhQ.png)](https://kadira.io)\n\n## How Did We Do It?\n\nMeteor does not have a built-in way to share login states across multiple apps or subdomains. So, we have to find an alternative way to do so.\n\nAs a solution, we can use browser cookies to share the login state between multiple domains. That\'s exactly what we did. We wrapped this up into a Meteor package, which now you can also use.\n\nIn this guide, I\'m going to explain how to share the login state between multiple domains using the [`kadira:login-state`](https://github.com/kadirahq/meteor-login-state) package.\n\n### On Meteor App\n\nFirst of all, install the `kadira:login-state` package in your Meteor app:\n\n~~~\nmeteor add kadira:login-state\n~~~\n\nThen, you need to add a new entry in the `public` object as the `loginState` in the `settings.json` file for your app. (If you haven\'t created the settings.json yet, you need to create it first.)\n\n~~~json\n{\n "public": {\n "loginState": {\n "domain": ".your-domain-name.com",\n "cookieName": "app-login-state-cookie-name"\n }\n }\n}\n~~~\n\nThe `domain` field must be your main domain name, starting with a dot. It allows you to share the login state, which can be accessed from any of its subdomains. You can use any appropriate identifier, such as `cookieName`.\n\nNow, everything has been set up on the Meteor app.\n\n### On the Static App (the Landing Page)\n\nNow we have to show the login state of the app on the landing page. For this, we need to add support for the login state for the static app (or landing page).\n\nActually, there are three different ways to do this. Here I will show you how to do so by pasting a few lines of JavaScript code.\n\nYou need to create a JavaScript file in your js folder. I create it as `js/login_state.js`. After that, copy and paste the following code snippet into it:\n\n~~~javascript\nLoginState = {};\n\nLoginState.get = function(cookieName) {\n var loginState = getCookie(cookieName);\n if(loginState) {\n return JSON.parse(decodeURIComponent(loginState));\n } else {\n return false;\n }\n};\n\nfunction getCookie(cname) {\n var name = cname + "=";\n var ca = document.cookie.split(\';\');\n for(var i=0; i \u003c ca.length; i++) {\n var c = ca[i];\n while (c.charAt(0)==\' \') c = c.substring(1);\n if (c.indexOf(name) != -1) return c.substring(name.length,c.length);\n }\n return;\n}\n~~~\n\nInsert that file into the head section of your HTML document: \n\n`\u003cscript src="js/login-state.js"\u003e\u003c/script\u003e`\n\n\u003e If you prefer, you can also use [Browserify](https://github.com/kadirahq/meteor-login-state#installing-via-browserify) or [Bower](https://github.com/kadirahq/meteor-login-state#installing-via-bower) to load the above JS file.\n\u003e The package name for both Browserify and Bower is `meteor-login-state`.\n\nThen, use the following code to get the login state of your app. You need to provide the relevant `cookieName` to do so: \n\n~~~javascript\nvar loginState = LoginState.get("app-login-state-cookie-name");\nif(loginState) {\n // the user has loggedIn to the meteor app\n // see the loginState Object for the addtional data\n // (append your code here!)\n console.log(loginState);\n} else {\n // user has not loggedIn yet.\n // (append your code here!) \n}\n~~~\n\nThe `loginState` object will be something like this:\n\n~~~json\n{\n timestamp: 1435835751489,\n username: "username",\n userId: "meteor-user-id",\n email: "user@email.com"\n url: "https://ui.kadira.io"\n}\n~~~\n\nNow you can do whatever you need to do with the login state.\n\nGive it a try and let me know what you think.'</span></span>,<span class="hljs-string"><span class="hljs-string">'date'</span></span>:{<span class="hljs-string"><span class="hljs-string">'$date'</span></span>:<span class="hljs-string"><span class="hljs-string">'2015-07-07T00:00:00.000Z'</span></span>},<span class="hljs-string"><span class="hljs-string">'layout'</span></span>:<span class="hljs-string"><span class="hljs-string">'blog_post'</span></span>,<span class="hljs-string"><span class="hljs-string">'slug'</span></span>:<span class="hljs-string"><span class="hljs-string">'sharing-meteor-login-state-between-sub-domains'</span></span>,<span class="hljs-string"><span class="hljs-string">'summary'</span></span>:<span class="hljs-string"><span class="hljs-string">'In this blog we\'ll show you how we shared login state between our static web app and our Meteor app Kadira UI.'</span></span>,<span class="hljs-string"><span class="hljs-string">'title'</span></span>:<span class="hljs-string"><span class="hljs-string">'Sharing the Meteor Login State Between Subdomains'</span></span>}, {<span class="hljs-string"><span class="hljs-string">'id'</span></span>:<span class="hljs-string"><span class="hljs-string">'03390abb5570ce03ae524397d215713b'</span></span>,<span class="hljs-string"><span class="hljs-string">'author_id'</span></span>:<span class="hljs-string"><span class="hljs-string">'0hy894hf0dlkfh9oinv'</span></span>,<span class="hljs-string"><span class="hljs-string">'author'</span></span>:<span class="hljs-string"><span class="hljs-string">'alonso'</span></span>, <span class="hljs-string"><span class="hljs-string">'category'</span></span>:<span class="hljs-string"><span class="hljs-string">'product'</span></span>,<span class="hljs-string"><span class="hljs-string">'body'</span></span>:<span class="hljs-string"><span class="hljs-string">'Here is a common feedback we received from our users:\n\n\u003e Hi, I have a suggestion. It would be great if I could "dismiss" errors or mark them as resolved on my end. This way, I can keep track of which errors I have resolved.\n\nToday we are happy to announce new Kadira feature which allows you to track **status** to errors. With that, you can mark errors as "Ignored", "Fixing" or "Fixed".\n\nOnce you mark an error as "Ignored", it will be hidden. \n\nBut you can click on "Show Ignored Errors" checkbox or filter by "ignored" status to view them again.\n\n![show ignored errors](https://cldup.com/XvoJk9RGWf.gif)\n\nYou can also filter errors by status like this:\n\n![filtering errors with status](https://cldup.com/76JZ6wmbVb.gif)\n\nWe are rolling out this feature to all our paid users. [Give it a try](https://ui.kadira.io/apps/AUTO/errors/overview?metric=count).\n\n### What'</span></span>s next?\n\nRight now we are planning to add few more feature related <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>. Could you help us on [prioritizing](https:<span class="hljs-comment"><span class="hljs-comment">//orinami.typeform.com/to/hyTwsy) them? Trust me, [it won\'t take a minute](https://orinami.typeform.com/to/hyTwsy).','date':{'$date':'2015-09-01T00:00:00.000Z'},'slug':'tracking-error-status-on-kadira','summary':'Lot of users asked us to add a feature to set status for errors in the Kadira Error Manager. Now, we\'ve that functionality.','title':'New Feature: Tracking Error Status with Kadira'}, {'id':'0be4bea0330ccb5ecf781a9f69a64bc8','author_id':'8dlx7ak38fd39dv79ad','author':'orinami', 'category':'product','body':'\u003cscript type="text/javascript" src="https://gumroad.com/js/gumroad.js"\u003e\u003c/script\u003e\n\nWe are working on the next few major feature releases for Kadira. We would like to know your preference. Pre-order the feature you would most like to see in the next major release (scheduled for August 1).\n\n## Real Client Monitoring\n\nWith Real Client Monitoring, you can learn how your app behaves in actual clients and find client-side bottlenecks. You\'ll be able to see:\n\n* Load time of your app\n* Time taken to connect to the DDP Server\n* Time taken to load the initial subscriptions\n* Time taken to render initial subscriptions\n* Latency values for your methods and publications. You can also break them down into:\n * Network latency for sending requests\n * Server queue time\n * Server processing time\n * Network latency for receiving result/data\n\nComparisons with all of these metrics can be made against countries and browsers (mobiles, desktop, etc.).\n\n\u003e This is an add-on for your app and we charge [**$25 for 50K DDP connections per month**](https://gumroad.com/l/LyDy). You can also enable this add-on even if you have a free plan.\n\u003e\n\u003e 1 DDP connection = 1 Reatime client who established a DDP connection\n\n\u003ca href="https://gumroad.com/l/LyDy" class="gumroad-button"\u003ePre Order Now!\u003c/a\u003e\n\n## CPU/Memory Profiling\n\nYou\'ll be able to create CPU and memory profiles for your app in both development and production. This is an add-on for your app.\n\nThe add-on shows:\n\n* CPU-intensive packages in your app\n* CPU-intensive functions and who created them\n* Capture and compare heap dumps and learn how to find memory leaks with them\n\n\u003e You can enable this add-on for a [**$20/month**](https://gumroad.com/l/EqEf) flat free for you app. You can also enable this add-on even if you have a free plan.\n\n\u003ca href="https://gumroad.com/l/EqEf" class="gumroad-button"\u003ePre Order Now!\u003c/a\u003e\n\n## Better Error Manager\n\nCurrently, we track errors for methods only. With Error Manager, you\'ll be able to track all the server-side and client-side errors.\n\nThe improved Error Manager will be available for any app with a [**paid plan**](https://gumroad.com/l/fRGA).\n\n\u003e Client-side errors will be routed through your app. In future, you\'ll be able to send them directly to Kadira without routing them through your app.\n\n\u003ca href="https://gumroad.com/l/fRGA" class="gumroad-button"\u003ePre Order Now!\u003c/a\u003e','date':{'$date':'2014-06-30T00:00:00.000Z'},'layout':'blog_post','slug':'what-should-kadira-build-next','summary':'We are working on the next few major feature releases for Kadira. We would like to know your preference. Pre-order the feature you would most like to see in the next major release (scheduled for August 1).','title':'What Should Kadira Build Next?'}, {'id':'19085291c89f0d04943093c4ff16b664','author_id':'8dlx7ak38fd39dv79ad','author':'orinami', 'category':'product','body':'Everybody hates errors -- whether it\'s in a Meteor app or not. Unfortunately, errors are something we can\'t avoid. So we must track and handle errors even though, we have tested our app a lot.\n\nIn the recent past, technology has been changed rapidly. But, how we track and fix errors hasn\'t changed that much specially for apps running live on production.\n\nTake a look at the following process. It\'s the process we often used to track and fix errors.\n\n* Capture errors via either logs or using some third party web service.\n* Look for error message and stack trace.\n* Try to locate the relevant place in the code.\n* Then try to fix it.\n\nI don\'t think I need to talk more about this because we all follow the same process.\n\n### Client Side Errors\n\nManaging server side errors is pretty easy compared with client side errors. For server errors all we need to focus on our servers. But tracking client side errors is not that simple.\n\nAlso, we can\'t really depend on stack traces because of the minified code. Even though we capture errors, it\'s not easy as server side errors due to the vendor specific issues and constraints. \n\n## Let\'s fix this!\n\nSo, we\'ve decided to find a cure for this and found a way.\n\nWhat we are doing is pretty simple. Along with capturing the error, we also capture the **context** and **events** related to the error. Then you can reproduce them in your development environment and identify and fix any issues quickly.\n\nCheck following error trace which has been captured with Kadira.\n\n![Server Side Meteor Error Trace on Kadira](https://i.cloudup.com/RLwjKSU464.png)\n\nIt contains:\n\n* input parameters for the error;\n* user, who\'s got this error;\n* all the DB, HTTP and other events that have occurred; and\n* the error message and the stack trace.\n\nNow it\'s super-easy to fix the error since you can clearly see what cause the error and it\'s context. We track all kinds of errors including pubsub, method, uncaught exceptions and internal Meteor errors.\n\n### What About Client Side Errors?\n\nWe do the same for client side errors as well. Look at the following error trace.\n\n![Client Side Meteor Error Trace on Kadira](https://cldup.com/-sxdlAvujw.png)\n\nIt has:\n\n* browser information;\n* user information; \n* all the Meteor method calls, subscriptions, sessions and all related events that have occurred;\n* a complete flow of the error starting from the page load event; and\n* the actual error message and stack trace.\n\nNow I think you know what to do with this information.\n\n\u003e we track events using client side zones. So, you need to add [`zones`](https://github.com/meteorhacks/zones) package into your app in addition to [`kadira`](https://github.com/meteorhacks/kadira). Otherwise, you can\'t see events.\n\n## Public Beta\n\nToday, we are happy to announce the public beta of the Kadira\'s Error Tracking solution and invite all of you to start tracking errors with Kadira.\n\nWe\'ve worked so hard on this over the last few months and a lot of people have helped us to test our error tracking solutions‚Äîthank you! \n\nSimply update the [`kadira`](https://github.com/meteorhacks/kadira) smart package and visit Errors section on the [Kadira UI](https://ui.kadira.io/).\n\n![Error Tracking with Kadira](https://cldup.com/hBQIhPgzhU.png)\n\n\u003e Error Tracking is free and unrestricted throughout public beta period.\n\nGive it a try and let us know how it goes.','date':{'$date':'2014-09-08T00:00:00.000Z'},'layout':'blog_post','slug':'awesome-error-tracking-solution-for-meteor-apps-with-kadira','summary':'Error tracking is so much important and goes side by side with performance issues. This is the public beta announcement of Kadira\'s error tracking solution.','title':'Awesome Error Tracking Solution for Meteor Apps with Kadira'}, {'id':'1afff9dfb0b97b5882c72cb60844e034','author_id':'8dlx7ak38fd39dv79ad','author':'orinami','category':'product','body':'You might have seen the [EventLoop Utilization](http://support.kadira.io/knowledgebase/articles/372876-event-loop-utilization) chart in our Dashboard. But, it was not correctly working across different hosting platforms. Actually, that value does not reflect any meaning in some situations.\n\n![CPU Usage tracking with Kadira](https://i.cloudup.com/eisfJAuiJW.gif)\n\nSo, we\'ve replaced EventLoop Utilization with [CPU Usage](http://support.kadira.io/knowledgebase/articles/378890-cpu-usage). It\'s the actual percentage of CPU spent on your app. Still, you need to be [careful](http://support.kadira.io/knowledgebase/articles/378890-cpu-usage) with analyzing CPU Usage because, some hosting providers have implemented CPU restrictions. But you can see the correct CPU Usage of your app.\n\n\u003e Please upgrade [kadira](https://atmospherejs.com/package/kadira) smart package in order to track CPU Usage. Apply following code:\n\u003e\n\u003e `mrt update`\n\n## How do we track CPU Usage?\n\nThere is no direct API to track CPU usage of your app within your app. But, we are using [usage](https://github.com/orinami/node-usage) npm module for that. In Linux and Solaris, it uses the **/proc** filesystem to read the CPU usage. So, it is very efficient.\n\nHave a good time with improving your application.','date':{'$date':'2014-06-12T00:00:00.000Z'},'layout':'blog_post','slug':'tracking-cpu-usage-with-kadira','summary':'We\'ve replaced EventLoop Utilization chart with actual CPU Usage. See why?','title':'Tracking Meteor CPU Usage with Kadira'}, {'id':'1bd16dfab1de982317d2ba4382ec8c86','author_id':'8dlx7ak38fd39dv79ad','author':'orinami','category':'meteor','body':'Today is holiday for Sri Lanka. But for me, it\'sa hackday. I started playing with React and wrote few simple apps. That\'sa nice experience.\n\nSo, I started thinking why not trying to implement SSR support. It\'s worth trying since now we\'ve all the tools we need.\n\n**Guys, It was a successful experience. Now we\'ve pure SSR support for Meteor.**\n\n### How It Works.\n\nLet\'s have a look at first.\n\n* Demo App: \u003chttp://flow-react-ssr.meteor.com/\u003e\n* Demo App Code: \u003chttps://github.com/orinami/hello-react-meteor\u003e\n\n\u003ciframe width="960" height="720" src="https://www.youtube.com/embed/Qj2eppT27BU?rel=0\u0026amp;showinfo=0" frameborder="0" allowfullscreen="1"\u003e\n\u003c/iframe\u003e\n\nBasically, you just write your Meteor app as you do normally, but using React as the frontend. You use generic Meteor pub/sub to fetch data to the client and render your pages. \n\nHere, you need to use [FlowRouter](https://atmospherejs.com/meteorhacks/flow-router-ssr) and [ReactLayout](https://github.com/orinami/hello-react-meteor/blob/master/lib/react_layout.js) to render react components. ReactLayout is a pretty simple wrapper around `React.render()` which works both on the server and the client.\n\nIn the server, there is very interesting thing is happening. FlowRouter generate an isolated environment for each route. It use existing subscriptions to fetch data and assign them to collections in that environment. So, you don\'t need to change any of your code for the SSR support. \n\nThen when ReactLayout render components, it gets the data filtered by subscriptions for that route. (You can also use component level subscriptions.) \n\nAfter that ReactLayout handover the generate HTML to FlowRouter. This is designed in a way that we can add other layout engine support as well. So, FlowRrouter still doesn\'t directly works with the layout engine.\n\n### Where we can go\n\nThis is just the base work for SSR and there\'sa lot to be done to build a production ready version. But, now everything is clear and it\'sa matter of time we build and ship it. \n\n\u003e This is the something we are going to release with FlowRouter 3.0. We are very close to release FlowRouter 2.0.\n\nI\'ll talk more about this in the upcoming **Kadira Show** and if you like to work on this, just drop me a message.','date':{'$date':'2015-07-01T00:00:00.000Z'},'layout':'blog_post','slug':'meteor-ssr-support-using-flow-router-and-react','summary':'This is an experiment orinami did to implement Server Side Renderng(SSR) using Flow Router and React.','title':'Meteor Server Side Rendering Support with FlowRouter and React'}, {'id':'285292901bb38be8f57dd2885c517826','author_id':'8dlx7ak38fd39dv79ad','author':'orinami','category':'user-story','body':'[Brent Abrahams](http://cn.linkedin.com/pub/brent-abrahams/87/372/ba1) is a mathematics teacher who has build an online curriculum management app [Standbench](http://cn.linkedin.com/pub/brent-abrahams/87/372/ba1) for his organization using Meteor. He has a [nice story](http://meteorhacks.com/meteor-in-production-a-case-study.html) with the initial stage of his applications and how he used Oplog with his application.\n\nRecently, we was able to figure out a potential issue of one of his server with the data from Kadira. This is how he talked about it.\n\n"Kadira did give me a heads-up a couple of days ago that one of my servers was in trouble, as I saw an unusual increase in the number of publications and methods being called. So I restarted the server and watched everything settle back into the normal pattern. That was nice! The real-time aspect of the Kadira admin console is just great."\n\nBrent also showed how he used Kadira with his development workflow.\n\n\u003ciframe width="640" height="480" src="//www.youtube.com/embed/MUTn6hdfV64" frameborder="0" allowfullscreen="1"\u003e\n\u003c/iframe\u003e','date':{'$date':'2014-05-27T00:00:00.000Z'},'layout':'blog_post','slug':'user-stories-brent-abrahams','summary':'Denis has been using Kadira from the initial beta release and helped us a lot on identifying issues with Kadira. This is how he is using Kadira.','title':'How Brent is using Kadira with his development workflow'}, {'id':'2f6b59fd0b182dc6e2f0051696c70d70','author_id':'8dlx7ak38fd39dv79ad','author':'orinami','category':'other','body':'This is a short guide to remind you about means, histograms and percentiles in statistics. Then, we will discuss why all these matter and when we can use each of them.\n\n## Our Data Set\n\nFirst, we need a data set so we can calculate these measurements. We will look at a collection of response times collected over a minute from a web app. Here are those values (they are in milliseconds):\n\n~~~\n255, 168, 125, 11102, 59, 120, 500, 2, 98, 25\n~~~\n\nBy just looking at the data set, it\'s hard to get a clear picture. \nIt would be impossible, if we had a larger data set. (Normally, we\'ll have larger data sets.)\n\n\u003e You can access these values in a [Google Sheet](https://docs.google.com/spreadsheets/d/1JsDB2ryWKBcSLRy-YHIjfIs-ESFZq2k3N7ggdVz5O84/edit?usp=sharing), which also has each of the measurements we are looking at in this article.\n\n## Analyzing the Data Set\n\nNow we need to analyze this data set and get some information from it. That\'s why we need to build some measurements.\n\n## Mean\n\nMean is the easiest measurement to generate. Simply add all the numbers together and divide by the number of items.\n\nFor this data set, the mean is **1245.4 milliseconds.**\n\nThat is, on average it took more than 1245 milliseconds to process a single request.\n\n\u003e The mean is a good measurement for representing a whole data set as a single value.\n\n## Histograms\n\nSometimes mean **does not** represent a data set accurately. For our data set, we got a mean of 1245 milliseconds. But, just by looking at the data set, we know a lot of requests took less than 200 milliseconds. So, the mean is not a good representation for our data set.\n\nMean has a higher value because it\'s sensitive to **outliers** like 11,102 milliseconds.\n\nSo, a histogram is the answer. It gives us a better view of the data set.\n\nHere\'s the histogram for our data set:\n\n![](https://cldup.com/CLt8N20YIH.png)\n\nIn the histogram, we group data points into equal groups. We call such a group a bin. The size of our bins (binSize) is 1000 milliseconds.\n\nIt\'s clear that we\'ve an outlier. We can get even more information if we make our bin size smaller.\n\n\u003e A histogram is a good tool for visualizing a data set. We can see what really happened.\n\n### Summarizing\n\nHistograms are always useful for visualizing a data set. But, we can\'t measure two different histograms and compare them easily. That\'s why we need to generate summary measurements from a histogram (or from the data set directly). \n\nLet\'s have a look at a few such measurements.\n\n#### Median\n\nMedian is the value in middle of the data set. We can simply get it by sorting the data set and picking the value in the middle. In our data set, it\'s **122.5 milliseconds.**\n\nWhat does the median represent? For 50% of the events, our response time was shorter than 125.5 milliseconds.\n\n\u003e So, the median gives us useful information about our data set and it\'s not sensitive to outliers.\n\n#### Percentiles\n\nTo calculate a percentile, we need to sort our data set and divide it into 100 equal groups. So, the 90th percentile is the value at beginning of the 90th group.\n\nIn our case, the 90th percentile is **1560.2 milliseconds.**\n\nThis means that more than 10% of our user base experienced a response time of 1560 milliseconds or higher. Alternatively, 90% of our users had a response time less than 1560 milliseconds.\n\n\u003e Median is equivalent to the 50th percentile. Percentiles are not sensitive to outliers.\n\n## Using All These Measurements\n\nWe can\'t say that one measurement is good or bad. Each of them has its own purpose. Let\'s discuss this. \n\n\u003e We will use the *response time* as an example metric, but our comments hold for any kind of metric. \n\n**Mean is a good measurement if we need to compare response times in different periods.**\n\nFor example, we can plot means for each minute as a graph to see how it behaves. Since it\'s sensitive to outliers, we **can** see them as well. Have a look at the following graph:\n\n![](https://cldup.com/hDcS9KuQb5.png)\n\nThere\'sa spike at the end of this chart. So, we can tell that there was something wrong then. We can now drill down into the data set at that time and find the problem.\n\n**That\'s when histograms and summary measurements come in handy.**\n\nLet\'s have a look at the histogram of our data set at that time:\n\n![](https://cldup.com/QM0ghRvB-a.png)\n\nHere, the 99th percentile is very high compared with the other percentiles, which indicates that there is an outlier.\n\nBut interestingly, our 90th and 95th percentiles are also quite high. So, that seems like a problem.\n\n\u003e Normally, we try to reduce response times. That\'s why we never look at lower percentile values like the 5th percentile. But, depending on your data set, you can pick any percentile you want.\n\nFor the response time, we usually look at the median, the 90th, 95th and 99th percentiles. It\'s up to you to decide which percentile you are going to look at. \n\nIf the response time is very critical to your app, you can try to reduce the 99th percentile. Otherwise, you could try to optimize the response time for the 90th or 95th percentile.\n\nIf you are really not worried about the response time, you could try to optimize the median.','date':{'$date':'2015-08-24T00:00:00.000Z'},'layout':'blog_post','slug':'mean-histogram-and-percentiles','summary':'A short guide to means, histograms and percentiles and how we can use them in a real situation.','title':'Understanding Mean, Histogram and Percentiles'}, {'id':'3d7a3853bf435c0f00e46e15257a94d9','author_id':'8dlx7ak38fd39dv79ad','author':'orinami','category':'product','body':'Today, I\'m very excited to be launching Kadira Debug version 2. This version comes with a lot of UI improvements and few CPU related functionalities.\n\n## Installation\n\nThis version of Kadira Debug is published as a new package: `kadira:debug`. So, you need to remove `meteorhacks:kadira-debug` if it\'s in your app:\n\n~~~\nmeteor remove meteorhacks:kadira-debug\nmeteor add kadira:debug\n~~~\n\nAfter you\'ve added `kadira:debug`, simply visit \u003chttp://debug.kadiraio.com/debug\u003e and you\'ll be able to see what\'s going on in your app.\n\nLet me show you couple of new features and enhancements that we\'ve added.\n\n### CPU Usage Monitoring\n\nThese days we do many things on the client side, which means there is a lot of CPU activities on the client side of your app. Sometimes, your app will become slower to use because of these activities.\n\nNow, we\'ve a real-time CPU usage monitor based on [EventLoop usage](https://kadira.io/platform/kadira-debug/cpu-monitoring):\n\n[![CPU Usage Monitoring](https://cldup.com/CVKvhaFDhA.png)](https://kadira.io/platform/kadira-debug/cpu-monitoring)\n\n### Improved Event Stream\n\nIn the previous version, the event stream was very hard to use if there was a lot of data in it. Now the event stream will pause if you click on it. Also, now you\'ll be able to filter the event stream for the data you actually need:\n\n\u003ca href="https://kadira.io/platform/kadira-debug/event-stream"\u003e\n \u003cimg \n src="https://cldup.com/i7bxh6m2WL.jpg" \n alt="Improved Event Stream" \n data-gif="https://cldup.com/aQC6-NFYNK.gif"/\u003e\n\u003c/a\u003e\n\n### CPU Profiling\n\nNow you can analyze both client and server CPU profiles using our CPU analyzer. Earlier it was only available inside our Kadira app and it was a bit hard to use. Now anyone can use it.\n\n[![Kadira CPU Analyzer](https://cldup.com/JNPqRdYhrv.png)](https://kadira.io/platform/kadira-debug/cpu-profiling)\n\n### Lots of UI Improvements\n\nBesides these major changes, we\'ve added many UI improvements, making Kadira Debug very productive to use. \n\nTry the new [Kadira Debug](http://debug.kadiraio.com/debug) and let us know what you think about it.','date':{'$date':'2015-07-20T00:00:00.000Z'},'layout':'blog_post','slug':'introducing-kadira-debug-v2','summary':'Today, we are introducing a new version of Kadira Debug. It comes with many UI improvements and support for CPU profiling.','title':'Introducing Kadira Debug, Version 2'} ]; module.exports = Posts;</span></span></code> </pre> <br></div></div><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Types in GraphQL </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GraphQL has a module 'grapql / type' used to define the type. </font><font style="vertical-align: inherit;">Types can be imported from the module 'graphql / type' or from the root module 'graphql'. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base types include </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">String</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Float</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boolean</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">We also add the type Author (Author). </font><font style="vertical-align: inherit;">To do this in our file schema.js add:</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AuthorType = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLObjectType({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"Author"</span></span>, <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">"This represent an author"</span></span>, <span class="hljs-attr"><span class="hljs-attr">fields</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLNonNull(GraphQLString)}, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLNonNull(GraphQLString)}, <span class="hljs-attr"><span class="hljs-attr">twitterHandle</span></span>: {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: GraphQLString} }) });</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you can see, to add a new type we needed: to create an object of the GraphQLObjectType class and set some of its properties. </font><font style="vertical-align: inherit;">Name and Description - for the description of the type, Fields for the definition of attributes of the type Author: id, name and twitterHandler. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">More details about the types on </font></font><a href="http://graphql.org/graphql-js/type/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">graphql.org/graphql-js/type/</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And now we will create a type for posts (Post):</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PostType = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLObjectType({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"Post"</span></span>, <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">"This represent a Post"</span></span>, <span class="hljs-attr"><span class="hljs-attr">fields</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLNonNull(GraphQLString)}, <span class="hljs-attr"><span class="hljs-attr">title</span></span>: {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLNonNull(GraphQLString)}, <span class="hljs-attr"><span class="hljs-attr">body</span></span>: {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: GraphQLString}, <span class="hljs-attr"><span class="hljs-attr">author</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: AuthorType, <span class="hljs-attr"><span class="hljs-attr">resolve</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">post</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _.find(Authors, a =&gt; a.id == post.author_id); } } }) });</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add this to schema.js. </font><font style="vertical-align: inherit;">This will create a PostType object that will be used in the Root Query (Literally, the root query. In fact, the entry point to our GraphQL API).</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Root query </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Root Query is used to expand the resources available to your application clients. </font><font style="vertical-align: inherit;">We could make 2 resources available: authors and posts. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's add to our `schema.js` file:</font></font><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> BlogQueryRootType = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLObjectType({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'BlogAppSchema'</span></span>, <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">"Blog Application Schema Query Root"</span></span>, <span class="hljs-attr"><span class="hljs-attr">fields</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">authors</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLList(AuthorType), <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">"List of all Authors"</span></span>, <span class="hljs-attr"><span class="hljs-attr">resolve</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Authors } }, <span class="hljs-attr"><span class="hljs-attr">posts</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLList(PostType), <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">"List of all Posts"</span></span>, <span class="hljs-attr"><span class="hljs-attr">resolve</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Posts } } }) });</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here the root query is defined as BlogQueryRootType. </font><font style="vertical-align: inherit;">If you noticed, a new type was declared here: new GraphQLList (). </font><font style="vertical-align: inherit;">It creates a wrapper around other types, which is a list of these types.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schema definition </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The schema defines how you want the data in your application to be generated and how you want the data to be linked to each other. </font><font style="vertical-align: inherit;">Schema definition affects how data will be stored in your database (or databases). </font><font style="vertical-align: inherit;">In the schema definition, you also determine which queries, mutations, and subscriptions will be available for your data interface. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's add a schema to our file:</font></font><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> BlogAppSchema = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLSchema({ <span class="hljs-attr"><span class="hljs-attr">query</span></span>: BlogQueryRootType <span class="hljs-comment"><span class="hljs-comment">/*       ,    .       . mutation: BlogMutationRootType */</span></span> });</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here, the request is assigned the BlogQueryRootType object, which will be used as the root API request. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Implementing the GraphQL API </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We need the package `lodash`. </font><font style="vertical-align: inherit;">`Lodash` is a toolkit, which is a Javascript function that provides clean, high-performance methods for manipulating objects and collections. </font><font style="vertical-align: inherit;">If you were familiar with the `underscore` library, this is great! </font><font style="vertical-align: inherit;">Lodash was created from it, adding additional functionality and solving some performance problems with underscore.</font></font><br><br><pre> <code class="bash hljs">npm install lodash --save</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using this command, the lodash library will be installed and the corresponding dependency added to the package.json file. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add the following code to the top of the schema.js file.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> _ = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'lodash'</span></span>);</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now let's look at the schema.js file. </font><font style="vertical-align: inherit;">This is how the file should look like in the end.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> _ = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'lodash'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Authors  Posts     // JSON     const Authors = require('./data/authors'); const Posts = require('./data/posts'); let { //    GraphQL,      GraphQLString, GraphQLList, GraphQLObjectType, /*          */ GraphQLNonNull, //        GraphQLSchema } = require('graphql'); const AuthorType = new GraphQLObjectType({ name: "Author", description: "This represent an author", fields: () =&gt; ({ id: { type: new GraphQLNonNull(GraphQLString)}, name: { type: new GraphQLNonNull(GraphQLString)}, twitterHandler: {type: GraphQLString} }) }); const PostType = new GraphQLObjectType({ name: "s", description: "This represent a s", fields: () =&gt; ({ id: {type: new GraphQLNonNull(GraphQLString)}, title: {type: new GraphQLNonNull(GraphQLString)}, body: {type: GraphQLString}, author: { type: AuthorType, resolve: function(post) { return _.find(Authors, a =&gt; a.id == post.author_id); } } }) }); const BlogQueryRootType = new GraphQLObjectType({ name: "BlogAppSchema", description: "Blog Application Schema Query Root", fields: () =&gt; ({ authors: { type: new GraphQLList(AuthorType), description: "List of all Authors", resolve: function() { return Authors } }, posts: { type: new GraphQLList(PostType), description: "List of all Posts", resolve: function() { return Posts } } }) }); const BlogAppSchema = new GraphQLSchema({ query: BlogQueryRootType /*       ,    .       . mutation: BlogMutationRootType */ }); module.exports = BlogAppSchema;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you noticed in PostType, we have the additional attribute attribute. </font><font style="vertical-align: inherit;">Resolve is a function that can manipulate data, convert its values, etc. </font><font style="vertical-align: inherit;">and return them to the end of the operation. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlogAppSchema will be exported to the server.js file using module.exports </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now, create the server.js file in the root folder and add this code:</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> graphqlHTTP = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express-graphql'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> schema = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./src/schema.js'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> port = <span class="hljs-number"><span class="hljs-number">3000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = express(); app.use(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, graphqlHTTP({ <span class="hljs-attr"><span class="hljs-attr">schema</span></span>: schema, <span class="hljs-attr"><span class="hljs-attr">graphiql</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> })); app.listen(port); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'GraphQL API server running at localhost:'</span></span>+ port);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now let's check our result on localhost: 3000. </font><font style="vertical-align: inherit;">To do this, open a terminal and run:</font></font><br><br><pre> <code class="bash hljs">node server.js</code> </pre> <br><br>  Result: <br><br><img src="https://habrastorage.org/webt/r4/7b/es/r47besq38boyglrr-x7wxky39qa.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This graphiql, it will help you test the API in the browser. </font><font style="vertical-align: inherit;">So the following query:</font></font><br><br><pre> <code class="javascript hljs"> { posts { id title author { name } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It will give a result like this: </font></font><br><br><img src="https://habrastorage.org/webt/7y/qf/td/7yqftdszwm9v3logwzv0htn7vgg.png"><br><br><h3>  Conclusion </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I'm so glad I finished this lesson with you. </font><font style="vertical-align: inherit;">Now you know how to create GraphQL API based on Express and NodeJS. </font><font style="vertical-align: inherit;">I hope the lesson was interesting and you learned a lot from it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you want to learn more about GraphQL visit </font></font><a href="https://graphql.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">graphql.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div><p>Source: <a href="https://habr.com/ru/post/424199/">https://habr.com/ru/post/424199/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../424187/index.html">Conference DEFCON 22. Adrian Crenshaw. What can ‚Äúburn‚Äù users TOR</a></li>
<li><a href="../424189/index.html">Smart House? Or not smart ???</a></li>
<li><a href="../424191/index.html">Mobile watchman on Raspberry pi (h.264)</a></li>
<li><a href="../424193/index.html">International Astronautical Congress - as it was in Australia</a></li>
<li><a href="../424197/index.html">Into the MVPs furnace, we introduce MVPr (minimum viable prototype)</a></li>
<li><a href="../424201/index.html">How machine learning has helped me understand some aspects of early child development.</a></li>
<li><a href="../424203/index.html">Procedural building</a></li>
<li><a href="../424205/index.html">A1: 2017 - Injections (Part 2)</a></li>
<li><a href="../424207/index.html">Reading with a pencil in hand</a></li>
<li><a href="../424209/index.html">Wireless Finesse: Snom A170 Headset Overview</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>