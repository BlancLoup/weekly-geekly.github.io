<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ZFS and disk access speeds in hypervisors</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article publishes the results of measurements of the speed of access to the file system inside the hypervisor in various ZFS installation options...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ZFS and disk access speeds in hypervisors</h1><div class="post__text post__text-html js-mediator-article">  This article publishes the results of measurements of the speed of access to the file system inside the hypervisor in various ZFS installation options.  Anyone interested in asking for a cat, I warn you about the presence of a large number of images under the spoilers (optimized). <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/io/93/xw/io93xwfrzfhg0kodp0mku-p7s6u.png"><br><br>  Hello!  There are quite a few materials on the network devoted to the ZFS file system (hereinafter FS), its development in Linux and practical application.  I was very interested in this FS in the context of improving my home virtualization server (and also thanks to the <a href="https://habr.com/users/kvaps/" class="user_link">kvaps</a> user <a href="https://habr.com/users/kvaps/" class="user_link">post</a> ), but I could not find on the Internet (maybe looking bad?) Comparative tests of the performance of virtualized machines.  Therefore, I decided to put together a test platform for conducting my comparative study. <br><br>  My article does not pretend to any scientific discoveries, it is unlikely to help professionals who have been working with ZFS for a long time, and know all its capabilities, but it will help beginners to estimate the ‚Äúprice‚Äù of each gigabyte divided by performance. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/cw/tp/m2/cwtpm2ph_j0je3l7xd-vgbcr9gc.png" alt="image"><br><br>  The essence of the experiment was as follows: Proxmox VE 5.2 OS was installed on the machine (each time from the boot disk).  During installation, one of the XFS / ZFS options was selected.  After that, a virtual machine was created, on which Windows Server 2008 R2 was installed, after which the popular CrystalDiskMark 5.2.2 utility was launched and tests were performed on volumes 1, 4, <s>32 GiB</s> (due to the loss of images with the results of 32 GiB tests, decisions, available data are given for extras). <br><br>  The XFS FS test was used to measure the reference speed of a single railway (perhaps this is wrong, but I did not think of any other options). <br><br>  ZFS RAID 0, RAID 1 tests were conducted on two randomly selected drives, ZFS RaidZ1 on 3 drives, ZFS RAID 10, RaidZ2 on 4 drives.  Tests with ZFS RaidZ3 were not conducted due to the lack of desire to buy another extremely economically impractical HDD at 500GB. <br><br>  Under the spoiler, I‚Äôll briefly give descriptions of each type of ZFS RAID with my example of the resulting ‚Äúcommercial‚Äù gigabytes: <br><br><div class="spoiler">  <b class="spoiler_title">ZFS RAID</b> <div class="spoiler_text">  2 disks: <br><br><ul><li>  ZFS RAID 0 - striping, volume 2 * DiskSize = 1000GB. </li><li>  ZFS RAID 1 - mirroring (Mirror), volume 1 * DiskSize = 500GB. </li></ul><br>  3 drives: <br><br><ul><li>  ZFS RaidZ1 - aka ZFS RaidZ, analogue of RAID5, volume (N - 1) * DiskSize = 1000GB. </li></ul><br>  4 drives: <br><br><ul><li>  ZFS RAID 10 - Striped Mirroring (Striped Mirrored), volume 2 * DiskSize = 1000GB. </li><li>  ZFS RaidZ2 is an analog of RAID6, volume (N - 2) * DiskSize = 1000GB. </li><li>  at the same time, I did not conduct such a test, but ZFS RaidZ1 with 4 disks = 1500GB. </li></ul><br>  Very clearly painted the essence <a href="http://www.zfsbuild.com/2010/05/26/zfs-raid-levels/">here (English)</a> .  And also how many disks it is permissible to lose by saving information. <br></div></div><br>  It should be noted that in addition to the different access speeds of the file system, it is also necessary to take into account the total volume of the resulting array, and the reliability of data integrity in cases of hard drive failure. <br><br>  Technical characteristics of the platform, (possibly) affecting the test results: <br><br><ul><li>  Motherboard: Intel Desktop Board DS67SQ-B3; </li><li>  Processor: Intel Pentium G630 2.7GHz; </li><li>  RAM: 2 x 4096Mb Hynix PC3-10700; </li><li>  Hard drives: 3 x WD 5000AZRX 500GB SATA 64MB Cache, 1 x WD 5000AZRZ 500GB SATA 64MB Cache, SSD SATA Goldenfir T650-8GB; </li><li>  Power supply: DeepCool DA500N 500W. </li></ul><br>  A virtual machine (KVM) for tests was allocated 4GB of RAM, 1 processor core, and a VirtIO Block 100GB hard disk. <br><br><img src="https://habrastorage.org/webt/q9/mx/86/q9mx86d_t8ffn4bvbsynchogabg.png"><br><br>  For systems installed on ZFS, 2 tests were performed; in the second, SSD was connected as a cache disk. <br><br>  All results are presented in the form of screenshots below.  If anyone has a desire to digitize these results - I will be grateful and will include the results of the work in the article. <br><br><div class="spoiler">  <b class="spoiler_title">Xfs</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ay/la/a2/aylaa21icnmonx0t6tyq0k9hjlg.png"><br><img src="https://habrastorage.org/webt/xt/zp/y0/xtzpy0w4q7yh3897pgsl71lhcso.png"><br><img src="https://habrastorage.org/webt/_m/xk/ey/_mxkeylxdlnybd05j3qcdfbcbv0.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">ZFS RAID 0</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/1e/tl/dy/1etldytbqlnhmh_7-tz-3ic81oa.png"><br><img src="https://habrastorage.org/webt/5f/i_/ru/5fi_ruurkwiffmdx61uybbpdd-w.png"><br></div></div><div class="spoiler">  <b class="spoiler_title">ZFS RAID 0 + cache</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/sb/nd/tj/sbndtjiv-hnc2kew7asvixqpobu.png"><br><img src="https://habrastorage.org/webt/oh/b7/yr/ohb7yrzfcedod5z_myjon8ocrtk.png"><br><img src="https://habrastorage.org/webt/xf/ji/ze/xfjizerc9-w2gqal-hmm5qkdzgu.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">ZFS RAID 1</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yf/fe/64/yffe64pup3scltlsasvrhmyf08g.png"><br><img src="https://habrastorage.org/webt/9c/rf/pc/9crfpcyxgsuzffb_jvpv8ofbzv8.png"><br></div></div><div class="spoiler">  <b class="spoiler_title">ZFS RAID 1 + cache</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/wn/ib/u2/wnibu2g9lixtd7yibfd5upbvm0o.png"><br><img src="https://habrastorage.org/webt/s9/-v/tz/s9-vtzupnmzne6befyliubnpb4o.png"><br><img src="https://habrastorage.org/webt/ii/m3/-4/iim3-49apwe6iipwprs8uuas7tk.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">ZFS RAID 10</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/p-/gz/mm/p-gzmmaza6gppylaqroli4v3pau.png"><br><img src="https://habrastorage.org/webt/-e/d5/jq/-ed5jqimnwzi0dpclqwsaaoarry.png"><br><img src="https://habrastorage.org/webt/q_/hn/k5/q_hnk5guiajjytdlr1zckwpbpkm.png"><br></div></div><div class="spoiler">  <b class="spoiler_title">ZFS RAID 10 + cache</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hh/dl/g6/hhdlg6ccn0ftw61d3wo-1ko1gjy.png"><br><img src="https://habrastorage.org/webt/as/7e/ff/as7eff7569ocbpumlqanobdpd-g.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">ZFS RaidZ1</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yr/bh/fd/yrbhfdinmncnp24l6vmqmnkuwio.png"><br><img src="https://habrastorage.org/webt/pu/uu/i7/puuui7qrfwpvrxlfadpomg9wqbk.png"><br></div></div><div class="spoiler">  <b class="spoiler_title">ZFS RaidZ1 + cache</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5q/_d/ri/5q_dril_hulqtmgjosmu4cw7s1a.png"><br><img src="https://habrastorage.org/webt/jy/vr/0b/jyvr0bcpkegqsnsszxh4lr_df3s.png"><br><img src="https://habrastorage.org/webt/wl/hr/q-/wlhrq-aabvduwqy05zxj8a79m-u.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">ZFS RaidZ2</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5e/dv/f3/5edvf3wgrt7oqril5plkbjmqkqq.png"><br><img src="https://habrastorage.org/webt/p1/ar/lr/p1arlrbte_bh9qan_budkbncv5w.png"><br></div></div><div class="spoiler">  <b class="spoiler_title">ZFS RaidZ2 + cache</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dq/ih/pf/dqihpf02po3twpdlnkiqcpvpbem.png"><br><img src="https://habrastorage.org/webt/63/es/gl/63esglusobuwce65bj0n8buvmro.png"><br></div></div><br>  Thanks to everyone who has paid attention, I hope for someone this sample will be, like for me, useful. <br><br>  <b>PS</b> For reasons unknown to me, some of the images disappeared somewhere, measurements were taken at the end of spring, the test platform could not be assembled in that form, fortunately they all fall on 32 GiB tests. <br><br>  <b>PPS</b> I did not try to advertise any organizations and / or software products, I didn‚Äôt have a goal to violate licensing agreements, if I was wrong somewhere, please write in private messages. <br><br>  <b>PPPS</b> Image with ZFS logo is a reproduction. </div><p>Source: <a href="https://habr.com/ru/post/423453/">https://habr.com/ru/post/423453/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423437/index.html">The digest of interesting materials for mobile developer # 270 (September 10 - 16)</a></li>
<li><a href="../423439/index.html">Report of the Club of Rome 2018, Chapter 2.6: ‚ÄúPhilosophical Errors of Market Doctrine‚Äù</a></li>
<li><a href="../423441/index.html">Exonum first buyding: why we chose Java</a></li>
<li><a href="../423445/index.html">Creating an online store structure: category map</a></li>
<li><a href="../423447/index.html">GLPH: New Content Marketing Podcast</a></li>
<li><a href="../423455/index.html">Correct tablet</a></li>
<li><a href="../423457/index.html">Work as a team leader in the 2018th year</a></li>
<li><a href="../423459/index.html">Phoenix and Rails Differences through Convert Eyes</a></li>
<li><a href="../423461/index.html">Suborbital autumn</a></li>
<li><a href="../423463/index.html">As we wrote another RFM analysis algorithm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>