<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Power Raspberry Pi using Arduino</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many probably know that it‚Äôs not difficult to supply power to the Arduino from the Raspberry Pi, you just need a USB cable. The inverse problem looks ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Power Raspberry Pi using Arduino</h1><div class="post__text post__text-html js-mediator-article">  Many probably know that it‚Äôs not difficult to supply power to the Arduino from the Raspberry Pi, you just need a USB cable.  The inverse problem looks more complicated, since most Arduino controllers do not have a USB output (Due is an exception).  Nevertheless, it is possible to do this using GPIO pins, and I want to talk about a specific example for the Arduino Nano V3.0 and Raspberry Pi B rev.2.  In addition to the power supply itself, I will also tell you how you can control this power using a button and a MOSFET transistor. <br><a name="habracut"></a><br><h5>  <b>Theoretical opportunity</b> </h5><br>  Most Arduino-compatible controllers use 5V pins.  The only exception is the Arduino Due and 3.3V output from the Arduino, but this is not the case now.  It is also known that one of the ways to power the Raspberry Pi is to use 5V and GND pins on the 26-pin P1 connector: <br><img src="https://habrastorage.org/files/321/4db/acb/3214dbacba62401287f0b29c08e2012a.png"><br>  It would seem that the solution is obvious - you need to connect the Raspberry Pi to any of the Arduino pins, and everything will work.  My attempt to do this led to the fact that the Raspberry Pi lit the PWR LED, but the ACT LED did not light up.  The reason is a very small current strength from Arduino pins (about 40-50 mA).  But the Arduino has a separate pin 5V, which (according to the <a href="http://forum.arduino.cc/index.php%3Ftopic%3D3192.0">link</a> ) can produce about 400-500 mA.  Now you need to check whether there is enough such current to power the Raspberry. <br><br>  For normal power, the Raspberry Pi with two USB devices connected needs about 700 mA.  Each USB device can consume up to 140 mA ( <a href="http://www.raspberrypi.org/forums/viewtopic.php%3Ft%3D14153%26p%3D158827">source</a> ).  Raspberries can consume even more current if it is overclocked (mine is not).  Thus, if you use a non-overclocked RPi without USB devices, then the current strength from the Arduino 5V pin should be quite enough. <br><br>  In order to control the power supply, you need a few more ingredients: a power button and something that can control large currents.  I used a MOSFET transistor for this purpose.  We proceed directly to the used parts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  <b>Required hardware and software</b> </h5><br>  I used the following "iron" parts: <br><ul><li>  Raspberry Pi B rev.  2; </li><li>  Arduino Nano V3.0; </li><li>  button to control the power (I used the button with latching and signal wire); </li><li>  MOSFET transistor (I turned out to be IRF530N); </li><li>  Breadboard and several wires. </li></ul><br>  For the Arduino firmware, you need an IDE, I used version 1.5.8 BETA, but stable 1.0.6 is also suitable.  You will also need my small PowerButton library (link at the end of the article in the utility section). <br><br><h5>  <b>Scheme</b> </h5><br>  Connection diagram looks like this: <br><br><img width="500" src="https://habrastorage.org/files/e1c/66e/260/e1c66e260b3c4a9cb0263a7ccd483cde.png"><br><br>  The schematic diagram is as follows: <br><br><img width="500" src="https://habrastorage.org/files/1e6/690/48a/1e669048a62b4dc09450265553826e9d.png"><br><br>  Explanation of schemes: <br><br><ol><li>  D2 is connected to the SIG pin on the button. </li><li>  D4 is connected to the VCC pin on the button. </li><li>  D5 is connected to the MOSFET gate. </li></ol><br><br>  The connection with the D2 pin is not accidental: the library uses interrupts for the button, while the Arduino Nano only has the D2 / D3 pins for this purpose (you can check which pins on your Arduino support interrupts <a href="http://arduino.cc/en/Reference/attachInterrupt">here</a> ). <br><br><h5>  <b>Source code for the Arduino</b> </h5><br><blockquote>  <font color="#339900">#include &lt;PowerButton.h&gt;</font> <br><br>  <font color="#339900">#define POWER_PIN_SIG 2</font> <br>  <font color="#339900">#define POWER_PIN_VCC 4</font> <br>  <font color="#339900">#define POWER_FET_GATE 5</font> <br>  <font color="#339900">#define POWER_PIN_INT 0</font> <br><br>  PowerButtonSwitch pbs <font color="#008080">;</font> <br><br>  <font color="#0000ff">void</font> onPowerOn <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">{</font> <br>  Serial.  <font color="#007788">println</font> <font color="#008000">(</font> <font color="#FF0000">"Power On"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  digitalWrite <font color="#008000">(</font> POWER_FET_GATE, <font color="#0000dd">1</font> <font color="#008000">)</font> <font color="#008080">;</font>  <font color="#666666">// Open the gate (gate)</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">void</font> onPowerOff <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">{</font> <br>  Serial.  <font color="#007788">println</font> <font color="#008000">(</font> <font color="#FF0000">"Power Off"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  digitalWrite <font color="#008000">(</font> POWER_FET_GATE, <font color="#0000dd">0</font> <font color="#008000">)</font> <font color="#008080">;</font>  <font color="#666666">// Close the gate (gate)</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">void</font> setup <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">{</font> <br>  Serial.  <font color="#007788">begin</font> <font color="#008000">(</font> <font color="#0000dd">9600</font> <font color="#008000">)</font> <font color="#008080">;</font> <br><br>  <font color="#666666">// Output signal from Arduino to the gate MOSFET (gate)</font> <br>  pinMode <font color="#008000">(</font> POWER_FET_GATE, OUTPUT <font color="#008000">)</font> <font color="#008080">;</font> <br>  digitalWrite <font color="#008000">(</font> POWER_FET_GATE, <font color="#0000dd">0</font> <font color="#008000">)</font> <font color="#008080">;</font> <br><br>  <font color="#666666">// Initial Power Button Setup</font> <br>  pbs  <font color="#007788">setupPowerButton</font> <font color="#008000">(</font> POWER_PIN_SIG, POWER_PIN_VCC, POWER_PIN_INT <font color="#008000">)</font> <font color="#008080">;</font> <br><br>  <font color="#666666">// Read the current value</font> <br>  <font color="#666666">// If there is a signal from the button,</font> <br>  <font color="#666666">// turn on Raspberry Pi</font> <br>  <font color="#0000ff">int</font> st <font color="#000080">=</font> pbs.  <font color="#007788">getSwitchStatus</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> st <font color="#000080">==</font> POWER_ON <font color="#008000">)</font> <font color="#008000">{</font> <br>  onPowerOn <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#666666">// Add event handlers</font> <br>  pbs  <font color="#007788">onPowerOn</font> <font color="#008000">(</font> onPowerOn <font color="#008000">)</font> <font color="#008080">;</font> <br>  pbs  <font color="#007788">onPowerOff</font> <font color="#008000">(</font> onPowerOff <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">void</font> loop <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#666666">// Empty loop</font> <br>  delay <font color="#008000">(</font> <font color="#0000dd">1000</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  Serial.  <font color="#007788">println</font> <font color="#008000">(</font> <font color="#FF0000">"No actions"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> </blockquote><br><br>  Most of the actions are taken by the library, so the code is very simple. <br><br><h5>  <b>Testing the solution</b> </h5><br>  Short video with testing: <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/LtDZuefj5bM%3Ffeature%3Doembed&amp;xid=17259,1500004,15700022,15700043,15700186,15700190,15700253&amp;usg=ALkJrhhm5RLDddxQilQutX_o7PYS0ptTcQ" frameborder="0" allowfullscreen=""></iframe><br>  As you can see, visually everything works.  But still it is necessary to check the voltage between the pins TP1 / TP2 (method <a href="http://elinux.org/RPi_Hardware">here</a> ).  I got the value of ~ 4.6V, the recommended value is greater than 4.75V. <br><br><h5>  <b>Conclusion</b> </h5><br>  Despite the fact that everything works, there is still a suspicion that when connecting the periphery of the current from 5V, the Arduino pin will not be enough.  MOSFET and the button work fine in a pair, such a bundle can be useful for further projects. <br><br>  Utilities and libraries used for writing: <br><ul><li>  <b>Fritzing</b> : used for drawing diagrams, available <a href="http://fritzing.org/home/">here</a> . </li><li>  actually library for <b>PowerButton</b> : it is possible to take with GitHub <a href="https://github.com/fossid/Arduino/tree/master/PowerButton">here</a> . </li></ul><br><br>  Since this is my first post, reviews and comments will be very helpful. </div><p>Source: <a href="https://habr.com/ru/post/242739/">https://habr.com/ru/post/242739/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../242715/index.html">Blade syntax extension</a></li>
<li><a href="../242725/index.html">Automatic connection of network multifunction devices with the ability to scan [Part 2]</a></li>
<li><a href="../242727/index.html">Analyzing HTTP traffic with Mitmproxy</a></li>
<li><a href="../242729/index.html">Configuring Ruby Module</a></li>
<li><a href="../242731/index.html">Low cost, small, networked computers - a small overview</a></li>
<li><a href="../242741/index.html">Open vSwitch as a virtual network core</a></li>
<li><a href="../242743/index.html">Paul Graham: An Illogical Startup</a></li>
<li><a href="../242745/index.html">Robotics Expo 2014 Robotics Exhibition</a></li>
<li><a href="../242747/index.html">The introduction of the software product. Features of the business consultant. Part I</a></li>
<li><a href="../242749/index.html">The mechanics of informal communication of C # developers at the conference</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>