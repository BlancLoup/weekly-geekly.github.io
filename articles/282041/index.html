<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JS Loader + template engine or history of another</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I consider the invention of my ‚Äúunique‚Äù bicycle to be very useful if: it does not distract from work (or distracts, but not strongly); gives some new ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>JS Loader + template engine or history of another</h1><div class="post__text post__text-html js-mediator-article">  I consider the invention of my ‚Äúunique‚Äù bicycle to be very useful if: it does not distract from work (or distracts, but not strongly);  gives some new positive experience;  The results can be used somewhere;  The process itself is high.  I was repelled by this, starting to construct my ‚Äúgreat‚Äù about 3 years ago and, probably, 3-4 times rewriting it by today. <br><br><h4>  <b>It all started with bootloader and jq</b> </h4><br><a name="habracut"></a><br>  RequireJS is certainly a nice and very effective utility that allows you to organize a modular system on the client side very quickly and naturally.  And she suited me all, except for two things: <br><ul><li>  "appearance" </li><li>  caching system </li></ul><br>  By ‚Äúappearance‚Äù I mean that links to modules are placed in the argument string of the parent module. <br><br><pre><code class="javascript hljs">requirejs([<span class="hljs-string"><span class="hljs-string">"module_0"</span></span>, <span class="hljs-string"><span class="hljs-string">"module_1"</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">module_0, module_1</span></span></span><span class="hljs-function">) </span></span>{ });</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And when the modules became more and more - it turned into a disgrace. <br><br>  On the one hand, you can call the necessary module somewhere inside the code (if it is used very, very rarely), on the other - I would like to see all the dependencies of the parent module in one place. <br><br>  In addition, I was a little annoyed by the need to operate paths when declaring dependencies, rather than variables containing the necessary data.  No, you can, of course, somewhere, declare a global object with paths and bring everything to something like this (but it's still somehow ugly): <br><br><pre> <code class="javascript hljs">requirejs([modules.mod_0, modules.mod_1], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">module_0, module_1</span></span></span><span class="hljs-function">) </span></span>{ });</code> </pre><br><br>  As for managing the cache, it seemed to me, let's say, not explicit. <br><br>  Over time, my requirements for my loader began to emerge, and today they are formulated as follows: <br><ol><li>  All JS and CSS files should be cached, and the caching system should have clear and understandable control. </li><li>  modules declared throughout the application must be described in one specific place (single register). </li><li>  The declaration of module dependencies on each other should occur without the use of paths, and with the use of references to a single register (clause 2) or module names. </li><li>  there should be control over the order of loading modules, as well as the possibility of asynchronous paging of the necessary resources. </li></ol><br><br>  And that's what I did.  The kernel consists of three files, the names of which completely imply their purpose: <br><ul><li>  <a href="">flex.core.js</a> </li><li>  <a href="">flex.registry.modules.js</a> </li><li>  <a href="">flex.settings.js</a> </li></ul><br><br>  I note that you only need to connect [flex.core.js], and the register of modules and settings will be picked up automatically. <br><br>  But here is the first unpleasant news.  The developer is strictly bound to the file names and their location.  [flex.registry.modules.js] and [flex.settings.js] should be in the same place as the base module [flex.core.js], and their names cannot be changed. <br><br>  But since this is my great and while I am the only developer, this circumstance does not really bother me.  In addition, this organization suits me very much.  Already there are a dozen projects written using flex, and I always know where I can find the settings and the full list of modules used. <br><br>  So let's take a look at [flex.registry.modules.js] (the register of modules from a live project). <br><br><pre> <code class="javascript hljs"> flex.libraries = { <span class="hljs-comment"><span class="hljs-comment">//Basic binding controller binds : { source: 'KERNEL::flex.binds.js', hash: 'HASHPROPERTY' }, //Basic events controller events : { source: 'KERNEL::flex.events.js', autoHash: false }, //Collection of tools for management of DOM html : { source: 'KERNEL::flex.html.js' }, css : { //Controller CSS animation animation : { source: 'KERNEL::flex.css.animation.js'}, //Controller CSS events events : { source: 'KERNEL::flex.css.events.js' }, }, //Collection of UI elements ui : { //Controller of window (dialog) window : { //Controller of window movement move : { source: 'KERNEL::flex.ui.window.move.js' }, //Controller of window resize resize : { source: 'KERNEL::flex.ui.window.resize.js' }, //Controller of window resize focus : { source: 'KERNEL::flex.ui.window.focus.js' }, //Controller of window maximize / restore maximize: { source: 'KERNEL::flex.ui.window.maximize.js' }, }, //Controller of templates templates : { source: 'KERNEL::flex.ui.templates.js' }, //Controller of patterns patterns : { source: 'KERNEL::flex.ui.patterns.js' }, //Controller of scrollbox scrollbox : { source : 'KERNEL::flex.ui.scrollbox.js' }, //Controller of itemsbox itemsbox : { source: 'KERNEL::flex.ui.itemsbox.js' }, //Controller of areaswitcher areaswitcher: { source: 'KERNEL::flex.ui.areaswitcher.js' }, //Controller of areascroller areascroller: { source: 'KERNEL::flex.ui.areascroller.js' }, //Controller of arearesizer arearesizer : { source: 'KERNEL::flex.ui.arearesizer.js' }, }, presentation: { source: 'program/presentation.js' }, };</span></span></code> </pre><br><br>  As you can see, this is just a list of all modules used in the application.  If you noticed, then for each module we can define a couple of variables (besides the [source] path itself): <br><ul><li>  [string] hash is a string that serves for ‚Äúmanual‚Äù cache management.  As long as this line remains unchanged, the module will be loaded from the cache.  But as soon as we change its value, the module will be updated. </li><li>  [bool] autoHash - allows you to completely disable the caching of the specified module.  The fact is that if the [hash] line is not set, then flex will manage the cache automatically, and to exclude any module from caching at all, it is enough to define [autoHash = false] for it. </li></ul><br><br>  Another point that you probably noticed is grouping.  The modules are not presented through the list, but are divided into groups, which makes the whole modular system as a whole more meaningful and transparent. <br><br>  Well, once again just in case - this is just a register (list) of modules.  The definition of a module here does not mean that it will be loaded.  Loading is otherwise regulated. <br><br>  Go ahead.  Let's look at the settings.  File [flex.settings.js] from a working site. <br><br><pre> <code class="javascript hljs">flex.init({ <span class="hljs-attr"><span class="hljs-attr">resources</span></span>: { <span class="hljs-attr"><span class="hljs-attr">MODULES</span></span>: [ <span class="hljs-string"><span class="hljs-string">'presentation'</span></span>, <span class="hljs-string"><span class="hljs-string">'ui.patterns'</span></span> ], <span class="hljs-attr"><span class="hljs-attr">EXTERNAL</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'/program/body.css'</span></span>, <span class="hljs-attr"><span class="hljs-attr">hash</span></span>: <span class="hljs-string"><span class="hljs-string">'HASHPROPERTY'</span></span> }, ], <span class="hljs-attr"><span class="hljs-attr">ASYNCHRONOUS</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">resources</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'/program/highcharts/highcharts.js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">after</span></span>: [<span class="hljs-string"><span class="hljs-string">'http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js'</span></span>] }, { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'/program/highcharts/highcharts-more.js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">after</span></span>: [<span class="hljs-string"><span class="hljs-string">'/program/highcharts/highcharts.js'</span></span>] }, { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'/program/highcharts/exporting.js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">after</span></span>: [<span class="hljs-string"><span class="hljs-string">'/program/highcharts/highcharts.js'</span></span>] }, ], <span class="hljs-attr"><span class="hljs-attr">storage</span></span> : <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">finish</span></span> : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//Do something } } ], }, events: { onFlexLoad: function () { //Do something }, onPageLoad: function () { var presentation = flex.libraries.presentation.create(); presentation.start(); } }, settings: { CHECK_PATHS_IN_CSS: true }, logs: { SHOW: ['CRITICAL', 'LOGICAL', 'WARNING', 'NOTIFICATION', 'LOGS', 'KERNEL_LOGS'] } });</span></span></code> </pre><br><br>  Here, too, everything is quite simple. <br><br>  In the section with the speaker name [MODULES] the list of those modules that must be loaded before the start of the entire application is defined.  Please note that we specify not the links, but the names of the modules in accordance with the register, that is, as defined in [flex.registry.modules.js] (excluding ‚Äúflex.libraries‚Äù). <br><br>  The array [EXTERNAL] contains a list of those resources that should be loaded at a given URL.  Just like in the list of modules, here you can operate with such properties as [hash] and [authHash] to manage the cache of a single resource. <br><br>  The [ASYNCHRONOUS] section is actually the same as [EXTERNAL], but: first, it starts loading right away (without waiting for the main modules to load);  secondly, here we have the ability to predetermine the order of loading.  In this particular example, the [highcharts.js] file will not load until the JQ library is loaded. <br><br>  In addition, in the [ASYNCHRONOUS] section, we can define any number of resource groups (bundles) with our own handlers for loading completion (event [finish]). <br><br>  Resources from the [ASYNCHRONOUS] section are also cached, but cache management is less flexible here.  We can only turn it on or off, determining the value of the [storage: true / false] property. <br><br>  Very large in the boot process is as follows: <br><ol><li>  Loading flex.core.js </li><li>  Catching flex.registry.modules.js, flex.registry.events.js and flex.settings.js </li><li>  Start loading modules defined in [MODULES] and here start loading all that is in [ASYNCHRONOUS] </li><li>  Creating a list of dependencies (modules and resources requested by modules from [MODULES]).  Download all required modules and resources. </li><li>  Upon completion of loading modules from [MODULES] (along with dependencies) start loading resources from [EXTERNAL] </li><li>  Upon completion of loading all of the [EXTERNAL] and [ASYNCHRONOUS] (if the settings indicate that you need to expect asynchronously loaded resources) call the event [onFlexLoad] and wait for the event [onPageLoad] </li></ol><br><br>  That's actually the whole boot process. <br><br>  I intentionally made a division into three groups [MODULES], [EXTERNAL] and [ASYNCHRONOUS].  This approach allows me to clearly and clearly see that there is a part of the current application, and that there are third-party solutions used in the project. <br><br><h4>  <b>What else is <a href="">flex.registry.events.js</a> ?</b> </h4><br><br>  This file is part of a common system, but it comes in handy only when some of the libraries I have already written are used.  Here is its content: <br><br><pre> <code class="javascript hljs">flex.registry.events = { <span class="hljs-comment"><span class="hljs-comment">//Events of UI ui: { //Events of scrollbox scrollbox : { GROUP : 'flex.ui.scrollbox', REFRESH : 'refresh', }, //Events of itemsbox itemsbox : { GROUP : 'flex.ui.itemsbox', REFRESH : 'refresh', }, //Events of arearesizer arearesizer : { GROUP : 'flex.ui.arearesizer', REFRESH : 'refresh', }, window : { //Events of window resize module resize : { GROUP : 'flex.ui.window.resize', REFRESH : 'refresh', FINISH : 'finish', }, //Events of window maximize / restore module maximize: { GROUP : 'flex.ui.window.maximize', MAXIMIZED : 'maximized', RESTORED : 'restored', CHANGE : 'change', } } }, //Events of Flex (system events) system: { //Events of logs logs: { GROUP : 'flex.system.logs.messages', CRITICAL : 'critical', LOGICAL : 'logical', WARNING : 'warning', NOTIFICATION: 'notification', LOGS : 'log', KERNEL_LOGS : 'kernel_logs', }, cache: { GROUP : 'flex.system.cache.events', ON_NEW_MODULE : 'ON_NEW_MODULE', ON_UPDATED_MODULE : 'ON_UPDATED_MODULE', ON_NEW_RESOURCE : 'ON_NEW_RESOURCE', ON_UPDATED_RESOURCE : 'ON_UPDATED_RESOURCE', } } };</span></span></code> </pre><br><br>  As you may have guessed, these are just event identifiers in the kernel and modules.  Why did I put it in a separate file?  To create a certain level of abstraction and to enable the modules to "communicate" with each other.  In addition, having such a register in public space, the developer gets a wonderful opportunity to respond to interesting events: <br><br><pre> <code class="javascript hljs">flex.events.core.listen( flex.registry.events.ui.window.resize.GROUP, flex.registry.events.ui.window.resize.REFRESH, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">node, area_id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//Do something } );</span></span></code> </pre><br><br>  Well, finally it is time to look at the template module and if you are not yawning from boredom, then here it is: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> protofunction = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//Constructor of module }; protofunction.prototype = function () { //Module body var //Get modules html = flex.libraries.html.create(), events = flex.libraries.events.create(); return { //Some methods }; }; flex.modules.attach({ name : 'ui.itemsbox', protofunction : protofunction, reference : function () { flex.libraries.events(); flex.libraries.html(); }, resources : [ { url: 'KERNEL::/css/flex.ui.itemsbox.css' } ], });</span></span></code> </pre><br><br>  All magic, as it is not difficult to guess, is hidden in the method [flex.modules.attach].  Let's go over it by properties. <br><ul><li>  name is how our module is called and this [name] should correspond to the name defined in the register, the volume itself [flex.registry.modules.js]. </li><li>  protofunction is actually our module.  It may have its own constructor, which will be initiated only once, during module initialization. </li><li>  references is the place where the dependencies are defined.  Notice how they are defined: there are no string values.  By the time your module starts loading, the register of modules will already contain function calls.  That is, the execution of [flex.libraries.events ()] will cause the [events] module to be loaded and initialized before this module is initialized. </li><li>  The resources array is the local (for the module) analogue of [EXTERNAL] from the [flex.settings.js] settings.  Here you are free to determine the list of resources (JS and / or CSS) that must be loaded before the module is initialized. </li><li>  In addition, you can also define two events [onBeforeAttach] and [onAfterAttach] that will trigger before and after module initialization, respectively. </li></ul><br><br>  The modules themselves can be called anywhere in the code using our register, namely via the - create function, for example: html = flex.libraries.html.create (), after which the html variable will become a reference to the functionality of the called module. <br><br>  So, here is the main part of how the modular system is organized using my flex-bike.  There is one place where modules are described;  there is a place where the settings are specified and the application is launched;  and there are modules themselves. <br><br>  For very small projects (literally with a pair, with a triple of modules) such a system may seem redundant, and I think that this is the way it is.  However, to solve such problems, we can not define the register and settings at all, that is, not create the files flex.registry.modules.js and flex.settings.js.  In this case, the creation of modules will be very much like the way RequireJS does it: <br><br><pre> <code class="javascript hljs">_append({ <span class="hljs-attr"><span class="hljs-attr">name</span></span> : <span class="hljs-string"><span class="hljs-string">'Base.B'</span></span>, <span class="hljs-attr"><span class="hljs-attr">require</span></span> : [ { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'ATTACH::D_file.js'</span></span> }, ], <span class="hljs-attr"><span class="hljs-attr">module</span></span> : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-comment"><span class="hljs-comment">//Get modules. D = flex.libraries.D.create(); //Module body return { //Module methods }; }, });</span></span></code> </pre><br><br>  As you can see, despite the fact that the register file <a href="">flex.registry.modules.js is</a> not used, the list of modules is still created and they are called the same as for regular modules using the create function. <br><br>  The only difference is that now we are forced to specify dependencies in the form of links (paths), which for small projects is certainly not critical. <br><br>  Also, without the configuration file <a href="">flex.settings.js, the</a> question of launching the application arises, because the onFlexLoad and onPageLoad events are not defined.  This issue is resolved with the help of the launched module: <br><br><pre> <code class="javascript hljs">_append({ <span class="hljs-attr"><span class="hljs-attr">name</span></span> : <span class="hljs-string"><span class="hljs-string">'A'</span></span>, <span class="hljs-attr"><span class="hljs-attr">require</span></span> : [ { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'ATTACH::B_file.js'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'ATTACH::C_file.js'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'ATTACH:css/B_file.css'</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">launch</span></span> : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-comment"><span class="hljs-comment">//Get modules. B = flex.libraries.Base.B.create(), C = flex.libraries.C.create(); //Do something } });</span></span></code> </pre><br><br>  That is, replacing the [module] property with the [launch] property, we will create a launch module, which, of course, there can be only one in the application. <br><br>  In addition, you can also group your modules.  Notice how the module name [B] - ‚ÄúBase.B‚Äù is defined.  This means that the ‚ÄúBase‚Äù group will be created and our module [B] will be attached to it. <br><br><h4>  <b>A little more about boring and the most interesting</b> </h4><br>  Naturally, you may have a question: ‚ÄúCycling is, of course, useful, but bro, you just repeated everything that RequireJS does.  What for?". <br><br>  All for two things: the first is ordering (via the settings file and a single register of modules), and the second is caching. <br><br>  Flex does not rely on standard browser caching, using local storage for this purpose - localStorage.  Suppose we have in the system from 20 to 30 modules (depending on the page).  In the first launch of the application, everything will be connected by creating a banal &lt;script&gt; and &lt;link&gt; for JS-files and CSS-files, respectively.  But at the same time in the background flex will try to ‚Äúextract‚Äù the content of all resources (the contents of the files).  After receiving it, flex will save it and link it to specific URLs for which they (resources) were requested.  And already from the second page load there will be not 20 - 30 calls to the server for files, but only 4 (for flex.core.js, settings, module register and event register).  Everything else will be taken from localStorage and integrated into the page, which most favorably affects the download speed of the entire application. <br><br>  But that's not all.  Caching can be controlled either manually (by setting hashes for various modules) or by entrusting this routine to flex, which, after the final page load in the background, produces a ‚Äúsurvey‚Äù of HEADERs at the URL of all resources, trying to determine the file size and the date it was created ( changes).  Based on the data received, flex initializes the update of the module (or resource) whose parameters have changed, thus keeping the entire system up to date. <br><br>  I, probably, already very tired you, but now there will be the most interesting.  I hope) <br><br><h4>  <b>Templates</b> </h4><br>  All that I have met with respect to templates in one way or another relies on the server part.  I admit that I looked badly (with my scanty experience), but what I found was loading the template every time I opened the page again and again. <br><br>  I didn't like it very much.  After all, if the template is more or less permanent, wouldn't it be easier to keep it on the client side and update it only when necessary? <br><br>  One more thing that I always wanted to have was the opportunity not only to see the template separately from the application, but to launch it ‚Äúin isolation‚Äù from the page.  For example, we have an authorization window template - I would like in a couple of clicks to open a page on which only this template would be.  What for?  Quickly debug styles, for example, or quickly catch a bug in the code. <br><br>  According to the results of long reflections, the following requirements for the template controller were derived: <br><ul><li>  The template file can be opened in the browser as a separate page. </li><li>  The template can be initialized with test content for debugging in standalone mode. </li><li>  The template should be cached and updated only when necessary (if there are changes on the server side).  The same applies to all template resources (JS and CSS files). </li></ul><br><br>  In general, let's see what happened (controller - <a href="">flex.ui.patterns.js</a> ). <br><br>  The main template file is trite html file.  Like this one, for example: <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/xhtml"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Flex.Template<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Content-Type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=utf-8"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pattern.css"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"controler.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Pattern.Login"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Login<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {{login}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Password<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {{password}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Pattern.Controls"</span></span></span><span class="hljs-tag">&gt;</span></span>{{controls}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  That is, task # 1 on opening the template as a file has already been solved (which allows the developer to very quickly debug the styles). <br><br>  Please note that styles and scripts are connected in the most usual way, via link and script.  Here it should also be noted that it is ‚Äúmore beautiful‚Äù (in my opinion) to lay out templates in separate folders. <br><br>  Next, let's take an example.  Create a pop-up window to authorize the user.  We will need several templates (to save space, I cite only the contents of the &lt;body&gt; tag). <br><br>  (A) Popup Template <br><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Popup"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-flex-ui-window-move-container</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{id}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-flex-ui-window-resize-position-parent</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{id}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-flex-ui-window-maximize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{id}}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Popup.Container"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-flex-ui-window-resize-container</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{id}}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Popup.Title"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-flex-ui-window-move-hook</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{id}}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Popup.Title"</span></span></span><span class="hljs-tag">&gt;</span></span>{{title}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Popup.Title.Switcher"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"max"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-flex-window-maximize-hook</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{id}}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Popup.Content"</span></span></span><span class="hljs-tag">&gt;</span></span>{{content}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Popup.Bottom"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Popup.Bottom"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"test_bottom_id"</span></span></span><span class="hljs-tag">&gt;</span></span>{{bottom}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Window.Resize.Coner"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  (B) An authorization window template (it was already slightly higher) <br><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Pattern.Login"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {{login}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {{password}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Pattern.Controls"</span></span></span><span class="hljs-tag">&gt;</span></span>{{controls}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  (C) Text field template <br><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>{{::value}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TextInput.Wrapper"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TextInput.Container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TextInput"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{type}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{::value}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestInput"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  (D) And the pattern of buttons <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Buttons.Flat"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{id}}"</span></span></span><span class="hljs-tag">&gt;</span></span>{{title}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  By syntax there are a couple of moments.  The curly brackets {{controls}} specify hooks.  Yes, borrowed from WordPress.  In double-colon braces, {{:: value}} specify the data that must be linked to the DOM tree and placed in the model.  See everything later. <br><br>  So, the call (assembly) of the final template will look like this: <br><br><pre> <code class="javascript hljs">_node(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body).ui().patterns().append({ <span class="hljs-attr"><span class="hljs-attr">url</span></span> : <span class="hljs-string"><span class="hljs-string">'/patterns/popup/pattern.html'</span></span>, <span class="hljs-comment"><span class="hljs-comment">//A hooks : { id : id, title : 'Login popup', content : patterns.get({ url : '/patterns/patterns/login/pattern.html',//B hooks : { login : patterns.get({ url : '/patterns/controls/textinput/pattern.html',//C hooks : { type: 'text' } }), password: patterns.get({ url : '/patterns/controls/textinput/pattern.html',//C hooks : { type: 'password' } }), controls: patterns.get({ url : '/patterns/buttons/flat/pattern.html',//D hooks : [{ title: '', id: 'login_button' }, { title: '', id: 'cancel_button' }] }), }, resources: { one: 'one', two: 'two' }, }) }, callbacks: { success: function (model, binds, map, resources) { var instance = this; } }, });</span></span></code> </pre><br><br>  After executing this method, the authorization window will be ‚Äúcollected‚Äù and attached to the body tag.  Of course, the method works asynchronously (after all, at least when you first load the page, you have to contact the server for the template files), so it returns nothing. <br>  Pay attention to the arguments to the success callback function (from the callbacks section).  Let's take a closer look - there are useful things inside. <br><br>  <b>model</b> is a link to a model that was compiled for this particular instance of the template.  If you look at the ¬© text box template, you will see that we have linked the value of input.value and span.innerHTML (located in the first paragraph).  Now, if the value of the text field changes, the inscription above it will change.  In addition, you can "get into the model" and change the value of input.value through the model, namely: <br><ul><li>  model .__ content __.__ login __. value (for login) </li><li>  model .__ content __.__ password __. value (for a password). </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notice that the properties framed in a double underline __something__ repeat the nesting of the template (its structure). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">binds</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> its structure completely repeats the model. That is, binds will also be model .__ content __.__ login __. Value and model .__ content __.__ password __. Value. But only now you will not have access to the value of the [value] property, but two methods: addHandle (handle) and removeHandle (id). As you have already guessed, we can ‚Äúpick up‚Äù a handler that will work both when the model is changed directly (by changing the model properties), or if the DOM (that is, the input value) changes. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">map</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- these are links to parent nodes for each hook. In other words, this is the node map for this particular template. It can be used for different purposes, but personally it comes in handy for me to indicate the context when searching for nodes through selectors. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And the last is </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resources</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is just an auxiliary object. Look at the method that creates the template. As you can see, there is a similar property. That's it will be returned here. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now let's go back to the first example. As I said, we are free to connect any number of JS and CSS resources to the template.</font></font><br><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pattern.css"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"controler.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Template initialization will be started only after all resources are loaded. Well, it goes without saying, everything is ‚Äústored‚Äù in localStorage and, if possible, comes from there instead of requests to the server. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But in this particular case, the important thing is not the ability to connect JQ to a single template, but the controller.js file. He, by the way, can be called whatever you like, the main thing is inside. And inside - the controller:</font></font><br><br><pre> <code class="javascript hljs">_controller(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">model, binds, map, resources</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> instance = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, clone = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; clone = instance.clone({ <span class="hljs-attr"><span class="hljs-attr">id</span></span> : <span class="hljs-string"><span class="hljs-string">'clonned_pattern'</span></span>, <span class="hljs-attr"><span class="hljs-attr">title</span></span> : <span class="hljs-string"><span class="hljs-string">'Clonned dialog window'</span></span>, <span class="hljs-attr"><span class="hljs-attr">content</span></span> : { <span class="hljs-attr"><span class="hljs-attr">login</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'text'</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">password</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'password'</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">controls</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">'login'</span></span>, <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">'login_button'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">'cancel'</span></span>, <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">'cancel_button'</span></span> }], } }); <span class="hljs-comment"><span class="hljs-comment">//Do something; });</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I have already introduced you to the controller arguments (they are the same as in callbacks.success). I can only add that, having received a copy of the template, you can create its clones. Notice that the clone creation syntax is greatly simplified compared to template initialization. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The controller will be called every time not only when the template is initialized, but when creating a clone. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And finally, about what it was all about. If we have a simple template (without nesting and controllers), then we can open it with the browser simply as an html file and debug the styles. Fast and efficient. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If our template is nested, and even a controller, then for debugging we just need to create a separate html-file for the test. Its creation is the advantage of copy / paste.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Test file for our example with a pop-up authorization window </font></font><br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../../kernel/flex.core.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">flexPatternTest</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> id = flex.unique(), patterns = flex.libraries.ui.patterns.create(), _pattern = patterns.get({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">url</span></span></span><span class="javascript"> : </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'/patterns/popup/pattern.html'</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">node</span></span></span><span class="javascript"> : </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.body, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">hooks</span></span></span><span class="javascript"> : { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">id</span></span></span><span class="javascript"> : id, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">title</span></span></span><span class="javascript"> : </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'Test dialog window'</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">content</span></span></span><span class="javascript"> : patterns.get({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">url</span></span></span><span class="javascript"> : </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'/patterns/patterns/login/pattern.html'</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">hooks</span></span></span><span class="javascript"> : { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">login</span></span></span><span class="javascript"> : patterns.get({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">url</span></span></span><span class="javascript"> : </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'/patterns/controls/textinput/pattern.html'</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">hooks</span></span></span><span class="javascript"> : { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">type</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'text'</span></span></span><span class="javascript">, } }), </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">password</span></span></span><span class="javascript"> : patterns.get({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">url</span></span></span><span class="javascript"> : </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'/patterns/controls/textinput/pattern.html'</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">hooks</span></span></span><span class="javascript"> : { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">type</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'password'</span></span></span><span class="javascript">, } }), </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">controls</span></span></span><span class="javascript"> : patterns.get({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">url</span></span></span><span class="javascript"> : </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'/patterns/buttons/flat/pattern.html'</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">hooks</span></span></span><span class="javascript"> : [{ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">title</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'login'</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">id</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'login_button'</span></span></span><span class="javascript"> }, { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">title</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'cancel'</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">id</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'cancel_button'</span></span></span><span class="javascript"> }] }), } }) }, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">callbacks</span></span></span><span class="javascript">: { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">success</span></span></span><span class="javascript">: </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">model, binds, map, resources</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> instance = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">, } } }).render(); }; flexPatternTest.include = [ </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'ui.window.move'</span></span></span><span class="javascript">, </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'ui.window.resize'</span></span></span><span class="javascript">, ]; flexPatternTest.exclude = [ </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'flex.presentation'</span></span></span><span class="javascript">, ]; </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All we did was ‚Äúhook‚Äù flex and define a function [flexPatternTest]. </font><font style="vertical-align: inherit;">As soon as flex finishes initializing, an attempt will be made to find this function and start it. </font><font style="vertical-align: inherit;">Profit - your template is running with all the necessary infrastructure in the ‚Äústandalone‚Äù mode. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I note that as can be seen from the example, you can exclude individual modules from the download, as well as include the necessary ones through the [exclude] and [include] properties, respectively. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first ‚Äúbuild‚Äù of the sample template shown takes on average 200 to 300 ms; </font><font style="vertical-align: inherit;">the next 100 - 150 ms. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Directly template controller ( </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flex.ui.patterns.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) first extracts the contents of the &lt;body&gt; tag (which allows us to transfer only this tag to the template HTML files (if no JS or CSS connection is required)); then builds the DOM tree of the template and performs all further manipulations only with the DOM tree. This mode of operation is at least 10-15% (according to my observations) slower if regular expressions were used to manipulate the contents of innerHTML. However, I tried to balance performance as much as possible and ‚Äúdelay‚Äù the moment I started working with DOM to the last. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And yet, for tasks, where even if there is nesting of templates, but there is no need for either the model, or the DOM card of the assembled template, or the controller, I made a template-light - </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flex.ui.templates.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The difference is exactly in the approach, if flex.ui.patterns.js mainly works with the DOM tree, then flex.ui.templates.js lasts as long as possible with regular expressions, replacing hooks in innerHTML and ‚Äúcollecting‚Äù the DOM tree only last moment. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is a controller (s) of templates I have turned out. </font><font style="vertical-align: inherit;">But, we go further.</font></font><br><br><h4> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And what does JQ have to do with it?</font></font></b> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indeed at the very beginning I mentioned the jQuery library. </font><font style="vertical-align: inherit;">I have very mixed feelings for her. </font><font style="vertical-align: inherit;">On the one hand, it is incredibly comfortable. </font><font style="vertical-align: inherit;">On the other hand, I sometimes come across such code (written in the JQ style), with such chains, that I want to shoot myself before shooting the developer. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, there is no perfect code, but, as it seems to me, JQ strongly relaxes something.</font></font> I do not know.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In general, whenever possible, I strive to refuse from JQ and not to apply it in projects. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, such a cool thing as the mentioned call chains I like, but not as it is implemented in JQ. </font><font style="vertical-align: inherit;">I like the concept itself, that there is some kind of wrapper function that checks or converts an input object, and then provides the ability to call various methods that will be applied to it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Therefore, I have defined five types of input objects:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> _node - one node; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> _nodes - many nodes; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> _array - array; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> _object - object; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> _string is a string. </font></font></li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">These are global "wrappers". </font><font style="vertical-align: inherit;">They can be called from anywhere in the code and do something like this:</font></font><br><br><pre> <code class="javascript hljs">_nodes(<span class="hljs-string"><span class="hljs-string">'.buttons'</span></span>).events().add(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//Do something }); var pos = _node('#this_button').html().position().byPage(); _object(some_object).forEach(function (key, value) { //Do something });</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For me the moment of grouping was very important. </font><font style="vertical-align: inherit;">As you can see, the function of determining the position of a node on a page is in the [html.position] group, and the function of adding an event handler in the [events] group. </font><font style="vertical-align: inherit;">In my subjective opinion, this makes the code more clear, because the same position can be defined both as [byPage ()] and as [byWindow ()]. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is more, adding a new functional is a very simple and not intricate business. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, we will make two methods: concealment and display of a node.</font></font><br><br><pre> <code class="javascript hljs">flex.callers.define.node(<span class="hljs-string"><span class="hljs-string">'html.hide'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target.__previous_display = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target.style.display; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target.style.display = <span class="hljs-string"><span class="hljs-string">'none'</span></span>; } }); flex.callers.define.node(<span class="hljs-string"><span class="hljs-string">'html.show'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target.style.display = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target.__previous_display !== <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target.__previous_display : <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target.__previous_display; } });</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And now we can use the newly created methods. </font></font><br><br><pre> <code class="javascript hljs">_node(<span class="hljs-string"><span class="hljs-string">'.buttons'</span></span>).html().hide(); _node(<span class="hljs-string"><span class="hljs-string">'.buttons'</span></span>).html().show();</code> </pre><br><br><h4>  <b>***</b> </h4><br>  Here you go.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now everything seems to be. I really hope that you have not fallen asleep, and if you have fallen asleep, you slept enough (that is a holiday for people of our profession). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is important to understand that everything described above was developed "by itself", so there is no whatever acceptable documentation and description of the API, although there are files on github that create the necessary code highlighting (intellisense) for Visual Studio. It is because of them, assholes, I still have not forced myself to describe the API - because everything is highlighted.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, there are probably a lot of bugs and places in the project for optimization, because it is used very ‚Äúparochially‚Äù, which simply cannot cover many applications where any flaws could be revealed. </font><font style="vertical-align: inherit;">There are unresolved problems. </font><font style="vertical-align: inherit;">For example, when creating a table template, all hooks inside &lt;table&gt; should be defined as html-comments - &lt;! - {{rows}} -&gt;. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I am very excited on the eve of your reaction, but I will try to control myself. </font><font style="vertical-align: inherit;">Anyway, thanks for your attention.</font></font><br><br>  PS <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Several links: </font></font><br><ul><li>  <a href="https://github.com/DmitryAstafyev/Flex-v.2/tree/master/Flex/kernel">github</a> </li><li>  <a href="http://flex.astafyev.net/">promo</a> </li><li> <a href="http://charts.astafyev.net/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">example</font></font></a> </li></ul><br><br>  Pps <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Forgot, there is an incomplete </font></font><a href="https://github.com/DmitryAstafyev/Flex-v.2/wiki"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in bad English</font></font></div><p>Source: <a href="https://habr.com/ru/post/282041/">https://habr.com/ru/post/282041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282031/index.html">8 mistakes when developing a mobile application</a></li>
<li><a href="../282033/index.html">April 23-24, from 12:00 to 12:00, we invite you to # 1 Global Chatbots Hackathon from Webinar.ru</a></li>
<li><a href="../282035/index.html">Weak [weak] links in the new version of Delphi</a></li>
<li><a href="../282037/index.html">We do multitasking</a></li>
<li><a href="../282039/index.html">Moscow Python Meetup ‚Ññ34 (April 27)</a></li>
<li><a href="../282043/index.html">On the development of non-paged keys based on passwords</a></li>
<li><a href="../282045/index.html">Scaling to 100 million: architecture defined by service level</a></li>
<li><a href="../282047/index.html">Evolution of viruses: from student fun to disruption of Iran‚Äôs nuclear program</a></li>
<li><a href="../282049/index.html">Preemptivity: how to take away the processor</a></li>
<li><a href="../282053/index.html">Andrei Ershov: ‚ÄúTwo Views of Programming‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>