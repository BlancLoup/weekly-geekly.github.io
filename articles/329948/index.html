<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Non-recursive algorithm for generating all partitions and compositions of an integer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! Suddenly again I wanted to write here! Since there was time on the weekend, I again decided to play around with the algorithmization and wro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Non-recursive algorithm for generating all partitions and compositions of an integer</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  Suddenly again I wanted to write here!  Since there was time on the weekend, I again decided to play around with the algorithmization and wrote this article here.  I even wanted to send to some peer-reviewed journal, but I cannot assess the triviality / non-triviality of this material, since programming is just my hobby and that is episodic, therefore, as usual, I apologize in advance if everything is too simple and painful familiar. <br><br>  <i>Thanks to the administration of Habr for responsiveness and lightning speed when restoring an account!</i> <br><br>  <b>So, the fruits of long effort ...</b> <br><a name="habracut"></a><br>  Non-recursive algorithm for generating all partitions of an integer in the lexicographic <br>  the order when all elements are arranged in descending order is alternative;  at <br>  The Internet provides several ways to generate combinatorial data. <br>  objects, however, as is true of other combinatorial algorithms, <br>  implementations are reduced to two types - non-recursive and recursive.  You can often meet <br>  implementations that do not take into account the order of output of objects or carry out <br>  output on the principle of splitting numbers. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The following implementation works in the opposite way: the initial number is initially divided into units, the algorithm works until the number in the zero index of the array becomes equal to the sum of the initial number.  A feature of this algorithm is that it is extremely easy to understand, but this does not deprive it of some specific features: <br><br>  1) The first object is simply displayed on the screen at the very beginning, so it is moved beyond the limits of the cycles, in fact it is initializing; <br>  2) There are several ways to implement unit transfer, which can both simplify the code and make it more confusing; <br>  3) This non-recursive implementation can serve as a good example to explain the generation of combinatorial objects on multiple processors, after minor modifications.  To divide generation into processors, it is enough: a) to determine the element by its number and make it initializing;  b) determine the time to stop work.  For example, if the number of objects generated on a single processor is known, then it is enough to enter another incremental variable in the upper cycle and change the condition for exiting the uppermost cycle when the required number is reached. <br><br>  The PHP code is shown only to demonstrate the correctness of the algorithm and may contain unnecessary language features that add redundancy implementations. <br><br>  <b>Algorithm Description</b> <br><br>  It is given: the initial array in the form of units - <b> (1,1,1,1,1).</b> <br><br>  <b>Steps</b> <br>  0) If we get the sum (in the case of implementation below, if the zero index is equal to the sum of the number), then the algorithm stops. <br><br>  1) Moving along the array from left to right, look in array A for the first minimal element - x, <br>  the last element is not taken into account (does not participate in the search for the minimum). <br>  2) Move the unit from the end (last element) to the minimum element x found <br>  (equivalent to increasing x by one and decreasing by one the last element). <br>  <s>3 <b>)</b> If in array A there is zero - 0, then delete the last element.</s> <br>  4) Decompose the sum of all elements after the changed element - x - into units. <br><br>  <b>Example</b> <br><br>  A = (1,1,1,1,1) <br>  2,1,1,1 <br>  2,2,1 <br>  3.1,1 <br><br><div class="spoiler">  <b class="spoiler_title">PHP Algorithm Code</b> <div class="spoiler_text"><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/*  . Generate all partitions.*/</span></span> $a = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> ); $n = count($a); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/*  . Print end exit.*/</span></span> print_r($a); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($a[<span class="hljs-number"><span class="hljs-number">0</span></span>] == $n) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*         . First element of our dynamic array*/</span></span> $first_elem = $a[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/*    . Length of an array*/</span></span> $c = count($a) - <span class="hljs-number"><span class="hljs-number">1</span></span>; $i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($i != count($a) - <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/*   . Here we search min. element.*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($a[$i] &lt; $first_elem) { $first_elem = $a[$i]; $min_elem = $i; } $i++; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($min_elem)) $min_elem = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*  "1". Here we transfer "1". */</span></span> $a[$min_elem]+= <span class="hljs-number"><span class="hljs-number">1</span></span>; $a[$c]-= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*      . We cut the array * and count the sum of elements.*/</span></span> array_splice($a, $min_elem + <span class="hljs-number"><span class="hljs-number">1</span></span>); $array_sum = array_sum($a); <span class="hljs-comment"><span class="hljs-comment">/*       . Here we add 1 (fill) to the array ( taking into account the sum ).*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($j = <span class="hljs-number"><span class="hljs-number">0</span></span>; $j != $n - $array_sum; $j++) $a[] = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* . Unset min_elem.*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span>($min_elem); } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br></div></div><br>  <b>Update:</b> <br>  The operation with search and delete 0 in the array is superfluous (since array_splice is used, and then the new array filling), as was correctly noted in the comment by the dev26 member <br><br>  <b>findings</b> <br><br>  I would like to share one observation at the end, I tried for a very long time to understand why some algorithms are immediately clear and easy to encode, while others make you suffer ... and sometimes for a long time.  I should note that I managed to encode this algorithm almost immediately, but only after I received an unambiguously clear description of each step.  And there is an important point, to understand the algorithm and to describe - the tasks of one another are not easier.  However, in the algorithmization and compilation of the description, it is especially important what verbs describe the actions in the algorithm - this (subjectively) ultimately can also affect the final implementation. <br><br>  <b>Literature</b> <br>  [1] Donald E. Knuth.  The Art of Programming.  Vol.  4. 2008. <br>  [2] Dennis Ritchie and Brian Kernighan.  The C Programming Language.  1978 <br>  [3] Aleksandr Shen.  Algorithms and Programming: Problems and Solutions. <br>  [4] <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D0%25B7%25D0%25B1%25D0%25B8%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D1%2587%25D0%25B8%25D1%2581%25D0%25BB%25D0%25B0">en.wikipedia.org/wiki/The breaking up</a> <br>  [5] <a href="https://en.wikipedia.org/wiki/De_Arte_Combinatoria">en.wikipedia.org/wiki/De_Arte_Combinatoria</a> <br><br>  PS Despite the list of references, the algorithm had to be displayed anew. <br>  <b>Another addition:</b> <br>  The removal of the first element from the cycles with this approach is valid both for generating partitions and for generating combinations and permutations.  In principle, this approach (although somewhat redundant in implementations) is quite generalized for the generation of other combinatorial objects. <br><br>  <b>UPDATE</b> <br>  The algorithm of partitions in conjunction with the algorithm of permutations allows you to generate all the compositions of a number.  The idea is simple: for each partition, the function of generating all permutations for this partition is called. <br><br><div class="spoiler">  <b class="spoiler_title">Generation of compositions.</b>  <b class="spoiler_title">Php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/*  . Generate all partitions.*/</span></span> $a = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> ); $n = count($a); $h=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/*     . Permutations and exit.*/</span></span> permute($a, $h); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($a[<span class="hljs-number"><span class="hljs-number">0</span></span>] == $n) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*         . First element of our dynamic array*/</span></span> $first_elem = $a[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/*    . Length of an array*/</span></span> $c = count($a) - <span class="hljs-number"><span class="hljs-number">1</span></span>; $i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($i != count($a) - <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/*   . Here we search min. element.*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($a[$i] &lt; $first_elem) { $first_elem = $a[$i]; $min_elem = $i; } $i++; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($min_elem)) $min_elem = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*  "1". Here we transfer "1". */</span></span> $a[$min_elem]+= <span class="hljs-number"><span class="hljs-number">1</span></span>; $a[$c]-= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*      . We cut the array * and count the sum of elements.*/</span></span> array_splice($a, $min_elem + <span class="hljs-number"><span class="hljs-number">1</span></span>); $array_sum = array_sum($a); <span class="hljs-comment"><span class="hljs-comment">/*       . Here we add 1 (fill) to the array ( taking into account the sum ).*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($j = <span class="hljs-number"><span class="hljs-number">0</span></span>; $j != $n - $array_sum; $j++) $a[] = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* . Unset min_elem.*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span>($min_elem); } <span class="hljs-comment"><span class="hljs-comment">/* . Permutations function.*/</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">permute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($b,&amp;$h)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*    .     *  . * Here we make a copy and reverse our array. It is necessary to * stop the algorithm.*/</span></span> $a = $b; $b = array_reverse($b); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/*   . Here we print and exit.*/</span></span> print_r($a); <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($a == $b) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*  . * Here we search next permutation.*/</span></span> $i = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($a[$i] &gt;= $a[$i - <span class="hljs-number"><span class="hljs-number">1</span></span>]) { $i++; } $j = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($a[$j] &lt;= $a[$i]) { $j++; } <span class="hljs-comment"><span class="hljs-comment">/*. Here we change.*/</span></span> $c = $a[$j]; $a[$j] = $a[$i]; $a[$i] = $c; <span class="hljs-comment"><span class="hljs-comment">/* . Tail reverse.*/</span></span> $c = $a; $z = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i-= <span class="hljs-number"><span class="hljs-number">1</span></span>; $i &gt; - <span class="hljs-number"><span class="hljs-number">1</span></span>; $i--) $a[$z++] = $c[$i]; } } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/329948/">https://habr.com/ru/post/329948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../329938/index.html">New compiler "buns" - safer, faster, more perfect</a></li>
<li><a href="../329940/index.html">Startups and abnormal programming. Tbd</a></li>
<li><a href="../329942/index.html">Review of changes in the new major release Node 8</a></li>
<li><a href="../329944/index.html">GitHub goes to GraphQL</a></li>
<li><a href="../329946/index.html">How many technologies does Yandex need for a search to find fresh documents almost instantly</a></li>
<li><a href="../329950/index.html">A day in the life of technical support</a></li>
<li><a href="../329952/index.html">Product design digest, May 2017</a></li>
<li><a href="../329954/index.html">How to worry less about your own lack of talent</a></li>
<li><a href="../329956/index.html">StringBuffer, and how hard it is to get rid of the legacy of the old code</a></li>
<li><a href="../329960/index.html">Marie Meeker report from the Code Conference: the main thing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>