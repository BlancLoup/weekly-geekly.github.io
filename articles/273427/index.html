<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unit Tests in ABAP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is focused on ABAP developers in SAP ERP systems. It contains many platform-specific points that are of little interest or even controver...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unit Tests in ABAP</h1><div class="post__text post__text-html js-mediator-article">  <i>This article is focused on ABAP developers in SAP ERP systems.</i>  <i>It contains many platform-specific points that are of little interest or even controversial for developers using other platforms.</i> <br><br>  In smart books and articles a lot about it is written in general.  But the question of specifics in ABAP programming is revealed little. <br><br>  ABAP programming can be quite different.  But in almost any large project, it can be decomposed into the following heaps: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Exits (user-exits).  These include validation, substitution, BTE (Business Transaction Events), BAdI, CMOD, and similar ways to extend standard functionality. </li><li>  Own application.  It is likely that this will be a variation on the theme of CRUD. </li><li>  Reports.  It can be said that a report is such an application of its own, but programs of this kind have their own nuances. </li><li>  Inbound integration, outbound integration.  We call, we call, as it often does not match. </li><li>  Auxiliary libraries.  Semi-finished products required for the construction of the finished product. </li></ul><br>  And now separately about exit. <br><a name="habracut"></a><br><h1>  Part one.  First test </h1><br>  Exit is a separate class method or a function module of a well-defined interface with your ABAP code, which is called in certain business operations (transactions) at some specific moment.  Like a plugin. <br><br>  Classic case: functional replacement module without global data.  And let the example be the event BTE 1120 (replacement when posting an accounting document). <br><br>  In the case of exits, usually the test is to perform a user operation that is associated with this event.  We could simulate this user operation, save the document, and then check this document for the required properties.  But that‚Äôs one of the important differences between unit testing and standard testing, that you don‚Äôt need to act in this way. <br><br>  We have a function module with several input parameters and several output parameters.  We give something to the input, and we get some change at the output. <br><br>  So our unit test should be like this: <br><br><ul><li>  Prepare a set of input parameters that simulates the reference document we need </li><li>  we launch our function module </li><li>  check that the output parameters contain the required values </li></ul><br>  Suppose the original production was as follows: <br><blockquote>  If an accounting document of the type VB is posted and the positions are posted on the debit account 1080, then the entire document must be posted with the sign ‚ÄúRed reversal‚Äù. </blockquote><br>  TDD can also be applied, but we (for the time being) will not adopt such a methodology. <br><br>  As a result, we wrote some code in FM ZFI_BTE_00001120: <br><br><img src="https://habrastorage.org/files/e01/1eb/213/e011eb2139af4f7aa8a9db95f102a183.png" alt="image"><br><br>  The code is ready, we want to write a test for it now. <br><br>  Option two: <br><br><ul><li>  we start the master </li><li>  do everything handles </li></ul><br>  I think the master is made almost with a human face, fit. <br><br>  First, we will look at the wizard, for this we go to the function group and then go through the menu ‚ÄúCreate - Other objects - Generate test class‚Äù and go step by step. <br><br>  A class is created not for a specific FM, but for a group of functions entirely: <br><br><img src="https://habrastorage.org/files/90c/222/447/90c2224475c84d37b96efdbe8e3137e1.png"><br><br>  You can come up with a name for the class and put some checkmarks: <br><br><img src="https://habrastorage.org/files/f82/1c5/138/f821c51380624dea800c510462d08f61.png"><br><br>  We choose which functional modules we need: <br><br><img src="https://habrastorage.org/files/55b/482/db3/55b482db38ab47959116435337c67e44.png"><br><br>  Further, further, further ... We look that the master has generated for us: <br><br><img src="https://habrastorage.org/files/655/442/019/6554420197c34b42891d57679834c490.png"><br><br>  The SETUP and TEARDOWN methods are empty.  The engine will run them, respectively, at the beginning and at the end of each test. <br><br>  For each selected function module, a test method was generated strictly by the name of our FM. <br><br>  And the implementation of a basic check in the form of a simple call already exists: <br><br><img src="https://habrastorage.org/files/1e6/013/6b5/1e60136b502843eabf3ba613d5e9a7a2.png"><br><br>  As you can see, the master did not do anything supernatural, which means we can do such preparations ourselves. <br><br>  If now we put a test around this code for our business scenario, then we come to the intermediate result: <br><br><img src="https://habrastorage.org/files/212/156/5dc/2121565dcba248f385e3fa965cc9d1a5.png"><br><br>  I believe that it is not necessary to completely simulate the document, if it does not affect the work of the whole set of tests: it is enough to provide only the most necessary things for the work of the business scenario.  Therefore, you can omit the date, amount, availability of the lender, account type and similar parameters. <br><br>  It turned out a suitable working scenario, I plan to use in a combat situation. <br><br>  You can throw tests for other functional modules in the group of functions. <br><br>  Now we can run unit tests on the menu ‚ÄúFunction module - Run - Module tests‚Äù: <br><br><img src="https://habrastorage.org/files/ac3/681/4a2/ac36814a280b45ebbd6a4d8e780c25aa.png"><br><br>  Quiet, small, green, all is well.  And if we were mistaken either in the test, or in the FM itself, the picture would be like this: <br><br><img src="https://habrastorage.org/files/fc6/355/26d/fc635526d3524b4b8191316c507f7c8e.png"><br><br>  It broke!  Q.E.D. <br><br>  BTW: Here at last, there is an application to table functions!  In my current active project, a big upgrade did occur, and now instead of the old APPEND and READ you can write such delicious things. <br><br>  BTW: There is also a sub-item ‚ÄúCoverage Measurement‚Äù next to it, but we'll get to it. <br><br>  BTW: Yes, there are flaws in the Russian version, we will not blame them. <br><br>  For now, enough is enough ... <br>  Continuation can be read here: <a href="http://habrahabr.ru/post/273569/">Unit tests in ABAP.</a>  <a href="http://habrahabr.ru/post/273569/">Part two.</a>  <a href="http://habrahabr.ru/post/273569/">Rake</a> </div><p>Source: <a href="https://habr.com/ru/post/273427/">https://habr.com/ru/post/273427/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273417/index.html">Advent of Code</a></li>
<li><a href="../273419/index.html">Myths and illusions of developers regarding playtests</a></li>
<li><a href="../273421/index.html">We become professional PHP developers. Part 1: Missing Link</a></li>
<li><a href="../273423/index.html">Children and parents on the web: the story of hacking services VTech</a></li>
<li><a href="../273425/index.html">Quickly raised is not considered to be dropped. Increase resiliency of embedded systems</a></li>
<li><a href="../273429/index.html">Development of plug-ins for Atlassian JIRA</a></li>
<li><a href="../273431/index.html">Learn English with Scala on Future and Actor</a></li>
<li><a href="../273433/index.html">Primary values ‚Äã‚Äãof the secondary market. Arguments and Facts</a></li>
<li><a href="../273435/index.html">Oracle Database 12c: Performance Tuning</a></li>
<li><a href="../273437/index.html">Security Week 51: Zero Day in Joomla, Twitter warns MacKeeper database leak</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>