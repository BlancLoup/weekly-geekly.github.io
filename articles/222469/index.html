<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"System Administrator's Toolkit" or "How We Work"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How do system administrators work, what do they use in their daily work, what utilities make life easier for us? 
 We will try to briefly answer these...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"System Administrator's Toolkit" or "How We Work"</h1><div class="post__text post__text-html js-mediator-article">  How do system administrators work, what do they use in their daily work, what utilities make life easier for us? <br>  We will try to briefly answer these questions and describe how <a href="http://centos-admin.ru/">our</a> work is arranged. <br><br>  So, in principle, the system administrator should do (be able to do): <br>  Install / update / uninstall software <br>  Software setting <br>  Plan work <br>  Document <br>  Monitor the state of IT systems <br>  Diagnose and maintain IT systems <br>  Backup / backup software and data <br><br>  For all this, there are many different software, try to describe all the most necessary. <br><a name="habracut"></a><br><h5>  Environment </h5><br>  How the work of the system administrator begins - with the choice of a comfortable environment.  This is not a spacious light office and comfortable chair, although it is important, and the choice of operating system.  My colleagues work on Mac OS X, Windows and Ubuntu.  After many trials and experiments with distributions and different desktop shells (Debian, Kubuntu, Fedora Gnome / Cinnamon), I stopped at Ubuntu 12.04 (Unity). <br>  I just got used to it and got used to Unity, now it seems to me a logical and quite comfortable shell of the PC.  The main requirement for the admin is stability and simplicity.  I don‚Äôt want to argue with anyone, but this is how Ubuntu has established itself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I probably will not describe in detail the means for planning documentation.  I note that for documenting I have enough notebook (Gedit) and Libre Office and Google Docs for sharing docks.  All the most useful notes and documents we store in the wiki.  For accounting of working hours and control of performance of tasks we use Redmine. <br>  Of course, the necessary tools for communication with colleagues and customers.  Usually, this is e-mail and Skype and phone. <br>  For planning I use Google Calendar, any other tool will be equally good if you actually use it, for example, a diary. <br><br>  One way or another, you have to work a lot on the console, locally or on remote servers.  Therefore, the most important things in the daily work of the administrator * nix are command line utilities. <br><br><h5>  Command line utilities </h5><br>  Most often, you have to work with text (configs, logs, manuals, etc.), so let's start with text editors and other tools for manipulating text and strings: <br>  <b>vi / vim</b> - this editor is an indispensable tool for any administrator, since it can be found on almost any server (on any Unix), and if you still have the first thing when it opens right out of it by ctrl + z, then I highly recommend you at least read man vim how to do it right. <br>  <b>nano</b> is the simplest editor, shipped by default on Debian / Ubuntu. <br>  <b>mcedit</b> - for fans of mc and blue screens, not the worst option, is quite simple and convenient. <br>  <b>cat</b> - concatinate is initially a tool for combining files, but is more often used to display the contents of a file, as well as to insert lines into a file. <br>  <b>tail</b> - by default, displays the last 10 lines of the file, can be used to monitor the log (with the -f key) <br>  <b>wc</b> - counts word strings and the number of bytes in the file <br>  <b>head</b> - like tail prints 10 lines of a file, but as it is clear from the name, from the beginning of the file. <br>  <b>grep</b> is the most indispensable tool for filtering text output or just for finding the desired string in files. <br>  <b>sed</b> - stream editor - is very useful for automating routine tasks, replacing lines in files (editing configs), deleting lines, displaying content by mask, etc. <br>  <b>awk / gawk</b> is a very powerful utility (in fact, AWK is a whole programming language) that helps parse files and manipulate the output of strings and whatnot. <br>  Information on all the listed utilities can be found in man.  Speaking of man: <br>  <b>man</b> - access to reference pages is something that no Unix-administrator can work without.  If you are a novice specialist, be sure to start by typing man in the command line. <br>  The list can be continued, for a long time, there are actually a lot of utilities.  But for now let's stop on this and see what can be done with awk, wc, cat and grep, reading a little man. <br><br><h5>  Some practice </h5><br>  What is all the same useful in practice, these utilities, try to show the example of parsing logs. <br><br>  There is an apache log file (access.log) in the following format: <br> <code>1.2.3.4 - - [12/May/2014:03:08:55 +0400] "GET /shop/goods-list HTTP/1.1" 200 1691 "http://example.ru/shop/goods-list" "Mozilla/5.0 (Windows NT 6.2; WOW64; rv:29.0) Gecko/20100101 Firefox/29.0"</code> <br> <br>  Let's write a simple script to calculate the percentage of successfully processed queries. <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash SUM=`wc -l access.log` #      OK=`cat access.log | awk '{print $9}' | grep 200 | wc -l` #      "200" awk -v SUM="$SUM" -v OK="$OK" ' BEGIN { printf "Passed: %3.2f%%\n", OK / SUM * 100 exit }'</span></span></code> </pre>  We <code>Passed: 93.62%</code> something like this: <code>Passed: 93.62%</code> <br><br>  And some more useful examples: <br><br>  Calculate the amount of data transferred in the hour preceding the current <br><pre> <code class="bash hljs">cat access.log | grep `date +%H:%M -d <span class="hljs-string"><span class="hljs-string">"-1 hour"</span></span>` | awk <span class="hljs-string"><span class="hljs-string">'{ total += $10 } END { print total/1024/1024 FS"MB" }'</span></span></code> </pre><br>  Calculate the total amount of data transferred <br><pre> <code class="bash hljs">awk <span class="hljs-string"><span class="hljs-string">'{ total += $10 } END { print total/1024/1024 FS"MB" }'</span></span> access.log</code> </pre><br>  Calculate the average request processing time <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash COUNT=`wc -l access.log` SUM=`cat access.log | awk '{ total += $16 } END { print total }' ` awk -v COUNT="$COUNT" -v SUM="$SUM" ' BEGIN { printf "Average req-time %3.2fs\n", SUM / COUNT exit }'</span></span></code> </pre><br><br><h5>  System boot diagnostics </h5><br>  To understand how busy the server is there are several utilities, first of all, you can estimate the load by the load average indicator, on Habr√© they already wrote that this is an indicator of the average system load, expressed in the number of blocking processes waiting to receive resources, for 1 minute, 5 minutes and 15 minutes, respectively. <br>  The first thing that will help to assess the current server load and see which processes in this particular load the server - top or htop more: <br>  <b>top</b> - displaying linux processes - in addition, it displays uptime, load average, the number of running tasks and threads. <br>  CPU performance (as a percentage): <br>  - <b>us</b> - time spent on the execution of custom without changing the processing priority (un-nice), <br>  - <b>sy</b> - time spent on executing system (kernel) processes, <br>  - <b>ni</b> is the time spent on executing custom c by changing the processing priority (nice), <br>  - <b>wa</b> - I / O waiting time (disk subsystem), <br>  - <b>hi</b> - time to process hardware interrupts, <br>  - <b>si</b> - time for processing software interrupts, <br>  - <b>st</b> - the time ‚Äústolen‚Äù by the hypervisor to process tasks on another virtual machine is important for virtual machines (VPS / VDS) and is useful for assessing the honesty of the hoster, if this figure is large, then your provider will impudently oversell. <br>  Also top will show you how much memory is consumed in general and for what (processes, caches, buffers), and also show how much each process consumes: <br>  - <b>VIRT</b> - displays how much memory a process uses in its entirety including code, data, shared libraries, as well as memory pages dumped into swap and memory pages that were reserved but not used, <br>  - <b>RES</b> - the size of the resident memory - the current amount of RAM (without a swap) used by the process, <br>  - <b>SHR</b> - size of shared memory - the current amount of RAM available for the process, as a rule, not all of this memory is resident.  This number simply indicates how much memory can be shared with other processes. <br>  In addition to displaying resource utilization indicators, top is also used to manipulate processes; you can send a signal to terminate a process or change its priority (nice). <br>  <b>htop</b> - a more colorful version of top - has all the same capabilities as top, but has a more user-friendly interface (allows scrolling through the list of processes both vertically and horizontally), and also can call lsof, strace and ltrace for the selected process (about them later we will tell in more detail). <br>  To estimate the load on the disk I / O subsystem, you can use the iotop utility: <br>  <b>iotop</b> , a top-like utility for monitoring disk load, displays a process table with current disk I / O utilization rates, such as: <br>  - PRIO - process priority, <br>  - DISK READ - read from disk Bytes / sec, <br>  - DISK WRITE - write to disk Bytes / sec, <br>  - SWAPIN - time (as a percentage) spent by the process on swapping, <br>  - IO - time (as a percentage) spent by the process waiting for input / output. <br>  Additionally, information about the total read / write bit rate of the disk subsystem is displayed. <br>  <b>vmstat</b> - displays summary information about processes, memory, input / output, processor and disk activity.  Unlike iotop, it does not require superuser privileges. <br><br>  <b>Diagnostics of program crashes, troubleshooting</b> <br>  There are situations when a program or a daemon does not work as you would expect, or fail for some unknown reason.  When all logs are viewed (or when there are no logs), all configs are checked and the documentation is re-read (if there is of course), the system call trace utilities stace, ltrace will help you, and lsof will show the list of open files: <br>  <b>strace</b> - the utility allows you to intercept system calls and signals from a running process or from an already running process using its PID. <br>  The output can be filtered, for example, only open () or select () calls can be output.  If the call returns a non-negative value, then everything is fine, if given for example: <br>  <code>open("/foo/bar", O_RDONLY) = -1 ENOENT (No such file or directory)</code> , then from this you can understand that the application is trying to open a non-existent file.  It also sometimes happens that the file permissions are incorrectly set.  For example, the virtual machine does not start, because the hypervisor cannot allocate the necessary amount of RAM to it.  Strace in such situations helps a lot. <br>  If you are just curious to see how a particular service works, what kind of system calls it uses, then stace is your friend.  For example, you want to know how Apache differs fundamentally from Nginx, just take and look. <br>  <b>ltrace</b> - a utility for tracing library calls - is very similar to strace, but intercepts only calls to dynamic libraries. <br>  <b>ldd</b> - if you set it on the program will show which program uses the library.  Useful if you need to transfer the program to chroot. <br>  <b>lsof</b> - displays a list of open files with an indication; by default, displays everything.  It can display a list for a specific process by PID (quite convenient output in htop), for a user by UID, or for example, which processes use a particular file. <br>  May be useful in some <a href="http://habrahabr.ru/post/208104/">cases</a> .  There is a very detailed man with descriptions and examples. <br><br><h5>  What remains to tell </h5><br>  In the next article we will talk about utilities for diagnosing equipment, networks, and monitoring and automation tools. <br>  The topic is really capacious and interesting, we will be happy to see in the comments interesting examples from your personal experience. <br><br>  <i>To be continued ...</i> <br><br>  UPD: More correct option for calculating the percentage of successfully processed requests from <a href="https://habrahabr.ru/users/sledopit/" class="user_link">sledopit</a> <br><pre> <code class="bash hljs">awk <span class="hljs-string"><span class="hljs-string">'{sum+=1; if ($9==200) ok+=1} END {printf "Passed: %3.2f%%\n", ok / sum * 100}'</span></span> access.log</code> </pre><br>  And an even simpler option with the built-in variable NR instead of SUM from <a href="https://habrahabr.ru/users/rumataestora/" class="user_link">RumataEstora</a> <br><pre> <code class="bash hljs">awk <span class="hljs-string"><span class="hljs-string">'$9 == 200 { s++ } END { print s / NR * 100; }'</span></span> access.log</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/222469/">https://habr.com/ru/post/222469/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../222447/index.html">Squeeze all the juice or use Raspberry pi to the fullest</a></li>
<li><a href="../222453/index.html">25 Laravel Tips and Tricks</a></li>
<li><a href="../222455/index.html">Rostelecom is introducing a new type of Internet traffic filtering. Not DPI</a></li>
<li><a href="../222463/index.html">Pip-Boy 3000: a new incarnation of the device from Fallout (without Rad-X)</a></li>
<li><a href="../222467/index.html">Toilet Guide, or Toto Smart Toilets</a></li>
<li><a href="../222471/index.html">By 2019, two-thirds of smartphones will be developed by hardware platform vendors.</a></li>
<li><a href="../222473/index.html">Spurious Correlations: service for the "game" with any sets of statistics</a></li>
<li><a href="../222475/index.html">The robot that will overtake you (video)</a></li>
<li><a href="../222477/index.html">Last.Backend opens its doors to first visitors.</a></li>
<li><a href="../222479/index.html">Is copyright in IT in the CIS?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>