<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automating the FreeBSD8 Apache2 + Mysql5 Web Server Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It so happened that I'm terribly lazy. Two years ago, when I bought myself a VDS and met FreeBSD 7.1 for the first time, I killed two weeks to configu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automating the FreeBSD8 Apache2 + Mysql5 Web Server Part 1</h1><div class="post__text post__text-html js-mediator-article">  It so happened that I'm terribly lazy.  Two years ago, when I bought myself a VDS and met FreeBSD 7.1 for the first time, I killed two weeks to configure everything I needed.  Now I have 2 * Pentium III 1GHz / RAM 1GB / 2 * SCSI 17GB, it suits my tasks perfectly. <br><br><ol><li>  Creating hosts </li><li>  Rotary of logs of Apache2 </li><li>  Archive Apache2 logs and delete old logs. </li><li>  Creating a database and adding a new user with permissions to only one database, with the generation of a new password. </li></ol><br><br>  My favorite editor is vi.  If someone doesn‚Äôt know how to work with him, wherever I‚Äôve told vi to be replaced with my ee, mcedit, etc. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Script to create hosts. <br>  The structure on my server is as follows, each user has a www folder in his home-directory, it looks like this. <br>  / home / user / www. <br>  The script inside the www folder creates directories with the host name. <br><br>  Example mk_host.sh domen.ru user <br>  A folder domen.ru with directories will be created in the directory / home / user / www. <br><br><ul><li>  cgi-bin </li><li>  html </li><li>  logs </li><li>  shadow </li></ul><br><br>  A host will also be created in the Apache2 directory.  According to my scheme, a separate config is created for each virtual host. <br><br>  We look at the script itself. <br><a name="habracut"></a> <code>   <br> vi /root/bin/mk_host.sh <br>   . <br> <br> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#007800">$#</font> <font color="#660033">-eq</font> <font color="#000000">2</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#666666">#  ,   </font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#007800">path</font> = <font color="#000000">/</font> usr <font color="#000000">/</font> local <font color="#000000">/</font> etc <font color="#000000">/</font> apache2 <font color="#000000">/</font> Includes <font color="#666666">#         .</font> &lt;br/&gt; <br> <font color="#007800">domen</font> =$ <font color="#000000">1</font> <font color="#666666">#  </font> &lt;br/&gt; <br> <font color="#007800">user</font> =$ <font color="#000000">2</font> <font color="#666666">#    </font> &lt;br/&gt; <br> <font color="#007800">pathhome</font> = <font color="#000000">/</font> home <font color="#000000">/</font> <font color="#007800">$user</font> <font color="#000000">/</font> www <font color="#666666">#   - </font> &lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> html&lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> shadow&lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> cgi-bin&lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> logs&lt;br/&gt; <br> <font color="#c20cb9">chown</font> <font color="#660033">-R</font> <font color="#007800">$user</font> : <font color="#007800">$user</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> <font color="#666666">#  .</font> &lt;br/&gt; <br> <font color="#666666">#   </font> &lt;br/&gt; <br> <font color="#7a0874">echo</font> <font color="#ff0000">"&lt;br/&gt; <br> #Config for <font color="#007800">$domen</font> &lt;br/&gt; <br> &lt;VirtualHost *:80&gt;&lt;br/&gt; <br> DocumentRoot <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /html/&lt;br/&gt; <br> ServerName <font color="#007800">$domen</font> &lt;br/&gt; <br> ServerAlias www. <font color="#007800">$domen</font> &lt;br/&gt; <br> ScriptAlias /cgi-bin/ <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /cgi-bin/&lt;br/&gt; <br> CustomLog <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /logs/web.log common&lt;br/&gt; <br> ErrorLog <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /logs/error.log&lt;br/&gt; <br> &lt;/VirtualHost&gt;&lt;br/&gt; <br> #end of <font color="#007800">$domen</font> "</font> <font color="#000000">&gt;&gt;</font> <font color="#007800">$path</font> <font color="#000000">/</font> <font color="#007800">$domen</font> .conf&lt;br/&gt; <br> <font color="#000000">else</font> &lt;br/&gt; <br> <font color="#666666">#       ,   .</font> &lt;br/&gt; <br> <font color="#7a0874">echo</font> <font color="#ff0000">"ERROR"</font> &lt;br/&gt; <br> <font color="#7a0874">echo</font> <font color="#ff0000">"$0 domen name_user"</font> &lt;br/&gt; <br> <font color="#7a0874">exit</font> <font color="#000000">1</font> &lt;br/&gt; <br> <font color="#000000">fi</font> <br></code> <blockquote> <code>   <br> vi /root/bin/mk_host.sh <br>   . <br> <br> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#007800">$#</font> <font color="#660033">-eq</font> <font color="#000000">2</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#666666">#  ,   </font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#007800">path</font> = <font color="#000000">/</font> usr <font color="#000000">/</font> local <font color="#000000">/</font> etc <font color="#000000">/</font> apache2 <font color="#000000">/</font> Includes <font color="#666666">#         .</font> &lt;br/&gt; <br> <font color="#007800">domen</font> =$ <font color="#000000">1</font> <font color="#666666">#  </font> &lt;br/&gt; <br> <font color="#007800">user</font> =$ <font color="#000000">2</font> <font color="#666666">#    </font> &lt;br/&gt; <br> <font color="#007800">pathhome</font> = <font color="#000000">/</font> home <font color="#000000">/</font> <font color="#007800">$user</font> <font color="#000000">/</font> www <font color="#666666">#   - </font> &lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> html&lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> shadow&lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> cgi-bin&lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> logs&lt;br/&gt; <br> <font color="#c20cb9">chown</font> <font color="#660033">-R</font> <font color="#007800">$user</font> : <font color="#007800">$user</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> <font color="#666666">#  .</font> &lt;br/&gt; <br> <font color="#666666">#   </font> &lt;br/&gt; <br> <font color="#7a0874">echo</font> <font color="#ff0000">"&lt;br/&gt; <br> #Config for <font color="#007800">$domen</font> &lt;br/&gt; <br> &lt;VirtualHost *:80&gt;&lt;br/&gt; <br> DocumentRoot <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /html/&lt;br/&gt; <br> ServerName <font color="#007800">$domen</font> &lt;br/&gt; <br> ServerAlias www. <font color="#007800">$domen</font> &lt;br/&gt; <br> ScriptAlias /cgi-bin/ <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /cgi-bin/&lt;br/&gt; <br> CustomLog <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /logs/web.log common&lt;br/&gt; <br> ErrorLog <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /logs/error.log&lt;br/&gt; <br> &lt;/VirtualHost&gt;&lt;br/&gt; <br> #end of <font color="#007800">$domen</font> "</font> <font color="#000000">&gt;&gt;</font> <font color="#007800">$path</font> <font color="#000000">/</font> <font color="#007800">$domen</font> .conf&lt;br/&gt; <br> <font color="#000000">else</font> &lt;br/&gt; <br> <font color="#666666">#       ,   .</font> &lt;br/&gt; <br> <font color="#7a0874">echo</font> <font color="#ff0000">"ERROR"</font> &lt;br/&gt; <br> <font color="#7a0874">echo</font> <font color="#ff0000">"$0 domen name_user"</font> &lt;br/&gt; <br> <font color="#7a0874">exit</font> <font color="#000000">1</font> &lt;br/&gt; <br> <font color="#000000">fi</font> <br></code> </blockquote> <code>   <br> vi /root/bin/mk_host.sh <br>   . <br> <br> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#007800">$#</font> <font color="#660033">-eq</font> <font color="#000000">2</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#666666">#  ,   </font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#007800">path</font> = <font color="#000000">/</font> usr <font color="#000000">/</font> local <font color="#000000">/</font> etc <font color="#000000">/</font> apache2 <font color="#000000">/</font> Includes <font color="#666666">#         .</font> &lt;br/&gt; <br> <font color="#007800">domen</font> =$ <font color="#000000">1</font> <font color="#666666">#  </font> &lt;br/&gt; <br> <font color="#007800">user</font> =$ <font color="#000000">2</font> <font color="#666666">#    </font> &lt;br/&gt; <br> <font color="#007800">pathhome</font> = <font color="#000000">/</font> home <font color="#000000">/</font> <font color="#007800">$user</font> <font color="#000000">/</font> www <font color="#666666">#   - </font> &lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> html&lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> shadow&lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> cgi-bin&lt;br/&gt; <br> <font color="#c20cb9">mkdir</font> <font color="#660033">-p</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> logs&lt;br/&gt; <br> <font color="#c20cb9">chown</font> <font color="#660033">-R</font> <font color="#007800">$user</font> : <font color="#007800">$user</font> <font color="#007800">$pathhome</font> <font color="#000000">/</font> $ <font color="#000000">1</font> <font color="#000000">/</font> <font color="#666666">#  .</font> &lt;br/&gt; <br> <font color="#666666">#   </font> &lt;br/&gt; <br> <font color="#7a0874">echo</font> <font color="#ff0000">"&lt;br/&gt; <br> #Config for <font color="#007800">$domen</font> &lt;br/&gt; <br> &lt;VirtualHost *:80&gt;&lt;br/&gt; <br> DocumentRoot <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /html/&lt;br/&gt; <br> ServerName <font color="#007800">$domen</font> &lt;br/&gt; <br> ServerAlias www. <font color="#007800">$domen</font> &lt;br/&gt; <br> ScriptAlias /cgi-bin/ <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /cgi-bin/&lt;br/&gt; <br> CustomLog <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /logs/web.log common&lt;br/&gt; <br> ErrorLog <font color="#007800">$pathhome</font> / <font color="#007800">$domen</font> /logs/error.log&lt;br/&gt; <br> &lt;/VirtualHost&gt;&lt;br/&gt; <br> #end of <font color="#007800">$domen</font> "</font> <font color="#000000">&gt;&gt;</font> <font color="#007800">$path</font> <font color="#000000">/</font> <font color="#007800">$domen</font> .conf&lt;br/&gt; <br> <font color="#000000">else</font> &lt;br/&gt; <br> <font color="#666666">#       ,   .</font> &lt;br/&gt; <br> <font color="#7a0874">echo</font> <font color="#ff0000">"ERROR"</font> &lt;br/&gt; <br> <font color="#7a0874">echo</font> <font color="#ff0000">"$0 domen name_user"</font> &lt;br/&gt; <br> <font color="#7a0874">exit</font> <font color="#000000">1</font> &lt;br/&gt; <br> <font color="#000000">fi</font> <br></code> <br><br>  And lastly: <br><ol><li>  The script must be run as root or at least you need to have access to the directory. </li><li>  The script is more convenient to put in your directory, for example, in my /root/bin/mk_host.sh directory and add the directory to .profile, then you will be able to run the script from anywhere without specifying a direct path to the script. </li><li>  The script has only checks for entering two parameters, unfortunately nothing else is checked, the script is made for yourself, in the hope that the script will be used by an experienced person. </li></ol><br><br>  Just in case the script <a href="http://karpenko.biz/bash/mk_host.html">is original.</a> <br><br>  And I also like when everything is in its place and laid out on the shelves, the description of the rest of the scripts will be in the next article. </div><p>Source: <a href="https://habr.com/ru/post/96933/">https://habr.com/ru/post/96933/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../96917/index.html">We get traffic and minimize its cost on the example of browser MMO</a></li>
<li><a href="../96918/index.html">Mozilla Foundation Product Update</a></li>
<li><a href="../96919/index.html">Get rid of stress for a few days in the style of LifeHack</a></li>
<li><a href="../96920/index.html">Automatic copying of CD / DVD to HDD</a></li>
<li><a href="../96932/index.html">Copy of Xperia X10 or Chinese SonyEricsson</a></li>
<li><a href="../96934/index.html">Check if browser is enabled for caching</a></li>
<li><a href="../96936/index.html">Electronic queue at Sberbank</a></li>
<li><a href="../96937/index.html">10 years in five charts</a></li>
<li><a href="../96942/index.html">Intel Graphics Performance Analyzers for game developers</a></li>
<li><a href="../96945/index.html">Documentation tornado in Russian</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>