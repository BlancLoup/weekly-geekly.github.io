<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Lib amqpcpp wrapper for librabbitmq</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Over the past year and a half, RabbitMQ Queue Server, which operates under the AMQP protocol, has been gaining popularity. About this protocol there w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Lib amqpcpp wrapper for librabbitmq</h1><div class="post__text post__text-html js-mediator-article">  Over the past year and a half, <a href="http://www.rabbitmq.com/">RabbitMQ</a> Queue Server, which operates under the AMQP protocol, has been gaining popularity.  About this protocol there were already enough articles on Habr√©.  The toolkit has a library <a href="http://hg.rabbitmq.com/rabbitmq-c">librabbitmq</a> <br><br>  On the basis of this library, I put the amqpcpp C ++ library project into <a href="http://code.google.com/p/rabbitcpp">Google Code</a> , which is a simplified interface to librabbitmq.  There is no documentation, only three examples of use in the distribution.  Under custom, a summary of the API and examples of its use.  Use made easier. <br><a name="habracut"></a><br><h4>  Installation </h4><br>  very simple: run the makefile into which the compile library libamqpcpp.a is compiled <br>  in the same makefile there is a compilation of examples: <br>  g ++ -o example_get -lamqpcpp -lrabbitmq -Iamqpcpp -I / usr / local / include -L / usr / local / lib -L.  example_get.cpp <br>  replace the name example_get with my_project and compile.  While configure is not done, I will be glad - if someone helps me to create it. <br><br><h4>  Brief description of the API </h4> <br>  The library turns on <code>#include "amqpcpp.h"</code> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All public methods are listed in the <a href="http://code.google.com/p/rabbitcpp/wiki/API">project wiki</a> .  Naming convention: <b>All methods that are defined in the AMQP protocol begin with a capital letter</b> , for example: Declare, Bind, Consume, Cancel etc. <br><br>  The Amqp class carries two functions: <br><ul><li>  connects to a broker </li><li>  is a factory for creating instances of the ‚Äúqueue‚Äù and ‚Äúexchanges‚Äù classes and transferring the connection to them. </li></ul><br>  For each instance of the class "queue" or "exchange" opens a new channel.  The channel is closed automatically when the class destructor is called. <br><br>  By default, a connection is made to the broker on vhost = / login = guest password = guest port = 5672 <br>  The connection parameters are passed in a string (connectionString) of the following form: "password: login @ host: port / vhost".  This is a well-established standard.  If any parameter is missing, it is replaced by the default parameter. <br><br>  If there is no connection, then you can print the connection parameters using the printConnect () method. <br><br> <code>AMQP amqp; <br> amqp-&gt;printConnect(); <br> <br> ./test <br> connect <br> port =5672 <br> host =localhost <br> vhost=/ <br> user =guest <br> passw=guest <br> <br> //   amqp-proxy-debug <br> AMQP amqp(AMQPDEBUG); <br> amqp-&gt;printConnect(); <br> <br> ./test <br> connect <br> port =5673 <br> host =localhost <br> vhost=/ <br> user =guest <br> passw=guest <br> <br> //   <br> AMQP amqp("123123:akalend@10.0.0.2/private"); <br> ./test <br> connect <br> port =5672 <br> host =10.0.0.2 <br> vhost=private <br> user =akalend <br> passw=123123 <br></code> <br><br><h4>  Exchange </h4><br><br>  An instance of the AMQPExchange exchange class can be obtained from the AMQP class using the createExchange () method. <br>  This method may or may not have a parameter - the name of the exchange.  To avoid leaks - it is proposed to use auto_ptr <br><br><blockquote>  AMQP amqp <font color="#008080">;</font> <br>  auto_ptr <font color="#000080">&lt;</font> AMQPExchange <font color="#000080">&gt;</font> ex <font color="#008000">(</font> amqp. <font color="#007788">createExchange</font> <font color="#008000">(</font> <font color="#FF0000">"ex"</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  ex <font color="#000040">-</font> <font color="#000080">&gt;</font> Declare <font color="#008000">(</font> <font color="#FF0000">"e"</font> , <font color="#FF0000">"topic"</font> <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br><br>  To carry out operations with the Exchange - it must be announced.  You can declare an exchange in two ways: either specify the name of the exchange when you create it, or when announcing it: <br><br><blockquote>  AMQP amqp <font color="#008080">;</font> <br>  auto_ptr <font color="#000080">&lt;</font> AMQPExchange <font color="#000080">&gt;</font> ex <font color="#008000">(</font> amqp. <font color="#007788">createExchange</font> <font color="#008000">(</font> <font color="#FF0000">"ex"</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  ex <font color="#000040">-</font> <font color="#000080">&gt;</font> Declare <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#666666">//</font> <br>  auto_ptr <font color="#000080">&lt;</font> AMQPExchange <font color="#000080">&gt;</font> ex <font color="#008000">(</font> amqp. <font color="#007788">createExchange</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  ex <font color="#000040">-</font> <font color="#000080">&gt;</font> Declare <font color="#008000">(</font> <font color="#FF0000">"e"</font> , <font color="#FF0000">"topic"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br></blockquote><br><br>  The second parameter of the AMQPExchange :: Declare () method is the exchange type, a string value.  Exchanges can be of three types: <ul><li>  Direct direct - direct match on the key </li><li>  Thematic topics - matching mask, the key can be composite. </li><li>  fanout keyless </li></ul><br>  By default, the exchange type is set to direct. <br><br>  The third optional parameter is the Exchange options.  Exchange options - one of the constants: <br><ul><li>  AMQP_PASSIVE - passive </li><li>  AMQP_AUTODELETE - auto-delete if not used </li><li>  AMQP_DURABLE - durable, i.e.  remains when rebooting the broker. </li></ul><br><br>  If we do not need an exchange, then we can delete it: <br><br><blockquote>  AMQP amqp <font color="#008080">;</font> <br>  auto_ptr <font color="#000080">&lt;</font> AMQPExchange <font color="#000080">&gt;</font> ex <font color="#008000">(</font> amqp. <font color="#007788">createExchange</font> <font color="#008000">(</font> <font color="#FF0000">"ex"</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  ex <font color="#000040">-</font> <font color="#000080">&gt;</font> Delete <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#666666">// or</font> <br>  auto_ptr <font color="#000080">&lt;</font> AMQPExchange <font color="#000080">&gt;</font> ex <font color="#008000">(</font> amqp. <font color="#007788">createExchange</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  ex <font color="#000040">-</font> <font color="#000080">&gt;</font> Delete <font color="#008000">(</font> <font color="#FF0000">"ex"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br></blockquote><br><br>  It is also possible to carry out binding (Bind) Exchange to the Queue.  Binding is done by key.  For the fanout exchange, we specify an empty string, the key value is ignored or we do not specify a key at all.  If the exchange in the broker already exists, you can not re-declare it. <br><blockquote>  AMQP amqp <font color="#008080">;</font> <br>  auto_ptr <font color="#000080">&lt;</font> AMQPExchange <font color="#000080">&gt;</font> ex <font color="#008000">(</font> amqp. <font color="#007788">createExchange</font> <font color="#008000">(</font> <font color="#FF0000">"ex"</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#666666">// exchange has been previously announced</font> <br>  ex <font color="#000040">-</font> <font color="#000080">&gt;</font> Bind <font color="#008000">(</font> <font color="#FF0000">"queue_name"</font> , <font color="#FF0000">"key_value"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br><br>  <font color="#666666">// declaration of the fanout type and binding it to the queue</font> <br>  auto_ptr <font color="#000080">&lt;</font> AMQPExchange <font color="#000080">&gt;</font> ex2 <font color="#008000">(</font> amqp. <font color="#007788">createExchange</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  ex2 <font color="#000040">-</font> <font color="#000080">&gt;</font> Declare <font color="#008000">(</font> <font color="#FF0000">"ex2"</font> , <font color="#FF0000">"fanout"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  ex2 <font color="#000040">-</font> <font color="#000080">&gt;</font> Bind <font color="#008000">(</font> <font color="#FF0000">"queue_name2"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br></blockquote><br>  It should be noted that the Binding can be done both Queues to Exchange and Exchange to Queues. <br><br><h6>  Posting posts </h6>  : <br>  If the exchange exists, then you can post messages to it.  If there are queues attached to it, these messages will be sent to the appropriate queues.  Each message is published with the corresponding key. If the Exchange type is fanout, then an empty key is set, which is ignored: <br><blockquote>  AMQP amqp <font color="#008080">;</font> <br>  auto_ptr <font color="#000080">&lt;</font> AMQPExchange <font color="#000080">&gt;</font> ex <font color="#008000">(</font> amqp. <font color="#007788">createExchange</font> <font color="#008000">(</font> <font color="#FF0000">"ex"</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#666666">// exchange has been previously announced</font> <br>  ex <font color="#000040">-</font> <font color="#000080">&gt;</font> Publish <font color="#008000">(</font> <font color="#FF0000">"some message"</font> , <font color="#FF0000">"key"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br></blockquote><br><br>  PS ... <br>  On the use of "Queues" in Part 2 </div><p>Source: <a href="https://habr.com/ru/post/91528/">https://habr.com/ru/post/91528/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../91513/index.html">Yandex.Money identified on REEF</a></li>
<li><a href="../91514/index.html">Features of life of residents in the village "Neglupovka"</a></li>
<li><a href="../91516/index.html">Millionaires, profit and all-all-all: a review of the third Minsk Startup Weekend</a></li>
<li><a href="../91519/index.html">Russian oligarchs want to invest in the creation of cyborgs</a></li>
<li><a href="../91526/index.html">LaTeX Text Producer (or Python typographer)</a></li>
<li><a href="../91529/index.html">Custom tags</a></li>
<li><a href="../91530/index.html">SharePoint Conference 2010 Russia</a></li>
<li><a href="../91532/index.html">Documenting templates</a></li>
<li><a href="../91534/index.html">Save traffic when viewing maps on the iPhone</a></li>
<li><a href="../91537/index.html">Video announcement UBUNTU 10.04 LTS :)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>