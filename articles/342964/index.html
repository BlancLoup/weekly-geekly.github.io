<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Optimize frontend. Part 2. We repair tree-shaking in the project on webpack</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So, if you do not specifically repair, tree-shaking in the webpack does not work. Who does not believe, read my previous article . If you really want ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Optimize frontend. Part 2. We repair tree-shaking in the project on webpack</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/zv/s3/b-/zvs3b-fs92zfofqocfdpfcwewsc.png"><br>  So, if you do not specifically repair, tree-shaking in the webpack does not work.  Who does not believe, read my <a href="https://habrahabr.ru/company/wrike/blog/342686/">previous article</a> .  If you really want to fix it, then welcome under cat.  There are several options that I could <del>  spy </del>  , <del>  to find </del>  come up with <a name="habracut"></a></p><br><h2 id="testovyy-kod">  Test code </h2><br><p>  All the experiments I did on two files that look like this: </p><br><pre><code class="hljs pgsql">// module.js <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Wheel { pump(){ console.log(<span class="hljs-string"><span class="hljs-string">'puuuuf'</span></span>);} } <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Rudder { turn(){ console.log(<span class="hljs-string"><span class="hljs-string">'turn'</span></span>);} } export {Wheel, Rudder}</code> </pre> <br><pre> <code class="hljs pgsql">// <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Wheel} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./module.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Car { constructor() { this.wheel = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Wheel(); } } const car = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Car(); car.wheel.pump();</code> </pre> <br><h2 id="variant-ochevidnyy-krivoy-uglify---babel---uglify">  The obvious option, the curve: uglify -&gt; babel -&gt; uglify </h2><br><p>  <a href="https://github.com/zolotyh/treeshaking-hell/tree/uglify-fix">Code</a> </p><br><p>  In the comments to the previous article I was offered an obvious solution.  If everything breaks down because babel interferes with the build and prevents UglifyJS from throwing out extra code, then why not run UglifyJS first and throw out extra code, and then later babel? </p><br><p>  It was too lazy to write something specifically for the webpack, so I performed all the steps in the console via npm scripts. </p><br><p>  I compiled the files from the example without the babel-loader and tried to skip through UglifyJS.  UglifyJS fell.  Well, do not understand the new javascript syntax! </p><br><p>  It's okay, I thought, and dug up <del>  stewardess </del>  <a href="https://www.npmjs.com/package/uglify-es">uglify-es</a> .  The problem is that babel doesn't know anything about minification, and the output is <a href="">unminified code</a> . </p><br><p>  We'll have to chase UglifyJS again after babel. </p><br><p>  I think that someone will probably use this approach, but I myself do not really like it. </p><br><h2 id="variant-razumnyy-zhdat-babel-7">  Reasonable option: wait babel 7 </h2><br><p>  <a href="https://github.com/zolotyh/treeshaking-hell/tree/new-babel">Code</a> </p><br><p>  Do your clients use your code?  Is he in production?  If so, just schedule an update on the new babel after it is released.  The disaster does not happen, because your application has been running all this time without tree-shaking. <br>  If you are just starting to develop a project from scratch and at the same time are bold enough, you can already connect a test version.  While you are working on your application, a new version of babel will be released. <br>  In any case, babel is open-source, which means that you yourself can help him get out earlier. </p><br><h2 id="variant-radikalnyy-rollup">  Option radical: Rollup </h2><br><p>  <a href="https://github.com/zolotyh/treeshaking-hell/tree/rollup-old-babel">Code</a> </p><br><p>  If you are not very bogged down in a webpack, it may not be too late to jump on the Rollup.  In the case of simple applications and libraries, Rollup is a good choice. </p><br><h2 id="variant-radikalnyy-i-s-kostylyami-no-inogda-rabotaet-typescript">  Option radical and with crutches, but sometimes it works: typescript </h2><br><p>  <a href="https://github.com/zolotyh/treeshaking-hell/tree/old-babel-fix">Code</a> </p><br><p>  You can throw away the babel and compile your application with typescript.  After all, we were promised that any javascript is already typescript;) <br>  In the place where the <code>#__PURE__</code> directive <code>#__PURE__</code> typescript leaves the <code>@class</code> directive, and, as you understand, it doesn‚Äôt cost anything to write a loader that changes this very <code>@class</code> to what we need. </p><br><pre> <code class="hljs javascript"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">content</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> content.replace(<span class="hljs-regexp"><span class="hljs-regexp">/\/\*\* @class \*\//g</span></span>, <span class="hljs-string"><span class="hljs-string">'\n /*#__PURE__*/ \n'</span></span>); };</code> </pre> <br><p>  I think that you can come up with something with flow too.  By the way, while I was writing, I thought that perhaps the babel could also be of some help now.  Maybe one of you knows the answer? </p><br><h2 id="variant-radikalnyy-dlya-fanatov-optimizacii-google-closure-compiler-i-advanced-mode">  Option radical, for fans of optimization: google closure compiler and advanced mode </h2><br><p>  <a href="https://github.com/zolotyh/treeshaking-hell/tree/gcc">Code</a> </p><br><p>  This is what I like best.  To understand what I'm talking about, let's compare one by one, the best version of the bundle, resulting after compilation for: </p><br><div class="spoiler">  <b class="spoiler_title">Webpack + Babel:</b> <div class="spoiler_text"><pre> <code class="javascript hljs">!<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(t[r])<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t[r].exports;<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> o=t[r]={<span class="hljs-attr"><span class="hljs-attr">i</span></span>:r,<span class="hljs-attr"><span class="hljs-attr">l</span></span>:!<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">exports</span></span>:{}};<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n[r].call(o.exports,o,o.exports,e),ol=!<span class="hljs-number"><span class="hljs-number">0</span></span>,o.exports}<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t={};em=n,ec=t,ed=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n,t,r</span></span></span><span class="hljs-function">)</span></span>{eo(n,t)||<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(n,t,{<span class="hljs-attr"><span class="hljs-attr">configurable</span></span>:!<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">enumerable</span></span>:!<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-attr"><span class="hljs-attr">get</span></span>:r})},en=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t=n&amp;&amp;n.__esModule?<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n.default}:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n};<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ed(t,<span class="hljs-string"><span class="hljs-string">"a"</span></span>,t),t},eo=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n,e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.prototype.hasOwnProperty.call(n,e)},ep=<span class="hljs-string"><span class="hljs-string">""</span></span>,e(es=<span class="hljs-number"><span class="hljs-number">0</span></span>)}([<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n,e,t</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-string"><span class="hljs-string">"use strict"</span></span>;<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n,e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!(n <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> e))<span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TypeError</span></span>(<span class="hljs-string"><span class="hljs-string">"Cannot call a class as a function"</span></span>)}<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(e,<span class="hljs-string"><span class="hljs-string">"__esModule"</span></span>,{<span class="hljs-attr"><span class="hljs-attr">value</span></span>:!<span class="hljs-number"><span class="hljs-number">0</span></span>});<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> o=t(<span class="hljs-number"><span class="hljs-number">1</span></span>);(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">n</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{r(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>,n),<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.wheel=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> oa}).wheel.pump()},<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n,e,t</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-string"><span class="hljs-string">"use strict"</span></span>;<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n,e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!(n <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> e))<span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TypeError</span></span>(<span class="hljs-string"><span class="hljs-string">"Cannot call a class as a function"</span></span>)}<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">o</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n,e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t=<span class="hljs-number"><span class="hljs-number">0</span></span>;t&lt;e.length;t++){<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r=e[t];r.enumerable=r.enumerable||!<span class="hljs-number"><span class="hljs-number">1</span></span>,r.configurable=!<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">"value"</span></span><span class="hljs-keyword"><span class="hljs-keyword">in</span></span> r&amp;&amp;(r.writable=!<span class="hljs-number"><span class="hljs-number">0</span></span>),<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(n,r.key,r)}}<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">u</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n,e,t</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> e&amp;&amp;o(n.prototype,e),t&amp;&amp;o(n,t),n}td(e,<span class="hljs-string"><span class="hljs-string">"a"</span></span>,<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> c});<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">n</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{r(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>,n)}<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> u(n,[{<span class="hljs-attr"><span class="hljs-attr">key</span></span>:<span class="hljs-string"><span class="hljs-string">"pump"</span></span>,<span class="hljs-attr"><span class="hljs-attr">value</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"puuuuf"</span></span>)}}]),n}()}]);</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Rollup:</b> <div class="spoiler_text"><pre> <code class="javascript hljs">!<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-string"><span class="hljs-string">"use strict"</span></span>;<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> classCallCheck=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">instance,Constructor</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!(instance <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> Constructor))<span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TypeError</span></span>(<span class="hljs-string"><span class="hljs-string">"Cannot call a class as a function"</span></span>)},Wheel=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Wheel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{classCallCheck(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>,Wheel)}<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Wheel.prototype.pump=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"puuuuf"</span></span>)},Wheel}();(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Car</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{classCallCheck(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>,Car),<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.wheel=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Wheel}).wheel.pump()}();</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Google closure compiler in advanced mode</b> <div class="spoiler_text"><p> <code>console.log('puuuuf');</code> </p> </div></div><br><p>  I think no further explanation is necessary.  But there are problems.  Major 2: </p><br><ul><li>  Requires java </li><li><del>  Inconvenient to tune </del>  It is poorly integrated into the webpack, which, as you understand, is loved not only for tree-shaking. <br>  In general, Google closure compiler (GCC) requires an analysis of all your code.  This imposes its own limitations, but also gives buns in the form of optimizations that are inaccessible from the default Webpack. </li></ul><br><p>  GCC starts like this: </p><br><pre> <code class="hljs ruby">java -jar node_modules/google-closure-compiler/compiler.jar --compilation_level ADVANCED --language_in=ES6 --js ./src/index.js ./src/<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">js</span></span></span><span class="hljs-class"> &gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">out</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dev</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">js</span></span></span></span></code> </pre> <br><p>  The first problem is completely solved, especially since there is a brake, but still javascript version. <br>  My next article in this series will be about the second problem, in it I will try to integrate the google closure compiler into the assembly. </p><br><p>  PS: <br>  Most recently, a colleague suggested that for GCC a <a href="https://github.com/webpack-contrib/closure-webpack-plugin">plug-in for webpack</a> came out, <a href="https://github.com/zolotyh/treeshaking-hell/tree/gcc-webpack">I launched</a> , checked, the code was clearly less, but tree-shaking did not work.  Apparently the article about setting up GCC is still needed. </p><br><div class="spoiler">  <b class="spoiler_title">The code that I got</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> __wpcc;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>===__wpcc&amp;&amp;(__wpcc={}),<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">c</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-string"><span class="hljs-string">"use strict"</span></span>;<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>===n&amp;&amp;(n=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}),np=<span class="hljs-string"><span class="hljs-string">""</span></span>,n.src=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">c</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n.p+<span class="hljs-string"><span class="hljs-string">""</span></span>+c+<span class="hljs-string"><span class="hljs-string">".out.dev.js"</span></span>}}.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>,__wpcc);<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> __wpcc;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>===__wpcc&amp;&amp;(__wpcc={}),<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">c</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-string"><span class="hljs-string">"use strict"</span></span>;<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{},o=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{},t={};n.prototype.pump=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.console.log(<span class="hljs-string"><span class="hljs-string">"puuuuf"</span></span>)},o.prototype.turn=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.console.log(<span class="hljs-string"><span class="hljs-string">"turn"</span></span>)},t.Wheel=n,t.Rudder=o,(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.wheel=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> t.Wheel}).wheel.pump()}.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>,__wpcc);</code> </pre> </div></div><br><h2 id="vmesto-vyvoda">  Instead of output </h2><br><p>  Perhaps you have a question: how exactly <del>  all this </del>  Will tree-shaking affect my build? <br>  To be honest, right now I can not answer this question with full responsibility.  There is an opinion that it will not be worse, it will be better.  How much?  The question is complicated.  If you try, share in the comments.  I, in turn, promise to keep you informed, and as soon as there are worthy thoughts on this subject, I‚Äôll share them with pleasure. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/342964/">https://habr.com/ru/post/342964/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342952/index.html">How to create a stable and harmonious system of indentation in the design for faster development</a></li>
<li><a href="../342954/index.html">Features of manual testing in ALM Works and Odnoklassniki</a></li>
<li><a href="../342956/index.html">Designing APIs in Java. SOA-based application development using JAX-WS and JAX-RS technologies</a></li>
<li><a href="../342960/index.html">Welcome to the Atlassian Meetup December 12</a></li>
<li><a href="../342962/index.html">BPM in the company: let them decide the processes</a></li>
<li><a href="../342966/index.html">What rules of English do our foreign colleagues violate? Part 2</a></li>
<li><a href="../342968/index.html">Torskel - simplify the routine in Tornado</a></li>
<li><a href="../342970/index.html">Exonum 0.3 - what we have improved in the new version of the framework for the development of blockchains</a></li>
<li><a href="../342974/index.html">How to make your blockchain. Part 1 - Build, Store, Sync, Display, Mining, and Proof</a></li>
<li><a href="../342976/index.html">10 obvious steps to prepare the infrastructure of an online store for Black Friday</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>