<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>(May 25, Kiev) Fighters of the invisible front or the story of how to protect themselves from DDoS-attacks in a short time using Radware</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In a previous article, I reviewed the main development of DDoS attacks and reviewed Radware solutions. The review is a review, but the effectiveness o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>(May 25, Kiev) Fighters of the invisible front or the story of how to protect themselves from DDoS-attacks in a short time using Radware</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/getpro/habr/post_images/d7e/2e1/cac/d7e2e1cacae3015292d338526cb9e192.jpg"><br>  In a <a href="http://habrahabr.ru/company/muk/blog/217695/">previous article,</a> I reviewed the main development of DDoS attacks and reviewed Radware solutions.  The review is a review, but the effectiveness of the solution is known in combat conditions. <br><br>  Not so long ago (around May 25 in Kiev), by the will of fate, the mission had just over two days to organize the protection of a state web site from expected DDoS attacks. <br><br>  This article consists of two parts.  In the first one, I will describe how to configure the selected solution to protect against DDoS attacks, and in the second, how it protected the state website. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So my article will be useful as engineers who are going to test the described solution, as well as those who are just following the news and wondering how protection from first-hand DDoS attacks occurred. <a name="habracut"></a><br><br><h4>  DDoS protection solution </h4><br>  The choice of equipment against protection fell on the manufacturer Radware, as it has proved itself quite well earlier. <br>  The day before the expected attacks, I was allowed to the provider's site, where there was a mirror of the state web-site, so that I set up the system. <br><br>  Having screwed the piece of iron into a rack, I assigned management protocols and an IP address and proceeded with setting it up. <br><br>  But before starting to describe the setting, I will describe the deployment of the system itself. <br><br>  The system consisted of a protected web server, the Radware DefensePro device and the Radware APSolute Vision control system, which was deployed on an ESX virtual machine. <br><br>  The device ports operate in bridge mode and are completely transparent, which allows it to be easily integrated into the existing network without changing the addressing in the infrastructure. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c19/e67/6be/c19e676bee475a97f5d0c671e860d075.png"><br><br>  It‚Äôs very inconvenient to set up the piece of hardware directly by accessing its web interface, and the big disadvantage is that you cannot view statistics of current attacks in real time and also build reports on the attacks that occurred (reports are made by a separate feature - Security Reporter).  Vision itself is managed by a piece of iron and collects statistics using the SNMP protocol.  I have installed SNMP version 3 for secure traffic management. <br><br><h4>  Installing Vision Client for PC </h4><br>  To do this, go through the Web to the IP address of the installed APSolute Vision, download the client itself and install it. <br><img src="https://habrastorage.org/getpro/habr/post_images/879/c7d/125/879c7d12507a2457b0da5c95b0116c3c.png"><br><br>  Now we run the installed client and see in front of us such a window. <br><img src="https://habrastorage.org/getpro/habr/post_images/ceb/a62/bb3/ceba62bb35479c1211c1fc13a5be1370.png"><br><br>  Enter the login, password and IP address of the APSolute Vision server and get to its interface. <br><img src="https://habrastorage.org/getpro/habr/post_images/59a/aa2/d27/59aaa2d277a6c73fafd78d9aee4a395c.png"><br><br>  Let's see how the Radware device is added to manage it through APSolute Vision. <br><img src="https://habrastorage.org/getpro/habr/post_images/a28/eaf/6a2/a28eaf6a21796ccb7ca90be22fe5a217.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb8/771/7a3/cb87717a30e4830f69bee246ca78c7b5.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f33/721/7c3/f337217c3770298aa483b22782ce4d36.png"><br><br>  Now that DefensePro is added, you need to configure it. <br>  To enter the device configuration mode, you must first lock it.  It is done this way. <br><img src="https://habrastorage.org/getpro/habr/post_images/e1b/5a6/879/e1b5a6879d0a0908a8b4e9180d0bb3ee.png"><br><br>  Now you can customize the hardware itself. <br><br><h4>  Customization </h4><br>  1. First, you need to update the software glands: <br>  ‚Ä¢ Firmware <br>  ‚Ä¢ Attack description file <br>  ‚Ä¢ Attack Signatures <br><br>  Firmware: <br><br>  First, download the firmware on the model of our hardware from the partner portal on your PC.  But do not rush to leave the portal.  In order for the firmware to be successfully started by the device, you must also generate a password.  On the same portal, we look for the ‚ÄúPassword Generator‚Äù, go to it and, setting the platform of our piece of iron from the drop-down list, the version of the firmware we want to install and the MAC address, generate the password and save it (for example, in a notebook). <br><br>  Next, go to the tab ‚ÄúMonitoring‚Äù -&gt; ‚ÄúManage Software Versions‚Äù <br><img src="https://habrastorage.org/getpro/habr/post_images/86b/f8f/af8/86bf8faf837fc1081a049e8f0c596c82.png"><br><br>  Here we needed a password. <br><img src="https://habrastorage.org/getpro/habr/post_images/c6a/473/767/c6a473767c9ac65f695fd6595b3bbcf1.png"><br><br><h4>  Attack Description File </h4><br>  Now update the attack description file that the hardware will use.  We ship it from the same partner site.  And I took the file for all Radware devices. <br><br>  Go to ‚ÄúAsset Management‚Äù and at the bottom we find the button for updating the attack description file. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dfe/ca4/c85/dfeca4c85eb1d8ac7464dd46a557936d.png"><br><br><h4>  Signatures </h4><br>  Again, download the file with signatures from the partner site.  On the home page there is a link to it. <br>  After downloading, go to the tab ‚ÄúMonitoring‚Äù and update the signatures of attacks on DefensePro. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bee/c6b/361/beec6b361f823bc007b07f09bc34b2fa.png"><br><br><h4>  Security policies </h4><br><br>  1. You must first enable the necessary functions that we want to use for protection. <br>  To ensure effective opposition to attacks on the state website, I turn on features to the maximum: <br>  ‚Ä¢ Signature Protection <br>  ‚Ä¢ DoS Shield <br>  ‚Ä¢ BDoS Protection (Behavioral DoS) <br>  ‚Ä¢ BDoS Early Blocking <br>  ‚Ä¢ Anti-Scanning <br>  ‚Ä¢ SYN Flood Protection <br>  ‚Ä¢ HTTP Flood Protection <br>  ‚Ä¢ Packet Anomaly <br><br>  This will be enough to protect the web server. <br><br>  I have no desire to describe in detail every tick.  All this can be found in the DefensePro User Guide.  But I will explain the protection functions themselves. <br><br>  <b>Signature Protection</b> <br><br>  Signatures protect against already known application vulnerabilities, common viruses, trojans, spyware, worms and DoS. <br>  By default, this type of protection is enabled.  And it should be included.  But all the same, for complete confidence, it is necessary to double-check, because, as they say, ‚Äúit is better to outrun than to win‚Äù <br><br>  <b>DoS Shield</b> <br>  This feature protects against zero-day floods, including SYN floods, TCP floods, UDP floods, ICMP and IGMP floods. <br><br>  <b>BDoS Protection</b> <br>  A very important feature.  She is responsible for learning the hardware itself and shaping the normal behavior of traffic. <br><br>  The chip DefensePro is that, after training, when launching a DDoS attack (this is not known to anyone, for which there is no signature, no ordinary SYN Flood and HTTP Flood), the piece of hardware tracks an abnormal increase in traffic and when the specified limits are exceeded - begins to analyze the presence of an attack.  Regulated detection of suspicious traffic - 10 ms.  Next, the device begins to analyze suspicious traffic and, when a verdict about the presence of an attack is made, it forms a signature in real time blocking such traffic.  The regulated signature generation and blocking time is 8 ms.  Thus, blocking a new type of DDoS attack occurs in 18 ms. <br><br>  By default, the DefensePro training time is a week.  But, in terms of the urgency of the task, I set for 1 day. <br><img src="https://habrastorage.org/getpro/habr/post_images/349/654/9b0/3496549b0e7b68e3bbe5b55ff0279638.png"><br><br>  <b>BDoS Early Blocking</b> <br>  This function, as part of the BDoS function, is a very good addition to the solution.  She is responsible for the early blocking of attack traffic, even before he is marked with a device as suspicious.  The blocking of the attack in this case will occur in the interval of up to 10 ms (that is why it is called Early Blocking). <br>  The essence of this function is that it checks packets for normal formatting.  And if she sees that the headers are incorrectly placed in this or that protocol, she starts blocking such traffic.  In more detail about this function it is possible to learn everything in the same User Guide. <br><br>  <b>Anti-scanning</b> <br>  This feature protects against self-propagating worms, horizontal and vertical TCP and UDP scans and pings. <br><br>  <b>SYN Flood Protection</b> <br>  There is nothing difficult.  From SYN flooding saves Connection Limit. <br><br>  <b>HTTP Flood Protection</b> <br>  Prevents a new, yet unknown HTTP flood to the site. <br><br>  <b>Packet anomaly</b> <br>  Protects against abnormally formatted packages. <br><br>  2. After the necessary protection features have been activated, it's time to start declaring a secure server and writing security policies. <br>  2.1.  The declaration of the protection object (server) occurs in the section ‚ÄúClasses‚Äù -&gt; ‚ÄúNetworks‚Äù <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f44/a1d/04b/f44a1d04b24ad51535249c130d471f85.png"><br><br>  2.2.  Security policy is announced in the Network Protection section. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a7/749/0fb/7a77490fbed7788a6b0cefe0c0b4341f.png"><br><br>  And then we begin to fill our policy <br><br><img src="https://habrastorage.org/getpro/habr/post_images/60d/283/b19/60d283b19684a6f3741850e7215f0298.png"><br><br>  We set the name of the policy, the source network is any, the destination network is our previously announced server. <br><br>  Port group - here we create a new port group, in which we specify our interface, which looks to the Internet. <br>  I have this G1 interface. <br><br>  Direction, that is, direction, means in which direction traffic will be inspected by a given policy.  Choices are One Way and Two Way. <br><br>  One Way - only incoming traffic. <br><br>  Two Way - both incoming and outgoing.  In Radware terminology, this is called ‚Äúsmart line‚Äù. <br><br>  Now let's proceed directly to filling the policy. <br><br>  A policy in DefensePro consists of profiles of security features previously activated by us. <br><br>  Profiles are made up of rules. <br>  In the article, I will not describe the whole process completely, as I filled out the security policy, since it will take quite a lot of time and space for the reader.  Therefore, I will simply show an example on the task of the profile of one protection function and the final policy formed. <br><br>  For example, take BDoS, as one of the most important. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/976/677/295/97667729557cae3787d2bc7258fddcdb.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/081/712/af3/081712af34117624c810b87fd540d009.png"><br><br>  For the first installation is recommended to put all the checkboxes. <br>  It is also mandatory to set the incoming and outgoing speeds of the channel, which is connected to the DefensePro interfaces. <br>  And also an obligatory parameter is to set the percentage of protocols in the declared incoming and outgoing speeds.  Since we can only assume these percentages, not knowing exactly, we can set a default quota, which is determined by the device itself. <br>  I also recommend checking the Packet Trace checkbox so that, during and after the attack, the device remembers the IP addresses of the attackers. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f70/f10/842/f70f1084293abfec8da26af289923c59.png"><br><br>  Click ‚ÄúOK‚Äù. <br><br>  For BDoS, only the security profile is set.  But other protection functions consist of profiles that are made up of rules. <br>  For example, take the Connection Limit security feature. <br><img src="https://habrastorage.org/getpro/habr/post_images/fee/c49/f23/feec49f23b89f3e92486a34f6c0faea2.png"><br><br>  Now you need to fill the profile with the rules of protection. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e93/f29/b00/e93f29b0084eb7a7bc234a3226258ceb.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/919/d8e/b74/919d8eb74c4e965ae33971fbe33f73e4.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d99/f00/661/d99f00661b0f829e4bbaf0daf456be08.png"><br><br>  Thus, several rules can be combined in one profile and apply the last one in the security policy. <br>  Similarly, we fill our policy with other protection profiles. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/63a/fac/d8d/63afacd8d623947b788010e2306f50a9.png"><br><br>  Separately, I would like to stop at the protection function by signatures.  I chose All-DoS-Shield here, i.e.  Incoming traffic is compared with all signatures in the database, thus protecting it as much as possible.  But this has its minus - more CPU load.  If you know which application to protect, all you need to do is select the required set of signatures to compare the incoming traffic with them. <br><br>  Action I had to choose Block and Report. <br>  It is generally recommended to initially install Forward, in order not to block legitimate traffic.  But, since I had little time, I immediately took blocking. <br><br>  After the policy is ready, you need to apply it on the device. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/569/dd9/a89/569dd9a89e15c9b97bcaf6b0b341afca.png"><br><br>  Everything, our server is protected from network attacks. <br><br>  3. Now you need to protect it from attacks aimed at vulnerability level 7 <br>  To do this, go to the tab ‚ÄúServer Protection‚Äù and in the same way create a security policy against attacks of the 7th level <br><br><img src="https://habrastorage.org/getpro/habr/post_images/803/ed3/71e/803ed371eaba9b8d0a9fb36f84d1d0ae.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3c2/68f/331/3c268f33103379ac9e0747bd9e0c65dd.png"><br><br>  Everything.  We activate the policy and our server is protected. <br><br><h4>  Attack protection </h4><br>  So the day came when the attacks were expected.  Around 00:30 at night, the first scans for server vulnerabilities began.  In the middle of the night, small HTTP floods were observed. <br><br>  These attacks successfully repulsed the server protection policy against attacks of the 7th level. <br><br>  At 9:00, an intensive TCP SYN and HTTP flood began, along with scanning for vulnerabilities. <br><br>  Here are the attacks that went to the state website. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b47/974/cf2/b47974cf2f36dfcd703925bec8756de9.png"><br><br>  How it looks in graphics mode APSolute Vision <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eda/74d/08c/eda74d08c97ba3f33ad7a829b0211fef.png"><br><br>  Flood lasted until 15:00 and then everything calmed down.  In the period before 19:30, jokes started from colleagues, that the attackers received the first part of the fee for the attack and had already drunk. <br><br>  But at 7:30 pm, the same TCP SYN and HTTP floods began, along with scanning the server for vulnerabilities and DDoS for application vulnerabilities. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e6c/0b5/5e7/e6c0b55e7a8fa8cb4b348da87d12fb96.png"><br><br>  In megabits <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5e5/8e3/344/5e58e3344d86b66ba5008178ba37856f.png"><br><br>  And in kilopackets per second <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4d2/757/ecb/4d2757ecbf685ef3714c5900f85ad578.png"><br><br>  The graph shows from which IP addresses the attacks came: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b18/09e/867/b1809e86720cb55193391cabce2aca8d.png"><br><br><br><div class="spoiler">  <b class="spoiler_title">Spoiler with a personal comment, which was asked to hide in the comments</b> <div class="spoiler_text">  Well, actually, who would doubt.  Personally, I'm not even surprised that the most massive attacks came from Russian IP addresses. </div></div><br><br>  On the second wave of the attack, the DefensePro device itself has already built a signature based on an analysis of anomalous increase in traffic. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ee/3cd/ea6/8ee3cdea6d3843a8c8527f24fcdc3797.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/285/4bc/c36/2854bcc367884d72eedd5f78f43efbdd.png"><br><br>  CPU load with this attack: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c9/039/34e/1c903934e5cda963badc76253eef7027.png"><br><br>  Somewhere from 20:30, the attack fell to this level: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/639/47d/09b/63947d09ba2b19c38f3429664407babe.png"><br><br>  And at this level, the attack remained until 23:30. <br>  At 23:30 we clearly see how the paid off time of the attack ended: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a74/001/225/a7400122573a0806f39fbb1c2f02ef58.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f22/8d6/6e0/f228d66e0025d028e3040f0e4effdcd7.png"><br><br>  And the hamsters went to bed. <br>  Subsequently, after 11:30 pm and throughout the next day, constant and small scans of the state web site for vulnerabilities were blocked that were blocked on DefensePro. <br><br><hr><br><br>  Thus, having drawn a line at the end of the article, I want to characterize the day of the expected attacks by two relatively average and not so long DDoSs that Radware DefensePro successfully beat off.  By loading the processor, we see that it could withstand significantly more attacks.  But we did not organize DDoS to check how long the glands would be. <br><br><hr><br>  <a href="http://www.service.muk.ua/">MUK-Service - all types of IT repair: warranty, non-warranty repair, sale of spare parts, contract service</a> </div><p>Source: <a href="https://habr.com/ru/post/224891/">https://habr.com/ru/post/224891/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../224871/index.html">The electronic cigarette will count every puff</a></li>
<li><a href="../224875/index.html">Feature # 2 - Podcast on entrepreneurs and current trends in the IT ecosystem</a></li>
<li><a href="../224879/index.html">Anemic Domain Model [Translation]</a></li>
<li><a href="../224883/index.html">Kerio Control for Windows to Kerio Control Appliance Migration Guide</a></li>
<li><a href="../224889/index.html">Google maps clustering</a></li>
<li><a href="../224895/index.html">The main international standards and best practices for auditing information technology</a></li>
<li><a href="../224897/index.html">WebRTC or how I taught our CRM to call phones</a></li>
<li><a href="../224901/index.html">Automatic downloading of the list of prohibited sites from the Roskomnadzor service</a></li>
<li><a href="../224903/index.html">5 mistakes made when starting a startup</a></li>
<li><a href="../224905/index.html">Startup Village 2014 through the eyes of the Webot robot</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>