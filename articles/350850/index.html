<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Do you really need Redux?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, React positioned itself as "V in MVC". After this commit, the marketing text changed, but the essence remained the same: React is res...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Do you really need Redux?</h1><div class="post__text post__text-html js-mediator-article"><p>  Not so long ago, React positioned itself as "V in MVC".  After <a href="https://github.com/facebook/react/commit/c7868cc7411694a7fd3b80aea589e280e88d926c">this commit, the</a> marketing text changed, but the essence remained the same: React is responsible for the display, the developer - for everything else, that is, speaking in MVC terms, for Model and Controller. </p><br><p>  One of the solutions for managing the Model (state) of your application is Redux.  Its appearance is <a href="https://redux.js.org/introduction/motivation">motivated by the</a> increased complexity of frontend applications that MVC cannot handle. </p><br><blockquote>  Main Technical Imperative of Software Development - complexity management <br><br>  - <a href="https://www.ozon.ru/context/detail/id/138437220/">Perfect code</a> </blockquote><p>  Redux offers to manage complexity with predictable state changes.  Predictability is achieved through <a href="https://redux.js.org/introduction/three-principles">three fundamental principles</a> : </p><br><ul><li>  the state of the entire application is stored in one place </li><li>  the only way to change state is to send actions. </li><li>  all changes happen with pure functions </li></ul><br><p>  Was Redux able to overcome the increased complexity and was there anything to fight with? </p><a name="habracut"></a><br><h2 id="mvc-ne-masshtabiruetsya">  MVC does not scale </h2><br><p>  Redux is inspired by <a href="https://facebook.github.io/flux/">Flux</a> , a solution from Facebook.  The reason for the creation of Flux, as <a href="https://www.infoq.com/news/2014/05/facebook-mvc-flux">stated by Facebook developers</a> ( <a href="https://youtu.be/nYkdrAPrdcw%3Ft%3D10m23s">video</a> ), was the problem of the scalability of the MVC architectural pattern. </p><br><p>  According to the description of Facebook, the connections of objects in large projects using MVC eventually become unpredictable: </p><br><ol><li>  modelOne changes viewOne </li><li>  viewOne changes modelTwo during its change </li><li>  modelTwo changes modelThree during its change </li><li>  modelThree changes viewTwo and viewFour during its change </li></ol><br><p>  The problem of the unpredictability of changes in MVC is also written in Redux's motivation.  The picture below illustrates how Facebook developers see this problem. </p><br><p><img src="https://habrastorage.org/webt/mj/4n/sl/mj4nsl3zgsmerztgfsxagljbkfo.png"></p><br><p>  Flux, in contrast to the described MVC, offers a clear and coherent model: </p><br><ol><li>  View spawns Action </li><li>  Action enters Dispatcher </li><li>  Dispatcher Updates Store </li><li>  Updated Store notifies View of a change. </li><li>  View redraws </li></ol><br><p><img src="https://habrastorage.org/webt/2i/zz/bo/2izzboknxql04sktijvdj-whqvk.png"></p><br><p>  In addition, using Flux, several Views can subscribe to the Stores of interest and be updated only when something changes in these Stores.  This approach reduces the number of dependencies and simplifies development. </p><br><p><img src="https://habrastorage.org/webt/4k/bv/e3/4kbve3hmmutdaxjhowvjpwb2yxi.png"></p><br><p>  The MVC implementation from Facebook is completely different from the original MVC, which was widely distributed in the Smalltalk world.  This difference is the main reason for the statement "MVC does not scale." </p><br><h2 id="nazad-v-vosmidesyatye">  Back in the eighties </h2><br><p>  MVC is the primary approach to developing user interfaces in Smalltalk-80.  Like Flux and Redux, MVC was created to reduce software complexity and speed development.  I will give a brief description of the basic principles of the MVC approach, a more detailed overview can be found <a href="http://www.global-webnet.com/Adventures/Files/DescriptionOfMvcUi-KrasnerPope.pdf">here</a> and <a href="http://www.math.sfedu.ru/smalltalk/gui/mvc.pdf">here</a> . </p><br><p>  Responsibilities of MVC entities: </p><br><ul><li>  Model is a central entity that models the real world and business logic, provides information about its state, and also changes its state upon request from the Controller. </li><li>  View receives information about the state of the Model and displays it to the user. </li><li>  The controller tracks mouse movement, clicks on the mouse and keyboard buttons, and processes them by changing the View or Model. </li></ul><br><p>  And now that Facebook missed, realizing MVC - the connections between these entities: </p><br><ul><li>  View can only be associated <strong>with one</strong> Controller </li><li>  A controller can only be associated <strong>with one</strong> View. </li><li>  Model <strong>knows nothing</strong> about View and Controller and <strong>cannot change them.</strong> </li><li>  View and Controller subscribe to Model </li><li>  One pair of View and Controller can only be subscribed <strong>to one</strong> Model. </li><li>  A model can have <strong>many subscribers</strong> and notifies all of them after changing its state. </li></ul><br><p>  Look at the image below.  The arrows directed from Model to Controller and View are not attempts to change their state, but alerts about changes in Model. </p><br><p><img src="https://habrastorage.org/webt/sd/3t/pv/sd3tpveiqa2gl09znpm9dc63coo.jpeg"></p><br><p>  The original MVC is completely different from the Facebook implementation, in which the View can change the Model set, the Model can change the View set, and the Controller does not form a close one-to-one relationship with the View.  Moreover, Flux is MVC, in which Dispatcher and Store play the role of Model, and Action is sent instead of calling methods. </p><br><h2 id="react-cherez-prizmu-mvc">  React through MVC </h2><br><p>  Let's look at the code for a simple React component: </p><br><pre><code>class ExampleButton extends React.Component {
  render() { return (
    &lt;button onClick={() =&gt; console.log("clicked!")}&gt;
        Click Me!
    &lt;/button&gt;
  ); }
}</code></pre><br>
<p>       Controller'a   MVC:</p><br>
<blockquote>Controller   ,         ,  View  Model<br>
<br>
ontroller    <strong>  </strong> View</blockquote><p>,  Controller   View    ?  :</p><br>
<pre><code>onClick={() =&gt; console.log("clicked!")}</code></pre><br>
<p>  Controller,     . JavaScript    ,            .  React-     View,      View-Controller.</p><br>
<p>  React,     Model. React-    Model       .</p><br>
<h2 id="gotovim-mvc"> MVC</h2><br>
<p>    React-,    BaseView,       props Model:</p><br>
<pre><code>// src/Base/BaseView.tsx
import * as React from "react";
import BaseModel from "./BaseModel";

export default class &lt;Model extends BaseModel, Props&gt; extends React.Component&lt;Props &amp; {model: Model}, {}&gt; {
    protected model: Model;

    constructor(props: any) {
        super(props);
        this.model = props.model
    }

    componentWillMount() { this.model.subscribe(this); }

    componentWillUnmount() { this.model.unsubscribe(this); }
}</code></pre><br>
<p>    state    ,      . View              <code>this.forceUpdate()</code>,   . ,      ,    ,       .</p><br>
<p>   BaseModel,      ,   ,        :</p><br>
<pre><code>// src/Base/BaseModel.ts
export default class {
    protected views: React.Component[] = [];

    subscribe(view: React.Component) {
        this.views.push(view);
        view.forceUpdate();
    }

    unsubscribe(view: React.Component) {
        this.views = this.views.filter((item: React.Component) =&gt; item !== view);
    }

    protected updateViews() {
        this.views.forEach((view: React.Component) =&gt; view.forceUpdate())
    }
}</code></pre><br>
<p>    TodoMVC   ,      <a href="https://github.com/Telichkin/react-without-redux/tree/master/todomvc/src">Github</a>. </p><br>
<p>TodoMVC  ,     .        : "  ", "   ", "  ".        .   :</p><br>
<pre><code>// src/TodoList/TodoListModel.ts
import BaseModel from "../Base/BaseModel";
import TodoItemModel from "../TodoItem/TodoItemModel";

export default class extends BaseModel {
    private allItems: TodoItemModel[] = [];
    private mode: string = "all";

    constructor(items: string[]) {
        super();
        items.forEach((text: string) =&gt; this.addTodo(text));
    }

    addTodo(text: string) {
        this.allItems.push(new TodoItemModel(this.allItems.length, text, this));
        this.updateViews();
    }

    removeTodo(todo: TodoItemModel) {
        this.allItems = this.allItems.filter((item: TodoItemModel) =&gt; item !== todo);
        this.updateViews();
    }

    todoUpdated() { this.updateViews(); }

    showAll() { this.mode = "all"; this.updateViews(); }

    showOnlyActive() { this.mode = "active"; this.updateViews(); }

    showOnlyCompleted() { this.mode = "completed"; this.updateViews(); }

    get shownItems() {
        if (this.mode === "active") { return this.onlyActiveItems; }
        if (this.mode === "completed") { return this.onlyCompletedItems; }
        return this.allItems; 
    }

    get onlyActiveItems() {
        return this.allItems.filter((item: TodoItemModel) =&gt; item.isActive());
    }

    get onlyCompletedItems() {
        return this.allItems.filter((item: TodoItemModel) =&gt; item.isCompleted());
    }
}</code></pre><br>
<p>      .     ,  ,       .     :</p><br>
<pre><code>// src/TodoItem/TodoItemModel.ts
import BaseModel from "../Base/BaseModel";
import TodoListModel from "../TodoList/TodoListModel";

export default class extends BaseModel {
    private completed: boolean = false;
    private todoList?: TodoListModel;
    id: number;
    text: string = "";

    constructor(id: number, text: string, todoList?: TodoListModel) {
        super();
        this.id = id;
        this.text = text;
        this.todoList = todoList;
    }

    switchStatus() { 
        this.completed = !this.completed
        this.todoList ? this.todoList.todoUpdated() : this.updateViews();
    }

    isActive() { return !this.completed; }

    isCompleted() { return this.completed; }

    remove() { this.todoList &amp;&amp; this.todoList.removeTodo(this) }
}</code></pre><br>
<p>       View,        Model.  View    :</p><br>
<pre><code>// src/TodoList/TodoListInputView.tsx
import * as React from "react";
import BaseView from "../Base/BaseView";
import TodoListModel from "./TodoListModel";

export default class extends BaseView&lt;TodoListModel, {}&gt; {
    render() { return (
        &lt;input 
            type="text"
            className="new-todo" 
            placeholder="What needs to be done?"
            onKeyDown={(e: any) =&gt; {
                const enterPressed = e.which === 13;
                if (enterPressed) { 
                    this.model.addTodo(e.target.value);
                    e.target.value = "";
                }
            }}
        /&gt;
    ); }
}</code></pre><br>
<p>   View,   ,  Controller (props onKeyDown)   Model  View,    Model .        props'    ,    .</p><br>
<p>   View   TodoListModel,     :</p><br>
<pre><code>// src/TodoList/TodoListView.tsx
import * as React from "react";
import BaseView from "../Base/BaseView";
import TodoListModel from "./TodoListModel";
import TodoItemModel from "../TodoItem/TodoItemModel";
import TodoItemView from "../TodoItem/TodoItemView";

export default class extends BaseView&lt;TodoListModel, {}&gt; {
    render() { return (
        &lt;ul className="todo-list"&gt;
            {this.model.shownItems.map((item: TodoItemModel) =&gt; &lt;TodoItemView model={item} key={item.id}/&gt;)}
        &lt;/ul&gt;
    ); }
}</code></pre><br>
<p>  View    ,      TodoItemModel:</p><br>
<pre><code>// src/TodoItem/TodoItemView.jsx
import * as React from "react";
import BaseView from "../Base/BaseView";
import TodoItemModel from "./TodoItemModel";

export default class extends BaseView&lt;TodoItemModel, {}&gt; {
    render() { return (
        &lt;li className={this.model.isCompleted() ? "completed" : ""}&gt;
            &lt;div className="view"&gt;
                &lt;input
                    type="checkbox"
                    className="toggle"
                    checked={this.model.isCompleted()}
                    onChange={() =&gt; this.model.switchStatus()}
                /&gt;
                &lt;label&gt;{this.model.text}&lt;/label&gt;
                &lt;button className="destroy" onClick={() =&gt; this.model.remove()}/&gt;
            &lt;/div&gt;
        &lt;/li&gt;
    ); }
}</code></pre><br>
<p>TodoMVC .     ,    60  .          : Model  View,    .          props',     .       <a href="https://medium.com/%40dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0"> Container-</a>.</p><br>
<h2 id="chto-ne-tak-s-redux">    Redux?</h2><br>
<p> ,     <a href="https://medium.com/%40gianluca.guarini/things-nobody-will-tell-you-about-react-js-3a373c1b03b4"> </a> <a href="https://codeburst.io/the-ugly-side-of-redux-6591fde68200"> Redux</a> ,     <a href="https://medium.com/%40dan_abramov/you-might-not-need-redux-be46360cf367"></a>,  Redux     .   frontend- :</p><br>
<ul>
<li>     local storage  ,   </li>
<li>           HTML</li>
<li> Action'   </li>
<li> undo  </li>
</ul><br>
<p>   Redux      ,         .</p><br>
<p>Redux  ,           ,       ,   . Redux  indirection  <a href="https://medium.com/%40dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0"></a>,        Presentation Components   ,  Action'   State,  props.   indirection'    <a href="https://jaysoo.ca/2015/11/21/avoid-unnecessary-indirection/">  </a>.            <a href="http://wiki.c2.com/%3FPrematureGeneralization"> </a>,          .</p><br>
<p>  indirection'      TodoMVC,      Redux.    State   <a href="">  callback' onSave</a>,      ? </p><br>
<div class="spoiler"><b class="spoiler_title">     ,    </b><div class="spoiler_text"><ol>
<li><code>hadleSave</code>  <code>TodoItem</code>   props <code>onSave</code>  <code>TodoTextInput</code></li>
<li><code>onSave</code>    <code>Enter</code> ,    props <code>newTodo</code>,   <code>onBlur</code></li>
<li><code>hadleSave</code>  props <code>deleteTodo</code>,      ,  props <code>editTodo</code>   </li>
<li>props' <code>deleteTodo</code>  <code>editTodo</code>   <code>TodoItem</code>  <code>MainSection</code></li>
<li><code>MainSection</code>    props' <code>deleteTodo</code>  <code>editTodo</code>  <code>TodoItem</code></li>
<li>props'  <code>MainSection</code>    <code>App</code>   <code>bindActionCreator</code>,     action'  <code>src/actions/index.js</code>,    <code>src/reducers/todos.js</code></li>
</ol></div></div><br>
<p>   ,   callback',   props',      2 .       ,     . </p><br>
<p>   MVC, ,       . <a href="">   </a>    indirection'       ,      . </p><br>
<p> Flux  Redux    MVC,    ,    MVC. Redux      ,    callback'  props'     ,          .   frontend-,     Flux  Redux,  .       . Facebook         ,      ""   . <strong></strong>  frontend-   Facebook,  <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BA%25D1%2581%25D0%25BF%25D0%25B5%25D1%2580%25D0%25B8%25D0%25BC%25D0%25B5%25D0%25BD%25D1%2582_%25D0%259C%25D0%25B8%25D0%25BB%25D0%25B3%25D1%2580%25D1%258D%25D0%25BC%25D0%25B0">   </a>.       ,   ,      MVC   ?</p><br>
<h2 id="upd">UPD</h2><br>
<p>  <code>view.setState({})</code>  <code>view.forceUpdate()</code>. , <a href="https://habrahabr.ru/users/kahi4/" class="user_link">kahi4</a>. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/350850/">https://habr.com/ru/post/350850/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350840/index.html">Sentenced to Russian hackers who attacked US exchanges</a></li>
<li><a href="../350842/index.html">Experience in the development of a non-commercial project by the Junior</a></li>
<li><a href="../350844/index.html">Design by Introspection</a></li>
<li><a href="../350846/index.html">Using the render props template outside of the render</a></li>
<li><a href="../350848/index.html">Women in IT, an inside look</a></li>
<li><a href="../350852/index.html">Information security of bank non-cash payments. Part 3 - Formation of requirements for the protection system</a></li>
<li><a href="../350854/index.html">FastTrack Training. "Network Basics". "Basics of data centers." Part 1. Eddie Martin. December 2012</a></li>
<li><a href="../350856/index.html">Interface Composition in Go</a></li>
<li><a href="../350858/index.html">Writing Telegram-bot for Habrahabr</a></li>
<li><a href="../350860/index.html">How big data will change the automotive industry</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>