<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Moq usage examples</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Moq is a simple and lightweight Isolation Framework, which is built on the basis of anonymous methods and expression trees. To create mocks, it uses c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Moq usage examples</h1><div class="post__text post__text-html js-mediator-article">  Moq is a simple and lightweight Isolation Framework, which is built on the basis of anonymous methods and expression trees.  To create mocks, it uses code generation, so it allows you to "mock up" interfaces, virtual methods (and even protected methods), and does not allow you to "mock" non-virtual and static methods. <br><br>  <b>NOTE</b> <br>  There are only two frameworks on the market that allow you to "mock" anything.  These are TypeMockIsolator and Microsoft Fakes, available in Visual Studio 2012 (formerly known as <a href="http://sergeyteplyakov.blogspot.com/2010/12/microsoft-moles.html">Microsoft Moles</a> ).  These frameworks, unlike Moq, use not code generation, but the CLR Profiling API, which allows you to hook into almost any method and create mocks / stubs even for static, non-virtual or closed methods. <br><a name="habracut"></a><br>  In Moq, there is no separation between ‚Äústubs‚Äù (stubs) and ‚Äúmocks‚Äù (mocks) or, more formally, there is no separation between state verification and behavior verification.  And although in most cases the <a href="http://sergeyteplyakov.blogspot.com/2011/12/blog-post.html">differences between stubs and mocks are</a> not so important, and sometimes the same stub performs both roles, we will consider examples from simple to complex, therefore we first consider examples of checking the state, and only then proceed to check the behavior . <br><br><h3>  <b>State</b> <b>verification</b> </h3><br>  As an example, we will consider the unit test suite for the following interface: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ILoggerDependency</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCurrentDirectory</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDirectoryByLoggerName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> loggerName</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> DefaultLogger { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } }</code> </pre> <br><br>  1. <b>GetCurrentDirectory</b> method <b>stub</b> : <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// Mock.Of    (-),   -. //   ,    GetCurrentDirectory() //   "D:\\Temp" ILoggerDependency loggerDependency = Mock.Of&lt;ILoggerDependency&gt;(d =&gt; d.GetCurrentDirectory() == "D:\\Temp"); var currentDirectory = loggerDependency.GetCurrentDirectory(); Assert.That(currentDirectory, Is.EqualTo("D:\\Temp"));</span></span></code> </pre><br><br>  2. The <b>stub of the GetDirectoryByLoggerName</b> method, which always returns the same result: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//     GetDirectoryByLoggerName  "C:\\Foo". ILoggerDependency loggerDependency = Mock.Of&lt;ILoggerDependency&gt;( ld =&gt; ld.GetDirectoryByLoggerName(It.IsAny&lt;string&gt;()) == "C:\\Foo"); string directory = loggerDependency.GetDirectoryByLoggerName("anything"); Assert.That(directory, Is.EqualTo("C:\\Foo"));</span></span></code> </pre><br><br>  3. The <b>stub</b> method <b>GetDirrectoryByLoggerName</b> , returning the result depending on the argument: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//    ,    //  GetDirrectoryByLoggerName    . //    : // public string GetDirectoryByLoggername(string s) { return "C:\\" + s; } Mock&lt;ILoggerDependency&gt; stub = new Mock&lt;ILoggerDependency&gt;(); stub.Setup(ld =&gt; ld.GetDirectoryByLoggerName(It.IsAny&lt;string&gt;())) .Returns&lt;string&gt;(name =&gt; "C:\\" + name); string loggerName = "SomeLogger"; ILoggerDependency logger = stub.Object; string directory = logger.GetDirectoryByLoggerName(loggerName); Assert.That(directory, Is.EqualTo("C:\\" + loggerName));</span></span></code> </pre><br><br>  4. <b>DefaultLogger</b> property <b>stubs</b> : <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//  DefaultLogger       ILoggerDependency logger = Mock.Of&lt;ILoggerDependency&gt;( d =&gt; d.DefaultLogger == "DefaultLogger"); string defaultLogger = logger.DefaultLogger; Assert.That(defaultLogger, Is.EqualTo("DefaultLogger"));</span></span></code> </pre><br><br>  5. Setting the behavior of several methods with one expression using the ‚Äúmoq functional specification‚Äù (appeared in Moq v4): <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//        ¬´¬ª ILoggerDependency logger = Mock.Of&lt;ILoggerDependency&gt;( d =&gt; d.GetCurrentDirectory() == "D:\\Temp" &amp;&amp; d.DefaultLogger == "DefaultLogger" &amp;&amp; d.GetDirectoryByLoggerName(It.IsAny&lt;string&gt;()) == "C:\\Temp"); Assert.That(logger.GetCurrentDirectory(), Is.EqualTo("D:\\Temp")); Assert.That(logger.DefaultLogger, Is.EqualTo("DefaultLogger")); Assert.That(logger.GetDirectoryByLoggerName("CustomLogger"), Is.EqualTo("C:\\Temp"));</span></span></code> </pre><br><br>  6. Setting the behavior of several methods by calling the Setup method (‚Äúold‚Äù v3 syntax): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stub = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;ILoggerDependency&gt;(); stub.Setup(ld =&gt; ld.GetCurrentDirectory()).Returns(<span class="hljs-string"><span class="hljs-string">"D:\\Temp"</span></span>); stub.Setup(ld =&gt; ld.GetDirectoryByLoggerName(It.IsAny&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;())).Returns(<span class="hljs-string"><span class="hljs-string">"C:\\Temp"</span></span>); stub.SetupGet(ld =&gt; ld.DefaultLogger).Returns(<span class="hljs-string"><span class="hljs-string">"DefaultLogger"</span></span>); ILoggerDependency logger = stub.Object; Assert.That(logger.GetCurrentDirectory(), Is.EqualTo(<span class="hljs-string"><span class="hljs-string">"D:\\Temp"</span></span>)); Assert.That(logger.DefaultLogger, Is.EqualTo(<span class="hljs-string"><span class="hljs-string">"DefaultLogger"</span></span>)); Assert.That(logger.GetDirectoryByLoggerName(<span class="hljs-string"><span class="hljs-string">"CustomLogger"</span></span>), Is.EqualTo(<span class="hljs-string"><span class="hljs-string">"C:\\Temp"</span></span>));</code> </pre><br><br>  <b>NOTE</b> <br>  As I already mentioned, in Moq there is no separation between mocks and stubs, however, it will be much easier for us to distinguish between two stub initialization syntax.  So, the ‚Äúmoq functional specification‚Äù syntax can only be used for state testing (i.e. for stubs) and cannot be used to define behavior.  Initialization of the stubs using the <b>Setup</b> method may be, firstly, more verbose, and secondly, when using it, it is not entirely clear whether we are going to check the behavior or state. <br><br><h3>  <b>Behavior</b> <b>verification</b> </h3><br>  The following class and interface will be used to test the behavior: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ILogWriter</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> logger</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Write</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Logger</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ILogWriter _logWriter; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Logger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ILogWriter logWriter</span></span></span><span class="hljs-function">)</span></span> { _logWriter = logWriter; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> { _logWriter.Write(message); } }</code> </pre><br><br>  1. Verification of the call to the <b>ILogWriter</b> <b>.Write</b> method <b>by</b> <b>an</b> object of the <b>Logger</b> class (with any argument): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;ILogWriter&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logger = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Logger(mock.Object); logger.WriteLine(<span class="hljs-string"><span class="hljs-string">"Hello, logger!"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ,    Write      mock.Verify(lw =&gt; lw.Write(It.IsAny&lt;string&gt;()));</span></span></code> </pre><br><br>  2. Verification of a call to the <b>ILogWriter</b> <b>.Write</b> method with the given arguments: <br><br><pre> <code class="cs hljs">mock.Verify(lw =&gt; lw.Write(<span class="hljs-string"><span class="hljs-string">"Hello, logger!"</span></span>));</code> </pre><br><br>  3. Verify that the <b>ILogWriter</b> <b>.Write</b> method was <b>called</b> exactly once (no more, no less): <br><br><pre> <code class="cs hljs">mock.Verify(lw =&gt; lw.Write(It.IsAny&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;()), Times.Once());</code> </pre><br><br>  <b>NOTE</b> <br>  There are many options for checking how many times a dependency is caused.  For this, there are various methods of the Times class: AtLeast (int), AtMost (int), Exactly, Between, and others. <br><br>  4. Verify behavior using the <b>Verify</b> method (can be handy when you need to test several assumptions): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;ILogWriter&gt;(); mock.Setup(lw =&gt; lw.Write(It.IsAny&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;())); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logger = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Logger(mock.Object); logger.WriteLine(<span class="hljs-string"><span class="hljs-string">"Hello, logger!"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     Verify   . //  ,      //   mock.Setup mock.Verify();</span></span></code> </pre><br><br>  5. Verify multiple calls using the <b>Verify</b> <b>()</b> method. <br><br>  In some cases, it is inconvenient to use several <b>Verify</b> methods to test multiple calls.  Instead, you can create a mock object and set the expected behavior using the <b>Setup</b> methods and check all these assumptions by calling the same <b>Verify</b> () method.  Such a technique can be convenient for reusing mock objects created in the Setup Test method. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;ILogWriter&gt;(); mock.Setup(lw =&gt; lw.Write(It.IsAny&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;())); mock.Setup(lw =&gt; lw.SetLogger(It.IsAny&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;())); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logger = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Logger(mock.Object); logger.WriteLine(<span class="hljs-string"><span class="hljs-string">"Hello, logger!"</span></span>); mock.Verify();</code> </pre><br><br><h3>  <b>Retreat from the topic.</b>  <b>Strict</b> <b>vs</b> <b>Loose</b> <b>models</b> </h3><br><br>  Moq supports two behavioral testing models: <b>strict</b> (strict) and <b>free</b> (loose).  By default, a free model of checks is used, which is that the class under test (Class Under Test, CUT), during the execution of an action (in the Act section) can call any methods of our dependencies and we are not obliged to specify them all. <br><br>  So, in the previous example, the <b>logger</b> <b>.WriteLine</b> method calls two <b>ILogWriter</b> interface <b>methods</b> : the <b>Write</b> method and the <b>SetLogger method</b> .  When using <b>MockBehavior</b> <b>.Strict,</b> the <b>Verify</b> method fails unless we explicitly indicate which exact dependency methods will be called: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;ILogWriter&gt;(MockBehavior.Strict); <span class="hljs-comment"><span class="hljs-comment">//      ,  //  mock.Verify()    mock.Setup(lw =&gt; lw.Write(It.IsAny&lt;string&gt;())); mock.Setup(lw =&gt; lw.SetLogger(It.IsAny&lt;string&gt;())); var logger = new Logger(mock.Object); logger.WriteLine("Hello, logger!"); mock.Verify();</span></span></code> </pre><br><br><h3>  <b>Using the MockRepository</b> </h3><br><br>  The <b>MockRepository</b> class provides another syntax for creating stubs and, most importantly, allows you to store several mock objects and check more complex behavior by calling a single method. <br><br>  1. Use <b>MockRepository</b> <b>.Of</b> to create stubs. <br>  This syntax is similar to using <b>Mock</b> <b>.Of</b> , however, it allows you to set the behavior of different methods not through the &amp;&amp; operator, but by using several <b>Where</b> methods: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repository = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MockRepository(MockBehavior.Default); ILoggerDependency logger = repository.Of&lt;ILoggerDependency&gt;() .Where(ld =&gt; ld.DefaultLogger == <span class="hljs-string"><span class="hljs-string">"DefaultLogger"</span></span>) .Where(ld =&gt; ld.GetCurrentDirectory() == <span class="hljs-string"><span class="hljs-string">"D:\\Temp"</span></span>) .Where(ld =&gt; ld.GetDirectoryByLoggerName(It.IsAny&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;()) == <span class="hljs-string"><span class="hljs-string">"C:\\Temp"</span></span>) .First(); Assert.That(logger.GetCurrentDirectory(), Is.EqualTo(<span class="hljs-string"><span class="hljs-string">"D:\\Temp"</span></span>)); Assert.That(logger.DefaultLogger, Is.EqualTo(<span class="hljs-string"><span class="hljs-string">"DefaultLogger"</span></span>)); Assert.That(logger.GetDirectoryByLoggerName(<span class="hljs-string"><span class="hljs-string">"CustomLogger"</span></span>), Is.EqualTo(<span class="hljs-string"><span class="hljs-string">"C:\\Temp"</span></span>));</code> </pre><br><br>  2. Use <b>MockRepository</b> to set the behavior of several mock objects. <br>  Suppose we have a more complex class, <b>SmartLogger</b> , which requires two dependencies: <b>ILogWriter</b> and <b>ILogMailer</b> .  Our test class, when calling its <b>Write</b> method, should call the methods of two dependencies: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MockRepository(MockBehavior.Default); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logWriterMock = repo.Create&lt;ILogWriter&gt;(); logWriterMock.Setup(lw =&gt; lw.Write(It.IsAny&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;())); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logMailerMock = repo.Create&lt;ILogMailer&gt;(); logMailerMock.Setup(lm =&gt; lm.Send(It.IsAny&lt;MailMessage&gt;())); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> smartLogger = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SmartLogger(logWriterMock.Object, logMailerMock.Object); smartLogger.WriteLine(<span class="hljs-string"><span class="hljs-string">"Hello, Logger"</span></span>); repo.Verify();</code> </pre><br><br><h3>  <b>Other technology</b> </h3><br><br>  In some cases, it is useful to get the mock object itself via the interface (get <b>Mock</b> <b>&lt;ISomething</b> <b>&gt;</b> through the <b>ISomething</b> interface).  For example, the functional syntax for stub initialization does not return a mock object, but the required interface immediately.  This is convenient for testing a couple of simple methods, but it is inconvenient if you also need to check the behavior, or set a method that returns different results for different parameters.  So sometimes it is convenient to use LINQ-based syntax for one part of the methods and use the <b>Setup</b> methods for another: <br><br><pre> <code class="cs hljs">ILoggerDependency logger = Mock.Of&lt;ILoggerDependency&gt;( ld =&gt; ld.GetCurrentDirectory() == <span class="hljs-string"><span class="hljs-string">"D:\\Temp"</span></span> &amp;&amp; ld.DefaultLogger == <span class="hljs-string"><span class="hljs-string">"DefaultLogger"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      GetDirectoryByLoggerName //    ,     Mock.Get(logger) .Setup(ld =&gt; ld.GetDirectoryByLoggerName(It.IsAny&lt;string&gt;())) .Returns&lt;string&gt;(loggerName =&gt; "C:\\" + loggerName); Assert.That(logger.GetCurrentDirectory(), Is.EqualTo("D:\\Temp")); Assert.That(logger.DefaultLogger, Is.EqualTo("DefaultLogger")); Assert.That(logger.GetDirectoryByLoggerName("Foo"), Is.EqualTo("C:\\Foo")); Assert.That(logger.GetDirectoryByLoggerName("Boo"), Is.EqualTo("C:\\Boo"));</span></span></code> </pre><br><br>  In addition, Moq allows you to check the behavior of protected methods, test events and contains some other features. <br><br><h3>  <b>Additional links</b> </h3><br><br>  <a href="https://github.com/SergeyTeplyakov/Moq.Samples">Github examples</a> <br>  <a href="http://sergeyteplyakov.blogspot.com/2011/12/blog-post.html">Moki and stubs</a> <br>  <a href="http://sergeyteplyakov.blogspot.com/2010/12/microsoft-moles.html">Microsoft Moles</a> </div><p>Source: <a href="https://habr.com/ru/post/150859/">https://habr.com/ru/post/150859/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150851/index.html">Smooth.js - jQuery plugin for CSS3 transitions with downgrade to $ .animate</a></li>
<li><a href="../150854/index.html">Apple insures from Samsung and actively buys LTE-patents</a></li>
<li><a href="../150855/index.html">Comparative CMS analysis: the hunt for an optimal system for creating corporate sites</a></li>
<li><a href="../150856/index.html">Bruce Willis will not sue Apple</a></li>
<li><a href="../150857/index.html">Unusual JSF and Spring integration</a></li>
<li><a href="../150861/index.html">Apple sent invitations to the presentation on September 12</a></li>
<li><a href="../150862/index.html">Debugging Android Applications Without Java Source Code: A Few Words About Breakpoints</a></li>
<li><a href="../150863/index.html">Add Bundling and Minification to an ASP.NET Web Forms Application</a></li>
<li><a href="../150864/index.html">iPhone Style Checkbox for Twitter Bootstrap</a></li>
<li><a href="../150867/index.html">PyCharm updated to version 2.6 with class diagrams, Flask, Python 3.3 and improved CSS / Sass / LESS editor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>