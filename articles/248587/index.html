<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reports for NORD POS. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Take the jrxml template and install it in the application 
 In the first part, I talked about how to prepare a report template for the JasperReports l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Reports for NORD POS. Part 2</h1><div class="post__text post__text-html js-mediator-article"><h3>  Take the jrxml template and install it in the application </h3><br>  In the <a href="http://habrahabr.ru/post/247515/">first part,</a> I talked about how to prepare a report template for the JasperReports library in iReport.  And this article is about how to integrate the resulting template directly into the <a href="http://www.nordpos.mobi/">NORD POS</a> application.  And if in the first part the program was needed only as a data source for building an example report on the product directory, then in this article it will be necessary to integrate the report into the application interface, as well as to demonstrate the possibilities of interaction between the business logic of the application and JasperReports library template elements. <br><br><img src="https://habrastorage.org/files/442/dba/b26/442dbab2613640bf932e40190eb914ee.png"><br><br>  In addition, I had to divide the article into two parts due to the fact that during the preparation of the material I found an error in printing the report in version 3.0.1CE.  The error occurred due to an incorrect call to the printer selection dialog when using a non-standard design from the Swing Look &amp; Feel <a href="http://insubstantial.github.io/insubstantial/">Insubstantial</a> library.  The error did not occur when using the Metal theme or design in the style of the operating system.  But, since the non-standard CremeSkin theme is used by default in NORD POS, to write this part, it was necessary to eliminate this bug and release an updated version of <a href="http://nordpos.mobi/">NORD POS 3.0.2CE</a> .  And it is this version that we will use in the second part of the article. <br><a name="habracut"></a><br><h4>  Place the template </h4><br>  To install the report template, it is not necessary to download the entire application source, just save the file from iRepot in the <b>reports</b> folder of the installed application and <b>specify the</b> path <b>./reports/io/example/reports/</b> for it.  In addition, you need to create a BeanShell script to initialize the template in NORD POS, as well as the Properties resource for localizing the template text fields. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/ae4/02a/bc7/ae402abc75034785971420bf74a242bf.png"><br><br><h4>  We write a script </h4><br>  The script code must initialize our report template in the program and transfer the values ‚Äã‚Äãfrom the application database to the form fields.  And so in the first line of the script we initialize the <b>PanelReportBean ()</b> class, which is responsible for interacting with the JasperReports library: <br><pre><code class="java hljs">report = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> com.openbravo.pos.reports.PanelReportBean();</code> </pre> <br>  We set the main parameters for it: <br><pre> <code class="java hljs">report.setTitleKey(<span class="hljs-string"><span class="hljs-string">"Menu.ExtProducts"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    report.setReport("/io/example/reports/productsext"); //      report.setResourceBundle("io/example/reports/productsext_messages"); //    </span></span></code> </pre><br>  And a SQL query string to get the value from the database: <br><pre> <code class="java hljs">report.setSentence(<span class="hljs-string"><span class="hljs-string">"SELECT"</span></span>+ <span class="hljs-string"><span class="hljs-string">" PRODUCTS.NAME AS PRODUCT_NAME"</span></span> + <span class="hljs-string"><span class="hljs-string">", PRODUCTS.REFERENCE AS PRODUCT_REFERENCE"</span></span> + <span class="hljs-string"><span class="hljs-string">", PRODUCTS.PRICESELL AS PRODUCT_PRICESELL"</span></span> + <span class="hljs-string"><span class="hljs-string">", PRODUCTS.CATEGORY AS CATEGORY_ID"</span></span> + <span class="hljs-string"><span class="hljs-string">", CATEGORIES.NAME AS CATEGORY_NAME"</span></span> + <span class="hljs-string"><span class="hljs-string">", PRODUCTS.TAXCAT AS TAX_ID"</span></span> + <span class="hljs-string"><span class="hljs-string">" FROM PRODUCTS"</span></span> + <span class="hljs-string"><span class="hljs-string">" LEFT OUTER JOIN CATEGORIES ON PRODUCTS.CATEGORY = CATEGORIES.ID"</span></span> + <span class="hljs-string"><span class="hljs-string">" LEFT OUTER JOIN TAXCATEGORIES ON PRODUCTS.TAXCAT = TAXCATEGORIES.ID"</span></span> + <span class="hljs-string"><span class="hljs-string">" LEFT OUTER JOIN TAXES ON TAXCATEGORIES.ID = TAXES.CATEGORY"</span></span> + <span class="hljs-string"><span class="hljs-string">" WHERE ?(QBF_FILTER)"</span></span> + <span class="hljs-string"><span class="hljs-string">" ORDER BY CATEGORIES.NAME, PRODUCTS.NAME"</span></span>);</code> </pre><br>  Here you need to pay attention to the <b>WHERE</b> condition <b>? (QBF_FILTER)</b> , it allows you to insert a filter into the query from the application interface.  For example, for a product directory this is <b>ProductFilter ()</b> with the following parameter fields: <br><pre> <code class="java hljs">report.addParameter(<span class="hljs-string"><span class="hljs-string">"PRODUCTS.NAME"</span></span>); report.addParameter(<span class="hljs-string"><span class="hljs-string">"PRODUCTS.PRICEBUY"</span></span>); report.addParameter(<span class="hljs-string"><span class="hljs-string">"PRODUCTS.PRICESELL"</span></span>); report.addParameter(<span class="hljs-string"><span class="hljs-string">"PRODUCTS.CATEGORY"</span></span>); report.addParameter(<span class="hljs-string"><span class="hljs-string">"PRODUCTS.CODE"</span></span>); report.addQBFFilter(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> com.openbravo.pos.ticket.ProductFilter());</code> </pre><br>  With the help of the filter, the user NORD POS will be able to make a selection at the price of the product, its category, or use the SQL regular expression to select the product only with a specific name.  For example, the expression <b>A%</b> will give us a list of products starting only with the letter ‚ÄúA‚Äù from any category. <br><br>  At the end of our script, you must specify the fields that will be used in the jrxml template for building the report: <br><pre> <code class="java hljs">report.addField(<span class="hljs-string"><span class="hljs-string">"PRODUCT_NAME"</span></span>, com.openbravo.data.loader.Datas.STRING); report.addField(<span class="hljs-string"><span class="hljs-string">"PRODUCT_REFERENCE"</span></span>, com.openbravo.data.loader.Datas.STRING); report.addField(<span class="hljs-string"><span class="hljs-string">"PRODUCT_PRICESELL"</span></span>, com.openbravo.data.loader.Datas.DOUBLE); report.addField(<span class="hljs-string"><span class="hljs-string">"CATEGORY_ID"</span></span>, com.openbravo.data.loader.Datas.STRING); report.addField(<span class="hljs-string"><span class="hljs-string">"CATEGORY_NAME"</span></span>, com.openbravo.data.loader.Datas.STRING); report.addField(<span class="hljs-string"><span class="hljs-string">"TAX_ID"</span></span>, com.openbravo.data.loader.Datas.STRING); report;</code> </pre><br>  And call the BeanShell script using the report we created. <br><br><div class="spoiler">  <b class="spoiler_title">Full script text</b> <div class="spoiler_text">  report = new com.openbravo.pos.reports.PanelReportBean (); <br><br>  report.setTitleKey ("Menu.ProductList");  // Set the panel name <br>  report.setReport ("/ io / example / reports / productsext");  // Point to the file forming the report <br>  report.setResourceBundle ("io / example / reports / productsext_messages");  // and localization file <br><br>  report.setSentence ("SELECT" + <br>  "PRODUCTS.NAME AS PRODUCT_NAME" + <br>  ", PRODUCTS.REFERENCE AS PRODUCT_REFERENCE" + <br>  ", PRODUCTS.PRICESELL AS PRODUCT_PRICESELL" + <br>  ", PRODUCTS.CATEGORY AS CATEGORY_ID" + <br>  ", CATEGORIES.NAME AS CATEGORY_NAME" + <br>  ", PRODUCTS.TAXCAT AS TAX_ID" + <br>  "FROM PRODUCTS" + <br>  "LEFT OUTER JOIN CATEGORIES ON PRODUCTS.CATEGORY = CATEGORIES.ID" + <br>  "LEFT OUTER JOIN TAXCATEGORIES ON PRODUCTS.TAXCAT = TAXCATEGORIES.ID" + <br>  "LEFT OUTER JOIN TAXES ON TAXCATEGORIES.ID = TAXES.CATEGORY" + <br>  "WHERE? (QBF_FILTER)" + <br>  "ORDER BY CATEGORIES.NAME, PRODUCTS.NAME"); <br>  report.addParameter ("PRODUCTS.NAME"); <br>  report.addParameter ("PRODUCTS.PRICEBUY"); <br>  report.addParameter ("PRODUCTS.PRICESELL"); <br>  report.addParameter ("PRODUCTS.CATEGORY"); <br>  report.addParameter ("PRODUCTS.CODE"); <br>  report.addQBFFilter (new com.openbravo.pos.ticket.ProductFilter ()); <br><br>  report.addField (‚ÄúPRODUCT_NAME‚Äù, com.openbravo.data.loader.Datas.STRING); <br>  report.addField (‚ÄúPRODUCT_REFERENCE‚Äù, com.openbravo.data.loader.Datas.STRING); <br>  report.addField (‚ÄúPRODUCT_PRICESELL‚Äù, com.openbravo.data.loader.Datas.DOUBLE); <br>  report.addField ("CATEGORY_ID", com.openbravo.data.loader.Datas.STRING); <br>  report.addField ("CATEGORY_NAME", com.openbravo.data.loader.Datas.STRING); <br>  report.addField ("TAX_ID", com.openbravo.data.loader.Datas.STRING); <br><br>  report; <br></div></div><br><br><h4>  Localize the fields </h4><br>  To do this, we need to return to iReport and replace the signature fields with text ones, in order to specify a variable of the form <b>$ R {label.key}</b> for localization in the expression.  For example, for the report header, set the value of <b>$ R {label.title}</b> in the jrxml template text box. <br><br>  Then we add the value for this key to the <b>productsext_messages.properies</b> file. <br><br><pre> <code class="java hljs">label.title=List of Products label.line.number=N label.product.reference=Reference label.product.name=Name label.product.price=Price label.product.vat=VAT label.product.TaxPrice=Price+Tax label.report.summary=Summary</code> </pre><br><br>  As a basic language, it is better to use English, then adding a translation to another language.  For example, for the Russian language it will be the <b>productsext_messages_ru.properies</b> file. <br><br><pre> <code class="java hljs">label.title=  label.line.number=‚Ññ label.product.reference= label.product.name= label.product.price= label.product.vat= label.product.TaxPrice=+ label.report.summary= </code> </pre><br><br><h4>  Recalculate taxes </h4><br>  In the first part, we took the tax rate directly from the database, but when generating a report from the application, it is better to calculate the tax rate and the tax amount using the <b>TaxesLogic</b> class <b>getTaxRate</b> specifically for this purpose.  To do this, create the parameter <b>TAXESLOGIC</b> in the template. <br><br><img src="https://habrastorage.org/files/2ee/ff5/4ba/2eeff54ba0b74c7683bff5cc7365424c.png"><br><div class="spoiler">  <b class="spoiler_title">Parameter tag in XML template</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">parameter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TAXESLOGIC"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.openbravo.pos.sales.TaxesLogic"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">isForPrompting</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br></div></div><br><br>  Which is called when calculating the price and receives a tax rate directly on the date of the report, which allows you to use the possibilities of NORD POS to calculate the VAT in case of a change in its rate after a certain date. <br><br><img src="https://habrastorage.org/files/fe0/eb1/3c6/fe0eb13c68764922b5769774e09f0b1d.png"><br><div class="spoiler">  <b class="spoiler_title">Price field with tax on report date</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textField</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pattern</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">isBlankWhenNull</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reportElement</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uuid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1158eb51-5046-4b15-88f2-2456bac9eea1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"425"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"84"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"32"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textElement</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">textAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Right"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">verticalAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Top"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textFieldExpression</span></span></span><span class="hljs-tag">&gt;</span></span>&lt;![CDATA[com.openbravo.format.Formats.CURRENCY.formatValue( new Double( $F{PRODUCT_PRICESELL}.doubleValue() * (1.0 + $P{TAXESLOGIC}.getTaxRate($F{TAX_ID}, new Date())) ) ) ]]&gt;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textFieldExpression</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textField</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><br>  Also in this example, instead of the pattern of the template for monetary values, the application pattern is used to ensure the uniformity of the output of all values. <br><br><h4>  Add a logo and QR code </h4><br>  Also, by calling the external class methods, you can add various resources of the parent application to the report.  For example, a logo image is stored in the NORD POS database.  You cannot insert it into the report using a SQL query, but you can use the <b>getResourceAsImage</b> method of the <b>DataLogicSystem</b> class by calling it with a query from the expression of the image field. <br><pre> <code class="java hljs">com.openbravo.pos.forms.DataLogicSystem.getResourceAsImage(<span class="hljs-string"><span class="hljs-string">"Window.SupportBy"</span></span>)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Logo image field</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scaleImage</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Clip"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reportElement</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uuid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5b7371fd-db3f-488e-80b2-1f2bc912703b"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image-1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Transparent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"381"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"132"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"34"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">box</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">topPen</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Solid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#000000"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">leftPen</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Solid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#000000"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bottomPen</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#000000"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rightPen</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Solid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#000000"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">box</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">imageExpression</span></span></span><span class="hljs-tag">&gt;</span></span>&lt;![CDATA[com.openbravo.pos.forms.DataLogicSystem.getResourceAsImage("Window.SupportBy")]]&gt;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">imageExpression</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><br>  Or, for example, in JasperReports there is no QR code among the supported bar codes, and <a href="https://github.com/zxing/zxing">ZXing</a> library is integrated into NORD POS, with it you can generate a QR code for a report, for example, with a link to the site. <br><pre> <code class="java hljs">com.nordpos.device.util.BarcodeImage.getQRCode(<span class="hljs-string"><span class="hljs-string">"http://nordpos.mobi"</span></span>)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Field of QR code links to the site</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scaleImage</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"RetainShape"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">hAlign</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Center"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">vAlign</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Middle"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reportElement</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uuid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"425a36a5-4937-4551-8b26-8ffe7245f9f0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"barcode-1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"449"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"13"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"64"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"64"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">box</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">topPen</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Solid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#000000"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">leftPen</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Solid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#000000"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bottomPen</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#000000"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rightPen</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Solid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#000000"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">box</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">graphicElement</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fill</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Solid"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pen</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lineStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Solid"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">graphicElement</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">imageExpression</span></span></span><span class="hljs-tag">&gt;</span></span>&lt;![CDATA[com.nordpos.device.util.BarcodeImage.getQRCode("http://nordpos.mobi")]]&gt;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">imageExpression</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><br><h4>  Configuring access </h4><br>  Now the last step remains, it is to open access to the report from NORD POS.  From the beginning, we will add our report button to the application interface.  Open in <b>Settings -&gt; Resources</b> , find the <b>Menu.Root</b> BeanShell script and add a report panel to the <b>MenuSalesManagement</b> section. <br><pre> <code class="java hljs"> submenu.addPanel(<span class="hljs-string"><span class="hljs-string">"/com/openbravo/images/appointment.png"</span></span>, <span class="hljs-string"><span class="hljs-string">"Menu.ProductList"</span></span>, <span class="hljs-string"><span class="hljs-string">"/io/example/reports/productsext.bsh"</span></span>);</code> </pre><br><br>  The second step is to allow access to the report in the profile for a group of users.  Go to <b>Settings -&gt; Profiles</b> , select a role from the list and add permission to access our report in the XML-document. <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">class</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/io/example/reports/productsext.bsh"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br><br>  Everything, we reboot NORD POS, open the report panel and configure it.  This completes the task of creating a report for NORD POS. <br><br><img src="https://habrastorage.org/files/eb3/01b/c5d/eb301bc5db2c432ba0e89256fa053640.png"><br><br>  In addition to creating reports using the JasperReports tools in NORD POS, you can create labels, fill in tables, build graphs and diagrams, but I tried to explain the foundations for this to Habr's readers in this article.  And in the future, if it is interesting, then I want to continue the story about other features of NORD POS, which appeared through the use of third-party libraries.  But first I would like to make a small survey among those readers who have read both parts to the end. </div><p>Source: <a href="https://habr.com/ru/post/248587/">https://habr.com/ru/post/248587/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248575/index.html">One ring to rule them all or TeddyID authentication</a></li>
<li><a href="../248579/index.html">RAD Studio XE7 World Tour in Rostov-on-Don, Almaty and Orenburg</a></li>
<li><a href="../248581/index.html">(Kiev) On January 28-30, the course ‚ÄúIntroduction to OpenStack. Basics</a></li>
<li><a href="../248583/index.html">(Kiev) February 16-17, the course "Infrastructure Management through HP OneView"</a></li>
<li><a href="../248585/index.html">Simple container</a></li>
<li><a href="../248589/index.html">The first step on the path to daily planning, or where does the meat grinder?</a></li>
<li><a href="../248591/index.html">Using the DSP coprocessor DM8168 using the C6Accel framework</a></li>
<li><a href="../248593/index.html">Opensource lifeguard for cats, dogs and other animals in PHP</a></li>
<li><a href="../248597/index.html">Parsing the Microsoft Office localization file format</a></li>
<li><a href="../248599/index.html">"Durov, return the wall" or "Habrahabr + Geektimes + Megamind" in one tape</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>