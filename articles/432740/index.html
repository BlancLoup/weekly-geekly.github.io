<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"CMS" based on Google Spreadsheets for static sites</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Increasingly, for a story about an event / product / service, companies are creating websites based on any constructors. Either on their own, or attra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"CMS" based on Google Spreadsheets for static sites</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/dk/en/ra/dkenra38lid9d25duailavzj3-8.jpeg"><br><br>  Increasingly, for a story about an event / product / service, companies are creating websites based on any constructors.  Either on their own, or attracting designers and without the participation of the programmer.  Modern designers allow you to build a cool, bright, effective site, but static.  Any changes you need to make "pens in the editor" and republish the page.  But what to do if the data changes very often or you want to add a little automation - this is where Google Tables and Charts Query Language can help (and the programmer is familiar). <br><a name="habracut"></a><br>  A few years ago, I was approached by a friend who needed to add a price list on the site gathered at Tilda.  And everything would be fine, there is a ‚Äútable‚Äù block - fill in the data and publish, but there were two conditions: <br><br><ul><li>  prices depended on the dollar and changed almost every day </li><li>  needed a general price and its parts on the pages of product groups </li></ul><br>  Accordingly, a lot of routine and high probability of discrepancies.  It was necessary to automate. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And help came from Google Speadsheets.  I think it makes no sense to describe the advantages: the usual editor, collaboration, formulas.  All you need is to change the exchange rate once a day.  There was only a question how to get data from the table on the site.  And then <a href="https://developers.google.com/chart/interactive/docs/querylanguage">the Google Charts API</a> came in handy. <br>  It allows using ajax request to get data in the form of jsonp. <br><br>  The request must be sent to <a href="https://docs.google.com/a/google.com/spreadsheets/d/xxxxxx/gviz/tq%3Ftq%3Dyyyyyy">docs.google.com/a/google.com/spreadsheets/d/xxxxxx/gviz/tq?tq=yyyyyyy</a> <br>  Where: <br>  xxxxxx - identifier from a public link to google table <br>  yyyyyy - SQL query to retrieve data from the converted table (remember to convert all characters to HTML entities of the type: select% 20A% 2C% 20sum (B)% 20group% 20by% 20A). <br><br>  One more note, SQL is quite familiar except trimmed (see the <a href="https://developers.google.com/chart/interactive/docs/querylanguage">documentation</a> ), but the FROM block is completely cut out of it.  So you need to write something like ‚Äúselect A, B where C = 'f' and B &lt;30 order by B‚Äù <br><br>  The script received in response will call the google.visualization.Query.setResponse (data) method. <br>  The data object contains the following useful data: <br><br><pre><code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">status</span></span>: <span class="hljs-string"><span class="hljs-string">"ok"</span></span>, <span class="hljs-comment"><span class="hljs-comment">//    table: { cols: [ //      0: { id: "A", label: "  ", type: "string" }, 1: { id: "B", label: "  B", type: "number" }, ... ], rows: [ //    0: { c: [ //      0: { v: "" //      } 1: { v: 3.1415, //      ""  f: "3,1415" //     } ] } ] } }</span></span></code> </pre> <br>  Well, then do what you want with the data: at least insert it into the table, at least generate svg (used to generate a map on the scheme of a country village noting free and sold), at least replace the placeholders in the text - the flight of fantasy is limitless. <br><br>  Naturally, this method is not suitable for highly loaded systems, Google has a limit on the number of requests per day, but so far none of the automated sites have been able to figure it out. <br><br>  And a little tip lastly.  The table to which the requests are made should be shared by reference.  And if you suddenly need fields hidden from common eyes, then for this there is a convenient feature in Google Tables.  It is called <a href="https://support.google.com/docs/answer/3093340%3Fhl%3Dru">IMPORTRANGE (key., Range)</a> .  The key is a link to any table to which you have access, and the range is a group of cells that need to be shown.  Those.  you make a closed table with a complete set of data and a public table into which you import only the necessary data ranges (you are still going to show them on the site). </div><p>Source: <a href="https://habr.com/ru/post/432740/">https://habr.com/ru/post/432740/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../432728/index.html">Vulnerability in the API API reveals 52.5 million private data.</a></li>
<li><a href="../432730/index.html">MQTT, smart home, ESP-8266 and Plug & Play</a></li>
<li><a href="../432732/index.html">My experience in implementing 1C (part 1. Introduction)</a></li>
<li><a href="../432734/index.html">Twisted in the clouds: prospects for development and the reverse side of cloud-services</a></li>
<li><a href="../432736/index.html">Devops, JUnit5 and microservice testing: a subjective view of Moscow ‚ÄúHeisenbag‚Äù</a></li>
<li><a href="../432742/index.html">Corporate time trouble</a></li>
<li><a href="../432744/index.html">DWDM: the solution is cheaper than the carrier by 30-50% (Enterprise class)</a></li>
<li><a href="../432746/index.html">For three days in reanimation or what is wrong with the Work-Life Balance section on Mobius'18?</a></li>
<li><a href="../432748/index.html">Kubernetes tips & tricks: on node allocation and web application loads</a></li>
<li><a href="../432750/index.html">Joy Haxe. Novel with a deprived programming language</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>