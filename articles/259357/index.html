<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Weather station not on Arduino, or Working with timers and GPIO interrupts in OpenWRT</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr, long time no see! 

 First, a few important news about the Black Swift microcomputer project, and then we move on to the main topic: how to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Weather station not on Arduino, or Working with timers and GPIO interrupts in OpenWRT</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr, long time no see! <br><br>  First, a few important news about the <a href="http://www.black-swift.com/">Black Swift</a> microcomputer project, and then we move on to the main topic: how to make a microcomputer with OpenWRT a fully-fledged embedded device. <br><br>  A full-fledged embedded computer, in my opinion, is impossible without two things: <br><ul><li>  Support for interrupts on various occasions, including signals on GPIO inputs </li><li>  Support for hardware resolutions with good resolution </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Without this, a significant part of the real automation tasks either does not solve at all, or is solved in such a way that it would not be better solved at all.  The only exceptions are the most banal ones - to pull the relay, to flash with a LED, to track a couple of buttons.  Anything that requires precise timings and / or a more or less quick response to external events is simply not feasible without carrying out the corresponding functionality to an external controller that can do the above things, which unnecessarily complicates the design of the device. <br><br>  All the more surprising that with a sufficient number of microcomputers on the SoC Atheros AR9331 and cheaper Ralink RT5350, positioned specifically as embedded solutions, with the support of these two functions in OpenWRT, everything is very sad.  Here, of course, the question arises of who needs these microcomputers at this level of support, but we will leave it hanging in the air. <br><br><img src="https://habrastorage.org/files/012/314/d8c/012314d8c6ea4abf9d7623291d8405f8.jpg"><br><br>  However, if you <a href="http://files.black-swift.com:9000/">look at it over TCP / IP</a> , you can get it for a healthy person. <br><br>  But first - the news: <br><br><ul><li>  The first batch of Black Swift is in Russia and is already being sent for ruble pre-orders (that is, not made on Kickstarter).  If you specified a pre-order delivery - wait, if self-pickup - call the office and drive up. </li><li>  If you did not pre-order, but you want to buy Black Swift - call the office and drive up, we have quite a lot of boards above the volume of pre-orders.  You can arrange delivery, but then for obvious reasons you will end up in the tail of the pre-order queue. </li><li>  FCC certification will end soon, apparently - successfully. </li><li>  Satisfaction of backers with Kickstarter, as promised, is expected in June.  We cannot send out the Russian-speaking or any other individual backers of the board separately for technical features of Kickstarter. </li><li>  The documentation is slowly being updated, due to lack of time, <a href="http://www.black-swift.com/wiki/index.php%3Ftitle%3DMain_Page">first of all, English-language</a> . </li><li>  In particular, the images of virtual machines with the OpenWRT SDK and Eclipse - <a href="http://www.black-swift.com/wiki/index.php%3Ftitle%3DC/C%252B%252B_Building_and_Remote_Debugging_with_Eclipse">here</a> (in a couple of days I will update them with the latest version of the SDK with our patches).  Useful for anyone who wants to write something under OpenWRT, but does not really understand how. </li></ul><br><br>  And now - to the topic. <br><br><a name="habracut"></a><h2>  Theory </h2><br>  In Atheros AR9331 there are two things that are very important for an embedded computer - these are hardware timers (four pieces ticking at the system bus frequency, generating an interrupt upon reaching zero) and interrupts on the GPIO legs (they can trigger on both signal edges). <br><br>  Unfortunately, at the program level in OpenWRT there is no support for either one or the other - that is, if you want to read some intervals or emulate some protocols, then udelay () is in your hands and hope that in multitasking environment, no one will fit into the middle of your protocol emulation - on the neck.  To support GPIO IRQ, there is a widely known <a href="">patch</a> in a narrow environment that solves only a part of the problem: you just need to get an interrupt, you have to process it and bring it to the user space where your own program lives.  And, of course, in order to impose a patch, you will need to assemble the entire firmware yourself - the exercise is slow and not hemorrhoid. <br><br>  There is nothing to support timers. <br><br>  More precisely, until recently, it was not. <br><br>  A kernel module that catches GPIO interrupts and sends them to the user space - here: <a href="https://github.com/blackswift/gpio-irq-handler">github.com/blackswift/gpio-irq-handler</a> <br><br>  It works simply: you need to write the line ‚Äú+ GPIO PID‚Äù to the / sys / kernel / debug / gpio-irq pseudo file, where GPIO is the number of the required foot, PID is your process to which you need to send a signal.  Then pick up the signal handler number 42 and wait for it.  Remove interrupt - ‚Äú- GPIO PID‚Äù in the same file. <br><br>  Kernel module that supports hardware timers - here: <a href="https://github.com/blackswift/timer-irq-handler">github.com/blackswift/timer-irq-handler</a> <br><br>  It doesn‚Äôt work any harder: first in / sys / kernel / debug / timer-irq we write ‚Äú+ TIMER TICK‚Äù, where TIMER is the timer number (from 0 to 3, no system is busy, so it remains to follow between your applications to did not try to catch together in one timer), TICK - its resolution in microseconds (each tick will generate an interrupt, so do not set less than 20 ¬µs).  Then there is ‚Äú+ TIMER TIMEOUT PID‚Äù, where TIMEOUT is the period through which you want to receive the signal, and PID is your process.  The signal number is 43. If you want the timer to work only once, add the word ‚Äúonce‚Äù at the end.  If you do not want - it will work until you say ‚Äú- TIMER‚Äù in the above file. <br><br>  The core modules will obviously only work on the AR9331, since other chips have a different register addressing.  Moreover, for the GPIO IRQ to work, you need a firmware with the above patch, and at the moment ‚Äúout of the box‚Äù you get such firmware only on Black Swift. <br><br><h2>  Practice </h2><br><br>  The knowledge gained must be used, that is, to collect something useful with timers and interrupts.  I will have a weather station (see KDPV).  Why?  Firstly, a thing that everyone understands, and secondly, a common DHT22 sensor is also a pain in the ass.  It has a similar to 1-Wire protocol, only if there is synchronization in 1-Wire, then the host once pulls the data leg to the ‚Äúground‚Äù, and then the sensor itself ottabanan output 41 at the output in response.  ‚Äú0‚Äù and ‚Äú1‚Äù differ in pulse durations - 28 ¬µs versus 70 ¬µs. <br><br>  A rather unpleasant thing to decode: you have to calculate the length of the incoming short pulses.  Without interruptions is solved, but the stability of the work, frankly, you do not like it.  If you want, I will give you a software implementation of the protocol, I have it.  Will try. <br><br>  With interruptions, the matter is simplified radically: without much difficulty, you can write a kernel module that catches an interrupt on the right leg, counts 35 Œºs from it with the commonplace udelay () and measures the level on the same leg.  If there is ‚Äú1‚Äù, then the signal is longer than 35 ¬µs, that is, in fact, ‚Äú1‚Äù.  Actually, everything.  If you write your kernel module a little harder than us, then here‚Äôs the source: <a href="https://github.com/blackswift/gpio-dht-handler">github.com/blackswift/gpio-dht-handler</a> <br><br>  Having captured the data from the sensor, the module outputs it either to the kernel output (see the logread command), or by signal 44 to the application at the specified PID.  In case of a CRC error, ‚ÄúError‚Äù will arrive in the console, and in the application - 0. <br><br><img src="https://habrastorage.org/files/0b3/bb8/71d/0b3bb871dd484726b42c479c393bcf17.png"><br><br>  Now it remains to write the application itself around this - we will not go to the kernel log to see whether to put on the cap. <br><br>  Here everything turns out to be just as trivial: we start a hardware timer that will tick once a minute (the maximum possible tick period is UINT_MAX microseconds, that is, a little more than 71 minutes).  A signal comes from it, the handler of which sends a request to the DHT22 protocol module ‚Äî it simply writes to a pseudo file.  After another ten milliseconds, the response signal from the DHT22 arrives, the handler of which, in fact, processes it - in our case it writes to the file. <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">irq_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">siginfo_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *info, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *unused)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//every minute counter++; dht_request_data(); } void dht_request_data() { int fd=open("/sys/kernel/debug/irq-dht", O_WRONLY); sprintf(buf, "%d %u", DHT_GPIO, getpid()); // gpio-dht-handler kernel module write(fd, buf, strlen(buf) + 1); close(fd); } void dht_handler(int n, siginfo_t *info, void *unused) { if (info-&gt;si_int == 0) // DHT protocol CRC error { if (++failcounter &gt; 10) { printf("Error retrieving data from DHT sensor\n"); failcounter = 0; return; } usleep(3000000); // wait 3 seconds between attempts dht_request_data(); return; } float humidity = (float)((info-&gt;si_int) &gt;&gt; 16)/10.0; // 2xMSB float temperature = (float)((info-&gt;si_int) &amp; 0xFFFF)/10.0; //2xLSB // ... } int main(int argc, char* argv[]) { int timer = TIMER_TIMER; int tick = 1000*1000; // 1 sec unsigned int timeout = 1000*1000*60; // 60 sec if (!init_handler(timer, tick, timeout)) { printf("Error initializing timer %d\n", timer); return -1; } struct sigaction sig; sig.sa_sigaction = dht_handler; sig.sa_flags = SA_SIGINFO | SA_NODEFER; sigaction(SIG_DHT_IRQ, &amp;sig, NULL); // ... }</span></span></code> </pre> <br><br><img src="https://habrastorage.org/files/d82/96a/6f7/d8296a6f71ff4bca92be6baa604c8bb7.png"><br><br>  We have just received a meteorological station with a minimum labor cost, in the literal sense of the word, for half an hour on the knee, which keeps a log of temperature and humidity in a text file.  With the same ease, the text file can be changed, for example, to the sqlite3 database. <br><br>  A text file is better than the logread command, but for the time being it‚Äôs not quite what you want at home for a more or less healthy person.  It would be necessary to display the data beautifully, with graphs.  Drawing graphs in C with output to a PNG file is quite a non-trivial task, probably, you not only do not want to solve it with your bare hands, but also look for libraries that can do it.  Fortunately, since we run quite a full-fledged Linux on the microcomputer, we don‚Äôt need to do anything of this: install the gnuplot package and then simply feed our data to it, accompanying them with a simple script indicating which axis and which scaler to install. <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> terminal png medium size 600,300 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> format x <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> key below <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> xrange [60:0] <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> yrange [0:100] <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> grid ytics lc rgb <span class="hljs-string"><span class="hljs-string">"#bbbbbb"</span></span> lw 1 lt 0 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> grid xtics lc rgb <span class="hljs-string"><span class="hljs-string">"#bbbbbb"</span></span> lw 1 lt 0 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> output <span class="hljs-string"><span class="hljs-string">"/www/light/img/last_60m.png"</span></span> plot <span class="hljs-string"><span class="hljs-string">"-"</span></span> using 0:1 title <span class="hljs-string"><span class="hljs-string">"Temperature"</span></span> with lines, <span class="hljs-string"><span class="hljs-string">"-"</span></span> using 0:1 title <span class="hljs-string"><span class="hljs-string">"Humidity"</span></span> with lines</code> </pre><br><br><img src="https://habrastorage.org/files/085/bbd/4b3/085bbd4b386d4f5196cd805ec153d331.png"><br><br>  Again, how are we going to find out this temperature?  Yes, elementary: set up a web server (for example, opkg install lighttpd - put a web server, respectively, lighttpd, notable for the fact that it can also PHP, if necessary) and make an HTML page that sucks our pictures, and at the same time the current data in numbers.  If you don‚Äôt have to withstand the habroeffect, you can do everything with PHP, if you need to - the current data can be changed in a static HTML file known to any Linux user (and able to terrify the others) by sed, pulling it out of our software as it comes new data. <br><br><pre> <code class="bash hljs">SR_TIME=<span class="hljs-string"><span class="hljs-string">"class=\"time\"&gt;.*&lt;/span"</span></span> RP_TIME=<span class="hljs-string"><span class="hljs-string">"class=\"time\"&gt; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$3</span></span></span><span class="hljs-string"> &lt;/span"</span></span> SR_TEMP=<span class="hljs-string"><span class="hljs-string">"class=\"temp\"&gt;.*&lt;/span"</span></span> RP_TEMP=<span class="hljs-string"><span class="hljs-string">"class=\"temp\"&gt; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$1</span></span></span><span class="hljs-string">\¬∞C </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$2</span></span></span><span class="hljs-string">% &lt;/span"</span></span> cat /www/light/index.html | sed -es,<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$SR_TIME</span></span></span><span class="hljs-string">"</span></span>,<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$RP_TIME</span></span></span><span class="hljs-string">"</span></span>, | sed -es,<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$SR_TEMP</span></span></span><span class="hljs-string">"</span></span>,<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$RP_TEMP</span></span></span><span class="hljs-string">"</span></span>,</code> </pre><br><br><img src="https://habrastorage.org/files/507/e1e/9bd/507e1e9bd5b3422fa73d360e75092b96.png"><br><br>  What is left?  Well, perhaps it is sometimes useful to see with your eyes what is going on there at all.  We take a webcam, stick it through the USB-OTG adapter into Black Swift and use the fswebcam utility to display a picture from it once a minute.  We go through the browser on the link and look. <br><br>  Link?  Here is the link: <a href="http://files.black-swift.com:9000/">http://files.black-swift.com:9000/</a> <br><br>  The port is forwarded directly to Black Swift, so everything that you see on the link revolves solely on it. <br><br>  Also, they say, lately it is fashionable to display information about how many degrees you have on your balcony, <a href="http://narodmon.ru/%3Flat%3D55.708%26lng%3D37.781%26zoom%3D18%26map%3Dmap">to the narodmon.ru service</a> .  Honestly, I never used it, but it turned out that it is not very difficult - copy the PHP example from the documentation, write it to the file / root/narodmon.php on Black Swift and then every 15 minutes we pull it from our software / usr / bin / php-cgi /root/narodmon.php, good PHP we also have and ready to use.  Well, the parameters do not forget to pass, of course. <br><br>  Here the reader may wonder - why do you need such a variety of languages ‚Äã‚Äãand utilities?  Isn't it better to write everything <del>  assembler month </del>  week on pure C, and then admire the beauty?  No, not better.  The beauty of full-fledged Linux on an embedded computer - in particular, is that you can get results in a matter of hours, using already known utilities and languages, and not arrange a full-fledged R &amp; D project for a week without sleep and rest. <br><br>  Basic knowledge of C, familiarity with popular Unix utilities - and that's it.  Do you want PHP - here you are.  Want to the database - get it, sign it.  Do you want on an assembler - also possible, but very expensive. <br><br><h2>  Why nothing </h2><br><br>  <i>Theory is when you know everything but nothing works.</i>  <i>Practice is everything works but no one.</i>  <i>In our laboratory, theory and practice are combined.</i> <br><br>  However, in order not to praise themselves, I will note - so far everything is not working as we would like. <br><br>  If you walk through our githaba, you can easily find there <a href="https://github.com/blackswift/gpio-irq-dht">an alternative module for working with DHT22</a> , which is beautifully made inside - it literally measures the duration of incoming pulses.  In microseconds.  And quite accurately - I did not check it on a calibrated generator, but the one coming with the DHT22 differs from the one specified in it by no more than 3-4 microseconds. <br><br>  With one exception. <br><br>  In the depths of OpenWRT, there is a rather evil USB interrupt handler that masks all other interrupts for the duration of its work - and it works for a long time, it can easily go into microseconds for 30-40 seconds.  As a result, in our case we can simply skip some GPIO interrupts, at best - with a long delay.  Alas, we haven‚Äôt completely figured out the wilderness of the assembler and copyrights of 1999, so the module working with two interrupts per pulse has to be put aside - catch the first interrupt and then measure 35 ¬µs from it in such conditions much more reliably. <br><br>  Here he ate two interruptions and pushed the third: <br><br><img src="https://habrastorage.org/files/652/67d/bf7/65267dbf7c904e62bebc1f0aaf37637d.png"><br><br>  In addition, when USB is active (for example, it is streamed from a webcam), such delays occur so often that a module that suffices a single interruption is threatened.  However, in a little less critical things, where delays of a couple of tens of microseconds are insignificant, you will not notice this - but still unpleasant. <br><br>  If you have something to say about this, we will listen with interest. <br><br><h2>  In the following series </h2><br><br>  Did you know that in OpenWRT there is no working way to completely disable console output in UART? <br><br>  Yes, this is another fun trap: no matter what parameters and what files you would write, when loading the board into the UART a lot of garbage falls;  The parameters available to the user determine only the size of this mountain - and it is always non-zero. <br><br>  On Black Swift, to completely disable all consoles from the UART, just give the command ‚Äúfw_setenv silent 1‚Äù and reboot.  But this is another story. <br><br>  PS Tomorrow not only DA will come to Skolkovo Startup Village.  Medvedev, but also me - in particular, <a href="https://startupvillage.ru/symfony/web/ru/timetable/event/140%3Fday%3D2">at this event</a> .  If you want to talk about crowdfunding and / or (outside the event) Black Swift - come up. </div><p>Source: <a href="https://habr.com/ru/post/259357/">https://habr.com/ru/post/259357/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259347/index.html">Adaptive multi-level menu of the site with self-registered items based on the AngularJS directive</a></li>
<li><a href="../259349/index.html">How I stopped worrying and loved React</a></li>
<li><a href="../259351/index.html">What would you choose? Exercise on the choice of applications from the App Store</a></li>
<li><a href="../259353/index.html">Webix 2.4. Door to summer</a></li>
<li><a href="../259355/index.html">Automatic generation of meaningful unique texts</a></li>
<li><a href="../259359/index.html">How to help manual tester. Automators rush to the rescue</a></li>
<li><a href="../259361/index.html">Full guide to robotic designers from Robotic Station</a></li>
<li><a href="../259363/index.html">VKontakte does not pay users for found vulnerabilities</a></li>
<li><a href="../259365/index.html">TrueCrypt container as storage for XenServer virtual machines</a></li>
<li><a href="../259367/index.html">Create an app for Gear VR using Unity3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>