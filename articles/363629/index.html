<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Little secrets of big savings</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Why 16 bytes is enough to save the game, and other little things 
 Fifty and a hundred years later, programmers will have all the same problems: they ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Little secrets of big savings</h1><div class="post__text post__text-html js-mediator-article"><h3>  Why 16 bytes is enough to save the game, and other little things </h3><br>  Fifty and a hundred years later, programmers will have all the same problems: they will very much miss the amount of available memory to implement everything they want. <br><br>  25 years ago, game cartridges contained 64‚Äì128 kilobytes of memory, but somehow this volume was enough to fit the game for tens of hours of gameplay.  Today, 128 kilobytes is the size of small JPEGs, and what's available in a modern consumer computer in the era of Super Mario Bros.  do not even have to dream. <br><br>  There were music, and sounds, and quite good graphics for those times.  Yes, some could be done using what was already in the game console or computer, but basically I had to go for various tricks to fit a huge amount of sounds, music, animation, images and game algorithms into these modest possibilities.  How did the developers of those years manage to do it? <br><a name="habracut"></a><br>  The main secret: the games were written in assembler, that is, you had to almost directly tell the processor which operations to perform.  This is the cause and the consequence: it would be difficult to work on large projects written at such a low level. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Another small detail: a lot of software needs to be written so that another programmer after you can edit and correct it.  Game developers for the Atari 2600, Sega Master System, NES and SNES, and even later consoles of the late 90s such as the PlayStation 1 or Nintendo 64, had nothing to worry about: why would anyone outside the team know how the product works?  After the release, nothing can be fixed, the patch on the cartridge can not be rolled.  On the contrary, it was preferable to avoid all hackers who released cheat systems, for example, <a href="https://ru.wikipedia.org/wiki/Game_Genie">Game Genie</a> .  The games had almost complete control over the console without any operating systems, so there was no need for a multi-layered architecture that is crammed into all modern products to improve independence from software and hardware. <br><br> <a href="http://https:"><img src="https://habrastorage.org/files/a6c/4cf/880/a6c4cf880533411bbeb5780b15c233bc" align="right" width="400"></a>  Basic techniques include maximum code reuse, the same functionality has been used over and over.  The same thing happened with the data: AI, graphics, music, sounds, they were only slightly changed to create the illusion of diversity.  Games could generate code and data needed for execution, but this complicated debugging.  Avoid the use of meaningless large arrays.  Often their own libraries were written. <br><br>  A bitmap of 16 colors does not take up much space, a block of 20 √ó 20 pixels will require only ¬Ω √ó 20 √ó 20 = 200 bytes.  For one processor cycle, you can process 2 pixels. <br><br>  The graphics had a low resolution and was two-dimensional.  But it was possible to successfully deceive feelings with the help of pseudo-3D or 2.5D.  The most famous 2.5D auto simulator is the 1984 <a href="https://ru.wikipedia.org/wiki/Rad_Racer">Rad Racer</a> .  The Lotus Esprit Challenge (right) of 1992 looks plausible enough. <br><br> <a href="http://https:"><img src="https://habrastorage.org/files/b06/b25/19f/b06b2519ffc94d64a75e096c98a8c2bc" align="left" width="400"></a>  The 2.5D elements are Doom and Wolfenstein 3D first-person shooters.  On the left is a fragment of <a href="https://en.wikipedia.org/wiki/The_Train:_Escape_to_Normandy">The Train: Escape to Normandy</a> (1987) for <a href="https://ru.wikipedia.org/wiki/Commodore_64">Commodore 64</a> . <br><br>  Music was generated on the fly, no one kept it in a recorded form - it simply would not have enough space.  Sometimes there were exceptions, but they only illustrate the inexpediency for that era to store the sounds of the game in the form of audio recordings.  Sonic the Hedgehog, the very first game in the series about a running blue hedgehog from 1991, occupied <a href="https://www.youtube.com/watch%3Fv%3DYw-FCACT6hk">this sound with a duration of one to two seconds, the</a> eighth part of the 512 kilobyte cartridge.  It was needed to ensure that the name of the publisher was played at launch. <br><br>  An example of this kind of music generation could be the MIDI format, although the games of that time worked at a much lower level.  Instead of notes, the order of patterns was used, which needed much less memory.  Here is an example of what can be achieved with a single-bit sound. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/zfegDlcUwJU%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhwC1nUuVYnfIGq8_RBWsGPBJ1O6A" frameborder="0" allowfullscreen=""></iframe><br><br>  <a href="https://ru.wikipedia.org/wiki/The_Legend_of_Zelda_%2528%25D0%25B8%25D0%25B3%25D1%2580%25D0%25B0%2529">The Legend of Zelda</a> , the very first of the legendary series about an elf-like boy in a green cap, for 1986 was a huge game that even had to fit on an expensive cartridge in as much as 128 kilobytes.  Today, this figure sounds ridiculous, but the game is really rather big: it consisted of one big nadmir and two dungeons, each of which was twice as large as nadmir.  Images are clickable. <br><br> <a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/2af/3f3/82a/2af3f382a53a1556d057daef229ab743.jpg"></a> <a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/b45/231/4ed/b452314edf0c9cfca2cbe4d44d87427d.jpg"></a> <a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/5a6/556/5b5/5a65565b5639260f69e9582f85056733.jpg"></a> <br><br>  The first trick is immediately visible: a maximum would be squeezed out of a standard grid.  Dungeons consist of 16 √ó 16 = 256 screens, the overworld of 16 √ó 8 = 128. Therefore, the data on which screen the Link is in fit into one byte: 4 bits for each of the coordinates, while for the world above, one of the bits does not was used.  Interestingly, the second dungeon has a blue L-shaped area that does not fit in the space allotted to it, so its additional two screens are located to the left. <br><br>  If you look closely, then each of the screens is a matrix.  Screens nadmir and dungeons were processed differently.  The nadmir screen is a grid of 16 √ó 11 tiles, each of which can be ground, sand, stone, bush, water, waterfall, gravestone, ladder, bridge / pier, hatch or hole in the wall, plus several options for special decorations - trees and entrances to dungeons that were processed in a special way. <br><br>  In addition to the ground, more than 3 tiles were not used, so two bytes, divided into 4-bit nibbles, are enough to store information about what types of tiles should be on the screen.  Each of the tiles requires only 2 data bits.  As a result, each screen requires 44 bytes of data (and two bytes to store information about the tiles used).  Total supram fit in a little less than 6 kilobytes. <br><br>  Most of the screens above the world use either white, brown or green, and some use brown on green, green on brown, or white on brown.  Two colors can be used as the color of the outer frame and the color of the inner elements.  Only 6 options that fit in three bits or nibble (half a byte). <br><br>  Each of the dungeon rooms is a 12 √ó 7 grid of the actual contents.  But this space was cut in a peculiar way: almost all rooms, except for special ones (entrances, end rooms, and others) have no more than one type of barrier.  This means that to store all the information you need only a bit per tile, a byte per column, and 12 bytes per room. <br><br>  We have 12 extra bits left.  It is necessary to store information about each of the walls (nothing, 3 types of doors, a point for a bomb, a blasted passage).  6 options √ó 4 walls = 24, that is, everything fits in 5 bits.  In addition, you need to store information about the type of barrier: stone, statue, water / lava, sand or void, which takes 3 bits.  The last 4 bits define the color scheme of the room.  Each of the color schemes is determined by the byte (2 options for 16 colors). <br><br>  So, the storage of the entire game world due to the many tricks go some kilobytes. <br><br>  Conservation is also an example of various tricks.  4 bits are used to store information about bombs, the second half of a byte is used to store information on the number of keys (up to 7).  Arrows and money use the same value in byte length, so each shot of 255 possible costs in rupee.  To store information about the number of pieces of Trifors, a whole byte is allocated, since you need to take into account the order of their collection. <br><br>  In total there are 8 used treasures, but one of them has three levels, and the other two - two levels.  There are 6 "passive" treasures, which, for example, allow you to move through the water or move heavy stones, and one of them also has two levels.  Finally, Link can have either a bronze, white, or magic sword, or he may be unarmed.  In total, it is possible to have 22 different items in the inventory, which will require 3 bytes to store, but only 2 bits will remain. <br><br>  You can have up to 16 containers of hearts (4 bits) with different levels of occupancy (4 bits).  Half of the hearts are considered one of the remaining bits from the inventory.  Finally, the first quest can be either passed or not, which requires another bit. <br><br>  Six bits can be set 26 letters, 10 digits and a few special characters.  The name of the save allocated as much as 8 characters, which are stored in 6 bytes.  The Japanese version had to use the entire ASCII range, so there the maximum length is 6 characters.  A byte goes to the coordinate of the screen in the overworld or dungeon, one byte to the other various data. <br><br>  <strong>Thus, the preservation of the game fits in 16 bytes</strong> , while it is not just saving, it is signed with text.  For comparison: this space is enough for 8 Cyrillic characters in UTF-8.  And today, game developers are doing a lot to fit their storage in file system clusters, but 16 bytes is just an error for modern software and data transfer. <br><br>  When developing <a href="https://ru.wikipedia.org/wiki/Crash_Bandicoot">Crash Bandicoot</a> for the PlayStation 1, there were also its own features.  RAM was the main problem, and then - just the console had 2 megabytes of memory, so I had to take insane steps.  There were levels with more than 10 megabytes of data that had to be loaded dynamically, avoiding subsidence of the frame rate below 30 Hz. <br><br>  To do this, it was written by the excellent paging system, which loads pieces of 64 kilobytes as the player moves along the map.  Everything was written in such a way that even at the speed of a console disk drive of 300 kilobytes per second everything was loaded by the time the game character appeared in a given area of ‚Äã‚Äãthe map. <br><br>  To store game resources (sounds, textures, models, code) in these pieces of 64 kilobytes the packing utility was written.  Some levels hardly fit, so the utility used a variety of algorithms - first-fit, best-fit and others.  After reviewing several attempts, the best option was chosen.  The task was complicated by the fact that with the change in the level of design, the possibilities of packing data changed, which was due to the complexity of the mathematical component of the process - this is difficult to explain to artists who suddenly wanted to remake something.  Optimization of the code in C and assembler remained the biggest problem, but in the end everything fit under the outset - only 4 bytes of free space left from two megabytes of RAM. <br><br>  In the 1984 car simulator, <a href="https://en.wikipedia.org/wiki/Revs_%2528video_game%2529">Revs</a> had its little trick.  The graphics of the game looked like the one below.  A large part of the screen was assigned to evenly blue sky <br><br><div style="text-align:center;"> <a href="http://https:"><img src="https://habrastorage.org/files/19f/45b/860/19f45b860cd74ba386a5119017a91881"></a> </div><br><br>  This was used by the creator of the game, the British <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D1%2580%25D1%258D%25D0%25BC%25D0%25BC%25D0%25BE%25D0%25BD%25D0%25B4,_%25D0%2594%25D0%25B6%25D0%25B5%25D1%2584%25D1%2584">Jeff Crammond</a> .  He used this area of ‚Äã‚Äãvideo memory data to store a fairly large piece of code, for which there was very little room in the <a href="https://ru.wikipedia.org/wiki/BBC_Micro">BBC Micro</a> .  This area was painted in blue, so the player did not know about it, unless the game ended with an error - then the screen was filled with some kind of garbage. <br><br>  Many of these tricks are used to this day, although the power of consumer computers and game consoles has increased by many orders of magnitude. <br><br>  Based on materials <a href="https://www.quora.com/How-did-game-developers-pack-entire-games-into-so-little-memory-twenty-five-years-ago">on Quora</a> . </div><p>Source: <a href="https://habr.com/ru/post/363629/">https://habr.com/ru/post/363629/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../363619/index.html">Black Friday at Amazon</a></li>
<li><a href="../363621/index.html">On the 3D-printer printed contact lenses with integrated OLED-display</a></li>
<li><a href="../363623/index.html">Rightholders ravaged Kim Dotcom</a></li>
<li><a href="../363625/index.html">Renewable energy is the biggest part of Scotland's electricity</a></li>
<li><a href="../363627/index.html">The concept of a magnetic suspension lift is created.</a></li>
<li><a href="../363631/index.html">The future is here or how we perceive progress: to the 5th anniversary of one pessimistic post</a></li>
<li><a href="../363637/index.html">Nanoshit for metal</a></li>
<li><a href="../363639/index.html">5 reasons why different people evaluate the sound of headphones differently</a></li>
<li><a href="../363641/index.html">Devuan, Debian fork without systemd</a></li>
<li><a href="../363643/index.html">Three days off in the frame of reference # 9DW</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>