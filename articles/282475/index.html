<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The implementation of the simulator of the mathematical game "Life"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 

 In general, I was going to start writing mini-projects of various games and tasks in order to restore and improve this very programmer for...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The implementation of the simulator of the mathematical game "Life"</h1><div class="post__text post__text-html js-mediator-article">  Foreword <br><br>  In general, I was going to start writing mini-projects of various games and tasks in order to restore and improve this very programmer form.  The first choice fell on chess problems and the math game of J. Conva "Life". <br><br>  Today I will talk about how I implemented the Life game simulator based on the Qt cross-platform library.  I did everything on Qt Widgets without using QML. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Idea <br><br>  The first thing that comes to mind is the choice to use a ready-made widget such as QTableView or make your own.  I decided to make my widget, to simplify all the work, it will be implemented without a scroll and will display as many cells of the ‚ÄúLife‚Äù game field as it will fit.  This is not very convenient, and classically, in professional versions of the ‚ÄúLife‚Äù simulator, the opposite is done: there, the size of the universe is constant, and only the scale and scrolling of the display of the same universe changes.  I will do it in a simple way: the size of the universe will be determined by the size of the widget itself, as many cells fit on the widget - as many cells will be in the grid of the universe.  In addition, an interesting service will be made: the ability to view a list of pre-compiled configurations of populations with the possibility of placing them in an arbitrary place in the grid of the simulator. <br><br>  Architecture <br><br>  The architecture will be simple.  One object will encapsulate the grid of the simulator and be responsible for all aspects of the simulation, including the miscalculation of populations by the signal of the QTimer timer.  Another object is a classic widget with an overridden paintEvent, which renders the current population on the screen using Qt.  The third object is an object that encapsulates work with samples (ready-made populations-configurations stored in files) and allows you to download them from files for further placement on the screen.  In addition, you will need to implement the objects of the program's windows and write in them the logic of working with the user. <br><br>  Implementation <br><br>  It was decided to make the universe itself in the form of an ordinary dynamic matrix, that is, an array of dimension 2. Dynamism is needed for more flexible work with the object.  So, the main object of the simulator should provide the calculation of the matrix of the universe and the other related functions.  The matrix is ‚Äã‚Äãcomposed of the structure of the form: <br><br>  struct Cell {// Matrix cell for game simulation <br>  bool current; <br>  bool next; <br>  }; <br><br>  Where current represents the current cell, which is shown in the interface and which is modified from the interface, and next sets up a temporary cell that serves to render the next population in the main loop of the simulator. <br><br>  The object that stores the matrix from this structure is called LifeObject.  I will give the definition of the object: <br><br>  /// Object containing the main code of the game simulator <br>  class LifeObject: public QObject <br>  { <br>  Q_OBJECT <br>  public: <br>  explicit LifeObject (QObject * parent = 0); <br>  ~ LifeObject (); <br><br>  signals: <br>  void signal_on_timer (); <br>  public slots: <br>  void slot_on_timer (); <br>  public: <br>  Cell ** matrix;  // matrix simulator <br>  QTimer * timer;  // timer object for simulation <br>  uint col_count, row_count; // matrix dimension <br>  uint timer_duration;  // <br>  void init_matrix (uint row_count, uint col_count); <br>  void reinit_matix (uint row_count, uint col_count); <br>  void deinit_matix (); <br>  void start_simulation (); <br>  void stop_simulation (); <br>  void process_population (); <br>  uint get_neighbor_count (uint row, uint col); <br>  void random_population (); <br>  void clean_population (); <br><br>  void test_population (); <br>  void qdebug_matrix (); <br>  }; <br><br>  The widget inherited from QWidget with the overridden paintEvent method is responsible for displaying the image. This widget itself draws on itself the current simulation state in the form of a grid with squares: <br><br><img src="https://habrastorage.org/files/0f5/02f/97e/0f502f97ef404f5496968978261f0b3f.png" alt="image"><br><br>  The definition of a LifeWidget object is: <br><br>  /// Object representing a widget for displaying game grid cells <br>  class LifeWidget: public QWidget <br>  { <br>  Q_OBJECT <br>  public: <br>  explicit LifeWidget (QWidget * parent = 0); <br>  ~ LifeWidget (); <br>  void paintEvent (QPaintEvent * event); <br>  signals: <br><br>  public slots: <br>  void slot_on_timer (); <br>  public: <br>  uint row_height, col_width; <br>  uint cell_padding; <br>  Sample * sample; <br>  bool draw_numbers; <br>  void load_sample (QString path, QString filename); <br>  bool putting_sample; <br>  uint sample_row, sample_col; <br>  void put_sample (); <br>  protected: <br>  virtual void resizeEvent (QResizeEvent *); <br>  void mousePressEvent (QMouseEvent * event); <br>  void mouseMoveEvent (QMouseEvent * event); <br>  public: <br>  LifeObject * life_object; <br>  void autoresize_widget (); <br>  }; <br><br>  Pictures and links <br><br>  Lastly, I‚Äôll give screenshots and links to the source code and distribution kit with a simulator. <br><br><img src="https://habrastorage.org/files/498/ce0/167/498ce01672d7445db69abe6315af538a.png" alt="image"><br><br>  Sample selection window: <br><br><img src="https://habrastorage.org/files/206/251/0e1/2062510e1e2a41799afab060a1ec255d.png" alt="image"><br><br>  Source code can be obtained from the <a href="https://bitbucket.org/ryzkot/qt_life">repository on BitBuket.</a> <br><br>  Download the compiled version of the simulator <a href="https://bitbucket.org/ryzkot/qt_life/downloads">can also be on BitBuket.</a> </div><p>Source: <a href="https://habr.com/ru/post/282475/">https://habr.com/ru/post/282475/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282463/index.html">The first update of the stable branch Vivaldi 1.1</a></li>
<li><a href="../282465/index.html">One little problem downloading files on slow connections</a></li>
<li><a href="../282467/index.html">How to connect the Internet in one day and set up telephony in the office?</a></li>
<li><a href="../282471/index.html">Yandex has developed a corporate font</a></li>
<li><a href="../282473/index.html">Integration of PVS-Studio into the CI process</a></li>
<li><a href="../282477/index.html">Async / Await in javascript. View from the outside</a></li>
<li><a href="../282479/index.html">CRM: April theses from Ruli24</a></li>
<li><a href="../282485/index.html">New Firefox 46.0 is available for free on FTP Mozilla</a></li>
<li><a href="../282489/index.html">Hackers and exchanges: The consequences of attacks on financial companies</a></li>
<li><a href="../282491/index.html">A word guru, problems with unity3d, and a happy ending in the end</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>