<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Forecasting real estate sales. Lecture in Yandex</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Success in machine learning projects is usually associated not only with the ability to use different libraries, but also with an understanding of the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Forecasting real estate sales. Lecture in Yandex</h1><div class="post__text post__text-html js-mediator-article">  Success in machine learning projects is usually associated not only with the ability to use different libraries, but also with an understanding of the area from which data is taken.  An excellent illustration of this thesis was the solution proposed by the team of Alexey Kayuchenko, Sergey Belov, Alexander Drobotov and Alexey Smirnov in the PIK Digital Day competition.  They took second place, and a couple of weeks later they talked about their participation and the models built at the next <a href="https://events.yandex.ru/events/mltr/28-july-2018/">ML training session of Yandex</a> . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/qSehSTWMXaY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Alexey Kayuchenko: <br>  - Good day!  We will talk about the PIK Digital Day competition in which we participated.  A little about the team.  We were four people.  All with a completely different background, from different areas.  In fact, we met at the final.  The team was formed literally the day before the final.  I will tell you about the course of the competition, the organization of work.  Then Serezha will come out, he will tell about the data, and Sasha will already tell about the submission, about the final course of work and how we moved along the leaderboard. <br><br><a name="habracut"></a><img src="https://habrastorage.org/webt/58/bt/vk/58btvkvxdi7xjp8l7vlurgd2vba.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Briefly about the competition.  The task was very applied.  PIK organized this competition by providing apartment sales data.  As a training data set, there was a story with attributes for 2 ¬Ω years in Moscow and the Moscow Region.  The competition consisted of two stages.  It was an online stage, where each of the participants individually tried to make their own model, and the offline stage, not so long, just one day from morning to evening.  It hit the leaders of the online stage. <br><br><img src="https://habrastorage.org/webt/ec/qw/8s/ecqw8s9eumu8exdjiqu6u4cvnpo.jpeg"><br><br>  Our places at the end of the online competition were not even in the top 10, and not even in the top 20.  We were there on the ground 50+.  At the very end, that is, offline stage, there were 43 teams.  There were a lot of teams consisting of one person, although it was possible to unite.  About a third of the teams were more than one person.  At the final there were two competitions.  The first competition is a model without restrictions.  It was possible to use any algorithms: deep learning, machine learning.  At the same time, there was a competition for the best linear regression solution.  The organizer considered that the linear regression was also quite applied, since the competition itself was generally very applied.  That is, an applied problem was posed - it was necessary to predict the volume of sales of apartments, having historical data for the previous 2.5 years with attributes. <br><br>  Our team won second place in the competition for the best model without restrictions and first place in the competition for the best regression.  Double prize. <br><br><img src="https://habrastorage.org/webt/6_/rc/mv/6_rcmvbmjii965qt1jstemjzpgi.jpeg"><br><br>  About the general course of the organization, I can say that the final was very tense, quite stressful.  For example, our winning decision was loaded literally two minutes before the stop game.  The previous decision put us, in my opinion, in fourth or fifth place.  That is, we worked to the end, not relaxing.  PIC organized everything very well.  There were such tables, there was even a veranda so that you could sit outside, get some fresh air.  Food, coffee, everything was provided.  In the picture you can see that everyone sat in their small groups, worked. <br><br>  Sergey will tell more about the data. <br><br>  Sergey Belov: <br>  - Thank.  PIC provided us with several data files.  The two main ones are train.csv and test.csv, in which there were approximately 50 features generated by the PIC itself.  Train consisted of approximately 10 thousand lines, test - from 2 thousand. <br><br><img src="https://habrastorage.org/webt/st/u5/mc/stu5mcmed3ekusrg-ogxkbnh2so.jpeg"><br><br>  What did the string provide?  She contained sales data.  That is, as a value (in this case - target), we had sales by square meters for apartments averaged over a specific building.  There were about 10 thousand such lines.  The features in the sets that the PIC itself poured are shown on the slide with an approximate significance that we received. <br><br>  I was helped here by experience in development companies.  Features such as the distance of the apartment to the Kremlin or to the Transport Ring, the number of parking spaces - they do not have a very strong effect on sales.  The impact is made by the class of the object, the bedroom, and, most importantly, the number of apartments in the implementation at the moment.  PIC did not generate this feature, but they provided us with three additional files: flat.csv, status.csv, and price.csv.  And we decided to take a look at flat.csv, because there was just data on the number of apartments, on their status. <br><br><img src="https://habrastorage.org/webt/gv/kz/j6/gvkzj6wrh-0dvemqkirvbgct9ho.jpeg"><br><br>  And if you ask yourself what was the success of our solution, then this is a certain teamwork.  We worked very smoothly from the very beginning of this competition.  We immediately discussed somewhere in 20 minutes what we would do.  They came to the general conclusion that the first thing to do is to work with the data, because any data scientist understands: there is a lot of data in the data and often the victory is obtained because of some feature that the team generated.  After working with the data, we, first of all, used different models.  We decided to see what result our features give in each of these models, and further focused on the model without restrictions and the linear regression model. <br><br><img src="https://habrastorage.org/webt/jk/5y/hg/jk5yhg6oeed0roc6q7gwii1ym7y.jpeg"><br><br>  We started working with data.  First of all, we looked at how the train set tests relate to each other, that is, whether the areas of this data intersect.  Yes, they intersect: in the number of apartments, and in the bedroom, and in a certain average number of floors. <br><br>  Further, for linear regression, we began to perform some transformations.  These are like standard logarithms of exponents.  For example, in the case of the middle floor, this was the inverse Gaussian transformation for linearization.  We also noticed that sometimes it is better to divide the data into groups.  If we take, for example, the distance from the apartment to the metro or its room, then there are a few other markets, and it is better to divide, make different models for each such group. <br><br>  From the flat.csv file, we generated three features.  One of them is presented here.  It can be seen that it has a fairly good linear relationship, except for this subsidence.  What was this feature?  It corresponded to the number of apartments that are currently under construction.  And this feature works very well at low values.  That is, there can not be more apartments sold than the number that is in sale.  But in these files, in fact, a certain human factor was laid, because they are often composed by man.  We right there saw the points that are knocked out of the area, because they were scored a little wrong. <br><br>  An example from scikit-learn.  The model from GBR and Random Forest without features gave RMSE 239, and with these three features - 184. <br><br>  Sasha will tell you about the models we used. <br><br>  Alexander Drobotov: <br>  - A few words about our approach.  As the guys have already said, we are all different, came from different spheres, different education.  And our approaches were different.  At the final stage, Lesha used more XGBoost from Yandex (most likely CatBoost is meant - ed.), Seryozha is scikit-learn library, I am LightGBM and linear regression. <br><br><img src="https://habrastorage.org/webt/tg/rn/ay/tgrnayovahayt9ssoayjqkb8vow.jpeg"><br><br>  The XGBoost, linear regression, and Prophet models are the three options that showed our best score.  For linear regression, we had a blending of two models, and for the general competition, XGBoost, and we added a little bit of linear regression. <br><br><img src="https://habrastorage.org/webt/lm/ca/3f/lmca3fbb6iryqyli0bwxubkkfnu.jpeg"><br><br><img src="https://habrastorage.org/webt/fe/-z/5o/fe-z5o2xbgu9vd9p4ymiqbufbyg.jpeg"><br><br>  Here is the process of sending solutions and team work.  In the graph on the left, the X axis is public RMSE, the value of the metric, and the Y axis is the private score, RMSE.  We started approximately from these positions.  Here are the individual models of each of the participants.  Then, after exchanging ideas and creating new features, we began to approach our best score.  Our values ‚Äã‚Äãfor individual models were approximately the same.  The best individual model is XGBoost and Prophet.  Prophet created a forecast for cumulative sales.  There was a sign like start square.  That is, we knew how many apartments we had total, understood what historical value, and incremental-value tended to total-value.  Prophet made a forecast for the future, gave out values ‚Äã‚Äãin the following periods and submitted them to XGBoost. <br><br>  The blending of our best individual score is somewhere here, here are these two orange dots.  But this score was not enough for us to get to the top. <br><br><img src="https://habrastorage.org/webt/4z/rz/ub/4zrzubgvsp-zuswhjzyv0ntkoyi.jpeg"><br><br>  After examining the usual correlation matrix of the best submitters, we saw the following: trees - and this is logical - showed a correlation close to one, and the best tree gave XGBoost.  It shows a not so high correlation with linear regression.  We decided to dabble these two options in the ratio of 8 to 2. That is how we got the best final solution. <br><br><img src="https://habrastorage.org/webt/yh/5v/fa/yh5vfasrzvukbsffnuiv6ir7z50.jpeg"><br><br>  This is a leaderboard with results.  Our team ranked second in models without restrictions and first in linear models.  As for the score - here all the values ‚Äã‚Äãare pretty close.  The difference is not very big.  A linear regression is already underway in the area of ‚Äã‚Äã5. We have it all, thank you! </div><p>Source: <a href="https://habr.com/ru/post/420581/">https://habr.com/ru/post/420581/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420571/index.html">Smart Headphones - Trends 2018: Environment Filtering, Audio Trainer, Head Gestures, and Direct Connection to Alexa</a></li>
<li><a href="../420573/index.html">Android Academy: now in Moscow</a></li>
<li><a href="../420575/index.html">What to read about the sound in movies, videos and games</a></li>
<li><a href="../420577/index.html">The digest of interesting materials for the mobile developer # 266 (August 13 ‚Äî August 19)</a></li>
<li><a href="../420579/index.html">24-core CPU, and I can not dial an email</a></li>
<li><a href="../420585/index.html">Barcode database free download without registration (and other persimmon)</a></li>
<li><a href="../420587/index.html">Well, where do these engines go now?</a></li>
<li><a href="../420589/index.html">What to look for when choosing a logging system, and why we stopped at ELK</a></li>
<li><a href="../420591/index.html">Translation of Andrew Un‚Äôs Passion for Machine Learning, Chapter 20-27</a></li>
<li><a href="../420593/index.html">Mobile Web Navigation Optimization (2 Recent Success)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>