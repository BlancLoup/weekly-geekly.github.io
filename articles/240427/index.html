<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Transition from ODAC 10 to ODAC 12</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good morning everyone! 

 It took us here quickly to switch to Oracle.DataAcess 12th version in our .Net project. And everything went fine until we tr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Transition from ODAC 10 to ODAC 12</h1><div class="post__text post__text-html js-mediator-article">  Good morning everyone! <br><br>  It took us here quickly to switch to Oracle.DataAcess 12th version in our .Net project.  And everything went fine until we tried to start the application.  In a <i>couple of thousand</i> places a type error suddenly fell out: <br><br><pre><code class="cs hljs">Unable to cast <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> of type <span class="hljs-string"><span class="hljs-string">'Oracle.DataAccess.Types.OracleDecimal'</span></span> to type <span class="hljs-string"><span class="hljs-string">'System.IConvertible'</span></span>.</code> </pre> <br><a name="habracut"></a><br>  Searching the forums gave the answer - in the 11th version something concrete was replayed in the OracleParameter and, as a result, all Convert.ToXXX in our project fell off. <br>  As a solution, the Mark Williams blog <a href="http://oradim.blogspot.ru/2009/08/odpnet-vb-and-from-type-to-type-is-not.html">oradim.blogspot.ru/2009/08/odpnet-vb-and-from-type-to-type-is-not.html</a> proposes the following: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  OracleDbType vs.  Oracle provider type is returned.  Also, the current ODP.NET Beta (11.1.7.10) exposes a new property for the OracleParameter class: OracleDbTypeEx This property allows you to use it. </blockquote><br><br>  Automaton this property is not initialized.  In the internals of ODAC through dotPeek, the following piece was discovered: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> OracleDbType OracleDbType { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_oraDbType; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_oraDbType != <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { OracleDbType oracleDbType = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (oracleDbType &lt; OracleDbType.BFile || oracleDbType &gt; OracleDbType.Boolean) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentOutOfRangeException(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_oraDbType = oracleDbType; } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_bSetDbType = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_enumType = PrmEnumType.ORADBTYPE; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_bOracleDbTypeExSet = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> OracleDbType OracleDbTypeEx { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_oraDbType; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.OracleDbType = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_bOracleDbTypeExSet = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } }</code> </pre><br><br>  Those.  the necessary property from the parameter constructor is not initialized itself; you need to explicitly add its setting to the code so that the field this.m_bOracleDbTypeExSet becomes true. <br>  We absolutely did not want to peel a huge number of command declarations, since we already had our own library with extender methods for OracleCommand and we added another method: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteNonQueryExt</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> OracleCommand cmd</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (OracleParameter param <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cmd.Parameters) { param.OracleDbTypeEx = param.OracleDbType; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cmd.ExecuteNonQuery(); }</code> </pre><br><br>  And then autocorrect for the ExecuteNonQuery project on ExecuteNonQueryExt and bingo!  Everything started and flew.  :-) <br>  Perhaps there is some more painless way to accomplish this transition without rewriting half of the project, but the solution was not found on the forums.  Although the rake is quite old and many have stepped on them even at the time of the 11th version. </div><p>Source: <a href="https://habr.com/ru/post/240427/">https://habr.com/ru/post/240427/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../240403/index.html">Hunting for Java-developers: how to grow professionally and become a desired goal</a></li>
<li><a href="../240405/index.html">Hadoop: what, where and why</a></li>
<li><a href="../240417/index.html">Fractal Night</a></li>
<li><a href="../240421/index.html">The education we lost</a></li>
<li><a href="../240425/index.html">Simple way to additional security: SSH - ALERT</a></li>
<li><a href="../240431/index.html">Android application on QML: Picker</a></li>
<li><a href="../240433/index.html">Level of maturity requirements management process</a></li>
<li><a href="../240435/index.html">News from Xamarin Evolve 2014 - Insights monitoring system, Android Player emulator, Profiler, UITest, prototyping in Sketches</a></li>
<li><a href="../240437/index.html">Facebook personalization</a></li>
<li><a href="../240439/index.html">English words</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>