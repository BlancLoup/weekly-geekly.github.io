<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tips and Tricks 1: deferred function calls (Functor Manager)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When creating games, developers are often faced with such a task - which event should be performed, but not at the moment, but after some time. This t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tips and Tricks 1: deferred function calls (Functor Manager)</h1><div class="post__text post__text-html js-mediator-article">  When creating games, developers are often faced with such a task - which event should be performed, but not at the moment, but after some time.  This task is solved in different ways.  Most often, game objects have their own internal timer, and the necessary delay can be realized with its help (by adding extra code to the object).  But sometimes you need to make a deferred method call for an object that does not have its own timer, say, hide a window, a row, show an icon or effect after a while, do something else, but not right now, but with a delay.  Once or several times. <br><br>  For these and similar purposes, my colleague developed a universal system, which he called Functor Manager (perhaps there is another term for such systems, I don‚Äôt know, I‚Äôll be glad if they tell you). <br><br>  Initially, the code was written in C ++, and was used in our past projects, now we have a project in C #, so the implementation will be in C #.  The brief concept and implementation code (C #) under the cut. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h4>  Functor </h4><br><br>  Fanctor is a classic who remembers how long and what function should be called. <br><br>  So, the fanctor itself consists of: <br>  <i><b>Guid</b></i> is a unique identifier that is generated when creating a fanto.  This ID is needed so that you can remove the fan in case of uselessness. <br>  <i><b>_deltaTime</b></i> - internal timer.  This is the time after which the function call should occur. <br>  <i><b>_func</b></i> is a pointer to a function whose code must be executed after the timer expires.  The function returns the value - after what period (in seconds) the fanctor must repeat the method call.  In case the function returns a value of 0.0f, then the fan is nailed. <br>  <i><b>_funcArg</b></i> - function argument.  Here you can pass say the pointer to the object, or any other necessary information. <br><br>  In the fan code, everything is simple - the constructors fill in the fields, and the only method worth explaining is the Process method.  The counter is reduced by the number of ticks; if it reaches zero, the function is called.  The return value is assigned to the timer. <br><br>  Fan Code: <br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Func</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> funcArg</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HOFunctor</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _deltaTime = <span class="hljs-number"><span class="hljs-number">0</span></span>; Func _func = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> _funcArg = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; Guid _id = Guid.Empty; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HOFunctor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaTime, Func func, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> funcArg</span></span></span><span class="hljs-function">)</span></span> { _id = Guid.NewGuid(); _deltaTime = deltaTime; _func = func; _funcArg = funcArg; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HOFunctor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaTime, Func func</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">deltaTime, func, </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Process</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaTime</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_func != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _deltaTime -= deltaTime; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_deltaTime &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { _deltaTime = _func(_funcArg); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _deltaTime &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Guid ID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _id; } } }</code> </pre> <br><br><h4>  Functor manager </h4><br><br>  Fanctor Manager is a class, singleton, that stores a list of fanktor (in fact, there are 2 lists, more on this below). <br><br>  So, in the manager there are 2 lists, one of which is active at the moment, and the second is filled with newly added fans, including those added at the time of execution of the active list.  There is also a <i><b>_currentIndex</b></i> variable, which is determined by which of the lists is currently active. <br><br>  Most of the methods are also intuitive (AddFunctor (...) - adds a fanctor to the list, RemoveFunctor () - removes from the list).  The only thing worth explaining is the ProcessFunctors (float delta) method.  The current list is taken, the process method is called for each fanctor so that it counts the time and, if necessary, runs, if the fantor returns a non-zero value (that is, the time after which it must be called again), then it is added to the new list.  At the end of the active list is cleared. <br><br>  Manager Code: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HOFunctorMgr</span></span> { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> Private fields private static HOFunctorMgr _instance = null; protected Dictionary&lt;Guid, HOFunctor&gt;[] _functors = { new Dictionary&lt;Guid, HOFunctor&gt;(), new Dictionary&lt;Guid, HOFunctor&gt;() }; int _currentIndex = 0; private HOFunctorMgr() { } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> public static HOFunctorMgr Instance { get { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (_instance == null) { _instance = new HOFunctorMgr(); } return _instance; } } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> Public methods public Guid AddFunctor(float deltaTime, Func func, object funcArg) { return AddFunctor(new HOFunctor(deltaTime, func, funcArg)); } public Guid AddFunctor(float deltaTime, Func func) { return AddFunctor(new HOFunctor(deltaTime, func, null)); } public Guid AddFunctor(HOFunctor functor) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (functor != null &amp;&amp; !_functors[_currentIndex].ContainsKey(functor.ID)) { _functors[_currentIndex].Add(functor.ID, functor); return functor.ID; } return Guid.Empty; } public void ProcessFunctors(float delta) { int indexToProcess = _currentIndex; _currentIndex ^= 1; foreach (HOFunctor f in _functors[indexToProcess].Values) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (f.Process(delta)) { AddFunctor(f); } } _functors[indexToProcess].Clear(); } public void RemoveFunctor(Guid id) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (_functors[0].ContainsKey(id)) { _functors[0].Remove(id); } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (_functors[1].ContainsKey(id)) { _functors[1].Remove(id); } } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> }</span></span></code> </pre><br><br><h4>  Project Integration </h4><br><br>  Integration into the project is done in 1 line.  Need to add a challenge <br><br>  HOFunctorMgr.Instance.ProcessFunctors (delta); <br><br>  in the game cycle, of course, after adding the class of the fan manager‚Äôs manager to the project.  In my case (the NeoAxis engine) this is the protected override void OnTick method (float delta) of the game window. <br><br>  delta is the elapsed time in seconds since the previous call. <br><br>  Everything is so simple. <br><br><h4>  Examples of using </h4><br><br>  Single call: <br><br><pre> <code class="cs hljs">GameEntities.HOFunctorMgr.Instance.AddFunctor(<span class="hljs-number"><span class="hljs-number">2.0f</span></span>, arg =&gt; { HidePuzzleWindow(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0.0f</span></span>; }, <span class="hljs-literal"><span class="hljs-literal">null</span></span> );</code> </pre><br><br>  After 2 seconds, HidePuzzleWindow () is called and the puzzle window is hidden. <br><br>  Multiple call: <br><br><pre> <code class="cs hljs">... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> k = <span class="hljs-number"><span class="hljs-number">5</span></span>; HOFunctorMgr.Instance.AddFunctor(<span class="hljs-number"><span class="hljs-number">5</span></span>, arg =&gt; { GameMap.Instance.AddScreenMessage(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0}"</span></span>, arg)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (k-- &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }, <span class="hljs-string"><span class="hljs-string">"test"</span></span>);</code> </pre><br><br>  The fanter will be called 5 times, displaying the word test at an interval of 5 seconds each time.  The interval, by the way, can be changed. <br><br>  Calling a static method: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyMethod</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arg</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arg != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { ... } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } HOFunctorMgr.Instance.AddFunctor(<span class="hljs-number"><span class="hljs-number">10</span></span>, MyMethod, someObject);</code> </pre><br><br>  After 10 seconds, the static method MyMethod will be called and someObject will be passed to it as an argument. <br><br><h4>  About use </h4><br><br>  You can modify and / or use the code in your projects, both non-commercial and commercial. <br><br><h4>  Full class code </h4><br><br>  Class code, neimspace sharpened for NeoAxis. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">GameEntities</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Func</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> funcArg</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HOFunctor</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _deltaTime = <span class="hljs-number"><span class="hljs-number">0</span></span>; Func _func = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> _funcArg = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; Guid _id = Guid.Empty; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HOFunctor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaTime, Func func, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> funcArg</span></span></span><span class="hljs-function">)</span></span> { _id = Guid.NewGuid(); _deltaTime = deltaTime; _func = func; _funcArg = funcArg; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HOFunctor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaTime, Func func</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">deltaTime, func, </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Process</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaTime</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_func != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _deltaTime -= deltaTime; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_deltaTime &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { _deltaTime = _func(_funcArg); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _deltaTime &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Guid ID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _id; } } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HOFunctorMgr</span></span> { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> Private fields private static HOFunctorMgr _instance = null; protected Dictionary&lt;Guid, HOFunctor&gt;[] _functors = { new Dictionary&lt;Guid, HOFunctor&gt;(), new Dictionary&lt;Guid, HOFunctor&gt;() }; int _currentIndex = 0; private HOFunctorMgr() { } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> public static HOFunctorMgr Instance { get { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (_instance == null) { _instance = new HOFunctorMgr(); } return _instance; } } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> Public methods public Guid AddFunctor(float deltaTime, Func func, object funcArg) { return AddFunctor(new HOFunctor(deltaTime, func, funcArg)); } public Guid AddFunctor(float deltaTime, Func func) { return AddFunctor(new HOFunctor(deltaTime, func, null)); } public Guid AddFunctor(HOFunctor functor) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (functor != null &amp;&amp; !_functors[_currentIndex].ContainsKey(functor.ID)) { _functors[_currentIndex].Add(functor.ID, functor); return functor.ID; } return Guid.Empty; } public void ProcessFunctors(float delta) { int indexToProcess = _currentIndex; _currentIndex ^= 1; foreach (HOFunctor f in _functors[indexToProcess].Values) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (f.Process(delta)) { AddFunctor(f); } } _functors[indexToProcess].Clear(); } public void RemoveFunctor(Guid id) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (_functors[0].ContainsKey(id)) { _functors[0].Remove(id); } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (_functors[1].ContainsKey(id)) { _functors[1].Remove(id); } } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> } }</span></span></code> </pre><br><br></div><p>Source: <a href="https://habr.com/ru/post/121244/">https://habr.com/ru/post/121244/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../121238/index.html">For the first time, Facebook has witnessed a negative growth in the number of users in the US and Canada.</a></li>
<li><a href="../121239/index.html">Chrome browser extension allows you to circumvent the paid reading mode Wall Street Journal</a></li>
<li><a href="../121241/index.html">Negligence hoster led to the publication of the base site</a></li>
<li><a href="../121242/index.html">Samsung Galaxy Tab 10.1 is available for pre-order</a></li>
<li><a href="../121243/index.html">IPO for dummies. Part IV: The Impact of an IPO on Adult-Partner Revenue</a></li>
<li><a href="../121246/index.html">Processor optimized for functional programming</a></li>
<li><a href="../121250/index.html">Another HTPC</a></li>
<li><a href="../121251/index.html">Type grouping concept in C ++</a></li>
<li><a href="../121252/index.html">Disable the jQuery library built into the MediaWiki 1.16.x engine, and replace it with a fresh one, updated and updated by the wiki administrators</a></li>
<li><a href="../121253/index.html">Free Cheese or Why so many reviews of Chinese Android tablets?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>