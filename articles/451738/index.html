<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A brief review of the article "DeViSE: A Deep Visual-Semantic Embedding Model"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article in question. 
 Introduction 


 Modern recognition systems are limited to classify into a relatively small number of semantically unrelate...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A brief review of the article "DeViSE: A Deep Visual-Semantic Embedding Model"</h1><div class="post__text post__text-html js-mediator-article"><p>  <a href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/41473.pdf">The article in question.</a> </p><br><h3 id="vvedenie">  Introduction </h3><br><p>  Modern recognition systems are limited to classify into a relatively small number of semantically unrelated classes.  Bringing in textual information, even unrelated to pictures, allows us to enrich the model and to some extent solve the following problems: </p><br><ol><li>  if the recognition model makes a mistake, then often this error is semantically not close to the correct class; </li><li>  There is no way to predict an object that belongs to a new class that was not represented in the training dataset. </li></ol><br><p>  The proposed approach proposes to display images in a rich semantic space in which the labels of more similar classes are closer to each other than the labels of less similar classes.  As a result, the model gives fewer semantically far from the true class of predictions.  Moreover, the model, taking into account both visual and semantic proximity, can correctly classify images belonging to a class that was not represented in the training dataset. </p><a name="habracut"></a><br><h3 id="algoritm-arhitektura">  Algorithm.  Architecture </h3><br><ol><li>  Pre-teach the language model, which gives good semantically meaningful embedding.  The dimension of the space is n.  Further n will be taken equal to 500 or 1000. </li><li>  We teach the visual model, which classifies objects well into 1000 classes. </li><li>  Cut the last softmax layer from the pre-trained visual model and add a fully connected layer from 4096 to n neurons.  For each image, we train the resulting model to predict embedding for the corresponding image label. </li></ol><br><p>  Explain using mappings.  Let LM be the language model, VM the visual model with the cut softmax and the added fully connected layer, I - image, L the label of image, LM (L) - the label embedding in the semantic space.  Then in the third step we train the VM so that: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>L</mi><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>L</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.726ex" height="2.66ex" viewBox="0 -832 7632.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-4D" x="769" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-28" x="1821" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-49" x="2210" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-29" x="2715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-3D" x="3382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-4C" x="4438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-4D" x="5120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-28" x="6171" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-4C" x="6561" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-29" x="7242" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mi>M</mi><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mi>M</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> VM (I) = LM (L) </script></p><br><p>  Architecture: </p><br><img src="https://habrastorage.org/webt/59/ki/-t/59ki-torfbo8ufarpy8vlwdalze.png"><br><h3 id="yazykovaya-model">  Language model </h3><br><p>  The language model used was a skip-gram model, a body of 5.4 billion words taken from wikipedia.org.  The model used a hierarchical softmax layer to predict adjacent concepts, a window - 20 words, the number of passes through the body - 1. It was experimentally established that embedding size is better to take 500-1000. </p><br><p>  The picture of the location of classes in space shows that the model has learned a high-quality and rich semantic structure.  For example, for a certain type of shark in the resulting semantic space, the 9 nearest neighbors are the other 9 types of sharks. </p><br><img src="https://habrastorage.org/webt/wd/wu/-b/wdwu-bbzhgw2jwdcyn_bnxa9h_o.png"><br><h3 id="vizualnaya-model">  Visual model </h3><br><p>  The architecture that won the 2012 ILSVRC competition was taken as a visual model.  Softmax was removed and a fully connected layer was added to obtain the desired embedding size. </p><br><h3 id="funkciya-poter">  Loss function </h3><br><p>  It turned out that the choice of the loss function is important.  A combination of cosine similarity and hinge rank loss was used.  The loss function spared a larger scalar product between the result vector of the visual network and the corresponding embinge label and fined for the large scalar product between the result of the visual network and embedings of random possible image labels.  The number of arbitrary random labels was not fixed, but limited by the condition under which the sum of scalar products with false labels became larger than the scalar product with a valid label minus the fixed margin (constant 0.1).  Of course, all the vectors were previously normalized. </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo>,</mo><mi>L</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>i</mi><mi>n</mi><mo>&amp;#x2212;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>L</mi><mo>,</mo><mi>V</mi><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mi>w</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>g</mi><msub><mi>L</mi><mi>j</mi></msub><mo>,</mo><mi>V</mi><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="70.586ex" height="2.78ex" viewBox="0 -832 30391 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-73" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-73" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-28" x="1723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-49" x="2112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-2C" x="2617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-4C" x="3062" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-29" x="3743" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-3D" x="4410" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-73" x="5717" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-75" x="6186" y="0"></use><g transform="translate(6759,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-6A" x="1242" y="-213"></use></g><g transform="translate(8029,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-6D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-61" x="878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-78" x="1408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-5B" x="1980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-30" x="2259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-2C" x="2759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-6D" x="3204" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-61" x="4083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-72" x="4612" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-67" x="5064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-69" x="5544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-6E" x="5890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-2212" x="6712" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-28" x="7713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-4C" x="8103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-2C" x="8784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-56" x="9229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-4D" x="9999" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-28" x="11050" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-49" x="11440" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-29" x="11944" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-29" x="12334" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-2B" x="12946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-28" x="13946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-77" x="14336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-72" x="15052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-6F" x="15504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-6E" x="15989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-67" x="16590" y="0"></use><g transform="translate(17070,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-4C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-6A" x="963" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-2C" x="18143" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-56" x="18589" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-4D" x="19358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-28" x="20410" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMATHI-49" x="20799" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-29" x="21304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-29" x="21693" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451738/&amp;xid=17259,15700002,15700023,15700186,15700191,15700256,15700259&amp;usg=ALkJrhgTsWd5ooXH3dAQQxO9AWJuC6esQA#MJMAIN-5D" x="22083" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>I</mi><mo>,</mo><mi>L</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>i</mi><mi>n</mi><mo>‚àí</mo><mo stretchy="false">(</mo><mi>L</mi><mo>,</mo><mi>V</mi><mi>M</mi><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mi>w</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>g</mi><msub><mi>L</mi><mi>j</mi></msub><mo>,</mo><mi>V</mi><mi>M</mi><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> loss (I, L) = \ sum_ {j} {max [0, margin - (L, VM (I)) + (wrongL_j, VM (I))]} </script></p><br><h3 id="process-trenirovki">  Training process </h3><br><p>  At the beginning, only the last fully connected layer was trained, the rest of the network did not update the weights.  In this case, the SGD optimization method was used.  Then the entire visual network was unfrozen and trained using the Adagrad optimizer so that during back propagation at different layers of the network the gradients scaled correctly. </p><br><h3 id="predskazanie">  Prediction </h3><br><p>  During the prediction, the image using a visual network, we get some vector in our semantic space.  Next, we find the nearest neighbors, that is, some possible labels and in a special way display them back to ImageNet synsets for scoring.  The procedure for the last mapping is not as simple as the labels in ImageNet are a set of synonyms, and not one label.  If the reader is interested to know the details, I recommend the original article (Appendix 2). </p><br><h2 id="rezultaty">  results </h2><br><p>  The result of the development of the DEVISE model was compared with two models: </p><br><ol><li>  Softmax baseline model - a state-of-the-art vision model (SOTA - at the time of publication) </li><li>  Random embedding model is the version of the described DEVISE model, where joints are not learned by the language model, but are initialized arbitrarily. </li></ol><br><p>  For quality assessment, ‚Äúflat‚Äù hit @ k metrics and hierarchical precision @ k metric were used.  The hit @ k ‚Äúflat‚Äù metric is the percentage of test images for which the correct label is among the first k predicted variants.  The hierarchical precision @ k metric was used to assess the quality of semantic match.  This metric was based on the label hierarchy in ImageNet.  For each true label and fixed k, a set of <br>  semantically correct tags - ground truth list.  Receiving a prediction (nearest neighbors) was the percentage of intersection with the ground truth list. </p><br><img src="https://habrastorage.org/webt/p_/i7/dm/p_i7dmm6gvhc8h9ndzd20hrryye.png"><br><p>  The authors expected that the softmax model should show the best results on flat metric because it minimizes cross-entropy loss, which is very well suited for ‚Äúflat‚Äù hit @ k metrics.  The authors were surprised at how close the DEVISE model comes to the softmax model, reaches parity at large k and even outperforms when k = 20. </p><br><p>  On the hierarchical metric, the DEVISE model shows itself in all its glory and overtakes the softmax baseline by 3% for k = 5 and by 7% for k = 20. </p><br><h3 id="zero-shot-learning">  Zero-shot learning </h3><br><p>  A particular advantage of the DEVISE model is the ability to provide adequate prediction for images whose marks the network has never seen during training.  For example, the network saw images marked tiger shark, bull shark, and blue shark during a workout and never met the shark tag.  Since the language model has an idea for shark in the semantic space and it is close to embeddings of different types of shark, the model is more likely to give an adequate prediction.  This is called the ability of generalization - generalization. </p><br><p>  Let us demonstrate some examples of Zero-Shot predictions: </p><br><img src="https://habrastorage.org/webt/50/w6/bc/50w6bceiaq61y6ohmehsmqzrrhc.png"><br><p>  Note that the DEVISE model, even in its erroneous assumptions, is closer to the correct answer than the erroneous assumptions of the softmax model. </p><br><p>  So, the presented model, quite a bit loses softmax baseline on flat metrics, but significantly wins on hierarchical precision @ k metric.  The model has the ability to generalize, giving adequate predictions for the images, the marks of which the network has not met (zero-shot learning). </p><br><p>  The described approach can be easily implemented, since it is based on two pre-trained models - language and visual. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/451738/">https://habr.com/ru/post/451738/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451716/index.html">Improving software performance with Intel tools for developer. Numerical modeling of astrophysical objects</a></li>
<li><a href="../451718/index.html">Creating a voice assistant</a></li>
<li><a href="../451720/index.html">Loading FIAS in DB on MSSQLSERVER with improvised (SQLXMLBULKLOAD) means. How it (probably) does not need to do</a></li>
<li><a href="../451724/index.html">Skyrmion skyrmion discord: three-dimensional polar skyrmions in ferroelastics</a></li>
<li><a href="../451726/index.html">Looking for a job abroad: 7 simple tips for IT specialists</a></li>
<li><a href="../451742/index.html">One day to DotNext 2019 Piter. Announcement of free broadcast</a></li>
<li><a href="../451746/index.html">MegaSlerm for Kubernetes engineers and architects</a></li>
<li><a href="../451748/index.html">SSD state monitoring in Qsan arrays</a></li>
<li><a href="../451750/index.html">The book "Elasticsearch, Kibana, Logstash and the new generation of search engines"</a></li>
<li><a href="../451752/index.html">30th anniversary of rampant insecurity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>