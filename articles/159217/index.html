<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Phalcon - Compiled PHP MVC Framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Creating compiled MVC frameworks for PHP more than once came to the mind of coders. 

 The advantages of this approach: 


- High performance 
- Low f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Phalcon - Compiled PHP MVC Framework</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/ede/b07/dd7/edeb07dd7dacef7135ae417b1ecedb46.png" align="right"><br>  Creating compiled MVC frameworks for PHP more than once came to the mind of coders. <br><br>  The advantages of this approach: <br><ul><li>  High performance </li><li>  Low file system load </li><li>  Less memory consumption (with strict typing) </li><li>  Partial data processing without interpretation </li></ul><br>  And by itself no less obvious flaws: <br><ul><li>  If you do not know C, then you are completely dependent on the developers. </li><li>  The project can be blown away at any second </li><li>  Depending on the architecture, some modules still have to write the most, which reduces the gain </li></ul><br><a name="habracut"></a><br><br>  In this article I will try to introduce another attempt to make a compiled PHP MVC Framework. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Acquaintance </h3><br>  I myself am in search of a fast, reliable and capable framework.  Walking on foreign forums and blogs, I stumbled upon an interesting benchmark, where a certain framework on ‚ÄúHello World!‚Äù Did belly-bellied celebrities several times. <br> <a href="http://docs.phalconphp.com/en/latest/reference/benchmark/hello-world.html"><img src="https://habrastorage.org/storage2/f8c/8bc/a7a/f8c8bca7acdd437a262edb2627bdaee2.jpg"><br></a> <br><br>  I couldn‚Äôt go past this and began to find out how it works and develops. <br>  Project less than a year.  The first commit on github is January 10, 2012. And yes, this is an open source project.  As I understand it, now 3 people are less actively involved in it. <br><br>  The authors are trying to give people the opportunity to write code without thinking about its performance, adhering to standards and giving access to most of the methods used, which are loaded into memory from the start of the server. <br><br><h5>  Example </h5><br>  The best way to learn the framework is to do something on it, while at the same time studying the documentation. <br>  I made a 3-page application showing some of the features of <b>phalcon</b> , namely: <br><ul><li>  Routing </li><li>  Work with the database in the internal language PHQL </li><li>  Work with events </li><li>  Data filtering </li><li>  Caching </li><li>  DI (dependency injection) </li><li>  Features built-in Volt template engine </li></ul><br>  In addition, the developers say much more: <br><ul><li>  ODM - work with document-oriented databases </li><li>  Multilingualism </li><li>  Automatic creation of CRUD applications from the console or web-muzzle </li><li>  Support for several popular template engines </li><li>  Micro applications (for creating REST API) </li><li>  Creating a logger of any configuration </li><li>  Creating your event manager with fire and catch </li><li>  Built-in html tag handler for templates </li><li>  Support nemespace and multi-modularity </li><li>  Processing sessions and flash messages </li><li>  ACL </li></ul><br><br><h5>  Project Hierarchy: </h5><br><pre> xmpl /
     apps /
         app / config /
         app / controllers /
         app / models /
         app / views /
         app / My /
     public /
         public / img /
         public / css /
         public / js /
</pre><br><br>  All code will be located along the path / apps /, initialization of the application /public/index.php.  On the last file, in fact, you need to configure the redirect of nonexistent pages, via <a href="https://github.com/phalcon/invo">apache</a> (.htaccess in the folders / and / public /) or <a href="http://docs.phalconphp.com/en/latest/reference/nginx.html">nginx</a> . <br><br><h5>  Initialization: </h5><br><div class="spoiler">  <b class="spoiler_title">About initialization in brief under the spoiler.</b> <div class="spoiler_text"><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//    ini  $config = new Phalcon\Config\Adapter\Ini( '../apps/config/config.ini' ); // ,  ,      $loader = new \Phalcon\Loader(); $loader-&gt;registerDirs(array( $config-&gt;application-&gt;controllersDir, $config-&gt;application-&gt;modelsDir, $config-&gt;application-&gt;myDir, )); $loader-&gt;register(); // DI $di = new \Phalcon\DI(); //,    url. $di-&gt;set('url', function() use ($config){ $url = new \Phalcon\Mvc\Url(); return $url; }); //    ,  ( Mysql, PostgreSQL, SQLite) $di-&gt;set('db', function() use ($config) { $connection = new \Phalcon\Db\Adapter\Pdo\Mysql(array( "host" =&gt; $config-&gt;database-&gt;host, "username" =&gt; $config-&gt;database-&gt;username, "password" =&gt; $config-&gt;database-&gt;password, "dbname" =&gt; $config-&gt;database-&gt;name )); return $connection; }); //2       $di-&gt;set('modelsManager', function(){ return new Phalcon\Mvc\Model\Manager(); }); //,   -  ,  (Apc, Files, Memory, Session) $di-&gt;set('modelsMetadata', function(){ return new \Phalcon\Mvc\Model\Metadata\Memory(); }); //  $di-&gt;set('router', 'Phalcon\Mvc\Router'); // ,      view  .    . $di-&gt;set('dispatcher', function() use ($di) { $dispatcher = new Phalcon\Mvc\Dispatcher(); return $dispatcher; }); //    $di-&gt;set('response', 'Phalcon\Http\Response'); $di-&gt;set('request', 'Phalcon\Http\Request'); //   $di-&gt;set('filter', function(){ return new \Phalcon\Filter(); }); //    Volt   $di-&gt;set('voltService', function($view, $di) use ($config) { $volt = new Phalcon\Mvc\View\Engine\Volt($view, $di); $volt-&gt;setOptions(array( "compiledPath" =&gt; $config-&gt;application-&gt;templCompDir, "compiledExtension" =&gt; ".compiled" )); return $volt; }); // ,   .    eventManager, //,     view.    //      $di-&gt;set('view', function() use ($config) { $eventsManager = new \Phalcon\Events\Manager(); $viewManager = new ViewManager(); $eventsManager-&gt;attach('view', $viewManager); $view = new \Phalcon\Mvc\View(); $view-&gt;setViewsDir( $config-&gt;application-&gt;viewsDir ); $view-&gt;registerEngines(array( ".phtml" =&gt; 'voltService' )); $view-&gt;setEventsManager($eventsManager); return $view; }); //    ,  front (Base64, Data, None, Output)  backend (Apc, File, Memcache, Mongo),  ,     $di-&gt;set('cache', function(){ $frontCache = new Phalcon\Cache\Frontend\Data(array( "lifetime" =&gt; 60 )); $cache = new Phalcon\Cache\Backend\Apc($frontCache); return $cache; }); //         try { $application = new \Phalcon\Mvc\Application(); $application-&gt;setDI($di); echo $application-&gt;handle()-&gt;getContent(); } catch(Phalcon\Exception $e){ echo $e-&gt;getMessage(); }</span></span></code> </pre> <br></div></div><br><br>  Most can be connected automatically, like this: <br><pre> <code class="php hljs">$di = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Phalcon\DI\FactoryDefault();</code> </pre><br><br><h5>  Controllers and their classes: </h5><br>  Now, standard routing is available in your application <i>/ baseUri / ControllerName / ActionName /</i> , methods are connected that via <b>di</b> inherit the <i>$ this-&gt; cache, $ this-&gt; dispatcher, $ this-&gt; db</i> controllers ... <br><br>  You can also call your classes located in the <i>/ apps / My /</i> folder <br>  The <b>ViewManager</b> class will receive all the events generated by the <b>View</b> .  On interests <b>beforeRender</b> .  In it, we will transfer to the view variables containing the name of the class and the action. <br><br><div class="spoiler">  <b class="spoiler_title">We will also create the BaseController class.</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Phalcon</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mvc</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Phalcon\Tag::prependTitle(<span class="hljs-string"><span class="hljs-string">'Example | '</span></span>); } }</code> </pre><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IndexController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    title,     (   Poll) Phalcon\Tag::setTitle('Index'); parent::initialize(); } public function indexAction(){ } }</span></span></code> </pre><br><br>  It inherits the standard class.  Our controllers will already inherit <b>BaseController</b> and get the prefix to the html title tag. <br></div></div><br><br><h5>  View </h5><br>  Phalcon provides a fairly convenient template method where a hierarchy exists. <br>  Templates are stored in the <i>/ apps / views /</i> folder <i>.</i> <br>  The root pattern /apps/views/index.phtm is rendered by all controllers, except those where a different path is explicitly specified. <br>  This file may contain the further path of the hierarchy: <br><pre> <code class="hljs django"><span class="xml"></span><span class="hljs-template-variable"><span class="xml"></span><span class="hljs-template-variable">{{ content() }}</span></span><span class="xml"></span><span class="xml"></span></code> </pre><br><br>  I used the built-in template engine syntax.  For other engines, too, have their own counterparts. <br>  This function calls the following pattern, located along the path: <br>  <i>/apps/view/layer/ControllerName.phtml</i> <br><br>  Essentially, setting a specific layout for a particular controller, as I did in my application.  You can also call <b>content () in it</b> , thereby <i>loading the</i> template <i>/apps/views/ControllerName/ActionName.phtml</i> <br><br>  In templates, you can load other templates, replace the pre-set blocks, call custom functions and predefined by the engine, refer to the Models methods. <br>  Only Volt is their young project, so many functions are not in it, but they are planned for the next releases. <br>  Out of the box, support <b>Slim</b> , <b>Smarty</b> , <b>Mustache</b> ... <br><br>  Out of the box there is the possibility of caching compiled templates, only in the version up to 0.6.0 inclusive, there is a bug that resets the cache and returns a blank page. <br><br><h5>  Models </h5><br>  Connection to the database is carried out using PDO.  There are 2 database implementations, an object-oriented path and PHQL, its own pseudo-SQL string handler. <br>  Unfortunately, the first is only suitable for fairly simple requests, and the second will be difficult for those who are used to the first. <br><br><div class="spoiler">  <b class="spoiler_title">Model in the application</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Poll</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Phalcon</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mvc</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Model</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    ,  ,    public public $id; public $gender; public $age; public $read_modern; public $authors; public $genre; public $method; public $timestamp; //    ,      public function getSource() { return 'answers'; } //     public function initialize() { $this-&gt;setConnectionService('db'); } }</span></span></code> </pre><br></div></div><br><br>  In the models, for myself, I did not find anything new and interesting, except that the storage of metadata in different places.  They can also be completely predetermined. <br><br><h5>  disadvantages </h5><br>  I did not fully understand everything that this framework could do, but I still noticed the flaws: <br><ul><li>  I never managed to build dll under windows.  The developers have not responded. </li><li>  On vps could not build version 0.6.1, informed the developers, and could not figure it out. </li><li>  I did not find a way to configure routing for the static file <a href="">example.com/tp/score.json</a> There is no file - a router to the controller and method, otherwise a static file.  I will sort this out. </li><li>  There are very few features in the built-in Volt template engine. </li><li>  I did not find a way to output Flash messages without using sessions, without turning off rendering. </li><li>  Strongly broken documentation on models - 3 separate sections, no structurality. </li><li>  In most cases, it is impossible to use on shared hosting. </li></ul><br>  It is difficult to call it flaws.  Unless there is no direct communication with the developers, except for the issue list on the githabe. <br><br><h3>  Application Functionality </h3><br>  We have an application with the main page, the survey page and the output of the results.  From here work with DB, sending data with filtering, and receiving with minute caching in Apc. <br><br>  Iron: VPS hosting.  Processor x1 500 MHz, OP 256 MB.  The horse is weak. <br>  APC is connected.  The settings are all default.  Server: Nginx - PHP-FPM - PHP - MySQL <br><br>  Synthetic tests: <br>  1. -c50 -d5 -r10 <br>  2. -c100 -d2 -r10 <br>  3. -c300 -d2 -r20 (LA - 0.7) <br>  4. -c400 -d1 -r20 (LA - 0.47) <br>  5. -c800 -d1 -r30 (LA - 1.1) <br>  6. -c1000 -b -r20 (LA - 2) <br>  <i>(-c: competitors, -d: delay before re-call, -r: number of repetitions, -b: call without delay, LA: load average)</i> <br><img src="https://habrastorage.org/storage2/ff3/5ae/7a8/ff35ae7a879c4d0eacb416a64583e4d5.jpg"><br><br>  Siege makes in random order 3 queries, all dynamic.  2 of them with queries to the database, with caching in 1 minute. <br>  With great competition, errors appeared (up to 2% of requests). <br>  Maximum processed 516 requests per second.  Pretty bad.  If you store the requested json in files and update them by cron, you can reduce the load several times. <br><br>  Spent a couple more tests with siege.  -c500 -r10 -d1 -i <br>  1. APC is disabled <br>  2. APC is enabled with a small buffer and stat = 0 <br><img src="http://www.habrastorage.com/images/0000007.jpg" alt="image"><br><br><h4>  Links </h4><br>  <a href="http://phalconphp.com/index">Phalcon website</a> <br>  <a href="https://github.com/phalcon/cphalcon">Phalcon repository</a> <br><br>  <a href="http://xmpl.assorium.ru/">Working example</a> <br>  <a href="https://github.com/mrspartak/xmpl.phalcon">Sample sources on GitHub</a> <br><br><h5>  PS </h5><br>  The survey in the application is not just chosen, please answer honestly;) <br>  And I apologize for the confusion, in one article lay out everything is impossible. <br><br>  11/19/2012 23:00 <br>  Someone decided to query for returning results from the database.  Logs grow in yeast.  LA ranges from 1 to 4. The site is loaded.  I am very happy :) <br>  Ddosyat with <a href="https://github.com/wg/wrk">wrk</a> .  Judging by the logs comes to 60 requests per second.  ip 188.254.105.18 <br>  11/19/2012 11:43 PM <br>  I spam a 0.5GB log and that's enough.  Bye ddos. </div><p>Source: <a href="https://habr.com/ru/post/159217/">https://habr.com/ru/post/159217/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../159199/index.html">How do you feel about open source software?</a></li>
<li><a href="../159201/index.html">NODE.JS + Windows: look inside</a></li>
<li><a href="../159203/index.html">Configure Nginx + LAMP server at home. Part 1: Configuring the frontend - backend</a></li>
<li><a href="../159209/index.html">Overlaying text and images onto an image using MagickWand and GD libraries</a></li>
<li><a href="../159215/index.html">How many portable computer devices do you have (smartphones, tablets, laptops)?</a></li>
<li><a href="../159219/index.html">Knock and open you: smartphones will learn to recognize fingers, nails and knuckles</a></li>
<li><a href="../159223/index.html">Running ServerClub USA</a></li>
<li><a href="../159225/index.html">Start OpenSource Project</a></li>
<li><a href="../159229/index.html">The simplest voice menu on Cisco VoiceXML</a></li>
<li><a href="../159231/index.html">Video review tablet Asus VivoTab RT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>