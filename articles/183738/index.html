<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Repl - a tiny open player for Mac</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago I switched to Mac and began to pick up my software for everyday use. The problem arose with the music player. I tried many players, but ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Repl - a tiny open player for Mac</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/c6e/2a8/5c7/c6e2a85c72df085186969ae0f9bb5124.png" alt="image"><br><br>  Some time ago I switched to Mac and began to pick up my software for everyday use.  The problem arose with the music player.  I tried many players, but none of them did not suit me.  So I decided to write my own.  At the same time, it was interesting for me to try development on Objctive-C for Mac. <br><br>  As a result, I got a player <b>Repl</b> , which means "residental": <br><a name="habracut"></a><br><h4>  Audio Player Requirements </h4><br>  Regarding what should be an audio player, I have the following considerations: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  1. The audio player does not need a graphical interface. </h6><br>  The sound goes in the background, you do not need to look at it, so there is no need to make any graphical interface for the audio player.  Of course, the player needs to be managed somehow, but all control can be reduced to just four buttons - the menu, start / pause, the next and previous track. <br><br>  These buttons fit perfectly in the status bar, where they are always at the click of a mouse.  And at the same time there is no need to switch focus from an open application. <br><br><h6>  2. The audio player does not need its own library. </h6><br>  The organization of the music repository is perfectly done using the file system.  In the overwhelming majority of cases, the music collection has a hierarchical structure (for example, Genre - Artist - Album - Track), which is reproduced without any problems using subfolders of the file system.  Moreover, you can create a more spreading structure from folders than from a limited set of id3 tags. <br><br>  In addition, with conventional files it is much more convenient to perform various manipulations, not related to the actual listening.  For example, it is much easier to directly copy a couple of folders with files than to pre-export from a library, or to look for exactly where the files displayed in the library are stored. <br><br><h6>  3. The audio player does not need playlists. </h6><br>  If there is a well-organized, structured collection of tracks in the file system, then simply open the necessary folders for playback.  You want - open one album, you want - several different albums, you want - a singer with all his albums. <br><br>  No need to make a layer between the files and the player, the player should just play the contents of the disk "as is". <br><br><h4>  Development </h4><br>  Up to this point, I have never programmed for Mac in general and in Objective-C in particular.  So I wrote the player in parallel with the study of Objective-C. <br><br>  As it turned out, there are very few articles on the development of a Mac in Russian on the web.  Native EPL documentation could probably give a lot, but it‚Äôs too voluminous, I find it difficult to read in English.  Most of the information, mainly code samples, I had to draw on English-language resources such as StackOverflow. <br><br>  I knew exactly what the player should be, how it should look and what should have the functionality.  Therefore, I did not have any pondering, design stage.  I just found the steps for each emerging question and then wrote the code.  In the process, I even wrote a few notes in my LiveJournal - how to set up Xcode, how to put an application icon in the status bar, how to read files, etc.  A sort of tutorial for himself. <br><br>  The most difficult issue was sound reproduction.  I started experimenting with the <a href="https://developer.apple.com/library/mac/">NSSound</a> class.  As I understand it, this is a kind of ‚Äústandard‚Äù class for playing sound in Objective-C.  At first, I didn‚Äôt manage to make this class reproduce the sound for a long time, then I couldn‚Äôt catch the end of the track to start the next one.  I started to get the impression that the NSSound class was not intended for use in the player at all, rather, it is needed to play a short sound once, such as a signal about the end of a file upload, or something like that. <br><br>  Then I decided to try to deal with the <a href="https://developer.apple.com/library/mac/">AV Foundation</a> framework, I can write a player on it.  However, it somehow happened that I was prompted by a way to make NSSound make sounds, and I learned to catch the end of the track myself.  And I made a player based on NSSound. <br><br>  Unfortunately, this class eats memory with terrible force.  A certain amount of memory is allocated for playing each new track, and after the end of the track the memory is not released.  Here either I don‚Äôt understand something and just crookedly wrote the code, or NSSound is really intended only for one-time reproduction of one fixed sound.  I would be extremely grateful if those who were knowledgeable in the question told me how to overcome this problem. <br><br>  Other issues, such as reading files or creating menus, did not seem difficult to me.  Well, no more difficult than any other questions arising from the study of new technology.  On the moments of the creation of the player, I also wrote a few notes in LJ. <br><br><h4>  Result </h4><br>  As a result, I wrote for myself an audio player that completely suits me.  And now I want to share the result with everyone. <br><br>  Repl is an open and completely free player.  <a href="https://github.com/ivanych/repl">All source codes are on Gitkhab</a> , in the same place there is a small list of features which I still want to fasten to Replu. <br><br>  I will be any comments and suggestions, as well as pull-requests :) <br><br>  UPD.  I did rewrite the player to AVFoundation. <br>  UPD2.  This article has been in draft for about a year, so some old comments may already be irrelevant. </div><p>Source: <a href="https://habr.com/ru/post/183738/">https://habr.com/ru/post/183738/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../183722/index.html">Designer at the cemetery</a></li>
<li><a href="../183730/index.html">Sony Xperia ZR sales start</a></li>
<li><a href="../183732/index.html">Public discussion of the GOST project on the protection of digitized video data from accidental and deliberate distortion</a></li>
<li><a href="../183734/index.html">Utilities for Windows Azure for every day!</a></li>
<li><a href="../183736/index.html">Free webinar from the series "Fundamentals of modern server architecture"</a></li>
<li><a href="../183744/index.html">Layout: the transition to semantic markup is the main goal of HTML</a></li>
<li><a href="../183746/index.html">What lives mobile islet</a></li>
<li><a href="../183750/index.html">List of 3d printing services</a></li>
<li><a href="../183752/index.html">About modern web design and the ‚ÄúUp‚Äù button</a></li>
<li><a href="../183754/index.html">Some secrets of connecting the web interface 1C 8.2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>