<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The key to all doors in continuous integration - rundeck</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With a large number of servers and virtual machines and even more code in constant deployment, inevitably there are problems in administering this hug...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The key to all doors in continuous integration - rundeck</h1><div class="post__text post__text-html js-mediator-article">  With a large number of servers and virtual machines and even more code in constant deployment, inevitably there are problems in administering this huge farm.  There are many tools to organize continuous integration.  In our list we already have GIT, Jenkins, Chef, Proxmox, Graylog2.  Today we will talk about another handy tool for automating routine tasks using scripts - <a href="http://rundeck.org/">rundeck</a> .  This article is not a detailed manual with examples of configs, but rather reflections on the topic. <a name="habracut"></a><br><br>  Rundeck is an open source project that will allow a system administrator to organize a server of scenarios, automating routine and sample work.  In fact, this is the key to all doors.  It allows you to execute scripts or shell commands on any number of nodes, monitor their execution and deployed to tell the administrator about each action, whether it is successful or not.  Rundeck combines all the tools already used and allows you to organize a transparent interaction between them. <br><br><img src="https://habrastorage.org/storage2/1be/9a4/847/1be9a4847a86949580a239cd62dd15d7.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Features: </h5><br>  - distributed execution of commands and scripts with parameters, <br>  - support of several mechanisms for interacting with the node (ssh by default) and the ability to write your own in the form of plug-ins, <br>  - the script can be described in several steps, <br>  - graphical management interface and console utilities for configuration, <br>  - separation of access rights, integration with LDAP / AD, <br>  - history and audit scenarios and commands <br>  - integration with other continuous integration tools - jenkins, chef, <br>  - API, <br>  - the ability to take all the parameters and settings by url from a remote site. <br><br><h5>  Architecture: </h5><br>  - this is a server and this is java.  Here, all the logic, authentication and access rights for users, console management utilities and web management interface (though not very convenient), <br>  - scenarios, audit results and all logs are stored in the database, <br>  - for interaction with nodes it is used ssh on keys.  No reverse ssh connection node-server is required. <br><br><img src="https://habrastorage.org/storage2/a52/01d/3a6/a5201d3a6227af1e47a7fdf42467d9d7.png"><br><br><h5>  It works almost everywhere: <br></h5>  - linux <br>  - Windows XP, Server and newer, <br>  - Mac OS X 10.4 and newer. <br><br>  Installation and configuration is trivial, all configs are stored in files. <br><br><h5>  Our usage example, integration with chef.  Problems and solutions. <br></h5><br>  A small lyrical digression about <a href="http://www.opscode.com/chef/">chef</a> .  Recipes, nodes, environment - it all works in theory with almost no problems.  Problems begin in real production.  The connectivity of the system components is unexpectedly high, some modules are very dependent on others.  In terms of geo-cluster and distributed data centers, many factors must be taken into account.  Network speed, node access speed from remote geographical points, time zone.  For large audiences, split deploy can be used when a new chip is shown only to certain regions and only at a certain time. <br><br>  In such a reality, chef ceases to save and harms more.  Recipes are getting too much.  Places where you can make more and more.  Parameters, environments and flags to recipes - more than recipes.  We have to get long and voluminous tables, where the scheme of our military actions will be described with a multi-colored felt-tip pen.  Where, where and in what time we are apprehended and why.  Once we still split the wrong place, which led to the understanding that chef also needs to be automated and that they also need to be managed. <br><br><img src="https://habrastorage.org/storage2/416/187/b83/416187b836f40847c9deddd9141105ed.jpg"><br><br>  There was a lot of logic in the recipes to overcome the high coherence of the components.  The node turns off from upstream, prepares its code and starts to deploy.  At some specific step, it is necessary to change the state of another module, for example, to reindex the data for a new code.  After reindexing, we immediately extinguish another node and prepare it for split testing.  At this time, the first node finishes its deployment and passes the final testing, after which it is included in the upstream.  At the same time, the database should already be ready, where a million transactions have been updated.  All this must be done almost simultaneously, while almost simultaneously.  Chef seems to know how, but this is inconvenient and you have to use too much logic in the recipes.  Exchange signals, common attributes, flags and understand at each stage what state we have neighbors and what to do next. <br><br><h5>  What gives us a rundeck. <br></h5>  1. Create a project <br>  2. Import there all the nodes from the chef with all the recipes.  For this there is a <a href="https://github.com/opscode/chef-rundeck">ready tool</a> . <br>  3. We create scenarios that will do everything themselves and see that the connectivity has not broken during the deployment.  They will turn on, turn off, synchronize, kick the chef and report to the administrator about each step they take. <br>  4. Profit. <br><br><img src="https://habrastorage.org/storage2/c2b/270/9a4/c2b2709a457f8b318e1e8b7af0d83663.png"><br><br>  To do this, you need to configure key authentication.  Understand what and how an unprivileged user should do, configure sudo.  Or cram it in chroot.  Well, write a bunch of magic scripts in any language.  Perl, python, bash, php))) You can also turn on script stop after an unsuccessful step.  Scripts can write whatever you like.  It all depends on the imagination and the challenges you face. <br><br>  Rundeck can work in two modes.  Tasks can be performed either in parallel on all nodes at once, or sequentially, finished with one - go to the other. <br>  Node-oriented <br>  1. NodeA step # 1 <br>  2. "step # 2 <br>  3. "step # 3 <br>  4. NodeB step # 1 <br>  5. "step # 2 <br>  6. "step # 3 <br><br>  Step oriented <br>  1. NodeA step # 1 <br>  2. NodeB " <br>  3. NodeA step # 2 <br>  4. NodeB " <br>  5. NodeA step # 1 <br>  6. NodeB " <br><br>  Rundeck can execute commands and scripts with arguments, and take them in turn from a remote url, like the rest of the settings.  Also, using the API, you can manage only those things that are needed without opening the webUI.  In addition, it is not very convenient here. <br><br><img src="https://habrastorage.org/storage2/61a/b79/932/61ab799321e9b04c1db5adf4c5e903a1.png"><br><br>  The big advantage of this solution is that the state of the system as a whole and separately at any time is controlled from one point.  And can be forcibly changed, also from one point.  Without the need for ssh-megaton servers. <br><br>  Of the minuses - another component of the series is monitoring the monitoring of the monitoring and managing the deployment of the deployment of the deployment system.  Complication is almost always bad.  It is necessary to clearly understand the scheme of the entire system and components separately.  Otherwise there is a chance to write such miracles that even dismissal will not be enough punishment.  You also need to clearly and clearly build a security scheme.  And allow the user only what needs to be allowed.  The key to all the doors is convenient, but it doesn‚Äôt seem so that ‚Äúwe are super scientists and have invented a vigorous bomb.  But if she gets into the wrong ruuki ... " <br><br>  Links <br>  - <a href="http://www.opscode.com/chef/">chef</a> <br>  - <a href="http://rundeck.org/">Rundeck</a> </div><p>Source: <a href="https://habr.com/ru/post/162447/">https://habr.com/ru/post/162447/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../162435/index.html">Mozilla released the final release of Firefox OS Simulator 1.0</a></li>
<li><a href="../162439/index.html">TAICHI - another pioneer from ASUS</a></li>
<li><a href="../162441/index.html">Bloggers Meet-up: have a contact or who is who in habra</a></li>
<li><a href="../162443/index.html">Online broadcast: the most feminine Microsoft conference</a></li>
<li><a href="../162445/index.html">Google Maps for iOS</a></li>
<li><a href="../162453/index.html">How expert supply chain optimization systems work in practice</a></li>
<li><a href="../162459/index.html">What will happen to the web in the era of mobile?</a></li>
<li><a href="../162463/index.html">Duke Nukem 3D is free during the day on GOG.COM</a></li>
<li><a href="../162471/index.html">New Cloud Server Control Panel</a></li>
<li><a href="../162473/index.html">Convert Word documents to php using COM (windows + apache)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>