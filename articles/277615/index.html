<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Testing plugins for Apache Cordova</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I'm going to talk about one of the topics related to Apache Cordova , which is practically not covered in runet - how to test your plug-in for Apache ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Testing plugins for Apache Cordova</h1><div class="post__text post__text-html js-mediator-article">  I'm going to talk about one of the topics related to <a href="http://cordova.apache.org/">Apache Cordova</a> , which is practically not covered in runet - how to test your plug-in for Apache Cordova. <br><br>  In this article, we will test only JavaScript code, since such tests are fairly easy to implement and will often be sufficient.  Of course, as a rule, plug-ins also contain native code for each of the supported platforms, which would also be nice to cover with unit-tests, but for now we will leave this question behind the scenes, since this aspect of testing plug-ins is practically not common and there is no toolkit for such testing.  In any case, JavaScript code, as a rule, causes native logic, and therefore our tests will indirectly test and implement for each platform. <br><a name="habracut"></a><br><h2>  Some theory </h2><br>  So, how is testing plugins for Apache Cordova.  First of all, the test architecture consists of two parts: <br><br><ol><li>  Actually tests using this or that library for testing. </li><li>  The so-called test harness, or part of the code responsible for running the tests and generating test results. </li></ol><br>  In the case of plugins, the BDD framework Jasmine, which is quite popular in the JavaScript world, is used as a library.  Accordingly, future tests may look something like this (the excerpt is from tests for <a href="https://github.com/apache/cordova-plugin-device"><code>cordova-plugin-device</code></a> , one of the plug-ins supported by the Apache Cordova community): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"should exist"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ expect(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.device).toBeDefined(); }); it(<span class="hljs-string"><span class="hljs-string">"should contain a platform specification that is a string"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ expect(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.device.platform).toBeDefined(); expect((<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.device.platform)).length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>).toBe(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); }); it(<span class="hljs-string"><span class="hljs-string">"should contain a version specification that is a string"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ expect(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.device.version).toBeDefined(); expect((<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.device.version)).length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>).toBe(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); });</code> </pre> <br>  If everything is quite clear and understandable with the code of tests, in order to run them, it is necessary to do additional manipulations. <br><br>  The easiest way here is to use the <a href="https://github.com/apache/cordova-plugin-test-framework"><code>cordova-plugin-test-framework</code></a> - another plug-in that adds an interface to the application to run tests as a separate page with controls to start, stop and select tests to run, and also loads all announced tests while the application is running and running them. <br><br>  Here is how it looks in work: <br><br><img src="https://habrastorage.org/files/849/5b5/80b/8495b580bfae484d8d7124392e0b0b0a.png" width="300"><img src="https://habrastorage.org/files/1c7/4b2/ee2/1c74b2ee2410412c870d45577939ca40.png" width="300"><br><br>  In addition, the <code>test-framework</code> provides the ability to quickly create so-called.  manual tests - create several buttons on a separate page with a description of the actions associated with clicking on each button and the expected behavior of the application. <br><br>  The plugin's README describes how it works and how to add tests in order for the <code>test-framework</code> pick them up, but it contains some inaccuracies, so I‚Äôll briefly summarize the main points here. <br><br><ol><li>  To declare the tests they need to be allocated in a separate plugin.  The location of the plugin is not critical, but it is often located inside the subfolder <code>/tests</code> main plugin. </li><li>  The tests themselves must be in a module with a name ending in <code>tests</code> , (for example <code>&lt;js-module src="tests/tests.js" name="my.plugin.tests"&gt;</code> ) </li><li>  The module with tests should export two functions: </li></ol><br><pre> <code class="javascript hljs">exports.defineAutoTests = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ }; exports.defineManualTests = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">contentEl, createActionButton</span></span></span><span class="hljs-function">) </span></span>{};</code> </pre> <br>  which will be executed when the module is loaded.  The name of the functions speaks for itself. <br><br><ol><li>  It would also be useful to add the <code>cordova-plugin-test-framework</code> - and perhaps also the plugin to be tested - as a dependency for your tests, so that they are installed automatically along with the tests.  This is done by adding the following elements to <code>tests/plugin.xml</code> : </li></ol><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cordova-plugin-test-framework"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my-awesome-plugin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".."</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><h2>  Create a plug-in framework </h2><br>  So, after everything is prepared for writing, the plug-in framework should look something like this: <br><img src="https://habrastorage.org/files/1d3/7fc/e7b/1d37fce7b4724be3a805f1a56f4598ee.JPG"><br><br><br>  <code>plugin.xml</code> will look like this: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://apache.org/cordova/ns/plugins/1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my-awesome-tests"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0.1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>My Awesome Plugin Tests<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cordova-plugin-test-framework"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my-awesome-plugin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".."</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">js-module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tests.js"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tests"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  <code>tests.js</code> : <br><br><pre> <code class="javascript hljs">exports.defineAutoTests = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// To be done }; exports.defineManualTests = function(content, createActionButton) { // To be done };</span></span></code> </pre> <br>  This can be done manually in your <code>$EDITOR</code> , or you can use <code>plugman</code> , another tool for working with Apache Cordova plugins: <br><br><pre> <code class="hljs sql">npm <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> -g plugman plugman <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-comment"><span class="hljs-comment">--name "My awesome plugin tests" --plugin_id my-awesome-plugin-tests --plugin_version 0.0.1 --path=./tests</span></span></code> </pre> <br>  to generate a plug-in framework and edit files manually. <br><br><h2>  We write automatic tests </h2><br>  We now turn directly to the writing of tests.  Those who are already familiar with BDD and jasmine may skip this section, because  nothing new will be here, and move on to the next. <br><br>  The examples later in this article are based on a simple plugin written in 10 minutes for demonstration purposes.  The plugin code can be found on <a href="https://github.com/vladimir-kotikov/my-awesome-plugin">github</a> . <br><br>  So, first create a test plug framework as described in the previous section and start filling it with tests. <br><br><pre> <code class="javascript hljs">exports.defineAutoTests = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ describe(<span class="hljs-string"><span class="hljs-string">'plugin'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ it(<span class="hljs-string"><span class="hljs-string">'should be exposed as cordova.plugins.MyAwesomePlugin object'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ expect(cordova.plugins.MyAwesomePlugin).toBeDefined(); expect(cordova.require(<span class="hljs-string"><span class="hljs-string">'my-awesome-plugin.MyAwesomePlugin'</span></span>)) .toBe(cordova.plugins.MyAwesomePlugin); }); it(<span class="hljs-string"><span class="hljs-string">'should have corresponding methods defined'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ [<span class="hljs-string"><span class="hljs-string">'coolMethod'</span></span>, <span class="hljs-string"><span class="hljs-string">'logCoolMessage'</span></span>].forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">methodName</span></span></span><span class="hljs-function">) </span></span>{ expect(cordova.plugins.MyAwesomePlugin[methodName]).toBeDefined(); expect(cordova.plugins.MyAwesomePlugin[methodName]).toEqual(jasmine.any(<span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>)); }); }); }); };</code> </pre> <br>  That's enough for now.  Now create a test application and run our tests.  To do this, execute the following commands in the folder with the <em>tested</em> plugin: <br><br><pre> <code class="hljs sql">cordova <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> my-<span class="hljs-keyword"><span class="hljs-keyword">sample</span></span>-app &amp;&amp; cd my-<span class="hljs-keyword"><span class="hljs-keyword">sample</span></span>-app cordova platform <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> android <span class="hljs-comment"><span class="hljs-comment">--save cordova plugin add .. ../tests --save</span></span></code> </pre> <br>  and edit the <code>&lt;content src="index.html" /&gt;</code> element in the <code>config.xml</code> file inside our test application ‚Äî change the value to <code>cdvtests/index.html</code> .  It is necessary that instead of the main start page when you start the application, the plugin page opens and loads the <code>test-framework</code> . <br><br>  Now run the application: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">cordova</span></span> run</code> </pre> <br>  and see the plugin page.  Click "Autotests" and almost immediately see the jasmine report on the successful completion of tests. <br><br><img src="https://habrastorage.org/files/3da/721/f9b/3da721f9bb4046209e61fb9a4060576a.png" width="300"><br><br><br><h2>  Add manual tests </h2><br>  Now, understanding how the <code>test-framework</code> works, you can easily write any number of automated tests for your plugin. <br><br>  With manual tests everything works a little differently.  <code>test-framework</code> assumes that each test has its own button in the interface and a field common to all tests in which you can display your results.  These are the <code>createActionButton</code> and <code>content</code> parameters respectively for the <code>defineManualTests</code> function. <br><br>  <code>createActionButton</code> is a function that creates a button, adds it to the DOM inside the specified element, and performs the specified function when the button is clicked.  Function parameters look like this: <br><br><pre> <code class="hljs actionscript">`<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createActionButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">' '</span></span></span></span><span class="hljs-function"><span class="hljs-params">, _, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'_'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{...}`</code> </pre> <br>  <code>content</code> is a container on the page, inside which you can put information about the test and describe the verification process for the tester. <br><br>  For example, add one manual test: <br><br><pre> <code class="javascript hljs">exports.defineManualTests = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">contentEl, createActionButton</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> show_preferences_test = <span class="hljs-string"><span class="hljs-string">'&lt;h3&gt;Press "Open preferences" button to show preferences pane&lt;/h3&gt;'</span></span> + <span class="hljs-string"><span class="hljs-string">'&lt;div id="open_prefs"&gt;&lt;/div&gt;'</span></span> + <span class="hljs-string"><span class="hljs-string">'Expected result: A "Preferences" box should appear'</span></span>; contentEl.innerHTML = <span class="hljs-string"><span class="hljs-string">'&lt;div id="info"&gt;&lt;/div&gt;'</span></span> + show_preferences_test; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> log = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'info'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logMessage = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logLine = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'div'</span></span>); logLine.innerHTML = message; log.appendChild(logLine); }; createActionButton(<span class="hljs-string"><span class="hljs-string">'Open preferences'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ log.innerHTML = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-comment"><span class="hljs-comment">// cleanup log area plugins.appPreferences.show(function(result) { logMessage(result); }, function(error) { logMessage(error); }); }, "open_prefs"); };</span></span></code> </pre> <br>  Now we need to rebuild the application with the updated plugin.  To do this, simply remove the plugin from the application and try to start the application. <br><br><pre> <code class="hljs perl">cordova plugin rm <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-awesome-plugin-tests &amp;&amp; cordova run</code> </pre> <br>  The <code>run</code> command before building the application will restore the deleted plugin from its original location along with the updated files, and all changes will be included in the application. <br><br><h2>  We run tests on CI </h2><br>  Rebuilding the application in order to run the tests again is a rather routine exercise, which of course you want to do automatically.  Instead of inventing your own bike, we use the ready-made solution - <a href="https://github.com/purplecabbage/cordova-paramedic"><code>cordova-paramedic</code></a> .  This application is written specifically to automate the launch of tests for plug-ins including.  and for CI.  Here is what it does: <br><br><ul><li>  creates a new application in a temporary folder </li><li>  adds to the application are required to run tests plugins </li><li>  changes the application start page </li><li>  starts a local server to communicate with the application and process the results </li><li>  displays the result of running the tests on the console </li><li>  completes with the appropriate code depending on whether all the tests passed successfully or not. </li></ul><br>  To start using <code>paramedic</code> , install it and add our plugin to the <code>package.json</code> : <br><br><pre> <code class="hljs sql">npm <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> cordova-paramedic <span class="hljs-comment"><span class="hljs-comment">--save-dev</span></span></code> </pre> <br>  and add a couple of commands to run tests for iOS and Android. <br><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { ... <span class="hljs-string"><span class="hljs-string">"test-android"</span></span>: <span class="hljs-string"><span class="hljs-string">"cordova-paramedic --platform android --plugin ./ --verbose"</span></span>, <span class="hljs-string"><span class="hljs-string">"test-ios"</span></span>: <span class="hljs-string"><span class="hljs-string">"cordova-paramedic --platform ios --plugin ./ --verbose"</span></span> },</code> </pre> <br>  Everything.  Now, instead of assembling the application manually, edit its <code>config.xml</code> , run it and then watch how the points and crosses of the passed and fallen tests appear, simply run the corresponding script, for example for Android: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">npm</span></span> run test-android</code> </pre> <br>  And after some time we get the test results on the console: <br><br><pre> <code class="hljs sql">... Results: ran 2 specs <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> failures <span class="hljs-keyword"><span class="hljs-keyword">result</span></span> code <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> {<span class="hljs-string"><span class="hljs-string">"mobilespec"</span></span>:{<span class="hljs-string"><span class="hljs-string">"specs"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"failures"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">"results"</span></span>:[]},<span class="hljs-string"><span class="hljs-string">"platform"</span></span>:<span class="hljs-string"><span class="hljs-string">"Desktop"</span></span>,<span class="hljs-string"><span class="hljs-string">"version"</span></span>:<span class="hljs-string"><span class="hljs-string">"5.1.0"</span></span>,<span class="hljs-string"><span class="hljs-string">"timestamp"</span></span>:<span class="hljs-number"><span class="hljs-number">1455530481</span></span>,<span class="hljs-string"><span class="hljs-string">"model"</span></span>:<span class="hljs-string"><span class="hljs-string">"none"</span></span>}</code> </pre> <br>  Now it becomes very easy to run tests on a CI machine.  Take for example the Travis CI and Circle CI: <br><br> <code>.travis.yml</code> <br> <br><pre> <code class="hljs sql">language: objective-c <span class="hljs-keyword"><span class="hljs-keyword">install</span></span>: - npm <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> script: - npm run <span class="hljs-keyword"><span class="hljs-keyword">test</span></span>-ios</code> </pre> <br> <code>circle.yml</code> <br> <br><pre> <code class="hljs pgsql">test: pre: - emulator -avd circleci-android21 -<span class="hljs-keyword"><span class="hljs-keyword">no</span></span>-audio -<span class="hljs-keyword"><span class="hljs-keyword">no</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">window</span></span>: background: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> parallel: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> - <span class="hljs-type"><span class="hljs-type">circle</span></span>-android wait-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-boot override: - npm run test-android</code> </pre> <br>  Then we go to the control panel of the corresponding service, turn on the integration with GitHub and enjoy: <br><br><img src="https://habrastorage.org/files/422/757/600/4227576009d14b1691429b74d5799db5.JPG" width="300"><br><br><br><h2>  Conclusion </h2><br>  So, now we have a plug-in covered with automatic tests, we are able to create and run a test application in just one or two lines in the terminal, and we know the status of the code that is updated per-commit. <br><br>  Finally, once again I will provide a link to the demo plugin: <a href="https://github.com/vladimir-kotikov/my-awesome-plugin">https://github.com/vladimir-kotikov/my-awesome-plugin</a> .  You can see the stages of adding tests by the commit history. <br><br>  Have a good test! <br></div><p>Source: <a href="https://habr.com/ru/post/277615/">https://habr.com/ru/post/277615/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277599/index.html">Hello, World! On FPGA. Blink LED</a></li>
<li><a href="../277601/index.html">How we automate testing with release management - Part 1</a></li>
<li><a href="../277603/index.html">The rules of good tone when writing a plugin on jQuery</a></li>
<li><a href="../277605/index.html">Nuances of developing a plugin for Unity</a></li>
<li><a href="../277609/index.html">What to replace Cisco? Import Substitution Access Switches</a></li>
<li><a href="../277617/index.html">Do not miss the chance to get on // Build: develop or update the UWP application and participate in Race to Build 2016</a></li>
<li><a href="../277625/index.html">Blockchain application stack</a></li>
<li><a href="../277629/index.html">Write code that is easy to remove and not add</a></li>
<li><a href="../277631/index.html">Kilometers of logs and recovery of databases on MS SQL</a></li>
<li><a href="../277635/index.html">Get websocket data using swift and populate UITableView (node.js server)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>