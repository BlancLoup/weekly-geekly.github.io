<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Subproject allocation in a separate repository on github</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I was faced with the task of transferring a project folder from one repository to another on github. It sounds primitive, but if we consider...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Subproject allocation in a separate repository on github</h1><div class="post__text post__text-html js-mediator-article"><p>  Recently, I was faced with the task of transferring a project folder from one repository to another on github.  It sounds primitive, but if we consider what is given and what needs to be obtained, some nuances may arise. </p><br><p>  So, what is given: </p><br><ul><li>  There is a large repository containing many folders.  Each folder is a separate project. </li></ul><br><p>  What needs to be done: </p><br><ul><li>  Transfer one of the folders to a separate repository with saving its commit history. </li></ul><br><p>  In theory, one could simply copy the entire repository with all its contents to a new place, and then simply delete those folders that are not needed.  But this method is rather non-optimal and I didn‚Äôt particularly like it, so I decided to do otherwise. </p><br><p>  I used the standard filter-branch git one.  I took the following articles as a basis: </p><br><ul><li>  <a href="http://gbayer.com/development/moving-files-from-one-git-repository-to-another-preserving-history/">Moving Files from One Git Repository to Another, Preserving History</a> </li><li>  <a href="https://help.github.com/articles/splitting-a-subfolder-out-into-a-new-repository/">Splitting a subfolder out into a new repository</a> </li></ul><br><p>  In this post I want to adapt the process a little for better perception. <a name="habracut"></a></p><br><p> Suppose, for example, that our repository is called <code>movement-example</code> , and the only folder that we want to transfer to a separate repository is <code>folder-to-move</code> .  Then the steps that need to be done to prepare the transfer are as follows: </p><br><ol><li> <code>git clone git@github.com:&lt;user_or_organization&gt;/movement-example.git</code> <br>  It is better to make a new clone of the repository, even if you already have it downloaded.  Better yet, make a clone from the local repository: <code>git clone &lt;path-to-movement-example&gt;</code> is much faster (thanks to <a href="https://habrahabr.ru/users/zyxi/" class="user_link">ZyXI</a> for the hint). </li><li> <code>cd movement-example</code> </li> <li> <code>git remote rm origin</code> <br>  This is exactly the moment for which we made a new clone - now we are not afraid to break the original repository. </li><li> <code>git filter-branch --subdirectory-filter folder-to-move -- --all</code> <br>  After performing this step, only the content of the <code>folder-to-move</code> will remain in your local repository, and the folder itself will no longer exist - all files contained in it now lie in the current directory (in <code>movement_example</code> ). </li><li> <code>mkdir folder-to-move</code> <br> <code>mv * folder-to-move</code> <br>  This is an optional step - if you want to have all the files inside the same folder as before, and not in the root of the new repository. </li><li> <code>git add .</code> </li> <li> <code>git commit -m ‚ÄúPreparing to extract folder‚Äù</code> </li> </ol><br><p>  The first part is ready, and the second is to make the actual transfer.  Suppose the new repository is simply called <code>new-repo</code> , then the necessary steps are as follows: </p><br><ol><li> <code>git clone git@github.com:&lt;user_or_organization&gt;/new-repo.git</code> <br>  We clone a new repository for ourselves, if, of course, we still have not done so. </li><li> <code>cd new-repo</code> </li> <li> <code>git remote add old-repo-branch &lt;path-to-movement-example-folder&gt;</code> <br>  Add a new remote.  If your new-repo and movement-example folders are at the same level in the file system, then the <code>path-to-movement-example-folder</code> would look like <code>../movement-example</code> </li><li> <code>git pull old-repo-branch master</code> <br>  After completing this step, the goal will be practically achieved - you will already have all the <code>folder-to-move</code> content in the local <code>new-repo</code> repository, all you have to do is push.  But first you need to do something else. </li><li> <code>git remote rm old-repo-branch</code> <br>  You don't need a second remote anymore, right? </li><li> <code>git push origin master</code> </li> </ol><br><p>  Done!  Now, in your new repository there is only a folder of interest along with the entire history of commits.  For example, immediately after the above steps, I saw the following in my new repository: <br><img src="https://habrastorage.org/files/285/9ba/f32/2859baf32d184c0bb1b5fdd3244a2219.png"></p><br><p>  810 commits! </p><br><p>  By the way, you will see only 1 brunch - <code>master</code> .  The procedure transfers only one brunch at a time.  If you want to transfer <code>dev</code> , then you just need to do <code>git checkout dev</code> and <code>git pull origin dev</code> after the second step in both steps. </p><br><p>  If you need to transfer all 50 (60? 100?) Brunch, then this solution will not be successful because of too much routine work.  But I think that for transfer, you just need to save the master and dev branches, because all the feature branches should already be in dev, and you will branch out new branches in the new repository. </p><br><h5 id="update">  UPDATE </h5><br><p>  Thanks <a href="https://habrahabr.ru/users/fstep/" class="user_link">fstep</a> for the hint.  You can simply use another guitar utility, the <code>subtree</code> .  All you need is nothing: </p><br><ol><li> <code>git clone &lt;path-to-movement-example&gt;</code> </li> <li> <code>git remote rm origin</code> <br>  Please note - these 2 steps are optional, you can perform the following steps directly from your "combat" local repository.  Having a clone with a remote origin is my personal preference to not even have a chance to somehow break the original repository. </li><li> <code>git subtree split --prefix folder-to-move master</code> <br>  Or any other brunch, except <code>master</code> .  This command will calculate the values ‚Äã‚Äãfor a long time, but in the end it will return you something like <code>253f8a5edd9a4dbbb1d72e5837243e93c92ebfcd</code> </li><li> <code>git push git@github.com:&lt;user_or_organization&gt;/new-repo.git 253f8a5edd9a4dbbb1d72e5837243e93c92ebfcd:master --force</code> <br>  Here we push with the <code>--force</code> flag, because <code>new-repo</code> will probably have at least a readme file that you (probably) don‚Äôt want to pull. </li></ol><br><p>  Well, if <code>new-repo</code> is completely fresh and does not even contain the readme file - in other words, it does not contain any files at all, then it is still easier: </p><br><p> <code>git subtree push --prefix folder-to-move git@github.com:&lt;user_or_organization&gt;/new-repo.git master</code> </p> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/326132/">https://habr.com/ru/post/326132/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326122/index.html">Test Lossless Image Optimizers (PNG and JPG)</a></li>
<li><a href="../326124/index.html">One-dimensional linear regression, SQL and machine learning</a></li>
<li><a href="../326126/index.html">Lectures Tehnotreka. Designing a DBMS (Fall 2016)</a></li>
<li><a href="../326128/index.html">Protection of confidential data: the main features of IBM Security Guardium</a></li>
<li><a href="../326130/index.html">Agile everyone has his own: how to go with the flow, manage projects and not to suffer</a></li>
<li><a href="../326134/index.html">Spring semester online courses from Academic University and CS Center</a></li>
<li><a href="../326136/index.html">PostCSS Hamster Framework - a tool that will make your life easier with the imposition. Typography. Vertical rhythm</a></li>
<li><a href="../326138/index.html">Pthreads: POSIX Threads</a></li>
<li><a href="../326142/index.html">JPoint 2017: remember everything</a></li>
<li><a href="../326146/index.html">How it works in the java world. Thread pool</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>