<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tetris for DCPU-16</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As already mentioned on Habr√© , the developer of widely known in narrow circles of Minecraft 'and Marcus ‚ÄúNotch‚Äù Persson is currently busy developing ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tetris for DCPU-16</h1><div class="post__text post__text-html js-mediator-article">  As already <a href="http://habrahabr.ru/post/141417/">mentioned on Habr√©</a> , the developer of widely known in narrow circles of <a href="http://minecraft.net/">Minecraft</a> 'and <b>Marcus ‚ÄúNotch‚Äù Persson</b> is currently busy developing a new game, which will take place in space in 281,474,976,712,644. <br><br>  Like Minecraft, the game will be nonstandard: the main "chip" is a fully emulated processor, under which spacecraft will surf the Bolshoi ... er, the Universe.  Since the characters of the game in the year <b>0x10 <sup>C</sup></b> (the game, in fact, is called so) got straight from 1980, the DCPU-16 processor in its characteristics roughly corresponds to that era: 128 kilobytes of RAM, 100 kilohertz, a simple set of commands. <br><br>  Despite the fact that the game is still in a very early stage of development, the specification of the processor is already <a href="http://0x10c.com/doc/dcpu-16.txt">available for review</a> - and communities are already being formed, whose members are developing a lot of interesting pieces for a nonexistent platform.  Your humble servant is among these people, and in this post I want to talk about one of these things: the implementation of <b>Tetris for DCPU-16</b> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      (and immediately a disclaimer: the music in the video is imposed separately for artistic, so to speak, expressiveness; DCPU doesn‚Äôt allow sound output, so far) <br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/ruULddKR_9o%3Ffeature%3Doembed&amp;xid=25657,15700023,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhhO8h1grsnoCYgE6NEt8V0toEm5UA" frameborder="0" allowfullscreen=""></iframe><br><a name="habracut"></a><br><h3>  Details about the "internals" DCPU-16 </h3><br>  So what does the specification say?  The fact that the processor will be 16-bit (you can forget about the bytes - only double-byte words are addressed), we have 12 registers (3 of them are <b>SP</b> , <b>PC</b> and <b>O</b> are of the service type), exactly 65536 words of memory (that is, 128 kilobytes), 15 basic and 1 additional opcode, instructions take from 1 to 3 words, all this will be emulated with a frequency of about 100 thousand cycles per second (the number of cycles depends on the opcode and whether ‚Äúbig literals‚Äù are used as operands ). <br>  Basic opcodes are simple - assignment, arithmetic (fractional numbers are represented only with fixed accuracy, 16 bits after the comma - they fall into the overflow register, <b>O</b> ), bit operations, condition checks.  No transitions, note: they are done by directly assigning values ‚Äã‚Äãto the <b>PC</b> register (as you might guess, it indicates the instruction that will be executed next).  Condition checks simply skip the next instruction if the condition is not met ‚Äî conditional jumps are made by combining the check and the regular jump.  The only non-base opcode is to call subprocedures, puts the return address on the top of the stack and makes the transition to the specified address. <br><br>  With operands it is interesting: in addition to regular registers, memory at a given address, memory at an address + register value and directly specified values, there are special values <b>POP</b> , <b>PEEK</b> and <b>PUSH</b> (yes - these are not operations, but operands!), Which firstly allow you to access to the top of the stack (generally speaking, it is impossible to directly access the memory pointed to by the service register), and, secondly, to reduce or increase the <b>SP</b> value by one.  As a result, using <b>SET PUSH, X,</b> you can put the value in the stack, <b>SET X, POP</b> - pick it up from there, and <b>SET X, PEEK</b> - copy the value without taking it from the stack.  True, strange constructions like <b>SET X, PUSH</b> ;  <b>SET POP, X</b> and even <b>SET POP, PUSH</b> .  To understand what they are doing is no longer very trivial. <br><br>  Finally, about the memory.  The stack mentioned above has already been mentioned - since during initialization all registers are 0, it starts with 0xFFFF (the first <b>PUSH will</b> first decrease <b>SP</b> by one, and then write down the value) and grows down.  In addition, it became known that the video buffer is located at 0x8000 address - the display contains 12 lines of 32 characters each, they are stored in memory line by line, each word corresponds to one character.  However, unfortunately, only 7 low bits of 16 bits went to the symbol code (it will be necessary to distort very much to provide Cyrillic support) - the 8th bit is responsible for the blinking, the next 4 - for the background color and the oldest 4 - for the color of the symbol.  Colors 16, used <a href="http://ru.wikipedia.org/wiki/CGA">palette CGA (RGBI)</a> . <br><br> <a href=""><img src="https://habrastorage.org/storage2/403/3ca/a6f/4033caa6f12783b9e594a512583017a1.jpg"></a> <br><br>  In addition to accessing the display, there is also the ability to read characters from the keyboard: this is the purpose of the circular buffer at 0x9000, 16 bytes in size.  In order for the buffer to work, you need to store a pointer to the next character ‚Äî as soon as the value in memory becomes nonzero, it must be counted, write 0 and increment the pointer to 1 (when reaching 0x9010, reset it to 0x9000).  Notch gave <a href="http://pastebin.com/raw.php%3Fi%3DaJSkRMyC">his own example</a> illustrating all this. <br><br>  Finally, according to the latest data, you can set your own character set for display - it is located at 0x8180 (immediately after the video buffer), each word describes one letter of 4x8 pixels, each byte corresponds to one column. <br><br><h3>  Javascript emulator </h3><br>  The DCPU-16 device is pretty straightforward, and its performance is low - so I decided to write an online <b>JavaScript</b> emulator for it.  Of course, in this idea I was not alone - now there is already a huge pile of such emulators, but what kind of abnormal programmer did it stop? <br><br>  The result was such a thing: <br> <a href="http://dcpu.ru/"><img src="https://habrastorage.org/getpro/habr/post_images/ffb/098/af5/ffb098af53b2edfe16eeb9044dff803a.png"></a> <br>  <a href="http://dcpu.ru/">http://dcpu.ru/</a> <br><br>  Actually, this is not just an emulator, but a ‚Äúthree in one‚Äù shampoo - an assembler, an emulator, and in the appendage a disassembler.  Able to almost all of the above, except for its own table of characters.  But when debugging, the current line is beautifully highlighted, and when assembling, it is able to do such a funny thing as the calculation of expressions.  I think to fasten more macros, in the assembler from Notch it is. <br><br>  Well, not about him.  I finish the lyrical digressions, turn to the topic of the article. <br><br><h3>  Tetris </h3><br>  As everyone knows, <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D1%2582%25D1%2580%25D0%25B8%25D1%2581">Tetris</a> was invented by Alexey Pajitnov in 1984.  The creator is our compatriot, the game was created practically for computers of the same level as DCPU-16 - what could be better suited for implementation? <br><br>  Briefly about the code.  I didn‚Äôt know about the possibility of redefining characters, so I decided to draw with ordinary characters: two filled spaces in a row - one cell.  Each figure (in any of 4 turns) can be inscribed in a square of 4x4 cells, all of the figures are 7 - a total of 28 states of 16 words each (I decided to store directly the codes that will be recorded on the screen, but double them only when outputting).  All this is piled up at the end of the program. <br><br>  Wrote several sub-procedures.  For example, to display lines on the screen (there are few of them, ‚ÄúScore:‚Äù, ‚ÄúLevel:‚Äù, ‚ÄúGAME OVER‚Äù), to read a character from the keyboard, or here‚Äôs a pseudo-random number generator: <br><br><pre><code class="hljs pgsql">:next_rand ; takes <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> arguments, <span class="hljs-keyword"><span class="hljs-keyword">returns</span></span> random word <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> A MUL [rand_seed], <span class="hljs-number"><span class="hljs-number">10061</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> [rand_seed], <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> A, [rand_seed] <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, POP :rand_seed DAT <span class="hljs-number"><span class="hljs-number">0xC00F</span></span></code> </pre> <br>  In general, the standard implementation of the <a href="http://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B8%25D0%25BD%25D0%25B5%25D0%25B9%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BA%25D0%25BE%25D0%25BD%25D0%25B3%25D1%2580%25D1%2583%25D1%258D%25D0%25BD%25D1%2582%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BC%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4">linear congruential method (LCG)</a> .  The prime number 10061 took at random - ready to accept the amendment, if someone has the best candidate.  In any case, we don‚Äôt have any cryptography here, we don‚Äôt need to take care of special ‚Äúrandomness‚Äù.  It seems to throw out different figures, and thank God.  The initial rand_seed seed is initialized as follows: when started in a loop, the value increases until the user presses a key.  They say that in the old games "Press any key" was also for this purpose, by the way. <br><br>  Finally, the most cunning sub-procedure that can erase a figure from the screen, and draw it, and check the possibility of its placement: <br><br><pre> <code class="hljs dos">:show_cur_piece ; display/clear/check current piece (A=<span class="hljs-number"><span class="hljs-number">0</span></span> - clear, A=<span class="hljs-number"><span class="hljs-number">1</span></span> - display, A=<span class="hljs-number"><span class="hljs-number">2</span></span> - check), <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> A=<span class="hljs-number"><span class="hljs-number">2</span></span> doesn't actually place anything, return B=<span class="hljs-number"><span class="hljs-number">1</span></span> is position is valid, <span class="hljs-number"><span class="hljs-number">0</span></span> otherwise <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> X, [piece_pos] ; place block <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> [X] (display) <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> Y, [cur_piece] ; ...from [Y] (pieces array) SHL Y, <span class="hljs-number"><span class="hljs-number">2</span></span> BOR Y, [cur_rot] SHL Y, <span class="hljs-number"><span class="hljs-number">4</span></span> ADD Y, pieces <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> I, <span class="hljs-number"><span class="hljs-number">0</span></span> ; index :piece_cyc1 <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> B, [Y] IFE B, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PC, piece_jmp1 IFG <span class="hljs-number"><span class="hljs-number">2</span></span>, A <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PC, piece_jmp2 IFG X, <span class="hljs-number"><span class="hljs-number">0</span></span>x8000 + <span class="hljs-number"><span class="hljs-number">32</span></span>*<span class="hljs-number"><span class="hljs-number">12</span></span> ADD PC, <span class="hljs-number"><span class="hljs-number">3</span></span> IFE [X], <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PC, piece_jmp1 <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> B, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PC, POP :piece_jmp2 IFE A, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> B, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> [X], B <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> [X + <span class="hljs-number"><span class="hljs-number">1</span></span>], B :piece_jmp1 ADD I, <span class="hljs-number"><span class="hljs-number">1</span></span> ADD X, <span class="hljs-number"><span class="hljs-number">2</span></span> ADD Y, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> B, <span class="hljs-number"><span class="hljs-number">1</span></span> IFE I, <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PC, POP IFB I, <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PC, piece_cyc1 ADD X, <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PC, piece_cyc1</code> </pre> <br>  As you can see, all checks are done directly ‚Äúon the spot‚Äù - in the video buffer.  This, of course, has a small negative effect - when the figure is displaced, you must first erase it, then try to put it in a new place and, if it could not be done, draw it again on the old one.  Due to erasing, a slight flashing occurs, but the speed of the work is sufficient to make it inconspicuous.  Actually, before the figure moves one cell down, it has time to work about 2500 iterations (each one checks the presence of a key in the buffer and the figure rotates or shifts left / right) at the first level, 2000 at the second, 1500 at the third - and so on. <br><br>  I mentioned the most nested cycle, but it is wrapped in two more - if the figure can no longer be moved down by gravity, a check is made for the presence of completely filled rows, they are destroyed, a new figure is selected (in fact, it is selected in advance and drawn in the ‚ÄúNext:‚Äù field, and here the choice is made ‚Äúone step ahead‚Äù) and rushes into the glass from above.  If you fail to quit, the outer loop is completed, and a beautiful flashing ‚ÄúGame Over‚Äù is drawn. <br><br>  Verification of the filled rows comes from the bottom up, two pointers to the current ‚Äúwriteable‚Äù and current ‚Äúreadable‚Äù lines are used.  First, the ‚Äúreadable‚Äù rises until it reaches the very top or meets the empty row.  Then, from the ‚Äúreadable‚Äù line, the cells are copied into the ‚Äúwriteable‚Äù line and both go up one line higher.  A pair of optimizations: copying does not occur if both pointers correspond to one line, attempts to raise the ‚Äúreadable‚Äù line are stopped if it is already at the very top or if the number of already deleted lines equals 4 (it is impossible to destroy at a time more).  As a result, it works pretty fast, you can live. <br><br><pre> <code class="hljs pgsql">:scan_lines ; <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> complete lines, remove them <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">move</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> other down; <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> score &amp; <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> A, <span class="hljs-number"><span class="hljs-number">0x8000</span></span> + <span class="hljs-number"><span class="hljs-number">32</span></span>*<span class="hljs-number"><span class="hljs-number">11</span></span> + <span class="hljs-number"><span class="hljs-number">11</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> next <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> fill <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> B, A ; <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> next <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> J, <span class="hljs-number"><span class="hljs-number">0</span></span> ; num <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> lines skipped :scan_cyc2 <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> I, <span class="hljs-number"><span class="hljs-number">0</span></span> ; horizontal <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> X, B :scan_cyc1 IFE [X], <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, scan_jmp1 <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> X, <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> I, <span class="hljs-number"><span class="hljs-number">1</span></span> IFG <span class="hljs-number"><span class="hljs-number">10</span></span>, I <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, scan_cyc1 <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> J, <span class="hljs-number"><span class="hljs-number">1</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> gaps <span class="hljs-built_in"><span class="hljs-built_in">found</span></span>, increase num <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> complete <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> SUB B, <span class="hljs-number"><span class="hljs-number">32</span></span> IFE J, <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, scan_jmp1 IFG B, <span class="hljs-number"><span class="hljs-number">0x8000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, scan_cyc2 :scan_jmp1 ; <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> a gap, <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> more gaps can be <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> IFE A, B <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, scan_jmp2 ; <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> need <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">move</span></span> anything, <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> I, <span class="hljs-number"><span class="hljs-number">0</span></span> :scan_cyc3 <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> [A], [B] <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> I, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> A, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> B, <span class="hljs-number"><span class="hljs-number">1</span></span> IFG <span class="hljs-number"><span class="hljs-number">20</span></span>, I <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, scan_cyc3 SUB A, <span class="hljs-number"><span class="hljs-number">20</span></span> SUB B, <span class="hljs-number"><span class="hljs-number">20</span></span> :scan_jmp2 SUB A, <span class="hljs-number"><span class="hljs-number">32</span></span> IFG <span class="hljs-number"><span class="hljs-number">0x8000</span></span>, A <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, scan_end SUB B, <span class="hljs-number"><span class="hljs-number">32</span></span> IFE J, <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, scan_jmp1 IFG <span class="hljs-number"><span class="hljs-number">0x8000</span></span>, B <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, scan_jmp1 <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, scan_cyc2 :scan_end IFE J, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, POP <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> [lines], J <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> J, [lines_score + J] MUL J, [<span class="hljs-keyword"><span class="hljs-keyword">level</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> [score], J JSR update_score IFG <span class="hljs-number"><span class="hljs-number">10</span></span>, [lines] <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, POP <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> [lines], <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">level</span></span>], <span class="hljs-number"><span class="hljs-number">1</span></span> JSR update_level <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PC, POP</code> </pre> <br><br>  Fully available source code <a href="http://www.dcpu16apps.com/Home/App/33">here</a> to launch it - find the button " <b>Run in the emulator</b> ", and already there - the button " <b>Run</b> ". <br><br><h3>  Links </h3><br><ul><li>  <a href="http://0x10c.com/">Official game site</a> </li><li>  <a href="http://0x10c.com/doc/dcpu-16.txt">Official DCPU-16 Specification</a> </li><li>  <a href="http://www.reddit.com/r/0x10c/">Podreddit dedicated to the game 0x10 <sup>C</sup></a> , and also <a href="http://www.reddit.com/r/dcpu16/">dedicated to the DCPU-16</a> </li><li>  <a href="http://0x10cforum.com/">The official forum dedicated to the game</a> </li><li>  <a href="http://wiki0x10c.com/">Wiki dedicated to the game</a> </li><li>  <a href="http://0x10cwiki.com/wiki/Developer_Tools">Catalog of assemblers, emulators, disassemblers and other tools</a> </li><li>  <a href="http://www.dcpu16apps.com/">Catalog of programs for DCPU-16</a> </li><li>  <a href="http://dcpu.ru/">My emulator / assembler / disassembler DCPU-16</a> </li><li>  <a href="http://www.dcpu16apps.com/Home/App/33">The source of my "Tetris" for DCPU-16</a> </li></ul><br><br>  PS Yes, I can not help but brag - Notch himself <a href="http://www.reddit.com/r/0x10c/comments/s6ul7/i_am_as_a_russian_especially_proud_to_present_you/c4brh16">positively assessed the</a> result of all the above efforts :) </div><p>Source: <a href="https://habr.com/ru/post/142539/">https://habr.com/ru/post/142539/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142528/index.html">Simple WEB-quest for non-IT students</a></li>
<li><a href="../142530/index.html">Practical optimization and scalability of MySQL InnoDB on large amounts of data</a></li>
<li><a href="../142533/index.html">IT (and not only) life in Brazil 2</a></li>
<li><a href="../142534/index.html">Shadow Triangles on CSS</a></li>
<li><a href="../142537/index.html">Podcast "Notes on Qt" s01e02</a></li>
<li><a href="../142540/index.html">The power consumption of game consoles is constantly growing - data from a single study</a></li>
<li><a href="../142541/index.html">Symfony 2: Useful Libraries and Bands</a></li>
<li><a href="../142543/index.html">Twitter announces sponsorship of the Apache Software Foundation</a></li>
<li><a href="../142546/index.html">Scala Days 2012</a></li>
<li><a href="../142553/index.html">Game Input / Output or have fun while waiting for Google IO 2012</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>