<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Playfully bash'im</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As I wrote the game on bash'e. 



 The impatient can watch / play by downloading the game here , and Ubuntu 18.04 users can install the game with apt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Playfully bash'im</h1><div class="post__text post__text-html js-mediator-article">  As I wrote the game on bash'e. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ed/c0c/1fe/4edc0c1fe18d8841e72feb454090673e.png" alt="image"><br><br>  The impatient can watch / play by downloading the game <a href="https://github.com/vaniacer/piu-piu-SH">here</a> , and Ubuntu 18.04 users can install the game with apt: <br><pre><code class="bash hljs">sudo apt install -y piu-piu</code> </pre> <br>  Then a short story about the process of creating and analyzing interesting (in my opinion) places. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">gif with gameplay</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/a3a/79d/774/a3a79d774d534a9ae0c94db3ec2d21c7.gif" alt="image"><br></div></div><br>  The idea, as usual, came suddenly.  Once I ‚Äúpainted‚Äù (I inserted control codes into text messages to change the color of the text / background), I repeated my own script and thought: ‚ÄúHmm, but this could make a game!‚Äù 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      By the way, I use this <a href="https://github.com/vaniacer/bash_color">tablet</a> for coloring: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#----------------------------------------------------------------------+ #Color picker, usage: printf ${BLD}${CUR}${RED}${BBLU}"Some text"${DEF}| #---------------------------+--------------------------------+---------+ # Text color | Background color | | #------------+--------------+--------------+-----------------+ | # Base |Lighter\Darker| Base | Lighter\Darker | | #------------+--------------+--------------+-----------------+ | RED='\e[31m'; LRED='\e[91m'; BRED='\e[41m'; BLRED='\e[101m' #| Red | GRN='\e[32m'; LGRN='\e[92m'; BGRN='\e[42m'; BLGRN='\e[102m' #| Green | YLW='\e[33m'; LYLW='\e[93m'; BYLW='\e[43m'; BLYLW='\e[103m' #| Yellow | BLU='\e[34m'; LBLU='\e[94m'; BBLU='\e[44m'; BLBLU='\e[104m' #| Blue | MGN='\e[35m'; LMGN='\e[95m'; BMGN='\e[45m'; BLMGN='\e[105m' #| Magenta | CYN='\e[36m'; LCYN='\e[96m'; BCYN='\e[46m'; BLCYN='\e[106m' #| Cyan | GRY='\e[37m'; DGRY='\e[90m'; BGRY='\e[47m'; BDGRY='\e[100m' #| Gray | #------------------------------------------------------------+---------+ # Effects | #----------------------------------------------------------------------+ DEF='\e[0m' # Default color and effects | BLD='\e[1m' # Bold\brighter | DIM='\e[2m' # Dim\darker | CUR='\e[3m' # Italic font | UND='\e[4m' # Underline | INV='\e[7m' # Inverted | COF='\e[?25l' # Cursor Off | CON='\e[?25h' # Cursor On | #----------------------------------------------------------------------+ # Text positioning, usage: XY 10 10 "Some text" | XY () { printf "\e[${2};${1}H${3}"; } # | #----------------------------------------------------------------------+ # Line, usage: line - 10 | line -= 20 | line "word1 word2 " 20 | line () { printf %.s"${1}" $(seq ${2}); } # | #----------------------------------------------------------------------+</span></span></code> </pre><br>  Inserted into the script using <i>source</i> or just copy-paste. <br>  Pay attention to this control code - <i>'\ e $ {Y}; $ {X} H'</i> <br>  It allows you to move the cursor position, where Y is a row, X is a column, and the game itself is built on this.  For convenience, I wrapped it in the XY function. <br><br>  So, inspired by such console utilities as: <i>sl</i> , <i>cowsay</i> , <i>figlet</i> , etc.  etc.  I started to invent a game.  I always had warm feelings for bullet scrollers, so the choice fell on this genre.  In addition, I wanted to make an action game!  And not some text adventure game (I have nothing against text adventure games).  Action in console, on bash'e?  Challenge accepted! <br>  First of all, I drew the "sprite" of the airplane (hero): <br><br><pre> <code class="bash hljs">__ |‚òÖ„Äµ____ \_| / ¬∞)- |/</code> </pre><br>  The "window" of the cockpit prevented to make the lower part, here the effect of underlining came in handy. <br>  At the same time added colors: <br><br><pre> <code class="bash hljs">__ |<span class="hljs-variable"><span class="hljs-variable">${RED}</span></span>‚òÖ<span class="hljs-variable"><span class="hljs-variable">${DEF}</span></span>„Äµ____ \_| /<span class="hljs-variable"><span class="hljs-variable">${UND}</span></span><span class="hljs-variable"><span class="hljs-variable">${BLD}</span></span> ¬∞<span class="hljs-variable"><span class="hljs-variable">${DEF}</span></span>)<span class="hljs-variable"><span class="hljs-variable">${DGRY}</span></span>-<span class="hljs-variable"><span class="hljs-variable">${DEF}</span></span> |/</code> </pre><br>  For drawing, I decided to use an array, break the lines into array elements: <br><br><pre> <code class="bash hljs">hero=(<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-string"><span class="hljs-string">"__ "</span></span> <span class="hljs-string"><span class="hljs-string">"|</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${RED}</span></span></span><span class="hljs-string">‚òÖ</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-string">„Äµ____ "</span></span> <span class="hljs-string"><span class="hljs-string">" \_| /</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${UND}</span></span></span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${BLD}</span></span></span><span class="hljs-string"> ¬∞</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-string">)</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DGRY}</span></span></span><span class="hljs-string">-</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">" |/ "</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span>)</code> </pre><br>  And we derive this command: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (( i=0; i&lt;<span class="hljs-variable"><span class="hljs-variable">${#hero[@]}</span></span>; i++ )); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> XY <span class="hljs-variable"><span class="hljs-variable">${X}</span></span> $((<span class="hljs-variable"><span class="hljs-variable">$Y</span></span> + <span class="hljs-variable"><span class="hljs-variable">$i</span></span>)) <span class="hljs-string"><span class="hljs-string">" </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${hero[$i]}</span></span></span><span class="hljs-string"> "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre><br>  Cycle by the number of elements in the array.  Each element is drawn with the line offset down. <br>  The first and last elements of the array are empty in order to erase the remnants of a plane with vertical movement.  And to remove artifacts, when moving horizontally, lines are drawn in the frame of spaces - <i>"$ {hero [$ i]}"</i> <br><br>  Let's make the airplane fly.  It is necessary to somehow handle button presses (WASD). <br><br>  Use the utility - <i>read</i> : <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">read</span></span> -t0.0001 -n1 input; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-variable"><span class="hljs-variable">$input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">"w"</span></span>) ((Y--));; <span class="hljs-string"><span class="hljs-string">"a"</span></span>) ((X--));; <span class="hljs-string"><span class="hljs-string">"s"</span></span>) ((Y++));; <span class="hljs-string"><span class="hljs-string">"d"</span></span>) ((X++));; <span class="hljs-keyword"><span class="hljs-keyword">esac</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (( i=0; i&lt;<span class="hljs-variable"><span class="hljs-variable">${#hero[@]}</span></span>; i++ )); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> XY <span class="hljs-variable"><span class="hljs-variable">${X}</span></span> $((<span class="hljs-variable"><span class="hljs-variable">$Y</span></span> + <span class="hljs-variable"><span class="hljs-variable">$i</span></span>)) <span class="hljs-string"><span class="hljs-string">" </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${hero[$i]}</span></span></span><span class="hljs-string"> "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre><br>  Infinite loop <i>while</i> .  In the <i>read</i> loop to the <i>input</i> variable.  Parameters <i>read</i> : <br>  -t0.0001 sets the timeout - input waiting time, I set the minimum so that the game does not get up to stake <br>  -n1 number of characters, we only need 1 <br><br>  <i>Case</i> checks what arrives at the <i>input</i> and, depending on this, moves the airplane (decreases / increases the X and Y coordinates).  Next is the familiar <i>for</i> loop <i>for</i> drawing the airplane. <br><br>  It turned out like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b05/a9b/b5b/b05a9bb5b724841d60ae95a3a32e0868.gif" alt="image"><br><br>  Great, the airplane is moving, but the cursor is flashing and <i>input is</i> coming out. <br>  Turn off the cursor and hide the input.  But this will ‚Äúspoil‚Äù the terminal (with the input disabled, it is somewhat uncomfortable to work), so it is necessary to enable the input after exiting the game. <br>  Create a <i>bye</i> function: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bye</span></span></span></span> () { stty <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-comment"><span class="hljs-comment">#   printf "${CON}${DEF}" #  ,     exit #    } trap bye INT #   bye   Ctrl+C printf "${COF}" #   stty -echo #  </span></span></code> </pre><br>  It‚Äôs beautiful, but if the airplane ‚Äúflies‚Äù off the edge of the screen, a facing occurs, the XY function stops working. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d7/0cf/3b7/6d70cf3b7352d4980ed5175d64955c07.gif" alt="image"><br><br>  It is necessary to determine the size of the "screen" and not to let the plane over the edge.  It is convenient to put this in a function so that the values ‚Äã‚Äãof variables change when you stretch the ‚Äúscreen‚Äù: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> get_dimensions { endx=$( tput cols ) <span class="hljs-comment"><span class="hljs-comment"># - (X) endy=$( tput lines ) # - (Y) heroendx=$(( $endx - 12 )) #     . X heroendy=$(( $endy - 7 )) #     . Y }</span></span></code> </pre><br>  Modify the main <i>while loop</i> : <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> get_dimensions <span class="hljs-built_in"><span class="hljs-built_in">read</span></span> -t0.0001 -n1 input; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-variable"><span class="hljs-variable">$input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">"w"</span></span>) ((Y--)); [ <span class="hljs-variable"><span class="hljs-variable">$Y</span></span> -lt 1 ] &amp;&amp; Y=1;; <span class="hljs-string"><span class="hljs-string">"a"</span></span>) ((X--)); [ <span class="hljs-variable"><span class="hljs-variable">$X</span></span> -lt 1 ] &amp;&amp; X=1;; <span class="hljs-string"><span class="hljs-string">"s"</span></span>) ((Y++)); [ <span class="hljs-variable"><span class="hljs-variable">$Y</span></span> -gt <span class="hljs-variable"><span class="hljs-variable">$heroendy</span></span> ] &amp;&amp; Y=<span class="hljs-variable"><span class="hljs-variable">$heroendy</span></span>;; <span class="hljs-string"><span class="hljs-string">"d"</span></span>) ((X++)); [ <span class="hljs-variable"><span class="hljs-variable">$X</span></span> -gt <span class="hljs-variable"><span class="hljs-variable">$heroendx</span></span> ] &amp;&amp; X=<span class="hljs-variable"><span class="hljs-variable">$heroendx</span></span>;; <span class="hljs-keyword"><span class="hljs-keyword">esac</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (( i=0; i&lt;<span class="hljs-variable"><span class="hljs-variable">${#hero[@]}</span></span>; i++ )); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> XY <span class="hljs-variable"><span class="hljs-variable">${X}</span></span> $((<span class="hljs-variable"><span class="hljs-variable">$Y</span></span> + <span class="hljs-variable"><span class="hljs-variable">$i</span></span>)) <span class="hljs-string"><span class="hljs-string">" </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${hero[$i]}</span></span></span><span class="hljs-string"> "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre><br>  You can already play in moving the airplane on the screen.  Let's play a little.  Enough, it's time to add a bullet. <br><br>  To do this, add a poll button "P" (piu), it will be responsible for the shot: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> HX=$((<span class="hljs-variable"><span class="hljs-variable">$X</span></span> + 9)); HY=$((<span class="hljs-variable"><span class="hljs-variable">$Y</span></span> + 3)) get_dimensions <span class="hljs-built_in"><span class="hljs-built_in">read</span></span> -t0.0001 -n1 input; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-variable"><span class="hljs-variable">$input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">"w"</span></span>) ((Y--)); [ <span class="hljs-variable"><span class="hljs-variable">$Y</span></span> -lt 1 ] &amp;&amp; Y=1;; <span class="hljs-string"><span class="hljs-string">"a"</span></span>) ((X--)); [ <span class="hljs-variable"><span class="hljs-variable">$X</span></span> -lt 1 ] &amp;&amp; X=1;; <span class="hljs-string"><span class="hljs-string">"s"</span></span>) ((Y++)); [ <span class="hljs-variable"><span class="hljs-variable">$Y</span></span> -gt <span class="hljs-variable"><span class="hljs-variable">$heroendy</span></span> ] &amp;&amp; Y=<span class="hljs-variable"><span class="hljs-variable">$heroendy</span></span>;; <span class="hljs-string"><span class="hljs-string">"d"</span></span>) ((X++)); [ <span class="hljs-variable"><span class="hljs-variable">$X</span></span> -gt <span class="hljs-variable"><span class="hljs-variable">$heroendx</span></span> ] &amp;&amp; X=<span class="hljs-variable"><span class="hljs-variable">$heroendx</span></span>;; <span class="hljs-string"><span class="hljs-string">"p"</span></span>) PIU+=(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$HY</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$HX</span></span></span><span class="hljs-string">"</span></span>);; <span class="hljs-keyword"><span class="hljs-keyword">esac</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (( i=0; i&lt;<span class="hljs-variable"><span class="hljs-variable">${#hero[@]}</span></span>; i++ )); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> XY <span class="hljs-variable"><span class="hljs-variable">${X}</span></span> $((<span class="hljs-variable"><span class="hljs-variable">$Y</span></span> + <span class="hljs-variable"><span class="hljs-variable">$i</span></span>)) <span class="hljs-string"><span class="hljs-string">" </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${hero[$i]}</span></span></span><span class="hljs-string"> "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre><br>  There can be a lot of bullets; here again an array is useful.  Pressing "P" adds the entry "$ HY $ HX" to the "PIU" array. <br><br>  These are the coordinates of the new bullet.  And in order for the bullets to appear at the plane from the desired place, and not from the tail or wing, these coordinates are set with the offset from the coordinates of the plane - HX = $ (($ X + 9));  HY = $ (($ Y + 3)). <br><br><div class="spoiler">  <b class="spoiler_title">Small lyrical digression</b> <div class="spoiler_text">  Arrays are generally very useful (O_o true chtol!?) <br><br>  A small example: the task is to take dumps from several postgresql servers of different colors and copy them to yourself. <br><br>  The settings for connecting to servers are different, the databases are called differently, the dumps are stored in different places ... <br><br>  We'll have to hardcode, the array is the best suited for this.  Create an array: <br><br><pre> <code class="bash hljs">dbases=( <span class="hljs-comment"><span class="hljs-comment">#-------------------------------+---------------+------------+---------+ # Ssh address | Dump folder | DB name | New db | #-------------------------------+---------------+------------+---------+ '-p123 user@192.168.0.1' '/backup' 'test_db' 'db1' '-p321 looser@127.1' '/tmp' 'main_db' 'db2' 'someserver' '/tmp/backup' 'a' 'db3' ); N=${#dbases[*]}; C=4</span></span></code> </pre><br>  Values ‚Äã‚Äãwe build up in columns, the convenient label turns out.  It is convenient to add / subtract lines, you can insert comments. <br><br>  Variable N counts the total number of values, variable C - the number of columns (manually set). <br><br>  Then in the cycle <i>for ((i = 0; i &lt;$ {N}; i + = $ {C}));</i>  <i>do</i> use this construction: <br><br><pre> <code class="bash hljs">tmp=(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${dbases[@]:$i:$C}</span></span></span><span class="hljs-string">"</span></span>) srvadr=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${tmp[0]}</span></span></span><span class="hljs-string">"</span></span> bkpath=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${tmp[1]}</span></span></span><span class="hljs-string">"</span></span> dbname=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${tmp[2]}</span></span></span><span class="hljs-string">"</span></span> dbtest=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${tmp[3]}</span></span></span><span class="hljs-string">"</span></span></code> </pre><br>  You can use <i>read</i> : <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">read</span></span> srvadr bkpath dbname dbtest &lt;&lt;&lt; <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${dbases[@]:$i:$C}</span></span></span><span class="hljs-string">"</span></span></code> </pre><br>  But <i>read it</i> messes up with spaces.  Total: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash dbases=( #-------------------------------+---------------+------------+---------+ # Ssh address | Dump folder | DB name | New db | #-------------------------------+---------------+------------+---------+ '-p123 user@192.168.0.1' '/backup' 'test_db' 'db1' '-p321 looser@127.1' '/tmp' 'main_db' 'db2' 'someserver' '/tmp/backup' 'a' 'db3' ); N=${#dbases[*]}; C=4 for ((i=0; i&lt;${N}; i+=${C})); do tmp=("${dbases[@]:$i:$C}") srvadr="${tmp[0]}" bkpath="${tmp[1]}" dbname="${tmp[2]}" dbtest="${tmp[3]}" # copy dump scp ${srvadr}${bkpath}/${dbname}.gz . # test dump gunzip -c ${dbname}.gz | psql -v ON_ERROR_STOP=1 ${dbtest} \ || { printf "\nDB error!"; continue; } done</span></span></code> </pre><br><br>  Voila  You can use an array for hardcode parsing without resorting to <i>grep</i> , <i>sed</i> , <i>awk</i> etc services: <br><br><pre> <code class="bash hljs">df=($(df -h)); <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">${df[5]}</span></span></code> </pre><br>  Etc.  etc., but back to our bullets. <br></div></div><br>  So, bullet is a record of the form "YX" in the array "PIU". <br>  It is necessary to "sprite" bullets, I decided to make bullets not simple, but <del>  gold </del>  animated. <br><br>  The bullet will have an animation of the flight, as if it were a mini rocket, it turned out like this: <br><br><pre> <code class="bash hljs">shoot=( <span class="hljs-string"><span class="hljs-string">" -&gt;"</span></span> <span class="hljs-string"><span class="hljs-string">"-=&gt;"</span></span> <span class="hljs-string"><span class="hljs-string">"=-&gt;"</span></span> <span class="hljs-string"><span class="hljs-string">"- &gt;"</span></span>)</code> </pre><br>  And in color: <br><br><pre> <code class="bash hljs">shoot=( <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${RED}</span></span></span><span class="hljs-string"> -</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${BLD}</span></span></span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${GRN}</span></span></span><span class="hljs-string">&gt;</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${BLD}</span></span></span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${LRED}</span></span></span><span class="hljs-string">-=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${GRN}</span></span></span><span class="hljs-string">&gt;</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${LRED}</span></span></span><span class="hljs-string">=-</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${BLD}</span></span></span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${GRN}</span></span></span><span class="hljs-string">&gt;</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${RED}</span></span></span><span class="hljs-string">- </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${GRN}</span></span></span><span class="hljs-string">&gt;</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DEF}</span></span></span><span class="hljs-string">"</span></span>)</code> </pre><br>  In the get_dimensions <i>function we</i> add restrictions for the bullet: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> get_dimensions { endx=$( tput cols ) <span class="hljs-comment"><span class="hljs-comment"># - (X) endy=$( tput lines ) # - (Y) heroendx=$(( $endx - 12 )) #     . X heroendy=$(( $endy - 7 )) #     . Y bullendx=$(( $endx - 4 )) #     . X }</span></span></code> </pre><br>  In the main <i>while loop, we</i> place this structure: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#-------------------------------{  }--------------------------------------- #  ,  L?    ((L++)); [ $L -gt 3 ] &amp;&amp; L=0 NP=${#PIU[@]} #  -  #    for (( t=0; t&lt;${NP}; t++ )); do #    "YX"    # .. X  ( ) PI=(${PIU[$t]}); PY=${PI[0]}; PX=${PI[1]} #  X   ((PX++)) [ $PX -ge $bullendx ] &amp;&amp; { #      : XY ${PX} ${PY} " " #  ( ) unset PIU[$t] #     PIU=("${PIU[@]}") #    # .. unset    ((NP--)) #  -  continue #   .  #  ,       "PIU" } || { PIU[$t]="$PY $PX"; } #  ,        XY ${PX} ${PY} " ${shoot[$L]}" done</span></span></code> </pre><br>  Piu, piu, piu! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2e/bd2/498/e2ebd2498b234f2a40fcc3218000933e.gif" alt="image"><br><br>  But there is no one to shoot at.  Add targets.  Targets will be the eternal enemies of humanity, zaslantsy from space - aliens in flying saucers. <br><br>  The plates, I also decided to make animated, as if the plate is spinning.  Sprite: <br><br><pre> <code class="bash hljs">alien=( <span class="hljs-string"><span class="hljs-string">" ___ "</span></span> <span class="hljs-string"><span class="hljs-string">"( o ) "</span></span> <span class="hljs-string"><span class="hljs-string">' `¬Ø¬¥ '</span></span>)</code> </pre><br>  The effect of torsion is achieved by animating the inside of a flying saucer: <br><br><pre> <code class="bash hljs">small=( <span class="hljs-string"><span class="hljs-string">'o '</span></span> <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-string"><span class="hljs-string">' o'</span></span> <span class="hljs-string"><span class="hljs-string">' o '</span></span>)</code> </pre><br>  In color: <br><br><pre> <code class="bash hljs">small=( <span class="hljs-variable"><span class="hljs-variable">${YLW}</span></span><span class="hljs-string"><span class="hljs-string">'o '</span></span><span class="hljs-variable"><span class="hljs-variable">${DEF}</span></span> <span class="hljs-variable"><span class="hljs-variable">${YLW}</span></span><span class="hljs-string"><span class="hljs-string">' '</span></span><span class="hljs-variable"><span class="hljs-variable">${DEF}</span></span> <span class="hljs-variable"><span class="hljs-variable">${YLW}</span></span><span class="hljs-string"><span class="hljs-string">' o'</span></span><span class="hljs-variable"><span class="hljs-variable">${DEF}</span></span> <span class="hljs-variable"><span class="hljs-variable">${YLW}</span></span><span class="hljs-string"><span class="hljs-string">' o '</span></span><span class="hljs-variable"><span class="hljs-variable">${DEF}</span></span>)</code> </pre><br>  In order not to make a bunch of flying saucer frames, I decided to make a sprite generator: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> sprites { <span class="hljs-comment"><span class="hljs-comment">#          "" alien=( " _${UND}${BLD}_${DEF}_ " #        small "(${small[$L]}${DEF}) " ' `¬Ø¬¥ ') }</span></span></code> </pre><br>  We add the <i>sprites</i> function to the <i>while loop</i> , the timing <i>L is</i> right here at the right time. <br><br>  Add limiters for cymbals: <br><br><pre> <code class="bash hljs">enmyendx=$(( <span class="hljs-variable"><span class="hljs-variable">$endx</span></span> - 5 )) enmyendy=$(( <span class="hljs-variable"><span class="hljs-variable">$endy</span></span> - 7 ))</code> </pre><br>  The number of enemies is given by the variables: <i>enumber</i> (current quantity) and <i>enmax</i> (maximum quantity). <br><br>  I immediately thought that I would add more objects other than flying saucers.  Therefore, I created the ‚ÄúOBJ‚Äù array and started adding records like ‚ÄúXY type‚Äù there. <br>  The plates appear at the right edge of the screen X = $ enmyendx, and the Y coordinate is set randomly Y = $ (((RANDOM% $ enmyendy) + 3)). <br>  Add to the main <i>while loop</i> : <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#-----------------------------{  }-------------------------------------- [ $enumber -lt $enmax ] &amp;&amp; { OBJ+=("$enmyendx $(( (RANDOM % $enmyendy) + 3 )) alien") ((enumber++)) }</span></span></code> </pre><br>  We draw strangers: <br><br><pre> <code class="bash hljs">NO=<span class="hljs-variable"><span class="hljs-variable">${#OBJ[@]}</span></span> <span class="hljs-comment"><span class="hljs-comment">#  -  er=${#alien[@]} #  -   #    for (( i=0; i&lt;$NO; i++ )); do #    "XY type"    OI=(${OBJ[$i]}); OX=${OI[0]}; OY=${OI[1]}; type=${OI[2]} #  X (   ) ((OX--)) #      : [ $OX -lt 1 ] &amp;&amp; { #  ,   #    ..     for (( k=0; k&lt;$er; k++ )); do XY ${OX} $(($OY + $k)) " " done unset OBJ[$i] #     OBJ=("${OBJ[@]}") #    # .. unset    ((NO--)) #  -  ((enumber--)) #   -  continue #   .  #  ,      "OBJ" } || { OBJ[$i]="$OX $OY $type"; } #  ,   for (( p=0; p&lt;${er}; p++ )); do XY ${OX} $(($OY + $p)) "${alien[$p]}" done done</span></span></code> </pre><br>  Juha!  Um, the aliens don't die ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8fa/5a2/7fe/8fa5a27fe28a7d6f04f81d35d85ebe6f.gif" alt="image"><br><br>  Implement collision checking: <br><br><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment">#   for (( p=0; p&lt;${er}; p++ )); do #     for (( t=0; t&lt;${NP}; t++ )); do #     #    "YX"    # .. X  ( ) PI=(${PIU[$t]}); PY=${PI[0]}; PX=${PI[1]} #        # &lt;i&gt;case&lt;/i&gt;   &lt;i&gt;test([])&lt;/i&gt; .. &lt;i&gt;case&lt;/i&gt; #   ,     #   ,   case "$(($OY + 1)) $(($OX + $p))" in #        "${PIU[$t]}") #  ,   #    ..     for (( k=0; k&lt;$er; k++ )); do XY ${OX} $(($OY + $k)) " " done unset OBJ[$i] #     OBJ=("${OBJ[@]}") #   ((NO--)) #  -  ((enumber--)) #   - #  #  ( ) XY ${PX} ${PY} " " unset PIU[$t] #     PIU=("${PIU[@]}") #   ((NP--)) #  -  break #   ;; esac done done</span></span></code> </pre><br>  Skeet. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/929/6d9/5c6/9296d95c681c9ceee00c2ebbfd38b818.gif" alt="image"><br><br>  It's time to add a little sense, strangers should collide with a plane and take life from the player. <br><br>  To do this, you need to add collision checking with an airplane, but to avoid copy-paste, it is desirable to create functions for deleting objects and pools: <br><br><pre> <code class="bash hljs"> frags=0 <span class="hljs-comment"><span class="hljs-comment">#  life=3 #  function remove_obj () { for (( k=0; k&lt;$er; k++ )); do XY ${OX} $(($OY + $k)) " " done unset OBJ[$1]; OBJ=("${OBJ[@]}"); ((NO--)) } function remove_piu () { XY ${PX} ${PY} " " unset PIU[$1]; PIU=("${PIU[@]}"); ((NP--)) }</span></span></code> </pre><br>  We rewrite the "bullets" and "aliens" using functions and add a check of the coliseum with the airplane: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#-------------------------------{  }--------------------------------------- #  ,  L?    ((L++)); [ $L -gt 3 ] &amp;&amp; L=0 NP=${#PIU[@]} #  -  #    for (( t=0; t&lt;${NP}; t++ )); do #    "YX"    # .. X  ( ) PI=(${PIU[$t]}); PY=${PI[0]}; PX=${PI[1]} #  X   ((PX++)) [ $PX -ge $bullendx ] &amp;&amp; { #      : remove_piu ${t} #   ,   #     "PIU" continue #   .  #  ,       "PIU" } || { PIU[$t]="$PY $PX"; } #  ,        XY ${PX} ${PY} " ${shoot[$L]}" done #------------------------------{  }------------------------------------- [ $enumber -lt $enmax ] &amp;&amp; { OBJ+=("$enmyendx $(( (RANDOM % $enmyendy) + 3 )) alien") ((enumber++)) } NO=${#OBJ[@]} #  -  er=${#alien[@]} #  -   #    for (( i=0; i&lt;$NO; i++ )); do #    "XY type"    OI=(${OBJ[$i]}); OX=${OI[0]}; OY=${OI[1]}; type=${OI[2]} #  X (   ) ((OX--)) [ $OX -lt 1 ] &amp;&amp; { #      : remove_obj ${i} #  , ,   #     "OBJ" ((enumber--)) #   -  continue #   .  #  ,      "OBJ" } || { OBJ[$i]="$OX $OY $type"; } #  ,   for (( p=0; p&lt;${er}; p++ )); do XY ${OX} $(($OY + $p)) "${alien[$p]}" done #   for (( p=0; p&lt;${er}; p++ )); do #     for (( t=0; t&lt;${NP}; t++ )); do #     #    "YX"    # .. X  ( ) PI=(${PIU[$t]}); PY=${PI[0]}; PX=${PI[1]} #       # &lt;i&gt;case&lt;/i&gt;   &lt;i&gt;test([])&lt;/i&gt; .. &lt;i&gt;case&lt;/i&gt; #   ,     #   ,   case "$(($OY + 1)) $(($OX + $p))" in #     #    "${PIU[$t]}") remove_obj ${i} #  , , #     #   "OBJ" ((enumber--)) #   - #  ((frags++)) #   remove_piu ${t} #   , #     #   "PIU" break #   ;; esac done #   ,  #    case "$(($OY + 1)) $(($OX + $p))" in #     #    "$HY $HX") remove_obj ${i} #  , ,   #     "OBJ" ((enumber--)) #   -  ((life--)) #    ((frags++)) #   break #   ;; esac done done</span></span></code> </pre><br>  Add the output of game information and check the number of lives: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#----------------------------{   }------------------------------ XY 0 0 "${BLD}killed aliens: ${DEF}${CYN}${frags}${DEF} ${BLD}Life: ${DEF}${CYN}${life}${DEF} " [ $life -le 0 ] &amp;&amp; { clear; echo 'Game over man!'; bye; }</span></span></code> </pre><br>  The game is dead, my friend! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ce/65e/d74/2ce65ed743ed1e3961daef3ea9e099f4.gif" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">Subtotal</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash #----------------------------------------------------------------------+ #Color picker, usage: printf ${BLD}${CUR}${RED}${BBLU}"Some text"${DEF}| #---------------------------+--------------------------------+---------+ # Text color | Background color | | #------------+--------------+--------------+-----------------+ | # Base |Lighter\Darker| Base | Lighter\Darker | | #------------+--------------+--------------+-----------------+ | RED='\e[31m'; LRED='\e[91m'; BRED='\e[41m'; BLRED='\e[101m' #| Red | GRN='\e[32m'; LGRN='\e[92m'; BGRN='\e[42m'; BLGRN='\e[102m' #| Green | YLW='\e[33m'; LYLW='\e[93m'; BYLW='\e[43m'; BLYLW='\e[103m' #| Yellow | BLU='\e[34m'; LBLU='\e[94m'; BBLU='\e[44m'; BLBLU='\e[104m' #| Blue | MGN='\e[35m'; LMGN='\e[95m'; BMGN='\e[45m'; BLMGN='\e[105m' #| Magenta | CYN='\e[36m'; LCYN='\e[96m'; BCYN='\e[46m'; BLCYN='\e[106m' #| Cyan | GRY='\e[37m'; DGRY='\e[90m'; BGRY='\e[47m'; BDGRY='\e[100m' #| Gray | #------------------------------------------------------------+---------+ # Effects | #----------------------------------------------------------------------+ DEF='\e[0m' # Default color and effects | BLD='\e[1m' # Bold\brighter | DIM='\e[2m' # Dim\darker | CUR='\e[3m' # Italic font | UND='\e[4m' # Underline | INV='\e[7m' # Inverted | COF='\e[?25l' # Cursor Off | CON='\e[?25h' # Cursor On | #----------------------------------------------------------------------+ # Text positioning, usage: XY 10 10 "Some text" | XY () { printf "\e[${2};${1}H${3}"; } # | #----------------------------------------------------------------------+ # Line, usage: line - 10 | line -= 20 | line "word1 word2 " 20 | line () { printf %.s"${1}" $(seq ${2}); } # | #----------------------------------------------------------------------+ small=( ${YLW}'o '${DEF} ${YLW}' '${DEF} ${YLW}' o'${DEF} ${YLW}' o '${DEF}) hero=(" " "__ " "|${RED}‚òÖ${DEF}„Äµ____ " " \_| /${UND}${BLD} ¬∞${DEF})${DGRY}-${DEF}" " |/ " " ") shoot=( "${RED} -${DEF}${BLD}${GRN}&gt;${DEF}" "${BLD}${LRED}-=${DEF}${GRN}&gt;${DEF}" "${LRED}=-${DEF}${BLD}${GRN}&gt;${DEF}" "${RED}- ${DEF}${GRN}&gt;${DEF}") X=1; Y=1 #    enumber=0 #    enmax=10 #    frags=0 #  life=3 #  #-----------------------------{  }------------------------------------- function sprites { alien=( " _${UND}${BLD}_${DEF}_ " "(${small[$L]}${DEF}) " ' `¬Ø¬¥ ') } function remove_obj () { for (( k=0; k&lt;$er; k++ )); do XY ${OX} $(($OY + $k)) " " done unset OBJ[$1]; OBJ=("${OBJ[@]}"); ((NO--)) } function remove_piu () { XY ${PX} ${PY} " " unset PIU[$1]; PIU=("${PIU[@]}"); ((NP--)) } function bye () { stty echo printf "${CON}${DEF}" exit } function get_dimensions { endx=$( tput cols ) endy=$( tput lines ) heroendx=$(( $endx - 12 )) heroendy=$(( $endy - 7 )) bullendx=$(( $endx - 4 )) enmyendx=$(( $endx - 5 )) enmyendy=$(( $endy - 7 )) } #----------------------------------------------------------------------------- trap bye INT printf "${COF}" stty -echo clear #---------------------------{   }--------------------------------- while true; do HX=$(($X + 9)); HY=$(($Y + 3)) get_dimensions; sprites read -t0.0001 -n1 input; case $input in "w") ((Y--)); [ $Y -lt 1 ] &amp;&amp; Y=1;; "a") ((X--)); [ $X -lt 1 ] &amp;&amp; X=1;; "s") ((Y++)); [ $Y -gt $heroendy ] &amp;&amp; Y=$heroendy;; "d") ((X++)); [ $X -gt $heroendx ] &amp;&amp; X=$heroendx;; "p") PIU+=("$HY $HX");; esac for (( i=0; i&lt;${#hero[@]}; i++ )); do XY ${X} $(($Y + $i)) " ${hero[$i]} " done #--------------------------{  }--------------------------------- ((L++)); [ $L -gt 3 ] &amp;&amp; L=0 NP=${#PIU[@]} #   for (( t=0; t&lt;${NP}; t++ )); do PI=(${PIU[$t]}); PY=${PI[0]}; PX=${PI[1]}; ((PX++)) [ $PX -ge $bullendx ] &amp;&amp; { remove_piu ${t} continue } || { PIU[$t]="$PY $PX"; } XY ${PX} ${PY} " ${shoot[$L]}" done #-------------------------{  }------------------------------- [ $enumber -lt $enmax ] &amp;&amp; { OBJ+=("$enmyendx $(( (RANDOM % $enmyendy) + 3 )) alien") ((enumber++)) } NO=${#OBJ[@]} #  -  er=${#alien[@]} #  -   #   for (( i=0; i&lt;$NO; i++ )); do OI=(${OBJ[$i]}); OX=${OI[0]}; OY=${OI[1]}; ((OX--)) [ $OX -lt 1 ] &amp;&amp; { remove_obj ${i} ((enumber--)) continue } || { OBJ[$i]="$OX $OY $type"; } #   for (( p=0; p&lt;${er}; p++ )); do XY ${OX} $(($OY + $p)) "${alien[$p]}" done #   for (( p=0; p&lt;${er}; p++ )); do for (( t=0; t&lt;${NP}; t++ )); do PI=(${PIU[$t]}); PY=${PI[0]}; PX=${PI[1]} case "$(($OY + 1)) $(($OX + $p))" in "${PIU[$t]}") remove_obj ${i} ((enumber--)) ((frags++)) remove_piu ${t} break ;; esac done #    case "$(($OY + 1)) $(($OX + $p))" in "$HY $HX") remove_obj ${i} ((enumber--)) ((life--)) ((frags++)) break ;; esac done done #-----------------------{   }------------------------ XY 0 0 "${BLD}killed aliens: ${DEF}${CYN}${frags}${DEF} ${BLD}Life: ${DEF}${CYN}${life}${DEF} " [ $life -le 0 ] &amp;&amp; { clear; echo 'Game over man!'; bye; } done</span></span></code> </pre></div></div><br>  The main points from which the movement is built are dismantled.  The following story goes in the style of "how to draw an owl." <br><br>  I already mentioned that I wanted to add more objects besides flying saucers.  As a result, I added bonuses that fall out of dead enemies. <br><br>  Life - adds life, cartridges - adds cartridges (yes, cartridges end) and a booster amplifier - shooter x2 and x3, but the consumption of cartridges is appropriate. <br><br>  He also added background elements: trees, clouds, sun and explosions of destroyed enemies. <br>  Trees and clouds are divided into 3 ‚Äúbitplanes‚Äù and appear randomly.  I had to completely redo the cycle of objects, moving all the logic into the <i>mover</i> function: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mover</span></span></span></span> () { er=<span class="hljs-variable"><span class="hljs-variable">${#sprite[@]}</span></span> <span class="hljs-comment"><span class="hljs-comment">#  [ ${1} = 0 ] &amp;&amp; { ((OX--)) [ $OX -lt 0 ] &amp;&amp; OX=0 OBJ[$i]="$OX $OY $type" } #   [ $OX -lt 1 ] &amp;&amp; { remove_obj ${i} case ${type} in "alien") ((enumber--));; esac continue } #         for (( p=0; p&lt;${er}; p++ )); do #  XY ${OX} $(($OY + $p)) "${sprite[$p]}" #   case ${type} in "life" ) #   case "$(($OY + $p)) $OX" in "$HY $HX") ((life++)) remove_obj ${i} break;; esac;; "ammo" ) #   case "$(($OY + $p)) $OX" in "$HY $HX") ((ammo+=100)) remove_obj ${i} break;; esac;; "gunup" ) #    case "$(($OY + $p)) $OX" in "$HY $HX") ((G++)) remove_obj ${i} break;; esac;; "bfire" ) #    case "$OY $OX" in "$HY $HX") ((life--)) remove_obj ${i} break;; esac;; "alien" ) for (( t=0; t&lt;${NP}; t++ )); do #     case "$(($OY + 1)) $(($OX + $p))" in "${PIU[$t]}") #      [ $((RANDOM % $rnd)) -eq 0 ] &amp;&amp; { OBJ+=("$OX $OY \ ${bonuses[$((RANDOM % ${#bonuses[@]}))]}") } ((frags++)) ((enumber--)) remove_obj ${i} remove_piu ${t} #   OBJ+=("${OX} ${OY} boom") break;; esac done #    case "$(($OY + 1)) $(($OX + $p))" in "$HY $HX") ((life--)) ((frags++)) ((enumber--)) remove_obj ${i} OBJ+=("${OX} ${OY} boom") break;; esac;; esac done }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And the cycle of objects began to look like this: </font></font><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># \\  ,    |------------------ NO=${#OBJ[@]} for (( i=0; i&lt;$NO; i++ )); do OI=(${OBJ[$i]}); OX=${OI[0]}; OY=${OI[1]}; type=${OI[2]} case $type in #      1  "boom" ) er=${boomC} for part in "${boom[@]:$B:$boomC}"; do XY ${OX} ${OY} " ${part}" ((OY++)) done [ ${E} = 0 ] &amp;&amp; { ((B+=${boomC})) [ $B -gt ${boomN} ] &amp;&amp; { B=0 remove_obj ${i} } };; #      sprite #   mover    #       # (  ) "alien" ) sprite=("${alien[@]}"); mover 0;; "bfire" ) sprite=("${bfire[@]}"); mover 0;; "ammo" ) sprite=("${ammob[@]}"); mover 0;; "life" ) sprite=("${lifep[@]}"); mover 0;; "gunup" ) sprite=("${gunup[@]}"); mover 0;; "tree1" ) sprite=("${tree1[@]}"); mover ${Q};; "tree2" ) sprite=("${tree2[@]}"); mover ${W};; "tree3" ) sprite=("${tree3[@]}"); mover ${E};; "cloud1") sprite=("${cloud1[@]}"); mover ${Q};; "cloud2") sprite=("${cloud2[@]}"); mover ${W};; "cloud3") sprite=("${cloud3[@]}"); mover ${E};; esac done</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So what kind of shooter without a boss? </font><font style="vertical-align: inherit;">As soon as the number of dead aliens reaches 100, an evil papa will appear. </font><font style="vertical-align: inherit;">With the advent of the big plate, the player understands where these endless aliens come from, from here! </font><font style="vertical-align: inherit;">From this big plate, you need to dunk it! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boss:</font></font><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#  |----------------------------------------------------------------- if [ $frags -ge $tillboss ]; then #    bar=; hp=$(( $bosshbar * $bhealth / 100 )); hm=$(( $endx - 10 )) for (( i=0 ; i&lt;${hp}; i++ )); do bar="‚ñí${bar}"; done for (( i=$hp; i&lt;${hm}; i++ )); do bar="${bar} "; done XY 1 $(($endy - 1)) " ${BLD}BOSS: |${RED}${bar}${DEF}${BLD}|${DEF}" #  [ $BY -lt $Y ] &amp;&amp; { ((BY++)) } [ $BY -gt $Y ] &amp;&amp; { ((BY--)) } [ $BX -gt $(($endx / 2)) -a "$goback" == "false" ] &amp;&amp; { ((BX--)) } || goback=true [ $BX -lt $bossendx -a "$goback" == "true" ] { &amp;&amp; ((BX++)) } || goback=false #  for (( i=0; i&lt;${#boss[@]}; i++ )); do XY ${BX} $(($BY + $i)) " ${boss[$i]} " done #  [ $BY -eq $Y -a $K -eq 0 ] &amp;&amp; { OBJ+=("$(($BX - 4)) $(($BY + 3)) bfire") } #     [ $enumber -lt $enmax ] &amp;&amp; { ((enumber++)) OBJ+=("$(($BX + 2)) $(($BY + 3)) alien") } else [ $enumber -lt $enmax ] &amp;&amp; { ((enumber++)) OBJ+=("$enmyendx $(( (RANDOM % $enmyendy) + 3 )) alien") } fi</span></span></code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/642/6a3/c71/6426a3c715c170bf58aaff0e64e029f0.gif" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That was such a game. </font><font style="vertical-align: inherit;">What I want to do more: try to realize the appearance of objects character by character. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There will have to either abandon the color / effects, or seriously squat. </font><font style="vertical-align: inherit;">There is an idea to add additional fields to the sprite arrays with control codes for each character. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maybe I‚Äôll come up with some storyline and who knows what else, but that's another story. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Continued </font></font><a href="https://habrahabr.ru/post/337896"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I. BASH'im further</font></font></a> <br><br>  Piu, piu, piu!) </div><p>Source: <a href="https://habr.com/ru/post/335960/">https://habr.com/ru/post/335960/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335944/index.html">Why does the Dwarf Fortress game start during apt-get upgrade?</a></li>
<li><a href="../335948/index.html">Key Criteria for Choosing and Evaluating an Internet Promotion Agency</a></li>
<li><a href="../335952/index.html">Multiformat banners in Tinkoff.ru and the approach to the layout of responsive banners in Google AdWords</a></li>
<li><a href="../335954/index.html">ReactOS versus Windows XP SP3: the epic battle in 3DMark</a></li>
<li><a href="../335958/index.html">Implementation, analog and adaptation for ‚Äúpure‚Äù javascript JavaScript jQuery () functions; and adjacent to it</a></li>
<li><a href="../335962/index.html">Parametric modeling in CAD SolveSpace: "The ways of the Solver are inscrutable" or "Newton's Wormholes"</a></li>
<li><a href="../335964/index.html">How cloud service Drimkas Cabinet copes with spontaneous loads</a></li>
<li><a href="../335966/index.html">Celesta and Flute: Creating Business Logic in the Java Ecosystem</a></li>
<li><a href="../335968/index.html">Cloning the Lode Runner game from the first PC in the USSR "BK-0010" plus a few words about the programming of games in the late 80s</a></li>
<li><a href="../335970/index.html">We break haks completely. We read machine codes as an open book.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>