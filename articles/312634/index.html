<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Special prime numbers help passively listen to the Diffie-Hellman key exchange protocol.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Slide from ANB presentation 

 In 2013, thanks to Edward Snowden, NSA documents appeared in the media. Among them - zamylenny slide from the presentat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Special prime numbers help passively listen to the Diffie-Hellman key exchange protocol.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/0d8/8e7/64d/0d88e764d7504148b96d16bd17ccb9bf.png"><br>  <i>Slide from ANB presentation</i> <br><br>  In 2013, thanks to Edward Snowden, <a href="http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html">NSA documents appeared</a> in the media.  Among them - zamylenny slide from the presentation, which pointed to the possibility of the NSA to decrypt VPN traffic.  The NSA had no reason to lie in a secret presentation, so the experts took this information as evidence of some fundamental vulnerability in modern public key cryptography systems. <br><a name="habracut"></a><br>  Fundamentals of cryptography and implementation of algorithms revised again.  Soon came the <a href="https://weakdh.org/imperfect-forward-secrecy-ccs15.pdf">first assumptions</a> .  The most likely of these was that the fundamental vulnerability is hidden in the practical implementation of <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25BE%25D1%2582%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25BB_%25D0%2594%25D0%25B8%25D1%2584%25D1%2584%25D0%25B8_%25E2%2580%2594_%25D0%25A5%25D0%25B5%25D0%25BB%25D0%25BB%25D0%25BC%25D0%25B0%25D0%25BD%25D0%25B0">the Diffie-Hellman protocol</a> .  Specifically, the implementation of the protocol recommended by the DSA standard encourages users not to calculate the unique large modules <i>p</i> when generating keys, but to use <i>standard</i> numbers. <br><br>  For example, here is the recommended prime number in <a href="https://tools.ietf.org/html/rfc2409">RFC 2409</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/3f5/763/63e/3f576363e5ea4ca3828e63998ecd990e.png"><br><br>  This is how it turned out in practice: until recently, 92% of the most popular HTTPS sites from the Alexa list used <a href="https://weakdh.org/imperfect-forward-secrecy-ccs15.pdf">two standard prime numbers</a> .  Diffie-Hellman protocol is also used to generate keys that are used in the SSH, VPN, SMTPS, IPsec and other protocols. <br><br>  These numbers were considered safe with a sufficiently large value of a prime number.  Now, experts from the University of Pennsylvania (USA), INRIA, CNRS and the University of Lorraine (France) have <a href="https://eprint.iacr.org/2016/961.pdf">managed to prove</a> that not all such numbers are safe, so the NSA does have a theoretical possibility of decrypting HTTPS traffic.  In practice, cryptographers have demonstrated that a specially designed large prime number, when used as a <i>p</i> module in the generation of encryption keys, can act as a ‚Äútrapdoor‚Äù that allows you to learn other secret key components and, as a result, decrypt the secret message. <br><br>  Generally speaking, the ability of large groups of users to use a standard prime number as a <i>p</i> module evoked instant criticism from experts immediately after the publication of the <a href="">Digital Signature Algorithm</a> (DSA) standard in 1991, which provided for such a possibility and, in fact, encouraged this practice. <br><br>  DSA is a cryptographic algorithm using the public key to create an electronic signature.  The signature is created secretly, but can be publicly verified.  The algorithm is based on the computational complexity of taking logarithms in finite fields, that is, the discrete logarithm. <br><br>  The classic DSA-based cryptographic scheme is the Diffie-Hellman common key generation scheme.  Its cryptographic strength is based on the supposedly high computational complexity of converting an exponential function.  As specialists assumed, the algorithms for computing the discrete logarithm have a very high complexity, which is comparable to the complexity of the fastest factorization algorithms. <br><br>  It turns out that this is not true.  As cryptographers have shown, with a certain number <i>p</i> for a 1024-bit key, it is possible to calculate the discrete logarithm in a quite observable time - namely, 10,000 faster than theoretically calculated for random primes.  Researchers did this in two months on a cluster of approximately 3000 processor cores in the university network (the actual number of machines changed as the task progressed). <br><br><img src="https://habrastorage.org/files/211/78a/ba1/21178aba10b2410db2e8191f027147f3.png"><br><br>  The only question is whether ‚Äústandard‚Äù prime numbers are such ‚Äúloopholes‚Äù and where they came from.  It is theoretically possible that the pre-calculations and the compilation of primes involved the attackers.  And then we understand what the statement of the NSA about the possibility of decrypting "trillions of encrypted connections" means.  With the computing power in the NSA's data centers, deciphering messages will take them orders of magnitude less than two months. <br><br>  The possibility of introducing a specially selected module <i>p</i> into a standard does not mean that the NSA really implemented this idea.  We cannot verify whether the prime numbers currently used are ‚Äúgood‚Äù or ‚Äúbad‚Äù without knowing the algorithm that the NSA uses.  But if this is true, then this will not be the first attempt by the NSA to weaken public encryption standards.  The <a href="https://habrahabr.ru/post/200686/">story of the ‚Äúrandom‚Äù number generator Dual_EC_DRBG</a> - RNG by default in RSA BSAFE and Data Protection Manager, among other programs, has not yet been erased from memory.  As shown by the documents of Snowden, this generator was originally designed with the participation of the NSA to give predictable numbers. <br><br>  To protect against potential ‚Äúloopholes‚Äù through specially selected prime numbers, the DSA provided the ability to select primes in a ‚Äúvirtually random‚Äù way, with the publication of a pseudo-random "seed value".  But practically no one uses this opportunity now.  As already mentioned, the absolute majority of sites generate keys with standard prime numbers proposed in documents for general use. <br><br>  The simplest protection against possible vulnerabilities in the encryption algorithm is the choice of keys longer than 1024 bits, the authors say.  According to their calculations, the calculation for a 2048-bit key with the same "weakened" prime will take about 16 million times longer than for a 1024-bit key.  According to the <a href="https://www.trustworthyinternet.org/ssl-pulse/">SSL Pulse survey</a> , now, 27.3% of sites using SSL exchange keys of 1024 bits or less. <br><br>  In the future, researchers believe, for safety, all prime numbers should be published along with sowing values. <br><br>  In general, it is necessary to take simple numbers only from reliable sources. </div><p>Source: <a href="https://habr.com/ru/post/312634/">https://habr.com/ru/post/312634/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312624/index.html">Presentation of DriverPack Cloud</a></li>
<li><a href="../312626/index.html">How to make friends Bagri and MongoDB</a></li>
<li><a href="../312628/index.html">Using CSS Flexbox to position blocks on page</a></li>
<li><a href="../312630/index.html">Asterisk cluster. Centralization of registration information</a></li>
<li><a href="../312632/index.html">Using R to prepare and transfer live analytics to other business units</a></li>
<li><a href="../312636/index.html">Any site can get information about which popular services you are authorized in</a></li>
<li><a href="../312638/index.html">Using ES6 generators using the example of koa.js</a></li>
<li><a href="../312640/index.html">How we filtered bots and lowered the bounce rate from 90% to 42%</a></li>
<li><a href="../312642/index.html">Unicode: the necessary practical minimum for each developer</a></li>
<li><a href="../312646/index.html">Anti-pager for paranoiac in Safari</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>