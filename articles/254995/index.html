<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Resuscitation of TP-LINK 3020 router</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all. 

 I decided to share my experience of resuscitation of Wi-Fi router TP-LINK 3020 . 

 It all started with the fact that I decided to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Resuscitation of TP-LINK 3020 router</h1><div class="post__text post__text-html js-mediator-article">  Good day to all. <br><br>  I decided to share my experience of resuscitation of Wi-Fi router <a href="http://www.ixbt.com/comm/tp-link-tl-mr3020.shtml">TP-LINK 3020</a> . <br><br>  It all started with the fact that I decided to play around with the CyberWRT firmware from idleness.  And it ended badly.  I even did not quite understand what had happened.  Most likely the case was that with the router I worked via WiFi, which was distributed in exactly the same router with factory firmware and default settings.  Apparently at some point, the test settings were reset, respectively, the IP address conflict, and I received a beautiful brick, blinking all the LEDs in a cyclic reboot. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Don't do that. <br><br><a name="habracut"></a>  Grieved and climbed into Google. <br><br>  The disadvantages in my position were: I was at work in the wild wilderness, I didn‚Äôt have any adapters from USB to UART.  To shop radio components about 565 kilometers in a straight line.  And not the fact that it sold what is necessary. <br>  Pros: on the router has already been unsoldered UART.  To unsolder it, by the way, two minutes under the standard comb 2.54.  And there was a <a href="http://www.freeduino.ru/arduino/freeduino-2013.html">Freeduino</a> board with a USB port.  Only here I did not meet any examples of using it as a USB-UART bridge.  Mainly they were pushing the boards with several UART hardware, and only one here.  Well, I'm not such a big specialist.  However, the time was free, the router is already half-dead - there is practically nothing to lose.  There was a risk to kill the router completely, there was an option to wait for the return home (in a month) and to go to the router there, looking for a normal adapter.  But a month without this router meant for me the loss of wasted heaps of time, which I was planning to spend just on gutting this router.  The second router was terrible and terrible to torment. <br><br>  Well, go.  He took freeduin, prisobachil to the computer.  Found on the Internet a cunning sketch: <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ pinMode(<span class="hljs-number"><span class="hljs-number">0</span></span>, INPUT); pinMode(<span class="hljs-number"><span class="hljs-number">1</span></span>, INPUT); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br><br>  And that's all.  What is there input, where input - is unclear.  Vaguely imagining the upcoming torment with a software serial or with something else that was incomprehensible, I began to connect a router.  RX-TX, TX-RX.  Somewhere they advised a resistor for matching the voltages, I did not have it.  Someone advised to short the RESET to the ground, which also seemed to me suspicious.  I decided that a half volt difference does not matter.  The router connected to the laptop network card and foolishly turned it on ... And I saw flashing LEDs repeating to the beat every two seconds: <br><br><pre> <code class="cpp hljs">U-Boot <span class="hljs-number"><span class="hljs-number">1.1</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> (Nov <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">2011</span></span> - <span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>) AP121 (ar9330) U-boot DRAM:<span class="hljs-number"><span class="hljs-number">32</span></span> MB .......... ....... .. eth0, eth1 Autobooting in <span class="hljs-number"><span class="hljs-number">1</span></span> seconds...</code> </pre><br>  And where did I see it?  In the window of the Arduinov serial monitor.  And at the top of the window an unobtrusively loomed input field and a button with a purely Russian ‚ÄúSend‚Äù.  I thought, doubted, scored "tpl" there, waited for the appearance of "Autobooting in 1 seconds" and sent.  Without any additional terminals there, Putty and the like.  And it stopped! <br><br>  It simply could not be true. <br><br>  Scored "printenv" - works! <br><br>  I was shocked.  Then everything goes like clockwork: <br>  - downloaded <a href="https://ru.wikipedia.org/wiki/Tftpd32">tftpd32</a> , stuck the firmware into its folder. <br>  - Set the IP of the network card of the laptop 192.168.1.100. <br>  - launch tftpd32, IP - 192.168.1.100, Show Dir - the path to the firmware - Copy. <br>  - tftpboot 0x80000000 CyberWrt-v1.4.bin - done <br>  - erase 0x9f020000 + 0x3c0000 - done <br>  - cp.b 0x80000000 0x9f020000 0x3c0000 - done <br>  - bootm 0x9f020000 - done! <br>  - returned to the network card the receipt of the IP machine ... <br><br>  And all this from the monitor serial from Arduino ... <br><br>  And that's it!  The result is a live router.  And what is interesting - I even forgot to connect the ‚Äúland‚Äù between the router and the freeduin.  I noticed it after the firmware.  Simply, the router received power from the USB of the same laptop as Freeduino, apparently it itself there somewhere connected. <br>  So everything turned out to be much simpler than I expected.  The eyes are afraid, and the hands are doing.  Good luck to all who will repeat. </div><p>Source: <a href="https://habr.com/ru/post/254995/">https://habr.com/ru/post/254995/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254983/index.html">Product Design Digest March 2015</a></li>
<li><a href="../254985/index.html">User videos: Windows 3.11 inside ReactOS</a></li>
<li><a href="../254989/index.html">Android Volley Loader. Moving toward the library</a></li>
<li><a href="../254991/index.html">Digital archeology: how long-lost data is saved</a></li>
<li><a href="../254993/index.html">How we "married" cloud PBX, GSM and realtors (part 4)</a></li>
<li><a href="../255001/index.html">Difficult times for free-to-play, a little more about Apple Watch, console revenue - and other news of the week for a mobile developer</a></li>
<li><a href="../255003/index.html">MMAS ant algorithm</a></li>
<li><a href="../255005/index.html">Quaternion rotation notes</a></li>
<li><a href="../255007/index.html">In the wake of WinHEC (Hardware Engineering Conference) 2015 - Windows 10, IoT, AllJoyn, clouds, and more</a></li>
<li><a href="../255009/index.html">Self-assembly 3d-printer or purchase ready-made equipment for the design. 3d printing. Part 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>