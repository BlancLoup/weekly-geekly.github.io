<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We measure power consumption for ASIC digital blocks (even before manufacturing)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, many articles devoted to development for FPGA / FPGA have appeared on Habrahabr . This happened with the direct participation of my colleagu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We measure power consumption for ASIC digital blocks (even before manufacturing)</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/metrotek/blog/264389/"><img src="https://habrastorage.org/files/d34/da1/b40/d34da1b4086b43c3b1b18b11cb61fcbf.jpg"></a> <br>  Recently, many articles devoted to development for <b>FPGA / FPGA</b> have appeared on <b>Habrahabr</b> .  This happened with the direct participation of my colleagues and other users.  It can be seen that such articles contribute to the popularization of this area of ‚Äã‚Äãdevelopment and show that there is already a significant interest in the development of <b>hardware</b> as a whole (figuratively called ‚Äúiron‚Äù). <br><br>  In this article, I will enter into an almost ‚Äúun-plowed field‚Äù of development for <b>ASIC</b> and talk about one interesting aspect of creating digital parts ( <b>IP blocks</b> ) in <b>ASIC</b> chips.  This area of ‚Äã‚Äãdevelopment is even narrower than <b>FPGA</b> . <br><blockquote>  <i><b>ASIC</b> (application-specific integrated circuit, ‚Äúspecial purpose integrated circuit‚Äù) is an integrated circuit specialized for solving a specific problem.</i> </blockquote><br><a name="habracut"></a><br>  My article illustrates the commonly used method of measuring <b>power consumption</b> for a single <b>IP block</b> inside a chip before it can be measured in a fabricated chip.  This assessment allows already at an early stage: <ul><li>  compare different variants of the digital data processing algorithm, </li><li>  choose the best implementation option by the criterion of consumption / digital losses, </li><li>  pretty accurate in numbers to estimate the power consumption when working in a chip produced by a certain technology. </li></ul>  A preliminary assessment will show in advance which blocks will consume the most energy in active mode. <br><br>  With this method, with some assumptions, it is possible to quite accurately compare several implementations of the algorithm on <b>HDL</b> (digital circuit description language).  In our case, this will be <b>Verilog</b> , which is the most popular language for developing for <b>ASIC</b> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Two assumptions to speed up the process of comparing multiple implementations: </h4><br><ol><li>  I will not conduct a complete synthesis of the <b>IP block</b> to obtain the final layered implementation (it includes all the parasitic capacitances that also affect the consumption), and confine myself to the so-called ideal <b>wire-load</b> model of the synthesized <b>IP block</b> .  * A more accurate assessment in absolute numbers is obtained by synthesis in the advanced <b>topographical</b> mode (with layer-by-layer synthesis), but with relative comparison this can be neglected. </li><li>  It will not be possible to estimate and take into account the consumption of the <b>"clock tree"</b> after the <b>wire-load</b> synthesis.  To evaluate it, you need to do a full wiring in the crystal.  In synchronous circuits, it can give in numbers a significant consumption relative to the consumption of the entire unit during operation.  But when comparing different implementations of a block with approximately the same area of ‚Äã‚Äãflip-flops, the consumption of <b>the forked tree</b> can also be considered approximately the same. </li></ol><br><h4>  What we need to measure consumption: </h4><br><ul><li>  Component Library (Standard Cell Library) for the target technology (130/90 / 65nm; provided by the manufacturer under <b>NDA</b> ) </li><li>  The program for the synthesis of <b>netlist</b> from <b>Verilog</b> in the basis of the selected component library </li><li>  Program to assess consumption </li><li>  The program for the simulation and logging of the operating mode of our <b>IP block</b> (we want to get an accurate estimate of consumption in the operating mode, and not a statistical estimate of the block consumption) </li></ul><br><br>  In particular, I used <b>Synopsys DC (Design Compiler)</b> to synthesize and calculate consumption, and <b>Modelsim</b> to simulate the operation and log the number of switching signals in the circuit.  Similar data and results can be obtained using programs from other companies. <br><br>  To get consumption, you need to know how many times and which elements have switched from a synthesized <b>IP block</b> from 1 to 0 and from 0 to 1 (in the digital circuit, elements can only be in these two states).  You can, of course, not get accurate data that and how many times switched, and calculate them on the basis of statistical data (we will consider this signal only 10% of the total time switches), but then the consumption estimate will be statistical.  And we need to get accurate estimates for several implementations in order to compare.  Therefore, we will simulate the operation of the <b>IP block</b> using <b>testbench</b> and log all switching elements in the test block. <br><br><h4>  The evaluation process in stages will be shown using an example. </h4><br>  As an example, for the evaluation we will use the source code of the digital data processing unit from the output of the <b>ADC</b> (Analog-to-Digital Converter).  Its task is to perform digital signal processing ( <b>DSP / DSP</b> ) in order to implement <b>Digital Down-shift Conversion</b> (digital down-conversion) for further processing.  Using this example, I will consistently illustrate the steps that allow you to get the consumption result for any <b>IP block</b> written in <b>Verilog / VHDL</b> .  <i>* Some names in the example are changed due to the inability to lay out the source code of the mentioned digital block as it is.</i> <br><br><h6>  To automate the process of testing different implementations of the <b>IP block,</b> I wrote scripts that run sequentially in 3 steps: </h6><br><ol><li>  Synthesis of <b>IP-block</b> under the target technology (in our case we will synthesize for <b>TSMC 90nm</b> , Library: typical) </li><li>  Running a simulated synthesized description ( <b>netlist</b> ) </li><li>  Calculate the consumption of the collected switching data from the simulation. </li></ol><br><h4>  And now the process of measurement in steps and the result obtained with comments </h4><br>  For each stage, you can select the commands in your script, as done to automate the process with me, or run them in a row by command. <br><br><div class="spoiler">  <b class="spoiler_title">Script run_srs for the first stage (Design Compiler):</b> <div class="spoiler_text">  saif_map -start <br><br>  read_verilog ~ / srs / ddc_notch.v <br>  read_verilog ~ / srs / ddc_qnt3b.v <br>  read_verilog ~ / srs / ddc_intp.v <br>  read_verilog ~ / srs / ddc_qsr0.v <br>  read_verilog ~ / srs / ddc_qsr1.v <br>  read_verilog ~ / srs / ddc_lpf0.v <br>  read_verilog ~ / srs / ddc_qsr_lpf1.v <br>  read_verilog ~ / srs / ddc_reg.v <br>  read_verilog ~ / srs / ddc_top.v <br>  current_design ddc_top <br><br>  create_clock clk_ddc -period 20 <br>  set_clock_uncertainty 0.15 [all_clocks] <br><br>  compile -gate_clock <br><br>  change_names -rules verilog -hierarchy <br>  write -format verilog -hierarchy -output ddc_top.v <br>  write -format ddc -hierarchy -output ddc_top.ddc <br><br>  report_area -hierarchy&gt; ./log/area_ddc.rpt <br>  exit <br></div></div><br>  Enable name matching logging for consumption calculation. <br><pre><code class="bash hljs">saif_map -start</code> </pre> <br>  Compile the source <br><pre> <code class="bash hljs">read_verilog ~/srs/ddc_notch.v read_verilog ~/srs/ddc_qnt3b.v read_verilog ~/srs/ddc_intp.v read_verilog ~/srs/ddc_qsr0.v read_verilog ~/srs/ddc_qsr1.v read_verilog ~/srs/ddc_lpf0.v read_verilog ~/srs/ddc_qsr_lpf1.v read_verilog ~/srs/ddc_reg.v read_verilog ~/srs/ddc_top.v current_design ddc_top</code> </pre><br>  We only need to specify the settings ( <b>constraints</b> ) for the clock.  Although for complex blocks of such settings, you need to specify quite a lot so that the result after the synthesis would meet expectations. <br><pre> <code class="bash hljs">create_clock clk_ddc -period 38.46 set_clock_uncertainty 0.15 [all_clocks]</code> </pre><br>  We only compile with the gate_clock parameter, which allows us to automatically insert a cloak-off scheme during the synthesis (if the FF is not active (flip-flop / register) and certain rules for registering on the <b>Verilog are</b> observed).  This is the most significant method of reducing active consumption of the scheme in the <b>ASIC</b> ) <br><pre> <code class="bash hljs">compile -gate_clock</code> </pre><br>  We write the results of the synthesis for the second and third stage <br><pre> <code class="bash hljs">change_names -rules verilog -hierarchy write -format verilog -hierarchy -output ddc_top.v write -format ddc -hierarchy -output ddc_top.ddc ddc_top.ddc ‚Äî   ,       . ddc_top.v ‚Äî  Verilog netlist  </code> </pre><br><div class="spoiler">  <b class="spoiler_title">Script vsim.do for the second stage (simulating and logging switching in Modelsim)</b> <div class="spoiler_text">  vlib work <br>  vmap work work <br>  vlog -work work ~ / work / tsmc090.v <br>  vlog -work work ~ / work / ddc_top.v <br>  vlog -work work ~ / work / tb.v <br>  vsim + notimingchecks -novopt work.tb + nowarn3017 + nowarn3722 <br><br>  run 90us <br>  power add -r tb / ddc_top / * <br>  run 200us <br>  power report -all -bsaif saif.saif <br>  exit <br></div></div><br>  Create a library in which we will compile and simulate <br><pre> <code class="bash hljs">vlib work vmap work work</code> </pre><br>  We compile the <b>netlist</b> synthesized at the first stage (ddc_top.v), the library of <b>TSMC 90nm</b> elements for simulation (tsmc090.v) and <b>testbench</b> (tb) <br><pre> <code class="bash hljs">vlog -work work ~/work/tsmc090.v vlog -work work ~/work/ddc_top.v vlog -work work ~/work/tb.v</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Verilog code for testbench (tb.v)</b> <div class="spoiler_text"><pre> <code class="vhdl hljs">`timescale <span class="hljs-number"><span class="hljs-number">1</span></span>ps/<span class="hljs-number"><span class="hljs-number">1</span></span>ps module tb; reg clk_ddc; reg rstz_ddc; reg in_valid; reg [<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] in_i; reg [<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] in_q; reg [<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] i_temp; reg [<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] q_temp; always @(posedge clk_ddc) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (~rstz_ddc) i_temp &lt;= <span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (in_valid) i_temp &lt;= $random % <span class="hljs-number"><span class="hljs-number">8</span></span>; always @(posedge clk_ddc) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (~rstz_ddc) q_temp &lt;= <span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (in_valid) q_temp &lt;= $random % <span class="hljs-number"><span class="hljs-number">8</span></span>; always @* <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> (i_temp) <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span>: in_i = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b001</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d1</span></span>: in_i = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b001</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d2</span></span>: in_i = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b010</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d3</span></span>: in_i = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b011</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d4</span></span>: in_i = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b100</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d5</span></span>: in_i = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b101</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d6</span></span>: in_i = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b110</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>:in_i= <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b111</span></span>; endcase always @* <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> (q_temp) <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span>: in_q = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b001</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d1</span></span>: in_q = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b001</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d2</span></span>: in_q = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b010</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d3</span></span>: in_q = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b011</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d4</span></span>: in_q = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b100</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d5</span></span>: in_q = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b101</span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d6</span></span>: in_q = <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b110</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>:in_q= <span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b111</span></span>; endcase initial clk_ddc = <span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span>; always #<span class="hljs-number"><span class="hljs-number">19230</span></span> clk_ddc = ~clk_ddc; //<span class="hljs-number"><span class="hljs-number">26</span></span> Mhz always @(posedge clk_ddc) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (~rstz_ddc) in_valid &lt;= <span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> in_valid &lt;= <span class="hljs-symbol"><span class="hljs-symbol">'d1</span></span>; initial <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> rstz_ddc = <span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span>; #<span class="hljs-number"><span class="hljs-number">80000</span></span>; @(posedge clk_ddc); rstz_ddc = <span class="hljs-symbol"><span class="hljs-symbol">'d1</span></span>; @(posedge clk_ddc); @(posedge clk_ddc); #<span class="hljs-number"><span class="hljs-number">50000000</span></span>; $display ($<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>); #<span class="hljs-number"><span class="hljs-number">50000000</span></span>; $display ($<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>); #<span class="hljs-number"><span class="hljs-number">50000000</span></span>; $display ($<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>); #<span class="hljs-number"><span class="hljs-number">400000000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> ddc_top ddc_top ( .clk_ddc ( clk_ddc ), .rstz_ddc ( rstz_ddc ), // APB .clk_apb ( <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span> ), .reg_adr ( <span class="hljs-number"><span class="hljs-number">10</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span> ), .reg_we ( <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span> ), .reg_wd ( <span class="hljs-number"><span class="hljs-number">32</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span> ), .reg_rd ( reg_rd ), .ddc_qi ( {in_q,in_i} ), .ddc_in_valid ( in_valid ), .ddc_out_i ( ), .ddc_out_q ( ), .ddc_out_valid ( ) );</code> </pre></div></div><blockquote>  I note that we input the initially randomly generated input data, and not the data from the model simulating a real input signal.  For our case of measuring the consumption of a digital circuit for a signal that is ‚Äúunder noise‚Äù, it will be equivalent.  In fact, the actual input signal represents ‚Äúwhite noise‚Äù (the uniform distribution of the random generator).  Although, to be precise, it is not perfectly ‚Äúwhite‚Äù due to the limitation of the signal bandwidth and the influence of analog input amplifiers, but this generally does not affect the result of the simulation and the measurement of consumption. </blockquote><br>  We run the simulation without optimization for accurate logging and without checking the time relationships from the <b>TSMC</b> library (also hide certain Warning libraries). <br><pre> <code class="bash hljs">vsim +notimingchecks -novopt work.tb +nowarn3017 +nowarn3722</code> </pre><br>  Skip the initial initialization for comparison purposes. <br><pre> <code class="bash hljs">run 90us</code> </pre><br>  And we start logging all signals in our block. <br><pre> <code class="bash hljs">power add -r tb/ddc_top/*</code> </pre><br>  We collect data 200mks in operating mode <br><pre> <code class="bash hljs">run 200us</code> </pre><br>  And write the collected data in the <b>Switching Activity Interchange Format (SAIF) format</b> to a file for use in the third stage. <br><pre> <code class="bash hljs">power report -all -bsaif saif.saif</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Example of part of the data from the saif</b> <div class="spoiler_text"><pre> (INSTANCE dff_20_reg_6_
	 NET
		 (flag (T0 0) (T1 200000000) (TX 0) (TC 0) (IG 0))
		 (n0 (T0 100534440) (T1 99465560) (TX 0) (TC 1324) (IG 0))
		 (clk (T0 150002000) (T1 49998000) (TX 0) (TC 5200) (IG 0))
		 (xRN (T0 0) (T1 200000000) (TX 0) (TC 0) (IG 0))
		 (xSN (T0 0) (T1 200000000) (TX 0) (TC 0) (IG 0))
</pre><br></div></div>  Shows how many times a certain internal netlist signal has been switched during the test. <br><br><div class="spoiler">  <b class="spoiler_title">Run script for the third stage (measurement of block consumption on the saif database in the Design Compiler)</b> <div class="spoiler_text">  read_ddc ./ddc_top.ddc <br>  current_design ddc_top <br>  read_saif -input ./saif.saif -instance tb / ddc_top <br>  report_power -hierarchy -levels 1 -analysis_effort high&gt; ./log/power_ddc.rpt <br>  report_saif <br></div></div><br>  Read the previously saved database for the synthesized netlist and connect the previously obtained saif <br><pre> <code class="bash hljs">read_ddc ./ddc_top.ddc current_design ddc_top read_saif -input ./saif.saif -instance tb/ddc_top</code> </pre><br>  Run the measurement of power consumption and write to the file <br><pre> <code class="bash hljs">report_power -hierarchy -levels 1 -analysis_effort high &gt; ./<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/power_ddc.rpt</code> </pre><br>  We check that all our internal signals were correctly compared and taken into account in the analysis of consumption.  And at the same time there were no signals for which it was not possible to find the switching statistics in the saif file (this goes for 50% of the signals if you simulate the original Verilog, and not the synthesized netlist under the target library). <br><pre> <code class="bash hljs">report_saif</code> </pre><br><div class="spoiler">  <b class="spoiler_title">The report of this team for our example</b> <div class="spoiler_text"><pre> -------------------------------------------------- ------------------------------
               User Default Propagated
 Object type Annotated (%) Activity (%) Activity (%) Total
 -------------------------------------------------- ------------------------------
  
  Nets 2029 (100.00%) 0 (0.00%) 0 (0.00%) 2029
  Ports 655 (100.00%) 0 (0.00%) 0 (0.00%) 655
  Pins 7492 (100.00%) 0 (0.00%) 0 (0.00%) 7492
 -------------------------------------------------- ------------------------------
</pre><br></div></div><br><br>  And now you can run all 3 scripts in succession with one command and see what happened for our example. <br><pre> <code class="bash hljs">dc_shell <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ./run_srs ; vsim <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> ./vsim.do ; dc_shell <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ./run</code> </pre><br><br><h4>  Here is a final report </h4><br><pre> <code class="bash hljs">Library(s) Used: typical (File: ~/lib/lib90nm/typical.db) Power-specific unit information : Voltage Units = 1V Capacitance Units = 1.000000pf Time Units = 1ns Dynamic Power Units = 1mW (derived from V,C,T units) Leakage Power Units = 1pW -------------------------------------------------------------------------------- Switch Int Leak Total Hierarchy Power Power Power Power % -------------------------------------------------------------------------------- ddc_top 6.60e-02 0.315 1.10e+08 0.491 100.0 r313 (ddc_top_DW01_inc_0) 0.000 0.000 1.40e+05 1.40e-04 0.0 ddc_reg (ddc_reg) 0.000 1.27e-03 3.78e+06 5.06e-03 1.0 ddc_intp (ddc_intp) 8.41e-03 3.34e-02 5.75e+06 4.76e-02 9.7 ddc_qnt3b (ddc_qnt3b) 2.59e-03 9.17e-03 2.20e+06 1.40e-02 2.8 ddc_qsr_lpf1(ddc_qsr_lpf1) 2.44e-02 0.110 1.54e+07 0.150 30.4 ddc_notch3 (ddc_notch_1) 1.75e-03 8.81e-03 1.05e+07 2.11e-02 4.3 ddc_notch2 (ddc_notch_2) 1.69e-03 8.81e-03 1.05e+07 2.10e-02 4.3 ddc_notch1 (ddc_notch_3) 1.69e-03 8.81e-03 1.05e+07 2.10e-02 4.3 ddc_notch0 (ddc_notch_0) 2.16e-03 9.98e-03 1.05e+07 2.27e-02 4.6 ddc_qsr1 (ddc_qsr1) 1.46e-03 2.98e-03 4.32e+05 4.86e-03 1.0 ddc_lpf0_q (ddc_lpf0_1) 9.79e-03 5.75e-02 3.80e+06 7.11e-02 14.5 ddc_lpf0_i (ddc_lpf0_0) 1.06e-02 6.05e-02 3.90e+06 7.50e-02 15.3 ddc_qsr0 (ddc_qsr0) 1.33e-03 2.68e-03 2.34e+05 4.24e-03 0.9</code> </pre><br>  Total consumption consists of three components: <br><ol><li>  <b>Cell Leakage power</b> - leakage current.  The static component, which depends on the production technology (90/65 / 28nm) and the conditions of operation of the circuit (temperature / voltage).  The calculated value is proportional to the block area. </li><li>  <b>Cell Internal power</b> - the current that occurs when the input / output state of the library component changes ( <b>cell</b> ‚Äî example: logical ‚Äúor‚Äù ORX2, DFF trigger).  Dynamic component. </li><li>  <b>Net Switching power</b> - the current associated with the recharging of the output capacitances of the component when switching.  Dynamic component. </li></ol><br><br>  <b>In our example, we got the result that, at a block of 26 MHz, our digital processing unit consumes 491 ¬µA in active mode for 90nm</b> <br><br>  In the next article, you can analyze the consumption of the same IP block when it is implemented in FPGA.  For this, every <b>Altera / Xilinx / Microsemi</b> manufacturer has specialized programs within their CAD systems (Computer Aided Design).  In particular, Altera has this part called <b>PowerPlay Power Analysis</b> , which allows you to automate the process described above for your <b>FPGAs</b> .  Only here it is well known that the ability to ‚Äúprogram‚Äù in an <b>FPGA</b> any IP block has an obvious negative component in the form of much higher consumption.  The difference in consumption can reach several dozen times, if we compare the implementation of the same IP block in <b>ASIC 90nm</b> and in modern <b>FPGA</b> , made using <b>28nm</b> technology. <br><br><h4>  useful links </h4><ul><li>  <a href="http://www.ee.ncu.edu.tw/~jfli/vlsi21/lecture/dc.pdf">Tutorial of Design Compiler</a> </li><li>  <a href="http://cfile2.uf.tistory.com/attach/201C6E455040517229EF61">Design Compiler User Guide</a> </li><li>  <a href="http://www.cc.gatech.edu/~hadi/teaching/cs3220/01-2014fa/doc/modelsim/ModelSim_Users_Manual_v10.1c.pdf">ModelSim SE User's Manual</a> </li><li>  <a href="http://ee.sharif.edu/~vlsi/VLSI_SharifFlow.pptx">Power Analysis using Synopsys flow</a> </li><li>  <a href="https://www.altera.com/support/support-resources/operation-and-testing/power/pow-powerplay.html">PowerPlay Power Analysis</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/264389/">https://habr.com/ru/post/264389/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264379/index.html">ReactOS Hackfest started</a></li>
<li><a href="../264381/index.html">Magic of tensor algebra: Part 18 - Mathematical modeling of the Janibekov effect</a></li>
<li><a href="../264383/index.html">Tox developers disassociate themselves from the Tox Foundation</a></li>
<li><a href="../264385/index.html">The study "The global state of information security 2015" (GSISS 2015). Part 1</a></li>
<li><a href="../264387/index.html">Announcement Rust 1.2</a></li>
<li><a href="../264391/index.html">Build USB HID under BeagleBone</a></li>
<li><a href="../264395/index.html">Debugging the rules of RewriteRule, or a little about the intimate life of mod_rewrite</a></li>
<li><a href="../264397/index.html">Pipeline with spark.ml</a></li>
<li><a href="../264399/index.html">The digest of interesting materials for the mobile # 115 developer (August 2-9)</a></li>
<li><a href="../264401/index.html">IBM Launches 50 Projects for the Open Source Developer Community</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>