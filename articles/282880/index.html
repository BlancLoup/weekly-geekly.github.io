<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dangerous target = "_ blank"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most create external links through target = "_ blank" and do not know of one interesting nuance - the page that we will get in this way will receive p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dangerous target = "_ blank"</h1><div class="post__text post__text-html js-mediator-article">  Most create external links through target = "_ blank" and do not know of one interesting nuance - the page that we will get in this way will receive partial control over the page referring to it through the js <b>window.opener</b> property. <br><br>  Through <b>window.opener.location</b> we can redirect to, for example, a phishing page.  This is a kind of tabnabbing, only more advanced.  Since the victim least expects the substitution of the page, in the previously opened trusted tab of the browser. <br><a name="habracut"></a><br>  The problem is far from new, but still relevant, and as I see, not many people know about it. <br><br>  <s>The problem also exists in facebook.</s> <s>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </s>  <s>For example - <a href="https://www.facebook.com/rb.ganjar/posts/1079631808768644%3Fpnref%3Dstory">open the post</a> , click on the link.</s>  <s>We look what happened to the tab on which we opened this post.</s> <br><br>  Hid the publication in the FB due to complaints about the need to restore access to the account after clicking on the link ( <a href="https://habrahabr.ru/post/282880/">proof</a> ).  You can try to put the hidden publication on the <a href="http://sli.su/kitten.html">sli.su/kitten.html</a> page or see <a href="https://habrahabr.ru/post/282880/">how it works on the browser</a> <br><br>  On the <a href="http://sli.su/kitten.html">sli.su/kitten.html</a> page <a href="http://sli.su/kitten.html">there</a> is such code: <br><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.opener.location = <span class="hljs-string"><span class="hljs-string">'https://sli.su/facebook.com/auth.html'</span></span>;</code> </pre> <br>  It creates a redirect from a previously trusted page.  This is because no one informed the browser that the page being opened should not have access to the parent tab.  At the time of publication, it works without problems in chrome 50, firefox 45, opera 36. <br><br>  So many sites sin, and some even do not consider this a problem "on their side" <a href="https://sites.google.com/site/bughunteruniversity/nonvuln/phishing-with-window-opener">sites.google.com/site/bughunteruniversity/nonvuln/phishing-with-window-opener</a> <br><br>  <b>Solutions to the problem:</b> <br><br>  1. Add to links: <br><br><pre> <code class="html hljs xml">rel="noopener"</code> </pre><br>  It can also be <br><br><pre> <code class="html hljs xml">rel="nofollow noopener"</code> </pre><br>  2. Open all external links through your own intermediate page, on which the code should work: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.opener = <span class="hljs-literal"><span class="hljs-literal">null</span></span>;</code> </pre><br>  3. Open links in a new tab via js: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> otherWindow = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.open(); otherWindow.opener = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; otherWindow.location = targetUrl;</code> </pre><br>  4. To catch all the clicks on the links and at the time of the transition to create a hidden iframe, through which to open the page in a new tab.  <a href="https://github.com/danielstjules/blankshield">github.com/danielstjules/blankshield</a> - js plugin that, according to the description, solves the problem (not personally tested). <br><br>  <b>PS:</b> Rel = "noopener" does not work in FF - <a href="https://habrahabr.ru/post/282880/">habrahabr.ru/post/282880/#comment_8879594</a> .  Instead, you can use rel = noreferrer. <br><br>  <b>PPS:</b> For anyone who considers the article <a href="https://medium.com/%40jitbit/target-blank-the-most-underestimated-vulnerability-ever-96e328301f4c">https: //medium.com/@jitbit/target-blank-the-most-under the</a> original article <a href="https://medium.com/%40jitbit/target-blank-the-most-underestimated-vulnerability-ever-96e328301f4c">...</a> - compare the publication date.  My article was published on the 3rd of May.  English - 4th. </div><p>Source: <a href="https://habr.com/ru/post/282880/">https://habr.com/ru/post/282880/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282870/index.html">Voice control of the smart home on the Z-wave via Siri</a></li>
<li><a href="../282874/index.html">ReactJS 15.0.2 Tutorial</a></li>
<li><a href="../282876/index.html">The digest of interesting materials for the mobile developer # 151 (April 25-May 3)</a></li>
<li><a href="../282878/index.html">Validation: inside entities or outside?</a></li>
<li><a href="../28288/index.html">iPhone 3G for $ 199?</a></li>
<li><a href="../282884/index.html">My experience setting up an environment for web development</a></li>
<li><a href="../282886/index.html">Attackers use a set of exploits for cyber attacks on Android users</a></li>
<li><a href="../282890/index.html">Sasha Goldshtein, the guru of .NET Performance, will speak at the .NET conference in St. Petersburg</a></li>
<li><a href="../282896/index.html">Multiple vulnerabilities in ImageMagick, one of which leads to RCE</a></li>
<li><a href="../282898/index.html">Upwork has monopoly greed</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>