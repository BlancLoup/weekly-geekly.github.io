<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to train mdl pnmt obratty skrschnya</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I came across a question on Stackoverflow, how to restore the original words from abbreviations: for example, from wtrbtl get a water bottle...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to train mdl pnmt obratty skrschnya</h1><div class="post__text post__text-html js-mediator-article"><p>  Recently, I came across a <a href="https://stackoverflow.com/questions/43510778">question</a> on Stackoverflow, how to restore the original words from abbreviations: for example, from <em>wtrbtl</em> get a <em>water bottle</em> , and from <em>bsktball</em> - <em>basketball</em> .  There was an additional complication in the question: there is no complete dictionary of all possible source words, i.e.  the algorithm must be able to come up with new words. </p><br><p>  The question intrigued me, and I found it useful to figure out which algorithms and mathematics underlie the modern spell-checkers.  It turned out that a good girder can be assembled from an n-gram language model, a word distortion probability model, and a beam search greedy algorithm.  The whole construction together is called the <a href="http://web.stanford.edu/~jurafsky/slp3/5.pdf">noisy channel</a> model. </p><br><p>  Armed with this knowledge and Python, in the evening I created a model from scratch, capable of learning the text of "The Lord of the Rings" (!) From scratch to recognize the abbreviations of quite modern sports terms. </p><br><img src="https://habrastorage.org/webt/1a/fo/ar/1afoarhel5lgye2tszzns09ny9u.png"><a name="habracut"></a><br><p>  Goggles are used a lot where: from the keyboard of your phone to search engines and voice assistants.  It is not so easy to make a good girdle, for it must be both quick and ready for everything (including correcting mistakes in words that you have never seen before).  That is why so much science is used in the guard.  The purpose of the article is to give an idea about this science and just have fun. </p><br><h3 id="matematika-vnutri-opechatochnika">  Math inside the girdle </h3><br><p>  The noisy channel model considers each abbreviation as the result of a random distortion of the original phrase. </p><br><p>  To restore the original phrase, you need to answer two questions: what source words are likely, and what kind of phrase distortions are likely? </p><br><p>  By Bayes theorem, </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>a</mi><mi>b</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>v</mi><mi>i</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>m</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy=&quot;false&quot;>)</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mi>b</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>v</mi><mi>i</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="63.532ex" height="2.66ex" viewBox="-38.5 -832 27353.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-68" x="1396" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="1973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="2954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-65" x="3423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-7C" x="3890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="4168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-62" x="4698" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-62" x="5127" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="5557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-65" x="6008" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-76" x="6475" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="6960" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="7306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-74" x="7835" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="8197" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6F" x="8542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6E" x="9028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-29" x="9628" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="10268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="10737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6D" x="11083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="11961" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-28" x="12465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="12854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-68" x="13358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="13934" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="14386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="14915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-65" x="15385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-29" x="15851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="16241" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-28" x="16744" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="17134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-62" x="17663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-62" x="18093" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="18522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-65" x="18974" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-76" x="19440" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="19926" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="20271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-74" x="20801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="21162" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6F" x="21508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6E" x="21993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-7C" x="22594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="22872" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-68" x="23376" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="23952" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="24404" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="24933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-65" x="25403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-29" x="25869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-3D" x="26536" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>a</mi><mi>b</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>v</mi><mi>i</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>m</mi><mi>p</mi><mo stretchy="false">(</mo><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi>a</mi><mi>b</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>v</mi><mi>i</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo><mo>=</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> p (phrase | abbreviation) \ sim p (phrase) p (abbreviation | phrase) = </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo>=</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="44.513ex" height="2.66ex" viewBox="0 -832 19165.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-3D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="1056" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-28" x="1559" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="1949" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-68" x="2452" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="3480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="4010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-65" x="4479" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-29" x="4946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="5585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-75" x="6055" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6D" x="6627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="7506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-28" x="8009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-74" x="8399" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="8760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="9212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6E" x="9741" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="10342" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-66" x="10811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6F" x="11362" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="11847" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6D" x="12299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="13177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-74" x="13707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="14068" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6F" x="14414" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6E" x="14899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-7C" x="15500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="15778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-68" x="16282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="16858" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="17310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="17839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-65" x="18309" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-29" x="18775" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mi>p</mi><mo stretchy="false">(</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> = p (phrase) \ sum p (transformation | phrase) </script></p><br><p>  Where <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.493ex" height="2.419ex" viewBox="0 -780.1 7101 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6E" x="1342" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="1943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-66" x="2412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6F" x="2963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="3448" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6D" x="3900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="4778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-74" x="5308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="5669" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6F" x="6015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6E" x="6500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> transformation </script>  - this is any such change of the original <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.141ex" height="2.419ex" viewBox="-38.5 -780.1 3505 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-68" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="1080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="1531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="2061" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-65" x="2530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="2997" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> phrases </script>  which makes it observable <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>b</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>v</mi><mi>i</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.681ex" height="2.057ex" viewBox="0 -780.1 5460 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-62" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-62" x="959" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-72" x="1388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-65" x="1840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-76" x="2306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="2792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="3137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-74" x="3667" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="4028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6F" x="4374" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6E" x="4859" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>b</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>v</mi><mi>i</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> abbreviation </script>  .  Symbol <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>m</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.514ex" height="1.937ex" viewBox="0 -728.2 1943.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6D" x="1065" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> \ sim </script>  denotes direct proportionality. </p><br><p>  And the probability of all sorts of phrases, and the probability of transformations can be estimated using statistical models.  I will use the simplest type of model - letter n-grams.  It would be possible to apply more complex models (for example, recurrent neural networks), this fundamentally does not change anything. </p><br><p>  With such models, you can choose the most plausible source phrase letter by letter using the greedy directional search algorithm, beam search. </p><br><h3 id="n-grammnaya-yazykovaya-model">  N-gram language model </h3><br><p>  The n-gram model on the previous n-1 letters of the phrase determines the probability of the next, n-th letter (and ignores all the letters that were in front of them).  For example, the probability of the letter "g" after the sequence "bowlin" will be calculated by the 4-gram model as <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>b</mi><mi>o</mi><mi>w</mi><mi>l</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>l</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.241ex" height="2.66ex" viewBox="-38.5 -832 9576.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-67" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-7C" x="1373" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-62" x="1652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6F" x="2081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-77" x="2567" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6C" x="3283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="3582" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6E" x="3927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-29" x="4528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-3D" x="5195" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="6251" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-28" x="6755" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-67" x="7144" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-7C" x="7625" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6C" x="7903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="8202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6E" x="8547" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-29" x="9148" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>b</mi><mi>o</mi><mi>w</mi><mi>l</mi><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>l</mi><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> p (g | bowlin) = p (g | lin) </script>  because  for simplicity, the model ignores all letters preceding these four.  Such conditional probabilities are determined (‚Äúlearned‚Äù) by the text corpus.  Continuing the example </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>p&amp;#xA0;(g&amp;#xA0;|&amp;#xA0;lin)&amp;#xA0;=&amp;#xA0;\&amp;#xA0;frac&amp;#xA0;{\&amp;#xA0;#&amp;#xA0;(ling)}&amp;#xA0;{\&amp;#xA0;#&amp;#xA0;(lin&amp;#xA0;\&amp;#xA0;bullet)}&amp;#xA0;=&amp;#xA0;\&amp;#xA0;frac&amp;#xA0;{\&amp;#xA0;#&amp;#xA0;(ling)}&amp;#xA0;{\&amp;#xA0;#&amp;#xA0;(lina)&amp;#xA0;+&amp;#xA0;\&amp;#xA0;#&amp;#xA0;(linb)&amp;#xA0;+&amp;#xA0;\&amp;#xA0;#&amp;#xA0;(linc)&amp;#xA0;+&amp;#xA0;...}</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">p&nbsp;(g&nbsp;|&nbsp;lin)&nbsp;=&nbsp;\&nbsp;frac&nbsp;{\&nbsp;#&nbsp;(ling)}&nbsp;{\&nbsp;#&nbsp;(lin&nbsp;\&nbsp;bullet)}&nbsp;=&nbsp;\&nbsp;frac&nbsp;{\&nbsp;#&nbsp;(ling)}&nbsp;{\&nbsp;#&nbsp;(lina)&nbsp;+&nbsp;\&nbsp;#&nbsp;(linb)&nbsp;+&nbsp;\&nbsp;#&nbsp;(linc)&nbsp;+&nbsp;...}</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>p&nbsp;(g&nbsp;|&nbsp;lin)&nbsp;=&nbsp;\&nbsp;frac&nbsp;{\&nbsp;#&nbsp;(ling)}&nbsp;{\&nbsp;#&nbsp;(lin&nbsp;\&nbsp;bullet)}&nbsp;=&nbsp;\&nbsp;frac&nbsp;{\&nbsp;#&nbsp;(ling)}&nbsp;{\&nbsp;#&nbsp;(lina)&nbsp;+&nbsp;\&nbsp;#&nbsp;(linb)&nbsp;+&nbsp;\&nbsp;#&nbsp;(linc)&nbsp;+&nbsp;...}</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> p (g | lin) = \ frac {\ # (ling)} {\ # (lin \ bullet)} = \ frac {\ # (ling)} {\ # (lina) + \ # (linb) + \ # (linc) + ...} </script></p><br><p>  Where <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>\&amp;#xA0;#&amp;#xA0;(ling)</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">\&nbsp;#&nbsp;(ling)</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>\&nbsp;#&nbsp;(ling)</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-9"> \ # (ling) </script>  Is the number of "ling" combinations in the learning package, and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>\&amp;#xA0;#&amp;#xA0;(lin&amp;#xA0;\&amp;#xA0;bullet)</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">\&nbsp;#&nbsp;(lin&nbsp;\&nbsp;bullet)</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>\&nbsp;#&nbsp;(lin&nbsp;\&nbsp;bullet)</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-10"> \ # (lin \ bullet) </script>  - the number of all 4 grams in the text, starting with "lin". </p><br><p>  To evaluate the probabilities of even rare n-grams more adequately, I applied two tricks.  First, I add a number to each counter. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.643ex" height="2.057ex" viewBox="0 -780.1 2429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-64" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-65" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6C" x="1240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-74" x="1538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="1900" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> \ delta </script>  - This ensures that I will not divide by zero.  Secondly, I use not only n-grams (which may be few in the text), but also (n-1) -grams (they are more common), and so on, up to the simplest model, which is not looks at the context.  But smaller order counters are used with weights decreasing exponentially with the pace <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>a</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.242ex" height="2.419ex" viewBox="0 -780.1 2687.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-68" x="1581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-61" x="2158" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>a</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> \ alpha </script>  .  Therefore, the probability <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>l</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.721ex" height="2.66ex" viewBox="-38.5 -832 3324.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-67" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-7C" x="1373" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6C" x="1652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-69" x="1950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMATHI-6E" x="2296" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-29" x="2896" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>l</mi><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-13"> p (g | lin) </script>  I calculate how </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>p&amp;#xA0;(g&amp;#xA0;|&amp;#xA0;lin)&amp;#xA0;=&amp;#xA0;\&amp;#xA0;frac&amp;#xA0;{(\&amp;#xA0;#&amp;#xA0;(ling)&amp;#xA0;+1)&amp;#xA0;+&amp;#xA0;\&amp;#xA0;alpha&amp;#xA0;(\&amp;#xA0;#&amp;#xA0;(ing)&amp;#xA0;+1)&amp;#xA0;+&amp;#xA0;\&amp;#xA0;alpha&amp;#xA0;^&amp;#xA0;2&amp;#xA0;(\&amp;#xA0;#&amp;#xA0;(ng)&amp;#xA0;+1)&amp;#xA0;+&amp;#xA0;\&amp;#xA0;alpha&amp;#xA0;^&amp;#xA0;3&amp;#xA0;(\&amp;#xA0;#&amp;#xA0;(g)&amp;#xA0;+1)}&amp;#xA0;{(\&amp;#xA0;#&amp;#xA0;(lin&amp;#xA0;\&amp;#xA0;bullet)&amp;#xA0;+1)&amp;#xA0;+&amp;#xA0;\&amp;#xA0;alpha&amp;#xA0;(\&amp;#xA0;#&amp;#xA0;(in&amp;#xA0;\&amp;#xA0;bullet)&amp;#xA0;+1)&amp;#xA0;+&amp;#xA0;\&amp;#xA0;alpha&amp;#xA0;^&amp;#xA0;2&amp;#xA0;(\&amp;#xA0;#&amp;#xA0;(n&amp;#xA0;\&amp;#xA0;bullet)&amp;#xA0;+1)&amp;#xA0;+&amp;#xA0;\&amp;#xA0;alpha&amp;#xA0;^&amp;#xA0;3&amp;#xA0;(\&amp;#xA0;#&amp;#xA0;(\&amp;#xA0;bullet)&amp;#xA0;+1)}</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">p&nbsp;(g&nbsp;|&nbsp;lin)&nbsp;=&nbsp;\&nbsp;frac&nbsp;{(\&nbsp;#&nbsp;(ling)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;(\&nbsp;#&nbsp;(ing)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;^&nbsp;2&nbsp;(\&nbsp;#&nbsp;(ng)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;^&nbsp;3&nbsp;(\&nbsp;#&nbsp;(g)&nbsp;+1)}&nbsp;{(\&nbsp;#&nbsp;(lin&nbsp;\&nbsp;bullet)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;(\&nbsp;#&nbsp;(in&nbsp;\&nbsp;bullet)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;^&nbsp;2&nbsp;(\&nbsp;#&nbsp;(n&nbsp;\&nbsp;bullet)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;^&nbsp;3&nbsp;(\&nbsp;#&nbsp;(\&nbsp;bullet)&nbsp;+1)}</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>p&nbsp;(g&nbsp;|&nbsp;lin)&nbsp;=&nbsp;\&nbsp;frac&nbsp;{(\&nbsp;#&nbsp;(ling)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;(\&nbsp;#&nbsp;(ing)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;^&nbsp;2&nbsp;(\&nbsp;#&nbsp;(ng)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;^&nbsp;3&nbsp;(\&nbsp;#&nbsp;(g)&nbsp;+1)}&nbsp;{(\&nbsp;#&nbsp;(lin&nbsp;\&nbsp;bullet)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;(\&nbsp;#&nbsp;(in&nbsp;\&nbsp;bullet)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;^&nbsp;2&nbsp;(\&nbsp;#&nbsp;(n&nbsp;\&nbsp;bullet)&nbsp;+1)&nbsp;+&nbsp;\&nbsp;alpha&nbsp;^&nbsp;3&nbsp;(\&nbsp;#&nbsp;(\&nbsp;bullet)&nbsp;+1)}</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-14"> p (g | lin) = \ frac {(\ # (ling) +1) + \ alpha (\ # (ing) +1) + \ alpha ^ 2 (\ # (ng) +1) + \ alpha ^ 3 (\ # (g) +1)} {(\ # (lin \ bullet) +1) + \ alpha (\ # (in \ bullet) +1) + \ alpha ^ 2 (\ # (n \ bullet) +1) + \ alpha ^ 3 (\ # (\ bullet) +1)} </script></p><br><p>  However, quite a theory!  Let's see better how the code of the model looks in Python </p><br><div class="spoiler">  <b class="spoiler_title">Language model</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> defaultdict, Counter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LanguageNgramModel</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    ,     .  : order -  (    ),  n-1 smoothing - ,        recursive - ,          : counter_ -   n-,    . vocabulary_ -   ,   """</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, order=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, smoothing=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, recursive=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.001</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.order = order self.smoothing = smoothing self.recursive = recursive <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, corpus)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""       : corpus -  . """</span></span> self.counter_ = defaultdict(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span>: Counter()) self.vocabulary_ = set() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(corpus[self.order:]): context = corpus[i:(i+self.order)] self.counter_[context][token] += <span class="hljs-number"><span class="hljs-number">1</span></span> self.vocabulary_.add(token) self.vocabulary_ = sorted(list(self.vocabulary_)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.recursive &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> self.order &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: self.child_ = LanguageNgramModel(self.order<span class="hljs-number"><span class="hljs-number">-1</span></span>, self.smoothing, self.recursive) self.child_.fit(corpus) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_counts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    ,      : context -   (   self.order ) : freq -    ,   pandas.Series """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.order: local = context[-self.order:] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: local = <span class="hljs-string"><span class="hljs-string">''</span></span> freq_dict = self.counter_[local] freq = pd.Series(index=self.vocabulary_) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(self.vocabulary_): freq[token] = freq_dict[token] + self.smoothing <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.recursive &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> self.order &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: child_freq = self.child_.get_counts(context) * self.recursive freq += child_freq <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> freq <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">predict_proba</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""     ,      : context -   (   self.order ) : freq -    ,   pandas.Series """</span></span> counts = self.get_counts(context) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> counts / counts.sum() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">single_log_proba</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context, continuation)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""       . : context -  ,    continuation -  ,    """</span></span> result = <span class="hljs-number"><span class="hljs-number">0.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> continuation: result += np.log(self.predict_proba(context)[token]) context += token <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">single_proba</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context, continuation)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""      . : context -  ,    continuation -  ,    """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.exp(self.single_log_proba(context, continuation))</code> </pre> </div></div><br><h3 id="model-opechatok">  The "typo" model </h3><br><p>  A language model was needed to understand what the original phrases are usually.  The distortion model is needed to understand how the original phrases are usually distorted. </p><br><p>  I will assume that the only possible distortion is the deletion of certain symbols from the phrase.  If desired, the model can be modified to take into account other distortions, for example, replacing and rearranging letters. </p><br><p>  I do not have a large sample on which to train a complex model.  Therefore, to estimate the probability of distortion, I will use 1-gram.  That is, my model will simply memorize for each character, with what probability it is deleted from the abbreviation.  However, I will encode it just in case in a general form, as an n-gram model. </p><br><div class="spoiler">  <b class="spoiler_title">Typo model (general view)</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MissingLetterModel</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    ,       : order - ,  n+1 smoothing_missed - ,      smoothing_total - ,      """</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, order=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, smoothing_missed=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.3</span></span></span></span><span class="hljs-function"><span class="hljs-params">, smoothing_total=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.order = order self.smoothing_missed = smoothing_missed self.smoothing_total = smoothing_total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, sentence_pairs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""         : sentence_pairs -   ( , )        . """</span></span> self.missed_counter_ = defaultdict(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span>: Counter()) self.total_counter_ = defaultdict(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span>: Counter()) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (original, observed) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sentence_pairs: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, (original_letter, observed_letter) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(zip(original[self.order:], observed[self.order:])): context = original[i:(i+self.order)] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> observed_letter == <span class="hljs-string"><span class="hljs-string">'-'</span></span>: self.missed_counter_[context][original_letter] += <span class="hljs-number"><span class="hljs-number">1</span></span> self.total_counter_[context][original_letter] += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">predict_proba</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context, last_letter)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""   ,   last_letter    context"""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.order: local = context[-self.order:] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: local = <span class="hljs-string"><span class="hljs-string">''</span></span> missed_freq = self.missed_counter_[local][last_letter] + self.smoothing_missed total_freq = self.total_counter_[local][last_letter] + self.smoothing_total <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> missed_freq / total_freq <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">single_log_proba</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context, continuation, actual=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    ,   context  continuation   actual  actual  , ,  continuation  . """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> actual: actual = continuation result = <span class="hljs-number"><span class="hljs-number">0.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> orig_token, act_token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(continuation, actual): pp = self.predict_proba(context, orig_token) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> act_token != <span class="hljs-string"><span class="hljs-string">'-'</span></span>: pp = <span class="hljs-number"><span class="hljs-number">1</span></span> - pp result += np.log(pp) context += orig_token <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">single_proba</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context, continuation, actual=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""   ,   context  continuation   actual  actual  , ,  continuation  . """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.exp(self.single_log_proba(context, continuation, actual))</code> </pre> </div></div><br><h3 id="primer-raboty-modeley">  Model work example </h3><br><p>  To understand how language models and abbreviations work, let's look at a simple example.  We will teach the language model on one word and see how it predicts the continuation of the word "bra".  From her point of view, "b" is the most plausible continuation (because this letter most often comes after "a"). </p><br><pre> <code class="python hljs">lang_model = LanguageNgramModel(<span class="hljs-number"><span class="hljs-number">1</span></span>) lang_model.fit(<span class="hljs-string"><span class="hljs-string">' abracadabra '</span></span>) print(lang_model.predict_proba(<span class="hljs-string"><span class="hljs-string">' bra'</span></span>))</code> </pre> <br><pre> <code class="hljs css"> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.181777</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.091297</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.272529</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">c</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.181686</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">d</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.181686</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.091025</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">dtype</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">float64</span></span></code> </pre> <br><p>  We will also train the model of abbreviations using one example (word, abbreviation).  In this example, we have reduced only the letter "a", so for her the model estimates the probability of reduction as high, and for the letter "b" - below.  The probability of missing the letter "c" is higher for the model than for "b", because it was less likely to meet the "c" in the training examples. </p><br><pre> <code class="python hljs">missed_model = MissingLetterModel(<span class="hljs-number"><span class="hljs-number">0</span></span>) missed_model.fit([(<span class="hljs-string"><span class="hljs-string">'abracadabra'</span></span>, <span class="hljs-string"><span class="hljs-string">'abr-cd-br-'</span></span>)]) print({letter: missed_model.predict_proba(<span class="hljs-string"><span class="hljs-string">'abr'</span></span>, letter) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">'abc'</span></span>})</code> </pre> <br><pre> <code class="hljs objectivec">{<span class="hljs-string"><span class="hljs-string">'a'</span></span>: <span class="hljs-number"><span class="hljs-number">0.7166666666666667</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>: <span class="hljs-number"><span class="hljs-number">0.09999999999999999</span></span>, <span class="hljs-string"><span class="hljs-string">'c'</span></span>: <span class="hljs-number"><span class="hljs-number">0.15</span></span>}</code> </pre> <br><p>  This is how the abbreviation model assesses the likelihood that abra will be abbreviated as abr- </p><br><pre> <code class="python hljs">print(missed_model.single_proba(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'abra'</span></span>, <span class="hljs-string"><span class="hljs-string">'abr-'</span></span>))</code> </pre> <br><pre> <code class="hljs css">0<span class="hljs-selector-class"><span class="hljs-selector-class">.164475</span></span></code> </pre> <br><h3 id="zhadnyy-poisk-naibolee-pravdopodobnoy-frazy">  Greedy search for the most plausible phrase </h3><br><p>  Having models of language and distortion, it is theoretically possible to estimate the probability of any source phrase.  To do this, just look at <em>all</em> possible pairs (source phrase, transformation) and evaluate the likelihood of each.  But there are too many of them: for example, in an alphabet of 27 characters possible <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>27</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>10</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.201ex" height="2.419ex" viewBox="0 -935.7 1808.8 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-37" x="500" y="0"></use><g transform="translate(1001,403)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346578/&amp;xid=17259,1500001,15700002,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhawOSCTzVVCGwSELS6XhXBAykalA#MJMAIN-30" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>27</mn><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-15"> 27 ^ {10} </script>  10 letter phrases;  to sort them all is unreal.  Need a trickier algorithm. </p><br><p>  We will use the fact that both models are one-letter, and we will select the letters of the original phrase one by one.  To do this, we will get a <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D1%2583%25D1%2587%25D0%25B0_(%25D0%25BF%25D0%25B0%25D0%25BC%25D1%258F%25D1%2582%25D1%258C)">bunch of</a> incomplete candidate phrases, and for each estimate how much it corresponds to the abbreviation.  We will supplement the best candidate with all the various continuation letters and hypotheses about whether they were missed and add to the heap.  In order not to create too many options, we will take only "good enough" continuations.  Those candidates that may already be full-fledged initial phrases will be set aside, and in the end we will issue as an answer.  We will repeat the procedure until the heap ends or the maximum number of iterations. </p><br><img src="https://habrastorage.org/webt/km/1s/61/km1s617dmpsswij9ravmbzjsb8m.jpeg" width="300"><br><p>  As a measure of the quality of candidates, we will use the estimate of the logarithm of the probability of an existing abbreviation, provided that the original phrase begins as this candidate, and ends as the abbreviation itself.  To control the search, we introduce two parameters - <em>optimism</em> and <em>freedom</em> .  <em>Optimism</em> estimates how much better the decoding will be when we get to the end of the abbreviation.  It makes sense to choose this coefficient between 0 and 1, and the closer it is to 1, the faster the algorithm will try to add new characters to the decryption.  <em>Freedom</em> is how much the quality of candidates may be worse than the best current option, and as this parameter increases, the algorithm considers more different options.  If you set a very high value of <em>freedom</em> , the algorithm will go through all the options (of which infinity), and work for a very long time, but with small values ‚Äã‚Äãof <em>freedom, the</em> heap can end before at least one adequate option is found. </p><br><div class="spoiler">  <b class="spoiler_title">Function to generate candidates</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> heapq <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> heappush, heappop <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generate_options</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(prefix_proba, prefix, suffix, lang_model, missed_model, optimism=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.5</span></span></span></span><span class="hljs-function"><span class="hljs-params">, cache=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""     ( ) : prefix_proba -     prefix -    suffix -     lang_model -   missed_model -    optimism - ,        cache -      :     ( ,  ,   ,  ,     ) """</span></span> options = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> lang_model.vocabulary_ + [<span class="hljs-string"><span class="hljs-string">''</span></span>]: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> letter: <span class="hljs-comment"><span class="hljs-comment">#   ,     next_letter = letter new_suffix = suffix new_prefix = prefix + next_letter proba_missing_state = - np.log(missed_model.predict_proba(prefix, letter)) else: #   ,      next_letter = suffix[0] new_suffix = suffix[1:] new_prefix = prefix + next_letter proba_missing_state = - np.log((1 - missed_model.predict_proba(prefix, next_letter))) proba_next_letter = - np.log(lang_model.single_proba(prefix, next_letter)) if cache: proba_suffix = cache[len(new_suffix)] * optimism else: proba_suffix = - np.log(lang_model.single_proba(new_prefix, new_suffix)) * optimism proba = prefix_proba + proba_next_letter + proba_missing_state + proba_suffix options.append((proba, new_prefix, new_suffix, letter, proba_suffix)) return options</span></span></code> </pre> </div></div><br><p>  If you read my code carefully, you will notice that I made another simplification - instead of summarizing the probabilities of all the distortions of the original word, I consider only one distortion.  This is not always true: for example, "ball" can be abbreviated to "bl" by deleting both the first ("b - l") and the second ("bl-") letter "l".  But if there are no such repetitions, an adequate reduction option is almost always the only one. </p><br><div class="spoiler">  <b class="spoiler_title">The main function to search for transcripts</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">noisy_channel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(word, lang_model, missed_model, freedom=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, max_attempts=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, optimism=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.9</span></span></span></span><span class="hljs-function"><span class="hljs-params">, verbose=False)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""  ,     word : word -  lang_model -   missed_model -    freedom -        max_attempts -   optimism - ,        verbose -          :    -    -    .   ,   . """</span></span> query = word + <span class="hljs-string"><span class="hljs-string">' '</span></span> prefix = <span class="hljs-string"><span class="hljs-string">' '</span></span> prefix_proba = <span class="hljs-number"><span class="hljs-number">0.0</span></span> suffix = query full_origin_logprob = -lang_model.single_log_proba(prefix, query) no_missing_logprob = -missed_model.single_log_proba(prefix, query) best_logprob = full_origin_logprob + no_missing_logprob <span class="hljs-comment"><span class="hljs-comment">#      heap = [(best_logprob * optimism, prefix, suffix, '', best_logprob * optimism)] #       -    candidates = [(best_logprob, prefix + query, '', None, 0.0)] if verbose: print('baseline score is', best_logprob) #      cache = {} for i in range(len(query)+1): future_suffix = query[:i] cache[len(future_suffix)] = -lang_model.single_log_proba('', future_suffix) # rough approximation cache[len(future_suffix)] += -missed_model.single_log_proba('', future_suffix) # at least add missingness for i in range(max_attempts): if not heap: break next_best = heappop(heap) if verbose: print(next_best) if next_best[2] == '': #     #    ,     if next_best[0] &lt;= best_logprob + freedom: candidates.append(next_best) #     if next_best[0] &lt; best_logprob: best_logprob = next_best[0] else: # it is not a leaf - generate more options prefix_proba = next_best[0] - next_best[4] # all proba estimate minus suffix prefix = next_best[1] suffix = next_best[2] new_options = generate_options(prefix_proba, prefix, suffix, lang_model, missed_model, optimism, cache) # add only the solution potentioally no worse than the best + freedom for new_option in new_options: if new_option[0] &lt; best_logprob + freedom: heappush(heap, new_option) if verbose: print('heap size is', len(heap), 'after', i, 'iterations') result = {} for candidate in candidates: if candidate[0] &lt;= best_logprob + freedom: result[candidate[1][1:-1]] = candidate[0] return result</span></span></code> </pre> </div></div><br><p>  We apply our algorithm to search for possible decoding of the abbreviation "brc". </p><br><pre> <code class="python hljs">result = noisy_channel(<span class="hljs-string"><span class="hljs-string">'brc'</span></span>, lang_model, missed_model, verbose=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, freedom=<span class="hljs-number"><span class="hljs-number">1</span></span>) print(result)</code> </pre> <br><pre> <code class="hljs pgsql">baseline score <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">7.68318306228</span></span> (<span class="hljs-number"><span class="hljs-number">6.9148647560475442</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'brc '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">6.9148647560475442</span></span>) (<span class="hljs-number"><span class="hljs-number">6.755450684372974</span></span>, <span class="hljs-string"><span class="hljs-string">' b'</span></span>, <span class="hljs-string"><span class="hljs-string">'rc '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">4.7044649199466617</span></span>) (<span class="hljs-number"><span class="hljs-number">5.8249119494605051</span></span>, <span class="hljs-string"><span class="hljs-string">' br'</span></span>, <span class="hljs-string"><span class="hljs-string">'c '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2.6863637325526679</span></span>) (<span class="hljs-number"><span class="hljs-number">7.088440394887126</span></span>, <span class="hljs-string"><span class="hljs-string">' brc'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">1.7075575253192956</span></span>) (<span class="hljs-number"><span class="hljs-number">7.1392598304831516</span></span>, <span class="hljs-string"><span class="hljs-string">' bra'</span></span>, <span class="hljs-string"><span class="hljs-string">'c '</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-number"><span class="hljs-number">2.6863637325526679</span></span>) (<span class="hljs-number"><span class="hljs-number">7.6831830622750497</span></span>, <span class="hljs-string"><span class="hljs-string">' brc '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">-0.0</span></span>) (<span class="hljs-number"><span class="hljs-number">8.0284469273601662</span></span>, <span class="hljs-string"><span class="hljs-string">' brac'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">1.7075575253192956</span></span>) (<span class="hljs-number"><span class="hljs-number">8.3621576081202385</span></span>, <span class="hljs-string"><span class="hljs-string">' a'</span></span>, <span class="hljs-string"><span class="hljs-string">'brc '</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-number"><span class="hljs-number">6.776535093383159</span></span>) (<span class="hljs-number"><span class="hljs-number">7.6954572168460142</span></span>, <span class="hljs-string"><span class="hljs-string">' ab'</span></span>, <span class="hljs-string"><span class="hljs-string">'rc '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">4.7044649199466617</span></span>) (<span class="hljs-number"><span class="hljs-number">6.7649184819335453</span></span>, <span class="hljs-string"><span class="hljs-string">' abr'</span></span>, <span class="hljs-string"><span class="hljs-string">'c '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2.6863637325526679</span></span>) (<span class="hljs-number"><span class="hljs-number">8.0284469273601662</span></span>, <span class="hljs-string"><span class="hljs-string">' abrc'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">1.7075575253192956</span></span>) (<span class="hljs-number"><span class="hljs-number">8.0792663629561936</span></span>, <span class="hljs-string"><span class="hljs-string">' abra'</span></span>, <span class="hljs-string"><span class="hljs-string">'c '</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-number"><span class="hljs-number">2.6863637325526679</span></span>) (<span class="hljs-number"><span class="hljs-number">8.6231895947480908</span></span>, <span class="hljs-string"><span class="hljs-string">' abrc '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">-0.0</span></span>) (<span class="hljs-number"><span class="hljs-number">8.6231895947480908</span></span>, <span class="hljs-string"><span class="hljs-string">' brac '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">-0.0</span></span>) (<span class="hljs-number"><span class="hljs-number">8.6740629096242063</span></span>, <span class="hljs-string"><span class="hljs-string">' brca'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-number"><span class="hljs-number">1.7075575253192956</span></span>) heap size <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> iterations {<span class="hljs-string"><span class="hljs-string">'brc'</span></span>: <span class="hljs-number"><span class="hljs-number">7.6831830622750497</span></span>, <span class="hljs-string"><span class="hljs-string">'abrc'</span></span>: <span class="hljs-number"><span class="hljs-number">8.6231895947480908</span></span>, <span class="hljs-string"><span class="hljs-string">'brac'</span></span>: <span class="hljs-number"><span class="hljs-number">8.6231895947480908</span></span>}</code> </pre> <br><h3 id="testirovanie-na-hobbitah">  Testing for hobbits </h3><br><p>  You can truly test written algorithms only with a good language model.  I was wondering how qualitatively the model would be able to decipher abbreviations, having studied on a deliberately limited corpus - one book, and even a specific subject.  The first book that came to my hand is "The Lord Of The Rings: The Fellowship Of The Ring".  Well, let's see how the Hobbit language can help decipher modern sports terms. </p><br><p>  For starters, the code for learning the model </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re <span class="hljs-comment"><span class="hljs-comment">#   with open('Fellowship_of_the_Ring.txt', encoding = 'utf-8') as f: text = f.read() #        text2 = re.sub(r'[^az ]+', '', text.lower().replace('\n', ' ')) all_letters = ''.join(list(sorted(list(set(text2))))) print(repr(all_letters)) # ' abcdefghijklmnopqrstuvwxyz' #      : missing_set = ( [(all_letters, '-' * len(all_letters))] * 3 #      + [(all_letters, all_letters)] * 10 #       + [('aeiouy', '------')] * 30 #      ) #    big_lang_m = LanguageNgramModel(order=4, smoothing=0.001, recursive=0.01) big_lang_m.fit(text2) big_err_m = MissingLetterModel(order=0, smoothing_missed=0.1) big_err_m.fit(missing_set)</span></span></code> </pre> <br><pre> <code class="hljs cs"><span class="hljs-string"><span class="hljs-string">' abcdefghijklmnopqrstuvwxyz'</span></span></code> </pre> <br><p>  I chose the four-gram model of the language by comparing the plausibility of different models on the ‚Äútest sample‚Äù at the very end of the book.  It turned out that the quality of predicting the probability of letters increases with the growth of the model order to 4. I did not use even greater order, because with the growth of the order, the speed of the model decreases greatly. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">5</span></span>): tmp = LanguageNgramModel(i, <span class="hljs-number"><span class="hljs-number">0.001</span></span>, <span class="hljs-number"><span class="hljs-number">0.01</span></span>) tmp.fit(text2[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">-5000</span></span>]) print(i, tmp.single_log_proba(<span class="hljs-string"><span class="hljs-string">' '</span></span>, text2[<span class="hljs-number"><span class="hljs-number">-5000</span></span>:]))</code> </pre> <br><pre> <code class="hljs css">0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-13858</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.8600648</span></span> 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-11608</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.8867664</span></span> 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-9235</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.21749986</span></span> 3 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-7461</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.78935696</span></span> 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-6597</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.9544372</span></span></code> </pre> <br><p>  Let's apply our algorithm to different abbreviations.  Sam, I thought of, for example, recognized the model without difficulty, and also added other options (however, with a higher speed, and therefore less believable). </p><br><pre> <code class="python hljs">noisy_channel(<span class="hljs-string"><span class="hljs-string">'sm'</span></span>, big_lang_m, big_err_m)</code> </pre> <br><pre> <code class="hljs cs">{<span class="hljs-string"><span class="hljs-string">'sam'</span></span>: <span class="hljs-number"><span class="hljs-number">7.3438449620080997</span></span>, <span class="hljs-string"><span class="hljs-string">'same'</span></span>: <span class="hljs-number"><span class="hljs-number">9.5091694602417469</span></span>, <span class="hljs-string"><span class="hljs-string">'some'</span></span>: <span class="hljs-number"><span class="hljs-number">7.6890573935288824</span></span>}</code> </pre> <br><p>  Frodo is also recognized without problems. </p><br><pre> <code class="python hljs">noisy_channel(<span class="hljs-string"><span class="hljs-string">'frd'</span></span>, big_lang_m, big_err_m)</code> </pre> <br><pre> <code class="hljs cs">{<span class="hljs-string"><span class="hljs-string">'frodo'</span></span>: <span class="hljs-number"><span class="hljs-number">6.8904938902680888</span></span>}</code> </pre> <br><p>  The ring is uniquely guessed. </p><br><pre> <code class="python hljs">noisy_channel(<span class="hljs-string"><span class="hljs-string">'rng'</span></span>, big_lang_m, big_err_m)</code> </pre><br><pre> <code class="hljs cs">{<span class="hljs-string"><span class="hljs-string">'ring'</span></span>: <span class="hljs-number"><span class="hljs-number">7.6317120419343913</span></span>}</code> </pre> <br><p>  Before running "wtrbtl", check the decryption in parts.  With water, everything is fine. </p><br><pre> <code class="python hljs">noisy_channel(<span class="hljs-string"><span class="hljs-string">'wtr'</span></span>, big_lang_m, big_err_m)</code> </pre> <br><pre> <code class="hljs cs">{<span class="hljs-string"><span class="hljs-string">'water'</span></span>: <span class="hljs-number"><span class="hljs-number">8.6405279255413898</span></span>}</code> </pre> <br><p>  The bottle is not so confidently recognized by the model.  Still, the battle in "The Lord of the Rings" are often referred to as bottles. </p><br><pre> <code class="python hljs">noisy_channel(<span class="hljs-string"><span class="hljs-string">'btl'</span></span>, big_lang_m, big_err_m)</code> </pre> <br><pre> <code class="hljs cs">{<span class="hljs-string"><span class="hljs-string">'battle'</span></span>: <span class="hljs-number"><span class="hljs-number">12.620490427990008</span></span>, <span class="hljs-string"><span class="hljs-string">'bottle'</span></span>: <span class="hljs-number"><span class="hljs-number">13.3327872548629</span></span>, <span class="hljs-string"><span class="hljs-string">'but all'</span></span>: <span class="hljs-number"><span class="hljs-number">14.66815480120338</span></span>, <span class="hljs-string"><span class="hljs-string">'but ill'</span></span>: <span class="hljs-number"><span class="hljs-number">15.387630853411283</span></span>}</code> </pre> <br><p>  For example, in the following phrases: </p><br><pre> <code class="python hljs">noisy_channel(<span class="hljs-string"><span class="hljs-string">'batlhrse'</span></span>, big_lang_m, big_err_m)</code> </pre> <br><pre> <code class="hljs cs">{<span class="hljs-string"><span class="hljs-string">'battle horse'</span></span>: <span class="hljs-number"><span class="hljs-number">25.194823785457018</span></span>, <span class="hljs-string"><span class="hljs-string">'battle horses'</span></span>: <span class="hljs-number"><span class="hljs-number">27.40528952535044</span></span>}</code> </pre> <br><p>  There are a lot of alternatives for a bottle of water: </p><br><pre> <code class="python hljs">noisy_channel(<span class="hljs-string"><span class="hljs-string">'wtrbtl'</span></span>, big_lang_m, big_err_m)</code> </pre> <br><pre> <code class="hljs cs">{<span class="hljs-string"><span class="hljs-string">'water battle'</span></span>: <span class="hljs-number"><span class="hljs-number">23.76999162985074</span></span>, <span class="hljs-string"><span class="hljs-string">'water bottle'</span></span>: <span class="hljs-number"><span class="hljs-number">23.962598992336815</span></span>, <span class="hljs-string"><span class="hljs-string">'water but all'</span></span>: <span class="hljs-number"><span class="hljs-number">24.445047133561353</span></span>, <span class="hljs-string"><span class="hljs-string">'water but ill'</span></span>: <span class="hljs-number"><span class="hljs-number">25.164523185769259</span></span>, <span class="hljs-string"><span class="hljs-string">'water but lay'</span></span>: <span class="hljs-number"><span class="hljs-number">25.601336188357113</span></span>, <span class="hljs-string"><span class="hljs-string">'water but lie'</span></span>: <span class="hljs-number"><span class="hljs-number">26.668305553728047</span></span>}</code> </pre> <br><p>  But the basketball (never seen) model recognized almost correctly, since the word "basket" was used in the training text.  But in order to do this, we had to manually increase the width of the "beam" from which the model chooses options. </p><br><pre> <code class="python hljs">print(noisy_channel(<span class="hljs-string"><span class="hljs-string">'bsktball'</span></span>, big_lang_m, big_err_m, freedom=<span class="hljs-number"><span class="hljs-number">5</span></span>))</code> </pre> <br><pre> <code class="hljs cs">{<span class="hljs-string"><span class="hljs-string">'bsktball'</span></span>: <span class="hljs-number"><span class="hljs-number">33.193085889457429</span></span>, <span class="hljs-string"><span class="hljs-string">'basket ball'</span></span>: <span class="hljs-number"><span class="hljs-number">33.985227947093364</span></span>}</code> </pre> <br><p>  But the word "ball" in the training text did not occur once, and the model did not restore it on its own (but Bilbo was suspected of the name in "bl").  The word "bowling" in the "Lord of the Rings" also never met, but based on some general idea of ‚Äã‚Äãthe language, the model still suggested it. </p><br><pre> <code class="python hljs">print(noisy_channel(<span class="hljs-string"><span class="hljs-string">'bwlingbl'</span></span>, big_lang_m, big_err_m, freedom=<span class="hljs-number"><span class="hljs-number">5</span></span>))</code> </pre> <br><pre> <code class="hljs cs">{<span class="hljs-string"><span class="hljs-string">'bwling blue'</span></span>: <span class="hljs-number"><span class="hljs-number">31.318936077746862</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling bilbo'</span></span>: <span class="hljs-number"><span class="hljs-number">30.695249686758611</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling ble'</span></span>: <span class="hljs-number"><span class="hljs-number">34.490254059547475</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling black'</span></span>: <span class="hljs-number"><span class="hljs-number">31.980325659562851</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling blow'</span></span>: <span class="hljs-number"><span class="hljs-number">33.15061216480305</span></span>, <span class="hljs-string"><span class="hljs-string">'bewilling blue'</span></span>: <span class="hljs-number"><span class="hljs-number">30.937989778499748</span></span>, <span class="hljs-string"><span class="hljs-string">'bewilling bilbo'</span></span>: <span class="hljs-number"><span class="hljs-number">30.314303387511497</span></span>, <span class="hljs-string"><span class="hljs-string">'bewilling ble'</span></span>: <span class="hljs-number"><span class="hljs-number">34.109307760300361</span></span>, <span class="hljs-string"><span class="hljs-string">'bewilling black'</span></span>: <span class="hljs-number"><span class="hljs-number">31.599379360315737</span></span>, <span class="hljs-string"><span class="hljs-string">'bewilling blin'</span></span>: <span class="hljs-number"><span class="hljs-number">34.685939493896406</span></span>, <span class="hljs-string"><span class="hljs-string">'bewilling blow'</span></span>: <span class="hljs-number"><span class="hljs-number">32.769665865555929</span></span>, <span class="hljs-string"><span class="hljs-string">'bewilling bill'</span></span>: <span class="hljs-number"><span class="hljs-number">32.156071732628014</span></span>, <span class="hljs-string"><span class="hljs-string">'bewilling below'</span></span>: <span class="hljs-number"><span class="hljs-number">32.195518180732158</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling bill'</span></span>: <span class="hljs-number"><span class="hljs-number">32.537018031875135</span></span>, <span class="hljs-string"><span class="hljs-string">'bewilling belia'</span></span>: <span class="hljs-number"><span class="hljs-number">32.550377929021479</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling below'</span></span>: <span class="hljs-number"><span class="hljs-number">32.576464479979279</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling belia'</span></span>: <span class="hljs-number"><span class="hljs-number">32.931324228268608</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling belt'</span></span>: <span class="hljs-number"><span class="hljs-number">33.203704016765826</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling bling'</span></span>: <span class="hljs-number"><span class="hljs-number">33.393527121566656</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling bell'</span></span>: <span class="hljs-number"><span class="hljs-number">34.180762531759534</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling blue'</span></span>: <span class="hljs-number"><span class="hljs-number">30.676613106535022</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling bilbo'</span></span>: <span class="hljs-number"><span class="hljs-number">30.052926715546771</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling ble'</span></span>: <span class="hljs-number"><span class="hljs-number">33.847931088335635</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling black'</span></span>: <span class="hljs-number"><span class="hljs-number">31.338002688351011</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling blin'</span></span>: <span class="hljs-number"><span class="hljs-number">34.42456282193168</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling blow'</span></span>: <span class="hljs-number"><span class="hljs-number">32.508289193591203</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling bill'</span></span>: <span class="hljs-number"><span class="hljs-number">31.894695060663285</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling below'</span></span>: <span class="hljs-number"><span class="hljs-number">31.934141508767446</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling bl'</span></span>: <span class="hljs-number"><span class="hljs-number">34.983414721126472</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling blad'</span></span>: <span class="hljs-number"><span class="hljs-number">34.992926061009179</span></span>, <span class="hljs-string"><span class="hljs-string">'bowling belia'</span></span>: <span class="hljs-number"><span class="hljs-number">32.289001257056761</span></span>, <span class="hljs-string"><span class="hljs-string">'bwling blind'</span></span>: <span class="hljs-number"><span class="hljs-number">35.000922570770712</span></span>}</code> </pre> <br><h3 id="generaciya-uporotyh-tekstov">  Generate uporotyh texts </h3><br><p>  In the end, in order to cheer you up a bit, I tried to turn the piece of the ‚ÄúLord of the Rings‚Äù text itself into cuts.  It turned out strange. </p><br><pre> <code class="python hljs">part = text[<span class="hljs-number"><span class="hljs-number">10502</span></span>:<span class="hljs-number"><span class="hljs-number">11149</span></span>] result = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(part): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> np.random.rand() * <span class="hljs-number"><span class="hljs-number">0.5</span></span> &lt; big_err_m.single_proba(part[<span class="hljs-number"><span class="hljs-number">0</span></span>:i], letter): result += letter print(result)</code> </pre> <br><pre> <code class="hljs pgsql">This bok s largly cncernd wth Hbbts, nd frm its pges readr ma dscver much f thir charctr nd littl f thir hstr. Furthr nfrmaton will als b fond n the selction <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> the Red Bok f Wstmarch that hs already ben publishd, ndr th ttle <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> The Hobbit. Tht stor was dervd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> the arlir chpters <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the Red Bok, cmpsed <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> Blbo hmslf, th first Hobbit t bcome famos n the world at <span class="hljs-keyword"><span class="hljs-keyword">large</span></span>, nd clld b him There <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Bck Again, sinc thy tld f his journey <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> th East <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> his <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>: n dvntr whch latr nvolved <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> the Hobbits n th grat vnts <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> that Ag that re hr rlatd.</code> </pre> <br><p>  The linguistic model can be used to generate text "in Tolkien's style", though without any sense. </p><br><pre> <code class="python hljs">np.random.seed(<span class="hljs-number"><span class="hljs-number">20</span></span>) text = <span class="hljs-string"><span class="hljs-string">"Frodo"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">300</span></span>): proba = big_lang_m.predict_proba(text) text += np.random.choice(proba.index, size=<span class="hljs-number"><span class="hljs-number">1</span></span>, p=proba)[<span class="hljs-number"><span class="hljs-number">0</span></span>] print(text+<span class="hljs-string"><span class="hljs-string">'.'</span></span>)</code> </pre> <br><pre> <code class="hljs pgsql">Frodo would me but them but his slipped <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> he see said pippin silent the names <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> follow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> days are <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> the hobbits rever <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> forward spoke ened <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> many <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> idle <span class="hljs-keyword"><span class="hljs-keyword">off</span></span> they hand we cried plunged they lit a simply attack struggled itself it <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a what it was barrow the will the ears what <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> grow.</code> </pre> <br><p>  The science of data has not yet learned to generate "from scratch" connected texts.  For this, we need a real artificial intelligence, possessing an understanding of the plot that unfolded once in Middle-earth. </p><br><h3 id="zaklyuchenie">  Conclusion </h3><br><p>  Natural language processing is actually a very complex blend of science, technology, and magic.  Even linguistic scholars do not fully understand the laws according to which speech is arranged.  And until the time when the machines will be able to understand the texts in the full sense of the word, it‚Äôs not very soon. </p><br><p>  Natural language processing is also fun.  Armed with a pair of statistical models, it turns out, you can both recognize and generate unobvious abbreviations.  For those who want to continue my entertainment, <a href="https://github.com/avidale/weirdMath/blob/master/nlp/abbreviation_spellchecker_russian.ipynb">here is the</a> complete experiment code. </p><br><p>  But if you replace the n-gram model with a recurrent neural network, you can generate texts of a higher degree of connectivity (and even almost compiled code).  In the near future I will try to generate a typical Habr-style neuron article (which I have already <a href="http://habrahabr.ru/post/346198/">submitted</a> ), so subscribe and wait :) </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/346578/">https://habr.com/ru/post/346578/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346564/index.html">Richard Hamming: Chapter 19. Modeling - II</a></li>
<li><a href="../346566/index.html">Richard Hamming: Chapter 4. Computer History - Software</a></li>
<li><a href="../346572/index.html">The tale of total brute force, or the tormenting wait of the decrypt</a></li>
<li><a href="../346574/index.html">Selfish problems: traffic jams and the Braes paradox</a></li>
<li><a href="../346576/index.html">KDB</a></li>
<li><a href="../346580/index.html">How will be organized trading in Bitcoin futures on the Chicago Stock Exchange</a></li>
<li><a href="../346582/index.html">Risk management in the fairy tale of A.S. Pushkin ‚ÄúOn the Fisherman and the Fish‚Äù</a></li>
<li><a href="../346584/index.html">How to do typical tasks in a web application on React JS</a></li>
<li><a href="../346586/index.html">How to build a community. Translation of the book "Social Architecture": The Myth of Individual Intelligence</a></li>
<li><a href="../346588/index.html">Remote work, is it good or bad?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>