<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cdr. Save and Grow</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Very often, creating a CDR database is given little space in the setup descriptions. As a rule, it all comes down to quoting SQL commands and promisin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cdr. Save and Grow</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6d/3c6/29e/c6d3c629ec2cba8c0d0ab23824f711d8.png" alt="image"></div><br>  Very often, creating a CDR database is given little space in the setup descriptions.  As a rule, it all comes down to quoting SQL commands and promising that if you throw it into the console, then ‚Äúeverything will be OK‚Äù. <br><a name="habracut"></a><br>  For example, the very first link in Google recommends creating a label like this: <br><br><blockquote><pre><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`cdr`</span></span> ( <span class="hljs-string"><span class="hljs-string">`calldate`</span></span> datetime <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">'0000-00-00 00:00:00'</span></span>, <span class="hljs-string"><span class="hljs-string">`clid`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`src`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`dst`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`dcontext`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`channel`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`dstchannel`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`lastapp`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`lastdata`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`duration`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">`billsec`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">`disposition`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">45</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`amaflags`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">`accountcode`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`userfield`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`cdr`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> ( <span class="hljs-string"><span class="hljs-string">`calldate`</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`cdr`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> ( <span class="hljs-string"><span class="hljs-string">`dst`</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`cdr`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> ( <span class="hljs-string"><span class="hljs-string">`accountcode`</span></span> );</code> </pre> </blockquote><br>  You can immediately note that at least two indices in the database are useless.  This is calldate and accountcode.  The first one is due to the fact that with the addition of records every second, the size of the index will be equal to the number of records in the database itself.  Yes, this index is sorted, and you can apply some ways to speed up the search, but will it be effective?  The second index (accountcode) is <b>almost</b> never used by anyone.  As an experimental base - base with 80 million records. <br><br>  Run the query: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> CDR <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> src=***** <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> calldate&gt;<span class="hljs-string"><span class="hljs-string">'2016-06-21'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> calldate&lt;<span class="hljs-string"><span class="hljs-string">'2016-06-22'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* Affected rows: 0  : 4 : 0  1 query: 00:09:36 */</span></span></code> </pre> <br>  Almost 10 minutes of waiting. <br><br>  In other words, creating reports becomes a problem.  Of course, the tablet can be ratiated, but why such sacrifices, if it is enough to optimize. <br><br>  <b>Attention!</b>  <b>Never do it in production!</b>  <b>Only on a copy of the base!</b>  <b>The database is locked for a while from 1 hour to several hours and data may be lost upon abnormal termination!</b> <br><br>  So, two steps to the success of efficient CDR storage: <br><br><ol><li>  Split into partitions to speed up the sample by period </li><li>  Efficient indexing </li></ol><br>  Step 0. Select storage engine <br><br>  Actually there are two common options - MyISAM and INNODB.  Holivarit on this topic can be infinitely long, but a comparison of engines on a real base gave an advantage in favor of MyISAM. <br><br>  There are several reasons for this: <br><br><ul><li>  With a clean server setup by an inexperienced admin, MyISAM works more correctly when indexing large volumes.  While INNODB requires tuning.  Otherwise, you can see interesting errors that the index can not be rebuilt. </li><li>  MyISAM with the inclusion of the option FIXED ROW acquires additional properties, namely: <br><br><ol><li>  Resilience even when server crashes </li><li>  The ability to read a file directly from an external application, bypassing the MySQL server, which is useful </li><li>  Speed ‚Äã‚Äãof access to random lines is higher, due to the fact that all lines have the same length </li></ol></li></ul><br>  In other words, MyISAM is the best for logging (IMHO). <br><br>  Let's stop on it. <br><br><h3>  Step 1. Partitions. <br></h3><br>  In view of the fact that we either supplement the base or read from it, we can effectively divide the base into files once and for all, in order to reduce the possible number of hits when reading certain time intervals.  Naturally, you need to break the base on some key.  But for what?  Definitely, it should be time, but is it effective to beat the base by calldate?  I think not, therefore we introduce an additional field, which we also need in the next step.  Namely - the date.  Just a date, without time. <br><br>  Enter an additional date field, and make a very simple trigger on the tablet, before update cdr: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> new.date=<span class="hljs-built_in"><span class="hljs-built_in">DATE</span></span>(new.calldate); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span></code> </pre><br>  Thus, in this field we get only the date.  And immediately break the plate into partitions by year: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> cdr <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RANGE</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">YEAR</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">date</span></span>)) (<span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">old</span></span> <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LESS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THAN</span></span> (<span class="hljs-number"><span class="hljs-number">2015</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span> = MyISAM, <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> p2015 <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LESS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THAN</span></span> (<span class="hljs-number"><span class="hljs-number">2016</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span> = MyISAM, <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> p2016 <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LESS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THAN</span></span> (<span class="hljs-number"><span class="hljs-number">2017</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span> = MyISAM, <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> p2018 <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LESS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THAN</span></span> (<span class="hljs-number"><span class="hljs-number">2018</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span> = MyISAM, <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> p2019 <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LESS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THAN</span></span> (<span class="hljs-number"><span class="hljs-number">2019</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span> = MyISAM, <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> p2020 <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LESS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THAN</span></span> (<span class="hljs-number"><span class="hljs-number">2020</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span> = MyISAM, <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> p2021 <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LESS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THAN</span></span> (<span class="hljs-number"><span class="hljs-number">2021</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span> = MyISAM, <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> p2022 <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LESS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THAN</span></span> (<span class="hljs-number"><span class="hljs-number">2022</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span> = MyISAM, <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> p2023 <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LESS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THAN</span></span> (<span class="hljs-number"><span class="hljs-number">2023</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span> = MyISAM, <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> pMAXVALUE <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LESS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THAN</span></span> MAXVALUE <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span> = MyISAM)</code> </pre> <br>  Done, now if we do the sampling with the indication of the date range, then MySQL will not have to shovel the entire database for all the years.  A small plus sign is already there. <br><br><h3>  Step 2. Index the base. </h3><br>  Actually, this is the most important step.  Experiments show that in 90% of cases there is a need for indexes on 3 columns (as needed): <br><br><ol><li>  date </li><li>  src </li><li>  dst </li></ol><br><h4>  date </h4><br>  MySQL can only use one index at a time, so some administrators are trying to create composite indexes.  Their effect is not very high, because, as a rule, you have to choose ranges, and in this case composite indexes are ignored by MySQL, i.e.  FullScan happens.  We can not correct the whining behavior, but we can make it so that the number of lines for scanning is minimal and give the engine a choice of which index to use.  On the one hand, we need maximum detail of the index, on the other hand, we need to spend as few operations as possible to get the range that we will iterate.  That is why I recommend using the index on the date field, rather than calldate.  The number of elements in the index will be equal to the number of days since the beginning of the database, which will allow the database to quickly move to the right lines. <br><br>  There is another way to help the database - to make it so that it can calculate the position of the line in the file even BEFORE opening the file.  For this you can use FIXED ROW.  The position of the line in the file will be calculated by multiplying the line number by the length of the line, and not by enumeration.  Naturally, that approach has victims - the base will take up much more disk space.  Here for example: <br><br><img src="https://habrastorage.org/files/0f8/457/2f9/0f84572f94da472d90e5d80f29e4fd5d.png"><br><br>  The size of the base has grown from 18 GB to 53.8 GB.  Do or not - the choice of each admin, but if space on the server allows, then this will be another plus. <br><br><h4>  src, dst </h4><br>  There is a little less room for optimization.  More precisely, one thing: <br><br>  If you do not use text numbers, for example in softphones, then these fields can be converted to BigInt, which will also have a very good effect on indexing and sampling.  But if you, like us, use text numbers, then this optimization is not for you and you will have to accept lower productivity. <br><br>  As a cherry on the cake - we clean up those fields that do not interest us and set the size of the fields in the expected for our case.  I did it like this: <br><br><img src="https://habrastorage.org/files/3ee/b01/2bf/3eeb012bf3ce4a91bc81c5d5988e1751.png"><br><br>  Well, the final query: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> CDR <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> src=***** <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-built_in"><span class="hljs-built_in">date</span></span>=<span class="hljs-string"><span class="hljs-string">'2016-06-21'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* Affected rows: 0  : 4 : 0  1 query: 0,577 sec. */</span></span></code> </pre> <br>  Increase by two orders of magnitude. <br><br>  For example, by range: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> CDR <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> src=***** <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-built_in"><span class="hljs-built_in">date</span></span>&gt;<span class="hljs-string"><span class="hljs-string">'2016-09-01'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-built_in"><span class="hljs-built_in">date</span></span>&lt;<span class="hljs-string"><span class="hljs-string">'2016-09-05'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* Affected rows: 0  : 1 : 0  1 query: 3,900 sec. */</span></span></code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/318770/">https://habr.com/ru/post/318770/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318760/index.html">3CX brings together Elastix and PBX in a Flash communities</a></li>
<li><a href="../318762/index.html">Programming multi-core DSP processors TMS320C66x using OpenMP</a></li>
<li><a href="../318764/index.html">Roaming in Wi-Fi networks without using a controller</a></li>
<li><a href="../318766/index.html">Founder's advice. Evgeny Kobzev, technical director and co-founder of the company "Button"</a></li>
<li><a href="../318768/index.html">Second Coming GOST 28147-89: Honest Tests</a></li>
<li><a href="../318772/index.html">Pimcore licensing FAQ</a></li>
<li><a href="../318774/index.html">About recovery. Is RAID on a VPS SSD advisable in case of dedicated drives? Analog server until February for free</a></li>
<li><a href="../318776/index.html">Stylish Python code, or learning to use Flake8</a></li>
<li><a href="../318778/index.html">PHPixie Cache: PSR-6, PSR-16 and some interesting features</a></li>
<li><a href="../318780/index.html">Approaches to design in virtual reality</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>