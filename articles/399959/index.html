<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The campaign of malicious advertising is aimed not at the browser and not at the computer, but at the router</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The developers of malicious software are looking for new ways to infect computers. The goal is to steal data, encrypt files with the requirement of "r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The campaign of malicious advertising is aimed not at the browser and not at the computer, but at the router</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/47f/d1f/d58/47fd1fd58fd94c5f48c86ef2a949d4fb.jpg" alt="image"><br><br>  The developers of malicious software are looking for new ways to infect computers.  The goal is to steal data, encrypt files with the requirement of "ransom", show off third-party advertisements, clicks on which bring money to cybercriminals.  Recently, information security experts from the company <a href="https://www.proofpoint.com/us">Proofpoint</a> found exactly such software.  And instead of a browser or operating system, it infects routers.  The new DNSChanger EK is called. <br><br>  The work pattern of cybercriminals is <a href="https://www.proofpoint.com/us/threat-insight/post/home-routers-under-attack-malvertising-windows-android-devices">relatively simple</a> .  They buy ads on popular sites, and they inject a script into this ad using a WebRTC request to the Mozilla STUN server.  The goal is to determine the local IP of the user who has entered the site with infected advertising banners. <br><a name="habracut"></a><br>  If the public address is already known or not in the range of goals, then the user is shown a regular banner from a third-party advertising network.  If you need to act (that is, if the network provides the router), then in this case JavaScript, attached to the advertisement, takes the PNG code from the comment field of the HTML code and opens the DNSChanger EK landing page. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/geektimes/post_images/908/ee1/03f/908ee103f43895aede41acccabbd3153.png"><br>  <font color="gray">Fake advertisements that redirect user requests to attackers' servers</font> <br><br>  From this moment the exploit starts working.  If the user's router is vulnerable (this is determined automatically), an image file with an AES encryption key embedded by steganography is sent to its browser.  The key allows the script in the "poisoned" ad to decode the traffic that the victim's PC receives from the exploit.  Moreover, all operations of cybercriminals are encrypted so as not to show the ins and outs of the process to information security specialists. <br><br>  After the victim receives the key, the exploit sends a list of the "prints" of the routers.  According to experts, now there are more than 166 "prints" on the list.  The script placed in the advertisement analyzes the router that the victim uses and sends the result of the survey to the server of the exploit.  If the user's system is identified as vulnerable, the attack on the device begins using a specific set of hacking tools or a set of default password / login sets for each specific device model. <br><br>  All this is done to change the DNS settings of the victim‚Äôs router in order to configure the redirect of the traffic through the attacker's servers.  The operation itself takes place in seconds, this is only a description of the process itself looks long.  If the settings of the router allow you to do this, the attackers open the control ports for external connection in order to control the infected devices directly.  The researchers claim that they watched as the attackers opened control ports for 36 routers from 166 devices on the list. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/11a/77b/0e4/11a77b0e453328dcab2989b356f542c2.png"><br>  <font color="gray">Scheme of attack ekploita DNSChanger</font> <br><br>  In case the attack is successful, advertisements of such networks as AdSupply, OutBrain, Popcash, Propellerads, Taboola in the user's browser change the advertising inserts of intruders.  Plus, advertising is shown now even on those sites where it does not exist. <br><br>  It is worth noting that DNSChanger is <a href="https://www.bleepingcomputer.com/news/security/malvertising-campaign-infects-your-router-instead-of-your-browser/">aimed at attacking</a> users with the Chrome browser, and not Internet Explorer, as in most cases.  Moreover, attacks are carried out by attackers for both desktops and mobile devices.  Advertising is shown on desktops and mobile devices. <br><br>  Unfortunately, so far information security specialists cannot determine the entire list of vulnerable rotoers.  But it is known that it includes device models from manufacturers such as Linksys, Netgear, D-Link, Comtrend, Pirelli, and Zyxel.  Among the vulnerable routers, experts from Proofpoint can name such devices: <br><br><ul><li>  D-Link DSL-2740R </li><li>  COMTREND ADSL Router CT-5367 C01_R12 </li><li>  NetGear WNDR3400v3 (and, probably, all other systems from the same lineup) </li><li>  Pirelli ADSL2 / 2 + Wireless Router P.DGA4001N </li><li>  Netgear R6200 </li></ul><br><img src="https://habrastorage.org/getpro/geektimes/post_images/abc/247/7b7/abc2477b76f58e123faefc0c3b58e50c.png"><br>  <font color="gray">Analysis of DNSChanger EK traffic passing through a router hacked by intruders</font> <br><br>  Of course, the problem is not only that the victim sees the advertisement being imposed in his browser.  The main thing is that attackers have the ability to manage user traffic, which means that it will be possible to remove a bank card data and steal personal data from any other sites, including social networks.  When infecting a sufficiently large number of systems, cybercriminals will be able to form their own botnet. <br><br>  And it is clear that not single users <a href="https://it.slashdot.org/story/16/12/14/2059217">are</a> hit, but all members of the local network formed by the compromised router. <br><br><h3>  What to do? </h3><br>  Since the attack is made through the user's browser, and attackers are able to <a href="http://malware.dontneedcoffee.com/2015/05/an-exploit-kit-dedicated-to-csrf.html">intercept</a> traffic, simply changing the password / login for the administrator of the router or disabling the administrator interface may not be enough. <br><br>  The only way to feel safe is to upgrade the router firmware to the newest version, which most likely already includes protection against the actions of exploits from the DNSChanger EK package. <br><br>  The Proofpoint team notes that a large number of ‚Äúpoisoned‚Äù advertisements placed by attackers are hiding with the help of blockers.  So users of software blocking this type of advertising are less vulnerable than those users who do not try to hide ads. <br><br>  Unfortunately, the problem is that the router manufacturers are not actively releasing security updates for their devices.  If they responded in a timely manner, the attacks of the attackers would be less successful and much smaller. </div><p>Source: <a href="https://habr.com/ru/post/399959/">https://habr.com/ru/post/399959/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../399949/index.html">John Glenn died, the first American to make an orbital flight.</a></li>
<li><a href="../399951/index.html">Who is to blame for the slowness of games on PC - processors or video cards? We define the "extreme" on the example of modern games</a></li>
<li><a href="../399953/index.html">Fight for a sound: timbre - psychoacoustics vs subjectivism</a></li>
<li><a href="../399955/index.html">Small secrets trace boards with operating and instrumentation amplifiers</a></li>
<li><a href="../399957/index.html">Physics of Spiderman with his new spider wings</a></li>
<li><a href="../399963/index.html">NSA tools are now sold by the piece</a></li>
<li><a href="../399965/index.html">Messenger readings by Professor Richard Feynman</a></li>
<li><a href="../399967/index.html">Interview with the author of the project MK-17, a three-wheeled covered motorcycle for Russian weather conditions</a></li>
<li><a href="../399969/index.html">HBO forced to remove the children's drawing with the inscription "Winter is close"</a></li>
<li><a href="../399971/index.html">Fitbit promises to support Pebble for another 1 year</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>