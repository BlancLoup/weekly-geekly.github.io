<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Notifications in iOS 10</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Notifications in iOS 10 


 They say that at this WWDC there was nothing interesting, except for interactive notifications. Indeed, new notifications ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Notifications in iOS 10</h1><div class="post__text post__text-html js-mediator-article"><h1>  Notifications in iOS 10 </h1><br><p> They say that at this WWDC there was nothing interesting, except for interactive notifications.  Indeed, new notifications are one of the most interesting new features.  Not only for developers, but also for ordinary users.  In iOS 10, they tried to unify work with local and push notifications and added a new framework <code>UserNotifications.framework</code> for this.  The old API is now forbidden (deprecated), but you can use it as long as you support iOS 9. </p><br><p>  New notifications can: </p><br><ul><li>  show attachments (pictures and video) </li><li>  display custom UI </li><li>  show standard UI in active application (why so long! 11) </li><li>  remove yourself from the notification center (!! 1) </li></ul><br><p>  In this article we will understand how this works.  It will be interesting not only to developers, but also to UX designers. </p><a name="habracut"></a><br><p><img src="https://habrastorage.org/files/8c8/d0d/10a/8c8d0d10a5f54f15a7ac4539882e8f05.jpg"></p><br><h2>  Notification Registration </h2><br><p>  Notifications are now managed by the <code>UNUserNotificationCenter</code> class.  As before, during registration, you must specify the types of notifications that the system will process ( <code>.alert</code> , <code>.sound</code> , <code>.badge</code> ).  But, instead of the <code>UIUserNotificationType</code> type, these values ‚Äã‚Äãare now of type <code>UNAuthorizationOptions</code> .  Subscribing to notifications now happens like this: </p><br><pre> <code class="hljs mel">UNUserNotificationCenter.current().requestAuthorization([.alert, .<span class="hljs-keyword"><span class="hljs-keyword">sound</span></span>, .badge]) { (granted, <span class="hljs-keyword"><span class="hljs-keyword">error</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> granted { UIApplication.shared().registerForRemoteNotifications() } }</code> </pre> <br><p>  Old methods of working with notifications will still be relevant for several years, so you need to take care of their support.  For compatibility with iOS8 +, we will make a method that allows you to convert the list of options from <code>UIUserNotificationType</code> to <code>UNAuthorizationOptions</code> : </p><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIUserNotificationType</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@available</span></span>(iOS <span class="hljs-number"><span class="hljs-number">10.0</span></span>, *) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">authorizationOptions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UNAuthorizationOptions</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> options: <span class="hljs-type"><span class="hljs-type">UNAuthorizationOptions</span></span> = [] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>(.alert) { options.formUnion(.alert) } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>(.sound) { options.formUnion(.sound) } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>(.badge) { options.formUnion(.badge) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> options } }</code> </pre> <br><p>  Now it‚Äôs easy to subscribe to pushy to support both APIs: </p><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerForNotifications</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(types: UIUserNotificationType)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> #available(iOS <span class="hljs-number"><span class="hljs-number">10.0</span></span>, *) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> options = types.authorizationOptions() <span class="hljs-type"><span class="hljs-type">UNUserNotificationCenter</span></span>.current().requestAuthorization(options) { (granted, error) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> granted { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.application.registerForRemoteNotifications() } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> settings = <span class="hljs-type"><span class="hljs-type">UIUserNotificationSettings</span></span>(types: types, categories: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) application.registerUserNotificationSettings(settings) application.registerForRemoteNotifications() } }</code> </pre> <br><h2>  Sending Notifications </h2><br><p>  There are two new entities for sending notifications: a <code>UNNotificationTrigger</code> trigger and a <code>UNNotificationRequest</code> request. </p><br><p>  The <code>UNNotificationTrigger</code> trigger <code>UNNotificationTrigger</code> needed in order to set the condition under which the notification will be delivered.  There are four types of triggers: </p><br><ul><li>  <code>UNPushNotificationTrigger</code> - set by the system automatically upon receipt of a push. </li><li>  <code>UNTimeIntervalNotificationTrigger</code> - will work after a specified period of time </li><li>  <code>UNCalendarNotificationTrigger</code> - will work at a specific time in the future. </li><li>  <code>UNLocationNotificationTrigger</code> - will work when entering / exiting a given georegion. </li></ul><br><p>  The <code>UNNotificationRequest</code> request <code>UNNotificationRequest</code> used to send a notification to the system.  Also, the system will give you this object when it receives a notification.  It is convenient to use to check the type of notification and switch to a specific screen in the application. </p><br><p>  So you can send a local notification, while maintaining compatibility with older versions of iOS: </p><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scheduleNotification</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(identifier: String, title: String, subtitle: String, body: String, timeInterval: TimeInterval, repeats: Bool = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> #available(iOS <span class="hljs-number"><span class="hljs-number">10</span></span>, *) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> content = <span class="hljs-type"><span class="hljs-type">UNMutableNotificationContent</span></span>() content.title = title content.subtitle = subtitle content.body = body <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> trigger = <span class="hljs-type"><span class="hljs-type">UNTimeIntervalNotificationTrigger</span></span>(timeInterval: timeInterval, repeats: repeats) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> request = <span class="hljs-type"><span class="hljs-type">UNNotificationRequest</span></span>(identifier: identifier, content: content, trigger: trigger) <span class="hljs-type"><span class="hljs-type">UNUserNotificationCenter</span></span>.current().add(request, withCompletionHandler: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> notification = <span class="hljs-type"><span class="hljs-type">UILocalNotification</span></span>() notification.alertBody = <span class="hljs-string"><span class="hljs-string">"\(title)\n\(subtitle)\n\(body)"</span></span> notification.fireDate = <span class="hljs-type"><span class="hljs-type">Date</span></span>(timeIntervalSinceNow: <span class="hljs-number"><span class="hljs-number">1</span></span>) application.scheduleLocalNotification(notification) } }</code> </pre> <br><h2>  Display in active application </h2><br><p>  In iOS 10, you can now display received notifications in the active application.  As usual, they will float right above the status bar and have a systematic design and behavior. </p><br><p><img src="https://habrastorage.org/files/35a/82c/aeb/35a82caeba6148dcba01dcbf96d8f6e1.gif"></p><br><p>  This feature is disabled by default, it must be activated in the delegate method <code>UNUserNotificationCenterDelegate</code> .  If the application is active, before displaying the notification, you will have the opportunity to process it: </p><br><pre> <code class="hljs swift"><span class="hljs-meta"><span class="hljs-meta">@available</span></span>(iOS <span class="hljs-number"><span class="hljs-number">10</span></span>, *) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">userNotificationCenter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> center: UNUserNotificationCenter, willPresent notification: UNNotification, withCompletionHandler completionHandler: </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(UNNotificationPresentationOptions)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { completionHandler([.alert, .sound, .badge]) }</code> </pre> <br><p>  In order not to display the notification, it is enough to call the handler with the empty parameters <code>completionHandler([])</code> or delete the implementation of this method altogether. </p><br><h2>  Notification management </h2><br><p>  The notification can now be deleted or updated its contents, while it has not yet been read.  The system uses an identifier to update a received or pending delivery notification.  If a new notification is received with an existing identifier, instead of showing several notifications in a row, the old notification will be updated and will rise higher in the list of notifications. </p><br><p><img src="https://habrastorage.org/files/c9e/8ae/97c/c9e8ae97c356456ab7747399344691bc.gif"></p><br><p>  The identifier is a parameter that is passed during the creation of a request for a local <code>UNNotificationRequest(identifier: "identifier", content: content, trigger: trigger)</code> notification <code>UNNotificationRequest(identifier: "identifier", content: content, trigger: trigger)</code> .  In push notifications, it is transmitted using the HTTP / 2 header <code>apns-collapse-id</code> .  It is not known whether this header can be made to work on old protocols.  At a minimum, this is another reason to finally switch to the HTTP / 2 protocol for those who have not yet done so. </p><br><h2>  Attachments </h2><br><p>  Now you can insert pictures and videos in the notification.  For this there is a new extension Notification Service Extension. </p><br><h3>  Notification Service Extension </h3><br><p><img src="https://habrastorage.org/files/86c/457/6a9/86c4576a94954e2d960b0da7971f8c0a.png"></p><br><p>  There are only two methods in this extension.  The first <code>didReceiveRequest:withCompletionHandler</code> used to insert media files.  The second method <code>serviceExtensionWithExpire</code> called if the extension fails to complete in the allotted time interval: </p><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NotificationService</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UNNotificationServiceExtension</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">didReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> request: UNNotificationRequest, withContentHandler contentHandler:</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(UNNotificationContent)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// handle attachments } override func serviceExtensionTimeWillExpire() { // fallback to default message } }</span></span></code> </pre> <br><p>  The extension is allocated 30 seconds to have time to download the attachment and save it to a temporary file.  Therefore, in the push it is necessary to transfer links to optimized resources.  Images should be small and videos should be short.  If the extension did not manage to call <code>contentHandler</code> in the allotted time, then it will be destroyed and the received notification will be displayed without changes. </p><br><p>  For the extension to execute, the key <code>mutable-content: 1</code> must be present in the push notification <code>mutable-content: 1</code> .  A typical example of push notifications with an attachment: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"aps"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"alert"</span></span>: <span class="hljs-string"><span class="hljs-string">"  ?"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mutable-content"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://habrastorage.org/files/ff5/03e/e6b/ff503ee6b45d46ffb092aac33f2f282b.gif"</span></span> }</code> </pre> <br><p>  Before the attachment appears on the screen, it must be downloaded and saved to a temporary file.  Files must be of type supported by the system: </p><br><p>  <a href="https://developer.apple.com/reference/usernotifications/unnotificationattachment">https://developer.apple.com/reference/usernotifications/unnotificationattachment#overview</a> </p><br><p><img src="https://habrastorage.org/files/b0f/caa/dc5/b0fcaadc5172475588aaaee59e6f444b.png"></p><br><p>  You can download the file this way (here and below, the forced <code>try!</code> used for short): </p><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">func</span></span> store(url: <span class="hljs-type"><span class="hljs-type">URL</span></span>, extension: <span class="hljs-type"><span class="hljs-type">String</span></span>, completion: ((<span class="hljs-type"><span class="hljs-type">URL</span></span>?, <span class="hljs-type"><span class="hljs-type">NSError</span></span>?) -&gt; ())?) { // obtain path to temporary file <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> filename = <span class="hljs-type"><span class="hljs-type">ProcessInfo</span></span>.processInfo().globallyUniqueString <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> path = try! <span class="hljs-type"><span class="hljs-type">URL</span></span>(fileURLWithPath: <span class="hljs-type"><span class="hljs-type">NSTemporaryDirectory</span></span>()).appendingPathComponent(<span class="hljs-string"><span class="hljs-string">"\(filename).\(`extension`)"</span></span>) // fetch attachment <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> task = session.dataTask(with: url) { (<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">, response, error) in let _ = try! </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">?.write(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">path</span></span></span><span class="hljs-class">) completion?(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">path</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">error</span></span></span><span class="hljs-class">) } task.resume() }</span></span></code> </pre> <br><p>  Then the notification needs to be modified by adding a <code>UNNotificationAttachment</code> object to <code>UNNotificationAttachment</code> .  At the end, always call <code>contentHandler</code> : </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">didReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> request: UNNotificationRequest, withContentHandler contentHandler:</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(UNNotificationContent)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> content = request.content.mutableCopy() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">UNMutableNotificationContent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gif = request.content.userInfo[<span class="hljs-string"><span class="hljs-string">"gif"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">String</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> url = <span class="hljs-type"><span class="hljs-type">URL</span></span>(string: gif)! attachmentStorage.store(url: url, <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class">: "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">gif</span></span></span><span class="hljs-class">") </span></span>{ (path, error) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> path = path { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> attachment = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>! <span class="hljs-type"><span class="hljs-type">UNNotificationAttachment</span></span>(identifier: <span class="hljs-string"><span class="hljs-string">"image"</span></span>, url: path, options: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { content.attachments = [attachment] contentHandler(content) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { contentHandler(content) } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { contentHandler(request.content) } }</code> </pre> <br><p>  When pressed hard, it unfolds into a detailed view and the attachment is fully displayed.  If in the attachment gif, it starts to play.  So far, only 3D Touch is supported, but Apple promises to port this feature to devices with conventional touch. </p><br><p><img src="https://habrastorage.org/files/aa0/0d8/b79/aa00d8b79c5a4a1f93943c3605004b95.gif"></p><br><h2>  Change appearance (UI) </h2><br><p>  Now you can add any content to the notification.  This is done using the Notification Content Extension. </p><br><h3>  Notification Content Extension </h3><br><p><img src="https://habrastorage.org/files/a03/723/df2/a03723df2a39496fbedc652dd6dcd519.png"></p><br><p>  This extension is used to change the appearance of a notification when it is presented in expanded form.  Unfortunately, such content is not interactive and clicking on it is impossible.  All interaction is based on action buttons under the notification. </p><br><p><img src="https://habrastorage.org/files/2c3/37e/cd4/2c337ecd4d074a9cbffcc5dd9ee14e96.gif"></p><br><p>  The extension consists of a <code>UIViewController</code> controller and a storyboard. </p><br><p><img src="https://habrastorage.org/files/ebd/0eb/135/ebd0eb1358e44601a6ae26fa10b42529.png"></p><br><p>  The system will launch the extension when it receives a notification with the category specified in Info.plist.  You can list several categories: </p><br><p><img src="https://habrastorage.org/files/713/4e1/b64/7134e1b640524d97a9a0587659c3ce2c.png"></p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"aps"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"alert"</span></span>: <span class="hljs-string"><span class="hljs-string">" 32‚ÇΩ"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"category"</span></span>: <span class="hljs-string"><span class="hljs-string">"content"</span></span> } }</code> </pre> <br><p>  Of course, the category must be registered in advance: </p><br><pre> <code class="hljs pgsql">let category = UNNotificationCategory(identifier: "content", actions: [], minimalActions: [], intentIdentifiers: [], <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: []) UNUserNotificationCenter.<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>().setNotificationCategories([category])</code> </pre> <br><p>  In addition, the following flags can be set in Info.plist: </p><br><ul><li>  <code>UNNotificationExtensionDefaultContentHidden</code> - controls the display of standard labels with title and notification text. </li><li>  <code>UNNotificationExtensionInitialContentSizeRatio</code> - the ratio of the width of the notification to the height.  The system uses this value to set the starting notification size on the screen. </li></ul><br><h2>  Knuff app </h2><br><p>  To send push notifications in this article, the Knuff App was used.  Very comfortably.  Information about her was in one of our digests <a href="http://digest.mbltdev.ru/digests/58">MBLTDev 58</a> . </p><br><h2>  thank </h2><br><p>  If you read this far, it means you really were interested.  Thanks for attention.  Hope it was helpful. </p><br><h2>  Links </h2><br><p>  <a href="https://developer.apple.com/videos/play/wwdc2016/707/">Introduction to Notifications</a> </p><br><p>  <a href="https://developer.apple.com/videos/play/wwdc2016/708/">Advanced notifications</a> </p><br><p>  <a href="https://developer.apple.com/ios/human-interface-guidelines/features/notifications/">iOS Human Interface Guidelines</a> </p><br><p>  <a href="https://developer.apple.com/reference/usernotifications">UserNotifications Framework Reference</a> </p><br><p>  <a href="https://developer.apple.com/reference/usernotificationsui">UserNotificationsUI Framework Reference</a> </p><br><p>  <a href="https://github.com/KnuffApp/Knuff">Knuff app</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/303970/">https://habr.com/ru/post/303970/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../303960/index.html">We start Yocto Linux on the virtual machine</a></li>
<li><a href="../303962/index.html">When voice assistants really start helping</a></li>
<li><a href="../303964/index.html">Technical and social calls dialogue interface</a></li>
<li><a href="../303966/index.html">Apple left the core of iOS 10 without protection</a></li>
<li><a href="../303968/index.html">Hackathon of media projects on open financial data "Budget Stories"</a></li>
<li><a href="../303974/index.html">On the implementation of persistent processes in real-time control systems (part 3)</a></li>
<li><a href="../303976/index.html">Rust game development. Ecosystem overview</a></li>
<li><a href="../303978/index.html">18 free photo stocks that will save your ad</a></li>
<li><a href="../303984/index.html">Disadvantages of pure functional programming</a></li>
<li><a href="../303986/index.html">PSReadLine install syntax highlighting in PowerShell console</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>