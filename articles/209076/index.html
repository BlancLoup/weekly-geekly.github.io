<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tasks for the developer Yandex.Music for iOS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When completing the application form for the Yandex.Musicle developer position for iOS, they are asked to complete test tasks. Tasks are laid out in o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tasks for the developer Yandex.Music for iOS</h1><div class="post__text post__text-html js-mediator-article">  When completing the <a href="">application</a> form for the <a href="">Yandex.Musicle developer</a> position <a href="">for iOS, they</a> are asked to complete test tasks.  Tasks are laid out in open form, there is no request not to disclose tasks and not to publish a decision. <br><br>  Let's get started <br><a name="habracut"></a><br>  <i>Question 1.</i> The authorization system has the following restriction on the login format: it must begin with a Latin letter, it may consist of Latin letters, numbers, periods and minuses and must end with a Latin letter or numbers.  The minimum login length is 1 character.  Maximum - 20 characters. <br><br>  Write code that checks if the input string matches this rule. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We use a regular expression.  The NSRegularExpression class appeared in iOS 4.0. <br><pre><code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span> loginTester(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span>* login) { <span class="hljs-built_in"><span class="hljs-built_in">NSError</span></span> *error = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">NSRegularExpression</span></span> *regex = [<span class="hljs-built_in"><span class="hljs-built_in">NSRegularExpression</span></span> regularExpressionWithPattern:<span class="hljs-string"><span class="hljs-string">@"\\A[a-zA-Z](([a-zA-Z0-9\\.\\-]{0,18}[a-zA-Z0-9])|[a-zA-Z0-9]){0,1}\\z"</span></span> options:<span class="hljs-built_in"><span class="hljs-built_in">NSRegularExpressionCaseInsensitive</span></span> error:&amp;error]; <span class="hljs-comment"><span class="hljs-comment">//     ,       //     -  . NSRange rangeOfFirstMatch = [regex rangeOfFirstMatchInString:login options:0 range:NSMakeRange(0, [login length])]; return (BOOL)(rangeOfFirstMatch.location!=NSNotFound); }</span></span></code> </pre> <br>  <a href="http://yadi.sk/d/lvabskzxFZmZS">Here is the</a> finished project using this code.  You can test. <br>  I think this question is aimed at weeding out those who are afraid of regular expressions. <br><br>  <i>Question 2.</i> Write a method that returns the N most common words in the input line. <br><br>  Much more interesting. <br><br><pre> <code class="objectivec hljs">-(<span class="hljs-built_in"><span class="hljs-built_in">NSArray</span></span>*)mostFrequentWordsInString:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span>*)string count:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)count { <span class="hljs-comment"><span class="hljs-comment">//   . //        . //  ,  ,      , //   enumerateSubstringsInRange   NSStringEnumerationByWords NSMutableCharacterSet *separators = [[NSCharacterSet whitespaceAndNewlineCharacterSet] mutableCopy]; [separators formUnionWithCharacterSet:[NSCharacterSet punctuationCharacterSet]]; NSArray *words = [string componentsSeparatedByCharactersInSet:separators]; NSCountedSet *set = [NSCountedSet setWithArray:words]; //    enumerateByCount,   . //    NSMutableArray *selectedWords = [NSMutableArray arrayWithCapacity:count]; NSMutableArray *countsOfSelectedWords = [NSMutableArray arrayWithCapacity:count]; for (NSString *word in set) { NSUInteger wordCount = [set countForObject:word]; NSNumber *countOfFirstSelectedWord = [countsOfSelectedWords count] ? [countsOfSelectedWords objectAtIndex:0] : nil; //  iOS 7  firstObject if ([selectedWords count] &lt; count || wordCount &gt;= [countOfFirstSelectedWord unsignedLongValue]) { NSNumber *wordCountNSNumber = [NSNumber numberWithUnsignedLong:wordCount]; NSRange range = NSMakeRange(0, [countsOfSelectedWords count]); NSUInteger indexToInsert = [countsOfSelectedWords indexOfObject:wordCountNSNumber inSortedRange:range options:NSBinarySearchingInsertionIndex usingComparator:^(NSNumber *n1, NSNumber *n2) { NSUInteger _n1 = [n1 unsignedLongValue]; NSUInteger _n2 = [n2 unsignedLongValue]; if (_n1 == _n2) return NSOrderedSame; else if (_n1 &lt; _n2) return NSOrderedAscending; else return NSOrderedDescending; }]; [selectedWords insertObject:word atIndex:indexToInsert]; [countsOfSelectedWords insertObject:wordCountNSNumber atIndex:indexToInsert]; //       ,       if ([selectedWords count] &gt; count) { [selectedWords removeObjectAtIndex:0]; [countsOfSelectedWords removeObjectAtIndex:0]; } } } return [selectedWords copy]; //      selectedWords, //    immutable   mutable   -     } //     :            .</span></span></code> </pre><br>  I would use this approach if I needed to solve this problem in a real iOS application, provided that I understand where the input data will come from for searching and assume that the size of the input line will not be more than a few megabytes.  It is a reasonable assumption for iOS applications, in my opinion.  Otherwise, there would not be a line at the entrance, but a file.  With really large input data, you will have to sweat over a regular expression to iterate over words to get rid of one intermediate array.  Such a regular expression is very dependent on the language - what works for the Russian does not prokanaet for Chinese.  But what to do with the words further - except for a straightforward algorithm, nothing comes to mind.  If you had to choose one most common word - this is Fast Majority Voting.  But the beauty of this algorithm is that it works to select a single value.  Modifications of the algorithm for selecting N values ‚Äã‚Äãare not known to me.  I did not manage to modify it myself. <br><br>  <i>Question 3.</i> Using NSURLConnection, write a method for asynchronously loading a text document over HTTP.  Give an example of its use. <br><br><pre> <code class="objectivec hljs">-(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)pullTextFromURLString:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span>*)urlString completion:(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(^)(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span>*text))callBack { <span class="hljs-built_in"><span class="hljs-built_in">NSURLRequest</span></span> *request = [<span class="hljs-built_in"><span class="hljs-built_in">NSURLRequest</span></span> requestWithURL: [<span class="hljs-built_in"><span class="hljs-built_in">NSURL</span></span> URLWithString:urlString] cachePolicy:<span class="hljs-built_in"><span class="hljs-built_in">NSURLRequestUseProtocolCachePolicy</span></span> timeoutInterval:<span class="hljs-number"><span class="hljs-number">60.0</span></span>]; [<span class="hljs-built_in"><span class="hljs-built_in">NSURLConnection</span></span> sendAsynchronousRequest:request queue:[<span class="hljs-built_in"><span class="hljs-built_in">NSOperationQueue</span></span> mainQueue] completionHandler:^(<span class="hljs-built_in"><span class="hljs-built_in">NSURLResponse</span></span> *response, <span class="hljs-built_in"><span class="hljs-built_in">NSData</span></span> *data, <span class="hljs-built_in"><span class="hljs-built_in">NSError</span></span> *error) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (error) { <span class="hljs-built_in"><span class="hljs-built_in">NSLog</span></span>(<span class="hljs-string"><span class="hljs-string">@"Error %@"</span></span>, error.localizedDescription); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ,     ,     callBack( [[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding] ); } }]; }</span></span></code> </pre><br><br>  It's simple.  Probably, like the first question, this question I know / do not know. <br><br>  <i>Question 4.</i> List all the problems you see in the code below.  Suggest how to fix them. <br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSOperation</span></span> *operation = [<span class="hljs-built_in"><span class="hljs-built_in">NSBlockOperation</span></span> blockOperationWithBlock:^{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">1000</span></span>; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([operation isCancelled]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; process(data[i]); } }]; [queue addOperation:operation];</code> </pre><br><br>  Personally, I see a problem in that the variable operation ‚Äúcaptured‚Äù by the block when creating the block has not yet been initialized to the end.  What real value of this variable will be at the moment of ‚Äúcapture‚Äù depends on whether this code is used in a class method or in a simple function.  It is possible that the generated code will be fully functional and so, but this code is not clear to me.  How to get out of the situation?  So: <br><br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSBlockOperation</span></span> *operation = [[<span class="hljs-built_in"><span class="hljs-built_in">NSBlockOperation</span></span> alloc] init]; [operation addExecutionBlock:^{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">1000</span></span>; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([operation isCancelled]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; process(data[i]); } }]; [queue addOperation:operation];</code> </pre><br>  Perhaps it would be enough just to add the __block modifier to the declaration of the operation variable.  But as in the code above - for sure.  Some even create a __weak copy of the operation variable and use it inside the block.  Having thought well, I decided that in this particular case, when the lifetime of the operation and block variable is known, this is unnecessary.  Well, I would think whether to use NSBlockOperation for such complex structures.  Reasonable arguments can not bring - a matter of personal preference. <br><br>  What else is wrong with this code?  I do not like different magic constants in the code and instead of 1000 I would use define, const, sizeof or something like that. <br><br>  In long cycles in objective-c, you need to remember about autoreleased variables and, if such variables are used in a function or method process, and this method or function does not care about it, you need to wrap this call in @autoreleasepool {}.  Creating a new pool at each iteration of the cycle may be overhead or redundant.  If ARC is not used, you can create a new NSAutoreleasePool every, say, 10 loop iterations.  If ARC is used, this is not possible.  By the way, this is probably the only reason not to use ARC. <br><br>  It is not clear by the code whether the data is changing during processing, if someone else is accessing this data during processing from other streams, what data structures are used, whether the process itself cares about the exclusive access to data when it is needed.  You may need to take care of locks. <br><br>  <i>Question 5.</i> There are tables: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> tracks ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> AUTO_INCREMENT, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) )</code> </pre><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> track_downloads ( download_id <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> AUTO_INCREMENT, track_id <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, download_time <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, ip <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (download_id) )</code> </pre><br>  Write a query that returns the names of tracks downloaded more than 1000 times. <br><br>  Here such a request copes with the task remarkably: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tracks <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> track_id <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> track_id, <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> track_download_count <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> track_downloads <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> track_id <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> track_download_count <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> track_download_count &gt; <span class="hljs-number"><span class="hljs-number">1000</span></span>)</code> </pre><br>  Tested in sqlite.  I suppose that it is possible to reduce one select, but I do not know how. <br>  The presence of this question in the task is quite explicable - approximately this application will deal with. <br><br>  Waiting for critics. </div><p>Source: <a href="https://habr.com/ru/post/209076/">https://habr.com/ru/post/209076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209066/index.html">The programmer remembers his mistakes</a></li>
<li><a href="../209068/index.html">Programmer gets investment: our experience</a></li>
<li><a href="../209070/index.html">Chinese moon rover sent new photos</a></li>
<li><a href="../209072/index.html">Containerization on Linux in detail - LXC and OpenVZ. Part 1</a></li>
<li><a href="../209074/index.html">Raising the Thunderbolt Ethernet Adapter on XenServer</a></li>
<li><a href="../209078/index.html">What is Teradata?</a></li>
<li><a href="../209080/index.html">Black Friday. How did it all really</a></li>
<li><a href="../209084/index.html">Containerization on Linux in detail - LXC and OpenVZ Part 2</a></li>
<li><a href="../209092/index.html">Microsoft and Adobe released a set of updates, January 2014</a></li>
<li><a href="../209094/index.html">Google Drive has a tape of user activity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>