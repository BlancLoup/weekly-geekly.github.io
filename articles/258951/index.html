<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cross-compiling Qt5 for Linux for Win x32 / x64 / static / shared</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Purpose of the article 
 Documenting the cross-compilation system under Linux for Windows x32 / x64 / static / shared and building it at the time of Q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cross-compiling Qt5 for Linux for Win x32 / x64 / static / shared</h1><div class="post__text post__text-html js-mediator-article"><h1>  Purpose of the article </h1><br>  Documenting the cross-compilation system under Linux for Windows x32 / x64 / static / shared and building it at the time of Qt 5.4.1 description in a light version (for the four purposes).  For myself, deeply adored, well, for the benefit of society. <br><br><h1>  Purpose </h1><br>  Many developers come to the conclusion that using * nix (in particular Linux) is more preferable for developing applications using the Qt framework.  And for good reason.  Qt was originally focused on * nix tools, such as autotool, make, perl ... And the second point, under the Nix, there is a great tool - <a href="http://ru.wikipedia.org/wiki/Valgrind">valgrind</a> , under the port's Windows, I have not yet seen it.  And the last reason: it is just convenient to have a set of tools for creating applications for different target platforms - in one place. <br><br><h1>  Why light version of Qt5 </h1><br>  The Qt framework has a modular structure, but, alas, not quite perfect.  Some dependencies on external libraries are ‚Äúhung‚Äù not on the module that requires these libraries, but on Qt5Core.  In other words, whether you need this library or not - take it out and put it in the distribution kit.  An example of this ‚Äúmonster‚Äù is the <a href="http://site.icu-project.org/">ICU</a> library.  It weighs almost 25 meters!  The dependency hangs, as I mentioned above, on Qt5Core ... and it is required by its Qt5WebKit module (which in fact is not used in 99% of cases, at least by me).  What are we doing?  Cut and cut.  Want to get a full version of Qt5?  I will mention this in conclusion.  Go. <br><a name="habracut"></a><br><h2>  0. Build script </h2><br>  All steps are done consistently.  It is advisable not to combine all the scripts in a sequential assembly due to the need for intermediate "humane" control.  Different Linux distributions, different execution environments, toolkits ... A simple algorithm: took another step, made sure there were no errors, went to do the next one.  So, the script itself: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  1. Preliminary preparation </li><li>  2. Install the <a href="http://mxe.cc/">MXE</a> cross-compile environment </li><li>  3. Download and configure Qt 5.4.1 </li><li>  4. Build Qt 5.4.1 kits for four purposes (see subject) </li><li>  5. Registration collected in QtCreator </li></ul><br><br><h2>  1. Preliminary preparation </h2><br>  You have a Linux distribution installed.  It is desirable to do all this on a production computer (not on live Linux), but installed in a virtual machine.  I for example, use VMWare, but this is a matter of taste.  The choice of a Linux distribution is also a matter of taste.  Personally, I prefer <a href="http://www.gentoo.org/">Gentoo Linux</a> , in fact, under it all this kitchen and set up.  If there are difficulties in setting up, I have a small article on this issue: <a href="http://majestio.tk/viewtopic.php%3Fid%3D29">"Installing and configuring Linux Gentoo under VMWare</a> . <a href="http://majestio.tk/viewtopic.php%3Fid%3D29">"</a> <br><br>  So, you have a customized Linux and you are <strong>not</strong> working <strong>under the root!</strong>  For further work, you need to check the presence of the following installed packages, or install it: <br><br><pre><code class="bash hljs">$ sudo emerge \ app-arch/bzip2 \ app-arch/unzip \ app-arch/xz-utils \ app-shells/bash \ dev-lang/ruby \ dev-libs/libffi \ dev-libs/openssl \ dev-perl/XML-Parser \ dev-util/cmake \ dev-util/intltool \ dev-util/pkgconfig \ dev-util/scons \ dev-vcs/git \ sys-devel/autoconf \ sys-devel/automake \ sys-devel/bison \ sys-devel/flex \ sys-devel/gettext \ sys-devel/libtool \ sys-devel/patch \ net-misc/ntp \ www-client/lynx</code> </pre> <br>  All further installation will be done in the <strong>$ HOME / dev directory</strong> .  If you have one, either rename it or carefully edit the scripts that will be given below.  For all manipulations with downloadable external files / scripts / libraries, the <strong>$ HOME / setup</strong> directory will be used.  All comments above regarding $ HOME / dev are valid for this directory. <br><br><h2>  2. Install the MXE cross-compile environment </h2><br>  Preliminary note about MXE.  This is an excellent cross-compilation toolchain build system.  But there is one "but."  There is currently no stable branch.  For the time being, the authors kept two branches in their git repository - stable and ‚Äúdevelopmental‚Äù.  Now the branches are merged.  The development goes very well, the changes are reset almost once or again 1-3 days.  And this is fraught with the fact that "the assembly works, it does not work."  Some libraries that are important to me, in particular the PostgreSQL client part, are compiled without errors, but in a non-working state.  Spent a week not exploring obvious shoals.  We correct these "shortcomings".  So: <br><br><pre> <code class="bash hljs">$ mkdir -p <span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/setup $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> <span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/setup $ wget http://majestio.tk/stuff/setup-scripts.tar.xz $ tar -xf setup-scripts.tar.xz $ rm -f setup-scripts.tar.xz</code> </pre><br>  You should get the following set of scripts in the $ HOME / setup directory: <br><br><div class="spoiler">  <b class="spoiler_title">1.setup-first.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh ########################################################################### ## ## ##  1.       ## ## -  MXE (http://mxe.cc), ## ##      ## ## ## ## Majestio (C) http://majestio.tk ## ########################################################################### # #  : # # 1.   $HOME ,  $HOME/Setup # 2.       # 3.   # #     $HOME/dev #   MXE   $HOME/dev/cross/mxe # # ......................................................................... if [ "$(whoami)" == 'root' ]; then echo ":      !" exit 1 fi RETDIR=`pwd` MXEHOME=$HOME/dev/cross/mxe #      MXE  git- ----------- mkdir -p $HOME/dev/{cross,projests,src,stuff,tools} cd $HOME/dev/cross #  : # git clone https://github.com/mxe/mxe.git #   : # wget http://majestio.tk/stuff/mxe-empty-26.05.2015.tar.xz # tar -xf mxe-empty-26.05.2015.tar.xz # rm -f mxe-empty-26.05.2015.tar.xz wget http://majestio.tk/stuff/mxe-empty-26.05.2015.tar.xz tar -xf mxe-empty-26.05.2015.tar.xz rm -f mxe-empty-26.05.2015.tar.xz #    ABI  MXE ------------------------------- echo "#!/bin/sh" &gt; $HOME/dev/cross/mxe/ext/config.guess echo "echo \"x86_64-pc-linux-gnu\"" &gt;&gt; $HOME/dev/cross/mxe/ext/config.guess #    MXE    win32 -------------------- cd $MXEHOME make MXE_TARGETS='x86_64-w64-mingw32.shared '` `'x86_64-w64-mingw32.static '` `'i686-w64-mingw32.shared '` `'i686-w64-mingw32.static ' gcc gmp winpthreads -j4 JOBS=4 #  mxe/src/gcc.mk    posix-threads --------------- GCCMK=$MXEHOME/src/gcc.mk PLTMP=$$-$RANDOM.pl echo "open(F,\"$GCCMK\") || die \"Holy shit!\\n\";" &gt; $PLTMP echo "@In = &lt;F&gt;;" &gt;&gt; $PLTMP echo "close(F);" &gt;&gt; $PLTMP echo "open(F,\"&gt;$GCCMK\") || die \"Holy shit!\\n\";" &gt;&gt; $PLTMP echo "foreach \$I(@In) {" &gt;&gt; $PLTMP echo " \$I =~ s/^(\\\$\(PKG\)_DEPS.+)\$/\$1 winpthreads/;" &gt;&gt; $PLTMP echo " \$I =~ s/^(.+?--libdir='\\\$\(PREFIX\).+)\$/\$1\n --enable-shared=libstdc\+\+ \\\/;" &gt;&gt; $PLTMP echo " \$I =~ s/^(.+?--enable-threads=)win32(.*)\$/\$1posix\$2/;" &gt;&gt; $PLTMP echo " print F \$I;" &gt;&gt; $PLTMP echo "}" &gt;&gt; $PLTMP echo "close(F);" &gt;&gt; $PLTMP perl $PLTMP &amp;&amp; rm -f $PLTMP #  GCC   posix-threads ----------------------------- cd $MXEHOME make MXE_TARGETS='x86_64-w64-mingw32.shared '` `'x86_64-w64-mingw32.static '` `'i686-w64-mingw32.shared '` `'i686-w64-mingw32.static ' gcc -j4 JOBS=4 #    ""  - ------------ echo "   ..." cd .. tar -cJf mxe-winpthreads-empty.tar.xz ./mxe #    -------------------------------------------- cd $MXEHOME make MXE_TARGETS='x86_64-w64-mingw32.shared '` `'x86_64-w64-mingw32.static '` `'i686-w64-mingw32.shared '` `'i686-w64-mingw32.static ' zlib xz sqlite dbus \ libiconv libodbc++ -j4 JOBS=4 #    PostgreSQL -------------------------------------------- cd $MXEHOME/src wget http://majestio.tk/stuff/postgresql-3-socket.patch PQSQL=$MXEHOME/src/postgresql.mk PLTMP=$$-$RANDOM.pl echo "open(F,\"$PQSQL\") || die \"Holy shit!\\n\";" &gt; $PLTMP echo "@In = &lt;F&gt;;" &gt;&gt; $PLTMP echo "close(F);" &gt;&gt; $PLTMP echo "open(F,\"&gt;$PQSQL\") || die \"Holy shit!\\n\";" &gt;&gt; $PLTMP echo "foreach \$I(@In) {" &gt;&gt; $PLTMP echo " \$I =~ s/^(.+?--disable-rpath.+)\$/\$1\n --disable-thread-safety \\\/;" &gt;&gt; $PLTMP echo " print F \$I;" &gt;&gt; $PLTMP echo "}" &gt;&gt; $PLTMP echo "close(F);" &gt;&gt; $PLTMP perl $PLTMP &amp;&amp; rm -f $PLTMP cd $MXEHOME make MXE_TARGETS='x86_64-w64-mingw32.shared '` `'x86_64-w64-mingw32.static '` `'i686-w64-mingw32.shared '` `'i686-w64-mingw32.static ' postgresql -j4 JOBS=4 for PREFIX in "x86_64-w64-mingw32.shared" "x86_64-w64-mingw32.static" \ "i686-w64-mingw32.shared" "i686-w64-mingw32.static" ; do echo "Description: PostgreSQL libpq library" &gt; $MXEHOME/usr/$PREFIX/lib/pkgconfig/libpq.pc echo "Url: http://www.postgresql.org/" &gt;&gt; $MXEHOME/usr/$PREFIX/lib/pkgconfig/libpq.pc echo "Version: 9.2.4" &gt;&gt; $MXEHOME/usr/$PREFIX/lib/pkgconfig/libpq.pc echo "Requires: " &gt;&gt; $MXEHOME/usr/$PREFIX/lib/pkgconfig/libpq.pc echo "Requires.private: " &gt;&gt; $MXEHOME/usr/$PREFIX/lib/pkgconfig/libpq.pc echo "Cflags: -I$MXEHOME/usr/$PREFIX/include" &gt;&gt; $MXEHOME/usr/$PREFIX/lib/pkgconfig/libpq.pc echo "Libs: -L$MXEHOME/usr/$PREFIX/lib -lpq" &gt;&gt; $MXEHOME/usr/$PREFIX/lib/pkgconfig/libpq.pc echo "Libs.private: -lssl -lcrypto -lshell32 -lwsock32 -lws2_32 -lsecur32" &gt;&gt; $MXEHOME/usr/$PREFIX/lib/pkgconfig/libpq.pc chmod 0644 $MXEHOME/usr/$PREFIX/lib/pkgconfig/libpq.pc done cd $RETDIR</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">2.setup-qt5.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh ########################################################################### ## ## ##  2.  Qt 5.4.1 +    ## ## ## ## Majestio (C) http://majestio.tk ## ########################################################################### # #  : # # 1.     $HOME/Setup # 2.       # 3.   # #     qt5 # # ------------------------------------------------------------------------- if [ "$(whoami)" == 'root' ]; then echo ":      !" exit 1 fi wget http://download.qt.io/official_releases/qt/5.4/5.4.1/single/qt-everywhere-opensource-src-5.4.1.tar.gz tar -xf qt-everywhere-opensource-src-5.4.1.tar.gz mv qt-everywhere-opensource-src-5.4.1 qt5 cd qt5/qtbase/mkspecs wget http://majestio.tk/stuff/win32-g++.static.tar.xz tar -xf win32-g++.static.tar.xz rm -f win32-g++.static.tar.xz cd ../.. wget http://majestio.tk/stuff/qt-5.4.1.patch patch -p1 -u &lt; qt-5.4.1.patch rm -f qt-5.4.1.patch cd ..</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">3.1.build-qt-x32-shared.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh ########################################################################### ## ## ##  3.1   Qt 5.4.1  Win x32 (shared) ## ## ## ## Majestio (C) http://majestio.tk ## ########################################################################### # #  : # # 1.     $HOME/Setup # 2.       # 3.   # #     ,   %HOME/dev/stuff # # ------------------------------------------------------------------------- if [ "$(whoami)" == 'root' ]; then echo ":      !" exit 1 fi TARGET="i686-w64-mingw32.shared" MXE="$HOME/dev/cross/mxe/usr" PREFIX="$HOME/dev/stuff/qt5-$TARGET" export PATH=$MXE/bin:$PATH PWD="`pwd`" LOG="$PWD/$TARGET-qt5.log___________" mkdir "$TARGET-qt5.build" cd "$TARGET-qt5.build" clear OPENSSL_LIBS="`''"$TARGET"'-pkg-config' --libs-only-l openssl`" \ PSQL_LIBS="-lpq -lsecur32 `''"$TARGET"'-pkg-config' --libs-only-l openssl` -lws2_32" \ ../qt5/configure -prefix $PREFIX \ -opensource \ -confirm-license \ -release \ -shared \ -opengl desktop \ -force-pkg-config \ -no-use-gold-linker \ -no-glib \ -openssl \ -dbus \ -plugin-sql-psql \ -plugin-sql-sqlite \ -plugin-sql-odbc \ -qt-libpng -qt-libjpeg -qt-pcre -zlib -qt-freetype -no-kms -no-pch \ -nomake examples -nomake tests -silent -skip webkit \ -xplatform win32-g++ \ -device-option CROSS_COMPILE=$TARGET- \ -device-option PKG_CONFIG="$TARGET-pkg-config" 2&gt;&amp;1 | tee $LOG make -j4 2&gt;&amp;1 | tee -a $LOG make install 2&gt;&amp;1 | tee -a $LOG</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">3.2.build-qt-x32-static.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh ########################################################################### ## ## ##  3.2   Qt 5.4.1  Win x32 (static) ## ## ## ## Majestio (C) http://majestio.tk ## ########################################################################### # #  : # # 1.     $HOME/Setup # 2.       # 3.   # #     ,   %HOME/dev/stuff # # ------------------------------------------------------------------------- if [ "$(whoami)" == 'root' ]; then echo ":      !" exit 1 fi TARGET="i686-w64-mingw32.static" MXE="$HOME/dev/cross/mxe/usr" PREFIX="$HOME/dev/stuff/qt5-$TARGET" PWD="`pwd`" LOG="$PWD/$TARGET-qt5.log___________" mkdir "$TARGET-qt5.build" cd "$TARGET-qt5.build" clear export PATH=$MXE/bin:$PATH #../qt5/configure --help|less #exit OPENSSL_LIBS="`''"$TARGET"'-pkg-config' --libs-only-l openssl`" \ PSQL_LIBS="-lpq -lsecur32 `''"$TARGET"'-pkg-config' --libs-only-l openssl` -lws2_32" \ ../qt5/configure -prefix $PREFIX \ -opensource \ -confirm-license \ -release \ -static \ -opengl desktop \ -force-pkg-config \ -no-use-gold-linker \ -no-glib \ -openssl-linked \ -dbus-linked \ -qt-sql-psql \ -qt-sql-sqlite \ -qt-sql-odbc \ -qt-libpng -qt-libjpeg -qt-pcre -zlib -qt-freetype -no-kms -no-pch \ -nomake examples -nomake tests -silent -skip webkit \ -xplatform win32-g++ \ -device-option CROSS_COMPILE=$TARGET- \ -device-option PKG_CONFIG="$TARGET-pkg-config" 2&gt;&amp;1 | tee $LOG make -j4 2&gt;&amp;1 | tee -a $LOG make install 2&gt;&amp;1 | tee -a $LOG</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">3.3.build-qt-x64-shared.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh ########################################################################### ## ## ##  3.3   Qt 5.4.1  Win x64 (shared) ## ## ## ## Majestio (C) http://majestio.tk ## ########################################################################### # #  : # # 1.     $HOME/Setup # 2.       # 3.   # #     ,   %HOME/dev/stuff # # ------------------------------------------------------------------------- if [ "$(whoami)" == 'root' ]; then echo ":      !" exit 1 fi TARGET="x86_64-w64-mingw32.shared" MXE="$HOME/dev/cross/mxe/usr" PREFIX="$HOME/dev/stuff/qt5-$TARGET" export PATH=$MXE/bin:$PATH PWD="`pwd`" LOG="$PWD/$TARGET-qt5.log___________" mkdir "$TARGET-qt5.build" cd "$TARGET-qt5.build" clear OPENSSL_LIBS="`''"$TARGET"'-pkg-config' --libs-only-l openssl`" \ PSQL_LIBS="-lpq -lsecur32 `''"$TARGET"'-pkg-config' --libs-only-l openssl` -lws2_32" \ ../qt5/configure -prefix $PREFIX \ -opensource \ -confirm-license \ -release \ -shared \ -opengl desktop \ -force-pkg-config \ -no-use-gold-linker \ -no-glib \ -openssl \ -dbus \ -plugin-sql-psql \ -plugin-sql-sqlite \ -plugin-sql-odbc \ -qt-libpng -qt-libjpeg -qt-pcre -zlib -qt-freetype -no-kms -no-pch \ -nomake examples -nomake tests -silent -skip webkit \ -xplatform win32-g++ \ -device-option CROSS_COMPILE=$TARGET- \ -device-option PKG_CONFIG="$TARGET-pkg-config" 2&gt;&amp;1 | tee $LOG make -j4 2&gt;&amp;1 | tee -a $LOG make install 2&gt;&amp;1 | tee -a $LOG</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">3.4.build-qt-x64-static.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh ########################################################################### ## ## ##  3.4   Qt 5.4.1  Win x64 (static) ## ## ## ## Majestio (C) http://majestio.tk ## ########################################################################### # #  : # # 1.     $HOME/Setup # 2.       # 3.   # #     ,   %HOME/dev/stuff # # ------------------------------------------------------------------------- if [ "$(whoami)" == 'root' ]; then echo ":      !" exit 1 fi TARGET="x86_64-w64-mingw32.static" MXE="$HOME/dev/cross/mxe/usr" PREFIX="$HOME/dev/stuff/qt5-$TARGET" PWD="`pwd`" LOG="$PWD/$TARGET-qt5.log___________" mkdir "$TARGET-qt5.build" cd "$TARGET-qt5.build" clear export PATH=$MXE/bin:$PATH #../qt5/configure --help|less #exit OPENSSL_LIBS="`''"$TARGET"'-pkg-config' --libs-only-l openssl`" \ PSQL_LIBS="-lpq -lsecur32 `''"$TARGET"'-pkg-config' --libs-only-l openssl` -lws2_32" \ ../qt5/configure -prefix $PREFIX \ -opensource \ -confirm-license \ -release \ -static \ -opengl desktop \ -force-pkg-config \ -no-use-gold-linker \ -no-glib \ -openssl-linked \ -dbus-linked \ -qt-sql-psql \ -qt-sql-sqlite \ -qt-sql-odbc \ -qt-libpng -qt-libjpeg -qt-pcre -zlib -qt-freetype -no-kms -no-pch \ -nomake examples -nomake tests -silent -skip webkit \ -xplatform win32-g++ \ -device-option CROSS_COMPILE=$TARGET- \ -device-option PKG_CONFIG="$TARGET-pkg-config" 2&gt;&amp;1 | tee $LOG make -j4 2&gt;&amp;1 | tee -a $LOG make install 2&gt;&amp;1 | tee -a $LOG</span></span></code> </pre></div></div><br><br>  The scripts will not have the attribute "executable" just for security reasons - to prevent the "unintended accidental" launch.  Run the first script <strong>1.setup-first.sh</strong> .  It will create a $ HOME / dev ... subdirectory structure, deflate the mxe cross-compilation system, double-build the gcc tulcheins (to ensure posix-threads support), build the main core libraries, patch it and build the PostgreSQL library. <br><br>  <strong>Important:</strong> If your ABI host system is different from x86_64-pc-linux-gnu, manually remove the ABI patch in the script.  We are looking for the comment "# patch file definition of the ABI project of the MXE project".  And better write yours. <br><br><pre> <code class="bash hljs">$ sh 1.setup-first.sh</code> </pre><br><h2>  3. Download and configure Qt 5.4.1 </h2><br>  Run the script <strong>2.setup-qt5.sh</strong> .  Its task is to download the sources of Qt 5.4.1, deploy them to the qt5 / subdirectory and patch the necessary ones. <br><br><pre> <code class="bash hljs">$ sh 2.setup-qt5.sh</code> </pre><br><br><h2>  4. Build Qt 5.4.1 Kits for Four Purposes </h2><br>  For, in fact, the assembly of four types of Qt 5.4.1 are the rest of the scripts: <br><br><ul><li>  3.1.build-qt-x32-shared.sh </li><li>  3.2.build-qt-x32-static.sh </li><li>  3.3.build-qt-x64-shared.sh </li><li>  3.4.build-qt-x64-static.sh </li></ul><br><br>  The launch is performed in the same way as in the previous paragraph: <br><br><pre> <code class="bash hljs">$ sh </code> </pre><br>  However, there is an important remark that can save you time to build.  If you have a multi-core computer, it makes sense to run the assembly in parallel.  To do this, you open the second (third, fourth) terminal, and launch the next script in the terminal.  Personally, I find it convenient to carry out all actions in an additional ssh client.  As practice has shown, on my Core i7 (4 cores, with hyper trading) - the increase in the total assembly time is observed with two concurrently working assemblies.  If more - productivity does not increase, but more often it drops. <br><br>  So, all four scripts have worked.  What did we get as a result? <br><br>  $ HOME / dev / cross / mxe / usr / bin - here are collected executable modules of all four tulcheynov <br>  $ HOME / dev / cross / mxe / usr / tulchein - here are the headers and lines of tulcheins <br>  $ HOME / dev / stuff / builds - here are collected all kinds of Qt for further cross-compiling <br><br>  It remains to connect all this to use. <br><br><h2>  5. Registration collected in QtCreator </h2><br>  You independently download Qt 5.4.1 for your linux (link to <a href="">x32</a> or <a href="">x64</a> ), do the installation yourself.  Check the performance. <br><br>  After that register collected by you.  Open QtCreator, select in the main menu ‚ÄúTools‚Äù ‚ñ∫ ‚ÄúOptions‚Äù ‚ñ∫ ‚ÄúBuild and Run‚Äù.  Further, the entire registration involves three steps: <br><br>  1) Registration of compilers (‚ÄúCompilers‚Äù tab) <br>  2) Registration of Qt profiles (Qt Profiles tab) <br>  3) Registration of kits (‚ÄúKits‚Äù tab) <br><br>  Step 1 <br><br>  When adding another compiler, choose the type ‚ÄúSpecial‚Äù.  We are looking for the necessary compiler in $ HOME / dev / cross / mxe / usr / bin of type bla-bla-bla-g ++.  Below we specify the path to the system make utility, such as / usr / bin / make.  Further we expose ABI.  If you chose the static version, at the bottom add mkspec - ‚Äúwin32-g ++. Static‚Äù (without quotes).  The remaining fields are irrelevant.  Zaregali all four types of compilers, click "Apply" <br><br>  Step-2 <br><br>  Switch to the Qt Profiles tab.  Adding profiles look for them in $ HOME / dev / stuff / bla-bla-bla / bin / qmake.  Zaregali all four profiles, click "Apply" <br><br>  Step-3 <br><br>  Switch to the "Kits" tab.  Add the next bundle, choosing the right compiler + Qt profile.  In the kits, where the static assembly is desirable to register and mkspecs as in step-1.  Zaregali all four sets, click "Apply" <br><br><h1>  Conclusion </h1><br>  Fully aware - collected may contain certain errors, because  Far from being the author of neither Qt nor PostgreSQL, not even a member of the MXE project.  And the absence of the simplest checks at the time of assembly, not to mention unit tests, assumes that you are aware of the ‚Äúdampness‚Äù of what has been done.  However, after receiving this set of toolchains, I tested my projects, examples from the Qt delivery.  I didn‚Äôt find any errors in the modules I‚Äôm interested in (UI, PostgreSQL, http, QtScript, and several others). <br><br>  ... The promised about the full assembly.  If you are very lucky, and MXE, at the time of your interest will be in a stable condition, it is very easy to get a full build: <br><br><pre> <code class="bash hljs">$ mkdir -p <span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/dev/{cross,src,stuff,projects} $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> <span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/dev/cross $ git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/mxe/mxe.git $ make MXE_TARGETS=<span class="hljs-string"><span class="hljs-string">'x86_64-w64-mingw32.shared'</span></span> gcc -j4 JOBS=4 $ make MXE_TARGETS=<span class="hljs-string"><span class="hljs-string">'x86_64-w64-mingw32.static'</span></span> gcc -j4 JOBS=4 $ make MXE_TARGETS=<span class="hljs-string"><span class="hljs-string">'i686-w64-mingw32.shared'</span></span> gcc -j4 JOBS=4 $ make MXE_TARGETS=<span class="hljs-string"><span class="hljs-string">'i686-w64-mingw32.static'</span></span> gcc -j4 JOBS=4 <span class="hljs-comment"><span class="hljs-comment"># #  PostgreSQL-   -    $HOME/dev/cross/mxe/src # ,   http://majestio.tk/stuff/postgresql-3-socket.patch # $ make MXE_TARGETS='x86_64-w64-mingw32.shared' qt5 -j4 JOBS=4 $ make MXE_TARGETS='x86_64-w64-mingw32.static' qt5 -j4 JOBS=4 $ make MXE_TARGETS='i686-w64-mingw32.shared' qt5 -j4 JOBS=4 $ make MXE_TARGETS='i686-w64-mingw32.static' qt5 -j4 JOBS=4</span></span></code> </pre><br>  Vanguyu, in this version of the assembly you will be disappointed with a probability of 87.14%, but if everything is without jambs, then the resulting Qt5 assemblies will be placed in <strong>$ HOME / dev / cross / mxe / usr / &lt;toolchain&gt; / qt5</strong> <br><br>  All successful coding. </div><p>Source: <a href="https://habr.com/ru/post/258951/">https://habr.com/ru/post/258951/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258937/index.html">The benefits of 3d printers for medicine and rocket science: desktop FDM versus industrial metal (can 500 zerlings overwhelm a dark templar?)</a></li>
<li><a href="../258941/index.html">An example of a multi-vendor WLAN access control solution</a></li>
<li><a href="../258943/index.html">Competition for designers from Mail.Ru Mail</a></li>
<li><a href="../258947/index.html">Upsource 2.0 came out with an IDE plug-in, Java code analysis in Gradle projects, JavaScript navigation and much more.</a></li>
<li><a href="../258949/index.html">Juniper emulator. VMware Virtual Lab</a></li>
<li><a href="../258953/index.html">Let unit-testing begin (Objective-C)</a></li>
<li><a href="../258955/index.html">Master Tehnokub</a></li>
<li><a href="../258957/index.html">TypeScript: general impressions</a></li>
<li><a href="../258959/index.html">Serialization, sir! Today for dinner byte porridge, cooked from C ++ objects</a></li>
<li><a href="../258961/index.html">How to pass an elephant through the eye of a needle. Processing the maximum amount of data in the shortest time</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>