<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>RDPPatcher sells access to your computer at a low price.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In recent months, the PandaLabs anti-virus laboratory of Panda Security has been witnessing a significant increase in malware installed using the Remo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>RDPPatcher sells access to your computer at a low price.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/9eb/66f/b7e/9eb66fb7ee664fb2b1e59919ab2445a9.jpg"><br><br>  In recent months, the PandaLabs anti-virus laboratory of Panda Security has been witnessing a significant increase in malware <a href="https://habrahabr.ru/company/panda/blog/320290/">installed using the Remote Desktop Protocol (RDP)</a> .  Every day we see thousands of attempts at infection using ransomware (ransomware), hacking the system for mining Bitcoins and other purposes.  In general, all such threats have a common approach: access to a computer via Remote Desktop (RDP) after selecting credentials using the brute force method. <br><br>  The new detected attack uses the same entry technique, but its goal is completely different from the attacks that we analyzed earlier.  This time, after entering the system, the <b>threat focuses on the search for POS-terminals and ATM</b> . <a name="habracut"></a>  The reason for this lies in the fact that these terminals are simple enough for an anonymous attack from the Internet, and the financial benefit from the sale of stolen information is very high. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  RDPPatcher: selling system access on the black market </h3><br>  In this case, the brute force attack lasted more than two months until, in January 2017, the hackers picked up the correct registration data and did not get access to the system.  After the system was compromised, the cyber criminals attempted to infect it with malware.  They found that their attempts were blocked by <a href="http://www.pandasecurity.com/russia/enterprise/solutions/advanced-threat-protection/">Adaptive Defense</a> .  After that, they modified the malware and tried again, but also to no avail.  Since the Panda advanced information security solution is not based on signatures and does not rely on existing knowledge about malware to block it, modifying the malware does not change the result. <br><br>  From the analysis of a malicious program, the purpose of the attack becomes clear.  The two file hashes are as follows: <br><br><blockquote>  MD5 d78be752e991ccbec16f11e4fc6b2115 <br>  SHA1 4cc9d2c98f22aefab50ee217c1a0d872e93ce541 <br><br>  MD5 950e8614db5c567f66d0900ad09e45ac <br>  SHA1 9355a60dd51cfd02a921444e92e012e25d0a6be </blockquote><br>  Both files were created in Delphi and packaged with Aspack.  After unpacking them, we found that they are very similar to each other.  We analyzed the most recent of them: (950e8614db5c567f66d0900ad09e45ac). <br><br>  This trojan is detectable as Trj / <b>RDPPatcher</b> .  A modifies the registry entries in Windows to change the type of RDP validation.  Here are the records that the system changes: <br><br><blockquote>  HKLM \ SYSTEM \ CurrentControlSet \ Control \ Terminal Server \ WinStations \ RDP-Tcp / v UserAuthentication / t REG_DWORD / d 1 <br><br>  HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Terminal Server \ WinStations \ RDP-Tcp ‚Äù/ v UserAuthentication / t REG_DWORD / d 1 <br><br>  In addition, it deletes the following entries if they are present in the system: <br><br>  ‚ÄúHKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Policies \ System‚Äù / v legalnoticecaption / f <br><br>  ‚ÄúHKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Policies \ System‚Äù / v legalnoticetext / f </blockquote><br>  Subsequently, it leaves another file (MD5: 78D4E9BA8F641970162260273722C887) in the% TEMP% folder.  This file is a variant of the <a href="https://github.com/stascorp/rdpwrap">rdpwrap</a> application and it is launched via the <a href="https://en.wikipedia.org/wiki/Runas">runas</a> command with the ‚Äú-i ‚Äìs‚Äù parameters to activate simultaneous RDP sessions in the system. <br><br>  Then he goes to the machine profile and receives the following information about it: <br><br>  ‚Ä¢ Username <br>  ‚Ä¢ Device Name <br>  ‚Ä¢ The time period when the device was turned on. <br>  ‚Ä¢ Operating system version <br>  ‚Ä¢ Tongue <br>  ‚Ä¢ Virtual machine <br>  ‚Ä¢ Memory <br>  ‚Ä¢ Processor Name <br>  ‚Ä¢ Number of processor cores <br>  ‚Ä¢ CPU speed <br><br>  It then connects to the management server (C &amp; C server) to access a list of services that measure Internet connection speed, and then saves data related to the speed of the incoming and outgoing connection.  Then he checks which antivirus is installed on the computer.  Contrary to what we are accustomed to see in most malicious attacks, it does not remove the installed antivirus and does not change its operation.  It simply collects data. <br><br>  We were able to extract from the code a list of those processes that it searches for: <br><br>  <a href="http://pandanews.pandasecurity.com/emailing/antivirus.pdf">See table 1</a> <br><br>  After that, he begins to look for different types of programs to continue profiling the computer.  Basically, he is looking for programs related to POS, ATM and online gambling.  Below is a small part of the programs that he is looking for (there are several hundreds of them): <br><br>  <a href="http://pandanews.pandasecurity.com/emailing/software.pdf">See table 2</a> <br><br>  It also ‚Äúpasses‚Äù through the history of visits, checking correspondences with another list, presented by categories, depending on the area of ‚Äã‚Äãinterest: <br><br>  <a href="http//pandanews.pandasecurity.com/emailing/browser%2520history.pdf">See table 3</a> <br><br>  All these actions are necessary in order to "tag" the computer in accordance with the software used on it and the visited web pages. <br><br>  After completing the data collection procedure from the system, it makes a request to the C &amp; C management server.  To hide sending information via web traffic from security systems, it first encrypts the data using AES128 with the password ‚Äú8c @ mj} || v * {hGqvYUG‚Äù, which was embedded in the sample being analyzed.  Then it encodes it in base64 <br><br><img src="https://habrastorage.org/files/b58/2e7/8a5/b582e78a592c49f894fc704ad72e409e.png"><br>  An example of an encrypted request. <br><br>  The C &amp; C Management Server used for this sample malware is located in Gibraltar: <br><br><img src="https://habrastorage.org/files/815/900/f7a/815900f7a08a40d098afe742ee894479.png"><br><br><h3>  Conclusion </h3><br>  As we have seen, the first thing an attacker seeks to do is to inventory the computer, gather a wide range of information (hardware, software, visited web pages, Internet connection speed), and install an application that allows you to run several RDP sessions. at the same time.  There is no data theft, passwords or anything else, as in other cases. <br><br>  The explanation for all this is quite simple: the cyber criminals behind these attacks sell access to these hacked computers at a very low price.  Having so much data from each system on hand, they can sell access to it to other groups of intruders who specialize in various fields.  For example, to groups that specialize in stealing bank card data, they can sell access to computers that have software installed for POS terminals, etc.  Cyber ‚Äã‚Äãcrime has indeed become a professional activity and a very profitable racket. </div><p>Source: <a href="https://habr.com/ru/post/322010/">https://habr.com/ru/post/322010/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321992/index.html">DDoS attacks: attack and defense</a></li>
<li><a href="../321996/index.html">Neural Network Based Interview Robot</a></li>
<li><a href="../321998/index.html">Using Tarantool in a .NET project on Windows</a></li>
<li><a href="../322000/index.html">Snake and coconut</a></li>
<li><a href="../322008/index.html">Create a development application using Android Studio</a></li>
<li><a href="../322012/index.html">Public data management: preparation and delivery</a></li>
<li><a href="../322016/index.html">My is an idea, yours is a program, or three real stories about how the author of the idea and the developer shared a startup in court.</a></li>
<li><a href="../322018/index.html">Convenient memo and 8 references to documentation in accordance with GOST 34 (automated systems)</a></li>
<li><a href="../322020/index.html">Derandomization of the ASLR on any modern processor using JavaScript</a></li>
<li><a href="../322022/index.html">Science on guard of interfaces: how to make buttons in the application really comfortable</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>