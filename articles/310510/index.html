<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Eddystone technologies replace QR codes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The purpose of testing is the ability to integrate Eddystone technology from Google with a unique service for interacting with cultural objects "City ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Eddystone technologies replace QR codes</h1><div class="post__text post__text-html js-mediator-article">  The purpose of testing is the ability to integrate Eddystone technology from Google with a unique service for interacting with cultural objects "City Beacon" (in development for Android, iOS, WEB). <br><br>  With the help of Eddystone technology, the completely inconvenient concept of QR codes will be replaced to obtain information of interest.  It should be noted that a small survey was conducted - 227 people (85% of respondents live in the Nizhny Novgorod region and Nizhny Novgorod), where only 5% of respondents constantly use QR codes, and 30% do not know what it is.  The focus of the service is on the use of Physical Web. <br><br><img src="https://habrastorage.org/files/47d/3ed/70f/47d3ed70fc9b4fc09e038558c203f27c.jpg"><br>  <em>Article author Cyril Rudakov, in the framework of the competition <a href="http://special.habrahabr.ru/google/lab">"Device Lab from Google</a></em> . <em><a href="http://special.habrahabr.ru/google/lab">"</a></em> <br><a name="habracut"></a><br>  However, in the WEB application, the user has the opportunity to install the original application for Android or iOS, which has a wider range of features, and moreover, few mobile browsers now work with the Eddystone-URL, and the unnecessary application for detecting new package types, such as Physical Web App, no one will additionally install.  Therefore, the need for mobile applications for Android and iOS platforms is obvious. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Testing </h2><br>  Five iBKS105 beacons from Accent Systems, which did not support Eddystone-EID, were transferred to the test.  Eddystone-EID was announced by Google on March 14, with the help of beacons that transmit an identifier that changes every few minutes, increasing security and expanding the scenario of their use.  In order for the beacons to support EID, you need to update the software through the official application (for Android, iBKS Config Tool Beta v0_1, which Accent Systems send on request, as long as it is not in Google Play), acting as a tool for the Eddystone GATT service.  You can read about usage scenarios and benefits <a href="https://habrahabr.ru/post/281877/">here</a> , and Eddystone-EID specifications <a href="https://github.com/google/eddystone/tree/master/eddystone-eid">here</a> . <br><br><img src="https://habrastorage.org/files/643/2d9/457/6432d9457a3b42e4b7c730a7f1d2a32d.png"><br><br>  To work with the following application programming interfaces and Google services, you must have a Google account.  To work with beacons and their integration with the application, I used Google‚Äôs beacon platform.  I read about setting up and using the Proximity Beacon API <a href="https://habrahabr.ru/post/279381/">here</a> and <a href="https://developers.google.com/beacons/proximity/guides">here</a> .  After creating a project in the Google Developer Console, you need to activate this API and get an OAuth 2.0 client ID and API KEY. <br><br>  Using APIs Explorer Tested such REST requests as proximitybeacon.beacons.register - to register previously unregistered beacons, proximitybeacon.beacons.update - update the beacon information, proximitybeacon.beacons.activate and proximitybeacon.beacons.deactivate - to activate and withdrawal of the beacon, proximitybeacon.beacons.attachments.create - to link additional information with a given beacon, proximitybeacon.beacons.diagnostics.list - to track the status of the beacon.  All requests can be found <a href="https://developers.google.com/apis-explorer/%3Fhl%3Dru">here</a> . <br><br>  Below is an example of the registration of the beacon - proximitybeacon.beacons.register and the result of the execution: <br><br><img src="https://habrastorage.org/files/f46/ca1/1ba/f46ca11ba08244f0bf58da6cbcf4c355.png"><br><img src="https://habrastorage.org/files/bf2/a4c/d19/bf2a4cd19fc14cb896ad4a4010ed6bb0.png"><br><br>  Also, to register BLE beacons and create small attachments to them with Google Beacon Registry, I tested the Beacon Tools mobile app for <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.google.android.apps.location.beacon.beacontools%26hl%3Dru">Android</a> and <a href="https://itunes.apple.com/ru/app/beacon-tools/id1094371356%3Fmt%3D8">iOS</a> .  About the metadata for the registration of the beacon can be found on the <a href="https://developers.google.com/beacons/proximity/reference/rest/v1beta1/beacons">link</a> . <br><br>  To receive messages in the background and active mode from the beacons in the application itself, I used Nearby Messages API 9.0.2. <br><br>  After setting up and configuring the project (you can read more in <a href="https://habrahabr.ru/post/279379/">this article</a> and in the <a href="https://developers.google.com/nearby/messages/overview">documentation</a> ) you connect to the Nearby Messages services: <br><br><pre><code class="hljs java">mGoogleApiClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GoogleApiClient.Builder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) .addApi(Nearby.MESSAGES_API) .addConnectionCallbacks(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) .enableAutoManage(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) .addOnConnectionFailedListener(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) .build();       : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">publish</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String message)</span></span></span><span class="hljs-function"> </span></span>{ mActiveMessage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Message(message.getBytes()); Nearby.Messages.publish(mGoogleApiClient, mActiveMessage); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unpublish</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mActiveMessage != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { Nearby.Messages.unpublish(mGoogleApiClient, mActiveMessage); mActiveMessage = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">subscribe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Nearby.Messages.subscribe(mGoogleApiClient, mMessageListener, options); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unsubscribe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Nearby.Messages.unsubscribe(mGoogleApiClient, mMessageListener); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onConnected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle connectionHint)</span></span></span><span class="hljs-function"> </span></span>{ publish(<span class="hljs-string"><span class="hljs-string">"Publish!"</span></span>); subscribe(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ unpublish(); unsubscribe(); <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onStop(); }</code> </pre> <br>  To subscribe to beacons and receive messages from them in the background (code from developers.google.com): <br><br><pre> <code class="hljs java"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">backgroundSubscribe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Log.i(TAG, <span class="hljs-string"><span class="hljs-string">"Subscribing for background updates."</span></span>); SubscribeOptions options = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubscribeOptions.Builder() .setStrategy(Strategy.BLE_ONLY) .build(); Nearby.Messages.subscribe(mGoogleApiClient, getPendingIntent(), options); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> PendingIntent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPendingIntent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> PendingIntent.getBroadcast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, BeaconMessageReceiver.class), PendingIntent.FLAG_UPDATE_CURRENT); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, Intent intent)</span></span></span><span class="hljs-function"> </span></span>{ Nearby.Messages.handleIntent(intent, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MessageListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onFound</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Message message)</span></span></span><span class="hljs-function"> </span></span>{ Log.i(TAG, <span class="hljs-string"><span class="hljs-string">"Found message via PendingIntent: "</span></span> + message); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onLost</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Message message)</span></span></span><span class="hljs-function"> </span></span>{ Log.i(TAG, <span class="hljs-string"><span class="hljs-string">"Lost message via PendingIntent: "</span></span> + message); } }); }</code> </pre><br>  To search for the Eddystone URL, I tested the Physical Web application for <a href="https://play.google.com/store/apps/details%3Fid%3Dphysical_web.org.physicalweb%26hl%3Dru">Android</a> and <a href="https://itunes.apple.com/ru/app/physical-web/id927653608%3Fmt%3D8">iOS</a> , as well as the search function for Physical Web objects in Google Chrome for iOS. <br><br>  It is worth noting that in the City Beacon application Firebase 9.0.2 is used, and fields such as Status, Description, Properties, using the Proximity Beacon API can be remotely controlled, and not only can you get Eddystone-TLM frames on Google‚Äôs beacon platform , but also to aggregate them in a separate service. <br><br><h2>  Conclusion </h2><br>  As part of a special project, testing the iBKS product and Google's Eddystone technology, the City Beacon application will receive innovative features.  It should be noted that during the testing period I was faced with the problem of updating the provided beacons, which took most of the time to solve.  In the future, I also plan to implement the ‚Äúbundle‚Äù of Firebase - Google's beacon platform described above.  Experience with Google's beacon platform and Nearby Messages API has a positive and positive effect on the further development of the City Beacon. </div><p>Source: <a href="https://habr.com/ru/post/310510/">https://habr.com/ru/post/310510/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../310498/index.html">Quick integration of Google Chromecast in Android app</a></li>
<li><a href="../310500/index.html">Matrix-based collection development</a></li>
<li><a href="../310502/index.html">GitLab CI: Learning to Deploy</a></li>
<li><a href="../310504/index.html">Equation Group exploit box added a new instance</a></li>
<li><a href="../310506/index.html">Universal mobile electronic key</a></li>
<li><a href="../310512/index.html">Oracle promises new products to help Amazon beat Amazon in the cloud market</a></li>
<li><a href="../310514/index.html">Adapting a mobile Android TV application or why I love Google</a></li>
<li><a href="../310516/index.html">Use the Entity Framework Core with the universal Windows platform application</a></li>
<li><a href="../310518/index.html">We catch notifications using beacons</a></li>
<li><a href="../310520/index.html">Why Augmented Reality Adds Network Risk</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>