<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatically Testing Java Swing Applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! A year and a half ago, my team had to test a Java Swing application that could have different visualizations strung on a common process. The...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatically Testing Java Swing Applications</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/617/481/132/61748113277a4eefa4f70e37833c6b98.png"><br><br>  Good day!  A year and a half ago, my team had to test a Java Swing application that could have different visualizations strung on a common process.  There were few articles on this topic at that time; there were no specific solutions at all.  TestComplete and other scripting technologies (yes, TestComplete supporters will forgive me) did not want to use it, because the application must have a flexible architecture that can be expanded and modified as part of the Agile process. <br><br>  A day of Google search, analysis of dozens of examples and technologies led me to two possible options: <br><ul><li>  Fest </li><li>  Jemmy </li></ul><br>  Without plunging into the depths of the depths of comparison, I chose the Fest library.  With its help and, of course, Junit, Mockito, we started testing our application.  About this and tell below. <br><a name="habracut"></a><br>  Of course, you can start by reading the documentation from Getting Started, and use the work through FrameFixture - everything is well described <a href="http://docs.codehaus.org/display/FEST/Getting%2BStarted">here</a> , but if tasks go beyond searching / clicking on standard Java Swing components, then below, using specific tasks as an example, I will show how it's done. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's start with the robot, namely org.fest.swing.core.Robot: <br><pre><code class="java hljs">Robot robot = BasicRobot.robotWithCurrentAwtHierarchy();</code> </pre> <br>  The robot can click components, focus on them, work with the mouse cursor, perform various checks.  But we will start with the implementation of ComponentFinder, which the robot kindly provides us.  And so that it is interesting, we will look at everything with an example.  In this article, I will not propose architectural solutions, propose an implementation of the PageObject pattern for Swing, - rather, I will try to just explain with an example how to use the library.  You can already invent your own architecture - tasks are always different. <br><br>  Suppose we have a JFrame with three custom buttons.  Suppose you want to find them, check that the texts on them are ‚ÄúBuy‚Äù, ‚ÄúSell‚Äù, ‚ÄúDelete‚Äù, respectively, and that the ‚ÄúDelete‚Äù button! IsEnabled (). <br><br>  For this we need: <br><pre> <code class="java hljs">ComponentFinder finder = robot.finder();</code> </pre><br>  It has many methods, such as findByLabel, findByName.  But we will turn our attention to: <br><ul><li>  finder.find (ComponentMatcher matcher) - returns the Component </li><li>  finder.findAll (ComponentMatcher matcher) returns a Collection. </li></ul><br>  There are options for methods 1 and 2 with generic matcher passing - sometimes it is useful.  But since we usually know what we are looking for, 1 and 2 are mainly used. <br><br>  The ComponentMatcher interface is essentially one method: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">matches</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Component c)</span></span></span></span></code> </pre><br>  We will need an implementation to search our custom button for text on it: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CaptionMatcher</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ComponentMatcher</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String expectedCaption; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String actualComponentCaption; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CaptionMatcher</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String expectedCaption)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.expectedCaption = expectedCaption; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">matches</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Component comp)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (comp != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; expectedCaption != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; comp <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> CustomButton) { actualComponentCaption = ((CustomButton) comp).getText(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (expectedCaption.equals(actualComponentCaption)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getExpectedCaption</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> expectedCaption; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setExpectedCaption</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String expectedCaption)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.expectedCaption = expectedCaption; } }</code> </pre><br>  Now let's try to find our first button: <br><pre> <code class="java hljs">finder.find(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CaptionMatcher(<span class="hljs-string"><span class="hljs-string">""</span></span>));</code> </pre><br>  If it is not found, it will return a ComponentLookupException.  We can also find the second button and the third one by changing the expectedCaption of the matcher.  With the third button, you can do differently.  If you often have to check the buttons ‚Äúzadizabilnost‚Äù, then you should overload the CaptionMatcher constructor and add to enable / disable check in matches. <br><br>  If rarely, you can just like this: <br><pre> <code class="java hljs">CustomButton btnDel = (CustomButton) finder.find(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CaptionMatcher(<span class="hljs-string"><span class="hljs-string">""</span></span>)); Assert.assertTrue(!btnDel.isEnabled());</code> </pre><br>  It was possible to go the other way - to make ClassMatcher, in which matches returns true, if the component of the instanceof CustomButton.  And search using findAll.  Then we would get all the buttons and then, running through them, would lead to the class of our buttons and check everything that is needed. <br><br>  At this point, one remark is absolutely necessary - nobody canceled threads on Swing rendering, and if you start searching for a component before it has been rendered, you will receive a ComponentLookupException.  Therefore, the best practice, in my opinion, is to wrap the search for a component in a loop and look for a component with a certain timeout, intercepting all the search errors.  If a component was not found for the selected timeout, then assume that it is not there and throw a ComponentLookupException above. <br><br>  We learned to find components.  Now about the clicks.  Experience has shown that it is better to throw an ActionEvent directly to a component than to try using a robot to click with the mouse.  First, with this approach, you can safely continue to work while chasing tests, and second, to quit the event faster than clicking.  We have this event implemented at the level of the component itself - decorated in the form of the public method doClick (). <br><br>  To demonstrate the Fest in action: <br><br>  1. Below is a link to turnips - for clarity, I sketched out a few tests that check addition, subtraction, and multiplication in a calculator.  Please note that between the clicks inserted Thread.sleep (100); <br>  In order to speed up, it is better to somehow form the ‚Äúexpected‚Äù result of the action.  Not only in the calculator, but also in any other project - it is desirable to associate any action with the expected result. <br><br>  <a href="https://bitbucket.org/stovmasyan/calcexample/">bitbucket.org/stovmasyan/calcexample/</a> <br><br>  Here is a video of the launch of these tests: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/JMBw_CcyeJI%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700253&amp;usg=ALkJrhgrzCGyEu-ztbiNgh1Nz98c5X9w6w" frameborder="0" allowfullscreen=""></iframe><br><br>  2. And here is a video of how our product is automatically tested - the <a href="http://www.crystals.ru/self-checkout">self-checkout checkout</a> .  Everything is built on actions and expected results.  Some screens and components you do not even have time to see - nevertheless, they manage to be checked along and across: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/AgdAZJgZ5ts%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700253&amp;usg=ALkJrhgP1XekJTZMghTbQk_inkDVKLR7Tw" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/251339/">https://habr.com/ru/post/251339/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251329/index.html">Static JavaScript analyzers and errors from which they will help to unlearn (Part 2)</a></li>
<li><a href="../251331/index.html">Registration for the fifth annual championship on sports programming Russian Code Cup has begun</a></li>
<li><a href="../251333/index.html">Lossless Image Compression</a></li>
<li><a href="../251335/index.html">Interactive map of the shopping center on HTML5 canvas</a></li>
<li><a href="../251337/index.html">Architectural design of mobile applications: part 2</a></li>
<li><a href="../251341/index.html">Whip and ... whip information security in the enterprise</a></li>
<li><a href="../251345/index.html">Pebble Time: a new watch with a color screen</a></li>
<li><a href="../251347/index.html">Context Model Pattern via Aero Framework</a></li>
<li><a href="../251349/index.html">Processing logs based on previous messages in logstash / elasticsearch</a></li>
<li><a href="../251351/index.html">CoinFest-2015-Moscow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>