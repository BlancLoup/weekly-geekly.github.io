<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Another way to get around PornHub lock</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think everyone remembers the telnet version of SW: New Hope. In connection with the blocking of PornHub, an idea arose to do something similar with ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Another way to get around PornHub lock</h1><div class="post__text post__text-html js-mediator-article">  I think everyone remembers the telnet version of SW: New Hope.  In connection with the blocking of PornHub, an idea arose to do something similar with their video.  Armed with a python and try to implement the idea. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Dgwyo6JNTDA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  That StarWars. <br><a name="habracut"></a><br><h3>  1. Content extraction </h3><br>  Pornhab has quite a distinct api, so let's use it.  The description is <a href="http://hubtraffic.com/">here</a> (unfortunately, you will have to register).  With it, you can pull out links to pages with video, but then we still have to dig into html.  Fortunately, the desired link is easily ripped out using the regular page: <br><br><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getVideoUrl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(pageUrl)</span></span></span><span class="hljs-function">:</span></span> response = urllib2.urlopen(pageUrl) content = response.read() videoRegex = re.compile(<span class="hljs-string"><span class="hljs-string">r'player_quality_\d+p\s+=\s+\'(?P&lt;url&gt;.+?\';)'</span></span>) m = videoRegex.search(content) url = m.group(<span class="hljs-string"><span class="hljs-string">'url'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> url</code> </pre> <br>  What else is worth noting at this stage: pornhub periodically returns 403 when trying to download a video, this problem is solved by changing the User-Agent. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  2. Conversion </h3><br>  Now we need to convert the video to ASCII graphics.  To do this, we use OpenCV.  The algorithm is extremely simple: <br><br><ul><li>  RGB -&gt; Grayscale </li><li>  Downscale to the desired resolution </li><li>  Convert pixels to character </li></ul><br>  Since we are going to output the result in telnet, let's take the 80x24 resolution as a basis: <br><br><pre> <code class="python hljs">gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY) res = cv2.resize(gray, (<span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>))</code> </pre> <br>  I think we should explain why we are converting to grayscale: we are only interested in information about the illumination, it can be obtained in two ways - convert to YUV and pull out the Y channel or convert to grayscale. <br><br>  Then we just need to iterate over the pixels and convert the resulting values ‚Äã‚Äãinto characters: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lumToChar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> result = <span class="hljs-string"><span class="hljs-string">'@'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> l &gt;= <span class="hljs-number"><span class="hljs-number">230.0</span></span>: result = <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> l &gt;= <span class="hljs-number"><span class="hljs-number">200.0</span></span>: result = <span class="hljs-string"><span class="hljs-string">'.'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> l &gt;= <span class="hljs-number"><span class="hljs-number">180.0</span></span>: result = <span class="hljs-string"><span class="hljs-string">'*'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> l &gt;= <span class="hljs-number"><span class="hljs-number">160.0</span></span>: result = <span class="hljs-string"><span class="hljs-string">':'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> l &gt;= <span class="hljs-number"><span class="hljs-number">130.0</span></span>: result = <span class="hljs-string"><span class="hljs-string">'o'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> l &gt;= <span class="hljs-number"><span class="hljs-number">100.0</span></span>: result = <span class="hljs-string"><span class="hljs-string">'&amp;'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> l &gt;= <span class="hljs-number"><span class="hljs-number">70.0</span></span>: result = <span class="hljs-string"><span class="hljs-string">'8'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> l &gt;= <span class="hljs-number"><span class="hljs-number">50.0</span></span>: result = <span class="hljs-string"><span class="hljs-string">'#'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result</code> </pre><br><h3>  3. Output to telnet </h3><br>  All that is left for us to do is to raise the tcp server and stream our video there when connected.  However, there is a snag: every frame needs to be cleared buffer.  To do this, simply send the client an escape sequence: <br><br><pre> <code class="python hljs">escapeSeq = <span class="hljs-string"><span class="hljs-string">'\033[2J'</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">NSFW</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/6bc/29c/034/6bc29c03480547b5b7822e80ce62a6e8.png" alt="image"><br>  Guess what it is. </div></div><br><h3>  4. Conclusion </h3><br>  <b>Q:</b> Why? <br>  <b>A:</b> There was free time. <br>  <b>Q:</b> Where can I get results? <br>  <b>A:</b> telnet 185.146.170.134 9002 </div><p>Source: <a href="https://habr.com/ru/post/310192/">https://habr.com/ru/post/310192/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../310176/index.html">Logeek Night in Voronezh</a></li>
<li><a href="../310180/index.html">What is such a Data? Or again about MapReduce</a></li>
<li><a href="../310182/index.html">The problem of dissonance between the narrative and the gameplay</a></li>
<li><a href="../310186/index.html">Responsive Font Size</a></li>
<li><a href="../310188/index.html">Registration is now open for Russia's first international Testathon</a></li>
<li><a href="../310196/index.html">MapReduce from scrap materials. Part II - Basic Implementation Interfaces</a></li>
<li><a href="../310198/index.html">8 signs of infantilism in business</a></li>
<li><a href="../310200/index.html">We implement Brotli with the help of Nginx - we save bytes almost for free</a></li>
<li><a href="../310202/index.html">Installing your SSL certificates on the D-Link DNS-320L file storage</a></li>
<li><a href="../310204/index.html">New plugin from Stepik.org for IntelliJ IDEA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>