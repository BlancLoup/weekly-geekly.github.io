<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parsing the site using T-SQL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! A couple of years ago, I read forums on the Internet and prepared a direct T-SQL query that received GPS coordinates from the delivery addre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parsing the site using T-SQL</h1><div class="post__text post__text-html js-mediator-article">  Good day!  A couple of years ago, I read forums on the Internet and prepared a direct T-SQL query that received GPS coordinates from the delivery addresses of all the company's customers in the 1C: Trade Management, Version 11 database.  The transition to work by coordinates was caused by frequent cases of changes in the address classifier in different programs of departments (sales department and delivery department).  The persuasion of departments to work in the same program without success. <br><a name="habracut"></a><br><h2>  Step one: <br></h2><br>  - Get the coordinates of a single client from his delivery address (for debugging a template): <br><br><pre><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">Declare</span></span> @URI1 <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-number"><span class="hljs-number">4000</span></span>)=<span class="hljs-string"><span class="hljs-string">'107113,  ,  ,  ‚Ññ 1-'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">count</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>, @i1 <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>, @urlReturn <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-number"><span class="hljs-number">4000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Declare</span></span> @s1 <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">count</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">LEN</span></span>(@URI1) <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> @i1 = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> @urlReturn = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (@i1 &lt;= @<span class="hljs-keyword"><span class="hljs-keyword">count</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> @s1 = <span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(@URI1, @i1, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ASCII</span></span>(@s1) &gt; <span class="hljs-number"><span class="hljs-number">191</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ASCII</span></span>(@s1) &lt;= <span class="hljs-number"><span class="hljs-number">256</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> @urlReturn = @urlReturn + sys.fn_varbintohexstr(<span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span>(@s1 <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> VARBINARY(<span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> @urlReturn = <span class="hljs-keyword"><span class="hljs-keyword">replace</span></span>(@urlReturn, <span class="hljs-string"><span class="hljs-string">'0x'</span></span>, <span class="hljs-string"><span class="hljs-string">'%'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> @urlReturn = @urlReturn + @s1 <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> @i1 = @i1 +<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @URI <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">2000</span></span>)=<span class="hljs-string"><span class="hljs-string">'https://geocode-maps.yandex.ru/1.x/?geocode='</span></span>+@urlReturn, @methodName <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">50</span></span>)=<span class="hljs-string"><span class="hljs-string">'GET'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @objectID <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>, @hResult <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> EXEC @hResult = sp_OACreate <span class="hljs-string"><span class="hljs-string">'WinHttp.WinHttpRequest.5.1'</span></span>, @objectID <span class="hljs-keyword"><span class="hljs-keyword">OUT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> @hResult &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> destroy EXEC @hResult = sp_OAMethod @objectID, <span class="hljs-string"><span class="hljs-string">'open'</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, @methodName, @URI, <span class="hljs-string"><span class="hljs-string">'false'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> @hResult &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> destroy EXEC @hResult = sp_OAMethod @objectID, <span class="hljs-string"><span class="hljs-string">'send'</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> @hResult &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> destroy <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @t <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>(s <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> @t EXEC sp_OAGetProperty @objectID, <span class="hljs-string"><span class="hljs-string">'responseText'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> @hResult &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> destroy <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @n <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @STRLEN <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @STRLEN=<span class="hljs-keyword"><span class="hljs-keyword">LEN</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(s,<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s)+<span class="hljs-number"><span class="hljs-number">5</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;/pos&gt;'</span></span>,s)-<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s))<span class="hljs-number"><span class="hljs-number">-5</span></span>))+<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> @t <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @n=<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">' '</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(s,<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s)+<span class="hljs-number"><span class="hljs-number">5</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;/pos&gt;'</span></span>,s)-<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s))<span class="hljs-number"><span class="hljs-number">-5</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> @t <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(s,<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s)+<span class="hljs-number"><span class="hljs-number">5</span></span>,@n) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> LON, <span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(s,<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s)+<span class="hljs-number"><span class="hljs-number">5</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;/pos&gt;'</span></span>,s)-<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s))<span class="hljs-number"><span class="hljs-number">-5</span></span>),@n,@STRLEN-@n) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> LAT, <span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(s,<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s)+<span class="hljs-number"><span class="hljs-number">5</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;/pos&gt;'</span></span>,s)-<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s))<span class="hljs-number"><span class="hljs-number">-5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> @t destroy: exec sp_OADestroy @objectID</code> </pre> <br><h2>  Step two: </h2><br>  - Enumerate all client delivery addresses and get GPS coordinates: <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @URI1 <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-number"><span class="hljs-number">4000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @ID1 <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> curMarks <span class="hljs-keyword"><span class="hljs-keyword">CURSOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOCAL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SCROLL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">STATIC</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> [ki]._Fld2260 <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [Adress], [p].[_CODE] <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> [UT_TEST_COPY].[dbo].[_Reference107] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> [p] <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OUTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> [UT_TEST_COPY].[dbo].[_Reference107_VT2256] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> [ki] <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (NOLOCK) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> ([p].[_IDRRef]=[ki].[_Reference107_IDRRef]) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> [ki]._Fld2259RRef=<span class="hljs-number"><span class="hljs-number">0x8757A30F90F658984F74B3E6BDCE0041</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> [p]._Fld11004RRef=<span class="hljs-number"><span class="hljs-number">0xA576BCAEC54B2C9E11E23ACC96E85A13</span></span> <span class="hljs-comment"><span class="hljs-comment">/*AND [p]._Fld11721RRef=0x814665286A763EC746207B8AD89C8693*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> [p]._Fld11721RRef=<span class="hljs-number"><span class="hljs-number">0xB54E694250E409A6463884A95998E32A</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OPEN</span></span> curMarks <span class="hljs-keyword"><span class="hljs-keyword">FETCH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEXT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> curMarks <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> @URI1,@ID1; WHILE @@FETCH_STATUS = 0 <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">count</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>, @i1 <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>, @urlReturn <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-number"><span class="hljs-number">4000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Declare</span></span> @s1 <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">count</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">LEN</span></span>(@URI1) <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> @i1 = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> @urlReturn = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (@i1 &lt;= @<span class="hljs-keyword"><span class="hljs-keyword">count</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> @s1 = <span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(@URI1, @i1, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ASCII</span></span>(@s1) &gt; <span class="hljs-number"><span class="hljs-number">191</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ASCII</span></span>(@s1) &lt;= <span class="hljs-number"><span class="hljs-number">256</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> @urlReturn = @urlReturn + sys.fn_varbintohexstr(<span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span>(@s1 <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> VARBINARY(<span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> @urlReturn = <span class="hljs-keyword"><span class="hljs-keyword">replace</span></span>(@urlReturn, <span class="hljs-string"><span class="hljs-string">'0x'</span></span>, <span class="hljs-string"><span class="hljs-string">'%'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> @urlReturn = @urlReturn + @s1 <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> @i1 = @i1 +<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @URI <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">2000</span></span>)=<span class="hljs-string"><span class="hljs-string">'https://geocode-maps.yandex.ru/1.x/?geocode='</span></span>+@urlReturn, @methodName <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">50</span></span>)=<span class="hljs-string"><span class="hljs-string">'GET'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @objectID <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>, @hResult <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> EXEC @hResult = sp_OACreate <span class="hljs-string"><span class="hljs-string">'WinHttp.WinHttpRequest.5.1'</span></span>, @objectID <span class="hljs-keyword"><span class="hljs-keyword">OUT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> @hResult &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> destroy EXEC @hResult = sp_OAMethod @objectID, <span class="hljs-string"><span class="hljs-string">'open'</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, @methodName, @URI, <span class="hljs-string"><span class="hljs-string">'false'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> @hResult &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> destroy EXEC @hResult = sp_OAMethod @objectID, <span class="hljs-string"><span class="hljs-string">'send'</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> @hResult &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> destroy <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @t <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>(s <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> @t EXEC sp_OAGetProperty @objectID, <span class="hljs-string"><span class="hljs-string">'responseText'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> @hResult &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> destroy <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @LAT <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @LON <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @n <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @STRLEN <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @STRLEN=<span class="hljs-keyword"><span class="hljs-keyword">LEN</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(s,<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s)+<span class="hljs-number"><span class="hljs-number">5</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;/pos&gt;'</span></span>,s)-<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s))<span class="hljs-number"><span class="hljs-number">-5</span></span>))+<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> @t <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @n=<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">' '</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(s,<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s)+<span class="hljs-number"><span class="hljs-number">5</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;/pos&gt;'</span></span>,s)-<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s))<span class="hljs-number"><span class="hljs-number">-5</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> @t <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @LON=<span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(s,<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s)+<span class="hljs-number"><span class="hljs-number">5</span></span>,@n), @LAT=<span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(s,<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s)+<span class="hljs-number"><span class="hljs-number">5</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;/pos&gt;'</span></span>,s)-<span class="hljs-keyword"><span class="hljs-keyword">CHARINDEX</span></span>(<span class="hljs-string"><span class="hljs-string">'&lt;pos&gt;'</span></span>,s))<span class="hljs-number"><span class="hljs-number">-5</span></span>),@n,@STRLEN-@n) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> @t <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @UpdateSQL <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> @UpdateSQL = <span class="hljs-string"><span class="hljs-string">' UPDATE [UT_TEST_COPY].[dbo].[_Reference107] '</span></span> + <span class="hljs-string"><span class="hljs-string">' SET _Fld11002 = '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">RTRIM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">LTRIM</span></span>(@LAT)) + <span class="hljs-string"><span class="hljs-string">','</span></span> + <span class="hljs-string"><span class="hljs-string">' _Fld11003 = '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">RTRIM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">LTRIM</span></span>(@LON)) + <span class="hljs-string"><span class="hljs-string">' WHERE _CODE = '</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">CHAR</span></span>(<span class="hljs-number"><span class="hljs-number">39</span></span>)+ @ID1 + <span class="hljs-built_in"><span class="hljs-built_in">CHAR</span></span>(<span class="hljs-number"><span class="hljs-number">39</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">EXECUTE</span></span>(@UpdateSQL) destroy: exec sp_OADestroy @objectID <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> @t <span class="hljs-keyword"><span class="hljs-keyword">FETCH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEXT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> curMarks <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> @URI1,@ID1; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CLOSE</span></span> curMarks <span class="hljs-keyword"><span class="hljs-keyword">DEALLOCATE</span></span> curMarks</code> </pre> <br><h2>  Step Three: </h2><br>  - Clearing the table of import of exit requests in the ‚ÄúANTOR LogisticsMaster‚Äù route building program: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">DELETE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FROM</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[LMaster]</span></span>.<span class="hljs-selector-attr"><span class="hljs-selector-attr">[dbo]</span></span>.<span class="hljs-selector-attr"><span class="hljs-selector-attr">[D__IMPORT0]</span></span></code> </pre> <br><h2>  Step Four: </h2><br>  - Uploading applications for exit to the ANTOR LogisticsMaster route building program: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> [LMaster].[dbo].[D__IMPORT0] ([EXT_ID] ,[EXT_STRID] ,[OPER_ID] ,[ORD_TYP] ,[DELIV_DATE] ,[ROUTE_ID] ,[ROUTE_NUM] ,[NUM_INROUTE] ,[CUST_ID] ,[CUST_STRID] ,[RENTED] ,[UNLOAD_TYP] ,[CATEGORY_ID] ,[TIME_BEG] ,[TIME_END] ,[TIME_UNLOAD] ,[ACTIVE] ,[ZONE_ID] ,[ACCESS_ID] ,[OGRSUM1] ,[OGRSUM2] ,[SUM3] ,[SUM4] ,[ADDR] ,[DISTR] ,[TOWN] ,[STREET] ,[HOUS] ,[CORP] ,[LINKED] ,[X] ,[Y] ,[DISTANC] ,[TIME_ARR] ,[VIRT] ,[SOST] ,[STR1] ,[STR2] ,[STR3] ,[STR4] ,[STR5] ,[STR6] ,[INT1] ,[<span class="hljs-type"><span class="hljs-type">INT2</span></span>] ,[INT3] ,[MIN_CAR] ,[MAX_CAR] ,[EXP1] ,[EXP2] ,[EXP3] ,[MACROZONE_ID] ,[PICT] ,[WIDTH] ,[HEIGHT] ,[LENGTH] ,[STORE1] ,[STORE2] ,[STORE3] ,[STORE4] ,[STORE5] ,[LATITUDE] ,[LONGITUDE]) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[EXT_ID], int*/</span></span> ,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[EXT_STRID], nvarchar(36)*/</span></span> ,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[OPER_ID], int*/</span></span> ,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[ORD_TYP], int*/</span></span> ,(Convert(datetime,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span>,<span class="hljs-number"><span class="hljs-number">104</span></span>)) <span class="hljs-comment"><span class="hljs-comment">/*[DELIV_DATE], datetime*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[ROUTE_ID], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[ROUTE_NUM], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[NUM_INROUTE], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[CUST_ID], int*/</span></span> ,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[CUST_STRID], nvarchar(36)*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[RENTED], bit*/</span></span> ,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[UNLOAD_TYP], int*/</span></span> ,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[CATEGORY_ID], int*/</span></span> ,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[TIME_BEG], datetime*/</span></span> ,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[TIME_END], datetime*/</span></span> ,(Convert(datetime,<span class="hljs-string"><span class="hljs-string">'19000101'</span></span>,<span class="hljs-number"><span class="hljs-number">104</span></span>)) <span class="hljs-comment"><span class="hljs-comment">/*[TIME_UNLOAD], datetime*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[ACTIVE], int*/</span></span> ,"+_SQL+" <span class="hljs-comment"><span class="hljs-comment">/*[ZONE_ID], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[ACCESS_ID], int*/</span></span> ,"+_SQL+" <span class="hljs-comment"><span class="hljs-comment">/*[OGRSUM1], float*/</span></span> ,"+_SQL+" <span class="hljs-comment"><span class="hljs-comment">/*[OGRSUM2], float*/</span></span> ,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[SUM3], float*/</span></span> ,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[SUM4], float*/</span></span> ,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[ADDR], nvarchar(100)*/</span></span> ,"+_SQL+" <span class="hljs-comment"><span class="hljs-comment">/*[DISTR], nvarchar(50)*/</span></span> ,"+_SQL+" <span class="hljs-comment"><span class="hljs-comment">/*[TOWN], nvarchar(50)*/</span></span> ,"+_SQL+" <span class="hljs-comment"><span class="hljs-comment">/*[STREET], nvarchar(50)*/</span></span> ,"+_SQL+" <span class="hljs-comment"><span class="hljs-comment">/*[HOUS], nvarchar(20)*/</span></span> ,"+_SQL+" <span class="hljs-comment"><span class="hljs-comment">/*[CORP], nvarchar(20)*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[LINKED], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[X], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[Y], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[DISTANC], float*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[TIME_ARR], datetime*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[VIRT], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[SOST], int*/</span></span> ,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STR1], nvarchar(255)*/</span></span> ,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STR2], nvarchar(255)*/</span></span> ,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STR3], nvarchar(255)*/</span></span> ,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STR4], nvarchar(255)*/</span></span> ,<span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STR5], nvarchar(100)*/</span></span> ,<span class="hljs-string"><span class="hljs-string">'"+_SQL+"'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STR6], nvarchar(255)*/</span></span> ,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[INT1], int*/</span></span> ,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[INT2], int*/</span></span> ,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[INT3], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[MIN_CAR], float*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[MAX_CAR], float*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[EXP1], nvarchar(36)*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[EXP2], nvarchar(36)*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[EXP3], nvarchar(36)*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[MACROZONE_ID], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[PICT], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[WIDTH], float*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[HEIGHT], float*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[LENGTH], float*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STORE1], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STORE2], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STORE3], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STORE4], int*/</span></span> ,<span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*[STORE5], int*/</span></span> ,"+_SQL+" <span class="hljs-comment"><span class="hljs-comment">/*[LATITUDE], FLOAT*/</span></span> ,"+_SQL+" <span class="hljs-comment"><span class="hljs-comment">/*[LONGITUDE], FLOAT*/</span></span>)</code> </pre> <br><h2>  Step Five: </h2><br>  - Update the status of requests for exit in the program "1C: Trade Management, Version 11": <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> D.EXT_STRID <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> _CRM, D.NAME <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> , O.TIME_ARR <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> , O.EXT_STRID <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> , O.DISTANC <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> , R.LEN-(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> sum(O1.DISTANC) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dbo.D__ORDERS0 <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> O1 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> O1.ROUTE_ID=R.ID) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> , O.LATITUDE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> LATITUDE, O.LONGITUDE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> LONGITUDE, O.ZONE_ID <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dbo.D__ZONE0 <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> Z <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span>(NOLOCK) <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> dbo.D__DRIVERS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> D <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span>(NOLOCK) <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> dbo.D__CARS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> C <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span>(NOLOCK) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> D.ID = C.DRIVER_ID <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> dbo.D__ROUTE0 <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> R <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span>(NOLOCK) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> C.ID = R.CAR_ID <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> Z.ID = R.ZONE_ID <span class="hljs-keyword"><span class="hljs-keyword">RIGHT OUTER JOIN</span></span> dbo.D__ORDERS0 <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> O <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span>(NOLOCK) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> R.ID = O.ROUTE_ID <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> (O.SOST &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> (O.ROUTE_ID &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> D.NAME, O.ROUTE_NUM, O.NUM_INROUTE</code> </pre> <br><h2>  You ask how I got to "this"? </h2><br>  The answer comes (if you dig a little in the memory with a psychologist): <br><br>  - 20 years ago I ‚Äúworked‚Äù at the UAZ in a friendly team of the department of automated enterprise management system technician. <br>  I can‚Äôt call it work at all (the green teenager is always doing everything wrong). <br>  I remember all the guys and remember with tears how I miss them.  Unfortunately, it‚Äôs impossible to find the coordinates of Ivan Ivanovich Davydenko (he was the one who tried to dissuade <br>  me from learning the language T-SQL - the forbidden fruit), I heard he went to Aviastar. </div><p>Source: <a href="https://habr.com/ru/post/357696/">https://habr.com/ru/post/357696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357686/index.html">Deprived of the premium for Russian citizenship, the programmer will receive a payment from Mail.ru</a></li>
<li><a href="../357688/index.html">Client-server step-by-step, from single-threaded to multi-threaded (Client-Server step by step)</a></li>
<li><a href="../357690/index.html">Getting Instagram users by city</a></li>
<li><a href="../357692/index.html">Certificate Store in LibreOffice Office Suite</a></li>
<li><a href="../357694/index.html">Haskell - knight's move</a></li>
<li><a href="../357698/index.html">Documentation generator using built-in 1C: Enterprise 8.3.10 language</a></li>
<li><a href="../357700/index.html">External scripts with access to your credit cards and personal account</a></li>
<li><a href="../357702/index.html">Haskel - knight's move II</a></li>
<li><a href="../357704/index.html">How not to work with time zones or Aeroflot-Fail</a></li>
<li><a href="../357706/index.html">Haskell - knight's move 3. Conclusion</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>