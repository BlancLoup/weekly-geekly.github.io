<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Jquery-ui inside a binary</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Haskel programs have one property. After compilation, we get a self-contained binary, one file with executable machine code. Languages ‚Äã‚Äãwith compiler...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Jquery-ui inside a binary</h1><div class="post__text post__text-html js-mediator-article">  Haskel programs have one property.  After compilation, we get a self-contained binary, one file with executable machine code.  Languages ‚Äã‚Äãwith compilers, convenient for web development, not so much.  This property has no special significance.  However, it allows you to achieve unsurpassed ease of installing programs.  And not only the installation, but all that is hidden behind the English word <i>deployment</i> . <br><br>  Web applications use additional data - images, css styles, javascript scripts.  As a rule, they are stored separately from the executable code of the application in the file system of the web server.  But if these additional resources are less than a megabyte - why not embed them directly into the binary?  Making web application deployment easier! <br><a name="habracut"></a><br>  This article continues the <a href="http://habrahabr.ru/blogs/Haskell/124270/">theme of a</a> small but interesting project <a href="http://iptadmin.confmgr.org/ru/about.html">iptadmin</a> . <br><br><h4>  Embedding </h4><br>  Embedding text into an executable file is a simple task.  It is enough to create a string constant.  Embedding binary files in an executable file is a bit more complicated. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In <a href="http://hackage.haskell.org/">hackage</a> , a <a href="">file-embed</a> library from the <a href="http://www.snoyman.com/">author of the</a> web-framework <a href="http://www.yesodweb.com/">yesod was found</a> . <br>  This library, using the <a href="http://www.haskell.org/ghc/">ghc</a> <a href="http://www.haskell.org/haskellwiki/Template_Haskell">template haskell</a> extension, reads arbitrary files at compile time, converts them to strings, saves to string constants and provides an interface to them as to byte strings.  String characters with codes outside the printable range are saved without problems.  As with this approach, they do not participate in the input / output and are not displayed in the code editor. <br><br>  The author of the library suggests using the <a href="http://hackage.haskell.org/packages/archive/file-embed/0.0.4.1/doc/html/Data-FileEmbed.html">embedDir</a> function.  It retrieves a list of files from the specified directory, and creates a list of pairs (Filename, Byte string) for convenient processing of a large set of files. <br><br>  But still, the <a href="http://hackage.haskell.org/packages/archive/file-embed/0.0.4.1/doc/html/Data-FileEmbed.html">embedFile</a> function was used, it is called for each file separately ( <a href="">PageHandlers function</a> ).  This increased the amount of code, but gave confidence that if the program was compiled, then all the files are definitely there.  The number of tests required has decreased. <br><br><h4>  Access to resources </h4><br>  Url to access the "static" data is left unchanged.  Therefore, in the client part of the application did not have to edit anything.  The http root directory of the / static server is processed by a separate handler.  The handler is called at the beginning of the authorization function ( <a href="">authorize</a> ).  Before the authorization procedure, the login page works correctly. <br><br>  <a href="http://happstack.com/">It is</a> quite simple to give the client a file using the ByteString in <a href="http://happstack.com/">Happstack</a> .  You can lapidably collect a <a href="http://hackage.haskell.org/packages/archive/happstack-server/6.2.2/doc/html/Happstack-Server-Internal-Types.html">Response</a> value using the Response data constructor.  In the rsHeaders field, add a header with Content-Type, in the rsBody field, specify our saved ByteString. <br><br>  However, the Happstack.Server.FileServe.BuildingBlocks module appeared in Happstack 6, which does exactly what you need.  The <a href="http://hackage.haskell.org/packages/archive/happstack-server/6.2.2/doc/html/Happstack-Server-FileServe-BuildingBlocks.html">strictByteSTringResponse</a> function accepts a ByteString input, a Content-Type description, and returns a file to the client.  This feature has been used.  To transfer different types of files to the <a href="">client, the returnJs, returnCss, and returnPng</a> functions are written. <br><br><h4>  304 </h4><br>  ‚ÄúLarge‚Äù web servers support <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html">conditional GET</a> requests with If-Modified-Since headers, and if the requested file has not changed since the last access, return code <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">304</a> with an empty message-body.  This method speeds up web applications and reduces network traffic. <br><br>  Answer client code 304 for already loaded resources necessary.  In the case of assembling a response to a client manually, using the Response constructor, you would also need to manually analyze the request and verify that the data has not changed since the last request.  The functions of the Happstack.Server.FileServe.BuildingBlocks module implement this functionality ‚Äúunder the hood‚Äù.  It is only necessary to transmit the date and time of the data change. <br><br>  Where to get this date?  Obviously, in our case, the time of the last change of the ‚Äúfile‚Äù will be the compilation time of the application.  Therefore, we will get it in the compilation process using template haskell ( <a href="">updateTime</a> ). <br><br><h4>  Problems and Solutions </h4><br>  This approach has several obvious problems. <br><br>  When changing only static files, the build system does not rebuild the Static module.  Therefore, to force a rebuild, you need to run the <i>touch Static.hs command</i> , and then build it.  The <i>htmlrebuild</i> command has been added to automate the Makefile. <br><br>  In addition, the development cycle is significantly increased.  After editing the javascript program, you need to completely rebuild the application's Static module.  Then run it, and only after that you can start debugging.  This question is solved simply, at the time of development you need to enable access through the / static directory to files in the file system.  How this is done in all web applications.  By means of happstack this is done trivially.  And only during the assembly of the finished release to embed resources in the executable file. <br><br>  ps <br>  As usual, I will be glad to criticism and any other feedback. <br>  If someone suddenly accidentally post on this topic seemed interesting, suggest interesting topics for future posts.  If there is no account on this great site, there are other ways to contact. </div><p>Source: <a href="https://habr.com/ru/post/128705/">https://habr.com/ru/post/128705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128698/index.html">Debian 6 + LAMP local server from testing</a></li>
<li><a href="../128699/index.html">Mail.Ru Agent in the browser: approaches to state synchronization</a></li>
<li><a href="../128701/index.html">Internet on the ship: satellite dish + modems + balancer + Wi-Fi</a></li>
<li><a href="../128703/index.html">Adding Designer Parameters to the MXML Flex Compiler</a></li>
<li><a href="../128704/index.html">Genetic algorithm. Just about the difficult</a></li>
<li><a href="../128706/index.html">Using synonyms in SEO: bundles, holes, underpages</a></li>
<li><a href="../128707/index.html">Console application PassKeep</a></li>
<li><a href="../128709/index.html">Another implementation of the field "city" for Django</a></li>
<li><a href="../128710/index.html">Fast implementation of incremental backup on Amazon S3</a></li>
<li><a href="../128711/index.html">Immersion into the scripts of the Unity3d game engine, part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>