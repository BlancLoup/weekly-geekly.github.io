<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We study MITER ATT & CK. Mobile Matrices: Device Access. Part 5</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Review (Discovery) and Lateral Movement (Lateral Movement) 
 Links to all parts: 

 Part 1. Initial access to a mobile device (Initial Access) 
 Part ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We study MITER ATT & CK. Mobile Matrices: Device Access. Part 5</h1><div class="post__text post__text-html js-mediator-article"><h2>  Review (Discovery) and Lateral Movement (Lateral Movement) </h2><br>  <b>Links to all parts:</b> <br><br>  <a href="https://habr.com/ru/post/451602/">Part 1. Initial access to a mobile device (Initial Access)</a> <br>  <a href="https://habr.com/ru/post/454714/">Part 2. Persistence and Privilege Escalation</a> <br>  <a href="https://habr.com/ru/post/454878/">Part 3. Getting Credential Access</a> <br>  <a href="https://habr.com/ru/post/455082/">Part 4. Defense Evasion</a> <br><br>  Having gained access to the mobile device, the adversary will probably try to use the standard means of the operating system to ‚Äúlook around‚Äù, understand what advantage is gained, whether it contributes to the achievement of the invasion goal.  This stage of the attack is called ‚ÄúDiscovery‚Äù.  Survey techniques are aimed at obtaining information about the characteristics of a compromised mobile device, as well as other available network systems. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After evaluating the capabilities of the attacked environment, the adversary will attempt to gain access to remote systems, and, possibly, control over them, will attempt to launch malicious tools on remote systems.  The described activity is called Lateral Movement.  Methods of lateral movement also include means of collecting information from remote systems without the use of additional tools, such as the RAT utility (Remote Access Tools). <br><a name="habracut"></a><br>  <i>The author is not responsible for the possible consequences of the application of the information contained in the article, and also apologizes for any inaccuracies in some formulations and terms.</i>  <i>The published information is a free retelling of the content of the <a href="https://attack.mitre.org/matrices/mobile/">ATT @ CK Mobile Matrices: Device Access</a> .</i> <br><br><h2>  <a href="https://attack.mitre.org/tactics/TA0032/">Review (Discovery)</a> </h2><br><h3>  <a href="https://attack.mitre.org/techniques/T1418">Application Discovery Overview</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description:</i> In order to detect security tools in an attacked system, an attacker may try to identify applications installed on the device that may increase the risk of detecting malicious activity or, on the contrary, identify applications that will be targeted by a further attack. <br><br>  In Android, applications can use the <i>PackageManager</i> class <i>method</i> to enumerate other applications or other objects with access to the command line to use the " <i>pm</i> " command.  In iOS, applications can use private API calls to get a list of applications installed on the device.  However, an application using private API calls will probably not be accepted in the AppStore. <br><br>  <i>Security Tips</i> <i>:</i> Application verification methods should include tools for identifying applications that use the <i>PackageManager</i> class to list other applications, but this approach may not be practical, because  many applications call <i>PackageManager</i> class <i>methods</i> as part of their normal work.  In iOS, application verification tools similarly can search for private API calls. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1419">Device Type Discovery</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> In Android, information about the type of device is available through the <i>android.os.Build</i> class.  Device information can be used to further exploit targeted exploits that raise privileges. <br><br>  <i>Security Tips:</i> During the pre-test, applications that use the <i>android.os.Build</i> class can be detected, but this measure is not effective, because many applications use this functionality as part of their regular work. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1420">File and Directory Discovery Detection</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> To enumerate the contents of the file system in Android, you can use the command line tools or Java API to work with files.  However, in Linux and SELinux, application access to files is usually very limited (unless you use an exploit to elevate privileges).  As a rule, external storage is accessible to applications, therefore storing confidential data there in an improper manner should cause concern.  IOS security architecture usually limits the ability to locate files and directories without extended privileges. <br><br>  <i>Security Tips:</i> Privilege escalation is complicated with every new version of Android and iOS.  The latest versions of Android have been enhanced sandbox, limiting the ability of applications to list the contents of the file system. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1423">Network Service Scanning</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description:</i> With the help of port scanners and vulnerabilities, attackers can try to get a list of services running on remote devices, including those that have remote-exploitable vulnerabilities.  The presence of a mobile device connecting to the internal network of the enterprise via a local or VPN connection can be perceived by the enemy as a potential advantage. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1424">Process Discovery</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> In Android up to version 5, applications can receive information about other processes running through the methods of the <i>ActivityManager</i> class.  On Android older than version 7, applications can receive this information by executing the <i>ps</i> command or ‚Äúexamining‚Äù the <i>/ proc</i> directory.  Starting with Android 7, using the <i>Linux</i> kernel‚Äôs <i>hidepid</i> function does not allow applications without elevated privileges to get information about other processes. <br><br>  <i>Security Tips:</i> Using Android OS version 7 and above. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1426">System Information Discovery Overview</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description: An</i> attacker may attempt to obtain detailed information about the operating system and hardware, including the version, installed fixes, and architecture.  On Android, most of the system information is available through the <i>android.os.Build</i> class.  On iOS, there are also methods by which applications can access system information. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1422">Network Configuration Configuration Discovery Overview</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> In Android, configuration details of embedded network interfaces are available to applications through the <i>java.net.NetworkInteface</i> class.  The <i>TelephonyManager</i> class can be used to collect information such as IMSI, IMEI and phone number. <br><br>  <i>Security Tips</i> <i>:</i> Preliminary analysis of the application should include checking <i>whether the</i> application requests permissions <i>ACCESS_NETWORK_STATE</i> (required for accessing <i>NetworkInterface</i> information) or <i>READ_PHONE_STATE</i> (required for accessing <i>TelephonyManager</i> information).  Starting with Android 6.0, applications cannot access the MAC addresses of network interfaces. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1421">Network Connections Overview (System Network Connections Discovery)</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> Applications can use standard APIs to collect data about outgoing and incoming network connections.  For example, the NetworkConnections application available on PlayMarket provides this functionality. <br><br><h2>  <a href="https://attack.mitre.org/tactics/TA0033/">Lateral movement (Lateral Movement)</a> </h2><br><h3>  <a href="https://attack.mitre.org/techniques/T1427">PC attack via USB connection (Attack PC via USB Connection)</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> In order to carry out attacks on the PC connected to a mobile device, the enemy (with elevated privileges) can make changes to the OS, after which the mobile device will impersonate a USB device: a keyboard, mouse, storage device or network device.  This method has been demonstrated on Android.  About the possibility of implementing this technique on iOS is not known. <br><br>  <i>Security Tips:</i> Users are advised to connect mobile devices to PCs only when they are reasonably necessary (for example, if necessary for the development and debugging of mobile applications). <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1428">Exploiting Enterprise Resources (Exploit Enterprise Resources)</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description: An</i> adversary may attempt to use corporate servers, workstations, or other resources available on the network.  This method is used when a mobile device is connected to a corporate network via a local or VPN connection. </div><p>Source: <a href="https://habr.com/ru/post/457092/">https://habr.com/ru/post/457092/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../45708/index.html">Software self motivation</a></li>
<li><a href="../457082/index.html">Imperceptible issuance of administrator rights</a></li>
<li><a href="../457084/index.html">How to live with professional lighting. Videos from Badoo Techleads Meetup # 4</a></li>
<li><a href="../457086/index.html">Architectural template "Builder" in the universe "Swift" and "iOS" / "macOS"</a></li>
<li><a href="../457090/index.html">Security Cheat Sheets: JWT</a></li>
<li><a href="../457096/index.html">We free our hands to several analysts: API Livy to automate typical banking tasks</a></li>
<li><a href="../457098/index.html">Elegant JavaScript error handling with the Either monad</a></li>
<li><a href="../4571/index.html">"Soup" suffers from bad PR</a></li>
<li><a href="../457100/index.html">AWS Lambda - theory, familiarity</a></li>
<li><a href="../457102/index.html">QVD files - what's inside, part 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>