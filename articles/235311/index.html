<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>0day vulnerability in iOS apps: Gmail, Google+ and FB Messenger</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Intro 
 Normal people spend the night watching movies, reading articles, communicating on social networks or (yes, I know - this is strange) falling a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>0day vulnerability in iOS apps: Gmail, Google+ and FB Messenger</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/873/891/d0c/873891d0ca53aff7cbf0185b962cbdb0.jpg" alt="image"><br><br><h2>  Intro </h2><br>  Normal people spend the night watching movies, reading articles, communicating on social networks or (yes, I know - this is strange) falling asleep on the bed. <br>  I spend my nights reading documentation and testing a wide variety of applications and services. <br>  One night, I just read the <a href="http://tools.ietf.org/html/rfc3966">documentation about tel links</a> , since I was delighted with the old technologies that have been used so far, their shortcomings and the fact that people never read the RFC, which leads them to RTFM PWNAGE (as I used to call). <br><br><h2>  Need to try </h2><br>  As soon as I finished reading the tel documentation, I looked at my iPhone and said: Cool, you need to try!  I nakodil small HTML page and uploaded it to Safari, here is the code: <br><img src="https://habrastorage.org/getpro/habr/post_images/fb2/6eb/360/fb26eb3608251bed68b95ce486aae867.png" alt="image"><br>  As soon as I clicked on the link, a dialog box appeared asking me if I really wanted to call 0000. <br><a name="habracut"></a><br><h2>  Apple </h2><br>  At this stage there was only my interest in tel links, I was not looking for vulnerability.  But it hit me: Apple loves to change things very much and make things better, so maybe Apple has its own TEL documentation?  And I <a href="https://developer.apple.com/library/ios/featuredarticles/iPhoneURLScheme_Reference/PhoneLinks/PhoneLinks.html">was right</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  The string I fell in love with </h2><br>  Apple's documentation on the tel link is very short and easy to read.  Reading the first paragraph, something caught my attention: <br><br><blockquote>  When a user clicks on the tel link on the page, iOS shows an alert that asks if the user really wants to dial a phone number and initializes the dial if the user presses on ‚ÄúI agree.‚Äù  When a user opens a URL with a tel link through the installed application, iOS does not show an alert and initializes the call without further confirmation by the user. </blockquote><br><div class="spoiler">  <b class="spoiler_title">Original</b> <div class="spoiler_text"><blockquote>  When I‚Äôm Using Your Phone Number, I‚Äôm Getting Your Phone Number.  When the user opens the URL with the app, the iOS app doesn‚Äôt need it. </blockquote><br></div></div><br><br>  Therefore, if I click on the link in Safari, I will get a window asking me if I really want to call, but if I click on the link in the webView of the installed application, the call will start without my confirmation. <br><br><h2>  Do people read documentation? </h2><br>  Not.  This is sad <br><br>  After reading, I was tormented by doubts about such ‚Äúbig players‚Äù as Facebook, Twitter, Google, LinkedIn, and so on.  I thought that such "giants" could take care of such a small "hole", but as it turned out, I was wrong. <br><br><h2>  We test on the Facebook Messenger application </h2><br>  I sent the link to the page through Facebook Messenger, clicked on it to get through the webView to the page created earlier (social applications do not want you to leave the application and that is why such applications use webView), and then clicked the ‚Äúclick me‚Äù link: <br><br>  Clicking the link initiates a call.  Wait a minute ... this is not very good. <br><br><h2>  We make the link self-clicking </h2><br>  Many people think that things like links can only be clicked by the user.  However yes not so!  Using a cunning, but terribly javascript script, I made the link ‚Äúself-clickable‚Äù. <br><img src="https://habrastorage.org/getpro/habr/post_images/da6/215/391/da62153919eaae10e1cf62df975fbd35.png" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">See what happens</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/bc8/bbf/54f/bc8bbf54f234e6b4ebf5f288f5bbf0b6.gif" alt="image"></div></div><br><br>  Note: you can also do a redirect on the server side, throwing the user by tel link using the header ("Location: tel: // 0000") <br><br><h2>  Is this a security issue? </h2><br>  I can force you to dial any phone number with a single click on the link in any application that does not adjust the processing of tel links.  So yes, this is a security issue. <br><br>  Just imagine - I registered a paid phone number and sent you a link to Facebook Messenger or Twitter.  You clicked and called me, I picked up the phone to withdraw some money from your account. <br><br><h2>  It is not right!  Who is to blame? </h2><br>  Well ... Apple is not to blame.  People don't read the documentation at all.  The first paragraph of the tel link describes everything to the smallest detail - what happens when and how, and also clearly states that however installed applications can be configured to show their own alerts. <br><br><h2>  Who is not RTFM? </h2><br><div class="spoiler">  <b class="spoiler_title">Facebook messenger</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/bc8/bbf/54f/bc8bbf54f234e6b4ebf5f288f5bbf0b6.gif" alt="image"></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Gmail</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/e82/b9e/978/e82b9e97828c73e2ad4b9f99370ea987.gif" alt="image"></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Google+</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/76b/eeb/f0b/76beebf0b72382c2f04b662217f7ceb2.gif" alt="image"></div></div><br><br>  And now for everyone ... <br><br><h2>  be careful </h2><br>  While I tested this vulnerability on only a few applications of large companies, it can also be assumed that companies and smaller platforms did not even think about patching this vulnerability. <br><br>  Author's note: By the way, everything is done the same way with iFrame. </div><p>Source: <a href="https://habr.com/ru/post/235311/">https://habr.com/ru/post/235311/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235301/index.html">DIY Spy Plush</a></li>
<li><a href="../235303/index.html">Tweatfor: we are all slightly weather forecasters</a></li>
<li><a href="../235305/index.html">Radio-controlled paper airplane PowerUP 3.0: reviews of the first pilots</a></li>
<li><a href="../235307/index.html">Selection of UX reports at 404fest</a></li>
<li><a href="../235309/index.html">How to launch Landing Page in 4 minutes?</a></li>
<li><a href="../235313/index.html">Older browsers - old version of google</a></li>
<li><a href="../235315/index.html">Testing flash storage. File System Impact</a></li>
<li><a href="../235319/index.html">Sale of electronic books for 99 rubles</a></li>
<li><a href="../235323/index.html">How to make a dance platform for the Dance Dance Revolution</a></li>
<li><a href="../235325/index.html">Leap Motion released gesture recognition system for Oculus Rift</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>