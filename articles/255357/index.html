<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DataSync API from Yandex.Disk: a cloud for applications and structured data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For data synchronization in applications, the usual ‚Äúfile‚Äù cloud storage is not suitable. Too many problems with data consistency have to be addressed...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DataSync API from Yandex.Disk: a cloud for applications and structured data</h1><div class="post__text post__text-html js-mediator-article">  For data synchronization in applications, the usual ‚Äúfile‚Äù cloud storage is not suitable.  Too many problems with data consistency have to be addressed by the authors of the applications themselves.  Therefore, today we are opening to everyone the <a href="https://tech.yandex.ru/datasync/">DataSync API</a> technology that the Yandex.Disk team has developed for its own Yandex services.  It allows you to synchronize structured data between cloud storage and devices.  The API uses Yandex login, which almost every Internet user has in Russia and many in other countries.  DataSync is multi-platform and not tied only to Android or iOS. <br><br> <a href="http://habrahabr.ru/company/yandex/blog/255357/"><img src="https://habrastorage.org/files/04a/a2d/68f/04aa2d68ffe84076a37908da495e9a6b.jpg"></a> <br><br>  We are really very happy, because three years ago, when Yandex.Disk was launched, we wanted to synchronize not only files between computers, but in general any data between all human devices.  Our digital life is not only files, but also points on maps, routes, bookmarks in the browser, a list of records in a computer game, and much more. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For more than two years, Yandex. The browser has been working on the synchronization technology of J.Diska.  In the near future, other large Yandex services will begin to integrate their platforms on DataSync.  Under the cut - more details about how it works, why it is needed, and examples where you can see and try how everything works. <br><a name="habracut"></a><br>  Once the basic infrastructure element of the Internet has become a web server, without which it is now impossible to imagine the existence of a worldwide network.  Now times have changed, and we are confident that the cloud self-synchronizing database will be an equally important element of the modern multiplatform Internet. <br><br>  Previously, the user had only one device and only one way to interact with the Internet service - go to the site.  And for the developer, everything was easy.  Base-Code-Web interface.  Somewhere in the depths of the site, the database worked, where the developer saved the data he needed, and from where he took them, displaying on a single device the user, or rather, in the browser of his computer. <br><br>  However, times have changed a lot, and now a person can have many devices, and one service can be represented by a whole set of applications.  This greatly complicated the life of the developer.  He has more everything: interfaces, databases, logic, and even programming languages.  But the worst thing is the data.  On some devices there are local copies of data that live on the server and other devices, and they all need to be synchronized with each other.  This is not an easy task at all: there may be conflicts, data loss, loss of communication, normal operation speed is required on all devices - and much more. <br><br>  Obviously, if the developer himself decides from scratch the tasks of synchronizing applications and cloud storage, he will most likely forget what he was actually going to do initially or will not get to that at all soon. <br><br>  Of course, the task to solve the described problem appeared in Yandex.  We started working on creating a ‚Äúcloud database‚Äù, which will free development from the routine synchronization task and allow us to focus on creating applications. <br><br>  A regular database lives boring on one computer, and we made a database that lives simultaneously in the cloud and on all user devices.  This, of course, as a ready-made solution, fundamentally simplifies the task of developing multiplatform applications.  No matter where the data is stored in such a database - on the phone, in the browser, on the server - nothing is lost and actual data will appear everywhere. <br><br>  The internal documentation for the project is written as follows: ‚ÄúThe DataSync API is a repository of arbitrary structured data associated with a user or a pair of user + application.  It is designed for synchronization between user devices and normal operation in the conditions of a poor mobile network. ‚Äù <br><br>  For an external developer, our database is very similar to the popular <a href="http://www.mongodb.com/nosql-explained">noSQL MongoDB database</a> - the essence is the same.  It consists of collections, collections - from objects.  An object is a collection of key-value fields.  But we set ourselves the task of making sure that the developer did not think about how to connect data on different devices and in the cloud, but simply worked with our API, while all the data synchronization occurred in a magical way.  Of course, such ‚Äúmagic‚Äù is possible when you use both the cloud and the client part of our ‚Äúsynchronizing‚Äù SDK. <br><img src="https://habrastorage.org/files/5b4/700/177/5b47001771084c428c3513f4e803ad17.png"><br>  And here I want to tell you a little more about what problems and how we solved it to happen. <br><br><h3>  Conflicts </h3><br>  In the proposed device of the world, we have many copies of the base, and they all change locally.  In such a situation, conflicts are inevitable when data changes simultaneously in different places.  And I don't want to lose data at all.  The algorithm for solving this problem is quite traditional: <br><br><ul><li>  all data instances have a version that every device and server knows about; </li><li>  when sending changes, it is sent and checked on the server; </li><li>  in case of a version mismatch, the client receives a list of changes that he did not know about and can correctly resolve the conflict. </li></ul><br><h3>  Transparent work without network </h3><br>  The mobile application (and many others) cannot count on a stable connection, and the service data may change at any time.  This should not be a problem for someone who uses our cloud base.  Obviously, this is also very important to consider in our SDK.  We solved this problem with this scheme of actions: <br><br><ul><li>  all communication with the server takes our SDK; </li><li>  communication with the server is completely asynchronous and occurs in the background; </li><li>  the methods that the SDK presents to developers never wait for the end of reading / writing from the network. </li></ul><br>  The DataSync API documentation describes all the methods that our own SDKs use.  You do not need to make your own library protected from conflicts and disconnections for any platform. <br><br>  We first made it so that each ‚Äúapplication‚Äù synchronizes with the same on other platforms and on the server.  But then there were examples when it was important to synchronize data between different applications on the same device - roughly speaking, to have a common database.  And then we implemented and such.  Now, for example, if you have a lite-application and a full-fledged one, then you can easily forward the data of the user who decided to upgrade from one to another.  Or send or receive data from the partner application. <br><br><h3>  How the API works </h3><br>  In the process of working with the API, the client mainly operates with such concepts as: <br><ul><li>  database (DB), </li><li>  delta updates, </li><li>  snapshot </li><li>  conflict. </li></ul><br>  The DB is the synchronization unit for the API.  It contains objects (records), combined in a collection.  But all operations are essentially done with separate objects.  Moreover, in order to uniquely identify an object, you must specify its identifier and collections. <br><br>  The database state identifier is the revision number.  The API implements a revision control scheme that allows you to track and fix conflict situations.  When creating a database, the revision is zero, upon further receipt of any changes for this database, the revision number will increase by one.  Any changes are made by sending a delta update.  With it, you can create, delete and edit notes. <br><br>  A conflict is considered a situation in which the client sends to the server a revision younger than that existing on it.  In this case, the server looks at the number of the incoming revision and sends a set of changes to the existing version. <br><br><img src="https://habrastorage.org/files/5f9/0c0/04b/5f90c004b12a4784ad19e239aaa36244.jpg"><br><br>  In the case when the audit on the client is so outdated that the server cannot provide a list of necessary changes, the client needs to receive a snapshot of the database and update to the current revision on its own.  The conflict resolution scheme is left to the discretion of the developers. <br><br>  Snapshot base reflects the status of the current database revision on the server.  It must be requested when creating a local database on a device or when resolving conflict situations. <br><br>  In order to share data only within its own application, it is necessary to request access rights to store application data, for sharing data - access to shared user data. <br><br><h3>  Conclusion </h3><br>  You can start using the <a href="http/doc/overview/concepts/about-docpage/">HTTP API</a> and <a href="https://tech.yandex.ru/datasync/jsapi/doc/overview/concepts/about-docpage/">JS SDK</a> now.  In the near future we will release an SDK for Android and iOS. <br><br>  You can see how everything works by the example of an address book in a <a href="https://yandex.github.io/datasync-js/example/contactList.html">test browser application</a> .  It demonstrates how a user's phone numbers can be synchronized in steps of 20 seconds.  Data is synchronized with the cloud and any instance of the web application.  The easiest way to see this is to open two tabs in the browser. </div><p>Source: <a href="https://habr.com/ru/post/255357/">https://habr.com/ru/post/255357/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255343/index.html">How we fought xss / sql attack with Nginx and Naxsi</a></li>
<li><a href="../255345/index.html">About: about page in Firefox</a></li>
<li><a href="../255349/index.html">Chronicles of the laboratory: a rat in a polymer helmet, spectral analysis of a can of chips and blue electrical tape</a></li>
<li><a href="../255351/index.html">One-page client-server MVC JavaScript application on technologies of 1996 for Windows</a></li>
<li><a href="../255355/index.html">How we implemented the machine interface for issuing loans</a></li>
<li><a href="../255359/index.html">Multifunctional temperature / humidity sensor on the ESP8266 or one more step to the ‚ÄúInternet of things‚Äù</a></li>
<li><a href="../255361/index.html">SQL Language Tutorial (DDL, DML) on the example of MS SQL Server dialect. Part one</a></li>
<li><a href="../255363/index.html">SDN: alternative or addition to traditional networks?</a></li>
<li><a href="../255365/index.html">10 commandments of programming without ego</a></li>
<li><a href="../255371/index.html">Electronics for 3D scanner</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>