<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic update of LetsEncrypt certificates in MDaemon mail server: step-by-step instructions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 Some time ago a good friend of mine approached me with a problem that suddenly appeared to him and asked for help in solving it. The problem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic update of LetsEncrypt certificates in MDaemon mail server: step-by-step instructions</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/oi/ed/iz/oiedizm0-3iaktqfjcjeotno_qu.jpeg" align="left"><br>  Hello! <br><br>  Some time ago a good friend of mine approached me with a problem that suddenly appeared to him and asked for help in solving it.  The problem was as follows: the organization in which he worked had a Windows server with MDaemon's mailer from Alt-N Technologies.  A couple of years ago, the StartSSL SSL certificate from StartCom was installed on this mailer.  And everything worked quite well for himself, the porridge did not ask, when suddenly a sad letter came from StartCom informing that soon all their certificates would come full and unconditional kirdyk.  Like, save yourself - who can, until it was bombed.  Today I will tell you how we were saved - you see, someone will find this information useful. <br><a name="habracut"></a><br><h2>  Some lyrics </h2><br>  What is the first thing that comes to mind when a person is asked a question about replacing a certificate?  There are two options: or - why don't you buy it?  Or - so there is a great team of Let's Encrypt, which distributes certificates to the right and left for free!  The first option was embarrassedly rejected as untenable, due to the fact that, as was said earlier, the server was working, I did not ask for porridge, and there was no desire to explain to the management why it should part with the unlimited amount of evergreen money.  The second option was just super-attractive, but some problems that were to be overlooked loomed on the horizon: the window-mailer window led to sad reflections on its compatibility with LetsEncrypt scripts, and did not want to receive and install the certificate every three months. <br><br>  Therefore, the second option was chosen - it was only necessary to find a way to automate the process of obtaining a certificate and linking it to the mailer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We began, naturally, with digging up the great and terrible Internet in search of a ready-made solution.  And, lo and behold!  It turned out that the valiant programmers from Alt-N Technologies have already bothered with this and have given out to the surface scripts that do everything they need!  As they say - hats off!  But even here it was not without a fly in the ointment: these scripts were not distributed to anyone and everyone, but were included in the latest versions of MDaemon.  However, our ward server had a rather old version of MDaemon - 13.6.3.  The software was completely legal, once bought for the most real money, it worked remarkably and its upgrade was of course not included in the management plans (see the clause about purchasing a certificate). <br><br>  Therefore, it was decided to try to surgically transplant the scripts from the new version of MDaemon into the old one and make them work there.  Thought and done: the latest MDaemon trial version at that time was installed on the virtual machine and the LetsEncrypt folder with all its contents was removed from it.  What now to do with this good?  - read below. <br><br><h2>  Initial data </h2><br><ul><li>  Server running Windows Server 2008 R2. </li><li>  MDaemon mail server version 13.6.3. </li><li>  On the same server raised IIS, serving the corporate website of the organization. </li><li>  MDaemon used WorldClient's own built-in WEB-server, which was accessible from the Internet through port 3000. </li></ul><br><h2>  Mandatory Requirements </h2><br>  As it was written in <a href="http://help.altn.com/mdaemon/ru/ssl_creating_and_using_ssl_certifi.htm">this article</a> , LetsEncrypt scripts for MDaemon are not completely universal and assume the following mandatory conditions: <br><br><ul><li>  Availability of PowerShell version 3.0. </li><li>  Presence of the installed framework Microsoft .NET version not lower than 4.0. </li><li>  Presence of the installed IIS Management Scripts and Tools package. </li><li>  From the Internet via port 80, the WorldClient server should be accessible either directly or via IIS. </li></ul><br>  As you can see, some of these requirements were not initially fulfilled, so the WorldClient was first linked to IIS in order to transfer it to port 80. Information on how to do this was obtained from <a href="http://www.altn.com/Support/KnowledgeBase/KnowledgeBaseResults/%3FNumber%3DKBA-02127">this article</a> from the Alt-N website. <br><br><h2>  A couple of words about the "rake" </h2><br>  Before proceeding with the description of the step-by-step instructions, I want to hold your attention on some unforeseen problems that have complicated the process of transplanting scripts and obtaining certificates. <br><br>  First, almost at the very beginning of the script, a check was implemented that the 'EnableWCServer' parameter in the 'Mdaemon.ini' file is set to 'Yes'.  And if this was not the case, the script immediately terminated its work with a critical error message 'Error: WorldClient must be enabled'.  But, oddly enough, in our case, this parameter was set to 'No' - despite the fact that we had already done the binding of WorldClient to IIS and WorldClient was perfectly open from the Internet.  Without thinking, we turned off this check by commenting it in the script.  This allowed the script to continue working. <br><br>  Secondly, the corporate site was raised on the same server and access to some pages of this site was carried out via the https protocol using a self-signed certificate.  And old Windows servers assume that only one certificate can be bound to a single IP.  We stepped on this rake at the very end of the path - when the certificate from LE was already successfully obtained, but could not reach the address 0.0.0.0.  As a result, the problem was solved quickly, but in a somewhat crooked way: WorldClient was sent to a separate IP address (since it was available), and again the script had to be edited - the IP address to which it was attached was added to the list of input parameters certificate.  And since the WorldClient linking to IIS was already fully completed, we did not launch MDaemon's own WEB server and left everything as is. <br><br>  Go. <br><br><h2>  Part 1: Preliminary Training </h2><br><ol><li>  In any way known to you we make server backup! </li><li>  Install the .NET version above or equal to 4.0. </li><li> Add Role Services: go to 'Control Panel' -&gt; 'Administrative Tools' -&gt; 'Server Manager' -&gt; 'Roles' and click on the link 'Add Role Services'. <br><br><div class="spoiler">  <b class="spoiler_title">We put kryzhiki on:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gs/rb/mc/gsrbmcuqebyuxwlfle3dzrpe-nk.png"></div></div><ul><li>  Web Server / Application Development / ISAPI Extensions </li><li>  Web Server / Application Development / ISAPI Filters </li><li>  Management Tools / IIS Management Scripts and Tools </li></ul><br>  Click 'Next', and so on. </li><li>  Installing Windows Management Framework 3.0 - this will install PowerShell version 3.0 (see the 'Requirements' section): <br><ul><li>  Download WMF 3.0 <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D34595">from Microsoft.</a> </li><li>  Install the necessary WMF.  For Windows Server 2008 R2, this is 'Windows6.1-KB2506143-x64.msu'. </li><li>  Reboot the server. </li></ul></li></ol><br><br><h2>  Part 2: Creating a site in IIS to access the WorldClient server </h2><br>  <b>Note 1:</b> if you use WorldClient's server built into MDaemon and it is already exclusively on port 80, you can safely skip this part and go directly to part 3. <br><br>  <b>Note 2: The</b> site‚Äôs host name should be the same as the fully qualified domain name of the MDaemon host for which it is accessible from the Internet. <br><br><div class="spoiler">  <b class="spoiler_title">To find out MDaemon's full domain name: run the Mdaemon GUI, go to the menu: 'Settings' -&gt; 'Primary domain / servers' -&gt; 'Domain and servers by default' -&gt; 'Domain' and look at the field 'Fully Qualified Domain Name' .</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ge/uy/ma/geuymabtt9hg9bikqdo_5vhusp8.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">So let's get started.</b>  <b class="spoiler_title">We launch the IIS-manager and add a new site in it:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ez/qe/ii/ezqeiifyndipueauqh5ojfvpttq.png"></div></div><br><ol><li>  In the field 'Site name' we enter the name of the site - what you like </li><li>  In the 'Physical path' field, enter the path to the HTML folder of the World client. </li><li>  In the 'Host name' field, enter the fully qualified domain name of the host (see note 2 above). </li><li>  In the 'IP-address' field, leave the 'All unassigned' if the interface is used exclusively, or from the list select IP that belongs to the mailer. </li><li>  The 'Type' and 'Port' fields are left as is - 'http' and '80', respectively. </li></ol><br><div class="spoiler">  <b class="spoiler_title">We edit the list of the site default documents - go to the 'Default Document' subsection:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gr/pv/bn/grpvbnf0fesmcgeb1soefdl4svq.png"><br></div></div><br><ol><li>  Clear the entire list. </li><li>  Add the document 'WorldClient.dll': in the right pane of the 'Actions' click 'Add ...' and in the 'Name' field type 'WorldClient.dll'. </li><li>  Add the document 'MDSyncML.dll': in the right pane of the 'Actions' click 'Add ...' and in the 'Name' field type 'MDSyncML.dll'. </li><li>  Put 'WorldClient.dll' first on the list: select it and click 'Move Up' in the right 'Actions' panel. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Go to the 'Handler Mappings' section:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/om/zp/1y/omzp1ymnvt8kopmsd4nm4mzktjs.png"><br></div></div><br><ol><li><div class="spoiler">  <b class="spoiler_title">Edit the 'Feature Permissions': in the right pane of the 'Actions' click on 'Edit Feature Permissions ...' and put all the little caps - 'Read', 'Script' and 'Execute'.</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/i2/mn/xc/i2mnxcpd1ve3i365apusfsxeh38.png"></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Find the list 'ISAPI-dll' and go to it.</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hh/ah/ky/hhahkysjsbxpgrnabla0bv8koky.png"><br></div></div></li><li>  In the field 'Request path' we write 'WorldClient.dll'. </li><li>  In the 'Module' list, select 'IsapiModule'. </li><li>  In the 'Executable (optional)' field, specify the path to WorldClient.dll. </li><li><div class="spoiler">  <b class="spoiler_title">Add a new handler: in the right 'Actions' panel click 'Add Module Mapping ...'</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/lz/ni/2i/lzni2icbrozwzfx9cqvulwunu6m.png"><br></div></div></li><li>  In the field 'Request path' we write 'MDSyncML.dll'. </li><li>  In the 'Module' list, select 'IsapiModule'. </li><li>  In the 'Executable (optional)' field, specify the path to MDSyncML.dll. </li><li>  In the field 'Name' we write something articulate.  For example, 'SyncML-ISAPI'. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Edit 'MIME Types' - if this is not done, then the LetsEncrypt robot will not be able to get a file from us without an extension:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/fy/jl/at/fyjlatgnblwyi6cr3ufvl7qj2_u.png"><br></div></div><br><ol><li>  Go to the section 'MIME Types'. </li><li>  In the right-hand pane of Actions, click Add. </li><li>  In the field 'File name extension' we write a period. </li><li>  In the field 'MIME type' we write 'text / plain'. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Edit the 'Application Pool', automatically created when you create our site:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ea/yd/eo/eaydeoya5o7i-2tracz3ykhhj48.png"><br></div></div><br><ol><li>  Go to 'Application Pools' -&gt; 'MDaemon WorldClient' -&gt; 'Advanced Settings ...'. </li><li>  In the 'Process Model' section, change 'Identity' to 'Network Service'. </li><li>  If the OS is 64-bit, then in the 'General' section we change the 'Enable 32-Bit Applications' to 'True'. </li></ol><br>  Close the console.  IIS is configured. <br><br><div class="spoiler">  <b class="spoiler_title">Next, we give users 'IUSR' and 'NETWORK SERVICE' full access to the MDaemon folder:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dj/gn/1k/djgn1kd0xq72z4gazxrf06zdgcu.png"></div></div><br><ol><li>  Go to the explorer, open the 'Properties' of the 'MDaemon' folder, go to the 'Security' tab, click on 'Edit'. </li><li>  Click 'Add' -&gt; 'Advanced' -&gt; 'Find Now' - select the 'IUSR' user in the 'Search Results' list, click 'OK'. </li><li>  We put the 'Full control' cap in the 'Permissions for IUSR' list. </li><li>  Click 'Add' -&gt; 'Advanced' -&gt; 'Find Now' - select the 'NETWORK SERVICE' user in the 'Search Results' list, click 'OK'. </li><li>  We put the 'Full control' cap in the 'Permissions for NETWORK SERVICE' list. </li><li>  Close both windows by clicking on 'OK'. </li></ol><br>  WorldClient is configured.  We check that WorldClient opens normally by accessing it with a browser via the Internet using the full domain name of the host. <br><br><h2>  Part 3: Installing and Configuring LetsEncrypt Scripts </h2><br><ol><li>  Download the archive with the scripts <a href="">from here</a> and unpack it into the root of the 'MDaemon' folder.  Important note: in the script, the main LetsEncrypt server is replaced with a test one - to prevent a ban due to repeated attempts to obtain a certificate during the debugging process.  The next part will be written - how to switch to the main server. </li><li><div class="spoiler">  <b class="spoiler_title">Add the path to the modules used by the script into the 'PSModulePath' environment variable:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vh/am/jx/vhamjxsyhwzkxu0ikbt0hnb61-w.png"><br></div></div><br><ul><li>  Go to 'Control Panel' -&gt; 'System' -&gt; 'Advanced system settings' -&gt; 'Advanced' -&gt; 'Environment Variables'. </li><li>  We are looking for the 'PSModulePath' variable in the 'System Variables' list. </li><li>  We finish in ';'  at its end is the path to the 'Modules' folder inside the 'LetsEncrypt' folder.  In my case, this: 'c: \ MDaemon \ LetsEncrypt \ Modules \' </li><li>  We are logging. </li></ul></li><li>  Run the cmd console. </li><li>  Run the letsencrypt.ps1 script with the command: <br><br><pre><code class="hljs tex">powershell -ExecutionPolicy ByPass -File c:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mdaemon</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">letsencrypt</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">letsencrypt</span></span></span></span>.ps1</code> </pre>  Here the parameter 'File' sets the path to the script. <br><br>  You can use additional parameters: <br><ul><li>  -IISSiteName "MDaemon WorldClient" <br>  If WorldClient works through IIS, then this parameter needs to specify the script name WorldClient site (see part 2) </li><li>  -WCIPAddress xxx.xxx.xxx.xxx <br>  This parameter specifies the IP address to which the script should attach the received certificate.  It is not necessary to specify it if no other certificates are attached to port 443. </li><li>  -To "admin@server.com" <br>  This parameter sets the email to which the script log will be sent in case of any error. </li></ul><br><div class="spoiler">  <b class="spoiler_title">We look into the console window - the script should run without errors.</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ht/w-/y-/htw-y-mpe4osvj1rquzg7ltmxi4.png"></div></div><br>  If something goes wrong, you will have to deal with this problem yourself. <br><br>  If everything is successful, you can try to access the WorldClient browser using the https protocol: since we used the LetsEncrypt test server, the browser should swear to the site certificate with the message 'SEC_ERROR_UNKNOWN_ISSUER'. <br><br>  By the way, remember - I talked about the "rake" with the 'EnableWCServer' parameter in the 'Mdaemon.ini' file - what is when using the bundle with IIS it is set to 'No'?  So, after successful script development, this parameter changed to 'Yes'.  However, this happened somewhat late in the day, so we didn‚Äôt begin commenting this parameter in the script. <br></li></ol><br><h2>  Part 4: translation of the script in the "battle mode" </h2><br><ol><li>  Open the letsencrypt.ps1 script in the LetsEncrypt folder in a text editor. </li><li>  Find lines in it: <br><br><pre> <code class="hljs 1c"><span class="hljs-meta"><span class="hljs-meta">#Initialize-ACMEVault -ErrorVariable LogText Initialize-ACMEVault -BaseURI https:</span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//acme-staging.api.letsencrypt.org/ -ErrorVariable LogText</span></span></span></span></code> </pre></li><li>  The first line is uncommented, and the second is commented out: <br><br><pre> <code class="hljs 1c">Initialize-ACMEVault -ErrorVariable LogText <span class="hljs-meta"><span class="hljs-meta">#Initialize-ACMEVault -BaseURI https:</span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//acme-staging.api.letsencrypt.org/ -ErrorVariable LogText</span></span></span></span></code> </pre></li><li>  Save the script. </li></ol><br><h2>  Part 5: Removal of all traces of "test" activity </h2><br>  If this is not done, the script will continue to issue us a ‚Äúfake‚Äù certificate for a couple of months, despite the fact that we have made the necessary changes to the script. <br><br><ol><li><div class="spoiler">  <b class="spoiler_title">Remove the test certificate from MDaemon:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/at/6o/qa/at6oqakimr_82_nar6dc1chqqfe.png"></div></div><ul><li>  Launch GUI MDaemon and go to the menu 'Security' -&gt; 'Security Settings' -&gt; 'SSL &amp; TLS'. </li><li>  In the list of certificates, select our test certificate (it will have 'Fake LE Intermediate X1' in its 'Sender' field) and click the 'Delete' button below the list. </li><li>  If the list of certificates is empty, you will have to create a self-signed certificate, otherwise MDaemon will swear when you try to close the window. </li></ul></li><li>  Delete the keystore created by the script: if you worked under the admin account, then go to 'c: \ ProgramData \', and if you‚Äôve worked under the user account - go to 'C: \ Users \ username \ AppData \ Local \' and delete the folder 'ACMESharp' from there along with all the content. </li><li>  Delete the XML file created by the script: go to the 'MDaemon \ LetsEncrypt' folder and delete the LetsEncrypt.XML file from there. </li><li>  Remove the test certificate: go to the 'MDaemon \ Pem' folder, find the certificate (file with the extension 'pfx') and delete it. </li></ol><br><h2>  Part 6: Configuring Script Launch </h2><br><ol><li>  Go to 'Control Panel' -&gt; 'Administrative Tools' -&gt; 'Computer Management' -&gt; 'System Tools' -&gt; 'Task Scheduler' -&gt; 'Task Scheduler Library'. </li><li>  Create a new task: click on 'Create Task ...' in the right 'Actions' panel. </li><li><div class="spoiler">  <b class="spoiler_title">On the 'General' tab:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jl/qo/uw/jlqouwujqkydillqar7bfgzawsy.png"></div></div><ul><li>  In the 'Name' field we write the name of the task - arbitrarily as you wish. </li><li>  In the subsection 'Security Options' select the item 'Run whether user is logged on or not'. </li></ul></li><li><div class="spoiler">  <b class="spoiler_title">On the 'Triggers' tab:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/se/8m/ui/se8mui7uwe89zslvrxb-mossnei.png"></div></div><ul><li>  Press the 'New ...' button - the 'New Trigger' window will open. </li><li>  In the 'Begin the task' list, select 'On a schedule'. </li><li>  Set the appropriate startup frequency: for example, once a week on Sundays.  The script at each start will check - how much certificate is left to live: and if less than a month, then update it. </li></ul></li><li><div class="spoiler">  <b class="spoiler_title">On the 'Actions' tab:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/d9/0d/zz/d90dzzyggkhkzmlzehniyhdi-sw.png"></div></div><ul><li>  Press the 'New' button - the 'New Action' window will open. </li><li>  In the list of 'Action' select 'Start a program'. </li><li>  In the field 'Program / script' we write 'powershell'. </li><li>  In the 'Add arguments (optional)' field, we write '-ExecutionPolicy ByPass -File c: \ MDaemon \ LetsEncrypt \ letsencrypt.ps1'.  In the tail of the line we add the required additional parameters (see part 3). </li></ul></li><li>  On the 'Conditions' tab, we put the little wings at our discretion. </li><li><div class="spoiler">  <b class="spoiler_title">On the 'Settings' tab we put the little wings:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/sz/w0/5a/szw05aheh7i5s8zukdtxegwzhoo.png"></div></div><ul><li>  Allow task to be run on demand </li><li>  Stop the task if it runs longer than 1 hour </li><li>  If it is a running task </li></ul></li><li>  Click the 'OK' button.  Enter the password of the current user. </li></ol><br><h2>  Part 7: the first "combat" launch </h2><br>  Run the script manually: <br><br><ol><li>  Select the newly created task in the list. </li><li>  Click 'Run' in the right pane of the Actions'.  No window will open. </li><li>  From time to time to refresh the task list - to see the changes in the 'Status' field: the 'Status' should change to 'Run'.  Refresh the list until 'Status' becomes 'Ready' again. </li><li>  See the result of the script in the log file 'MDaemon \ Logs \ LetsEncrypt.log'. </li></ol><br>  If, judging by the log file, everything went well, then it‚Äôs done - the certificate has been received and you can check the performance of receiving / sending mail via a secure channel.  And yes, do not forget to enter the browser via the https protocol - to make sure that WorldClient also works without problems. <br><br><h2>  Part last - final </h2><br>  In conclusion, I want to say that at the time of writing this article I did not have access to the combat server, so all the screenshots were taken from a virtual machine, on which an even older version of MDaemon was installed - 13.0.4 - which is why the windows can look differ from other versions. <br><br>  Well that's all.  All he knew - told.  Congratulations to all the upcoming New Year!  I wish you health and good luck! </div><p>Source: <a href="https://habr.com/ru/post/345298/">https://habr.com/ru/post/345298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345284/index.html">Selection of resources for a job seeker programmer</a></li>
<li><a href="../345286/index.html">Severe Siberian and Kazakh microelectronics 2017: Verilog, ASIC and FPGA in Tomsk, Novosibirsk and Astana</a></li>
<li><a href="../345290/index.html">HDD performance doubled: Multi Actuator technology</a></li>
<li><a href="../345294/index.html">From tanks to nuclear power plants: looking back at Heisenbug 2017 Moscow</a></li>
<li><a href="../345296/index.html">Ratings of car brands: an example of analyzing variables with multiple response</a></li>
<li><a href="../345300/index.html">Free Software Developer Self-Financing Guide</a></li>
<li><a href="../345302/index.html">Distributed Team Anatomy - Requirements Preparation Process</a></li>
<li><a href="../345304/index.html">‚ÄúVery handles‚Äù: make Tableau / Qlik from R and ‚Äúblue tape‚Äù</a></li>
<li><a href="../345306/index.html">Working with the in-memory database using Intel Optane</a></li>
<li><a href="../345310/index.html">Predict outflow using neural network</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>