<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Alarm clock for computer in C #</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Surely, many of us wanted us to wake up our beloved computer in the morning and ‚Äúsing‚Äù our favorite songs (at least I wanted it so), the poet decided ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Alarm clock for computer in C #</h1><div class="post__text post__text-html js-mediator-article">  Surely, many of us wanted us to wake up our beloved computer in the morning and ‚Äúsing‚Äù our favorite songs (at least I wanted it so), the poet decided to write such an application as soon as he began to study programming. <br><br>  How was it supposed to be?  I launch my application - an alarm clock, set it up at how many hours it should wake me up and which program should I run (TV, music ...) and put my PC into sleep mode, after the time the program had to give the OS some kind of ‚ÄúWake up‚Äù signal. it's time to wake the host! ‚Äùand launch the application I need. <br><br>  To do this, I shoveled the Internet, read a lot of articles about computer hibernation, what Windows is doing at this point, etc.  asked questions in different forums and all they could say to me was ‚ÄúThe alarm clock is on the phone, why do you need this hemorrhoids‚Äù or what is that kind of thing, though they wrote on Microsoft that what can be done, but it will be pretty difficult, in short, they advised me to use the technology <a href="http://ru.wikipedia.org/wiki/Wake-on-LAN">WOL</a> there as it is all done through the network, with one computer must be constantly turned on to give a signal to another computer and he must wake up!  But it seemed to me that this is somehow inconvenient.  But nothing, I did not despair and went in the direction of WinAPI, and now the moment is true ... "Hurray, Found!". <br><a name="habracut"></a><br>  I only needed three WinAPI functions and MSDN help to work. <br>  So let's get started! <br>  1. Create a console application; <br>  2. Connect the namespace to work with the API; <br>  3. Write the necessary functions; <br>  4. Create one method. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To work with WinAPI, we connect the <a href="http://msdn.microsoft.com/ru-ru/library/system.runtime.interopservices.aspx">System.Runtime.InteropServices</a> and write our API functions <br><br><pre><code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">DllImport(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"kernel32.dll"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> IntPtr </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateWaitableTimer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IntPtr lpTimerAttributes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bManualReset, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lpTimerName</span></span></span><span class="hljs-function">)</span></span>; [DllImport(<span class="hljs-string"><span class="hljs-string">"kernel32.dll"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetWaitableTimer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IntPtr hTimer, [In] </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pDueTime, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lPeriod, IntPtr pfnCompletionRoutine, IntPtr lpArgToCompletionRoutine, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fResume</span></span></span><span class="hljs-function">)</span></span>; [DllImport(<span class="hljs-string"><span class="hljs-string">"kernel32"</span></span>, SetLastError = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, ExactSpelling = <span class="hljs-literal"><span class="hljs-literal">true</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> Int32 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WaitForSingleObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IntPtr handle, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> milliseconds</span></span></span><span class="hljs-function">)</span></span>;</code> </pre> <br><br>  Next, create a method that will count time to wake up: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IntPtr handle; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetWaitForWakeUpTime</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> duetime = <span class="hljs-number"><span class="hljs-number">-900000000</span></span>; Console.WriteLine(<span class="hljs-string"><span class="hljs-string">",   !    !); handle = CreateWaitableTimer(IntPtr.Zero, true, "</span></span>MyWaitabletimer<span class="hljs-string"><span class="hljs-string">"); SetWaitableTimer(handle, ref duetime, 0, IntPtr.Zero, IntPtr.Zero, true); uint INFINITE = 0xFFFFFFFF; int ret = WaitForSingleObject(handle, INFINITE); System.Diagnostics.Process.Start("</span></span>C:\Program Files\AIMP3\AIMP3.exe<span class="hljs-string"><span class="hljs-string">"); }</span></span></code> </pre><br><br>  I hope everything is clear in the code, the long variable stores time (that is, the number of intervals of 100 nanoseconds), then we created a timer that processes all of these and after the time expires, the player starts. <br><br>  Everything is so simple, but how much effort is put to find how to do it. <br><br>  As a result, we got a useful application that can wake us up in the morning (plus everything turned out to be a beautiful interface). <br><br>  It is certainly not very ergonomic, but everything is in your hands, you can transfer it to WinForms, add a few more useful features and you will have a full application. <br><br>  I hope you are interested in reading my post, thank you for your attention! <br><br>  PS If the application does not work for you but the compilation went without errors, then check whether the item ‚ÄúAllow wake-up timers‚Äù is enabled in your power settings. </div><p>Source: <a href="https://habr.com/ru/post/150028/">https://habr.com/ru/post/150028/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150021/index.html">Practical metametamodeling</a></li>
<li><a href="../150022/index.html">Downloading price lists of suppliers in the online store</a></li>
<li><a href="../150023/index.html">RedBeanPHP - CodeFirst PHP Framework</a></li>
<li><a href="../150025/index.html">Comparison of client-banks of different eras</a></li>
<li><a href="../150027/index.html">Practice refactoring in large projects</a></li>
<li><a href="../150030/index.html">CSS slider</a></li>
<li><a href="../150031/index.html">Cach√© + Java + Flex. Part 2</a></li>
<li><a href="../150032/index.html">ATLAS experiment - a simplified description of the task and a bit about the detector</a></li>
<li><a href="../150034/index.html">We implement RESTful Web Service on java</a></li>
<li><a href="../150037/index.html">FBI for the first time arrested websites with pirated applications for Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>