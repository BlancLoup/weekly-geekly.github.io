<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hosting provider paid a million dollars to ransomware hackers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On June 10, NAYANA, a South Korean hosting company, fell victim to the Erebus ransomware attack (detected by Trend Micro as RANSOM_ELFEREBUS.A). As a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hosting provider paid a million dollars to ransomware hackers</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/44c/d9d/219/44cd9d219dd4464592a6cee01bad2435.png"><br><br>  On June 10, NAYANA, a South Korean hosting company, fell victim to the Erebus ransomware attack (detected by Trend Micro as RANSOM_ELFEREBUS.A).  As a result, 153 Linux servers and more than 3,400 business sites hosted by the hosting provider were infected. <br><br>  In a message published on the NAYANA website on June 12, the company reported that the attackers demanded an unprecedented ransom of 550 Bitcoins (BTC) or $ 1.62 million for decrypting files on all infected servers.  Here are some of the negotiations with the extortionists: <br><blockquote>  <i>My boss told me to give you a good price, since you buy a lot of cars,</i> <i><br></i>  <i>550 BTC</i> <i><br></i>  <i>If you do not have enough money, you need to take a loan.</i> <i>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </i>  <i>You have 40 employees,</i> <i><br></i>  <i>The annual salary of each employee is 30,000 US dollars</i> <i><br></i>  <i>All employees 30 000 * 40 = $ 1 200 000</i> <i><br></i>  <i>All 550BTC servers = $ 1,620,000</i> <i><br><br></i>  <i>If you can not pay, you are bankrupt.</i> <i><br></i>  <i>You will have to look into the eyes of your children, wife, customers and employees.</i> <i><br></i>  <i>You will also lose your reputation and business.</i> <i><br></i>  <i>You will get a lot of lawsuits.</i> </blockquote><br>  Later on June 14, NAYANA announced an agreement on payment by installments in the amount of 397.6 BTC (about $ 1.01 million as of June 19, 2017).  On June 17, the company announced that the second of the three payments was made.  On June 18, NAYANA began restoring the server in batches.  There are currently database errors on some of the second batch servers.  The third payment will be paid after successful recovery of the first and second batch of servers. <a name="habracut"></a><br><br>  Although this is not comparable in terms of the ransom amount, the case resembles <a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/kansas-hospital-hit-by-ransomware-extorted-twice">what happened</a> to a hospital in Kansas, whose employees did not receive full access to the encrypted files after the payment.  Instead, the extortionist demanded redemption. <br><br>  Erebus was first seen in September 2016, when it was distributed <a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-recap-sept-23-2016">through malicious advertising</a> .  It reappeared in February 2017, already using a method that bypassed Windows account control.  Here are some of the technical details that are available on the Linux version of Erebus: <br><br><img src="https://habrastorage.org/web/770/0fc/2a7/7700fc2a754f47e89536463955f8562a.jpg"><br>  <i>Figure 1: Erebus has a multilingual redemption notice (English version above)</i> <br><br><img src="https://habrastorage.org/web/375/427/2b8/3754272b8ac24a378c0ab801c2115b37.jpg"><br>  <i>Figure 2: A demo video frame from intruders showing how to decrypt files</i> <br><br><h3>  Possible vector of virus attacks </h3><br>  Regarding how Linux systems get infected, we can only assume that Erebus may have used the Linux exploit.  For example, based on open source information, the researchers found that the NAYANA site runs on the Linux 2.6.24.2 kernel, which was compiled back in 2008.  Therefore, security threats such as <a href="https://habrahabr.ru/company/pentestit/blog/313276/">DIRTY COW</a> can provide root attackers with access to vulnerable Linux systems. <br><br>  In addition, the NAYANA website uses outdated versions of Apache 1.3.36 and PHP 5.1.4, both of which were released back in 2006.  The version of Apache used by NAYANA runs under the user nobody (uid = 99), which indicates that some previously known exploits could also be used in the attack. <br><br><img src="https://habrastorage.org/web/76b/56b/662/76b56b662bca4fe09cbbd0bf6ce7f854.png"><br>  <i>Figure 3: Erebus Linux Rasomware</i> <br><br>  It is worth noting that this virus extortionist is limited in geographical coverage and, in fact, attacks are concentrated in South Korea.  However, data from the VirusTotal service show otherwise - several samples were also obtained from Ukraine and Romania.  A possible reason could be that they were sent by other information security researchers. <br><br><h3>  Encryption procedure </h3><br>  Each file encrypted by Erebus will have the following format: <br><br><table><tbody><tr><td>  Header (0x438 bytes) </td></tr><tr><td>  RSA-2048-encrypted original filename </td></tr><tr><td>  RSA-2048-encrypted AES key </td></tr><tr><td>  AES-encrypted RC4 key </td></tr><tr><td>  RC4-encrypted data </td></tr></tbody></table><br>  First, each individual file is divided into blocks of 500 kB and scrambled using the RC4 encryption algorithm with randomly generated keys.  The RC4 key is then encoded with an AES encryption algorithm.  The AES key is encrypted again using the RSA-2048 algorithm, whose public key is stored in a file. <br><br>  Each file has one public key RSA-2048 common to all.  The RSA-2048 keys are generated locally, while the private key required for decryption is stored in an AES key that is encrypted using an additional randomly generated (possibly, also based on Machine ID).  The analysis shows that decryption is impossible without obtaining RSA-keys. <br><br><h3>  Target file types </h3><br>  Typically, encryption is directed to office documents, databases, archives, and multimedia files.  This is also characteristic of this version of Erebus, which encrypts 433 file types, but there is also a focus on encrypting the web servers and the data stored on them. <br><br>  The table below lists the folders that Erebus is looking for. <br>  var / www / - folders where files / data of web sites are stored, and ibdata files are used in MySQL: <br><table><tbody><tr><td width="200">  <b>Included directories:</b> </td><td width="200">  <strong>Excluded directories:</strong> </td></tr><tr><td width="200">  var / www / </td><td width="200">  $ / bin / </td></tr><tr><td width="200">  <b>Included files:</b> </td><td width="200">  $ / boot / </td></tr><tr><td width="200">  ibdata0 </td><td width="200">  $ / dev / </td></tr><tr><td width="200">  ibdata1 </td><td width="200">  $ / etc / </td></tr><tr><td width="200">  ibdata2 </td><td width="200">  $ / lib / </td></tr><tr><td width="200">  ibdata3 </td><td width="200">  $ / lib64 / </td></tr><tr><td width="200">  ibdata4 </td><td width="200">  $ / proc / </td></tr><tr><td width="200">  ibdata5 </td><td width="200">  $ / run / </td></tr><tr><td width="200">  ibdata6 </td><td width="200">  $ / sbin / </td></tr><tr><td width="200">  ibdata7 </td><td width="200">  $ / srv / </td></tr><tr><td width="200">  ibdata8 </td><td width="200">  $ / sys / </td></tr><tr><td width="200">  ibdata9 </td><td width="200">  $ / tmp / </td></tr><tr><td width="200">  ib_logfile0 </td><td width="200">  $ / usr / </td></tr><tr><td width="200">  ib_logfile1 </td><td width="200">  $ / var / </td></tr><tr><td width="200">  ib_logfile2 </td><td width="200">  /.gem/ </td></tr><tr><td width="200">  ib_logfile3 </td><td width="200">  /.bundle/ </td></tr><tr><td width="200">  ib_logfile4 </td><td width="200">  /.nvm/ </td></tr><tr><td width="200">  ib_logfile5 </td><td width="200">  /.npm/ </td></tr></tbody></table><br><h3>  How to protect yourself? </h3><br>  One vulnerable machine on the network is sometimes enough to infect all connected systems and servers.  Given the risks to operations, reputation and profits, companies must be proactive in addressing such threats.  Recommendations for reducing risks include: <br><br><ul><li>  <a href="https://goo.gl/ub2qw4">Backing up</a> important files </li><li>  Disable or minimize the number of third-party or unverified repositories </li><li>  Application of the principle of least privilege </li><li>  Software update of servers and terminals (or use of virtual patches) </li><li>  Regular network monitoring </li><li>  Check event logs for signs of intrusion or infection </li></ul><br>  Hash functions of SHA256 RANSOM_ELFEREBUS.A: <br>  0b7996bca486575be15e68dba7cbd802b1e5f90436ba23f802da66292c8a055f <br>  d889734783273b7158deeae6cf804a6be99c3a5353d94225a4dbe92caf3a3d48 <br><br>  We will update this post in case new information is received about the features of the spread of the virus. </div><p>Source: <a href="https://habr.com/ru/post/331266/">https://habr.com/ru/post/331266/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331256/index.html">The story of the unexpected "scorching" and restore one smartphone</a></li>
<li><a href="../331258/index.html">Atmosphere at InfoWatch</a></li>
<li><a href="../331260/index.html">CocoaHeads Russia in Tutu.ru office</a></li>
<li><a href="../331262/index.html">How can PVS-Studio help in finding vulnerabilities?</a></li>
<li><a href="../331264/index.html">Analytical tools: a review of lucrative offers</a></li>
<li><a href="../331268/index.html">How to run add-on bitcoin blockchain</a></li>
<li><a href="../331270/index.html">Speed ‚Äã‚Äãreading: does it work or not? Part 1</a></li>
<li><a href="../331272/index.html">GraphicsJS - Graphic JavaScript Library</a></li>
<li><a href="../331274/index.html">Material motivation of staff in the department of Internet marketing</a></li>
<li><a href="../331276/index.html">Antipatterns to search for applicants</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>