<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experiment: the creation of an algorithm for predicting the behavior of stock indices</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Scientists at the Faculty of Computer Science from the Azad Islamic University, located in the UAE, published a paper on predicting the behavior of st...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experiment: the creation of an algorithm for predicting the behavior of stock indices</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/itinvest/blog/278023/"><img src="https://habrastorage.org/files/628/6f8/a9f/6286f8a9f8594df699edfd30e7711b48.png"></a> <br><br>  Scientists at the Faculty of Computer Science from the Azad Islamic University, located in the UAE, published a <a href="https://www.academia.edu/10352844/Prediction_of_Stock_Market_Index_based_on_Neural_Networks_Genetic_Algorithms_and_Data_Mining_Using_SVD">paper</a> on predicting the behavior of stock indices based on neural network technologies, genetic algorithms and data mining using reference vectors.  We bring to your attention the main thoughts of this document. <a name="habracut"></a><br><br><h4>  Introduction </h4><br>  One of the most popular areas of financial analysis in recent years is the prediction of stock prices and the behavior of stock indices based on data from previous trading periods.  To obtain any relevant results, you must use the appropriate tools and correct algorithms. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Scientists have set as their goal the development of special software that could generate predictions of the behavior of stock indices using predictive algorithms and mathematical rules. <br><br>  Stock indices themselves are unpredictable, since they depend not only on economic events, but they are also influenced by the political situation in different parts of the world.  Therefore, it is extremely difficult to develop a mathematical model for processing such unpredictable, nonlinear and non-parametric time series. <br><br>  When working on the stock market using two types of analysis. <br><br>  <b>1) Technical analysis</b> <br><br>  Used for short-term financial strategies.  It is used to predict price changes based on patterns and price changes in a similar way in the past.  As a rule, price charts are analyzed on which patterns of certain patterns in price dynamics stand out.  In addition to studying the dynamics of price changes, technical analysis uses information on trading volumes and other statistical data. <br><br>  <b>2) Fundamental analysis</b> <br><br>  Fundamental analysis is used for long-term investment strategies.  It implies using for forecasting the stock price of a certain company, information on financial and industrial indicators of its activities. <br><br>  Also, when predicting possible price movements, it is necessary to understand the risks existing in the financial market for the players acting on it: <br><br><ul><li>  <b>Trading risk</b> - the amount of funds at risk for the trader.  For example, if he buys a financial asset for a thousand dollars, then the trading risk will be equal to that amount. </li><li>  <b>Market risk</b> - what can happen on the market under the influence of global economic events or events in a particular country where the financial market is located or shares of companies from which are traded on the stock exchange. </li><li>  <b>Marginal risk</b> - if borrowed funds are used to make transactions, a marginal risk arises.  Borrowed, for example, from a broker, the money will ultimately have to be returned, and if the trader has not enough free funds in the account for this, his positions will be forcibly closed even if it was not implied by his trading strategy. </li><li>  <b>Liquidity risk</b> - not every financial instrument can be quickly ‚Äúexited‚Äù. </li><li>  <b>The risk of moving overnight positions</b> - maintaining positions in the interval between trading days or for several trading days carries a risk, since the trader cannot know what will happen at the time when the stock exchange is not working.  Perhaps an event will affect the opening of the trading day, and the stock price will immediately shift in an unprofitable way for the investor. </li><li>  <b>Volatility risk</b> - stock prices fluctuate in certain ranges.  The wider the range of price fluctuations, the higher the volatility of a particular financial instrument. </li></ul><br><h4>  Forecasting stock index behavior </h4><br>  One of the popular tools used to solve stock pricing problems is the decision tree.  In turn, the most effective method of collecting and analyzing data is data mining.  There are several models of using data mining, which implement various approaches to collecting and analyzing the information received. <br><br>  In our case, the researchers chose the CRISP-DM (Cross-Identity Standard Process for Data Mining) model.  This method was developed by a consortium of European companies in the mid-nineties of the last century.  The model includes seven basic steps: <br><br><ol><li>  Definition of targets for information retrieval (data about which promotions are needed). </li><li>  Find the right data. </li><li>  Ordering data in the classification model. </li><li>  The choice of technology for the implementation of the model. </li><li>  Evaluation of the model using known methods. </li><li>  Applying the model in the current market conditions to generate a recommendation for a target action ‚Äî for example, buying or selling a stock. </li><li>  Evaluation of the results. </li></ol><br>  After collecting data, a classification tree is used for decision making.  This approach has three main advantages: it is fast, simple and allows you to achieve high accuracy.  In this case, the previous price, opening price, maximum, minimum, closing and target action (previous, open, max, min, last, action) were chosen as model parameters. <br><br>  Also, genetic algorithms are used for prediction.  They are used to solve complex problems, in cases where the exact relationship between the elements involved is unknown and may not exist in principle. <br><br>  The task is formalized so that its solution can be encoded as a vector of genes (‚Äúgenotype‚Äù), where each gene can represent a bit, a number, or some other object.  Further, a set of genotypes of the initial ‚Äúpopulation‚Äù is randomly created, which are estimated using a special fitness function.  As a result, each genotype is assigned the value of "fitness" - it determines how well it solves the problem. <br><br>  For continuous optimization of the parameters involved in the trading strategy, optimization methods are used.  For example, a gene can be represented as a vector, and the corresponding optimization algorithm applies an intermediate recombination mechanism to it. <br><br>  One of the methods for generating predictions about future price movements is machine learning.  In this case, the researchers used the support vector method.  Researchers have collected financial data from the NASDAQ, as well as some financial instruments and indices.  As a result, for NASDAQ, the accuracy of the system-generated predictions was 74.4%, 77.6% for the DJIA index and 76% for the S &amp; P500. <br><br>  The following formulas were used for machine learning: <br><br>  First of all, x <sub>i</sub> (t) was defined, where i ‚àà {1, 2, ...}. <br><br>  F = (X <sub>1</sub> , X <sub>2</sub> , ... X <sub>n</sub> ) <sup>T</sup> , where <br><br><img src="https://habrastorage.org/files/a4d/af9/325/a4daf932566c491ca2fb2031e3a462e2.png"><br><br>  To evaluate the model used, the method used to calculate the root-mean-square error (RMSE, Root of Mean Square Error) was used: <br><br><img src="https://habrastorage.org/files/ba3/9b5/346/ba39b53463f94e70be29bea06d8b961b.png"><br><br><h4>  Multiclass classification </h4><br>  To minimize risks and increase profits, the support vector model is used.  It implies data classification in three categories: positive, negative and neutral.  This helps to identify the most risky forecasts and reject them.  To create such a multiclass classifier, it is not necessary to determine the width of the central zone: <br><br><img src="https://habrastorage.org/files/90b/64b/e28/90b64be28892443ea6abbc90374d12b3.png"><br><br><blockquote>  <i>tp: true positive</i> <i><br></i>  <i>fp: false positive</i> <i><br></i>  <i>fn: false negative</i> </blockquote><br><h4>  Proposed model </h4><br>  As noted above, the data collected had six attributes.  For use in a decision tree, data must be converted to discrete values.  To do this, you can use the criterion based on the market closing price.  If the value of open, max, min and last exceeds the previous value of the attribute during the current trading day, then the positive value should be replaced with the previous attribute.  On the contrary, a negative value is set instead of the previous attribute, and if the values ‚Äã‚Äãare equal, then the corresponding attribute is set. <br><br>  This is how the data set for six attributes looks like before they are converted to discrete values: <br><br><img src="https://habrastorage.org/files/29e/a46/a5d/29ea46a5d7c54518a46bf1fa90eb52f0.png"><br><br>  And so after the transfer: <br><br><img src="https://habrastorage.org/files/d47/4c2/097/d474c2097d0e402e84b63bb938ec49a0.png"><br><br>  After obtaining such a set of discrete values, it is necessary to build a classification model using a decision tree. <br><br>  This study explores two possible scenarios of action. <br><br><h5>  Scenario # 1 </h5><br>  It is necessary to do the following: <br><br><ol><li>  Collect financial data on the auction for 30 days. </li><li>  Select data on six attributes at 9 points in time during one trading day. </li><li>  For each set to form a matrix. </li><li>  Calculate XX ^ T and apply the support vector method to generate the eigenvalue. </li><li>  Calculate average sales and purchases. </li><li>  Calculate the average of each trading day. </li><li>  Assigning different weights for the first day, the seventh and the thirtieth day, as well as the average value of the month. </li><li>  To generate a recommendation for action, it is necessary to compare the current value with the first, seventh, and thirtieth day, as well as the average value for the entire month. </li><li>  If the prediction result for 4 trading days is the same, then a purchase should be made, if there is a match for three trading days, the purchase will have a risk of 25%, for two days the risk will be 50%. </li></ol><br>  For each trading day out of thirty, it is necessary to generate a matrix in which Xi represents nine different moments in one day: <br><br><img src="https://habrastorage.org/files/92a/2b4/83c/92a2b483c4ae495280028582b51d985d.png"><br><br>  After that, R = XX <sup>T</sup> is calculated - each matrix must be multiplied by the transposed version.  Then the reference vector and its eigenvalue are calculated. <br><br><h5>  Scenario 2 </h5><br>  In this case, all the same steps are performed, but the support vector method is applied not to the ‚Äúraw‚Äù data, but to the matrix obtained after autocorrelation.  An autocorrelation matrix is ‚Äã‚Äãgenerated for each trading day: <br><br><img src="https://habrastorage.org/files/808/369/639/80836963914b445c8920c98594650976.png"><br><br>  The following formula is used here: <br><br><img src="https://habrastorage.org/files/7cd/47a/4b3/7cd47a4b3e93468db43b4337e9a4dd7b.png"><br><br>  After autocorrelation, we get a new matrix ( <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D1%2582%25D1%2580%25D0%25B8%25D1%2586%25D0%25B0_%25D0%25A2%25D1%2591%25D0%25BF%25D0%25BB%25D0%25B8%25D1%2586%25D0%25B0">Toeplitz matrix</a> ): <br><br><img src="https://habrastorage.org/files/75c/7d6/6b5/75c7d66b552143efbb852bd9b96a6c86.png"><br><br>  And already for it the reference vector and the eigenvalue are calculated.  To compare deviations from the average among different trading days, the average value, variance, and standard deviation, which are stored in the vector, are calculated. <br><br><h4>  Conclusion </h4><br>  To obtain the best results, the researchers applied all the described methods step by step: starting with fundamental analysis, using the genetic algorithm, neural networks, machine learning and the support vector machine. <br><br><img src="https://habrastorage.org/files/bfd/e84/1e9/bfde841e90df40ec8c9751e2165f81ae.png"><br><br>  At the same time, it was not possible to achieve 100% accuracy of forecasts of changes in stock index values.  For various financial instruments, the accuracy of predicting the behavior of indices in a single trading day interval is quite different: <br><br><img src="https://habrastorage.org/files/640/0b1/c17/6400b1c17a894361b8b93d35800868f8.png"><br><br>  The best result was an accuracy of 70.8% for the German DAX index.  To achieve greater accuracy with long-term forecasts (a period longer than 30 days), the following formula was used: <br><br>  Pr {v <sub>t + 1</sub> - v <sub>t</sub> &gt; c <sub>t</sub> }, where c <sub>t</sub> = - (v <sub>t-ts</sub> - v <sub>t</sub> ) <br><br>  In this case, the best result of forecast accuracy was 85.0%. <br><br><h4>  Other materials on stock price forecasting and the use of algorithms in the stock market: </h4><br><ul><li>  <a href="https://habrahabr.ru/company/itinvest/blog/275825/">Machine learning techniques for predicting stock prices: indicator functions and news analysis</a> </li><li>  <a href="https://habrahabr.ru/company/itinvest/blog/274821/">How to predict a stock price: An adaptive filtering algorithm</a> </li><li>  <a href="https://habrahabr.ru/company/itinvest/blog/273337/">Detection of insider trading: Algorithms for identifying and patterns of illegal transactions</a> </li><li>  <a href="https://habrahabr.ru/company/itinvest/blog/271555/">Machine learning as a method of analyzing the microstructure of the market and its application in high-frequency trading</a> </li><li>  <a href="https://habrahabr.ru/company/itinvest/blog/271059/">Algorithms and trading on the stock exchange: Hiding large transactions and predicting the price of shares</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/278023/">https://habr.com/ru/post/278023/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278009/index.html">Set operations using Google Guava</a></li>
<li><a href="../278011/index.html">Fees for developers and a terminal based on the Russian microprocessor Baykal-T</a></li>
<li><a href="../278017/index.html">Node.js. Design and development patterns</a></li>
<li><a href="../278019/index.html">Table as parameter in postgresql</a></li>
<li><a href="../278021/index.html">DevTips: Web Developer Tips (49-64)</a></li>
<li><a href="../278025/index.html">Security Week 08: Mice theft through a whistle, Blockbuster operation, Linux Mint with backdoor</a></li>
<li><a href="../278031/index.html">Problems of access control based on the access list in ECM systems (part 2)</a></li>
<li><a href="../278033/index.html">TOM.js is a special library for special cases.</a></li>
<li><a href="../278037/index.html">Handlersocket protocol in detail</a></li>
<li><a href="../278039/index.html">Again about STL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>