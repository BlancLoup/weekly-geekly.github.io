<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Squeeze all the juice from Chromium to Linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article we will look at how to squeeze all the juices from Chromium and speed it up as much as possible, or another browser on its engine (Chr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Squeeze all the juice from Chromium to Linux</h1><div class="post__text post__text-html js-mediator-article"> In this article we will look at how to squeeze all the juices from Chromium and speed it up as much as possible, or another browser on its engine (Chromium, Google Chrome, Opera, Vivaldi, Yandex, etc.).  Due to the inclusion of many experimental opportunities to carry out calculations from the processor to the video card and to include the use of software algorithms that are under development.  Due to this, our favorite <em>chromium will work faster, may stop braking or blinking the screen</em> . <br><br>  <em>Go!</em> <br><a name="habracut"></a><br>  How to make a backup of your entire browser profile (settings, history, bookmarks, etc.) is written at the end of the article. <br><br>  Go to the address <strong><code><a href="http://chrome//gpu" rel="noopener">chrome://gpu</a></code></strong> (yes, just type in the address bar or copy-paste)! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/a5b/f9f/767/a5bf9f767aaf27b05359e740c2dc6809.png" width="456" height="332"></a> <br><br>  As you can see, I have a green ‚ÄúHardware accelerated‚Äù everywhere, which says that this function uses hardware acceleration due to the removal of calculations on the video card, and ‚ÄúEnabled‚Äù says that the software algorithm is enabled. <br><br>  Now go to <strong><code><a href="http://chrome//flags" rel="noopener">chrome://flags</a></code></strong> . Here and we will make most of the settings. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b5a/2d1/943/b5a2d19431ac733be8b25cc339906313.png" width="868" height="456"></a> <br><br>  In the screenshot, red rectangles selected <code>#ignore-gpu-blacklist</code> .  Then all the options from this list will be called just like that.  You can press Ctrl + F and find the setting by its copied name. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/a5d/6af/318/a5d6af3189e4cbc926e8bac7f8eef2c8.png" width="869" height="438"></a> <br><br>  Now we have both <code>chrome://gpu</code> and <code>chrome://flags</code> open.  We look at what parameters are in <code>chrome://gpu</code> , and if the parameter is not green, but yellow or red, in the <code>chrome://flags</code> change the corresponding setting.  <em>Beware, some settings may make the browser unstable, depending on the hardware.</em> <br><br>  <b>Canvas</b> - hardware acceleration of <a href="https://ru.wikipedia.org/wiki/Canvas_(HTML)" rel="noopener">canvas</a> rendering <br>  In <code>chrome://flags</code> this is <code><strong>#ignore-gpu-blacklist</strong></code> <br>  Disables by enabling the option <code>#disable-accelerated-2d-canvas</code> <br><br>  <b><a href="https://www.google.ru/search%3Fq%3Dchromium%2BCheckerImaging" rel="noopener">CheckerImaging</a></b> - the point is that the rasterization of the image is removed from the dependence on the rasterization of the rest of the area with which the image is connected, which allows the web page to be drawn without waiting for the end of the image processing, something like that.  It is said that the Yulmart site starts to draw much faster. <br>  This is the command line option <code><strong>--enable-features="CheckerImaging"</strong></code> , more details below. <br><br>  <b>Flash, Flash Stage3D, Flash Stage3D, Flash Stage3D Baseline profile</b> - hardware accelerated flash content decoding <br>  Also <code><strong>#ignore-gpu-blacklist</strong></code> <br><br>  <b>Compositing</b> - hardware acceleration overlay layers <br>  Most likely, also <code><strong>#ignore-gpu-blacklist</strong></code> , I did not see that it was not working (it was not green) out of the box. <br><br>  <b>Multiple Raster Threads</b> - paralleling the rasterization process of vector elements of a web page into several threads <br>  <code><strong>#enable-gpu-rasterization</strong></code> -&gt; Force-enabled for all layers / Forces for all layers. <br>  Enabling this option can also help if your <em>screen blinks when browsing websites</em> , incl.  VKontakte, and video. <br><br>  <a href="https://software.intel.com/en-us/articles/native-one-copy-texture-uploads-for-chrome-os-on-intel-architecture-enabled-by-default" rel="noopener"><b>Native GpuMemoryBuffers</b></a> - the additional buffer is excluded when copying elements between the CPU and the GPU, disabled by default, why - it is written in detail by reference. <br>  This is the command line option <code><strong>--enable-native-gpu-memory-buffers</strong></code> , more details below. <br><br>  <b>Rasterization</b> - using a rasterization video card <br> <code><strong>#enable-gpu-rasterization</strong></code> <br> <br>  <b>Video Decode</b> - hardware accelerated video decoding (decoded when viewing video) <br>  <b>Video Encode</b> - similar to encoding <br>  Included in <code><strong>#ignore-gpu-blacklist</strong></code> <br><br>  <b>WebGL, WebGL2</b> - support for rendering on the video card the set of OpenGL instructions included in the WebGL standard;  automatically turns off if the video card driver does not support them. <br>  Included in <code><strong>#ignore-gpu-blacklist</strong></code> <br><br>  There is also the option ‚Äú <code><strong>#enable-zero-copy</strong></code> , the above is a <a href="https://software.intel.com/en-us/articles/native-one-copy-texture-uploads-for-chrome-os-on-intel-architecture-enabled-by-default" rel="noopener">link</a> to an article by Intel engineers who developed this function (judging by the screenshots and the introduction to the article, the development takes place on Ubuntu, but is commercially beneficial primarily because of Chrome OS).  There is a suspicion that her work will be very specific for a particular iron. <br><br>  <strong><code>#enable-tcp-fast-open</code></strong> - <a href="https://habrahabr.ru/post/136926/" rel="noopener">TCP Fast Open</a> , speeds up the network stack, feature of the Linux kernel, on Windows and MacOS is not available, Windows ***** unwittingly enjoying the inferiority of their operating system, Apple employees are not far behind them ( do not take to heart, this is a joke). <br><br>  <strong><code>#expensive-background-timer-throttling</code></strong> - limits the maximum processor load to background tabs (i.e. not the tab you are currently working with) to a maximum of 1%.  Not always appropriate.  Suddenly you have a trading on the exchange in the background tab. <br><br>  <strong><code>#v8-cache-options</code></strong> - for example, in the ‚ÄúCache V8 compiler data‚Äù mode, the V8 will be better to cache javascript and not compile them again.  Yet again.  on some complex web applications in theory can cause problems.  V8 is a processing engine (including compilations) of javascript in Chromium, and javascript compilation creates the main load on the processor when the browser is running. <br><br>  <strong><code>#v8-cache-strategies-for-cache-storage</code></strong> - you can enable aggressive V8 cache, talking about the cache in the previous paragraph, the possible consequences are the same. <br><br>  <strong><code>#shared-array-buffer</code></strong> - experimental memory functions in javascript, a detailed explanation is <a href="https://habrahabr.ru/company/ruvds/blog/332194/" rel="noopener">here</a> . <br><br>  <strong><code>#enable-simple-cache-backend</code></strong> -&gt; Enabled / Enabled - instead of implementing your file system similarity in a block cache file, we work with files directly inside the file system, placing most of the work on the operating system and reducing the load on disk I / O including  reduce the number of context switches, which should speed up the work. <br><br>  Now about the Chromium and Google Chrome <strong>command line options</strong> .  Theoretically, any other <s>share of</s> browsers on the Chromium engine should support them, but there is no guarantee. <br>  Close all open copies of Chromium, open the terminal and execute the following command: <br><pre>  $ chromium-browser - enable-native-gpu-memory-buffers - enable-features = "CheckerImaging" </pre><br>  In <code>chrome://gpu</code> can see CheckerImaging and Native GpuMemoryBuffers items turned green (or the browser didn‚Äôt start at all :)) But it‚Äôs inconvenient to launch the browser through the terminal each time, so we open the graphical editor of the <a href="https://www.google.ru/search%3Fq%3Dxdg%2Bdesktop%2Bfiles%26oq%3Dxdg%2Bdesktop%2Bfiles%26aqs%3Dchrome..69i57j0.3738j0j7%26client%3Dubuntu%26sourceid%3Dchrome%26ie%3DUTF-8" rel="noopener">desktop files</a> and in it we add to the browser launch command we need the parameters (note that there is a <code>%U</code> at the end, it is replaced with a link or path to the file that needs to be opened, so you don‚Äôt need to delete it. In KDE, this is <code>kmenuedit</code> (call either via the terminal with the <code>kmenuedit</code> command, or move the cursor to button to call the application menu and click on the right to  mouse button 1 time, then left 1 click on the "Menu Editor" in the list that appears), on the rest of the DE (XFCE, GNOME, Budgie, LXDE, LXQt, etc.) this is <code>menulibre</code> . <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/96c/a34/bcb/96ca34bcb5d2c6efa7b0b698a393ecfd.png" width="155" height="83"></a> <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/65c/2e7/186/65c2e7186aef308fea91e6c2f78a53c5.png" alt="Menulibre, Chromium" width="676" height="638"></a> <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/352/1a1/5e4/3521a15e4bbb70e7a93b76ebb2987980.png" alt="Kmenuedit, Chromium" width="873" height="507"></a> <br><br>  True unixoids can copy <code>/usr/share/applications/chromium-browser.desktop</code> to <code>~/.local/share/applications/chromium-browser.desktop</code> and edit the Exec parameter, you <code>~/.local/share/applications/chromium-browser.desktop</code> get the same: <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/8e1/4fb/14f/8e14fb14f52523a4d9a3630d061b1089.png" width="576" height="364"></a> <br><br>  Depending on the DE, you may need to re-bring the shortcut to the desktop and / or panels. <br><br>  <b>UPD</b> 05/10/2018. <br>  <a href="https://github.com/WArYagTwar/chromiumdesktop">Here</a> is a complete list of flags for Chromium, which can be written directly to Exec in the Desktop file, so that you do not need to turn them all on manually: <br><pre>  chromium-browser --ignore-gpu-blacklist --enable-experimental-canvas-features --enable-accelerated-2d-canvas - canvas-msaa-sample-count = 2 - force-display-list-2d-canvas --force-gpu-rasterization --enable-fast-unload --enable-accelerated-vpx-decode = 3 --enable-tcp-fastopen --javascript-harmony --enable-checker-imaging --v8-cache- options = code --v8-cache-strategies-for-cache-storage = aggressive -enable-zero-copy --ui-enable-zero-copy --enable-native-gpu-memory-buffers --enable-webgl -image-chromium --enable-accelerated-video --enable-gpu-rasterization </pre><br><br>  <strong>How to measure the speed of the browser</strong> , to understand which options <em>on your combination of hardware and video driver</em> speed up the work, and which ones slow down? <br>  To do this, run the online benchmark <a href="https://web.basemark.com/" rel="noopener">web.basemark.com</a> with various combinations of settings and compare the number of points scored <s>parrots</s> . <br><br>  In <code>chrome://gpu</code> browser can mom swear that hardware acceleration of video decoding is enabled.  But not every video will be decoded by hardware! <br>  Open the <strong><code>chrome://media-internals/</code></strong> , in parallel, start playing any video from <a href="https://youtube.com/" rel="noopener">Youtube</a> and see what codec it is decoded. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/6a2/87e/67b/6a287e67be3b9d69c547b39e32e666f1.png" width="660" height="365"></a> <br><br>  Now Google gives all video in the VP9 codec of its own design, but on quite a few old video cards only H.264 hardware decoding is possible;  The <a href="https://chrome.google.com/webstore/detail/h264ify/aleakchihdccplidncghkekgioiakgal%3Fhl%3Dru" rel="noopener">h264ify</a> extension <a href="https://chrome.google.com/webstore/detail/h264ify/aleakchihdccplidncghkekgioiakgal%3Fhl%3Dru" rel="noopener">will</a> force the browser to report that it does not support VP8 and VP9 codecs, which will force Youtube to give out video in H.264.  See <a href="https://www.youtube.com/html5" rel="noopener">youtube.com/html5</a> <br><br>  The default is: <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/83f/400/e7b/83f400e7b8f4f9f387277adb3062d3ef.png" width="1021" height="487"></a> <br><br>  With h264ify enabled on its standard settings: <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/4a2/743/ad1/4a2743ad1b754acacb0ce75dbdb8e942.png" width="660" height="277"></a> <br><br>  In general, there is no single normal list of which drivers support hardware decoding and on which video cards, but the Chromium 62 <a href="https://chromium-review.googlesource.com/c/chromium/src/%2B/532294" rel="noopener">will have a</a> full VA-API (API for hardware accelerated video encoding and decoding), which was before, but only on ChromeOS, for example , <a href="https://launchpad.net/~saiarcot895/%2Barchive/ubuntu/chromium-dev" rel="noopener">here</a> , Chromium was compiled and assembled with a patch that includes it on Linux.  We recommend the latest version of libva;  if you have, for example, Ubuntu 16.04, then you can update the entire graphics stack <a href="https://launchpad.net/~xorg-edgers/%2Barchive/ubuntu/ppa" rel="noopener">from here</a> , which is recommended for users of modern and not very Intel and AMD video cards, since  these days, the open-end graphics stack is developing very quickly, and we used a lot of video card functions in the article.  The developers of Ubuntu 17.10 <a href="https://www.google.ru/search%3Fq%3Dubuntu%2B17.10%2Blibva%2Bstatus%26oq%3Dubuntu%2B17.10%2Blibva%2Bstatus%26client%3Dubuntu%26sourceid%3Dchrome%26ie%3DUTF-8" rel="noopener">have been working</a> to improve the work of the VA-API out of the box.  In general, I have never encountered problems with playing video on Linux, everything works fine out of the box.  For Firefox, <em>there was an</em> <a href="https://addons.mozilla.org/ru/firefox/addon/watch-with-mpv/" rel="noopener">addition</a> that allowed the YouTube movie to play in the external mpv player, which on very old machines could significantly reduce the load on the processor. <br><br>  - Pamagite !!!  <strong>The browser stopped running</strong> !!! <br>  - This happens very rarely, but still sometimes happens when the settings for working with a video card are twisted so that the browser does not work with it.  Open the <code>~/.config</code> folder in the file manager (~ is your home folder) and find the chromium folder (for Google Chrome it is called google-chrome, Vivaldi - Vivaldi, etc.). <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/458/0eb/13e/4580eb13e79b78532004231a2e7082cf.png" width="837" height="592"></a> <br><br>  Our profile is stored in it.  You can simply rename the folder, for example, to chromium.old, and the next time you run it, chromium will create it again and start from scratch.  As a <strong>backup (backup), I</strong> recommend to archive this folder (and store it as the eyeball of the eye) before all manipulations.  If you broke something, and you do not want to start with a clean profile, then try opening the terminal inside <code>~/.config/chromium</code> and executing the command: <br><pre>  $ grep -inHr "ignore-gpu-blacklist" </pre><br>  where, instead of ignore-gpu-blacklist, substitute the name of the option that you think is causing the problem.  In response, the grep command will display the file path and line number where there is a chance to correct the setting.  Perhaps some of the settings are stored in the SQLite database, and then you need some program to work with SQLite-DB and search them.  Honestly, I have never tried to do that. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/a3e/db5/910/a3edb591001854c6dec674a89f21c548.png" width="660" height="376"></a> <br><br>  For this I leave, thank you for your attention, waiting for feedback and questions in the comments. </div><p>Source: <a href="https://habr.com/ru/post/339238/">https://habr.com/ru/post/339238/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339228/index.html">From web developer to machine learning specialist</a></li>
<li><a href="../339230/index.html">.NET Performance: The Real Jedi Tricks</a></li>
<li><a href="../339232/index.html">Rapid application development on Angular + Ag-Grid</a></li>
<li><a href="../339234/index.html">Announcement RamblerElixir # 4</a></li>
<li><a href="../339236/index.html">Do you have a fast site? And if I check?</a></li>
<li><a href="../339240/index.html">Generate short texts with limiting conditions - for advertising and other purposes.</a></li>
<li><a href="../339242/index.html">About traffic interception: 4-10% of encrypted HTTPS traffic is intercepted today</a></li>
<li><a href="../339246/index.html">Few prefab tasks on bash</a></li>
<li><a href="../339248/index.html">The first hackathon Skyeng: 15 working projects in two days</a></li>
<li><a href="../339250/index.html">Identify hidden data dependencies to improve the quality of the forecast in machine learning</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>