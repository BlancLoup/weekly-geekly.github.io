<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Casual workouts for Swift</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, brothers in swift-e. I also had to learn this bird language, and there is no better way to learn than to make a software product that works on a b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Casual workouts for Swift</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/b94/f35/202/b94f35202f374560bbe29f16402d43d2.png" alt="image"><br><br>  Hi, brothers in swift-e.  I also had to learn this bird language, and there is no better way to learn than to make a software product that works on a battered iPhone.  I have been bitten by an intricate math puzzle from the inside for a long time!  And suddenly swift.  The code in some places looks ridiculous, but understandable.  I will not discuss the algorithm of the game itself, it is too complicated for local moderators who do not know how to divide 111 by 3. But here are some examples of useful functions for casual game developers - please discuss. <br><a name="habracut"></a><br><h4>  Randomness </h4><br>  First of all, in any game you need your own generator of random sequences of integers.  To generate repetitive layouts and for a lot more then. <br>  If the code of the generator function on Java, JS and C looks the same (after all, will your game be written in all languages?), Then on Swift you had to rewrite the code using the random method.  Instead of 2 lines, he began to occupy 4. <br><br><pre><code class="cpp hljs">var holdrand = <span class="hljs-number"><span class="hljs-number">0</span></span> func microsoft_rnd()-&gt;Int { var k = Int.multiplyWithOverflow(holdrand, <span class="hljs-number"><span class="hljs-number">214013</span></span>) k = Int.addWithOverflow(k<span class="hljs-number"><span class="hljs-number">.0</span></span>, <span class="hljs-number"><span class="hljs-number">2531011</span></span>) holdrand = k<span class="hljs-number"><span class="hljs-number">.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Int((holdrand &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7FFF</span></span>) } func microsoft_rand(number:Int)-&gt;Int { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> microsoft_rnd() % number }</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And here is what the C-th version of the MixoPhoto sensor, which I had torn out from MSVC 15 years ago, looked like. <br><pre> <code class="cpp hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)microsoft_rnd { holdrand = holdrand * <span class="hljs-number"><span class="hljs-number">214013</span></span> + <span class="hljs-number"><span class="hljs-number">2531011</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((holdrand &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7FFF</span></span>); } - (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) microsoft_rand:(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) number{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [self microsoft_rnd] % number; }</code> </pre><br><br>  As you can see, Swift is very strict with overflows and adds headaches to the developer, but apparently removes stress from the runtime user.  At the same time, Obj-C worked perfectly without any stresses and headaches. <br><br>  So here.  Defining the holdrand variable, say holdrand = 25, we will obviously repeat the alignment for the conditional level 25 in all variants of the puzzle - be it written in PHP for playing on the server, or on Swift for playing on the iPhone.  This gives a sense of fraternity for the players - they are like everything is offline, but at the same time they compete in absentia in the same scenario.  Looks like a bridge tournament.  For a long time I did not play bridge, by the way. <br><br>  Let's go to practice.  Let's create a simple Swift project using Xcode.  Press the button <i>File-&gt; New-&gt; Project ...-&gt; Single View Application</i> and get the finished project blank, the main class of which <i>AppDelegate.swift</i> looks frighteningly simple <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit @UIApplicationMain <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppDelegate</span></span></span><span class="hljs-class">:</span></span> UIResponder, UIApplicationDelegate { var window: UIWindow? <span class="hljs-function"><span class="hljs-function">func </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">application</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?)</span></span></span><span class="hljs-function"> -&gt; Bool </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Override point for customization after application launch. } }</span></span></code> </pre><br><br>  What has changed since Obj-C?  First, instead of two files, there is one.  I approve of it. <br>  In addition, strange "?" Characters appeared in the text.  and "!"  Do not worry, these are signs of the type of a variable, if the variable x: Float!  Is it exactly float if x: float?  - the author is not sure that this variable will always be Float. <br><br>  Honestly, Xcode itself substitutes these characters in case of need, and after 4 hours of coding, you will begin to understand the logic of using idiotic characters. <br><br><h4>  Advertising </h4><br>  So, what is necessary for the game developer in the second place, but not the last?  Of course, advertising.  It is in this class AppDelegate it must be added.  Download the latest version of Google MobileAds with Swift, add to the project and write a couple of functions <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GoogleMobileAds @UIApplicationMain <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppDelegate</span></span></span><span class="hljs-class">:</span></span> UIResponder, UIApplicationDelegate { var window: UIWindow? var bannerView: GADBannerView! var iPhone5 = <span class="hljs-literal"><span class="hljs-literal">true</span></span> func application(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?) -&gt; Bool { startAds() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> } func startAds() { bannerView = GADBannerView(adSize: kGADAdSizeBanner) print(<span class="hljs-string"><span class="hljs-string">"Google Mobile Ads SDK version: "</span></span> + GADRequest.sdkVersion()) bannerView.adUnitID = yourAdMobID bannerView.rootViewController = self.window?.rootViewController let adViewHeight = bannerView.frame.size.height print(<span class="hljs-string"><span class="hljs-string">"adViewHeight: \(adViewHeight)"</span></span>) let screenSize: CGRect = UIScreen.mainScreen().bounds let screenHeight = screenSize.height bannerView.frame.origin = CGPointMake(<span class="hljs-number"><span class="hljs-number">0</span></span>, screenHeight - adViewHeight) let request = GADRequest() request.testDevices = [kGADSimulatorID ] self.window?.rootViewController!.view.addSubview(bannerView) bannerView.loadRequest(request) <span class="hljs-comment"><span class="hljs-comment">//    ,  2    iPhone5 = screenHeight &gt;= heightOfScreenOfiPhone5AndMoreInLogicalPixels } func bringAdsToFront() { self.window?.rootViewController!.view.bringSubviewToFront(bannerView) } }</span></span></code> </pre><br><br>  The startAds () call appeared in the body of the main function. <br>  The bringAdsToFront () function is in fact not necessary for me, but it can be useful to you if you use non-standard ViewControllers that will overlap the advertising window when it appears.  In this case, the banner must be pulled out on top of all Views by calling this procedure. <br><br>  The variable iPhone5 is terribly necessary, like air, as long as two Aspect Ratio on iOS are alive.  I remind you that 5% of the population still uses 4 iPhones, the proportions of which differ from all modern models.  In addition, if your application is iPhone only, then when you launch it on the iPad, you again get the good old mode 320 by 480 pixels. <br><br>  Why so place a banner?  I have an application to play in the subway with one hand on the phone, so the working mode is always defined for him - <i>Portrait</i> .  And 320x50 ads I bring down the screen, which doubles the earnings.  At the time of publication of the article, I already earned 40 US cents. <br><br>  In principle, now you have learned how to program in Swift. <br><br><h4>  Sound </h4><br>  What else is needed in the game, even the most primitive?  Sounds mu <br><br>  Add two functions and one class. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit @UIApplicationMain <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppDelegate</span></span></span><span class="hljs-class">:</span></span> UIResponder, UIApplicationDelegate { var window: UIWindow? var soundLib: SoundController? <span class="hljs-function"><span class="hljs-function">func </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">application</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?)</span></span></span><span class="hljs-function"> -&gt; Bool </span></span>{ soundLib = SoundController.init() } func setVolume(v:Double) { soundLib?.setVolume(v*v) } func playSound(i:Int) { soundLib?.playSound(i) } }</code> </pre><br><br>  In addition, we add dozens of mp3 and caf files pulled out of Google to the project and create the SoundController class in a separate file <br><div class="spoiler">  <b class="spoiler_title">SoundController.swift</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Created by Vadim Bashurov on 3/19/16. // import UIKit import AVFoundation class SoundController { let audioFiles: [String: String] = [ "Ashley_glad_1": "caf", "star_first": "caf", "star_third": "caf", "bouncer":"caf", "bird shot-a3":"mp3", "ball_bounce":"mp3", "bird_a4":"mp3", "HittingBasketBoard":"mp3", "piglette_a1":"mp3", ] var players : [AVAudioPlayer] = [] var volume = 0.0 init () { for (name, ext) in audioFiles { let a1 = self.setupAudioPlayerWithFile(name, type:ext) players.append(a1!) } } func setVolume(v:Double) { volume = v for audioPlayer in players { audioPlayer.volume = Float(volume) } } func playSound(i:Int) { let audioPlayer = players[i] audioPlayer.play() } func setupAudioPlayerWithFile(file:NSString, type:NSString) -&gt; AVAudioPlayer? { let path = NSBundle.mainBundle().pathForResource(file as String, ofType: type as String) let url = NSURL.fileURLWithPath(path!) var audioPlayer:AVAudioPlayer? do { try audioPlayer = AVAudioPlayer(contentsOfURL: url) audioPlayer!.prepareToPlay() } catch { print("Player not available") } return audioPlayer } }</span></span></code> </pre><br></div></div><br><br>  Of course, I went through all 4 options for playing sound under iOS.  System sounds are not suitable for game development, as they do not programmatically control the level of reproduction.  AudioService from the OAL library on Swift has not been rewritten by me, there is not enough knowledge and time.  AudioQuery slows down.  In the future, I will abandon the bridge from my Obj-C library, because despite the <i>preload</i> function, AVAudioPlayer lays at the start of the program. <br><br>  And for dessert, jumpers! <br><br><h4>  Skipjack </h4><br><br>  All your lettering buttons and pictures should appear on the screen, like real objects from the fairy-tale world.  Either float, or fly, go out of the shadows and poddrygivat.  Starting with iOS 8, Apple offered a left-handed feature for bouncing animations. <br><br>  Here is an example <br><pre> <code class="objectivec hljs"> <span class="hljs-built_in"><span class="hljs-built_in">UIView</span></span>.animateWithDuration(<span class="hljs-number"><span class="hljs-number">1.2</span></span>, delay: <span class="hljs-number"><span class="hljs-number">0.1</span></span>, usingSpringWithDamping: <span class="hljs-number"><span class="hljs-number">0.3</span></span>, initialSpringVelocity: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, options: <span class="hljs-built_in"><span class="hljs-built_in">UIViewAnimationOptions</span></span>.CurveLinear, animations: { box1.center = <span class="hljs-built_in"><span class="hljs-built_in">CGPointMake</span></span>(box2.center.x,box2.center.y) }, completion: {finished <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.showFingers() })</code> </pre><br><br>  As a result of the work of the function, box 1 will fall on box 2 (this is the plot of my puzzle) not just stupid, but with cheerful jumps, after which it will rest peacefully. <br>  The physics of a jump can be varied with 3 parameters - the time of the whole process - in my text it is 1.2 seconds, the second parameter is the delay before the start of the fall (delay: 0.1) does not affect bouncing. <br>  But the 3 and 4 parameters have a value from 0 to 1 and determine the quality of the jump.  If you set them to 1, then there will be no rebound.  If zero, the box will jump like a louse on a branch. <br><br>  Experiment yourself, this exercise is extremely fun. <br><br>  Now you are ready to write a simple toy on Swift and earn a few dollars for beer. <br>  Chao! </div><p>Source: <a href="https://habr.com/ru/post/280266/">https://habr.com/ru/post/280266/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../280254/index.html">Experience starting AHCI in VxWorks653</a></li>
<li><a href="../280256/index.html">Wearable Smart Gateway - wearable device for emergency services</a></li>
<li><a href="../280258/index.html">The digest of interesting materials for the mobile # 146 developer (March 21-27)</a></li>
<li><a href="../280262/index.html">Efficient data structures for PHP 7</a></li>
<li><a href="../280264/index.html">5 tips for preparing your application for multiwindow mode in Android N</a></li>
<li><a href="../280268/index.html">Russian neural network chatbot</a></li>
<li><a href="../280270/index.html">Parsim HTML in C ++ and Gumbo</a></li>
<li><a href="../280272/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ204 (March 21 - 27, 2016)</a></li>
<li><a href="../280274/index.html">Rust and Swift (introduction, first and second parts)</a></li>
<li><a href="../280276/index.html">Development Case on Golang: ITooLabs Virtual PBX Platform</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>