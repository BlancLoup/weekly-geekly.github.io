<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bicubic interpolation, theory and practical implementation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There was a task to visualize the results of some measurements on a 2-dimensional map, the results were known at the nodal points on a uniform grid, r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bicubic interpolation, theory and practical implementation</h1><div class="post__text post__text-html js-mediator-article">  There was a task to visualize the results of some measurements on a 2-dimensional map, the results were known at the nodal points on a uniform grid, respectively, the task was reduced to interpolating the obtained data.  The main requirement was the quality of the resulting image and the minimum number of interpolation artifacts, so the choice fell on the bicubic interpolation.  <a href="http://ru.wikipedia.org/wiki/%25D0%2591%25D0%25B8%25D0%25BA%25D1%2583%25D0%25B1%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B5%25D1%2580%25D0%25BF%25D0%25BE%25D0%25BB%25D1%258F%25D1%2586%25D0%25B8%25D1%258F">The articles</a> in <a href="http://en.wikipedia.org/wiki/Bicubic_interpolation">Wiki</a> seemed to me dry (at least for a person who did not study mathematics from school), but there was also a <a href="http://www.paulinternet.nl/%3Fpage%3Dbicubic">link</a> to an amazing article describing the algorithm in detail.  Here we look at the practical application of this algorithm and analyze the article. <br><a name="habracut"></a><br><h4>  Terminology </h4><br><blockquote>  Interpolation, interpolation - in computational mathematics, a method of finding intermediate values ‚Äã‚Äãof a value over an existing discrete set of known values. </blockquote><br>  (c) Wiki <br><br><h4>  Cubic interpolation </h4><br><br>  To better understand the principle of bicubic interpolation, I propose to consider the principle of cubic interpolation. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If the values ‚Äã‚Äãof the function f (x) and its derivative are known at the points x = 0 and x = 1, then the function can be interpolated on the interval [0, 1] using a third-order polynomial.  The formula for the calculation can be easily obtained. <br><br>  Third-order polynomial and its derivative: <br><img src="https://habrastorage.org/getpro/habr/post_images/5cd/a40/9fa/5cda409fa1195edec6bc6a32316916c1.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/091/329/07e/09132907eeb43cde711b6c15b605be8d.png"><br><br>  The values ‚Äã‚Äãof the polynomial and its derivative at the points x = 0 and x = 1 <br><img src="https://habrastorage.org/getpro/habr/post_images/d90/ec5/8a2/d90ec58a2868b1e910cabeac5d1304f1.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/0e9/1fa/f69/0e91faf698f7eefa9841760acaf3d06c.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/27c/a82/f97/27ca82f97175bda5889be9e883ce318b.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/4ac/ab8/989/4acab898904a6be31cc7a093287b2d81.png"><br><br>  These four identities can be written as: <br><img src="https://habrastorage.org/getpro/habr/post_images/009/22d/4ad/00922d4ad96e1f71e2e03987d0d028ed.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/3ab/80f/dbd/3ab80fdbdb94ccdf9270a0be515fbaa9.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/4a6/834/da5/4a6834da52333ede0dfbf389a500949c.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/ecc/328/231/ecc3282312176ffb4f57e5696a65495b.png"><br><br>  So we got our interpolation formula <br><br>  In practice, the algorithm is used to interpolate a function, having certain known values ‚Äã‚Äãat specified points.  In this case, we cannot know the derivative of the function.  We could take the derivative at given points as 0, but to obtain smoother and more likely function graphs, we take the slope of the line between the previous and the next point as the derivative.  Thus for the calculations we need 4 points.  Suppose we have 4 function values ‚Äã‚Äãat the points p0, p1, p2 and p3, located respectively at x = -1, x = 0, x = 1 and x = 2.  Substitute the obtained values ‚Äã‚Äãof f (0), f (1), f (2) and f (3): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/705/00a/dbc/70500adbc1ff2339f834fac5a37246e5.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/45e/c20/5e2/45ec205e26c23731360c0733c0122f4a.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/ccc/edb/ceb/cccedbceb17e680955ee4df7de2354ec.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/1f8/abe/9fe/1f8abe9fed65678c82d266f611a055f5.png"><br><br>  Comparing these data with the previously obtained formulas, we have: <br><img src="https://habrastorage.org/getpro/habr/post_images/82e/866/159/82e86615924695a78eb4551275f22c47.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/393/860/060/393860060c48a86cbd93fbc321b46978.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/1bb/e8c/5b2/1bbe8c5b2146e0bfac2564cea875a6ee.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/cc9/20d/a87/cc920da877abbe8687a0bd0ff67c465f.png"><br><br>  Result: <br><img src="http://www.paulinternet.nl/images/bicubic/bf68b87e.png"><br><br>  Consider the implementation of this algorithm in PHP: <br><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> array $p    : f(x0), f(x1), f(x2), f(x3) * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> float $x x-   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> float   f($x) */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cubicInterpolate</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($p, $x)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $p[<span class="hljs-number"><span class="hljs-number">1</span></span>] + (<span class="hljs-number"><span class="hljs-number">-0.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">0.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>]) * $x + ($p[<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">2.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">2.0</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">0.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>]) * $x * $x + (<span class="hljs-number"><span class="hljs-number">-0.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">1.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">1.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">0.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>]) * $x * $x * $x; }</code> </pre> <br><br><h4>  Bicubic interpolation </h4><br><br>  Bicubic interpolation is a cubic interpolation in two dimensions.  In fact, we can interpolate in more dimensions, but in this article, we consider only this example. <br>  Imagine that we know 16 points p <sub>ij</sub> , with a point of origin in (i-1, j-1), where i, j vary from 0 to 3. Then, we can interpolate the surface in the section [0,0] x [ 1,1], for this we interpolate 4 columns and then interpolate the obtained results in the horizontal direction: <br><img src="https://habrastorage.org/getpro/habr/post_images/a79/342/8c5/a793428c567f91c5da269f5f2f5cdfc6.png"><br><br>  The implementation of the method in PHP, combined with the first function: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> array $p   2-  (4 x 4),    16-   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> float $x x-   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> float $y y-   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> float   f($x, $y) */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bicubicInterpolate</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($p, $x, $y)</span></span></span><span class="hljs-function"> </span></span>{ $tmp = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $tmp[<span class="hljs-number"><span class="hljs-number">0</span></span>] = cubicInterpolate($p[<span class="hljs-number"><span class="hljs-number">0</span></span>], $y); $tmp[<span class="hljs-number"><span class="hljs-number">1</span></span>] = cubicInterpolate($p[<span class="hljs-number"><span class="hljs-number">1</span></span>], $y); $tmp[<span class="hljs-number"><span class="hljs-number">2</span></span>] = cubicInterpolate($p[<span class="hljs-number"><span class="hljs-number">2</span></span>], $y); $tmp[<span class="hljs-number"><span class="hljs-number">3</span></span>] = cubicInterpolate($p[<span class="hljs-number"><span class="hljs-number">3</span></span>], $y); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cubicInterpolate($tmp, $x); }</code> </pre><br><br>  Everything would be great if not for one problem - performance.  In order to interpolate even a relatively small amount of data, serious computational resources are required.  To optimize performance there is the following approach. <br>  Consider our formula in the form of a multidimensional polynomial: <br><img src="https://habrastorage.org/getpro/habr/post_images/270/995/b3f/270995b3fbbf23ab1a2c6e998471b79a.png"><br>  In expanded form there will be something like: <br><pre>  g (x, y) = a00 * x ^ 0 * y ^ 0 + a01 * x ^ 0 * y ^ 1 + 
          a02 * x ^ 0 * y ^ 2 + a03 * x ^ 0 * y ^ 3 +
          a10 * x ^ 1 * y ^ 0 + a11 * x ^ 1 * y ^ 1 + 
          a12 * x ^ 1 * y ^ 2 + a13 * x ^ 1 * y ^ 3 +
          a20 * x ^ 2 * y ^ 0 + a21 * x ^ 2 * y ^ 1 + 
          a22 * x ^ 3 * y ^ 2 + a23 * x ^ 2 * y ^ 3 +
          a30 * x ^ 3 * y ^ 0 + a31 * x ^ 3 * y ^ 1 + 
          a32 * x ^ 3 * y ^ 2 + a33 * x ^ 3 * y ^ 3
</pre><br>  Now it is necessary to calculate the coefficients a <sub>ij</sub> .  Here I would especially like to note that by calculating the coefficients once we can use them to interpolate all values ‚Äã‚Äãin the section from [0.0] to [1.1] <br><img src="https://habrastorage.org/getpro/habr/post_images/3d7/82d/b38/3d782db3834785da9ac341cfd57f65f2.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/d1b/747/4b5/d1b7474b5d96b04dae664d4110089082.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/4cf/1f2/78b/4cf1f278b180246dc38dabd86a1a78b7.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/80d/cfa/a4a/80dcfaa4a2c81ba66c589cbd2230c54c.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/579/591/d7f/579591d7fac884b8f844a7e596f935a4.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/f6d/83d/c0c/f6d83dc0ca5b1b680ea3ac515dd35849.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/746/755/e08/746755e081986f137dd864b17155913c.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/cd1/85b/2ff/cd185b2fff4a5a923303ae08b99bc86b.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/3b4/3c5/2a9/3b43c52a9263e1d1409dc32bbaf67cbd.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/b0c/b7a/fa8/b0cb7afa8531ecaa1b08517609bdb267.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/fea/f92/e95/feaf92e95441de608bd85cdf7f378ab0.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/10f/d20/a3f/10fd20a3f413f49bc23afbb4223285b2.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/217/524/454/217524454e1004030f79bc5e544eab69.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/958/3b8/eaa/9583b8eaad303c3de19333d4791780af.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/04d/139/a8b/04d139a8b9cbeb81bf07ef450df71a4f.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/a3f/bb6/75d/a3fbb675dde04ccc14bc591e228fae61.png"><br><br>  To implement this method, create the following class: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CachedBicubicInterpolator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $a00, $a01, $a02, $a03, $a10, $a11, $a12, $a13, $a20, $a21, $a22, $a23, $a30, $a31, $a32, $a33; <span class="hljs-comment"><span class="hljs-comment">/** *  . * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> array $p 2-  (4 x 4),      * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateCoefficients</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($p)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a00 = $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a01 = <span class="hljs-number"><span class="hljs-number">-.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a02 = $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">2.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">2</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a03 = <span class="hljs-number"><span class="hljs-number">-.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">1.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">1.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a10 = <span class="hljs-number"><span class="hljs-number">-.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a11 = <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a12 = <span class="hljs-number"><span class="hljs-number">-.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">1.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">1.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a13 = <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a20 = $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">2.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">2</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a21 = <span class="hljs-number"><span class="hljs-number">-.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">1.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">1.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a22 = $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">2.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">2</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] - <span class="hljs-number"><span class="hljs-number">2.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">6.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">1.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-number"><span class="hljs-number">2</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] - <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">1.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a23 = <span class="hljs-number"><span class="hljs-number">-.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">1.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">1.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-number"><span class="hljs-number">1.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">3.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">3.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">1.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] - $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">3</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">3</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a30 = <span class="hljs-number"><span class="hljs-number">-.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">1.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">1.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a31 = <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a32 = <span class="hljs-number"><span class="hljs-number">-.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">1.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-number"><span class="hljs-number">1.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">3.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">3</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] - <span class="hljs-number"><span class="hljs-number">1.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">3.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">3</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-number"><span class="hljs-number">.5</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">1.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;a33 = <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] - <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">2.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">2.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] - <span class="hljs-number"><span class="hljs-number">2.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">2.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>] - <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] - <span class="hljs-number"><span class="hljs-number">.75</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">.25</span></span> * $p[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>]; } <span class="hljs-comment"><span class="hljs-comment">/** *  . * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> float $x $x = $x - $x0 * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> float $y $y = $y - $y0 * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> float    . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getValue</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($x, $y)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   2  3 . $x2 = $x * $x; $x3 = $x2 * $x; $y2 = $y * $y; $y3 = $y2 * $y; return ($this-&gt;a00 + $this-&gt;a01 * $y + $this-&gt;a02 * $y2 + $this-&gt;a03 * $y3) + ($this-&gt;a10 + $this-&gt;a11 * $y + $this-&gt;a12 * $y2 + $this-&gt;a13 * $y3) * $x + ($this-&gt;a20 + $this-&gt;a21 * $y + $this-&gt;a22 * $y2 + $this-&gt;a23 * $y3) * $x2 + ($this-&gt;a30 + $this-&gt;a31 * $y + $this-&gt;a32 * $y2 + $this-&gt;a33 * $y3) * $x3; } }</span></span></code> </pre><br><br><h4>  Practical use </h4><br><br>  Consider the use of bicubic interpolation in the following example: <br>  <strong>Baseline:</strong> 7 x 7 <strong>data</strong> array <br>  <strong>Required:</strong> Imagine the surface as an image of 300 x 300 pixels. <br><br>  In the code I tried to comment on every step as much as possible, I think everything will be clear <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> header(<span class="hljs-string"><span class="hljs-string">"Content-type: image/png"</span></span>);<span class="hljs-comment"><span class="hljs-comment">//  include 'interpolation.php';//   include 'colormap.php';//   $simpleData = array( array(0, 0.1, 0.15, 0.2, 0.15, 0.1, 0), array(0, 0.1, 0.5, 1, 0.9, 0.1, 0), array(0, 0.1, 0.7, 1, 0.9, 0.1, 0), array(0, 0.1, 0.6, 0.7, 0.5, 0.1, 0), array(0, 0.2, 0.8, 0.6, 0.15, 0.08, 0.1), array(0.08, 0.2, 0.15, 0.2, 0.15, 0.1, 0.1), array(0.1, 0.8, 0.1, 0.1, 0.1, 0, 0) );//    7  7 $countX = count($simpleData[0]);//    $countY = count($simpleData); $input = array(); /*       *      ,         *     -      */ for ($i = 0; $i &lt; $countX; $i ++) { for ($j = 0; $j &lt; $countY; $j ++) { $input[$i + 1][$j + 1] = $simpleData[$j][$i]; if ($i == 0) { $input[0][$j + 1] = $simpleData[$j][$i] - $simpleData[$j][$i + 1];//  } if ($i == ($countX - 1)) { $input[$countX + 1][$j + 1] = $simpleData[$j][$i] - $simpleData[$j][$i - 1];//  } if ($j == 0) { $input[$i + 1][0] = $simpleData[$j][$i] - $simpleData[$j + 1][$i];//  } if ($j == ($countY - 1)) { $input[$i + 1][$countY + 1] = $simpleData[$j][$i] - $simpleData[$j - 1][$i];//  } } } /*   *     ,     . */ $input[0][0] = ($input[1][0] + $input[0][1]) / 2; $input[$countX + 1][0] = ($input[$countX][0] + $input[$countX][1]) / 2; $input[0][$countY + 1] = ($input[0][$countY] + $input[1][$countY]) / 2; $input[$countX + 1][$countY + 1] = ($input[$countX + 1][$countY] + $input[$countX][$countY]) / 2; $step = 50; //  50  $img = imagecreatetruecolor(($countX - 1) * $step, ($countY - 1) * $step);//    $colormap = createColormap($img);//   $b2i = new CachedBicubicInterpolator(); for ($i = 1; $i &lt; $countX; $i ++) {//   for ($j = 1; $j &lt; $countY; $j ++) { $points = array(); $points[0][0] = $input[$i - 1][$j - 1]; $points[1][0] = $input[$i][$j - 1]; $points[2][0] = $input[$i + 1][$j - 1]; $points[3][0] = $input[$i + 2][$j - 1]; $points[0][1] = $input[$i - 1][$j]; $points[1][1] = $input[$i][$j]; $points[2][1] = $input[$i + 1][$j]; $points[3][1] = $input[$i + 2][$j]; $points[0][2] = $input[$i - 1][$j + 1]; $points[1][2] = $input[$i][$j + 1]; $points[2][2] = $input[$i + 1][$j + 1]; $points[3][2] = $input[$i + 2][$j + 1]; $points[0][3] = $input[$i - 1][$j + 2]; $points[1][3] = $input[$i][$j + 2]; $points[2][3] = $input[$i + 1][$j + 2]; $points[3][3] = $input[$i + 2][$j + 2]; $b2i-&gt;updateCoefficients($points);//  for ($x = 0; $x &lt; $step; $x ++) {//   for ($y = 0; $y &lt; $step; $y ++) { $rx = ($i - 1) * $step + $x;//     $ry = ($j - 1) * $step + $y;//y     $ax = $x / $step;//x - x0 $ay = $y / $step;//y - y0 $val = $b2i-&gt;getValue($ax, $ay);//  $color = ceil(($val) * 1024) - 1;//  if ($color &lt; 0) $color = 0;//   if ($color &gt; 1023) $color = 1023;//   imagesetpixel($img, $rx, $ry, $colormap[$color]);//  } } } } imagepng($img); </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br><br>  Separately made a file to create a color map <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createColormap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$image)</span></span></span><span class="hljs-function"> </span></span>{ $colormap = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">0</span></span>; $i &lt; <span class="hljs-number"><span class="hljs-number">256</span></span>; $i ++) { $colormap[$i] = imagecolorallocate($image, <span class="hljs-number"><span class="hljs-number">0</span></span>, $i, <span class="hljs-number"><span class="hljs-number">255</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">0</span></span>; $i &lt; <span class="hljs-number"><span class="hljs-number">256</span></span>; $i ++) { $colormap[$i + <span class="hljs-number"><span class="hljs-number">256</span></span>] = imagecolorallocate($image, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span> - $i); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">0</span></span>; $i &lt; <span class="hljs-number"><span class="hljs-number">256</span></span>; $i ++) { $colormap[$i + <span class="hljs-number"><span class="hljs-number">512</span></span>] = imagecolorallocate($image, $i, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">0</span></span>; $i &lt; <span class="hljs-number"><span class="hljs-number">256</span></span>; $i ++) { $colormap[$i + <span class="hljs-number"><span class="hljs-number">768</span></span>] = imagecolorallocate($image, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span> - $i, <span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $colormap; }</code> </pre><br><br><h4>  Result of work: </h4><br><img src="http://img143.imageshack.us/img143/3828/interu.png"></div><p>Source: <a href="https://habr.com/ru/post/111402/">https://habr.com/ru/post/111402/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111394/index.html">DRM bypass for some applications in the Mac AppStore</a></li>
<li><a href="../111396/index.html">Hosting Center - brazen extortionists</a></li>
<li><a href="../111398/index.html">Creating Packet Tracer Exercises to Prepare for Cisco Certification</a></li>
<li><a href="../111399/index.html">Configure PPPoE with traffic shaping for a small network</a></li>
<li><a href="../111401/index.html">How to design programs and their user interfaces, or DISC theory for ‚Äúnon-licenses‚Äù</a></li>
<li><a href="../111404/index.html">Answering machine for calls to Skype for Python</a></li>
<li><a href="../111408/index.html">Creating your own archetypes and directories in Maven</a></li>
<li><a href="../111411/index.html">Habr's favorites in PDF</a></li>
<li><a href="../111412/index.html">Excel is my financial auditor</a></li>
<li><a href="../111413/index.html">Molecular Dynamics Programming</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>