<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Exporting data from PostgreSQL to Excel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings to all. 
 When automating small stores to store data, PostgreSQL is often used. And often there is a need to export this data to Excel. In t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Exporting data from PostgreSQL to Excel</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/187/87a/fc0/18787afc0b884bc9b424aad1cf417483.png"><br><br>  Greetings to all. <br>  When automating small stores to store data, PostgreSQL is often used.  And often there is a need to export this data to Excel.  In this article I will tell you how I solved this problem.  Naturally, experienced specialists are unlikely to discover something new.  However, the material will be interesting to those who "swims" in this topic. <br><a name="habracut"></a><br>  So, naturally, the easiest and most trivial way is to export query results data to csv-files, and then open them in Excel.  It looks like this: <br><pre><code class="sql hljs">COPY (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> your_table) <span class="hljs-keyword"><span class="hljs-keyword">TO</span></span> <span class="hljs-string"><span class="hljs-string">'C:/temp/123.csv'</span></span> CSV;</code> </pre> <br><br>  Once, a friend approached me, who needed to get various data from PostgreSQL.  Moreover, requests for data were changing from day to day.  It would seem that the first method could be used safely, but there are significant drawbacks in it: <br><ul><li>  first, the insertion of data from PostgreSQL takes place on the server; </li><li>  secondly, you can of course be confused to write a batch script that will remotely trigger this request on the server, then copy this file to the user's computer and initiate the opening in Excel. </li></ul><br>  But I wanted to speed up the process as quickly as possible, and I found a way. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Steps: <br><br>  1. Follow <a href="http://www.postgresql.org/ftp/odbc/versions/msi/">the link</a> and, depending on the computer's bit depth, download the ODBC installer driver.  Installing it is simple and does not require special knowledge. <br><br>  2. In order for users to cling to the database from their computers, do not forget in the pg_hba.conf file to set parameters for IP addresses from which you can connect: <br><br><img src="https://habrastorage.org/files/668/d73/82b/668d7382b0d34ca5bb58776ddf138391.png"><br><br><br>  In this example, that all workstations will be able to connect to the server from the database: <br><br><img src="https://habrastorage.org/files/f15/917/a91/f15917a91dbc47ee8daca0da7bd31fec.png"><br><br><br>  3. Further, through Excel, we simply generate a dynamic query file for data * .dqy.  Further, this file can simply be changed at its discretion.  You can directly take the following text below, copy it into a notebook and edit it there, saving the * .dqy file.  Enter the file name and the extension dqy.  Select the file type ALL (All files): <br><br><img src="https://habrastorage.org/files/587/aba/e1b/587abae1bd3342d8953840fad6b32540.png"><br><br><pre> <code class="sql hljs">XLODBC 1 DRIVER={PostgreSQL Unicode};DATABASE=your_base;SERVER=192.168.12.12;PORT=5432;UID=postgres;PASSWORD=postgres;SSLmode=disable;ReadOnly=0;Protocol=7.4;FakeOidIndex=0;ShowOidColumn=0;RowVersioning=0;ShowSystemTables=0;ConnSettings=;Fetch=100;Socket=4096;UnknownSizes=0;MaxVarcharSize=255;MaxLongVarcharSize=8190;Debug=0;CommLog=0;Optimizer=0;Ksqo=1;UseDeclareFetch=0;TextAsLongVarchar=1;UnknownsAsLongVarchar=0;BoolsAsChar=1;Parse=0;CancelAsFreeStmt=0;ExtraSysTablePrefixes=dd_;LFConversion=1;UpdatableCursors=1;DisallowPremature=0;TrueIsMinus1=0;BI=0;ByteaAsLongVarBinary=0;UseServerSidePrepare=0;LowerCaseIdentifier=0;GssAuthUseGSS=0;XaOpt=1 <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> your_table</code> </pre><br><br>  DATABASE - indicates the name of the database to which the connection will be made; <br>  SERVER - server address; <br>  PASSWORD - password to connect to the database. <br><br>  Please note that the large text indicates the connection parameters to the database and your database.  You can also configure many connection options. <br><br>  The last line is the query itself.  Next, save the file.  If Microsoft Excel is installed on the computer, then the file will immediately acquire an icon: <br><br><img src="https://habrastorage.org/files/18f/9ea/217/18f9ea2171524960ab8aa9641f52bb82.png"><br><br><br>  When you run the file, a dialog box will appear.  Feel free to click "Enable": <br><br><img src="https://habrastorage.org/files/d43/204/924/d432049248c34bce9fefccd7935a1b4d.png"><br><br><br>  And we get the result of the query from the database: <br><br><img src="https://habrastorage.org/files/917/b91/cee/917b91cee9444bf0ae9cb321afeafdb7.png"><br><br><br>  Now you can create several such files and quietly copy them to the user's desktop: <br><br><img src="https://habrastorage.org/files/542/7fe/e58/5427fee580e14506aa7ccf1c518ee328.png"><br><br><br>  By the way, I went a little further.  Dug up the good old VB6.  You can do this with any programming language.  Made a form that, according to the selected date, requests data from the database, by generating this * .dqy file: <br><img src="https://habrastorage.org/files/ee8/742/c1c/ee8742c1c1f04bdfa39c359059cffba8.png"><br><br><br>  Then a little bit of code (here‚Äôs part of the code): <br><pre> <code class="sql hljs">sq1 = "your_query" Open "report.dqy" For Output As <span class="hljs-comment"><span class="hljs-comment">#1 Print #1, "XLODBC" Print #1, "1" Print #1, "DRIVER={PostgreSQL Unicode};DATABASE=your_db;SERVER=192.168.12.12;PORT=5432;UID=postgres;PASSWORD=postgres;SSLmode=disable;ReadOnly=0;Protocol=7.4;FakeOidIndex=0;ShowOidColumn=0;RowVersioning=0;ShowSystemTables=0;ConnSettings=;Fetch=100;Socket=4096;UnknownSizes=0;MaxVarcharSize=255;MaxLongVarcharSize=8190;Debug=0;CommLog=0;Optimizer=0;Ksqo=1;UseDeclareFetch=0;TextAsLongVarchar=1;UnknownsAsLongVarchar=0;BoolsAsChar=1;Parse=0;CancelAsFreeStmt=0;ExtraSysTablePrefixes=dd_;LFConversion=1;UpdatableCursors=1;DisallowPremature=0;TrueIsMinus1=0;BI=0;ByteaAsLongVarBinary=0;UseServerSidePrepare=0;LowerCaseIdentifier=0;GssAuthUseGSS=0;XaOpt=1" Print #1, sq1 Close #1 Shell "CMD /c report.dqy"</span></span></code> </pre><br><br>  The result was the same - the data from Excel, and the user is comfortable.  By the way, in the line: <br><pre> <code class="sql hljs">DRIVER={PostgreSQL Unicode};</code> </pre><br><br>  if we are talking about a 64-bit processor and an ODBC driver installed for 64 bits, then we need to write: <br><pre> <code class="sql hljs">DRIVER={PostgreSQL Unicode(x64)};</code> </pre><br><br>  Well, and most importantly, despite the simplicity of the method, it certainly has drawbacks: the query can be written only in one line, i.e.  write a string here in this form does not work.  It is necessary only in one: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> un_cg_product</code> </pre><br><br>  - Will not be able to handle on changing data type: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span></code> </pre>  or <pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span></code> </pre><br><br>  Well, it can only display the result of the query in the form of a list, i.e.  A beautiful document can not be done.  That's all.  I hope this way someone come in handy.  I would be happy to receive your recommendations for improving my method or an alternative solution to this problem. </div><p>Source: <a href="https://habr.com/ru/post/245975/">https://habr.com/ru/post/245975/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245961/index.html">How i hacked facebook</a></li>
<li><a href="../245963/index.html">Data center with container</a></li>
<li><a href="../245965/index.html">Migration from Proxmox to VMmanager</a></li>
<li><a href="../245967/index.html">Live webcast IT Pro Community Day December 17</a></li>
<li><a href="../245969/index.html">Deploy4Me reduces prices and fixes them in rubles</a></li>
<li><a href="../245977/index.html">Why data centers need operating systems</a></li>
<li><a href="../245979/index.html">Profile the code with Cach√© Monitor</a></li>
<li><a href="../245981/index.html">Entry to the annual program of the Stratoplan School of Managers is open.</a></li>
<li><a href="../245985/index.html">Simple leaderboard on Unity3D with facebook</a></li>
<li><a href="../245987/index.html">We optimize the page with our own social buttons</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>