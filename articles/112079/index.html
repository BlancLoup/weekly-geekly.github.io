<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Otsu object detection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear harabrachiteli and habrakritiki. I would like to dedicate this post to such an urgent topic today as the detection of objects in images. 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Otsu object detection</h1><div class="post__text post__text-html js-mediator-article">  Hello, dear harabrachiteli and habrakritiki.  I would like to dedicate this post to such an urgent topic today as the detection of objects in images. <br>  As one of the algorithms for such detection, we consider the choice of a threshold by the fast and efficient <b>Otsu method</b> . <br><a name="habracut"></a><br><br><h4>  Introduction </h4><br>  So let's start in order.  In general, the task of detecting objects is to establish the presence in the image of an object that has some specific characteristics. <br><br>  Such a characteristic may be, for example, brightness.  One of the simplest and most natural ways to detect an object (or objects) is the choice of threshold by brightness, or threshold classification (thresholding).  The meaning of this threshold is to separate the image into a light object (foreground) and a dark background (background).  Those.  an object is a collection of those pixels whose brightness exceeds the threshold ( <i>I</i> &gt; <i>T</i> ), and the background is a collection of other pixels whose brightness is below the threshold ( <i>I</i> &lt; <i>T</i> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Thus, the key parameter is the threshold <i>T.</i>  How to choose it? <br><br>  There are dozens of threshold selection methods.  The method invented by the Japanese scientist Nobuyuki Otsu in 1979 is a fast and effective method.  About him that will be discussed further. <br><br><h4>  Otsu method </h4><br>  Suppose there is an 8-bit image for which you want to calculate the threshold <i>T.</i>  In the case of a 24-bit image, it is easy to overtake it into an 8-bit image using a gray cast (grayscale): <br>  <i>I</i> = 0.2125 <i>R</i> + 0.7154 <i>G</i> + 0.0721 <i>B</i> <br><br>  The Otsu's Method uses an image histogram to calculate the threshold.  Let me remind you that a histogram is a set of bins, each of which characterizes the number of sampling elements hit into it.  In our case, the sample is pixels of different brightness, which can take integer values ‚Äã‚Äãfrom 0 to 255. <br><br>  An example of an image with an object: <br><img src="https://habrastorage.org/storage/habraeffect/68/db/68db25aea01ce0142d24b7ea8a57f1e9.jpg"><br><br>  Histogram for this image: <br><img src="https://habrastorage.org/storage/habraeffect/65/f2/65f283989118f93550841238a085de58.png"><br><br>  From the histogram, a person easily sees that there are two clearly separated classes.  The essence of the Otsu method is to set the threshold between classes in such a way that each of them is as dense as possible.  If expressed in mathematical language, it comes down to minimizing the intraclass variance, which is defined as the weighted sum of the variances of the two classes: <br><img src="https://habrastorage.org/storage/habraeffect/4d/c1/4dc1d46d299a331ab04ef28d9712c500.png"><br><br>  Here, <i>w</i> <sub>1</sub> and <i>w</i> <sub>2</sub> are the probabilities of the first and second classes, respectively. <br><br>  In his work, Otsu shows that minimizing the intraclass dispersion is equivalent to maximizing <b>between</b> class variance, which is equal to: <br><img src="https://habrastorage.org/storage/habraeffect/e6/f6/e6f6cad7bd13b5f3396742b5d809993a.png"><br><br>  In this formula, <i>a</i> <sub>1</sub> and <i>a</i> <sub>2</sub> are the arithmetic mean values ‚Äã‚Äãfor each of the classes. <br><br>  The peculiarity of this formula is that <i>w</i> <sub>1</sub> ( <i>t</i> + 1), <i>w</i> <sub>2</sub> ( <i>t</i> + 1), <i>a</i> <sub>1</sub> ( <i>t</i> + 1), <i>a</i> <sub>2</sub> ( <i>t</i> + 1) are easily expressed through previous values ‚Äã‚Äãof <i>w</i> <sub>1</sub> ( <i>t</i> ), <i>w</i> <sub>2</sub> ( <i>t</i> ), <i>a</i> <sub>1</sub> ( <i>t</i> ), <i>a</i> <sub>2</sub> ( <i>t</i> ) ( <i>t</i> is the current threshold).  This feature allowed us to develop a fast algorithm: <br><ol><li>  Calculate the histogram (one pass through an array of pixels).  Further only the histogram is necessary;  passes through the entire image is no longer required. </li><li>  Starting from the threshold <i>t</i> = 1, we go through the entire histogram, recalculating the variance <i>œÉ</i> <sub><i>b</i></sub> ( <i>t</i> ) at each step.  If at some of the steps the variance is greater than the maximum, then the variance is updated and <i>T</i> = <i>t</i> . </li><li>  The required threshold is <i>T.</i> </li></ol><br>  Naturally, this is only a general description of the algorithm.  In the exact implementation you can make a lot of optimizations.  For example, a passage through a histogram can (and should) be done not from 1 to 254, but from minimum to maximum brightness minus one.  At the end, the implementation in C ++ will be given taking into account some of these optimizations. <br><br>  Here is the result of the implementation of the above algorithm: <br><img src="https://habrastorage.org/storage/habraeffect/0e/e6/0ee6e4a7d5f8103d5b5de20bab3d7e95.jpg"><br><br>  Calculated threshold: <br><img src="https://habrastorage.org/storage/habraeffect/13/71/1371f447aa2ce525862012793b56bbbc.png"><br><br><h4>  Real example </h4><br>  Besides the artificially generated example, I would also like to show the real <br>  use method. <br><br>  In my current thesis, the localization of the barcode on the image is required: <br><img src="https://habrastorage.org/storage/habraeffect/72/fa/72faf847ab2974924b053dd6d7285f22.jpg"><br><br>  Before you use the Otsu method, you need to do preprocessing to somehow take into account the features of the structure of a one-dimensional bar code.  If it is not done, the method simply will not do anything.  The peculiarity of the bar code structure is that it consists of vertical stripes, and therefore has large horizontal derivatives and small vertical ones.  Therefore, if we take the image as the difference between the horizontal and vertical derivatives, and then apply the averaging filter, we get this: <br><img src="https://habrastorage.org/storage/habraeffect/3f/35/3f359e2881ae3575acc74280ee97ca7f.jpg"><br><br>  Not bad, huh?  The barcode image is clearly visible on the image and is distinguished by a much higher brightness compared with the surrounding objects.  Now we can safely apply the Otsu method: <br><img src="https://habrastorage.org/storage/habraeffect/15/45/1545f9dc9a69cab1567047291812947e.png"><br><br>  The result was a properly localized barcode. <br><br><h4>  C ++ implementation </h4><br>  Well, as I promised, the implementation of the calculation of the threshold by the Otsu method in C ++ with comments: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; //     <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { //   NULL  . ,   <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> //    <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> //        <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } //        min  max, <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> //       256  <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; //    <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; //     <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; //    : <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> //  alpha2  , ..   m - alpha1 <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> //  beta2  , ..   n - alpha1 <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> // t       <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; //    1. <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; //  ,  w2   , ..   1 - w1 <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> // a = a1 - a2,  a1, a2 -     1  2 <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); // ,  sigma <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; //  sigma   ,   maxSigma   <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } //  ,     min,     threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; // ,  ,    :) <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">typedef unsigned char</font> imageInt; <font color="#008000">//    </font> <font color="#0000ff">int</font> otsuThreshold(imageInt *image, <font color="#0000ff">int</font> size) { <font color="#008000">//   NULL  . ,  </font> <font color="#008000">//   </font> <font color="#008000">//       </font> <font color="#0000ff">int</font> min = image[0]; <font color="#0000ff">int</font> max = image[0]; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 1; i &lt; size; i++) { <font color="#0000ff">int</font> <font color="#0000ff">value</font> = image[i]; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &lt; min) min = <font color="#0000ff">value</font> ; <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> &gt; max) max = <font color="#0000ff">value</font> ; } <font color="#008000">//        min  max,</font> <font color="#008000">//       256 </font> <font color="#0000ff">int</font> histSize = max - min + 1; <font color="#0000ff">int</font> * hist = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [histSize]; <font color="#008000">//   </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; histSize; t++) hist[t] = 0; <font color="#008000">//    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) hist[image[i] - min]++; <font color="#008000">//    :</font> <font color="#0000ff">int</font> m = 0; <font color="#008000">// m -    ,     </font> <font color="#0000ff">int</font> n = 0; <font color="#008000">// n -    </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt;= max - min; t++) { m += t * hist[t]; n += hist[t]; } <font color="#0000ff">float</font> maxSigma = -1; <font color="#008000">//    </font> <font color="#0000ff">int</font> threshold = 0; <font color="#008000">// ,  maxSigma</font> <font color="#0000ff">int</font> alpha1 = 0; <font color="#008000">//       1</font> <font color="#0000ff">int</font> beta1 = 0; <font color="#008000">//       1,     </font> <font color="#008000">//  alpha2  , ..   m - alpha1</font> <font color="#008000">//  beta2  , ..   n - alpha1</font> <font color="#008000">// t      </font> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> t = 0; t &lt; max - min; t++) { alpha1 += t * hist[t]; beta1 += hist[t]; <font color="#008000">//    1.</font> <font color="#0000ff">float</font> w1 = ( <font color="#0000ff">float</font> )beta1 / n; <font color="#008000">//  ,  w2   , ..   1 - w1</font> <font color="#008000">// a = a1 - a2,  a1, a2 -     1  2</font> <font color="#0000ff">float</font> a = ( <font color="#0000ff">float</font> )alpha1 / beta1 - ( <font color="#0000ff">float</font> )(m - alpha1) / (n - beta1); <font color="#008000">// ,  sigma</font> <font color="#0000ff">float</font> sigma = w1 * (1 - w1) * a * a; <font color="#008000">//  sigma   ,   maxSigma  </font> <font color="#0000ff">if</font> (sigma &gt; maxSigma) { maxSigma = sigma; threshold = t; } } <font color="#008000">//  ,     min,    </font> threshold += min; <font color="#008000">// ,  ,    :)</font> <font color="#0000ff">return</font> threshold; }</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><h4>  Conclusion </h4><br>  So, we have examined the use of the Otsu method for detecting objects in images.  The advantages of this method are: <ol><li>  Ease of implementation. </li><li>  The method adapts well to various kinds of images, choosing the most optimal threshold. </li><li>  Fast lead time.  <i>O</i> ( <i>N</i> ) operations are required, where <i>N</i> is the number of pixels in the image. </li><li>  The method has no parameters, just take it and apply it.  In MatLab, this function is graythresh () with no arguments (Why did I give an example of MatLab? Simply, this tool is the de facto standard for image processing). </li></ol>  Disadvantages: <br><ol><li>  By itself, threshold binarization is sensitive to uneven image brightness.  The solution to this problem may be the introduction of local thresholds, instead of one global. </li></ol><br><h4>  Sources </h4><ol><li>  Otsu, N., ‚ÄúA Threshold Selection Method from Gray-Level Histograms,‚Äù IEEE Transactions on Systems, Man, and Cybernetics, Vol.  9, No.  1, 1979, pp.  62-66. </li><li>  <a href="http://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%259E%25D1%2586%25D1%2583">Wikipedia</a> </li><li>  <a href="http://homepages.inf.ed.ac.uk/rbf/CVonline/LOCAL_COPIES/MORSE/threshold.pdf">Notes of the lecturer (English)</a> </li><li>  <a href="http://users.soe.ucsc.edu/~orazio/barcodes.html">Website for people who have come up with an effective UPC barcode recognition algorithm (eng.)</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/112079/">https://habr.com/ru/post/112079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../112072/index.html">Chinas work MTS</a></li>
<li><a href="../112073/index.html">Nekto.me - anonymous comment service</a></li>
<li><a href="../112074/index.html">3D without glasses</a></li>
<li><a href="../112077/index.html">Cookies inside the iframe - a problem when creating the application VKontakte / Facebook</a></li>
<li><a href="../112078/index.html">Results of CES 2011 from Samsung</a></li>
<li><a href="../112080/index.html">Automate routine in Microsoft Excel using VBA</a></li>
<li><a href="../112081/index.html">Vogue-Tec News # 1</a></li>
<li><a href="../112083/index.html">Modern web forms: some more subtleties</a></li>
<li><a href="../112084/index.html">W3C introduced the HTML5 logo</a></li>
<li><a href="../112088/index.html">rospil.info and ruleaks.net underwent a DOS attack</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>