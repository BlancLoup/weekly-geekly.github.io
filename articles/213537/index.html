<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Encrypted communication tunnel via VK (RSA + GreaseMonkey)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In connection with recent developments in the world, network users are increasingly thinking about their security: someone refuses to use a number of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Encrypted communication tunnel via VK (RSA + GreaseMonkey)</h1><div class="post__text post__text-html js-mediator-article">  In connection with recent developments in the world, network users are increasingly thinking about their security: someone refuses to use a number of web services, someone deletes personal information, photos and other data from social networks, and someone does Blocks "their accounts.  But only the majority of these data are deleted only <i>visually</i> , which is, in principle, a well-known fact. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/447/ef4/b3a/447ef4b3af59ac5f7c32e88506efe763.png" alt="image"></div><br>  Since a significant part of my acquaintances are people who do not have sufficient knowledge in the field of IT, then they have to do their best to make them use unusual services or utilities that I consider safe. <br>  I offer a relatively simple way to install a <i>secure</i> channel for text communication through the well-known VK network.  To do this, do not need any additional software or extensive knowledge in the field of information security.  All you need to have is a web browser and a GreaseMonkey addon. <br><a name="habracut"></a><br><h4>  general information </h4><br>  The motive of this method is to create a channel managed by interlocutors without an intermediary, i.e.  Do not allow the server to see unencrypted text messages.  Of course, a typical man-in-the-middle attack by substitution of the public key is quite possible, but very unlikely, since we are afraid not of <i>listening in real time</i> , but of the <i>potential danger of compromising the text of messages</i> in the near future, for example, at the request of special services. <br>  As I said above, the idea was to create your own messenger <s>(well, you understand, with what)</s> .  Why?  Of a couple of reasons: <br><ul><li>  My friends and I can trust my product; </li><li>  I can make it what I want; </li><li>  It's fun! </li></ul><br>  But through some difficulties, among which - both product development and its introduction among non-programmers.  Therefore, VKontakte was definitely chosen as the subject of these perversions, and the <a href="http://ru.wikipedia.org/wiki/Greasemonkey">GreaseMonkey</a> addon became the platform for implementing the final product: <br><ul><li>  Most friends use exactly VKontakte; </li><li>  It's pretty easy to explain the process of unfolding my script. </li></ul><br><br><h4>  Some well-known technical data. </h4><br>  Based on the audience for which this article is intended, I will not explain the installation process of GreaseMonkey and my script.  If you do not know how to do it - read the manual, for example, <a href="http://softlakecity.ru/browsers/firefox/greasemonkey">here</a> (thanks <a href="https://habrahabr.ru/users/google/" class="user_link">google</a> for this link). <br><br>  As the encryption mechanism, of course, the unique RSA in the standard implementation is selected.  There is no point in explaining this mechanism either, since the article is not about it, but about automating this process, but, just in case, two-way asymmetric encryption looks like this: <br><ul><li>  <b>The interlocutors exchange public keys.</b>  This process is automated by our script. </li><li>  <b>One of the interlocutors sends a message.</b>  This message is encrypted with the partner‚Äôs public (public) key. </li><li>  <b>The other one gets this message.</b>  This message is decrypted by its private (private) key. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The process in the picture: <br><img src="https://habrastorage.org/getpro/habr/post_images/663/758/50d/66375850dc9eb8c18ad316dea891051e.jpg" alt="image"><br><br>  To implement the RSA algorithm, I used its JS implementation, written by the <a href="http://www-cs-students.stanford.edu/~tjw/jsbn/">guys from Stanford</a> .  She was one of the first that caught my eye, and perfectly met all my expectations, so I used it. <br><br><h4>  Closer to the point </h4><br>  So what does the script do? <br><ul><li> Introduces itself to the VK page when it is opened, and patches the document, adding an event to pressing <code>CTRL+SHIFT+V</code> ; </li><li>  By pressing the last combination adds buttons to send encrypted messages and generate a public key for a partner; </li><li>  It responds to messages like <code>"%n:__"</code> and <code>"%m:_"</code> message <code>"%m:_"</code> , replacing them with notifications about the fact of receiving the public key from the partner or the decrypted text. </li><li>  Patch DOM elements with their attributes with the prefix "vksl-" to save their state. </li></ul><br><br><h4>  Brief instruction </h4><br>  When you open the chat page in the upper right corner, the message ‚ÄúVKSL loaded‚Äù should appear (you may have to press F5 if you moved from another page).  Pressing <code>CTRL+SHIFT+V</code> on the page with the chat, again we get a message about the successful (or unsuccessful) injection of the encoder into the page code. <br>  After that, each of the interlocutors must click on the link <u>"GENERATE KEYS NOW"</u> .  After a few (perhaps tens) seconds, a message will appear that the key has been generated and sent.  Consequently, the interlocutor at the other end will also be notified of this. <br>  Now you can begin to communicate.  To send a normal message, use the standard button, to send an encrypted message, click on <b>‚ÄúSEND ENCRYPTED‚Äù</b> .  The script at the other end will understand what to do if an encrypted message is received. <br><br><h4>  Problems that have so far been too lazy to fix (and should) </h4><br><ul><li>  The script does not work in conferences, and is designed only for two-way communication. </li><li>  The maximum length of the message at the moment is only 32 bytes - you need to encrypt it, breaking the text into blocks, and not like it is now. </li><li>  By clicking on "Enter" is called the native send.  It takes a little more digging through the code to replace this event as well. </li><li>  Attachments are not encrypted because they are not actually part of the message. </li></ul><br><br>  You can install the script from here: <a href="http://userscripts.org/scripts/show/396094">http://userscripts.org/scripts/show/396094</a> <br>  Thank you for your attention! <br><br>  <b>EDIT:</b> I apologize for the many spelling mistakes that readers kindly paid my attention to.  It seems that everything is fixed. </div><p>Source: <a href="https://habr.com/ru/post/213537/">https://habr.com/ru/post/213537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213523/index.html">DdTypograph 2.0b snippet on EMT lib 3.2 (MODX Evo)</a></li>
<li><a href="../213525/index.html">Adam Langley explained the reasons for the bug in iOS: an extra line of code broke all security</a></li>
<li><a href="../213527/index.html">The history of game consoles in advertising. Part 1: From Magnavox Odyssey to Super Nintendo</a></li>
<li><a href="../213529/index.html">Challenge for $ 500. Part two, about money</a></li>
<li><a href="../213531/index.html">Vsem Pro Server or VPS Large-Scale Testing</a></li>
<li><a href="../213539/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ97 (February 16 - 22, 2014)</a></li>
<li><a href="../213541/index.html">NetBeans IDE 8.0 Beta released</a></li>
<li><a href="../213545/index.html">War Space</a></li>
<li><a href="../213549/index.html">Box2d: Collision Anatomy</a></li>
<li><a href="../213551/index.html">[User experience] Audio-Technica ANC7b - full immersion</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>