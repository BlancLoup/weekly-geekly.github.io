<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tutorial: Creating a simple 2D game on Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This tutorial is intended primarily for beginners in the development of an android, but may be useful to more experienced developers. Here it is told ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tutorial: Creating a simple 2D game on Android</h1><div class="post__text post__text-html js-mediator-article">  This tutorial is intended primarily for beginners in the development of an android, but may be useful to more experienced developers.  Here it is told how to create the simplest 2D game on an anroid without using any game engines.  For this, I used Android Studio, but you can use any other appropriate customized development environment. <br><br>  <b>Step 1. Come up with the idea of ‚Äã‚Äãthe game.</b> <br>  For example, take a fairly simple idea: <br><br>  At the bottom of the screen - the spacecraft.  He can move left and right by pressing the corresponding buttons.  Asteroids move vertically down from above.  They appear across the entire width of the screen and move at different speeds.  The ship must dodge meteorites as long as possible.  If a meteorite hits it - the game is over. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/web/b7c/bef/10b/b7cbef10bcea4ff1a4a6e07a9b7305cc.jpeg"><br><a name="habracut"></a><br>  <b>Step 2. Create a project</b> <br>  In Android Studio, in the top menu, select File ‚Üí New ‚Üí New Project. <br><br><img src="https://habrastorage.org/web/cc2/1a0/089/cc21a0089de948a28dbb30165053899b.png"><br><br>  Here we enter the application name, domain and path.  Click Next. <br><br><img src="https://habrastorage.org/web/56f/3a0/0ac/56f3a00ac86f4c5c88aac111f51dc2ef.png"><br><br>  Here you can enter the version of android.  You can also choose an Android watch and a TV.  But I'm not sure that our application will work on all this.  So it is better to enter everything as in the screenshot.  Click Next. <br><br><img src="https://habrastorage.org/web/539/d51/85f/539d5185f5ef48d7b7797122dbf027a2.png"><br><br>  Here we must choose Empty Activity.  And click Next. <br><br><img src="https://habrastorage.org/web/23a/318/4bf/23a3184bfa384fb493b2889aaffa0555.png"><br><br>  Here we leave everything as it is and click Finish.  So the project is created.  Go to the third step. <br><br>  <b>Step 3. Add pictures</b> <br><br>  Download the <a href="https://drive.google.com/file/d/0B053Cq6-zmFQbUhEQWY3NEp2REE/view%3Fusp%3Dsharing">archive</a> with pictures and unpack it. <br><br>  Find the drawable folder and copy the pictures there. <br><br><img src="https://habrastorage.org/web/f94/284/1b4/f942841b44a9493a93224b25667066aa.png"><br><br>  Later we will need them. <br><br>  <b>Step 4. Create layout</b> <br><br>  Find activity_main.xml, open the Text tab and paste it there: <br><br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:context</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.spaceavoider.spaceavoider.MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/gameLayout"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/leftButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Left"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/rightButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Right"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  On the Design tab you can see how our layout will look. <br><br><img src="https://habrastorage.org/web/4d0/776/f6b/4d0776f6ba1748b8be61fc8f2458483e.png"><br><br>  At the top there is a field in which the game itself will be, and at the bottom are the Left and Right control buttons.  About the layout, you can write a separate article, and not one.  I will not dwell on this in detail.  About this you can read <a href="http://developer.alexanderklimov.ru/android/theory/layout.php">here</a> . <br><br>  <b>Step 5. Edit the MainActivity class</b> <br><br>  First of all, we add implements View.OnTouchListener to the class definition.  The class definition will now be: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnTouchListener</span></span></span><span class="hljs-class"> </span></span>{</code> </pre> <br>  Add to the class we need static variables (class variables): <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> isLeftPressed = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    public static boolean isRightPressed = false; //   </span></span></code> </pre> <br>  To procedure protected void onCreate (Bundle savedInstanceState) { <br>  add lines: <br><br><pre> <code class="java hljs">GameView gameView = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  gameView LinearLayout gameLayout = (LinearLayout) findViewById(R.id.gameLayout); //  gameLayout gameLayout.addView(gameView); //     gameView Button leftButton = (Button) findViewById(R.id.leftButton); //   Button rightButton = (Button) findViewById(R.id.rightButton); leftButton.setOnTouchListener(this); //       (   onTouch) rightButton.setOnTouchListener(this);</span></span></code> </pre> <br>  Classes LinearLayout, Button, etc.  are highlighted in red because they have not yet been added to Import. <br>  To add to Import and remove the red highlight, you need to press Alt + Enter for everyone. <br>  GameView will be highlighted in red because this class is not yet.  We will create it later. <br><br>  Now add the procedure: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTouch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View button, MotionEvent motion)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(button.getId()) { <span class="hljs-comment"><span class="hljs-comment">//    case R.id.leftButton: switch (motion.getAction()) { //     case MotionEvent.ACTION_DOWN: isLeftPressed = true; break; case MotionEvent.ACTION_UP: isLeftPressed = false; break; } break; case R.id.rightButton: switch (motion.getAction()) { //     case MotionEvent.ACTION_DOWN: isRightPressed = true; break; case MotionEvent.ACTION_UP: isRightPressed = false; break; } break; } return true; }</span></span></code> </pre> <br>  If someone gets confused - this is how the MainActivity class should look like as a result: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.spaceavoider.spaceavoider; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.MotionEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.LinearLayout; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnTouchListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> isLeftPressed = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    public static boolean isRightPressed = false; //    @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); GameView gameView = new GameView(this); //  gameView LinearLayout gameLayout = (LinearLayout) findViewById(R.id.gameLayout); //  gameLayout gameLayout.addView(gameView); //     gameView Button leftButton = (Button) findViewById(R.id.leftButton); //   Button rightButton = (Button) findViewById(R.id.rightButton); leftButton.setOnTouchListener(this); //       (   onTouch) rightButton.setOnTouchListener(this); } public boolean onTouch(View button, MotionEvent motion) { switch(button.getId()) { //    case R.id.leftButton: switch (motion.getAction()) { //     case MotionEvent.ACTION_DOWN: isLeftPressed = true; break; case MotionEvent.ACTION_UP: isLeftPressed = false; break; } break; case R.id.rightButton: switch (motion.getAction()) { //     case MotionEvent.ACTION_DOWN: isRightPressed = true; break; case MotionEvent.ACTION_UP: isRightPressed = false; break; } break; } return true; } }</span></span></code> </pre> <br>  So, the MainActivity class is ready!  It has initiated a not yet created GameView class.  And when the left button is pressed - the static variable isLeftPressed = true, and when the right button isRightPressed = true.  In general, this is all that he does. <br><br>  To begin with, we will do so that the spacecraft is displayed on the screen, and that it moves by pressing the control buttons.  Asteroids leave for later. <br><br>  <b>Step 6. Create a GameView Class</b> <br><br>  Now finally create the same missing class GameView.  So let's get started.  In the class definition, add extends SurfaceView implements Runnable.  Mobile devices have different screen resolutions.  This may be an old small phone with a resolution of 480x800, or a large tablet 1800x2560.  In order for the game to look the same on all devices, I divided the screen into 20 parts horizontally and 28 vertically.  I called the obtained unit of measure unit.  You can select other numbers.  The main thing is that the relationship between them is approximately preserved, otherwise the image will be stretched or compressed. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> maxX = <span class="hljs-number"><span class="hljs-number">20</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    public static int maxY = 28; //    public static float unitW = 0; //      public static float unitH = 0; //     </span></span></code> </pre> <br>  unitW and unitW we will calculate later.  We will also need other variables: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> firstTime = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> gameRunning = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Ship ship; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Thread gameThread = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Paint paint; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Canvas canvas; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SurfaceHolder surfaceHolder;</code> </pre> <br>  The constructor will be: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(context); <span class="hljs-comment"><span class="hljs-comment">//    surfaceHolder = getHolder(); paint = new Paint(); //   gameThread = new Thread(this); gameThread.start(); }</span></span></code> </pre> <br>  The run () method will contain an infinite loop.  At the beginning of the loop, the update () method is executed. <br>  which will calculate the new coordinates of the ship.  Then the draw () method draws the ship on the screen.  And at the end the control () method will pause for 17 milliseconds.  After 17 milliseconds, run () will start again.  And so on until the gameRunning variable == true.  These methods are: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (gameRunning) { update(); draw(); control(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!firstTime) { ship.update(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (surfaceHolder.getSurface().isValid()) { <span class="hljs-comment"><span class="hljs-comment">//   surface if(firstTime){ //     firstTime = false; unitW = surfaceHolder.getSurfaceFrame().width()/maxX; //      unitH = surfaceHolder.getSurfaceFrame().height()/maxY; ship = new Ship(getContext()); //   } canvas = surfaceHolder.lockCanvas(); //  canvas canvas.drawColor(Color.BLACK); //    ship.drow(paint, canvas); //   surfaceHolder.unlockCanvasAndPost(canvas); //  canvas } } private void control() { //   17  try { gameThread.sleep(17); } catch (InterruptedException e) { e.printStackTrace(); } }</span></span></code> </pre> <br>  Pay attention to initialization when you first start.  There we calculate the number of pixels in a unit and add the ship.  The ship we have not created.  But before we create its parent class. <br><br>  <b>Step 7. Create a SpaceBody class</b> <br><br>  It will be the parent for the class Ship (spacecraft) and Asteroid (asteroid).  It will contain all the variables and methods common to these two classes.  Adding variables: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> x; <span class="hljs-comment"><span class="hljs-comment">//  protected float y; protected float size; //  protected float speed; //  protected int bitmapId; // id  protected Bitmap bitmap; // </span></span></code> </pre> <br>  and methods <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      Bitmap cBitmap = BitmapFactory.decodeResource(context.getResources(), bitmapId); bitmap = Bitmap.createScaledBitmap( cBitmap, (int)(size * GameView.unitW), (int)(size * GameView.unitH), false); cBitmap.recycle(); } void update(){ //      } void drow(Paint paint, Canvas canvas){ //   canvas.drawBitmap(bitmap, x*GameView.unitW, y*GameView.unitH, paint); }</span></span></code> </pre> <br>  <b>Step 8. Create the Ship class</b> <br><br>  Now create a class Ship (spacecraft).  It inherits the SpaceBody class, so add the extends SpaceBody to the class definition. <br><br>  Let's write a constructor: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ship</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ bitmapId = R.drawable.ship; <span class="hljs-comment"><span class="hljs-comment">//    size = 5; x=7; y=GameView.maxY - size - 1; speed = (float) 0.2; init(context); //   }</span></span></code> </pre> <br>  and override the update () method <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//        if(MainActivity.isLeftPressed &amp;&amp; x &gt;= 0){ x -= speed; } if(MainActivity.isRightPressed &amp;&amp; x &lt;= GameView.maxX - 5){ x += speed; } }</span></span></code> </pre> <br>  On this space ship is ready!  All compile and run.  A spacecraft should appear on the screen.  When you press the buttons, it should move to the right and left.  Now add the asteroids flowing above.  When confronted with a ship, the game ends. <br><br>  <b>Step 9. Create the Asteroid class</b> <br><br>  Add the class Asteroid (asteroid).  It also inherits the SpaceBody class, so add the extends SpaceBody to the class definition. <br><br>  Add the variables we need: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> radius = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  private float minSpeed = (float) 0.1; //   private float maxSpeed = (float) 0.5; //  </span></span></code> </pre> <br>  The asteroid should appear at a random point at the top of the screen and fly down at a random speed.  To do this, x and speed are set using a random number generator in its constructor. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Asteroid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ Random random = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(); bitmapId = R.drawable.asteroid; y=<span class="hljs-number"><span class="hljs-number">0</span></span>; x = random.nextInt(GameView.maxX) - radius; size = radius*<span class="hljs-number"><span class="hljs-number">2</span></span>; speed = minSpeed + (maxSpeed - minSpeed) * random.nextFloat(); init(context); }</code> </pre> <br>  The asteroid must move with a certain speed vertically downwards.  Therefore, in the update () method, we add velocity to the x coordinate. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ y += speed; }</code> </pre> <br>  We also need a method that determines whether the asteroid collided with the ship. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isCollision</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shipX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shipY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shipSize)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !(((x+size) &lt; shipX)||(x &gt; (shipX+shipSize))||((y+size) &lt; shipY)||(y &gt; (shipY+shipSize))); }</code> </pre> <br>  Consider it in more detail.  For simplicity, we consider the ship and the asteroid squares.  Here I went from the opposite.  That is, I determine when the squares do NOT intersect. <br><br>  ((x + size) &lt;shipX) - the ship to the left of the asteroid. <br>  (x&gt; (shipX + shipSize)) - the ship to the right of the asteroid. <br>  ((y + size) &lt;shipY) - the ship on top of the asteroid. <br>  (y&gt; (shipY + shipSize)) - the ship from the bottom of the asteroid. <br><br>  Between these four expressions is ||  (or).  That is, if at least one expression is true (and this means that the squares do NOT intersect) - the resulting ones are also true. <br><br>  I invert all this expression with a sign !.  As a result, the method returns true when the squares intersect.  What we need. <br><br>  About the definition of the intersection of more complex shapes can be read <a href="https://habrahabr.ru/sandbox/108362/">here</a> . <br><br>  <b>Step 10. Add asteroids to GameView</b> <br><br>  Add variables to GameView: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ArrayList&lt;Asteroid&gt; asteroids = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-comment"><span class="hljs-comment">//     private final int ASTEROID_INTERVAL = 50; //      ( ) private int currentTime = 0;</span></span></code> </pre> <br>  also add 2 methods: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkCollision</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//             for (Asteroid asteroid : asteroids) { if(asteroid.isCollision(ship.x, ship.y, ship.size)){ //   gameRunning = false; //   // TODO    } } } private void checkIfNewAsteroid(){ //  50     if(currentTime &gt;= ASTEROID_INTERVAL){ Asteroid asteroid = new Asteroid(getContext()); asteroids.add(asteroid); currentTime = 0; }else{ currentTime ++; } }</span></span></code> </pre> <br>  And in the run () method, we add calls to these methods before the control () call. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (gameRunning) { update(); draw(); checkCollision(); checkIfNewAsteroid(); control(); } }</code> </pre> <br>  Next, in the update () method, we add a loop that goes through all the asteroids and calls the update () method on them. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!firstTime) { ship.update(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Asteroid asteroid : asteroids) { asteroid.update(); } } }</code> </pre> <br>  The same loop is added to the draw () method. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (surfaceHolder.getSurface().isValid()) { <span class="hljs-comment"><span class="hljs-comment">//   surface if(firstTime){ //     firstTime = false; unitW = surfaceHolder.getSurfaceFrame().width()/maxX; //      unitH = surfaceHolder.getSurfaceFrame().height()/maxY; ship = new Ship(getContext()); //   } canvas = surfaceHolder.lockCanvas(); //  canvas canvas.drawColor(Color.BLACK); //    ship.drow(paint, canvas); //   for(Asteroid asteroid: asteroids){ //   asteroid.drow(paint, canvas); } surfaceHolder.unlockCanvasAndPost(canvas); //  canvas } }</span></span></code> </pre> <br>  That's all!  The simplest 2D game is ready.  Compile, run and see what happened! <br>  If someone is confused or something does not work, you can download the <a href="https://drive.google.com/file/d/0B053Cq6-zmFQdllOcVgyd1NfRms/view%3Fusp%3Dsharing">source</a> . <br><br>  The game, of course, is primitive.  But it can be improved by adding new features.  The first step is to implement the removal of asteroids that have flown off the screen.  You can make the ship could shoot asteroids, so that the game gradually accelerated, add a timer, a table of records and so on.  If this is interesting to you, I will write a sequel, where I will describe all this. <br><br>  That's all.  Write reviews, questions, topics that interest you to continue. </div><p>Source: <a href="https://habr.com/ru/post/330686/">https://habr.com/ru/post/330686/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330676/index.html">Client-server step-by-step, from single-threaded to multi-threaded (Client-Server step by step)</a></li>
<li><a href="../330678/index.html">SPL programming language - an example of solving a problem</a></li>
<li><a href="../330680/index.html">Estimation of aging parameters using wearable electronics. Lecture in Yandex</a></li>
<li><a href="../330682/index.html">Create a dynamic VKontakte cover.</a></li>
<li><a href="../330684/index.html">The use of national languages ‚Äã‚Äãin SPL programming</a></li>
<li><a href="../330690/index.html">Optimization of combinatorial algorithms</a></li>
<li><a href="../330692/index.html">Idiomatic Redux: Redo's Tao, Part 1 - Realization and Design</a></li>
<li><a href="../330694/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ266 (June 5 - 11, 2017)</a></li>
<li><a href="../330696/index.html">PHP Digest number 110 - the latest news, materials and tools (May 28 - June 11, 2017)</a></li>
<li><a href="../330702/index.html">SQL Server Integration Services (SSIS) for Beginners - Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>