<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Search for faces based on hidden Markov models</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the moment, there is an avalanche increase in the number of multimedia resources, in particular images. As a result, the requirements for the means...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Search for faces based on hidden Markov models</h1><div class="post__text post__text-html js-mediator-article">  At the moment, there is an avalanche increase in the number of multimedia resources, in particular images.  As a result, the requirements for the means of organizing and searching for such resources are increasing.  Most of the currently existing systems <br>  carrying out the search for information on the description (English Description-Based Image Retrieval, DBIR), can no longer fully meet human needs.  Therefore, an increasing interest in searching for objects in content (English Content-Based Image Retrieval, CBIR). <br><br>  It should be noted that in many areas of the user has to deal with images of human faces: from the rapidly developing social networks and ending with the field of forensics.  And although the general methods of search and classification are applicable to this task, it requires a higher accuracy of the solution.  Such a requirement is explained, by and large, by the complexity of the structure of the face itself and the many details that make it difficult to identify common types of faces (moles, hairstyles, facial hair, etc.).  It is quite natural that the requirement for accuracy of the result leads to an increase in the computational costs of search and face recognition algorithms. <br><a name="habracut"></a><br>  There are quite a number of methods that allow you to process images of individuals: the method of own faces, neural networks, etc.  Among them are algorithms based on hidden Markov models.  This method shows one of the highest results in the tasks of facial recognition. <br><br><h5>  Hidden Markov Models </h5><br>  Before proceeding to the consideration of models, consider what constitutes a Markov chain (Markov process).  A sequence of random variables <i>X</i> <sub>n</sub> is called a <i>Markov chain</i> if: <br>  <i>P (X <sub>n</sub> = a | X <sub>n-1</sub> = b, X <sub>n-2</sub> = c, ..., X <sub>0</sub> = x) = P (X <sub>n</sub> | X = b)</i> . <br>  It is proved that Markov chains allow you to create fairly simple and informative pictures.  You can, for example, draw a weighted directed graph with a node for each state and a weighting factor on each edge indicating the probability of transition between states: <br><img src="https://habrastorage.org/storage/habraeffect/67/c8/67c8b89d7a6dfef98a07b725b8f8a33f.png" alt="image"><br>  When observing a random variable <i>X</i> <sub><i>n,</i></sub> it is known what state the chain is in.  This model, unfortunately, is too limited and it is not able to solve many actual problems.  A more perfect model can be obtained by assuming that for each element of the sequence there is a different random variable, the probability distribution of which depends on the state of the chain - there is some variable <i>Y</i> <sub><i>n</i></sub> , and the probability distribution at some point <i>P (Y</i> <sub><i>n</i></sub> <i>| X</i> <sub><i>n</i></sub> <i>= s</i> <sub><i>i</i></sub> <i>) = q</i> <sub><i>i</i></sub> <i>(Y</i> <sub><i>n</i></sub> <i>)</i> .  These elements can be collected in the matrix <i>Q.</i>  Models of this kind are called <i>hidden Markov models (SMM)</i> .  To specify the SMM, it is required to provide a transition between states, a relationship between a state and a probability distribution. <br>  <i>Y</i> <sub><i>n</i></sub> , and also know the initial distribution of states. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Consider the formal description of the hidden Markov model.  Each model is determined by the following parameters: <br><ul><li>  The set <i>S = {s</i> <sub><i>1</i></sub> <i>, s</i> <sub><i>2</i></sub> <i>, ..., s</i> <sub><i>N</i></sub> <i>}</i> of N states. </li><li>  The initial probability distribution is <i>P = {p</i> <sub><i>i</i></sub> <i>}</i> . </li><li>  Matrix of transition probabilities between states <i>A = {a</i> <sub><i>i</i></sub> <i>}</i> . </li><li>  The matrix of the probability of generating observations is <i>B = {b</i> <sub><i>j</i></sub> <i>(O</i> <sub><i>t</i></sub> <i>)</i> <i>}</i> , where <i>b</i> <sub><i>j</i></sub> <i>(O</i> <sub><i>t</i></sub> <i>)</i> is the probability of generating the observation <i>O</i> <sub><i>t</i></sub> at the moment of time <i>t</i> in the state <i>q</i> <sub><i>t</i></sub> <i>= s</i> <sub><i>j</i></sub> , <i>b</i> <sub><i>j</i></sub> <i>(O</i> <sub><i>t</i></sub> <i>) = P (O</i> <sub><i>t</i></sub> <i>| q</i> <sub><i>t</i></sub> <i>= s</i> <sub><i>j</i></sub> <i>)</i> . </li></ul>  It is important to note that the considered model is one-dimensional.  There are also multidimensional Markov models (pseudo-multidimensional SMM).  In the framework of this work, pseudo-two-dimensional models have practical interest, in view of the fact that the main work is carried out with images. <br>  Each element of a nested SMM is called a <i>superstate</i> and is a separate one-dimensional Markov model with the parameters described above. <br><br><h5>  Image in terms of recognition </h5><br>  The digital image is the essence of a random two-dimensional discrete signal observed by the system.  The sequence of observations (vector of observations) can be extracted from the image in various ways.  Because of this, the descriptive abilities of the models obtained may vary.  Most preferred is the option to scan an image with a rectangular window.  To reduce the likelihood of data loss at the block boundaries, it is recommended to scan the image so that adjacent blocks of pixels can overlap each other.  The value of the overlap is chosen experimentally. <br>  To reduce computational complexity and reduce the space of attributes, each extracted block of pixels undergoes some transformation, which results in a certain set of numerical data, which is the vector of observations. <br>  The most suitable for the task are two transformations: <br><ul><li>  Karunen-Loeve transform (eng. Karhunen-Loeve transform - abbr. KLT); </li><li>  discrete cosine transform (English Discrete Cosine <br>  Transform - abbr.  DCT). </li></ul>  KLT conversion is quite time consuming and requires large computational resources.  The discrete-cosine transform is devoid of these disadvantages.  In addition, DCT allows to reduce the sensitivity of the system to noise, transformations and distortions.  After extracting each block of pixels, each of them is transformed into a vector <i>F</i> using discrete-cosine transform.  The length of this vector is the number of significant coefficients.  Only the first few coefficients of the discrete cosine decomposition are called significant.  Their number may vary depending on the problem being solved. <br><br>  Further, the obtained vectors are distributed over the states of the model.  It should be noted here that each individual SMM represents a certain class of objects.  Then the state of the model determines some key features of the class.  For example, the SMM for face search consists of 5 superstates corresponding to the face areas (frontal part, eyes, nose, mouth, chin), each of which is divided into separate states. <br><img src="https://habrastorage.org/storage/habraeffect/57/00/5700eadf44841eedac4f0e27437f5b50.png" alt="image"><br>  The transition to the next state is possible only after the previous one, and the transition to the next super-state is possible only after all the states of the current super-state.  The probability that a certain object belongs to a given class is estimated as the probability of generating a signal corresponding to its feature vector. <br><br><h5>  Face search </h5><br>  We assume that information about the images of the collection is stored in a relational database.  Image content can be defined at various levels of abstraction.  At the lowest level, an image is a collection of pixels.  The pixel level is rarely used in a search task, since it implies large computational and time costs. <br><br>  Raw data can be sent to generate numeric descriptors that describe particular visual characteristics, called <i>signatures</i> .  As a rule, the level of image signatures requires much less space than the image. <br><br>  Image search is based on the search for similarity in multidimensional space.  The image is determined by a set of their signatures.  The similarity measure is a function that calculates and returns a value corresponding to the similarity between two objects according to some predefined criteria.  The concept of measure of similarity is based on the concept of a <i>metric</i> .  A metric is a function of distance <i>d</i> , defined on a metric set, for any <i>x, y</i> points whose <i>z</i> <br>  the conditions are met: <br>  one. <img src="https://habrastorage.org/storage/habraeffect/67/ec/67ec7e2498267af0f8900305b9c7e1af.gif" alt="image">  , <br>  2 <img src="https://habrastorage.org/storage/habraeffect/5a/f8/5af8c29b71566367e114aae019928acf.gif" alt="image">  , <br>  3 <img src="https://habrastorage.org/storage/habraeffect/fd/fc/fdfc55750a6bd51fa98a70e1205eb93f.gif" alt="image">  . <br>  Indexing and searching of images in collections is performed on the basis of a <i>triangular tree</i> (triangle tree, trie tree), also called Really Fixed Query Tree.  A triangle tree is a data structure designed to find approximate matches based on search efforts.  It is associated with a measure of distance, a set of key images and a set of database elements.  The trie form is a tree form in which the edges follow from root to leaf, defining the leaf index.  The leaves of the tree contain elements of the base.  Each internal edge in the tree is associated with a non-negative number.  Each level of the tree is associated with a single key.  The path from the root to the leaves is the distance from the database item to each of the keys. <br>  The figure shows a triangular tree with 4 elements ( <i>W</i> , <i>X</i> , <i>Y</i> , Z) and 2 keys ( <i>J</i> , <i>K</i> ).  The distance from the sheet <i>W</i> to the key <i>J</i> is 3, the distance from <i>W</i> to <i>K</i> is 1. Thus, each image will be characterized by a certain set of numerical values, defined as the distance from this image to the existing keys. <br><img src="https://habrastorage.org/storage/habraeffect/ec/5d/ec5d727b27c50c53ed3326f837abb3c2.png" alt="image"><br>  The process of indexing the collection of images consists in finding the distances from each image to each key.  Based on the foregoing, the search principle can be defined as follows.  Let <i>I</i> represent the base object, <i>Q</i> represent the query object, <i>K</i> represent the key images, and <i>d</i> define some similarity measures ‚Äî metrics.  Using the property of metric (3), we conclude that the following inequalities will be true: <br><img src="https://habrastorage.org/storage/habraeffect/ee/ef/eeeff8a2191bffdd18aec9f8aad06dd8.gif" alt="image"><br><img src="https://habrastorage.org/storage/habraeffect/cc/bb/ccbb0da462a83e0748f8ef8283bd42f0.gif" alt="image"><br>  Combining inequalities, we get an expression that determines the distance from the request object to the collection object: <br><img src="https://habrastorage.org/storage/habraeffect/2f/4e/2f4e605bf625bd508f928d7f37340a02.gif" alt="image"><br><br>  Thus, by comparing objects from a database and objects of a query with a third key object, the lower limit of the distance between two objects can be obtained.  Based on this boundary, most of the collection can be cut off as not satisfying the request. <br><br>  It should also be noted that the search process takes place in two stages.  At the first stage, the lower limit of the distance from the request image to the collection images is determined.  At this stage, part of the collection is cut off.  At the second stage, a refinement search takes place: the distances from the request image to each image are determined, from those found at the first stage.  Images corresponding to maximum distances make up the final search result. <br><br>  Based on the above, we can conclude that in order to use search and indexing, you must be able to perform the following actions for each image. <ul><li>  Highlight image signatures.  For single images, the signature will be the observation vectors of each face contained on it. </li><li>  Highlight key signatures.  In this case, for the search system based on the SMM, the keys will be sets of images of one person, and the signature will be the parameters of the model trained on these images. </li><li>  Compare key signatures and images, as well as two images.  The result of the comparison should be the distance, expressed as an integer, lying in the segment [0;  99]. </li></ul>  The main problem in finding faces using hidden Markov models is that the methods based on these models provide only an assessment of the conformity of the image model.  In other words, this estimate allows you to decide which model corresponds to the image more than the others. <br><br>  The second problem is that at this stage it is not possible to use the SMM to find the distance between two separate images.  This is due to the fact that search algorithms require a trained model: teaching a model on one image is problematic. <br><br>  The following materials were used in the preparation of the article: <br><ol><li>  Nefian, AV Hidden Markov Madel-Based Approach for Face Detection and Recognition / Ara Nefian.  1999 </li><li>  Josan, O.V.  Using Hidden Markov Models for Detecting Iris on Faces: 2006 / A.V.  Jozan, Moscow State University  Lomonosov.  - 2006. </li><li>  Gultyaeva, T.A.  Hidden Markov models with one-dimensional topology in the problem of face recognition / TA  Gultyaev, A.A.  Popov;  NSTU.  - 2006. </li><li>  Berman, AP A Flexible Image Database System for Content-Based Retrieval: Computer Vision and Understanding / AP Berman, LG Shapiro.  1999 </li></ol></div><p>Source: <a href="https://habr.com/ru/post/109956/">https://habr.com/ru/post/109956/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../109945/index.html">Visual Studio 2010 SP1 and IIS Express Integration</a></li>
<li><a href="../109949/index.html">Infrastructure Blekko: 800 servers, your crawler and Perl modules</a></li>
<li><a href="../109953/index.html">Results of the November grant competition</a></li>
<li><a href="../109954/index.html">Beginner's Guide to Twitter</a></li>
<li><a href="../109955/index.html">Android tablet from MTS went on sale</a></li>
<li><a href="../109957/index.html">New version of the program Family and New Year's action</a></li>
<li><a href="../109958/index.html">Russian President ignores (c)</a></li>
<li><a href="../109960/index.html">During the day it was sold 3.3 million copies of the game World of Warcraft: Cataclysm</a></li>
<li><a href="../109961/index.html">Amavis :: Custom - paint yourself</a></li>
<li><a href="../109962/index.html">Alt Linux may be installed in Russian schools</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>