<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Twelve Linux Security Tips</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We live in a dangerous time: almost every day new vulnerabilities are discovered, exploits are created on their basis, a normal Linux home computer an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Twelve Linux Security Tips</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/ruvds/blog/343892/"><img src="https://habrastorage.org/getpro/habr/post_images/585/18b/a98/58518ba9884cfa5c4bc1cd9053ef5b4d.png" alt="image" align="left"></a>  We live in a dangerous time: almost every day new vulnerabilities are discovered, exploits are created on their basis, a normal Linux home computer and a server on which a huge organization depends can be under attack. <br><br>  Perhaps you pay attention to security and periodically update the system, but usually this is not enough.  Therefore, today we will share twelve tips to improve the security of Linux-based systems on the example of CentOS 7. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Terminal security</font> </h2><br>  In order to improve the security of the system, you can protect the console access to it by limiting the root user to the use of certain terminals.  This can be done by specifying the terminals that the superuser can use in the <code>/etc/securetty</code> . <br><br>  It is recommended, although not necessary, to allow the superuser to log in only from one terminal, leaving the rest to other users. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  <font color="#3AC1EF">Password Reminders</font> </h2><br>  Nowadays, a complex password is an absolutely necessary thing.  However, it is even better when passwords are regularly changed.  It is easy to forget about this, so it would be good to use some kind of system mechanism for reminding you about the age of a password, and when it should be changed. <br><br>  We offer you two ways to organize such reminders.  The first is to use the <code>chage</code> command, the second is to set the required default values ‚Äã‚Äãin <code>/etc/login.defs</code> . <br><br>  Calling <code>chage</code> looks like this: <br><br><pre> <code class="hljs ruby">$ chage -M <span class="hljs-number"><span class="hljs-number">20</span></span> likegeeks</code> </pre> <br>  Here we use the key <code>-M</code> in order to set the expiration date of the password in days. <br><br>  You can use this command without keys, then it will prompt you to enter the required value: <br><br><pre> <code class="hljs ruby">$ chage likegeeks</code> </pre> <br>  The second way is to modify the <code>/etc/login.defs</code> file.  Here is an example of what the values ‚Äã‚Äãof interest may look like.  You can change them to those you need: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">PASS_MAX_DAYS</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> PASS_MIN_DAYS <span class="hljs-number"><span class="hljs-number">0</span></span> PASS_WARN_AGE <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Remember that if you play the role of administrator, you should encourage users to use complex passwords.  You can do this with <a href="https://likegeeks.com/linux-pam-easy-guide/">pam_cracklib</a> . <br><br>  After installing this program, you can go to <code>/etc/pam.d/system-auth</code> and enter something like this: <br><br><pre> <code class="hljs swift">password <span class="hljs-keyword"><span class="hljs-keyword">required</span></span> pam_cracklib.so minlen=<span class="hljs-number"><span class="hljs-number">12</span></span> lcredit=-<span class="hljs-number"><span class="hljs-number">1</span></span> ucredit=-<span class="hljs-number"><span class="hljs-number">1</span></span> dcredit=-<span class="hljs-number"><span class="hljs-number">2</span></span> ocredit=-<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">Sudo notifications</font> </h2><br>  The <code>sudo</code> , on the one hand, makes life easier, and on the other, it can cause Linux security problems that can lead to irreparable consequences.  <code>sudo</code> settings are stored in the <code>/etc/sudoers</code> file.  Using this file, you can prevent ordinary users from executing certain commands on behalf of the superuser.  In addition, you can have <code>sudo</code> send an email when it is used by adding the following to the above file: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">mailto</span></span> yourname<span class="hljs-variable"><span class="hljs-variable">@yourdomain</span></span>.com</code> </pre> <br>  You also need to set the <code>mail_always</code> property to the value <code>on</code> : <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">mail_always</span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">SSH Security</font> </h2><br>  If we are talking about Linux security, then we should remember about SSH.  SSH is an important system service, it allows you to remotely connect to the system, and sometimes it is the only way to save the situation when something goes wrong, so we don‚Äôt talk about disabling SSH here. <br><br>  Here we use CentOS 7, so the SSH configuration file can be found at <code>etc/ssh/sshd_config</code> .  Scanners or bots used by attackers attempt to connect to SSH using the default port 22. <br><br>  It is common practice to change the standard SSH port to another, unused port, for example, <code>5555</code> .  The SSH port can be changed by setting the desired port number in the configuration file.  For example: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Port</span></span> <span class="hljs-number"><span class="hljs-number">5555</span></span></code> </pre> <br>  In addition, you can restrict SSH login for the root user by changing the value of the <code>PermitRootLogin</code> parameter to <code>no</code> : <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">PermitRootLogin</span></span> <span class="hljs-literal"><span class="hljs-literal">no</span></span></code> </pre> <br>  And, of course, you should disable password authentication and use public and private keys instead: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">PasswordAuthentication</span></span> <span class="hljs-literal"><span class="hljs-literal">no</span></span> PermitEmptyPasswords <span class="hljs-literal"><span class="hljs-literal">no</span></span></code> </pre> <br>  Now let's talk about SSH timeouts.  The problem of timeouts can be solved by setting some parameters.  For example, the following settings imply that packets supporting a connection will be automatically sent after a specified number of seconds: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">ServerAliveInterval</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> ServerAliveCountMax <span class="hljs-number"><span class="hljs-number">3</span></span> TCPKeepAlive <span class="hljs-literal"><span class="hljs-literal">yes</span></span></code> </pre> <br>  By setting these parameters, you can increase the connection time: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">ClientAliveInterval</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span> ClientAliveCountMax <span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre> <br>  You can specify which users are allowed to use SSH: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">AllowUsers</span></span> user1 user2</code> </pre> <br>  Permissions can also be assigned at the group level: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">AllowGroup</span></span> group1 group2</code> </pre> <br><h2>  <font color="#3AC1EF">SSH protection using Google Authenticator</font> </h2><br>  For even more reliable SSH protection, you can use two-factor authentication, for example, by using Google Authenticator.  To do this, you first need to install the appropriate program: <br><br><pre> <code class="hljs sql">$ yum <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> google-authenticator</code> </pre> <br>  Then run it to verify the installation: <br><br><pre> <code class="hljs ruby">$ google-authenticator</code> </pre> <br>  You also need the Google Authenticator application installed on your phone. <br><br>  Edit the <code>/etc/pam.d/sshd</code> , adding the following to it: <br><br><pre> <code class="hljs swift">auth <span class="hljs-keyword"><span class="hljs-keyword">required</span></span> pam_google_authenticator.so</code> </pre> <br>  Now it remains to report all this SSH, adding the following line to the <code>/etc/ssh/sshd_config</code> file: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">ChallengeResponseAuthentication</span></span> <span class="hljs-literal"><span class="hljs-literal">yes</span></span></code> </pre> <br>  Now restart ssh: <br><br><pre> <code class="hljs pgsql">$ systemctl <span class="hljs-keyword"><span class="hljs-keyword">restart</span></span> sshd</code> </pre> <br>  When you try to log in using SSH, you will be prompted to enter a verification code.  As a result, now SSH access to your system is much better protected than before. <br><br><h2>  <font color="#3AC1EF">File System Monitoring with Tripwire</font> </h2><br>  Tripwire is a great tool for enhancing Linux security.  This is an intrusion detection system (HIDS). <br><br>  The task of Tripwire is to track file system actions, keep track of who changes files, and when these changes occur. <br><br>  To install Tripwire, you need access to the EPEL repository.  This is a simple task; you can solve it with the following commands: <br><br><pre> <code class="hljs ruby">wget <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/dl.fedoraproject.org/pub</span></span><span class="hljs-regexp"><span class="hljs-regexp">/epel/</span></span><span class="hljs-number"><span class="hljs-number">7</span></span>/x86_64/e/epel-release-<span class="hljs-number"><span class="hljs-number">7</span></span>-<span class="hljs-number"><span class="hljs-number">9</span></span>.noarch.rpm $ rpm -ivh epel-release-<span class="hljs-number"><span class="hljs-number">7</span></span>-<span class="hljs-number"><span class="hljs-number">9</span></span>.noarch.rpm</code> </pre> <br>  After installing the EPEL repository, you can install Tripwire as well: <br><br><pre> <code class="hljs sql">$ sudo yum <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> tripwire</code> </pre> <br>  Now create the key file: <br><br><pre> <code class="hljs ruby">$ tripwire-setup-keyfiles</code> </pre> <br>  You will be prompted to enter a complex password for the key file.  You can then customize Tripwire by making changes to the <code>/etc/tripwire/twpol.txt</code> file.  Working with this file is easy, as each line is equipped with a meaningful comment. <br><br>  When setting up the program is completed, initialize it: <br><br><pre> <code class="hljs swift">$ tripwire --<span class="hljs-keyword"><span class="hljs-keyword">init</span></span></code> </pre> <br>  Initialization, during which the system scan is performed, will take some time, depending on the size of your files. <br><br>  Any modifications of protected files are regarded as an intrusion, the administrator will be notified about this and he will need to restore the system using files whose origin he has no doubt. <br><br>  For this reason, the necessary system changes must be confirmed via Tripwire.  To do this, use the following command: <br><br><pre> <code class="hljs pgsql">$ tripwire <span class="hljs-comment"><span class="hljs-comment">--check</span></span></code> </pre> <br>  And here's another recommendation regarding Tripwire.  Protect the <code>twpol.txt</code> and <code>twcfg.txt</code> .  This will increase the security of the system. <br><br>  Tripwire has many options and settings.  You can view help on it like this: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">man</span></span> tripwire</code> </pre> <br><h2>  <font color="#3AC1EF">Using Firewalld</font> </h2><br>  Firewalld is a replacement for <code>iptables</code> , this program improves Linux network security.  Firewalld allows you to make changes to settings without stopping current connections.  The firewall works as a service that allows you to add and change rules without restarting and uses network zones. <br><br>  To find out if <code>firewalld</code> is currently running, enter the following command: <br><br><pre> <code class="hljs pgsql">$ firewall-cmd <span class="hljs-comment"><span class="hljs-comment">--state</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c3/eef/430/8c3eef43077e4f888930b7d316a45e91.png"></div><br>  You can view the predefined network zones as follows: <br><br><pre> <code class="hljs swift">$ firewall-cmd --<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-zones</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9bb/173/2d4/9bb1732d485f15170d6ec3a57b0ce34c.png"></div><br>  Each of these zones has a certain level of trust. <br><br>  This value can be updated as follows: <br><br><pre> <code class="hljs cs">$ firewall-cmd --<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-zone=&lt;<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>-name&gt;</code> </pre> <br>  You can get detailed information about a specific zone like this: <br><br><pre> <code class="hljs pgsql">$ firewall-cmd <span class="hljs-comment"><span class="hljs-comment">--zone=&lt;zone-name&gt; --list-all</span></span></code> </pre> <br>  You can view a list of all supported services with the following command: <br><br><pre> <code class="hljs swift">$ firewall-cmd --<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-services</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/37d/7b2/8a1/37d7b28a1543007a6fe2df33d0635a48.png"></div><br>  Then you can add new services to the zone or remove existing ones: <br><br><pre> <code class="hljs xml">$ firewall-cmd --zone=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zone-name</span></span></span><span class="hljs-tag">&gt;</span></span> --add-service=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service-name</span></span></span><span class="hljs-tag">&gt;</span></span> $ firewall-cmd --zone=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zone-name</span></span></span><span class="hljs-tag">&gt;</span></span> --remove-service=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service-name</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  You can display information about all open ports in any zone: <br><br><pre> <code class="hljs pgsql">$ firewall-cmd <span class="hljs-comment"><span class="hljs-comment">--zone=&lt;zone-name&gt; --list-ports</span></span></code> </pre> <br>  You can add ports to the zone and delete them from it as follows: <br><br><pre> <code class="hljs xml">$ firewall-cmd --zone=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zone-name</span></span></span><span class="hljs-tag">&gt;</span></span> --add-port=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">protocol</span></span></span><span class="hljs-tag">&gt;</span></span> $ firewall-cmd --zone=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zone-name</span></span></span><span class="hljs-tag">&gt;</span></span> --remove-port=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">protocol</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  You can configure and port forwarding: <br><br><pre> <code class="hljs xml">$ firewall-cmd --zone=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zone-name</span></span></span><span class="hljs-tag">&gt;</span></span> --add-forward-port=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag">&gt;</span></span> $ firewall-cmd --zone=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zone-name</span></span></span><span class="hljs-tag">&gt;</span></span> --remove-forward-port=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Firewalld is a very advanced tool.  The most remarkable thing about him is that he can work normally, for example, when making changes to the settings, without restarting or stopping the service.  This distinguishes it from the <code>iptables</code> tool, when working with which the service in similar situations needs to be restarted. <br><br><h2>  <font color="#3AC1EF">Switch from firewalld to iptables</font> </h2><br>  Some prefer the <code>iptables</code> firewall to the firewalld <code>firewalld</code> .  If you are using <code>firewalld</code> , but want to go back to <code>iptables</code> , this is pretty easy to do. <br><br>  First, disable <code>firewalld</code> : <br><br><pre> <code class="hljs ruby">$ systemctl disable firewalld $ systemctl stop firewalld</code> </pre> <br>  Then install <code>iptables</code> : <br><br><pre> <code class="hljs ruby">$ yum install iptables-services $ touch /etc/sysconfig/iptables $ touch /etc/sysconfig/ip6tables</code> </pre> <br>  Now you can start the <code>iptables</code> service: <br><br><pre> <code class="hljs pgsql">$ systemctl <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> iptables $ systemctl <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> ip6tables $ systemctl <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> iptables $ systemctl <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ip6tables</code> </pre> <br>  After all this, restart the computer. <br><br><h2>  <font color="#3AC1EF">Compiler Restriction</font> </h2><br>  The attacker can compile the exploit on his computer and upload it to the server of interest.  Naturally, with this approach, the presence of compilers on the server does not matter.  However, it is better to limit compilers if you do not use them for work, as happens in most modern server management systems. <br><br>  First, list all binary compilers from packages, and then set permissions for them: <br><br><pre> <code class="hljs perl">$ rpm -<span class="hljs-keyword"><span class="hljs-keyword">q</span></span> --filesbypkg gcc | <span class="hljs-keyword"><span class="hljs-keyword">grep</span></span> <span class="hljs-string"><span class="hljs-string">'bin'</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9fc/72f/b79/9fc72fb798e2f00c8b59acc18506340c.png"></div><br>  Create a new group: <br><br><pre> <code class="hljs ruby">$ groupadd compilerGroup</code> </pre> <br>  Then change the compiler binary group: <br><br><pre> <code class="hljs perl">$ <span class="hljs-keyword"><span class="hljs-keyword">chown</span></span> root:compilerGroup /usr/bin/gcc</code> </pre> <br>  And one more important thing.  You need to change the permissions of these binary files: <br><br><pre> <code class="hljs perl">$ <span class="hljs-keyword"><span class="hljs-keyword">chmod</span></span> <span class="hljs-number"><span class="hljs-number">0750</span></span> /usr/bin/gcc</code> </pre> <br>  Now any user who tries to use <code>gcc</code> will get an error message. <br><br><h2>  <font color="#3AC1EF">Prevent File Modification</font> </h2><br>  Immunity files can not be overwritten by any user, even with root-rights.  A user cannot modify or delete such a file until the immunity flag is set, which can only be removed by the root user. <br><br>  It is easy to see that this feature protects you, as a superuser, from errors that can disrupt the system.  Using this approach, you can protect configuration files or any other files you wish. <br><br>  To make any file immutable, use the <code>chattr</code> command: <br><br><pre> <code class="hljs ruby">$ chattr +i /myscript</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/689/d33/d33/689d33d33d8499705ded76f405469b63.png"></div><br>  Immunity attribute can be removed with the following command: <br><br><pre> <code class="hljs ruby">$ chattr -i /myscript</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c02/86f/9be/c0286f9be0e80f8438d802a701855e69.png"></div><br>  This way you can protect any files, but remember that if you have processed binary system files in this way, you will not be able to update them until you clear the immunity flag. <br><br><h2>  <font color="#3AC1EF">SELinux control with aureport</font> </h2><br>  Often, the SELinux forced access control system turns out to be disabled by default.  This does not affect the performance of the system, and working with SELinux is quite difficult.  However, for the sake of increased security, SELinux can be enabled, and the management of this mechanism can be <code>aureport</code> using <code>aureport</code> . <br><br>  The <code>aureport</code> utility allows you to create reports based on audit <a href="https://likegeeks.com/linux-syslog-server-log-management/">log files</a> . <br><br><pre> <code class="hljs pgsql">$ aureport <span class="hljs-comment"><span class="hljs-comment">--avc</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/264/fc1/98b/264fc198b0589c5e0267a4d220ad0b9b.png"></div><br>  The list of executable files can be displayed with the following command: <br><br><pre> <code class="hljs ruby">$ aureport -x</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e09/199/44b/e0919944bd5b0d3f8b8362eba9fc1534.png"></div><br>  You can use <code>aureport</code> to create a complete authentication report: <br><br><pre> <code class="hljs matlab">$ aureport -au -<span class="hljs-built_in"><span class="hljs-built_in">i</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/99d/147/ee6/99d147ee682741d4bb2a9d61b9a431dd.png"></div><br>  You can also display information about failed authentication attempts: <br><br><pre> <code class="hljs pgsql">$ aureport -au <span class="hljs-comment"><span class="hljs-comment">--summary -i --failed</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e02/eba/256/e02eba2566aa4a6c4c669a2a6c658df1.png"></div><br>  Or perhaps a summary of successful authentication attempts: <br><br><pre> <code class="hljs pgsql">$ aureport -au <span class="hljs-comment"><span class="hljs-comment">--summary -i --success</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/003/044/6d3/0030446d33e811884334759928374488.png"></div><br>  The <code>aureport</code> utility makes working with SELinux much easier. <br><br><h2>  <font color="#3AC1EF">Using sealert</font> </h2><br>  In addition to <code>aureport</code> you can use a good Linux security tool called <code>sealert</code> .  You can install it like this: <br><br><pre> <code class="hljs sql">$ yum <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> setools</code> </pre> <br>  Now we have a tool that will issue alerts from the <code>/var/log/audit/audit.log</code> file and give us more information about the problems identified by SELinux. <br><br>  You can use it like this: <br><br><pre> <code class="hljs pgsql">$ sealert -a /var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/audit/audit.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d3/6bd/c39/2d36bdc39aa41c7ef7ea982676d4644f.png"></div><br>  The most interesting thing is that in the alerts you can find tips on how to solve the relevant problems. <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  Hopefully the tips here will help you make your Linux installation safer.  However, if we are talking about protecting information, it is impossible, by applying certain measures, to assume that nothing threatens you now.  To any security software always add vigilance and caution. <br><br>  Dear readers!  Do you know any simple but non-obvious ways to improve Linux security? </div><p>Source: <a href="https://habr.com/ru/post/343892/">https://habr.com/ru/post/343892/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343880/index.html">How we made an application under Windows 10 with Fluent Design (UWP / C #)</a></li>
<li><a href="../343882/index.html">Undefined behavior! = Insecure programming</a></li>
<li><a href="../343884/index.html">Automation of development processes: how we in Positive Technologies implemented DevOps ideas</a></li>
<li><a href="../343888/index.html">Performance analysis of React 16 applications using Chrome developer tools</a></li>
<li><a href="../343890/index.html">Great Java Application Server Debate with Tomcat, Jboss, GlassFish, Jetty and Liberty Profile</a></li>
<li><a href="../343894/index.html">Analysis of six web frameworks: pros, cons and features of choice</a></li>
<li><a href="../343902/index.html">Deploy Windows Containers to Azure Container Instances (ACI). Kubernetes Connector</a></li>
<li><a href="../343904/index.html">External IT services: ‚Äúand we have worked before‚Äù</a></li>
<li><a href="../343906/index.html">There was no sadness, updates pumped up</a></li>
<li><a href="../343908/index.html">Spring Websocket + SockJs. How it works?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>