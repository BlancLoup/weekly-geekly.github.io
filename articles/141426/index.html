<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Go for IT. Part one</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Elusive Go. 
 Remember the joke about the elusive Joe? Exactly the exclamation ‚ÄúYes, who needs it!‚Äù, Which sounded in the form of the question ‚Äú WHY? ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Go for IT. Part one</h1><div class="post__text post__text-html js-mediator-article"><h4>  Elusive Go. </h4><br>  Remember the joke about the elusive Joe?  Exactly the exclamation ‚ÄúYes, who needs it!‚Äù, Which sounded in the form of the question ‚Äú <a href="http://habrahabr.ru/post/140976/">WHY?</a> ‚Äù, Was released on Habr√© for the release of the first stable version of GO 1. <br><br>  I want to answer this question with a series of articles designed in an unusual format for Habr - in the form of step-by-step joint development of an existing web project - with a lively discussion and addition of functionality.  And in order to doubly justify the introduction of the cycle into the ‚ÄúHigh Performance‚Äù hub, we will set ourselves the task of creating not just a ‚Äúhamster‚Äù, but a project that clearly demonstrates habri et orbi the ability to withstand significant natural loads. <br><br>  <i>Instead of an aperitif: the implementation of the simplest dynamic web application in the Go language works 5‚Äì20 times faster than a similar Python implementation.</i>  <i>And just two times inferior to the rate of recoil of static Nginx.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this project, in addition to the Go language itself, we will indirectly touch on other (relatively new) technologies of web development - HTML5, CSS3, Redis, MongoDB.  I will also try to pull some of the tricks in the field of security and saving on matches from the corners of the long-term memory, which have accumulated a lot over the past fifteen years of work in this field.  Make yourself comfortable, have patience and coffee - under the cut "many letters", but this is only the introduction :) <br><a name="habracut"></a><br>  First of all, I want to thank the administration of Habr for the quick response and the creation of the hub dedicated to the Go language.  The recognition of a favorite subject is always pleasant, so that the appearance of such a hub and the arising interest of the audience prompted me for the first time in two years of being at Habr√© to ‚Äútake up drafts‚Äù. <br><br>  In addition, I apologize in advance for a somewhat old-fashioned style of presentation, skipping bearded terms, some tongue-tied speech and skipping paraphrasing of catch phrases in a long-dead language - i.e.  for the habits that I inherited from my legal background. <br><br><h5>  Hardness and prejudice </h5><br>  On tastes, as you know, do not argue.  Therefore, I have to leave behind the scenes my exclamations about the beautiful syntax, simplicity and elegance of the Go language.  The last thing I would like to see in the comments is another battle of blunt and pointed.  On this basis, I propose to speak exclusively about matters that are subject to simple and understandable measurement.  But even comparing numbers, I will have to compare with other languages, which can also be perceived as casus belli.  I thought for a long time how to get out of this delicate situation, and the decision seems to me quite solomon.  I will compare it with another favorite language, with Python.  This approach, it seems to me, will relieve me from accusations of bias.  So let's write it in black and white and in bold letters: <b>I also love Python</b> ! <br><br>  I do not want to repeat banal paragraphs from the documentation, describing the language itself, its philosophy and possibilities.  I will proceed from the fact that you are already interested and at the same time are able to read the documentation yourself. <br><br><h5>  Go to the barrier, Go!  To the barrier! </h5><br>  Let's start with a comparison that I intimidated you in the previous paragraph.  We write two primitive dynamic applications that: <br><br><ol><li>  launch webserver </li><li>  have routing and handler </li><li>  take variable from context </li><li>  substitute it in the handler and issue a personalized greeting Hello,% s. </li></ol><br><br>  Nothing complicated, but this is not static content, albeit with some cunning.  I foresee many objections to the fact that the main brakes will still be disk operations and work with the database.  And I do not argue with that.  But let's remember about the announced content of the article.  We‚Äôll still get to optimize i / o and db, but for now let's look at the figures for the net speed of responses. <br><br>  1. Application code for <a href="http://webapp-improved.appspot.com/">Webapp2.py</a> - a very simple and fast Paste-based mini-framework: <br><br><pre>  import webapp2
 class Hello (webapp2.RequestHandler):
     def get (self, name):
         self.response.write ('Hello,% s!'% name)
 app = webapp2.WSGIApplication ([
     ('/ (\ w +)', Hello),
 ], debug = False)
 def main ():
     from paste import httpserver
     httpserver.serve (app, host = '127.0.0.1', port = '8080')
 if __name__ == '__main__':
     main () </pre><br>  Launch code: python habr.py <br><br>  2. Go language code: <br><pre>  package main
 import (
     fmt
     "net / http"
 )
 func handler (w http.ResponseWriter, r * http.Request) {
     fmt.Fprintf (w, "Hello,% s!", r.URL.Path [1:])
 }
 func main () {
     http.HandleFunc ("/", handler)
     http.ListenAndServe (": 8080", nil)
 } </pre><br>  Launch code: go run habr.go <br><br>  Nothing complicated, right?  Notice how simple and understandable the Go code is, at least for such a simple task.  Both listings show the same algorithm.  We listen to the port, send all the GET / (*) handler, which turns (*) into the display name after Hello.  I suppose the code should be clear to everyone who has worked with such a scheme. <br><br>  3. For comparison, add another nginx, which renders a static page with the text ‚ÄúHello, habr‚Äù.  Attention!  Nginx is launched with out-of-box settings coming in the nginx-light package.  The stock for overclocking remains huge, but we'll talk about it later. <br><br>  4. Test bench (it does not rotate the language to call it a server) of the following configuration: <br>  Lenovo B460E / RAM: 2G / CPU: Celeron Dual-Core T3500 @ 2.10Ghz <br>  OS: Lubuntu 12.04 x86, kernel: 3.2.0-20-generic <br><br>  5. We will take measurements in a primitive way, using the ab utility from apache2-utils.  If you want, you can check it yourself using siege or another familiar tool. <br><br>  6. Run results <br><br><pre>  Py @ ab -c10 -n1000 http: // localhost: 8080 / habr </pre>  (with a larger value of "-n", the Python version can no longer cope) <br>  Time taken for tests: 0.987 seconds <br>  Requests per second: 1012.67 [# / sec] (mean) <br><br><pre>  Go @ ab -c10 -n1000 http: // localhost: 8080 / habr </pre><br>  Time taken for tests: 0.197 seconds <br>  Requests per second: 5080.24 [# / sec] (mean) <br><br><pre>  Nginx @ ab -c10 -n1000 http: // localhost / </pre><br>  Time taken for tests: 0.101 seconds <br>  Requests per second: 9895.50 [# / sec] (mean) <br><br>  Let's complicate the task. <br><br><pre>  Py @ ab -c100 -n1000 http: // localhost: 8080 / habr </pre><br>  Time taken for tests: 1.045 seconds <br>  Requests per second: 956.57 [# / sec] (mean) <br><br><pre>  Go @ ab -c100 -n1000: http: // localhost: 8080 / habr </pre><br>  Time taken for tests: 0.199 seconds <br>  Requests per second: 5021.14 [# / sec] (mean) <br><br><pre>  Nginx @ ab -c100 -n1000 http: // localhost / </pre><br>  Time taken for tests: 0.110 seconds <br>  Requests per second: 9054.77 [# / sec] (mean) <br><br>  With "-c"&gt; 1000, the python version of the test does not pass, Nginx keeps cucumber, but Go "pleases" completely unpredictable results, showing from 50 to 4000 requests per second.  I cannot explain this phenomenon, because I ran into it for the first time today, on Ubuntu 12.04 and in version Go 1. Go was stable on earlier versions (r60.3).  Or maybe it's a laptop, but the package bundle is clearly not for the HighLoad server :) <br><br>  I suspect that the testing methodology, default settings or lack of implementation in other languages ‚Äã‚Äãwill not suit anyone.  I am pleased to hear your suggestions and repeat the tests.  I drove a lot of different tests and with different settings for the two years of Go.  And all the tests convinced me that Go is the best tool for my range of tasks.  To lead and bring them all is an ungrateful occupation, because all the same, again, they will be displeased. <br><br>  By asking for a word of faith, I‚Äôll give a brief answer on the results from memory. <br><br>  Java sometimes turns out to be 10-30% faster, but at the expense of much more memory consumption (both by the VM itself and by the processes).  Again, the above example (without the use of frameworks, only standard libraries) quite clearly demonstrates the minimum implementation code.  And the less code, the less errors. <br><br>  The same can be said about the Net / Mono C # implementation. <br><br>  C / C ++ no doubt allow you to create fantastically fast web-based applications with minimal resource requirements.  But the speed of development suffers greatly. <br><br>  Python and Ruby implementations are about the same in losing speed and load, PHP suffers a crushing defeat. <br><br>  The announcement of the next part: <br><ul><li>  Parse the code from the example Hello, Habr! </li><li>  Complicate with multiple handlers </li><li>  Compile and push several Go servers under Nginx. </li></ul><br><br>  Thank you for attention.  I hope that at least someone mastered the introduction and found something interesting for themselves. <br>  I look forward to the discussion, preferably civilized. </div><p>Source: <a href="https://habr.com/ru/post/141426/">https://habr.com/ru/post/141426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141420/index.html">Lenovo laptops: what is expected in 2012?</a></li>
<li><a href="../141421/index.html">Doctor Web discovered a botnet from over 550,000 Macs</a></li>
<li><a href="../141422/index.html">Project Glass - Future points from Google or "feel like a terminator"</a></li>
<li><a href="../141424/index.html">My version of .htaccess</a></li>
<li><a href="../141425/index.html">Forget everything you knew about banners</a></li>
<li><a href="../141427/index.html">I'm Feeling Lucky in Standard Browser Search</a></li>
<li><a href="../141430/index.html">Version 4.0 - Creative Commons License Draft Ready for Public Comment</a></li>
<li><a href="../141431/index.html">The accident on the cellular network Vodafone in the Netherlands</a></li>
<li><a href="../141432/index.html">WordpressMD Community 1st Offline</a></li>
<li><a href="../141433/index.html">Facebook Developer Garage in faces</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>