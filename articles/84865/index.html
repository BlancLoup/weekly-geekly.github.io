<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Soul in the program</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Remember the beginning of the film "I am a robot"? There, the professor gives a lecture on the phenomenon of "Soul" in the program code: 

 ‚ÄúWhen a pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Soul in the program</h1><div class="post__text post__text-html js-mediator-article">  Remember the beginning of the film "I am a robot"?  There, the professor gives a lecture on the phenomenon of "Soul" in the program code: <br><br>  ‚ÄúWhen a program grows, especially when many people are involved in it, pieces of the so-called‚Äú dead code ‚Äùinevitably begin to occur.  These are the remaining functions that have been replaced by newer ones or just the test code forgotten by the programmer. <br>  When such critical mass accumulates of such pieces, it can lead to unexpected actions in the algorithm, which, from the outside, can be called a manifestation of one's will or ‚ÄúSoul‚Äù of the program ‚Äù <br><br>  The quotation does not claim to be accurate, but the sense is as follows.  In light of this and recent topics in Habr√© to check variable names for different values ‚Äã‚Äãin different languages ‚Äã‚Äã(sorry, I could not find the link), I decided to describe a small incident that happened to me.  Perhaps, if someone also met with "manifestations of the soul", which turned out to be the most banal errors in the code, he would want to throw an example to a comment or give me an invite. <br><a name="habracut"></a><br>  So, the essence of the matter fits in one function - handling the TextChanged event.  Processing is that when you receive a particular character, you must add a certain line after the cursor position. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At first, the handler looked like this: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">void</font> txtMain_TextChanged( <font color="#0000ff">object</font> sender, <font color="#2b91af">EventArgs</font> e)&lt;br&gt;{&lt;br&gt; <font color="#008000">//,     (   backspace -   )</font> &lt;br&gt; <font color="#0000ff">if</font> (txtMain.Text.Length &gt; textlen)&lt;br&gt;  {&lt;br&gt; <font color="#008000">//  </font> &lt;br&gt; <font color="#0000ff">if</font> (txtMain.Text[txtMain.TextLength - 1] == <font color="#a31515">'a'</font> )&lt;br&gt;    {&lt;br&gt; <font color="#008000">// try -   </font> &lt;br&gt; <font color="#0000ff">try</font> &lt;br&gt;      {&lt;br&gt; <font color="#0000ff">string</font> newSpace = <font color="#a31515">"&lt;inputted a&gt;"</font> ; <font color="#008000">//-    </font> &lt;br&gt; <font color="#0000ff">int</font> curPosition = txtMain.SelectionStart; <font color="#008000">//  </font> &lt;br&gt;        txtMain.Text = txtMain.Text.Insert(curPosition, newSpace); <font color="#008000">// </font> &lt;br&gt;        txtMain.SelectionStart = curPosition + newSpace.Length; <font color="#008000">//   </font> &lt;br&gt;      }&lt;br&gt; <font color="#0000ff">catch</font> (Exception ex)&lt;br&gt;      {&lt;br&gt;        MessageBox.Show(ex.Message); <font color="#008000">//  </font> &lt;br&gt;      }&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;  textlen = txtMain.Text.Length; <font color="#008000">//    ,   </font> &lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  But the first error was found quite simply - the line was not inserted if the required character was entered in the middle of the typed text.  Those.  Only the last character was checked.  Then the 7th line was corrected as follows: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">if</font> (txtMain.Text[txtMain.SelectionStart - 1] == <font color="#a31515">'a'</font> )</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  And here the most interesting thing began - the method began to throw IndexOutOfRangeException on line 14: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">txtMain.Text = txtMain.Text.Insert(curPosition, newSpace);// </font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  At the same time, when entering a function (for the case of sequential text input - that is, when we add the required character to the end) in both cases both properties had the same value - both TextLength and SelectionStart.  Passing through the body of the function was the same, but in the case of SelectionStart, an exception was dropped. <br><br>  I could not understand for a long time why, changing in one line the name of a property that returns the same value as the previous one, I get an exception 5 lines below. <br><br>  But it turned out pretty simple.  At the moment of inserting the desired line (just the place where the exception fell), the TextChanged event was raised again (logical !!) but for him SelectionStart was 0, as a result, we received an attempt to compare the -1 character of the string with the specified one, but the debugger showed an error on 14 line, and not on the 7th. <br><br>  Actually, the final function code is as follows: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">void</font> txtMain_TextChanged( <font color="#0000ff">object</font> sender, <font color="#2b91af">EventArgs</font> e) <br> { <br> <font color="#008000">//,     (   backspace -   )</font> <br> <font color="#008000">//     </font> <br> <font color="#0000ff">if</font> (txtMain.Text.Length &gt; textlen &amp;&amp; txtMain.SelectionStart &gt; 0) <br> { <br> <font color="#008000">//  </font> <br> <font color="#0000ff">if</font> (txtMain.Text[txtMain.SelectionStart - 1] == <font color="#a31515">'a'</font> ) <br> { <br> <font color="#008000">// try -   </font> <br> <font color="#0000ff">try</font> <br> { <br> <font color="#0000ff">string</font> newSpace = <font color="#a31515">"&lt;inputted a&gt;"</font> ; <font color="#008000">//-    </font> <br> <font color="#0000ff">int</font> curPosition = txtMain.SelectionStart; <font color="#008000">//  </font> <br> txtMain.Text = txtMain.Text.Insert(curPosition, newSpace); <font color="#008000">// </font> <br> txtMain.SelectionStart = curPosition + newSpace.Length; <font color="#008000">//   </font> <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> MessageBox.Show(ex.Message); <font color="#008000">//  </font> <br> } <br> } <br> } <br> textlen = txtMain.Text.Length; <font color="#008000">//    ,   </font> <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> </div><p>Source: <a href="https://habr.com/ru/post/84865/">https://habr.com/ru/post/84865/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../84855/index.html">MSN Russia at Silverlight - Olympics, photo order ...</a></li>
<li><a href="../84856/index.html">Torrents.Ru: case number 343-227</a></li>
<li><a href="../84858/index.html">These entertaining SIM cards</a></li>
<li><a href="../84860/index.html">Adidas Flashback</a></li>
<li><a href="../84863/index.html">10+ convenient online editors for programmers</a></li>
<li><a href="../84866/index.html">NOMOBILE.RU at MWC-2010. Last day</a></li>
<li><a href="../84867/index.html">Barbapapa Mouse - wireless heart</a></li>
<li><a href="../84869/index.html">Dimensionless flash drive</a></li>
<li><a href="../84871/index.html">Bottomless "flash drive" from Infinitec</a></li>
<li><a href="../84872/index.html">Femtocells for the population</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>