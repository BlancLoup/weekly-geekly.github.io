<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security threats in electronic postage stamp systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi% username! 

 The habr for the Postal Form is about to close for an indefinite period, and we really want to have time to release at least a small ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security threats in electronic postage stamp systems</h1><div class="post__text post__text-html js-mediator-article">  <b>Hi% username!</b> <br><br>  The habr for the Postal Form is about to close for an indefinite period, and we really want to have time to release at least a small part of the long-term construction.  The article will discuss the main vulnerabilities of the two-dimensional code, which is more and more often used in the world of postal operators as a sign of payment for mailings.  Yes, there is a lot of confusion in the article, but we have only 20 minutes to block and very, very much collected useful information. <br><br>  So. <br>  Light, camera, motor! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/web/c54/990/57a/c5499057a06846f8870df3e073ad1bf2.png" alt="image"></div><a name="habracut"></a><br><h1>  Management of risks </h1><br>  The main task of e-postage systems is to provide the sender with the opportunity to use the services of postal operators, correctly determine the amount of postage for each service used and transfer the appropriate funds from the sender to the postal operator safely and in a timely manner.  The second most important tasks are to provide postal operators with accurate data on the use of postal services, additional information to the user when tracking a postal item, as well as protecting the confidentiality of information about senders and recipients ("communication secret"). <br><br>  In order to develop and start using such a system, at the design stage it is important to anticipate possible security risks to which it will be exposed during the entire lifetime, and after deployment, regularly re-evaluate the residual risks.  For any considered EPM system, all actions must be planned in advance, organized and carried out within the framework of the so-called ‚Äúrisk management process‚Äù.  This is a recurring cycle of taking measures to reduce the identified risks to an acceptable level and maintain it further. <br><br>  At the risk assessment stage, it is necessary to determine the relevant data held by the system and to evaluate them.  The following indicates a possible threat of damage to the established data.  Threats include an emergency or malfunction, as well as hacker attacks.  In order to understand the resilience of the system to attacks, it is useful to develop their model describing which parts of the system may be vulnerable to an attacker, what methods of attacks he has and what resources he has. <br><br>  Unintentional threats can be measured by the degree of their likelihood.  Hacker attacks can be judged on the basis of the expected benefits that attackers can help out.  The greater the value of the target asset, the higher the risk of security breach;  the more likely or cheaper to launch an attack, the more serious or critical the expected breach of the security system or the damage to the relevant data will be. <br><br>  The risk assessment phase usually consists of a security audit, which examines all active and operational components.  The final system security report provides a framework with which you can determine the current level and compare it with the results of the previous audit.  In the case of detection of new vulnerabilities or security threats, as well as if existing protection measures are considered ineffective, a new phase is introduced in which additional protection measures are identified and established with a corresponding update of the system documentation. <br><br>  In this article, we will look at the systems of electronic postal prepayments from the point of view of the postal operator, the main requirement of which is the protection of legitimate income.  Next, we will develop a catalog of security threats common to most EMP systems.  We will also give examples of threats to mechanical and electromechanical franking machines. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/808/fe4/a42/808fe4a4276847559e022deafe00adf2.jpg" alt="image"></div><br>  <i><font color="#999999">Typical modern franking machine</font></i> <br><br><h1>  Attacker model </h1><br>  We agree that in the commercial sector there are 3 classes of intruders: <br><br>  <b>‚ñ† Attackers of class 1</b> : people from the side, often very intellectually developed, but lacking sufficient knowledge of the system.  They may have access only to equipment of medium complexity and often try to take advantage of an existing vulnerability in the system, without trying to find new ones. <br><br>  <b>‚ñ† Attacking 2 classes</b> : internal specialists with relevant technical education and significant experience.  To varying degrees, they have an understanding of how the components of the system work.  Most often they own modern tools and tools for analysis. <br><br>  <b>‚ñ† Attackers 3 classes</b> : funded by organizations able to organize teams of specialists with related and complementary skills, provided with large financial resources.  They are capable of in-depth analysis of the system, the development of complex attacks using the most advanced analysis tools, and can use attacking class 2 as part of a team. <br><br>  In the EMP systems, it is necessary to clearly distinguish the areas of potential attacks: the mail delivery domain and the backoffice domain. <br><br>  The sender is always identified at the time of registration of the EMP generation devices, and companies using closed EPM devices (franking machines), under certain circumstances, are obliged to deal with postal inspections.  Otherwise, the replenishment processes remain virtually uncontrolled by the postal operator, which creates various opportunities for attacks. <br><br>  In traditional mail transport and processing systems, where mail is not protected by cryptography, attackers can directly access the mail transport system by bribing or blackmailing postal employees who work in logistics centers handling mail.  Thus, attackers, without great risk of detection, can illegally throw bags with unpaid mail into the mail channel and delivery system after the blanking stage of the prints and before the address recognition stage.  It can be assumed that these methods of attack can be used by attacking class 1. <br><br><img src="https://psv4.userapi.com/c612724/u135899894/docs/e339f4699b2d/Raspoznavanie.gif" alt="image"><br>  <i><font color="#999999">E-mail stamp processing center</font></i> <br><br>  In ePM systems, mail processing centers are designed in such a way that the franc verification process includes a snapshot of each mail item.  Then, the resulting digital image is divided into the lower part, which contains the recipient's address, and the upper part, which contains payment information.  If the verification of payment fails, the shipment is automatically sorted and delivered to the recipient, subject to payment of a penalty, or otherwise returned to the sender.  This higher degree of automation and system integration effectively prevents access to the first-class attacking mail delivery system, which used methods of bribing or blackmailing postal workers.  However, an attacker may attempt to misuse the EPR devices to obtain valid stamps on mail items that will be freely passed through processing centers.  It is important to remember that EPM devices are used in unsupervised environments.  Attackers can explore one or more devices to analyze their defense mechanisms before planning a complex attack on new ones. <br><br>  <b>Social engineering, collusion</b> - deliberate collaboration between several fraud members pursuing fraudulent goals.  Parties may collude across security areas, for example, senders cooperating with corrupt employees of an EMF provider and / or postal operator.  Another type of collusion is an example where an attacker ‚Äúhires‚Äù a former employee of the manufacturer of an EPM device to access inside information and tools to control this type of device, as well as to obtain seals or replaceable plastic seals to eliminate traces of intrusion. <br><br>  <b>Unauthorized access to the system</b> - a general definition for any type of attack that interferes with the integrity or accountability of financial transaction systems.  Most of them are still guided by the principle of security, which provides narrowly limited access for unauthorized persons if they do not have the necessary powers, and full access rights for internal specialists.  Thus, persons with unrestricted access to confidential information, by virtue of their official position, may incorrectly use their access rights to databases or application servers to create hidden accounts and launch malware.  As a result, outsiders may gain access to confidential information after they have calculated passwords or otherwise captured one of the privileged user accounts. <br><br>  <b>The actions of the offender under the guise of a legitimate user</b> are a fraud, as a result of which personal data of the sender who did not actually send anything is displayed on the stamp of the postal item.  This can occur as a result of using lost or stolen EPM devices without re-registering them with the postal service operator.  For example, in 1996, only 0.6% of all registered franking machines were lost or stolen in the US market. <br><br>  <b>Refunds</b> - an attempt to replenish the electronic mass storage device from the electronic mass media provider, which will later be canceled (for example, using a rejected check or refusing to debit funds from an account).  The attacker will try to replenish the franking machine, before the provider can find out that in fact the payment failed. <br><br><h1>  EPM device </h1><br>  Illegal modification of EPM devices is a fraud scheme as well.  For example, in mechanical franking machines, locks and seals were neutralized in order to replace printed clich√©s, which, for example, were taken from the lost or stolen machines of this or a similar model.  Another type of attack is a way to bypass the blocking mechanism, which aims to prevent the franking process after the remainder in the downstream DR register has been expended (for more information on the registers of frankmashins, see <a href="https://habrahabr.ru/company/pbrf/blog/297780/">our first article</a> ).  Such ‚Äújackpot‚Äù machines could be tuned to the maximum number of available mailings, which in some cases amounted to $ 99,999,999. <br><br>  Bypassing the control of the printing mechanism occurs by replacing the control system of the printing mechanism with its own software running from a PC in the EPM device.  This attack can theoretically produce any stamps and print them with postal ink. <br><br>  Print reuse is a type of attack in which the print control unit of a legitimate EPM device is connected to printers of two or more EPMs.  As a result, the attacker collects one or more free copies of each legitimate stamp on mailings, each of which is printed with mail (fluorescent) ink.  This attack leads to the manufacture of higher quality duplicate stamps than in the manufacture of its photocopies. <br><br><h1>  Postal Security Device </h1><br><img src="https://habrastorage.org/web/ed9/940/d18/ed9940d182dc4ae787ee41bdc9dcc070.png" alt="image"><br>  <i><font color="#999999">Special module of the franking machine that stores all existing registers</font></i> <br><br>  Physical attacks include drilling, cutting, sand blasting, exposure to heat or cold, or certain chemicals such as acids or solvents on devices.  These attacks are aimed at identifying certain electrical access points, which are usually protected by a mail security device. <br><br>  Other attacks are aimed at extracting the cryptographic keys of individual users from the mail security devices necessary to obtain correct prints. <br><br>  For example, replacing the original cryptographic keys with false ones or launching man-in-the-middle attacks with the further introduction of a fake key into the mail security device.  This attack can lead to the actions of the offender under the guise of a legitimate user, if the attacker uses the cryptographic keys of other clients. <br><br>  There are attacks aimed at replaying a replenishment transaction without the fact of a repayment.  If the received messages are checked at the level of the EPM provider using cryptographic tools, then the attacker may not be able to calculate the actual checksum for a randomly selected message, but he can reuse the previously intercepted message along with its checksum. <br><br><h1>  Mail processing area </h1><br><img src="https://habrastorage.org/web/cb8/76d/a3c/cb876da3c8f94014a0569edca1ea805e.jpg" alt="image"><br>  <i><font color="#999999">Typical sorting</font></i> <br><br>  <b>Alteration</b> - is a modification of the intercepted impressions, changing the value of the prepayment or identification or other data of the sender. <br><br>  <b>Copying</b> is the illegal reproduction of prints using, for example, photocopiers or color laser printers.  For EMP systems using cryptographically protected stamps, any stamps that occur twice are, by definition, invalid.  However, this will not prevent criminals from creating a large number of copies, because all the ‚Äúelectronic traces‚Äù available to investigating authorities will only lead to original stamps of postal prepaid security devices.  Another risk postal operators associated with the fact that attackers use high-speed copying machines to fill the mail network with massive copies of stamps. <br><br>  <b>Counterfeit</b> - the creation of valid or similar to actual impressions in any way other than using a registered EPM device, for example, rubber stamps, software on personal computers or counterfeit EPM devices.  This is one of the most common ways of cheating postal operators, which can only be detected through laboratory analysis. <br><br>  <b>Erroneous application</b> - the use of electronic stamps in the postal item in such a way that the nominal value of the impression does not coincide with the postal item.  If this error happens by accident, it can lead to overpayment or underpayment.  But in the case where the action is intentional, in most cases this leads to incomplete payment. <br><br>  <b>Obliteration</b> is a distortion of an imprint in order to make it impossible to read or verify them.  This can be achieved by deforming, hiding, blurring the character set.  All these actions are difficult to detect because they can be committed unintentionally. <br><br><h1>  Algorithmic level </h1><br>  <b>Cryptanalysis</b> is a general term for any kind of attack on a cryptographic mechanism.  Each postal operator reserves the right to indicate which cryptographic algorithms are allowed to use in its EMP systems.  Even if postal operators regularly review their recommendations regarding the use of new cryptographic algorithms, the old algorithms continue to work in existing systems for a long time.  The average period of use of algorithms from commissioning to removal should be no more than 10 years.  The advantage of these rules is that an erroneous algorithm is unlikely to be used in approved EFM systems.  On the other hand, if an incorrect algorithm is already in use and turns out to be incorrect subsequently or otherwise damaged, then the entire system and potentially all electronic devices and programs are at risk. <br><br>  The professional way to resolve this predicament is to additionally use instant key updates for each cryptographic mechanism so that it will take effect in an emergency situation. <br><br>  <b>Cryptanalysis of common hash functions</b> <br><br>  A hash function that is resistant to finding the second preimage must generate 80 or more bits at the output.  In order to be resistant to collisions, hash values ‚Äã‚Äãmust be at least 160 bits long.  Shorter output values ‚Äã‚Äãare not recommended, since the search for second types or collisions can be performed offline, and such attacks can be highly parallelized. <br><br>  Hash functions are an example of how too limited rules can threaten all electronic postal prepay systems.  Not surprisingly, in 2005 (Dada, if you‚Äôve read it up to this point, it means we can say with confidence that we are translating the book of 2005) almost all the EMP systems (and many other cryptographic systems) use SHA-1 for (a) preprocessing messages before they are digitally signed or (b) authenticated by using a message identification code, ¬© obtaining a secret key using the session key agreement and (d) generating pseudo-random bits according to FIPS 186-2.  Since the output length of the SHA-1 added extra margin to the minimum recommended output length for the hash functions, SHA-1 was considered sufficiently resistant to collisions.  That all changed when, in 2004, Biham and Chen demonstrated new ways of finding possible conflicts in SHA-0 and SHA-1.  All of these attacks were aimed at finding collisions, when the attacker must find any two pre-images that are matched with the same hash value for SHA-1. <br><br>  When focusing on the weaknesses of the hash function, we assume that the attacker will not be able to compromise the private keys of the electronic signature of any mail security device, including his own. <br><br>  How are these attacks applied to industrial EMP systems and what is the likelihood that they will be successful?  In general, the data fields in an imprint fall into two categories: (a) system constants and data that are individual for an EPM client or device, and (b) data that are specific to each individual imprint.  Since clients and their EPM devices are usually registered by postal operators, in the imprint the data fields of categories (a) must coincide with the record registered by the postal operator in order to be recognized as valid.  The data fields by category (b) may vary, but in general must meet the basic integrity criteria.  For example, a data field containing the amount of postage usually corresponds to, or is determined by, a data field containing a category of tariffs or services. <br><br>  First consider the case where SHA-1 is used in combination with a digital signature algorithm, so the data in the mark is first hashed to a fixed length, and then signed using, for example, RSA, DSA or ECDSA. <br><br><img src="https://habrastorage.org/web/188/6e1/6d7/1886e16d79564c6ead0d963f40c4d0a2.png" alt="image"><br>  <i><font color="#999999">USPS Electronic Brand: IBIP (Information Based Indicia Program)</font></i> <br><br>  Consider stamps IBIP (Information Based Indiciaia Program), which should be used to send by mail on a particular day.  How many valid IBIP stamp values ‚Äã‚Äãexist on this day? <br><br><img src="https://habrastorage.org/web/e24/47d/09a/e2447d09af73419bbd775fa5440d589a.jpg" alt="image"><br>  <i><font color="#999999">Variables contained in IBIP</font></i> <br><br>  An analysis of the table above shows that 8 of the 14 data fields fall into category (a), or rather fields No. 1-6, 10, and 12. This subset of data can take on any of the 1.6 million franking machine records registered in the United States ( if the market had completely moved to IBIP).  The remaining fields are in category (b).  Of these, the date of dispatch (field No. 9) automatically coincides with the specified date of registration, and, as a rule, the tariff category (field No. 4) is uniquely determined by the payment amount (field No. 8).  Assuming that the unused field number 11 can take any possible value, there are 17 bytes of data category (b) left, data that belongs to the contents of the stamps.  Factoring in both data categories is no more than 1.6x10 ^ 6 x 256 ^ 17 ‚âà 256 ^ 16.58 of the actual value of the stamps.  Any restrictions on filling data fields will further reduce this figure. <br><br>  So it goes. </div><p>Source: <a href="https://habr.com/ru/post/328748/">https://habr.com/ru/post/328748/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328738/index.html">Linux staff monitoring: when demand creates supply</a></li>
<li><a href="../328740/index.html">Genetic Advisor for Options Trading</a></li>
<li><a href="../328742/index.html">Data-driven Production Approach / Stock Filters</a></li>
<li><a href="../328744/index.html">MyTaskHelper online database designer: create relational databases without programming knowledge</a></li>
<li><a href="../328746/index.html">We order translations and copywriting - the results of the project for 2 years</a></li>
<li><a href="../328750/index.html">The reverse side of the ticket. How Tutu.ru helps to choose the best rate</a></li>
<li><a href="../328752/index.html">Guide React Native - create an application for iOS. Part 1.1</a></li>
<li><a href="../328756/index.html">Orchestration of the CockroachDB DBMS at Kubernetes</a></li>
<li><a href="../328760/index.html">Do cats know how to build regression?</a></li>
<li><a href="../328762/index.html">On fear of paranoids: where did the development of an analytics system lead us to fight industrial espionage?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>