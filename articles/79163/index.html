<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why are Haiku vector icons so compact?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In Haiku, vector icons are so compact, how is it? You probably expect some kind of hack, but the secret is that HVIF (Haiku Vector Icon Format) is pre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why are Haiku vector icons so compact?</h1><div class="post__text post__text-html js-mediator-article">  In Haiku, vector icons are so compact, how is it?  You probably expect some kind of hack, but the secret is that HVIF (Haiku Vector Icon Format) is pretty simple.  Most importantly, this format is optimized for icons.  As soon as you agree with this simple assumption, immediately come the ideas of various ways to optimize the amount of data. <br><a name="habracut"></a><br><br><h4>  Coordinates </h4><br>  For example, let the icons have a standard resolution of 64x64 pixels.  It would be nice to tie the coordinates of the vector path to the integers of the squeak.  It would also be nice to be able to set coordinates beyond the borders of the icons, so we will define a range from -32 to +95 pixels, which will fit in just 7 bits.  If the coordinates are not integers, or are outside the range [-32, 95], we will use the 8th bit to specify a two-byte sequence that extends the range to [-128, 192], and the additional precision will be used for fractional values coordinates. <br><br><h4>  Paths </h4><br>  It is also useful to think about optimizing the general form of vector paths. <br>  HVIF distinguishes between three basic types: the path with commands, the path with straight lines, and the path only with curves.  All paths are curves that can represent two other forms of paths, but they require storing a large amount of data, because it‚Äôs just a joke, as many as 6 coordinates are required for each segment.  If the path includes many straight sections, or there are many horizontal and vertical lines, it will be better to associate the commands with the segments, which significantly reduces the number of required coordinates per segment.  The SVG format defines a lot more, but how can you find enough four different commands for paths that cover all the needs for icons.  This is a horizontal line, a vertical line, just a line and a cubic curve.  The first two need only one coordinate (X or Y), since the other will be unchanged with respect to the previous point.  An arbitrary line will require 2 coordinates, and the curve is already 6. Four encoded commands for the paths may take two bits, add finesse, write them separately from the coordinates, so one byte encodes up to four commands.  Let's now calculate how much data a simple rectangle with integer coordinates will occupy: <br><ul><li>  1 byte to specify the number of paths (4) </li><li>  1 byte for four path commands (2 bits may remain unused, but there is a command (line) that determines the first point anyway) </li><li>  5 bytes for coordinates (2 bytes for the first point, 3 bytes for the rest) </li></ul><br>  HVIF analyzes which commands to use when encoding to get the least data.  For example, if all curves or all lines, then there is no point in storing a section of commands. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Flags </h4><br>  Most of the icon objects are encoded with an additional reserved byte for the ‚Äúflags‚Äù, which determines which aspects need to be stored in the file.  For example, if the shape will never change - there is no point in storing the transformation matrix.  In this case, ‚Äúempty labels‚Äù for unused parameters will simply be excluded. <br><br><h4>  Matrices </h4><br>  Speaking of transformation matrices, it should be borne in mind that they can take quite a lot of space if you do not take additional measures. <br>  HVIF uses normal affine matrices for transformations, which are usually encoded with 6 double (48 bytes) or float, if you do not think about high precision (24 bytes).  To further reduce storage costs (since precision is not required for icons), HVIF uses its own floating point format, which uses only 3 bytes per value.  So the required volume for the matrix is ‚Äã‚Äãreduced to 18 bytes. <br>  Often it is required only to displace a figure, but not to rotate, cut or scale.  In this case, it makes sense to store only the offset using the same format as for the coordinates of the paths. <br><br><h4>  Styles </h4><br>  There are two kinds of styles: just color and gradient.  Section style can occupy a significant place, so there are a number of steps to reduce this indicator.  A color or gradient that does not use an alpha channel is not encoded with an alpha channel, and gray is encoded with one byte.  What type of coding for colors is also used is determined by the byte of flags of any given style.  There is also a special format for gradients with two colors, one at 0% and one at 100% offset (a very common type of gradient), where color offsets are not coded. <br>  HVIF data consists of three sections.  The first encodes all the styles, the second all the ways, and the last all the shapes.  Styles and paths are global in Haiku icons, so they can be used by various shapes.  But there should be no more than 256 styles or 256 paths in total.  Thus, the figures can refer to them with just one byte, which is an index of the style or the path in the global list.  Figures can also have attached transformations, for example, a Stroke transformer can transform a path into a stroke.  For storage of transformers nothing special was invented. <br>  As you can see, it hardly makes sense to use HVIF for general vector graphics.  This format is only suitable for very special tasks.  But, as was said, it can be useful for solving these problems, ultimately, at least in terms of the responsiveness of the working environment.  But this will not happen by itself.  If the icon is designed without knowing how HVIF works, then its potential is lost.  For example, if the coordinates of a vector path are not integer values, or if the paths are not reused, where they may be, then the icon may take up much more space than it could.  This is especially true when the SVG icon is imported into Icon-O-Matic and is simply stored in HVIF as it is, which is not good.  Some works have yet to remove redundant or unnecessary information from the icons, but now, with the information that has just been presented, everyone will be able to use optimization techniques when creating icons for Haiku. </div><p>Source: <a href="https://habr.com/ru/post/79163/">https://habr.com/ru/post/79163/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../79154/index.html">Using the Internet as a tool for sociological and biological research</a></li>
<li><a href="../79156/index.html">Does the Russian research institute continue Tesla's experiments?</a></li>
<li><a href="../79159/index.html">Star Wars style blogging</a></li>
<li><a href="../79160/index.html">Yandex and New Year's gifts</a></li>
<li><a href="../79162/index.html">Strange links to dirty.ru</a></li>
<li><a href="../79164/index.html">Criticize the Drupal site</a></li>
<li><a href="../79165/index.html">Traffic consumption by country</a></li>
<li><a href="../79167/index.html">Telecom capital in December</a></li>
<li><a href="../79168/index.html">FineReader Online - Beta 3</a></li>
<li><a href="../79169/index.html">Yuri Zisser apologized to the designers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>