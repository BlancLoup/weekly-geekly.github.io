<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Formula white mane horses: perlin noise in pictures</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Surely anyone who met with "perlin noise" ( perlin noise ), tried to generate the texture of the clouds. 
 Because it suggests itself. 

 On the noise...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Formula white mane horses: perlin noise in pictures</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://www.youtube.com/watch%3Fv%3DqjLpuSTviHY"><img src="https://habrastorage.org/getpro/habr/post_images/7ae/5d1/365/7ae5d1365adfa46fea7e00a341a506fb.jpg"></a> <br><br>  Surely anyone who met with "perlin noise" ( <a href="http://en.wikipedia.org/wiki/Perlin_noise">perlin noise</a> ), tried to generate the texture of the clouds. <br>  Because it suggests itself. <br><br>  On the noise of Perlin on Habr√© was already an <a href="http://habrahabr.ru/post/142592/">article</a> , but it has very few pictures. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  In short, the essence of pearly noise is as follows: uniformly distributed random points are connected by a smooth gradient. <br>  It looks not particularly attractive: <br><img src="https://habrastorage.org/getpro/habr/post_images/e3a/e60/101/e3ae601010465599a9c52aeba9afe940.png" height="360" width="360"><br>  However, if you take only the upper half of the waves, do it twice, at 4, and at 8, and put it all together, you will get very recognizable clouds: <br><img src="https://habrastorage.org/getpro/habr/post_images/140/de8/b97/140de8b975f142fe852ee8f89e371a9a.png" alt="image">  <b>+</b> <img src="https://habrastorage.org/getpro/habr/post_images/7ad/1d3/a94/7ad1d3a94b454dd89397d686a75897bf.png" alt="image">  <b>+</b> <img src="https://habrastorage.org/getpro/habr/post_images/0c6/76f/72a/0c676f72ab9f66480af8f9606a4e2f46.png" alt="image">  <b>+</b> <img src="https://habrastorage.org/getpro/habr/post_images/7b8/177/ea8/7b8177ea8912c63a62827f5c10813b87.png" alt="image">  <b>=</b> <img src="https://habrastorage.org/getpro/habr/post_images/4b0/064/1fe/4b00641feafe455ea544cd4a959859e0.png" alt="image"><br>  Almost the same, but 8 times: <br><img src="https://habrastorage.org/getpro/habr/post_images/29e/3f9/576/29e3f95762902f6ed13c032bd5252ab8.png" alt="image"><br><br>  By the squiggle in the center, it is clear that such a construction is fractal, and inevitably has a vanishing point (fixed point).  Neighboring squiggles, too, hinted at her.  In practice, this does not particularly interfere, or you can shove it somewhere far away. <br><br>  Here is how the formation of clouds in the texture space: <br><img src="https://habrastorage.org/getpro/habr/post_images/0b0/850/dc3/0b0850dc33b0aff49bd592c8c44e2ec1.gif" alt="image"><br><br>  A reasonable question arises - why are the levels scaled exactly in two times? <br>  Here is an example of an 8-tier cloud with different scaling coefficients: <br><img src="https://habrastorage.org/getpro/habr/post_images/657/c8b/370/657c8b37005a1ca1f02afe5a246c5ecc.gif" alt="image"><br>  It can be seen that before 1.6 the cloud is not curly enough, and after 2.6 the cloud is too pimply. <br><br>  You can try to substitute magic numbers: <br><img src="https://habrastorage.org/getpro/habr/post_images/c4f/214/696/c4f214696f0f9616855deb8b533ae2e5.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/267/91d/07b/26791d07be6d0c968fa038b2d9950c84.png" alt="image"><br>  The golden ratio is a little more blurred, the number e is a bit more crowded. <br>  No miracle happened.  Although sometimes with numbers it happens. <br>  Two. <br><br>  So, the cool cloud formula is: <br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> acc = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> amp = <span class="hljs-number"><span class="hljs-number">1.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;layers; i++){ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> v = noise(<span class="hljs-string"><span class="hljs-string">"perlin"</span></span>, scale*pnt); acc += v * amp; amp *= <span class="hljs-number"><span class="hljs-number">.5</span></span>; scale *= <span class="hljs-number"><span class="hljs-number">2.0</span></span>; } <span class="hljs-comment"><span class="hljs-comment">// max(acc) = (2^n - 1) / 2^n acc *= (float)(1&lt;&lt;(layers)) / (float)((1&lt;&lt;(layers)-1)); return acc * 0.5 + 0.5; }</span></span></code> </pre> <br>  Here pnt is a point in the texture space for which the cloud factor is calculated.  For example, UV. <br>  The noise function (method, coords) generates the perlin noise value for a given point, in the range from -1 to +1. <br>  There are, for sure, in any graphic library, as well as in the above mentioned habrastiat. <br><br>  Armed with this formula, you can generate this texture in 3d, and pull it onto a sphere (without bothering with spherical projections, but simply substituting the coordinates of a point of a sphere in space): <br><img src="https://lh3.googleusercontent.com/-pQwH0xcX0aQ/URi7a8RPJvI/AAAAAAAABuU/KN53XblelWY/s800/perlin-4lvls-3d-sphere.png" alt="image"><br><br>  You can also generate a four-dimensional texture, and, shifting in time, get live clouds: <br><img src="https://lh3.googleusercontent.com/-7yiKXIArer4/URi7bVIlEoI/AAAAAAAABuk/b3y-O2bbYp0/s800/perlin-4lvls-4d-sphere.gif" alt="image"><br><br>  For greater persuasiveness, the texture 3d coordinate can still be rotated 30 degrees along the equator, proportional to the square of the cosine of latitude: <br><img src="https://lh3.googleusercontent.com/-Cc2f7o4jlVA/URi7aasl3KI/AAAAAAAABuM/aqB8Zxr_79k/s800/perlin-4lvls-3d-sphere-swirl.png" alt="image"><br>  Why 30 degrees and the cosine square - I do not know, but this is how real clouds look on the planet. <br><br>  In fact, real clouds on planet Earth, according to NASA (http://visibleearth.nasa.gov/), look like this: <br><img src="https://lh6.googleusercontent.com/-2v9B--2-tiw/URjIaakog9I/AAAAAAAABv8/cy_eCChmp9I/s800/clouds-nasa.png" alt="image"><br>  And the resulting texture has little to do with them. <br><br>  First, the clouds need to be pulled out. <br>  For decoupling, for each point it is necessary to shift the texture coordinate in some direction, moreover, so that at nearby points the displacement differs slightly.  The easiest way to calculate the offset is to use the pearl noise again. <br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Distortion != <span class="hljs-number"><span class="hljs-number">0.0</span></span>) { point sp = scale[<span class="hljs-number"><span class="hljs-number">0</span></span>] * pnt.p; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> st = scale[<span class="hljs-number"><span class="hljs-number">1</span></span>] * pnt.t; pnt.p[<span class="hljs-number"><span class="hljs-number">0</span></span>] += Distortion * noise(<span class="hljs-string"><span class="hljs-string">"perlin"</span></span>, sp + <span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>), st); pnt.p[<span class="hljs-number"><span class="hljs-number">1</span></span>] += Distortion * noise(<span class="hljs-string"><span class="hljs-string">"perlin"</span></span>, sp + <span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>), st); pnt.p[<span class="hljs-number"><span class="hljs-number">2</span></span>] += Distortion * noise(<span class="hljs-string"><span class="hljs-string">"perlin"</span></span>, sp + <span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>), st); pnt.t += Distortion * noise(<span class="hljs-string"><span class="hljs-string">"perlin"</span></span>, sp, st + <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre><br>  Here float scale [2] - scales in space and time, pnt - struct {point p;  float t;  } coordinates 4d-points. <br>  If you try to save on calls to the function of noise, you will get all sorts of obscenities such as this: <br> <a href="https://picasaweb.google.com/lh/photo/s_9kP5xLqpEUDtw2TRmRXdMTjNZETYmyPJy0liipFm0%3Ffeat%3Dembedwebsite"><img src="https://lh4.googleusercontent.com/-K1EyvVDB2yM/URi7dJwDiyI/AAAAAAAABvI/HPf6XQTWTEU/s400/weirdfractalcloud0104.jpg" height="225" width="400"></a> <br>  And you need to get a continuously distorted texture in space and time: <br><img src="https://lh4.googleusercontent.com/-nxcI6vgr2WY/URjPVpBlsHI/AAAAAAAABwY/8NmBf4IH4ZU/s800/perlin-distortion.gif" alt="image"><br><br>  Secondly, on the planet the clouds are spread quite torn, and near look like purebred Perlon noise (with scales from 8 to 16 from the size of the planet). <br><br>  The best I‚Äôve come up with in a week is to multiply the clouds. <br>  Large clouds, meaning mega-air currents, multiplied by small, sheep - as a result, the cloud clouds, distributed along the mega-streams. <br><img src="https://lh5.googleusercontent.com/-QHPrSU2l8Gs/URjTeti627I/AAAAAAAABxE/h-ZCpk1KjMA/s288/clouds-canvas.png" alt="image">  <b>‚àó</b> <img src="https://lh4.googleusercontent.com/-8neiyJ9eWk4/URjTeof5yRI/AAAAAAAABxE/b_2piEnWV5Q/s288/clouds-cumulus.png" alt="image">  <b>=</b> <img src="https://lh4.googleusercontent.com/-Mx-t8BAbERM/URjTenWlWkI/AAAAAAAABxE/8mLQ6z88Hek/s288/clouds-product.png" alt="image"><br><br>  This is much more like the truth. <br><img src="https://lh4.googleusercontent.com/-ZRA1tubo-Fg/URjYncgiJUI/AAAAAAAAByA/W-HPpUogjys/s800/clouds-result.png" alt="image"><br>  Real clouds have varying degrees of graininess, but it‚Äôs already too lazy to bother with it. <br>  There was an idea to make another very large cloud and its value to use as a scale parameter for small ones. <br>  This focus did not work - at the boundaries of the scale, wing clouds are indecently shrinking. <br>  In addition, when the planet rotates, the clouds at the equator slow down (this gives a 30 degree twist), but how to do it so that the texture does not twist into the trash, and evaporate smoothly - I did not think of it. <br>  It is probably necessary to use 5d texture, and to displace the twist in the 5th dimension, but bledner and open shading language on which it was coded, 5d do not support.  Such a shame ... <br><br>  However, against the background of the present planet such clouds look quite decent: <br><img src="https://lh4.googleusercontent.com/--fz0DSHhO7w/URjqbypQvcI/AAAAAAAABzE/doU3EsK8O50/s800/clouds-mars-perlin.png" alt="image"><br>  Although rendered 1.5 times longer. <br><br>  An animated comparison of nasa vs perlin is <a href="http://www.youtube.com/watch%3Fv%3DqjLpuSTviHY">uploaded to youtube</a> . <br>  All the pictures, including the highs of ‚Äúlewdness‚Äù are in the <a href="https://picasaweb.google.com/101319265639002430248/PerlinNoise">pico-album</a> . <br>  Well, <a href="https://docs.google.com/file/d/0B1CnZRX0nrEQQWlEVXdLOWVXZm8/edit%3Fusp%3Dsharing">blender-file</a> with all the constructions and scripts on OSL. </div><p>Source: <a href="https://habr.com/ru/post/169001/">https://habr.com/ru/post/169001/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168989/index.html">Review of Mark Siman's book "Dependency Injection in .NET"</a></li>
<li><a href="../168991/index.html">VDI & APP-V 5.0 & RDS Windows Server 2012 from ex-architect Microsoft</a></li>
<li><a href="../168993/index.html">Small talk about dough-driven baking</a></li>
<li><a href="../168997/index.html">We move information about users in Active Directory and Sharepoint using PowerShell</a></li>
<li><a href="../168999/index.html">Motion system do-it-yourself for $ 13</a></li>
<li><a href="../169003/index.html">Tablet as a second screen under linux</a></li>
<li><a href="../169005/index.html">Internet startup risk management. Part one</a></li>
<li><a href="../169007/index.html">Compressed video review of the latest version of the BlackBerry 10 operating system</a></li>
<li><a href="../169015/index.html">What can be obtained from the integration of 1C: CRM 8 and Asterisk telephony</a></li>
<li><a href="../169017/index.html">Job Safety Driven Development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>