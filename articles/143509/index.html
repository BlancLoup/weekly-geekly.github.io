<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Continuous TFS 11 Integration</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, colleagues. 

 The long holidays end, and tomorrow, we will again plunge into the abyss of the daily routine. Today, at the junction o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Continuous TFS 11 Integration</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage2/c88/3d6/aad/c883d6aadccc3b1ec28873a7c40deaa1.png"><br>  Good afternoon, colleagues. <br><br>  The long holidays end, and tomorrow, we will again plunge into the abyss of the daily routine.  Today, at the junction of the holidays that have not yet ended and the working week that has not yet begun, I would like to talk a little about <a href="http//ru.wikipedia.org/wiki/%25D0%259D%25D0%25B5%25D0%25BF%25D1%2580%25D0%25B5%25D1%2580%25D1%258B%25D0%25B2%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B5%25D0%25B3%25D1%2580%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">continuous integration</a> . <br>  Starting to introduce Agile practices in the development, many, reading: "Personalities and their interactions are more important than processes and tools," come to the delight.  After all, you can assemble a team, rally them, set tasks and here it is: ‚Äúthe star of captivating happiness‚Äù (working and useful for software users).  But, unfortunately, in life everything is much more boring and unpredictable.  Starting to introduce a new-fangled Scrum or Kanban, it is often forgotten that all the advantages of these techniques manifest themselves only if they fall on the correct engineering practices.  These practices include unit testing in general, and TDD in particular;  pair programming;  Code Review;  continuous integration and more. <br>  Under the cat, I will try to show how to configure continuous integration within TFS 11 and in which scenarios, which way to build projects will be most justified (a lot of pictures and text). <br><a name="habracut"></a><br>  So, anticipating the main content, a couple of words about what is needed to repeat everything described below in the article: <br>  1. Installed TFS 11 <br>  2. Visual Studio 11 or 2010. <br>  Download TFS 11 and VS 11 from the <a href="http://www.microsoft.com/visualstudio/11/ru-ru/downloads">Microsoft</a> website. <br>  If you do not have TFS 11, but there is TFS 2010, then with differences in the user interface, but you can configure everything described in the article in it. <br><br><h5>  Team Foundation Build Service Setup </h5><br>  If you have already configured the Build Service, then immediately go to the <a href="https://habr.com/ru/post/143509/">second part of the article</a> . <br>  Starting the TFS Administration Console and selecting Build Configuration, you will see the following prompt: <br><img src="https://habrastorage.org/storage2/b8e/790/20a/b8e79020ad8a36a6fd45510de1db51b7.png"><br>  Configuring!  The wizard is quite simple, we skip its first screen immediately Next: <br><img src="https://habrastorage.org/storage2/0a0/8e1/87c/0a08e187cfbd83559b15454d36173a8b.png"><br>  In the second step, you need to specify with which collection of projects and on which TFS server the configured Build Service will work.  By default, the first collection of the current TFS server is selected: <br><img src="https://habrastorage.org/storage2/f5c/0d8/af8/f5c0d8af87988c950e73d5477474c751.png"><br>  In the third step, you have to decide how many agents will be served by the builds within this server.  If you select 1, then all build requests will be queued; after the completion of compilation of one project, the next query from the queue will be compiled.  The main advantage of this approach is to reduce server load, minus - if projects are compiled for a long time, and the queue is long, then you will have to wait.  When increasing the number of Build Agents, the queue will be serviced faster, the main thing is that with a huge number of them, the server will not spend more time switching between agents than the compilation itself: <br><img src="https://habrastorage.org/storage2/30d/93f/220/30d93f2203df53c6057b0d7e8af829ae.png"><br>  On the final screen, we will be asked to indicate with which credentials you need to run the Build Service.  If you plan to only compile projects without deployment to a test and / or production environment, then you can leave the default value.  Otherwise, choosing an account for the Build Service must take into account what rights the account must have to perform these tasks. <br>  Actually setting this ends.  There are two more screens ahead, with what we have chosen and checking whether it is possible to configure what is selected.  Clicking Configure on Readiness Check and waiting for the end of the configuration, we will see: <br><img src="https://habrastorage.org/storage2/b8f/a69/c12/b8fa69c12194f53a4dd83dddbb2cec61.png"><br>  If you consistently reached this place, then the Build Configuration in the TFS administration console will look like this: <br><img src="https://habrastorage.org/storage2/9c1/2fe/0e0/9c12fe0e02358cff265ce9a548dd8b93.png"><br>  This is where you can finish working with the Team Foundation Server administration console and go to Visual Studio. <br><a name="PartTwo"></a><br><h5>  Demonstration environment </h5><br>  For clarity, let's take a simple WPF application that should be in the Source Control.  We will also add a project with unit tests that will test the functionality from the first project. <br>  The folder structure in TFS for this article is: <br><img src="https://habrastorage.org/storage2/1ed/df9/cff/1eddf9cff4e7980d33bbb1c7ce06c899.png"><br>  Yes, until I forgot, the network folder should act as a folder where the built solutions will take shape.  To which, the account under which the Build Service is running must have access. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  1. Manual request for solution building </h5><br>  Immediately make a reservation, manual launch and continuous integration, these are concepts from different tales.  Continuous integration implies automatic, regular construction of projects, without human intervention.  But, since  manual building requests are the easiest, and setting up for all other launch cases will be very reminiscent of manual requests, then let's start with it. <br>  <i>Scenario:</i> <br>  You have a branch in which you are developing.  And there is a branch in which you store the version of the project that is deployed in the operational environment.  From time to time, there are errors in the working version.  You download the corresponding project, correct the error, check it on the local developer‚Äôs computer, place it in the Source Control.  Testers and / or deployment specialists need to build this solution.  To do this, they will perform a manual request. <br>  <i>Setup:</i> <br>  On the Team Explorer home page, select Builds and in the New Build Definition tab that opens: <br><img src="https://habrastorage.org/storage2/a0e/4b6/d80/a0e4b6d80fbf68781b250227334141e4.png"><br>  In the first step of the wizard to create a new Build Definition, we need to specify the name by which we will further identify this build request.  For this example, I added the suffix "_manual" to the name suggested by default: <br><img src="https://habrastorage.org/storage2/388/363/8e5/3883638e5b55af266c749f4009d4d2a3.png"><br>  The second step allows you to configure when the Build Agent should be active and run the build.  The default value of Manual suits us well: <br><img src="https://habrastorage.org/storage2/230/79e/37f/23079e37f357699cc79a30370ea80854.png"><br>  The third step allows you to specify the location of the solution folder in the Source Control and the location of the Build Agent on the server.  In most cases, these values ‚Äã‚Äãcan be left as default. <br>  The fourth step allows you to specify with which controller we will build, as well as the folder into which the output project should be placed (Staging location).  Moreover, the first placement option (do not copy files to the output folder) is justified if you just want to build the project, run all the Unit Test on it, and you do not need the resulting exe and dll.  The third option (put the result of the construction in the Source Control) may be convenient for developers, in order not to lose the stable Build.  But basically, of course, the second option is used, when the results of the construction will be copied to a network folder.  Moreover, for each launch of Build Definition a nested folder is created, and all constructions, by default, are saved according to the following scheme: &lt;project name&gt; _ &lt;build date&gt;. &lt;Build number for build date&gt;. <br><img src="https://habrastorage.org/storage2/78f/966/cd8/78f966cd86c73cddac311bc93bc1db55.png"><br>  In the penultimate step, we define general construction settings.  Please note that by default, the open sln is immediately selected and the launch of unit tests is worth it: <br><img src="https://habrastorage.org/storage2/404/f40/bb9/404f40bb9a20af8389a13e6f83582fa1.png"><br>  But, of course, the build mode can be changed.  For example, configuration changes in which to compile the project: <br><img src="https://habrastorage.org/storage2/9b1/822/168/9b18221683e80f74d4ccd3d82da13678.png"><br>  Save the Build Definition using the Save button from the toolbar.  Team Explorer has a new Build Definition: <br><img src="https://habrastorage.org/storage2/b25/dbd/e11/b25dbde1113a5643b262e75112d0eea3.png"><br>  In order to run it, just open the context menu on it and select ‚ÄúQueue New Build ...‚Äù.  In the window that opens, click "Queue".  And we see that we are building, well, at the end, the pictogram will tell us about the result of the construction: <br><img src="https://habrastorage.org/storage2/d0a/965/949/d0a9659491bb1388a0a9e61299ad477e.png"><br>  Double-click on the build will allow you to view detailed information, including the result of the execution of modular tests: <br><img src="https://habrastorage.org/storage2/3c8/2da/c97/3c82dac9787b376b56a37f250f819f5b.png"><br>  Everything, with manual start and the main requests I finish.  Let's quickly go through the rest of the scenarios. <br><br><h5>  2. Building a solution for each code location in Source Control </h5><br>  <i>Scenario:</i> <br>  Developers write code, unit tests.  Putting it all in the code repository.  We want to be sure that this is all going to and pass all tests. <br>  <i>Settings:</i> <br>  Setting up a new Build Definition will differ only in the first step (you must give a different name) and in step 2 of the wizard.  We specify the second option as a trigger: <br><img src="https://habrastorage.org/storage2/404/d1f/c4a/404d1fc4a8ac862ca5a508e7b4a0dc6e.png"><br>  To start building, it is enough to make changes to the code of projects or unit tests and place the changes in the Source Control.  At the end of Check In, if we go to the Builds tab in the Team Explorer panel, we will immediately see that our construction is running.  Incidentally, I added a new test to the project, which failed: <br><img src="https://habrastorage.org/storage2/df2/f6b/f65/df2f6bf65409eb4e019ad80e5f4da484.png"><br>  We can also open the details of this construction and analyze what went wrong. <br>  With this build scenario, there is a significant drawback.  If there are a lot of developers, they work on TDD (frequent Check-in), and the complete construction of the project and the test run take 5-10 minutes, then the build queue at 1 Build Agent will be very long and you will have to wait for changes in the Source Control build result. <br><br><h5>  3. Building on the Check-In but not more often than ... </h5><br>  <i>Scenario:</i> <br>  The script is the same as in option 2, but the TFS server cannot cope with it, and the management does not provide money for a separate Build Server. <br>  <i>Setup:</i> <br>  Similarly manual, at the second step we select the third option of construction: <br><img src="https://habrastorage.org/storage2/381/a84/71a/381a8471ae440fb523c1a375c617b826.png"><br>  We are correcting the project so that the test-check introduced in the previous paragraph passes.  And we see that two constructions started right away.  The one that needs to be run on each Check-In and the one that needs to be run on Ckeck-In, but not more than once per hour (pay attention to the icon indicating that the construction is in the queue): <br><img src="https://habrastorage.org/storage2/c34/735/1e2/c347351e2fc9c26a2d7a9ad7661b539a.png"><br>  True, with the next Check-In, if it happens earlier than in 60 minutes, our new building will not be launched. <br>  Using these two types of constructions, we can, for example, build a project for each Check-In without running the tests, and at least once an hour build a test with the launch of tests. <br><br><h5>  4. You can not put the code in the Source Control, if it is not compiled </h5><br>  <i>Scenario:</i> <br>  You have a new developer in your team who forgets to check before compiling the code in Source Control, does he even compile? <br>  <i>Setup:</i> <br>  Create a new Build Definition, give it a name, and select the 4th option to trigger the start of the build: <br><img src="https://habrastorage.org/storage2/3fa/31b/cbb/3fa31bcbb824ac34de770c8412bbda95.png"><br>  We make changes to the code (of course, so that it stops compiling) and when trying to Check In, this notification: <br><img src="https://habrastorage.org/storage2/b99/6c6/849/b996c68498cd6bc00846fd1b7073c359.png"><br>  And after launching the compilation, in Team Explorer we will be unequivocally reminded that we need to wait until the end of the build, and after the end of the compilation, a notification pops up: <br><img src="https://habrastorage.org/storage2/72f/7a3/f8a/72f7a3f8a19e1995fe2f81df34afd806.png"><br>  Conveniently, damn it! <br><br><h5>  5. Daily builds </h5><br>  <i>Scenario:</i> <br>  How do you not have daily builds yet?  Then urgently read the 3 point test Joel Spolsky (http://russian.joelonsoftware.com/Articles/TheJoelTest.html). <br>  <i>Setup:</i> <br>  Well, you probably already know, create a new Build Definition, change the name, and in the second step we ask on which days and at what time to compile: <br><img src="https://habrastorage.org/storage2/57c/f66/976/57cf66976bc358cd0ba10ca02bdb4222.png"><br>  Every night, the evil Build Agent will come and compile, compile, compile. <br><br><h5>  Instead of conclusion </h5><br>  Do you still live in a world without continuous integration?  If yes, then nothing! <br>  As you can see, the setup takes not so much time, but the result from the fact that your project is compiled regularly, subjected to testing with unit tests, etc., you will feel almost immediately. <br>  And finally, the new version of the VS design I like.  Everything is very convenient and clear: <br><img src="https://habrastorage.org/storage2/7e6/48b/cfe/7e648bcfe80e745936c4a01e0abac5a0.png"></div><p>Source: <a href="https://habr.com/ru/post/143509/">https://habr.com/ru/post/143509/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143500/index.html">Twitter stood up for its user before the court of the state of New York</a></li>
<li><a href="../143501/index.html">The site of the Kremlin has undergone a DDoS attack</a></li>
<li><a href="../143502/index.html">Export exams from Visual CertExam to Anki</a></li>
<li><a href="../143503/index.html">How to learn to read someone else's code</a></li>
<li><a href="../143508/index.html">Want to find out why major publishers make slop applications? Look in the mirror</a></li>
<li><a href="../143510/index.html">Network on a chip - mini-internet inside the processor</a></li>
<li><a href="../143511/index.html">Linux laptop designed for developers</a></li>
<li><a href="../143512/index.html">Tips on how to properly configure your TV</a></li>
<li><a href="../143513/index.html">Millions of visitors to WordPress against the server</a></li>
<li><a href="../143515/index.html">Full-length 3D Teleconference Cab (Star Trek Style)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>