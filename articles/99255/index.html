<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Virtualization: recommendations of leading dog owners</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Before building an infrastructure based on virtualization, and even more so to introduce it into commercial operation, it is necessary to ensure that ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Virtualization: recommendations of leading dog owners</h1><div class="post__text post__text-html js-mediator-article">  Before building an infrastructure based on virtualization, and even more so to introduce it into commercial operation, it is necessary to ensure that the system resources are used most efficiently and the performance is maximum.  In this series of articles, I will give recommendations on how to optimize the system for performance, both from the host side and from the virtual machines side. <div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/16/75/16753f5bc29b12e6d4a1cca704609508.jpg" alt="image"></div><br><br><a name="habracut"></a><br><br><h4>  Let's start with the host </h4><br>  Since servers hosting virtual machines often run at peak loads, the performance of such servers is crucial for the performance of the entire system.  Potential "bottlenecks" can be: <br><ul><li>  CPU </li><li>  Memory </li><li>  Disk subsystem </li><li>  Network subsystem </li></ul><br>  Here I will tell you how to identify bottlenecks in all four areas and how to deal with them, and most importantly, how to avoid them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  The processor is the heart of the computer </h5><br>  The "heart" of any computer is the processor.  And the correctness of the choice of processor in the context of virtualization - it becomes even more important.  The processor is the most expensive part of any computer, and the choice of a too powerful processor can lead to unnecessary costs not only for the purchase of the processor itself, but also in the future for electricity and cooling.  If the processor is not powerful enough - the system will not be able to provide the necessary performance, which can result in the purchase of a new processor - and, therefore, costs again. <br>  We need to get answers to the following key questions: <br><ul><li>  How many processors to install? </li><li>  How many need cores? </li><li>  Their speed characteristics? </li></ul><br>  Answering these questions is not as easy as it sounds.  A simple example: which system to use - dual-processor or four-processor?  At the price of dual-processor systems in an unconditional win: the price of one four-processor server is approximately equal to three dual-processor.  It would seem that in this case the best solution is to buy three dual-processor servers and combine them into a failover cluster ‚Äî and you can get a more high-performance and fault-tolerant solution.  But on the other hand, in such cases ... There are many new costs: <br><ol><li>  More software licenses are required - both on the OS and on the management software (SCVMM, SCCM, SCOM, etc.) </li><li>  Administration costs increase - three servers instead of one </li><li>  Three servers consume more power, which means they generate more heat and take up more rack space than a single server, albeit a more powerful one. </li></ol><br>  After that, it may turn out that it would be better to use a four-processor server, which can and will cost a little more and be less fault-tolerant - together with all overhead costs it may still be cheaper. <br>  Nevertheless, the performance of the system as a whole may depend not only and not so much on the processors.  Take, for example, a DBMS.  In some cases, the requirements for the processor may not be too high, but the disk subsystem can be used very actively.  And if in this DBMS business logic and analytics (OLAP, reports) are actively used, then on the contrary, the requirements for the processor and memory can be much higher than for the disk subsystem. <br>  To determine whether the processor is a bottleneck in the system, you need to know how heavily it is loaded.  For this, different system utilities can be used.  For example, many system administrators are accustomed to using the standard Windows Task Manager.  Unfortunately, due to the peculiarities of the Hyper-V architecture, this Task Manager will show not the weather in Honduras, and not the Zimbabwean dollar rate, but only the CPU load of the host OS.  Virtual machines will not be taken into account in this case - since the host OS, in the same way as all virtual machines, works in its isolated partition.  Therefore, you need to use the Perfmon snap-in.  Many administrators, especially those who passed the MCSA exams, know about this utility.  For those who still do not know - it starts quite easily: <i>Start - Administrative Tools - Reliability and Performance</i> .  From this snap-in, we need the <i>Monitoring Tools - Performance Monitor</i> branch. <br>  With the help of this utility, you can see the values ‚Äã‚Äãof almost any system parameters, as well as observe their change on the graph.  By default, only one parameter is added (in terms of Perfmon - ‚Äúcounter‚Äù or ‚Äúcounter‚Äù) - ‚Äú% Processor Time‚Äù.  This counter shows the same thing as Task Manager - the CPU load of the host OS.  Therefore, this counter can be deleted. <br>  We proceed to add counters.  Perfmon has many Hyper-V-related counters.  Of these, we are currently interested in two: <br><ul><li>  <b>Hyper-V Hypervisor Virtual Processor,% Total Run Time</b> - this counter displays the load of virtual processors.  You can set the display of the total load of all processors for running virtual machines, or you can select a specific virtual processor of a specific virtual machine. </li><li>  <b>Hyper-V Hypervisor Root Virtual Processor,% Total Run Time</b> - and this counter shows the loading of selected logical processors with tasks not related to Hyper-V. </li></ul><br>  <i>Note: What is a logical processor?</i>  <i>The easiest way to understand this is by example.</i>  <i>Suppose if you have one processor with one core, you will have one logical processor.</i>  <i>If the processor is dual-core, then there will already be two logical processors.</i>  <i>And if he supports Hyper-Threading, there will be four of them.</i> <br>  These two counters will help to get a real picture of the host processor load.  The counters are measured in percent, and, accordingly, the closer they are to 100% - the higher the CPU load, and it may be worth considering buying additional or new, more powerful processors. <br><br><h5>  Memory does not happen much </h5><br>  A powerful processor is good, but with a lack of memory, the system begins to use paging files, and performance begins to fall almost exponentially.  As they say on the Internet - "512 megabytes is not a memory, it is insanity." <br>  Unfortunately (and most likely fortunately) in Hyper-V it‚Äôs impossible to allocate more memory to virtual machines than is physically present in the system.  This is what is called ‚Äúmemory overcommit‚Äù, and the marketing of other virtualization solutions vendors plays with such joy.  For better or worse, this is a topic for a separate article, and quite a few virtual copies have been broken about this topic. <br>  In this regard, the question arises: how much memory do we need as a result?  The answer depends on various factors: <br><ul><li>  <b>How many virtual machines will be running, and how much memory will they need?</b>  The amount of memory required for each virtual machine depends on the tasks it will perform.  The approach is the same as for conventional servers, but virtual machines can allocate memory more flexibly - not 1024 MB, but, for example, 900 MB. </li><li>  <b>The host OS also needs memory.</b>  It is recommended to leave at least 512 MB of free memory for the needs of the hypervisor and the host OS itself.  If the amount of free memory drops below 32 MB - the system will not allow to run more than one virtual machine until the memory is free.  In addition, in the host OS can perform some other tasks, in addition to virtualization.  Although it is not recommended, but the fact still has a place to be, and this must be taken into account. </li><li>  <b>Other virtual machines (for Live Migration scripts).</b>  If the infrastructure is planned on the basis of a failover cluster, then additional memory should be provided on each of the hosts.  The fact is that virtual machines can move from one host to another in the case of a manual move (Live Migration), or in the event of a failure of one of the hosts.  If there is not enough memory on the host to start roaming virtual machines, then they simply won't be able to start on it.  Therefore, at the design stage, it is necessary to provide an ‚Äúemergency supply‚Äù in the amount of 50-100% of the required memory capacity.  Perhaps the situation will improve slightly with the release of Windows Server 2008 R2 SP1, which includes dynamic memory allocation technologies, but I can only say for sure when I test it myself. </li></ul><br>  How do we see what happens to memory?  Fortunately, you can look through your favorite Task Manager - in contrast to the CPU load, it will show memory usage fairly true.  And you can (and even need to) resort to the familiar Perfmon and its <b>Memory / Available Mbytes and Memory / Pages / Sec</b> counters. <br><br><h5>  Hard drives: how many need them? </h5><br>  As a rule, it is quite difficult to predict how much disk space virtual machines will need to work.  And therefore, situations where there is not enough disk space, or vice versa - when there are too many of it and the disks are idle - are quite common. <br>  In addition to volume, there is another very important characteristic - the speed of the disk subsystem.  2 TB of disk space is certainly good, but if these are two SATA disks that are not combined into a RAID array, then the bandwidth may simply not be enough, and this will greatly affect the system performance. <br>  Planning the storage subsystem includes the following aspects: <br>  Controllers.  The hard disk controllers can have different bus widths, different cache sizes, and in general their performance can vary greatly.  Some controllers are completely ‚Äúhardware‚Äù, that is, they process all requests independently, and some are ‚Äúhalf-soft‚Äù, that is, the processor of the computer itself performs part of the request processing.  The speed of the disk subsystem depends primarily on the type of controller, and you need to choose the controller correctly. <br>  Type of disks.  Hard drives, in addition to volume, have many other characteristics that should not be forgotten.  This includes the interface type (IDE, SATA, SCSI, SAS), and the spindle speed (7200, 10000, 15000 rpm), and the cache size of the hard disk itself.  The difference, for example, between a disk at 7200 and 10000, and even more so - 15000 rpm, or between 8 and 32 MB of cache memory - for such high-load systems as virtualization hosts - is quite high. <br>  The number of disks and the type of RAID array.  As already mentioned, sometimes, in order to achieve higher performance and reliability, the best solution would be not to install a single large disk, but to combine several smaller disks into a RAID array.  There are several types of RAIDs: <br><ul><li>  RAID 0 - ‚Äúinterleaved array‚Äù.  Information is written in blocks (‚Äústripes‚Äù) simultaneously on several disks.  Due to this, reading and writing large amounts of information is much faster than from a single disk, and the faster, the more disks in the array.  But there is one big drawback: low reliability.  Failure of any of the disks will lead to complete loss of information.  Therefore, in practice, RAID 0 is used quite rarely.  One example is the intermediate backup storage in the ‚ÄúDisk-to-disk-to-tape‚Äù model, when reliability is not as important as speed. </li><li>  RAID 1 - "mirroring".  With this model, information is recorded simultaneously on several disks, and the contents of all disks are absolutely identical.  The speed of writing and reading is not higher than for a single disk, but much higher reliability: the failure of one disk will not lead to loss of information.  There is only one drawback: the high cost - where there is enough one disc - you have to install two or more.  Meaning is when reliability is crucial. </li><li>  RAID 4 and RAID 5 - ‚Äúinterleaving with parity‚Äù.  It represents a kind of "middle ground" between RAID 0 and RAID 1. The idea is that the information is stored on disks as in the case of RAID 0 - interleaved blocks, but in addition, the checksums of the stored data are calculated.  In case of failure of one of the disks - the missing data is automatically calculated from the available data and checksums.  Of course, this leads to a decrease in performance, but at the same time, data is not lost, and when replacing a failed disk, all information is restored (this process is called rebuilding the array).  Data loss will occur only when two or more disks fail.  Such arrays are distinguished by the fact that their write speed is much lower than the read speed.  This is due to the fact that when writing a block of data, the checksum is calculated and written to disk.  RAID 4 and RAID 5 differ in that in RAID 4 checksums are written to a separate disk, and in RAID 5 they are stored on all disks in the array, along with the data.  In any case, to organize such an array, you need N disks for data storage plus one disk.  Unlike RAID 1 and RAID 10, where the number of drives simply doubles. </li><li>  RAID 6 is also RAID DP, double-parity, double parity.  Same as RAID 5, but checksums are calculated twice using different algorithms.  Although the disks here no longer require N + 1, as with RAID 5, but N + 2, but such an array can survive even the simultaneous failure of two disks.  It is relatively rare, as a rule - in Enterprise-level data storage systems, for example, NetApp. </li><li>  RAID 10 is a ‚Äúhybrid‚Äù of RAID 0 and RAID 1. It is a RAID 0 of several RAID 1 (and then called RAID 0 + 1) or vice versa - RAID 1 of several RAID 0 (RAID 1 + 0).  It is distinguished by the highest performance, both in writing and reading, but at the same time it is also distinguished by its high cost - since disks require 2 times more than is necessary for data storage. </li></ul><br>  As you can see, the choice of disks is quite a difficult task, so you need to choose, based not only on the requirements for disk space, but also on performance requirements, and of course, from allocated budgets.  Sometimes it will be more justified to use external data storage, for example - when it comes to large volumes and / or high performance that cannot be achieved using internal disks.  And when infrastructure with high resiliency is planned, then there is certainly no escape from external storage.  External storage systems should be selected based on the same principles as internal disks: interface bandwidth, number of disks, type of disks supported by RAID arrays, additional functions such as changing volumes of virtual disks (LUNs) on the fly, the ability to use snapshots, etc. <br>  What about measurements?  There are several counters related to the performance of the disk subsystem.  Of interest are the following: <br><ul><li>  <b>Physical Disk,% Disk Read Time</b> </li><li>  <b>Physical Disk,% Disk Write Time</b> </li><li>  <b>Physical Disk,% Idle Time</b> </li></ul><br>  These counters show the percentage of time spent reading, writing to disk and, accordingly, the percentage of downtime.  If their values ‚Äã‚Äãrise above 75% for long periods of time, this means that the performance of the disk subsystem is not high enough. <br>  In addition, there are two more counters: <br><ul><li>  <b>Physical Disk, Avg.</b>  <b>Disk Read Queue Length</b> </li><li>  <b>Physical Disk, Avg.</b>  <b>Disk Write Queue Length</b> </li></ul><br>  These two counters show the average length of the disk queue, respectively, for reading and writing.  High values ‚Äã‚Äãof these parameters (above 2) for short periods of time (‚Äúpeaks‚Äù) are quite acceptable, and, for example, for DBMS or MS Exchange servers are quite typical, but long-term exceedances indicate that the disk subsystem is probably ‚Äúnarrow‚Äù place. " <br><br><h5>  Network subsystem </h5><br>  The network subsystem is a "bottleneck" much less often than the processor, memory and hard disk, but nevertheless - you should not forget about it. <br>  As with all other components - there are several questions to which it would be nice to get answers at the planning stage: <br><ul><li>  How many virtual machines will be running at the same time, and what will be the load on the network? </li><li>  What is the network bandwidth? </li><li>  Are iSCSI storage systems in use? </li><li>  Does the server have remote management hardware independent of the installed OS (for example, HP iLO or Dell DRAC)? </li></ul><br>  Depending on the answers, different configuration scenarios for the network subsystem are possible.  Suppose we have only one server.  It has exactly 4 network interfaces. Only three virtual machines have been launched.  The server does not have an Out-of-band-management controller, which means that if something bad happens, you will have to run to the server (which is located at the other end of the city). <br><br><h6>  At the host level </h6><br>  For servers that do not have remote management hardware, it is recommended that one of the network interfaces be left unused in virtual networks, solely for management tasks.  This will greatly reduce the risk of a situation when, due to excessive utilization or due to incorrect settings of the network interface, the ability to remotely manage the server is lost.  This can be done either during the installation of the Hyper-V role by unchecking one of the network interfaces, or after installation by removing the virtual network attached to the network interface that will be used for management. <br>  In addition, at the host level, it is imperative to install as much as possible ‚Äúfresh‚Äù drivers for network adapters.  This is necessary in order to take advantage of the special functions of network adapters - VLAN, Teaming, TCP Offloading, VMQ (provided that the network adapters themselves support this - as a rule, they are specialized server network adapters). <br><br><h6>  Network loads </h6><br>  Suppose that our three virtual machines have already worked for some time, and the traffic analysis showed that two of them do not burden the network interface very much, while the third generates very large amounts of traffic.  The best solution would be to ‚Äúrelease to the world‚Äù a virtual machine that generates a large amount of traffic through a separate network interface.  To do this, you can create two virtual networks of the External type: one for those virtual machines that do not load the network, and a separate one for the third virtual machine. <br>  In addition, you can create a virtual network with the output "out", while not creating a virtual network adapter in the parent partition.  This is done using scripts.  I will not go into details, but just give a link: <a href="http://blogs.msdn.com/b/robertvi/archive/2008/08/27/howto-create-a-virtual-swich-for-external-without-creating-a-virtual-nic-on-the-root.aspx">blogs.msdn.com/b/robertvi/archive/2008/08/27/howto-create-a-virtual-swich-for-external-without-creating-a- virtual-nic-on-the-root.aspx</a> <br><br><h6>  iSCSI </h6><br>  If you plan to use an iSCSI storage system, it is highly recommended to allocate a separate network interface for iSCSI operation, or even two for MPIO operation.  If LUNs will be mounted in the host OS, then you just need to leave one or two interfaces unattached to virtual networks.  If iSCSI initiators work inside virtual machines, they need to create one or two separate virtual networks that will be used exclusively for iSCSI traffic. <br><br><h6>  VLAN tagging </h6><br>  VLAN-tagging (IEEE 802.1q) means ‚Äúmarking‚Äù of network packets with a special marker (tag), thanks to which a packet can be associated with a particular virtual network (VLAN).  In this case, the hosts belonging to different VLANs will be located in different broadcast domains, although they are physically connected to the same equipment.  Hyper-V virtual network adapters also support VLAN tagging.  To do this, go to the properties of the virtual adapter in the settings of the virtual machine and register the corresponding VLAN ID there. <br><br><h6>  Active equipment </h6><br>  So far we have talked about network interfaces and virtual network adapters within a host.  But it is also necessary to take into account the bandwidth of the active equipment - for example, switches to which our hosts will connect.  A simple example: if there is an 8-port 1Gbps switch, and each of the ports utilizes the entire 1Gbps bandwidth, then a 1Gbps uplink will not physically be able to pass through such traffic volumes, which will lead to a drop in performance.  This has to be especially taken into account when using iSCSI - the loads there can be high, and packet delays can be quite critical for performance.  Therefore, when using iSCSI, it is highly recommended to send iSCSI traffic through separate switches. <br><br><h5>  Recommendations for the host OS </h5><br>  We now turn to recommendations on the host OS.  As you know, Windows Server 2008 R2 can be installed in two different modes: Full and Server Core.  In terms of the work of the hypervisor, these modes are no different.  Although the Server Core mode seems more difficult at first glance (especially for inexperienced administrators), it is recommended to use this mode.  Installing an OS in Server Core mode has the following advantages over a full installation: <br><ul><li>  Smaller updates </li><li>  Smaller attack surface for potential intruders </li><li>  Lower processor and memory load in parent partition </li></ul><br><br><h6>  Running other applications in the host OS </h6><br>  Running third-party (not related to Hyper-V) applications in the guest OS, as well as installing other server roles besides Hyper-V can lead to a dramatic drop in performance, as well as to a decrease in stability.  The fact is that due to the peculiarities of the Hyper-V architecture, all the interaction of virtual machines with devices passes through the parent partition.  Therefore, high loads or ‚Äúfalling into the blue screen‚Äù in the parent partition will necessarily lead to a drop in performance or simply to a ‚Äúdrop‚Äù in all running virtual machines.  Here you can (and should) include antivirus software.  Whether it is necessary at all on a host that will not do anything except virtualization, is, of course, another question.  However, if the antivirus is installed, the first thing to do is to exclude from the list all folders where virtual machine files may be located.  Otherwise, the performance may slow down during scanning, and if something similar to a virus is found in any VHD file, then the VHD itself may spoil the anti-virus package when trying to treat it.  Similar cases have been observed with MS Exchange databases, and therefore the first recommendation is not to put file antiviruses on Exchange servers at all, and if you do, add folders with databases to exclusions. <br><br><h4>  Virtual Machine Recommendations </h4><br>  The steps that need to be taken to improve the performance of the virtual machines themselves depend on the applications that will be run on them.  Microsoft has recommendations (best practices) for each of the applications - Exchange, SQL Server, IIS, and others.  Similar recommendations exist for software of other vendors.  Here I will give only general recommendations that are independent of specific software. <br>  It will explain why you need to install Integration Services in the guest OS, how to simplify the deployment of new virtual machines using the VHD library, and how to keep these VHDs up to date with the release of new patches. <br><br><h5>  Integration services </h5><br>  Integration services are a set of drivers running inside the guest OS.  They should be installed immediately after installing the OS.  At the moment, the list of supported OS is as follows: <br><ul><li>  Windows 2000 Server SP4 </li><li>  Windows Server 2003 SP2 </li><li>  Windows Server 2008 </li><li>  Windows XP SP2, SP3 </li><li>  Windows Vista SP1 </li><li>  SUSE Linux Enterprise Server 10 SP3 / 11 </li><li>  Red Hat Enterprise Linux 5.2 - 5.5 </li></ul><br>  Windows 7 and Windows Server 2008 R2 contain integration services in the installation package, so they do not need to be installed on these OSes additionally. <br>  Installation of integration services allows the use of synthetic devices that have higher performance compared to emulated.  Learn more about the difference between emulated and synthetic devices in my article on Hyper-V architecture. <br>  Here is a list of drivers included in Integration Services: <br><ul><li>  <b>IDE-controller</b> - replaces the emulated IDE-controller, which increases the speed of access to the disks </li><li>  <b>SCSI controller</b> is a fully synthetic device and requires the installation of integration services for work.  Up to 64 disks can be connected to each SCSI controller, there can be up to 4 controllers per virtual machine. </li><li>  <b>Network adapter</b> - has a higher performance than the emulated (Legacy Network Adapter), and supports special features such as VMQ. </li><li>  <b>Video and mouse</b> - increase the convenience of managing a virtual machine through its console. </li></ul><br>  In addition to the drivers listed, the following functions are supported when installing integration services: <br><ul><li>  <b>Operating System Shutdown</b> - the ability to correctly shut down the guest OS without a login to it.  Same as pressing the Power button on an ATX chassis. </li><li>  <b>Time Synchronization</b> - as the name implies - synchronization of the system time between the host and the guest OS. </li><li>  <b>Data Exchange</b> - the exchange of registry keys between the guest and the host OS.  Thus, for example, the guest OS can determine the name of the host on which it is running.  This feature is only available for guest OS family MS Windows. </li><li>  <b>Heartbeat</b> is a special service that periodically sends special signals, meaning that everything is fine with the virtual machine.  If the guest OS for some reason, for example, hangs, it will stop sending Heartbeat, and this can serve as a signal, for example, for an automatic reboot. </li><li>  <b>Online Backup</b> - is a VSS Writer, allowing at any time to obtain a consistent backup copy of the virtual machine data.  When you start a backup through VSS, applications running in a virtual machine automatically dump data to disk, and therefore the backup is consistent. </li></ul><br>  To install integration services in Windows OS, select <i>Action - Integration Services Setup</i> .  In this case, an ISO-image with installation files will automatically be mounted to the virtual machine, and the installation process will start.  If Autorun is disabled on the guest system, the installation process will have to be started manually. <br>  Integration components for Linux are not included in the distribution of Windows Server - they must be downloaded from the Microsoft website. <br><br><h5>  Sysprep: create a master image </h5><br>  If you have a sufficiently large infrastructure, and you often have to create new virtual machines and install an OS on them, a set of ready-made "master images" of virtual hard disks will save a lot of time.  ¬´-¬ª,    VHD-,  ,         VHD    .              (  ‚Äì  ). <br>    - : <br><ol><li>     </li><li>   ,  ,       ,    </li><li>       Sysprep,     ,      (SID). </li></ol><br>          ,  ¬´mini-setup¬ª.        ,  ,    . <br><br><h5> -  </h5><br>   -,          .    ,     :    ,       -    ,     -.    , ,      ‚Äì      .  ,             ,    ‚Äì  .   ,      -   ‚Äì   ¬´Offline Virtual Machine Servicing Tool¬ª.      System Center Virtual Machine Manager (SCVMM),       WSUS  SCCM, ,  ,    .    : <br><ol><li>     ,    SCVMM,  ‚Äì   maintenance host. </li><li>   ,        . </li><li>   ,  VHD-       . </li></ol><br> Offline Virtual Machine Servicing Tool  .          ‚Äì     : <a href="http://www.microsoft.com/solutionaccelerators">www.microsoft.com/solutionaccelerators</a> . <br><br><h4>  Conclusion </h4><br>           ,     .  ,   -    . </div><p>Source: <a href="https://habr.com/ru/post/99255/">https://habr.com/ru/post/99255/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../99249/index.html">Where do habrlydy take the news?</a></li>
<li><a href="../99251/index.html">Trailer for "Social Network" - a film about creating Facebook</a></li>
<li><a href="../99252/index.html">Microsoft's participation in the O'Reilly Open Source Convention (OSCON)</a></li>
<li><a href="../99253/index.html">HTC Desire - transition from WM to Android</a></li>
<li><a href="../99254/index.html">Finally, USB connectors can be used upside down!</a></li>
<li><a href="../99256/index.html">GZip and nginx: performance impact</a></li>
<li><a href="../99257/index.html">HTC Ace - the future Android-flagship from HTC</a></li>
<li><a href="../99258/index.html">miniGeekFest on July evening</a></li>
<li><a href="../99261/index.html">Backup phone book in Nokia S60</a></li>
<li><a href="../99262/index.html">Canobuvosti, 48th edition</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>