<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Excel instead of PowerShell: queries to AD and system reports "on the knee"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the comments to the previous article, we remembered accounting in Excel instead of 1C. Well, let's see how you know Excel. Today I will show how to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Excel instead of PowerShell: queries to AD and system reports "on the knee"</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/76/68/rw/7668rwmr-_p-255jw2trkvl-hqi.jpeg"></p><br><p>  In the comments to the previous article, we remembered accounting in Excel instead of 1C.  Well, let's see how you know Excel.  Today I will show how to get data from Active Directory and work with them without macros and PowerShell - only with regular Office mechanisms.  For example, you can easily get analytics on the use of operating systems in an organization if you do not already have something like Microsoft SCOM.  Well, or just warm up and get away from the scripts. <a name="habracut"></a></p><br><blockquote>  Of course, you can get data as in the examples below in literally one line on PowerShell.  But, firstly, PowerShell is too boring, and secondly, Excel is able to dynamically update the data - the resulting documents can be published online and forget about updating them. </blockquote><p>  To work with data, I will use the mechanism of <a href="https://support.office.com/ru-ru/article/power-query-%25E2%2580%2594-%25D0%25BE%25D0%25B1%25D0%25B7%25D0%25BE%25D1%2580-%25D0%25B8-%25D0%25BE%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5-ed614c81-4b00-4291-bd3a-55d80767f81d">Power Query</a> .  For office 2010 and 2013, you will have to install a <a href="https://www.microsoft.com/ru-ru/download/details.aspx%3Fid%3D39379">plugin</a> , in Microsoft Office 2016 this module is already built in.  Unfortunately, the standard edition is not enough for us, we need Professional. </p><br><p>  The mechanism itself is designed to receive and process data from a variety of sources - from old ODBC and text files, to Exchange, Oracle and Facebook.  More information about the mechanism and the built-in scripting language "M" has already been written on <a href="https://habrahabr.ru/post/271019/">Habr√©</a> , but I will analyze a couple of examples of using Power Query to get data from Active Directory. </p><br><h1 id="razminka-posmotrim-kogda-nashi-polzovateli-loginilis">  Warm-up: see when our users have logged in </h1><br><p>  The request itself to the domain database is created on the ‚ÄúData - New request - From other sources - From Active Directory‚Äù tab. </p><br><p><img src="https://habrastorage.org/webt/rf/xu/or/rfxuorll2vwoi-pah-shzassx9q.jpeg"><br>  <em>Specify the data source.</em> </p><br><p>  You will need to choose a domain name, specify the necessary data for the connection.  Next, select the type of objects, in this example - <strong>user</strong> .  On the right in the preview window, the request is already running, showing a preview of the data. </p><br><p><img src="https://habrastorage.org/webt/v-/bu/pk/v-bupkn1d0m_bemaluktstmux8w.jpeg"><br>  <em>We prepare the request, admiring the preview.</em> </p><br><p>  Preliminary inquiry should be prepared by clicking the "change" button and selecting the necessary columns.  In essence, these columns are classes. Each of them contains a set of specific attributes of an Active Directory object, except for the main <strong>displayName</strong> column, which is itself an attribute.  I will focus on the <strong>user</strong> , <strong>person</strong> , <strong>top,</strong> and <strong>securityPrincipal</strong> classes.  Now it is necessary to select the necessary attributes from each class using the "extension" - an icon with two arrows at the column heading: </p><br><ul><li>  The <strong>user</strong> class is <strong>expanded</strong> by selecting <strong>lastLogonTimestamp</strong> and <strong>userAccountControl</strong> ; </li><li>  in <strong>person,</strong> select <strong>telephoneNumber</strong> ; </li><li>  in <strong>top</strong> - <strong>whenCreated</strong> ; </li><li>  and in <strong>securityPrincipal</strong> , <strong>SamAccountName</strong> . </li></ul><br><p><img src="https://habrastorage.org/webt/me/bx/ef/mebxefx7utadswnt0uk_oaimimk.jpeg"><br>  <em>Expand the query.</em> </p><br><p>  Now we‚Äôll configure the filter: in particular, in order not to get blocked accounts, the userAccountControl attribute must be set to 512 or 66048. The filter may be different in your environment.  More information about the attribute can be found in the <a href="https://support.microsoft.com/ru-ru/help/305144/how-to-use-the-useraccountcontrol-flags-to-manipulate-user-account-pro">Microsoft</a> documentation. </p><br><p><img src="https://habrastorage.org/webt/ad/8w/vh/ad8wvhvfgilloskghus9rc4lyu8.jpeg"><br>  <em>Apply the filter</em> . </p><br><blockquote>  Sometimes Excel incorrectly defines the data format, especially the values ‚Äã‚Äãof the lastLogonTimestamp attribute.  If you suddenly suffer such a misfortune, you can set the correct format on the ‚ÄúConvert‚Äù tab. </blockquote><p>  Now the userAccountControl column should be removed - in the display it is not needed at all.  And click "Download and close." </p><br><p>  The result was a sign that remained quite a bit to bring to mind.  For example, rename columns to something readable.  And set up automatic data update. </p><br><p>  Automatic updating when opening a table or by timeout is configured in the ‚ÄúData‚Äù tab in ‚ÄúProperties‚Äù. </p><br><p><img src="https://habrastorage.org/webt/j_/9m/b2/j_9mb2ysdqwiunoo9malohcaweo.jpeg"></p><br><p>  <em>Configure update data.</em> </p><br><p>  After the update setup is completed, you can safely give the table to the staff of the personnel department or the security service - let them know who logged in and when. </p><br><div class="spoiler">  <b class="spoiler_title">Request code in the "M" language under the spoiler.</b> <div class="spoiler_text"><pre><code class="hljs vbscript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span>  = ActiveDirectory.Domains(<span class="hljs-string"><span class="hljs-string">"domain.ru"</span></span>), domain.ru = {[Domain=<span class="hljs-string"><span class="hljs-string">"domain.ru"</span></span>]}[#<span class="hljs-string"><span class="hljs-string">"Object Categories"</span></span>], user1 = domain.ru{[Category=<span class="hljs-string"><span class="hljs-string">"user"</span></span>]}[Objects], #<span class="hljs-string"><span class="hljs-string">" "</span></span> = Table.RemoveColumns(user1,{<span class="hljs-string"><span class="hljs-string">"organizationalPerson"</span></span>, <span class="hljs-string"><span class="hljs-string">"shadowAccount"</span></span>, <span class="hljs-string"><span class="hljs-string">"posixAccount"</span></span>, <span class="hljs-string"><span class="hljs-string">"msExchOmaUser"</span></span>, <span class="hljs-string"><span class="hljs-string">"msExchBaseClass"</span></span>, <span class="hljs-string"><span class="hljs-string">"msExchIMRecipient"</span></span>, <span class="hljs-string"><span class="hljs-string">"msExchCertificateInformation"</span></span>, <span class="hljs-string"><span class="hljs-string">"msExchMultiMediaUser"</span></span>, <span class="hljs-string"><span class="hljs-string">"msExchMailStorage"</span></span>, <span class="hljs-string"><span class="hljs-string">"msExchCustomAttributes"</span></span>, <span class="hljs-string"><span class="hljs-string">"mailRecipient"</span></span>, <span class="hljs-string"><span class="hljs-string">"distinguishedName"</span></span>}), #<span class="hljs-string"><span class="hljs-string">"  securityPrincipal"</span></span> = Table.ExpandRecordColumn(#<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"securityPrincipal"</span></span>, {<span class="hljs-string"><span class="hljs-string">"sAMAccountName"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"sAMAccountName"</span></span>}), #<span class="hljs-string"><span class="hljs-string">"  top"</span></span> = Table.ExpandRecordColumn(#<span class="hljs-string"><span class="hljs-string">"  securityPrincipal"</span></span>, <span class="hljs-string"><span class="hljs-string">"top"</span></span>, {<span class="hljs-string"><span class="hljs-string">"whenCreated"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"whenCreated"</span></span>}), #<span class="hljs-string"><span class="hljs-string">"  person"</span></span> = Table.ExpandRecordColumn(#<span class="hljs-string"><span class="hljs-string">"  top"</span></span>, <span class="hljs-string"><span class="hljs-string">"person"</span></span>, {<span class="hljs-string"><span class="hljs-string">"telephoneNumber"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"telephoneNumber"</span></span>}), #<span class="hljs-string"><span class="hljs-string">"  user"</span></span> = Table.ExpandRecordColumn(#<span class="hljs-string"><span class="hljs-string">"  person"</span></span>, <span class="hljs-string"><span class="hljs-string">"user"</span></span>, {<span class="hljs-string"><span class="hljs-string">"lastLogonTimestamp"</span></span>, <span class="hljs-string"><span class="hljs-string">"userAccountControl"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"lastLogonTimestamp"</span></span>, <span class="hljs-string"><span class="hljs-string">"userAccountControl"</span></span>}), #<span class="hljs-string"><span class="hljs-string">"   "</span></span> = Table.SelectRows(#<span class="hljs-string"><span class="hljs-string">"  user"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> ([userAccountControl] = <span class="hljs-number"><span class="hljs-number">512</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> [userAccountControl] = <span class="hljs-number"><span class="hljs-number">66048</span></span>)), #<span class="hljs-string"><span class="hljs-string">" "</span></span> = Table.TransformColumnTypes(#<span class="hljs-string"><span class="hljs-string">"   "</span></span>,{{<span class="hljs-string"><span class="hljs-string">"lastLogonTimestamp"</span></span>, type datetime}}), #<span class="hljs-string"><span class="hljs-string">" 1"</span></span> = Table.RemoveColumns(#<span class="hljs-string"><span class="hljs-string">" "</span></span>,{<span class="hljs-string"><span class="hljs-string">"userAccountControl"</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> #<span class="hljs-string"><span class="hljs-string">" 1"</span></span></code> </pre> </div></div><br><h1 id="sozdaem-adresnuyu-knigu-ili-chto-delat-kogda-korporativnyy-portal-s-ad-ne-druzhit">  Create an address book, or what to do when the corporate portal with AD is not friendly </h1><br><p>  Another way to use Excel in conjunction with Active Directory is to create an address book based on AD data.  It is clear that the address book will be relevant only if the domain is in order. </p><br><p>  Create a query on the <strong>user</strong> object, expand the <strong>user</strong> class in the <strong>mail</strong> , and the <strong>person</strong> class in the <strong>telephoneNumber</strong> .  Let's delete all columns, except <strong>distinguishedName</strong> - the domain structure repeats the structure of the enterprise, therefore the names of <strong>Organizational Units</strong> correspond to the names of the divisions.  Similarly, security groups can be used as the basis of unit names. </p><br><p>  Now, from the line <strong>CN = User Name, OU = Accounting Department, OU = Divisions, DC = domain, DC = ru,</strong> you must directly extract the department name.  The easiest way to do this is with the delimiters on the Transform tab. </p><br><p><img src="https://habrastorage.org/webt/7m/um/v9/7mumv9qief09rxgfgs86idg3yua.jpeg"><br>  <em>Extract the text.</em> </p><br><p>  I use <strong>OU =</strong> and <strong>, OU =</strong> as separators.  In principle, a comma is sufficient, but I am reinsured. </p><br><p><img src="https://habrastorage.org/webt/ul/gd/zp/ulgdzpxdetwsu2zg4sgcgx3lilm.jpeg"><br>  <em>Enter separators.</em> </p><br><p>  Now, using the filter, you can cut off unnecessary <strong>OUs</strong> , like blocked users and <strong>Builtin</strong> , set up sorting and load data into the table. </p><br><p><img src="https://habrastorage.org/webt/ze/qb/ia/zeqbiaccbn097lazptakysjabci.jpeg"><br>  <em>View summary table.</em> </p><br><h1 id="bystryy-otchet-po-sostavu-rabochih-stanciy-bez-vnedreniya-agentov-i-prochey-podgotovki">  Quick report on the composition of workstations, without the introduction of agents and other training </h1><br><p>  Now we will try to create a useful table by obtaining data on computers.  Let's make a report on the operating systems used by the company: for this we will create a query, but in the navigator this time we will select <strong>computer</strong> . </p><br><p><img src="https://habrastorage.org/webt/qf/dm/hw/qfdmhwz8oyowfwk5sfbi5tfst-o.jpeg"><br>  <em>Make a request for the computer object.</em> </p><br><p>  Let's leave the <strong>computer</strong> and <strong>top</strong> column classes and expand them: </p><br><ul><li>  We will expand the <strong>computer</strong> class by selecting <strong>cn</strong> , <strong>operatingSystem</strong> , <strong>operatingSystemServicePack</strong> and <strong>operatingSystemVersion</strong> ; </li><li>  in the <strong>top</strong> class, select <strong>whenCreated</strong> . </li></ul><br><p><img src="https://habrastorage.org/webt/gi/pp/j8/gippj8kr8lgmm6mjfmszuhupt5y.jpeg"><br>  <em>Advanced Request.</em> </p><br><p>  If desired, you can make a report only on server operating systems.  For example, apply a filter on the operatingSystem attribute or operatingSystemVersion.  I will not do this, but I will correct the display of the creation time - only a year is interesting to me.  To do this, on the ‚ÄúConversion‚Äù tab, select the column we need and select ‚ÄúYear‚Äù in the ‚ÄúDate‚Äù menu. </p><br><p><img src="https://habrastorage.org/webt/rh/ky/m8/rhkym85wk9ma5g_sihiyeplybhu.jpeg"><br>  <em>We retrieve the year from the time the computer entered the domain.</em> </p><br><p>  It now remains to remove the displayname column as unnecessary and load the result.  Data is ready.  Now you can work with them as with a regular table.  To begin with, we will make a pivot table on the ‚ÄúInsert‚Äù tab - ‚ÄúPivot table‚Äù.  We agree with the choice of the data source and configure its fields. </p><br><p><img src="https://habrastorage.org/webt/cw/ys/hp/cwyshpgecf8o8icfh-xw46fah78.jpeg"><br>  <em>Pivot table field settings.</em> </p><br><p>  It now remains to customize the design and enjoy the result: </p><br><p><img src="https://habrastorage.org/webt/zt/ql/fd/ztqlfdjda-e6jxy9x6lm8maiaqe.jpeg"><br>  <em>Pivot table for computers in AD.</em> </p><br><p>  If you wish, you can add a summary graph, also on the "Insert" tab.  In the "Categories" (or in the "Rows", to taste) we add the <strong>operatingSystem</strong> , in the data - <strong>cn</strong> .  On the "Designer" tab, you can select the type of chart you like, I prefer a circular one. </p><br><p><img src="https://habrastorage.org/webt/sy/pk/fd/sypkfdamaqwsfzgahyi5pcrptfe.jpeg"><br>  <em>Pie chart.</em> </p><br><p>  Now you can clearly see that, despite the ongoing update, the total number of workstations running Windows XP and servers running Windows 2003 is quite large.  And there is something to strive for. </p><br><div class="spoiler">  <b class="spoiler_title">Request code under the spoiler.</b> <div class="spoiler_text"><pre> <code class="hljs vbscript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span>  = ActiveDirectory.Domains(<span class="hljs-string"><span class="hljs-string">"domain.ru"</span></span>), domain.ru = {[Domain=<span class="hljs-string"><span class="hljs-string">"domain.ru"</span></span>]}[#<span class="hljs-string"><span class="hljs-string">"Object Categories"</span></span>], computer1 = domain.ru{[Category=<span class="hljs-string"><span class="hljs-string">"computer"</span></span>]}[Objects], #<span class="hljs-string"><span class="hljs-string">" "</span></span> = Table.RemoveColumns(computer1,{<span class="hljs-string"><span class="hljs-string">"user"</span></span>, <span class="hljs-string"><span class="hljs-string">"organizationalPerson"</span></span>, <span class="hljs-string"><span class="hljs-string">"person"</span></span>}), #<span class="hljs-string"><span class="hljs-string">"  "</span></span> = Table.SelectColumns(#<span class="hljs-string"><span class="hljs-string">" "</span></span>,{<span class="hljs-string"><span class="hljs-string">"displayName"</span></span>, <span class="hljs-string"><span class="hljs-string">"computer"</span></span>, <span class="hljs-string"><span class="hljs-string">"top"</span></span>}), #<span class="hljs-string"><span class="hljs-string">"  computer"</span></span> = Table.ExpandRecordColumn(#<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">"computer"</span></span>, {<span class="hljs-string"><span class="hljs-string">"cn"</span></span>, <span class="hljs-string"><span class="hljs-string">"operatingSystem"</span></span>, <span class="hljs-string"><span class="hljs-string">"operatingSystemServicePack"</span></span>, <span class="hljs-string"><span class="hljs-string">"operatingSystemVersion"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"cn"</span></span>, <span class="hljs-string"><span class="hljs-string">"operatingSystem"</span></span>, <span class="hljs-string"><span class="hljs-string">"operatingSystemServicePack"</span></span>, <span class="hljs-string"><span class="hljs-string">"operatingSystemVersion"</span></span>}), #<span class="hljs-string"><span class="hljs-string">"  top"</span></span> = Table.ExpandRecordColumn(#<span class="hljs-string"><span class="hljs-string">"  computer"</span></span>, <span class="hljs-string"><span class="hljs-string">"top"</span></span>, {<span class="hljs-string"><span class="hljs-string">"whenCreated"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"whenCreated"</span></span>}), #<span class="hljs-string"><span class="hljs-string">" "</span></span> = Table.TransformColumns(#<span class="hljs-string"><span class="hljs-string">"  top"</span></span>,{{<span class="hljs-string"><span class="hljs-string">"whenCreated"</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">Year</span></span>}}), #<span class="hljs-string"><span class="hljs-string">" 1"</span></span> = Table.RemoveColumns(#<span class="hljs-string"><span class="hljs-string">" "</span></span>,{<span class="hljs-string"><span class="hljs-string">"displayName"</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> #<span class="hljs-string"><span class="hljs-string">" 1"</span></span></code> </pre> </div></div><br><h1 id="no-i-eto-esche-ne-vse">  But that's not all. </h1><br><p>  It should be noted that Excel is able to compile not only the favorite tables of accounting.  With a skillful approach, he is on the shoulder of both multidimensional data analytics (OLAP-cubes), and <a href="http://exceltable.com/otchety/reshenie-uravneniy">solving a system of equations using matrices</a> .  And for those who have a certificate from Microsoft on the wall, there is an option to be confused even with <a href="https://habrahabr.ru/post/348704/">3D games</a> .  Not a Doom, of course, but it will take an evening. </p><br><p>  <strong>What do you think about Excel as an admin tool?</strong>  <strong>Have you ever used something from the above?</strong> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/350582/">https://habr.com/ru/post/350582/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350572/index.html">Backlog in product management: what to do when ideas grow ‚Äúlike a snowball‚Äù</a></li>
<li><a href="../350574/index.html">You can not just take and edit subtitles</a></li>
<li><a href="../350576/index.html">Background removal using deep learning</a></li>
<li><a href="../350578/index.html">UX-design in Russia and the CIS "under the microscope"</a></li>
<li><a href="../350580/index.html">Kali Linux is now available in the Microsoft Store</a></li>
<li><a href="../350584/index.html">An overview of the new UMAP dimension reduction algorithm. Is it really better and faster than t-sne?</a></li>
<li><a href="../350588/index.html">We wrote the code together for one computer for five months. This is what I learned</a></li>
<li><a href="../350590/index.html">FastTrack Training. "Network Basics". "The Value of Cisco Wireless Local Area Networks". Eddie Martin December 2012</a></li>
<li><a href="../350594/index.html">What is SaaS-business</a></li>
<li><a href="../350596/index.html">This SVG always shows today's date.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>