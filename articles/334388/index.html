<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Authorization form with sending an encrypted password</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, I decided to post my idea of ‚Äã‚Äãauthorization on the site using PHP. 
 Of course, if the authorization occurs on SSL, the risks that t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Authorization form with sending an encrypted password</h1><div class="post__text post__text-html js-mediator-article">  In this article, I decided to post my idea of ‚Äã‚Äãauthorization on the site using PHP. <br>  Of course, if the authorization occurs on SSL, the risks that the password will be intercepted using a sniffer become void.  But still, this type of authorization is not used everywhere.  One type of protection is the content of the password in the form of a hash.  But after all, during authorization, the password is sent to the POST request to the server and there is a chance to catch it.  Upon reflection, I decided to try to implement an authorization scheme in which the password would not be sent to the server in the form in which it is.  And not even his MD5 hash.  The plans had something like the ms-chap algorithm. <br><a name="habracut"></a><br>  Namely: <br><br>  1) When visiting a site, an unauthorized user in the cookie is given a unique id. <br>  2) If the user decides to log in, when the password is filled, a hash is generated based on the md5 hash of his password and the id issued by the server. <br>  3) After authorization attempt, regardless of its results, id is overwritten. <br><br>  What do we get in the end?  With each authorization attempt, a new hash is generated which is different from the previous one and there is no sense in catching it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So let's start: <br><br>  Since the article did not imply a ready-made code, but focused more on the algorithm and logic, only those bass moments on which the implementation of this logic is based are indicated.  The essence here is more in the algorithm and the environment each builds in its own way. <br><br>  So in the root of the site the user is assigned a "salt" which is generated at the very beginning, as well as after each authorization attempt. <br><br><pre><code class="php hljs">session_start(); <span class="hljs-comment"><span class="hljs-comment">//   id   if(!isset($_SESSION['uniq'])||$_SESSION['uniq']=='') { $_SESSION['uniq']=uniqid(); } </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br><br>  Further in the form of login: <br><br><pre> <code class="php hljs">&lt;form action=<span class="hljs-string"><span class="hljs-string">""</span></span> method=<span class="hljs-string"><span class="hljs-string">"post"</span></span>&gt; <span class="hljs-comment"><span class="hljs-comment">//   &lt;input type="email" placeholder="E-mail" name="login"&gt; //    &lt;input id="pass" type="password" placeholder="" &gt; //       &lt;input id="hidpass" type="hidden" name="password" value="" &gt; //  &lt;button type="submit" &gt;&lt;/button&gt; &lt;/form&gt; //   &lt;script&gt; $(function () { $("#pass").on("input",function(e){ //           MD5   id              var pass=CryptoJS.MD5($('#pass').val())+'</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?php</span></span></span><span class="hljs-comment"> echo $_SESSION['uniq']</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment">'; var md5pass=CryptoJS.MD5(pass); $('#hidpass').val(md5pass.toString()); }); }); &lt;/script&gt;</span></span></code> </pre><br>  How to get a constantly changing password, we figured out, it remains to figure out what to do with it. <br><br>  After submitting the form we get into the function of checking the login and password.  Here, too, the taste and color markers are different.  In my case, instead of the form, the authorization function is called after the results of which the page is simply updated and if the authorization was successful, then we get into our workspace.  If the result is unsuccessful, then we again look at the entry form. <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckLogin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($login,$md5pass)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     $pass="MD5    " ; //    id      $pass.=$_SESSION['uniq']; //     $pass=md5($pass); //  id         unset($_SESSION['uniq']); //    if(strcmp($md5pass,$pass)==0) { echo "  .        "; $_SESSION['id']=session_id(); } //     ....... }</span></span></code> </pre><br><br>  UPD: The article assumed not the code itself, but an algorithm which everyone sees in their own way.  And not for the holivar divorce on the topic ‚Äúa hole was formed and it‚Äôs not plowing at all‚Äù and the brackets are crooked.  But since all the comments rested precisely on this, the cat had to be removed which was primitive and implied actions on non-instructions. </div><p>Source: <a href="https://habr.com/ru/post/334388/">https://habr.com/ru/post/334388/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../334376/index.html">JetBrains MPS for those interested # 2</a></li>
<li><a href="../334378/index.html">Security Week 30: Addups again for your own, how to cache uncached in Docker containers - a dangerous load</a></li>
<li><a href="../334380/index.html">PyTorch - your new deep learning framework</a></li>
<li><a href="../334384/index.html">Tree Tree Comparison *</a></li>
<li><a href="../334386/index.html">Postgres Pro quiz task analysis on PGDay'17</a></li>
<li><a href="../334390/index.html">Magento Dare to Share - Open Platform for Reports on Magento, PHP and eCommerce</a></li>
<li><a href="../334392/index.html">Putting things in order: Chrome and Firefox will end the credibility of Symantec certification center</a></li>
<li><a href="../334394/index.html">Mutation Testing</a></li>
<li><a href="../334396/index.html">Hacking a casino through a smart aquarium and DDoS stock brokers: new attacks on finance</a></li>
<li><a href="../334398/index.html">R and Big Data: Use Replyr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>