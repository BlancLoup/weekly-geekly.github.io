<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The first way to generate collisions for SHA-1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Collisions exist for most hash functions, but for the best of them, the number of collisions is close to the theoretical minimum. For example, for ten...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The first way to generate collisions for SHA-1</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/576/780/0bf/5767800bfd2c7d5bb07d164e3f5b519e.png"><br><br>  Collisions exist for most hash functions, but for the best of them, the number of collisions is close to the theoretical minimum.  For example, for ten years since the invention of SHA-1, not a single practical method of generating collisions was known.  Now there is one.  Today, the first algorithm for generating collisions for SHA-1 was <a href="https://security.googleblog.com/2017/02/announcing-first-sha1-collision.html">presented by</a> employees of Google and the Center for Mathematics and Computer Science in Amsterdam. <br><br>  Here's the proof: <a href="https://shattered.it/">two PDF documents</a> with different content, but the same SHA-1 digital signatures. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <a href="https://shattered.it/static/shattered-1.pdf">https://shattered.it/static/shattered-1.pdf</a> </li><li>  <a href="https://shattered.it/static/shattered-2.pdf">https://shattered.it/static/shattered-2.pdf</a> </li></ul><a name="habracut"></a><br><pre><code class="hljs perl">$ls -l sha*.pdf -rw-r--r--@ <span class="hljs-number"><span class="hljs-number">1</span></span> amichal staff <span class="hljs-number"><span class="hljs-number">422435</span></span> Feb <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span> shattered-<span class="hljs-number"><span class="hljs-number">1</span></span>.pdf -rw-r--r--@ <span class="hljs-number"><span class="hljs-number">1</span></span> amichal staff <span class="hljs-number"><span class="hljs-number">422435</span></span> Feb <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span> shattered-<span class="hljs-number"><span class="hljs-number">2</span></span>.pdf $shasum -a <span class="hljs-number"><span class="hljs-number">1</span></span> sha*.pdf <span class="hljs-number"><span class="hljs-number">38762</span></span>cf7f55934b34d179ae6a4c80cadccbb7f0a shattered-<span class="hljs-number"><span class="hljs-number">1</span></span>.pdf <span class="hljs-number"><span class="hljs-number">38762</span></span>cf7f55934b34d179ae6a4c80cadccbb7f0a shattered-<span class="hljs-number"><span class="hljs-number">2</span></span>.pdf</code> </pre> <br>  On the website <a href="https://shattered.it/">shattered.it,</a> you can check any file to see if it is in the space of possible collisions.  That is, is it possible to select another data set (file) with the same hash.  The attack vector is clear here: an attacker can spoof a ‚Äúgood‚Äù file with his own instance with a bookmark, a malicious macro, or a Trojan downloader.  And this ‚Äúbad‚Äù file will have the same hash or digital signature. <br><br>  Cryptographic hash functions like SHA-1 is a universal cryptographic tool that is commonly used in practical applications.  They are needed when building associative arrays, when searching for duplicates in data sets, when building unique identifiers, when calculating checksums for error detection.  For example, SHA-1 hashes are completely relied upon by the Git software version control system. <br><br>  But more importantly, hashing is critical in the field of information security: it is used when saving passwords, when generating an electronic signature, etc.  In general, hash functions convert any large data array into a small message. <br><br>  Given the ubiquitous distribution of hash functions, a very important requirement is the minimum number of collisions when two different blocks of input data are converted into two identical hashes. <br><br>  In an official <a href="https://security.googleblog.com/2017/02/announcing-first-sha1-collision.html">report, the</a> authors say that this finding was the result of a two-year study, which began shortly after the publication in 2013 of the <a href="https://marc-stevens.nl/research/">work of</a> cryptographer Mark Stevens from the Center for Mathematics and Computer Science in Amsterdam on the theoretical approach to creating SHA-1 collision.  He further continued the search for practical methods of hacking, along with colleagues from Google. <br><br>  Google has long expressed its disbelief in SHA-1, especially in the quality of using this feature to sign TLS certificates.  Back in 2014, shortly after the publication of the work of Stevens, the Chrome development team <a href="https://security.googleblog.com/2014/09/gradually-sunsetting-sha-1.html">announced</a> a phasing out of the use of SHA-1.  Now they hope that a practical attack on SHA-1 will increase the awareness of the information security community, so that many will speed up the abandonment of SHA-1. <br><br>  Experts began searching for a practical attack method by creating a PDF prefix specially selected for generating two documents with different content, but with the same SHA-1 hash. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba5/61c/82e/ba561c82eb4d17722e4006ed5a74aad3.png"><br>  <i>PDF prefix</i> <br><br><img src="https://habrastorage.org/files/96c/4e7/49e/96c4e749e4a8420e9bfc0ce5338d3466.png"><br>  <i>Identical prefix for collisions based on Google infrastructure</i> <br><br>  They then used Google‚Äôs infrastructure to perform calculations and test theoretical calculations.  Developers say it was one of the largest calculations Google ever performed.  In total, nine quintillion calculations of SHA-1 (9,223,372,036,854,775,808) were made, which required 6,500 processor years in the first phase and 110 years in the GPU in the second phase of the attack. <br><br>  The numbers seem large, but in fact such an attack is quite practical for an attacker who has a large computer cluster or just money to pay for processor time in the cloud.  According to Google, the attack is about 100,000 faster than brute force, which can be considered impractical. <br><br>  To imagine the number of hashes that Google cheated during brute force, we can mention that about the same number of hashes SHA-256 is counted in the Bitcoin network every three seconds, so there‚Äôs nothing fantastic about the attack.  It is possible to assume that in the cryptographic departments of some organizations with <a href="https://habrahabr.ru/post/229349/">large data centers</a> , SHA-1 collisions have long been calculated.  However, to pick a collision for a specific TLS certificate, you need some other method, because an identical prefix from Google‚Äôs research for PDF will not work there.  On the other hand, the contents of the certificates largely coincide, so that theoretically a prefix for collisions can be chosen. <br><br>  Now Mark Stevens and co-authors have published a <a href="https://shattered.io/static/shattered.pdf">scientific paper</a> in which they describe the general principles of generating documents with message blocks that are prone to SHA-1 collisions. <br><br>  <b>Message blocks that are prone to SHA-1 collisions</b> <br><img src="https://habrastorage.org/files/b4f/fcb/97a/b4ffcb97a3ad4ca8975e6c69e9a81719.png"><br><br>  In accordance with the accepted rules for disclosing vulnerabilities, Google promises to publish the full code for the attack in 90 days in open access.  Then anyone can create different documents with the same SHA-1 digital signatures.  Maybe even different certificates, different software updates in Git, different distributions on torrents (DHT hashes), different old PGP / GPG keys, etc.  However, one should not exaggerate the danger of such attacks, because not every document will be subject to an attack on the search for a collision.  That is, the attacker will have to initially create two files: one ‚Äúgood‚Äù and the second ‚Äúbad‚Äù with the same signature.  Then distribute a ‚Äúgood‚Äù document through normal channels (for example, via Git or a torrent tracker), and later try to replace it with a ‚Äúbad‚Äù file with the same digital signature.  However, all this is purely theoretical reasoning. <br><br>  Protection against documents prone to collisions hashes SHA-1 is already built into the software Gmail and GSuite.  As mentioned above, the detector of vulnerable documents works in the public domain on the website <a href="http://shattered.io/">shattered.io</a> .  In addition, a library for collision detection is <a href="https://github.com/cr-marcstevens/sha1collisiondetection">published on Github</a> . <br><br>  As a defense against the SHA-1 collision detection attack, Google recommends switching to higher-quality cryptographic hash functions SHA-256 and SHA-3. </div><p>Source: <a href="https://habr.com/ru/post/322478/">https://habr.com/ru/post/322478/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322466/index.html">Where to talk "on IB": OWASP Russia Meetup # 6 will be held in the office of Positive Technologies</a></li>
<li><a href="../322468/index.html">February 23: there is no worse thing than an IT person</a></li>
<li><a href="../322470/index.html">What to read to the programmer at your leisure</a></li>
<li><a href="../322474/index.html">Events, tires and data integration in the challenging world of microservices</a></li>
<li><a href="../322476/index.html">Development of SELinux-module for the user</a></li>
<li><a href="../322480/index.html">Upspin: Google's new global file system</a></li>
<li><a href="../322482/index.html">On the application of the scientific method in real life and activities</a></li>
<li><a href="../322484/index.html">MVC programming pattern as a way to implement the design process in Revit</a></li>
<li><a href="../322486/index.html">Detectable virtual machine in C #: 1 level</a></li>
<li><a href="../322492/index.html">The exclusive role of the boss</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>