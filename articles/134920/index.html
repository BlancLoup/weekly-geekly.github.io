<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating your own CheckBoxList control</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 This article will consider the possibility of creating your own control and using it in the framework of a new project on ASP .NET MVC 3.0....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating your own CheckBoxList control</h1><div class="post__text post__text-html js-mediator-article"><h1>  Foreword </h1><br>  This article will consider the possibility of creating your own control and using it in the framework of a new project on ASP .NET MVC 3.0.  Everything written below is the point of view of the author and may not coincide with the common or generally accepted methods of creating controls, therefore criticism and comments are welcome. <br><br><h1>  Introduction </h1><br>  Probably many users who previously worked on their projects with WinForms or ASP .NET WebForms, noticed that Html helpers in the ASP .NET MVC project do not provide the ability to create controls like CheckBoxList, which could be useful in complex filter forms data or multiple selection of non-structured data, whether in the profile about the user or when adding a new topic to Habrahabr.  Of course, no one forbids the use of a single CheckBox or CheckBoxFor, but whether working with such a group of checkboxes is convenient, and the code is easily extensible, understandable to maintainer and protected from duplication, these are not the last questions for a programmer who plans to use his achievements in future projects .  And if we take into account that we can add to our control some useful options for its visual display, the need to create it is becoming more and more obvious. <br><a name="habracut"></a><br>  Before finally diving into the subject area, I would like to note that the idea of ‚Äã‚Äãcreating the control in question was inspired after viewing the site <a href="http://mvc.devexpress.com/">http://mvc.devexpress.com</a> , on which there are many beautiful and functional controls, some of them look altogether awesome.  If this article is approved and met with positive reviews, then further review and implementation of the controls presented on the site within the cycle of articles for the community habr is possible. <br><br><h1>  Analysis </h1><br>  First of all, we need to understand what we are planning to do.  The control will be represented by the CheckBox group, which allows you to display the data collections transferred to it, uses the Model Binding concept when sending the form to the server and has the following display settings: <br><ul><li>  Layoutt - frame (in div or table); </li><li>  Direction- output direction (vertical / horizontal); </li><li>  RepeatColumns - number of columns; </li><li>  htmlAttributes are the attributes that will be applied to the CheckBox container. </li></ul><br><h1>  Creating a project </h1><br>  Create an empty ASP .NET MVC 3 project and add a <b>DemoController</b> controller with the <b>Index</b> method and representation: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/bf6/a73/174/bf6a7317421a3e77a0aa7a403e18d9a6.png"><br><br><img src="https://habrastorage.org/storage2/b58/04a/acd/b5804aacd5f985f304c54ad953d83402.png"><br><br><img src="https://habrastorage.org/storage2/85f/b32/666/85fb3266659d85b0dec47c351afc9dd2.png"><br><br>  After the minimum preparations are made, go directly to the control. <br><br><h1>  Adding a CheckBoxList </h1><br>  Add the <b>Core</b> folder to the root of the project with the <b>Controls.cs</b> file and the <b>static</b> <b>Controls</b> class in which the implementation of our CheckBoxList will be placed. <br><br><img src="https://habrastorage.org/storage2/c82/cc4/e51/c82cc4e51fc2f5c77bed8e5ea6028f21.png"><br><br>  At the moment, in the <b>static</b> class <b>Controls,</b> we can already create our own implementations of Html helpers, so we will add the necessary amount of code for this: <br><br><pre><code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MvcHtmlString </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckBoxList</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HtmlHelper helper</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MvcHtmlString(<span class="hljs-string"><span class="hljs-string">"Hello, i'm your CheckBoxList!"</span></span>); }</code> </pre> <br><br>  And we will try to call it in our <b>Index</b> view, the <b>DemoController</b> controller. <br><br>  <i>Note: I deliberately do not write in the text of the article about plugin assemblies and files with a scope, because</i>  <i>I hope that you can do this without my mentioning.</i>  <i>The only thing worth mentioning is adding the &lt;add namespace = "MVC3Controls_H.Core" /&gt; line to the /Views/web.config file, where MVC3Controls_H.Core is the location of your static class with CheckBoxList.</i> <br><br><br>  To call our element, add the following line to <b>Index.cshtml</b> (if you specified Razor Engine when adding a new view): <br><br><pre> <code class="hljs css">@<span class="hljs-keyword"><span class="hljs-keyword">Html</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">CheckBoxList</span></span>()</code> </pre><br><br>  and specify in the <b>Global.asax</b> file, which is in the project root, that the <b>Demo</b> controller should be called by default: <b>Index</b> : <br><br><pre> <code class="hljs pgsql">routes.MapRoute( "Default", // Route <span class="hljs-type"><span class="hljs-type">name</span></span> "{controller}/{action}/{id}", // URL <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> parameters <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> { controller = "Demo", action = "Index", id = UrlParameter.Optional } // Parameter defaults );</code> </pre><br><br>  If all actions have been done correctly, then you will see the following page: <br><br><img src="https://habrastorage.org/storage2/bf5/8c5/6fd/bf58c56fd8d244f58ab5a6c4ef0407f0.png"><br><br>  Fine.  Now we are going to implement the structure of our CheckBoxList. <br><br><h1>  Implementing the CheckBoxList Structure </h1><br>  First of all, let's add the settings for its display in the <b>Controls.cs</b> file.  In our case, these will be 3 <b>enum</b> objects: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Layoutt</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-type"><span class="hljs-type">Table</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-type"><span class="hljs-type">Flow</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Direction</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-type"><span class="hljs-type">Horizontal</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-type"><span class="hljs-type">Vertical</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepeatColumns</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-type"><span class="hljs-type">OneColumn</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-type"><span class="hljs-type">TwoColumns</span></span> = <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-type"><span class="hljs-type">ThreeColumns</span></span> = <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-type"><span class="hljs-type">FourColumns</span></span> = <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-type"><span class="hljs-type">FiveColumns</span></span> = <span class="hljs-number"><span class="hljs-number">5</span></span> }</code> </pre><br><br>  And the <b>CheckBoxList_Settings</b> class, in which we will pass them in a call to our control: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CheckBoxList_Settings</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> cbl_Name = <span class="hljs-string"><span class="hljs-string">"SelectedCheckBoxListItems"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Layoutt cbl_Layout = Layoutt.Table; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Direction cbl_Direction = Direction.Horizontal; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> RepeatColumns cbl_RepeatColumns = RepeatColumns.FiveColumns; }</code> </pre><br><br>  As default settings, we will choose a frame-table, a direction of output-horizontally and a display in the form of five columns.  The <b>cbl_Name</b> property <b>will</b> be discussed later. <br>  We change the constructor of our CheckBoxList to accept a collection of type IDictionary &lt;string, int&gt; and an instance of the settings class: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MvcHtmlString </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckBoxList</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HtmlHelper helper, IDictionary&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; items, CheckBoxList_Settings settings</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MvcHtmlString(<span class="hljs-string"><span class="hljs-string">"Hello, i'm your CheckBoxList!"</span></span>); }</code> </pre><br><br>  We came to the conclusion that in the view we now need not only to call our element, but also to transfer 2 parameters to it, for this we add the data collection method of our controller to the <b>Index</b> : <br><br><pre> <code class="hljs cs">Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; languages = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; { {<span class="hljs-string"><span class="hljs-string">"ActionScript"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Delphi"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-string"><span class="hljs-string">"GO"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Lua"</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Prolog"</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Basic"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Eiffel"</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Haskell"</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Objective-C"</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Python"</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>}, {<span class="hljs-string"><span class="hljs-string">"C"</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Erlang"</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Java"</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Pascal"</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Ruby"</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>}, {<span class="hljs-string"><span class="hljs-string">"C++"</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>}, {<span class="hljs-string"><span class="hljs-string">"F#"</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>}, {<span class="hljs-string"><span class="hljs-string">"JavaScript"</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Perl"</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Scala"</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>}, {<span class="hljs-string"><span class="hljs-string">"C#"</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Fortran"</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Lisp"</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>}, {<span class="hljs-string"><span class="hljs-string">"PHP"</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>} };</code> </pre><br><br>  And we will provide this data to our view as a model: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">View</span></span>(languages);</code> </pre><br><br>  In the code of our presentation, we indicate that the model for it is the data type Dictionary &lt;string, int&gt; and call our CheckBoxList: <br><br><pre> <code class="hljs pgsql">@model <span class="hljs-keyword"><span class="hljs-keyword">Dictionary</span></span>&lt;string, <span class="hljs-type"><span class="hljs-type">int</span></span>&gt; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MVC3Controls_H.Core @{ ViewBag.Title = "Index"; } &lt;h2&gt;<span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>&lt;/h2&gt; @Html.CheckBoxList(Model, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> CheckBoxList_Settings { cbl_Name = "SelectedCheckBoxListItems", cbl_Layout = Layoutt.<span class="hljs-keyword"><span class="hljs-keyword">Table</span></span>, cbl_Direction = Direction.Horizontal, cbl_RepeatColumns = RepeatColumns.FiveColumns })</code> </pre><br><br>  We start the project and see the same customary entry for us: <br><br><img src="https://habrastorage.org/storage2/bf5/8c5/6fd/bf58c56fd8d244f58ab5a6c4ef0407f0.png"><br><br><h1>  Analysis of the current structure of the application </h1><br>  Before proceeding further, we will need to deal with the current structure of the application and possibly change it.  This is what I would like to focus on: <br><ul><li>  At the moment, we are passing a dictionary &lt;string, int&gt; type to our view; however, in most cases, the application uses other data transmitted from the controller, whether it be meta tags (title, description) of the page or entity (registration, form order), - therefore we should not monopolize the model exclusively for our control.  In addition, we will need to store and retrieve the values ‚Äã‚Äãof our element selected by the user somewhere. </li><li>  Suppose that over time, in our CheckBoxList project, we will get more and more views and at some point, we will need to add a new parameter or modify existing ones.  In this case, you will have to change all calls to our control (in all views of the project), and this is not very convenient. </li></ul><br>  From the above it follows that we need: <br><ul><li>  Add a model for the view (ViewModel) and pass the collection for display in CheckBoxList'e as part of this model, along with other data. </li><li>  To transfer the call of our control from the view in partial view, so that in case of a change in the constructor or parameters, we need to change the call for all elements used in our project in just one place. </li><li>  Deliver the transferred values ‚Äã‚Äãof CheckBoxList to a separate data model for our control and transfer it to our partial view in order to maximally isolate our views from changes to the element call. </li></ul><br>  <i>Note: These and many other questions should be taken into account and asked yourself before you start writing application code, however, because</i>  <i>This article is designed for those who are trying to do something similar for the first time, then I will try to consistently lead you to their solution by trial and error.</i> <br><br><h1>  Add view model </h1><br>  Since our presentation model serves not only to transfer data to it, but also to receive it, we will need to add, in addition to the transmitted collection, an array of selected elements.  Add the <b>ViewModels</b> folder to the <b>Models</b> folder, then add the <b>ViewModel_Index.cs</b> file to the <b>ViewModels</b> as shown below: <br><br><img src="https://habrastorage.org/storage2/f8a/746/e3a/f8a746e3aa17faa79f3dbbe7a8b314a2.png"><br><br>  and the code of our view model: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ViewModel_Index</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IDictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; Languages { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] SelectedCheckBoxListItems { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br><br>  <b>The index</b> method of our <b>DemoController</b> 'a will change as follows: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> ActionResult <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">Dictionary</span></span>&lt;string, <span class="hljs-type"><span class="hljs-type">int</span></span>&gt; languages = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dictionary</span></span>&lt;string, <span class="hljs-type"><span class="hljs-type">int</span></span>&gt; { {"ActionScript", <span class="hljs-number"><span class="hljs-number">0</span></span>}, {"Delphi", <span class="hljs-number"><span class="hljs-number">1</span></span>}, {"GO", <span class="hljs-number"><span class="hljs-number">2</span></span>}, {"Lua", <span class="hljs-number"><span class="hljs-number">3</span></span>}, {"Prolog", <span class="hljs-number"><span class="hljs-number">4</span></span>}, {"Basic", <span class="hljs-number"><span class="hljs-number">5</span></span>}, {"Eiffel", <span class="hljs-number"><span class="hljs-number">6</span></span>}, {"Haskell", <span class="hljs-number"><span class="hljs-number">7</span></span>}, {"Objective-C", <span class="hljs-number"><span class="hljs-number">8</span></span>}, {"Python", <span class="hljs-number"><span class="hljs-number">9</span></span>}, {"C", <span class="hljs-number"><span class="hljs-number">10</span></span>}, {"Erlang", <span class="hljs-number"><span class="hljs-number">11</span></span>}, {"Java", <span class="hljs-number"><span class="hljs-number">12</span></span>}, {"Pascal", <span class="hljs-number"><span class="hljs-number">13</span></span>}, {"Ruby", <span class="hljs-number"><span class="hljs-number">14</span></span>}, {"C++", <span class="hljs-number"><span class="hljs-number">15</span></span>}, {"F#", <span class="hljs-number"><span class="hljs-number">16</span></span>}, {"JavaScript", <span class="hljs-number"><span class="hljs-number">17</span></span>}, {"Perl", <span class="hljs-number"><span class="hljs-number">18</span></span>}, {"Scala", <span class="hljs-number"><span class="hljs-number">19</span></span>}, {"C#", <span class="hljs-number"><span class="hljs-number">20</span></span>}, {"Fortran", <span class="hljs-number"><span class="hljs-number">21</span></span>}, {"Lisp", <span class="hljs-number"><span class="hljs-number">22</span></span>}, {"PHP", <span class="hljs-number"><span class="hljs-number">23</span></span>} }; ViewModel_Index _ViewModel_Index = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ViewModel_Index { Languages = languages }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">View</span></span>(_ViewModel_Index); }</code> </pre><br><br>  Since we changed the transmitted model in the controller, it is also necessary to do this in the associated view: <br><br><pre> <code class="hljs pgsql">@<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MVC3Controls_H.Models.ViewModels @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MVC3Controls_H.Core @model ViewModel_Index @{ ViewBag.Title = "Index"; } &lt;h2&gt;<span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>&lt;/h2&gt; @Html.CheckBoxList(Model.Languages, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> CheckBoxList_Settings { cbl_Name = "SelectedCheckBoxListItems", cbl_Layout = Layoutt.<span class="hljs-keyword"><span class="hljs-keyword">Table</span></span>, cbl_Direction = Direction.Horizontal, cbl_RepeatColumns = RepeatColumns.FiveColumns })</code> </pre><br><br>  Thus, if you need, in addition to the collection of data for our control, to transfer something else to the page, you can do it by simply changing the view model <b>/Models/ViewModels/ViewModels_Index.cs</b> (adding new properties to it) and adding their initialization in the controller method. <br><br><h1>  Encapsulating a call to our CheckBoxList </h1><br>  In my <a href="http://habrahabr.ru/blogs/aspnet_mvc/134126/">first article</a> , I already used a similar scheme for calling the extension method, but for several other purposes.  In the current project, in order to make a call to our CheckBoxList in Partial View, we will add the <b>Partial</b> folder, the <b>Controls</b> folder to it, and the new partial view <b>CheckBoxList.cshtml</b> in the <b>Controls</b> folder: <br><br><img src="https://habrastorage.org/storage2/e87/4c4/e1a/e874c4e1af9ef99d95b03451543e65c4.png"><br><br>  Now the structure of our application is as follows: <br><br><img src="https://habrastorage.org/storage2/e29/c64/af5/e29c64af5ac11eaad0acd07a14726690.png"><br><br>  Change our <b>Index</b> view by calling our Partial View instead of CheckBoxList: <br><br><pre> <code class="hljs scala"><span class="hljs-meta"><span class="hljs-meta">@using</span></span> <span class="hljs-type"><span class="hljs-type">MVC3Controls_H</span></span>.<span class="hljs-type"><span class="hljs-type">Models</span></span>.<span class="hljs-type"><span class="hljs-type">ViewModels</span></span> <span class="hljs-meta"><span class="hljs-meta">@using</span></span> <span class="hljs-type"><span class="hljs-type">MVC3Controls_H</span></span>.<span class="hljs-type"><span class="hljs-type">Core</span></span> <span class="hljs-meta"><span class="hljs-meta">@model</span></span> <span class="hljs-type"><span class="hljs-type">ViewModel_Index</span></span> @{ <span class="hljs-type"><span class="hljs-type">ViewBag</span></span>.<span class="hljs-type"><span class="hljs-type">Title</span></span> = <span class="hljs-string"><span class="hljs-string">"Index"</span></span>; } &lt;h2&gt;<span class="hljs-type"><span class="hljs-type">Index</span></span>&lt;/h2&gt; <span class="hljs-meta"><span class="hljs-meta">@Html</span></span>.<span class="hljs-type"><span class="hljs-type">Partial</span></span>(<span class="hljs-string"><span class="hljs-string">"~/Views/Partial/Controls/CheckBoxList.cshtml"</span></span>)</code> </pre><br><br><h1>  Adding a data model for CheckBoxList </h1><br>  Since we plan to transfer the call of our control to our Partial View, we also need to transfer data for it there too - therefore, we need to add a data model for it.  In the <b>Models</b> folder, create a new <b>CheckBoxList</b> folder, add the <b>CheckBoxList_Model.cs</b> class to it: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CheckBoxList_Model</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IDictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; items; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> CheckBoxList_Settings settings; }</code> </pre><br><br>  Let's change the Partial View call in our <b>Index</b> view, passing the added model as data: <br><br><pre> <code class="hljs pgsql">@Html.Partial("~/Views/Partial/Controls/CheckBoxList.cshtml", <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> CheckBoxList_Model { items = Model.Languages, settings = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> CheckBoxList_Settings { cbl_Name = "SelectedCheckBoxListItems", cbl_Layout = Layoutt.<span class="hljs-keyword"><span class="hljs-keyword">Table</span></span>, cbl_Direction = Direction.Horizontal, cbl_RepeatColumns = RepeatColumns.FiveColumns } })</code> </pre><br><br>  and define this model as the model for our Partial View in <b>/Views/Partial/Controls/CheckBoxList.cshtml</b> , calling and passing values ‚Äã‚Äãto our control: <br><br><pre> <code class="hljs scala"><span class="hljs-meta"><span class="hljs-meta">@model</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Model</span></span> <span class="hljs-meta"><span class="hljs-meta">@Html</span></span>.<span class="hljs-type"><span class="hljs-type">CheckBoxList</span></span>(<span class="hljs-type"><span class="hljs-type">Model</span></span>.items, <span class="hljs-type"><span class="hljs-type">Model</span></span>.settings)</code> </pre><br><br>  This completes the structure of the application.  Consider its main points: <br><br><img src="https://habrastorage.org/storage2/05e/c50/aa1/05ec50aa14e1fefa3928cd8a8bb8696b.png"><br><br>  The good news is that we are finally done with the structure of our application, and the bad, we haven't written much about our CheckBoxList yet. <br><br><h1>  CheckBoxList implementation </h1><br>  To begin with, we describe the general algorithm for constructing our element: <br>  1. Selection of a framing HTML tag (table, div) based on the <b>cbl_Layout</b> parameter. <br>  2. Determination of the number of iterations of the collection based on the <b>cbl_RepeatColumns</b> parameter and the number of records in the collection. <br>  3. Formation of the condition for selecting elements from the collection based on the sequence number of the current iteration: <br>  3.1.  If the output is carried out horizontally, and the number of columns = 4, then the first row should consist of the first 4 elements of the collection going in order, the second of the following 4, and so on: <br><br><pre> <code class="hljs css"><span class="hljs-selector-attr"><span class="hljs-selector-attr">[0 1 2 3]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> 0  <span class="hljs-selector-attr"><span class="hljs-selector-attr">[4 5 6 7]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> 1  <span class="hljs-selector-attr"><span class="hljs-selector-attr">[8 9 10 11]</span></span></code> </pre><br><br>  3.2.  If the output is carried out vertically, the number of columns = 4 and the total of elements 24, then the first line should consist (!) Of every sixth element of the collection, the second of iteration number + 6, etc .: <br><br><pre> <code class="hljs css"><span class="hljs-selector-attr"><span class="hljs-selector-attr">[0 6 12 18]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> 0  <span class="hljs-selector-attr"><span class="hljs-selector-attr">[1 7 13 19]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> 1  <span class="hljs-selector-attr"><span class="hljs-selector-attr">[2 8 14 20]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[3 9 15 21]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[4 10 16 22]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[5 11 17 23]</span></span></code> </pre><br><br>  3.3.  Do not forget when calculating the number of iterations (number of elements / number of columns) about the remainder of the division! = 0. In this case, we need extra iteration to display the entire collection. <br><br><pre> <code class="hljs css"><span class="hljs-selector-attr"><span class="hljs-selector-attr">[0 1 2 3]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> 0  <span class="hljs-selector-attr"><span class="hljs-selector-attr">[4 5 6 7]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> 1  <span class="hljs-selector-attr"><span class="hljs-selector-attr">[8 9 10 11]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[12 13 - -]</span></span></code> </pre><br><br>  4. Forming a string of suitable for the condition of the sample at each iteration, depending on the framing tag (div, table): <br>  4.1.  For a div, this will only be hyphenated at the end of the line. <br>  4.2.  For table, this is: <br>  4.2.1.   at the beginning of the line.   label   in the process of sorting items.   at the end of the line. <br>  5. Close the framing tag and return the generated string to the view. <br><br>  Since the main idea of ‚Äã‚Äãthe article is not the code and algorithms, I will give only a part of the functions - you can see the rest by downloading the project at the end of the article, stopping perhaps a bit more at the formation of the CheckBox markup: <br><br><h2>  Generating HTML CheckBox and Model Binding markup </h2><br>  In general terms, this is the simplest code to which an element of the collection and settings of our control is passed.  Perhaps the main thing in this code is that the name attribute is assigned the name of our entire CheckBoxList.  This is done so that in the future, when retrieving data on the server side in our <b>Index</b> method of the <b>DemoController</b> controller <b>,</b> we can get the selected values ‚Äã‚Äãin the form of a formed array - I will show this later with an example later. <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateHtmlMarkup_CheckBox</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">KeyValuePair&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; item, CheckBoxList_Settings settings</span></span></span><span class="hljs-function">)</span></span> { TagBuilder tagBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TagBuilder(<span class="hljs-string"><span class="hljs-string">"input"</span></span>); tagBuilder.MergeAttribute(<span class="hljs-string"><span class="hljs-string">"type"</span></span>, <span class="hljs-string"><span class="hljs-string">"checkbox"</span></span>); tagBuilder.MergeAttribute(<span class="hljs-string"><span class="hljs-string">"name"</span></span>, settings.cbl_Name); tagBuilder.MergeAttribute(<span class="hljs-string"><span class="hljs-string">"value"</span></span>, item.Value.ToString()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tagBuilder.ToString(TagRenderMode.SelfClosing); }</code> </pre><br><br><h2>  HTML Label Formation </h2><br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateHtmlMarkup_Label</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">KeyValuePair&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; item</span></span></span><span class="hljs-function">)</span></span> { TagBuilder tagBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TagBuilder(<span class="hljs-string"><span class="hljs-string">"label"</span></span>); tagBuilder.SetInnerText(item.Key); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tagBuilder.ToString(TagRenderMode.Normal); }</code> </pre><br><br><h2>  Calculating the number of iterations: </h2><br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iMod = items.Count % (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)settings.cbl_RepeatColumns; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iterationsCount = items.Count / (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)settings.cbl_RepeatColumns + (iMod == <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><br><br><h2>  Selection condition for each iteration: </h2><br><br><pre> <code class="hljs lisp">foreach (<span class="hljs-name"><span class="hljs-name">KeyValuePair&lt;string</span></span>, int&gt; item in items.Where((<span class="hljs-name"><span class="hljs-name">item</span></span>, index) =&gt; settings.cbl_Direction == Direction.Horizontal ? index / (<span class="hljs-name"><span class="hljs-name">int</span></span>)settings.cbl_RepeatColumns == i : (<span class="hljs-name"><span class="hljs-name">index</span></span> - i) % iterationsCount == <span class="hljs-number"><span class="hljs-number">0</span></span>))</code> </pre><br><br>  where i is the iteration number. <br>  When outputting horizontally, we take elements whose indices when divided by the number of columns == i: <br><br><pre> <code class="hljs json">[<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>] [<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>] [<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>]</code> </pre><br><br>  When outputting vertically, we take elements, the remainder of dividing the index of which and the current iteration by the number of iterations == 0: <br><br><pre> <code class="hljs json">[<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span>] [<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span>]</code> </pre><br><br><h1>  Health check </h1><br>  Let's take a look at the 3 CheckBoxLists as an example, what we got in the end: <br><br><pre> <code class="hljs scala">&lt;h2&gt;<span class="hljs-type"><span class="hljs-type">Index</span></span>&lt;/h2&gt; <span class="hljs-meta"><span class="hljs-meta">@using</span></span> (<span class="hljs-type"><span class="hljs-type">Html</span></span>.<span class="hljs-type"><span class="hljs-type">BeginForm</span></span>()) { <span class="hljs-meta"><span class="hljs-meta">@Html</span></span>.<span class="hljs-type"><span class="hljs-type">Partial</span></span>(<span class="hljs-string"><span class="hljs-string">"~/Views/Partial/Controls/CheckBoxList.cshtml"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Model</span></span> { items = <span class="hljs-type"><span class="hljs-type">Model</span></span>.<span class="hljs-type"><span class="hljs-type">Languages</span></span>, settings = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Settings</span></span> { cbl_Name = <span class="hljs-string"><span class="hljs-string">"SelectedCheckBoxListItems"</span></span>, cbl_Layout = <span class="hljs-type"><span class="hljs-type">Layoutt</span></span>.<span class="hljs-type"><span class="hljs-type">Table</span></span>, cbl_Direction = <span class="hljs-type"><span class="hljs-type">Direction</span></span>.<span class="hljs-type"><span class="hljs-type">Horizontal</span></span>, cbl_RepeatColumns = <span class="hljs-type"><span class="hljs-type">RepeatColumns</span></span>.<span class="hljs-type"><span class="hljs-type">FiveColumns</span></span> }, htmlAttributes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { <span class="hljs-meta"><span class="hljs-meta">@cellpadding</span></span> = <span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-meta"><span class="hljs-meta">@cellspacing</span></span> = <span class="hljs-string"><span class="hljs-string">"0"</span></span> } }) &lt;br /&gt; <span class="hljs-meta"><span class="hljs-meta">@Html</span></span>.<span class="hljs-type"><span class="hljs-type">Partial</span></span>(<span class="hljs-string"><span class="hljs-string">"~/Views/Partial/Controls/CheckBoxList.cshtml"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Model</span></span> { items = <span class="hljs-type"><span class="hljs-type">Model</span></span>.<span class="hljs-type"><span class="hljs-type">Languages</span></span>, settings = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Settings</span></span> { cbl_Name = <span class="hljs-string"><span class="hljs-string">"SelectedCheckBoxListItemsTwo"</span></span>, cbl_Layout = <span class="hljs-type"><span class="hljs-type">Layoutt</span></span>.<span class="hljs-type"><span class="hljs-type">Flow</span></span>, cbl_Direction = <span class="hljs-type"><span class="hljs-type">Direction</span></span>.<span class="hljs-type"><span class="hljs-type">Vertical</span></span>, cbl_RepeatColumns = <span class="hljs-type"><span class="hljs-type">RepeatColumns</span></span>.<span class="hljs-type"><span class="hljs-type">ThreeColumns</span></span> } }) &lt;br /&gt; <span class="hljs-meta"><span class="hljs-meta">@Html</span></span>.<span class="hljs-type"><span class="hljs-type">Partial</span></span>(<span class="hljs-string"><span class="hljs-string">"~/Views/Partial/Controls/CheckBoxList.cshtml"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Model</span></span> { items = <span class="hljs-type"><span class="hljs-type">Model</span></span>.<span class="hljs-type"><span class="hljs-type">Languages</span></span>, settings = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Settings</span></span> { cbl_Name = <span class="hljs-string"><span class="hljs-string">"SelectedCheckBoxListItemsThree"</span></span>, cbl_Layout = <span class="hljs-type"><span class="hljs-type">Layoutt</span></span>.<span class="hljs-type"><span class="hljs-type">Flow</span></span>, cbl_Direction = <span class="hljs-type"><span class="hljs-type">Direction</span></span>.<span class="hljs-type"><span class="hljs-type">Horizontal</span></span>, cbl_RepeatColumns = <span class="hljs-type"><span class="hljs-type">RepeatColumns</span></span>.<span class="hljs-type"><span class="hljs-type">TwoColumns</span></span> } }) &lt;br /&gt; &lt;input <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"submit"</span></span> value=<span class="hljs-string"><span class="hljs-string">"send"</span></span> /&gt; }</code> </pre><br><br><img src="https://habrastorage.org/storage2/04a/185/d57/04a185d57a938e1fa5f4e4cd145461ad.png"><br><br>  In order to get the selected values, we need to add 3 arrays with the names that we pass to our CheckBoxLists in the model of our <b>ViewModel_Index</b> : <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ViewModel_Index</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IDictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; Languages { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] SelectedCheckBoxListItems { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] SelectedCheckBoxListItemsTwo { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] SelectedCheckBoxListItemsThree { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br><br>  and also add the <b>Index</b> controller method that handles post requests: <br><br><pre> <code class="hljs cs">[<span class="hljs-meta"><span class="hljs-meta">HttpPost</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ActionResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Index</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ViewModel_Index model</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> return View(); }</span></span></code> </pre><br><br>  Putting a breakpoint, look at the result: <br><br><img src="https://habrastorage.org/storage2/54b/80c/d3b/54b80cd3b67d77b8ff0c05ecff575d71.png"><br><br>  If you are absolutely indifferent to duplication of code, model of representations and maintenance, then you can also just call CheckBoxList directly in the view and get the selected values ‚Äã‚Äãon the server directly in the array (however, you should not forget that the name CheckBoxList and the accepted parameter on the server should be the same): <br><br><img src="https://habrastorage.org/storage2/38c/f03/32a/38cf0332ab93887f12ce719c6dfe705e.png"><br><br><img src="https://habrastorage.org/storage2/b30/d07/d23/b30d07d23d9dfeedf3bb5928a0bb16bc.png"><br><br><img src="https://habrastorage.org/storage2/c77/c2e/aac/c77c2eaacc07b23e475c214ecb715847.png"><br><br>  Well, now that we have completely finished what we planned, the last remains.  Consider expanding our control with new properties on the example of <b>object htmlAttributes</b> . <br><br><h1>  Extend CheckBoxList </h1><br>  In order to pass a new property to the code of our element, we have to go from the constructor to the initial call (or vice versa, as someone like more).  It all starts with our constructor in <b>Controls.cs</b> - we add a new parameter object htmlAttributes: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MvcHtmlString </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckBoxList</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HtmlHelper helper, IDictionary&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; items, CheckBoxList_Settings settings, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> htmlAttributes</span></span></span><span class="hljs-function">)</span></span></code> </pre><br><br>  Our constructor is called in Partial View with the name <b>CheckBoxList.cshtml</b> .  Add a new property for the CheckBoxList model: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CheckBoxList_Model</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IDictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; items; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> CheckBoxList_Settings settings; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> htmlAttributes; }</code> </pre><br><br>  And pass it when called in our Partial View: <br><br>  Before: <br><br><pre> <code class="hljs scala"><span class="hljs-meta"><span class="hljs-meta">@model</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Model</span></span> <span class="hljs-meta"><span class="hljs-meta">@Html</span></span>.<span class="hljs-type"><span class="hljs-type">CheckBoxList</span></span>(<span class="hljs-type"><span class="hljs-type">Model</span></span>.items, <span class="hljs-type"><span class="hljs-type">Model</span></span>.settings)</code> </pre><br><br>  After: <br><br><pre> <code class="hljs scala"><span class="hljs-meta"><span class="hljs-meta">@model</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Model</span></span> <span class="hljs-meta"><span class="hljs-meta">@Html</span></span>.<span class="hljs-type"><span class="hljs-type">CheckBoxList</span></span>(<span class="hljs-type"><span class="hljs-type">Model</span></span>.items, <span class="hljs-type"><span class="hljs-type">Model</span></span>.settings, <span class="hljs-type"><span class="hljs-type">Model</span></span>.htmlAttributes)</code> </pre><br><br>  It remains to add the property initialization itself in the <b>Index</b> view and add the code of our element: <br><br><pre> <code class="hljs scala"> <span class="hljs-meta"><span class="hljs-meta">@Html</span></span>.<span class="hljs-type"><span class="hljs-type">Partial</span></span>(<span class="hljs-string"><span class="hljs-string">"~/Views/Partial/Controls/CheckBoxList.cshtml"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Model</span></span> { items = <span class="hljs-type"><span class="hljs-type">Model</span></span>.<span class="hljs-type"><span class="hljs-type">Languages</span></span>, settings = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">CheckBoxList_Settings</span></span> { cbl_Name = <span class="hljs-string"><span class="hljs-string">"SelectedCheckBoxListItemsThree"</span></span>, cbl_Layout = <span class="hljs-type"><span class="hljs-type">Layoutt</span></span>.<span class="hljs-type"><span class="hljs-type">Table</span></span>, cbl_Direction = <span class="hljs-type"><span class="hljs-type">Direction</span></span>.<span class="hljs-type"><span class="hljs-type">Vertical</span></span>, cbl_RepeatColumns = <span class="hljs-type"><span class="hljs-type">RepeatColumns</span></span>.<span class="hljs-type"><span class="hljs-type">FourColumns</span></span> }, htmlAttributes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { <span class="hljs-meta"><span class="hljs-meta">@border</span></span> = <span class="hljs-string"><span class="hljs-string">"3"</span></span>, style = <span class="hljs-string"><span class="hljs-string">"color: Grey; border-style:dashed;"</span></span> } })</code> </pre><br><br>  Frame selection code (table, div): <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> TagBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateHtmlMarkup_OuterTag</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Layoutt cbl_Layout, IDictionary&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; htmlAttributes</span></span></span><span class="hljs-function">)</span></span> { ... TagBuilder tagBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TagBuilder(htmlTag); tagBuilder.MergeAttributes(htmlAttributes); ... }</code> </pre><br><br>  As you can see below, everything works: <br><br><img src="https://habrastorage.org/storage2/e3b/fc1/94e/e3bfc194e02c9af70b17de3486eb5f28.png"><br><br><h1>  Conclusion </h1><br>  As a conclusion, I would like to understand what we did after all: <br><ul><li>  We considered the possibility of creating, using and extending our own Html-based control of ASP .NET MVC helpers; </li><li>  Created a project framework for further development of controls; </li><li>  Implemented the structure of a web application with the division of responsibilities of each functional unit; </li><li>  We learned about the site, with which there is something to compete when writing your own controls. </li></ul><br><br><h1>  List of materials </h1><br>  1. <a href="http://mvc.devexpress.com/Editors/CheckBoxList">http://mvc.devexpress.com/Editors/CheckBoxList</a> <br>  2. <a href="http://stackoverflow.com/questions/220020/how-to-handle-checkboxes-in-asp-net-mvc-forms">How to handle checkboxes in ASP.NET MVC forms</a> <br>  3. <a href="">Project Source Code</a> </div><p>Source: <a href="https://habr.com/ru/post/134920/">https://habr.com/ru/post/134920/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134911/index.html">Asterisk 10.0.0 Is Released!</a></li>
<li><a href="../134913/index.html">There is such a profession</a></li>
<li><a href="../134916/index.html">PHP autodocumentation in NetBeans 7.01 using phpDocumentor, telling, configuring, fixing</a></li>
<li><a href="../134917/index.html">What is the preferred option for navigating the large table?</a></li>
<li><a href="../134918/index.html">Grab: Spider parsing framework</a></li>
<li><a href="../134922/index.html">2GIS updates the online version of the directory</a></li>
<li><a href="../134923/index.html">2GIS launches API cards</a></li>
<li><a href="../134924/index.html">Bacula: realtime filesets on Windows clients</a></li>
<li><a href="../134925/index.html">Android infringes a patent on ‚Äúretrieving a phone number from a message for use in another application‚Äù!</a></li>
<li><a href="../134927/index.html">IBM predicts the emergence of thought-driven computers within five years.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>