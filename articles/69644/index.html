<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Debugging .Net Framework Source Code in MS VS 2008 and More</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translation of several articles, incl. Shawn Burke ( thanks! ), ScottGu ( thanks! ), Paul Krill ( thanks! ) And John Robbins ( First great thanks! Sec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Debugging .Net Framework Source Code in MS VS 2008 and More</h1><div class="post__text post__text-html js-mediator-article">  Translation of several articles, incl.  Shawn Burke ( <a href="http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx">thanks!</a> ), ScottGu ( <a href="http://weblogs.asp.net/scottgu/archive/2008/01/16/net-framework-library-source-code-now-available.aspx">thanks!</a> ), Paul Krill ( <a href="http://www.infoworld.com/d/developer-world/microsoft-opening-net-framework-libraries-893">thanks!</a> ) And John Robbins ( <a href="http://www.wintellect.com/cs/blogs/jrobbins/archive/2008/02/07/net-mass-downloader-1-1-released.aspx">First great thanks!</a> <a href="http://www.wintellect.com/cs/blogs/jrobbins/archive/2008/02/06/download-all-the-net-reference-source-code-at-once-with-net-mass-downloader.aspx">Second great thanks!</a> ) <br><br>  The end result to which we are striving here is the possibility of a debugger for any IDE to go "inside" of the .Net Framework methods.  I hope this post contains everything you need.  The last few weeks we have done a lot of experiments and collected a lot of data on this issue.  And we want to share our experience with the community. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Method # 1: Configure Visual Studio to debug .NET Framework source code (Visual Studio 2008 only. Theoretically 2010) </h4><br>  If you have any problems, please make sure you have completed all the steps first.  In ACCURACY as written by us.  If, however, nothing helps, pay attention to the FAQ section at the end of the document.  If this does not work, write your comments, we will solve them all together. <br><br><h5>  Basic setting </h5><br>  To begin with, I note that if you have MS VS 2008 Express Edition installed, then it will not work for you. <br><br>  <b>1)</b> Install <a href="https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx%3FDownloadID%3D10443%26wa%3Dwsignin1.0">Visual Studio QFE</a> .  This fix simply updates the DLLs that are part of the Visual Studio debugger, which selects the source files.  All the details of the corrections read on the download page. <br><br>  If you received an update error message, try inserting your DVD VS 2008 and run the EXE again.  This may help to install the fix correctly. <br><br>  <b>2)</b> Start Visual Studio and select Tools&gt; Options&gt; Debugging&gt; General.  If you are working on a Visual Basic Profile, you need to check the box at the bottom of the Options Dialog, ‚ÄúShow All Settings‚Äù before continuing. <br><br>  Set the following settings: <br><ul><li>  Turn off "Enable Just Me Code (Managed only)" </li><li>  Enable "Enable source server support" </li></ul><br>  Everything should turn out like this: <br><br><img src="http://docs.google.com/File?id=dhsgpk83_10fdwrtdgx_b" alt="image"><br><br>  <b>3)</b> Next, select Debugging&gt; Symbols from the properties tree.  Set the source of symbols for download and the space on your hard disk where Visual Studio will cache them: <br>  Add to the Symbol file (.pdb) location address: <a href="http://referencesource.microsoft.com/symbols">http://referencesource.microsoft.com/symbols</a> <br>  Set the cache location.  Make sure that this place has read and write permissions.  A great option is the place of your documents.  For example, C: \ Users \ Stanislav \ VsSymbols. <br>  Check the box: Search the above locations only whan symbols are loaded manually. <br><br>  Everything, installation is made! <br><br><h5>  Debugging inside the Source Code Framework </h5><br>  To do this, take a simple example.  Create an empty C # Windows Application project.  Set the entry point to <b>Form_Load</b> . <br><br><img src="http://docs.google.com/File?id=dhsgpk83_11cfddmfgn_b" alt="image"><br><br>  We start solution debugging.  When the program stops at the breakpoint we set, go to the Call Stack window.  In the call stack, right-click on the line starting with <b>System.Windows.Forms.dll</b> and select Load Symbols.  We hope that you have a good Internet channel.  Otherwise, stock up in advance buns and tea.  Files to be downloaded weigh about 10 megabytes.  Please note that Visual Studio will not respond all this time (minus it in karma. A good tone is the loading indicator. What if it hangs? Then kill the process. And if it doesn‚Äôt hang? Kill - time is a pity).  However, such a download is performed once and will be stored on your computer in the directory with the cache you specified above. <br><br><img src="http://docs.google.com/File?id=dhsgpk83_12cz8cxnft_b" alt="image"><br><br>  These actions will allow to load symbols from the DLL from sevrera, and you will see that all the lines denoting calls inside <b>System.Windows.Forms.dll</b> will turn black, i.e.  affordable.  Line numbers will also be available.  Remember that every time you need to look at the symbols, you will need to right-click and select Load Symbols. <br><br><img src="http://docs.google.com/File?id=dhsgpk83_13cwc3pscp_b" alt="image"><br><br>  So, from this moment on, all the symbols for System.Windows.Forms.dll are loaded and now you can watch its code.  You can view the code in exactly the same way as during normal debugging of your code.  To do this, as usual, double-click the CallStack line or go inside the build methods for <b>(F11)</b> .  When you try to review the code for the first time, you will be offered a license, on the basis of which you are allowed to read it, and if you agree with it, click Accept, after which the source code will be downloaded. <br><br><img src="http://docs.google.com/File?id=dhsgpk83_14d54zxpdz_b" alt="image"><br><br>  Now for all the builds in which you want to debug, just repeat all the steps described above.  If you need to debug those assemblies that are not in the Call Stack, open the Modules window and download the symbols from there. <br><br><img src="http://docs.google.com/File?id=dhsgpk83_15cddhf3dg_b" alt="image"><br><br><img src="http://docs.google.com/File?id=dhsgpk83_16c9t6t28q_b" alt="image"><br><br>  Now you can in the example above go to the code DrawRectangle on F11. <br><br><h5>  For advanced users </h5><br>  As a rule, during each debugging session, Visual Studio tries to load symbols for each DLL that is loaded into the process being debugged.  To find information on characters, it looks at all the paths specified in Options&gt; Debugging&gt; Symbols.  But there are projects that use a lot of DLLs for which there is no information on symbols.  In these cases, the debugging process will be very long.  This is the main reason why we advise you to use character loading on demand. <br><br>  There is, however, a way to automatically load symbols (which essentially eliminates the ‚ÄúLoad Symbols‚Äù step), which increases overall performance.  It makes sense to install this flag only to advanced users of the system, since then you will have to return to this dialogue quite often.  By the way, in order to quickly enter it, select "Symbol Settings ..." in the context menu on the image above. <br><br>  The basis of this is to get all the characters, download them and store them locally.  To do this, disable the "Search the above locations ..." checkbox. <br><br>  After that, run your project in the debugger.  Oh, by the way, sorry, I completely forgot to say.  Be patient, tea and cakes.  Depending on the connection, the studio will either download long or very long.  Total need to download about 50 megabytes.  And since  All this will be cached, then this will be at the same time. <br><br><img src="http://docs.google.com/File?id=dhsgpk83_17s5dmdcd9_b" alt="image"><br><br>  Once this process is complete, you can stop the debugger and remove the source with the server address and click OK: <br><br><img src="http://docs.google.com/File?id=dhsgpk83_18fdrzjkfm_b" alt="image"><br><br>  After these steps, all characters will be loaded automatically, and you will be able to intervene in the call stack without early restrictions.  Please note that if you are working on another project that does not contain information on loaded symbols, then repeat all these steps;) <br><br><h5>  FAQ </h5><br>  <b>1) When I select ‚ÄúLoad Symbols‚Äù, I get an ‚ÄúOpen File‚Äù dialog box in which I specify the position of the .pdb file</b> <br>  This can happen in four situations: <br><ol><li>  You have not configured or configured, but the server address is not correct: <a href="http://referencesource.microsoft.com/symbols">referencesource.microsoft.com/symbols</a> </li><li>  You have selected a directory for the cache in such a way that your account does not allow Visual Studio to write or read files along this path. </li><li>  You are trying to load symbols for DLLs for which they do not exist. </li><li>  You may have a different version of the .NET Framework installed.  This can happen, for example, if you have Microsoft Server 2008 Beta installed.  To check this, look at the version number for the mscorlib.dll assembly. It should be 2.0.50727.1433, if not, install the <a href="http://www.microsoft.com/downloads/details.aspx%253FFamilyID%253D333325fd-ae52-4e35-b531-508d977d32a6%2526displaylang%253Den%26prev%3D_t%26rurl%3Dtranslate.google.ru">RTM version of .NET Framework 3.5</a> </li></ol><br><br><img src="http://docs.google.com/File?id=dhsgpk83_19f4gj9bhs_b" alt="image"><br><br>  Also check your <b>"C: \ Program Files \ Microsoft Visual Studio 9.0 \ Common7 \ IDE"</b> (or the place where you installed Visual Studio) a file called <b>symsrv.no</b> .  If this file exists, rename it to <b>symsrv.yes</b> . <br><br>  <b>2) When I try to debug inside the source code, I get the dialog ‚ÄúSource is not available for this location‚Äù</b> <br>  First, see item (2) in the FAQ.  to make sure all the characters were loaded successfully.  This can be seen by looking at the Modules window, in the character status column.  If characters are loaded, check the following: <br>  If you have configured Microsoft Symbol Server in the past, and you have loaded symbols for this DLL, which do not contain source codes.  Try to specify a different cache location or delete the existing cache, then roll up the ‚ÄúLoad Symbols‚Äù command.  See also FAQ (3) for more information. <br>  Make sure once again that you have enabled the ‚ÄúEnable Source Server‚Äù checkbox in the Tools&gt; Options&gt; Debugging&gt; General window. <br>  Make sure the folder that is configured to collect the character cache has read and write permissions. <br>  If you have _NT_SYMBOL_PATH installed, it will override all these settings.  For details <a href="http://codebetter.com/blogs/james.kovacs/archive/2008/01/17/debugging-into-the-net-framework-source.aspx">here</a> <br><br>  <b>3) I also use Microsoft Symbol Server to load symbols.</b>  <b>What is the difference?</b> <br><br>  Microsoft Symbol Server will provide you with symbols without providing any information in them.  This information will be deleted before publication.  To use both the Reference Source path and the Micrososft Symbol Server this is the location of the Reference Source path first on the list. <br><br><img src="http://docs.google.com/File?id=dhsgpk83_20f3s5gkgb_b" alt="image"><br><br>  However, if you have a Microsoft Symbol Server configured via _NT_SYMBOL_PATH, remember that _NT_SYMBOL_PATH overrides these settings. <br><br>  <b>4) Is there support for 64-bit OS?</b> <br><br>  Yes, subject to availability of 64-bit PDB versions.  It is worth noting here that there are DLLs that work on various architectures.  Therefore, they will need only one PDB. <br><br>  <b>5) How can I set breakpoints in Framework code?</b> <br><br>  Initially, Visual Studio requires the code to exactly match the PDB file.  Although quite often PDB files are not significantly changed.  For example, the author added copyright strings.  But the code can still be easily debugged.  Just set a breakpoint (an incomplete shaded point will appear) and specify the location of the PDB file (context menu from breakpoint, Location position ...) <br><br><img src="http://docs.google.com/File?id=dhsgpk83_21zbthh6gc_b" alt="image"><br><br>  Then check the box below: <br><br><img src="http://docs.google.com/File?id=dhsgpk83_22ggknzpfp_b" alt="image"><br><br>  After these actions, you can safely continue working. <br><br>  <b>6) Why don't features like ‚ÄúGo To Defenition‚Äù work?</b> <br><br>  Because this information is created on the period of working with the code, and not during the execution. <br><br>  <b>7) Why are some members or local variables not available?</b>  <b>Why can't I go inside some methods or walk along some lines of code?</b> <br><br>  This means that the .NET Framework optimizes code for size and performance.  Some of these optimizations remove some information when it is no longer needed.  Debugging reflects this.  However, most debugging information is still present in the session, and setting breakpoints at the beginning of the methods makes it visible.  The second reason may be that some of the methods are built-in, which means that you cannot go inside these methods.  But for the most part of the source code you can debug freely. <br><br>  <b>8) Why are PDB files loaded for so long?</b> <br><br>  Because there are many of them, and among them there are files under 1 megabyte. <br><br>  <b>9) Can I open and view them through the browser?</b> <br><br>  No, you get an HTTP 400 error. <br><br><h4>  Method # 2: Download from the official Microsoft website in one archive (any IDE) </h4><br>  To download all symbols and source codes in one archive, follow the link: <a href="http://referencesource.microsoft.com/netframework.aspx">http://referencesource.microsoft.com/netframework.aspx</a> . <br>  However, of the entire set of links provided for download, only one worked for me.  Not solid. <br><br><h4>  Method # 3: .NET MASS DOWNLOADER (any IDE) </h4><br>  Designed for downloading all symbols and source codes.  It works from the command line and is available in source code. <br><br>  To download what we need, click on the link ( <a href="http://www.codeplex.com/NetMassDownloader">.NET MASS DOWNLOADER</a> ), download it and run as follows: <br><br><ul><li>  For 32-bit systems: NetMassDownloader.exe -d "C: \ Windows \ Microsoft.Net \ Framework \ v2.0.50727" -d "C: \ Program Files \ Reference Assemblies \ Microsoft \ Framework \ v3.5" </li><li>  For 64 bit systems: NetMassDownloader.exe -d "C: \ Windows \ Microsoft.Net \ Framework \ v2.0.50727" -d "C: \ Windows \ Microsoft.Net \ Framework64 \ v2.0.50727" -d "C: \ Program Files \ Reference Assemblies \ Microsoft \ Framework \ v3.5 "-d" C: \ Program Files (x86) \ Reference Assemblies \ Microsoft \ Framework \ v3.5 " <br></li></ul>  And of course, this method is good when you do not have MSVS 2008, but installed, for example, MS VS 2005 or CodeGear's RAD Studio or #develop. <br>  Setting up Visual Studio for ways # 2 and # 3 <br><br>  Configure Visual Studio as shown below: <br><br><img src="http://docs.google.com/File?id=dhsgpk83_24dj235khg_b" alt="image"><br><br><img src="http://docs.google.com/File?id=dhsgpk83_25c56fkdd2_b" alt="image"><br><br><img src="http://docs.google.com/File?id=dhsgpk83_26cxpz4kdd_b" alt="image"><br><br> <a href="http://progg.ru/%25D0%259E%25D1%2582%25D0%25BB%25D0%25B0%25D0%25B4%25D0%25BA%25D0%25B0-%25D0%25B8%25D1%2581%25D1%2585%25D0%25BE%25D0%25B4%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE-%25D0%25BA%25D0%25BE%25D0%25B4%25D0%25B0-Net-Framework-%25D0%25B2-MS-VS-2008-%25D0%25B8-%25D0%25BD%25D0%25B5-%25D1%2582%25D0%25BE%25D0%25BB%25D1%258C%25D0%25BA%25D0%25BE"><img alt="Progg it" src="http://progg.ru/image.axd?url=http%3A%2F%2Fsunexdevelopment.habrahabr.ru%2Fblog%2F69644%2F"></a> </div><p>Source: <a href="https://habr.com/ru/post/69644/">https://habr.com/ru/post/69644/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../69637/index.html">Follow ashton kutcher</a></li>
<li><a href="../69638/index.html">Horizontal menus, some tips</a></li>
<li><a href="../69641/index.html">Photos of the working version of HTC Leo</a></li>
<li><a href="../69642/index.html">Solve the problem using one bit of memory 2: we take into account the interference</a></li>
<li><a href="../69643/index.html">category tree in its own way (webasyst shop-script)</a></li>
<li><a href="../69647/index.html">Explay CMS 3.1</a></li>
<li><a href="../69650/index.html">Interesting task: we increase the stability (robustness) of applications (part 2)</a></li>
<li><a href="../69651/index.html">Using the Google Analytics API to build site visit statistics</a></li>
<li><a href="../69652/index.html">Google launched site statistics</a></li>
<li><a href="../69653/index.html">Windows 7 and USB modem HUAWEI E1550</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>