<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New mitigation mechanisms in Windows 8.1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Earlier we wrote about some of the mechanisms of operational difficulties (mitigation) for Windows and applications that Microsoft was trying to bring...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New mitigation mechanisms in Windows 8.1</h1><div class="post__text post__text-html js-mediator-article">  Earlier we wrote about some of the mechanisms of operational difficulties (mitigation) for Windows and applications that Microsoft was trying to bring with the release of new operating systems.  As a rule, such mechanisms are based on the following conceptual approaches: <br><br><ul><li>  Differentiation of application access rights to OS resources ( <a href="http://windows.microsoft.com/en-us/windows7/what-is-user-account-control">User Account Control</a> , <a href="http://msdn.microsoft.com/en-us/library/bb625957.aspx">Integrity Level</a> ).  Vista + </li><li>  Special mitigating factors when working with <a href="http://blogs.technet.com/b/srd/archive/2010/12/08/on-the-effectiveness-of-dep-and-aslr.aspx%3FRedirected%3Dtrue">DEP &amp; ASLR</a> memory.  XP SP2 / Vista +.  DEP is set by system settings and in Windows 8+ it is active for all applications (processor support).  ASLR works for applications compiled with its support. </li><li>  Kernel ASLR / DEP, for components that operate in kernel mode.  Vista SP1 +.  ASLR / DEP is active by default for kernel-mode modules, DEP from executing data in the pool requires selections from <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/hh920391(v%3Dvs.85).aspx">NonPagedPoolNx</a> (Windows 8+). </li><li>  Protection against rewriting pointers to functions in SEH at the OS level (SEHOP).  Vista SP1 +.  By default, it is active only for server editions. </li><li>  Free <a href="http://habrahabr.ru/company/eset/blog/184428/">EMET</a> tool (v 4.1 last update) to enhance the system‚Äôs immunity from exploit actions.  For Windows XP +. </li><li>  Advanced isolation of <a href="http://blogs.msdn.com/b/ieinternals/archive/2012/03/23/understanding-ie10-enhanced-protected-mode-network-security-addons-cookies-metro-desktop.aspx">AppContainer</a> processes (aka sandboxing, advanced Integrity Level).  Windows 8+.  Used for Internet Explorer 10+ and all Modern UI aka Metro applications. </li><li>  <b>Blocking access to obtaining information about the addresses of kernel objects for untrusted applications ( <a href="http://www.alex-ionescu.com/%3Fp%3D82">KASLR bypass mitigation</a> ).</b>  <b>Windows 8.1.</b> </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd3/543/314/bd3543314f68d25bf3b104381a311e64.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  The last point deserves special attention, since this innovation was added by MS in Windows 8.1 as an extension for AppContainer mode or Integrity Level.  Relatively speaking, the untrusted aka restricted caller application (whose Integrity Level &lt; <a href="http://msdn.microsoft.com/en-us/library/bb625963.aspx">Medium</a> ) does not have the right to obtain information about the addresses of various objects in the kernel mode, which means the actual compromise of the KASLR restrictions and the subsequent possible operation of the LPE (Local Privelege Escalation).  The main functions of disclosing such information were of course <i>NtQuerySystemInformation</i> with various classes, as well as <i>NtQueryProcessInformation</i> .  Access to the corresponding applications is limited to these functions. <br><br>  In the case of <i>NtQuerySystemInformation, the</i> application with a low Integrity Level will be returned STATUS_ACCESS_DENIED if it requests information on the following classes: <br><br><ul><li>  SystemModuleInformation / SystemModuleInformationEx - addresses of loaded drivers </li><li>  SystemLocksInformation - addresses of kernel objects (ERESOURCE) </li><li>  SystemStackTraceInformation - address of the kernel mode stack </li><li>  SystemHandleInformation / SystemExtendedHandleInformation - addresses of kernel objects </li><li>  SystemObjectInformation - addresses of kernel objects </li><li>  SystemBigPoolInformation / SystemSessionBigPoolInformation - allocated system memory addresses </li><li>  SystemProcessInformation / SystemExtendedProcessinformation / SystemFullProcessInformation - addresses of process kernel objects, streams and their stacks. </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/98f/f8e/1eb/98ff8e1eba07e6f7decb1b514512e423.png"><br>  Fig.  The call points of the Integrity Level check function in the application access token that is trying to access <i>ntoskrnl! NtQuerySystemInformation</i> .  <i>ntoskrnl! ExpQuerySystemInformation</i> is responsible for collecting information for the corresponding classes, and the <i>ntoskrnl! ExIsRestrictedCaller</i> function is executed in it, which performs the check itself. <br><br>  In addition to <i>NtQuerySystemInformation,</i> access is also blocked to the <i>NtQueryInformationProcess</i> function, through which the application can access the addresses of various objects.  For the <i>ProcessHandleTracing</i> , <i>ProcessWorkingSetWatch / ProcessWorkingSetWatchEx</i> classes, the corresponding error status is also returned. <br><br>  <a href="http://www.alex-ionescu.com/%3Fp%3D82">www.alex-ionescu.com/?p=82</a> </div><p>Source: <a href="https://habr.com/ru/post/202548/">https://habr.com/ru/post/202548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../202534/index.html">Problems of transition to middle managers</a></li>
<li><a href="../202536/index.html">Making Hyperboria hotspot. Allowance for picking the router</a></li>
<li><a href="../202538/index.html">Dual Standards for Account Encryption</a></li>
<li><a href="../202540/index.html">Love in pixels or what is Love2d</a></li>
<li><a href="../202544/index.html">KUB-Pico / 220 Socket Controller from Technotronics</a></li>
<li><a href="../202550/index.html">Shopping list</a></li>
<li><a href="../202554/index.html">Dmitry Sklyarov: ‚ÄúAttentiveness and some logic. How complicated is simple. ‚Äù</a></li>
<li><a href="../202556/index.html">JavaScript race (30 lines of code)</a></li>
<li><a href="../202560/index.html">English idioms with names</a></li>
<li><a href="../202562/index.html">Migrating an application from Windows 8 to Windows 8.1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>