<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Everything under control: we protect corporate conversations</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cases for the already familiar GSM / SIP convergence have been repeatedly described in the network and in Habr√© in particular. In this article we want...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Everything under control: we protect corporate conversations</h1><div class="post__text post__text-html js-mediator-article">  Cases for the already familiar GSM / SIP convergence <a href="https://habrahabr.ru/company/tottoli_gsm/blog/266627/">have been repeatedly described</a> in the network and in Habr√© in particular.  In this article we want to tell a little about something else. <br><br>  We in <a href="http://tottoli-gsm.com/ru/">Tottoli GSM</a> had the opportunity to participate in the project, the essence of which was to deploy a local GSM network in the organization‚Äôs territory with access to a public telephone network and integration with the existing PBX. <br><br><img src="https://habrastorage.org/files/c92/d08/9eb/c92d089ebe504b459df4bcd28c0f30df.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  <font color="#0071BC">Project Objective:</font> </h1><br><h2>  Maximum reduction of information leakage risks in the GSM network. </h2><br><a name="habracut"></a><br>  The whole architecture was packed in one OsmoBTS - UmDESK piece of hardware ( <abbr title="Mobile Switching Center - Mobile Switching Center">MSC</abbr> / <abbr title="Home Location Register">HLR</abbr> / <abbr title="Visitors Location Register">VLR</abbr> / <abbr title="Authentification center">AuC</abbr> / <abbr title="SMSC - SMS Center">SMSC</abbr> ).  This project is open and very flexible, it allows you to develop your applications and create your services.  Well and that is important - the price.  The whole software and hardware stack is open source, many articles have been written about it, and there‚Äôs no point in retelling the essence. <br><br>  Our configuration has the following: <br><br><h1>  <font color="#0071BC">Radio interface</font> </h1><br>  The question of the legitimacy of the use of frequencies is decided by the customer, and responsibility lies on his side.  However, in order not to attract attention once again, the radio frequency spectrum was scanned to identify free frequencies and determine the <abbr title="Absolute RF channel number">ARFCN</abbr> channels used. <br><br><img src="https://habrastorage.org/files/eaa/0cb/443/eaa0cb4433604c889cf1cfd6ba9ee009.png" alt="image"><br><br>  Based on the scan results, two free channels were selected. <br><br>  We configured OsmoBTS so that the attenuation behind the walls of the organization was maximum, while the signal level in the controlled area was sufficient. <br><br><h3>  Subscriber part </h3><br>  All employees were given SIM-cards with pre-installed profiles ( <abbr title="International Mobile Subscriber Identity - international mobile subscriber ID (individual subscriber number">IMSI</abbr> / <abbr title="Key Identification - individual user authentication key">KI</abbr> / <abbr title="Mobile Subscriber Integrated Services Digital Number">MSISDN</abbr> ) and specially designed applets.  Authentication triplets were whitelisted in HLR / UmDESK.  The HLR configuration was made in such a way that any SIM cards could be registered in the local network, but only SIM cards from the HLR white list could make calls.  This made it possible to track "guest" telephones at the level of their network, in fact, IMSI-catcher.  On the SIM-card, an image of a local network was created, where the only allowed network was a local network.  This was achieved by recording the network parameters in the <abbr title="Public Land Mobile Network">PLMN area</abbr> , and of course using a special applet.  Thus, the employee, getting into the area of ‚Äã‚Äãthe local network, was transferred to it without the possibility of switching to another network (for example, a similar virtual BTS "active interception complex"). <br><br><h3>  SIP PBX </h3><br>  For interaction OsmoBTS with iron library libusrp is used.  Further, using the oSIP and oRTP libraries, OsmoBTS creates SIP calls, which, in turn, are sent to Asterisk PBX.  On the client side is billing and additional services. <br><br><img src="https://habrastorage.org/files/641/d27/ccd/641d27ccd1c84d1ebadec9c2e178dfb2.jpg" alt="image"><br><br><h4>  Here are some criteria that have been set by the customer: </h4><br>  1. Employees must be mobile and have access to special services at any time. <br>  2. Employees can use their mobile devices they are used to. <br>  3. All services must be accessible regardless of the operating system of the mobile device. <br>  4. All used traffic from mobile devices must be available to the company's Security Service for analysis. <br>  5. All communications within the network should not fall on the equipment of the host operators. <br>  6. It is necessary to minimize the threat of interception of traffic through the air. <br>  7. The guest subscriber cannot use the communication services of the host operator within the company. <br>  8. The guest subscriber has a controlled ability to use communication services only within the local network. <br>  9. Combine offices located in different countries into a single network. <br><br><h4>  As often happens, the appetite comes with eating.  The customer during the operation offered to implement the following tasks: </h4><br>  1. The employee must be able to use the service SIM card outside the local network. <br>  2. An employee must have access to all services outside the local network. <br>  3. In public networks, an employee must change authenticators (IMEI / IMSI). <br>  4. The ability to share sensitive information using instant messages in an encrypted form. <br>  5. The employee‚Äôs mobile device must have mechanisms to detect false BTS outside the local network. <br>  6. The employee‚Äôs mobile device must detect attacks of active interception complexes. <br>  7. All traffic (GSM / SMS / DATA / USSD) should be available to the company's Security Service for analysis outside the local network. <br>  8. All Internet traffic, both inside the local network and outside the local network, must pass through the customer's APN and be analyzed using DPI. <br><br>  If this project is of interest, we will describe each item in more detail with pictures and explanations in the following articles of the <a href="https://tottoli-gsm.com/ru/">Tottoli GSM</a> blog. <br><br><h2>  Read more: </h2><br>  Everything is under control: we protect corporate conversations.  <a href="https://habrahabr.ru/company/tottoli_gsm/blog/306370/">Part 2: Secure Telephone</a> <br>  Everything is under control: we protect corporate conversations.  <a href="https://habrahabr.ru/company/tottoli_gsm/blog/308432//">Part 3: Secure SIM Card</a> </div><p>Source: <a href="https://habr.com/ru/post/305586/">https://habr.com/ru/post/305586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../305576/index.html">Treatment of all js-files on the server or the definition of the encryption method in the day off</a></li>
<li><a href="../305578/index.html">Hello, TensorFlow. Google Machine Learning Library</a></li>
<li><a href="../305580/index.html">Global range of FINTECH accelerators</a></li>
<li><a href="../305582/index.html">9 Russian companies that make interesting content</a></li>
<li><a href="../305584/index.html">UltraVDS has launched a loyalty program for its VDS / VPS servers</a></li>
<li><a href="../305590/index.html">Hidden e-commerce hazards and valid SSL certificates</a></li>
<li><a href="../305594/index.html">Pastilde - open hardware password manager</a></li>
<li><a href="../305596/index.html">iOS 10: new in creating animations</a></li>
<li><a href="../305598/index.html">Citrix and OpenStack History</a></li>
<li><a href="../305600/index.html">Short cheat sheet on locks when reading and changing data depending on the transaction isolation level in MSSQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>