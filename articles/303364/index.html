<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As an sql query, retrieve information from the database that is not there.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Under such a tricky title is quite an easy task, but first a small introduction: 


 Users come and ask: ‚ÄúHere we have entered the data into the datab...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As an sql query, retrieve information from the database that is not there.</h1><div class="post__text post__text-html js-mediator-article"><p>  Under such a tricky title is quite an easy task, but first a small introduction: </p><br><p>  Users come and ask: ‚ÄúHere we have entered the data into the database, but tell us what is missing?  What data we have not yet entered into the database and they are not enough for complete happiness? " <br>  The first (and frankly, very stupid) reaction: ‚ÄúHow can I find you something that is not in the database?‚Äù. </p><br><p>  But let us drop emotions and apply logic.  After all, as a rule, data are required, the formation of which obeys a certain rule - the numbers of receipts, references and so on ... And I assume that all these numbers and identifiers can be converted into natural sequence. <br>  That is, the task will be formulated as follows: a sequence of natural numbers in which there are gaps is stored in the database, and it is necessary to output the missing numbers for the user. <br>  In this formulation, the task already looks pretty simple.  Moreover, there is a desire to implement this task with a single sql query. </p><a name="habracut"></a><br><p>  Let's create a table and fill it with some data. </p><br><pre><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> <span class="hljs-string"><span class="hljs-string">`Test`</span></span> (<span class="hljs-string"><span class="hljs-string">`id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> <span class="hljs-string"><span class="hljs-string">`Test`</span></span> (<span class="hljs-string"><span class="hljs-string">`id`</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">3</span></span>), (<span class="hljs-number"><span class="hljs-number">5</span></span>), (<span class="hljs-number"><span class="hljs-number">7</span></span>), (<span class="hljs-number"><span class="hljs-number">8</span></span>) , (<span class="hljs-number"><span class="hljs-number">9</span></span>) , (<span class="hljs-number"><span class="hljs-number">11</span></span>) , (<span class="hljs-number"><span class="hljs-number">12</span></span>), (<span class="hljs-number"><span class="hljs-number">16</span></span>) , (<span class="hljs-number"><span class="hljs-number">17</span></span>) ;</code> </pre> <br><p>  The basic idea is as follows: compare the table with itself and for each value of the X and find the minimum IGREC (which is still greater than the X), where (X + 1) and (IGREC - 1) are our boundaries for the missing ranges of numbers.  Adding a logical condition that, (X + 1) should be no less (IGREC - 1) we get the following ranges: from 4 to 4, from 6 to 6, from 10 to 10 and from 13 to 15. <br>  What are the nuances: <br>  1) The first element of the sequence can be skipped (in our case it is 1) <br>  2) The last element of the sequence is unknown (what if it is 22).  You can, of course, request this information from the user, but experience suggests that it is better to avoid it. <br>  3) The range "from 4 to 4" looks buggy, you just have to replace it with one number <br>  4) The result is still desirable to obtain the value of a single line, rather than a set of lines </p><br><p>  We take into account the comments and get a version of the script under MySQL: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP_CONCAT</span></span>( ranges ) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> id2 <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONCAT</span></span>( id1, <span class="hljs-string"><span class="hljs-string">'...'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> id1 = id2 <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> id1 <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONCAT</span></span>( id1, <span class="hljs-string"><span class="hljs-string">'-'</span></span>, id2 ) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> ranges <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> +<span class="hljs-number"><span class="hljs-number">1</span></span> id1, ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> ) <span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-string"><span class="hljs-string">`Test`</span></span> t2 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> t2.id &gt; t1.id )id2 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-string"><span class="hljs-string">`Test`</span></span> t1 <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> ) <span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-string"><span class="hljs-string">`Test`</span></span> t3 )t <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> id1 &lt;= id2 <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> id2 <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> id1 )tt</code> </pre> <br><p>  and option under Oracle: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LISTAGG</span></span> (ranges, <span class="hljs-string"><span class="hljs-string">', '</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> id2 <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> TO_CHAR (id1) || <span class="hljs-string"><span class="hljs-string">'...'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> id1 = id2 <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> TO_CHAR (id1) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> TO_CHAR (id1) || <span class="hljs-string"><span class="hljs-string">'-'</span></span> || TO_CHAR (id2) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> ranges <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> id1, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TEST</span></span> t2 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> t2.id &lt; t1.id) id2 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TEST</span></span> t1 <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TEST</span></span> t3) t <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> id1 &lt;= id2 <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> id2 <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> id1 ) tt</code> </pre> <br><p>  The result of their execution is the string <u><strong>'1-2, 4, 6, 10, 13-15, 18 ...'</strong></u> <br>  First, this line contains what the users wanted. <br>  Secondly, the result looks clear to any user. <br>  And most importantly, the query displays data that is not actually stored in the database! </p><br><p>  <strong>UPD1:</strong> </p><br><p>  Many thanks to everyone who suggested options for improving the scripts, and just expressed interest in this issue. <br>  As is often the case, comments turned out to be more interesting and useful than the original article. <br>  Indeed, it was worth noting that nuance number 4 is not implemented by the standard SQL syntax and for this task it is necessary to attract additional functionality implemented on each separate DBMS in its own way. <br>  Below are the scripts that I pulled from comments on the article. </p><br><p>  MySQL option from <a href="https://habrahabr.ru/users/asmm/" class="user_link">asmm</a> </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONCAT</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">IFNULL</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CONCAT</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">GROUP_CONCAT</span></span>(miss_num), <span class="hljs-string"><span class="hljs-string">','</span></span>), <span class="hljs-string"><span class="hljs-string">''</span></span>) , <span class="hljs-keyword"><span class="hljs-keyword">IFNULL</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>, @start_num) , <span class="hljs-string"><span class="hljs-string">'...'</span></span> ) miss_num <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @prev_id prev_id , <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> @prev_id + <span class="hljs-number"><span class="hljs-number">1</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> @prev_id + <span class="hljs-number"><span class="hljs-number">2</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> @prev_id + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONCAT</span></span>(@prev_id + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> miss_num , @prev_id := <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @start_num := <span class="hljs-number"><span class="hljs-number">1</span></span> start_num, @prev_id := @start_num - <span class="hljs-number"><span class="hljs-number">1</span></span> prev_id) p , <span class="hljs-string"><span class="hljs-string">`Test`</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> t.id &gt;= p.start_num <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> t.id ) t</code> </pre> <br><p>  Option for Oracle from <a href="https://habrahabr.ru/users/xtender/" class="user_link">xtender</a> </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">listagg</span></span>(id1||<span class="hljs-keyword"><span class="hljs-keyword">decode</span></span>(id2 ,id1 ,<span class="hljs-literal"><span class="hljs-literal">null</span></span> ,<span class="hljs-literal"><span class="hljs-literal">null</span></span>,<span class="hljs-string"><span class="hljs-string">'...'</span></span> ,<span class="hljs-string"><span class="hljs-string">'-'</span></span>||id2) ,<span class="hljs-string"><span class="hljs-string">','</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">within</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> id1)s <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">max</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)+<span class="hljs-number"><span class="hljs-number">1</span></span> id1 ,<span class="hljs-keyword"><span class="hljs-keyword">lead</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">over</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)) id2 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> rn <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dual <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>,row_number()<span class="hljs-keyword"><span class="hljs-keyword">over</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) rn <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">test</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> - rn)</code> </pre> <br><p>  Option for MSSQL from <a href="https://habrahabr.ru/users/yizraor/" class="user_link">yizraor</a> </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> rlist = ( <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-string"><span class="hljs-string">"text()"</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">iif</span></span>(id1 &lt; id2, <span class="hljs-keyword"><span class="hljs-keyword">convert</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>), id1) + <span class="hljs-keyword"><span class="hljs-keyword">iif</span></span>(id1 &lt; (id2 - <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-string"><span class="hljs-string">'-'</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">convert</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>), id2 - <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-string"><span class="hljs-string">''</span></span>), <span class="hljs-string"><span class="hljs-string">''</span></span>) + <span class="hljs-keyword"><span class="hljs-keyword">iif</span></span>(id3 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">iif</span></span>(id1 &lt; id2, <span class="hljs-string"><span class="hljs-string">', '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) + <span class="hljs-keyword"><span class="hljs-keyword">convert</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>), id2 + <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-string"><span class="hljs-string">'...'</span></span>, <span class="hljs-string"><span class="hljs-string">', '</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> id1 = <span class="hljs-keyword"><span class="hljs-keyword">isnull</span></span>(lag(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>, id2 = <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>, id3 = <span class="hljs-keyword"><span class="hljs-keyword">lead</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">test</span></span> ) t <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> ( id1 &lt; id2 ) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> ( id3 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> id2 <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xml</span></span> <span class="hljs-keyword"><span class="hljs-keyword">path</span></span>(<span class="hljs-string"><span class="hljs-string">''</span></span>) )</code> </pre> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/303364/">https://habr.com/ru/post/303364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../303352/index.html">Proper use of require in node.js</a></li>
<li><a href="../303354/index.html">Music as a startup, or why iTunes is evil</a></li>
<li><a href="../303358/index.html">Russia's place in the global digital transformation</a></li>
<li><a href="../303360/index.html">We work with a budget institution. Part 1</a></li>
<li><a href="../303362/index.html">Why do those who work a little have higher productivity?</a></li>
<li><a href="../303366/index.html">REST API on Symfony, FOSRestBundle + GlavwebDatagridBundle</a></li>
<li><a href="../303368/index.html">We write a serializer for a network game in C ++ 11</a></li>
<li><a href="../303370/index.html">Tony Robbins seminar review ‚ÄúFree your inner strength‚Äù. Day 4. The power of clean energy (part 2)</a></li>
<li><a href="../303372/index.html">Connect MATLAB to Wolfram Mathematica</a></li>
<li><a href="../303374/index.html">2-3-tree. Naive implementation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>