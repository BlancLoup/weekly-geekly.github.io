<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing BIND9 DNS on CentOS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For all the time, I did not encounter installing DNS on the server, but here I had to install Slave DNS on the new client server. I think that the pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing BIND9 DNS on CentOS</h1><div class="post__text post__text-html js-mediator-article">  For all the time, I did not encounter installing DNS on the server, but here I had to install Slave DNS on the new client server.  I think that the procedure will be useful, as admins and web-developers. <br><a name="habracut"></a><br><h1>  Master DNS installation </h1><br>  Go to the server (for example, Master DNS will be placed on a server with IP 10.10.10.10, Slave DNS - IP 20.20.20.20) <br>  In the beginning check that the system has all the latest updates. <br><br><pre><code class="bash hljs">yum update -y</code> </pre> <br>  If you do not specify the "-y" key, you will have to answer all the questions of the installer, and with it all the answers are automatically set by default. <br><br>  Install bind and bind-utils. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs">yum install <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span>-utils -y</code> </pre><br>  Using the example of my domain ‚Äúsibway.pro‚Äù, for your own, change all the occurrences in the examples.  We will assume that master has IP 10.10.10.10, slave 20.20.20.20.  Master and slave, as far as I understand, the division is conditional, since both of them will perform the same functions, the only difference is that the slave takes all the data from the master. <br><br>  Now we will edit the configuration file with any text editor, I use vi as it is always on any system. <br><br><pre> <code class="bash hljs">vi /etc/named.conf</code> </pre><br>  When installing bind, the configuration file is set automatically and we only need to edit it. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">options</span></span> { #<span class="hljs-keyword"><span class="hljs-keyword">listen</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">on</span></span> port <span class="hljs-number"><span class="hljs-number">53</span></span> { <span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">listen</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">on</span></span>-v6 port <span class="hljs-number"><span class="hljs-number">53</span></span> { ::<span class="hljs-number"><span class="hljs-number">1</span></span>; }; directory "/var/named"; dump-file "/var/named/data/cache_dump.db"; <span class="hljs-keyword"><span class="hljs-keyword">statistics</span></span>-file "/var/named/data/named_stats.txt"; memstatistics-file "/var/named/data/named_mem_stats.txt"; allow-query { <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>; }; allow-transfer { localhost; <span class="hljs-number"><span class="hljs-number">20.20</span></span><span class="hljs-number"><span class="hljs-number">.20</span></span><span class="hljs-number"><span class="hljs-number">.20</span></span>; }; recursion <span class="hljs-keyword"><span class="hljs-keyword">no</span></span>; dnssec-<span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> yes; dnssec-validation yes; dnssec-lookaside auto; <span class="hljs-comment"><span class="hljs-comment">/* Path to ISC DLV key */</span></span> bindkeys-file "/etc/named.iscdlv.key"; managed-keys-directory "/var/named/dynamic"; };</code> </pre><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta">#listen-on port 53 { 127.0.0.1; };</span></span></code> </pre><br>  We comment on the line so that the server can listen to the broadcast from all addresses and ports (you can probably just specify IP 10.10.10.10, but did not experiment with the hands. From the outside, it still closes the firewall). <br><br><pre> <code class="hljs pgsql">allow-query { <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>; };</code> </pre><br>  We allow you to request a server from any address. <br><br><pre> <code class="hljs apache"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">allow</span></span></span></span>-transfer { localhost; 20.20.20.20; };</code> </pre><br>  We allow to take information about domains to slave servers. <br>  Add a domain zone, in the same configuration file is prescribed. <br><br><pre> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">zone</span></span> "sibway.pro" <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> master; file "sibway.pro.zone"; allow-<span class="hljs-keyword"><span class="hljs-keyword">update</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">none</span></span>; }; };</code> </pre><br><h2>  Configuring domain zones </h2><br>  In the configuration file, we specified the sibway.pro.zone file as the configuration file for the domain of the sibway.pro zone. <br>  The easiest way is to take any existing and edit to the desired configuration.  Files can be placed in a subdirectory. <br><br><pre> <code class="bash hljs">vi /var/named/sibway.pro.zone</code> </pre><br>  Here is a simple example of what needs to be registered in the domain zone. <br><br><pre> <code class="hljs dos">$TTL <span class="hljs-number"><span class="hljs-number">86400</span></span> @ <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> SOA ns1.sibway.pro. root.sibway.pro. ( <span class="hljs-number"><span class="hljs-number">2014120801</span></span> ;Serial  <span class="hljs-variable"><span class="hljs-variable">!!!</span></span>          ,  slave     <span class="hljs-number"><span class="hljs-number">3600</span></span> ;Refresh <span class="hljs-number"><span class="hljs-number">1800</span></span> ;Retry <span class="hljs-number"><span class="hljs-number">604800</span></span> ;Expire <span class="hljs-number"><span class="hljs-number">86400</span></span> ;Minimum TTL ) ;   name  <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS ns1.sibway.pro. <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS ns2.sibway.pro. ;  IP  name  ns1 <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A <span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">10</span></span> ns2 <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A <span class="hljs-number"><span class="hljs-number">20</span></span>.<span class="hljs-number"><span class="hljs-number">20</span></span>.<span class="hljs-number"><span class="hljs-number">20</span></span>.<span class="hljs-number"><span class="hljs-number">20</span></span> ; Define hostname -&gt; IP      @ <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A <span class="hljs-number"><span class="hljs-number">213</span></span>.<span class="hljs-number"><span class="hljs-number">133</span></span>.<span class="hljs-number"><span class="hljs-number">100</span></span>.<span class="hljs-number"><span class="hljs-number">77</span></span> www <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A <span class="hljs-number"><span class="hljs-number">213</span></span>.<span class="hljs-number"><span class="hljs-number">133</span></span>.<span class="hljs-number"><span class="hljs-number">100</span></span>.<span class="hljs-number"><span class="hljs-number">77</span></span></code> </pre><br>  We make server name restar <br><br><pre> <code class="bash hljs">service named restart</code> </pre><br>  Determine that the server name starts when the system boots. <br><br><pre> <code class="bash hljs">chkconfig named on</code> </pre><br>  Now let's check how our name server works. <br><br><pre> <code class="bash hljs">dig @10.10.10.10 sibway.pro</code> </pre><br>  The response must indicate the correct IP of the requested domain.  Now configure the slave server. <br><br><h2>  Server slave configuration </h2><br>  Configuring the server's slave name is the same as master except for two things: <br><br><ol><li>  When editing the configuration file named.conf, you need to specify which domain zones slave </li><li>  Do not add domain zones, as they are automatically updated from the master server </li></ol><br>  In the configuration file, you must specify the type slave and specify the IP master server. <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">zone</span></span> "sibway.pro" <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> slave; masters { <span class="hljs-number"><span class="hljs-number">10.10</span></span><span class="hljs-number"><span class="hljs-number">.10</span></span><span class="hljs-number"><span class="hljs-number">.10</span></span>; }; file "sibway.pro.zone"; };</code> </pre><br>  Do not forget to start the server and enable it to start automatically at system startup. <br><br><pre> <code class="bash hljs">service named start chkconfig named on</code> </pre><br>  Now we have two configured name servers. <br>  It remains to open the port in the firewall <br>  Edit the / etc / sysconfig / iptables file: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># vi /etc/sysconfig/iptables</span></span></code> </pre><br>  Add the following rules for port 53. <br><br><pre> <code class="hljs perl">-A INPUT -p udp -<span class="hljs-keyword"><span class="hljs-keyword">m</span></span> udp --dport <span class="hljs-number"><span class="hljs-number">53</span></span> -j ACCEPT -A INPUT -<span class="hljs-keyword"><span class="hljs-keyword">m</span></span> <span class="hljs-keyword"><span class="hljs-keyword">state</span></span> --<span class="hljs-keyword"><span class="hljs-keyword">state</span></span> NEW -<span class="hljs-keyword"><span class="hljs-keyword">m</span></span> tcp -p tcp --dport <span class="hljs-number"><span class="hljs-number">53</span></span> -j ACCEPT -A INPUT -<span class="hljs-keyword"><span class="hljs-keyword">m</span></span> <span class="hljs-keyword"><span class="hljs-keyword">state</span></span> --<span class="hljs-keyword"><span class="hljs-keyword">state</span></span> NEW -<span class="hljs-keyword"><span class="hljs-keyword">m</span></span> udp -p udp --dport <span class="hljs-number"><span class="hljs-number">53</span></span> -j ACCEPT</code> </pre><br>  Update iptable <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># /etc/init.d/iptables restart</span></span></code> </pre><br>  Do not forget to update this file on both servers. <br>  Now we have two working server names. </div><p>Source: <a href="https://habr.com/ru/post/245857/">https://habr.com/ru/post/245857/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245845/index.html">Overview of App Annie features for Windows and Windows Phone developers</a></li>
<li><a href="../245847/index.html">Replication slots in PostgreSQL</a></li>
<li><a href="../245849/index.html">Dagaz: Again about XSLT</a></li>
<li><a href="../245851/index.html">MyLifeOrganized: folders vs contexts</a></li>
<li><a href="../245853/index.html">Business is not childish - Or how did an eighth-grader deliver fruit?</a></li>
<li><a href="../245859/index.html">IOMeter2 v1.1.0</a></li>
<li><a href="../245861/index.html">We simulate the prestress of the concrete shell of the nuclear power plant</a></li>
<li><a href="../245863/index.html">New office Synesis: how we created the space for the birth of ideas</a></li>
<li><a href="../245867/index.html">Textolite 1.04: you can create templates and edit scripts</a></li>
<li><a href="../245869/index.html">The course from Yandex about what every developer who wants to make large systems should know. Buzz word DevOps and more</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>