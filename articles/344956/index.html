<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>For those who were afraid, but still ready to try. (Excel)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Often, when people talk about working in office applications, it is intended to use a PC as a typewriter and, frankly, this is a rather expensive subs...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>For those who were afraid, but still ready to try. (Excel)</h1><div class="post__text post__text-html js-mediator-article">  Often, when people talk about working in office applications, it is intended to use a PC as a <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B8%25D1%2588%25D1%2583%25D1%2589%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25B0%25D1%2588%25D0%25B8%25D0%25BD%25D0%25BA%25D0%25B0">typewriter</a> and, frankly, this is a rather expensive substitute for physical mechanisms, if not using the capabilities that the PC gives us.  Let's talk about it. <br><img src="https://habrastorage.org/webt/nx/ps/wa/nxpswa_or2hzpxyq5-ty6ub-mka.png" alt="image"><br><a name="habracut"></a><br><h2>  Introduction </h2><br>  In my opinion, the PC appeared as a tool for solving the principle of automating routine processes, and in this he is damn good.  In addition, the development of functional programs has a history of creating tools for the implementation of the translation of emergency tasks into routine actions, as a consequence of the deepening division of labor.  However, there are areas, including  and workflow, where today the PC is used exactly as a typewriter including.  and because serious development was not conducted due to the fact that the salaries of people are sitting in overhead costs and, as a result, are not large, which cannot be said about the increasing volumes of workflow. <br><br>  So, let's talk about construction, specifically about the preparation of as-built <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D1%2581%25D0%25BF%25D0%25BE%25D0%25BB%25D0%25BD%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B4%25D0%25BE%25D0%25BA%25D1%2583%25D0%25BC%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">documentation</a> (hereinafter ID). <br><br><div class="spoiler">  <b class="spoiler_title">on as-built documentation</b> <div class="spoiler_text">  More precisely about its textual component.  In short, the ID is a set of acts, journals and other documents, drawings, diagrams that are compiled at each stage and even an operation (group of operations) in construction, to confirm / reject the work performed by the project.  Such documents are completely template, their list, depending on the type of work, is regulated, and they are maintained according to the actual work schedule, formalizing the project‚Äôs correctness / retreat of the work approved by the commission. </div></div><br>  Most of the work is closed in the form <a href="http://www.consultant.ru/law/podborki/akt_osvidetelstvovaniya_skrytyh_rabot/">of the Inspection Certificate for Hidden Works</a> (approved by order of the Federal Service for Environmental, Technological and Nuclear Supervision dated December 26, 2006 N 1128 (As amended, effective March 6, 2016, Order No. 42 of Rostechnadzor) Further AOSR). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Baseline data for automation. </h2><br>  Therefore, we take the form AOSR as a basis.  So, we have a document template in which the following information is entered: <br><br>  - postfix number of the act; <br>  - name of the capital construction object; <br>  - legal data on construction participants (Developer or Customer; Construction Person; Person who prepares project documentation; <br>  The person carrying out the construction, completed the work to be surveyed;  other faces.) <br>  - a list of persons with the name of organizations, positions and orders confirming their authority; <br>  - name of work performed; <br>  - turnaround time; <br>  - list of works included in the work performed; <br>  - references to reference documents and sections of the project / technical documentation; <br>  - references to executive schemes, test reports (if required); <br>  - list of materials used with references to documents confirming their compliance (passports, certificates, etc.) <br><br><h2>  Thoughts on the fundamental methods of solving the problem </h2><br>  So, in the first approximation, you can simply create a visual table in which by assigning the corresponding fields of the same type to each act, we will get a descriptive shingles on the scheme of work on the object.  And this is nothing new.  So, we need to associate the form with cells in the data tables, and here there are 2 options: <br><br>  1. Merge with Word file <br>  2. Filling using Excel-based template macros. <br><br>  Each of these methods has its pros and cons, but since  the merge makes a replacement in real time, then I decided to choose the second item, which does not provide a real time merge and it will be necessary to deduce acts every time, in case of data correction, again.  This is due to the fact that I often need a history of my actions. <br><br>  So, now we run into 2 tasks: <br><br>  1. Filling the template based on tabular data <br>  2. Which fields are sufficient to enter once, which will change from time to time and which fields will differ in each act. <br><br>  Solving the problem number 2, we will put on a separate sheet the data that will be the same within the object / section of the construction project - this is: <br><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  - name of the capital construction object; <br>  - legal data on construction participants (Developer or Customer; Construction Person; Person who prepares project documentation; <br>  The person carrying out the construction, completed the work to be surveyed;  other faces.) <br>  - a list of persons with the name of organizations, positions and orders confirming their authority; <br></div></div><br>  On the current sheet, fill in only once, and for the rest of the acts we just put down references to these values: <br><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  - references to reference documents and sections of the project / technical documentation; <br>  - Postfix to the act number; <br></div></div><br>  And the fields that will change in each act: <br><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  - name of work performed; <br>  - turnaround time; <br>  - list of works included in the work performed; <br>  - references to executive schemes, test reports (if required); <br>  - list of materials used with references to documents confirming their compliance (passports, certificates, etc.) <br></div></div><br>  Now about convenience, if you write down the names of the responsible persons, their organization, the order of appointment with the date, then using the ‚Äúdata check‚Äù tool you can put their names in the <a href="https://support.office.com/ru-ru/article/%25D0%259F%25D1%2580%25D0%25B8%25D0%25BC%25D0%25B5%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5-%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B5%25D1%2580%25D0%25BA%25D0%25B8-%25D0%25B4%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D1%2585-%25D0%25BA-%25D1%258F%25D1%2587%25D0%25B5%25D0%25B9%25D0%25BA%25D0%25B0%25D0%25BC-29fecbcc-d1b9-42c1-9d76-eff3ce5f7249">spoiler</a> , and pull up their regalia with a formula. <br><br><pre><code class="hljs perl">=(((<span class="hljs-string"><span class="hljs-string">"'  '!"</span></span>;(((E3<span class="hljs-number"><span class="hljs-number">0</span></span>;<span class="hljs-string"><span class="hljs-string">'  '</span></span>!$G$15:$G$34;<span class="hljs-number"><span class="hljs-number">0</span></span>))+<span class="hljs-number"><span class="hljs-number">14</span></span>;<span class="hljs-number"><span class="hljs-number">6</span></span>)));<span class="hljs-string"><span class="hljs-string">"-"</span></span>)</code> </pre> <br>  Those.  on the 'Data for the project' sheet in the $ G $ 15 range: $ G $ 34, in the 6th column we look for the value in cell E30, and as soon as we find it using the simple method we will convert it into an address that will be converted into a link by formulas. <br><br>  The new problem already rests on the length of the line, if you use the Times New Roman font number 10, the length of the text to be printed does not exceed 105 characters.  Those.  we resist the need to create a crutch for transfers.  So the function code on VBA: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> PatrOfString(StringOfTable As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, Nnumber As Byte) As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>) As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer <span class="hljs-comment"><span class="hljs-comment">' Dim j As Integer ' Dim k As Integer ' Dim p As Integer ' For i = 1 To 10 Let (i) = " " Next i Let k = 1 Let p = Len(StringOfTable) Let p1 = Len(StringOfTable) For i = 1 To Round(Len(StringOfTable) / 105) + 1 Step 1 If p &gt; 0 And p &lt; 105 Then If k &lt;= p1 Then Let (i) = Mid$(StringOfTable, k, p) Else If Mid(StringOfTable, k, 1) = " " Then If k &lt;= p1 Then Let (i) = Mid$(StringOfTable, k, 105) Let p = p - 105 k = k + 105 Else j = 105 * i If j - k &gt;= 105 Then j = k + 105 End If Do j = j - 1 Loop While Mid$(StringOfTable, j, 1) &lt;&gt; " " Let (i) = Mid$(StringOfTable, k, j - k + 1) Let p = p - (j - k + 1) Let k = j + 1 End If End If Next i If Nnumber - 1 &gt; 0 Then If (Nnumber) = (Nnumber - 1) Then (Nnumber) = " " End If PatrOfString = (Nnumber)</span></span></code> </pre> <br>  Those.  we first take away the text, then cut out 105 characters, look for the first character from the end of the space, as we find it, then we drop the text from the first character into the first line of the array, by the number of the space found.  Then we continue the operation until the text ends or the output array is clogged.  At this stage, it is limited to 10 lines of memory.  Then we derive from the link the contents of the desired line from 1-10.  From the minuses of the solution, memory is clogged up, and for each new request a recount is performed again.  But the crutch works. <br><br>  Now output to the standard AOSP template.  There are again 2 options, either manually assigning a column mapping (/ rows in the case of horizontally positioned data for each act), this will be long and resource-intensive to adjust each new template or changes to the data tables.  Therefore we do optimization.  The data for each one act will be placed vertically, and the comparison of the controlling combination of characters (in Latin, because the acts themselves are entirely in Cyrillic) will be lines with information in these acts, so in a double nested loop, we will compare the necessary text in the text of control characters value from column. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> wb.Worksheets(<span class="hljs-string"><span class="hljs-string">"   "</span></span>).Copy after:=Worksheets(Worksheets.Count) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>  = wb.Worksheets(Worksheets.Count) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> x = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Step</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">'     "   " For y = 1 To 71 Step 1 '     "   " If Sheets(.Name).Cells(y, 20) = 1 Then Let k = CStr(Sheets(.Name).Cells(y, x)) '      -  If k &lt;&gt; "" Then For i = 1 To __ Step 1 Let k = Replace(k, arr(i), Worksheets("    (2)").Cells(i, )) Next i .Cells(y, x) = k End If End If Next y Next x '        ,   . '     Cells(3, 2),  3 -   , 2 -    '     ,     R1C1 ' ( -&gt;  -&gt;  -&gt;    "  R1C1") '      Cells(1, "A"),  1 -   , "" -     Rem -=            =- Let  =  + CStr(Worksheets("    (2)").Cells("1", )) + "-" Let  =  + CStr(Worksheets("    (2)").Cells("2", )) + ".xlsx"  = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, ) Application.DisplayAlerts = False '    Sheets(.Name).Copy '       ActiveWorkbook.SaveAs Filename:=, _ FileFormat:=51 ActiveWindow.Close Sheets(.Name).Delete '    Application.DisplayAlerts = True '     Let  =  + 1 Loop While  &lt;=  End Sub</span></span></code> </pre> <br>  Well, the last point at this stage - we run into system performance and with a large number of acts, their output will take hours.  In order to speed up the process, I use the following option: I copy the contents of a sheet with data into a new sheet with a macro, it gets a numeral (2) in its name, then another macro is launched, which accelerates Excel, but disables some functionality: <br><br><pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">' Excel    "" Public Sub AccelerateExcel() '       Application.ScreenUpdating = False '     Application.Calculation = xlCalculationManual '  Application.EnableEvents = False '    If Workbooks.Count Then ActiveWorkbook.ActiveSheet.DisplayPageBreaks = False End If '   Application.DisplayStatusBar = False '  Excel Application.DisplayAlerts = False End Sub</span></span></code> </pre> <br>  And after outputting all the data from the forms, I run a similar macro where I assign the value true to the same variables and delete the duplicate sheet so that it does not interfere. </div><p>Source: <a href="https://habr.com/ru/post/344956/">https://habr.com/ru/post/344956/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344944/index.html">Aliexpress brain</a></li>
<li><a href="../344946/index.html">Check Point Video & Webinars</a></li>
<li><a href="../344950/index.html">Does Ketchapp clone games?</a></li>
<li><a href="../344952/index.html">Winter internship for mobile developers at Redmadrobot</a></li>
<li><a href="../344954/index.html">Time is money. As we taught Yandeks.Taksi accurately calculate the cost of the trip</a></li>
<li><a href="../344960/index.html">Phone number without a passport</a></li>
<li><a href="../344962/index.html">Git bottom to top</a></li>
<li><a href="../344964/index.html">FAQ on integration with ESIA</a></li>
<li><a href="../344966/index.html">HyperRAM: Using a HyperBus Memory Interface Chip</a></li>
<li><a href="../344968/index.html">Translation - Maximum Usage APK Analyzer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>