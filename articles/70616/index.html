<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating an installer using WiX. Part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This time we will create something more complicated than the installation package from the first article . Learn how to change installation steps and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating an installer using WiX. Part 3</h1><div class="post__text post__text-html js-mediator-article">  This time we will create something more complicated than the installation package from the <a href="http://habrahabr.ru/blogs/development/68616/">first article</a> .  Learn how to change installation steps and create your own installer dialogs. <br><br><a name="habracut"></a><br>  Our new installer will include the following steps: <br><br>  <b>1. Greetings</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>2. Choosing an installation method</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c4d/155/0f8/c4d1550f885d5678d508159588271619.gif"><br><br>  <b>3. Selection of components for installation</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/801/e1f/799/801e1f79925106e052f601dae760ba78.gif"><br><br>  <b>4. Creating shortcuts</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba2/211/057/ba221105720b948e7deec6d43b91daa4.gif"><br><br>  <b>5. Everything is ready for installation</b> <br>  <b>6. Installation process</b> <br>  <b>7. Final dialogue</b> <br><br>  Two programs will be installed: Notepad and Calculator. <br><br>  The installer will offer three types of installation: <b>Normal</b> , <b>Custom</b> , <b>Complete</b> .  Let's set a condition: if the user chose a normal installation, the Calculator should not be installed, with a full one, both a notepad and a calculator should be installed, with a selective option that the user chose. <br><br>  To begin with, we will create a new project and immediately add to it support for the Russian language and a link to <b>WixUIExtension</b> . <br><br>  <i>In the <a href="http://habrahabr.ru/blogs/development/68616/">last article</a> I indicated the need to include the file <b>WixUI_ru-ru.wxl</b> in the project, in fact there is no such need, since</i>  <i>The file with Russian localization is already included in the current version of WiX.</i>  <i>I did not watch, I confess.</i> <i><br></i> <br>  This time we will use the <b>WixUI_Mondo</b> set as a set of dialog boxes.  Add a link to this set at the end of the <b>Product.wxs</b> file in the <font color="#0000ff">&lt;</font> <font color="#800000">Product</font> <font color="#0000ff">&gt;</font> section. <br><blockquote><code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Property</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WIXUI_INSTALLDIR"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">Property</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">UIRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WixUI_Mondo"</font> <font color="#0000ff">/&gt;</font></font></code> <br> </blockquote><br>  Next, we divide our project into several files.  We put the description <font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> in a separate file <b>Features.wxs</b> .  We will also create separate files for the description of the installed <b>Files.wxs</b> files, shortcuts <b>Shortcuts.wxs</b> being created, and we will move the variables to the <b>Variables.wxi</b> file as described in the <a href="http://habrahabr.ru/blogs/development/69129/">second article</a> . <br><br>  Now add the files to install: notepad and calculator.  A notepad will be a mandatory element, a calculator is optional and will be part of the notepad component as shown in the screenshot. <b>Selecting components to be installed.</b> <br><br>  Add the following code to the <b>Files.wxs</b> file: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">DirectoryRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#ff0000">FileSource</font> <font color="#0000ff">="C:\WINDOWS\system32\"</font> <font color="#ff0000">DiskId</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ComponentNotepad"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="{7A8E49AD-DDE6-4f82-BC1D-389E2AF2B1CB}"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">File</font> <font color="#ff0000">Id</font> <font color="#0000ff">='Notepad'</font> <font color="#ff0000">Name</font> <font color="#0000ff">='notepad.exe'</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ComponentCalc"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="{0564AAFC-0AC9-4b0b-8ED9-452147CCEFFA}"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">File</font> <font color="#ff0000">Id</font> <font color="#0000ff">='Calc'</font> <font color="#ff0000">Name</font> <font color="#0000ff">='calc.exe'</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DirectoryRef</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> </blockquote><br>  We have created a description of two different components so that these components can be included in different options ( <font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> ) of the installation.  Add installation options, for this, add the code to the <b>Features.wxs</b> file: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#ff0000">Id</font> <font color="#0000ff">="FeatureNotepad"</font> <font color="#ff0000">Title</font> <font color="#0000ff">=""</font> <font color="#ff0000">Description</font> <font color="#0000ff">=" "</font> <font color="#ff0000">Level</font> <font color="#0000ff">="1"</font> <font color="#ff0000">ConfigurableDirectory</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ComponentNotepad"</font> <font color="#0000ff">/&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#ff0000">Id</font> <font color="#0000ff">="FeatureCalc"</font> <font color="#ff0000">Title</font> <font color="#0000ff">=""</font> <font color="#ff0000">Description</font> <font color="#0000ff">=" "</font> <font color="#ff0000">Level</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ComponentCalc"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> </blockquote><br>  As you can see, the installation option for FeatureCalc is included with FeatureNotepad, i.e.  is dependent and, accordingly, is displayed as a child element in the component selection window for installation. <br>  In the parameters of the <font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> key, we see such parameters as <font color="#ff0000">Title</font> and <font color="#ff0000">Description</font> .  These parameters are responsible for the name of the component in the component selection tree for installation and its description, which is displayed on the right side of the window when a component is selected.  Another interesting point is the <font color="#ff0000">ConfigurableDirectory</font> parameter - it sets the directory identifier, the path of which will change when you click the <b>Browse</b> button.  In this case, this is the INSTALLLOCATION directory, i.e.  the one in which our product will be installed.  If you do not specify the value of the <font color="#ff0000">ConfigurableDirectory</font> parameter, the user will not be able to change the installation path. <br><br>  Add a link to the installation options in the <b>Product.wxs</b> file: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">FeatureRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="FeatureNotepad"</font> <font color="#0000ff">/&gt;</font></font></code> <br> </blockquote><br>  It remains to add shortcuts to the Start menu and you can build the first version of the package.  To add shortcuts to the <b>Shortcuts.wxs</b> file, insert the code: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">DirectoryRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ApplicationProgramsFolder"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutNotepad"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="{29EB41BB-FCFA-4f71-B31A-9B265DA5C05D}"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Shortcut</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutNotepad"</font> <br> <font color="#ff0000">Name</font> <font color="#0000ff">=""</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="$(var.ProductName)"</font> <br> <font color="#ff0000">Target</font> <font color="#0000ff">="[INSTALLLOCATION]Notepad.exe"</font> <br> <font color="#ff0000">WorkingDirectory</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RemoveFolder</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ApplicationProgramsFolder"</font> <font color="#ff0000">On</font> <font color="#0000ff">="uninstall"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RegistryValue</font> <font color="#ff0000">Root</font> <font color="#0000ff">="HKCU"</font> <br> <font color="#ff0000">Key</font> <font color="#0000ff">="Software\$(var.Manufacturer)\$(var.ProductName)"</font> <br> <font color="#ff0000">Name</font> <font color="#0000ff">="installed"</font> <br> <font color="#ff0000">Type</font> <font color="#0000ff">="integer"</font> <br> <font color="#ff0000">Value</font> <font color="#0000ff">="1"</font> <br> <font color="#ff0000">KeyPath</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutCalc"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="{C050C54C-F1E9-4fb8-9179-666305ADF489}"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Shortcut</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutCalc"</font> <br> <font color="#ff0000">Name</font> <font color="#0000ff">=""</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="$(var.ProductName)"</font> <br> <font color="#ff0000">Target</font> <font color="#0000ff">="[INSTALLLOCATION]Calc.exe"</font> <br> <font color="#ff0000">WorkingDirectory</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RegistryValue</font> <font color="#ff0000">Root</font> <font color="#0000ff">="HKCU"</font> <br> <font color="#ff0000">Key</font> <font color="#0000ff">="Software\$(var.Manufacturer)\$(var.ProductName)"</font> <br> <font color="#ff0000">Name</font> <font color="#0000ff">="installed"</font> <br> <font color="#ff0000">Type</font> <font color="#0000ff">="integer"</font> <br> <font color="#ff0000">Value</font> <font color="#0000ff">="1"</font> <br> <font color="#ff0000">KeyPath</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DirectoryRef</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> </blockquote><br>  Description of labels added, now you need to add shortcuts to the appropriate installation options: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#ff0000">Id</font> <font color="#0000ff">="FeatureNotepad"</font> <font color="#ff0000">Title</font> <font color="#0000ff">=""</font> <font color="#ff0000">Description</font> <font color="#0000ff">=" "</font> <font color="#ff0000">Level</font> <font color="#0000ff">="1"</font> <font color="#ff0000">ConfigurableDirectory</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ComponentNotepad"</font> <font color="#0000ff">/&gt;</font> <br> <b><font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutNotepad"</font> <font color="#0000ff">/&gt;</font></b> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#ff0000">Id</font> <font color="#0000ff">="FeatureCalc"</font> <font color="#ff0000">Title</font> <font color="#0000ff">=""</font> <font color="#ff0000">Description</font> <font color="#0000ff">=" "</font> <font color="#ff0000">Level</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ComponentCalc"</font> <font color="#0000ff">/&gt;</font> <br> <b><font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutCalc"</font> <font color="#0000ff">/&gt;</font></b> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> </blockquote><br>  Let's try to collect our project and look at what happened.  Options are selected, files are set, but this is not similar to what we planned at the very beginning.  There is a license agreement window, which we decided to remove and there is no window for creating shortcuts. <br><br>  Let's start making changes to the display order of the installation installation windows.  To do this, you must either create your own set of dealer windows, or take it as a basis and make your own changes.  To save time, download the archive with the <a href="">WiX</a> sources, unpack it, find the <b>WiXUI_Mondo.wxs</b> file (src \ ext \ UIExtension \ wixlib), rename it to <b>WiXUI_Wizard.wxs</b> .  Next, open this file to find the line: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">UI</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WixUI_Mondo"</font> <font color="#0000ff">&gt;</font></font></code> </blockquote>  and change to <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">UI</font> <font color="#ff0000">Id</font> <font color="#0000ff">WixUI_Wizard</font> <font color="#0000ff">&gt;</font></font></code> <br> </blockquote><br>  Made to ensure that during assembly we did not receive the error " <i>Duplicate symbol 'WixUI: WixUI_Mondo' found.</i> " Because  element with the identifier <font color="#0000ff">WixUI_Mondo</font> already exists in the <b>WixUIExtension</b> library the link to which we added to our project. <br><br>  We include this file in our project.  Change the link: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">UIRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WixUI_Mondo"</font> <font color="#0000ff">/&gt;</font></font></code> <br> </blockquote>  on <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">UIRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WixUI_Wizard"</font> <font color="#0000ff">/&gt;</font></font></code> <br> </blockquote><br>  Remove the license agreement from the package. To do this, remove the <b>following</b> lines from the <b>WixUI_Wizard.wxs</b> file: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="LicenseAgreementDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Back"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="WelcomeDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="LicenseAgreementDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Next"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="SetupTypeDlg"</font> <font color="#ff0000">Order</font> <font color="#0000ff">="2"</font> <font color="#0000ff">&gt;</font> LicenseAccepted = "1" <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font></font></code> <br> </blockquote><br>  These lines defined actions when clicking the Next and Back buttons in the license agreement dialog. <br><br>  Change the line: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="WelcomeDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Next"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="LicenseAgreementDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font></font></code> <br> </blockquote>  on <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="WelcomeDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Next"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="SetupTypeDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br>  This line set the action when you click the Next button in the welcome window.  We changed the action and assigned the display of the installation type selection window (SetupTypeDlg) when clicking the Next button. <br><br>  Row: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="SetupTypeDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Back"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="LicenseAgreementDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font></font></code> <br> </blockquote>  change to <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="SetupTypeDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Back"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="WelcomeDlg"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="LicenseAgreementDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font></font></code> <br> </blockquote><br>  This line set the action when you click the Back button in the installation type selection window.  We changed the action and set a return to the welcome window by pressing the Back button. <br><br>  All we did was remove the mention of the window with the license agreement and "jumped" through it, overriding the reaction of the Back and Next buttons.  The lines defining the reaction of the Back and Next buttons in the license agreement window could not be removed by redefining the actions of the Next and Back buttons in the welcome dialogs and choosing the installation method, we have already excluded the license dialog from the installation process. <br><br>  If we now assemble and run the installation package, we will see the same as before, but already without the license agreement window. <br><br>  Create your own shortcut creation dialog box.  Add a new <b>WixUI_Shortcuts.wxs</b> file to the <b>project</b> in which we define the appearance of the new dialog box: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Wix</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/wix/2006/wi"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Fragment</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">UI</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Dialog</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutsDlg"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="370"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="270"</font> <font color="#ff0000">Title</font> <font color="#0000ff">="!(loc.WelcomeDlg_Title)"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Control</font> <font color="#ff0000">Id</font> <font color="#0000ff">="Next"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="PushButton"</font> <font color="#ff0000">X</font> <font color="#0000ff">="248"</font> <font color="#ff0000">Y</font> <font color="#0000ff">="243"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="56"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="17"</font> <font color="#ff0000">Default</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">Text</font> <font color="#0000ff">="!(loc.WixUINext)"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Control</font> <font color="#ff0000">Id</font> <font color="#0000ff">="Back"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="PushButton"</font> <font color="#ff0000">X</font> <font color="#0000ff">="192"</font> <font color="#ff0000">Y</font> <font color="#0000ff">="243"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="56"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="17"</font> <font color="#ff0000">Text</font> <font color="#0000ff">="!(loc.WixUIBack)"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Control</font> <font color="#ff0000">Id</font> <font color="#0000ff">="Cancel"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="PushButton"</font> <font color="#ff0000">X</font> <font color="#0000ff">="304"</font> <font color="#ff0000">Y</font> <font color="#0000ff">="243"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="56"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="17"</font> <font color="#ff0000">Cancel</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">Text</font> <font color="#0000ff">="!(loc.WixUICancel)"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Event</font> <font color="#0000ff">="SpawnDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="CancelDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Control</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Control</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutDesktop"</font> <br> <font color="#ff0000">Type</font> <font color="#0000ff">="CheckBox"</font> <br> <font color="#ff0000">Height</font> <font color="#0000ff">="18"</font> <br> <font color="#ff0000">Width</font> <font color="#0000ff">="295"</font> <br> <font color="#ff0000">X</font> <font color="#0000ff">="26"</font> <font color="#ff0000">Y</font> <font color="#0000ff">="58"</font> <br> <font color="#ff0000">Text</font> <font color="#0000ff">="    "</font> <br> <font color="#ff0000">Property</font> <font color="#0000ff">="SHORTCUT_DESKTOP"</font> <br> <font color="#ff0000">CheckBoxValue</font> <font color="#0000ff">="1"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Control</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutProgramMenu"</font> <br> <font color="#ff0000">Type</font> <font color="#0000ff">="CheckBox"</font> <br> <font color="#ff0000">Height</font> <font color="#0000ff">="18"</font> <br> <font color="#ff0000">Width</font> <font color="#0000ff">="295"</font> <br> <font color="#ff0000">X</font> <font color="#0000ff">="26"</font> <font color="#ff0000">Y</font> <font color="#0000ff">="79"</font> <br> <font color="#ff0000">Text</font> <font color="#0000ff">="    "</font> <br> <font color="#ff0000">Property</font> <font color="#0000ff">="SHORTCUT_PROGRAMMENU"</font> <br> <font color="#ff0000">CheckBoxValue</font> <font color="#0000ff">="1"</font> <font color="#0000ff">/&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Control</font> <font color="#ff0000">Id</font> <font color="#0000ff">="BannerBitmap"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="Bitmap"</font> <font color="#ff0000">X</font> <font color="#0000ff">="0"</font> <font color="#ff0000">Y</font> <font color="#0000ff">="0"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="370"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="44"</font> <font color="#ff0000">TabSkip</font> <font color="#0000ff">="no"</font> <font color="#ff0000">Text</font> <font color="#0000ff">="!(loc.CustomizeDlgBannerBitmap)"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Control</font> <font color="#ff0000">Id</font> <font color="#0000ff">="BannerLine"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="Line"</font> <font color="#ff0000">X</font> <font color="#0000ff">="0"</font> <font color="#ff0000">Y</font> <font color="#0000ff">="44"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="370"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="2"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Control</font> <font color="#ff0000">Id</font> <font color="#0000ff">="BottomLine"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="Line"</font> <font color="#ff0000">X</font> <font color="#0000ff">="0"</font> <font color="#ff0000">Y</font> <font color="#0000ff">="234"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="370"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="2"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Control</font> <font color="#ff0000">Id</font> <font color="#0000ff">="Title"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="Text"</font> <font color="#ff0000">X</font> <font color="#0000ff">="15"</font> <font color="#ff0000">Y</font> <font color="#0000ff">="6"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="210"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="15"</font> <font color="#ff0000">Transparent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">NoPrefix</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">Text</font> <font color="#0000ff">="!(loc.CustomizeDlgTitle)"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Dialog</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">UI</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Fragment</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Wix</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> </blockquote><br>  You can create dialogs in two ways: create them yourself by editing the code, or you can use a visual editor, such as Sharp Develop.  I did so, taking the <b>SetupTypeDlg.wxs</b> dialog (src \ ext \ UIExtension \ wixlib) as a basis, deleted the excess, added the missing one. <br><br>  Let's include our new dialogue in the installation process.  A new dialog should be displayed following the selection of components for installation, or after the installation type selection dialog if the Normal or Full buttons are pressed.  Open the <b>WixUI_Wizard.wxs</b> file and add the following: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="ShortcutsDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Back"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="CustomizeDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="ShortcutsDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Next"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="VerifyReadyDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> </blockquote><br>  Now it is necessary to redefine the response to button presses in the dialogs <b>SetupTypeDlg</b> , <b>CustomizeDlg</b> , <b>VerifyReadyDlg</b> .  All together it will look like this (I do not quote unchanged lines): <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#00CC00">&lt;!--          --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="SetupTypeDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="TypicalButton"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="ShortcutsDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font> <br> <font color="#00CC00">&lt;!--          --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="SetupTypeDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="CompleteButton"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="ShortcutsDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="CustomizeDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Next"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="ShortcutsDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#00CC00">&lt;!--                --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="ShortcutsDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Back"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="CustomizeDlg"</font> <font color="#ff0000">Order</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> WixUI_InstallMode = "InstallCustom" <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font> <br> <font color="#00CC00">&lt;!--                  --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="ShortcutsDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Back"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="SetupTypeDlg"</font> <font color="#ff0000">Order</font> <font color="#0000ff">="2"</font> <font color="#0000ff">&gt;</font> <br> WixUI_InstallMode = "InstallTypical" OR WixUI_InstallMode = "InstallComplete" <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="VerifyReadyDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Back"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="ShortcutsDlg"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="VerifyReadyDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Back"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="CustomizeDlg"</font> <font color="#ff0000">Order</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> WixUI_InstallMode = "Change" <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Dialog</font> <font color="#0000ff">="VerifyReadyDlg"</font> <font color="#ff0000">Control</font> <font color="#0000ff">="Back"</font> <font color="#ff0000">Event</font> <font color="#0000ff">="NewDialog"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="MaintenanceTypeDlg"</font> <font color="#ff0000">Order</font> <font color="#0000ff">="2"</font> <font color="#0000ff">&gt;</font> <br> WixUI_InstallMode = "Repair" OR WixUI_InstallMode = "Remove" <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> </blockquote><br>  We collect, we start, we see a new window.  One problem, are checkboxes or not - a shortcut on the desktop is not created, in the Start menu is created anyway.  Those.  no reaction.  And all because we tied nothing to these checkboxes.  <b>First,</b> add two new properties to the <b>Product.wxs</b> file: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Property</font> <font color="#ff0000">Id</font> <font color="#0000ff">="SHORTCUT_PROGRAMMENU"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Property</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Property</font> <font color="#ff0000">Id</font> <font color="#0000ff">="SHORTCUT_DESKTOP"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Property</font> <font color="#0000ff">&gt;</font></font></code> <br> </blockquote><br>  Our checkboxes have the same properties: <font color="#800000">Property</font> <font color="#0000ff">= "SHORTCUT_DESKTOP"</font> and <font color="#800000">Property</font> <font color="#0000ff">= "SHORTCUT_PROGRAMMENU"</font> , hence the connection.  If we change the state of the checkboxes in the dialog box, the <font color="#800000">Property</font> value will also change.  Now you need to link the creation of labels and property values.  This is done very simply.  The condition is added to the component: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> SHORTCUT_PROGRAMMENU <font color="#0000ff">&lt;/</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font></font></code> <br> </blockquote><br>  If the expression inside the <font color="#0000ff">&lt;</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> key is true, then the component will be installed. <br><br>  All together looks like this: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutNotepad"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="{29EB41BB-FCFA-4f71-B31A-9B265DA5C05D}"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Shortcut</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutNotepad"</font> <br> <font color="#ff0000">Name</font> <font color="#0000ff">=""</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="$(var.ProductName)"</font> <br> <font color="#ff0000">Target</font> <font color="#0000ff">="[INSTALLLOCATION]Notepad.exe"</font> <br> <font color="#ff0000">WorkingDirectory</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RemoveFolder</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ApplicationProgramsFolder"</font> <font color="#ff0000">On</font> <font color="#0000ff">="uninstall"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RegistryValue</font> <font color="#ff0000">Root</font> <font color="#0000ff">="HKCU"</font> <font color="#ff0000">Key</font> <font color="#0000ff">="Software\$(var.Manufacturer)\$(var.ProductName)"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="installed"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="1"</font> <font color="#ff0000">KeyPath</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> SHORTCUT_PROGRAMMENU <font color="#0000ff">&lt;/</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> </blockquote><br>  Do not forget to add <font color="#0000ff">&lt;</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> for the <font color="#0000ff">ShortcutCalc</font> component. <br><br>  All that's left to do is add the creation of desktop shortcuts.  Add a new directory to the <b>Products.wxs</b> file <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="DesktopFolder"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="Desktop"</font> <font color="#0000ff">/&gt;</font></font> <br></code> <br></blockquote><br>  Description of shortcuts in the <b>Shortcuts.wxs</b> file: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">DirectoryRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="DesktopFolder"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="DesktopShortcutNotepad"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="{9746557B-59B1-46de-B369-5F454A946698}"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RegistryKey</font> <font color="#ff0000">Root</font> <font color="#0000ff">="HKCU"</font> <font color="#ff0000">Key</font> <font color="#0000ff">="YourAppKey\PossibleSubKey"</font> <font color="#ff0000">Action</font> <font color="#0000ff">="createAndRemoveOnUninstall"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RegistryValue</font> <font color="#ff0000">Name</font> <font color="#0000ff">="AnyValueName"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="1"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">KeyPath</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">RegistryKey</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Shortcut</font> <font color="#ff0000">Id</font> <font color="#0000ff">="DesktopShortcut"</font> <font color="#ff0000">Directory</font> <font color="#0000ff">="DesktopFolder"</font> <font color="#ff0000">Name</font> <font color="#0000ff">=""</font> <font color="#ff0000">Target</font> <font color="#0000ff">="[INSTALLLOCATION]Notepad.exe"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> SHORTCUT_DESKTOP <font color="#0000ff">&lt;/</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="DesktopShortcutCalc"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="{B4908FF0-96C6-4f12-8E64-BC366E1147E1}"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RegistryKey</font> <font color="#ff0000">Root</font> <font color="#0000ff">="HKCU"</font> <font color="#ff0000">Key</font> <font color="#0000ff">="YourAppKey\PossibleSubKey"</font> <font color="#ff0000">Action</font> <font color="#0000ff">="createAndRemoveOnUninstall"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RegistryValue</font> <font color="#ff0000">Name</font> <font color="#0000ff">="AnyValueName"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="1"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">KeyPath</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">RegistryKey</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Shortcut</font> <font color="#ff0000">Id</font> <font color="#0000ff">="DesktopShortcut"</font> <font color="#ff0000">Directory</font> <font color="#0000ff">="DesktopFolder"</font> <font color="#ff0000">Name</font> <font color="#0000ff">=""</font> <font color="#ff0000">Target</font> <font color="#0000ff">="[INSTALLLOCATION]Calc.exe"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> SHORTCUT_DESKTOP <font color="#0000ff">&lt;/</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DirectoryRef</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> </blockquote><br>  Add links to shortcuts in the <b>Features.wxs</b> file: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#ff0000">Id</font> <font color="#0000ff">="FeatureNotepad"</font> <font color="#ff0000">Title</font> <font color="#0000ff">=""</font> <font color="#ff0000">Description</font> <font color="#0000ff">=" "</font> <font color="#ff0000">Level</font> <font color="#0000ff">="1"</font> <font color="#ff0000">ConfigurableDirectory</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ComponentNotepad"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutNotepad"</font> <font color="#0000ff">/&gt;</font> <br> <b><font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="DesktopShortcutNotepad"</font> <font color="#0000ff">/&gt;</font></b> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#ff0000">Id</font> <font color="#0000ff">="FeatureCalc"</font> <font color="#ff0000">Title</font> <font color="#0000ff">=""</font> <font color="#ff0000">Description</font> <font color="#0000ff">=" "</font> <font color="#ff0000">Level</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ComponentCalc"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutCalc"</font> <font color="#0000ff">/&gt;</font> <br> <b><font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="DesktopShortcutCalc"</font> <font color="#0000ff">/&gt;</font></b> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> </blockquote><br>  Almost done.  It remains to fulfill one more condition, with a normal installation, only a notebook should be installed.  To fulfill this condition, add <font color="#0000ff">&lt;</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> to <font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> , which is responsible for installing the calculator. <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Condition</font> <font color="#ff0000">Level</font> <font color="#0000ff">="0"</font> <font color="#0000ff">&gt;</font> INSTALLLEVEL=3 <font color="#0000ff">&lt;/</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font></font></code> <br> </blockquote><br>  The <font color="#ff0000">Level</font> parameter when using <font color="#0000ff">&lt;</font> <font color="#800000">Condition</font> <font color="#0000ff">&gt;</font> inside <font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> is mandatory.  It sets the <font color="#ff0000">Level</font> itself <font color="#0000ff">&lt;/</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> if the condition is met.  In this case, it is <b>INSTALLLEVEL = 3, the</b> value 3 is set to the property INSTALLLEVEL if the user has selected <b>Normal</b> installation.  How did I know this?  I looked at the sources for the <b>SetupTypeDlg.wxs</b> installation type selection <b>dialog</b> (by the way, there are a lot of interesting things there, by the way) <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Publish</font> <font color="#ff0000">Event</font> <font color="#0000ff">="SetInstallLevel"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="3"</font> <font color="#0000ff">&gt;</font> 1 <font color="#0000ff">&lt;/</font> <font color="#800000">Publish</font> <font color="#0000ff">&gt;</font></font></code> <br> </blockquote><br>  A value of 0 for the <font color="#ff0000">Level</font> parameter means that the installation option will be disabled. <br><br>  We collect, run, install. <br><br>  Project sources can be downloaded <a href="">here.</a> <br><br>  That's all.  Next time I will talk about <b>CustomActions</b> , a very interesting thing that allows you to add any actions to the installation package. </div><p>Source: <a href="https://habr.com/ru/post/70616/">https://habr.com/ru/post/70616/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../70607/index.html">Moscow: in public institutions incandescent bulbs will be replaced with energy-saving</a></li>
<li><a href="../70608/index.html">Which virtualization system is better?</a></li>
<li><a href="../70610/index.html">Perl One-Line Programs</a></li>
<li><a href="../70614/index.html">Consumer Expert Social Network</a></li>
<li><a href="../70615/index.html">On a heuristic method for detecting viral injections on sites</a></li>
<li><a href="../70617/index.html">Consumer Expert Social Network</a></li>
<li><a href="../70618/index.html">Ideal university</a></li>
<li><a href="../70621/index.html">Google Sites Opened API</a></li>
<li><a href="../70623/index.html">FreeBSD 8.0-RC1 released</a></li>
<li><a href="../70626/index.html">Parking.ru participant of the WebsiteSpark program</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>