<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Threat Hunting, or How to defend against 5% of threats</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="95% of information security threats are known, and you can defend against them with traditional means such as antivirus, firewall, IDS, WAF. The remai...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Threat Hunting, or How to defend against 5% of threats</h1><div class="post__text post__text-html js-mediator-article">  95% of information security threats are known, and you can defend against them with traditional means such as antivirus, firewall, IDS, WAF.  The remaining 5% of the threats are unknown and the most dangerous.  They constitute 70% of the risk for the company due to the fact that it is very difficult to detect them and even more so to protect against them.  Examples of <a href="https://www.nytimes.com/2007/04/22/books/chapters/0422-1st-tale.html%3F_r%3D0">‚Äúblack swans‚Äù</a> are the epidemics of the WannaCry cryptographers, NotPetya / ExPetr, crypto miners, Stuxnet‚Äôs ‚Äúcyber weapon‚Äù (which hit Iran‚Äôs nuclear facilities) and many (does anyone remember Kido / Conficker?) Of other attacks that are not very good at defending classical defense means of protection.  We want to talk about how to counter these 5% of threats with the help of the Threat Hunting technology. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f0/6a1/19e/6f06a119e1279e1bbbe9f3774f831f53.png"></div><a name="habracut"></a><br>  The continuous development of cyber-attacks requires constant detection and counteraction, which ultimately leads us to the idea of ‚Äã‚Äãan endless arms race between attackers and defenders.  Classic protection systems are no longer able to provide an acceptable level of protection, in which the level of risk does not affect the company's key indicators (economic, political, reputation) without refining them for a specific infrastructure, but in general they cover some of the risks.  Already in the process of implementation and configuration, modern security systems find themselves in the role of a catch-up and must respond to the challenges of the new time. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8f/a31/386/a8fa31386ee92fe03e60d4bb004c2ce0.png"></div>  <a href="">A source</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      One answer to the challenges of modernity for an information security specialist can be Threat Hunting technology.  The term Threat Hunting (hereinafter referred to as TH) appeared several years ago.  The technology itself is quite interesting, but does not yet have any generally accepted standards and rules.  Also complicated is the heterogeneity of information sources and the small number of Russian-language information sources on this topic.  In this connection, we in ‚ÄúLANIT-Integration‚Äù decided to write a certain review of this technology. <br><br><h2>  Relevance </h2><br>  TH technology relies on infrastructure monitoring processes.  <a href="https://lukatsky.blogspot.com/2016/11/mssp-mdr.html">There are two main scenarios for internal monitoring - Alerting and Hunting</a> .  Alerting (by type of MSSP services) is a traditional method, searching for signatures and signs of attacks developed earlier and responding to them.  This script is successfully implemented by traditional signature protection.  Hunting (MDR type service) is a monitoring method that answers the question ‚ÄúWhere do signatures and rules come from?‚Äù.  This is the process of creating correlation rules by analyzing hidden or previously unknown indicators and signs of attack.  It is to this type of monitoring that Threat Hunting belongs. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df0/6ba/ffb/df06baffb0742e44018b15b5ae804de5.png"></div><br>  Only by combining both types of monitoring, we get protection that is close to ideal, but there always remains some level of residual risk. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6c6/820/fd3/6c6820fd3eca0e338e9f530bfb43ccc4.png"></div>  <i>Protection using two types of monitoring</i> <br><br>  And this is why TH (and all the hunting!) Will be increasingly relevant: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ba/a47/d96/6baa47d96a13bafd8b10d2c11b4e1f79.png"></div>  <i>Threats, remedies, risks.</i>  <a href="https://lukatsky.blogspot.com/2016/11/threat-hunting.html">A source</a> <br><br>  <a href="https://lukatsky.blogspot.com/2016/11/threat-hunting.html">95% of all threats are already well understood</a> .  These include such types as spam, DDoS, viruses, rootkits and other classic malware.  You can protect yourself from these threats with the same classical means of protection. <br><br>  In the course of any project, <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25BA%25D0%25BE%25D0%25BD_%25D0%259F%25D0%25B0%25D1%2580%25D0%25B5%25D1%2582%25D0%25BE">80% of the work takes 20% of the time</a> , and the remaining 20% ‚Äã‚Äãof the work takes 80% of the time.  Similarly, among the entire threat landscape, 5% of the threats of a new type will amount to 70% of the risk to the company.  In a company where information security management processes are organized, we can manage 30% of the risk of implementing known threats in one way or another by avoiding (relinquishing wireless networks in principle), accepting (introducing the necessary protections) or shifting (for example, to the integrator) this risk.  Defending yourself against <a href="https://threatpost.ru/windows-0day-patched-by-third-party/30640/">zero-day vulnerabilities</a> , APT attacks, phishing, <a href="https://www.cloudav.ru/mediacenter/news/business-risks-supply-chain-attacks/">supply chain attacks</a> , cyber espionage and national operations, as well as a large number of other attacks is much more difficult.  The consequences of these 5% of threats will be much more serious (the <a href="https://www.group-ib.ru/brochures/gib-buhtrap-report.pdf">average amount of losses of the bank from the group buhtrap - 143 million</a> ), than the consequences of spam or viruses, which saves antivirus software. <br><br>  With 5% of the threats have to face almost everything.  Recently, we had to install one open-source-solution that uses the application from the repository PEAR (PHP Extension and Application Repository).  Attempting to install this application through pear install failed, because the <a href="http://pear.php.net/">site</a> was unavailable (now the stub is already hanging on it), I had to install it from GitHub.  And just recently it turned out that PEAR was the victim of an <a href="https://threatpost.ru/intruders-modified-pear-installer/30665/">attack through the supply chain</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/kp/ja/gvkpjav5nqtvhmubvsavkm6n1vg.png"></div><br><br>  You can still remember the <a href="https://habr.com/ru/company/cloud4y/blog/338980/">attack using CCleaner</a> , the NePetya cipher epidemic through the program update module for managing tax reporting <a href="https://habr.com/ru/company/cloud4y/blog/338980/">MEDoc</a> .  Threats are becoming more sophisticated, and a logical question arises - ‚ÄúHow can we still resist these 5% of threats?‚Äù <br><br><h2>  Threat Hunting Definition </h2><br>  So, Threat Hunting is a process of proactive and iterative search and detection of advanced threats that cannot be detected by traditional means of protection.  Advanced threats include, for example, attacks such as APT, 0-day vulnerability attacks, Living off the Land, and so on. <br><br>  You can also rephrase that TH is a hypothesis testing process.  This is mainly a manual process with elements of automation, in which the analyst, relying on his knowledge and qualifications, sifts large amounts of information in search of signs of compromise, corresponding to the initially defined hypothesis of the presence of a certain threat.  A distinctive feature of it is the variety of sources of information. <br><br>  It should be noted that Threat Hunting is not some kind of software or hardware product.  These are not alerts that can be seen in a solution.  This is not an IOC (compromise identifier) ‚Äã‚Äãsearch process.  And this is not some kind of passive activity that goes without the participation of information security analysts.  Threat Hunting is, above all, a process. <br><br><h2>  Threat Hunting </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/528/6af/453/5286af453a0cac4b426159d8e123f8c4.png"></div><br>  Three main components of Threat Hunting: data, technology, people. <br><br>  <b>Data (what?)</b> , Including Big Data.  Various traffic streams, information about previously conducted APT, analytics, data on user activity, network data, information from employees, information on the darknet and much more. <br><br>  <b>Technologies (how?)</b> Of processing this data are all possible ways of processing this data, including Machine Learning. <br><br>  <b>People (who?) Are</b> those who have extensive experience analyzing various attacks, developed intuition and the ability to detect an attack.  These are usually information security analysts who must have the ability to generate hypotheses and find confirmation for them.  They are the main link in the process. <br><br><h2>  PARIS model </h2><br>  Adam Bateman <a href="http://threathunter.guru/blog/the-paris-model/">describes</a> the PARIS model for the ideal TH process.  The name seems to hint at a famous landmark in France.  This model can be viewed in two directions - top and bottom. <br><br>  In the process of hunting for threats, moving along the model from the bottom up, we will deal with a lot of evidence of malicious activity.  Each proof has a measure such as confidence ‚Äî a characteristic that reflects the weight of this proof.  There are "iron", direct evidence of malicious activity, by which we can immediately reach the top of the pyramid and create the actual notification of an exactly known infection.  And there is circumstantial evidence, the sum of which can also lead us to the top of the pyramid.  As always, there is much more indirect evidence than direct evidence, which means that they should be sorted and analyzed, additional research should be carried out and it is desirable to automate it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/40c/e5d/f57/40ce5df5731f6024e785dd678c251d48.png"></div> <i>PARIS model.</i>  <a href="http://threathunter.guru/blog/the-paris-model/">A source</a> <br><br>  The upper part of the model (1 and 2) is based on automation technologies and various analytics, and the lower part (3 and 4) on people with certain qualifications that control the process.  You can consider the model moving from top to bottom, where at the top of blue we have alerts from traditional means of protection (antivirus, EDR, firewall, signatures) with a high degree of confidence and confidence, and lower indicators (IOC, URL, MD5 and others), who have a lower degree of confidence and require additional study.  And the lowest and the thickest level (4) is the generation of hypotheses, the creation of new scenarios for the operation of traditional means of protection.  This level is not limited to the indicated sources of hypotheses.  The lower the level, the greater the requirements for analyst qualifications. <br><br>  It is very important that analysts do not just check the final set of predetermined hypotheses, but constantly work on generating new hypotheses and options for testing them. <br><br><h2>  TH use maturity model </h2><br>  In an ideal world, TH is a continuous process.  But since there is no ideal world, let us analyze the <a href="http://threathunter.guru/blog/threat-hunting-maturity-model/">model of maturity</a> and methods in the context of people, processes and technologies used.  Consider the model of an ideal spherical TH.  There are 5 levels of using this technology.  Consider them on the example of the evolution of a single team of analysts. <br><table><tbody><tr><td width="170">  <b>Maturity levels</b> </td><td>  <b>People</b> </td><td>  <b>Processes</b> </td><td>  <b>Technology</b> </td></tr><tr><td>  <b>Level 0</b> </td><td>  SOC Analysts </td><td>  24/7 </td><td>  Traditional instruments: </td></tr><tr><td>  Traditional </td><td>  Alerts set </td><td>  Passive monitoring </td><td>  IDS, AV, Sandboxing, </td></tr><tr><td>  <i>Without th</i> </td><td>  Work with alerts </td><td></td><td>  signature analysis tools, Threat Intelligence data. </td></tr><tr><td>  <b>Level 1</b> </td><td>  SOC Analysts </td><td>  One-time TH </td><td>  Edr </td></tr><tr><td>  Experimental </td><td>  Basic knowledge of forensic </td><td>  IOC Search </td><td>  Partial coverage of data from network devices </td></tr><tr><td>  <i>TH experiments</i> </td><td>  Good knowledge of networks and application </td><td></td><td>  Partial application </td></tr><tr><td>  <b>Level 2</b> </td><td>  Temporary occupation </td><td>  Sprints </td><td>  Edr </td></tr><tr><td>  Periodic </td><td>  Average knowledge of forensic </td><td>  Week per month </td><td>  Full application </td></tr><tr><td>  <i>Temporary TH</i> </td><td>  Excellent knowledge of networks and applications </td><td>  Regular th </td><td>  Full automation of the use of EDR data </td></tr><tr><td></td><td></td><td></td><td>  Partial use of advanced EDR features </td></tr><tr><td>  <b>Level 3</b> </td><td>  Dedicated TH Team </td><td>  24/7 </td><td>  Partial ability to test TH hypotheses </td></tr><tr><td>  Preventive </td><td>  Excellent knowledge of forensics and malware </td><td>  Proactive th </td><td>  Full use of advanced EDR features </td></tr><tr><td>  <i>TH special cases</i> </td><td>  Excellent knowledge of the attacking side </td><td>  TH special cases </td><td>  Full coverage of data from network devices </td></tr><tr><td></td><td></td><td></td><td>  Configuration under the needs </td></tr><tr><td>  <b>Level 4</b> </td><td>  Dedicated TH Team </td><td>  24/7 </td><td>  Full ability to test TH hypotheses </td></tr><tr><td>  Leading </td><td>  Excellent knowledge of forensics and malware </td><td>  Proactive th </td><td>  Level 3, plus: </td></tr><tr><td>  <i>TH use</i> </td><td>  Excellent knowledge of the attacking side </td><td>  Verification, automation and verification of the hypotheses TH </td><td>  tight integration of data sources; </td></tr><tr><td></td><td>  Ability to research </td><td></td><td>  development for the needs and non-standard use of the API. </td></tr></tbody></table>  <i>TH maturity levels in terms of people, processes and technology</i> <br><br>  <b>Level 0:</b> traditional, without the use of TH.  Conventional analysts work with a standard set of alerts in the passive monitoring mode using standard tools and technologies: IDS, AV, sandboxes, and signature analysis tools. <br><br>  <b>Level 1:</b> experimental, using TH.  The same analysts with a basic knowledge of forensics and a good knowledge of networks and applications can implement one-time Threat Hunting by searching for indicators of compromise.  EDR tools are added to the tools with partial coverage of data from network devices.  Tools applied in part. <br><br>  <b>Level 2:</b> Periodic, Temporary TH.  The same analysts who have already pumped their knowledge of forensics, networks and applied parts are charged with the regular practice (sprint) of Threat Hunting, say, a week a month.  The tools are added to complete the study of data from network devices, automation of data analysis from EDR and partial use of advanced features of EDR. <br><br>  <b>Level 3:</b> proactive, frequent cases of TH.  Our analysts organized themselves into a dedicated team, they began to have excellent knowledge of forensics and malware, as well as knowledge of the methods and tactics of the attacking side.  The process is already carried out 24/7.  The team is able to partially test the TH hypothesis, fully utilizing the advanced capabilities of the EDR with full coverage of data from network devices.  Also, analysts are able to configure tools to fit their needs. <br><br>  <b>Level 4:</b> Lead, use TH.  The same team has acquired the ability to research, the ability to generate and automate the process of testing hypotheses TH.  Now to the tools added tight integration of data sources, software development for the needs and non-standard use of the API. <br><br><h2>  Threat Hunting Techniques </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/394/fbc/cf6/394fbccf6628d64624578ec61db29dda.png"></div>  <i>Basic Threat Hunting Techniques</i> <br><br>  The TH <a href="https://www.anti-malware.ru/analytics/Technology_Analysis/Cyber-Threat-Hunting-Data-Science">techniques</a> in terms of maturity of the technology used are: basic search, statistical analysis, visualization techniques, simple aggregations, machine learning, and Bayesian methods. <br><br>  The simplest method is the basic search, which is used to narrow the field of study using certain queries.  Statistical analysis is used, for example, to build a typical user or network activity in the form of a statistical model.  Visualization techniques are used to visualize and simplify data analysis in the form of graphs and diagrams, which are much easier to catch patterns in the sample.  The technique of simple aggregation by key fields is used to optimize search and analysis.  The higher the maturity level of the TH process in an organization, the more relevant the use of machine learning algorithms becomes.  They are also widely used in spam filtering, malicious traffic detection and fraud detection.  A more advanced type of machine learning algorithm is Bayesian methods that allow classification, sample size reduction, and thematic modeling. <br><br><h2>  Diamond Model and Strategy TH </h2><br>  Sergio Kaltagiron, Andrew Pendegast and Christopher Betz, in their work <a href="https://digital-forensics.sans.org/summit-archives/cti_summit2014/The_Diamond_Model_for_Intrusion_Analysis_A_Primer_Andy_Pendergast.pdf">The Diamond Model of Intrusion Analysis</a> , showed the main key components of any malicious activity and the basic connection between them. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/304/cde/02b/304cde02ba7997ff249797d93d2423f3.png"></div>  <i>Diamond model for malicious activity</i> <br><br>  According to this model, there are 4 Threat Hunting strategies that rely on the relevant key components. <br><br>  1. A strategy focused on the victim.  We assume that the victim has opponents, and they will deliver "opportunities" through e-mail.  We are looking for enemy data in the mail.  Search for links, attachments and etc.  We are looking for confirmation of this hypothesis for a certain period (month, two weeks), if not found, then the hypothesis has not played. <br><br>  2. Infrastructure oriented strategy.  There are several methods for using this strategy.  Depending on access and visibility, some are lighter than others.  For example, we monitor domain name servers that are known to host malicious domains.  Or we carry out the process of tracking all new domain name registrations for a known pattern used by the adversary. <br><br>  3. A strategy focused on opportunities.  In addition to the victim-centered strategy used by most of the network defenders, there is an opportunity-oriented strategy.  It is the second most popular and focuses on detecting opportunities from the adversary, namely ‚Äúmalware‚Äù and the possibility of the adversary using such legitimate tools as psexec, powershell, certutil and others. <br><br>  4. Strategy focused on the enemy.  The enemy-oriented approach focuses on the enemy.  These include the use of public information from publicly available sources (OSINT), collection of data about the enemy, his techniques and methods (TTP), analysis of previously occurring incidents, Threat Intelligence data, etc. <br><br><h2>  Sources of information and hypotheses in TH </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/001/c47/173/001c47173ac8a4e5affead0e47869f1e.png"></div>  <i>Some sources of information for Threat Hunting</i> <br><br>  Sources of information can be very much.  The ideal analyst should be able to extract information from all that is around.  Typical sources in almost any infrastructure will be data from the means of protection: DLP, SIEM, IDS / IPS, WAF / FW, EDR.  Also typical sources of information will be various indicators of compromise, Threat Intelligence services, CERT and OSINT data.  Additionally, you can use the information from the darknet (for example, suddenly there is an order for breaking the mailbox of the head of the organization, or a candidate for the network engineer has become active), information received from HR (reviews about the candidate from the past job), information from the security service ( for example, the results of the counterparty check). <br><br>  But before using all available sources, it is necessary to have at least one hypothesis. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aea/d70/c0d/aead70c0d9eee2ac44caa2b1cc12f4e0.png"></div>  <a href="https://www.anti-malware.ru/analytics/Technology_Analysis/generation-hypotheses-Threat-Hunting">A source</a> <br><br>  In order to test hypotheses, they must first be put forward.  And in order to put forward many qualitative hypotheses, it is necessary to apply a systematic approach.  The process of hypothesis generation is described in more detail in the <a href="https://www.anti-malware.ru/analytics/Technology_Analysis/generation-hypotheses-Threat-Hunting">article</a> ; it is very convenient to take this scheme as the basis for the process of hypothesizing. <br><br>  The main source of hypotheses will be the <b>matrix ATT &amp; CK</b> (Adversarial Tactics, Techniques and Common Knowledge).  It is, in essence, a knowledge base and model for assessing the behavior of intruders who implement their activities in the last steps of an attack, usually described with the help of the concept of Kill Chain.  That is, at the stages after an intruder penetrates the internal network of the enterprise or the mobile device.  Initially, the knowledge base included a description of 121 tactics and techniques used in the attack, each of which is described in detail in the Wiki format.  As a source for the generation of hypotheses is well suited various analytics Threat Intelligence.  Of particular note are the results of the analysis of infrastructure and penetration tests - these are the most valuable data that can give us iron hypotheses because they rely on a specific infrastructure with its specific flaws. <br><br><h2>  Hypothesis testing process </h2><br>  Sergey Soldatov gave a <a href="http://reply-to-all.blogspot.com/2016/10/bis-summit.html">good scheme</a> with a detailed description of the process; it illustrates the process of testing the TH hypotheses in a single system.  I will indicate the main stages with a brief description. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/431/46f/6a3/43146f6a3d7066bfc614fea87086e95b.png"></div>  <a href="https://www.anti-malware.ru/analytics/Technology_Analysis/generation-hypotheses-Threat-Hunting">A source</a> <br><br>  <b>Stage 1: TI Farm</b> <br><br>  At this stage, it is necessary to select <b>objects</b> (by analyzing them together with all the data about the threats) and assigning them the labels of their characteristics.  This is a file, URL, MD5, process, utility, event.  Passing them through the systems of Threat Intelligence, you must hang tags.  That is, this site was seen at CNC in a certain year, this MD5 was associated with such and such a Malvar, this MD5 swung from the site that distributed the malware. <br><br>  <b>Stage 2: Cases</b> <br><br>  At the second stage, we look at the interaction between these objects and identify the relationships between all these objects.  We get labeled systems that do something bad. <br><br>  <b>Stage 3: Analyst</b> <br><br>  At the third stage, the case is transferred to an experienced analyst, who has a vast experience of analysis, and he makes a verdict.  It parses up to bytes what, whence, how, why and why does this code.  This body was malicious, this computer was infected.  Opens the connection between objects, checks the results of the run through the sandbox. <br><br>  The results of the analyst are passed on.  Digital Forensics examines the images, Malware Analysis examines the found ‚Äúbodies‚Äù, and the Incident Response team can go to the site and explore something already there.  The result of the work will be a confirmed hypothesis, the identified attack and ways to counter it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5d1/dd8/c93/5d1dd8c937bacb4805a67795317a0b49.png"></div>  <a href="https://www.flickr.com/photos/megane_wakui/22066181186/">A source</a> <br><br><h2>  Results </h2><br>  Threat Hunting is a fairly young technology that can effectively withstand customized, new and non-standard threats, which has great prospects given the growing number of such threats and the increasing complexity of corporate infrastructure.  It requires three components - data, tools and analytics.  The benefits of Threat Hunting are not limited to the proactive implementation of threats.  Do not forget that in the process of searching we dive into our infrastructure and its weak points through the eyes of a security analyst and we can further strengthen these places. <br><br>  The first steps that, in our opinion, need to be done to initiate the TH process in your organization. <br><br><ol><li>  Take care of endpoint and network infrastructure protection.  Take care of the visibility (NetFlow) and control (firewall, IDS, IPS, DLP) of all processes in your network.  Know your network from the border router to the most recent host. </li><li>  Learn <a href="https://attack.mitre.org/">MITER ATT &amp; CK</a> . </li><li>  To conduct regular pentest at least key external resources, analyze its results, highlight the main objectives for the attack and close their vulnerabilities. </li><li>  Implement an open source Threat Intelligence system (for example, MISP, Yeti) and analyze logs with it. </li><li>  Implement an incident response platform (IRP): R-Vision IRP, The Hive, a sandbox for analyzing suspicious files (FortiSandbox, Cuckoo). </li><li>  Automate routine processes.  Log analysis, incident management, staff information are a huge field for automation. </li><li>  Learn to interact effectively with engineers, developers, technical support to work together on incidents. </li><li>  Document the entire process, key points, achieved results, to return to them later or share this data with colleagues; </li><li>  Remember about the social side: be aware of what is happening with your employees, whom you recruit and who you give access to the information resources of the organization. </li><li>  To keep abreast of trends in the field of new threats and ways of protection, to increase your level of technical literacy (including in the work of IT services and subsystems), to attend conferences and communicate with colleagues. </li></ol><br>  Ready to discuss the organization of the TH process in the comments. <br><br><div class="spoiler">  <b class="spoiler_title">Or come to work with us!</b> <div class="spoiler_text"><ul><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-31.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-04-16%26utm_campaign%3Ddsi">Leading Information Consultant</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-163.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-04-16%26utm_campaign%3Ddsi">Information Security Systems Architect</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-4.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-04-16%26utm_campaign%3Ddsi">Lead Network Security Engineer</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-136.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-04-16%26utm_campaign%3Ddsi">Lead Information Security Engineer (SIEM)</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-100.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-04-16%26utm_campaign%3Ddsi">IB Architect (Applied)</a> </li></ul></div></div><br><div class="spoiler">  <b class="spoiler_title">Sources and Materials for Study</b> <div class="spoiler_text"><ul><li>  <a href="http://threathunter.guru/">threathunter.guru</a> </li><li>  <a href="https://attack.mitre.org/">attack.mitre.org</a> </li><li>  <a href="https://digital-forensics.sans.org/summit-archives/cti_summit2014/The_Diamond_Model_for_Intrusion_Analysis_A_Primer_Andy_Pendergast.pdf">digital-forensics.sans.org</a> </li><li>  <a href="https://resources.infosecinstitute.com/category/enterprise/threat-hunting/">resources.infosecinstitute.com</a> </li><li>  <a href="https://www.redcanary.com/blog/threat-hunting-not-a-magical-unicorn/">www.redcanary.com</a> </li><li>  <a href="https://www.cybereason.com/blog/blog-the-eight-steps-to-threat-hunting">www.cybereason.com</a> </li><li>  <a href="https://www.anti-malware.ru/analytics/Technology_Analysis/generation-hypotheses-Threat-Hunting">www.anti-malware.ru</a> </li><li>  <a href="https://www.anti-malware.ru/analytics/Technology_Analysis/Cyber-Threat-Hunting-Data-Science">www.anti-malware.ru</a> </li><li>  <a href="http://reply-to-all.blogspot.com/2016/10/bis-summit.html">reply-to-all.blogspot.com</a> </li><li>  <a href="https://lukatsky.blogspot.com/2016/11/threat-hunting.html">lukatsky.blogspot.com</a> </li><li>  <a href="https://whitepapers.theregister.co.uk/paper/view/6965/threat-hunting-for-dummies">whitepapers.theregister.co.uk</a> </li></ul></div></div></div><p>Source: <a href="https://habr.com/ru/post/447580/">https://habr.com/ru/post/447580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447568/index.html">Interview with cosmonaut Alexander Laveykin about space cinema, overload in 20 units and soft landing</a></li>
<li><a href="../447570/index.html">GoLand 2019.1: Code Performance Analysis, Smart Step Into, Extract Interface Refactoring, Nilness Analyzer, and more</a></li>
<li><a href="../447574/index.html">Notes freelancer: the development of the first React Native-application</a></li>
<li><a href="../447576/index.html">Responsible approach to JavaScript development, part 1</a></li>
<li><a href="../447578/index.html">Accelerate JavaScript using Set data type</a></li>
<li><a href="../447582/index.html">Rusatom: 3D metal printing in Russia</a></li>
<li><a href="../447584/index.html">Anatomy of the "Space Data Center". Sky-high server: look under the hood</a></li>
<li><a href="../447586/index.html">Advanced string interpolation in Swift 5.0</a></li>
<li><a href="../447588/index.html">How to make the application more stable with the help of 2 types of unit tests</a></li>
<li><a href="../447592/index.html">WhatsApp in the palm of your hand: where and how can you detect forensic artifacts?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>