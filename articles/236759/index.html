<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis of lost passwords Gmail, Yandex and Mail.Ru</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most recently, public password databases of popular mail services [ 1 , 2 , 3 ] have come into public access and today we will analyze them and answer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analysis of lost passwords Gmail, Yandex and Mail.Ru</h1><div class="post__text post__text-html js-mediator-article">  Most recently, public password databases of popular mail services [ <a href="http://habrahabr.ru/post/235949/">1</a> , <a href="http://habrahabr.ru/post/236077/">2</a> , <a href="http://habrahabr.ru/post/236283/">3</a> ] have come into public access and today we will analyze them and answer a number of questions about the quality of passwords and the possible source (or sources).  We will also discuss the quality metrics of individual passwords and the entire sample. <br><br>  No less interesting are some anomalies and patterns of the password databases, perhaps they can shed light on what could serve as a source of data and how this sample is dangerous from the point of view of the average user. <br><br>  Formally, we will consider the following questions: how strong are the passwords in the database and could they be collected by dictionary attack?  Are there signs of phishing attacks?  Could data ‚Äúleakage‚Äù be the only data source?  Could this database be accumulated over a long period or was the data exclusively ‚Äúfresh‚Äù? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The structure of the article: <br><br><ol><li>  <a href="http://habrahabr.ru/post/236759/">Data description</a> </li><li>  <a href="http://habrahabr.ru/post/236759/">Invalid passwords and non-passwords</a> </li><li>  <a href="http://habrahabr.ru/post/236759/">Password length distribution</a> </li><li>  <a href="http://habrahabr.ru/post/236759/">Password strength distribution</a> </li><li>  <a href="http://habrahabr.ru/post/236759/">Dictionary attack</a> </li><li>  <a href="http://habrahabr.ru/post/236759/">Top passwords</a> </li><li>  <a href="http://habrahabr.ru/post/236759/">Gmail sample</a> </li><li>  <a href="http://habrahabr.ru/post/236759/">Rambler sample</a> </li><li>  <a href="http://habrahabr.ru/post/236759/">Open source analysis</a> </li><li>  <a href="http://habrahabr.ru/post/236759/">Conclusion</a> </li></ol><br><a name="habracut"></a><br><h4>  Data description </h4><a name="data"></a><br>  Data from all three databases is a set of address-password pairs, separated by a colon.  No other "meta-data" is available.  However, the data is quite noisy i.  they contain strings that are not mail addresses or valid passwords. <br><br><img src="https://habrastorage.org/files/056/449/076/056449076470443bb262159a2b266c11.png"><br><br>  If we examine the features of the data, we can put forward (or refute) the hypothesis of what process the passwords could be obtained. <br><br><h4>  Invalid passwords and non-passwords </h4><a name="valid"></a><br>  The simplest criterion for invalid password is the discrepancy between the length of the password and the requirements of mail services. <br><br><img src="https://habrastorage.org/files/168/839/ff3/168839ff390f429fbbb492047af28fe2.png"><br><br>  The data obtained suggests that the passwords from the sample could not be obtained as a result of an ‚Äúinternal‚Äù leak, since several thousand passwords are not valid passwords in principle due to restrictions on the password length of six characters (and for modern passwords gmail eight characters) . <br><br>  Consider these abnormally long (over 60) and short passwords (less than 6) in detail. <br><br><h5>  Examples </h5><br>  Long passwords are pieces of HTML code, one of the representative examples: <br><br><img src="https://habrastorage.org/files/cfc/8bb/6bb/cfc8bb6bbdf74b9d80e84d3a12bfdf04.png"><br><br>  Such examples indicate that phishing could be one of the sources of passwords.  The record in the database was clearly not verified by a person and obtained automatically, phishing is also indicated by the fact that the html markup is present in the password, which is rather unusual for stealing a password through infection. <br><br>  Brief selection of passwords that are too short: <br><br><img src="https://habrastorage.org/files/494/86c/189/49486c1892ec4cb48d9f4bc131f8c941.png"><br><br>  Another indicator that phishing could be one of the sources is the absence of a login and password in the records.  Particularly interesting is the apostrophe without a password.  Perhaps a potential victim guessed the phishing form and tried to check for SQL injection. <br><br>  What can be unequivocally asserted by verified data?  Automatic database validation did not occur.  The most likely hypotheses are phishing and virus infection. <br><br>  In order to assess the quality of the entire sample, we will remove from it deliberately incorrect passwords of length less than 6 and more than 60 and consider the distribution as a whole according to several parameters. <br><br><h4>  Password length distribution </h4><a name="length"></a><br>  As you can see from the graph below, most passwords are 8 characters or less long.  This may indicate that a significant layer of passwords is potentially unstable to various types of attacks of over-the-counter attacks. <br><br><img src="https://habrastorage.org/files/e97/f01/995/e97f01995c9b407ca7b085562d6505f8.png"><br><br><h4>  Password strength distribution </h4><a name="stength"></a><br>  In order to test this hypothesis, consider a simple password <i>strength</i> metric based on <br>  <a href="https://limoanywhere.uservoice.com/knowledgebase/articles/170461-what-are-the-password-requirements-for-pci-complia">PCI standard</a> . <br>  Let the password receive a conditional score for satisfying one of the following conditions: <br><ul><li>  password contains at least 7 characters; </li><li>  password contains at least one lower case letter; </li><li>  the password contains at least one uppercase letter; </li><li>  the password contains at least one digit; </li><li>  Password contains at least one special character. </li></ul><br>  If the password receives 4/5, then we call it reliable (very reliable for 5/5), respectively, 3/5 we will call average, and 2/5 weak (0 or 1 point we will call very weak).  The R code is shown below. <br><br><div class="spoiler">  <b class="spoiler_title">Reliability function</b> <div class="spoiler_text"><pre><code class="matlab hljs">library(<span class="hljs-string"><span class="hljs-string">"Hmisc"</span></span>) strength &lt;- <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(password)</span></span></span><span class="hljs-function">{ # </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">must</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contain</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">at</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">least</span></span></span><span class="hljs-function"> 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">characters</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">score</span></span></span><span class="hljs-function"> = 0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(nchar(password)</span></span></span><span class="hljs-function"> &gt;= 7){ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(score)</span></span></span><span class="hljs-function"> &lt;- 1 } # </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">at</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">least</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">one</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">digit</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(grepl("[[:digit:]]", password)</span></span></span><span class="hljs-function">){ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(score)</span></span></span><span class="hljs-function"> &lt;- 1 } # </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">at</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">least</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">one</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lowercase</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">letter</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(grepl("[[:lower:]]", password)</span></span></span><span class="hljs-function">){ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(score)</span></span></span><span class="hljs-function"> &lt;- 1 } # </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">at</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">least</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">one</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uppercase</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">letter</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(grepl("[[:upper:]]", password)</span></span></span><span class="hljs-function">){ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(score)</span></span></span><span class="hljs-function"> &lt;- 1 } # </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">at</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">least</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">one</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">special</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">symbol</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(grepl("[#!?^@*+&amp;%]", password)</span></span></span><span class="hljs-function">){ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(score)</span></span></span><span class="hljs-function"> &lt;- 1 } # 0-1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">very</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">weak</span></span></span><span class="hljs-function"> # 2 - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">weak</span></span></span><span class="hljs-function"> # 3 - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">medium</span></span></span><span class="hljs-function"> # 4 - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">strong</span></span></span><span class="hljs-function"> # 5 - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">very</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">strong</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">return</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(score)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br>  Then the distribution of reliability is: <br><br><img src="https://habrastorage.org/files/556/293/60d/55629360d7f649e3b62c8ecb816c093b.png"><br><br>  As you can see from the graph, most passwords fall into the non-secure category.  As an example, consider zero security passwords, as this is most likely another representative example of invalid passwords. <br><br><h5>  Zero Passwords </h5><br><img src="https://habrastorage.org/files/443/c67/9df/443c679df6cb42f090b0b4883d7ee67e.png"><br><br>  As can be seen from the examples above, these passwords are not valid (and from a person‚Äôs point of view they look more like an input error than a valid password), since postal services do not allow registering the box if they consider the password too simple, for example, repeating the same character six times.  This means that perhaps even a larger layer of passwords is not valid according to modern requirements. <br><br>  Is it possible that a substantial part of the database was collected over a long period of time, when the requirements for passwords were softer?  Otherwise, it is quite difficult to explain such a large group of passwords that do not meet the requirements of modern mail systems. <br><br><h4>  Dictionary attack </h4><a name="dictionary"></a><br>  As an additional argument, we will conduct the following experiment: take a sample of relevant password dictionaries from general access, conduct an attack on the available passwords on these dictionaries and estimate what percentage of passwords is contained in this selection of dictionaries (the author literally did not go beyond the first three Google links on request [password dictionary ]). <br><br><img src="https://habrastorage.org/files/370/1f5/4a1/3701f54a13d6465da08e04d15c64644b.png"><br><br>  The table above shows that a significant proportion of passwords is contained in dictionaries, which also indicates that some passwords could have been obtained as a result of a dictionary attack (or some sort of brute force modification). <br><br><h4>  Top passwords </h4><a name="top"></a><br>  We present a selection of the most popular passwords and note that most of them are not valid passwords now. <br><br><img src="https://habrastorage.org/files/947/674/c4a/947674c4aa734f498a6c4cc13ea0ecd4.png"><br><br><h4>  Gmail sample </h4><a name="sampleGmail"></a><br>  The actions and data described and obtained in this and the next part were produced and transmitted by a <i>friend of my friend</i> who wished to remain anonymous. <br><br>  Task: check the validity (i.e. that the password is really appropriate) of the password.  Action: on a small sample of ~ 150-200 try to get access to the boxes.  Of the entire sample, in principle, ~ 2-3% are valid (after a few hours of publicly available data), and virtually all are deactivated at the time of the check.  Less than 1% of the boxes were actually operating and they were abandoned by the owners for at least a year. <br><br><h4>  Rambler sample </h4><a name="sampleRambler"></a><br>  It is easy to find in the network lists of ‚Äútruly valid‚Äù addresses compiled by a wide range of interested parties (aka kulkhackers). <br><br><img src="https://habrastorage.org/files/fa3/28b/306/fa328b306f8949c4afbc12953cab7170.png"><br><br>  Interestingly, among them is a rather large percentage of the rambler addresses. <br><br>  <b>Rambler was warned a few days before publication and a reply was received that the necessary security measures would be taken soon.</b> <br><br>  &lt;humor&gt; <img src="https://habrastorage.org/files/dac/eb5/d83/daceb5d836da4a0bb4c9b0c5fdd05c68.png">  &lt;/ humor&gt; <br><br>  Interestingly, the percentage of valid passwords is significantly higher and, until recently, rambler was outside the media field of events and did not activate additional security systems. <br><br>  This allowed an unknown leakage anthropologist to assess the last moments of mailbox life.  Despite the validity of passwords, all the boxes were abandoned for a long time (~ 1-1.5 years) and ended with one of these letters: <br><br><img src="https://habrastorage.org/files/6f8/12d/1c3/6f812d1c3f884bc6bbd93b808668ce6e.png"><br><br>  Which is another confirmation of the phishing hypothesis and the cumulative nature of the base. <br><br><h4>  Open source analysis </h4><a name="sources"></a><br>  Let us return to the consideration of open sources.  Active search for username passwords led us to a series of distributions from gaming forums: <br><br><img src="https://habrastorage.org/files/d09/cb8/480/d09cb848073e44c2869184fc5eee5127.png"><br><br>  It turns out that part of the list was already walking around the network in some form. <br><br>  Thus, the data allows to reject the hypothesis of a single source of data such as ‚Äúinternal leakage‚Äù. <br><br>  The main part of the code used: <br><div class="spoiler">  <b class="spoiler_title">Data analysis and visualization</b> <div class="spoiler_text"><pre> <code class="matlab hljs">source(<span class="hljs-string"><span class="hljs-string">"multiplot.R"</span></span>) source(<span class="hljs-string"><span class="hljs-string">"password_strength.R"</span></span>) library(<span class="hljs-string"><span class="hljs-string">"ggplot2"</span></span>) print(<span class="hljs-string"><span class="hljs-string">"loading yandex data"</span></span>) yandex &lt;- read.csv(<span class="hljs-string"><span class="hljs-string">"yandex.txt"</span></span>, header = FALSE, sep = <span class="hljs-string"><span class="hljs-string">":"</span></span>, quote = <span class="hljs-string"><span class="hljs-string">""</span></span>, stringsAsFactors = FALSE) print(<span class="hljs-string"><span class="hljs-string">"loading mailru data"</span></span>) mailru &lt;- read.csv(<span class="hljs-string"><span class="hljs-string">"mail.txt"</span></span>, header = FALSE, sep = <span class="hljs-string"><span class="hljs-string">":"</span></span>, quote = <span class="hljs-string"><span class="hljs-string">""</span></span>, stringsAsFactors = FALSE) print(<span class="hljs-string"><span class="hljs-string">"loading gmail data"</span></span>) gmail &lt;- read.csv(<span class="hljs-string"><span class="hljs-string">"gmail.txt"</span></span>, header = FALSE, sep = <span class="hljs-string"><span class="hljs-string">":"</span></span>, quote = <span class="hljs-string"><span class="hljs-string">""</span></span>, stringsAsFactors = FALSE) ##testing <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> data loaded correctly print(<span class="hljs-string"><span class="hljs-string">"testing, if loaded correctly"</span></span>) print(head(yandex)) print(head(mailru)) print(head(gmail)) ##changing names names(yandex) &lt;- c(<span class="hljs-string"><span class="hljs-string">"email"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>) names(mailru) &lt;- c(<span class="hljs-string"><span class="hljs-string">"email"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>) names(gmail) &lt;- c(<span class="hljs-string"><span class="hljs-string">"email"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>) print(<span class="hljs-string"><span class="hljs-string">"computing lengths of passwords and adding to the datasets"</span></span>) yandex$pass_length &lt;- sapply(yandex$password, nchar) mailru$pass_length &lt;- sapply(mailru$password, nchar) gmail$pass_length &lt;- sapply(gmail$password, nchar) print(<span class="hljs-string"><span class="hljs-string">"number of invalid passwords by length"</span></span>) print(nrow(yandex[yandex$pass_length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>,])) print(nrow(yandex[yandex$pass_length &gt; <span class="hljs-number"><span class="hljs-number">60</span></span>,])) print(nrow(mailru[mailru$pass_length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>,])) print(nrow(mailru[mailru$pass_length &gt; <span class="hljs-number"><span class="hljs-number">60</span></span>,])) print(nrow(gmail[gmail$pass_length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>,])) print(nrow(gmail[gmail$pass_length &gt; <span class="hljs-number"><span class="hljs-number">60</span></span>,])) print(<span class="hljs-string"><span class="hljs-string">"removing invalid passwords by length"</span></span>) yandex &lt;- subset(yandex, pass_length &gt;= <span class="hljs-number"><span class="hljs-number">6</span></span> &amp; pass_length &lt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) mailru &lt;- subset(mailru, pass_length &gt;= <span class="hljs-number"><span class="hljs-number">6</span></span> &amp; pass_length &lt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) gmail &lt;- subset(gmail , pass_length &gt;= <span class="hljs-number"><span class="hljs-number">6</span></span> &amp; pass_length &lt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) #print(<span class="hljs-string"><span class="hljs-string">"checking that they are removed"</span></span>) print(nrow(yandex[yandex$pass_length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>,])) print(nrow(yandex[yandex$pass_length &gt; <span class="hljs-number"><span class="hljs-number">60</span></span>,])) print(nrow(mailru[mailru$pass_length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>,])) print(nrow(mailru[mailru$pass_length &gt; <span class="hljs-number"><span class="hljs-number">60</span></span>,])) print(nrow(gmail[gmail$pass_length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>,])) print(nrow(gmail[gmail$pass_length &gt; <span class="hljs-number"><span class="hljs-number">60</span></span>,])) print(<span class="hljs-string"><span class="hljs-string">"visualizing distribution of password lenghts by provider"</span></span>) gmailcolor &lt;- <span class="hljs-string"><span class="hljs-string">"deepskyblue"</span></span> yandexcolor &lt;- <span class="hljs-string"><span class="hljs-string">"orangered1"</span></span> mailrucolor &lt;- <span class="hljs-string"><span class="hljs-string">"limegreen"</span></span> pgmail &lt;- ggplot(data=gmail, aes(x=pass_length)) + scale_x_discrete(limits=seq(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), breaks=seq(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), drop=TRUE) + geom_histogram(colour=<span class="hljs-string"><span class="hljs-string">"black"</span></span>, fill=gmailcolor, aes(y=..density..)) + coord_cartesian(xlim=c(<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">21.5</span></span>)) + xlab(expression(<span class="hljs-string"><span class="hljs-string">" "</span></span>))+ ylab(expression(<span class="hljs-string"><span class="hljs-string">""</span></span>))+ggtitle(<span class="hljs-string"><span class="hljs-string">"Gmail"</span></span>) pyandex &lt;- ggplot(data=yandex, aes(x=pass_length)) + scale_x_discrete(limits=seq(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), breaks=seq(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), drop=TRUE) + geom_histogram(colour=<span class="hljs-string"><span class="hljs-string">"black"</span></span>, fill=yandexcolor, aes(y=..density..)) + coord_cartesian(xlim=c(<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">21.5</span></span>)) + xlab(expression(<span class="hljs-string"><span class="hljs-string">" "</span></span>))+ ylab(expression(<span class="hljs-string"><span class="hljs-string">""</span></span>))+ggtitle(<span class="hljs-string"><span class="hljs-string">"Yandex"</span></span>) pmailru &lt;- ggplot(data=mailru, aes(x=pass_length)) + scale_x_discrete(limits=seq(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), breaks=seq(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), drop=TRUE) + geom_histogram(colour=<span class="hljs-string"><span class="hljs-string">"black"</span></span>, fill=mailrucolor, aes(y=..density..)) + coord_cartesian(xlim=c(<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">20.5</span></span>)) + xlab(expression(<span class="hljs-string"><span class="hljs-string">" "</span></span>))+ ylab(expression(<span class="hljs-string"><span class="hljs-string">""</span></span>))+ggtitle(<span class="hljs-string"><span class="hljs-string">"Mail.ru"</span></span>) multiplot(pgmail, pyandex, pmailru, cols=<span class="hljs-number"><span class="hljs-number">3</span></span>) print(<span class="hljs-string"><span class="hljs-string">"computing strength of the passwords"</span></span>) yandex$strength &lt;- sapply(yandex$password, strength) mailru$strength &lt;- sapply(mailru$password, strength) gmail$strength &lt;- sapply(gmail$password, strength) print(head(yandex)) print(head(mailru)) print(head(gmail)) scale &lt;- scale_x_discrete(limits=c(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>), breaks=c(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>), drop=TRUE, labels=c(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"\n"</span></span>)) pgmail &lt;- ggplot(data=gmail , aes(<span class="hljs-built_in"><span class="hljs-built_in">factor</span></span>(strength))) + geom_bar(colour=<span class="hljs-string"><span class="hljs-string">"black"</span></span>, fill=gmailcolor) + xlab(expression(<span class="hljs-string"><span class="hljs-string">""</span></span>))+ coord + ylab(expression(<span class="hljs-string"><span class="hljs-string">""</span></span>))+ggtitle(<span class="hljs-string"><span class="hljs-string">"Gmail"</span></span>) + scale pyandex &lt;- ggplot(data=yandex, aes(<span class="hljs-built_in"><span class="hljs-built_in">factor</span></span>(strength))) + geom_bar(colour=<span class="hljs-string"><span class="hljs-string">"black"</span></span>, fill=yandexcolor, binwidth=<span class="hljs-number"><span class="hljs-number">0.5</span></span>) + xlab(expression(<span class="hljs-string"><span class="hljs-string">""</span></span>))+ coord + ylab(expression(<span class="hljs-string"><span class="hljs-string">""</span></span>))+ggtitle(<span class="hljs-string"><span class="hljs-string">"Yandex"</span></span>) + scale pmailru &lt;- ggplot(data=mailru, aes(<span class="hljs-built_in"><span class="hljs-built_in">factor</span></span>(strength))) + geom_bar(colour=<span class="hljs-string"><span class="hljs-string">"black"</span></span>, fill=mailrucolor, binwidth=<span class="hljs-number"><span class="hljs-number">0.5</span></span>) + xlab(expression(<span class="hljs-string"><span class="hljs-string">""</span></span>))+ coord + ylab(expression(<span class="hljs-string"><span class="hljs-string">""</span></span>))+ggtitle(<span class="hljs-string"><span class="hljs-string">"Mail.ru"</span></span>) + scale multiplot(pgmail, pyandex, pmailru, cols=<span class="hljs-number"><span class="hljs-number">3</span></span>) print(<span class="hljs-string"><span class="hljs-string">"Zero strength passwords"</span></span>) print(<span class="hljs-string"><span class="hljs-string">"GMAIL"</span></span>) print(head(gmail[gmail$strength == <span class="hljs-number"><span class="hljs-number">0</span></span>,])) print(<span class="hljs-string"><span class="hljs-string">"YANDEX"</span></span>) print(head(yandex[yandex$strength == <span class="hljs-number"><span class="hljs-number">0</span></span>,])) print(<span class="hljs-string"><span class="hljs-string">"MAILRU"</span></span>) print(head(mailru[mailru$strength == <span class="hljs-number"><span class="hljs-number">0</span></span>,])) table_gmail &lt;- <span class="hljs-built_in"><span class="hljs-built_in">sort</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">table</span></span>(gmail$password) , TRUE) table_yandex &lt;- <span class="hljs-built_in"><span class="hljs-built_in">sort</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">table</span></span>(yandex$password), TRUE) table_mailru &lt;- <span class="hljs-built_in"><span class="hljs-built_in">sort</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">table</span></span>(mailru$password), TRUE) print(<span class="hljs-string"><span class="hljs-string">"gmail most frequent"</span></span>) print(head(table_gmail, <span class="hljs-number"><span class="hljs-number">100</span></span>)) print(<span class="hljs-string"><span class="hljs-string">"yandex most frequent"</span></span>) print(head(table_yandex,<span class="hljs-number"><span class="hljs-number">100</span></span>)) print(<span class="hljs-string"><span class="hljs-string">"mailru most frequent"</span></span>) print(head(table_mailru,<span class="hljs-number"><span class="hljs-number">100</span></span>)) only_pass_gmail &lt;- gmail[ ,<span class="hljs-number"><span class="hljs-number">2</span></span>] write.csv(only_pass_gmail, <span class="hljs-string"><span class="hljs-string">"only_pass_gmail"</span></span>, row.names = FALSE) only_pass_yandex &lt;- yandex[,<span class="hljs-number"><span class="hljs-number">2</span></span>] write.csv(only_pass_yandex, <span class="hljs-string"><span class="hljs-string">"only_pass_yandex"</span></span>, row.names = FALSE) only_pass_mailru &lt;- mailru[,<span class="hljs-number"><span class="hljs-number">2</span></span>] write.csv(only_pass_mailru, <span class="hljs-string"><span class="hljs-string">"only_pass_mailru"</span></span>, row.names = FALSE)</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Experiment code 'dictionary attack'</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash data=sample_mailru dict=saved_dict_mailru &gt; $dict j=0 while read p; do ((j++)) echo -n $j if grep -q "^$p$" dictionary/*; then echo " in " echo $p &gt;&gt; $dict else echo " out " fi if (("$j" &gt; 10000)); then break fi done &lt;$data</span></span></code> </pre><br></div></div><br><br><h4>  Conclusion </h4><a name="conclusions"></a><br>  Thus, it seems most likely that this sample is a compilation of various sources (phishing, infection, word-digging attacks, a collection of popular collections) for a long period of time.  A sufficient part of the data is in principle not valid passwords according to formal syntactic criteria, which was also confirmed by experimental verification. <br><br>  From the user's point of view, this event does not pose a significant danger and rather looks like an attempt to create an inflower. <br><br>  <b>UPD.</b>  Another evidence that merged data is a compilation of various sources is the presence of a collection of gmail accounts with "+" features in the database, when the address looks like name + domain \ word at gmail.com (for reminding me about this feature, thanks to <a href="http://habrahabr.ru/users/geka/" class="user_link">geka</a> ) <br>  Top 10 domains from the sample (the entire list <a href="http://pastebin.com/DRd0ZBLn">here</a> ) <br>  176 xtube <br>  132 daz <br>  88 filedropper <br>  66 daz3d <br>  64 eharmony <br>  63 friendster <br>  62 savage <br>  57 spam <br>  54 bioware <br>  52 savage2 <br>  ... <br>  11 <b>paygr</b> <br>  11 <b>comicbookdb</b> <br>  ... <br>  About paygr: user <a href="http://habrahabr.ru/users/gkond/" class="user_link">gkond</a> wrote that <br><blockquote>  Found your e-mail in dump.  The password that is listed next to it was automatically generated by the paygr.com service, back in May 2011. <br></blockquote><br>  at the same time, "paygr" occurs 11 times in the "+" list of gmail.  Perhaps their base has also been compromised. <br><br>  But the most important thing is that comicbookdb recognized that their base was really stolen along with the passwords (thanks to <a href="http://habrahabr.ru/users/entersandman/" class="user_link">EnterSandman</a> for the link): <a href="http://www.comicbookdb.com/hacked.php">www.comicbookdb.com/hacked.php</a> </div><p>Source: <a href="https://habr.com/ru/post/236759/">https://habr.com/ru/post/236759/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../236747/index.html">Thoughts on the virtual-real game (survey)</a></li>
<li><a href="../236749/index.html">The Hive: A Little War, A Deep Strategy, A Strange GameDev</a></li>
<li><a href="../236753/index.html">Flask Mega-Tutorial, Part 13: Date and Time</a></li>
<li><a href="../236755/index.html">Use of libraries in projects on Unity3D</a></li>
<li><a href="../236757/index.html">Overview of the most interesting materials on data analysis and machine learning ‚Ññ13 (September 8 - 14, 2014)</a></li>
<li><a href="../236761/index.html">Superiority Mask. About the magic of "Merlin" put in a word</a></li>
<li><a href="../236763/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ125 (September 8 - 14, 2014)</a></li>
<li><a href="../236769/index.html">The use of machine learning in trading. Part 2</a></li>
<li><a href="../236771/index.html">A couple of useful commands that can be useful with DDoS and not only</a></li>
<li><a href="../236773/index.html">Sun Service</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>