<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PyOOCalc - Library for generating reports, Libre / Open Office Calc accounts in Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sometimes tasks arise when it is necessary to generate reports and other documents. In my practice, this problem arose more than once. 

 Projects in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PyOOCalc - Library for generating reports, Libre / Open Office Calc accounts in Python</h1><div class="post__text post__text-html js-mediator-article">  Sometimes tasks arise when it is necessary to generate reports and other documents.  In my practice, this problem arose more than once. <br><br>  Projects in which this task arose: <br><br><ul><li>  inventory control </li><li>  property accounting </li><li>  document flow </li></ul><br>  My first experience was with MS Office, but later there was a need to develop cross-platform solutions, therefore, the choice fell on OpenOffice.  Since  in most cases it was necessary to form the tables, then OpenOffice Calc was chosen. <br><a name="habracut"></a><br>  At first I solved similar problems in C ++, developed a library that I used in different projects.  Everything was fine, but almost every minor version of the office required rebuilding the library, and not rarely editing the code.  At each distribution kit and its new version, at best, we had to rebuild the packages, edit the paths taking into account the office version, replace OpenOffice with LibreOffice, etc.  And this is very tiring and time consuming. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All these difficulties led to the search for simpler solutions.  I looked at the list of supported languages ‚Äã‚Äãand saw Python, which I was very interested in, because  already quite actively began to use it.  Found a simple example, tried it - it works.  Checked on different versions and - oh, a miracle!  Without the slightest edits, the same script works on different distributions and versions of the office. <br><br>  Those who have already encountered similar tasks know that picking the API is not a thankful business.  Therefore, the first thing I did was start looking for ready-made libraries.  The most interesting option for me was <a href="https://github.com/seznam/pyoo">PyOO</a> .  This library contains quite extensive functionality and is easy to use.  It implements functions from creating / saving documents to merging cells and creating charts.  But ... None of the libraries I found provided the functionality I needed.  A lot of tasty, but too much for me. <br><br>  Let's return to the initial task: it is necessary to generate reports and accounts.  As mentioned above, the easiest way to create templates is in an office suite.  After all, they will be able to create and end users without the participation of developers. <br><br>  With the creation of templates, everything is clear, but how to know where to insert the data.  You can use indexes (column, row) or name (for example: "E5"). <br><br>  And what if for one report you need to create several templates for generating a document.  For example, one template for a book layout, the second for a landscape.  But there is no guarantee that the same field (data) must be inserted by the same name (or index) of the cell in the same template and in the other.  And this means that you need to store data on the location of the fields in the template.  But there is a simpler, universal solution.  This task can be implemented through <b>NamedRange</b> . <br><br>  NamedRange is the name of a cell or area on a sheet.  At the same time NamedRange is unique in the frame of one book (document). <br><br>  Another necessary function for solving this problem is inserting strings.  In this case, the insertion should be taking into account the formatting of the string (font, merged cells, etc.). <br><br>  Based on the above tasks, a Python module was developed that implements the following functions: <br><br><ul><li>  Opening and creating documents </li><li>  Saving documents in different formats (supported by Libre / Open Office) </li><li>  Insert / delete sheets </li><li>  Insert lines with copy formatting </li><li>  Insert / Get Name Values ‚Äã‚Äã(NamedRange) </li><li>  Insert / get cell values ‚Äã‚Äãby name (index) </li></ul><br>  Usage example: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyoocalc <span class="hljs-comment"><span class="hljs-comment"># open document doc = pyoocalc.Document() file_name = os.getcwd() + "/example.ods" doc.open_document(file_name) # Get document fields fields = doc.fields() # Get field "HEADER" field = fields.field("HEADER") print ("Document header is: " + str(field.is_null())) # Set values field = fields.field("TABLE_NAME") field.set_value("Test table name") print ("New table name is: " + field.value()) # Insert 5 rows field1 = fields.field("FIELD_1") num_rows = 5 step = 2 if num_rows &gt; 0: field1.insert_rows(num_rows=num_rows-1, step=step, columns_to_copy=200) for i in range(1, num_rows + 1): field1.set_value("F1." + str(i), 0, i * step - (step - 1)) # Set value="value1" at column=1, row=1 (B1) sheet = doc.sheets().sheet(0) sheet.set_cell_value_by_index(1, 0, "value1") print (sheet.cell_value_by_index(1, 0))</span></span></code> </pre> <br>  I am sure that this task arose not only from me.  Glad if someone come in handy. <br><br>  An example of a document with these requirements and an example of using the library are in the examples directory. <br><br>  Download: <a href="https://github.com/thepurple/pyoocalc">PyOOCalc</a> </div><p>Source: <a href="https://habr.com/ru/post/273131/">https://habr.com/ru/post/273131/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273115/index.html">Selenium for Python. Chapter 6. Page Objects</a></li>
<li><a href="../273117/index.html">Data Festival in the Museum of Moscow, or how Big Data helps to live and work</a></li>
<li><a href="../273125/index.html">DB hacking or excursion into the world of DBMS</a></li>
<li><a href="../273127/index.html">Zoo communication protocols for GPS trackers (part 2)</a></li>
<li><a href="../273129/index.html">Export two or more directories from Bitrix to 1C on request</a></li>
<li><a href="../273135/index.html">The book "Inside Linux"</a></li>
<li><a href="../273137/index.html">Give up the peaceful atom? Rosenergoatom is building the most powerful data center in Russia</a></li>
<li><a href="../273139/index.html">Covering graphs in software testing, part 2</a></li>
<li><a href="../273141/index.html">My experience with wxWidgets</a></li>
<li><a href="../273143/index.html">DevCon Secrets # 1. Traditional DevCon in a new format</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>