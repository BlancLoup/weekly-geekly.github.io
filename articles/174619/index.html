<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Not another article about functional programming.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For several years now, functional programming has gained popularity. This, of course, does not mean that people abandon their old languages ‚Äã‚Äãand OOP ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Not another article about functional programming.</h1><div class="post__text post__text-html js-mediator-article">  For several years now, functional programming has gained popularity.  This, of course, does not mean that people abandon their old languages ‚Äã‚Äãand OOP and massively switch to Haskell, Lisp or Erlang.  Not.  The functional paradigm penetrates our code through loopholes of multi-paradigm languages, and the aforementioned languages ‚Äã‚Äãmore often serve as flags in this attack than are used directly. <br><br>  I was going to continue in the same vein and in the second part of the article to present <a href="http://github.com/Suor/funcy">my library</a> , adding a couple of functional tricks in python, but then I realized that the focus of my library is not on functional programming, but on practicality.  I will focus on this, I will give a few life examples of the usefulness of funcy. <br><a name="habracut"></a><br>  Development of funcy began with an attempt to put together a few utilities for manipulating data and less often functions, so most of my examples will focus on this.  Some (or many) examples may seem trivial, but it is surprising how much time these simple functions can save and how much more expressive they can make your code. <br><br>  I will go through several typical tasks that are encountered in the practice of drinking and, despite their simplicity, raise constant questions.  So let's go. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Easy data manipulation </h4><br>  1. Combine the list of lists.  Traditionally, I did it this way: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> operator <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> concat reduce(concat, list_of_lists) <span class="hljs-comment"><span class="hljs-comment">#  : sum(list_of_lists, []) #  : from itertools import chain list(chain.from_iterable(list_of_lists))</span></span></code> </pre> <br>  All of them are not bad, but they require either extra gestures: imports and additional calls, or impose restrictions: you can combine only lists with lists and tupl with tups, for the amount you still need to know in advance which type will come.  In funcy, this is done like this: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> funcy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cat cat(list_of_lists)</code> </pre><br>  <code>cat()</code> combines a list of lists, tuples, iterators, and indeed any iterated into one list.  If you want to combine lists of the results of a function call, you can use <code>mapcat()</code> , for example: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> funcy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mapcat mapcat(str.splitlines, bunch_of_texts)</code> </pre><br>  will sort all the lines in the texts into one flat list.  For both functions there are lazy versions: <code>icat()</code> and <code>imapcat()</code> . <br><br>  2. Add a few dictionaries.  In python, there are several clunky ways to combine dictionaries: <br><br><pre> <code class="python hljs">d1.update(d2) <span class="hljs-comment"><span class="hljs-comment">#  d1 dict(d1, **d2) #   &gt; 2  d = d1.copy() d.update(d2)</span></span></code> </pre><br>  I always wondered why they can not just lay down?  But we have what we have.  In any case, with funcy this is done easily: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> funcy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> merge, join merge(d1, d2) merge(d1, d2, d3) join(sequence_of_dicts)</code> </pre><br>  But <code>merge()</code> and <code>join()</code> can combine not only dictionaries, they work for almost any collections: dictionaries, ordered dictionaries, sets, lists, tuples, iterators, and even strings. <br><br>  3. Capturing a substring using a regular expression.  This is usually done like this: <br><br><pre> <code class="python hljs">m = re.search(some_re, s) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> m: actual_match = m.group() <span class="hljs-comment"><span class="hljs-comment">#  m.group(i),  m.groups() ...</span></span></code> </pre><br>  With funcy, it turns into: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> funcy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re_find actual_match = re_find(some_re, s)</code> </pre><br>  If this doesn't seem impressive enough, take a look at this: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> funcy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re_finder, re_all, partial, mapcat <span class="hljs-comment"><span class="hljs-comment">#      map(re_finder('\d+'), words) #  ini  (re_finder()      &gt; 1 ) dict(imap(re_finder('(\w+)=(\w+)'), ini.splitlines())) #     (    )      mapcat(partial(re_all, r'\d+'), bunch_of_strings)</span></span></code> </pre><br><h4>  A retreat about imports and practicality </h4><br>  As you can see, I import functions directly from funcy, without using any subpackages.  The reason I stopped at this interface is practical;  it would be pretty boring to require all users of my library to remember where you need to import walk () from funcy.colls or funcy.seqs, in addition, multi-line imports at the beginning of each file and without me there is someone to stuff. <br><br>  An additional advantage of this solution is the ability to simply write: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> funcy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> *</code> </pre><br>  And enjoy all the functional delights and convenience that brings funcy, no longer returning to the beginning of the file for the addition.  Well, now that you know where all the good is, I will no longer explicitly point out the imports from funcy.  We continue. <br><br><h4>  Some more functional things. </h4><br>  We have already seen a couple of examples of using higher order functions, <code>re_finder()</code> and <code>partial()</code> .  It should be added that the <code>re_finder()</code> function itself is a partial use of <code>re_find()</code> created for ease of use in <code>map()</code> and the like.  And naturally, with <code>filter()</code> it is convenient to use <code>re_tester()</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      is_private = re_tester('^_') filter(is_private, dir(some_obj))</span></span></code> </pre><br>  Great, we can set several predicates, such as <code>is_private()</code> , and filter object attributes by them: <br><br><pre> <code class="python hljs">is_special = re_tester(<span class="hljs-string"><span class="hljs-string">'^__.+__$'</span></span>) is_const = re_tester(<span class="hljs-string"><span class="hljs-string">'^[A-Z_]+$'</span></span>) filter(...)</code> </pre><br>  But, what if we want to get a list of public attributes or private constants, something involving a combination of predicates?  Easy: <br><br><pre> <code class="python hljs">is_public = complement(is_private) is_private_const = all_fn(is_private, is_const) either_const_or_public = any_fn(is_const, is_public)</code> </pre><br>  For convenience, there is also a function that complements <code>filter()</code> : <br><br><pre> <code class="python hljs">remove(is_private, ...) <span class="hljs-comment"><span class="hljs-comment">#  ,  filter(is_public)</span></span></code> </pre><br>  I hope everyone quenched their functional appetite, so it's time to move on to something less abstract. <br><br><h4>  Work with collections </h4><br>  In addition to tools for working with sequences, of <a href="http://funcy.readthedocs.org/en/latest/seqs.html">which there are many more</a> than I described here, funcy also helps to work with collections.  The basis is the <code>walk()</code> and <code>select()</code> functions, which are similar to <code>map()</code> and <code>filter()</code> , but retain the type of collection being processed: <br><br><pre> <code class="python hljs">walk(inc, {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>}) <span class="hljs-comment"><span class="hljs-comment"># -&gt; {2, 3, 4} walk(inc, (1, 2, 3)) # -&gt; (2, 3, 4) #        - swap = lambda (k, v): (v, k) walk(swap, {1: 10, 2: 20}) # -&gt; {10: 1, 20: 2} select(even, {1, 2, 3, 10, 20}) # -&gt; {2, 10, 20} select(lambda (k, v): k == v, {1: 1, 2: 3}) # -&gt; {1: 1}</span></span></code> </pre><br>  This pair of functions is supported by a set for working with dictionaries: <code>walk_keys(), walk_values(), select_keys(), select_values()</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       select_keys(is_public, instance.__dict__) #      select_values(bool, some_dict)</span></span></code> </pre><br>  The last example in this series will use several new functions at once: <code>silent()</code> - silences all exceptions thrown by the wrapped function, returning <code>None</code> ;  <code>compact()</code> - removes <code>None</code> values ‚Äã‚Äãfrom the collection;  <code>walk_values()</code> - bypasses the values ‚Äã‚Äãof the passed dictionary by constructing a new dictionary with the values ‚Äã‚Äãconverted by the passed function.  In general, this line selects a dictionary of integer parameters from the query parameters: <br><br><pre> <code class="python hljs">compact(walk_values(silent(int), request_dict))</code> </pre><br><h4>  Data manipulation </h4><br>  ABOUT!  We got to the most interesting, I included some of the examples here simply because they seem cool to me.  Although, to be honest, I did it above.  Now we will divide and group: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   URL   absolute, relative = split(re_tester(r'^http://'), urls) #     group_by(lambda post: post.category, posts)</span></span></code> </pre><br>  Collect flat data in nested structures: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       dict(partition(2, flat_list_of_pairs)) #     {id: (name, password) for id, name, password in partition(3, users)} # ,     assert all(prev + 1 == next for prev, next in partition(2, 1, versions)): #    for chunk in chunks(CHUNK_SIZE, lots_of_data): process(chunk)</span></span></code> </pre><br>  And a couple more examples, just to the heap: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     for line, prev in with_prev(text.splitlines()): if not prev: print ' ', print line #     1611  where(plays, author="Shakespeare", year=1611) # =&gt; [{"title": "Cymbeline", "author": "Shakespeare", "year": 1611}, # {"title": "The Tempest", "author": "Shakespeare", "year": 1611}]</span></span></code> </pre><br><br><h4>  Not just a library </h4><br>  Perhaps some of you have met familiar functions from Clojure and Underscore.js (by the way, the example of Shakespeare is brazenly torn from the documentation of the latter) - no wonder, I drew a lot of inspiration from these sources.  At the same time, I tried to follow the style of the library, preserve the consistency of the library and never sacrifice practicality, so not all functions fully correspond to their prototypes, they rather correspond to each other and the standard library. <br><br>  And one more thought.  We used to call programming languages ‚Äã‚Äãlanguages, and we rarely realize that syntactic constructs and standard functions are the words of these languages.  We can add our words by defining functions, but usually such words are too specific to fall into the everyday language dictionary.  Utilities from funcy, on the contrary, are sharpened for a wide range of applications, so this library can be perceived as an extension of python, as well as underscore or jQuery ‚Äî an extension of JavaScript.  So, everyone who wants to replenish their vocabulary is <a href="http://github.com/Suor/funcy">welcome</a> . </div><p>Source: <a href="https://habr.com/ru/post/174619/">https://habr.com/ru/post/174619/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../174605/index.html">Video reports are posted from the last Yandex conference on project management</a></li>
<li><a href="../174609/index.html">Modular robot snake at Carnegie Mellon University</a></li>
<li><a href="../174611/index.html">Bitcoin economy worth $ 1,000,000,000</a></li>
<li><a href="../174613/index.html">USB 2.0 issues in Windows 8 on motherboards with Intel 6 Series Chipset</a></li>
<li><a href="../174617/index.html">Recommendations for creating websites that are optimized for smartphones</a></li>
<li><a href="../174623/index.html">Google launched its own delivery service</a></li>
<li><a href="../174625/index.html">Facebook usability. Part 1: The Scale of Disaster</a></li>
<li><a href="../174627/index.html">Spherical panoramas of Mars and Curiosity</a></li>
<li><a href="../174629/index.html">Chrome has been updated to version 26</a></li>
<li><a href="../174631/index.html">A study of the statistics of search queries allows you to detect previously unknown side effects of drugs.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>