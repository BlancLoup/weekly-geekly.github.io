<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A day in the life of a new server: how we check and restore iron</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I want to talk a little about the inner kitchen of the Server Mall and how the servers are tested and restored. I will try to visually...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A day in the life of a new server: how we check and restore iron</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/6bc/200/704/6bc200704fa94d249fc234cc1bfc7894.jpg" alt="image alt text"></p><br><p>  In this article I want to talk a little about the inner kitchen of the Server Mall and how the servers are tested and restored.  I will try to visually show the difference between an ordinary "second-hand" server from <a href="https://habrahabr.ru/company/pc-administrator/blog/263283/">Refurbished</a> and talk about the process of turning a little "tired" iron into almost new. <a name="habracut"></a></p><br><p>  To study the marvelous inner world of the pre-sale department of Server Mall, I talked to one of the engineers who shared professional ingenuity and experience.  Andrei was working on the newly arrived <strong>IBM System X 3650 M4</strong> , so the tour turned out with a practical bias. </p><br><h1 id="dopustim-vy-reshili-prodat-server">  Let's say you decide to sell a server </h1><br><p>  This can be done not only by the organization, but also by an individual by <a href="https://servermall.ru/">contacting the Server Mall (SM) for an assessment</a> .  On Habr√© was already a detailed article on the process of buying, so I will tell you about what happens next. </p><br><p>  According to the information received during the telephone conversation, the specialists decide on the advisability of the purchase, usually positive.  Nevertheless, the acquisition of some second-generation ProLiant is unlikely to be useful, so the initial assessment of the prospects for iron is quite important.  If all is well, then a specially trained forwarder comes to the seller, conducts a visual inspection of the server, checks for obvious errors in the work and takes the hardware with him.  Purchase of servers is carried out by the company across all Russia. </p><br><p><img src="https://habrastorage.org/files/efc/1d7/5fb/efc1d75fb64f45599b77d0c49b008c91.jpg" alt="image alt text"></p><br><p>  Inspection allows you to roughly estimate the cost of server restoration: the same large chip on the case can easily be caused by a fall, with the subsequent occurrence of floating errors due to microcracks in the PCB textolite.  Servers do not drop at all often, but very accurately.  He himself witnessed the transportation of three DL380 cars in the trunk of a sedan, from which one of the glands was awkwardly removed.  Visually, the server just fell off his ear and hemped a corner, but at the start we received errors in the cooling system and periodic reloads. </p><br><p>  Even when viewed from the server include, look at the self-diagnosis indicators and console errors.  If nothing critical, then the transaction is made and the car is passed on to the authorities. </p><br><div class="spoiler">  <b class="spoiler_title">The entire sequence of checks described below appeared not from scratch - under the spoiler there is some information about MTBF and their extraction.</b> <div class="spoiler_text"><p>  Initially, our engineers asked about the time-to-failure statistics of the main nodes, so as not to struggle with what needs to be replaced.  The main indicator of reliability is <a href="https://en.wikipedia.org/wiki/Mean_time_between_failures">MTBF</a> (Mean Time Between Failures), that is, the time during which there will be no failures.  For each component, the figure is different, and official data on all components is not so easy to get. </p><br><p>  But for reference, you can use the reports of some OEM manufacturers, whose hardware is used in any brand server.  For example, with <a href="http://ark.intel.com/ru/products/66248/Intel-SSD-520-Series-120GB-2_5in-SATA-6Gbs-25nm-MLC">SSD intel 520</a> , MTBF is 1,200,000 hours.  Of course, this does not mean that the disc will work for 136 years, since this characteristic is statistical and is displayed when testing a large batch.  An indicator of AFR (Annual Failure Rate) derived from MTBF according to the formula AFR = 1-exp (-8760 / MTBF) is more convenient for understanding. </p><br><p>  For our example, the probability of failure of the SSD drive in the first year will be approximately 0.007, that is, 0.7%.  For a less accurate calculation, the formula 8760 / MTBF is used.  Quite a few articles have already been written on the calculation of this indicator, so that curious people can refer to the <a href="https://habrahabr.ru/company/nerepetitor/blog/255407/">published materials</a> . </p></div></div><br><h1 id="servernoe-to">  Server maintenance </h1><br><p>  All newly arrived servers go through a mandatory testing and cleaning cycle.  In addition, serious physical defects, such as bent mounting ears, are restored. </p><br><p>  Absolutely cosmetic things, like scratches on metal and scuffs, remain as it is.  By the way, the metal of the server systems is coated at the factory with a special antistatic lacquer, which is not so easy to restore.  The composition of the substance itself is not exactly known - almost as a seasoning in KFC - therefore we sacrifice aesthetics to protection against static. </p><br><p><img src="https://habrastorage.org/files/ca2/31a/f53/ca231af535664ad980b668a2b248d68c.jpg" alt="image alt text"></p><br><p>  If the so-called ‚Äúears‚Äù are damaged, for which the server is conveniently extended from the rack, they are usually changed to new ones.  In the case of HP plastic parts, they simply change to new ones, just like the power supply hinges.  Assembly slides are simply re-ordered.  With significant damage to the body itself (deep and complex dents, for example), it simply changes to a new assembly. </p><br><p>  Damage to IBM metal mounts for the entire experience of Server Mall engineers has never been met.  Apparently, the well-known "indestructibility" of the systems of this manufacturer manifests itself even in trifles. </p><br><div class="spoiler">  <b class="spoiler_title">By the way, the time between failures for the body is quite long.</b> <div class="spoiler_text"><p>  For example, here is an example of <a href="http://www.maxexpansion.com/sites/default/files/documents/MTBF%2520engineering%2520report%2520for%25201U%25202U%25203U%25203U%2520short%2520and%25204U%2520expansion%2520enclosures.pdf">one of the manufacturers MTBF</a> data: </p><br><ul><li>  The indicator of the case itself is 5 000 000 hours; </li><li>  Disk basket and IMPI-modules will work 700,000 hours; </li><li>  LEDs are designed for 2 000 000 hours. </li></ul><br></div></div><br><blockquote>  Once a request was made to sell a server that had been cooled by tobacco smoke for several years.  He just stood in the server, the air intake in which was made from a nearby smoking room.  The aromas of the products of burning tobacco-containing products were already felt on the way to the patient.  The model was relevant, so we decided to take a chance.  Have you ever washed an even layer of tobacco tar?  And the engineers at the Mall Mall were laundering - one even quit smoking.  True, the hardware was not sold for sale and was used for internal needs. </blockquote><p>  After the inspection, the engineer removes the case cover and starts the car to listen to the sound background of the fans, power supplies and disks.  Some coolers do not give out any errors in the diagnostic system, but their sound leaves no faith in the future future of the bearings.  Such coolers are simply changed to new ones.  The MTBF for Intel cooling systems is only <a href="http://www.intel.com/content/dam/support/us/en/documents/motherboards/server/sb/s3420gpmtbfcalculationrev10.pdf">100,000</a> hours, so replacing the fans with new ones is common. </p><br><p><img src="https://habrastorage.org/files/edb/62b/c2f/edb62bc2fac24f959de2898e9aae4bea.jpg" alt="image alt text"></p><br><p>  No less popular sound is the sound of the capacitors of the power system, which until recently glows green in monitoring.  In relatively <a href="https://servermall.ru/catalog/server-hp-dl360-gen9-2/">fresh servers</a> , power supplies with solid capacitors are used, but models with electrolytic cells are still relevant and therefore require careful diagnostics. </p><br><p>  Time between failures of modern power supplies can be 967 300 hours, according to <a href="http://www.intel.com/content/dam/support/us/en/documents/motherboards/server/sb/s1200rpcalculatedmtbfestimatesrev1_0.pdf">data from the OEM-manufacturer Intel</a> .  In the case of whistles and suspicions of malfunctions, the entire BP changes to a new one, because any work on soldering is not economically feasible and fraught for the future buyer. </p><br><h1 id="sveto-cifrovaya-diagnostika">  Light and digital diagnostics </h1><br><p>  Most modern servers are equipped with self-diagnostic systems.  These can be LED indicators on the front panel, individual modules with a list and status of all components, just a pointer to the presence of any error.  In any case, serious problems with the components are immediately visible. </p><br><div class="spoiler">  <b class="spoiler_title">A brief excursion into basic diagnostics on the example of IBM, HP and Dell solutions.</b> <div class="spoiler_text"><ul><li>  <strong>Option from IBM</strong> is called <a href="http://publib.boulder.ibm.com/infocenter/systemx/documentation/index.jsp%3Ftopic%3D/com.ibm.sysx.7944.doc/c_light_path_panel.html">Light Path</a> and is a sliding panel with indicators and explanations; </li></ul><br><p><img src="https://habrastorage.org/files/70f/3f1/f90/70f3f1f90a814963b43f9b04726e8611.jpg" alt="image alt text"></p><br><ul><li>  <strong>Dell</strong> in most servers uses an LCD panel for basic configuration and error display with a brief description; </li></ul><br><p><img src="https://habrastorage.org/files/c7f/015/fcf/c7f015fcf4df44d38804449ba01cd444.jpg" alt="image alt text"></p><br><p>  There are also simplified indicators: </p><br><p><img src="https://habrastorage.org/files/a29/37f/213/a2937f213bd14db394c5cee3cb050b71.jpg" alt="image alt text"></p><br><ul><li>  <strong>HPE</strong> offers <a href="http://h20564.www2.hpe.com/hpsc/doc/public/display%3FdocId%3Demr_na-c03245333">Systems Insight Display LED</a> self-test, the panel of which is similar to IBM. </li></ul><br><p><img src="https://habrastorage.org/files/be7/ce3/c18/be7ce3c18a824febad7bad13c410d25c.jpg" alt="image alt text"></p></div></div><br><p>  After a quick glance at the indicators, a long program check begins using standard diagnostic tools: </p><br><ul><li><p>  <a href="https://publib.boulder.ibm.com/infocenter/toolsctr/v1r0/index.jsp%3Ftopic%3D%252Fdsa%252Fdsa_t_running_diagnostics_tests_on_the_local_system.html">IBM Dynamic System Analysis</a> </p><br></li><li><p>  <a href="http://www.dell.com/support/article/us/en/04/SLN283546">Dell Hardware Diagnostics</a> </p><br></li><li>  <a href="http://h20565.www2.hpe.com/portal/site/hpsc/public/psi/home/%3Fcc%3Dus%26lang%3Den-us%26sp4ts.oid%3D460016%26ac.admitted%3D1476801850038.125225703.1851288163">HPE Insight Diagnostics</a> </li></ul><br><p>  All these programs are launched locally or using IMM, DRAC, iLO.  If the diagnostics is not "sewn" into the server's control controller, then simply boot from the manufacturer's diagnostic disk.  Full diagnostics take 2 to 3 hours and find most problems with memory, processor, diagnostic controller, fans, power supplies, and disk controllers.  Hard drives are not involved in the process, since the sale is almost always put new. </p><br><p>  Traditionally, the weakness of motherboards were electrolytic capacitors.  They swelled, overheated, exploded and led to complete inoperability.  At the maximum temperature, the MTTF of such elements was up to 8,000 hours, which is fraught with unscheduled repairs after a couple of years of operation.  Therefore, in modern server systems solid-state capacitors are used, which will be enough for several server "lives".  The total MTBF of the motherboard on the example of the Intel S1200V3RPM confirms this and amounts to 371,523 <a href="http://www.intel.com/content/dam/support/us/en/documents/motherboards/server/sb/s1200rpcalculatedmtbfestimatesrev1_0.pdf">hours</a> . </p><br><p><img src="https://habrastorage.org/files/061/5f5/e2e/0615f5e2e8cb4c7ea1b17037b7e7df90.jpg" alt="image alt text"></p><br><p> After a thoughtful check, the server is completely disassembled to the "bare case and components on the table" state, after which all components are thoroughly cleaned and rinsed with alcohol.  Alcohol does not harm the conductive paths, circuitry and lacquer of the motherboard, and therefore is widely used to give the boards a pristine appearance.  In order to avoid overhead costs and as a measure to combat alcoholism, isopropyl alcohol is used. </p><br><p><img src="https://habrastorage.org/files/a1b/db6/4ea/a1bdb64eace0437b91bd3c1cf6337378.jpg" alt="image alt text"></p><br><p>  Careful attention is paid to the motherboard connectors.  In particular, the engineer examines the processor socket on the subject of bent pins through a magnifying glass, because even one damaged leg can cause the most unpredictable consequences.  PCI slots and main memory slots are not ignored, network port links are checked.  As a "cherry on the cake," we change the BIOS battery, just in case. </p><br><p><img src="https://habrastorage.org/files/e48/09b/627/e4809b62757341bf983ddb8cbe7748ee.jpg" alt="image alt text"></p><br><p>  After bathing, the server is transferred to the warehouse, where bar codes for the internal warehouse base are read from all components.  Then the iron waits on the shelf of its buyer, along with the test logs and warranty sheet, which contains the serial numbers of all components. </p><br><h1 id="i-vot-prishel-zakaz-imenno-na-etot-server">  And then came the order for this server </h1><br><p>  It‚Äôs rare for a customer to choose the configuration "as is" and don‚Äôt want to add anything.  Therefore, the ordered iron is equipped with new disks, processors, power supplies of a certain power, memory and necessary controllers.  After that, the server is passed back to the testing engineers for a pre-sales check. </p><br><p>  The tools use built-in diagnostic software of the server manufacturer and a couple of utilities from an external disk.  Pre-sales inspection takes about ten hours and is conducted in stress mode: </p><br><ul><li>  Processors and memory work at their maximum capacity; </li><li>  Power supplies give up all the power, even if there are several; </li><li>  Under load, most defective hard drives are detected; </li><li>  The whole element base of the server works as it is unlikely to work in everyday use. </li></ul><br><p><img src="https://habrastorage.org/files/c01/9c9/604/c019c96043154ffd88f3e9452bcb033a.jpg" alt="image alt text"></p><br><p>  At this stage, by the way, "thin" defects of power supply units are detected.  So they are not limited to just checking for a whistle in Server Mall.  At the same stage, an unconditional replacement of a power supply unit with a new one is possible if the customer decided to purchase a server with one power supply unit, despite the prospects for using <a href="https://habrahabr.ru/company/pc-administrator/blog/310698/">fail-safe options</a> . </p><br><p>  New hard drives are not tested only when the customer asks for their reasons to send them unpacked. </p><br><p>  For a complete check of all network interfaces, the machine is loaded from an external disk in a specially prepared environment based on Windows 2012R2.  The server connects to the local network and the engineer sequentially starts copying one large file and many small ones.  If packet loss exceeds 1% - the network card must be diagnosed and replaced. </p><br><p>  With <a href="http://hcidesign.com/memtest/">Memtest,</a> memory is additionally tested on all systems except IBM.  The fact is that Memtest checks on IBM machines almost always find non-existent errors on one of the slots.  Such is the technical feature. </p><br><p><img src="https://habrastorage.org/files/315/912/b00/315912b0056648a28f1cb2dae7af7662.jpg" alt="image alt text"></p><br><p>  If any of the server components fail, all testing begins again, thus avoiding possible compatibility problems with the replaced components. </p><br><blockquote>  Once a curious problem with the RAID controller in the Dell server came up: all the tests were successful, but after rebooting the BIOS, the errors of the rather rare H710 controller began to show.  Because of the search for an equivalent replacement, the server had to be delayed by one day, which was compensated by replacing it with a more modern H330 adapter with twice the bandwidth. </blockquote><p>  Total for each server takes about 16 hours: </p><br><ul><li>  2 - 3 hours initial testing; </li><li>  3 hours for cleaning and bathing; </li><li>  10 hours takes pre-sales testing. </li></ul><br><p>  Complete with all the iron tested, the buyer receives a flash drive with a testing log, server instructions, useful links and an offline version of an article about common errors of this particular manufacturer. </p><br><p><img src="https://habrastorage.org/files/ba4/db6/85f/ba4db685f4aa4c438cf0a80ad2f8414d.jpg" alt="image alt text"></p><br><p>  Special mention deserves the preparation of the server to send.  The packaging is designed independently and, according to reviews, surpasses the quality of the original.  The server is sealed in a film with silica gel (moisture absorber), wrapped in foamed polyethylene, packed in durable cardboard and sent to the customer. </p><br><h1 id="vmesto-zaklyucheniya">  Instead of conclusion </h1><br><p>  Server Mall provides its own warranty for 3 years on the machines restored in the manner described above.  Moreover, the standard set of services includes both the replacement of failed components within a couple of days, and the complete replacement of the entire server in case of critical malfunctions.  You can learn more about warranty support and its differences from HP, IBM and Dell branded offers <a href="https://habrahabr.ru/company/pc-administrator/blog/308830/">in one of the past articles</a> . </p><br><p>  By the way, during the existence of the company, a complete replacement was required only once.  Gluck was not reproducible, and in the presence of Server Mall engineers everything worked like a clock.  Here it is, admin aura in action! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/313172/">https://habr.com/ru/post/313172/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../313162/index.html">Is there a lot to start up with big data and AI?</a></li>
<li><a href="../313164/index.html">Eight Tips for Beginning Usability</a></li>
<li><a href="../313166/index.html">In Q3 2016, cybercrime reached new heights.</a></li>
<li><a href="../313168/index.html">How MTS builds public Wi-Fi networks for business with user identification</a></li>
<li><a href="../313170/index.html">The best vacancies on My Circle for the week, October 3-9</a></li>
<li><a href="../313174/index.html">How to stop worrying about inefficient employees</a></li>
<li><a href="../313176/index.html">JS Programming Contest: Word Classifier (Special Prizes)</a></li>
<li><a href="../313178/index.html">Small HTML preprocessor</a></li>
<li><a href="../313180/index.html">Yii 2.0.10</a></li>
<li><a href="../313182/index.html">On the issue of style</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>