<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to safely store and use secret data in R</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Periodically, the question arises how it is possible to safely store the login and password in R, without setting this data explicitly in your script....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to safely store and use secret data in R</h1><div class="post__text post__text-html js-mediator-article">  Periodically, the question arises how it is possible to safely store the login and password in R, without setting this data explicitly in your script.  I think there are several possible solutions.  You can store your parameters: <br><ol><li>  Directly in the script. </li><li>  In the file inside the folder with the project that you do not show. </li><li>  In the .Rprofile file. </li><li>  In the .Renviron file. </li><li>  In json file. </li><li>  In a secure repository that you access from R. </li><li>  Using the digest package. </li><li>  Using the sodium package. </li><li>  Using the secure package. </li></ol><br>  Let's consider the main idea, the advantages (or disadvantages) of each of the approaches. <br>  <i>[From translator: ordered as utility increases.]</i> <br><a name="habracut"></a><br><h4>  Directly in the script </h4><br>  The first approach is to store your parameters directly in the script. <br><pre><code class="python hljs">id &lt;- <span class="hljs-string"><span class="hljs-string">"my login name"</span></span> pw &lt;- <span class="hljs-string"><span class="hljs-string">"my password"</span></span> call_service(id, pw, ...)</code> </pre> <br>  Despite the simplicity, no one seriously offers to do this because of an obvious drawback: you cannot show your code without showing these parameters either. <br><br><h4>  In the file inside the folder with the project that you do not show </h4><br>  The second option is almost as simple.  The idea is this: you put your parameters in a separate file inside the same folder with the project, for example, ‚Äúkeys.R‚Äù.  Then you can read the parameters using, say, <code>source()</code> .  Then we exclude "keys.R" from the version control system.  If you use git, you can add ‚Äúkeys.R‚Äù to the .gitignore settings. <br><br>  The disadvantage is that you can still accidentally show this file if you are not careful enough. <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># keys.R id &lt;- "my login name" pw &lt;- "my password" # script.R source("keys.R") call_service(id, pw, ...)</span></span></code> </pre><br><h4>  In the .Rprofile file </h4><br>  The third option is to store the parameters in one of the .Rprofile files.  This option is quite popular because: <br>  You can store data in another folder, i.e.  not in the project folder.  Therefore, it is less likely that you will accidentally open access to the file. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In .Rprofile you can write regular code in R. <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># ~/.Rprofile id &lt;- "my login name" pw &lt;- "my password" # script.R # id  pw     .Rprofile call_service(id, pw, ...)</span></span></code> </pre><br>  One of the drawbacks of defining the <code>"id"</code> and <code>"pw"</code> objects in .Rprofile is that they become part of the global environment.  Once they are there, they are easy to change from the script.  For example, using <code>rm()</code> to clean up the global environment will remove them. <br><br>  A slightly more flexible version of the same method - also use .Rprofile, but declare your parameters as environment variables.  <code>Sys.setenv()</code> can be used to set environment variables, <code>Sys.setenv()</code> can be used to read. <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># ~/.Rprofile Sys.setenv(id = "my login name") Sys.setenv(pw = "my password") # script.R # id  pw     .Rprofile call_service(id = Sys.getenv("id"), pw = Sys.getenv("pw"), ...)</span></span></code> </pre><br><h4>  In the .Renviron file </h4><br>  R also has a mechanism for defining environment variables in a special external file, .Renviron.  Working with .Renviron is similar to .Rprofile.  The main difference is that variables can be set directly in .Renviron, without using <code>Sys.setenv()</code> . <br><br>  Environment variables are language independent. <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># ~/.Renviron id = "my login name" pw = "my password" # script.R # id  pw     .Renviron call_service(id = Sys.getenv("id"), pw = Sys.getenv("pw"), ...)</span></span></code> </pre><br><h4>  Json or yaml file </h4><br>  The json format is mainly used for interaction via web services.  Therefore, most modern languages ‚Äã‚Äãeasily interpret json files.  The same applies to yaml files.  If you want to store parameters in a format that other languages ‚Äã‚Äãcan understand, such as Python, json can be a good solution. <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># keys.json { "id":["my login name"], "pw":["my password"] } # script.R library(jsonlite) call_service(id = fromJSON("keys.json")$id, pw = fromJSON("keys.json")$pw, ...)</span></span></code> </pre><br><h4>  In a secure repository that you access from R </h4><br>  One big disadvantage of all previous approaches is that in all cases the parameters are stored in unencrypted form somewhere on the disk.  Perhaps you are using some kind of tool like <a href="https://en.wikipedia.org/wiki/Keychain_(software)">keychain</a> or <a href="https://en.wikipedia.org/wiki/LastPass">LastPass</a> . <br><br>  For storage, you can use an <a href="https://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B4%25D0%25B8%25D1%2581%25D0%25BA%25D0%25B0">encrypted disk</a> .  Once it is mounted, you can work with its contents as with plain text.  Those.  From the point of view of user R, secret data is simply stored as ‚Äúplain text‚Äù somewhere on an encrypted disk. <br><br><h4>  Using the digest package </h4><br>  Another alternative is to use the <a href="https://cran.rstudio.com/web/packages/digest/index.html">digest</a> package, which is supported by Dirk Eddelb√ºttel.  Stefan Doyen proposed this solution: <br><ol><li>  I use the digest package with AES encryption implemented. </li><li>  I use two functions: one writes files encrypted with AES, the second reads and decrypts these files.  These functions are on <a href="https://github.com/sdoyen/r_password_crypt">github</a> . </li><li>  Then I use the digest package to generate a key to decrypt and encrypt files. </li><li>  Once all this is ready, I create a data block (dataframe) with a login and password. </li><li>  I use the <code>write.aes()</code> function to write a parameter locally to an encrypted file. </li><li>  <code>read.aes()</code> allows you to decrypt parameters and import them into R. </li></ol><br>  Thus, secret data does not appear explicitly or in code.  This gives an additional opportunity to store the parameters somewhere else (remote server, usb disk, etc.).  Also this solution does not require entering a password every time. <br><br>  Stefan offers this code to illustrate: <br><pre> <code class="python hljs">source(<span class="hljs-string"><span class="hljs-string">"crypt.R"</span></span>) load(<span class="hljs-string"><span class="hljs-string">"key.RData"</span></span>) credentials &lt;- data.frame(login = <span class="hljs-string"><span class="hljs-string">"foo"</span></span>, password = <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, stringsAsFactors = FALSE) write.aes(df = credentials, filename = <span class="hljs-string"><span class="hljs-string">"credentials.txt"</span></span>,key = key) rm(credentials) credentials &lt;- read.aes(filename = <span class="hljs-string"><span class="hljs-string">"credentials.txt"</span></span>,key = key) print(credentials)</code> </pre><br><h4>  Using the sodium package </h4><br>  Another option is to use the <a href="https://cran.r-project.org/web/packages/sodium/index.html">sodium</a> package created by Yerun Oms.  The sodium package is an R wrapper for the <a href="https://download.libsodium.org/doc/">libsodium</a> cryptographic library. <br><br>  <i>Libsodium wrapper: a modern, easy-to-use library for encrypting, decrypting, signing, password hashing, etc.</i>  <i>Sodium uses curve25519, the newest Diffie-Hellman function from Daniel Bernstein, which became very popular after the Dual EC DRBG vulnerability was discovered in the NSA.</i> <br><br>  This means that sodium can be used to set up secure communications, including using asymmetric keys, directly from R. To use sodium to encrypt your data, use the approach described above for digest. <br><br><h4>  Using the secure package </h4><br>  Finally, the last option is to use the <a href="https://github.com/hadley/secure">secure</a> package written by Headley Wickham.  From the package description: <br><br>  <i>The secure package provides secure storage in a publicly accessible repository.</i>  <i>This allows you to store secret data in a public repository, so that they are accessible only to selected users.</i>  <i>This is especially useful for testing, because using the package, you can store personal data in a public repository, not showing them to the world.</i> <i><br><br></i>  <i>Secure is built on the basis of asymmetric encryption (with public and private keys).</i>  <i>Secure generates a random master key and uses it to encrypt (AES256) each file in <code>vault/</code> .</i>  <i>The master key is not stored anywhere in the unencrypted form; instead, for each user there is a copy encrypted with his public key.</i>  <i>Each user can decrypt the master key using his private key, and then use it to decrypt each file.</i> <br><br>  In order to understand how this works, you may need a whole study.  But in general, the idea is this: <br><ul><li>  Secret data is stored in the repository using the key consisting of the public keys of all people whom you want to give the right to decrypt. </li><li>  You can use the public key available to every user on github. </li><li>  You can also use the Travis public key if continuous integration is used. </li></ul><br>  Headley provides step-by-step instructions on how to use the package in his <a href="https://github.com/hadley/secure">github repository</a> . </div><p>Source: <a href="https://habr.com/ru/post/275757/">https://habr.com/ru/post/275757/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275745/index.html">Transponder DST40: principle of operation, the history of the appearance and hacking, as well as some practice on brute force</a></li>
<li><a href="../275747/index.html">How to transfer a site from Google Sites to your hosting</a></li>
<li><a href="../275749/index.html">Mission: Impossible: geolocation on Android without battery drain</a></li>
<li><a href="../275751/index.html">Centos 7.x USB Install Media (Add Centos to Multiboot)</a></li>
<li><a href="../275755/index.html">Query Processing in Oracle and PostgreSQL: Implications of a Single Solution</a></li>
<li><a href="../275759/index.html">Highly accurate coordinates (+ -2cm) for virtual reality, kopter and robots</a></li>
<li><a href="../275761/index.html">Script automatic update DDNS for No-IP</a></li>
<li><a href="../275765/index.html">Considering difference schemes in Mathcad Express</a></li>
<li><a href="../275767/index.html">Own browser - the way the mouse: Theory</a></li>
<li><a href="../275769/index.html">Work with geolocation in iOS 24/7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>