<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A simple exploit gives attackers the opportunity to change the contents of the letter after sending</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Do you think that the contents of an email cannot be changed after delivery? If you are interested in the issue of information security, you should le...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A simple exploit gives attackers the opportunity to change the contents of the letter after sending</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/cloud4y/blog/336296/"><img src="https://habrastorage.org/web/b71/fac/a0e/b71faca0e4564b43b918f9b3b9367a46.png"></a> <br><br>  Do you think that the contents of an email cannot be changed after delivery?  If you are interested in the issue of information security, you should learn about the method of attack, which the researchers from Mimecast called ROPEMAKER. <br><br>  The acronym ROPEMAKER stands for ‚ÄúRemotely Originated Post Delivery Email <br>  Manipulation Attacks Keeping Email Risky. ‚Äù  In fact, ROPEMAKER is a type of hacker attack via email, discovered by Francisco Ribeiro (@blackthorne) from Mimecast.  This exploit can give an attacker the ability to remotely change the content of an email at any time after delivery.  Is ROPEMAKER a vulnerability that needs to be fixed to protect normal users?  We hope that this article will help answer this question. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      By origin, ROPEMAKER lies at the intersection of email and web technologies such as HTML and CSS.  Although the use of these web technologies made email visually more attractive and dynamic compared to its predecessor based solely on text, it also led to the emergence of a new attack vector for email.  People usually expect web content to be dynamic and can change instantly, but do not expect it from emails.  Thus, ROPEMAKER is another potential attack vector that can be used by attackers to spread, for example, ransomware viruses. <br><br>  Fundamentally, ROPEMAKER exists, because two resources that are located remotely from each other, but connected through a network, can interact in such a way that one of them will affect the performance of the other.  When using web content, deleted data can be retrieved without direct control of the local user.  With appropriate security settings, this happens automatically, and in most cases, is the expected and desired functionality by the user.  A great example is the use of remote style sheets (CSS). <br><br>  CSS is the cornerstone technology used by most websites to create visually appealing web pages.  ROPEMAKER uses the fact that CSS allows us to separate the appearance design and the content itself.  It is important to note that with certain security settings, many email clients can use the CSS file locally or remotely via the network.  And, of course, the key to this exploit from a security point of view is that some of the elements of the system used are in an unreliable zone.  And instead of controlling only the appearance of the email, the removed CSS can actually change the content of the letter. <br><br><h3>  How can attackers use ROPEMAKER in cyber attacks? </h3><br>  Imagine that a cyber-criminal with malicious intent sends an HTML-based HTML email with a CSS located on a remote server to his intended victim.  ROPEMAKER will work as long as the email client automatically connects to the remote server to get the desired ‚Äústyle‚Äù for the letter. <br><br>  For example, an attacker could replace the mapping of a ‚Äúgood‚Äù URL to a ‚Äúbad‚Äù URL by modifying the removed CSS code.  It can also turn the text into a ‚Äúbad‚Äù URL or change the content of the delivered letter, which will affect the meaning of the transaction by replacing ‚Äúyes‚Äù with ‚Äúno‚Äù or ‚Äú1 dollar‚Äù by ‚Äú1 million dollars‚Äù. <br><br><h3>  Switch exploit </h3><br>  In the first example, which the researchers called ‚ÄúSwitch‚Äù, the good URL in the letter later ‚Äúswitches‚Äù to the attacker in the same message to the bad URL.  Everything looks good in Figure 1. But by editing the removed CSS, the letter gets a new ‚Äústyle‚Äù (Figure 2). <br><br><img src="https://habrastorage.org/web/239/9bc/039/2399bc0399e2416aa71da5ef864b64b0.jpg" width="500"><br>  <i>Picture 1</i> <br><br><img src="https://habrastorage.org/web/d97/353/57e/d9735357eaa64b9dbbfb33a01d66d2ec.jpg" width="500"><br>  <i>Figure 2</i> <br><br><img src="https://habrastorage.org/web/90a/f0c/f56/90af0cf56e2f4f89ab7138d09c16e25b.png" width="300"><br>  <i>Removed CSS code that switches the style to display the ‚Äúbad‚Äù URL in this example.</i> <br><br><img src="https://habrastorage.org/web/e29/99f/be7/e2999fbe75c24be1b524f1dda8d2e795.png" width="600"><br>  <i>HTML-letter with a remote CSS call.</i> <br><br>  Both URLs are sent in the original email and, therefore, the solution to the problem is to check the ‚ÄúGood‚Äù and ‚ÄúBad‚Äù URLs before the user is allowed to follow them.  Organizations that do not use blocking malicious URLs by security systems will be subject to similar threats. <br><br><h3>  Matrix Exploit </h3><br>  "Matrix Exploit" is more sophisticated.  Inside the email there is a matrix of all ASCII characters for each letter.  Using the CSS mapping rules, an attacker can selectively change the visibility of each letter and, thus, recreate the desired text in the letter at any time.  For example, an attack can begin by displaying an empty letter, as shown in Figure 5. And with relatively simple manipulations in a remote CSS file, you can change the content.  As a result, the user will see what is shown in Figure 6. <br><br><img src="https://habrastorage.org/web/3b7/be7/c2e/3b7be7c2eb1b422da46958409eb39bb5.png" width="500"><br>  <i>Figure 5</i> <br><br><img src="https://habrastorage.org/web/b40/493/d8b/b40493d8b53648da8ec2cd1c56983313.png" width="500"><br>  <i>Figure 6</i> <br><br>  Matrix Exploit is more dangerous because the letter itself in this case is just text without any URLs or other content that can be found during delivery (although a relatively large number of HTML tags and message size can serve as a signal).  However, as soon as the removed CSS is used to selectively display text and URLs, the email client will show a clickable link (for example, Apple Mail), or at least it will contain text with a URL address.  Thus, a gullible user can easily copy it and use it in a browser. <br><br>  Microsoft <a href="https://cloud4y.ru/cloud-services/corporate-mail/">Outlook</a> , for example, can be configured to alert you before automatically downloading external resources.  But how many users simply reject the warning or disable the setting?  From the user's point of view, if a part of the letter looks good, why not get the rest of the message? <br><br>  Since the URL is displayed after delivery, the email security gateway cannot find and check the malicious url, because it is not available at the time of delivery.  This will require the interpretation of CSS files, and this goes beyond the functionality of existing email security systems. <br><br><img src="https://habrastorage.org/web/398/e76/749/398e76749d5941d08129981530932d28.png"><br>  <i>How is the change in the displayed text when using Matrix Exploit.</i> <br><br>  It is important to note that the code block as in the figure above represents the ability to display only one position in the matrix of displayed characters and, therefore, it must be repeated for all positions in the intended letter.  Thus, a relatively large letter is required to display a relatively short message. <br><br><h3>  ROPEMAKER Disclosure </h3><br>  At the end of 2016, Mimecast notified the main suppliers of email clients, in particular, Apple and Microsoft. <br><br>  Most recently, Mimecast received a response from Apple: <br><blockquote>  Users can disable remote content loading by going to the Mail&gt; Preferences&gt; Viewing and unchecking ‚ÄúLoad remote content in messages‚Äù menu. </blockquote>  The solution is provided at the user level and is thus under its control, which adds risks.  Do users really understand the potential threats to information security?  In addition, iOS does not have the same feature in the settings.  The only answer from Microsoft described ROPEMAKER as ‚Äúnot a vulnerability‚Äù.  What is your opinion? </div><p>Source: <a href="https://habr.com/ru/post/336296/">https://habr.com/ru/post/336296/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../336286/index.html">Reed-Solomon codes. Part 1 - the theory of simple language</a></li>
<li><a href="../336288/index.html">What is known about the possible IPO Dropbox: rumors, difficulties and numbers</a></li>
<li><a href="../336290/index.html">How to scratch a panda</a></li>
<li><a href="../336292/index.html">Not all CT pancake week, or CT does not walk by itself</a></li>
<li><a href="../336294/index.html">Understanding the V8 bytecode</a></li>
<li><a href="../336298/index.html">Check Point SMB Solutions. New models for small companies and branches</a></li>
<li><a href="../336300/index.html">KOMPAS-3D viewer for Android: the experience of porting a large Windows application</a></li>
<li><a href="../336302/index.html">Analysis of MS SQL Server, for those who see it for the first time</a></li>
<li><a href="../336304/index.html">How to overcome common graphics artifacts</a></li>
<li><a href="../336306/index.html">Explore and optimize Object # toString performance in ES2015</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>