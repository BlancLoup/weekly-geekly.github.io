<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>White-box cryptography in pictures</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! 

 You always wanted to know about the principles of public key encryption, but were afraid to ask? Not? Anyway, the article is interesting ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>White-box cryptography in pictures</h1><div class="post__text post__text-html js-mediator-article">  Good day! <br><br>  You always wanted to know about the principles of public key encryption, but were afraid to ask?  Not?  Anyway, the article is interesting (and even understandable), and in the end lies a toy based on the material studied. <br>  So, the theme is public key encryption, or rather, White-Box Encrypting.  The difference is that the ‚Äúbox‚Äù instead of the usual encryption function has a certain program in which this function is hidden.  But I will tell about it later, but first ... <br><img src="https://habrastorage.org/getpro/habr/post_images/4d0/c30/fd7/4d0c30fd76a764891deec5c8fec5973d.jpg"><br><a name="habracut"></a><br><h2>  Description </h2><br>  What is encryption, I believe, many understand at least intuitively, but what is the public key and why is it needed?  Where is it used?  How good is its crypt endurance? <br><div class="spoiler">  <b class="spoiler_title">Crypt resistance</b> <div class="spoiler_text">  the ability of the algorithm to resist hacking without a hot soldering iron. </div></div><br><h4>  Consider this task: </h4><br><h5>  Given: </h5><br><ul><li>  Secret message; </li><li>  Man # 1, let's call him Alena; </li><li>  Person # 2 - Lesha; </li><li>  Unprotected communication channel. </li></ul><br><h5>  Task: </h5><br>  Alyona needs to send a secret message with a technical task Lesha through this channel. <br><br><h5>  Decision: </h5><br>  Lyosha cannot work without a clear technical task, so he writes a public-key encryption algorithm consisting of two elements ‚Äî the encryption algorithm itself (open) and the decryption algorithm (private).  He sends the first algorithm to Alena, and the second leaves to himself - that‚Äôs why he‚Äôs closed. <br><img src="https://habrastorage.org/getpro/habr/post_images/316/1e5/c03/3161e5c03adfd7eaf7db7bde4704bc86.png"><br>  Alena happily receives the algorithm, applies the message, receives encrypted data, which she sends to our hero.  The latter, in turn, applies its decryption algorithm to this data, receiving the original secret message.  Everyone is happy - the project will be completed on time. <br><img src="https://habrastorage.org/getpro/habr/post_images/0b0/9b0/207/0b09b02078bfee86d133d3699d64c60f.png"><br>  Let everything not be so rosy - the attacker intercepted the transfer.  This is a problem - having an encryption algorithm and encrypted data, the villain will be able to recover the secret message, especially if the encryption function is specified explicitly. <br>  The solution was white-box encryption - instead of the public key, Lyosha sends Aliona a program in which this algorithm is hidden (obfuscated, complicated), so the attacker is unlikely to find this function.  It is much faster to find the original message in full brute force, and this is an NP class problem, so the larger the message and the more complex the algorithm, the more time it spends on it. <br><div class="spoiler">  <b class="spoiler_title">Proof</b> <div class="spoiler_text">  The table shows the estimated time for a complete brute force of passwords, depending on their length.  It is assumed that the password can use 36 different characters (Latin letters of one register + numbers), and the search speed is 100,000 passwords per second (attack class B, typical for recovering the password from the Windows Cache (.PWL files) to the Pentium 100).  <sub>Wikipedia</sub> <br><table><tbody><tr><th>  Number of characters </th><th>  Number of options </th><th>  Persistence </th><th>  Iteration time </th></tr><tr><td>  one </td><td>  36 </td><td>  5 bits </td><td>  less than a second </td></tr><tr><td>  2 </td><td>  1296 </td><td>  10 bits </td><td>  less than a second </td></tr><tr><td>  3 </td><td>  46,656 </td><td>  15 bits </td><td>  less than a second </td></tr><tr><td>  four </td><td>  1,679,616 </td><td>  21 bits </td><td>  17 seconds </td></tr><tr><td>  five </td><td>  60 466 176 </td><td>  26 bits </td><td>  10 minutes </td></tr><tr><td>  6 </td><td>  2 176 782 336 </td><td>  31 bits </td><td>  6 o'clock </td></tr><tr><td>  7 </td><td>  78 364 164 096 </td><td>  36 bits </td><td>  9 days </td></tr><tr><td>  eight </td><td>  2,821 109 9x10 <sup>12</sup> </td><td>  41 bits </td><td>  11 months </td></tr><tr><td>  9 </td><td>  1,015 599 5x10 <sup>14</sup> </td><td>  46 bits </td><td>  32 years </td></tr><tr><td>  ten </td><td>  3,656 158 4x10 <sup>15</sup> </td><td>  52 bits </td><td>  1 162 years </td></tr><tr><td>  eleven </td><td>  1,316 217 0x10 <sup>17</sup> </td><td>  58 bits </td><td>  41,823 years </td></tr><tr><td>  12 </td><td>  4,738 381 3x10 <sup>18</sup> </td><td>  62 bits </td><td>  1,505,615 years old </td></tr></tbody></table><br></div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/9bf/a21/000/9bfa210006d76e8703eed13b3f99b72c.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If Alena also can do magic, they can fully communicate with each other, while maintaining secrecy. <br><br><h2>  Pro toy </h2><br>  Consider the slot machines.  It is known that the probability of winning on these devices is extremely small, while nothing depends on a person at all.  Obviously, this is not fair.  So why not fix it? <br>  No sooner said than done.  Meet the representative of the class of fair gambling - ‚Äúhonest one-armed gangster‚Äù, the probability of winning in which equals 100%.  This probability was due to the fact that all the information that affects the successful outcome is in the game before the eyes. <br>  Why, you ask, a machine that does not bring benefits?  Everything is so simple - the approach is based on the theory of computational complexity (‚Äúcomplexity theory‚Äù - the name was taken from there), so a person, as already mentioned, simply needs to solve the NP problem (hello, brute force).  And so life does not seem like honey, the game goes on time. <br>  The game contains two methods of encryption of different complexity - hashing (many in one) and bijection (one in one).  The main goal of our game was to explain the principle of such encryption "on the fingers." <br>  The point is to recover (decrypt) the original data over the Z <sub>3</sub> ring (modulo-3 residue ring), having before your eyes only an encrypted message and an encryption algorithm. <br>  This algorithm is a set of nodes with transition tables - it has 2 inputs, whose values ‚Äã‚Äãare converted, generating an output value.  The algorithm was divided into nodes for a reason - this is obfuscation (complication), because it is much easier to choose an inverse function for the transformation function, which makes the whole NP problem losing its meaning.  The superposition of these nodes is the same encryption algorithm. <br><br><h2>  Maths </h2><br>  The algorithm for constructing a bijection is essentially simple: the composition of bijections is a bijection, so you only need to find a way to construct an elementary bijection.  Analytical geometry has come to our aid ‚Äî we are not ciphering the colors, but the coordinates of the vector.  Multiplying the transition matrix by a given vector, we get a new vector - encrypted, and in order to go from the received to the original vector, the transition matrix must be reversible - we build the inverse of the original, multiply by the encrypted message and get the original data.  Thus, it all comes down to building such a matrix. <br>  The hashing algorithm is even simpler: we build a bijection, and on each layer of nodes we remove a few pieces, continuing so until we get the number of nodes we need at the end.  The fact that this algorithm was once a bijection, guarantees us a uniform distribution, which reduces the number of collisions to a minimum. <br>  In this way: <br><ul><li>  The original message is the vector of values ‚Äã‚Äãabove the ring Z <sub>3</sub> (3 values ‚Äã‚Äãrepresented by different colors); </li><li>  The encryption algorithm is a matrix; </li><li>  Algorithm obfuscation - matrix sets with two inputs and one output; </li><li>  An encrypted message is a vector obtained by multiplying the original message by the matrix. </li></ul><br><br><h2>  Programming </h2><br>  The toy was made on Canvas, so you can play it from any device.  They wrote, of course, in JavaScript, PHP (to generate a graph), C ++ (to post it), and also used the KineticJS framework to make everything work faster (but they have some kind of dislike for Firefox, so it‚Äôs a bit slow) . <br><br><h2>  Conclusion </h2><br>  As promised, I share a <a href="http://zaic101.ru/complexity/">link to the toy</a> , which was made while working in the laboratory at the university. <br>  I hope it will quite clearly show that even the simplest mappings (such as hash 4-2) are quite complex to decrypt after obfuscation. <br>  All good.  : 3 <br><img src="https://habrastorage.org/getpro/habr/post_images/37a/152/fea/37a152fea6fcbd99a55505680dd3c579.png"></div><p>Source: <a href="https://habr.com/ru/post/171169/">https://habr.com/ru/post/171169/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../171157/index.html">Bitcoin exchange rate hit a record high.</a></li>
<li><a href="../171161/index.html">ASUS Vivobook S200E - an affordable laptop for solving serious problems</a></li>
<li><a href="../171163/index.html">Easy installation of Asterisk + FreePBX for beginners</a></li>
<li><a href="../171165/index.html">Canonical seriously thinking about abandoning semi-annual releases.</a></li>
<li><a href="../171167/index.html">Intellectual ideas that everyone should know</a></li>
<li><a href="../171171/index.html">"You must be crazy if you don't use the potential of Open Source." Gerhard Lausser on open source monitoring systems and enterprise solutions</a></li>
<li><a href="../171173/index.html">"Smart" queue size in android</a></li>
<li><a href="../171175/index.html">Integration design. Every pixel matters. Part 2</a></li>
<li><a href="../171177/index.html">DNSSEC in practice at the domain registrar</a></li>
<li><a href="../171181/index.html">New Zopfli algorithm improves zlib compression by 3-8%</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>