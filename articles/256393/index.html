<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to make Xamarin Studio a little better?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So, a year and a half has passed since I started developing mobile applications using Xamarin and C #. During this time, the guys from Xamarin have th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to make Xamarin Studio a little better?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/703/a94/5b1/703a945b13c34e2cad806f9c38e84429.png" alt="image"><br><br>  So, a year and a half has passed since I started developing mobile applications using Xamarin and C #.  During this time, the guys from Xamarin have thoroughly worked on their IDE, so from the bundle <a href="http://habrahabr.ru/post/224517/">iMac-Parallels Desktop-Visual Studio-Android,</a> I gladly refused in favor of iMac-Xamarin-Genymotion.  However, Xamarin Studio is still at the level where some actions have to be performed manually, but what if you have to do this 5, 10, 15 or more times a day?  The answer is simple - upgrade Xamarin Studio by writing an Add-in that will do all the work for you.  In this article I will tell you how to create a simple Add-in and where to go if you need something more serious. <br><a name="habracut"></a><br><h2>  Training </h2><br>  To create an add-in, you will need: <br><ul><li>  Xamarin Studio; </li><li>  Addin maker </li></ul><br>  The list is not long.  Addin maker is set as follows: <br><ol><li>  Open Xamarin Studio and go to the add-ons manager. <br><br><img src="https://habrastorage.org/files/d07/7bb/a74/d077bba748154d86a9d9598be3757c64.png" alt="image"><br></li><li>  In the Add-ons Manager, select the Gallery tab and drive into the Addin maker search box.  As soon as the manager finds an add-in, install it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/d6a/7ee/7f1/d6a7ee7f18a64d6abfeb99ce0034d3bc.png" alt="image"><br></li></ol><br><br>  If suddenly the add-ons manager did not find such an add-in, take it <a href="https://github.com/mhutch/MonoDevelop.AddinMaker">here</a> . <br>  After installing Addin Maker, restart Xamarin Studio.  Now everything is ready to start. <br><br><h2>  Goal of Add-in Created </h2><br>  The main and only purpose of the Add-in, the creation of which I will discuss, will be to delete the bin and obj folders in the main project directory by pressing one button.  Working with Xamarin Studio on a Mac, such an operation sometimes has to be done several times per hour, regardless of whether the project is debugging for Android or iOS. <br><br><h2>  Project creation </h2><br>  To create a project in Xamarin Studio, select New Solution&gt; C #&gt; Xamarin Studio&gt; Xamarin Studio Addin, enter the name and select the location: <br><br><img src="https://habrastorage.org/files/3d5/7a7/d85/3d57a7d8505c418bad4b5df8dd5913d9.png" alt="image"><br><br>  After creating a project, its structure should look like this: <br><br><img src="https://habrastorage.org/files/645/b61/e7f/645b61e7f4b54700aac13f6a783746b6.png" alt="image"><br><br>  AddinInfo and AssemblyInfo, as the name implies, carry information about the Add-in and assembly, respectively.  In Manifest.addin, the model of the created extension is described.  Therefore, open it and write the following lines: <br><br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExtensionModel</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Extension</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/MonoDevelop/Ide/Commands"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Command</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BinObjCleaner.BinObjCleanerCommands.DeleteBinObj"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">_label</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Delete bin/obj"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">_description</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Delete /bin and /obj folders in every solution project"</span></span></span><span class="hljs-tag">  </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">defaultHandler</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BinObjCleaner.DeleteBinObjHandler"</span></span></span><span class="hljs-tag"> /&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Extension</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Extension</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/MonoDevelop/Ide/MainMenu/Build"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CommandItem</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BinObjCleaner.BinObjCleanerCommands.DeleteBinObj"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Extension</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExtensionModel</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  And now in order.  Line: <br><br><pre> <code class="java hljs">&lt;Extension path = <span class="hljs-string"><span class="hljs-string">"/MonoDevelop/Ide/Commands"</span></span>&gt;</code> </pre><br>  She talks about which category the Add-in falls into.  Since we create a button, the category will be ‚ÄúCommands‚Äù, if they created a template for a file, then you would need to specify ‚ÄúFileTemplates‚Äù as a category (of course, it is not limited to two categories).  Go ahead. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Command</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BinObjCleaner.BinObjCleanerCommands.DeleteBinObj"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">_label</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Delete bin/obj"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">_description</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Delete /bin and /obj folders in every solution project"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">defaultHandler</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BinObjCleaner.DeleteBinObjHandler"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  Here is given: <br><ul><li>  The button's id is the path (with the namespace specified) to the enum with the button type, i.e.  {namespace}. {enum_name}. {enum_type_name}; </li><li>  label - the text to be displayed; </li><li>  description - a description of what the button can do; </li><li>  defaultHandler - specify the path to the class, which will contain the logic of the button,  {namespace}. {class_name}. </li></ul><br>  The following lines: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Extension</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/MonoDevelop/Ide/MainMenu/Build"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CommandItem</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BinObjCleaner.BinObjCleanerCommands.DeleteBinObj"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  Determine the location of the Add-in'a (in our case, the button) with a specific id in the IDE.  Ie, after launching Add-in, the button should be seen here: <br><br><img src="https://habrastorage.org/files/3f8/1fa/873/3f81fa8736014afb98bbee8f76f1d351.png" alt="image"><br><br>  We continue to move towards this goal.  You must now create an empty enum (Right-click on the project&gt; Add&gt; New file) <br><br><img src="https://habrastorage.org/files/1d9/522/0f7/1d95220f746a48a1a3256ba8452e1858.png" alt="image"><br><br>  And register in it: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">BinObjCleaner</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> BinObjCleanerCommands { DeleteBinObj } }</code> </pre><br>  We added this to the enum project for the following line of Manifest.addin: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Command</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">¬´BinObjCleaner.BinObjCleanerCommands.DeleteBinObj</span></span></span><span class="hljs-tag">"</span></span></code> </pre><br>  Next, create an empty class like enum: <br><br><img src="https://habrastorage.org/files/1d2/322/a07/1d2322a0780b4fa18adf44ab60e9d818.png" alt="image"><br><br>  Now we have added a class that was specified in Manifest.addin as a handler for the button: <br><br><pre> <code class="xml hljs">defaultHandler = "BinObjCleaner.DeleteBinObjHandler"</code> </pre><br>  We inherit it from CommandHandler'a and redefine two methods - Run and Update.  You should get the following: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MonoDevelop.Components.Commands; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MonoDevelop.Ide; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MonoDevelop.Core;  <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">BinObjCleaner</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DeleteBinObjHandler</span></span> : <span class="hljs-title"><span class="hljs-title">CommandHandler</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Run</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { }  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">CommandInfo info</span></span></span><span class="hljs-function">)</span></span> { } } }</code> </pre><br>  Overriding the Update method is necessary to control the visibility of a button, i.e.  if no solution is open, the button should not be shown, since then it is not clear which solution exactly needs to delete the bin and obj folders.  To do this, add one line to the Update method: <br><br><pre> <code class="cs hljs">info.Visible = IdeApp.Workspace.IsOpen;</code> </pre><br>  Overriding the Run method will contain all the logic involved in deleting the bin and obj folders.  This method is called after pressing the button.  Before deleting folders, you need to check whether the solution is running or whether its assembly has begun, and also that these operations are completed.  Add the following code to the Run method: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> projectOperation = IdeApp.ProjectOperations; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isBuild = projectOperation.IsBuilding (projectOperation.CurrentSelectedSolution); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isRun = projectOperation.IsRunning (projectOperation.CurrentSelectedSolution); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isBuild &amp;&amp; !isRun &amp;&amp; IdeApp.ProjectOperations.CurrentBuildOperation.IsCompleted &amp;&amp; IdeApp.ProjectOperations.CurrentRunOperation.IsCompleted) { }</code> </pre><br>  Thus, we will get a list of operations that can be performed on the solution, check whether the assembly of the solution has begun / completed, whether the launch of the solution has not been started / completed. <br>  After we have verified that deleting the bin and obj folders will not break anything, you need to get a list of projects included in the solution. To do this, inside the ifa, we add the following line: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> solutionItems = projectOperation.CurrentSelectedSolution.Items;</code> </pre><br>  Now that we know the list of projects in the solution, we just have to walk along the path to each project, adding ‚Äú/ bin‚Äù or ‚Äú/ obj‚Äù and deleting these folders, having previously checked their existence: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> solutionItems) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binPath = item.BaseDirectory.FullPath + <span class="hljs-string"><span class="hljs-string">"/bin"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (FileService.IsValidPath (binPath) &amp;&amp; FileService.IsDirectory (binPath)) FileService.DeleteDirectory (binPath);  <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> objPath = item.BaseDirectory.FullPath + <span class="hljs-string"><span class="hljs-string">"/obj"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (FileService.IsValidPath (objPath) &amp;&amp; FileService.IsDirectory (objPath)) FileService.DeleteDirectory (objPath); }</code> </pre><br>  As a result, DeleteBinObjHandler should look like this: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MonoDevelop.Components.Commands; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MonoDevelop.Ide; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MonoDevelop.Core; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">BinObjCleaner</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DeleteBinObjHandler</span></span> : <span class="hljs-title"><span class="hljs-title">CommandHandler</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Run</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> projectOperation = IdeApp.ProjectOperations; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isBuild = projectOperation.IsBuilding (projectOperation.CurrentSelectedSolution); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isRun = projectOperation.IsRunning (projectOperation.CurrentSelectedSolution);  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isBuild &amp;&amp; !isRun &amp;&amp; IdeApp.ProjectOperations.CurrentBuildOperation.IsCompleted &amp;&amp; IdeApp.ProjectOperations.CurrentRunOperation.IsCompleted) { IdeApp.Workbench.StatusBar.BeginProgress(<span class="hljs-string"><span class="hljs-string">"Deleting /bin and /obj folders"</span></span>);  <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> solutionItems = projectOperation.CurrentSelectedSolution.Items; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> solutionItems) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binPath = item.BaseDirectory.FullPath + <span class="hljs-string"><span class="hljs-string">"/bin"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (FileService.IsValidPath (binPath) &amp;&amp; FileService.IsDirectory (binPath)) FileService.DeleteDirectory (binPath);  <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> objPath = item.BaseDirectory.FullPath + <span class="hljs-string"><span class="hljs-string">"/obj"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (FileService.IsValidPath (objPath) &amp;&amp; FileService.IsDirectory (objPath)) FileService.DeleteDirectory (objPath); }  IdeApp.Workbench.StatusBar.EndProgress (); IdeApp.Workbench.StatusBar.ShowMessage (<span class="hljs-string"><span class="hljs-string">"Deleted successfully"</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">CommandInfo info</span></span></span><span class="hljs-function">)</span></span> { info.Visible = IdeApp.Workspace.IsOpen; } } }</code> </pre><br><br>  All that concerns the status of the IDE bar (IdeApp.Workbench.StatusBar) is needed to display a visual notification to the user that the removal process has begun or ended.  Looks like that: <br><br><img src="https://habrastorage.org/files/89e/f4e/d06/89ef4ed064dd464b86ec00168de75e42.png" alt="image"><br><br>  With this, with the creation of the project, you can collect the solution, package it in .mpack and publish it in the official repository or distribute it among your colleagues. <br><br><h2>  Add-in Publishing </h2><br>  If you, like me, create an Add-in for internal use, then it will be enough just to execute the command ‚Äúmdtool setup pack BinObjCleaner.dll‚Äù in the console: <br><br><img src="https://habrastorage.org/files/e42/c08/8ce/e42c088ce3e04c1699660b46cb34ffe7.png" alt="image"><br><br>  And distribute .mpack (if you collect from a Mac, you will find it in your home folder) among the needy.  Installation is done through the Add-ons Manager in Xamarin Studio using Install from File (Xamarin Studio&gt; Add-in Manager&gt; Install from file). <br>  If you decide to upload to the official repository, then I, unfortunately, can only help by <a href="http://monodevelop.com/developers/articles/publishing-an-addin/">reference</a> , since  No matter how hard I tried, I didn‚Äôt manage to break through the numerous assembly errors. <br><br><h2>  Where to go next?  Instead of conclusion </h2><br>  After writing a simple Add-in, when I realized the possibilities of expanding Xamarin Studio, I decided to write a solution template and project for internal development with additional logic, for example, with automatic registration of controllers when they were created (the most common mistake of our newbies is to forget to register the controller :-)).  The sources of this Add-in and Add-in, discussed in the article, can be found on the github <a href="https://github.com/pocheshire/BindingControllerRegistrator">here</a> and <a href="https://github.com/pocheshire/BinObjCleaner">here</a> . <br>  The following resources helped me a lot in writing both: <br><ul><li>  Base articles MonoDevelop <a href="http://www.monodevelop.com/developers/articles/">www.monodevelop.com/developers/articles</a> </li><li>  Description MonoDevelop API <a href="http://www.monodevelop.com/developers/articles/api-overview/">www.monodevelop.com/developers/articles/api-overview</a> </li><li>  Examples of add-ins on a githaba, for example, <a href="https://github.com/aBothe/Mono-D">github.com/aBothe/Mono-D</a> , contribute most to success. </li><li>  Add-in Creation Guide by Xamarin <a href="http://developer.xamarin.com/guides/cross-platform/getting_started/extending_xamarin_studio_with_addins/">developer.xamarin.com/guides/cross-platform/getting_started/extending_xamarin_studio_with_addins</a> </li></ul><br>  The possibilities of expanding Xamarin Studio are quite extensive and, perhaps, are limited only by your needs, so do not hesitate to simplify life for yourself and your colleagues. <br><br>  That's all, I hope the article will be useful to you.  Thanks for reading! </div><p>Source: <a href="https://habr.com/ru/post/256393/">https://habr.com/ru/post/256393/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../256381/index.html">RS analysis (analysis of the fractal structure of time series)</a></li>
<li><a href="../256383/index.html">Get a grant for network security training in the Netherlands</a></li>
<li><a href="../256385/index.html">How we taught iPhone football clubs to recognize</a></li>
<li><a href="../256387/index.html">Ionic Framework - working with the camera</a></li>
<li><a href="../256389/index.html">Scrum sprint simulation. We solve problems of interaction with the client and within the team.</a></li>
<li><a href="../256397/index.html">Transferring a project from iOS designers to developers</a></li>
<li><a href="../256401/index.html">Compare Visual Studio Community 2013 with Visual Studio 2013 Express. Features of the license agreement</a></li>
<li><a href="../256403/index.html">We unify the behavior of LINQ to IEnumerable and LINQ to IQueriable in terms of working with null values. Part two. Its implementation of IQueryProvider</a></li>
<li><a href="../256405/index.html">Interview with Serge</a></li>
<li><a href="../256407/index.html">Worm apples [WITHOUT JailBreak]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>