<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Symfony2 and KnockoutJS - Form Validation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few months ago, I began to learn the popular PHP framework Symfony2. Recently, I faced the task of checking the correctness of filling out a form on...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Symfony2 and KnockoutJS - Form Validation</h1><div class="post__text post__text-html js-mediator-article">  A few months ago, I began to learn the popular PHP framework Symfony2.  Recently, I faced the task of checking the correctness of filling out a form on the client side using the KnockoutJS library.  At the same time, the validation rules, in order not to duplicate the code, are preferably taken from the symfony entity class. <br>  There are over 10,000 plug-ins, libraries and bundles covering any one side of the problem.  I could not find a comprehensive solution.  Assessing the complexity of combining the two most popular solutions (Knockout-Validation and APYJsFormValidationBundle) for the first and second part of the problem, I decided to write everything from scratch.  Details under the cut. <br><a name="habracut"></a><br><h4>  Validation in symfony2 </h4>  In my case, the validation rules are specified in annotations.  For refreshment of memory I will provide the listing: <br><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Acme\UsersBundle\Entity\User */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JsonSerializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string $name . * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ORM</span></span></span><span class="hljs-comment">\Column(name="name", type="string", length=255, unique = true, nullable=false) * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Assert</span></span></span><span class="hljs-comment">\NotBlank(message=" ") * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Assert</span></span></span><span class="hljs-comment">\MinLength(limit=3, message="  ") * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Assert</span></span></span><span class="hljs-comment">\MaxLength(limit=15, message="  ") * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Assert</span></span></span><span class="hljs-comment">\Regex(pattern="/^[A-z0-9_-]+$/ui", match=true, message="   ") */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $name; <span class="hljs-comment"><span class="hljs-comment">// .... }</span></span></code> </pre> <br>  The first thing to do is parse these comments.  Of course, the framework itself already does this.  The results of the parsing are stored in the cache at the address "app / cache / <u>dev</u> / annotations /" or "app / cache / <u>prod</u> / annotations /", depending on the environment.  A little thought, I wrote a small method: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** *    . * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $bundle    "Bundle". * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $entity         . * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $env  ("dev"  "prod"). * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $namespace   (  "Acme"). * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> array . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readEntityAnnotations</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($bundle, $entity, $env = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'prod'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, $namespace = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'Acme'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ $result = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $files = glob($_SERVER[<span class="hljs-string"><span class="hljs-string">'DOCUMENT_ROOT'</span></span>] . <span class="hljs-string"><span class="hljs-string">'/../app/cache/'</span></span> . $env . <span class="hljs-string"><span class="hljs-string">'/annotations/'</span></span> . $namespace . <span class="hljs-string"><span class="hljs-string">'-'</span></span> . $bundle .<span class="hljs-string"><span class="hljs-string">'Bundle-Entity-'</span></span> . $bundle . $entity .<span class="hljs-string"><span class="hljs-string">'$*.php'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($files <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $path) { <span class="hljs-comment"><span class="hljs-comment">//        preg_match('/\\$(.*?)\\./', $path, $matches); //   foreach (include $path as $annotation) { //       if (get_parent_class($annotation) === 'Symfony\\Component\\Validator\\Constraint') { $type = preg_replace('/^.*\\\/', '', get_class($annotation)); $annotation = (array)$annotation; unset($annotation['charset']); $result[$matches[1]][$type] = (array)$annotation; } } } return $result; }</span></span></code> </pre><br>  Probably such a code is a bad example to follow, but it copes with its task.  I will rewrite it later. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a result, on the client, we can get something like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/b1e/752/20c/b1e75220c1948b5e3a550a1d5ad87009.png" alt="annotations"><br><br><h4>  Validation and KnockoutJS </h4>  After the validation rules are known, you can start writing client code.  The idea of ‚Äã‚Äãimplementation was borrowed from <a href="https://github.com/Knockout-Contrib/Knockout-Validation">Knockout Validation</a> .  I will give an example of setting validation rules in this plugin: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myComplexValue = ko.observable() myComplexValue.extend({ <span class="hljs-attr"><span class="hljs-attr">required</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }) .extend({ <span class="hljs-attr"><span class="hljs-attr">minLength</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }) .extend({ <span class="hljs-attr"><span class="hljs-attr">pattern</span></span>: { <span class="hljs-attr"><span class="hljs-attr">message</span></span>: <span class="hljs-string"><span class="hljs-string">'Hey this doesnt match my pattern'</span></span>, <span class="hljs-attr"><span class="hljs-attr">params</span></span>: <span class="hljs-string"><span class="hljs-string">'^[A-Z0-9].$'</span></span> }});</code> </pre><br>  That is, the essence of using <a href="http://knockoutjs.com/documentation/extenders.html">extenders</a> that appeared from the second Knockout branch.  Extenders allow you to change or supplement the behavior of any kind of observables.  Consider an example: <br><br> <code>var name = ko.observable('habrahabr').extend({MinLength: 42});</code> <br> <br>  When updating the observed <i>name</i> property, the knockout will try to find an <i>extender</i> with the name <i>MinLength</i> and, if successful, will call it.  As parameters, the observable property and the number 42 will be passed to the extender. <br><br>  Now we implement the extender itself: <br><br><pre> <code class="javascript hljs">ko.extenders.MinLength = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">observavle, params</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// .... };</span></span></code> </pre><br>  The idea is clear, let's move on to implementation.  Take for example the following model: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> AppViewModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     this.name = ko.observable(''); //   this.mail = ko.observable(''); // E-mail //   ko.validation.init(self, _ANNOTATIONS_); //    this.submit = function () { if (self.isValid()) { alert(' '); } else { alert('  '); } }; })();</span></span></code> </pre><br>  Except for ko.validation.init and self.isValid everything should be clear here.  ko.validation.init is a validator initialization function that takes as arguments a model and an object containing information about annotations obtained from symfony.  The isValid method will be added to the model when the validator is initialized. <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"value: name, valueUpdate: 'keyup'"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"visible: name.isError, text: name.message"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span>E-mail<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"value: mail, valueUpdate: 'keyup'"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"visible: mail.isError, text: mail.message"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"click: submit"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The isError and message properties are an error flag and an error message, respectively.  Both of these properties are observable and are added to the main property at the time of initialization. <br><br><pre> <code class="javascript hljs">AppViewModel.name.isError = ko.observable(); <span class="hljs-comment"><span class="hljs-comment">//    AppViewModel.name.message = ko.observable(); //    AppViewModel.name.typeError = ''; //   </span></span></code> </pre><br>  For the target audience of the post, this should not be a problem, but just in case I will explain: everything in JavaScript is an object, or rather, for each type there is an object wrapper.  Conversions occur automatically as needed.  The same is true for functions.  Therefore, nothing prevents us from adding several properties to the AppViewModel.name property, which is, in essence, a function. <br><br>  The form validation algorithm will look as follows: <br>  - do not do anything until the user tries to submit the form <br>  - after the first, unsuccessful due to not validity, sending we check the fields each time they are updated (keyup and change). <br><br>  Now I will give the code in its entirety, and then analyze it in detail: <br><br><pre> <code class="javascript hljs">ko.validation = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** *   . * @return {Boolean} */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isValid = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.validate(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      for (var opt in this) if (ko.isObservable(this[opt])) { //     if (this[opt].isError !== undefined &amp;&amp; this[opt].isError() === true) { return false; } } return true; }; return { /** *  . * @param {object} AppViewModel  . * @param {object} annotations   . */ init: function (AppViewModel, annotations) { var asserts, options; AppViewModel.validate = ko.observable(false); //        for (var field in annotations) if (annotations.hasOwnProperty(field)) { asserts = annotations[field]; //   (AppViewModel)        if (AppViewModel[field] !== undefined &amp;&amp; ko.isObservable(AppViewModel[field])) { AppViewModel[field].isError = ko.observable(); //    AppViewModel[field].message = ko.observable(); //    //      for (var i in asserts) if (asserts.hasOwnProperty(i)) { options = {}; options[i] = asserts[i]; //   options[i]['asserts'] = asserts; //    options[i]['AppViewModel'] = AppViewModel; //    //      AppViewModel[field].extend(options); } } } //      AppViewModel.isValid = isValid; }, /** *    . * @param name  . * @param validate  . * @param checkAsserts */ addAssert: function (name, validate, checkAsserts) { //  extender' ko.extenders[name] = function(target, option) { //     "AppViewModel.validate" ko.computed(function () { //          if (validate(target, option) === false &amp;&amp; option.AppViewModel.validate()) { checkAsserts = checkAsserts || new Function('t,o', 'return false'); //     if (checkAsserts(target, option) === false) { target.isError(true); //    target.message(option.message); //    target.typeError = name; //   } return; } //          if (target.isError.peek() === true &amp;&amp; target.typeError === name) { target.isError(false); } }); return target; }; } } })();</span></span></code> </pre><br>  Add a couple of validation methods right away: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// NotBlank ko.validation.addAssert('NotBlank', function (target, option) { return (target().length &gt; 0); }); // MaxLength ko.validation.addAssert('MaxLength', function (target, option) { return (target().length &lt;= option.limit); });</span></span></code> </pre><br><br><h4>  Common device </h4>  The code is organized in accordance with the design pattern called ‚ÄúModule‚Äù by Stefan Stoyanov in his book ‚ÄúJavascript Patterns‚Äù.  Those.  anonymous immediately called function, returns an object with two methods: init and addAssert.  Inside the closure, the isValid method is defined. <br><br><h5>  The isValid method.  Model validation </h5>  Checks the validity of the model.  The method is called in the context of the model, i.e.  this inside the isValid method is AppViewModel.  First, it sets the observed property of the validate model to true.  This signals an attempt to submit a form.  The validate property itself is added to the model during the initialization process using the init method. <br>  Further, the method runs over all observable properties of the model and checks their error flags. <br><br><h5>  Init method  Initialization Validation </h5>  First, the method adds to the model the above-mentioned observed property validate and the isValid method.  For that cycle it goes through the fields for which restrictions are indicated and for which there are observable properties of the same name, adding last in the model: isError and message.  The second nested loop bypasses the restrictions and tries to expand the field with the appropriate extender.  As a parameter, the extender is passed an object with the constraint parameters obtained from the symfony cache, with model references added to it (AppViewModel) and a list of all constraints for this field. <br><br><h5>  The addAssert method.  Registration of a new validation method </h5>  The method takes three parameters: name is the name of the new validation method, validate is the validation function, checkAsserts is the function confirming error setting.  The last parameter will be discussed a little later. <br>  The body of the extender method is wrapped in a computed property to ensure that validation is restarted when updating AppViewModel.validate. <br><br><h5>  CheckAsserts method </h5>  This is an optional parameter to the addAssert method.  It is needed to check if any other validator will throw an error.  For example, when checking the length of the string entered in the field.  If the field is empty, I want to say ‚Äúfill in the field‚Äù, and if it is less than 3 characters long - ‚Äúthe name must contain at least 3 characters‚Äù, etc.  But there is no guarantee that the MinLength check will happen later than NotBlank.  Here is an example of the MinLengt validation (extender) method: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// MinLength ko.validation.addAssert( 'MinLength', function (target, option) { return (target().length &gt;= option.limit); }, function (target, option) { //       "NotBlank" return (target().length === 0 &amp;&amp; option.asserts.NotBlank !== undefined); } );</span></span></code> </pre><br>  Of course, you can build an object with a list of validators, sorting them in a specific order.  The enumeration of properties in an object occurs in the order of their assignment.  This is not spelled out in the standards, but in reality this is a fairly reliable rule.  However, the question arises as to how the knockout is arranged inside and whether it will be arranged the same way in the next version.  So, the option with a crutch-like function at first glance seems to be the best for me. <br><br><h4>  Using </h4>  Validation rules apply to all observable properties that have the same field in the symfony entity class with the described restrictions.  Accordingly, if a field does not need to be checked on the client‚Äôs side, the solution is obvious - give it a different name or remove the property from the js-object obtained when reading annotations. <br><br>  There is a small demo on codepen: <a href="http://codepen.io/alexismaster/pen/LAaqc">codepen.io/alexismaster/pen/LAaqc</a> <br><br>  Lastly, the promised improvements to the readEntityAnnotations method.  You can get annotations through the validation service: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//      "name"   "User" $validator = $this-&gt;get('validator'); $metadata = $validator-&gt;getMetadataFactory()-&gt;getClassMetadata("Acme\\UsersBundle\\Entity\\User"); var_dump($metadata-&gt;properties['name']-&gt;constraints);</span></span></code> </pre><br><br>  References: <br>  <a href="https://github.com/Abhoryo/APYJsFormValidationBundle">github.com/Abhoryo/APYJsFormValidationBundle</a> - Symfony-bundle generating JS code for validation <br>  <a href="https://github.com/Knockout-Contrib/Knockout-Validation">github.com/Knockout-Contrib/Knockout-Validation</a> <br>  <a href="http://habrahabr.ru/post/136782/">habrahabr.ru/post/136782</a> - An interesting post about KnockoutJS and Extenders <br>  <a href="https://phalcon-docs-ru.readthedocs.org/ru/latest/reference/annotations.html">phalcon-docs-ru.readthedocs.org/en/latest/reference/annotations.html</a> - Annotation <a href="https://phalcon-docs-ru.readthedocs.org/ru/latest/reference/annotations.html">Parser</a> <br>  <a href="http://habrahabr.ru/post/133270/">habrahabr.ru/post/133270</a> - Custom annotations in Symfony 2 </div><p>Source: <a href="https://habr.com/ru/post/188720/">https://habr.com/ru/post/188720/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../188710/index.html">We write applications for Google Glass</a></li>
<li><a href="../188712/index.html">ARM assembler (continued)</a></li>
<li><a href="../188714/index.html">Vipnet failover crypto gateway or how not to implement fault tolerance</a></li>
<li><a href="../188716/index.html">Yesterday in the Business Incubator passed Pitch me Day</a></li>
<li><a href="../188718/index.html">MikroTik QoS - dispelling myths</a></li>
<li><a href="../188722/index.html">"BackgroundImageTransition", smooth animation of background images</a></li>
<li><a href="../188726/index.html">"/ sbin / powerOffVms" in ESX 4.1</a></li>
<li><a href="../188728/index.html">Analytics on the Russian market of book scanners</a></li>
<li><a href="../188732/index.html">Hacking BitTorrent servers</a></li>
<li><a href="../188734/index.html">20 years of youth of the gaming industry in 5 minutes of video. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>