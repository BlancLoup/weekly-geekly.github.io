<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Data conversion, or deepening in Talent Open Studio</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The morning was quite ordinary and lazy: shower, coffee, cigarette ... It's time to get ready for work ... 
 Upon arrival at the office, I was greeted...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Data conversion, or deepening in Talent Open Studio</h1><div class="post__text post__text-html js-mediator-article">  The morning was quite ordinary and lazy: shower, coffee, cigarette ... It's time to get ready for work ... <br>  Upon arrival at the office, I was greeted with the news about the transition to a new project as an ETL engineer (what it means I did not know, but oh well).  Well, I think we will try.  Before me, one guy worked there, but as always, I didn‚Äôt wait for a lot of help about his work.  And so begin. <br><a name="habracut"></a><br><br>  What is ETL?  This is what the <a href="http://ru.wikipedia.org/wiki/ETL">wiki</a> says: <br>  ETL (from the English. Extract, Transform, Load - literally "extraction, transformation, loading") - one of the main processes in the management of data warehouses, which includes: <br><ul><li>  extract data from external sources; </li><li>  their transformation and purification (eng. Data cleansing), so that they correspond to the needs of the business model; </li><li>  and loading them into the data warehouse. </li></ul><br>  I think this more or less clearly.  The essence of my task was to pull data from some .xls document, convert it by type (most of the fields were defined as string), calculate something (depending on the case), and write the whole thing into the database.  After lead to the <b>star schema</b> mind, what is it you can read on the same <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2585%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%25B7%25D0%25B2%25D0%25B5%25D0%25B7%25D0%25B4%25D1%258B">wiki</a> . <br>  So.  Deal with the task.  For work, <a href="http://www.talend.com/">Talent Open Studio was used</a> , and an example of how and what to do was made.  And began a very long and boring job copy-paste. <br><br>  Here is what a simplified example of data conversion looks like and writing to the database looks like this: <br><ul><li>  A project is being created; </li><li>  A data source is added to it;  (in our case .xml doc); </li><li>  Added data recipient (table in MySQL); </li><li>  Create a new job; </li><li>  We drop the source and the receiver into it, as well as the tMap component of the environment; </li><li>  For each field, we write in it a data conversion (for example, an envelope toInt || toFloat, delete extra characters, for example, "%", and so on; </li><li>  We press our Job to execute and see what happens; </li></ul> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>so visually looks like a simple example of a job at TOS</i> <br><img src="https://habrastorage.org/getpro/geektimes/post_images/b2a/031/628/b2a0316287916e5639aab50e1e92c77b.jpg" alt="TOS Job"><br><br>  There were cases where I had to write a fairly long check on the validity of the data, their parsing, and so on.  After several such tasks and an annoying copy-peist, the idea of ‚Äã‚Äãoptimizing the process matured, as it turned out in this IDE there is an opportunity to write your own static public classes.  The first class for data conversion was written in a couple of minutes.  And immediately the amount of marudnaya work decreased significantly.  If, for example, every time I had to copy-paste: <br><br> <code>obj.toString().equals("#") || obj.toString().equals("") || obj==null ? null <br> Integer.parseInt(StringHandling.EREPLACE(obj.toString().replace(" ", "").substring(0,obj.toString().replace(" ", "").indexOf(".")),"\\xA0", ""))</code> <br> <br>  then it all went on in one line <br><br> <code>routines.Convert.toInteger(obj)</code> <br> <br>  But as they say, not everything is so simple, especially if you have to perform some operations with some data, and even more so if you have to work with data from the previous osprey, as in Talent Open Studio the data is transferred in rows, rather than as a whole array, and accessed to the previous osprey is not so easy, but rather I haven‚Äôt found a way except to use the buffer components. <br><br>  More specifically, there is the following task: we have a set of values ‚Äã‚Äãwith the following fields: ‚ÄúYear‚Äù, ‚ÄúQuarter‚Äù, ‚ÄúStartsFromJan1‚Äù, ‚ÄúSomeValue1‚Äù, ‚ÄúSomeValue2‚Äù, ‚ÄúSomeValue3‚Äù; the StartsFromJan1 field can take the values ‚Äã‚Äã‚ÄúY‚Äù (true) or ‚ÄúN‚Äù (false). <br><br>  If the ‚ÄúStartsFromJan1‚Äù field is set to ‚ÄúY‚Äù (true), then this line must be processed according to a set of rules, if ‚ÄúN‚Äù is left as it is.  For example, the processing can occur as follows: the corresponding cell of the previous line is subtracted from the cell in the current line (if Q4 is subtracted Q3), taking into account the fact that if it has the value of the StartsFromJan1 == N field then subtract one more minus one line, and so on let's get to Q1, but if the StartsFromJan1 == Y field is in the row to be taken away, then we stop there, for clarity, I will give an example of the data: <br><table><tbody><tr><th>  Year </th><th>  Quarter </th><th>  StartsFromJan1 </th><th>  Somevalue </th><th>  Somevalue </th></tr><tr><td>  2009 </td><td>  Q1 </td><td>  N </td><td>  3000 </td><td>  4,000 </td></tr><tr><td>  2009 </td><td>  Q2 </td><td>  Y </td><td>  3500 </td><td>  5000 </td></tr><tr><td>  2009 </td><td>  Q3 </td><td>  N </td><td>  4,000 </td><td>  6000 </td></tr><tr><td>  2009 </td><td>  Q4 </td><td>  Y </td><td>  5000 </td><td>  7,000 </td></tr><tr><td>  2009 </td><td>  Q1 </td><td>  N </td><td>  3500 </td><td>  4400 </td></tr><tr><td>  2009 </td><td>  Q2 </td><td>  Y </td><td>  3400 </td><td>  5600 </td></tr><tr><td>  2009 </td><td>  Q3 </td><td>  N </td><td>  4500 </td><td>  6500 </td></tr><tr><td>  2009 </td><td>  Q4 </td><td>  Y </td><td>  5600 </td><td>  7800 </td></tr></tbody></table><br><h4>  in our case, the first remains unchanged, we take away the first from the second, do not touch the third, subtract 3 and 2 from the fourth </h4><br><br>  the development of the problem the following problems <br><ul><li>  Calculating data if the ‚ÄúStartsFromJan1‚Äù field is set to ‚ÄúY‚Äù </li><li>  Weeding empty lines </li><li>  Minimize the amount of manual work </li></ul><br><br>  To solve the first problem, the same static classes came to the rescue.  I used 3 one-dimensional arrays (three, because the string in which Quarter == Q1 is always ‚ÄúN‚Äù for the ‚ÄúStartsFromJan1‚Äù field), created some Int type variable, which after each processed cell was increased by one, and after processing the last cell in the line and the transition to the next reset.  Next, a method was created that converted the incoming data and wrote it into an array, it also reset the array when switching from Q4 to Q1.  And in the latter method, I was engaged in pulling data out of the array, whether the incoming parameter needed to be counted, he later called the method to add to the array and returned the calculated or uncalculated value (depending on the ‚ÄúStartsFromJan1‚Äù parameter). <br>  Then, in the tMap component, this method was called into which the values ‚Äã‚Äã‚ÄúStartsFromJan1‚Äù, ‚ÄúQuarter‚Äù, ‚ÄúsomeValue‚Äù were transferred ... <br><br>  The problem with empty lines ... at first we just cut the number of readable lines from the file, but this solution was temporary, as the amount of data increases over time. The solution came in the form of a tFilterRow component, which simply indicated some expression for filtering, for example Year! = null ||  Year! = "", All values ‚Äã‚Äãthat met the condition were run through tMap. <br><br>  after carrying out the described optimizations, the development time of a single Osprey data was reduced by several orders of magnitude, the amount of work was also significantly less, although for the most part everything was done because of the enormous reluctance to do the same type and long-term work, especially when it concerns copy-peist. </div><p>Source: <a href="https://habr.com/ru/post/86847/">https://habr.com/ru/post/86847/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../86838/index.html">10 years of Nupedia, the free encyclopedia</a></li>
<li><a href="../86841/index.html">1024-bit RSA encryption cracked</a></li>
<li><a href="../86844/index.html">Vuurmuur - fighting cats guard your network</a></li>
<li><a href="../86845/index.html">"Beeline" introduces a fee for "silent" subscribers - 5 rubles per day</a></li>
<li><a href="../86846/index.html">OAuth authorization using the example of Desktop Twitter client</a></li>
<li><a href="../86848/index.html">Ribbon Development (‚ÄúWhy the Interface, Part 1)</a></li>
<li><a href="../86850/index.html">Soyuz Telecom plans in early April to begin providing WiMAX in seven locations in various regions and territories of Russia</a></li>
<li><a href="../86852/index.html">Parable about interception of errors</a></li>
<li><a href="../86857/index.html">Place a layer with traffic jams on our J.Map map</a></li>
<li><a href="../86860/index.html">Charged Trojan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>