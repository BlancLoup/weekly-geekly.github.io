<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What's wrong with the display of currency symbols in iOS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In June 2016, the application ILE de Bote appeared in the App Store. A client asked us to use the Carisma font. It does not apply to the system fonts ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What's wrong with the display of currency symbols in iOS</h1><div class="post__text post__text-html js-mediator-article">  In June 2016, the application <a href="http://livetyping.com/ru/portfolio/ile-de-beaute">ILE de Bote</a> appeared in the App Store.  A client asked us to use the <a href="https://www.myfonts.com/fonts/castletype/carisma/">Carisma</a> font.  It does not apply to the system fonts of the iOS platform, which can be understood after trying to find it <a href="http://iosfonts.com/">here</a> .  While working on the application, I noted that currency symbols falling in the range from U + 20B6 (symbol of tour livre) to U + 20BE (symbol of Georgian lari) and typed in a font that is not included in the number of system ones, reduce application performance.  The symbol of the ruble - just out of the specified range. <br><br>  Find the differences: <br><br><img src="https://habrastorage.org/files/9dc/fd8/7ae/9dcfd87aec514b3f8778f9ac8c27a0d3.gif">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">The captain gets in touch</b> <div class="spoiler_text">  The screen on the right lags.  This is noticeable in terms of CPU utilization. <br></div></div><br>  Let's discuss this. <br><a name="habracut"></a><br>  We will understand in more detail, in which situations <s>everything slows</s> down the performance.  To do this, we divide the representation of the line with the currency symbol into its constituent parts: <br><br><ol><li>  The text can be contained in the following entities: UILabel, UITextView and UITextField </li><li>  These entities can use the normal NSString and the attributed NSAttributedString </li><li>  For a string, we can get the ruble symbol in one of three ways: <br><br><ol><li>  Using HTML: <br><br><pre><code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *htmlString = <span class="hljs-string"><span class="hljs-string">@"&lt;p&gt;500 ‚ÇΩ&lt;/p&gt; "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.string = [[<span class="hljs-built_in"><span class="hljs-built_in">NSAttributedString</span></span> alloc] initWithData:[htmlString dataUsingEncoding:<span class="hljs-built_in"><span class="hljs-built_in">NSUnicodeStringEncoding</span></span>] options:@{ <span class="hljs-built_in"><span class="hljs-built_in">NSDocumentTypeDocumentAttribute</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">NSHTMLTextDocumentType</span></span> } documentAttributes:<span class="hljs-literal"><span class="hljs-literal">nil</span></span> error:<span class="hljs-literal"><span class="hljs-literal">nil</span></span>];</code> </pre> <br></li><li>  Using unicode: <br><br><pre> <code class="objectivec hljs"><span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.string = [[<span class="hljs-built_in"><span class="hljs-built_in">NSAttributedString</span></span> alloc] initWithString: <span class="hljs-string"><span class="hljs-string">@"500 \u20BD"</span></span>];</code> </pre><br></li><li>  Using number formatter: <br><br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSNumberFormatter</span></span> * numberFormatter = [[<span class="hljs-built_in"><span class="hljs-built_in">NSNumberFormatter</span></span> alloc] init]; [numberFormatter setNumberStyle:<span class="hljs-built_in"><span class="hljs-built_in">NSNumberFormatterCurrencyStyle</span></span>]; [numberFormatter setCurrencyCode:<span class="hljs-string"><span class="hljs-string">@"RUB"</span></span>]; [numberFormatter setMaximumFractionDigits:<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.string = [[<span class="hljs-built_in"><span class="hljs-built_in">NSAttributedString</span></span> alloc] initWithString:[numberFormatter stringFromNumber:@<span class="hljs-number"><span class="hljs-number">500</span></span>]];</code> </pre></li></ol></li></ol><br>  When I started to combine entities, I found that the following combinations reduce performance: <br><br><ol><li>  UILabel, string type: attributed, methods for getting a character: 2 or 3 </li><li>  UITextView, string type: any, character retrieval methods: any </li><li>  UITextField, string type: any, character retrieval methods: any </li></ol><br>  The experiment was to measure the load on the processor when scrolling through the list, the elements of which contained the symbol of the ruble.  The average processor load for a normal state did not exceed 10%, and if there was a problem, the load fluctuated around 30-80%, which can be seen on gifs. <br><br><img src="https://habrastorage.org/files/463/1d7/0e9/4631d70e9a6545a4a55b8aed1945e57b.png"><br>  The picture outlines the symbols with which the described problem is observed. <br><br>  In order for the application to behave normally, you should avoid those combinations that I identified, or use the system font San Francisco for the currency symbols, as well as fonts from the Helvetica Neue family.  But these are the minimum requirements.  The true reason for the increase in the load for me remains a mystery, and if someone understands the essence of the question - share your thoughts in the comments. </div><p>Source: <a href="https://habr.com/ru/post/312294/">https://habr.com/ru/post/312294/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312282/index.html">Prevent it: make life easier for the client and yourself at the same time</a></li>
<li><a href="../312286/index.html">Developing intelligent bots using the Microsoft Bot Framework, Azure Cognitive Services and NER systems. Part 1</a></li>
<li><a href="../312288/index.html">Do not think about seconds down</a></li>
<li><a href="../312290/index.html">The concept of a sandbox when developing extensions for the browser Google Chrome</a></li>
<li><a href="../312292/index.html">Installing Mikrotik Cloud Hosted Router on VPS Hosting Digital Ocean</a></li>
<li><a href="../312296/index.html">The United States has transferred control of the domains to the world community: what does it mean</a></li>
<li><a href="../312300/index.html">We understand in MAVLink. Part 1</a></li>
<li><a href="../312302/index.html">We sit on a Java-hardcore: Free broadcast of the track Joker 2016 without cuts</a></li>
<li><a href="../312304/index.html">Sell ‚Äã‚Äãlike Amazon: 7 examples of automating personal trigger e-mails that you can run today</a></li>
<li><a href="../312306/index.html">10G Switching for SMB: Extreme Summit Switch X620 Series</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>