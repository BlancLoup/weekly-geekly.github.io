<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How JavaScript Timers Work</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is extremely important to understand how JavaScript timers work. Often their behavior does not coincide with our intuitive perception of multithrea...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How JavaScript Timers Work</h1><div class="post__text post__text-html js-mediator-article">  It is extremely important to understand how JavaScript timers work.  Often their behavior does not coincide with our intuitive perception of multithreading, and this is due to the fact that in reality they are performed in a single thread.  Let's look at four functions with which we can control timers: <br><ul><li>  var id = setTimeout (fn, delay);  - Creates a simple timer that will trigger a given function after a specified delay.  The function returns a unique ID with which the timer can be paused. </li><li>  var id = setInterval (fn, delay);  - It looks like setTimeout, but continuously calls a function at a specified interval (until it is stopped). </li><li>  clearInterval (id) ;, clearTimeout (id);  - Accepts a timer ID (returned by one of the functions described above) and stops the execution of the callback. </li></ul>  The main idea to consider is that the accuracy of the timer delay period is not guaranteed.  To begin with, the browser executes all asynchronous JavaScript events in a single thread (such as a mouse click or timers) and only at the time when the time of this event arrived.  This is best illustrated by the following diagram: <br><br> <a href=""><img src="https://habrastorage.org/storage2/bb6/b35/ee1/bb6b35ee17c0a332d31e338d44183706.png"></a> <a name="habracut"></a><br><br>  In this picture, there is quite a lot of information that needs to be learned, but an understanding of this will give you a deeper understanding of how asynchronous JavaScript executes.  this chart shows the time vertically in milliseconds; the blue blocks show blocks of JavaScript code that has been executed.  For example, the first block is executed on average within 18 ms, a mouse click blocks execution for about 11 ms, and so on 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      JavaScript can execute only one portion of code (due to the single-threaded nature of execution), each blocking the execution of other asynchronous events.  This means that when an asynchronous event occurs (such as a mouse click, a timer call, or an XMLHttp request completion), it is added to the queue and executed later (the implementation, of course, varies depending on the browser, but let's call it a ‚Äúqueue‚Äù) . <br><br>  To begin with, imagine that inside the JavaScript block, two timers start: setTimeout with a delay of 10ms and setInterval with the same delay.  Depending on when the timer starts, it will work at the moment when we have not completed the first block of code.  Note, however, that it does not work right away (this is not possible due to single-threaded).  Instead, the deferred function enters the queue and is executed at the next available moment. <br><br>  Also, during the execution of the first JavaScript block, a mouse click occurs.  The handler of this asynchronous event (and it is asynchronous, because we cannot predict it) cannot be executed directly at this moment, so it also enters the queue, as does the timer. <br><br>  After the first block of JavaScript code has been executed, the browser asks ‚ÄúWhat is waiting for execution?‚Äù.  In this case, the mouse click handler and the timer are pending.  The browser selects one of them (click handler) and executes it.  The timer will wait for the next available portion of time in the queue for execution. <br><br>  Note that while the mouse click handler is executed, the first interval-callback is triggered.  Like the timer callback, it will be queued.  However, keep in mind that when the interval works again (while the call-callback is running), it will be removed from the queue.  If all the interval-callbacks were in the queue while a large piece of code was being executed, this would have resulted in a bunch of functions waiting to be called without periods of delays between the end of their execution.  Instead, browsers tend to wait until there is a single function in the queue before adding another one to the queue. <br><br>  Thus, we can observe the case when the third interval-callback operation coincides with the moment when it is already executed.  This illustrates an important feature: the intervals do not care about what is being performed at the moment, they will be added to the queue without taking into account the delay period between performances. <br><br>  Finally, after the second interval-callback is completed, we will see that there is nothing left that the JavaScript engine should do.  This means that the browser is waiting for new asynchronous events to appear again.  This will happen at 50ms where interval-callback will work again.  At this point there will be nothing that would block it, so it will work immediately. <br><br>  Let's look at an example that illustrates well the difference between setTimeout and setInterval. <br><pre><code class="javascript hljs">setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* Some long block of code... */</span></span> setTimeout(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>.callee, <span class="hljs-number"><span class="hljs-number">10</span></span>); }, <span class="hljs-number"><span class="hljs-number">10</span></span>); setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* Some long block of code... */</span></span> }, <span class="hljs-number"><span class="hljs-number">10</span></span>);</code> </pre> <br>  These two options are equivalent at first glance, but in reality it is not.  Code using setTimeout will always have a delay of at least 10ms after the previous call (it may be longer, but never less), while code using setInterval will tend to be called every 10ms regardless of when the previous call worked. <br><br>  Let's summarize all of the above: <br>  - JavaScript engines use a single-threaded environment, converting asynchronous events into a queue waiting to be executed, <br>  - The functions setTimeout and setInterval are fundamentally differently executed in asynchronous code, <br>  - If the timer cannot be executed at the moment, it will be delayed until the next execution point (which will be longer than the desired delay), <br>  - Intervals (setInterval) can be executed one after another without delay if their execution takes longer than the specified delay. <br><br>  All this is extremely important development information.  Knowing how the JavaScript engine works, especially with a large number of asynchronous events (which often happens), lays an excellent foundation for building advanced applications. </div><p>Source: <a href="https://habr.com/ru/post/138062/">https://habr.com/ru/post/138062/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138056/index.html">The authors of the amendments to the Civil Code of the Russian Federation finally decided to destroy Linux, Wikipedia, OpenStreetMap, Firefox, Chromium and LibreOffice?</a></li>
<li><a href="../138057/index.html">Watch vBulletin or attempt to cache dynamic content</a></li>
<li><a href="../138058/index.html">Freelance vs business</a></li>
<li><a href="../138059/index.html">Cheap RFID printed on paper</a></li>
<li><a href="../138060/index.html">A couple of questions on multiple screens. (.NET)</a></li>
<li><a href="../138063/index.html">Automatic quality check of Java code (iteration 1)</a></li>
<li><a href="../138064/index.html">Vkontakte will be forced to actively deal with piracy</a></li>
<li><a href="../138065/index.html">24 Weeks Metro-Design for Windows Phone | # 2 Windows Phone Application Design Process</a></li>
<li><a href="../138067/index.html">Determining a country by IP: testing the speed of algorithms</a></li>
<li><a href="../138069/index.html">Droider Show # 27. Siri will speak Russian</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>