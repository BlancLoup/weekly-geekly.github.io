<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bluetooth controlled machine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have long wanted to introduce my son into programming, but how to do it? 
 Gone are the days when they studied in BASIC and Pascal. I tried to show ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bluetooth controlled machine</h1><div class="post__text post__text-html js-mediator-article">  I have long wanted to introduce my son into programming, but how to do it? <br>  Gone are the days when they studied in BASIC and Pascal.  I tried to show him TurboPascal - even something seemed to be starting to turn out, but somehow it didn‚Äôt get any further ... <br><br>  I decided to make the next attempt when I met <a href="http://www.marsohod.org/index.php/ourblog/11/106-scratchstart">Scratch, the</a> children's design language.  It is not even a language - it is a tool for creating scripts by dragging ‚Äúblocks‚Äù on the screen and connecting them with each other.  Now it went better.  The child was able to make even some simple game.  But you need to move on? <br><br><img src="https://habrastorage.org/storage/9e76982d/6522e6df/3cb73e90/d31aec34.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In order to somehow diversify the ‚Äúprogramming‚Äù, I thought up to make a typewriter, but so that its behavior could be controlled from a computer by a program on <a href="http://www.marsohod.org/index.php/ourblog/11/106-scratchstart">Scratch</a> .  That is, so that the child could somehow program the logic of the behavior of the machine. <a name="habracut"></a><br><br>  In the Scratch programming environment itself, there seems to be even means for this: apparently somewhere there are special ScratchBoard or SesorBoard boards connected to the computer via the serial port. <br><br><img src="https://habrastorage.org/storage/b8c6b42c/9ca6b271/734889e9/dafc7cc6.jpg"><br><br>  This ScratchBoard board can send the values ‚Äã‚Äãof some sensors to the computer (four analog sensors A, B, C, D, a light sensor, a sound sensor, a button, etc.).  Commands to one motor can be sent from the computer to the board: "on" / "off", the direction "there" / "back" and power from 0 to 100. The program (script) for controlling the motor in Scratch can look, for example, like this: <br><br><img src="https://habrastorage.org/storage/038aef91/547a7973/9f9507fd/3d2f2442.jpg"><br><br>  Something like Lego cubes - you connect different blocks and you get a program.  The child may well master. <br><br>  Actually there was an idea to make something moving, but controlled from the Scratch program. <br><br>  Immediately there are several problems.  The first problem - how to connect a moving machine with a computer - the wires are clearly not suitable.  The second problem is that the connection should be in the form of a ‚Äúserial port‚Äù, because Scratch only understands this way.  The third problem, you need to know the data transfer protocol in both directions.  The fourth problem - how to control the machine if Scratch knows only one motor?  Fifth ... Well, enough to list the problems!  Need to solve them! <br><br>  1. Purchased a Bluetooth module LMX9838.  This chip is good because when it is energized, it is immediately ready for operation and you can immediately establish a connection in the form of a virtual serial port from a computer.  Two problems are solved immediately - wireless communication and COM-port.  How to solder this module to the scarf can be <a href="http://www.marsohod.org/index.php/projects/126-bluetoothcar">read here</a> .  The BGA chip is all bottom pins, but fortunately most of the legs are not used.  If you turn the chip and solder wiring on top, it greatly simplifies the work.  The result is such a module: <br><br><img src="https://habrastorage.org/storage/4936d2cd/0650b4e3/ce30dd66/b1941aa5.jpg"><br><br>  2. With the help of Google, I found the description of the Scratch protocol on some Japanese website.  Now you can get to know him better yourself, <a href="http://www.marsohod.org/index.php/projects/107-scratchboard">already in Russian</a> . <br><br>  3. Took the <a href="http://www.marsohod.org/index.php/howtostart/plata">charge "Mars Rover"</a> - this is such an "electronic designer" on the Alter FPGA.  I made and sewed into the FPGA a project that implements a serial transceiver and receives and sends data using the Scratch protocol, controls the motors.  Even connected to the board "Mars Rover" connected two photo-transistors - these will be the "eyes" of the machine.  I sent them down to the ground.  Planned that the machine would move on a white sheet of paper, on which, for example, some obstacles will be drawn.  Actually, these sensors give the values ‚Äã‚Äã‚Äúdark‚Äù or ‚Äúlight‚Äù, and I transmit them to Scratch, as readings of the sensors ‚ÄúC‚Äù and ‚ÄúD‚Äù. <br><br><img src="https://habrastorage.org/storage/65d8ea71/ec5aab5b/d961baed/89415584.jpg"><br><br>  4. To control the two motors, it was decided to use such a parameter as ‚Äúpower‚Äù.  Scratch language scripts can set the ‚Äúpower‚Äù motor connected via ScratchBoard.  I decided so.  If the power is zero, then the first motor can work, and the second is not.  If the power is 50, then both motors can work.  If the power is set to 100, then the second motor can work, but not the first one.  Certainly not entirely elegant, but some way out.  They turn on at the command ‚Äúmotor on‚Äù and turn off at the command ‚Äúmotor off‚Äù. <br><br>  Well, that's all. <br>  The entire machine assembly looks something like this: two motors on a platform with a caterpillar drive, a ‚ÄúMars Rover‚Äù board, optical sensors-eyes, a Bluetooth module.  On a large piece of paper we draw a figure of eight with black gouache (and so that it dries). <br><br>  A child makes a program on Scratch - something like this: <br><br><img src="https://habrastorage.org/storage/402b1c0d/9221b314/5a6d6a8b/4f88a51d.png"><br><br>  Then we turn on the machine, establish a Bluetooth connection between the computer and the machine.  And run the Scratch program: The typewriter moves along the strip, and this logic is set by our Scratch program! <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/cSSqjg5_mFI%3Ffeature%3Doembed&amp;xid=25657,15700002,15700023,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhhObbfDLwEoOZs86LYSZQgYuZBC3g" frameborder="0" allowfullscreen=""></iframe><br><br>  PS: The very next day a thought occurred to me.  There is a machine with Bluetooth.  Can you manage it from a cell phone?  By evening, the Java program for my nokia was ready! <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/OpcIIg5l4Rw%3Ffeature%3Doembed&amp;xid=25657,15700002,15700023,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhiEKEPMqVJpIF49efUIvknX4uZNiw" frameborder="0" allowfullscreen=""></iframe><br><br>  I wrote it using the Sun Wireless Toolkit.  You can <a href="http://www.marsohod.org/index.php/ourblog/11-blog/127-phonebtctrl">read more</a> about this project <a href="http://www.marsohod.org/index.php/ourblog/11-blog/127-phonebtctrl">here</a> .  There is also a java program source. </div><p>Source: <a href="https://habr.com/ru/post/113079/">https://habr.com/ru/post/113079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../113074/index.html">Automatic file copying on iOS device without jailbreak and file managers</a></li>
<li><a href="../113075/index.html">Virtual keyboard</a></li>
<li><a href="../113076/index.html">Group of users</a></li>
<li><a href="../113077/index.html">6 reasons why you should not write functional specifications</a></li>
<li><a href="../113078/index.html">Web developer pitfalls</a></li>
<li><a href="../113080/index.html">Researchers manage to fingerprint clothes</a></li>
<li><a href="../113083/index.html">Feature List: I can! (I Can-Do!)</a></li>
<li><a href="../113084/index.html">Hyper Estraier - a small search engine for the lazy</a></li>
<li><a href="../113085/index.html">We design rating evaluation</a></li>
<li><a href="../113086/index.html">Telecommunications market in Russia - what, where, how, how much</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>