<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Array for LED matrix in Excel - easy!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I am developing a device with information output on an LED matrix. The standard typical solution on the MK STM8S105C6T6 + 74HC595. 



 And so, after ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Array for LED matrix in Excel - easy!</h1><div class="post__text post__text-html js-mediator-article">  I am developing a device with information output on an LED matrix.  The standard typical solution on the MK STM8S105C6T6 + 74HC595. <br><br><img src="https://habrastorage.org/files/f80/806/b52/f80806b52bf84b5da35398f6e081959c.png" alt="image"><br><br>  And so, after running the tests on simple pictures and lines, I ran into a problem, how can I fill these data arrays in the simplest way?  After all, each pixel is either 1 or 0, and even in the smallest 8x8 matrix there are as many as 64 pixels. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/3etFtuy6sP0%3Ffeature%3Doembed&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgfUeqCRY3AD9_AWFKwGWOcFHhR7w" frameborder="0" allowfullscreen=""></iframe>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You can, of course, manually, using a notepad to stuff something like this: <br><br><img src="https://habrastorage.org/files/7a3/e7c/023/7a3e7c023ce94e0ea4cb183a81833416.png" alt="image"><br><br>  But then the array 0 and 1 must be converted to decimal or hexadecimal values ‚Äã‚Äãcorresponding to rows or columns, for example, using an engineering calculator.  But it is long and uninteresting.  You can write a simple editor in C #, but at work I need to install and configure the environment.  But there is Excel at hand!  He does an excellent job with such tasks.  So let's get started. <br><br>  To begin with, let's agree that the luminous pixel is ‚Äú1‚Äù, not luminous - ‚Äú0‚Äù.  In order for Excel to show us in the ‚Äúlight bulb‚Äù table instead of boring numbers, let's use conditional formatting.  Let Vs¬ß, which is equal to and greater than 1, be a green circle, and all that is less ‚Äî not filled with white. <br><br><img src="https://habrastorage.org/files/41a/2d9/a68/41a2d9a68d6a487494d0859df342f684.png" alt="image"><br><br>  We obtain in the left part of the cells a circle that corresponds to the state of the cell.  In the right we see the contents of the cell. <br><br><img src="https://habrastorage.org/files/ed9/fc5/820/ed9fc5820f3c4d5ba9406b976af79955.png" alt="image"><br><br>  But why do we need to see ‚Äú0‚Äù and ‚Äú1‚Äù?  We hide them, for this we need to reduce the width of the cells so that only the ‚Äúlight bulbs‚Äù are visible.  I got it with the width of the column = "2".  Now the fun part.  How to turn eight zeros and units in one byte in Excel?  To do this, take the school formula for converting a binary number to a decimal. <br><br>  For those who do not remember: <br><br>  <b>10110110 = (1 ¬∑ 2 ^ 7) + (0 ¬∑ 2 ^ 6) + (1 ¬∑ 2 ^ 5) + (1 ¬∑ 2 ^ 4) + (0 ¬∑ 2 ^ 3) + (1 ¬∑ 2 ^ 2) + (1 ¬∑ 2 ^ 1) + (0 ¬∑ 2 ^ 0) = 128 + 32 + 16 + 4 + 2 = 182</b> <br><br>  In the cell under the bulbs the same formula is obtained: <br><br>  <b>= <i>J14</i> * 2 ^ 7 + <i>J13</i> * 2 ^ 6 + <i>J12</i> * 2 ^ 5 + <i>J11</i> * 2 ^ 4 + <i>J10</i> * 2 ^ 3 + <i>J9</i> * 2 ^ 2 + <i>J8</i> * 2 ^ 1 + <i>J7</i> * 2 ^ 0</b> <br><br>  And finally, we want to get the code of the array to immediately insert into the program and check.  To do this, combine the contents of the cells separated by commas using the &amp; &amp;, "&amp;."  The result is the formula: <br><br>  <b>= "Unsigned char to_display [] = {" &amp; B16 &amp; "," &amp; C16 &amp; "," &amp; D16 &amp; "," &amp; E16 &amp; "," &amp; F16 &amp; "," &amp; G16 &amp; "," &amp; H16 &amp; "," &amp; I16 &amp; "," &amp; J16 &amp; "," &amp; K16 &amp; "," &amp; L16 &amp;, "&amp; M16 &amp;", "&amp; N16 &amp;", "&amp; O16 &amp;", "&amp; P16 &amp;", "&amp; Q16 &amp;", "&amp; R16 &amp;", "&amp; S16 &amp;", "&amp; T16 &amp;", "&amp; U16 &amp;", "&amp; V16 &amp;", "&amp; W16 &amp;", "&amp; X16 &amp;" , "&amp; Y16 &amp;", "&amp; Z16 &amp;", "&amp; AA16 &amp;", "&amp; AB16 &amp;", "&amp; AC16 &amp;", "&amp; AD16 &amp;", "&amp; AE16 &amp;", "&amp; AF16 &amp;", "&amp; AG16 &amp;", "&amp; AH16 &amp;", "&amp; AI16 &amp;", "&amp; AJ16 &amp;", " &amp; AK16 &amp;, "&amp; AL16 &amp;," "&amp; AM16 &amp;", "&amp; AN16 &amp;", "&amp; AO16 &amp;", "&amp; AP16 &amp;", "&amp; AQ16 &amp;", "&amp; AR16 &amp;", "&amp; AS16 &amp;", "&amp; AT16 &amp;", "&amp; AU16 &amp;", "&amp; AV16 &amp;", "&amp; AW16 &amp;" , "&amp; AX16 &amp;", "&amp; AY16 &amp;", "&amp; AZ16 &amp;", "&amp; BA16 &amp;", "&amp; BB16 &amp;", "&amp; BC16 &amp;", "&amp; BD16 &amp;", "&amp; BE16 &amp;", "&amp; BF16 &amp;", "&amp; BG16 &amp;"} ""</b> <br><br>  As a result, having filled the array with the values ‚Äã‚Äã‚Äú1‚Äù and ‚Äú0‚Äù, we immediately see the result: <br><br><img src="https://habrastorage.org/files/b7d/3e1/131/b7d3e113175942629baa4426898ba565.png" alt="image"><br><br>  And the generated code can be immediately inserted into the program and see the result: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Va96GCUEiPE%3Ffeature%3Doembed&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgsJG85RdOdjDADUa5SFu_JNroTBA" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/376089/">https://habr.com/ru/post/376089/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../376077/index.html">Save $ 400 per year: Google made Earth Pro free</a></li>
<li><a href="../376079/index.html">Apple will build a data center for $ 2 billion</a></li>
<li><a href="../376081/index.html">Backpack for the programmer</a></li>
<li><a href="../376085/index.html">OCZ plans to release new SSDs for 2015</a></li>
<li><a href="../376087/index.html">Why all this unproved universe?</a></li>
<li><a href="../376091/index.html">The App Store has a section with Russian products.</a></li>
<li><a href="../376093/index.html">The practice of a foreign language through computer games</a></li>
<li><a href="../376095/index.html">Visualization of architectural lighting</a></li>
<li><a href="../376097/index.html">What happened in the world of finance in a week # 9</a></li>
<li><a href="../376099/index.html">How star companies like Apple kill US high-tech culture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>