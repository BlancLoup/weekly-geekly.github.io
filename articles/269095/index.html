<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>iOs debug master</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once I almost completely abandoned the mouse to navigate Xcode and quite happy about it. The next step is to drop the visual debugger controls. What f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>iOs debug master</h1><div class="post__text post__text-html js-mediator-article">  Once I almost completely abandoned the mouse to navigate Xcode and quite happy about it.  The next step is to drop the visual debugger controls.  What for?  - Increase opportunities, reduce debugging time, spend less calories to move a heavy hand (we need calories to work with our head) and thereby provoke less tunnel syndrome. <br><br><img src="https://habrastorage.org/files/822/32e/ac4/82232eac445f4134b817799f8eafb54b.png"><br><a name="habracut"></a>  . <br>  Particularly new discoveries in the article will not, just summarize that you yourself knew well and how it can be used for someone in a new way. <br><br>  I don‚Äôt consider such topics: how to work in Xcode, how to debug an application at all, at what point you need to do it and why, what is <a href="https://ru.wikipedia.org/wiki/LLDB">LLDB</a> , what is Step Into and Step Over, etc. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Immediately to the examples: <br><br><h4>  <b>We configure the console</b> </h4><br>  We reject this panel here: <br><br><img src="https://habrastorage.org/files/b19/393/b29/b19393b29a7e453487f0baf590325fd3.png"><br><br>  Yes, and that's about this soon forget <br><br><img src="https://habrastorage.org/files/ffe/1b5/348/ffe1b5348de04c2c83a8dc53c88a0e94.png"><br><br>  Now our new best friend is this tempting white canvas, you can stretch it to the full length or even the whole screen. <br><br><img src="https://habrastorage.org/files/3ad/a1b/1b7/3ada1b1b7c4f4a8ebe47222aa0902ab1.png"><br><br>  Thanks to my colleague: he realized my old dream - to open the debugger console in a new window.  And it always bothered me that I had just opened and set up the tabs as you need, so immediately at the first breakpoint everything got messed up.  To prevent this, go to <b>Xcode -&gt; Behaviors -&gt; Edit behaviours ...</b> Next we need the <b>Running</b> section <b>-&gt; Pause</b> . <br><br>  We select <b>Show tab named</b> , we write our unique tab name there, for example <b>Debug</b> (I note that the tab is not duplicated during repeated starts), at the end we set the <b>active window</b> - this, strangely enough, opens a new tab (Cmd + T) for our debugger.  I hid the unnecessary right panel, but this is optional.  In general, customization of the environment under different conditions is in the section <b>Behaviors</b> <br><br><img src="https://habrastorage.org/files/c44/dd1/55b/c44dd155b4a34e668aaaf39be5de83dc.png" alt="image"><br><br>  Everything, we are adjusted, we move further. <br><br><h4>  <b>Run the debugger</b> </h4><br>  Add immediately to the treasury of useful hotkeys who did not know <b>Cmd + Shift + C.</b>  This is a quick transition to the console. <br>  <b>Cmd + Shift + Y</b> - this is to hide / show the console. <br>  Our new teams: <br>  <b>Step Into</b> - <b>step</b> or short <b>s</b> <br>  <b>Step Over</b> - <b>next</b> or short <b>n</b> <br>  <b>Step Out</b> - <b>finish</b> <br>  <b>Continue</b> - <b>continue</b> or <b>c</b> <br>  Disable all breakpoints - <b>breakpoint disable</b> <br><br>  For a complete list of lldb commands, you can go <a href="http://lldb.llvm.org/lldb-gdb.html">here.</a> <br>  I will not list all the possibilities of direct LLDB commands, but their list is longer than the Xcode visual environment allows us to do and everyone has the right to decide whether to use this approach or not, and which teams are necessary and interesting.  I will dwell on what showed where to look. <br><br>  The convenience of executing commands is that there is the usual transition to the previous / next command in the terminal through the up and down arrows. <br><br>  As a result, our work with the debugger looks like this: <br><br><img src="https://habrastorage.org/files/145/d01/d87/145d01d8778a47f3a4e2a80d5b72e9c8.png"><br><br><h4>  <b>Swift and obj-c!</b>  <b>What is inside the facility?</b> </h4><br>  I do not know about you, but I was not lucky to write a project on Swift from scratch, but with the release of a new language in a huge obj-c project I had to write all new files on Swifte.  I do not write about all inconsistencies, but the main problem in debugging is probably the following: <br><br>  Create a simple model class on Swift <br><br><pre><code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestObject</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSObject</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-string"><span class="hljs-string">"name"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> index: <span class="hljs-type"><span class="hljs-type">Int</span></span> = <span class="hljs-number"><span class="hljs-number">123</span></span> }</code> </pre> <br>  Now we write a simple array on obj-c with our class: <br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSArray</span></span> *array = @[[[TestObject alloc] init], [[TestObject alloc] init], [[TestObject alloc] init]];</code> </pre><br>  Now we set breakpoint on the next line and look at what we would see in the Variables: <br><br><img src="https://habrastorage.org/files/135/adb/f00/135adbf006844603b47938b953e2ba38.png" alt="image"><br><br>  Familiar?  And where are our <b>name</b> and <b>index</b> <br>  Now we look that we can do it ourselves in the console: <br><br><pre> <code class="bash hljs">(lldb) p array (__NSArrayI *) <span class="hljs-variable"><span class="hljs-variable">$0</span></span> = 0x00007f9a1878c6b0 @<span class="hljs-string"><span class="hljs-string">"3 objects"</span></span> (lldb) po array &lt;__NSArrayI 0x7f9a1878c6b0&gt;( &lt;CornerApp.TestObject: 0x7f9a1870fc60&gt;, &lt;CornerApp.TestObject: 0x7f9a1878c650&gt;, &lt;CornerApp.TestObject: 0x7f9a1878c680&gt; ) (lldb) po [array debugDescription] &lt;__NSArrayI 0x7f9a1878c6b0&gt;( &lt;CornerApp.TestObject: 0x7f9a1870fc60&gt;, &lt;CornerApp.TestObject: 0x7f9a1878c650&gt;, &lt;CornerApp.TestObject: 0x7f9a1878c680&gt; ) (lldb) po array[0] &lt;CornerApp.TestObject: 0x7f9a1870fc60&gt; (lldb) po array[0].name error: property <span class="hljs-string"><span class="hljs-string">'name'</span></span> not found on object of <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> <span class="hljs-string"><span class="hljs-string">'id'</span></span> error: 1 errors parsing expression (lldb) po [array[0] name] name (lldb)</code> </pre><br>  <b>p</b> is <b>print</b> <br>  <b>po</b> is a <b>print object</b> , throws a description message to an object, note that you can still send a message to debugDescription <br>  <b>po array [0] .name</b> - does not work, because for the debugger, the zero element in the array is of type id.  But sending the <b>name</b> message (po [ <b>array [0] name]</b> ) works great.  Do not forget that obj-c is a message oriented programming language. <br><br><h4>  <b>find me</b> </h4><br>  The following case: we have an API - we go to the server for a list of countries, then we convert them into internal logic and store it somewhere.  For example, our modelView follows the data in the repository and searches for the model in the dictionary by key: <br><pre> <code class="objectivec hljs">- (<span class="hljs-built_in"><span class="hljs-built_in">CACountry</span></span> *)countryByCode:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)code { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [_countries objectForKey:code]; }</code> </pre><br>  What do we see in the variables?  242 countries, great, how can we quickly find Russia? <br><img src="https://habrastorage.org/files/0b0/add/205/0b0add205fc446f681d05347effd6dc8.png" alt="image"><br><br>  I know, like this: <br><pre> <code class="bash hljs">(lldb) po [_countries objectForKey:@<span class="hljs-string"><span class="hljs-string">"RU"</span></span>] &lt;CACountry: 0x7fae00630ba0&gt; (lldb) po [[[_countries objectForKey:@<span class="hljs-string"><span class="hljs-string">"RU"</span></span>] title] string] </code> </pre><br>  And I want to note that in the debugger line, autocompletion works perfectly for sending messages in objective-c <br><br><h4>  <b>Magical UIView</b> </h4><br>  Surely, if any non-trivial UI was done, there were situations when something in the interface went away and you need to figure out who is to blame.  With this restart, the application is threatened by the fact that it may not be able to reproduce the situation.  This is where working with a debugger is irreplaceable. <br>  As a result of doing simple <br><pre> <code class="bash hljs">(lldb) po self.view.subviews</code> </pre><br>  see something like this: <br><pre> <code class="bash hljs">&lt;UICollectionView: 0x7fd9fb81a200; frame = (0 0; 375 667); clipsToBounds = YES; opaque = NO; autoresize = W+H; gestureRecognizers = &lt;NSArray: 0x7fd9fb416cb0&gt;; layer = &lt;CALayer: 0x7fd9fb4067f0&gt;; contentOffset: {0, -180}; contentSize: {375, 843}&gt; collection view layout: &lt;TGLStackedLayout: 0x7fd9fb410000&gt;, &lt;CASortView: 0x7fd9fb4468c0; frame = (67.5 607; 240 60); clipsToBounds = YES; alpha = 0; opaque = NO; autoresize = RM+BM; layer = &lt;CALayer: 0x7fd9fb481290&gt;&gt;, &lt;UIView: 0x7fd9fb47e240; frame = (0 0; 375 687); alpha = 0; layer = &lt;CALayer: 0x7fd9fb4895a0&gt;&gt;</code> </pre><br>  We immediately see the view set, their frames, properties, everything that Apple developers stuffed into the standard description description. <br>  If you need we can easily clarify some property, you can use the address in memory directly: <br><pre> <code class="bash hljs">(lldb) po [0x7fae2b792ba0 backgroundColor] UIDeviceWhiteColorSpace 0 1</code> </pre><br>  But finally, a piece of code that can get across the hierarchy all the views of a given class may seem useful to you.  I use it myself. <br><pre> <code class="hljs markdown">import UIKit extension UIView { func debugAllSubviewsOfClass(cls: AnyClass) -&gt; [<span class="hljs-string"><span class="hljs-string">String</span></span>] { func goDeepAndPrint(inout views: [<span class="hljs-string"><span class="hljs-string">String</span></span>], currentView: UIView) { for v in currentView.debugSubview() { views.append(v.debugDescriptionWithParent()) goDeepAndPrint(&amp;views, currentView:v) } } var views = [<span class="hljs-string"><span class="hljs-string">String</span></span>](<span class="hljs-link"></span><span class="hljs-link"></span>) goDeepAndPrint(&amp;views, currentView:self) return views } func debugDescriptionWithParent() -&gt; String { let parentAddress = self.superview != nil ? String(format: "%p", self.superview!) : "nil" return "\(self.description), parent = \(parentAddress)" } func debugSubview() -&gt; [UIView] { return self.subviews } } extension UITableView { override func debugSubview() -&gt; [UIView] { return self.subviews + self.visibleCells } } extension UICollectionView { override func debugSubview() -&gt; [UIView] { return self.subviews + self.visibleCells() } }</code> </pre><br><h4>  <b>UPD: expanding the LLDB command set</b> </h4><br>  There is a good collection of Facebook LLDB commands from LindB - <a href="https://github.com/facebook/chisel">Chisel</a> <br>  For example, there is already a command with recursive output of the nested view - <b>pviews</b> and controllers - <b>pvc</b> There are convenient show / hide commands that allow you to hide or show this or that layer, view, without continue. <br>  The git has a description of the commands and installation instructions, I just want to note that you need a brew package manager if you don‚Äôt have it and create an .lldbinit file with your hands, which you, like me, may not have and add the code that brew issues after installing chisel'a: <br><pre> <code class="bash hljs">ruby -e <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span></span></span><span class="hljs-string">"</span></span> ... brew install chisel ==&gt; Downloading https://github.com/facebook/chisel/archive/1.3.0.tar.gz ==&gt; Downloading from https://codeload.github.com/facebook/chisel/tar.gz/1.3.0 <span class="hljs-comment"><span class="hljs-comment">######################################################################## 100.0% ==&gt; Caveats Add the following line to ~/.lldbinit to load chisel when Xcode launches: command script import /usr/local/opt/chisel/libexec/fblldb.py</span></span></code> </pre><br>  Then we create the .lldbinit file in the root directory and push the script there: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">command</span></span> script import /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/opt/chisel/libexec/fblldb.py</code> </pre><br>  Please note that the script may vary, for example, the one specified in the chisel itself is different. <br>  Commands will be available when you restart Xcode, if you are too lazy to do this, you can: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">command</span></span> <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ~/.lldbinit</code> </pre><br><h4>  <b>Summary</b> </h4><br><ul><li>  You can work with the debugger not only via Xcode buttons. </li><li>  How to configure console opening when debugging in a new tab?  The very beginning - the big picture </li><li>  Quick transition to the console - <b>Cmd + Shift + C</b> , <br>  minimize / expand console - <b>Cmd + Shift + Y</b> </li><li>  Our new teams: <br>  <b>Step Into</b> - <b>step</b> or short <b>s</b> <br>  <b>Step Over</b> - <b>next</b> or short <b>n</b> <br>  <b>Continue</b> - <b>continue</b> or <b>c</b> <br>  Disable all breakpoints - <b>breakpoint disable</b> <br>  Here is the entire list of LLDB commands. </li><li>  Obj-c does not see the properties of a Swift-th class object?  No problem: <br><pre> <code class="bash hljs">(lldb) po [array[0] name]</code> </pre></li><li>  In the variables window 242 key in the dictionary? <br>  Looking for a quick: <br><pre> <code class="bash hljs">(lldb) po [[[_countries objectForKey:@<span class="hljs-string"><span class="hljs-string">"RU"</span></span>] title] string] </code> </pre></li><li>  We <a href="https://github.com/facebook/chisel">put chisel</a> and expand the LLDB command set </li></ul><br><br>  Thank you all who read.  I hope someone has discovered a couple of tricks for himself. <br><br>  He described each of the possibilities in no detail, but he tried to show the direction to whom he needed - he could sort it out or ask in the comments! </div><p>Source: <a href="https://habr.com/ru/post/269095/">https://habr.com/ru/post/269095/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269079/index.html">SanDisk and HP Begin Collaboration on Memory-Driven Computing Technology</a></li>
<li><a href="../269081/index.html">Puli: Resource Management in php applications</a></li>
<li><a href="../269085/index.html">Porting the blog from yii1.1. * To yii2</a></li>
<li><a href="../269087/index.html">Testing NVIDIA GRID + VMware Horizon</a></li>
<li><a href="../269089/index.html">Browser Development Design ‚ÄúSocial Browser Bar‚Äù</a></li>
<li><a href="../269097/index.html">Position - team lead</a></li>
<li><a href="../269099/index.html">Russian hackers hacked Dow Jones and seized insider information</a></li>
<li><a href="../269103/index.html">Big hakaton on VDNH</a></li>
<li><a href="../269107/index.html">[CodinGame] Back to the Code: Recar and Olaf69 share their strategies</a></li>
<li><a href="../269111/index.html">How to write RFP for software development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>