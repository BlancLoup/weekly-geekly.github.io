<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>USB DC power meter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article introduces the development of a USB DC power meter. 



 On the basis of the presented circuit of the voltmeter and the firmware of the P...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>USB DC power meter</h1><div class="post__text post__text-html js-mediator-article">  This article introduces the development of a USB DC power meter. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b3/6dd/1f8/3b36dd1f871b15a38813c3d4b817ebb2.jpg" alt="image"><br><a name="habracut"></a><br>  <a href="http://www.moty22.co.uk/usb_counter.php">On the basis of the presented circuit of the voltmeter and the firmware of the PIC18F2550 microcontroller</a> , a USB program was created, which could consider electricity, for a circuit with constant resistance.  Since the constant energy meters are rare and expensive (20-30 thousand rubles in Russia and 6-10 thousand rubles in China and India), we decided to make a meter that would be suitable for our laboratory research, which eventually amounted to no more than 400 rubles., by component.  They made a meter for measuring and comparing the energy of recovery in electric motors of different designs, but of the same power, it can also be used as a meter of energy received from a wind generator, solar batteries and other sources of direct current energy.  A written program can read not only kW * h, but also watt * h, watt * s, etc ... <br><br>  The assembled circuit included a voltage divider, which was also a design resistance (highlighted in red) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/bc9/5dc/293/bc95dc29393479d9e871548eca76148a.jpg" alt="image"><br><br>  Which was entered into the USB-program (highlighted in red): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/477/ecc/cdc/477ecccdc40cf9aa709d862393b9221b.jpg" alt="image"><br><br>  The value of the voltage multiplier is highlighted in blue, it can be obtained before measurements using the formula specified here: <a href="http://bit.ly/1oNddey">bit.ly/1oNddey</a> .  Or pick up on a multimeter, that is, measuring the battery voltage with a multimeter, and then enter a voltage multiplier value so that the USB program (using our meter) shows the same voltage on the multimeter on the same battery. <br><br>  The resistance value of the voltage divider can be selected for the transmission of large and small currents.  A voltage divider is still needed if we apply a voltage of more than 5 volts, more than 5 volts cannot be applied to the microcontroller, so a voltage divider is needed. <br><br>  It is worth noting that the circuit in Proteus is different from the circuit, which is made in the gland.  VCC (red USB wiring) will not go on 1 foot, but on PIC's 20 foot.  Also in the scheme for Proteus 8 and 19 legs are not drawn, in iron 8 or 19 (by choice) it is necessary to take it to the ground. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/738/729/b56/738729b569d7016ceb442fab0d07a09c.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/f3c/18e/fb1/f3c18efb10ce917dddc88804e18cce36.jpg" alt="image"><br><br>  Counter, you can improve if you change the firmware of the microcontroller, so that the microcontroller measures the current value (using a current sensor) in the circuit and feeds them into the USB program, and the resistance value of the circuit disappears into the manual. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/820/3ce/9ee/8203ce9eefedd8691a191e4475a04588.jpg" alt="image"><br><br>  In order for the USB program to work, you need to install <a href="http://www.microsoft.com/ru-ru/download/details.aspx%3Fid%3D24872">Framework 4.0</a> or later.  If we turn on the USB-program on Windows 7 or 8, then we need to enable it, as from the Administrator. <br><br>  The USB program can process an unlimited number of connected counters, for this you need to choose to open the program and once again select the HID-compatible device from the list down (highlighted in black).  The devices will list down in the order in which they are included in the computer. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e3/de5/741/1e3de5741de7021b885967f87a22b0ba.jpg" alt="image"><br><br>  In the USB program, you can also set the noise voltage threshold (highlighted in green), which will take for 0 volts all values ‚Äã‚Äãnot exceeding the selected one for the noise threshold in the example indicated 0.05 V. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3e5/b26/d19/3e5b26d192c8f92c667c9adf5d3b1b44.jpg" alt="image"><br>  It is noticed that in Windows XP, sometimes the program may not work.  To do this, you need to clear the event log in front of the DC energy meter, how to clean it, and where it is located <a href="http://adminhome.ru/operatsionnye-sistemy/zhurnal-sobytij-windows.html">here</a> . <br><br><h5>  Algorithm USB-program to calculate the energy of DC: </h5><br>  The USB program receives the measured voltage from the microcontroller, then divides it into the input resistance, a current is obtained.  After that, the measured voltage is multiplied by the input value of the voltage multiplier, the actual voltage is obtained, which is fed to the counter up to the divider.  This real voltage is multiplied with the current and integrated over time, the energy value is obtained. <br><br><h6>  Link to USB program: </h6>  <a href="https://yadi.sk/d/CMS6Up4ZJzDYf">yadi.sk/d/CMS6Up4ZJzDYf</a> <br><h6>  Link to the source code of the si USB program </h6>  <a href="https://github.com/neremin/USB_Voltmeter">github.com/neremin/USB_Voltmeter</a> <br><h6>  Link to the circuit simulation in Proteus, and to the PIC controller firmware for quartz 20 Mhz: </h6>  <a href="http://yadi.sk/d/c76mzfURM9PqG">yadi.sk/d/c76mzfURM9PqG</a> <br><h6>  Link to firmware sources (asm, c) and firmware for quartz 4 Mhz: </h6>  <a href="http://yadi.sk/d/wA4p7RFjM9Qk2">yadi.sk/d/wA4p7RFjM9Qk2</a> <br><br><h6>  USB program development: </h6>  <a href="http://vk.com/neremin">Nikolay Eremin</a> <br><h6>  Project management: </h6>  <a href="http://vk.com/id21741100">Julian Baryshnikov</a> <br><br><h6>  Thanks: </h6><br>  Moty Mizrachi for the disinterested presentation of a USB voltmeter on his website, as well as correspondence tips. <br>  Roman Verinsky and Vitaly Pavlov for disinterested help and advice on soldering and flashing microcontrollers. <br>  Vitaly Azarov for disinterested advice on formulas and constructing a scheme for measuring DC energy. <br>  Urry for disinterestedly checking the circuit in the gland and fixing the firmware for quartz 20 Mhz. <br>  Alexandra Medyanikova for disinterested photographing the finished circuit in the gland. </div><p>Source: <a href="https://habr.com/ru/post/220955/">https://habr.com/ru/post/220955/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220941/index.html">SKALA - ChNPP computer, history of creation</a></li>
<li><a href="../220947/index.html">AdMob, Qt 5.2 and Android or what happens when there is no answer on the Internet</a></li>
<li><a href="../220949/index.html">New requirements for Stanford University passwords: a balance between length and complexity</a></li>
<li><a href="../220951/index.html">Yandex lost 10% of capitalization per day</a></li>
<li><a href="../220953/index.html">HD FPV on Raspberry Pi. Bug work</a></li>
<li><a href="../220957/index.html">Interpersonal hernia or What is common in the climate in the team and back problems</a></li>
<li><a href="../220959/index.html">I vs openSUSE</a></li>
<li><a href="../220961/index.html">Pro layout, dependency hell and backward compatibility</a></li>
<li><a href="../220963/index.html">Arduino UNO plays in 2048 with a field size of 8x8</a></li>
<li><a href="../220965/index.html">Creating a media platform using CMS Drupal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>