<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calculation of certain integrals: basic algorithms</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This publication describes the simplest methods for calculating integrals of functions of one variable on an interval, also called quadrature formulas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calculation of certain integrals: basic algorithms</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/u9/v3/cz/u9v3czzjh1wakdvjgj5u64tyxhy.gif" alt="image"><br>  This publication describes the simplest methods for calculating integrals of functions of one variable on an interval, also called quadrature formulas.  Typically, these methods are implemented in standard math libraries, such as the <a href="https://www.gnu.org/software/gsl/">GNU Scientific Library</a> for C, <a href="https://www.scipy.org/">SciPy</a> for Python, and others.  The publication aims to demonstrate how these methods work "under the hood", and to pay attention to some questions about the accuracy and performance of algorithms.  I would also like to note the connection of quadrature formulas and methods for the numerical integration of ordinary differential equations, about which I want to write another publication. </p><a name="habracut"></a><br><h3 id="opredelenie-integrala">  Definition of the integral </h3><br><p>  Integral (Riemann function) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">f</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">x</span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.418ex" height="2.66ex" viewBox="0 -832 1902 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-29" x="1512" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> f (x) </script>  on the segment <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6"><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">a</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">b</span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.555ex" height="2.66ex" viewBox="0 -832 1961.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-61" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-3B" x="808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-62" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-5D" x="1682" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> [a; b] </script>  called the following limit: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-12"><span class="MJXp-mtext" id="MJXp-Span-13">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">n</span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">b</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">a</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">f</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">x</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">x</span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-27">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">i</span><span class="MJXp-msubsup" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-32" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-33">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">x</span><span class="MJXp-mtext" id="MJXp-Span-40">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">o</span><span class="MJXp-mn" id="MJXp-Span-43">0</span></span></span><span class="MJXp-mtext" id="MJXp-Span-44">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">u</span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-53"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">n</span><span class="MJXp-mo" id="MJXp-Span-55">‚àí</span><span class="MJXp-mn" id="MJXp-Span-56">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-49"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">i</span><span class="MJXp-mo" id="MJXp-Span-51">=</span><span class="MJXp-mn" id="MJXp-Span-52">0</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">f</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-59">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">x</span><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-68" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">i</span><span class="MJXp-mo" id="MJXp-Span-70">+</span><span class="MJXp-mn" id="MJXp-Span-71">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-75" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-78">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-79">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-81">1</span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="58.661ex" height="3.142ex" viewBox="0 -935.7 25256.8 1352.7" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-69" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-6E" x="595" y="0"></use><g transform="translate(1196,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-62" x="511" y="499"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-61" x="511" y="-210"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-66" x="2031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-28" x="2582" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="2971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-29" x="3544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-64" x="3933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="4457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-3D" x="5307" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-6C" x="6613" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-69" x="6912" y="0"></use><g transform="translate(7257,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-44" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-65" x="1182" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-6C" x="1648" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-74" x="1947" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-61" x="2308" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="2838" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-74" x="3764" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-6F" x="4125" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-30" x="4611" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-73" x="12100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-75" x="12570" y="0"></use><g transform="translate(13142,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,403)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-31" x="1379" y="0"></use></g><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-30" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-66" x="15450" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-28" x="16000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="16640" y="0"></use><g transform="translate(17212,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-69" x="488" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-29" x="17902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-28" x="18292" y="0"></use><g transform="translate(18681,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-2B" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-2212" x="20725" y="0"></use><g transform="translate(21725,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-29" x="22642" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-2C" x="23032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-28" x="23977" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-31" x="24366" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-29" x="24867" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> \ int_a ^ bf (x) dx = \ lim _ {\ Delta x \ to 0} \ sum_ {i = 0} ^ {n-1} f (\ xi_i) (x_ {i + 1} - x_i), ~ ~ (1) </script></p><br><p>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mtext" id="MJXp-Span-84">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">x</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-92">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">x</span><span class="MJXp-mtext" id="MJXp-Span-96">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">e</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">i</span><span class="MJXp-mo" id="MJXp-Span-107">+</span><span class="MJXp-mn" id="MJXp-Span-108">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-112" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-113">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.795ex" height="2.539ex" viewBox="0 -780.1 16703.5 1093.4" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-44" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-65" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-6C" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-74" x="1843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-61" x="2205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="2734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-3D" x="3584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-6D" x="4891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-61" x="5769" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="6299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-6C" x="7121" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-62" x="7420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-72" x="7849" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-61" x="8301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-63" x="8830" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-65" x="9264" y="0"></use><g transform="translate(9730,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-2B" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMAIN-2212" x="11773" y="0"></use><g transform="translate(12774,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-72" x="13941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-62" x="14393" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-72" x="14822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-61" x="15274" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-63" x="15803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420867/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6ShAtEc3bXiA0naUunOKzvpSxJQ#MJMATHI-65" x="16237" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> \ Delta x = \ max \ lbrace x_ {i + 1} - x_i \ rbrace </script>  - the fineness of splitting, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-120"><span class="MJXp-msubsup" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-123" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-5"> x_0 = a </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-126"><span class="MJXp-msubsup" id="MJXp-Span-127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-129" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-6"> x_n = b </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-mtext" id="MJXp-Span-133">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">x</span><span class="MJXp-msubsup" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-137" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> \ xi_i </script>  - an arbitrary number on the segment <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-138"><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-142" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-146" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">i</span><span class="MJXp-mo" id="MJXp-Span-148">+</span><span class="MJXp-mn" id="MJXp-Span-149">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> [x_i; x_ {i + 1}] </script>  . </p><br><p>  If the integral of the function exists, then the limit value is the same regardless of the partition, if only it is quite small. <br><img src="https://habrastorage.org/webt/v7/8-/m1/v78-m1x-bgt79lmesfocurqftek.png" alt="image"><br>  The geometrical definition is more obvious - the integral is equal to the area of ‚Äã‚Äãa curvilinear trapezoid, bounded by the axis 0 <em>x</em> , the graph of the function and the straight lines <em>x = a</em> and <em>x = b</em> (the shaded area in the figure). </p><br><h3 id="kvadraturnye-formuly">  Quadrature formulas </h3><br><p>  The definition of integral (1) can be rewritten as </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">I</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-154">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">n</span><span class="MJXp-msubsup" id="MJXp-Span-157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">b</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">a</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">f</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">x</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">x</span><span class="MJXp-mtext" id="MJXp-Span-167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">x</span><span class="MJXp-msubsup" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-176" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">b</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">a</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-183">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">u</span><span class="MJXp-msubsup" id="MJXp-Span-186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">n</span><span class="MJXp-mo" id="MJXp-Span-194">‚àí</span><span class="MJXp-mn" id="MJXp-Span-195">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">i</span><span class="MJXp-mo" id="MJXp-Span-190">=</span><span class="MJXp-mn" id="MJXp-Span-191">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-198" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">f</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-201">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">x</span><span class="MJXp-msubsup" id="MJXp-Span-203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-205" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-207" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-208">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-209">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-211">2</span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> I = \ int_a ^ b f (x) dx \ approx I_n = (b - a) \ sum_ {i = 0} ^ {n-1} w_i f (\ xi_i), ~~ (2) </script></p><br><p>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-213"><span class="MJXp-msubsup" id="MJXp-Span-214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-216" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> w_i </script>  - weight coefficients, the sum of which must be equal to 1, and the coefficients themselves - tend to zero with increasing number <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> n </script>  points at which the function is calculated. </p><br><p>  Expression (2) is the basis of all quadrature formulas (that is, formulas for the approximate calculation of the integral).  The challenge is to select points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-219"><span class="MJXp-mtext" id="MJXp-Span-220">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">e</span><span class="MJXp-mtext" id="MJXp-Span-227">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">x</span><span class="MJXp-msubsup" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-231" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-232">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> \ lbrace \ xi_i \ rbrace </script>  and weight <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-239"><span class="MJXp-msubsup" id="MJXp-Span-240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-242" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> w_i </script>  so that the sum on the right side approximates the required integral as precisely as possible. </p><br><h3 id="vychislitelnaya-zadacha">  Computational problem </h3><br><p>  Set function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">f</span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">x</span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> f (x) </script>  for which there is an algorithm for calculating values ‚Äã‚Äãat any point of the segment <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">a</span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">b</span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> [a; b] </script>  (meaning the points represented by a floating-point number ‚Äî no <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D1%2583%25D0%25BD%25D0%25BA%25D1%2586%25D0%25B8%25D1%258F_%25D0%2594%25D0%25B8%25D1%2580%25D0%25B8%25D1%2585%25D0%25BB%25D0%25B5">Dirichlet functions</a> there!). </p><br><p>  Required to find the approximate value of the integral <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mtext" id="MJXp-Span-255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">n</span><span class="MJXp-msubsup" id="MJXp-Span-258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">b</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">a</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">f</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">x</span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> \ int_a ^ b f (x) dx </script>  . <br>  Solutions will be implemented in Python 3.6. </p><br><p>  The integral method is used to test the methods. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-268"><span class="MJXp-mtext" id="MJXp-Span-269">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">n</span><span class="MJXp-msubsup" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-275"><span class="MJXp-mn" id="MJXp-Span-276">3</span><span class="MJXp-mrow" id="MJXp-Span-277"><span class="MJXp-mo" id="MJXp-Span-278">/</span></span><span class="MJXp-mn" id="MJXp-Span-279">2</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-274">0</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-280">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">t</span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-286">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">x</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-289">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">c</span><span class="MJXp-mrow" id="MJXp-Span-294"><span class="MJXp-mn" id="MJXp-Span-295">1</span></span><span class="MJXp-mrow" id="MJXp-Span-296"><span class="MJXp-mtext" id="MJXp-Span-297">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">t</span><span class="MJXp-mrow" id="MJXp-Span-302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">x</span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-305">1</span><span class="MJXp-mrow" id="MJXp-Span-306"><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-308">16</span></span></span><span class="MJXp-mtext" id="MJXp-Span-309">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">t</span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">x</span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-319">17</span><span class="MJXp-mrow" id="MJXp-Span-320"><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-322">4</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> \ int_0 ^ {3/2} \ left [2x + \ frac {1} {\ sqrt {x + 1/16}} \ right] dx = 17/4 </script>  . </p><br><h3 id="kusochno-postoyannaya-approksimaciya">  Piece-constant approximation </h3><br><p>  The ideally simplest quadrature formulas arise from the use of the expression (1) "in the forehead": </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-323"><span class="MJXp-msubsup" id="MJXp-Span-324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-326" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-328">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">u</span><span class="MJXp-msubsup" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">n</span><span class="MJXp-mo" id="MJXp-Span-339">‚àí</span><span class="MJXp-mn" id="MJXp-Span-340">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">i</span><span class="MJXp-mo" id="MJXp-Span-335">=</span><span class="MJXp-mn" id="MJXp-Span-336">0</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">f</span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-343">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">x</span><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-347" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-352" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">i</span><span class="MJXp-mo" id="MJXp-Span-354">+</span><span class="MJXp-mn" id="MJXp-Span-355">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-359" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-18"> I_n = \ sum_ {i = 0} ^ {n-1} f (\ xi_i) (x_ {i + 1} - x_i) </script></p><br><p>  Since  from the method of splitting a segment of dots <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-361"><span class="MJXp-mtext" id="MJXp-Span-362">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">e</span><span class="MJXp-msubsup" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-371" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-372">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> \ lbrace x_i \ rbrace </script>  and point selection <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-379"><span class="MJXp-mtext" id="MJXp-Span-380">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">e</span><span class="MJXp-mtext" id="MJXp-Span-387">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">x</span><span class="MJXp-msubsup" id="MJXp-Span-389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-391" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-392">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> \ lbrace \ xi_i \ rbrace </script>  the value of the limit does not depend, then we will select them so that they are conveniently calculated - for example, we take the partitioning uniform, and for the points of calculation of the function we consider the options: 1) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-399"><span class="MJXp-mtext" id="MJXp-Span-400">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">x</span><span class="MJXp-msubsup" id="MJXp-Span-402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-404" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-408" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> \ xi_i = x_i </script>  ;  2) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-409"><span class="MJXp-mtext" id="MJXp-Span-410">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">x</span><span class="MJXp-msubsup" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-414" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-415" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-418" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">i</span><span class="MJXp-mo" id="MJXp-Span-420">+</span><span class="MJXp-mn" id="MJXp-Span-421">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> \ xi_i = x_ {i + 1} </script>  ;  3) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-422"><span class="MJXp-mtext" id="MJXp-Span-423">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">x</span><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-427" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-432" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-433" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-436" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">i</span><span class="MJXp-mo" id="MJXp-Span-438">+</span><span class="MJXp-mn" id="MJXp-Span-439">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-441"><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-443">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ xi_i = (x_i + x_ {i + 1}) / 2 </script>  . </p><br><p>  We obtain the methods of left rectangles, right rectangles and rectangles with a midpoint, respectively. </p><br><div class="spoiler">  <b class="spoiler_title">Implementation</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_rectangle_rule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func, a, b, nseg, frac)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""  ."""</span></span> dx = <span class="hljs-number"><span class="hljs-number">1.0</span></span> * (b - a) / nseg sum = <span class="hljs-number"><span class="hljs-number">0.0</span></span> xstart = a + frac * dx <span class="hljs-comment"><span class="hljs-comment"># 0 &lt;= frac &lt;= 1    , #    , #     dx for i in range(npoints): sum += func(xstart + i * dx) return sum * dx def left_rectangle_rule(func, a, b, nseg): """  """ return _rectangle_rule(func, a, b, nseg, 0.0) def right_rectangle_rule(func, a, b, nseg): """  """ return _rectangle_rule(func, a, b, npoints, 1.0) def midpoint_rectangle_rule(func, a, b, nseg): """    """ return _rectangle_rule(func, a, b, nseg, 0.5)</span></span></code> </pre> </div></div><br><p>  To analyze the performance of quadrature formulas, we construct a graph of the error in the coordinates ‚Äúthe number of points - the difference between the numerical result and the exact one‚Äù. </p><br><p><img src="https://habrastorage.org/webt/ph/s1/hn/phs1hnoimtbjlywmsxy14ucmlcq.png" alt="image"></p><br><p>  What can be noticed: </p><br><ol><li>  The formula with a midpoint is much more accurate than with the right or left points. </li><li>  The error of a formula with a midpoint drops faster than the other two </li><li>  With a very fine partition, the error of the formula with the midpoint begins to increase <br>  The first two points are related to the fact that the formula of rectangles with a midpoint has the second order of approximation, i.e. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-444"><span class="MJXp-mrow" id="MJXp-Span-445"><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-449" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-450" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">I</span><span class="MJXp-mrow" id="MJXp-Span-452"><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">O</span><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-457">1</span><span class="MJXp-mrow" id="MJXp-Span-458"><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-462" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> | I_n - I | = O (1 / n ^ 2) </script>  , and the formulas of the right and left rectangles are the first order, i.e. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-464"><span class="MJXp-mrow" id="MJXp-Span-465"><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-469" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">I</span><span class="MJXp-mrow" id="MJXp-Span-472"><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">O</span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-477">1</span><span class="MJXp-mrow" id="MJXp-Span-478"><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">n</span><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> | I_n - I | = O (1 / n) </script>  . <br>  The increase in the error during the grinding of the integration step is associated with the increase in the rounding error in the summation of a large number of terms.  This error grows like <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-482"><span class="MJXp-mrow" id="MJXp-Span-483"><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-487" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">I</span><span class="MJXp-mrow" id="MJXp-Span-490"><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">O</span><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-495">1</span><span class="MJXp-mrow" id="MJXp-Span-496"><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">n</span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> | I_n - I | = O (1 / n) </script>  that does not allow to achieve machine accuracy when integrated. <br>  <strong>Conclusion: the</strong> methods of rectangles with right and left points have low accuracy, which also slowly grows with the refinement of the partition.  Therefore, they only make sense for demonstration purposes.  The method of rectangles with a midpoint has a higher approximation order, which gives it chances to be used in real applications (more on this below). </li></ol><br><h3 id="kusochno-lineynaya-approksimaciya">  Piecewise linear approximation </h3><br><p>  The next logical step is to approximate an integrable function on each of the sub-segments by a linear function, which gives the quadrature trapezium formula: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-500"><span class="MJXp-msubsup" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-503" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-505">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">u</span><span class="MJXp-msubsup" id="MJXp-Span-508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">n</span><span class="MJXp-mo" id="MJXp-Span-516">‚àí</span><span class="MJXp-mn" id="MJXp-Span-517">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">i</span><span class="MJXp-mo" id="MJXp-Span-512">=</span><span class="MJXp-mn" id="MJXp-Span-513">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-518">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">c</span><span class="MJXp-mrow" id="MJXp-Span-523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">f</span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-528" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">f</span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-535" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">i</span><span class="MJXp-mo" id="MJXp-Span-537">+</span><span class="MJXp-mn" id="MJXp-Span-538">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-539" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-540"><span class="MJXp-mn" id="MJXp-Span-541">2</span></span><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-545" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">i</span><span class="MJXp-mo" id="MJXp-Span-547">+</span><span class="MJXp-mn" id="MJXp-Span-548">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-552" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-554">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-555">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-557">3</span><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-27"> I_n = \ sum_ {i = 0} ^ {n-1} \ frac {f (x_i) + f (x_ {i + 1})} {2} (x_ {i + 1} - x_i) ~~ ( 3) </script></p><br><p><img src="https://habrastorage.org/webt/bo/u_/kq/bou_kqhspiicqeppteokzj-bivc.png" alt="image"><br>  Illustration of the trapezoid method for <em>n</em> = 1 and <em>n</em> = 2. </p><br><p>  In the case of a uniform grid, the lengths of all segments of the partition are equal, and the formula has the form </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-559"><span class="MJXp-msubsup" id="MJXp-Span-560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-562" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">h</span><span class="MJXp-mtext" id="MJXp-Span-565">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">t</span><span class="MJXp-mo" id="MJXp-Span-570" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-571">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">c</span><span class="MJXp-mrow" id="MJXp-Span-576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">f</span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">a</span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">f</span><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">b</span><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-586"><span class="MJXp-mn" id="MJXp-Span-587">2</span></span><span class="MJXp-mo" id="MJXp-Span-588" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-589">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">u</span><span class="MJXp-msubsup" id="MJXp-Span-592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">n</span><span class="MJXp-mo" id="MJXp-Span-600">‚àí</span><span class="MJXp-mn" id="MJXp-Span-601">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">i</span><span class="MJXp-mo" id="MJXp-Span-596">=</span><span class="MJXp-mn" id="MJXp-Span-597">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">f</span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">a</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">h</span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-609">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">t</span><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-617">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">h</span><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-620">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">c</span><span class="MJXp-mrow" id="MJXp-Span-625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">a</span></span><span class="MJXp-mrow" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">n</span></span><span class="MJXp-mtext" id="MJXp-Span-630">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-631">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-633">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">a</span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-28"> I_n = h \ left (\ frac {f (a) + f (b)} {2} + \ sum_ {i = 1} ^ {n-1} f (a + ih) \ right), ~ h = \ frac {ba} {n} ~~ (3a) </script></p><br><div class="spoiler">  <b class="spoiler_title">Implementation</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trapezoid_rule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func, a, b, nseg)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""  nseg -  ,    [a;b]"""</span></span> dx = <span class="hljs-number"><span class="hljs-number">1.0</span></span> * (b - a) / nseg sum = <span class="hljs-number"><span class="hljs-number">0.5</span></span> * (func(a) + func(b)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, nseg): sum += func(a + i * dx) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum * dx</code> </pre> </div></div><br><p>  By plotting the error from the number of split points, we see that the trapezoid method also has a second order of approximation and generally gives results that are slightly different from the middle point rectangle method (hereinafter, it is just the rectangle method). <br><img src="https://habrastorage.org/webt/zu/j_/zj/zuj_zjj9ey9nmiiymayupp0ikxg.png" alt="image"></p><br><h3 id="kontrol-tochnosti-vychisleniya">  Accuracy control </h3><br><p>  Setting the number of split points as an input parameter is not very practical, since it is usually required to calculate the integral not with a given partition density, but with a given error.  If the integrand function is known in advance, then it is possible to estimate the error in advance and choose such an integration step so that the specified accuracy is certainly achieved.  But this is rarely the case in practice (and in general, is it not easier with a known function in advance and the integral itself to be tabulated in advance?), Therefore, a procedure is necessary to automatically adjust the step to a given error. </p><br><p>  How to implement it?  One of the simple methods for estimating an error ‚Äî the <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B0%25D0%25B2%25D0%25B8%25D0%25BB%25D0%25BE_%25D0%25A0%25D1%2583%25D0%25BD%25D0%25B3%25D0%25B5">Runge rule</a> ‚Äî the difference in the values ‚Äã‚Äãof the integrals calculated over <em>n</em> and 2 <em>n</em> points, gives an estimate of the error: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-636"><span class="MJXp-mtext" id="MJXp-Span-637">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">t</span><span class="MJXp-msubsup" id="MJXp-Span-642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-644" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-645">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">n</span></span></span><span class="MJXp-mtext" id="MJXp-Span-647">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">x</span><span class="MJXp-mrow" id="MJXp-Span-654"><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-658" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-659">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-661" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-664" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mrow" id="MJXp-Span-665"><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ Delta_ {2n} \ approx | I_ {2n} - I_n | </script>  .  The trapezoid method is more convenient for doubling the fineness of a partition than the method of rectangles with a central point.  When calculating by the trapezoid method, to double the number of points, we need new values ‚Äã‚Äãof the function only in the middle of the segments of the previous partition, i.e.  The previous approximation of the integral can be used to calculate the following. </p><br><div class="spoiler">  <b class="spoiler_title">What else is good method of rectangles</b> <div class="spoiler_text"><p>  The method of rectangles does not require to calculate the function values ‚Äã‚Äãat the ends of the segment.  This means that it can be used for functions that have integrable singularities at the edges of a segment (for example, sin <em>x</em> / <em>x</em> or <em>x</em> <sup>-1/2</sup> from 0 to 1).  Therefore, the extrapolation method shown below will work in the same way for the rectangle method.  The only difference from the trapezoidal method is that by decreasing the step, the result of previous calculations is doubled, but the number of points can be <em>tripled</em> , and then the previous value of the integral can also be used to calculate the new one.  Formulas for extrapolation in this case must be adjusted to a different ratio of integration steps. </p></div></div><br><p>  From here we get the following code for the trapezoid method with accuracy control: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trapezoid_rule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func, a, b, rtol = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1e-8</span></span></span></span><span class="hljs-function"><span class="hljs-params">, nseg0 = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""  rtol -     nseg0 -    """</span></span> nseg = nseg0 old_ans = <span class="hljs-number"><span class="hljs-number">0.0</span></span> dx = <span class="hljs-number"><span class="hljs-number">1.0</span></span> * (b - a) / nseg ans = <span class="hljs-number"><span class="hljs-number">0.5</span></span> * (func(a) + func(b)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, nseg): ans += func(a + i * dx) ans *= dx err_est = max(<span class="hljs-number"><span class="hljs-number">1</span></span>, abs(ans)) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (err_est &gt; abs(rtol * ans)): old_ans = ans ans = <span class="hljs-number"><span class="hljs-number">0.5</span></span> * (ans + midpoint_rectangle_rule(func, a, b, nseg)) <span class="hljs-comment"><span class="hljs-comment">#      #       nseg *= 2 err_est = abs(ans - old_ans) return ans</span></span></code> </pre> <br><p>  With this approach, the integrand will not be calculated several times at one point, and all calculated values ‚Äã‚Äãare used for the final result. </p><br><p>  But is it possible to achieve higher accuracy with the same amount of function calculations?  It turns out that it is possible, there are formulas that work more precisely than the trapezoid method on the same grid. </p><br><h3 id="kusochno-parabolicheskaya-approksimaciya">  Piecewise parabolic approximation </h3><br><p>  The next step is to approximate the function with elements of parabolas.  This requires that the number of segments of the partition is even, then parabolas can be drawn through triples of points with abscissas {( <em>x</em> <sub>0</sub> = <em>a</em> , <em>x</em> <sub>1</sub> , <em>x</em> <sub>2</sub> ), ( <em>x</em> <sub>2</sub> , <em>x</em> <sub>3</sub> , <em>x</em> <sub>4</sub> ), ..., ( <em>x</em> <sub><em>n</em> -2</sub> , <em>x</em> <sub><em>n</em> -1</sub> , <em>x <sub>n</sub></em> = <em>b</em> )}. </p><br><p><img src="https://habrastorage.org/webt/ko/rw/ll/korwllkbzphjpl_uvs10zpfnx6u.png"><br>  Illustration of the piecewise parabolic approximation at 3 and 5 points ( <em>n</em> = 2 and <em>n</em> = 3). </p><br><p>  Approaching the integral of the function on each of the segments [ <em>x <sub>k</sub></em> ;  <em>x</em> <sub><em>k</em> +2</sub> ] integral of a parabolic approximation on this segment and considering the points evenly distributed ( <em>x</em> <sub><em>k</em> +1</sub> = <em>x <sub>k</sub></em> + <em>h</em> ), we obtain <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25BE%25D1%2580%25D0%25BC%25D1%2583%25D0%25BB%25D0%25B0_%25D0%25A1%25D0%25B8%25D0%25BC%25D0%25BF%25D1%2581%25D0%25BE%25D0%25BD%25D0%25B0">the Simpson formula</a> : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-667"><span class="MJXp-msubsup" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-670" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">s</span><span class="MJXp-mo" id="MJXp-Span-676">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-679">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">u</span><span class="MJXp-msubsup" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">n</span><span class="MJXp-mrow" id="MJXp-Span-690"><span class="MJXp-mo" id="MJXp-Span-691">/</span></span><span class="MJXp-mn" id="MJXp-Span-692">2</span><span class="MJXp-mo" id="MJXp-Span-693">‚àí</span><span class="MJXp-mn" id="MJXp-Span-694">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">i</span><span class="MJXp-mo" id="MJXp-Span-686">=</span><span class="MJXp-mn" id="MJXp-Span-687">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-695">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">c</span><span class="MJXp-mrow" id="MJXp-Span-700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">h</span></span><span class="MJXp-mrow" id="MJXp-Span-702"><span class="MJXp-mn" id="MJXp-Span-703">3</span></span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">f</span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-709" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-710">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-714">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">f</span><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-719" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-720">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">i</span><span class="MJXp-mo" id="MJXp-Span-722">+</span><span class="MJXp-mn" id="MJXp-Span-723">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">f</span><span class="MJXp-mo" id="MJXp-Span-727" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-730" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-731">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">i</span><span class="MJXp-mo" id="MJXp-Span-733">+</span><span class="MJXp-mn" id="MJXp-Span-734">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mspace" id="MJXp-Span-738" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-740">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">c</span><span class="MJXp-mrow" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">h</span></span><span class="MJXp-mrow" id="MJXp-Span-747"><span class="MJXp-mn" id="MJXp-Span-748">3</span></span><span class="MJXp-mo" id="MJXp-Span-749" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">f</span><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">a</span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-755">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">f</span><span class="MJXp-mo" id="MJXp-Span-757" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">a</span><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">h</span><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-763">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">f</span><span class="MJXp-mo" id="MJXp-Span-765" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">a</span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-768">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">h</span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-776">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">f</span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">h</span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">f</span><span class="MJXp-mo" id="MJXp-Span-784" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">b</span><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-788">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-789">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-790" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-791">4</span><span class="MJXp-mo" id="MJXp-Span-792" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-30"> I_ {Simps, n} = \ sum_ {i = 0} ^ {n / 2-1} \ frac {h} {3} [f (x_ {2i}) + 4f (x_ {2i + 1}) + f (x_ {2i + 2})] = \\ = \ frac {h} {3} [f (a) + 4f (a + h) + 2f (a + 2h) + ... + 4f (bh) + f (b)] ~~ (4) </script></p><br><p>  Formula (4) directly yields the "naive" implementation of the Simpson method: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simpson_rule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func, a, b, nseg)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""  nseg -  ,    [a;b]"""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> nseg%<span class="hljs-number"><span class="hljs-number">2</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>: nseg += <span class="hljs-number"><span class="hljs-number">1</span></span> dx = <span class="hljs-number"><span class="hljs-number">1.0</span></span> * (b - a) / nseg sum = (func(a) + <span class="hljs-number"><span class="hljs-number">4</span></span> * func(a + dx) + func(b)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, nseg / <span class="hljs-number"><span class="hljs-number">2</span></span>): sum += <span class="hljs-number"><span class="hljs-number">2</span></span> * func(a + (<span class="hljs-number"><span class="hljs-number">2</span></span> * i) * dx) + <span class="hljs-number"><span class="hljs-number">4</span></span> * func(a + (<span class="hljs-number"><span class="hljs-number">2</span></span> * i + <span class="hljs-number"><span class="hljs-number">1</span></span>) * dx) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum * dx / <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> </div></div><br><p>  To estimate the error, you can use the same calculation of the integral with steps <em>h</em> and <em>h</em> / 2 - but bad luck, when calculating the integral with a smaller step, you will have to discard the result of the previous calculation, although half of the new calculations of the function will be at the same points as before. </p><br><p>  Fortunately, you can avoid wasting computer time by implementing the Simpson method in a more ingenious way.  Looking closely, we note that the integral according to the Simpson formula can be represented through two integrals using the trapezoid formula with different steps.  This is most clearly seen in the basic case of approximation of the integral over three points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-793"><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">a</span><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-799" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-800" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-802">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">a</span><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">h</span><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-810" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-813">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">a</span><span class="MJXp-mo" id="MJXp-Span-816" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-817">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">h</span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-822" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> (a, f_0), ~ (a + h, f_1), ~ (a + 2h, f_2) </script>  : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-824"><span class="MJXp-msubsup" id="MJXp-Span-825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-827" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">s</span><span class="MJXp-mo" id="MJXp-Span-833">,</span><span class="MJXp-mn" id="MJXp-Span-834">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-836">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">c</span><span class="MJXp-mrow" id="MJXp-Span-841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">h</span></span><span class="MJXp-mrow" id="MJXp-Span-843"><span class="MJXp-mn" id="MJXp-Span-844">3</span></span><span class="MJXp-mo" id="MJXp-Span-845" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-848" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-850">4</span><span class="MJXp-msubsup" id="MJXp-Span-851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-853" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-854" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-857" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-858" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-860">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">c</span><span class="MJXp-mrow" id="MJXp-Span-865"><span class="MJXp-mn" id="MJXp-Span-866">4</span></span><span class="MJXp-mrow" id="MJXp-Span-867"><span class="MJXp-mn" id="MJXp-Span-868">3</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">h</span><span class="MJXp-mtext" id="MJXp-Span-870">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">t</span><span class="MJXp-mo" id="MJXp-Span-875" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-876">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">c</span><span class="MJXp-mrow" id="MJXp-Span-881"><span class="MJXp-msubsup" id="MJXp-Span-882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-884" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-888" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-889"><span class="MJXp-mn" id="MJXp-Span-890">2</span></span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-892">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">c</span><span class="MJXp-mrow" id="MJXp-Span-897"><span class="MJXp-msubsup" id="MJXp-Span-898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-900" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-904" style="vertical-align: -0.4em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-905"><span class="MJXp-mn" id="MJXp-Span-906">2</span></span><span class="MJXp-mtext" id="MJXp-Span-907">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">t</span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-915">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">c</span><span class="MJXp-mrow" id="MJXp-Span-920"><span class="MJXp-mn" id="MJXp-Span-921">1</span></span><span class="MJXp-mrow" id="MJXp-Span-922"><span class="MJXp-mn" id="MJXp-Span-923">3</span></span><span class="MJXp-mtext" id="MJXp-Span-924">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">t</span><span class="MJXp-mn" id="MJXp-Span-929">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">h</span><span class="MJXp-mtext" id="MJXp-Span-931">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">c</span><span class="MJXp-mrow" id="MJXp-Span-936"><span class="MJXp-msubsup" id="MJXp-Span-937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-939" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-940" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-943" style="vertical-align: -0.4em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-944"><span class="MJXp-mn" id="MJXp-Span-945">2</span></span><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mspace" id="MJXp-Span-947" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-949">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">c</span><span class="MJXp-mrow" id="MJXp-Span-954"><span class="MJXp-mn" id="MJXp-Span-955">4</span><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-958" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">p</span><span class="MJXp-mo" id="MJXp-Span-963">,</span><span class="MJXp-mn" id="MJXp-Span-964">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-968" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">p</span><span class="MJXp-mo" id="MJXp-Span-973">,</span><span class="MJXp-mn" id="MJXp-Span-974">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-975"><span class="MJXp-mn" id="MJXp-Span-976">3</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> I_ {Simps, 2} = \ frac {h} {3} (f_0 + 4f_1 + f_2) = \ frac {4} {3} h \ left (\ frac {f_0 + f_1} {2} + \ frac { f_1 + f_2} {2} \ right) - \ frac {1} {3} \ cdot2h \ frac {f_0 + f_2} {2} = \\ = \ frac {4I_ {trap, 2} - I_ {trap, 1 }} {3} </script></p><br><p>  Thus, if you implement the step reduction procedure in half and store the last two trapezoid calculations, the Simpson method with accuracy control is implemented more efficiently. </p><br><div class="spoiler">  <b class="spoiler_title">Something like this...</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Quadrature</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    """</span></span> __sum = <span class="hljs-number"><span class="hljs-number">0.0</span></span> __nseg = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">#    __ncalls = 0 #      def __restart(func, x0, x1, nseg0, reset_calls = True): """    .       """ if reset_calls: Quadrature.__ncalls = 0 Quadrature.__nseg = nseg0 #           nseg0 Quadrature.__sum = 0.5 * (func(x0) + func(x1)) dx = 1.0 * (x1 - x0) / nseg0 for i in range(1, nseg0): Quadrature.__sum += func(x0 + i * dx) Quadrature.__ncalls += 1 + nseg0 return Quadrature.__sum * dx def __double_nseg(func, x0, x1): """  .       """ nseg = Quadrature.__nseg dx = (x1 - x0) / nseg x = x0 + 0.5 * dx i = 0 AddedSum = 0.0 for i in range(nseg): AddedSum += func(x + i * dx) Quadrature.__sum += AddedSum Quadrature.__nseg *= 2 Quadrature.__ncalls += nseg return Quadrature.__sum * 0.5 * dx def trapezoid(func, x0, x1, rtol = 1e-10, nseg0 = 1): """     . rtol -  , nseg0 -    """ ans = Quadrature.__restart(func, x0, x1, nseg0) old_ans = 0.0 err_est = max(1, abs(ans)) while (err_est &gt; abs(rtol * ans)): old_ans = ans ans = Quadrature.__double_nseg(func, x0, x1) err_est = abs(old_ans - ans) print("Total function calls: " + str(Quadrature.__ncalls)) return ans def simpson(func, x0, x1, rtol = 1.0e-10, nseg0 = 1): """     . rtol -  , nseg0 -    """ old_trapez_sum = Quadrature.__restart(func, x0, x1, nseg0) new_trapez_sum = Quadrature.__double_nseg(func, x0, x1) ans = (4 * new_trapez_sum - old_trapez_sum) / 3 old_ans = 0.0 err_est = max(1, abs(ans)) while (err_est &gt; abs(rtol * ans)): old_ans = ans old_trapez_sum = new_trapez_sum new_trapez_sum = Quadrature.__double_nseg(func, x0, x1) ans = (4 * new_trapez_sum - old_trapez_sum) / 3 err_est = abs(old_ans - ans) print("Total function calls: " + str(Quadrature.__ncalls)) return ans</span></span></code> </pre> </div></div><br><p>  Compare the efficiency of the trapezoid method and parabolas: </p><br><pre> <code class="hljs lua">&gt;&gt;&gt; import <span class="hljs-built_in"><span class="hljs-built_in">math</span></span> &gt;&gt;&gt; Quadrature.trapezoid(lambda x: <span class="hljs-number"><span class="hljs-number">2</span></span> * x + <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-built_in"><span class="hljs-built_in">math</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(x + <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">16</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.5</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1e-9</span></span>) Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 65537 4.250000001385811 &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature.simpson</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lambda x: 2 * x + 1 / math.sqrt(x + 1 / 16)</span></span></span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.5</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1e-9</span></span>) Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 2049 4.2500000000490985</span></span></code> </pre> <br><p>  As you can see, with both methods, the answer can be obtained with sufficiently high accuracy, but the number of calls to the integrand is strikingly different - a higher order method is 32 times more efficient! </p><br><p>  By plotting the integration error versus the number of steps, it can be verified that the order of approximation of the Simpson formula is four, i.e.  numerical integration error <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-977"><span class="MJXp-mrow" id="MJXp-Span-978"><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-982" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">s</span><span class="MJXp-mo" id="MJXp-Span-988">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">I</span><span class="MJXp-mrow" id="MJXp-Span-992"><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">O</span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-997">1</span><span class="MJXp-mrow" id="MJXp-Span-998"><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-1000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1002" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> | I_ {Simps, n} - I | = O (1 / n ^ 4) </script>  (and the integrals of cubic polynomials with the help of this formula are calculated to within rounding errors for any even <em>n</em> &gt; 0!). <br><img src="https://habrastorage.org/webt/4w/-8/jk/4w-8jkj9y4wc1g9wnn9ynlfdxsk.png" alt="image"><br>  Hence, there is such an increase in efficiency compared to the simple trapezoidal formula. </p><br><h3 id="chto-dalshe">  What's next? </h3><br><p>  The further logic of improving the accuracy of quadrature formulas, in general, is understandable - if the function continues to be approximated by higher-order polynomials, then the integral of these polynomials will more closely approximate the integral of the original function.  This approach is called the construction <a href="https://en.wikipedia.org/wiki/Newton%25E2%2580%2593Cotes_formulas">of Newton-Cotes quadrature formulas</a> .  Formulas are known up to the 8th order of approximation, but the alternating terms appear higher among the weighting factors <em>w <sub>i</sub></em> in (2), and formulas lose their stability in the calculations. </p><br><p>  Let's try to go some other way.  The error of the quadrature formula is represented as a series in powers of the integration step <em>h</em> .  A remarkable property of the trapezoidal method (and rectangles with a midpoint!) Is that for it this series consists only of even degrees: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1004"><span class="MJXp-msubsup" id="MJXp-Span-1005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1007" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">p</span><span class="MJXp-mo" id="MJXp-Span-1012">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">f</span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">a</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">b</span><span class="MJXp-mo" id="MJXp-Span-1020" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1022">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">n</span><span class="MJXp-msubsup" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">b</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">a</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">f</span><span class="MJXp-mo" id="MJXp-Span-1030" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">x</span><span class="MJXp-mo" id="MJXp-Span-1032" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">x</span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1038" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-1039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1041" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1045" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-msubsup" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1048" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1052" style="vertical-align: -0.4em;">6</span></span><span class="MJXp-msubsup" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1055" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1057" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1061">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">h</span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1064">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">c</span><span class="MJXp-mrow" id="MJXp-Span-1069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">a</span></span><span class="MJXp-mrow" id="MJXp-Span-1072"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">n</span></span><span class="MJXp-mtext" id="MJXp-Span-1074">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1075">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1076">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1078">5</span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> I_ {trap, n} [f, a, b] = \ int_a ^ bf (x) dx + C_2h ^ 2 + C_4h ^ 4 + C_6h ^ 6 + ..., ~ h = \ frac {ba} {n } ~~~ (5) </script></p><br><p>  <a href="https://en.wikipedia.org/wiki/Richardson_extrapolation">Richardson extrapolation is</a> based on finding successive approximations to this decomposition: instead of approximating the integrand function by a polynomial, the calculated approximations of the integral <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">I</span><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">h</span><span class="MJXp-mo" id="MJXp-Span-1084" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> I (h) </script>  a polynomial approximation is constructed, which at <em>h</em> = 0 should give the best approximation to the true value of the integral. </p><br><p>  The decomposition of the integration error in even powers of the partitioning step sharply accelerates the convergence of extrapolation, since  for approximation of order 2 <em>n</em> you need only <em>n</em> values ‚Äã‚Äãof the integral by the trapezoid method. </p><br><p>  If we assume that each subsequent term is less than the previous one, then we can successively exclude the degrees <em>h</em> , having integral approximations calculated with different steps.  Since the above implementation makes it easy to split the split in half, it is convenient to consider formulas for steps <em>h</em> and <em>h</em> / 2. </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1085"><span class="MJXp-msubsup" id="MJXp-Span-1086"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1088" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">p</span><span class="MJXp-mo" id="MJXp-Span-1093">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">I</span><span class="MJXp-mtext" id="MJXp-Span-1097">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">x</span><span class="MJXp-msubsup" id="MJXp-Span-1104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1106" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-1107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1109" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1110" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-1111">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1114" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">p</span><span class="MJXp-mo" id="MJXp-Span-1119">,</span><span class="MJXp-mn" id="MJXp-Span-1120">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">I</span><span class="MJXp-mtext" id="MJXp-Span-1124">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">x</span><span class="MJXp-msubsup" id="MJXp-Span-1131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1133" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1134">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">t</span><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1140">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">c</span><span class="MJXp-mrow" id="MJXp-Span-1145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">h</span></span><span class="MJXp-mrow" id="MJXp-Span-1147"><span class="MJXp-mn" id="MJXp-Span-1148">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1149">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">t</span><span class="MJXp-msubsup" id="MJXp-Span-1155"><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1157" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> I_ {trap, n} - I \ approx C_2h ^ 2; ~ I_ {trap, 2n} - I \ approx C_2 \ left (\ frac {h} {2} \ right) ^ 2 </script></p><br><p>  It is easy to show that the elimination of the highest error term of the trapezoid formula will give a simpson formula: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">I</span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1163" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">p</span><span class="MJXp-mo" id="MJXp-Span-1168">,</span><span class="MJXp-mn" id="MJXp-Span-1169">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1174" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1175">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">t</span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">c</span><span class="MJXp-mrow" id="MJXp-Span-1186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">h</span></span><span class="MJXp-mrow" id="MJXp-Span-1188"><span class="MJXp-mn" id="MJXp-Span-1189">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1190">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">t</span><span class="MJXp-msubsup" id="MJXp-Span-1196"><span class="MJXp-mo" id="MJXp-Span-1197" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1198" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">O</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1204" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1206">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">x</span><span class="MJXp-msubsup" id="MJXp-Span-1213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1215" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">p</span><span class="MJXp-mo" id="MJXp-Span-1220">,</span><span class="MJXp-mn" id="MJXp-Span-1221">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">c</span><span class="MJXp-mrow" id="MJXp-Span-1229"><span class="MJXp-msubsup" id="MJXp-Span-1230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1232" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">p</span><span class="MJXp-mo" id="MJXp-Span-1237">,</span><span class="MJXp-mn" id="MJXp-Span-1238">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1240" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1243" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">p</span><span class="MJXp-mo" id="MJXp-Span-1248">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">n</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1250"><span class="MJXp-mn" id="MJXp-Span-1251">1</span><span class="MJXp-mo" id="MJXp-Span-1252" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1253"><span class="MJXp-mn" id="MJXp-Span-1254" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1255" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1256" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1259" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">s</span><span class="MJXp-mo" id="MJXp-Span-1265">,</span><span class="MJXp-mn" id="MJXp-Span-1266">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">n</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> I = I_ {trap, 2n} - C_2 \ left (\ frac {h} {2} \ right) ^ 2 + O (h ^ 4) \ approx I_ {trap, 2n} - \ frac {I_ {trap, 2n} -I_ {trap, n}} {1-2 ^ 2} = I_ {Simps, 2n} </script></p><br><p>  Repeating a similar procedure for the Simpson formula, we get: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1268"><span class="MJXp-msubsup" id="MJXp-Span-1269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1271" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">s</span><span class="MJXp-mo" id="MJXp-Span-1277">,</span><span class="MJXp-mn" id="MJXp-Span-1278">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">I</span><span class="MJXp-mtext" id="MJXp-Span-1282">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">x</span><span class="MJXp-msubsup" id="MJXp-Span-1289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1291" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-mtext" id="MJXp-Span-1292">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">t</span><span class="MJXp-mo" id="MJXp-Span-1297" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1298">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">c</span><span class="MJXp-mrow" id="MJXp-Span-1303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">h</span></span><span class="MJXp-mrow" id="MJXp-Span-1305"><span class="MJXp-mn" id="MJXp-Span-1306">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1307">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">t</span><span class="MJXp-msubsup" id="MJXp-Span-1313"><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1315" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1316" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-1317">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1320" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">s</span><span class="MJXp-mo" id="MJXp-Span-1326">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1328" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">I</span><span class="MJXp-mtext" id="MJXp-Span-1330">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">x</span><span class="MJXp-msubsup" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1339" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-msubsup" id="MJXp-Span-1340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1342" style="vertical-align: 0.5em;">4</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> I_ {Simps, 2n} - I \ approx C_4 \ left (\ frac {h} {2} \ right) ^ 4; ~ I_ {Simps, n} - I \ approx C_4h ^ 4 </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">I</span><span class="MJXp-mo" id="MJXp-Span-1345" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1348" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">s</span><span class="MJXp-mo" id="MJXp-Span-1354">,</span><span class="MJXp-mn" id="MJXp-Span-1355">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1357" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1360" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-mtext" id="MJXp-Span-1361">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">t</span><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1367">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">c</span><span class="MJXp-mrow" id="MJXp-Span-1372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">h</span></span><span class="MJXp-mrow" id="MJXp-Span-1374"><span class="MJXp-mn" id="MJXp-Span-1375">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1376">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">t</span><span class="MJXp-msubsup" id="MJXp-Span-1382"><span class="MJXp-mo" id="MJXp-Span-1383" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1384" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1385" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">O</span><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1390" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1391" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1392">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">x</span><span class="MJXp-msubsup" id="MJXp-Span-1399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1401" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">s</span><span class="MJXp-mo" id="MJXp-Span-1407">,</span><span class="MJXp-mn" id="MJXp-Span-1408">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1411">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">c</span><span class="MJXp-mrow" id="MJXp-Span-1416"><span class="MJXp-msubsup" id="MJXp-Span-1417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1419" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">s</span><span class="MJXp-mo" id="MJXp-Span-1425">,</span><span class="MJXp-mn" id="MJXp-Span-1426">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1428" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1431" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">s</span><span class="MJXp-mo" id="MJXp-Span-1437">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">n</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1439"><span class="MJXp-mn" id="MJXp-Span-1440">1</span><span class="MJXp-mo" id="MJXp-Span-1441" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1442"><span class="MJXp-mn" id="MJXp-Span-1443" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1444" style="vertical-align: 0.5em;">4</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> I = I_ {Simps, 2n} - C_4 \ left (\ frac {h} {2} \ right) ^ 4 + O (h ^ 6) \ approx I_ {Simps, 2n} - \ frac {I_ {Simps, 2n} -I_ {Simps, n}} {1-2 ^ 4} </script></p><br><p>  If to continue, the following table appears: </p><br><table><thead><tr><th>  2nd order </th><th>  4th order </th><th>  6 order </th><th>  ... </th></tr></thead><tbody><tr><td>  <em>I</em> <sub>0,0</sub> </td><td></td><td></td></tr><tr><td>  <em>I</em> <sub>1,0</sub> </td><td>  <em>I</em> <sub>1,1</sub> </td><td></td></tr><tr><td>  <em>I</em> <sub>2,0</sub> </td><td>  <em>I</em> <sub>2,1</sub> </td><td>  <em>I</em> <sub>2,2</sub> </td></tr><tr><td>  ... </td><td>  ... </td><td>  ... </td></tr></tbody></table><br><p>  The first column contains the integrals calculated by the trapezoid method.  When going from the top row down, the split of the segment becomes twice smaller, and when going from the left column to the right, the order of approximation of the integral increases (ie, the Simpson integrals in the second column, etc.). </p><br><p>  The elements of the table, as can be derived from the decomposition (5), are related by the recurrence relation: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1445"><span class="MJXp-msubsup" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1448" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">i</span><span class="MJXp-mo" id="MJXp-Span-1450">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1455" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">i</span><span class="MJXp-mo" id="MJXp-Span-1457">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">j</span><span class="MJXp-mo" id="MJXp-Span-1459">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1460">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1462">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">c</span><span class="MJXp-mrow" id="MJXp-Span-1467"><span class="MJXp-msubsup" id="MJXp-Span-1468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1470" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">i</span><span class="MJXp-mo" id="MJXp-Span-1472">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">j</span><span class="MJXp-mo" id="MJXp-Span-1474">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1475">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1476" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1479" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">i</span><span class="MJXp-mo" id="MJXp-Span-1481">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1482">1</span><span class="MJXp-mo" id="MJXp-Span-1483">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">j</span><span class="MJXp-mo" id="MJXp-Span-1485">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1486">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1487"><span class="MJXp-mn" id="MJXp-Span-1488">1</span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1490">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">t</span><span class="MJXp-mo" id="MJXp-Span-1495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1496">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">c</span><span class="MJXp-mrow" id="MJXp-Span-1501"><span class="MJXp-msubsup" id="MJXp-Span-1502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1504" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1507"><span class="MJXp-msubsup" id="MJXp-Span-1508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1510" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1511">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">t</span><span class="MJXp-msubsup" id="MJXp-Span-1517"><span class="MJXp-mo" id="MJXp-Span-1518" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1519" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1523" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">i</span><span class="MJXp-mo" id="MJXp-Span-1525">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">j</span><span class="MJXp-mo" id="MJXp-Span-1527">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1528">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1530">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">c</span><span class="MJXp-mrow" id="MJXp-Span-1535"><span class="MJXp-msubsup" id="MJXp-Span-1536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1538" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">i</span><span class="MJXp-mo" id="MJXp-Span-1540">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">j</span><span class="MJXp-mo" id="MJXp-Span-1542">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1543">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1547" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">i</span><span class="MJXp-mo" id="MJXp-Span-1549">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1550">1</span><span class="MJXp-mo" id="MJXp-Span-1551">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">j</span><span class="MJXp-mo" id="MJXp-Span-1553">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1554">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1555"><span class="MJXp-mn" id="MJXp-Span-1556">1</span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1558"><span class="MJXp-mn" id="MJXp-Span-1559" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1560" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1561">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">j</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1563">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1564">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1565">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1567">6</span><span class="MJXp-mo" id="MJXp-Span-1568" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> I_ {i, j} = I_ {i, j-1} - \ frac {I_ {i, j-1} -I_ {i-1, j-1}} {1- \ left (\ frac {h_ {ij}} {h_i} \ right) ^ 2} = I_ {i, j-1} - \ frac {I_ {i, j-1} -I_ {i-1, j-1}} {1-2 ^ {2j}} ~~~ (6) </script></p><br><p>  The error of approximation of the integral can be estimated from the difference of formulas of different orders in one line, i.e. </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1569"><span class="MJXp-mtext" id="MJXp-Span-1570">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">t</span><span class="MJXp-msubsup" id="MJXp-Span-1575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1577" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">i</span><span class="MJXp-mo" id="MJXp-Span-1579">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1581">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">x</span><span class="MJXp-msubsup" id="MJXp-Span-1588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1590" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">i</span><span class="MJXp-mo" id="MJXp-Span-1592">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1594" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1597" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">i</span><span class="MJXp-mo" id="MJXp-Span-1599">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">j</span><span class="MJXp-mo" id="MJXp-Span-1601">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1602">1</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-41"> \ Delta_ {i, j} \ approx I_ {i, j} - I_ {i, j-1} </script></p><br><p>  The use of Richardson extrapolation along with the integration of the trapezoid <a href="https://en.wikipedia.org/wiki/Romberg%2527s_method">method</a> is called <a href="https://en.wikipedia.org/wiki/Romberg%2527s_method">the Romberg method</a> .  If the Simpson method takes into account the two previous values ‚Äã‚Äãusing the trapezoid method, the Romberg method uses all the values ‚Äã‚Äãcalculated by the trapezoid method earlier to obtain a more accurate estimate of the integral. </p><br><div class="spoiler">  <b class="spoiler_title">Implementation</b> <div class="spoiler_text"><p>  An additional method is added to the quadrature class. </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Quadrature</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    """</span></span> __sum = <span class="hljs-number"><span class="hljs-number">0.0</span></span> __nseg = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">#    __ncalls = 0 #      def __restart(func, x0, x1, nseg0, reset_calls = True): """    .       """ if reset_calls: Quadrature.__ncalls = 0 Quadrature.__nseg = nseg0 #          nseg0  Quadrature.__sum = 0.5 * (func(x0) + func(x1)) dx = 1.0 * (x1 - x0) / nseg0 for i in range(1, nseg0): Quadrature.__sum += func(x0 + i * dx) Quadrature.__ncalls += 1 + nseg0 return Quadrature.__sum * dx def __double_nseg(func, x0, x1): """  .       """ nseg = Quadrature.__nseg dx = (x1 - x0) / nseg x = x0 + 0.5 * dx i = 0 AddedSum = 0.0 for i in range(nseg): AddedSum += func(x + i * dx) Quadrature.__sum += AddedSum Quadrature.__nseg *= 2 Quadrature.__ncalls += nseg return Quadrature.__sum * 0.5 * dx def romberg(func, x0, x1, rtol = 1e-10, nseg0 = 1, maxcol = 5, reset_calls = True): """   nseg0 -     maxcol -   """ #   Itable = [[Quadrature.__restart(func, x0, x1, nseg0, reset_calls)]] i = 0 maxcol = max(0, maxcol) ans = Itable[i][i] error_est = max(1, abs(ans)) while (error_est &gt; abs(rtol * ans)): old_ans = ans i += 1 d = 4.0 ans_col = min(i, maxcol) Itable.append([Quadrature.__double_nseg(func, x0, x1)] * (ans_col + 1)) for j in range(0, ans_col): diff = Itable[i][j] - Itable[i - 1][j] Itable[i][j + 1] = Itable[i][j] + diff / (d - 1.0) d *= 4.0 ans = Itable[i][ans_col] if (maxcol &lt;= 1): #       error_est = abs(ans - Itable[i - 1][-1]) elif (i &gt; maxcol): error_est = abs(ans - Itable[i][min(i - maxcol - 1, maxcol - 1)]) else: error_est = abs(ans - Itable[i - 1][i - 1]) print("Total function calls: " + str(Quadrature.__ncalls)) return ans</span></span></code> </pre> </div></div><br><p>  Check how the high order approximation works: </p><br><pre> <code class="hljs lua">&gt;&gt;&gt; Quadrature.romberg(lambda x: <span class="hljs-number"><span class="hljs-number">2</span></span> * x + <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-built_in"><span class="hljs-built_in">math</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(x + <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.5</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1e-9</span></span>, maxcol = <span class="hljs-number"><span class="hljs-number">0</span></span>) #  Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 65537 4.250000001385811 &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature.romberg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lambda x: 2 * x + 1 / math.sqrt(x + 1/16)</span></span></span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.5</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1e-9</span></span>, maxcol = <span class="hljs-number"><span class="hljs-number">1</span></span>) #  Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 2049 4.2500000000490985 &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature.romberg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lambda x: 2 * x + 1 / math.sqrt(x + 1/16)</span></span></span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.5</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1e-9</span></span>, maxcol = <span class="hljs-number"><span class="hljs-number">4</span></span>) Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 257 4.250000001644076</span></span></code> </pre> <br><p>  We are convinced that, compared with the parabola method, the number of calls to the integrand has decreased by another 8 times.  With a further increase in the required accuracy, the advantages of the Romberg method are even more pronounced: <br><img src="https://habrastorage.org/webt/pw/d8/3r/pwd83rerz_10ju9x5jia4kpt9bm.png" alt="image"></p><br><h3 id="nekotorye-zamechaniya">  Some notes </h3><br><p>  <strong>Remark 1. The</strong> number of function calls in these problems characterizes the number of summations in the calculation of the integral.  Reducing the number of computations of the integrand not only saves computational resources (although with a more optimized implementation, this is also the case), it also reduces the effect of round-off errors on the result.  So, when trying to calculate the test function integral, the trapezoid method freezes when trying to achieve a relative accuracy of 5 √ó 10 <sup>-15</sup> , a parabola method - at the desired accuracy of 2 √ó 10 <sup>-16</sup> (which is the limit for doubles), and the Romberg method does the calculation test integral up to machine precision (with an error in the low bit).  That is, not only the integration accuracy is increased for a given number of function calls, but also the maximum attainable accuracy of the integral calculation. </p><br><p>  <strong>Remark 2.</strong> If the method converges when specifying a certain accuracy, this does not mean that the calculated value of the integral has the same accuracy.  First of all, this applies to cases where the specified error is close to machine accuracy. </p><br><p>  <strong>Remark 3.</strong> Although the Romberg method for a number of functions works in an almost magical way, it assumes that the integrand has bounded higher-order derivatives.  This means that for functions with kinks or gaps, it may turn out to be worse than simple methods.  For example, we integrate <em>f</em> ( <em>x</em> ) = |  <em>x</em> |: </p><br><pre> <code class="hljs lua">&gt;&gt;&gt; Quadrature.trapezoid(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1e-5</span></span>) Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 9 5.0 &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature.simpson</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(abs, -1, 3, rtol=1e-5)</span></span></span></span> Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 17 5.0 &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature.romberg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(abs, -1, 3, rtol=1e-5, maxcol = 2)</span></span></span></span> Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 17 5.0 &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature.romberg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(abs, -1, 3, rtol=1e-5, maxcol = 3)</span></span></span></span> Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 33 5.0 &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature.romberg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(abs, -1, 3, rtol=1e-5, maxcol = 4)</span></span></span></span> Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 33 5.000001383269357</span></span></code> </pre> <br><p>  <strong>Remark 4.</strong> It may seem that the higher the order of approximation, the better.  In fact, it is better to limit the number of columns of the Romberg table at level 4-6.  To understand this, look at the formula (6).  The second term is the difference of two consecutive elements of the <em>j</em> ‚Äì1th column divided by about 4 <sup><em>j</em></sup> .  Since  in the <em>j</em> ‚Äì1st column there are approximations of the integral of order 2 <em>j</em> , then the difference itself has order (1 / <em>n <sub>i</sub></em> ) <sup>2 <em>j</em></sup> ~ 4 <sup>- <em>ij</em></sup> .  C division takes ~ 4 <sup>- ( <em>i</em> +1) <em>j</em></sup> ~ 4 <sup>- <em>j</em> <sup>2</sup></sup> .  Those.  when <em>j</em> ~ 7, the second term in (6) loses its accuracy after reducing the orders when adding floating-point numbers, and an increase in the approximation order can lead to an accumulation of rounding error. </p><br><p>  <strong>Remark 5.</strong> Those interested can apply the described methods for finding the integral <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1603"><span class="MJXp-mtext" id="MJXp-Span-1604">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">n</span><span class="MJXp-msubsup" id="MJXp-Span-1607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1610">1</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1609">0</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1611">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">t</span><span class="MJXp-mrow" id="MJXp-Span-1616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">x</span></span><span class="MJXp-mtext" id="MJXp-Span-1618">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">n</span><span class="MJXp-mrow" id="MJXp-Span-1622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> \ int_0 ^ 1 \ sqrt {x} \ sin {x} dx </script>  and its equivalent <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1626"><span class="MJXp-mtext" id="MJXp-Span-1627">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">n</span><span class="MJXp-msubsup" id="MJXp-Span-1630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1633">1</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1632">0</span></span></span></span></span></span><span class="MJXp-mn" id="MJXp-Span-1634">2</span><span class="MJXp-msubsup" id="MJXp-Span-1635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1637" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1638">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">n</span><span class="MJXp-mrow" id="MJXp-Span-1642"><span class="MJXp-msubsup" id="MJXp-Span-1643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1645" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> \ int_0 ^ 1 2t ^ 2 \ sin {t ^ 2} dt </script>  .  As they say, feel the difference. </p><br><h3 id="zaklyuchenie">  Conclusion </h3><br><p>  A description and implementation of the basic methods of numerical integration of functions on a uniform grid is presented.  It is demonstrated how using a simple modification to obtain, on the basis of the trapezoid method, a class of quadrature formulas using the Romberg method, which significantly accelerates the convergence of numerical integration.  The method works well for integrating "normal" functions, i.e.  weakly varying on the segment of integration, having no singularities on the edges of the segment (see Remark 5), fast oscillations, etc. </p><br><p>                ( [3] ‚Äî     C++). </p><br><h3 id="literatura">  Literature </h3><br><ol><li> <em>.. , .. .</em>  . .: . 1989. </li><li> <em>J. Stoer, R. Bulirsch.</em> Introduction to Numerical Analysis: Second Edition. Springer-Verlag New York.  1993. </li><li> <em>WH Press, SA Teukolsky, WT Vetterling, BP Flannery.</em> Numerical Recipes: Third Edition. Cambridge University Press.  2007 </li></ol></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/420867/">https://habr.com/ru/post/420867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420857/index.html">Seamless Wi-Fi roaming: theory in practice</a></li>
<li><a href="../420859/index.html">On the issue of virt and chains</a></li>
<li><a href="../420861/index.html">Preparing for C ++ 20. Coroutines TS on a real example</a></li>
<li><a href="../420863/index.html">As we did the first Russian smartphone, continued</a></li>
<li><a href="../420865/index.html">The principle of least action. Part 1</a></li>
<li><a href="../420869/index.html">Evacuation, HAMR and MAMR - three ways to increase the capacity of modern HDD to the maximum</a></li>
<li><a href="../420871/index.html">How we relocated a web studio in Bali</a></li>
<li><a href="../420873/index.html">Quest that no one can pass</a></li>
<li><a href="../420875/index.html">Why do I need a 3D printer</a></li>
<li><a href="../420877/index.html">YouDrive introduced registration via Telegram Passport</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>