<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hypothesis Quick Start Guide</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quick Start Guide 


 This article is a translation of the Hypothesis - Quick start guide page taken from the official manual. 
 * Approx. translator:...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hypothesis Quick Start Guide</h1><div class="post__text post__text-html js-mediator-article"><h1>  Quick Start Guide </h1><br><p>  <em>This article is a <u>translation of the</u> <a href="https://hypothesis.readthedocs.io/en/latest/quickstart.html">Hypothesis - Quick start guide</a> page taken from the official manual.</em> </p><br><div class="spoiler">  <b class="spoiler_title">* Approx.</b>  <b class="spoiler_title">translator: *</b> <div class="spoiler_text"><p>  I could not find any useful information in Russian on the use of the Hypothesis, except for the <a href="https://youtu.be/G5GAd8A_igY">speech</a> on November 23, 2017 of Alexander Shorin on "Moscow Python Meetup 50".  I decided to figure it out.  In the end, something translated.  Here, I decided to share. </p></div></div><br><p>  This document should tell you about all that you need to get started with hypothesis. </p><a name="habracut"></a><br><h2>  Example </h2><br><p>  Suppose we write a <a href="https://en.wikipedia.org/wiki/Run-length_encoding">run length encoding</a> system, and want to check that it can. </p><br><p>  We have the following code, which I took directly from the <a href="http://rosettacode.org/wiki/Run-length_encoding">Rosetta Code wiki</a> (OK, I deleted some commented code and fixed the formatting, but did not modify the functions): </p><br><pre><code class="hljs pgsql">def encode(input_string): count = <span class="hljs-number"><span class="hljs-number">1</span></span> prev = <span class="hljs-string"><span class="hljs-string">''</span></span> lst = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">character</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> input_string: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-type"><span class="hljs-type">character</span></span> != prev: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> prev: entry = (prev, count) lst.append(entry) count = <span class="hljs-number"><span class="hljs-number">1</span></span> prev = <span class="hljs-type"><span class="hljs-type">character</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: count += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: entry = (<span class="hljs-type"><span class="hljs-type">character</span></span>, count) lst.append(entry) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lst def decode(lst): q = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">character</span></span>, count <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> lst: q += <span class="hljs-type"><span class="hljs-type">character</span></span> * count <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> q</code> </pre> <br><p>  We want to write a test for this pair of functions that will check some invariant of their job responsibilities. </p><br><p>  The invariant when you have this kind of <code>encoding/decoding</code> is that if you encode something and then decode it, you get the same value backwards. </p><br><p>  Let's see how this can be done with Hypothesis: </p><br><pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> hypothesis <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> given <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> hypothesis.strategies <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span> @given(text()) def test_decode_inverts_encode(s): <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> decode(encode(s)) == s</code> </pre> <br><p>  (For this example, we just let <em>pytest</em> detect and run the test. We‚Äôll tell you about other ways you could run it later). </p><br><p>  The text function returns what Hypothesis calls the search strategy.  An object with methods that describe how to produce and simplify certain kinds of values.  Then the decorator <code>@given</code> takes our function test and turns it into parameterized, which, when called, will perform the test function on a wide range of matching data from this strategy. </p><br><p>  In any case, this test immediately finds an error in the code: </p><br><pre> <code class="hljs pgsql">Falsifying example: test_decode_inverts_encode(s=<span class="hljs-string"><span class="hljs-string">''</span></span>) UnboundLocalError: <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> variable <span class="hljs-string"><span class="hljs-string">'character'</span></span> referenced <span class="hljs-keyword"><span class="hljs-keyword">before</span></span> assignment</code> </pre> <br><p>  <em>Note</em> : Local <code>character</code> variable, mentioned before assignment. </p><br><p>  Hypothesis correctly indicates that this code is simply incorrect if it is called for an empty string. </p><br><p>  If we correct this by simply adding the following code to the beginning of the function, then Hypothesis will tell us that the code is correct (doing nothing, as you expected to pass the test). </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> input_string: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> []</code> </pre> <br><p>  If we wanted to make sure that this example would always be checked, we could add it explicitly: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> hypothesis <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> given, example <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> hypothesis.strategies <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span> @given(text()) @example(<span class="hljs-string"><span class="hljs-string">''</span></span>) def test_decode_inverts_encode(s): <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> decode(encode(s)) == s</code> </pre> <br><p>  You don‚Äôt have to do this, but it can be useful: for clarity, and for a reliable search for examples.  Also, as part of local "learning", in any case, the Hypothesis will remember and reuse examples, but for the exchange of data in your continuous integration (CI) system, there is currently no acceptable good workflow. </p><br><p>  It is also worth noting that the arguments of the keywords <code>example</code> , and <code>given</code> can be both named and positional.  The following code would work just as well: </p><br><pre> <code class="hljs ruby">@given(s=text()) @example(s=<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_decode_inverts_encode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s)</span></span></span></span>: assert decode(encode(s)) == s</code> </pre> <br><p>  Suppose we had a more interesting error and we forgot to restart the counter <br>  in the loop.  Let's say we skipped a string in our <code>encode</code> method: </p><br><pre> <code class="hljs pgsql"> def encode(input_string): count = <span class="hljs-number"><span class="hljs-number">1</span></span> prev = <span class="hljs-string"><span class="hljs-string">''</span></span> lst = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">character</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> input_string: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-type"><span class="hljs-type">character</span></span> != prev: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> prev: entry = (prev, count) lst.append(entry) # count = <span class="hljs-number"><span class="hljs-number">1</span></span> #    prev = <span class="hljs-type"><span class="hljs-type">character</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: count += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: entry = (<span class="hljs-type"><span class="hljs-type">character</span></span>, count) lst.append(entry) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lst</code> </pre> <br><p>  Hypothesis will quickly inform us in the following example: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Falsifying</span></span> example: test_decode_inverts_encode(s=<span class="hljs-string"><span class="hljs-string">'001'</span></span>)</code> </pre> <br><p>  Please note that the presented example is really very simple.  Hypothesis is not easy <br>  finds <em>any</em> example for your tests, he knows how to simplify examples <br>  which he finds to create small and easily understandable.  In this case, two identical <br>  values ‚Äã‚Äãare sufficient to set the counter to a number other than one followed by <br>  another value that should have reset the score, but in this case <br>  did not. </p><br><p>  Hypothesis examples are valid Python code that you can run.  Any arguments that you explicitly specify when calling a function are not generated by the Hypothesis, and if you explicitly provide <em>all the</em> arguments, the Hypothesis will simply call the base function once, rather than run it several times. </p><br><h2>  Installation </h2><br><p>  Hypothesis is <code>available on pypi as "hypothesis"</code> .  You can install it with: </p><br><pre> <code class="hljs sql">pip <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> hypothesis</code> </pre> <br><p>  If you want to install directly from source code (for example, because you want to <br>  make changes and install a modified version) you can do it with: </p><br><pre> <code class="hljs sql">pip <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> -e .</code> </pre> <br><p>  You should probably run the tests first to make sure nothing is broken.  You can do it like this: </p><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">python</span></span> setup.py test</code> </pre> <br><p>  Please note that if they are not already installed, an attempt will be made to establish test dependencies. </p><br><p>  You can do all this in <a href="https://virtualenv.pypa.io/en/latest/">virtualenv</a> . </p><br><p>  For example: </p><br><pre> <code class="hljs sql">virtualenv venv source venv/bin/activate pip <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> hypothesis</code> </pre> <br><p>  Create an isolated environment for you to try Hypothesis without affecting installed system packages. </p><br><h2>  Test execution </h2><br><p>  In our example above, we simply allow <em>pytest to</em> detect and run our tests, but we could also run it explicitly ourselves: </p><br><pre> <code class="hljs cs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: test_decode_inverts_encode()</code> </pre> <br><p>  Or so <a href="https://docs.python.org/2/library/unittest.html">unittest.TestCase</a> : </p><br><pre> <code class="hljs python"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> unittest <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestEncoding</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(unittest.TestCase)</span></span></span><span class="hljs-class">:</span></span> @given(text()) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_decode_inverts_encode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, s)</span></span></span><span class="hljs-function">:</span></span> self.assertEqual(decode(encode(s)), s) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: unittest.main()</code> </pre> <br><p>  <em>Note:</em> this works because Hypothesis ignores any arguments that it was not told to provide (positional arguments begin on the right), so the <code>self</code> argument for the test is simply ignored and works as usual.  This also means that Hypothesis will play well with other ways of parameterizing tests.  For example, it works fine if you use <em>pytest gadgets</em> for some arguments and hypothesis for others. </p><br><h2>  Writing tests </h2><br><p>  The test in Hypothesis consists of two parts: a function that looks like a normal test in the selected test structure, but with some additional arguments, and the decorator <code>@given</code> , which indicates how to provide these arguments. </p><br><p>  Here are some other examples of how this can be used: </p><br><pre> <code class="hljs python"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> hypothesis <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> given <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> hypothesis.strategies <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> st @given(st.integers(), st.integers()) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_ints_are_commutative</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> x + y == y + x @given(x=st.integers(), y=st.integers()) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_ints_cancel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> (x + y) - y == x @given(st.lists(st.integers())) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_reversing_twice_gives_same_list</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(xs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#      (  0  # 100 ),     . ys = list(xs) ys.reverse() ys.reverse() assert xs == ys @given(st.tuples(st.booleans(), st.text())) def test_look_tuples_work_too(t): #    ,   ,  #     . assert len(t) == 2 assert isinstance(t[0], bool) assert isinstance(t[1], str)</span></span></code> </pre> <br><p>  Notice that, as we saw in the above example, you can pass <code>@given</code> arguments as positional or named. </p><br><h2>  Where to begin </h2><br><p>  Now you know enough about the basics to write some tests for your code with Hypothesis.  The best way to learn is to do it, so try it. </p><br><p>  If you have a tough idea of ‚Äã‚Äãhow to use this kind of test for your code, here are a few tips: </p><br><ol><li>  Just try calling the functions with the corresponding random data and get them crashing.  You may be surprised how often it works.  For example, note that the first error we found in the example of coding did not even reach our statement: it failed because it could not process the data we gave, and not because something wrong had happened. </li><li>  Look for duplication in your tests.  Are there cases when you test the same thing with several different examples?  Can you summarize this in one test using Hypothesis? </li><li>  <a href="https://fsharpforfunandprofit.com/posts/property-based-testing-2/">This part is intended to be implemented on F #</a> , but is still very useful to help in finding good ideas for using Hypothesis. </li></ol><br><p>  If you have problems with the launch, do not hesitate and contact <a href="https://hypothesis.readthedocs.io/en/latest/community.html">asking for help</a> . </p><br><p><img src="https://habrastorage.org/webt/jl/jn/bb/jljnbbjr-ejh473xy_eccsmknpk.png">  <a href="https://habrahabr.ru/post/354134/">Back</a> <a href="https://habrahabr.ru/post/354146/">Next</a> <img src="https://habrastorage.org/webt/rw/dy/-g/rwdy-grsvbpcetjttrmecdkxtlk.png"></p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/354144/">https://habr.com/ru/post/354144/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354134/index.html">Hypothesis</a></li>
<li><a href="../354136/index.html">Build rpm packages and configure your repository</a></li>
<li><a href="../354138/index.html">How the stats and monitoring of WebRTC changed the monitoring of VoIP</a></li>
<li><a href="../354140/index.html">Kubernetes Ice Cream, or Beginner Container Solutions</a></li>
<li><a href="../354142/index.html">Difficulties of translation: how to find plagiarism from English in Russian scientific articles</a></li>
<li><a href="../354146/index.html">Hypotesis - Details and Extras</a></li>
<li><a href="../354148/index.html">Security Week 14: RSA Conference, Holed Advertising Networks, Alliances and Confrontation</a></li>
<li><a href="../354150/index.html">How we participated in the hackathon from OpenData</a></li>
<li><a href="../354152/index.html">Mobius-2018: robo report</a></li>
<li><a href="../354154/index.html">Setting up a machine learning model: feature selection and optimization of hyper parameters</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>