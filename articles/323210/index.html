<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Open machine learning course. Topic 2: Data Visualization with Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The second lesson is devoted to data visualization in Python. First, we will look at the basic methods of the Seaborn and Plotly libraries, then we wi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Open machine learning course. Topic 2: Data Visualization with Python</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/62b/42b/b53/62b42bb533f44cbaa8d6306332512555.png" align="right" width="320"><br><p>  The second lesson is devoted to data visualization in Python.  First, we will look at the basic methods of the Seaborn and Plotly libraries, then we will analyze the data set familiar to us from the <a href="https://habrahabr.ru/company/ods/blog/322626/">first article</a> on the outflow of customers of the telecom operator and look into the n-dimensional space using the t-SNE algorithm.  There is also a <a href="https://youtu.be/vm63p8Od0bM">video of a</a> lecture based on this article as part of the second launch of the open course (September-November 2017). </p><br><p>  <strong>UPD:</strong> now the course is in English under the brand <a href="http://mlcourse.ai/">mlcourse.ai</a> with <a href="https://medium.com/open-machine-learning-course">articles</a> on Medium, and materials on Kaggle ( <a href="https://www.kaggle.com/kashnitsky/mlcourse">Dataset</a> ) and on <a href="">GitHub</a> . </p><br><p>  Now the article will be much longer.  Ready?  Go! </p><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">List of articles series</b> <div class="spoiler_text"><ol><li>  <a href="https://habrahabr.ru/company/ods/blog/322626/">Primary data analysis with Pandas</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323210/">Visual data analysis with Python</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/322534/">Classification, decision trees and the method of nearest neighbors</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323890/">Linear classification and regression models</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Compositions: bagging, random forest</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/325422/">Construction and selection of signs</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/325654/">Teaching without a teacher: PCA, clustering</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/326418/">Training in gigabytes with Vowpal Wabbit</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/327242/">Time Series Analysis with Python</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/327250/">Gradient boosting</a> </li></ol></div></div><br><h2 id="plan-etoy-stati">  Plan for this article </h2><br><ul><li>  <a href="https://habrahabr.ru/company/ods/blog/323210/">Demonstration of the main methods of Seaborn and Plotly</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323210/">An example of visual data analysis</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323210/">Peeping into n-dimensional space with t-SNE</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323210/">Homework number 2</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323210/">Overview of useful resources</a> </li></ul><br><h1 id="demonstraciya-osnovnyh-metodov-seaborn-i-plotly">  Demonstration of the main methods of Seaborn and Plotly </h1><br><p>  At the beginning, as always, we set up the environment: we import all the necessary libraries and slightly adjust the default display of images. </p><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   Anaconda import warnings warnings.simplefilter('ignore') #      jupyter'e %matplotlib inline import seaborn as sns import matplotlib.pyplot as plt #  svg    %config InlineBackend.figure_format = 'svg' #    from pylab import rcParams rcParams['figure.figsize'] = 8, 5 import pandas as pd</span></span></code> </pre> <br><p>  After that we will load data with which we will work into <code>DataFrame</code> .  For the examples, I chose the sales and <a href="https://www.kaggle.com/rush4ratio/video-game-sales-with-ratings">rating</a> data for video games from <a href="https://www.kaggle.com/rush4ratio/video-game-sales-with-ratings">Kaggle Datasets</a> . </p><br><pre> <code class="python hljs">df = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../../data/video_games_sales.csv'</span></span>) df.info()</code> </pre> <br><pre> <code class="python hljs">&lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pandas</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">core</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">frame</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataFrame</span></span></span><span class="hljs-class">'&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RangeIndex</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-number"><span class="hljs-number">16719</span></span> entries, <span class="hljs-number"><span class="hljs-number">0</span></span> to <span class="hljs-number"><span class="hljs-number">16718</span></span> Data columns (total <span class="hljs-number"><span class="hljs-number">16</span></span> columns): Name <span class="hljs-number"><span class="hljs-number">16717</span></span> non-null object Platform <span class="hljs-number"><span class="hljs-number">16719</span></span> non-null object Year_of_Release <span class="hljs-number"><span class="hljs-number">16450</span></span> non-null float64 Genre <span class="hljs-number"><span class="hljs-number">16717</span></span> non-null object Publisher <span class="hljs-number"><span class="hljs-number">16665</span></span> non-null object NA_Sales <span class="hljs-number"><span class="hljs-number">16719</span></span> non-null float64 EU_Sales <span class="hljs-number"><span class="hljs-number">16719</span></span> non-null float64 JP_Sales <span class="hljs-number"><span class="hljs-number">16719</span></span> non-null float64 Other_Sales <span class="hljs-number"><span class="hljs-number">16719</span></span> non-null float64 Global_Sales <span class="hljs-number"><span class="hljs-number">16719</span></span> non-null float64 Critic_Score <span class="hljs-number"><span class="hljs-number">8137</span></span> non-null float64 Critic_Count <span class="hljs-number"><span class="hljs-number">8137</span></span> non-null float64 User_Score <span class="hljs-number"><span class="hljs-number">10015</span></span> non-null object User_Count <span class="hljs-number"><span class="hljs-number">7590</span></span> non-null float64 Developer <span class="hljs-number"><span class="hljs-number">10096</span></span> non-null object Rating <span class="hljs-number"><span class="hljs-number">9950</span></span> non-null object dtypes: float64(<span class="hljs-number"><span class="hljs-number">9</span></span>), object(<span class="hljs-number"><span class="hljs-number">7</span></span>) memory usage: <span class="hljs-number"><span class="hljs-number">2.0</span></span>+ MB</code> </pre> <br><p>  Some features that <code>pandas</code> counted as <code>object</code> will be explicitly cast to <code>float</code> or <code>int</code> types. </p><br><pre> <code class="hljs cs">df[<span class="hljs-string"><span class="hljs-string">'User_Score'</span></span>] = df.User_Score.astype(<span class="hljs-string"><span class="hljs-string">'float64'</span></span>) df[<span class="hljs-string"><span class="hljs-string">'Year_of_Release'</span></span>] = df.Year_of_Release.astype(<span class="hljs-string"><span class="hljs-string">'int64'</span></span>) df[<span class="hljs-string"><span class="hljs-string">'User_Count'</span></span>] = df.User_Count.astype(<span class="hljs-string"><span class="hljs-string">'int64'</span></span>) df[<span class="hljs-string"><span class="hljs-string">'Critic_Count'</span></span>] = df.Critic_Count.astype(<span class="hljs-string"><span class="hljs-string">'int64'</span></span>)</code> </pre> <br><p>  Data is not available for all games, so let's leave only those records that do not have gaps using the <code>dropna</code> method. </p><br><pre> <code class="python hljs">df = df.dropna() print(df.shape)</code> </pre> <br><pre> <code class="hljs lisp">(<span class="hljs-number"><span class="hljs-number">6825</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>)</code> </pre> <br><p>  In total, there are 6825 objects in the table and 16 features for them.  Let's look at the first few entries using the <code>head</code> method to make sure that everything is correct.  For convenience, I left only those signs that we will continue to use. </p><br><pre> <code class="python hljs">useful_cols = [<span class="hljs-string"><span class="hljs-string">'Name'</span></span>, <span class="hljs-string"><span class="hljs-string">'Platform'</span></span>, <span class="hljs-string"><span class="hljs-string">'Year_of_Release'</span></span>, <span class="hljs-string"><span class="hljs-string">'Genre'</span></span>, <span class="hljs-string"><span class="hljs-string">'Global_Sales'</span></span>, <span class="hljs-string"><span class="hljs-string">'Critic_Score'</span></span>, <span class="hljs-string"><span class="hljs-string">'Critic_Count'</span></span>, <span class="hljs-string"><span class="hljs-string">'User_Score'</span></span>, <span class="hljs-string"><span class="hljs-string">'User_Count'</span></span>, <span class="hljs-string"><span class="hljs-string">'Rating'</span></span> ] df[useful_cols].head()</code> </pre> <br><p><img src="https://habrastorage.org/files/594/274/ef6/594274ef67c74d748bb961c9820f8aae.png" alt="img"></p><br><p>  Before we get into the methods of the <code>seaborn</code> and <code>plotly</code> , let's discuss the simplest and often convenient way to visualize data from the <code>pandas DataFrame</code> - use the <code>plot</code> function. <br>  For example, let's build a graph of sales of video games in different countries depending on the year.  To begin with, we filter only the columns we need, then calculate the total sales by year and call the <code>plot</code> function with no parameters for the resulting <code>DataFrame</code> . </p><br><pre> <code class="python hljs">sales_df = df[[x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> df.columns <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">'Sales'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> x] + [<span class="hljs-string"><span class="hljs-string">'Year_of_Release'</span></span>]] sales_df.groupby(<span class="hljs-string"><span class="hljs-string">'Year_of_Release'</span></span>).sum().plot()</code> </pre> <br><p>  The implementation of the <code>plot</code> function in <code>pandas</code> based on the <code>matplotlib</code> library. </p><br><p><img src="https://habrastorage.org/files/ebb/da5/6a6/ebbda56a661b44a29dd60c795e98ee52.png" alt="img"></p><br><p>  Using the <code>kind</code> parameter, you can change the type of chart, for example, to <strong><code>bar chart</code></strong> .  <code>Matplotlib</code> allows you to customize graphics very flexibly.  On the graph, you can change almost anything, but you will need to rummage through the documentation and find the necessary parameters.  For example, the parameter <code>rot</code> is responsible for the slope of the labels to the <code>x</code> axis. </p><br><pre> <code class="python hljs">sales_df.groupby(<span class="hljs-string"><span class="hljs-string">'Year_of_Release'</span></span>).sum().plot(kind=<span class="hljs-string"><span class="hljs-string">'bar'</span></span>, rot=<span class="hljs-number"><span class="hljs-number">45</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/files/0a5/24d/4d7/0a524d4d7a2b454ba4a85e9a13e92fd9.png" alt="img"></p><br><h2 id="seaborn">  Seaborn </h2><br><p>  Now let's go to the <code>seaborn</code> library.  <code>Seaborn</code> is essentially a higher level API based on the <code>matplotlib</code> library.  <code>Seaborn</code> contains more adequate default settings for graphic design.  Also in the library there are quite complex types of visualization, which in <code>matplotlib</code> would require a large amount of code. </p><br><p>  Let's get acquainted with the first such "complex" type of graphs of the <strong><code>pair plot</code></strong> ( <code>scatter plot matrix</code> ).  This visualization will help us to look at one picture, as different signs are interconnected. </p><br><pre> <code class="python hljs">cols = [<span class="hljs-string"><span class="hljs-string">'Global_Sales'</span></span>, <span class="hljs-string"><span class="hljs-string">'Critic_Score'</span></span>, <span class="hljs-string"><span class="hljs-string">'Critic_Count'</span></span>, <span class="hljs-string"><span class="hljs-string">'User_Score'</span></span>, <span class="hljs-string"><span class="hljs-string">'User_Count'</span></span>] sns_plot = sns.pairplot(df[cols]) sns_plot.savefig(<span class="hljs-string"><span class="hljs-string">'pairplot.png'</span></span>)</code> </pre> <br><p>  As you can see, histograms of the sign distributions are located on the diagonal of the matrix of graphs.  The rest of the graphs are the usual <code>scatter plots</code> for the corresponding pairs of signs. </p><br><p>  To save graphs to files, use the <code>savefig</code> method. </p><br><p><img src="https://habrastorage.org/files/1ea/ebc/9ec/1eaebc9ecf6d430f825836c3dcc67a8c.png" alt="img"></p><br><p>  With the help of <code>seaborn</code> you can also build <strong><code>dist plot</code></strong> distribution.  For example, let's look at the distribution of <code>Critic_Score</code> critics' <code>Critic_Score</code> .  By default, a histogram and <a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">kernel density estimation are</a> displayed on the graph. </p><br><pre> <code class="python hljs">sns.distplot(df.Critic_Score)</code> </pre> <br><p><img src="https://habrastorage.org/files/b09/02c/fe7/b0902cfe7aaa43c2bdce22840c39d6fe.png" alt="img"></p><br><p>  In order to take a closer look at the relationship of two numerical features, there is also a <strong><code>joint plot</code></strong> - this is a hybrid of the <code>scatter plot</code> and <code>histogram</code> .  Let's look at how the critique of <code>Critic_Score</code> and <code>Critic_Score</code> are related to each other. </p><br><p><img src="https://habrastorage.org/files/951/9b1/e29/9519b1e29fd143b3ab26f7c14a5af215.png" alt="img"></p><br><p>  Another useful type of graph is <strong><code>box plot</code></strong> .  Let's compare the ratings of games from critics for the top 5 largest gaming platforms. </p><br><pre> <code class="python hljs">top_platforms = df.Platform.value_counts().sort_values(ascending = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>).head(<span class="hljs-number"><span class="hljs-number">5</span></span>).index.values sns.boxplot(y=<span class="hljs-string"><span class="hljs-string">"Platform"</span></span>, x=<span class="hljs-string"><span class="hljs-string">"Critic_Score"</span></span>, data=df[df.Platform.isin(top_platforms)], orient=<span class="hljs-string"><span class="hljs-string">"h"</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/files/081/d0d/809/081d0d8095554636befc11b6e0dc879b.png" alt="img"></p><br><p>  I think it is worth discussing a little more in detail how to understand <code>box plot</code> .  <code>Box plot</code> consists of a box (which is why it is called a <code>box plot</code> ), antenna bars and points.  The box shows the interquartile range of distribution, that is, respectively 25% ( <code>Q1</code> ) and 75% ( <code>Q3</code> ) percentile.  The dash inside the box indicates the median of the distribution. <br>  With the box figured out, let's go to the mustache.  The whiskers reflect the entire range of points except for outliers, that is, the minimum and maximum values ‚Äã‚Äãthat fall in the gap <code>(Q1 - 1.5*IQR, Q3 + 1.5*IQR)</code> , where <code>IQR = Q3 - Q1</code> is the interquartile range.  The dots on the graph indicate outliers (those values ‚Äã‚Äãthat do not fit into the range of values ‚Äã‚Äãgiven by the graph mustache). </p><br><p>  It‚Äôs better to see once to understand, so here‚Äôs a picture from <a href="https://en.wikipedia.org/wiki/Box_plot">Wikipedia</a> : <br><img src="https://habrastorage.org/files/d0f/f53/8d5/d0ff538d59154901b18a98469de07fde.png" alt="img"></p><br><p>  And one more type of graphs (the last of those we consider in this article) is the <strong><code>heat map</code></strong> .  <code>Heat map</code> allows you to look at the distribution of a numerical trait by two categorical.  We visualize the total sales of games by genre and gaming platforms. </p><br><pre> <code class="python hljs">platform_genre_sales = df.pivot_table( index=<span class="hljs-string"><span class="hljs-string">'Platform'</span></span>, columns=<span class="hljs-string"><span class="hljs-string">'Genre'</span></span>, values=<span class="hljs-string"><span class="hljs-string">'Global_Sales'</span></span>, aggfunc=sum).fillna(<span class="hljs-number"><span class="hljs-number">0</span></span>).applymap(float) sns.heatmap(platform_genre_sales, annot=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, fmt=<span class="hljs-string"><span class="hljs-string">".1f"</span></span>, linewidths=<span class="hljs-number"><span class="hljs-number">.5</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/files/90c/47e/235/90c47e23522f4c7d98c0cd08f80da54f.png" alt="img"></p><br><h2 id="plotly">  Plotly </h2><br><p>  We looked at visualizations based on the <code>matplotlib</code> library.  However, this is not the only option for <code>python</code> graphing.  We will also <strong><code>plotly</code></strong> acquainted with the <strong><code>plotly</code></strong> library.  <code>Plotly</code> is an open-source library that allows you to build interactive graphics in jupyter.notebook'e without having to dig into javascript code. </p><br><p>  The beauty of interactive graphs is that you can see the exact numerical value when you hover the mouse, hide uninteresting rows in the visualization, zoom in on a certain part of the graph, etc. </p><br><p>  Before we begin, we import all the necessary modules and initialize <code>plotly</code> using the <code>init_notebook_mode</code> . </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> plotly.offline <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> download_plotlyjs, init_notebook_mode, plot, iplot <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> plotly <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> plotly.graph_objs <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> go init_notebook_mode(connected=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><p>  To begin with, we will build a <strong><code>line plot</code></strong> with the dynamics of the number of games released and their sales by year. </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#          years_df = df.groupby('Year_of_Release')[['Global_Sales']].sum().join( df.groupby('Year_of_Release')[['Name']].count() ) years_df.columns = ['Global_Sales', 'Number_of_Games'] #       trace0 = go.Scatter( x=years_df.index, y=years_df.Global_Sales, name='Global Sales' ) #       trace1 = go.Scatter( x=years_df.index, y=years_df.Number_of_Games, name='Number of games released' ) #      title   layout data = [trace0, trace1] layout = {'title': 'Statistics of video games'} # c  Figure    fig = go.Figure(data=data, layout=layout) iplot(fig, show_link=False)</span></span></code> </pre> <br><p>  In <code>plotly</code> visualization of the object <code>Figure</code> , which consists of data (an array of lines, which are called <code>traces</code> in the library) and design / style, is responsible for the <code>layout</code> object.  In simple cases, you can call the <code>iplot</code> function and just from the <code>traces</code> array. </p><br><p>  The <code>show_link</code> parameter <code>show_link</code> responsible for links to the plot.ly online platform on the graphs.  Since usually this functionality is not needed, I prefer to hide it to prevent accidental clicks. </p><br><p><img src="https://habrastorage.org/files/8b9/3fb/be5/8b93fbbe58b44ed79e5b7f40d83f8d1d.png" alt="img"></p><br><p>  You can immediately save the graph as an html file. </p><br><pre> <code class="python hljs">plotly.offline.plot(fig, filename=<span class="hljs-string"><span class="hljs-string">'years_stats.html'</span></span>, show_link=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br><p>  We will also look at the market share of gaming platforms, calculated by the number of games released and by total revenue.  To do this, build a <strong><code>bar chart</code></strong> . </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#         platforms_df = df.groupby('Platform')[['Global_Sales']].sum().join( df.groupby('Platform')[['Name']].count() ) platforms_df.columns = ['Global_Sales', 'Number_of_Games'] platforms_df.sort_values('Global_Sales', ascending=False, inplace=True) #  traces   trace0 = go.Bar( x=platforms_df.index, y=platforms_df.Global_Sales, name='Global Sales' ) trace1 = go.Bar( x=platforms_df.index, y=platforms_df.Number_of_Games, name='Number of games released' ) #       title     x  layout data = [trace0, trace1] layout = {'title': 'Share of platforms', 'xaxis': {'title': 'platform'}} #   Figure    fig = go.Figure(data=data, layout=layout) iplot(fig, show_link=False)</span></span></code> </pre> <br><p><img src="https://habrastorage.org/files/496/3f9/2eb/4963f92ebf8a4a93a8d7abb4a6205c96.png" alt="img"></p><br><p>  In <code>plotly</code> you can build a <strong><code>box plot</code></strong> .  Consider the distribution of critics' ratings depending on the game genre. </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  Box trace       data = [] for genre in df.Genre.unique(): data.append( go.Box(y=df[df.Genre==genre].Critic_Score, name=genre) ) #   iplot(data, show_link = False)</span></span></code> </pre> <br><p><img src="https://habrastorage.org/files/6a4/e4e/a10/6a4e4ea10da049d2b56c9323dea77c2e.png" alt="img"></p><br><p>  With the help of <code>plotly</code> you can build other types of visualizations.  The graphics are pretty nice with default settings.  However, the library allows you to flexibly customize various rendering parameters: colors, fonts, captions, annotations, and more. </p><br><h1 id="primer-vizualnogo-analiza-dannyh">  An example of visual data analysis </h1><br><p>  We read in <code>DataFrame</code> data on the outflow of customers of the telecom operator familiar to us from the <a href="https://habrahabr.ru/company/ods/blog/322626/">first article</a> . </p><br><pre> <code class="python hljs">df = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../../data/telecom_churn.csv'</span></span>)</code> </pre> <br><p>  Check whether everything was considered normal - let's look at the first 5 lines ( <code>head</code> method). </p><br><pre> <code class="python hljs">df.head()</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/978/022/6a8/9780226a800b4a1da342daaa966b4a0e.png"></div><br><br><p>  Number of rows (clients) and columns (features): </p><br><pre> <code class="python hljs">df.shape</code> </pre> <br><pre> <code class="hljs lisp">(<span class="hljs-number"><span class="hljs-number">3333</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>)</code> </pre> <br><p>  Let's look at the signs and see that there are no gaps in any of them - there are 3333 entries everywhere. </p><br><pre> <code class="python hljs">df.info()</code> </pre> <br><pre> <code class="hljs pgsql">&lt;<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-string"><span class="hljs-string">'pandas.core.frame.DataFrame'</span></span>&gt; Range<span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>: <span class="hljs-number"><span class="hljs-number">3333</span></span> entries, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">3332</span></span> Data <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> (total <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>): State <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> Account length <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Area code <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 International plan <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> Voice mail plan <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> Number vmail messages <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Total day minutes <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total day calls <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Total day charge <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total eve minutes <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total eve calls <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Total eve charge <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total night minutes <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total night calls <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Total night charge <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total intl minutes <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total intl calls <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Total intl charge <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Customer service calls <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Churn <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> dtypes: <span class="hljs-type"><span class="hljs-type">bool</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>), float64(<span class="hljs-number"><span class="hljs-number">8</span></span>), int64(<span class="hljs-number"><span class="hljs-number">8</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>) memory <span class="hljs-keyword"><span class="hljs-keyword">usage</span></span>: <span class="hljs-number"><span class="hljs-number">498.1</span></span>+ KB</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Feature description</b> <div class="spoiler_text"><table><thead><tr><th>  Title </th><th>  Description </th><th>  Type of </th></tr></thead><tbody><tr><td>  <strong>State</strong> </td><td>  State letter code </td><td>  categorical </td></tr><tr><td>  <strong>Account length</strong> </td><td>  How long does a customer have been served by the company? </td><td>  quantitative </td></tr><tr><td>  <strong>Area code</strong> </td><td>  Phone number prefix </td><td>  quantitative </td></tr><tr><td>  <strong>International plan</strong> </td><td>  International roaming (connected / not connected) </td><td>  binary </td></tr><tr><td>  <strong>Voice mail plan</strong> </td><td>  Voicemail (connected / not connected) </td><td>  binary </td></tr><tr><td>  <strong>Number vmail messages</strong> </td><td>  Number of voice messages </td><td>  quantitative </td></tr><tr><td>  <strong>Total day minutes</strong> </td><td>  Total duration of conversations in the afternoon </td><td>  quantitative </td></tr><tr><td>  <strong>Total day calls</strong> </td><td>  Total number of calls during the day </td><td>  quantitative </td></tr><tr><td>  <strong>Total day charge</strong> </td><td>  Total amount of payment for services in the afternoon </td><td>  quantitative </td></tr><tr><td>  <strong>Total eve minutes</strong> </td><td>  The total duration of conversations in the evening </td><td>  quantitative </td></tr><tr><td>  <strong>Total eve calls</strong> </td><td>  Total number of calls in the evening </td><td>  quantitative </td></tr><tr><td>  <strong>Total eve charge</strong> </td><td>  The total amount of payment for services in the evening </td><td>  quantitative </td></tr><tr><td>  <strong>Total night minutes</strong> </td><td>  The total duration of conversations at night </td><td>  quantitative </td></tr><tr><td>  <strong>Total night calls</strong> </td><td>  Total number of calls at night </td><td>  quantitative </td></tr><tr><td>  <strong>Total night charge</strong> </td><td>  Total payment for services at night </td><td>  quantitative </td></tr><tr><td>  <strong>Total intl minutes</strong> </td><td>  Total duration of international calls </td><td>  quantitative </td></tr><tr><td>  <strong>Total intl calls</strong> </td><td>  Total international calls </td><td>  quantitative </td></tr><tr><td>  <strong>Total intl charge</strong> </td><td>  Total amount of payment for international calls </td><td>  quantitative </td></tr><tr><td>  <strong>Customer service calls</strong> </td><td>  The number of calls to the service center </td><td>  quantitative </td></tr></tbody></table><br><p>  Target variable: <strong>Churn</strong> - <strong>Outflow</strong> symptom, binary (1 - client loss, i.e. outflow).  Then we will build models that predict this sign for the rest, so we called it target. </p></div></div><br><p>  Let's look at the distribution of the target class - customer churn. </p><br><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>].value_counts()</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-number"><span class="hljs-number">2850</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-number"><span class="hljs-number">483</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>: Churn, dtype: int64</code> </pre> <br><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>].value_counts().plot(kind=<span class="hljs-string"><span class="hljs-string">'bar'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>) plt.legend() plt.title(<span class="hljs-string"><span class="hljs-string">'  '</span></span>);</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/363/837/4ca/3638374ca01a4777b9c7280e30669b7d.png"></div><br><br><p>  Select the following groups of signs (among all but <em>Churn</em> ): </p><br><ul><li>  binary: <em>International plan</em> , <em>Voice mail plan</em> </li><li>  categorical: <em>State</em> </li><li>  serial: <em>Customer service calls</em> </li><li>  quantitative: all others </li></ul><br><p>  Let's look at the correlation of quantitative traits.  From the colored correlation matrix, one can see that signs such as <em>Total day charge</em> are counted according to the minutes spoken ( <em>Total day minutes</em> ).  That is, 4 signs can be thrown out, they do not carry useful information. </p><br><pre> <code class="python hljs">corr_matrix = df.drop([<span class="hljs-string"><span class="hljs-string">'State'</span></span>, <span class="hljs-string"><span class="hljs-string">'International plan'</span></span>, <span class="hljs-string"><span class="hljs-string">'Voice mail plan'</span></span>, <span class="hljs-string"><span class="hljs-string">'Area code'</span></span>], axis=<span class="hljs-number"><span class="hljs-number">1</span></span>).corr()</code> </pre> <br><pre> <code class="python hljs">sns.heatmap(corr_matrix);</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/148/611/03f/14861103fbf14dff9c56802f709f0749.png"></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  Now let's look at the distribution of all quantitative traits of interest to us.  We will look at binary / categorical / ordinal signs separately. </p><br><pre> <code class="python hljs">features = list(set(df.columns) - set([<span class="hljs-string"><span class="hljs-string">'State'</span></span>, <span class="hljs-string"><span class="hljs-string">'International plan'</span></span>, <span class="hljs-string"><span class="hljs-string">'Voice mail plan'</span></span>, <span class="hljs-string"><span class="hljs-string">'Area code'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total day charge'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total eve charge'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total night charge'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total intl charge'</span></span>, <span class="hljs-string"><span class="hljs-string">'Churn'</span></span>])) df[features].hist(figsize=(<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>));</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/de3/01b/18f/de301b18f8e5459b9ad8158314a80769.png"></div><br><br><p>  We see that most of the signs are distributed normally.  Exceptions are the number of calls to the service center ( <em>Customer service calls</em> ) (the Poisson distribution is more appropriate here) and the number of voice messages ( <em>Number vmail messages</em> , the peak at zero, that is, those whose voicemail is not connected).  The distribution of the number of international calls ( <em>Total intl calls</em> ) is also shifted. </p><br><p>  It is also useful to build such pictures, where the distribution of signs are drawn on the main diagonal, and outside the main diagonal there are scatter diagrams for pairs of signs.  It happens that this leads to some conclusions, but in this case, everything is approximately clear, without surprises. </p><br><pre> <code class="python hljs">sns.pairplot(df[features + [<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>]], hue=<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>);</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/aef/703/336/aef703336cbf42feabe289b0c849dc2b.png"></div><br><br><p>  <strong>Next, we will look at how the signs are related to the target - to the outflow.</strong> </p><br><p>  Construct boxplot-s, describing the statistics of the distribution of quantitative traits in two groups: among loyal and departed customers. </p><br><pre> <code class="python hljs">fig, axes = plt.subplots(nrows=<span class="hljs-number"><span class="hljs-number">3</span></span>, ncols=<span class="hljs-number"><span class="hljs-number">4</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> idx, feat <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(features): sns.boxplot(x=<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>, y=feat, data=df, ax=axes[idx / <span class="hljs-number"><span class="hljs-number">4</span></span>, idx % <span class="hljs-number"><span class="hljs-number">4</span></span>]) axes[idx / <span class="hljs-number"><span class="hljs-number">4</span></span>, idx % <span class="hljs-number"><span class="hljs-number">4</span></span>].legend() axes[idx / <span class="hljs-number"><span class="hljs-number">4</span></span>, idx % <span class="hljs-number"><span class="hljs-number">4</span></span>].set_xlabel(<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>) axes[idx / <span class="hljs-number"><span class="hljs-number">4</span></span>, idx % <span class="hljs-number"><span class="hljs-number">4</span></span>].set_ylabel(feat);</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/ca8/96c/e02/ca896ce024c5491fa8f21672efa8ab6e.png"></div><br><br><p>  By eye, we see the biggest difference for the signs of <em>Total day minutes</em> , <em>Customer service calls</em> and <em>Number vmail messages</em> .  Subsequently, we will learn to determine the importance of signs in a classification task using random forest (or gradient boosting), and it turns out that the first two are really very important signs for predicting outflow. </p><br><p>  Let's look separately at the pictures with the distribution of the number of minutes spoken in the afternoon among loyal / departed.  On the left - familiar to us boxboxes, on the right - smoothed histograms of the distribution of a numerical attribute in two groups (rather, rather, a beautiful picture, everything is clear from boxsplot). </p><br><p>  An interesting <strong>observation:</strong> on average, retired customers use more communication.  Perhaps they are dissatisfied with tariffs, and one of the measures to combat the outflow will be a reduction in tariff rates (the cost of mobile communication).  But this is the company will need to conduct additional economic analysis, whether such measures will be justified. </p><br><pre> <code class="python hljs">_, axes = plt.subplots(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, sharey=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>)) sns.boxplot(x=<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>, y=<span class="hljs-string"><span class="hljs-string">'Total day minutes'</span></span>, data=df, ax=axes[<span class="hljs-number"><span class="hljs-number">0</span></span>]); sns.violinplot(x=<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>, y=<span class="hljs-string"><span class="hljs-string">'Total day minutes'</span></span>, data=df, ax=axes[<span class="hljs-number"><span class="hljs-number">1</span></span>]);</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/f19/c94/fac/f19c94facf30431cb37804b449bac34b.png"></div><br><br><p>  Now we will depict the distribution of the number of calls to the service center (we built this picture in the first article).  There are not many unique values ‚Äã‚Äãof the feature (the feature can be considered both quantitative integer and ordinal), and more graphically depict the distribution using <code>countplot</code> .  <strong>Observation: the</strong> share of churn increases greatly from 4 calls to the service center. </p><br><pre> <code class="python hljs">sns.countplot(x=<span class="hljs-string"><span class="hljs-string">'Customer service calls'</span></span>, hue=<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>, data=df);</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/43c/30f/8b7/43c30f8b7053410c90e575d5b26d3ae1.png"></div><br><br><p>  Now let's look at the connection between the binary features of the <em>International plan</em> and the <em>Voice mail plan</em> with the outflow.  <strong>Observation</strong> : when roaming is connected, the outflow rate is much higher, i.e.  International roaming is a strong sign.  About voice mail this can not be said. </p><br><pre> <code class="python hljs">_, axes = plt.subplots(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, sharey=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>)) sns.countplot(x=<span class="hljs-string"><span class="hljs-string">'International plan'</span></span>, hue=<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>, data=df, ax=axes[<span class="hljs-number"><span class="hljs-number">0</span></span>]); sns.countplot(x=<span class="hljs-string"><span class="hljs-string">'Voice mail plan'</span></span>, hue=<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>, data=df, ax=axes[<span class="hljs-number"><span class="hljs-number">1</span></span>]);</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/60f/6d0/691/60f6d06912784245acb19571361e6627.png"></div><br><br><p>  Finally, let‚Äôs see how the categorical attribute <em>State</em> is associated with outflow.  It is not so pleasant to work with him, since the number of unique states is quite large - 51. You can build a summary tablet at the beginning or calculate the percentage of outflow for each state.  But the data for each state is not enough (there are only 3 to 17 customers left in each state), so perhaps the <em>State</em> sign should not be added to the classification models because of the risk of <em>retraining</em> (but we will check for <em>cross-validation</em> , stay tuned!). </p><br><p>  Outflow shares for each state: </p><br><pre> <code class="python hljs">df.groupby([<span class="hljs-string"><span class="hljs-string">'State'</span></span>])[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>].agg([np.mean]).sort_values(by=<span class="hljs-string"><span class="hljs-string">'mean'</span></span>, ascending=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>).T</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/e08/460/918/e0846091885244e9b124207a834e908f.png"></div><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/3c4/d55/e55/3c4d55e55f9044f0836fc513598de442.png"></div><br><br><p>  It can be seen that in New Jersey and California, the share of outflow is above 25%, while in Hawaii and Alaska it is less than 5%.  But these conclusions are based on too modest statistics and it is possible that these are just the features of the available data (here you can also test hypotheses about the correlation of Matthews and Cramer, but this is beyond the scope of this article). </p><br><h1 id="podglyadyvanie-v-n-mernoe-prostranstvo-s-t-sne">  Peeping into n-dimensional space with t-SNE </h1><br><p>  Construct a t-SNE representation of the same outflow data.  The name of the method is complex - t-distributed Stohastic Neighbor Embedding, mathematics is also cool (and we will not go into it, but for those who want it - <a href="http://www.jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf">this is the</a> original article by D. Hinton and his graduate student in JMLR), but the basic idea is simple, like a door: we will find such a display from the multidimensional feature space to the plane (or in 3D, but almost always 2D is chosen), so that points that are far from each other on the plane also appear remote, and close points also map to close ones.  That is, neighbor embedding is a kind of search for a new view of data, in which the neighborhood is preserved. </p><br><p>  A few details: let's throw out the states and the sign of churn, binary Yes / No-signs translate into numbers ( <code>pd.factorize</code> ).  You also need to scale the sample - subtract its average from each attribute and divide it by the standard deviation, <code>StandardScaler</code> does. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.manifold <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> TSNE <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.preprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StandardScaler</code> </pre> <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     ,   X = df.drop(['Churn', 'State'], axis=1) X['International plan'] = pd.factorize(X['International plan'])[0] X['Voice mail plan'] = pd.factorize(X['Voice mail plan'])[0] scaler = StandardScaler() X_scaled = scaler.fit_transform(X)</span></span></code> </pre> <br><pre> <code class="python hljs">%%time tsne = TSNE(random_state=<span class="hljs-number"><span class="hljs-number">17</span></span>) tsne_representation = tsne.fit_transform(X_scaled)</code> </pre> <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">CPU</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">user</span></span> 20 <span class="hljs-selector-tag"><span class="hljs-selector-tag">s</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">sys</span></span>: 2<span class="hljs-selector-class"><span class="hljs-selector-class">.41</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">s</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span>: 22<span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">s</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wall</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">time</span></span>: 21<span class="hljs-selector-class"><span class="hljs-selector-class">.9</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">s</span></span></code> </pre> <br><pre> <code class="python hljs">plt.scatter(tsne_representation[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], tsne_representation[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]);</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/5ad/048/43c/5ad04843caac44f7890fd61a0d9bb9b1.png"></div><br><br><p>  Let us color the resulting t-SNE outflow data representation (blue - loyal, orange - gone customers). </p><br><pre> <code class="python hljs">plt.scatter(tsne_representation[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], tsne_representation[:, <span class="hljs-number"><span class="hljs-number">1</span></span>], c=df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>].map({<span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-string"><span class="hljs-string">'blue'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-string"><span class="hljs-string">'orange'</span></span>}));</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/web/e37/fcf/d34/e37fcfd3486a473486067e212551f4ad.png"></div><br><br><p>  We see that the departed customers are mostly "handful" in some areas of the attribute space. </p><br><p>  To better understand the picture, you can also paint it on the other binary features - roaming and voice mail.  The blue areas correspond to objects with this binary sign. </p><br><pre> <code class="python hljs">_, axes = plt.subplots(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, sharey=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>)) axes[<span class="hljs-number"><span class="hljs-number">0</span></span>].scatter(tsne_representation[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], tsne_representation[:, <span class="hljs-number"><span class="hljs-number">1</span></span>], c=df[<span class="hljs-string"><span class="hljs-string">'International plan'</span></span>].map({<span class="hljs-string"><span class="hljs-string">'Yes'</span></span>: <span class="hljs-string"><span class="hljs-string">'blue'</span></span>, <span class="hljs-string"><span class="hljs-string">'No'</span></span>: <span class="hljs-string"><span class="hljs-string">'orange'</span></span>})); axes[<span class="hljs-number"><span class="hljs-number">1</span></span>].scatter(tsne_representation[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], tsne_representation[:, <span class="hljs-number"><span class="hljs-number">1</span></span>], c=df[<span class="hljs-string"><span class="hljs-string">'Voice mail plan'</span></span>].map({<span class="hljs-string"><span class="hljs-string">'Yes'</span></span>: <span class="hljs-string"><span class="hljs-string">'blue'</span></span>, <span class="hljs-string"><span class="hljs-string">'No'</span></span>: <span class="hljs-string"><span class="hljs-string">'orange'</span></span>})); axes[<span class="hljs-number"><span class="hljs-number">0</span></span>].set_title(<span class="hljs-string"><span class="hljs-string">'International plan'</span></span>); axes[<span class="hljs-number"><span class="hljs-number">1</span></span>].set_title(<span class="hljs-string"><span class="hljs-string">'Voice mail plan'</span></span>);</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/web/a65/bd7/604/a65bd7604ce84de29bc7ac7d40d5d8d0.png"></div><br><br><p>  Now it is clear that, for example, a lot of departed clients are grouped in the left cluster of people with roaming turned on, but without voice mail. </p><br><p>  Finally, we note the disadvantages of t-SNE (yes, it is also better to write a separate article on it): </p><br><ul><li>  large computational complexity.  This implementation of <code>sklearn</code> most likely will not help in your real task; on large samples it is worth looking in the direction of <a href="https://github.com/DmitryUlyanov/Multicore-TSNE">Multicore-TSNE</a> ; </li><li>  the picture can change a lot when changing the <code>random seed</code> , it complicates interpretation.  <a href="http://distill.pub/2016/misread-tsne/">Here is a</a> good t-SNE tutorial.  But in general, such pictures should not be made far-reaching conclusions - do not guess the coffee grounds.  Sometimes something catches the eye and is confirmed by the study, but this does not often happen. </li></ul><br><p>  And a couple of pictures.  With the help of t-SNE, you can really get a good idea of ‚Äã‚Äãthe data (as in the case of handwritten numbers, <a href="https://colah.github.io/posts/2014-10-Visualizing-MNIST/">here's a</a> good article), or you can just draw a Christmas tree toy. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/583/9c1/f2f/5839c1f2f402489aaa928e593e9b1153.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ad9/089/1a1/ad90891a141c448f90de89c34a79cc9f.jpg"></div><br><h2 id="domashnee-zadanie--2">  Homework number 2 </h2><br><p>  Actual homework is announced during the regular session of the course, you can follow in <a href="https://vk.com/mlcourse">the VC group</a> and in the <a href="">repository of the</a> course. </p><br><p>  In order to consolidate the material, we propose to perform <a href="http://nbviewer.jupyter.org/github/Yorko/mlcourse.ai/blob/master/jupyter_russian/assignments_demo/assignment02_habr_visual_analysis.ipynb">this task</a> - to conduct a visual analysis of data on publications in Habrahabr.  You can check yourself by sending the answers in a <a href="https://docs.google.com/forms/d/1y8qj5iYpaVhczjWnZuHd5NRR_sdCGy3eTF5n-qPKknQ">web form</a> (there you will also find a solution). </p><br><h2 id="obzor-poleznyh-resursov">  Overview of useful resources </h2><br><ul><li>  Extended version of this article in English - <a href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-2-visual-data-analysis-in-python-846b989675cd">Medium story</a> </li><li>  <a href="https://youtu.be/vm63p8Od0bM">Video recording of the</a> lecture based on this article. </li><li>  First of all, <a href="http://seaborn.pydata.org/api.html">official documentation</a> and a <a href="http://seaborn.pydata.org/examples/index.html">gallery of</a> examples of various graphs for <code>seaborn</code> </li><li>    <code>plotly</code>    : <a href="https://plot.ly/python/reference/"> </a> , <a href="https://plot.ly/python/">   </a> </li><li>  ,       <code>plotly</code>        <a href="https://habrahabr.ru/post/308162/">         python</a> .   c ,   ,        drop-down menu. </li></ul><br><p> <em>     <a href="https://habr.com/users/yorko/" class="user_link">yorko</a> ( ).</em> </p></div><p>Source: <a href="https://habr.com/ru/post/323210/">https://habr.com/ru/post/323210/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323200/index.html">Power BI Embedded, IoT and machine learning for processing brain thermograms</a></li>
<li><a href="../323202/index.html">Web scraper development to extract data from the open data portal of Russia data.gov.ru</a></li>
<li><a href="../323204/index.html">Apache Ant - quick start</a></li>
<li><a href="../323206/index.html">Program on PYTHON to determine the authorship of the text by the frequency of occurrence of new words</a></li>
<li><a href="../323208/index.html">Nginx + PHP 7.1.1 FPM vs Node.js 7.7.1 as part 2 backend</a></li>
<li><a href="../323212/index.html">Where the games go: the problem of preserving old video games. Part 1</a></li>
<li><a href="../323214/index.html">React Native - one JS is not enough</a></li>
<li><a href="../323220/index.html">Chronic Fatigue Syndrome. What it is, causes and consequences</a></li>
<li><a href="../323224/index.html">Zynq SoC Programming</a></li>
<li><a href="../323226/index.html">Intranet, Office 365, Digital Workplace. How to go through a digital minefield</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>