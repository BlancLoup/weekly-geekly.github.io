<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>10 critical event ID to monitor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Randy Franklin Smith (CISA, SSCP, Security MVP) has a very useful document in his arsenal that tells about which event IDs should be monitored as part...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>10 critical event ID to monitor</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/329/998/fe2/329998fe25fe083fb927b43cfb49b5ba.jpg"><br>  Randy Franklin Smith (CISA, SSCP, Security MVP) has a very <a href="http://www.ultimatewindowssecurity.com/securitylog/quickref/Default.aspx">useful document</a> in his arsenal that tells about which event IDs should be monitored as part of Windows information security.  This document contains extremely useful information that will allow you to ‚Äúsqueeze‚Äù the maximum out of the standard audit system.  We have prepared a translation of this material.  We invite interested persons under cat. <br><a name="habracut"></a><br>  We already wrote about <a href="http://habrahabr.ru/company/netwrix/blog/143878/">how to set up an audit</a> in one of our posts.  But of all the event id that are found in the event logs, you need to stop your attention on several critical important.  On what exactly - to decide each.  However, Randy Franklin Smith suggests focusing on 10 important security events in Windows. <br><br><h4>  Domain Controllers </h4><br>  <u>Event ID - (Category) - Description</u> <br><br>  1) <b>675 or 4771</b> <br>  <i>(Audit event logon)</i> <br>  Event 675/4771 on a domain controller indicates an unsuccessful attempt to log in via Kerberos on a workstation with a domain account.  This is usually caused by an inappropriate password, but the error code indicates why the authentication was unsuccessful.  The Kerberos error code table is shown below. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2) <b>676, or Failed 672 or 4768</b> <br>  <i>(Audit event logon)</i> <br>  Event 676/4768 logs for other types of failed authentication.  The Kerberos code table is shown below. <br>  ATTENTION: In Windows 2003 Server, a failure event is recorded as 672 instead of 676. <br><br>  3) <b>681 or Failed 680 or 4776</b> <br>  <i>(Audit event logon)</i> <br>  Event 681/4776 on a domain controller indicates a failed login attempt through <br>  NTLM with a domain account.  The error code indicates why authentication was unsuccessful. <br>  NTLM error codes are listed below. <br>  ATTENTION: In Windows 2003 Server, a failure event is recorded as 680 instead of 681. <br><br>  4) <b>642 or 4738</b> <br>  <i>(Account Management Audit)</i> <br>  Event 642/4738 indicates changes to the specified account, such as resetting a password or activating a previously deactivated account.  The event description is updated according to the type of change. <br><br>  5) <b>632 or 4728;</b>  <b>636 or 4732;</b>  <b>660 or 4756</b> <br>  <i>(Account Management Audit)</i> <br>  All three events indicate that the specified user has been added to a specific group.  Global (Local) and Local (Local) and Universal (Universal) are indicated for each ID, respectively. <br><br>  6) <b>624 or 4720</b> <br>  <i>(Account Management Audit)</i> <br>  A new user account has been created. <br><br>  7) <b>644 or 4740</b> <br>  <i>(Account Management Audit)</i> <br>  The specified user account has been blocked after several login attempts. <br><br>  8) <b>517 or 1102</b> <br>  <i>(Audit system events)</i> <br>  The specified user has cleared the security log <br><br><h4>  Login and Logout (Logon / Logoff) </h4><br>  <u>Event Id - Description</u> <br><br>  <b>528 or 4624</b> - Successful Login <br>  <b>529 or 4625</b> - Failure to login - Unknown username or invalid password <br>  530 or 4625 Login failed - The login was not completed within the specified time period. <br>  <b>531 or 4625</b> - Failure to login - Account temporarily deactivated <br>  <b>532 or 4625</b> - Login failed - The specified account has expired. <br>  <b>533 or 4625</b> - Failure to enter the system - The user is not allowed to log into the system on this computer <br>  <b>534 or 4625 or 5461</b> - Failure to login - User was not allowed the requested type of login on this computer <br>  <b>535 or 4625</b> - Login <b>failed</b> - The specified account password has expired <br>  <b>539 or 4625</b> - Login failed - Account locked out <br>  <b>540 or 4624</b> - Successful Network Login (Only Windows 2000, XP, 2003) <br><br><h4>  Types of Logins (Logon Types) </h4><br>  <u>Login Type - Description</u> <br><br>  <b>2</b> - Interactive (input from the keyboard or system screen) <br>  <b>3</b> - Network (for example, connecting to a shared folder on this computer from anywhere on the network or IIS login - Never logged on 528 on Windows Server 2000 or higher. See event 540) <br>  <b>4</b> - Package (batch) (for example, scheduled task) <br>  <b>5</b> - Service (Start service) <br>  <b>7</b> - Unlock (for example, a maintenance-free workstation with password-protected screensaver) <br>  <b>8</b> - NetworkCleartext (Login with credentials sent as plain text. Often indicates login to IIS with ‚Äúbasic authentication‚Äù) <br>  <b>9</b> - NewCredentials <br>  <b>10</b> - RemoteInteractive (Terminal Services, Remote Desktop or Remote Assistance) <br>  <b>11</b> - CachedInteractive (login with cached domain permissions, for example, login to a workstation that is not online) <br><br><h4>  Kerberos Fault Codes </h4><br>  <u>Error Code - Reason</u> <br><br>  <b>6</b> - Username does not exist <br>  <b>12</b> - Restriction of the working machine;  login time limit <br>  <b>18</b> - Account is deactivated, blocked or expired <br>  <b>23</b> - Expired user password <br>  <b>24</b> - Pre-authentication failed;  usually the reason is the wrong password <br>  <b>32</b> - Application expired.  This is a normal event that is logged by computer accounts. <br>  <b>37</b> - Time on a working machine has not been synchronized with time on a domain controller for a long time. <br><br><h4>  NTLM Error Codes </h4><br>  <u>Error code (decimal system) - Error code (hex system) - Description</u> <br><br>  3221225572 - C0000064 - This username does not exist <br>  3221225578 - C000006A - The correct username, but the password is incorrect <br>  3221226036 - C0000234 - User account is locked <br>  3221225586 - C0000072 - Account deactivated <br>  3221225583 - C000006F - The user is trying to log in to the system outside the designated period of time (working time) <br>  3221225584 - C0000070 - Restriction of the workstation <br>  3221225875 - C0000193 - The account has expired <br>  3221225585 - C0000071 - The password has expired <br>  3221226020 - C0000224 - The user must change the password at the next logon <br><br>  Once again let's duplicate the link to download the document on the Randy Franklin Smith <a href="http://www.ultimatewindowssecurity.com/securitylog/quickref/Default.aspx">website www.ultimatewindowssecurity.com/securitylog/quickref/Default.aspx</a> .  You will need to fill out a small form to access it. <br><br>  <i>PS Do you want to fully automate work with event logs?</i>  <i>Try a new version of <a href="http://www.netwrix.com/ru/event_log_archiving_consolidation_freeware.html">NetWrix Event Log Manager 4.0</a> , which collects and archives event logs, builds reports and generates alerts in real time.</i>  <i>The program collects data from numerous computers on the network, alerts you about critical events and centrally stores data about all events in a compressed format for the convenience of analyzing archived log data.</i>  <i>A free version of the program is available for 10 domain controllers and 100 computers.</i> </div><p>Source: <a href="https://habr.com/ru/post/148501/">https://habr.com/ru/post/148501/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148495/index.html">Play box</a></li>
<li><a href="../148496/index.html">Competition for the best A / V testing</a></li>
<li><a href="../148497/index.html">How does Lytro, or another review</a></li>
<li><a href="../148498/index.html">From junior developer to senior</a></li>
<li><a href="../148500/index.html">Homemade budget sub for movie</a></li>
<li><a href="../148502/index.html">NASA has developed a technology for 3D printing of spare parts for spacecraft.</a></li>
<li><a href="../148503/index.html">The first criminal case for failing to pay 1% to Mikhalkov</a></li>
<li><a href="../148505/index.html">Gabe Newell is going to support Linux, because Windows 8 is a ‚Äúdisaster‚Äù</a></li>
<li><a href="../148506/index.html">Testing the order form in the online store</a></li>
<li><a href="../148508/index.html">Clang API. Start</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>