<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 15: attack on routers with DNS spoofing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The topic of vulnerabilities in network routers is not the first time we are addressing, but the research of the Bad Packets and Ixia companies ( news...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 15: attack on routers with DNS spoofing</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ls/66/9z/ls669z3fo8aghcsnkgdrcmdb1f8.png" align="right">  The topic of vulnerabilities in network routers is <a href="https://habr.com/ru/company/kaspersky/blog/425701/">not the first</a> time we are addressing, but the research of the Bad Packets and Ixia companies ( <a href="https://threatpost.ru/new-dns-hijacking-campaign-exploits-vulnerable-routers/32144/">news</a> , Bad Packets <a href="https://www.ixiacom.com/company/blog/paypal-netflix-gmail-and-uber-users-among-targets-new-wave-dns-hijacking-attacks">report,</a> Ixia <a href="https://www.ixiacom.com/company/blog/paypal-netflix-gmail-and-uber-users-among-targets-new-wave-dns-hijacking-attacks">report</a> ) is interesting because they provide an almost complete picture: how to break routers, what settings change, and what then it happens. <br><br>  Such attacks do not have any technically complex elements, and the goal of the attackers is simple - to earn money from advertising and, if possible, to steal passwords for access to banking systems and paid Internet services.  In short: the attackers scanned the network to find vulnerable routers (mostly non-new D-Link production models).  Having found such a router, they changed the DNS records in it, redirecting traffic to their own servers.  Vulnerabilities were used for this trivial, access to the settings for non-patched devices occurred without authorization.  The oldest devices in the target list are more than 10 years old, but despite this, in theory, cybercriminals could attack more than 15 thousand victims. <br><a name="habracut"></a><br>  Specialists Bad Packets recorded three attacks with common signs at the end of December last year, as well as in February and the end of March 2019.  In all cases, the Google Cloud Platform service was used for the first stage of the attack: a virtual server was created that made a dial-up of network devices. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1079251375987425280"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  The scan was aimed at finding devices with known vulnerabilities, mostly they were not the most modern routers manufactured by D-Link.  Later, using the <a href="https://badpackets.net/ongoing-dns-hijacking-campaign-targeting-consumer-routers/">BinaryEdge</a> service that collects information about the parameters of network devices, it was possible to estimate how many devices were in principle vulnerable to such an attack.  Of the dozen models that were definitely attacked during this campaign, only one had recorded several thousand ‚Äúhits‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/ct/wm/dm/ctwmdmqe32tfhrjszrs7_av32ny.png"></div><br>  This is an D-Link <a href="https://eu.dlink.com/uk/en/products/dsl-2640b-adsl-2-wireless-g-router-with-4-port-10-100-switch">DSL-2640B</a> ADSL router.  Stored megabyte Ethernet, WiFi 802.11g support - overall not bad for a model that has been available since 2007.  Other models (for example, D-Link 2740R, 526B and others, only about a dozen versions), if they benefited attackers, then on a small scale - only a few hundred of such devices are available on the network. <br><br>  In 2012, the traditional for network devices <a href="https://www.cvedetails.com/cve/CVE-2012-1308/">vulnerability</a> was discovered in the 2640B model: if you force the user logged into the web interface of the router to click on the prepared link, you can gain control of the device.  And in 2017, a more serious problem was discovered in the same router: it turned out that it was possible to replace DNS server records <a href="https://www.exploit-db.com/exploits/42197">without authorization</a> .  Naturally, if the web interface of the router is accessible from the outside, which should not happen under normal conditions. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zv/ni/ns/zvninsoous63olxg8xxty2pel9o.png"></div><br>  The consequences of DNS server substitution are obvious: attackers have the opportunity to substitute ad banners with their own, show fake websites to users at the "correct" address, attack computers connected to the router with the use of malware directly. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-1" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1114190053226549248"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  What exactly happens with the attacked router, found out in the company Ixia.  It was done this way: on the test system, the attackers' server was installed as a DNS server, then a list of 10,000 domain names of the most popular sites was run (according to the Alexa version).  It was necessary to find out for which domains a fake DNS server is trying to lead victims to its own versions of sites.  Site spoofing was fixed for four global services: Paypal, GMail, Uber and Netflix.  Other domains (more than ten in total) were local services of banks and network providers in Brazil. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zr/qo/by/zrqobyvgmmelhwtkl3ml8rdofmw.png"></div><br>  A copy of the banking service looks reliable, only a lack of HTTPS connection indicates a fake.  The attackers apparently did not have time to properly prepare some of the redirects: instead of <a href="http://cetelem.com/">cetelem.com</a> , for example, the standard Apache web server plug was shown.  In the event of a specific attack in March of this year, both fake websites and the DNS server itself also hosted on the Google cloud platform.  In response to a request from <a href="https://arstechnica.com/information-technology/2019/04/ongoing-dns-hijackings-target-unpatched-consumer-routers/">Arstechnica</a> , Google reported that malicious services were blocked and measures were taken to automatically block such operations in the future.  However, the point is not Google: other waves of attack used servers in Canada and Russia. <br><br>  In general, in this particular case we are not talking about a large-scale attack.  Defective devices that have been around for many years, with fairly long-known vulnerabilities, and which for some reason (erroneous configuration, insecure default settings), in principle, allow you to open a web interface when accessing from the Internet, and not just from the local network.  In this case, it is hardly worth relying on a patch for the old firmware, it is easier to upgrade.  Why are attackers even attacking such relatively few types of devices?  It is quite simple and profitable. <br><br>  Large-scale attacks with DNS spoofing have been fixed for the last ten years, there have been more creative methods, such as <a href="https://securelist.ru/switcher-android-joins-the-attack-the-router-club/29910/">attacking routers</a> with a malicious application, after connecting to Wi-Fi.  Then there are a lot of ways to dishonestly withdraw money: phishing and subsequent resale of passwords on the black market (recently paid service accounts for streaming music and video have become a hot commodity, direct theft of funds through banking and payment services, distribution of malicious software.  In the same Brazil, similar attacks took on the character of an <a href="https://threatpost.ru/ghostdns-infected-over-100k-routers-in-brazil/28514/">epidemic</a> , the score goes to hundreds of thousands of attacked devices.  So today we have before us a fairly well documented, but a small episode of the turbulent activity of cybercrime. <br><br>  <i>Disclaimer: The opinions expressed in this digest may not always coincide with the official position of Kaspersky Lab.</i>  <i>Dear editors generally recommend to treat any opinions with healthy skepticism.</i> </div><p>Source: <a href="https://habr.com/ru/post/447258/">https://habr.com/ru/post/447258/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447246/index.html">Prototype in 1 day instead of 2-3 weeks: 3D-printing in concern ‚ÄúOceanpribor‚Äù</a></li>
<li><a href="../447248/index.html">What is explored in the stratosphere?</a></li>
<li><a href="../447250/index.html">Learning to communicate between microservices on Node.js via RabbitMQ</a></li>
<li><a href="../447252/index.html">Help Duke to find a way out</a></li>
<li><a href="../447256/index.html">Miracle Materialize Magics: Nissan spends seconds instead of several months of work</a></li>
<li><a href="../447260/index.html">Live Share in Visual Studio 2019</a></li>
<li><a href="../447262/index.html">We accelerate the site with JivoSite. Delayed download online consultant</a></li>
<li><a href="../447264/index.html">Ignite Service Grid - reboot</a></li>
<li><a href="../447266/index.html">Language and senses</a></li>
<li><a href="../447268/index.html">Announced new features of Microsoft Azure Security Center</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>