<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Storage Recycling Analysis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How to understand that storage is bad? How to determine that the performance margin is exhausted? What parameters indicate this? This article will dis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Storage Recycling Analysis</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/e1b/8bf/7f6/e1b8bf7f6c4f4b7198f2ab08443c4488.png" alt="image"><br><br>  How to understand that storage is bad?  How to determine that the performance margin is exhausted?  What parameters indicate this?  This article will discuss the analysis of storage utilization, as well as the identification and prediction of problems related to performance.  The material may not be of interest to experienced storage administrators, since only general points will be considered, without delving into the logic of tricky performance optimization mechanisms. <br><a name="habracut"></a><br>  To begin with we will be defined with terminology.  There are several terms and abbreviations close in meaning: storage, disk array, SAN, Storage Array, or just Storage.  I'll try to clarify. <br><br>  <b>SAN</b> - Storage Area Network or storage area network, is a collection of equipment that transmits traffic between a server and a storage system. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Storage - data storage system or disk array, the equipment on which data is stored with the possibility of real-time access.  There are still archival vaults, but here we will not consider them.  <i>Storage</i> abbreviation can also be used as an abbreviation for <i>saving data storage</i> , but among Russian- <i>speaking</i> specialists, the term storage system is assigned to the data storage system. <br><br>  Storage systems can provide two ways to access data: <br><br><ul><li>  Block access, server operating system works with storage as with a SCSI hard disk (simplified). </li><li>  File access, server operating system works with DSS as with file storage using NFS, SMB and so on. </li></ul><br>  Typically, storage systems providing block access have higher performance requirements than systems providing file access, this is due to the specifics of the tasks being solved.  Next, we will focus on storage with block access using the Fiber Channel protocol. <br><br><h3>  Three main metrics are used to evaluate storage performance. </h3><br><ol><li>  Service Time, often referred to as latency or responce time, is measured in milliseconds and means: <br><ul><li>  when reading: the time from the moment the storage system received the task to read the information block to send the requested information. </li><li>  during recording: time from the moment of receiving the recorded block of information until confirmation of its successful recording. </li></ul></li><li>  IO / s is the number of input / output operations per second. </li><li>  MB / s - the number of megabytes transferred per second. <br></li></ol><br>  The parameters IO / s and MB / s are closely related to each other by the size of the data block, i.e.  One megabyte of information can be written in blocks of 4k and receive 256 I / O operations, or blocks of 64k and get 16 IO. <br><br>  Consider the most typical manifestations of storage performance problems in terms of Service Time, IO / s and MB / s. <br><br><h3>  Increased Service Time </h3><br><img src="https://habrastorage.org/web/657/043/044/657043044e1347df93aebe8baff9389a.png" alt="image"><br><br>  For each storage system, there is an extreme value of Service Time that corresponds to maximum performance, in other words, a slight increase in load will lead to a significant increase in Service Time, thereby causing degradation of demanding applications. <br><br>  For example, below are graphs of Service Time versus IOPS for two storage configurations. <br><br>  ST for All flash storage, 2 Node, 24x1.9 TB SSD, RAID 5, Random 32k, 50/50 Read / Write. <br><br><img src="https://habrastorage.org/web/eee/6d9/738/eee6d97381cd4652bc82b48bd5e6cce4.png" alt="image"><br><br>  ST for classic storage, 2 Node, 24x1.8 TB HDD, RAID 5, Random 32k, 50/50 Read / Write. <br><br><img src="https://habrastorage.org/web/1d5/2b8/926/1d52b8926e874a35ac1cfb81a5600e69.png" alt="image"><br><br>  In general cases, for All Flash the storage system is considered to be acceptable service time less than 1ms, and for classic storage systems up to 20ms.  The threshold for an acceptable Service time depends on the number of controllers, the speed of the disks and, of course, the models of the storage system itself, and may differ from the given values. <br>  You also need to consider to what level the delays of the disk subsystem maintain the normal operation of the application, and always have the necessary margin. <br><br><h3>  MB / s bar </h3><br><img src="https://habrastorage.org/web/285/360/52e/28536052eb034ca6b5179d2a2ba5700d.png" alt="image"><br><br>  Most often indicates the exhaustion of bandwidth or FC adapter. <br><br><h3>  Competing values ‚Äã‚Äãfor MB / s or IO / s </h3><br><img src="https://habrastorage.org/web/7ef/9b5/667/7ef9b566794c404193857d3c1660d8b2.png" alt="image"><br><br>  The sum (orange graph) of two or more parameters on a time interval has a constant and does not exceed it at any time.  This situation can occur in the case of competition for bandwidth of the channel or port of the storage system. <br><br><h3>  Decrease of IO with increasing ST </h3><br><img src="https://habrastorage.org/web/5e9/c52/b4c/5e9c52b4cd9d4592867877532901cc33.png" alt="image"><br><br><img src="https://habrastorage.org/web/5a0/fdf/c7c/5a0fdfc7c964413fb858d86e2f88fca6.png" alt="image"><br><br>  If the percentage distribution of the block sizes has not changed, but at the same time the ST starts to increase and the IO falls, this may indicate hardware problems with storage, degradation of one of the controllers or high utilization of the CPU. <br><br><h3>  CPU utilization </h3><br>  CPU utilization of storage controllers in general cases should not exceed 70%, if it is constantly above 70%, this indicates the lack of storage performance margin. <br>  Here it should be noted that storage systems can be divided into two large groups: <br><br><ul><li>  Using ASICs, in such storage systems the data transfer within the array is processed by a separate high-performance chip, and the CPU remains with service tasks, such as creating and deleting disks and snapshots, collecting statistics, and so on. </li><li>  Without using ASIC, in such storage systems all tasks are performed by the CPU. </li></ul><br>  CPU utilization should be interpreted differently for storage systems with and without ASIC, but in any case it should not be higher than 70% in the absence of running service tasks. <br><br><h3>  Slow IO reading </h3><br><img src="https://habrastorage.org/web/5b2/c43/8bf/5b2c438bffb9446290ba3b670481d779.png" alt="image"><br><br>  Such a problem can be observed if the storage system uses the data placement tearing between media of different speeds (for example, SSD and NL SATA). <br><br>  For example: a certain database works with a high load one day a week, and idle for the rest of the time, in which case data for which there have been no calls for a long time will go to media at low speed, and the reading speed will gradually increase during the transition (the so-called data warming) on fast carriers. <br><br><h3>  What is the nature of the load does not indicate problems? </h3><br>  <b>IO ramp</b> <br><br><img src="https://habrastorage.org/web/9d4/d45/8da/9d4d458da41a43f3a6ca46b0f014f46f.png" alt="image"><br><br>  <b>MB Racing</b> <br><br><img src="https://habrastorage.org/web/807/01c/ee3/80701cee304241bbb86a184efb4228a1.png" alt="image"><br><br>  <b>Jumping IO values</b> <br><br><img src="https://habrastorage.org/web/787/c15/0f9/787c150f9798438bb04103321bd9a396.png" alt="image"><br><br>  All of the above load cases do not indicate any problems on the storage side.  The load is created by the host connected to the storage system and depends on the logic of the processes using disk space. <br><br><h3>  How to determine trashholds for Service Time, IO / s and MB / s? </h3><br>  These parameters can be calculated theoretically, adding up the performance of the disks and considering the penalty of the selected RAID level, you can also use the saisers if present, but the calculation will be very approximate, since the actual load profile will not be taken into account.  To determine the exact threshold values, indicating, for example, about 90% of the storage load, it is necessary to carry out load testing using special software, having formed a load profile that is close to real and measure the maximum values ‚Äã‚Äãof IO / s and MB / s.  But what about Service Time?  There is a non-linear relationship.  To determine the Service Time of the corresponding 90% load, you simply need to generate 90% of the maximum achieved value by IO.  The results obtained can be extrapolated to similar configurations of data storage systems. <br><br><h3>  Instead of conclusion </h3><br>  Analysis and interpretation of storage performance parameters in most cases is not a trivial task, you need to understand the architecture and operation of a specific storage system, have a SAN port scheme and know the operation nuances of the used FC adapters.  I did not consider the impact of replication and the use of convergent solutions, since the use of these technologies significantly complicates the description of processes affecting performance and narrows the list of general recommendations.  The article did not understand the parameters of using the controller cache, disk loading and utilization of the internal switching ports of the data storage system, since the interpretation of this data strongly depends on the specific storage model and technologies used. </div><p>Source: <a href="https://habr.com/ru/post/338438/">https://habr.com/ru/post/338438/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338428/index.html">How we teach AI to help find employees</a></li>
<li><a href="../338430/index.html">REQ Labs 2017. Online conference for business and system analysts</a></li>
<li><a href="../338432/index.html">Uptime day 2: Russian IT companies will talk about how to cope with disasters</a></li>
<li><a href="../338434/index.html">Oblique frustum. Inside the oblique visibility pyramid</a></li>
<li><a href="../338436/index.html">learnopengl. Lessons 3.1 (Assimp) + 3.2 (Mesh class)</a></li>
<li><a href="../338440/index.html">Library of quick path search on the graph</a></li>
<li><a href="../338442/index.html">Stages of development of the Java Online Projects learning project: how it was, an inside look</a></li>
<li><a href="../338444/index.html">VEDO. External electronic document management what it is and how to choose</a></li>
<li><a href="../338450/index.html">How to run your project on Product Hunt: Administration Guide</a></li>
<li><a href="../338452/index.html">Broadcast from the gamedev conference 4C in St. Petersburg. The first day</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>