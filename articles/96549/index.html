<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with CCK Filefield. Insert and display Flash</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sometimes it is necessary to display a file on a site not just by reference, but in some other way. Video and audio files you want to display the play...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with CCK Filefield. Insert and display Flash</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/e18/1b8/bc0/e181b8bc02b12710d1c0e31dee0241b7.png" alt="image" align="left">  Sometimes it is necessary to display a file on a site not just by reference, but in some other way.  Video and audio files you want to display the player, with the ability to view (listen), swf - immediately displayed on the page.  There is an excellent Filefield module for attaching files to materials, but the choice of formatters for it is small.  The file can be displayed simply by reference.  Other modules slightly expand its functionality, for example Imagefield allows you to display images.  I will try to explain in an easy way how to add the ability to display Flash content using the example of the SWFfield module. <br><br>  <font color="#696969"><sup><i>Further there will be a lot of code, few pictures and in general everything is boring and sad ...</i></sup></font> <br><a name="habracut"></a><br><h4>  Start </h4><br>  Create a new directory <b>swffield</b> in the modules directory. <br>  As with any module, we will need a .info file, in our case - <b>swffield.info</b> <br><blockquote><code><a href="http://s-c.me/7743/s"></a> <a href="http://s-c.me/7743/h"></a> <font color="black">Copy Source | Copy HTML name = SwfField description =   Flash  CCK. dependencies[] = content dependencies[] = filefield package = CCK core = 6.x version = "6.x-1.1"</font></code> <ol> <li> <code><font color="black"><a href="http://s-c.me/7743/s"></a> <a href="http://s-c.me/7743/h"></a> Copy Source | Copy HTML name = SwfField description =   Flash  CCK. dependencies[] = content dependencies[] = filefield package = CCK core = 6.x version = "6.x-1.1"</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/7743/s"></a> <a href="http://s-c.me/7743/h"></a> Copy Source | Copy HTML name = SwfField description =   Flash  CCK. dependencies[] = content dependencies[] = filefield package = CCK core = 6.x version = "6.x-1.1"</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/7743/s"></a> <a href="http://s-c.me/7743/h"></a> Copy Source | Copy HTML name = SwfField description =   Flash  CCK. dependencies[] = content dependencies[] = filefield package = CCK core = 6.x version = "6.x-1.1"</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/7743/s"></a> <a href="http://s-c.me/7743/h"></a> Copy Source | Copy HTML name = SwfField description =   Flash  CCK. dependencies[] = content dependencies[] = filefield package = CCK core = 6.x version = "6.x-1.1"</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/7743/s"></a> <a href="http://s-c.me/7743/h"></a> Copy Source | Copy HTML name = SwfField description =   Flash  CCK. dependencies[] = content dependencies[] = filefield package = CCK core = 6.x version = "6.x-1.1"</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/7743/s"></a> <a href="http://s-c.me/7743/h"></a> Copy Source | Copy HTML name = SwfField description =   Flash  CCK. dependencies[] = content dependencies[] = filefield package = CCK core = 6.x version = "6.x-1.1"</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/7743/s"></a> <a href="http://s-c.me/7743/h"></a> Copy Source | Copy HTML name = SwfField description =   Flash  CCK. dependencies[] = content dependencies[] = filefield package = CCK core = 6.x version = "6.x-1.1"</font></code> </li> </ol></blockquote><br><br>  We also need the <b>swffield.install</b> file <b>.</b> <br><blockquote> <code><a href="http://s-c.me/7745/s"></a> <a href="http://s-c.me/7745/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#696969">// hook_install (install module)</font> </li><li>  <font color="#0000ff">function</font> swffield_install () { </li><li>  <font color="#696969">// Load the content module</font> </li><li>  drupal_load ( <font color="#008000">'module'</font> , <font color="#008000">'content'</font> ); </li><li>  <font color="#696969">// We inform CCK about the installation of a new module</font> </li><li>  content_notify ( <font color="#008000">'install'</font> , <font color="#008000">'swffield'</font> ); </li><li>  } </li><li></li><li>  <font color="#696969">// hook_uninstall (remove the module)</font> </li><li>  <font color="#0000ff">function</font> swffield_uninstall () { </li><li>  drupal_load ( <font color="#008000">'module'</font> , <font color="#008000">'content'</font> ); </li><li>  <font color="#696969">// We inform CCK about the removal of the new module</font> </li><li>  content_notify ( <font color="#008000">'uninstall'</font> , <font color="#008000">'swffield'</font> ); </li><li>  } </li><li></li><li>  <font color="#696969">// hook_enable (enable module)</font> </li><li>  <font color="#0000ff">function</font> swffield_enable () { </li><li>  drupal_load ( <font color="#008000">'module'</font> , <font color="#008000">'content'</font> ); </li><li>  <font color="#696969">// We inform CCK about the inclusion of the new module</font> </li><li>  content_notify ( <font color="#008000">'enable'</font> , <font color="#008000">'swffield'</font> ); </li><li>  } </li><li></li><li>  <font color="#696969">// hook_disable (disable module)</font> </li><li>  <font color="#0000ff">function</font> swffield_disable () { </li><li>  drupal_load ( <font color="#008000">'module'</font> , <font color="#008000">'content'</font> ); </li><li>  <font color="#696969">// We inform CCK about disabling the new module</font> </li><li>  content_notify ( <font color="#008000">'disable'</font> , <font color="#008000">'swffield'</font> ); </li><li>  } </li></ol></blockquote><br><h4>  Module </h4><br>  We will create the files <i>swffield.module</i> , <i>swffield.render.inc</i> (we will bring here all the code related to displaying the content to the user) and <i>swffield.widget.inc</i> (displaying the field in the admin panel).  In principle, all code can be written in <i>swffield.module</i> - it will work. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>swffield.module</b> <br><blockquote> <code><a href="http://s-c.me/7747/s"></a> <a href="http://s-c.me/7747/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#696969">// Connect the necessary files</font> </li><li>  module_load_include ( <font color="#008000">'inc'</font> , <font color="#008000">'swffield'</font> , <font color="#008000">'swffield.render'</font> ); </li><li>  module_load_include ( <font color="#008000">'inc'</font> , <font color="#008000">'swffield'</font> , <font color="#008000">'swffield.widget'</font> ); </li><li></li><li>  <font color="#696969">// Initialization.</font>  <font color="#696969">Check if Filefield is there, if not, disable the module.</font> </li><li>  <font color="#0000ff">function</font> swffield_init () { </li><li>  <font color="#0000ff">if</font> (! module_exists ( <font color="#008000">'filefield'</font> )) { </li><li>  module_disable ( <font color="#0000ff">array</font> ( <font color="#008000">'swffield'</font> )); </li><li>  <font color="#0000ff">return</font> ; </li><li>  } </li><li>  } </li><li></li><li>  <font color="#696969">// Set the data entry form of the widget and how it is processed.</font> </li><li>  <font color="#696969">// Our field is no different from the Filefield field</font> </li><li>  <font color="#0000ff">function</font> swffield_elements () { </li><li>  <font color="#cc6633">$ filefield_elements</font> = module_invoke ( <font color="#008000">'filefield'</font> , <font color="#008000">'elements'</font> ); </li><li>  <font color="#cc6633">$ elements</font> [ <font color="#008000">'swffield_widget'</font> ] = <font color="#cc6633">$ filefield_elements</font> [ <font color="#008000">'filefield_widget'</font> ]; </li><li></li><li>  <font color="#0000ff">return</font> <font color="#cc6633">$ elements</font> ; </li><li>  } </li><li></li><li>  <font color="#696969">// Report CCK Formatter Information</font> </li><li>  <font color="#0000ff">function</font> swffield_field_formatter_info () { </li><li>  <font color="#cc6633">$ formatters</font> = <font color="#0000ff">array</font> ( </li><li>  <font color="#008000">'swffield_flash'</font> =&gt; <font color="#0000ff">array</font> ( </li><li>  <font color="#008000">'label'</font> =&gt; t ( <font color="#008000">'Flash'</font> ), </li><li>  <font color="#008000">'field types'</font> =&gt; <font color="#0000ff">array</font> ( <font color="#008000">'filefield'</font> ), </li><li>  <font color="#008000">'description'</font> =&gt; t ( <font color="#008000">'Displays Flash content'</font> ), </li><li>  ), </li><li>  ); </li><li>  <font color="#0000ff">return</font> <font color="#cc6633">$ formatters</font> ; </li><li>  } </li><li></li><li>  <font color="#696969">// Specify the standard field value as Filefield.</font> </li><li>  <font color="#0000ff">function</font> swffield_default_value (&amp; <font color="#cc6633">$ form</font> , &amp; <font color="#cc6633">$ form_state</font> , <font color="#cc6633">$ field</font> , <font color="#cc6633">$ delta</font> ) { </li><li>  <font color="#0000ff">return</font> filefield_default_value ( <font color="#cc6633">$ form</font> , <font color="#cc6633">$ form_state</font> , <font color="#cc6633">$ field</font> , <font color="#cc6633">$ delta</font> ); </li><li>  } </li><li></li><li>  <font color="#696969">// Specify when the field is considered empty</font> </li><li>  <font color="#0000ff">function</font> swffield_content_is_empty ( <font color="#cc6633">$ item</font> , <font color="#cc6633">$ field</font> ) { </li><li>  <font color="#0000ff">return</font> filefield_content_is_empty ( <font color="#cc6633">$ item</font> , <font color="#cc6633">$ field</font> ); </li><li>  } </li><li></li><li>  <font color="#696969">// Add another handler to save the field settings</font> </li><li>  <font color="#0000ff">function</font> swffield_form_content_field_overview_form_alter (&amp; <font color="#cc6633">$ form</font> , &amp; <font color="#cc6633">$ form_state</font> ) { </li><li>  <font color="#cc6633">$ form</font> [ <font color="#008000">'#submit'</font> ] [] = <font color="#008000">'swffield_form_content_field_overview_submit'</font> ; </li><li>  } </li><li></li><li>  <font color="#696969">// Handler for saving field settings</font> </li><li>  <font color="#0000ff">function</font> swffield_form_content_field_overview_submit (&amp; <font color="#cc6633">$ form</font> , &amp; <font color="#cc6633">$ form_state</font> ) { </li><li>  <font color="#696969">// If we add a new field to the material</font> </li><li>  <font color="#0000ff">if</font> ( <font color="#0000ff">isset</font> ( <font color="#cc6633">$ form_state</font> [ <font color="#008000">'fields_added'</font> ] [ <font color="#008000">'_add_new_field'</font> ]) &amp;&amp; <font color="#0000ff">isset</font> ( <font color="#cc6633">$ form</font> [ <font color="#008000">'#type_name'</font> ])) { </li><li>  <font color="#696969">// Field Type</font> </li><li>  <font color="#cc6633">$ new_field</font> = <font color="#cc6633">$ form_state</font> [ <font color="#008000">'fields_added'</font> ] [ <font color="#008000">'_add_new_field'</font> ]; </li><li>  <font color="#696969">// Material type</font> </li><li>  <font color="#cc6633">$ node_type</font> = <font color="#cc6633">$ form</font> [ <font color="#008000">'#type_name'</font> ]; </li><li>  <font color="#696969">// Array with field data</font> </li><li>  <font color="#cc6633">$ field</font> = content_fields ( <font color="#cc6633">$ new_field</font> , <font color="#cc6633">$ node_type</font> ); </li><li>  <font color="#696969">// If the field is added by our module</font> </li><li>  <font color="#0000ff">if</font> ( <font color="#cc6633">$ field</font> [ <font color="#008000">'widget'</font> ] [ <font color="#008000">'module'</font> ] == <font color="#008000">'swffield'</font> ) { </li><li>  <font color="#0000ff">foreach</font> ( <font color="#cc6633">$ field</font> [ <font color="#008000">'display_settings'</font> ] <font color="#0000ff">as</font> <font color="#cc6633">$ display_type</font> =&gt; <font color="#cc6633">$ display_settings</font> ) { </li><li>  <font color="#0000ff">if</font> ( <font color="#cc6633">$ field</font> [ <font color="#008000">'display_settings'</font> ] [ <font color="#cc6633">$ display_type</font> ] [ <font color="#008000">'format'</font> ] == <font color="#008000">'default'</font> ) { </li><li>  <font color="#696969">// Set the display of the "swffield_flash" field</font> </li><li>  <font color="#cc6633">$ field</font> [ <font color="#008000">'display_settings'</font> ] [ <font color="#cc6633">$ display_type</font> ] [ <font color="#008000">'format'</font> ] = <font color="#008000">'swffield_flash'</font> ; </li><li>  } </li><li>  } </li><li>  <font color="#696969">// Update the field</font> </li><li>  content_field_instance_update ( <font color="#cc6633">$ field</font> ); </li><li>  } </li><li>  } </li><li>  } </li></ol></blockquote><br>  <b>swffield.widget.inc</b> <br><blockquote> <code><a href="http://s-c.me/7748/s"></a> <a href="http://s-c.me/7748/h"></a> <a href="http://www.php.net/manual/en/function.explode.php"></a> <a href="http://www.php.net/manual/en/function.count.php"></a> <a href="http://www.php.net/manual/en/function.array-diff.php"></a> <a href="http://www.php.net/manual/en/function.preg-match.php"></a> <a href="http://www.php.net/manual/en/function.array-merge.php"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#696969">// Report CCK Widget Information</font> </li><li>  <font color="#0000ff">function</font> swffield_widget_info () { </li><li>  <font color="#0000ff">return array</font> ( </li><li>  <font color="#008000">'swffield_widget'</font> =&gt; <font color="#0000ff">array</font> ( </li><li>  <font color="#008000">'label'</font> =&gt; t ( <font color="#008000">'Flash'</font> ), </li><li>  <font color="#008000">'field types'</font> =&gt; <font color="#0000ff">array</font> ( <font color="#008000">'filefield'</font> ), </li><li>  <font color="#008000">'multiple values'</font> =&gt; CONTENT_HANDLE_CORE, </li><li>  <font color="#008000">'callbacks'</font> =&gt; <font color="#0000ff">array</font> ( <font color="#008000">'default value'</font> =&gt; CONTENT_CALLBACK_CUSTOM), </li><li>  <font color="#008000">'description'</font> =&gt; <font color="#008000">'Flash content'</font> , </li><li>  ), </li><li>  ); </li><li>  } </li><li></li><li>  <font color="#696969">// This hook will be called every time our field is added to the form</font> </li><li>  <font color="#0000ff">function</font> swffield_widget (&amp; <font color="#cc6633">$ form</font> , &amp; <font color="#cc6633">$ form_state</font> , <font color="#cc6633">$ field</font> , <font color="#cc6633">$ items</font> , <font color="#cc6633">$ delta</font> = <font color="#008000">0</font> ) { </li><li>  <font color="#cc6633">$ element</font> = filefield_widget ( <font color="#cc6633">$ form</font> , <font color="#cc6633">$ form_state</font> , <font color="#cc6633">$ field</font> , <font color="#cc6633">$ items</font> , <font color="#cc6633">$ delta</font> ); </li><li></li><li>  <font color="#0000ff">return</font> <font color="#cc6633">$ element</font> ; </li><li>  } </li><li></li><li>  <font color="#696969">// Settings widget (field)</font> </li><li>  <font color="#0000ff">function</font> swffield_widget_settings ( <font color="#cc6633">$ op</font> , <font color="#cc6633">$ widget</font> ) { </li><li>  <font color="#0000ff">switch</font> ( <font color="#cc6633">$ op</font> ) { </li><li>  <font color="#0000ff">case</font> <font color="#008000">'form'</font> : </li><li>  <font color="#0000ff">Return</font> swffield_widget_settings_form ( <font color="#cc6633">$ widget</font> ); </li><li>  <font color="#0000ff">case</font> <font color="#008000">'validate'</font> : </li><li>  <font color="#0000ff">Return</font> swffield_widget_settings_validate ( <font color="#cc6633">$ widget</font> ); </li><li>  <font color="#0000ff">case</font> <font color="#008000">'save'</font> : </li><li>  <font color="#0000ff">Return</font> swffield_widget_settings_save ( <font color="#cc6633">$ widget</font> ); </li><li>  } </li><li>  } </li><li></li><li>  <font color="#696969">// Form of field settings</font> </li><li>  <font color="#0000ff">function</font> swffield_widget_settings_form ( <font color="#cc6633">$ widget</font> ) { </li><li>  <font color="#cc6633">$ form</font> = module_invoke ( <font color="#008000">'filefield'</font> , <font color="#008000">'widget_settings'</font> , <font color="#008000">'form'</font> , <font color="#cc6633">$ widget</font> ); </li><li>  <font color="#696969">// By default, CCK substitutes the txt file type.</font> </li><li>  <font color="#696969">// Replace it with swf</font> </li><li>  <font color="#0000ff">if</font> ( <font color="#cc6633">$ form</font> [ <font color="#008000">'file_extensions'</font> ] [ <font color="#008000">'#default_value'</font> ] == <font color="#008000">'txt'</font> ) { </li><li>  <font color="#cc6633">$ form</font> [ <font color="#008000">'file_extensions'</font> ] [ <font color="#008000">'#default_value'</font> ] = <font color="#008000">'swf'</font> ; </li><li>  } </li><li>  <font color="#696969">// Width field to specify the width of the displayed content</font> </li><li>  <font color="#cc6633">$ form</font> [ <font color="#008000">'width'</font> ] = <font color="#0000ff">array</font> ( </li><li>  <font color="#008000">'#type'</font> =&gt; <font color="#008000">'textfield'</font> , </li><li>  <font color="#008000">'#title'</font> =&gt; <font color="#008000">'Width'</font> , </li><li>  <font color="#008000">'#default_value'</font> =&gt; <font color="#cc6633">$ widget</font> [ <font color="#008000">'width'</font> ]?  <font color="#cc6633">$ widget</font> [ <font color="#008000">'width'</font> ]: <font color="#008000">470</font> , </li><li>  <font color="#008000">'#size'</font> =&gt; <font color="#008000">15</font> , </li><li>  <font color="#008000">'#maxlength'</font> =&gt; <font color="#008000">5</font> , </li><li>  <font color="#008000">'#description'</font> =&gt; <font color="#008000">'Flash content width'</font> , </li><li>  <font color="#008000">'#weight'</font> =&gt; <font color="#008000">2</font> .  <font color="#008000">1</font> , </li><li>  ); </li><li>  <font color="#696969">// Similar to "Height"</font> </li><li>  <font color="#cc6633">$ form</font> [ <font color="#008000">'height'</font> ] = <font color="#0000ff">array</font> ( </li><li>  <font color="#008000">'#type'</font> =&gt; <font color="#008000">'textfield'</font> , </li><li>  <font color="#008000">'#title'</font> =&gt; <font color="#008000">'Height'</font> , </li><li>  <font color="#008000">'#default_value'</font> =&gt; <font color="#cc6633">$ widget</font> [ <font color="#008000">'height'</font> ]?  <font color="#cc6633">$ widget</font> [ <font color="#008000">'height'</font> ]: <font color="#008000">350</font> , </li><li>  <font color="#008000">'#size'</font> =&gt; <font color="#008000">15</font> , </li><li>  <font color="#008000">'#maxlength'</font> =&gt; <font color="#008000">5</font> , </li><li>  <font color="#008000">'#description'</font> =&gt; <font color="#008000">'Flash content height'</font> , </li><li>  <font color="#008000">'#weight'</font> =&gt; <font color="#008000">2</font> .  <font color="#008000">2</font> , </li><li>  ); </li><li>  <font color="#696969">// Alternate text settings if the user has Javascript disabled or the Flash Player isn‚Äôt</font> </li><li>  <font color="#cc6633">$ form</font> [ <font color="#008000">'alt_text'</font> ] = <font color="#0000ff">array</font> ( </li><li>  <font color="#008000">'#type'</font> =&gt; <font color="#008000">'textarea'</font> , </li><li>  <font color="#008000">'#title'</font> =&gt; <font color="#008000">'Alternate Text'</font> , </li><li>  <font color="#008000">'#default_value'</font> =&gt; <font color="#cc6633">$ widget</font> [ <font color="#008000">'alt_text'</font> ]?  <font color="#cc6633">$ widget</font> [ <font color="#008000">'alt_text'</font> ]: <font color="#008000">'Dear friends! &lt;br /&gt; Due to the fact that the technology of our site requires a pre-installed Adobe Flash Player, we strongly recommend that you install the latest version of the plug-in for your browser from &lt;a href = " http://www.adobe.com/go/getflashplayer"&gt;Adobe.com &lt;/a&gt;. '</font>  , </li><li>  <font color="#008000">'#description'</font> =&gt; <font color="#008000">'This text will be displayed if the user does not have the Flash player installed'</font> , </li><li>  <font color="#008000">'#weight'</font> =&gt; <font color="#008000">2</font> .  <font color="#008000">3</font> , </li><li>  ); </li><li>  <font color="#0000ff">return</font> <font color="#cc6633">$ form</font> ; </li><li>  } </li><li></li><li>  <font color="#696969">// Settings form validator</font> </li><li>  <font color="#0000ff">function</font> swffield_widget_settings_validate ( <font color="#cc6633">$ widget</font> ) { </li><li>  <font color="#cc6633">$ extensions</font> = array_filter (explode ( <font color="#008000">''</font> , <font color="#cc6633">$ widget</font> [ <font color="#008000">'file_extensions'</font> ])); </li><li>  <font color="#cc6633">$ flash_extensions</font> = <font color="#0000ff">array</font> ( <font color="#008000">'swf'</font> ); </li><li>  <font color="#696969">// Check the file extension</font> </li><li>  <font color="#0000ff">if</font> (count (array_diff ( <font color="#cc6633">$ extensions</font> , <font color="#cc6633">$ flash_extensions</font> ))) { </li><li>  form_set_error ( <font color="#008000">'file_extensions'</font> , <font color="#008000">'Only SWF format is supported'</font> ); </li><li>  } </li><li>  <font color="#696969">// Check Width And Height</font> </li><li>  <font color="#0000ff">foreach</font> ( <font color="#0000ff">array</font> ( <font color="#008000">'width'</font> , <font color="#008000">'height'</font> ) <font color="#0000ff">as</font> <font color="#cc6633">$ resolution</font> ) { </li><li>  <font color="#0000ff">if</font> ( <font color="#0000ff">empty</font> ( <font color="#cc6633">$ widget</font> [ <font color="#cc6633">$ resolution</font> ]) ||! preg_match ( <font color="#008000">'/ ^ [0-9] + $ /'</font> , <font color="#cc6633">$ widget</font> [ <font color="#cc6633">$ resolution</font> ])) { </li><li>  form_set_error ( <font color="#cc6633">$ resolution</font> , <font color="#008000">'</font> Invalid <font color="#008000">content size specified.'</font> ); </li><li>  } </li><li>  } </li><li>  <font color="#0000ff">return</font> module_invoke ( <font color="#008000">'filefield'</font> , <font color="#008000">'widget_settings'</font> , <font color="#008000">'validate'</font> , <font color="#cc6633">$ widget</font> ); </li><li>  } </li><li></li><li>  <font color="#696969">// Save the field settings</font> </li><li>  <font color="#0000ff">function</font> swffield_widget_settings_save ( <font color="#cc6633">$ widget</font> ) { </li><li>  <font color="#cc6633">$ filefield_settings</font> = module_invoke ( <font color="#008000">'filefield'</font> , <font color="#008000">'widget_settings'</font> , <font color="#008000">'save'</font> , <font color="#cc6633">$ widget</font> ); </li><li>  <font color="#0000ff">return</font> array_merge ( <font color="#cc6633">$ filefield_settings</font> , <font color="#0000ff">array</font> ( <font color="#008000">'width'</font> , <font color="#008000">'height'</font> , <font color="#008000">'alt_text'</font> )); </li><li>  } </li></ol></blockquote><br>  <b>swffield.render.inc</b> <br><blockquote> <code><a href="http://s-c.me/7749/s"></a> <a href="http://s-c.me/7749/h"></a> <a href="http://www.php.net/manual/en/function.rand.php"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#696969">// Theme Hook</font> </li><li>  <font color="#696969">// Set the theme functions for the widget, formatter and site display</font> </li><li>  <font color="#0000ff">function</font> swffield_theme () { </li><li>  <font color="#cc6633">$ theme</font> = <font color="#0000ff">array</font> ( </li><li>  <font color="#008000">'swffield_widget'</font> =&gt; <font color="#0000ff">array</font> ( </li><li>  <font color="#008000">'arguments'</font> =&gt; <font color="#0000ff">array</font> ( <font color="#008000">'element'</font> =&gt; NULL), </li><li>  ), </li><li>  <font color="#008000">'swffield_formatter_swffield_flash'</font> =&gt; <font color="#0000ff">array</font> ( </li><li>  <font color="#008000">'arguments'</font> =&gt; <font color="#0000ff">array</font> ( <font color="#008000">'element'</font> =&gt; NULL), </li><li>  ), </li><li>  <font color="#008000">'swffield_flash'</font> =&gt; <font color="#0000ff">array</font> ( </li><li>  <font color="#008000">'arguments'</font> =&gt; <font color="#0000ff">array</font> ( <font color="#008000">'item'</font> =&gt; NULL, <font color="#008000">'attributes'</font> =&gt; NULL), </li><li>  ), </li><li>  ); </li><li>  <font color="#0000ff">return</font> <font color="#cc6633">$ theme</font> ; </li><li>  } </li><li></li><li>  <font color="#696969">// Theming of the widget is the same as for any element of the form</font> </li><li>  <font color="#0000ff">function</font> theme_swffield_widget ( <font color="#cc6633">$ element</font> ) { </li><li>  <font color="#0000ff">return</font> theme ( <font color="#008000">'form_element'</font> , <font color="#cc6633">$ element</font> , <font color="#cc6633">$ element</font> [ <font color="#008000">'#children'</font> ]); </li><li>  } </li><li></li><li>  <font color="#696969">// Thematization of the formatter</font> </li><li>  <font color="#0000ff">function</font> theme_swffield_formatter_swffield_flash ( <font color="#cc6633">$ element</font> ) { </li><li>  <font color="#696969">// Check if the file is loaded</font> </li><li>  <font color="#0000ff">if</font> ( <font color="#0000ff">empty</font> ( <font color="#cc6633">$ element</font> [ <font color="#008000">'#item'</font> ] [ <font color="#008000">'fid'</font> ])) { </li><li>  <font color="#0000ff">return</font> <font color="#008000">''</font> ; </li><li>  } </li><li></li><li>  <font color="#cc6633">$ field</font> = content_fields ( <font color="#cc6633">$ element</font> [ <font color="#008000">'#field_name'</font> ], <font color="#cc6633">$ element</font> [ <font color="#008000">'#node'</font> ] -&gt; type); </li><li>  <font color="#cc6633">$ item</font> = <font color="#cc6633">$ element</font> [ <font color="#008000">'#item'</font> ]; </li><li></li><li>  <font color="#696969">// Class to display the field</font> </li><li>  <font color="#cc6633">$ class</font> = <font color="#008000">'swffield swffield-'</font> .  <font color="#cc6633">$ field</font> [ <font color="#008000">'field_name'</font> ]; </li><li>  <font color="#696969">// Return the output using the "swffield_flash" function</font> </li><li>  <font color="#0000ff">return</font> theme ( <font color="#008000">'swffield_flash'</font> , <font color="#cc6633">$ item</font> , <font color="#0000ff">array</font> ( <font color="#008000">'class'</font> =&gt; <font color="#cc6633">$ class</font> , <font color="#008000">'width'</font> =&gt; <font color="#cc6633">$ field</font> [ <font color="#008000">'widget'</font> ] [ <font color="#008000">'width'</font> ], <font color="#008000">'height'</font> =&gt; <font color="#cc6633">$ field</font> [ <font color="#008000">'widget'</font> ] [ <font color="#008000">'height'</font> ], <font color="#008000">'alt'</font> =&gt; <font color="#cc6633">$ field</font> [ <font color="#008000">'widget'</font> ] [ <font color="#008000">'alt_text'</font> ])); </li><li>  } </li><li></li><li>  <font color="#696969">// Auxiliary function of themes</font> </li><li>  <font color="#0000ff">function</font> theme_swffield_flash ( <font color="#cc6633">$ item</font> , <font color="#cc6633">$ attributes</font> ) { </li><li>  <font color="#696969">// Load the library "swfobject.js"</font> </li><li>  drupal_add_js (drupal_get_path ( <font color="#008000">'module'</font> , <font color="#008000">'swffield'</font> ). <font color="#008000">"/"</font> . <font color="#008000">"swfobject.js"</font> ); </li><li>  <font color="#696969">// Generate ID for the displayed item</font> </li><li>  <font color="#cc6633">$ id</font> = <font color="#008000">"swffield-"</font> .  rand ( <font color="#008000">1</font> , <font color="#008000">10000</font> ); </li><li>  <font color="#696969">// The path to the file</font> </li><li>  <font color="#cc6633">$ file</font> = <font color="#008000">"/"</font> .  <font color="#cc6633">$ item</font> [ <font color="#008000">'filepath'</font> ]; </li><li>  <font color="#696969">// Ready item</font> </li><li>  <font color="#0000ff">return</font> <font color="#008000">"&lt;div id = '"</font> .  <font color="#cc6633">$ id</font> .  <font color="#008000">"'class ='"</font> .  <font color="#cc6633">$ attributes</font> [ <font color="#008000">'class'</font> ].  <font color="#008000">"'&gt;"</font> </li><li>  .  <font color="#cc6633">$ attributes</font> [ <font color="#008000">'alt'</font> ] </li><li>  .  <font color="#008000">"&lt;script type = 'text / javascript'&gt;"</font> </li><li>  .  <font color="#008000">"var flashvars = {};"</font> </li><li>  .  <font color="#008000">"var params = {bgcolor: '# ffffff', allowFullScreen: 'false', allowScriptAccess: 'always', wmode: 'opaque'};"</font> </li><li>  .  <font color="#008000">"new swfobject.embedSWF ('"</font> . <font color="#cc6633">$ file</font> . <font color="#008000">"', '"</font> . <font color="#cc6633">$ id</font> . <font color="#008000">"', '"</font> . <font color="#cc6633">$ attributes</font> [ <font color="#008000">' width '</font> ]. <font color="#008000">"', '"</font> . <font color="#cc6633">$ attributes</font> [ <font color="#008000">' height '</font> ]. <font color="#008000">" ',' 9.0.0 ', false, flashvars, params); "</font> </li><li>  .  <font color="#008000">"&lt;/ script&gt;"</font> </li><li>  .  <font color="#008000">"&lt;/ div&gt;"</font> ; </li><li>  } </li></ol></blockquote><br>  It uses excellent js <a href="http://code.google.com/p/swfobject/">SWFobject</a> library.  The <i>swfobject.js</i> file <i>must</i> be put in the directory with our module. <br>  Another subtle point.  For each display of our element on the page, it is necessary to generate a unique ID, by which the content will be inserted later by javascript.  I use <i>rand (1, 10000)</i> .  If there is a more adequate way, I will be glad to hear it in the comments. <br><br><h4>  Conclusion </h4><br>  That's all that is needed to add the display of SWF content on the pages of our site.  Similarly, you can, for example, add the display "Video Player" for FLV or "Audio Player" for MP3. <br><br>  <b>Good luck!</b> </div><p>Source: <a href="https://habr.com/ru/post/96549/">https://habr.com/ru/post/96549/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../96542/index.html">How did cellular communication come about?</a></li>
<li><a href="../96543/index.html">Plugin for the development of VK iframe applications</a></li>
<li><a href="../96544/index.html">Goooooool</a></li>
<li><a href="../96545/index.html">Electronic Arts Presentation at E3 2010</a></li>
<li><a href="../96547/index.html">Android 2.1 has become available for European users of HTC Hero</a></li>
<li><a href="../96551/index.html">YouTube and the Guggenheim Museum are looking for the most creative videos.</a></li>
<li><a href="../96553/index.html">Russian-made equipment or one day in the life of ITshnik</a></li>
<li><a href="../96560/index.html">Circuitry - again about the goat with a gun</a></li>
<li><a href="../96561/index.html">A game created by one person. Eador. Creation</a></li>
<li><a href="../96562/index.html">Startup Crash Test 15 in Kiev</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>