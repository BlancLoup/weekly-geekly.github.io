<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Open source databases on large machines: disk speed and innodb_io_capacity. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we bring to your attention the second part of the article by Sveta Smirnova and Anastasia Raspopina on improving InnoDB performance. 

 Pyotr Za...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Open source databases on large machines: disk speed and innodb_io_capacity. Part 2</h1><div class="post__text post__text-html js-mediator-article">  <i>Today we bring to your attention the <a href="https://www.percona.com/blog/2017/03/01/open-source-databases-big-machines-disk-speed-innodb_io_capacity/">second part of the</a> article by <b><a href="http://pgday.ru/ru/2017/speakers/111%3Futm_source%3Dhabr%26utm_medium%3Dpost%26utm_campaign%3Dmysql2">Sveta Smirnova</a></b> and <b>Anastasia Raspopina</b> on improving InnoDB performance.</i> <i><br><br></i>  <i><b><a href="http://pgday.ru/ru/2017/speakers/131%3Futm_source%3Dhabr%26utm_medium%3Dpost%26utm_campaign%3Dmysql2">Pyotr Zaitsev</a></b> , the founder of Percona at his master class on July 5, will also discuss this issue in great detail.</i>  <i>Peter will talk about <b>how to properly use MySQL 5.7</b> to ensure maximum performance, and also give specific recommendations regarding server configuration, database schema, application architecture, and hardware selection.</i>  <i>Do not miss the opportunity to visit this unique <a href="https://pgday.ru/ru/2017/request/registration%3FtalkId%3D163%26utm_source%3Dhabr%26utm_medium%3Dpost%26utm_campaign%3Dmysql2"><b>master class</b></a> , <b>especially for PG Day</b> Peter will prepare it for the first time in Russia in Russian!</i> <br><br><img src="https://habrastorage.org/files/817/063/65e/81706365e9384bb3bd482b4b1ad88554.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this article, I‚Äôll tell you how I looked for a bottleneck that prevented performance improvement in <a href="https://habrahabr.ru/company/pgdayrussia/blog/326204/">my previous post</a> . <br><a name="habracut"></a><br>  The powerful machine I used <a href="https://habrahabr.ru/company/pgdayrussia/blog/326204/">in the tests in my previous article</a> has a relatively slow disk, and therefore I expected my tests to reach a level where I couldn‚Äôt increase performance anymore due to the speed of the disk. <br><br>  <b>Hardware Configuration</b> : <br>  <b>Processors</b> : physical = 4, cores = 72, virtual = 144, hyperthreading = yes <br>  <b>Memory</b> : 3.0 TB <br>  <b>Disk speed</b> : about 3K IOPS <br>  <b>OS</b> : CentOS 7.1.1503 <br>  <b>File System</b> : XFS <br><br>  <b>Tested versions and configuration</b> : the same as <a href="https://habrahabr.ru/company/pgdayrussia/blog/326204/">in the first article in</a> this series (read it to find out details). <br><br>  Although I expected my tests to stop growing in performance due to disk speed, there were no high IO values ‚Äã‚Äãin the iostat results.  I conducted testing with a complete set of data that fit in memory.  In this case, write performance only affected dropping data to the disk and writing to the log.  But we still need to see a noticeable decrease in speed.  So I decided to try the RW tests completely in memory.  I created a <a href="https://en.wikipedia.org/wiki/RAM_drive">ramdisk</a> and installed MySQL datadir on it.  Surprisingly, the results on the SSD and ramdisk did not differ. <br><br><img src="https://habrastorage.org/files/0b6/1fe/696/0b61fe696cd647229ff3738519246715.png"><br>  I asked my colleagues from <a href="https://postgrespro.com/">Postgres Professional to</a> test PostgreSQL using ramdisk.  They got similar results: <br><br><img src="https://habrastorage.org/files/4ef/ce8/d47/4efce8d47e454ed0ada31077c0eca1c3.png"><br>  Interestingly, the value of innodb_io_capacity does not affect this situation.  The data for the graph below was taken when I ran the ramdisk tests.  I wanted to see if, using this variable, I could control the IO activity on the disk, which by default is very fast. <br><br><img src="https://habrastorage.org/files/4dd/87f/b02/4dd87fb02dfb4502807673de2466251f.png"><br>  This completely contradicts all my past experiences with less productive machines.  Percona reassigned the machine with a faster disk (which I used earlier in <a href="https://habrahabr.ru/company/pgdayrussia/blog/326204/">this article</a> ), so I used a similar one with a lower disk speed. <br><br>  <b>Hardware Configuration</b> : <br>  <b>Processors</b> : physical = 2, cores = 12, virtual = 24, hyperthreading = yes <br>  <b>Memory</b> : 47.2 GB <br>  <b>Disk speed</b> : about 3K IOPS <br>  <b>OS</b> : Ubuntu 14.04.5 LTS (trusty) <br>  <b>File system</b> : ext4 <br><br>  <a href="https://habrahabr.ru/company/pgdayrussia/blog/326204/">Again</a> , in this case, innodb_io_capacity tests with fewer processor cores showed more predictable results. <br><br>  <b>Conclusion</b> : <br><br>  Both MySQL and PostgreSQL on a machine with a large number of processor cores reach the limits of CPU resources before the speed of the disk can begin to affect performance.  However, we tested only one scenario.  In other cases, results may vary. <br><br>  <i>You can leave your questions to Svetlana in the comments, and also ask in person at her <a href="https://pgday.ru/ru/2017/request/registration%3FtalkId%3D129%26utm_source%3Dhabr%26utm_medium%3Dpost%26utm_campaign%3Dmysql2"><b>master class</b></a> at PG Day'17 about debugging MySQL performance.</i> </div><p>Source: <a href="https://habr.com/ru/post/327226/">https://habr.com/ru/post/327226/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327216/index.html">Publication of Vkontakte posts through Trello</a></li>
<li><a href="../327218/index.html">Understanding Bitcoin Replace-By-Fee Transactions</a></li>
<li><a href="../327220/index.html">Nalivator-9000: robot barman on Raspberry Pi and Go</a></li>
<li><a href="../327222/index.html">3D modeling and high performance computing (HPC) in the development of new products</a></li>
<li><a href="../327224/index.html">From engineers to managers: maintaining technical skills</a></li>
<li><a href="../327228/index.html">The book "React.js. Fast start"</a></li>
<li><a href="../327232/index.html">How to use a token to make a Windows domain safer? Part 1</a></li>
<li><a href="../327234/index.html">Jerminal - terminal emulator for java programs</a></li>
<li><a href="../327236/index.html">Dive into Ethereum</a></li>
<li><a href="../327238/index.html">We invite you to the IV conference on the practical application of data science DataScience Lab May 13</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>