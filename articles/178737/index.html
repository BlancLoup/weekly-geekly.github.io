<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a simple CRUD application using Yii2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Disclaimer 
 This lesson will help you get to know Yii2. At the moment, Yii2 is absolutely not ready for production. I do not recommend using it in wo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a simple CRUD application using Yii2</h1><div class="post__text post__text-html js-mediator-article"><h4>  Disclaimer </h4><br>  This lesson will help you get to know Yii2.  At the moment, Yii2 is absolutely not ready for production.  I do not recommend using it in work projects. <br><br><h4>  Let's start </h4><br>  Today, the authors of the Yii Framework announced a public preview of Yii2.  There are quite a few changes between Yii1 and Yii2. <br><br>  This tutorial describes how to create a simple blog on Yii2.  In the process, we will download and install Yii2, create a basic application, connect to the database and describe the logic of creating, updating, reading and deleting posts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To continue, you will need: <br><br><ul><li>  Web server, for example Apache or Nginx.  I will use nginx.  Using Apache will differ slightly, so don‚Äôt worry if you don‚Äôt have a Nginx server nearby. </li><li>  North database for our application.  I chose MySQL 5.5 </li><li>  Basic knowledge of PHP.  I will try to explain everything as simple as possible, but the better you know PHP, the easier it will be to move on. </li><li>  Basic knowledge of Yii or MVC.  If you have no experience with MVC, then I recommend you <a href="">read the basics of MVC</a> .  You <em>can</em> read this lesson without MVC knowledge, but it will be much easier for you to understand what is happening, I understand the topic of MVC. </li></ul><br>  Forward! <br><a name="habracut"></a><br>  I will assume that you already have a configured web server.  In the lesson I will use the following paths and addresses: <br><br><ul><li>  / var / www / yii2 as DocumentRoot </li><li>  yii2.erianna.com as a hosting address </li></ul><br>  Also, at the end of the lesson you will be able to see an example of the application that we will do at <a href="http://yii2.erianna.com/">yii2.erianna.com</a> . <br><br><h4>  Downloading Yii2 </h4><br>  You can get a copy of Yii2 from Github either by cloning the repository or by downloading the archive. <br><br><pre>  git clone git@github.com: yiisoft / yii2.git / dir / to / yii2 </pre><br>  or <br><br><pre>  wget https://github.com/yiisoft/yii2/archive/master.zip
 unzip master.zip / dir / to / yii2 </pre><br>  After unpacking Yii2, go to the <strong>/ dir / to / yii2 / framework</strong> folder <br><br><pre>  cd / dir / to / yii2 / framework </pre><br>  And run the following command to create a basic web application, answering Yes to the first question. <br><br><pre>  php yiic.php app / create / var / www / yii2
 yes </pre><br>  This is equivalent to creating a web application in Yii 1.x.  Now go to / var / www / yii2.  You will see one folder and one file. <br><br><pre>  $ ls -l
 total 8
 -rwxrwxrwx 1 user www-data 265 May 4 09:30 index.php
 drwxrwsr-x 5 user www-data 4096 May 4 09:07 protected
</pre><br>  Before we launch our site, we need to make some modifications to the index.php file.  In my opinion, there are several controversial decisions.  Hopefully they will be fixed before the final release of Yii2, to make it more user friendly to install. <br><br>  Modify index.php as follows: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> define(<span class="hljs-string"><span class="hljs-string">'YII_DEBUG'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Change this to your actual Yii path require '/path/to/yii2/framework/yii.php'; // Change __DIR__ to __FILE__ so we can load our config file $config = require dirname(__FILE__).'/protected/config/main.php'; $config['basePath'] = dirname(__FILE__).'/protected'; $app = new \yii\web\Application($config); $app-&gt;run();</span></span></code> </pre> <br>  Let's look at what we changed: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// Change this to your actual Yii path require '/path/to/yii2/framework/yii.php';</span></span></code> </pre> <br><br>  First, we need to change the path to the framework / yii.php file.  By default, it is considered that it lies in the same directory.  Perhaps it is, but we need to specify the exact path to Yii2. <br><br><pre> <code class="php hljs">$config = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> dirname(<span class="hljs-keyword"><span class="hljs-keyword">__FILE__</span></span>).<span class="hljs-string"><span class="hljs-string">'/protected/config/main.php'</span></span>; $config[<span class="hljs-string"><span class="hljs-string">'basePath'</span></span>] = dirname(<span class="hljs-keyword"><span class="hljs-keyword">__FILE__</span></span>).<span class="hljs-string"><span class="hljs-string">'/protected'</span></span>;</code> </pre> <br>  Secondly, we update the path to the configuration file so that it uses <strong>__FILE__</strong> instead of <strong>__DIR__</strong> .  This is necessary so that your application can run. <br><br>  Before we continue, it is important to note something new in Yii - <strong>Namespaces</strong> <br><br><pre> <code class="php hljs">$app = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \yii\web\Application($config);</code> </pre> <br>  The meaning of namespaces in encapsulating code into logical units to avoid collisions between different code bases.  Suppose you have two classes, both are called <strong>Foo</strong> and both have a <strong>Bar</strong> method.  If they are located in different namespaces, then you will be able to call them independently from each other without any collisions. <br><br><pre> <code class="php hljs">$foo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \<span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span>\<span class="hljs-title"><span class="hljs-title">Foo</span></span>; $foo2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \namespace2\Foo;</code> </pre> <br>  Namespaces are a simple way to avoid collisions in code.  I recommend you <a href="http://www.php.net/manual/en/language.namespaces.rationale.php">read about them</a> , since Yii2 will be fully built on this principle. <br><br>  Now you have created the first application!  Go to the address where you have yii2 and you will see the following page. <br><br><img src="https://www.erianna.com/uploads/c4ca4238a0b923820dcc509a6f75849b.png" alt="c4ca4238a0b923820dcc509a6f75849b.png"><br>  Your first application on Yii2! <br><br>  Unlike Yii 1.x, the basic application of Yii2 is not so admiring.  Let's teach him to do a little more. <br><br>  First, open the <strong>/protected/views/layout/main.php</strong> file and replace its contents: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">helpers</span></span>\<span class="hljs-title"><span class="hljs-title">Html</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">Html</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;!doctype html&gt; &lt;html lang=<span class="hljs-string"><span class="hljs-string">"&lt;?php \Yii::$app-&gt;language?&gt;"</span></span>&gt; &lt;head&gt; &lt;meta charset=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span> /&gt; &lt;title&gt;<span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> Html::encode(\Yii::$app-&gt;name); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span>&lt;/title&gt; &lt;link href=<span class="hljs-string"><span class="hljs-string">"//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css"</span></span> rel=<span class="hljs-string"><span class="hljs-string">"stylesheet"</span></span>&gt; &lt;script src=<span class="hljs-string"><span class="hljs-string">"//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"</span></span>&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">container</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">navbar</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">navbar</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inverse</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">container</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">navbar</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inner</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">brand</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">href</span></span></span><span class="hljs-class">="/"&gt;&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Html</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">encode</span></span></span><span class="hljs-class">(\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Yii</span></span></span><span class="hljs-class">::$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">app</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">); ?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">"&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">body</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">html</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre> <br>  Now refresh the page.  Do you see?  Doesn't things get better with Twitter Bootstrap?  Again, not so much has changed between Yii1 and Yii2.  You still have the $ content variable to display the content in the view.  However, <strong>Yii :: app () was</strong> replaced by <strong>Yii :: $ app</strong> .  And let me remind you once again - everything in Yii2 is divided into namespaces, so it is important to remember to address everything in their namespace, and not just call ‚Äúraw‚Äù classes. <br><br>  Now let's do some real coding! <br><br><h4>  Connect to the database </h4><br>  For this application we will have only a simple table <strong>Posts</strong> , in which we will store the posts of our blog. <br><br><h5>  Create a table in the database </h5><br>  Log in to MySQL and create a user and database named yii2.  Then run the following query to update the structure: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DROP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> <span class="hljs-string"><span class="hljs-string">`posts`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> <span class="hljs-string"><span class="hljs-string">`posts`</span></span> ( <span class="hljs-string"><span class="hljs-string">`id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`title`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`content`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`created`</span></span> datetime <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`updated`</span></span> datetime <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">InnoDB</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHARSET</span></span>=latin1; <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`posts`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>(<span class="hljs-string"><span class="hljs-string">`id`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> <span class="hljs-string"><span class="hljs-string">`yii2`</span></span>.<span class="hljs-string"><span class="hljs-string">`posts`</span></span> (<span class="hljs-string"><span class="hljs-string">`id`</span></span>, <span class="hljs-string"><span class="hljs-string">`title`</span></span>, <span class="hljs-string"><span class="hljs-string">`content`</span></span>, <span class="hljs-string"><span class="hljs-string">`created`</span></span>, <span class="hljs-string"><span class="hljs-string">`updated`</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'Example Title'</span></span>, <span class="hljs-string"><span class="hljs-string">'New Post'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NOW</span></span>(), <span class="hljs-keyword"><span class="hljs-keyword">NOW</span></span>());</code> </pre> <br><h5>  We update a config </h5><br>  Go to the <strong>/ var / www / yii2 / protected /</strong> folder and open the <strong>config.php file</strong> in your favorite editor.  Replace all its contents with this: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'webapp'</span></span>, <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'My Web Application'</span></span>, <span class="hljs-string"><span class="hljs-string">'components'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-comment"><span class="hljs-comment">// uncomment the following to use a MySQL database 'db' =&gt; array( 'class' =&gt; 'yii\db\Connection', 'dsn' =&gt; 'mysql:host=localhost;dbname=yii2', 'username' =&gt; 'yii2', 'password' =&gt; '&lt;password&gt;', ), 'cache' =&gt; array( 'class' =&gt; 'yii\caching\DummyCache', ), ), );</span></span></code> </pre> <br>  If you are familiar with Yii, you will notice a <em>strong</em> improvement regarding the monstrous configs that Yii1 generated.  Despite the fact that the structure remains the same, this is all we need to connect to the database. <br><br><h5>  Create a Post Model </h5><br>  Create a new <strong>models</strong> folder in the protected folder, and then create a <strong>Post.php</strong> file in it with the following code. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">app</span></span>\<span class="hljs-title"><span class="hljs-title">models</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Post</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">yii</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">db</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActiveRecord</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * Returns the static model of the specified AR class. * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $className active record class name. * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> Comments the static model class */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($className=__CLASS__)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::model($className); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string the associated database table name */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'posts'</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> array primary key of the table **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">primaryKey</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'id'</span></span>); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> array customized attribute labels (name=&gt;label) */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">attributeLabels</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'ID'</span></span>, <span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Title'</span></span>, <span class="hljs-string"><span class="hljs-string">'content'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Content'</span></span>, <span class="hljs-string"><span class="hljs-string">'created'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Created'</span></span>, <span class="hljs-string"><span class="hljs-string">'updated'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Updated'</span></span>, ); } }</code> </pre> <br>  If you are familiar with Yii1, the only thing that has changed in ActiveRecord (at least in this example) is that the <strong>primaryKey</strong> and <strong>tableName</strong> functions are now static methods.  Everything else basically remains the same.  For the most part, ActiveRecord has remained untouched. <br><br>  The most important part of the class is the inclusion of the <strong>app \ models</strong> namespace.  This tells Yii how we can reference this file. <br><br>  Unlike Yii1, where you can simply call the class name, Yii2 uses a different type of file startup, which requires you to specify exactly what you are going to use.  This may slow down the development somewhat (Attempts to remember to always connect \ yii \ framework \ web \ Html instead of just calling CHtml may tire), but at the same time it will make Yii2 much faster, because the autoloader now doesn‚Äôt have to search the entire framework to load some one class.  At least in theory. <br><br><h4>  CRUD! </h4><br>  After we put the Post model in the namespace, we can start creating CRUD applications. <br><br><h5>  View all </h5><br>  First, let's update the index action so that we can see everything.  I love to see all the messages right on the main page, so let's start with that.  Open the <strong>controllers / SiteController.php file</strong> and update the index action as shown below: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $post = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Post; $data = $post-&gt;find()-&gt;all(); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'index'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'data'</span></span> =&gt; $data )); }</code> </pre> <br>  I will note a few things.  First, <strong>:: model () -&gt;</strong> disappeared.  Data from ActiveRecord and models are now available by direct method call.  For example, $ post-&gt; find () -&gt; all ().  Despite the fact that I personally love Post :: model () -&gt; findAll (), the new way to access data looks more standard and easy to read. <br><br>  Secondly, findAll has been replaced by find () -&gt; all ().  All search methods now come from find () or findBySql (). <br><br>  Thirdly, $ this-&gt; render () now requires echo at the beginning of the line.  Personally, I hate it.  This is <em>very</em> similar to CakePHP and, in my opinion, redundant.  The idea behind this change is that everything you want to show to the user should be sent via echo, otherwise it should just be placed in a variable for further action.  I prefer the old way of rendering to a variable (passing a parameter to the rendering method), but maybe I‚Äôve gotten to it. <br><br>  Now refresh the page ... <br><br>  If you are familiar with namespaces, you will probably shout at me asking why I didn‚Äôt turn on the Post model.  If you are not familiar, then you may be surprised that you got an error.  The reason is simple.  _You must remember the namespace in Yii2_.  Everything that you want to use should be clearly stated, if this has not been done before. <br><br>  Add the following line at the beginning of the <em>SiteController</em> file.  Then refresh the page. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">app</span></span>\<span class="hljs-title"><span class="hljs-title">models</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span>;</code> </pre> <br>  Now add the markup to display posts.  Open the <strong>protected / views / site / index.php</strong> file and replace its contents with the following: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">helpers</span></span>\<span class="hljs-title"><span class="hljs-title">Html</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> Html::a(<span class="hljs-string"><span class="hljs-string">'Create New Post'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'site/create'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'btn btn-primary pull-right'</span></span>)); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">clearfix</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hr</span></span></span><span class="hljs-class"> /&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">striped</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hover</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tr</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt;#&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Title</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Created</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Updated</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Options</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tr</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foreach</span></span></span><span class="hljs-class"> ($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">as</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">): ?&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tr</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Html</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">site</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">read</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">'=&gt;$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">)); ?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt;&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Html</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">site</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">read</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">'=&gt;$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">)); ?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt;&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">created</span></span></span><span class="hljs-class">; ?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt;&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">updated</span></span></span><span class="hljs-class">; ?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Html</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NULL</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">site</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">update</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">'=&gt;$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">'=&gt;'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">icon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">icon</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">edit</span></span></span><span class="hljs-class">')); ?&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Html</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NULL</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">site</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">delete</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">'=&gt;$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">'=&gt;'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">icon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">icon</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">trash</span></span></span><span class="hljs-class">')); ?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tr</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endforeach</span></span></span><span class="hljs-class">; ?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre> <br>  Hmmm, looks different, right?  CHtml :: link () was gone, an Html helper appeared instead.  Fortunately, the structure of CHtml :: link and Html :: a is no different.  So just fill in the parameters. <br><br><h5>  We read </h5><br>  Reading is easy, so let's deal with it.  Create a new method in SiteController with the following definition: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionRead</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id=NULL)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'HelloWorld'</span></span>; }</code> </pre> <br>  Now go to? R = site / read &amp; id = 1.  You will see <strong>HelloWorld</strong> on the screen.  Do you see?  Hory.  This means that our method has been called.  Now update it to show data from the database. <br><br>  First, let's add a HttpException to the SiteController so that we can throw a HttpException if the post is not found. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> \<span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">base</span></span>\<span class="hljs-title"><span class="hljs-title">HttpException</span></span>;</code> </pre> <br>  Now we add the read action. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionRead</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id=NULL)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($id === <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpException(<span class="hljs-number"><span class="hljs-number">404</span></span>, <span class="hljs-string"><span class="hljs-string">'Not Found'</span></span>); $post = Post::find($id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($post === <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpException(<span class="hljs-number"><span class="hljs-number">404</span></span>, <span class="hljs-string"><span class="hljs-string">'Document Does Not Exist'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'read'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'post'</span></span> =&gt; $post )); }</code> </pre> <br>  For clarity, HttpException is essentially a CHttpException.  All we do is request a post with the specified ID in the database and display it.  If the post is not found or the ID was not specified, we throw a HttpException. <br><br>  Next, we need to create a new file, <strong>protected / views / site / read.php,</strong> and add the following code to it to display the post. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">helpers</span></span>\<span class="hljs-title"><span class="hljs-title">Html</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pull</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">right</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">group</span></span></span><span class="hljs-class">"&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Html</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Update</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">site</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">update</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">' =&gt; $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">' =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">primary</span></span></span><span class="hljs-class">')); ?&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Html</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Delete</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">site</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">delete</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">' =&gt; $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">' =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">danger</span></span></span><span class="hljs-class">')); ?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">; ?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">&gt;&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">; ?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hr</span></span></span><span class="hljs-class"> /&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">time</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Created</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">On</span></span></span><span class="hljs-class">: &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">created</span></span></span><span class="hljs-class">; ?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">time</span></span></span><span class="hljs-class">&gt;&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">br</span></span></span><span class="hljs-class"> /&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">time</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Updated</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">On</span></span></span><span class="hljs-class">: &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">updated</span></span></span><span class="hljs-class">; ?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">time</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre> <br>  Now, on the main page, click on "Example Post".  Voila!  Now you can view blog posts! <br><br><h5>  Deletion </h5><br>  Removing posts is just as easy, so we‚Äôll do it.  Create a new method with the following code: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionDelete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id=NULL)</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br>  For this method, we need a slightly more complex syntax.  We must redirect the user back to the main page after successfully deleting the post  Let's start. <br><br>  First, we describe the method <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionDelete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id=NULL)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($id === <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) { Yii::$app-&gt;session-&gt;setFlash(<span class="hljs-string"><span class="hljs-string">'PostDeletedError'</span></span>); Yii::$app-&gt;getResponse()-&gt;redirect(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'site/index'</span></span>)); } $post = Post::find($id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($post === <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) { Yii::$app-&gt;session-&gt;setFlash(<span class="hljs-string"><span class="hljs-string">'PostDeletedError'</span></span>); Yii::$app-&gt;getResponse()-&gt;redirect(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'site/index'</span></span>)); } $post-&gt;delete(); Yii::$app-&gt;session-&gt;setFlash(<span class="hljs-string"><span class="hljs-string">'PostDeleted'</span></span>); Yii::$app-&gt;getResponse()-&gt;redirect(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'site/index'</span></span>)); }</code> </pre> <br>  A few comments on Yii2.  First, redirection is now done using <strong>Yii :: $ app-&gt; getResponse-&gt; redirect ()</strong> instead of <strong>$ this-&gt; redirect ()</strong> .  This solution makes sense in terms of code organization, but it takes so long to print!  In addition, it creates a feeling of overloading the $ app.  At the same time, the definition of the method remains the same. <br><br>  Second, setFlash is now available via $ app instead of app ().  You should now get used to it.  =) <br><br>  Now we are done with the deletion.  Let's go back to <strong>protected / views / site / index.php</strong> and catch the notifications that were sent. <br><br>  Just add it after the first tag hr <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Yii::$app-&gt;session-&gt;hasFlash(<span class="hljs-string"><span class="hljs-string">'PostDeletedError'</span></span>)): <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alert</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alert</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">error</span></span></span><span class="hljs-class">"&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">There</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">was</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">an</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">error</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">deleting</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">your</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">! &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class">; ?&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Yii</span></span></span><span class="hljs-class">::$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">app</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">session</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hasFlash</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostDeleted</span></span></span><span class="hljs-class">')): ?&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alert</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alert</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">success</span></span></span><span class="hljs-class">"&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Your</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">has</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">successfully</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">been</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">deleted</span></span></span><span class="hljs-class">! &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class">; ?&gt;</span></span></code> </pre> <br>  Now try deleting the ‚ÄúExample Post‚Äù.  Pretty simple, huh?  Now you get the idea of ‚Äã‚ÄãYii :: $ app, right? <br><br><h5>  Create </h5><br>  We now turn to the fun broadcasting, the creation of new entries in our blog.  We have to do a few things to create.  First, we are going to use ActiveForm to work with the form.  Secondly, we must catch and validate the data in $ _POST.  And finally, after this we must save the data to the database.  Let's start. <br><br>  First, we will make view for the form.  Create a <strong>protected / views / site / create.php file</strong> .  Since we are going to use the widget, it is necessary to create the ‚Äúassets‚Äù folder in the application root and make it writable by the web server.  Chmod 755 usually solves this issue.  Then add the method definition to SiteController. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Post; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST[<span class="hljs-string"><span class="hljs-string">'Post'</span></span>])) { $model-&gt;title = $_POST[<span class="hljs-string"><span class="hljs-string">'Post'</span></span>][<span class="hljs-string"><span class="hljs-string">'title'</span></span>]; $model-&gt;content = $_POST[<span class="hljs-string"><span class="hljs-string">'Post'</span></span>][<span class="hljs-string"><span class="hljs-string">'content'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($model-&gt;save()) Yii::$app-&gt;response-&gt;redirect(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'site/read'</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; $model-&gt;id)); } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'create'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'model'</span></span> =&gt; $model )); }</code> </pre> <br>  It looks more or less the same as in Yii1.  But there are still a few differences.  First, the Controller now has a ‚Äúpopulate‚Äù method ($ this-&gt; populate ($ ds, $ model)), which in theory should save us from all this misery with isset ($ _ POST).  The code for creating a new post will look like this: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;populate($_POST, $model)) { <span class="hljs-comment"><span class="hljs-comment">//Then do something }</span></span></code> </pre> <br>  Unfortunately, I could not get it to work in the latest version.  The data in my model remained unchanged.  Secondly, I also could not make $ model-&gt; attributes = $ _POST ['Post'] work.  ActiveRecord looks somewhat damp, so for now, you have to enter data by hand. <br><br>  Finally, I stumbled upon another obstacle - saving to the database with a unique ID.  So that we have to do it manually.  If someone finds out how to solve it - feel free to leave a comment. <br><br>  Let's update the Post model to make the unique primary key work.  Just add this code to the end of the file: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">beforeSave</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($insert)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;isNewRecord) { $command = <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>::getDb()-&gt;createCommand(<span class="hljs-string"><span class="hljs-string">"select max(id) as id from posts"</span></span>)-&gt;queryAll(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;id = $command[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'id'</span></span>] + <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::beforeSave($insert); }</code> </pre> <br>  All it does is check whether a new record is created and if so, it gets the maximum ID from the database, increments it and uses it as an ID. <br><br>  I tried several different combinations (NULL, 0, _ for $ model-&gt; id, but for some reason ActiveRecord refused to keep the model with ID excellent 0. I have no idea why this does not work). <br><br>  ( <em>Actually, the author simply forgot to specify AUTO_INCREMENT for the id field. But I decided to leave this part as a small lesson of carelessness. Note the translator.</em> ) <br><br>  With it sorted out, now we create view. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">helpers</span></span>\<span class="hljs-title"><span class="hljs-title">Html</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $form = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;beginWidget(<span class="hljs-string"><span class="hljs-string">'yii\widgets\ActiveForm'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'options'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'form-horizontal'</span></span>), )); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $form-&gt;field($model, <span class="hljs-string"><span class="hljs-string">'title'</span></span>)-&gt;textInput(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'span8'</span></span>)); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $form-&gt;field($model, <span class="hljs-string"><span class="hljs-string">'content'</span></span>)-&gt;textArea(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'span8'</span></span>)); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">actions</span></span></span><span class="hljs-class">"&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Html</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">submitButton</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Submit</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">null</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">null</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">' =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">primary</span></span></span><span class="hljs-class">')); ?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endWidget</span></span></span><span class="hljs-class">(); ?&gt;</span></span></code> </pre> <br>  That's it, now you can save the model.  But something strange is not it?  For example, why is the creation and update time 0?  What if we send an empty form? <br><br>  Let's fix these two errors before we continue.  Open the Post model and add the following method: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rules</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'title, content'</span></span>, <span class="hljs-string"><span class="hljs-string">'required'</span></span>), ); }</code> </pre> <br>  This method makes the title and content fields required.  Now when you try to save the model, you get an error if one of these fields is empty.  And since we use bootstrap, it is very easy to see what <em>exactly</em> was the error.  Try it! <br><br>  Next, we must automatically set the correct time. <br><br>  First, add another <strong>use</strong> -string at the top of our model. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> \<span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">db</span></span>\<span class="hljs-title"><span class="hljs-title">Expression</span></span>;</code> </pre> <br>  Second, update the beforeSave method to automate the process. <br><br>  Inside the if ($ this-&gt; isNewRecord) block, add a line: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;created = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Expression(<span class="hljs-string"><span class="hljs-string">'NOW()'</span></span>);</code> </pre> <br>  Before return parent :: beforeSave ($ insert) add: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;updated = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Expression(<span class="hljs-string"><span class="hljs-string">'NOW()'</span></span>);</code> </pre> <br>  As a result, the method should have the following form: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">beforeSave</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($insert)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;isNewRecord) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;created = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Expression(<span class="hljs-string"><span class="hljs-string">'NOW()'</span></span>); $command = <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>::getDb()-&gt;createCommand(<span class="hljs-string"><span class="hljs-string">"select max(id) as id from posts"</span></span>)-&gt;queryAll(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;id = $command[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'id'</span></span>] + <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;updated = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Expression(<span class="hljs-string"><span class="hljs-string">'NOW()'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::beforeSave($insert); }</code> </pre> <br>  Let's try to save again.  Now the model validates the title and content fields, and also automatically fills in the creation and update times.  Let's go to the update. <br><br><h5>  We update </h5><br>  The update action will be almost identical to the creation.  The only difference is how we define the model we will use. <br><br>  In the action of creation we did this: <br><br><pre> <code class="php hljs">$model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Post;</code> </pre> <br>  In the update action, we do this: <br><br><pre> <code class="php hljs">$model = Post::find($id);</code> </pre> <br>  I like to throw exceptions when something is not found, so my action will do some error checking.  After adding them, the code should look something like this: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionUpdate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id=NULL)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($id === <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpException(<span class="hljs-number"><span class="hljs-number">404</span></span>, <span class="hljs-string"><span class="hljs-string">'Not Found'</span></span>); $model = Post::find($id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($model === <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpException(<span class="hljs-number"><span class="hljs-number">404</span></span>, <span class="hljs-string"><span class="hljs-string">'Document Does Not Exist'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST[<span class="hljs-string"><span class="hljs-string">'Post'</span></span>])) { $model-&gt;title = $_POST[<span class="hljs-string"><span class="hljs-string">'Post'</span></span>][<span class="hljs-string"><span class="hljs-string">'title'</span></span>]; $model-&gt;content = $_POST[<span class="hljs-string"><span class="hljs-string">'Post'</span></span>][<span class="hljs-string"><span class="hljs-string">'content'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($model-&gt;save()) Yii::$app-&gt;response-&gt;redirect(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'site/read'</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; $model-&gt;id)); } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'create'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'model'</span></span> =&gt; $model )); }</code> </pre> <br>  Noticed something interesting?  We still use view to create, because they are <i>exactly the same</i> .  Cool, yeah? <br><br><h4>  findings </h4><br>  So we did it.  In a few hours, we went from ignorance of Yii2 to a simple CRUD application on it.  Using this knowledge, you can easily extend applications by adding user support, authentication, additional tables in the database, and even much more powerful features. <br><br>  Yii2 is <em>very</em> similar to Yii 1.x, but there are a lot of changes in it that you must learn to use.  Since Yii2 is not well documented yet, I wrote this article only on the basis of the source code on Github.  The framework code is very well documented.  And since the methods are very similar to Yii1, it was easy to find what I needed. <br><br>  As we found, there are still a few problems that need to be fixed (either through better documentation of ActiveRecord, or by fixing what is broken). <br><br><h4>  Links </h4><br>  <a href="https://github.com/charlesportwoodii/yii2-blog-demo">Github source code</a> <br>  <a href="http://yii2.erianna.com/">Demo</a> <br>  <a href="https://www.erianna.com/getting-starting-with-yii-framework-2">Original article</a> </div><p>Source: <a href="https://habr.com/ru/post/178737/">https://habr.com/ru/post/178737/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../178721/index.html">Smart player nearly collapsed EVE Online economy</a></li>
<li><a href="../178723/index.html">Google recognized Palestine</a></li>
<li><a href="../178725/index.html">Scientists have embedded radio chips in paper</a></li>
<li><a href="../178727/index.html">geoDNS using Powerdns and nginx</a></li>
<li><a href="../178733/index.html">Modify Chrome Logger - a post as an incentive to study Google Chrome extensions and write your own</a></li>
<li><a href="../178739/index.html">How to increase revenue from 0 to $ 1,000,000 for two years</a></li>
<li><a href="../178741/index.html">Cloud in your pocket</a></li>
<li><a href="../178743/index.html">Time to connect the source. Introduction to Source Maps</a></li>
<li><a href="../178745/index.html">Liberator: the world's first firearm, fully printed on a 3D printer</a></li>
<li><a href="../178747/index.html">Guys we need to talk</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>