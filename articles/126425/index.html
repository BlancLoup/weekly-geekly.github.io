<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NuGet - download packages from the Internet during the build process</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="UPD: A method similar to that used here is included with the NuGet 1.6 package. Accordingly, the article is outdated. 

 That's what I always liked in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>NuGet - download packages from the Internet during the build process</h1><div class="post__text post__text-html js-mediator-article">  <b>UPD: A method similar to that used here is included with the <a href="http://habrahabr.ru/company/microsoft/blog/134584/">NuGet 1.6</a> package.</b>  <b>Accordingly, the article is outdated.</b> <br><br><img src="https://habrastorage.org/storage1/9fe0f1d1/10c1dd37/d9f4753d/f09948c7.jpg" align="right">  That's what I always liked in Java, it's Maven.  One file with a list of everything you need, and no binaries in the repository.  When NuPack appeared, I decided - hurray, here it is, happiness has come to our street.  But it was not there.  NuPack presented a convenient interface for working with packages ... but without the possibility of normally screwing into the build process. <br><br>  I picked it up then, I looked, but I didn‚Äôt see any real benefit.  It does not hurt much help - to download packages by hand with manual powershell commands.  Well, yes, it is more convenient than downloading FIGs to know where, and even add references with your hands, but I don‚Äôt need it every day.  In general, the game is not worth the candle. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But one day I realized that I needed to do something with the Shared \ Bin folder in my sorts-control, because it was already incredibly swollen.  I decided to take a look, has anything changed with NuPack, which already became NuGet?  No, who <a href="http://nuget.codeplex.com/workitem/165">and further there</a> . <br><br>  But nuget.exe has an interesting feature ... <a name="habracut"></a><br>  If you pass the ‚Äúpackages.config‚Äù file as a parameter in which NuGet stores the list of packages installed in this project, it will download all the packages specified in it! <br><br><h5>  The case of technology </h5><br>  1) Create NuGet.Targets, which we will include in our projects: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Project</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/developer/msbuild/2003"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">PropertyGroup</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">BuildDependsOn</font> <font color="#0000ff">&gt;</font> <br> _InsallNuGetPackages;$(BuildDependsOn) <br> <font color="#0000ff">&lt;/</font> <font color="#800000">BuildDependsOn</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">PropertyGroup</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Target</font> <font color="#ff0000">Name</font> <font color="#0000ff">="_InsallNuGetPackages"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Exec</font> <font color="#ff0000">Command</font> <font color="#0000ff">="$(MSBuildThisFileDirectory)\NuGet install $(ProjectDir)packages.config -o $(SolutionDir)Packages"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Target</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Project</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  We put it in sorts-kontrol, it will launch NuGet before each build.  Regarding the placement of NuGet: you can put an exe-shku in sorts-control next to the target, you can simply add to the path.  The first option, as for me, is more convenient, although less kosher.  If you prefer to force all employees to put Nuget.exe in the Path - just remove <code>$(MSBuildThisFileDirectory)</code> . <br>  ... Do not forget about build servers;) <br><br>  2) Add packages to the NuGet project. <br>  3) Add your hands in the *. * Proj file: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Import</font> <font color="#ff0000">Project</font> <font color="#0000ff">="$(SolutionDir)\\\\\NuGet.Targets"</font> <font color="#0000ff">/&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Actually all the packages will be pulled out automatically during the build.  And only if they are not there yet - which is good. <br><br><h5>  What if... </h5><br>  ... do I use binaries in my project, which is not on nuget.org?  No problem.  Create your feed.  You can use <a href="http://habrahabr.ru/blogs/net/120673/">MyGet</a> , but in my opinion it‚Äôs even easier to create on your server: <br>  1) Create a new Empty Web Application Project <br>  2) Put the package NuGet.Server on it <br>  3) Publish. <br><br>  All is ready.  You can clean up a bit, because the garbage is published ... Well, as usual.  In the published project will be the Packages folder, where we actually fold our packages. <br><br><h5>  Cooking <s>garnish</s> packages. </h5><br>  This is also easy.  nuget.exe to help you. <br>  Take turns: <br>  1) <code>nuget spec .</code> generates a file with the nuspec extension containing the package manifest template.  We correct it, it is trivial, you will figure it out :) <br>  2) Put our nuspec in an empty daddy, create a lib next to it, put our dll in it. <br>  Run the <code>nuget pack ..nuspec</code> , which will generate the package file. <br>  3) Fill the received package on the server, in the above-mentioned Packages folder. <br><br>  Regarding daddy lib: files found in it will be added to References in the importing project.  And only so.  This was not clearly described in the documentation, so it was necessary to experiment. <br><br><h5>  Finishing touch </h5><br>  So, we have a server with packages ready, we need to tie it to the studio and the build process.  In the studio - again, no problem: <br>  Tools-&gt; Library Package Manager-&gt; Package Manager Settings, select Package Sources, add your own.  What is it I actually - if you have read this far, then you will understand. <br>  Build process: to be honest, I was hoping that NuGet would be stored in Package files and where to download from.  But no, he does not go down to such trifles.  You have to add parameters for nuget.exe ... Remember, I took out its launch in a separate file?  A lot of honor for one line, right?  No, it's not true.  Now it will be useful to us (as it came in handy to me, so as not to climb 30 separate projects).  Change the line from exec to the following: <br><blockquote> <code><a href="http://nuget.example.com/nuget"></a> <a href="https://go.microsoft.com/fwlink/%3FLinkID%3D206669"></a> <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Exec</font> <font color="#ff0000">Command</font> <font color="#0000ff">="NuGet install $(ProjectDir)packages.config -o $(SolutionDir)Packages -Source nuget.example.com/nuget -Source go.microsoft.com/fwlink/?LinkID=206669"</font> <font color="#0000ff">/&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The order of the sources is exactly this - in which case it will be possible to replace some version of the official repository with its own patched one (for example, in my case with AjaxControlToolkit). <br><br>  ... Congratulations, you can now safely remove the Shared \ Bin monster, commit and enjoy the cleanliness in Sort Control. </div><p>Source: <a href="https://habr.com/ru/post/126425/">https://habr.com/ru/post/126425/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126418/index.html">How to avoid collisions when writing to Memcache from PHP</a></li>
<li><a href="../126419/index.html">PS3 steering wheel overview</a></li>
<li><a href="../126421/index.html">Amazing near or how to make fun of stock analysts (using Excel)</a></li>
<li><a href="../126422/index.html">Creating an application on the Cocos2d framework for iOS</a></li>
<li><a href="../126423/index.html">Mouse over translation in Lingvo x5</a></li>
<li><a href="../126427/index.html">Creating an operating system based on the linux kernel. From scratch</a></li>
<li><a href="../126428/index.html">‚ÄúWhat is your name in my name?‚Äù - a stupid manual on choosing a startup name</a></li>
<li><a href="../126431/index.html">VHDL delay element</a></li>
<li><a href="../126432/index.html">Writing a ‚Äúdraftsman‚Äù for iPhone on HTML5 Canvas</a></li>
<li><a href="../126433/index.html">Ramos W6HD - replacing a paladin or tablet for $ 100</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>