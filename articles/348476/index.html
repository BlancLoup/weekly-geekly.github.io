<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Houses with Xeoma (CCTV and VMWARE ESXi)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Video surveillance / video recording systems are very popular now. And although there are many of them on the market, the desire to save money, especi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Houses with Xeoma (CCTV and VMWARE ESXi)</h1><div class="post__text post__text-html js-mediator-article"><p>  Video surveillance / video recording systems are very popular now.  And although there are <a href="https://habrahabr.ru/company/intems/blog/322634/">many of</a> them on the market, the desire to save money, especially for use at home or in the SOHO sector, often leads to the agony of choice. </p><br><p>  In particular, I had the following conditions for a home NVR: </p><br><ol><li>  the server side of the NVR running Linux in the VMWare ESXi virtual machine; </li><li>  low requirements for virtual machine resources when connecting 6-8 FullHD H.264 cameras; </li><li>  the ability to connect and manage the NVR server from a Windows computer and smartphone (Android); </li><li>  low cost (better free); <a name="habracut"></a></li></ol><br><h2 id="1-nvr-s-vozmozhnostyu-zapuska-servernoy-chasti-v-srede-linux">  1. NVR with the ability to run the server side in a Linux environment </h2><br><ul><li>  <a href="http://zoneminder.com/">ZoneMinder</a> <br>  <em>free open source</em> </li><li>  <a href="http://www.veyesys.com/">Veyesys rapidvms</a> <br>  <em>free open source</em> </li><li>  <a href="http://felenasoft.com/ru/">Xeoma</a> <br>  <em>up to 8 cameras for free (it is impossible to use the free version in Linux without a graphical environment)</em> <br>  <em>license cost for 1 camera is 875 rubles</em> </li><li>  AVReg (www.avreg.net) <br>  <em>up to 4 cameras for free</em> <br>  <em>license cost for 1 camera 1000 rub</em> </li><li>  Line (www.devline.ru) <br>  <em>license cost for 1 camera is 1008 rubles</em> </li><li>  Trassir (www.dssl.ru) <br>  <em>the cost of a license for 1 camera is 2990 rubles</em> </li><li>  <a href="https://www.ipconfigure.com/products/orchid">Orchid Core VMS</a> <br>  <em>up to 4 cameras for free</em> </li><li>  <a href="https://ru.ivideon.com/">Ivideon</a> <br>  <em>up to 15 cameras for free</em> <br>  <em>unable to install ivideon server without graphical environment</em> </li></ul><br><h2 id="2-zoneminder">  2. ZoneMinder </h2><br><p>  The first CCTV system that worked for a little over a year and was the first experience of using CCTV systems was ZoneMinder.  Honestly, ZoneMinder is quite complicated to install and configure, but not even this has become the main problem in its use.  The main problem appeared when I began to slowly replace old MJPEG cameras with H.264-camcorders.  I don‚Äôt know how it is now, but the version with which I worked several years ago (1.28) did not support H.264 streams out of the box, but what worked to do by connecting ffmpeg, although it worked, but the processor was quite heavy, and the quality of motion detection left much to be desired.  It simply turned out to either record video from the cameras almost continuously, or when the motion detection was ‚Äúblunt‚Äù, I had to put up with the omission of ‚Äúimportant‚Äù frames.  In addition, apparently because of the furious load on the processor, the ffmpeg processes, decoding H.264, fell and often the record was not kept at all.  I had to look for something else. </p><br><h2 id="3-avreg">  3. AVReg </h2><br><p>  In general, moved to AVReg.  Installing AVReg is easier, but still far from trivial.  AVReg worked in free mode, therefore, of the 6 installed cameras, recording was made only from 4, but the recording of video data was already stable.  AVreg is more stable than ZoneMinder, video streams do not fall off.  However, the complexity and non-triviality of the settings and the ‚Äúcoarse‚Äù interface were a bit annoying.  The quality of motion detection also left much to be desired.  AVReg recorded a lot, searching the archive of necessary events is inconvenient.  In the end, as it seems to me now, the price of a license of 1000 rubles per camera for this project is greatly overestimated.  Adequate price tag for AVReg 400 rubles per channel, not more. </p><br><p>  In general, when working with the above projects, a lot of time was spent and what worked out in the end did not cause delight.  From time to time, turning to Google for advice, what else is good about the NVR for Linux, I came to the conclusion that a small fee for high-quality software for organizing a video surveillance system is not such a bad idea. </p><br><h2 id="4-xeoma">  4. Xeoma </h2><br><p>  The first thing that fell gaze was <a href="http://felenasoft.com/ru/">XEOMA</a> . <br>  I must say that the gaze fell well, because, as it turned out, the software for the NVR had all that I needed for the organization of home video surveillance: </p><br><ul><li>  The system can work in Linux OS (as well as in Windows, MacOS, Android, iOS and ARM) </li><li>  The server part can be run separately from the client part (in fact, except for the free version, which has restrictions on connecting to the server over the network) in a bare console. </li><li>  The client interface can connect to the server from any OS (Linux, Windows, MacOS, Android, iOS and ARM) </li><li>  Support a huge number of video cameras. </li><li>  Easy installation and configuration. </li><li>  PTZ control. </li><li>  High quality motion detection. </li><li>  You can enable and use the web interface to access the system. </li><li>  A large number and high quality of video processing modules. </li></ul><br><h4 id="41-ustanovka-xeoma-v-virtualnuyu-mashinu-centos-linux">  4.1.  Installing XEOMA in a CentOS Linux virtual machine </h4><br><p>  As I wrote one of the key conditions for using the NVR is the ability to run it in a virtual environment (VMWare ESXi 6.5 on the i5-3570 @ 3.40Ghz / RAM 32Gb machine), and of course it is very desirable to minimize the resources consumed by the system. </p><br><p>  In this regard, for the beginning, a VM with CentOS 7.3 was created, which was allocated quite modest resources: </p><br><ul><li>  CPU: 1 core </li><li>  RAM: 2Gb </li><li>  HDD1: 20 Gb (system) </li><li>  HDD2: 200 Gb (video archive) </li></ul><br><h4 id="42-zapusk-konsolnogo-servera-videonablyudeniya-xeoma">  4.2.  Launch Xeoma CCTV Console Server </h4><br><p>  The XEOMA server is launched not simply, but extremely simply.  Honestly, I was very surprised by the process of installing and running the system in Linux, especially after the ordeal with ZoneMinder and AVReg. <br>  Everything is simple: </p><br><ul><li>  we install Linux in the minimum option; </li><li>  Downloading the right version of Xeoma (links here: <a href="http://felenasoft.com/xeoma/ru/download/">http://felenasoft.com/xeoma/ru/download/</a> ) <br><blockquote>  wget <a href="">http://felenasoft.com/xeoma/downloads/xeoma_trial_standard_linux64.tgz</a> <br></blockquote></li><li>  we unpack the extorted archive; <br><blockquote>  tar xzf xeoma_trial_standard_linux64.tgz <br></blockquote></li><li>  If necessary, set attributes for the application, allowing its launch <br><blockquote>  chmod u + x xeoma_trial_standard.app <br></blockquote></li><li>  We find out the administrator password to connect to the server, for example from a Windows workstation; <br><blockquote>  ./xeoma_trial_standard.app -showpassword <br></blockquote></li><li>  we start Xeoma in the server mode (while for check in an interactive mode): <br><blockquote>  ./xeoma_trial_standard.app -core <br></blockquote></li><li>  configure the autorun of Xeoma and running the server as a Linux service (daemon) is also surprisingly simple, instead of the previous command, you need to do the following: <br><blockquote>  ./xeoma_trial_standard.app -install -hiddenmode <br></blockquote></li></ul><br><h4 id="43-zapusk-klientskogo-prilozheniya-xeoma">  4.3.  Launch XEOMA client application </h4><br><p>  The workstation (running, for example, already under Windows) also needs to load the XEOMA software module on the above download page and start it with the command: </p><br><blockquote>  xeoma_trial_standard_win64.exe -client </blockquote><p>  A program running in client mode will automatically detect the xeoma server, connect to it (if it is on the same subnet), and offer a choice of automatic network scanning or manual input of cameras.  The address of the Xeoma server can also be entered manually using the menu "Remote Access"&gt; "Connect to a remote server": </p><br><p><img src="https://habrastorage.org/webt/1z/cp/6k/1zcp6kgxroc4hpiq5hdhvfm8b5a.jpeg" alt="Xeoma remote access menu"></p><br><p>  Here we enter the IP address and access password obtained earlier (see section 4.2.): </p><br><p><img src="https://habrastorage.org/webt/lt/6v/ni/lt6vnikwga3fiwnzxy6wxved8xc.jpeg" alt="Xeoma remote access dialog"></p><br><p>  As a result, we obtain approximately the following image: </p><br><p><img src="https://habrastorage.org/webt/nn/n-/6l/nnn-6l4m14zzh2kti2pxrcspl-w.jpeg" alt="Xeoma client"></p><br><p>  The actual configuration of Xeoma is as simple and intuitive as the installation of this system.  <a href="http://felenasoft.com/xeoma/ru/description/">A complete guide</a> is available on the manufacturer's website. </p><br><h4 id="44-potreblenie-resursov-virtualnoy-mashiny">  4.4.  Virtual machine resource consumption </h4><br><p>  Honestly, considering that Xeoma independently performs motion detection based on which it records a video stream, I had doubts about the adequacy of the 1st kernel for a virtual machine running a Xeoma server.  However, the loading of a single nucleus with the included motion detection of 6 chambers was about 30-40% and remained within the specified limits even with activity on all chambers.  In the absence of movement, the load fell below 20%: </p><br><p><img src="https://habrastorage.org/webt/it/jt/lw/itjtlwkxeb8q809_tgrnl5dac4a.jpeg" alt="CPU LOAD"></p><br><p>  The average HDD Latency at maximum load is 35-50ms, which is quite a lot, but this delay corresponds to simultaneous recording of a video stream from 5-6 cameras.  Such a load happens infrequently, but all the same it is necessary to allocate a separate disk for recording video streams, connecting it as an <a href="https://slipsoad.wordpress.com/virtualization-technology/vmware/%25D0%25BF%25D0%25BE%25D0%25B4%25D0%25BA%25D0%25BB%25D1%258E%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5-rdm-%25D0%25B4%25D0%25B8%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B2-sata/">RDM disk</a> : </p><br><p><img src="https://habrastorage.org/webt/r2/ax/mu/r2axmu6mr96ou-w_p2gvpsd4tq4.jpeg" alt="HDD Latency"></p><br><p>  The allocated disk space of <strong>200 GB</strong> was enough to store video data from 6 HD video cameras for 2 weeks: </p><br><p><img src="https://habrastorage.org/webt/zw/ob/ax/zwobaxoclmy7jyoyqrv6hpdhsyk.jpeg" alt="Xeoma Archive"></p><br><h4 id="45-optimizaciya-nastroek-xeoma">  4.5.  Optimize Xeoma Settings </h4><br><h5 id="451-detektor-dvizheniya">  4.5.1.  Motion Detector </h5><br><p>  In general, the default detection and archive settings offered by Xeoma work quite normally without any changes, but considering the resource limitations of the virtual machine with the Xeoma server, and the lack of need for storing unnecessary information, I still recommend that you immediately make small changes to the settings of the detector module movements ": </p><br><p><img src="https://habrastorage.org/webt/0k/dx/om/0kdxomh3uilt182ceksq8mpyu-0.jpeg" alt="Xeoma Motion Detection"></p><br><p>  <strong>Change the threshold of sensitivity.</strong>  It is necessary to observe a little the testimony of the current level of sensitivity with various changes in the video frame and decide on the minimum sensitivity threshold.  I am satisfied with the value 10, at which the detector does not miss any movement in the chamber.  The default value of 5 actually captures the ‚Äúnoise‚Äù of the cameras and minor changes in light, resulting in a large recording volume in the video archive. <br>  <strong>Change the detection area</strong> .  With the help of the brush and the "erase" mode, we delete the extra areas, the fixation of the movement in which we are not interested. <br>  <strong>Change the minimum size of the object</strong> .  More precisely, we increase a little.  The size of the object "by default" is very small, which also leads to an erroneous triggering of the detector and excessive recording of frames that do not contain anything useful. </p><br><h5 id="452-prosmotr-i-arhiv">  4.5.2.  View and archive </h5><br><p>  The settings of the "View and Archive" module are also possible. You should slightly adjust it.  My settings for example look like this: </p><br><p><img src="https://habrastorage.org/webt/cu/il/zz/cuilzzxqmqnrli798g9ftsptkgk.jpeg" alt="Xeoma Archive"></p><br><p>  <strong>Prerecord.</strong>  I set 5 seconds, which ensures that due to the buffering of video streams, information will be recorded in the video archive, not only from the beginning of motion detection, but also five seconds before it. <br>  <strong>The storage time of this archive.</strong>  Considering that the total available disk space allocated for the video archive is 200GB, 2 weeks turned out to be the optimal storage depth. </p><br><h5 id="453-nastroyki-dekodirovaniya">  4.5.3.  Decoding settings </h5><br><p>  To reduce server load, when connecting clients to it, it is recommended to decode video streams on clients.  To do this, set the decoding settings as shown in the following figure: </p><br><p><img src="https://habrastorage.org/webt/ek/aa/3k/ekaa3kqoy0hktw5cezugutjawno.jpeg" alt="Xeoma decode properties"></p><br><h4 id="46-ogranicheniya-pri-ispolzovanie-virtualizacii">  4.6.  Limitations when using virtualization </h4><br><p>  The work of Xeoma in a virtual environment, the manufacturer has established restrictions that may be critical for someone.  In particular, the following instructions are written in the complete instructions for the system: </p><br><blockquote>  For licenses Xeoma (Xeoma Standard), Xeoma Pro, the transition from Xeoma Standard to Xeoma Pro and renewals added the ability to activate on any virtual machines.  To do this, you need constant access to the Internet in a virtual machine.  If the Internet is lost, the license can be deactivated, but it will be restored when the Internet connection is resumed. </blockquote><p>  It works as follows: When the Internet is lost, the Xeoma server on the virtual machine continues to work as if nothing had happened for 2 days, records the archives, allows the connection to the client, but it all works until the server is restarted. </p><br><p>  If the server fails to restart via the Internet for a license activation upon restarting, the server will stop its productive work, i.e.  data from the cameras will not be received, the archive will stop recording.  When you try to start the client, you will see the following warning: </p><br><p><img src="https://habrastorage.org/webt/ww/ga/hb/wwgahbnsc5rmthug320o-bvmwp0.jpeg" alt="Xeoma deactivated"></p><br><p>  Now until you have the Internet Xeomu you can only use to view the archive.  To do this, click "Continue Work". </p><br><p>  However, after the resumption of access to the Internet, you will find one trouble (at least in the latest version 11/17/24).  Despite the fact that with the renewal of access to the Internet, the Xeohm functionality will work in full, when you view information about your active license (Menu&gt; Information&gt; Active licenses), you will see the following: </p><br><p><img src="https://habrastorage.org/webt/f8/gp/cg/f8gpcgpm_qdel3xu9dfbcekxfcg.jpeg" alt="Xeoma No Licenses"></p><br><p>  Waiting for a day with a little did not correct the situation, so I had to re-enter the license activation code manually. </p><br><p>  Given the not quite understandable logic of Xeoma running in a virtual machine, I can recommend to protect myself from resetting the settings you made earlier, saving them in one of two ways: </p><br><ul><li>  Using the menu in the GUI of the Xeoma client: Menu&gt; Install&gt; Restore&gt; Save Settings (or Export Settings). </li><li>  Make a copy of the settings file /usr/local/Xeoma/settings.dat using Linux tools </li></ul><br><h4 id="vyvody">  findings </h4><br><p>  Xeoma is a very good video registration system.  It certainly costs its money.  This, as mentioned above, is 875 rubles per camera using a standard license.  For 6 cameras, its use will cost about 5,000 rubles.  Considering how much time you spend on achieving acceptable work for free solutions - this is certainly a low price. </p><br><p>  I want to note the excellent motion detection system, which allows you to save and quickly find all significant events that fall under your video camera, without fear of missing something.  Due to this, for a two-week recording from 6 FullHD-cameras it is enough to allocate only 200GB of disk space, whereas in many low-cost recorders (for example, based on CMS), in order not to miss events, you have to include a continuous recording, which for the same two weeks archive depth will require about 2Tb. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/348476/">https://habr.com/ru/post/348476/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348464/index.html">Operation "Y" and the new library ABI</a></li>
<li><a href="../348466/index.html">GopherCon Russia 2018: Conference Program Ready</a></li>
<li><a href="../348470/index.html">Corporate training at the Olympic Games in Sochi 2014</a></li>
<li><a href="../348472/index.html">What not to expect from 802.11ax?</a></li>
<li><a href="../348474/index.html">How we created an IT product price calculator and automated specification creation</a></li>
<li><a href="../348478/index.html">Runtime Permissions</a></li>
<li><a href="../348486/index.html">The release of Kali Linux 2018.1</a></li>
<li><a href="../348488/index.html">Reinventing the PoA Consensus Algorithm - PoG Algorithm</a></li>
<li><a href="../348490/index.html">Mono-vendor data centers. Debunking myths</a></li>
<li><a href="../348492/index.html">Clothing stores in section: why are we so painful to go there</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>