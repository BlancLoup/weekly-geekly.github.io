<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Android and architecture</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Android operating system provides a powerful foundation for developing applications that work well on a wide variety of devices and form factors. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Android and architecture</h1><div class="post__text post__text-html js-mediator-article"><p>  The Android operating system provides a powerful foundation for developing applications that work well on a wide variety of devices and form factors.  Now, as they say, we have heard the complaints of the developers: it is difficult to create "bug-free" applications in the conditions of complex life cycles of objects and the lack of the recommended application architecture. </p><br><p>  We, the creators of Android, need to make writing sustainable applications simple and fun in order to translate the efforts of developers into areas where innovation can be created.  Today, we are announcing a guide to the architecture of Android applications and the preview of the libraries of Architecture Components.  Instead of reinventing the wheel, we recognize the work done by the authors of popular third-party Android libraries (lane: WAT?). </p><br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/vOJCrbr144o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Tips and not prescriptions </h2><br><p>  It is clear that there are many ways to create Android applications.  We want to offer a set of guidelines that could help develop an application architecture that best fits the behavior of the Android system.  The SDK has excellent APIs for interacting with the OS, such as activations, but these are the points of contact, not the building blocks of architecture;  SDK components do not require separating the data model from the UI components and do not provide normal ways to store data regardless of the life cycle. </p><br><h2>  Building blocks </h2><br><p>  Architecture Components together help to implement a reasonable architecture, although individually they solve individual popob "developers".  The first version of the components helps: </p><br><ul><li>  Automatically manage life cycles of activations and fragments to avoid memory leaks and resources. </li><li>  Save Java data model objects to SQLite. </li></ul><br><h2>  Lifecycle management components </h2><br><p> New <a href="https://developer.android.com/topic/libraries/architecture/lifecycle.html">components</a> provide constructs for binding the application kernel to life cycle events, eliminating the obvious dependencies.  A typical observer model should start tracking in <code>onStart()</code> and stop at <code>onStop()</code> .  It sounds simple enough, but often you have several simultaneous asynchronous calls, and all of them handle the life cycles of their components.  You can easily skip any boundary case.  And here can help new components. </p><br><h2>  Lifecycle, LifecycleOwner and LifecycleObserver </h2><br><p>  The main class for all of this is <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html"><code>Lifecycle</code></a> .  Him <del>  inside neonka </del>  there is ENUM for the current state of the life cycle, and ENUM for the set of events, and it uses them to track the life cycle of the associated component. </p><br><p><img src="https://habrastorage.org/web/c4b/7d8/31a/c4b7d831a6df4f6a86eb71a78e593cd3.png" alt="States and events"></p><br><p>  <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html"><code>LifecycleOwner</code></a> is the interface that the <code>Lifecycle</code> object returns when <code>getLifecycle()</code> called, and <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleObserver.html"><code>LifecycleObserver</code></a> is the class that can track component lifecycle events if you add a couple of annotations to the component methods.  Putting it all together, we can create components that automatically track life cycle events and can query the current lifecycle state. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyObserver</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LifecycleObserver</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyObserver</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Lifecycle lifecycle)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Starts lifecycle observation lifecycle.addObserver(this); ... } public void startFragmentTransaction() { // Queries lifecycle state if (lifecycle.getState.isAtLeast(STARTED)) { // perform transaction } } // Annotated methods called when the associated lifecycle goes through these events @OnLifecycleEvent(Lifecycle.Event.ON_RESUME) public void onResume() { } @OnLifecycleEvent(Lifecycle.Event.ON_PAUSE) public void onPause() { } } MyObserver observer = new MyObserver(aLifecycleOwner.getLifecycle());</span></span></code> </pre> <br><h2>  Livedata </h2><br><p>  <a href="https://developer.android.com/topic/libraries/architecture/livedata.html"><code>LiveData</code></a> is a data wrapper that monitors the life cycle.  And she knows how to "observable".  Your UI code can subscribe to changes in the data <code>LiveData</code> with <code>LifecycleOwner</code> , and <code>LiveData</code> will make sure that the observer: </p><br><ul><li>  Receives data updates while the component is in the active state ( <code>STARTED</code> or <code>RESUMED</code> ). </li><li>  Removed when <code>LifecycleOwner</code> destroyed. </li><li>  Receives actual data when <code>LifecycleOwner</code> restarts due to a configuration change or when it is returned from back stack. </li></ul><br><p>  This helps to eliminate a lot of ways to get memory leaks and reduces the likelihood of crashing by preventing events from being sent to stopped activations. </p><br><p>  Several listeners can subscribe to <code>LiveData</code> , each of which is tied to the life cycle of a fragment or aktiviti. </p><br><h2>  Viewmodel </h2><br><p>  <a href="https://developer.android.com/topic/libraries/architecture/viewmodel.html"><code>ViewModel</code></a> is an auxiliary class that contains user interface data for an activity or a fragment and which serves to separate data management in the interface from the UI controller logic.  The ViewModel persists as long as the area of ‚Äã‚Äãits activit or fragment habitat is alive, including situations when the activit or fragment is destroyed and re-created due to a change in configuration.  This allows the ViewModel to make UI data accessible to recreated actions or fragments without the need for manual recovery.  Wrapping the UI data stored in the ViewModel into the LiveData object creates for the data <del>  warm cozy </del>  house with life cycle support and observers (observable).  LiveData keeps track of change notification mechanisms, and the ViewModel ensures that data is saved and restored at the right time. </p><br><h2>  Data persistence </h2><br><p>  Architecture Components also simplify data storage using the <a href="https://developer.android.com/topic/libraries/architecture/room.html">Room</a> library. </p><br><p>  Room provides an object-mapping abstracion layer, allowing easy access to the database along with all the power of SQLite.  The Android SDK provides native support for working with raw SQL content.  Although this is a powerful API, it is quite low-level and takes a lot of time and effort: </p><br><ul><li>  No validation of raw SQL queries at compile time. </li><li>  When changing the data schema, you need to manually update the affected SQL queries.  This process can be lengthy and error prone. </li><li>  You need to write a bunch of boilerplate code for converting between SQL and Java data model objects. </li></ul><br><p>  Room takes on all these responsibilities, providing a level of abstraction over SQLite. </p><br><h2>  Database, Entity, and DAO </h2><br><p>  The Room library has three main components: </p><br><ul><li>  <a href="https://developer.android.com/reference/android/arch/persistence/room/Entity.html">An entity</a> represents data for a single database row and is created using an annotated Java data model object.  Each Entity is stored in its own table. </li><li>  <a href="https://developer.android.com/reference/android/arch/persistence/room/Dao.html">DAO</a> (Data Access Object) defines methods that access a database, using annotations to bind SQL to each method. </li><li>  <a href="https://developer.android.com/reference/android/arch/persistence/room/Database.html">A database</a> is a single database custodian that uses annotations to determine the list of entities and the version of the database.  Class content defines a DAO list.  Database is also the main way to access the connection to the database under the hood. </li></ul><br><p><img src="https://habrastorage.org/web/0bf/2cb/c0d/0bf2cbc0d07943f2b1a142f6caea9a36.png" alt="Room Architecture Chart"></p><br><p>  To use Room, you need to annotate Java objects that you want to store as entities, create a database containing these entities, and define a DAO class with SQL code to access and modify tables in the database. </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@PrimaryKey</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> uid; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-comment"><span class="hljs-comment">// Getters and Setters - required for Room public int getUid() { return uid; } public String getName() { return name; } public void setUid(int uid) { this.uid = uid; } public void setName(String name) { this.name = name; } } @Dao public interface UserDao { @Query("SELECT * FROM user") List getAll(); @Insert void insertAll(User... users); } @Database(entities = {User.class}, version = 1) public abstract class AppDatabase extends RoomDatabase { public abstract UserDao userDao(); }</span></span></code> </pre><br><h2>  Application Architecture Guide </h2><br><p>  Architecture Components are designed for individual use, but they are most effective when they are used in an efficient application architecture. <br>  Today, we are launching the <a href="https://developer.android.com/topic/libraries/architecture/guide.html">Application Architecture Guide</a> , which shows how to build robust, modular, and testable applications using Architecture Components.  This guide serves three main purposes: </p><br><ul><li>  Defines principles that are suitable for developing Android applications. </li><li>  Describes the architecture of an application that works on these principles. </li><li>  Shows how to implement this architecture using Architecture Components. </li></ul><br><p>  We recommend that all developers who have to deal with these problems, read the "Guide";  even if you are happily married to your current architecture, you will find useful guidelines and tips in the Guide. </p><br><h2>  This is just the beginning. </h2><br><p>  We're going to stubbornly and continue to develop new parts of the Architecture Components to make it easier for Android developers to make a conscious choice of options when designing their application architecture.  We encourage you to try out the previews and leave feedback about our work, since we are all in the same boat here to make the development of sustainable applications easier and more fun.  Learn more about Android architecture here: </p><br><ul><li>  <a href="https://codelabs.developers.google.com/codelabs/android-lifecycles">https://codelabs.developers.google.com/codelabs/android-lifecycles</a> </li><li>  <a href="https://codelabs.developers.google.com/codelabs/android-persistence">https://codelabs.developers.google.com/codelabs/android-persistence</a> </li><li>  <a href="https://developer.android.com/topic/libraries/architecture/guide.html">https://developer.android.com/topic/libraries/architecture/guide.html</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/328962/">https://habr.com/ru/post/328962/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328952/index.html">Implementing drag & drop functionality in an iOS application</a></li>
<li><a href="../328954/index.html">Creating a Web API application using. NET Core + MongoDB. NET Driver</a></li>
<li><a href="../328956/index.html">Register for the webinar "From WannaCry to WannaSaveU". Attack visibility and recovery</a></li>
<li><a href="../328958/index.html">Network microsegmentation in examples: how this cleverly twisted thing reacts to different attacks</a></li>
<li><a href="../328960/index.html">Ionic 2 vs React Native: a comparison of frameworks for creating corporate mobile applications</a></li>
<li><a href="../328964/index.html">Analysis of errors in the seller</a></li>
<li><a href="../328966/index.html">How are developed industry and specialized solutions for 1C: ERP</a></li>
<li><a href="../328970/index.html">Building a modular architecture of the application on Forwarding decorators (author's translation)</a></li>
<li><a href="../328972/index.html">Nice to meet you. LANIT</a></li>
<li><a href="../328974/index.html">Top designs by Behance users</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>