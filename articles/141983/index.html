<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Signals and Slots in Qt5</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Qt5 alpha saw the light. In this article I will describe one of the features that I worked on - this is a new syntax of signals and slots. 

 Previous...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Signals and Slots in Qt5</h1><div class="post__text post__text-html js-mediator-article">  Qt5 alpha saw the light.  In this article I will describe one of the features that I worked on - this is a new syntax of signals and slots. <br><br><h4>  Previous syntax </h4><br>  Here is how we usually connect the signal and the slot: <br><br><pre><code class="cpp hljs">connect(sender, SIGNAL(valueChanged(QString,QString)), receiver, SLOT(updateValue(QString)) );</code> </pre> <br>  In fact, the <code>SIGNAL</code> and <code>SLOT</code> macros convert their arguments to strings.  Then <code>QObject::connect()</code> compares these strings with the introspection data collected by the <code>moc</code> utility. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  What is the problem with this syntax? </h5><br>  Despite the fact that, in general, everything works well, there are some inconveniences: <br><a name="habracut"></a><br><ul><li>  Impossibility of checking at compile time: All checks are performed at runtime, after parsing strings.  And this means that if a typo creeps into the name of a signal or slot, the program will successfully compile, but the connection will not be created.  All we will see is a warning during execution. </li><li>  Since all operations are performed with strings, the names of the types in the slots must literally coincide with the names of the types in the signals.  In addition, they must match in the header files and in the code describing the connection.  This means problems when trying to use typedefs or namespaces. </li></ul><br><h4>  New syntax: use of function pointers </h4><br>  Qt5 in preparation supports alternative syntax.  In addition to the above approach, you can use this new way of connecting signals and slots: <br><br><pre> <code class="cpp hljs">connect(sender, &amp;Sender::valueChanged, receiver, &amp;Receiver::updateValue );</code> </pre> <br>  Which one is more beautiful is a matter of taste.  But getting used to the new version is very simple. <br><br>  Now consider the advantages that it gives: <br><br><h5>  Check at compile time </h5><br>  You will get a compilation error if you make a mistake in the name of the signal or slot, or if the slot arguments do not match the signal arguments.  This will save you time after refactoring. <br><br>  In addition, <code>static_assert</code> used to show understandable errors in cases where the arguments do not match or <code>Q_OBJECT</code> omitted. <br><br><h5>  Automatic coercion of argument types </h5><br>  Now you can not only fear using typedef or namespaces, but also connect signals with slots that accept arguments of other types if implicit coercion is possible. <br><br>  In the following example, we connect a signal that takes a <code>QString</code> as a parameter to a slot that accepts a <code>QVariant</code> .  This works without problems, since <code>QVariant</code> has an implicit constructor that accepts a <code>QString</code> . <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Test</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> QObject { Q_OBJECT <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: Test() { connect(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, &amp;Test::someSignal, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, &amp;Test::someSlot); } signals: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">someSignal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> QString &amp;)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">someSlot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> QVariant &amp;)</span></span></span></span>; };</code> </pre> <br><h5>  Connect the signal with any function </h5><br>  As you noted in the last example, <code>someSlot</code> was declared simply as a public method, without a <code>slot</code> .  Qt can call a slot directly and no longer needs introspection for this.  (Although it is still needed for signals) <br><br>  But now we can also connect a sinal with any function or functor: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">someFunction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ qDebug() &lt;&lt; <span class="hljs-string"><span class="hljs-string">"pressed"</span></span>; } <span class="hljs-comment"><span class="hljs-comment">// ... somewhere else QObject::connect(button, &amp;QPushButton::clicked, someFunction);</span></span></code> </pre> <br>  This can be a very powerful feature in combination with boost or tr1 :: bind. <br><br><h5>  Anonymous functions from C ++ 11 </h5><br>  Everything described above works with the old C ++ 98.  But if you are using a compiler that supports C ++ 11, then I strongly recommend using new language features.  Lambda expressions are supported at least MSVC 2010, GCC 4.5, clang 3.1.  For the last two, you must specify <code>-std=c++0x</code> as a flag. <br><br>  Now you can write this code: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> MyWindow::saveDocumentAs() { QFileDialog *dlg = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QFileDialog(); dlg-&gt;open(); QObject::connect(dlg, &amp;QDialog::finished, [=](<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result) { QFile file(dlg-&gt;selectedFiles().first()); <span class="hljs-comment"><span class="hljs-comment">// ... save document here ... } dlg-&gt;deleteLater(); }); }</span></span></code> </pre> <br>  This makes writing asynchronous code very simple. </div><p>Source: <a href="https://habr.com/ru/post/141983/">https://habr.com/ru/post/141983/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141977/index.html">Applied for domain zone .MOSCOW and.MOSKVA</a></li>
<li><a href="../141978/index.html">Astronauts, do not be offended by us!</a></li>
<li><a href="../141980/index.html">How do you write code comments?</a></li>
<li><a href="../141981/index.html">Instrumenting Google Chrome via the WebSocket API</a></li>
<li><a href="../141982/index.html">180,000</a></li>
<li><a href="../141984/index.html">Japanese are developing ATM with biometrics</a></li>
<li><a href="../141986/index.html">Do you consider yourself a jack of all trades in the household?</a></li>
<li><a href="../141987/index.html">Work with Command Line in .Net</a></li>
<li><a href="../141988/index.html">Guess the movie on the trailer</a></li>
<li><a href="../141989/index.html">Nginx module to combat DDoS, put a cookie through Flash</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>