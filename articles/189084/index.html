<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Promises in AngularJS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the key components of almost any web application is interaction with the server. In large applications, this is not a single request. In this c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Promises in AngularJS</h1><div class="post__text post__text-html js-mediator-article">  One of the key components of almost any web application is interaction with the server.  In large applications, this is not a single request.  In this case, requests are often necessary to combine for sequential or parallel execution, and often combine both.  In addition, large applications usually have a multi-layered architecture - a wrapper over the RESTFul API =&gt; business entities =&gt; more complex business logic (partitioning for example).  And on each layer it is necessary to accept data in one format and transfer to the next layer in another. <br><br>  All these tasks can be handled by promises. <br><br>  For details, welcome under cat. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Promises provide an interface for interacting with objects containing the result of performing some operation, the end time of which is unknown.  Initially, any promise is not resolved (unresolved) and will be resolved either with a specific value (resolved) or rejected with an error (rejected).  As soon as a promise becomes resolved or rejected, its state can no longer change, which ensures that the state remains unchanged for any number of checks.  That does not mean that at different stages of the checks you will get the same value. <br><br>  In addition, promises can be combined for both sequential and parallel execution. <br><br>  Further, the entire description will be built on the basis of AngularJS 1.1.5, and all the examples will be executed in the form of <a href="">tests</a> . <br><br>  So what is a promise?  This is an object with two methods: <br><ul><li> <code>then(successCallback, errorCallback)</code> ; </li><li>  <code>always(callback)</code> ; </li></ul><br><br>  What does AngularJS give you a promise? <br><ul><li>  <a href="http"><code>$http</code></a> - service to perform AJAX requests; </li><li>  <a href="http://code.angularjs.org/1.1.5/docs/api/ng.%24timeout"><code>$timeout</code></a> - AngularJS-wrapper over <code>setTimeout</code> ; </li><li>  various methods of <a href=""><code>$q</code></a> - service to create your deferred-objects and promises. </li></ul><br><br>  Next, we will go through all the options for working with promises. <br><br><h4>  Simplest use </h4><br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> responseData; $http.get(<span class="hljs-string"><span class="hljs-string">'http://api/user'</span></span>).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function">)</span></span>{ responseData = response.data; });</code> </pre><br><br>  Nothing interesting - callback and all.  But it is necessary to start from something in the presentation? .. :-) <br><br><h4>  Return values ‚Äã‚Äãfrom handlers </h4><br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> User = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> angular.extend(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, data); }; $httpBackend.expectGET(<span class="hljs-string"><span class="hljs-string">'http://api/user'</span></span>).respond(<span class="hljs-number"><span class="hljs-number">200</span></span>, { <span class="hljs-attr"><span class="hljs-attr">result</span></span>: { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: [{<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Artem'</span></span>}], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">total</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span> } }); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = {}; $http.get(<span class="hljs-string"><span class="hljs-string">'http://api/user'</span></span>).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> usersInfo = {}; usersInfo.list = _.collect(response.data.result.data, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">u</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(u); }); usersInfo.total = response.data.result.total; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> usersInfo; }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">usersInfo</span></span></span><span class="hljs-function">)</span></span>{ data.users = usersInfo; });</code> </pre><br><br>  Thanks to this chain of <code>then</code> you can build a multi-layered application.  ApiWrapper made a request, executed common error handlers, gave the data from the response unchanged to the next layer.  There, the data was transformed as necessary and given to the next.  Etc. <br><br>  Any return value from <code>then</code> will come in <code>success</code> - <code>callback</code> following <code>then</code> .  They did not return anything - in the <code>success-callback</code> will come undefined (see tests). <br><br>  To do a <code>reject</code> , you need to return <code>$q.reject(value)</code> . <br><pre> <code class="javascript hljs"> $httpBackend.expectGET(<span class="hljs-string"><span class="hljs-string">'http://api/user'</span></span>).respond(<span class="hljs-number"><span class="hljs-number">400</span></span>, {<span class="hljs-attr"><span class="hljs-attr">error_code</span></span>: <span class="hljs-number"><span class="hljs-number">11</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> error; $http.get(<span class="hljs-string"><span class="hljs-string">'http://api/user'</span></span>).then( <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.data &amp;&amp; response.data.error_code == <span class="hljs-number"><span class="hljs-number">10</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">list</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">total</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $q.reject(response.data ? response.data.error_code : <span class="hljs-literal"><span class="hljs-literal">null</span></span>); } ).then( <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">errorCode</span></span></span><span class="hljs-function">)</span></span>{ error = errorCode; } );</code> </pre><br><br><h4>  Call chains </h4><br><pre> <code class="javascript hljs"> $httpBackend.expectGET(<span class="hljs-string"><span class="hljs-string">'http://api/user/10'</span></span>).respond(<span class="hljs-number"><span class="hljs-number">200</span></span>, {<span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Artem'</span></span>, <span class="hljs-attr"><span class="hljs-attr">group_id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>}); $httpBackend.expectGET(<span class="hljs-string"><span class="hljs-string">'http://api/group/1'</span></span>).respond(<span class="hljs-number"><span class="hljs-number">200</span></span>, {<span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Some group'</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user; $http.get(<span class="hljs-string"><span class="hljs-string">'http://api/user/10'</span></span>).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function">)</span></span>{ user = response.data; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $http.get(<span class="hljs-string"><span class="hljs-string">'http://api/group/'</span></span> + user.group_id); }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function">)</span></span>{ user.group = response.data; });</code> </pre><br>  This will avoid the pyramid code, make the code more linear, and therefore more readable and easier to maintain. <br><br><h4>  Parallel execution of requests with the expectation of all </h4><br>  <a href=""><code>$q.all(...)</code></a> accepts an array or dictionary of promises, combines them into one that will be resolved when all promises are resolved, or rejected with an error, when at least one promise is rejected.  The values ‚Äã‚Äãwill come in success-callback either as an array or as a dictionary, depending on how the <code>all</code> method was called. <br><br><pre> <code class="javascript hljs"> $httpBackend.expectGET(<span class="hljs-string"><span class="hljs-string">'http://api/obj1'</span></span>).respond(<span class="hljs-number"><span class="hljs-number">200</span></span>, {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'obj1'</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj1, obj2; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> request1 = $http.get(<span class="hljs-string"><span class="hljs-string">'http://api/obj1'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> request2 = $timeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'obj2'</span></span>}; }); $q.all([request1, request2]).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">values</span></span></span><span class="hljs-function">)</span></span>{ obj1 = values[<span class="hljs-number"><span class="hljs-number">0</span></span>].data; obj2 = values[<span class="hljs-number"><span class="hljs-number">1</span></span>]; }); expect(obj1).toBeUndefined(); expect(obj2).toBeUndefined(); $httpBackend.flush(); expect(obj1).toBeUndefined(); expect(obj2).toBeUndefined(); $timeout.flush(); expect(obj1).toEqual({<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'obj1'</span></span>}); expect(obj2).toEqual({<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'obj2'</span></span>});</code> </pre><br><br><pre> <code class="javascript hljs"> $q.all({ <span class="hljs-attr"><span class="hljs-attr">obj1</span></span>: $http.get(<span class="hljs-string"><span class="hljs-string">'http://api/obj1'</span></span>), <span class="hljs-attr"><span class="hljs-attr">obj2</span></span>: $timeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'obj2'</span></span>}; }) }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">values</span></span></span><span class="hljs-function">)</span></span>{ obj1 = values.obj1.data; obj2 = values.obj2; });</code> </pre><br><br><h4>  $ q.when </h4><br>  Wrap any object in a promise object.  Most commonly needed for mocks in unit tests.  Or when there is a chain of requests, one of which needs to be executed not always, but only in some cases, and in other cases there is a ready-made object. <br><br><pre> <code class="javascript hljs"> spyOn(UserApi, <span class="hljs-string"><span class="hljs-string">'get'</span></span>).andReturn($q.when({<span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Artem'</span></span>})); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res; UserApi.get(<span class="hljs-number"><span class="hljs-number">1</span></span>).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function">)</span></span>{ res = user; }); $rootScope.$digest(); expect(res).toEqual({<span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Artem'</span></span>});</code> </pre><br><br>  Note that to resolve promises, at least one <code>$digest</code> loop must be executed. <br><br><h4>  Creating your own <code>deferred</code> objects </h4><br>  <code>$q</code> -service also allows you to wrap any asynchronous operation in your deferred-object with the corresponding promise-object. <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> postFile = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, file</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> deferred = $q.defer(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> form = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FormData(); form.append(<span class="hljs-string"><span class="hljs-string">'file'</span></span>, file); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xhr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLHttpRequest(); xhr.open(<span class="hljs-string"><span class="hljs-string">'POST'</span></span>, apiUrl + name, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); xhr.onload = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.target.status == <span class="hljs-number"><span class="hljs-number">200</span></span>) { deferred.resolve(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { deferred.reject(e.target.status); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$rootScope.$$phase) $rootScope.$apply(); }; xhr.send(form); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> deferred.promise; };</code> </pre><br><br>  Key points here: <br><ul><li>  creating your own deferred object: <code>var deferred = $q.defer()</code> </li><li>  its resolution at the right moment: <code>deferred.resolve()</code> </li><li>  or <code>reject</code> in case of error: <code>deferred.reject(e.target.status)</code> </li><li>  return associated promise: <code>return deferred.promise</code> </li></ul><br><br><h4>  AngularJS Features </h4><br>  First, the $ q-service is implemented taking into account dirty-checking in AngularJS, which gives a faster resolve and reject, removing unnecessary redrawing by the browser. <br>  Second, when interpolating and calculating angular expressions, promise objects are interpreted as the value obtained after resolve. <br><pre> <code class="javascript hljs"> $rootScope.resPromise = $timeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>; }); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res = $rootScope.$<span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">'resPromise + 2'</span></span>); expect(res).toBe(<span class="hljs-number"><span class="hljs-number">2</span></span>); $timeout.flush(); res = $rootScope.$<span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">'resPromise + 2'</span></span>); expect(res).toBe(<span class="hljs-number"><span class="hljs-number">12</span></span>);</code> </pre><br><br>  This means that if you follow the change of a variable through a string <code>watch</code> , then exactly the resolved value will come as a value. <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res; $rootScope.resPromise = $timeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>; }); $rootScope.$watch(<span class="hljs-string"><span class="hljs-string">'resPromise'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newVal</span></span></span><span class="hljs-function">)</span></span>{ res = newVal; }); expect(res).toBeUndefined(); $timeout.flush(); expect(res).toBe(<span class="hljs-number"><span class="hljs-number">10</span></span>);</code> </pre><br>  An exception is the use of the function.  The value returned from it will be used as is, i.e.  it will be a promise object. <br><pre> <code class="javascript hljs"> $rootScope.resPromise = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $timeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>; }); }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res = $rootScope.$<span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">'resPromise()'</span></span>); expect(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> res.then).toBe(<span class="hljs-string"><span class="hljs-string">'function'</span></span>);</code> </pre><br><br>  Understanding this is important when writing various loading widgets, loading directives for buttons, etc. <br><br><h4>  AngularJS 1.2.0 - what's new in promises </h4><br><ul><li>  <code>catch(errorCallback)</code> as a shortened synonym for <code>promise.then(null, errorCallback)</code> ; </li><li>  for greater similarity with <a href="https://github.com/kriskowal/q">Q,</a> <code>always(callback)</code> renamed <code>finally(callback)</code> ; </li><li>  and the most significant is support for notifications in deferred- and promise-objects, which is convenient to use for notification of progress, etc.  Now the full signature of <code>promise.then</code> looks like <code>then(successCallback, errorCallback, progressCallback)</code> , while <code>deferred</code> has a <code>notify(progress)</code> method. </li></ul><br><br>  And finally, a screenshot of completed tests from WebStorm 7 EAP.  Yet nice added integration with karma. <br><img src="https://habrastorage.org/storage2/f80/c65/f9a/f80c65f9aae9118e53ff7f803292b648.png"></div><p>Source: <a href="https://habr.com/ru/post/189084/">https://habr.com/ru/post/189084/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../189070/index.html">Channel consolidation, or solution of one telecommunication problem</a></li>
<li><a href="../189074/index.html">Learn xrdp to connect to past sessions.</a></li>
<li><a href="../189078/index.html">Huawei Enterprise and Landata Webinar "Review of new products for video conferencing" August 14, 2013</a></li>
<li><a href="../189080/index.html">The history of the creation of X-COM: Enemy Unknown (1993)</a></li>
<li><a href="../189082/index.html">Battery review for 5500mAh for Galaxy S4</a></li>
<li><a href="../189086/index.html">Basics of IIS architecture, or query pipeline for ASP.NET</a></li>
<li><a href="../189090/index.html">Airconsole. Connecting to the Cisco Console port via WiFi</a></li>
<li><a href="../189094/index.html">About Bob Martin's Clean Code Book</a></li>
<li><a href="../189098/index.html">Meet Apache Mahout</a></li>
<li><a href="../189106/index.html">CoH2, learn from the mistakes of others</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>