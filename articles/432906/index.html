<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Editing CSV-files, so as not to break the data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Products of HFLabs in industrial volumes process data: addresses, full names, company details and another car in total. Naturally, testers deal with t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Editing CSV-files, so as not to break the data</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/xr/j1/ia/xrj1ia0lo_magqpxw2sr51g-9dg.jpeg"><br><br>  Products of HFLabs in industrial volumes process data: addresses, full names, company details and another car in total.  Naturally, testers deal with this data every day: update test cases, study the results of cleaning.  Often, customers provide a ‚Äúlive‚Äù base for the tester to set up a service for it. <br><br>  The first thing we learn about new QA is to keep the data in its original form.  All the covenants: "Do no harm."  In the article I will tell you how to work with CSV files in Excel and Open Office.  Tips will help not to spoil anything, save the information after editing and generally feel more confident. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>Material base, professionals absolutely bored.</i> <br><a name="habracut"></a><br><h2>  What are CSV files? </h2><br>  The CSV format is used to store tables in text files.  Data is often packaged in tables, so CSV-files are very popular. <br><br><img src="https://habrastorage.org/webt/ya/z5/vw/yaz5vwq0sruyxaqvir0cnxvu7je.png"><br>  <sub>A CSV file consists of data lines and delimiters that indicate the boundaries of the columns.</sub> <br><br>  CSV stands for comma-separated values ‚Äã‚Äã- comma-separated values.  But don't let the name fool you: the semicolons and tabs can serve as column delimiters in a CSV file.  This will still be a CSV file. <br><br>  CSV has a lot of advantages in front of the same Excel format: text files are as simple as a button, open quickly, read on any device and in any environment without additional tools. <br><br>  Because of its advantages, CSV is a super-popular data exchange format, although it is already 40 years old. CSV has been using industrial application programs, it uploads data from databases. <br><br>  One problem - a text editor to work with CSV is not enough.  Nothing if the table is simple: in the first field the ID is of one length, in the second one is in one format, and in the third one is some address.  But when the fields are of different lengths and there are more than three of them, the torment begins. <br><br><img src="https://habrastorage.org/webt/cv/lb/mm/cvlbmmwfjujdiowdolcfjgwbiik.png"><br>  <sub>Follow the delimiters and columns - break eyes</sub> <br><br>  Even worse with data analysis - try Notepad to at least add up all the numbers in a column.  I'm not talking about beautiful graphics. <br><br>  Therefore, CSV-files are analyzed and edited in Excel and analogues: <a href="https://www.openoffice.org/">Open Office</a> , <a href="https://www.libreoffice.org/">LibreOffice</a> and others. <br><br>  <i>Veterans who still read it: guys, we know about the analysis directly in the database using SQL, we know about <a href="https://www.tableau.com/">Tableau</a> and <a href="https://www.talend.com/products/talend-open-studio/">Talend Open Studio</a> .</i>  <i>This article is for beginners, but at a basic level and a small amount of data Excel with analogs is enough.</i> <br><br><h2>  How Excel spoils data: from classics </h2><br>  Everything would be fine, but Excel, barely opening a CSV file, starts its crafty freaks.  Without a demand, he changes the data so that they become unusable.  And it does this completely unnoticed.  Because of this, in due time, we grabbed a bunch of problems. <br><br>  Most incidents are due to the fact that a program without demand converts strings with a set of numbers into numbers. <br><br>  <b>Rounds.</b>  For example, in the source cell two phones are stored separated by commas without spaces: "5235834,5235835".  What will Excel do?  Famously turn the numbers into one number and round up to two digits after the decimal point: "5235834,52".  So we lose the second phone. <br><br>  <b>Leads to exponential form.</b>  Excel carefully converts "123456789012345" to the number "1.2E + 15".  The original value will lose completely. <br><br>  The problem is relevant for long, characters of fifteen, digital lines.  For example, KLADR codes (this is such a state identifier of the address object: city, street, house). <br><br>  <b>Removes the leading advantages.</b>  Excel considers that a plus at the beginning of a line with numbers is a completely extra character.  They say, and so it is clear that the number is positive, since it is not worth a minus.  Therefore, the leading plus in the number ‚Äú+74955235834‚Äù will be rejected as superfluous - you get ‚Äú74955235834‚Äù.  (In reality, the number will suffer even more, but for clarity, I will manage a plus). <br><br>  The loss of a plus is critical, for example, if the data goes to a third-party system, and that when importing it rigidly checks the format. <br><br>  <b>Splits three digits.</b>  A numeric string longer than three characters of Excel, kind soul, carefully disassemble.  For example, "8 495 5235834" will turn into "84 955 235 834". <br><br>  Formatting is important at least for telephone numbers: spaces separate country and city codes from the rest of the number and from each other.  Excel easily violates the correct division of the phone. <br><br>  <b>Removes leading zeros.</b>  Excel will turn the string "00523446" into "523446". <br>  And in the TIN, for example, the first two digits are the region code.  For the Republic of Altai it starts from scratch - ‚Äú04‚Äù.  Without zero, the meaning of the number will be distorted, and the TIN format check will not pass at all. <br><br>  <b>Changes dates for local settings.</b>  Excel will gladly fix the house number "1/2" to "01.fev."  Because Windows has suggested that in this form it is more convenient for you to read the dates. <br><br><h2>  We defeat data corruption with correct import. </h2><br>  But seriously, it‚Äôs not Excel that‚Äôs entirely to blame for the trouble, but the unobvious way to import data into the program. <br><br>  By default, Excel applies the ‚ÄúGeneral‚Äù type to the data in the downloaded CSV file ‚Äî common.  Because of it, the program recognizes numeric strings as numbers.  This order can be won using the built-in import tool. <br><br>  <b>I launch the import mechanism which is built in Excel.</b>  In the menu this is ‚ÄúData ‚Üí Get External Data ‚Üí From Text‚Äù. <br><br>  <b>I choose a CSV file with data, a dialog opens.</b>  In the dialog, I click on the Delimited file type (with delimiters).  Encoding - the one in the file, usually determined by the machine.  If the first line of the file is a header, I mark ‚ÄúMy Data Has Headers‚Äù. <br><br>  <b>I turn to the second step of the dialogue.</b>  I select the field separator (usually a semicolon - semicolon).  Turning off ‚ÄúTreat consecutive delimiters as one‚Äù, and ‚ÄúText qualifier‚Äù I put in ‚Äú{none}‚Äù.  (Text qualifier is a symbol of the beginning and end of the text. If the separator in CSV is a comma, then the text qualifier is needed to distinguish commas inside the text from commas-separators.) <br><br>  <b>In the third step, I choose the format of the fields</b> , and everything was started for him.  For all columns I set the type "Text".  By the way, if you click on the first column, hold down the shift and click on the last one, all columns will be highlighted at once.  Conveniently. <br><br>  Then Excel will ask where to insert data from CSV - you can simply click "OK", and the data will appear in the open sheet. <br><br><img src="https://habrastorage.org/webt/rl/rf/cw/rlrfcwbol_yygemdyub2caobfpk.gif"><br>  <sub>Before importing, you will have to create a new workbook in Excel.</sub> <br><br>  <b>But!</b>  <b>If I plan to add data to CSV through Excel, I have to do one more thing.</b> <br><br>  After importing, you need to force all cells on the sheet to the ‚ÄúText‚Äù format.  Otherwise, the new fields will get the same type of ‚ÄúGeneral‚Äù. <br><br><ul><li>  Press Ctrl + A twice, Excel selects all the cells on the sheet; </li><li>  I click the right mouse button; </li><li>  I select Format Cells in the context menu; </li><li>  In the dialog that opens, I select the ‚ÄúText‚Äù data type on the left. </li></ul><br><img src="https://habrastorage.org/webt/3s/ux/aw/3suxawbdhnfuj5mokakdb8v6y74.gif"><br>  <sub>To select all the cells, press Ctrl + A twice.</sub>  <sub>Just two, this is not a joke, try</sub> <br><br>  After that, if you're lucky, Excel will leave the original data alone.  But this is not the strongest guarantee, so after saving we will definitely check the file through a text viewer. <br><br><h2>  Alternative: Open Office Calc </h2><br>  I use Calc to work with CSV files.  It is not that it does not consider digital data at all as strings, but at least it does not apply reformatting to them in accordance with the regional settings of Windows.  And import is simpler. <br><br>  Of course, you will need an Open Office (OO) package.  During installation, it will offer to reassign MS Office files to itself.  I do not recommend: although OO is quite functional, it does not fully understand the cunning microsoftware formatting of documents. <br><br>  But assigning OO as the default program for CSV files is quite reasonable.  You can do this after installing the package. <br><br>  So, we start importing data from CSV.  After double clicking on the file, Open Office displays a dialog. <br><br><img src="https://habrastorage.org/webt/xe/uh/zy/xeuhzy60ogakabxxxoiwc8pcdq8.png"><br>  <sub>Note that in OO you do not need to create a new workbook and force the import to run, all by itself</sub> <br><br><ol><li>  Encoding - as in the file. </li><li>  A ‚Äúdelimiter‚Äù is a semicolon.  Naturally, if it is the separator in the file. </li><li>  The ‚Äútext delimiter‚Äù is empty (all the same as in Excel). </li><li>  In the "Fields" section I click in the left-upper square of the table, all columns are highlighted.  I specify the type "Text". </li></ol><br>  A thing that spoiled a lot of blood: if by mistake you select several field separators or the wrong text is separated, the file may open correctly, but it may not be saved correctly. <br><br>  In addition to Calc, libreOffice is popular in HFLabs, especially under Linux.  Both are used more for CSV than Excel. <br><br><h2>  Bonus Track: problems saving from Calc to .xlsx </h2><br>  If you save data from Calc to Excel format .xlsx, keep in mind - OO sometimes inexplicably losing data on a large scale. <br><br><img src="https://habrastorage.org/webt/yv/bw/7u/yvbw7u8x4lzavz3hztn4pff9wvw.jpeg"><br>  <sub>The white wasteland in the middle is rich in data in the original CSV file.</sub> <br><br>  Therefore, after saving, I once again open the file and make sure that the data is in place. <br><br>  If something is lost, treatment is resave from CSV to .xlsx.  Or, if Windows is installed, import from CSV to Excel and save from there. <br><br>  After re-saving, I must once again check that all data is in place and there are no extra empty lines. <br><br>  <i>If you are interested in working with data, look <a href="https://hh.ru/employer/15589">at our vacancies</a> .</i>  <i>HFLabs almost always need analysts, testers, implementation engineers, developers.</i>  <i>We will provide data so that it will not find it :)</i> </div><p>Source: <a href="https://habr.com/ru/post/432906/">https://habr.com/ru/post/432906/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../432896/index.html">AXIS P1425-LE Mk II vs IDIS DC-T3233HRXL: Compare CCTV Cameras</a></li>
<li><a href="../432898/index.html">Panoramas on Stereo Pi</a></li>
<li><a href="../432900/index.html">Features of work in an international team. Japan</a></li>
<li><a href="../432902/index.html">Failed flight to the moon: what does the previously unknown recording of the Soviet mission Zond-6 tell us</a></li>
<li><a href="../432904/index.html">The best employers in IT 2018: the annual rating of "My Circle"</a></li>
<li><a href="../432908/index.html">Russia plans to introduce additional control over payments on the Internet</a></li>
<li><a href="../432910/index.html">It is dangerous to consider virtual reality as an empathy machine.</a></li>
<li><a href="../432912/index.html">How to get an internship at Google</a></li>
<li><a href="../432914/index.html">Very simple chat bot for Telegram for the little ones</a></li>
<li><a href="../432918/index.html">Sorry, I broke your recovery.conf</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>