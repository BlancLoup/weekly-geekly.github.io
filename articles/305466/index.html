<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Compiling and connecting dynamic nginx modules</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will tell you how to compile and install dynamic modules in nginx in its current installation. 

 I think many have come across a situati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Compiling and connecting dynamic nginx modules</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/e1d/529/d73/e1d529d731e74063a84e1e1192fbfa78.jpg"><br>  This article will tell you how to compile and install dynamic modules in nginx in its current installation. <br><a name="habracut"></a><br>  I think many have come across a situation where you need to install a web server, and a good one, besides, with the right modules.  For this, nginx fits like no other better.  And what do you most likely do, especially if you put it for the first time?  Typing <br><pre><code class="bash hljs">apt-get install nginx  yum install nginx</code> </pre> <br>  Then you realize that you want to try the module with http2, use the echo module, or add support for processing Ruby scripts by connecting the Passenger module to nginx. <br>  If you have previously worked with Apache2, disappointment awaits you.  You can't just take and put a module from the repository and activate it in the console (a2enmod). <br>  Since version 1.9.11, nginx supports dynamic modules.  They are not as easy to install as with Apache, but this is not difficult and now we will analyze it. <br>  Of course, there are already ready dynamic modules from the nginx developers themselves, which can be supplied from turnips: <br><pre> <code class="bash hljs">sudo apt-get install nginx-module-geoip</code> </pre><br>  But here we are talking about modules from third parties. <br>  In order not to compile nginx from scratch by specifying the required modules, and then changing configs, paths in the system, etc.  - you can add a dynamic module to the current nginx installation. <br>  For this we need: <br><ul><li>  Nginx sources that correspond to your version on the server (you can check the version with <b>nginx -v</b> ).  We download source codes <a href="http://nginx.org/ru/download.html">from here</a> . </li><li>  Installed Passenger (since we will add its dynamic module to nginx) </li><li>  Sources of other modules we need that are not in the base delivery of nginx: <a href="https://github.com/openresty/echo-nginx-module">Echo module</a> </li></ul><br><br>  To add modules to the current installation of nginx, we need to know - with what parameters it was assembled.  If you collect with parameters in which there will be only new modules, nginx will swear and will not allow the use of such a module. <br>  In order to find out with which parameters nginx was installed (including from the repository), you need to type the command <br><pre> <code class="bash hljs">nginx -V</code> </pre><br><br>  The output will be something like this: <br><pre> <code class="bash hljs">--prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib64/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/nginx/error.log --http-log-path=/var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --with-http_xslt_module=dynamic --with-http_image_filter_module=dynamic --with-http_geoip_module=dynamic --with-http_perl_module=dynamic --with-threads --with-stream --with-stream_ssl_module --with-http_slice_module --with-mail --with-mail_ssl_module --with-file-aio --with-ipv6 --with-http_v2_module --with-cc-opt=<span class="hljs-string"><span class="hljs-string">'-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic'</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We only need to add the modules we need here: <br><pre> <code class="bash hljs">--add-dynamic-module=/usr/share/passenger/ngx_http_passenger_module --add-dynamic-module=/tmp/<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>-nginx-module --with-http_v2_module</code> </pre><br>  where <b>/ usr / share / passenger / ngx_http_passenger_module</b> is the path to the Passenger module, appears after its installation into the system, <br>  <b>/ tmp / echo-nginx-module</b> is the path of the Echo module's cloned repository. <br><br>  The result is one command: <br><pre> <code class="bash hljs">./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib64/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/nginx/error.log --http-log-path=/var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --with-http_xslt_module=dynamic --with-http_image_filter_module=dynamic --with-http_geoip_module=dynamic --with-http_perl_module=dynamic --with-threads --with-stream --with-stream_ssl_module --with-http_slice_module --with-mail --with-mail_ssl_module --with-file-aio --with-ipv6 --with-http_v2_module --with-cc-opt=<span class="hljs-string"><span class="hljs-string">'-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic'</span></span> -add-dynamic-module=/usr/share/passenger/ngx_http_passenger_module --add-dynamic-module=/tmp/<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>-nginx-module --with-http_v2_module</code> </pre><br><br>  We carry it out. <br><br>  It remains to build and update modules for nginx: <br><pre> <code class="bash hljs">make modules sudo make install</code> </pre><br><br>  After that, your current nginx will be updated, the necessary modules will be added to it, and the dynamic modules will be located in the / etc / nginx / modules folder. <br><br>  To enable them in nginx, it remains only to add the following lines to the very beginning of the file in the global nginx config (/etc/nginx/nginx.conf): <br> <code>load_module modules/ngx_http_passenger_module.so; <br> load_module modules/ngx_http_echo_module.so; <br></code> <br><br>  Done!  It remains for us to restart the web server and enjoy life with the right modules: <br><pre> <code class="bash hljs">service nginx reload</code> </pre><br><br>  P.S.  I understand that for people who know this article - the captain.  But for those who have not encountered this and who are frightened by the compilation of software, the article will be useful to add new or interesting modules to nginx without serious consequences. </div><p>Source: <a href="https://habr.com/ru/post/305466/">https://habr.com/ru/post/305466/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../305444/index.html">Fifth Generation Framework Framework</a></li>
<li><a href="../305446/index.html">Avral: you work hard to get to the deadline. Now what?</a></li>
<li><a href="../305452/index.html">Smart tape VK - the killer of your conversions, but telegrams are not the way out</a></li>
<li><a href="../305462/index.html">Bot as a task manager?</a></li>
<li><a href="../305464/index.html">Cryptocurrency Dash: Symbiosis of Man and Code</a></li>
<li><a href="../305470/index.html">Microsoft Edge and RTC: pain history</a></li>
<li><a href="../305472/index.html">We attack SS7: security analysis of cellular operators in 2015</a></li>
<li><a href="../305474/index.html">Starbucks Mobile Payment Success Secrets</a></li>
<li><a href="../305476/index.html">The book "100 NEW Main Design Principles"</a></li>
<li><a href="../305478/index.html">Use RxJava and Retrofit on Android, given the screen rotation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>