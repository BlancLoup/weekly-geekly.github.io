<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with basic animation on the iPhone</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the attractive features of the Cocoa Touch interface is the simplified animation work. In this tutorial, I‚Äôll show a couple of simple examples ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with basic animation on the iPhone</h1><div class="post__text post__text-html js-mediator-article">  One of the attractive features of the <strong>Cocoa Touch</strong> interface is the simplified animation work.  In this tutorial, I‚Äôll show a couple of simple examples of creating animations for the iPhone.  Our animation will perform two tasks: to move an object on the screen and resize it depending on the point of touch by the user. <br><br>  Those who have not had to do programming on the iPhone, it will be useful to get acquainted with the basics <strong><a href="http://lookapp.ru/2009/05/15/iphone-sdk-tutorials5/"><b>here</b></a></strong> , <b><a href="http://lookapp.ru/2009/06/04/iphone-sdk-tutorials46/">here</a> and <b><a href="http://lookapp.ru/2009/07/16/iphone-sdk-tutorials80/">here</a></b></b> .  As an example, I will also give a lesson from the <a href="http://www.stanford.edu/class/cs193p/cgi-bin/index.php"><strong>Stanford iPhone Development</strong></a> series (English), where the basics of motion animation were considered. <br><br>  Below is a short video of the application that we have to create.  As mentioned above, you can do two things with it.  One click will move the internal view to the touch point.  When you double-tap the view will move with resizing.  Focusing on the touch points, the application create a rectangle with a frame for presentation. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/4635669&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhgD9KlD7xjYoWZgMQX4BHYw7sbNwg" width="164" height="240" frameborder="0" title="Strechy animation demo" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe><br><br>  Well, let's get started ... <a name="habracut"></a>  First of all, we need a project.  After creating a simple <strong>Window-Based Application</strong> , let's add a view to it.  To do this, open the " <strong>MainWindow.xib</strong> " file in the <strong>Interface Builder</strong> editor by double-clicking on it.  In the running editor, open the Library window (with the command <strong>Tools</strong> -&gt; <strong>Library</strong> ).  One of its elements is the <strong>View</strong> component.  Drag it into the main Window window, focusing on the image below. <br><br><img title="dragviewintowindow" src="https://habrastorage.org/getpro/habr/post_images/d95/d9f/80d/d95d9f80d90c82f7d46d83a72c4023f1.jpg" alt="dragviewintowindow" width="600" height="380"><br><br>  Now you need to tell the main view that the multi-touch method of operation will be resolved.  This can be done in the inspector window, invoked by the " <strong>Tools</strong> -&gt; <strong>Attributes Inspector</strong> " command.  Make sure that the " <strong>Multiple Touch</strong> " option at the bottom of the window is checked. <br><br><img title="viewsetmultitouch" src="https://habrastorage.org/getpro/habr/post_images/e98/e23/1ac/e98e231ace7c558fc68a4159f613f47d.jpg" alt="viewsetmultitouch" width="287" height="290"><br><br>  Inside the first view, drag the second, the one that will move and resize.  For the second view, you will need to adjust a number of parameters: size, color, initial position.  You can adjust the size and position in the Size inspector ( <strong>Tools</strong> &gt; <strong>Size Inspector</strong> ).  I set the position to 0, 0, size - 30, 30. In the Attribute Inspector window, uncheck the box " <strong>User Interaction Enabled</strong> ". <br><br><img title="smallviewupdateattributes" src="https://habrastorage.org/getpro/habr/post_images/a42/701/113/a42701113e4d5161c4db09b98e1a460b.jpg" alt="smallviewupdateattributes" width="507" height="467"><br><br>  The next step is to create a custom subclass " <strong>UIView</strong> ", which will include all the code for this lesson.  I gave my own name " <strong>TouchView</strong> ". <br><br><img title="cocoatouchnewclass" src="https://habrastorage.org/getpro/habr/post_images/51d/ddc/4b2/51dddc4b207d5214f2e13d2e3f74e99d.jpg" alt="cocoatouchnewclass" width="618" height="566"><br><br><img title="touchviewcreate" src="https://habrastorage.org/getpro/habr/post_images/b27/b87/4b7/b27b874b754e07df0e30237df35aeb8c.jpg" alt="touchviewcreate" width="618" height="566"><br><br><br>  In the " <strong>TouchView.h</strong> " file for a small internal view (moving and resizing), add the variable <strong>single instance</strong> .  Give it the label " <strong>IBOutlet</strong> " to associate with the presentation in the <strong>IB</strong> editor.  As a result, the header file will look like this: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#import &lt;UIKit/UIKit.h&gt; <br> <br> @ <font color="#0000ff">interface</font> TouchView : UIView { <br> IBOutlet UIView *strechView; <br> } <br> <br> @end</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  To associate an <strong>IB</strong> view with a custom class ( <strong>custom class</strong> ), specify the class name for the view.  To do this, select the main view in the <strong>IB</strong> editor and open the " <strong>Identity Inspector</strong> " inspector window for it.  In the " <strong>Class</strong> " field at the top of the window, enter " <strong>TouchView</strong> ". <br><br>  Let's go back to the editor and associate the small view with the instance variable.  To do this, hold down the <strong>&lt;Control&gt;</strong> key, click on the main view and drag it to a small one.  In the window that opens, options for communication will appear.  We need a " <strong>strechView</strong> " method. <br><br><img title="strechviewconnect" src="https://habrastorage.org/getpro/habr/post_images/c54/3e7/ee9/c543e7ee956850f566a6468ff5f09620.jpg" alt="strechviewconnect" width="320" height="502"><br>  The rest of the code refers to " <strong>TouchView.m</strong> ".  First, delete all the current code, since we will not need any of the methods implemented in it.  However, you can add the following fragment, the processing time of touching the screen. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">- ( <font color="#0000ff">void</font> )touchesBegan:(NSSet *)touches withEvent:(UIEvent *) <font color="#0000ff">event</font> <br> { <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  First you need to run the animation.  The " <strong>beginAnimations: context:</strong> " method of the " <strong>UIView</strong> " class will be responsible for this.  We give it the name of the animation and " <strong>nil</strong> " as the context.  In my case, the name will be <strong>@ "MoveAndStrech"</strong> .  To start and stop the animation, refer to the method of the " <strong>commitAnimations</strong> " class.  Events between the two requests and represent the actual animation.  Two methods will help you quickly configure animation behavior: " <strong>setAnimationDuration:</strong> " and " <strong>setAnimationBeginsFromCurrentState</strong> ".  The function of the first, in principle, is clear from the title, and the second tells the animation that it will begin with the current state of the view.  Here is what the updated " <strong>touchesBegan</strong> " method will look like: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">- ( <font color="#0000ff">void</font> )touchesBegan:(NSSet *)touches withEvent:(UIEvent *) <font color="#0000ff">event</font> <br> { <br> [UIView beginAnimations: <font color="#A31515">@"MoveAndStrech"</font> context:nil]; <br> [UIView setAnimationDuration:1]; <br> [UIView setAnimationBeginsFromCurrentState:YES]; <br> <br> [UIView commitAnimations]; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The rest of the code is responsible for updating the view.  First consider the situation with one touch.  In this case, we get the object " <strong>UITouch</strong> " from the set of " <strong>touches</strong> ".  Then set the center <strong>‚ÄústrechVie</strong> ‚Äù to the touch point relative to the main view (self).  As a result, in two simple lines we have a moving view, following a touch. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">- ( <font color="#0000ff">void</font> )touchesBegan:(NSSet *)touches withEvent:(UIEvent *) <font color="#0000ff">event</font> <br> { <br> [UIView beginAnimations: <font color="#A31515">@"MoveAndStrech"</font> context:nil]; <br> [UIView setAnimationDuration:1]; <br> [UIView setAnimationBeginsFromCurrentState:YES]; <br> <font color="#0000ff">if</font> ([touches count] == 1) { <br> UITouch *touch = [touches anyObject]; <br> strechView.center = [touch locationInView:self]; <br> } <br> [UIView commitAnimations]; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  It remains only to implement the resizing of the presentation.  Below we take a closer look at the following fragment: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">- ( <font color="#0000ff">void</font> )touchesBegan:(NSSet *)touches withEvent:(UIEvent *) <font color="#0000ff">event</font> <br> { <br> [UIView beginAnimations: <font color="#A31515">@"MoveAndStrech"</font> context:nil]; <br> [UIView setAnimationDuration:1]; <br> [UIView setAnimationBeginsFromCurrentState:YES]; <br> <font color="#0000ff">if</font> ([touches count] == 1) { <br> UITouch *touch = [touches anyObject]; <br> strechView.center = [touch locationInView:self]; <br> } <font color="#0000ff">else</font> <font color="#0000ff">if</font> ([touches count] == 2) { <br> NSArray *touchArray = [touches allObjects]; <br> UITouch *touchOne = [touchArray objectAtIndex:0]; <br> UITouch *touchTwo = [touchArray objectAtIndex:1]; <br> CGPoint pt1 = [touchOne locationInView:self]; <br> CGPoint pt2 = [touchTwo locationInView:self]; <br> CGFloat x, y, width, height; <br> <font color="#0000ff">if</font> (pt1.x &lt; pt2.x) { <br> x = pt1.x; <br> width = pt2.x - pt1.x; <br> } <font color="#0000ff">else</font> { <br> x = pt2.x; <br> width = pt1.x - pt2.x; <br> } <br> <font color="#0000ff">if</font> (pt1.y &lt; pt2.y) { <br> y = pt1.y; <br> height = pt2.y - pt1.y; <br> } <font color="#0000ff">else</font> { <br> y = pt2.y; <br> height = pt1.y - pt2.y; <br> } <br> strechView.frame = CGRectMake(x, y, width, height); <br> } <br> [UIView commitAnimations]; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  To move the view with resizing, you need to fix two touches.  This will easily execute an instance method of the <strong>allObjects</strong> class on a set of <strong>touches</strong> .  We get both addresses and determine the top <strong>x</strong> and <strong>y</strong> coordinates.  Width and height are calculated from the difference of coordinates.  The final step is to set the <strong>frame</strong> for the view using the <strong>CGRectMake</strong> .  The resulting file " <strong>TouchView.m</strong> " is shown below: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#import <font color="#A31515">"TouchView.h"</font> <br> <br> @implementation TouchView <br> <br> - ( <font color="#0000ff">void</font> )touchesBegan:(NSSet *)touches withEvent:(UIEvent *) <font color="#0000ff">event</font> <br> { <br> [UIView beginAnimations: <font color="#A31515">@"MoveAndStrech"</font> context:nil]; <br> [UIView setAnimationDuration:1]; <br> [UIView setAnimationBeginsFromCurrentState:YES]; <br> <font color="#0000ff">if</font> ([touches count] == 1) { <br> UITouch *touch = [touches anyObject]; <br> strechView.center = [touch locationInView:self]; <br> } <font color="#0000ff">else</font> <font color="#0000ff">if</font> ([touches count] == 2) { <br> NSArray *touchArray = [touches allObjects]; <br> UITouch *touchOne = [touchArray objectAtIndex:0]; <br> UITouch *touchTwo = [touchArray objectAtIndex:1]; <br> CGPoint pt1 = [touchOne locationInView:self]; <br> CGPoint pt2 = [touchTwo locationInView:self]; <br> CGFloat x, y, width, height; <br> <font color="#0000ff">if</font> (pt1.x &lt; pt2.x) { <br> x = pt1.x; <br> width = pt2.x - pt1.x; <br> } <font color="#0000ff">else</font> { <br> x = pt2.x; <br> width = pt1.x - pt2.x; <br> } <br> <font color="#0000ff">if</font> (pt1.y &lt; pt2.y) { <br> y = pt1.y; <br> height = pt2.y - pt1.y; <br> } <font color="#0000ff">else</font> { <br> y = pt2.y; <br> height = pt1.y - pt2.y; <br> } <br> strechView.frame = CGRectMake(x, y, width, height); <br> } <br> [UIView commitAnimations]; <br> } <br> <br> @end</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  That's all.  Talk, learn :) <br><br>  The source code for the lesson can be downloaded <b><a href="http://lookapp.ru/2009/05/20/iphone-sdk-tutorials18-2/">here</a></b> . </div><p>Source: <a href="https://habr.com/ru/post/70377/">https://habr.com/ru/post/70377/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../70370/index.html">Google added Chrome in Internet Explorer</a></li>
<li><a href="../70371/index.html">Courier - tablet booklet from Microsoft</a></li>
<li><a href="../70372/index.html">Encryption of a separate part of the PHP script</a></li>
<li><a href="../70375/index.html">Virtual VISA Card from QIWI (QIWI). First month of work</a></li>
<li><a href="../70376/index.html">Make your site work efficiently. It is not difficult</a></li>
<li><a href="../70379/index.html">Photos of interesting home offices</a></li>
<li><a href="../70381/index.html">The organization of the HTTP tunnel on the example of utilities for working with MySQL</a></li>
<li><a href="../70382/index.html">Picasa 3.5</a></li>
<li><a href="../70384/index.html">Headphones that feel you. Sony Ericsson MH907</a></li>
<li><a href="../70386/index.html">Zend_Form, Russification of Error Messages</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>