<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Design Template Projects or the complexity of managing large projects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 


 Modern frontend is actively moving towards complication, and this complexity must be controlled. To begin with, I would like to note th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Design Template Projects or the complexity of managing large projects</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/0w/cg/om/0wcgomdqth__rgmus2qeq6nx-oe.jpeg" alt="Rispa is a tool to make everyone friends with everyone."></p><br><h2 id="predystoriya">  Prehistory </h2><br><p>  Modern frontend is actively moving towards complication, and this complexity must be controlled.  To begin with, I would like to note that the problem has existed for a long time, and several of its solutions have been tested and even adapted, but the concrete idea should have crystallized and shaped.  What will be discussed further. </p><a name="habracut"></a><br><p>  The company I am currently working on is developing a frontend for various customers, and the size of projects varies from very small to very solid (for example, Enterprise systems).  We are faced with the fact that solutions that are well suited for large projects are poorly adapted for small ones, and vice versa - that in small projects it works very well does not meet the requirements of large ones. </p><br><p>  In the spirit of the times, we can say that we need our own boilerplate for projects, which allows us to effectively structure projects of various scales so as to keep their complexity under control and not allow it to grow arbitrarily, because  This can lead either to a failure of the project deadlines, or to a lot of trouble.  And, of course, do not forget about the cost of support and development. </p><br><p>  The initial implementation assumed a simple division of the project into independent parts, and the main emphasis was placed on the development of a tool to facilitate the work with the project.  The project began to be a mono-repository under the management of lerna, which was formed on the basis of common modules, openly published on github, as well as specific modules that are in the project itself.  An event bus was used to communicate between these modules, and in general, this implementation worked stably.  However, this structure had a significant drawback: the modules that were not planned to be changed within the project still needed to be connected as part of the mono-repository, because otherwise we received different versions of the same package in different places.  This, of course, is not a problem, but only if it is not a package with configs. </p><br><p>  The second important problem was the description of the method of writing plug-ins, because, for all their modularity, they still turned out to be strongly connected, and the general concept of communication between modules was absent.  We needed some kind of holistic specification for writing such plug-ins by any person, which would also solve the issue of resolving dependencies at the start level of the application. </p><br><p>  Next, I will try to describe our version of eliminating these problems and begin by describing the ideal possible result. </p><br><h2 id="disclaimer">  Disclaimer </h2><br><p>  Written below does not pretend to be the ultimate truth and is just another opinion.  We are looking for our own way and we want to make the world a little better and more convenient, at least for ourselves. </p><br><h2 id="idealnyy-vozmozhnyy-rezultat">  Perfect possible result </h2><br><h3 id="1-modulnost">  1. Modularity </h3><br><p>  <em>Problem</em> : monolithic application.  Steps are already being taken to divide the client code into separate parts within a certain monolith, but in essence the project remains as one, and it is difficult to quickly replace or remove a certain part in it, since it does not have clear boundaries. </p><br><p>  <em>Solution</em> : Break the project into physically demarcated modules with clearly defined boundaries and responsibilities.  You also need the ability to configure the behavior of one module from another. </p><br><p> <em>Profit</em> : The project can be assembled as a designer.  That is, the module itself ensures its performance within the existing infrastructure.  A good example here is setting up the lint.  The linter's config itself can be assembled in parts from different packages, but the plugins used should be connected in the project itself.  The ideal module connecting the linter, along with itself, will bring all the necessary plug-ins, and, when used in the project, will itself make changes for its connection.  In the case of <code>eslint</code> these are the commands in <code>package.json</code> and the <code>.eslintrc</code> config <code>.eslintrc</code> . </p><br><h3 id="2-interfeys-vzaimodeystviya">  2. Interface of interaction </h3><br><p>  <em>Problem</em> : The increasing complexity of the internal structure of the application leads to difficulties in managing dependencies, project configuration, and running commands. </p><br><p>  <em>Solution</em> : You need a <code>cli</code> developed <code>cli</code> application that provides a simple and intuitive interface for managing, extending and supporting a project.  Teams must be concise and intuitive. </p><br><p>  <em>Profit</em> : The developer spends much less time on routine operations - for example, creating standard components for an interface. </p><br><h3 id="3-avtomatizaciya-rutinnyh-zadach">  3. Automation of routine tasks </h3><br><p>  <em>Problem</em> : Most templates end their participation in a project immediately after generating a project or cloning a template.  Sometimes a tool is added that can generate atomic parts of a project. </p><br><p>  <em>Solution</em> : Each module must contain a specific set of templates of its component parts, which can be quickly added to the project. </p><br><p>  <em>Profit</em> : The power of automating routine tasks is the <em>responsibility of the project itself, not the template</em> .  That is, the more complex the project, the more complex generators it will require, but adding them will not affect, for example, another, more local project.  But if necessary, it can be easily connected as a separate module. </p><br><p>  Briefly: the set of generators in the project is determined by the set of installed modules. </p><br><h3 id="4-obnovlenie-shablona">  4. Template update </h3><br><p>  <em>Problem</em> : After starting a project on a specific template, updating the packages used, as well as the project structure, remains with the project developers. </p><br><p>  <em>Solution</em> : It is necessary to provide the ability to quickly update dependencies and migrate the code base if necessary. </p><br><p>  <em>Profit</em> : Migration of breaking versions can be done only in one place.  In the final projects, the project will simply update the dependencies of the project with additional migration of the code base, if necessary (it should be said that, since this task has not been solved yet, its definition and implementation method are vague). </p><br><h2 id="kak-eto-rabotaet">  How it works </h2><br><p>  It turns out that the Rispa project can be divided into several levels: </p><br><ul><li>  <code>cli</code> app, </li><li>  infrastructure to support the modularity of the project, </li><li>  plug-ins: <br><ul><li>  general functionality </li><li>  project-specific logic. </li></ul></li></ul><br><h3 id="cli-prilozhenie">  <code>cli</code> app </h3><br><p>  The main feature of this application is that the set of executable commands depends on the project itself.  That is, there are two types of commands: </p><br><ol><li>  Project management teams: <code>ris add</code> , <code>ris update</code> , <code>ris assemble</code> and others; </li><li>  Commands from plugins described as <code>scripts</code> in <code>package.json</code> .  It is an extension of the <code>ris run [plugin-name-or-alias] [command-name-from-scripts]</code> in which the <code>run</code> can be omitted </li></ol><br><p>  More details about cli can be found <a href="https://github.com/rispa-io/rispa-cli">in the description</a> . </p><br><h3 id="modulnaya-infrastruktura">  Modular infrastructure </h3><br><p>  The most obvious solution for organizing such an infrastructure is the use of the mono-repository format in the final project.  The <a href="https://github.com/lerna/lerna"><code>lerna.js</code></a> tool was originally used, but it is better suited for managing library development projects, such as <code>jest</code> , <code>babel</code> and many others.  The main feature used was the resolution of dependencies within the monorepository, but now, with the advent of <a href="https://yarnpkg.com/blog/2017/08/02/introducing-workspaces/"><code>yarn workspaces</code></a> , they switched to using them, because it allows to solve the problems of organizing a project as a monorepository most effectively. </p><br><p>  The second part of the modularity of the application can be called <a href="https://github.com/rispa-io/rispa-core">rispa-core</a> .  This package provides the ability to organize the interaction of plug-ins with each other, and also declares the <a href="">specification</a> for writing plug-ins. </p><br><h3 id="plaginy">  Plugins </h3><br><p>  At the moment, a rather large body of plug-ins has been formed, however, they mainly serve the needs of projects at React, which in the future may be revised to introduce support for other frameworks or build systems.  Here is a short list of them: </p><br><ul><li>  <a href="https://github.com/rispa-io/rispa-config"><code>rispa-config</code></a> is the project configuration repository, it is always present in the project and is connected as a simple dependency in all plug-ins; </li><li>  <a href="https://github.com/rispa-io/rispa-server"><code>rispa-server</code></a> - is responsible for the entire routine associated with starting the server, configuring compression, supporting CORS, and some default routing.  At the same time allows other plugins to expand their capabilities through the connection of routs and other middleware; </li><li>  <a href="https://github.com/rispa-io/rispa-client"><code>rispa-client</code></a> - directly responsible for the client application that runs in the browser.  Now it is a React-specific client, so in the future there will be only a part that provides the work of the entire platform, and the React-part will move to a separate plugin; </li><li>  <a href="https://github.com/rispa-io/rispa-webpack"><code>rispa-webpack</code></a> - is responsible for the overall assembly of the project webpack, while the config is assembled in parts from existing plug-ins; </li><li>  <a href="https://github.com/rispa-io/rispa-eslint-config"><code>rispa-eslint-config</code></a> - is responsible for the connection and correct operation of the linter in the project, is simply a drop-in dependency; </li><li>  <a href="https://github.com/rispa-io/rispa-generator"><code>rispa-generator</code></a> - is responsible for the work of generators in the project, the generators themselves are also assembled from all installed plug-ins in the project. </li></ul><br><p>  Experimental plugins: </p><br><ul><li>  <a href="https://github.com/rispa-io/rispa-render-static"><code>rispa-render-static</code></a> - a plugin for rendering an existing application to a static site, currently under development; </li><li>  <a href="https://github.com/rispa-io/rispa-render-simple"><code>rispa-render-simple</code></a> - a plugin for rendering pages without frameworks; in the initial implementation pug is used, probably the final version will also be customizable. </li></ul><br><h2 id="kak-nachat">  How to start </h2><br><p>  You must first install <code>cli</code> : </p><br><pre> <code class="bash hljs">$ yarn global add @rispa/cli</code> </pre> <br><p>  After a successful installation, you need to run <code>ris new</code> , which will allow you to create a new project, answer questions, select plugins and wait for the installation of all dependencies: </p><br><pre> <code class="bash hljs">$ ris new</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Approximate view in the console</b> <div class="spoiler_text"><pre> <code class="bash hljs">$ ris new [18:22:11] Enter project name [started] ? Enter project name: temp-project-name [18:22:22] Enter project name [completed] [18:22:22] Enter remote url [started] ? Enter remote url <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> project (optional): [18:22:24] Enter remote url [completed] [18:22:24] Generate project structure [started] [18:22:24] Generate project structure [completed] [18:22:24] Git init [started] Initialized empty Git repository <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /opt/work/temp-project-name/.git/ [master (root-commit) f5af296] Create project <span class="hljs-string"><span class="hljs-string">'temp-project-name'</span></span> [18:22:24] Git init [completed] [18:22:24] Fetch plugins [started] [18:22:28] Fetch plugins [completed] [18:22:28] Select plugins to install [started] ? Select plugins: &gt;(*) react-redux v4.1.3 - Rispa Redux plugin (*) webpack-javascript v4.1.3 - Rispa plugin <span class="hljs-built_in"><span class="hljs-built_in">which</span></span> provide Webpack JavaScript configuration (*) babel v4.1.3 - Rispa Babel plugin (*) @rispa/react-config v4.1.3 - Rispa React Configuration (*) @rispa/routes v4.1.3 - rispa routes (*) react-server v4.1.7 - Rispa Server rendering plugin (*) react-client v4.1.3 - Rispa Client plugin (Move up and down to reveal more choices) [18:33:30] Select plugins to install [completed] [18:33:30] Install plugins [started] [18:33:30] Install plugin with name @rispa/react-config [started] ... success Saved lockfile. $ ris clean-cache [18:37:38] Read project configuration [started] [18:37:38] Read project configuration [completed] [18:37:38] Clean cache [started] [18:37:38] Clean cache [completed] Done <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 240.41s. [18:37:39] Install project dependencies [completed] [18:37:39] Git commit [started] [master e3223c2] Bootstrap deps and install plugins [18:37:40] Git commit [completed]</code> </pre> </div></div><br><p>  Now we have a freshly generated and customized project.  However, there is no route in it.  Need to add it.  To do this, use the <code>feature-plugin</code> generator, which creates a new module and registers it with <code>@rispa/routes</code> .  After answering a few questions, the plugin will be generated and connected to the project, and the dependencies will be updated. </p><br><pre> <code class="bash hljs">$ ris g feature-plugin</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Approximate view in the console</b> <div class="spoiler_text"><pre> <code class="bash hljs">$ ris g feature-plugin [19:07:27] Read project configuration [started] [19:07:27] Read project configuration [completed] [19:07:27] Scan plugins [started] [19:07:27] Scan plugins [completed] [19:07:27] Init generators [started] [19:07:28] Init generators [completed] [19:07:28] Check generator [started] [19:07:28] Check generator [completed] [19:07:28] Select plugin [started] [19:07:28] Select plugin [skipped] [19:07:28] Enter plugin name [started] ? Enter plugin name: home [19:07:38] Enter plugin name [completed] [19:07:38] Run generator [started] ? Enter package name: @project/home ? Enter plugin router path: / [19:07:58] Run generator [completed] [19:07:58] Bootstrap plugin dependencies [started] ... [19:08:26] Read project configuration [started] [19:08:26] Read project configuration [completed] [19:08:26] Clean cache [started] [19:08:26] Clean cache [completed] Done <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 28.54s. [19:08:27] Bootstrap plugin dependencies [completed]</code> </pre> </div></div><br><p>  Now we have a customized plugin, then we need to deliver the main component for the page.  Again we will use the <code>ris g container</code> generator, in the process we will be asked to choose which plugin to generate.  By the way, to see all the generators, you can simply specify <code>ris g</code> - a list of generators available in the project will be displayed. </p><br><pre> <code class="bash hljs">$ ris g container</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Approximate view in the console</b> <div class="spoiler_text"><pre> <code class="bash hljs">$ ris g container [19:12:20] Read project configuration [started] [19:12:20] Read project configuration [completed] [19:12:20] Scan plugins [started] [19:12:20] Scan plugins [completed] [19:12:20] Init generators [started] [19:12:20] Init generators [completed] [19:12:20] Check generator [started] [19:12:20] Check generator [completed] [19:12:20] Select plugin [started] ? Select plugin: @project/home [19:12:25] Select plugin [completed] [19:12:25] Enter plugin name [started] [19:12:25] Enter plugin name [skipped] [19:12:25] Run generator [started] ? How should it be called? Home [19:12:29] Run generator [completed] [19:12:29] Bootstrap plugin dependencies [started] [19:12:29] Bootstrap plugin dependencies [skipped]</code> </pre></div></div><br><p>  Now it is necessary to associate the route with the created container, this is done in the file <code>/packages/home/src/register.js</code> : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Home <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./containers/Home/Home'</span></span> <span class="hljs-comment"><span class="hljs-comment">// import reducer, { action } from './redux/reducer' // import { match } from '@rispa/redux' const registerReducer = () =&gt; { // store.injectReducer('reducerName', reducer) } const registerWhen = () =&gt; { // when(match('/'), action) } const registerModule = context =&gt; { registerReducer(context) registerWhen(context) return Home } export default registerModule</span></span></code> </pre> <br><p>  Now you can run the project and after completing the build, see it in the browser: </p><br><pre> <code class="hljs pgsql">$ ris <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>-dev</code> </pre> <br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Now Rispa allows you to solve problems to simplify the start of the project, as well as streamline the workflow.  Further development is seen precisely in the expansion of capabilities and support of new frameworks, and in addition, in the search for other possible applications for the base itself in the form of <code>rispa-cli + rispa-core</code> . </p><br><p>  If you like the idea of ‚Äã‚Äãthis project, then I would like to read more about, for example, features of the organization of plug-in infrastructure on top of a mono-repository, or a tutorial on plug-in development and an overview of environments or modes that cli works with the project, or the client application architecture it reacts specific, it remains fairly standard.  As the project develops, and there is no possibility to test everything in various environments, problems that can be covered through issues are not excluded.  We also invite those who wish to join this project in order to develop it for the benefit of the developers. </p><br><h2 id="nekotorye-plany-na-buduschee">  Some plans for the future </h2><br><ul><li>  Expansion of the list of supported frameworks, it is planned to add Angular, vue.js; </li><li>  Completion of moving the yard and plug-ins on TypeScript and typing of all interfaces; </li><li>  Adding detailed documentation for plugins; </li><li>  Implementing the plug-in infrastructure on the client. </li></ul><br><h2 id="poleznye-ssylki">  useful links </h2><br><ul><li>  Project organization on <a href="https://github.com/rispa-io/">github</a> </li><li>  Project page with basic info <a href="https://rispa.io/">rispa.io</a> </li><li>  The company, under the wing of which it was all born <a href="https://csssr.ru/">CSSSR</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/346926/">https://habr.com/ru/post/346926/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346914/index.html">Advantages and fatal flaws in php typing</a></li>
<li><a href="../346918/index.html">OAuth authentication in the Flask application</a></li>
<li><a href="../346920/index.html">Ten startups from 1298: the story of the first global IKEA Bootcamp</a></li>
<li><a href="../346922/index.html">Interview with Oren Kaniel (CEO Appsflyer) about the mobile ecosystem, investments in technology and corporate culture</a></li>
<li><a href="../346924/index.html">How many participants can be in a WebRTC call?</a></li>
<li><a href="../346928/index.html">Past, present and future speech recognition technology</a></li>
<li><a href="../346930/index.html">My favorite algorithm: finding the median for linear time</a></li>
<li><a href="../346932/index.html">New process of launching online games in China</a></li>
<li><a href="../346934/index.html">Review of the best reports from HighLoad ++ 2017</a></li>
<li><a href="../346936/index.html">How to fit property in one byte?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>