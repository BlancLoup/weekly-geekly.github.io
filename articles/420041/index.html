<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>War of TypeScript or Conquest of Enum</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 
 Half a year ago, our company decided to switch to newer and more modern technologies. To do this, they formed a group of specialists who ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>War of TypeScript or Conquest of Enum</h1><div class="post__text post__text-html js-mediator-article"><h2>  Prehistory </h2><br>  Half a year ago, our company decided to switch to newer and more modern technologies.  To do this, they formed a group of specialists who had to: decide on the technological stack, make a bridge to the legacy code on the basis of this stack, and finally, transfer part of the old modules to new rails.  I was lucky to get into this group.  The client code base is approximately one million lines of code.  We chose TypeScript as the language.  GUI decided to make the substrate on the vue, coupled with the <a href="https://github.com/vuejs/vue-class-component">vue-class-component</a> and <a href="https://github.com/thiagobustamante/typescript-ioc">IoC</a> . <br><br>  But the story is not about how we got rid of Legacy code, but about one small incident that resulted in a real war of knowledge.  Who cares, welcome under cat. <br><a name="habracut"></a><br><h2>  Getting to know the problem </h2><br>  A couple of months after the start, the working group got used to the new stack well and already managed to transfer part of the old code to it.  One could even say that a certain critical mass of meat had accumulated, when it was necessary to stop, take a breath, and take a look at what we wrapped up. <br><br>  There were enough places that required deep study, as you understand.  But of all the important things, ironically, nothing clung to me.  Not clinging as a developer.  But one of the unimportant, on the contrary, did not give rest.  I was completely annoyed by the way we work with data like an enumeration.  There was no generalization.  Then you will meet a separate class with a set of required methods, then you will find two classes for the same, or even something mysterious and magical.  And there is nobody to blame here.  The pace that we took to get rid of Legacy was too great. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Raising the topic with transfers among colleagues, I received support.  It turned out that not only I am not satisfied with the lack of a unified approach to working with them.  At that moment, I had a dream that in a couple of hours of coding I would achieve the desired result and volunteered to correct the situation.  But how was I wrong then ... <br><br><pre><code class="hljs pgsql">//    ,        . <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Enum} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "ts-jenum"; @Enum("text") export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> State { static readonly <span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("New"); static readonly ACTIVE = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("Active"); static readonly BLOCKED = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("Blocked"); private constructor(<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span>: string) { super(); } } //   console.log("" + State.ACTIVE); // Active console.log("" + State.BLOCKED); // Blocked console.log(State.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>()); // [State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span>, State.ACTIVE, State.BLOCKED] console.log(State.valueOf("New")); // State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> console.log(State.valueByName("NEW")); // State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> console.log(State.ACTIVE.enumName); // ACTIVE</code> </pre> <br><h2>  1. Decorator </h2><br>  Where to begin?  Only one thing came to mind: to base Java-like enumeration.  But since I wanted to show off in front of my colleagues, I decided to abandon the classical inheritance.  Use decorator instead.  The decorator, moreover, could be applied with arguments in order to give the enumeration the required functionality easily and naturally.  Coding did not take much time and after a couple of hours I already had something similar to this: <br><br><div class="spoiler">  <b class="spoiler_title">Decorator</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">export <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Enum(idProperty?: string) { // tslint:<span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-next-<span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> &lt;T extends <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span>, V&gt;(target: T): T { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).__enumMap__ || (target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).__enumValues__) { const enumName = (target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).prototype.constructor.name; throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`The enumeration ${enumName} has already initialized`); } const enumMap: <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> = {}; const enumMapByName: <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> = {}; const enumValues = []; // Lookup static fields <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (const key <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.keys(target)) { const <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> = (target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>)[key]; // <span class="hljs-keyword"><span class="hljs-keyword">Check</span></span> static field: <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be instance <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> enum <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> instanceof target) { let id; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (idProperty) { id = (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>)[idProperty]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (typeof id !== "string" &amp;&amp; typeof id !== "number") { const enumName = (target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).prototype.constructor.name; throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`The <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the ${idProperty} property <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the enumeration element ${enumName}. ${key} <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> a string <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> a number: ${id}`); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { id = key; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (enumMap[id]) { const enumName = (target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).prototype.constructor.name; throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`An element <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the identifier ${id}: ${enumName}.${enumMap[id].enumName} already <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the enumeration ${enumName}`); } enumMap[id] = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; enumMapByName[key] = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; enumValues.push(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.defineProperty(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, "__enumName__", {<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: key}); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">freeze</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">freeze</span></span>(enumMap); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">freeze</span></span>(enumValues); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.defineProperty(target, "__enumMap__", {<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: enumMap}); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.defineProperty(target, "__enumMapByName__", {<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: enumMapByName}); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.defineProperty(target, "__enumValues__", {<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: enumValues}); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (idProperty) { <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.defineProperty(target, "__idPropertyName__", {<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: idProperty}); } //  <span class="hljs-keyword"><span class="hljs-keyword">values</span></span>(), valueOf     ,    -. <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">freeze</span></span>(target); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> target; }; }</code> </pre></div></div><br>  And here I suffered a first failure.  It turned out that using the decorator can not change the type.  On this subject, Microsoft even has a message: <a href="https://github.com/Microsoft/TypeScript/issues/4881">Class Decorator Mutation</a> .  When I say that you cannot change the type, I mean that your IDE will not know anything about it and will not offer any prompts or adequate auto-completion.  And you can change the type as much as you like, just to sense from this ... <br><br><h2>  2. Inheritance </h2><br>  As I did not try to persuade myself, but I had to return to the idea of ‚Äã‚Äãcreating transfers on the basis of a general class.  And what's the big deal?  I was annoyed with myself.  Time goes on, guys from the group of figachat god forbid, and I spend time here for decorators.  It was possible to cut down enum in an hour and move on.  So be it.  Quickly threw the code of the base class Enumerable and sighed, feeling relieved.  I threw the draft in a common repository and asked a colleague to check the solution. <br><br><div class="spoiler">  <b class="spoiler_title">Enumerable</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">// :     ,  -     export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Enumerable&lt;T&gt; { constructor() { const clazz = this.constructor <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EnumStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (clazz.__enumMap__ || clazz.__enumValues__ || clazz.__enumMapByName__) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`It <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> forbidden <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> ${clazz.name} enumeration elements outside the enumeration`); } } static <span class="hljs-keyword"><span class="hljs-keyword">values</span></span>&lt;T&gt;(): ReadonlyArray&lt;T&gt; { const clazz = this <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EnumStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!clazz.__enumValues__) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`${clazz.name} enumeration has <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> been initialized. It <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> necessary <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> the decorator @Enum <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>`); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> clazz.__enumValues__; } static valueOf&lt;T&gt;(id: string | number): T { const clazz = this <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EnumStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!clazz.__enumMap__) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`${clazz.name} enumeration has <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> been initialized. It <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> necessary <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> the decorator @Enum <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>`); } const <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = clazz.__enumMap__[id]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`The element <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> ${id} identifier does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> exist <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the $ {clazz.name} enumeration`); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } static valueByName&lt;T&gt;(<span class="hljs-type"><span class="hljs-type">name</span></span>: string): T { const clazz = this <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EnumStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!clazz.__enumMapByName__) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`${clazz.name} enumeration has <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> been initialized. It <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> necessary <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> the decorator @Enum <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>`); } const <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = clazz.__enumMapByName__[<span class="hljs-type"><span class="hljs-type">name</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`The element <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> ${<span class="hljs-type"><span class="hljs-type">name</span></span>} <span class="hljs-type"><span class="hljs-type">name</span></span> does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> exist <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the ${clazz.name} enumeration`); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> enumName(): string { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (this <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).__enumName__; } toString(): string { const clazz = this.constructor <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EnumStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (clazz.__idPropertyName__) { const self = this <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self[clazz.__idPropertyName__]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> this.enumName; } }</code> </pre> </div></div><br>  But tragicomedy was gaining its full speed.  I had TypeScript version 2.6.2 installed on my machine, exactly the version in which there was an invaluable bug.  Invaluable, because not a bug, but a fitch.  A voice from the next room shouted that he was not going to do anything.  Compile error ( <i>transpilation</i> ).  I did not believe my own ears, for I always collect a project before pushing, even if it is a draft.  And the inner voice whispered: it's a fiasco, bro. <br><br>  After a brief trial, I realized that it was the TypeScript version.  It turned out that if the generic name of the class coincided with the name of the generic specified in the static method, then the compiler considered this as one type.  But no matter how it was there, now it is already part of the history of the war for the knowledge of TypeScript. <br><br>  The bottom line: the problem with transfers as it was and has remained.  My sadness ... <br><br>  Note: <i>I can not reproduce this behavior in my own now with 2.6.2, it is possible that the version was mistaken or did not add something in test examples.</i>  <i>And the request for the problem described above has been rejected.</i> <br><br><h2>  3. Casting function </h2><br>  Despite the fact that there was a curved solution, with an explicit indication of the type of the enumeration class in static methods, for example, State.valueOf &lt;State&gt; (), it did not suit anyone and, above all, me.  For a while, I even put aside the fucking transfers and lost confidence that I could solve this problem. <br><br>  Morally recuperating, I searched the Internet for tricks with TypeScript, looked at who was suffering from what, read the documentation on the language again, just in case, and decided, in order not to become, to finish the job.  Seven hours of continuous experiments, not looking at anything, even on coffee, gave their result.  Only one function, consisting of one line of code, put everything in its place. <br><br><pre> <code class="hljs matlab">export <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnumType</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IStaticEnum</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">&gt; { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">return</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&lt;IStaticEnum&lt;T&gt;&gt; Enumerable)</span></span></span><span class="hljs-function">; } //  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IStaticEnum</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">export</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">interface</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IStaticEnum</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">&gt; { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: {</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enumName</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span><span class="hljs-function">}; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">values</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadonlyArray</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">&gt;; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">valueOf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id: string | number)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">valueByName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name: string)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">; }</span></span></code> </pre><br>  And the declaration of a Java-like enumeration itself now looks like this: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Enum, EnumType, IStaticEnum} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "ts-jenum"; @Enum("text") export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> State extends EnumType&lt;State&gt;() { static readonly <span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("New"); static readonly ACTIVE = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("Active"); static readonly BLOCKED = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("Blocked"); private constructor(<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span>: string) { super(); } } //   console.log("" + State.ACTIVE); // Active console.log("" + State.BLOCKED); // Blocked console.log(State.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>()); // [State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span>, State.ACTIVE, State.BLOCKED] console.log(State.valueOf("New")); // State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> console.log(State.valueByName("NEW")); // State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> console.log(State.ACTIVE.enumName); // ACTIVE</code> </pre><br>  Not without a curiosity, with the extra import of IStaticEnum, which is not used anywhere (see the example above).  In the same ill-fated version of TypeScript 2.6.2 you need to specify it explicitly.  The bug on the topic is <a href="https://github.com/Microsoft/TypeScript/issues/15870">here</a> . <br><br><h2>  Total </h2><br>  If you suffer for a long time, something will turn out.  Link to githab with the result of the work done <a href="https://github.com/reforms/ts-jenum">here</a> .  For myself, I discovered that TypeScript is a language with great potential.  There are so many of these possibilities that you can drown in them.  And who does not want to go to the bottom, learns to swim.  If you go back to the topic of transfers, you can see how others work with them: <br><br><ul><li>  <a href="https://github.com/LMFinney/ts-enums">Enum based on two classes</a> </li><li>  <a href="https://github.com/UselessPickles/ts-enum-util">Wrap over transfers out of the box</a> </li></ul><br>  Write about your work, I think the community will be interested.  Thank you all for your patience and interest. </div><p>Source: <a href="https://habr.com/ru/post/420041/">https://habr.com/ru/post/420041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420029/index.html">As we in 1C: Enterprise, we solve systems of algebraic equations</a></li>
<li><a href="../420031/index.html">Drawing with Render Targets in the Unreal Engine</a></li>
<li><a href="../420033/index.html">How we started registering cash desks for our clients</a></li>
<li><a href="../420035/index.html">GUI on Golang: GTK + 3</a></li>
<li><a href="../420037/index.html">Stream with several cameras made from scrap materials</a></li>
<li><a href="../420045/index.html">Bunker for the date: how I was allowed to walk on the data center RUVDS on the territory of the space plant</a></li>
<li><a href="../420049/index.html">The book "The Man Talking. Evolution and language "</a></li>
<li><a href="../420051/index.html">[DotNetBook] Span, Memory and ReadOnlyMemory</a></li>
<li><a href="../420053/index.html">Veeam Academy for C # Developers: New Season</a></li>
<li><a href="../420055/index.html">Theory and practice of backups with Borg</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>