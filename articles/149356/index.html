<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SQLite is a great embedded database (part 1)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I decided to still write an article about SQLite, in which I want to summarize my 3 years experience of using this database under Windows. I see that ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SQLite is a great embedded database (part 1)</h1><div class="post__text post__text-html js-mediator-article">  I decided to still write an article about SQLite, in which I want to summarize my 3 years experience of using this database under Windows.  I see that the topic is popular, but there is little information. <br><br>  <a href="http://habrahabr.ru/post/149390/">Part 2</a> <br>  <a href="http://habrahabr.ru/post/149635/">Part 3</a> <br><br>  A little introductory. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This article is not for novice programmers. <br>  It is not a SQL tutorial. <br>  It does not agitate to use SQLite. <br>  It does not agitate not to use SQLite. <br>  The article is written in the form of questions from a hypothetical novice in SQLite and answers to them (since there is a lot of information and it is at least a little easier to structure it). <br><br><a name="habracut"></a><br><br><h5>  What is SQLite? </h5><br>  SQLite is an embedded cross-platform database that supports a fairly complete set of SQL commands and is available in source codes (in C). <br><br>  SQLite source codes are in the public domain, that is, there are no restrictions on usage at all. <br><br>  Site (with excellent documentation in English): <a href="http://sqlite.org/">http://sqlite.org</a> <br><br>  Current version: 3.7.13 <br><br>  SQLite can be compiled by myself, but I download it already compiled as a Windows DLL. <br><br>  Download page: <a href="http://sqlite.org/download.html">http://sqlite.org/download.html</a> <br><br>  For own assembly usually download so-called.  <a href="http://www.sqlite.org/amalgamation.html">"Amalgamation"</a> , <br>  those.  SQLite sources in a single C + sqlite3.h file. <br><br>  To reduce the size of the SQlite code, throwing out unnecessary nishtyaki, use any DEFINE. <br><br><h5>  How popular is SQLite? </h5><br>  In short: it is everywhere.  At least on any smartphone. <br><br><h5>  How reliable is it? </h5><br>  Highly.  When a version is released, it passes through a series of serious automatic tests (~ 2 million tests are performed), the code covers 100% of tests (since August 2009). <br><br><h5>  What other tools do the developers give? </h5><br>  A console utility for working with databases (sqlite3.exe, ‚Äúa command-line shell for accessing and modifying SQLite databases‚Äù) is available. <br><br><h5>  And all? </h5><br>  Yes, from the main developers - everything.  However, other people write all sorts of managers, etc. <br>  Personally, I have not found the perfect and use the console. <br><br><h5>  What does ‚Äúfairly complete set of SQL‚Äù mean? </h5><br>  As you know, in its development SQL rushed in different directions.  Large manufacturers began to cram all sorts of extensions.  And although all standards are accepted (SQL 92), in real life all large databases do not support standards completely + have something of their own.  So, SQLite tries to live by the principle of ‚Äúminimal but complete set‚Äù.  It does not support complex things, but largely corresponds to SQL 92. <br>  And introduces some of its features that are very convenient, but - not standard. <br><br><h5>  What exactly in SQL support may cause confusion? </h5><br>  You cannot delete or change a column in a table (ALTER TABLE DROP COLUMN ..., ALTER TABLE ALTER COLUMN ...). <br>  There are triggers, but not as powerful as those of large RDBMS. <br>  There is support for foreign key, but by default it is DISABLED. <br>  There is no built-in support for UNICODE (but, in general, it is not difficult to achieve). <br>  No stored procedures. <br><br><h5>  What is your good or unusual? </h5><br>  a) each record contains a virtual column rowid, which is equal to a 64-bit number (unique for the table). <br>  You can declare your INTEGER PRIMARY KEY column and then this column will become rowid (with its name, the name rowid still works). <br>  When inserting a record, you can specify a rowid, or you can - do not specify (and the system will then insert a unique one). <br>  Details: <a href="http://www.sqlite.org/autoinc.html">www.sqlite.org/autoinc.html</a> <br>  b) you can easily organize a database in memory (this is very convenient and I will tell you more later); <br>  c) easy to transfer: by default, the database is one file (in a cross-platform format); <br>  d) the type of the column does not determine the type of the stored value in this field of the record, that is, any value can be entered in any column; <br>  e) many built-in functions (which can be used in SQL): <a href="http://www.sqlite.org/lang_corefunc.html%3B">www.sqlite.org/lang_corefunc.html;</a> <br><br><h5>  I do not understand - what's up with the type?  Why do we need a column type then at all? </h5><br>  The type of a column determines how to compare values ‚Äã‚Äã(you need to reduce them to a single type when comparing, say, within an index). <br>  But it does not oblige to enter values ‚Äã‚Äãof this type in the column.  Something like weak typing. <br><br>  Suppose we declared a column as "A INTEGER". <br>  SQlite allows you to add values ‚Äã‚Äãof any type to this column (999, ‚Äúabc‚Äù, ‚Äú123‚Äù, 678.525). <br>  If the inserted value is not an integer, then SQlite tries to bring it to the whole. <br>  Those.  the string ‚Äú123‚Äù turns into a whole 123, and the remaining values ‚Äã‚Äãare written ‚Äúas is‚Äù. <br><br><h5>  So it is possible not to set column type at all? </h5><br>  Very often this is done: <i>CREATE TABLE foo (a, b, c, d)</i> . <br><br><h5>  What about architecture?  There is no server? </h5><br>  There is no server, the application itself is a server.  Access to the database occurs via the ‚Äúconnections‚Äù to the database (something like the OS file handle), which we open by calling the corresponding DLL function.  When opening, the name of the database file is indicated.  If there is no such thing, it is automatically created. <br>  It is permissible to open multiple connections to the same database (via the file name) in the same or different applications. <br>  The system uses file-level locking mechanisms for the OS to make it all work. <br>  (these mechanisms usually do not work well on network drives, so it is not recommended to use SQlite with a file on the network). <br>  Initially, SQlite worked on the principle of "many read - one writes." <br>  That is, only one connection writes to the database at a given time.  If other connections try to write too, they get the error SQLITE_BUSY. <br>  You can, however, enter a timeout of operations.  Then the connection, faced with the employment of the database, will wait N seconds before falling off with an SQLITE_BUSY error. <br><br><h5>  And how to be? </h5><br>  Either one connection and all queries through it, or proceed from a possible timeout and provide for repeating the execution of SQL. <br>  There is one more possibility: not so long ago a new kind of SQlite log appeared: Write Ahead Log, <a href="http://www.sqlite.org/draft/wal.html">WAL</a> . <br>  If you enable this particular log mode for the database, then several connections will be able to simultaneously modify the database. <br>  But in this mode, the database already takes several files. <br><br><h5>  Well now it is clear why SQLite is terrible, because it does not have a GLOBAL CASH? </h5><br>  Indeed, all modern RDBMS are unthinkable without a global shared cache, which can store all sorts of nishtyaki like compiled parameterized queries.  This is a busy server, which is not here.  However, within a single application, SQlite can share the cache between multiple connections (read here: <a href="http://www.sqlite.org/sharedcache.html">www.sqlite.org/sharedcache.html</a> ) and save some memory. <br><br><h5>  And why does everyone complain that SQLite slows down? </h5><br>  Two reasons.  The first is the default settings.  They work for reliability, not performance. <br>  The second is a lack of understanding of the mechanism for fixing transactions.  By default, after any SQlite command, it will commit the transaction (that is, wait until the database is in a consistent state to turn off the power).  Depending on the paranoia mode, SQLite will spend from 50 to 300 ms on it (waiting for the data to be written to disk to finish). <br><br><h5>  What to do?  I need to insert 100 thousand records and quickly! </h5><br>  Delete indexes, turn on OFF (or NORMAL) synchronization mode, insert in portions of N thousands (N - pick up, first take 5000).  Before inserting portions make BEGIN TRANSACTION, after - COMMIT. <br><br><h5>  But I found a mistake!  How to report? </h5><br>  No <br><br>  The fact is that the popularity of SQLite is terrible - it is everywhere.  It is not joke. <br>  And the developers were faced with a shaft of error messages that were either caused by misunderstanding, or were hidden feature request.  They, in fact, closed the direct reception of reports with errors. <br>  So you should subscribe to the mailing list and describe the problem there and hope for the best. <br><br>  Personally, I had a situation that I interpreted as a SQLIte defect.  I described this in the mailing list.  In the next version, the SQLite behavior was fixed. <br><br>  <a href="http://sqlitedog.com/">A handy utility</a> to play around with SQLite. <br><br>  <i>To be continued.</i> </div><p>Source: <a href="https://habr.com/ru/post/149356/">https://habr.com/ru/post/149356/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149349/index.html">About jQuery and bicycles - my addition</a></li>
<li><a href="../149350/index.html">Interactive 3D tour of Versailles from Google</a></li>
<li><a href="../149351/index.html">Steam or Windows Store. Or why I choose Steam for now.</a></li>
<li><a href="../149352/index.html">Learn English</a></li>
<li><a href="../149354/index.html">The program "taught" to determine the city by architecture</a></li>
<li><a href="../149357/index.html">Web2py framework</a></li>
<li><a href="../149359/index.html">It happens - the most unusual application of Ivideon</a></li>
<li><a href="../149360/index.html">Freelance as a means of earning. Part 3 A bit of theory</a></li>
<li><a href="../149362/index.html">National Computer Museum in Blechley Park</a></li>
<li><a href="../149365/index.html">Programming in Android - why is it so difficult?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>