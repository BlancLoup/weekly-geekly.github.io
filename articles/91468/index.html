<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We attach Flex-components to the project on a clean Actionscript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 This article is intended more for beginners who have just begun to create FlashPlayer applications using only free development tools, a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We attach Flex-components to the project on a clean Actionscript</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  This article is intended more for beginners who have just begun to create FlashPlayer applications using only free development tools, and can be considered as a mini-tutorial on this topic, telling about my personal rake, which I sincerely wish not to step on the same way as I mastering programming in ActionScript. <br><br>  As an example, <s>HelloWorld</s> will be used rather simple project, written in pure ActionScript 3.0 without using commercial development tools from Adobe. <br>  I develop FlashPlayer applications using <a href="http://flashdevelop.org/">FlashDevelop</a> on Windows, and vim (less convenient, but cheap and cheerful) on GNU / Linux. <br><a name="habracut"></a><br>  Naturally, flex3 sdk is needed both there and there, which contains mxmlc - a compiler that accepts * .mxml (flex-layout) or * .as (actionscript) as input - and creates a swf file - an application for FlashPlayer 9/10 (the version is configured in the compiler configuration) output.  The latter is a bytecode executed by the FlashPlayer or Adobe AIR virtual machine. <br><br><h4>  Task </h4><br>  As promised, consider a simple example. <br>  So suppose we conceived to write an interactive flash application that should allow the user to draw colored rectangles, drag them and set their color (see the figure). <br><img src="http://xmages.net/upload/2c2927d2.png" alt="image"><br>  The color change is the second part of the task, and since the bar for entry into ActionScript3 is extremely low, we sit down and within the hour (or a couple of hours maximum) we code the first part, i.e.  drawing and dragging rectangles.  The result comes down to two classes: RectContainer and Rect.  In the code, you can look at the simplest examples of implementing event handling, drawing graphics, dragging objects.  The main file is RectContainer.as - it should be pushed into the mxmlc compiler or marked as Always Compile in the project tree in the FlashDevelop IDE. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  RectContainer.as: </h6><br> <code>package { <br> import flash.events.*; <br> import flash.display.*; <br> public class RectContainer extends Sprite { <br> private var currentRect:Rect; <br> public var isDragging:Boolean; <br> <br> public function RectContainer() { <br> stage.addEventListener(MouseEvent.MOUSE_MOVE,onMouseMove); <br> stage.addEventListener(MouseEvent.MOUSE_DOWN, onMouseDown); <br> stage.addEventListener(MouseEvent.MOUSE_UP,onMouseUp); <br> stage.scaleMode = StageScaleMode.NO_SCALE; <br> stage.addChild(this); <br> } <br> <br> private function onMouseDown(evt:MouseEvent):void { <br> if (!isDragging) { <br> currentRect = new Rect(); <br> currentRect.container = this; <br> currentRect.x = evt.stageX; <br> currentRect.y = evt.stageY; <br> addChild(currentRect); <br> } <br> } <br> <br> private function onMouseUp(evt:MouseEvent):void { <br> if (null != currentRect) { <br> currentRect = null; <br> } <br> } <br> <br> private function onMouseMove(evt:MouseEvent):void { <br> if (evt.buttonDown &amp;&amp; !isDragging) { <br> var dX:Number = evt.stageX - currentRect.x; <br> var dY:Number = evt.stageY - currentRect.y; <br> if (dX&gt;0 &amp;&amp; dY&gt;0) <br> currentRect.draw(dX,dY); <br> } <br> } <br> <br> } <br> } <br></code> <br><br><h6>  Rect.as: </h6><br> <code>package { <br> import flash.events.*; <br> import flash.display.*; <br> public class Rect extends Sprite { <br> public var color:uint = 0xff00ff; <br> public var container:RectContainer; <br> <br> public function Rect() { <br> addEventListener(MouseEvent.MOUSE_MOVE,onMouseMove); <br> addEventListener(MouseEvent.MOUSE_UP,onMouseUp); <br> addEventListener(MouseEvent.MOUSE_DOWN,onMouseDown); <br> } <br> <br> public function draw(width:int,height:int):void { <br> graphics.clear(); <br> graphics.lineStyle(1); <br> graphics.beginFill(color); <br> graphics.drawRect(0,0,width,height); <br> graphics.endFill(); <br> } <br> <br> private function onMouseMove(evt:MouseEvent):void { <br> <br> } <br> <br> private function onMouseUp(evt:MouseEvent):void { <br> this.stopDrag(); <br> container.isDragging = false; <br> } <br> <br> private function onMouseDown(evt:MouseEvent):void { <br> container.isDragging = true; <br> this.startDrag(); <br> } <br> } <br> } <br></code> <br><br>  The more difficult part of the task is to make the choice of color possible.  Naturally you need a small component, allowing the user to interactively choose a color.  After a brief googling, it becomes clear that it‚Äôs not so easy for us to download a light, simple and free ColorPicker, but we know that there is a Flex framework containing, among other things, what we need - a component of ColorPicker.  The task is seemingly simple: screw the ColorPicker to our project. <br><br><h4>  Search solutions </h4><br><h5>  1. Solution to the forehead </h5><br>  Immediately try the obvious way: we try to create an instance of this component directly in the Rect constructor. <br><br> <code>import mx.controls.ColorPicker; <br> ... <br> var colorPicker:ColorPicker = new ColorPicker(); <br> addChild(colorPicker); <br></code> <br><br>  and when creating the next rectangle, contrary to expectations, there is no visual indication of the appearance of the color-picker. <br>  After a hard googling, it becomes clear that the standard use case for Flex components is static positioning in an interactive form that contains other Flex components and is expressed by mxml markup.  This way of solution does not suit us, since  we even do not want to see any static mxml form in the project. <br><br><h5>  2. It took another half an hour googling </h5><br>  It was naturally initially clear that each tag describing an instance of a Flex component in mxml corresponds to a certain class in the Flex framework, but it‚Äôs just not clear how to use them in pure ActionScript.  Adobe <a href="http://cookbooks.adobe.com/index.cfm%3Fevent%3Dshowdetails%26postId%3D11123">states</a> only that this is certainly possible, but it doesn‚Äôt explain, because  apparently it is not commercially profitable, why then Flex Builder, etc.?  There are also bloggers who have <a href="http://filt3r.free.fr/index.php/2007/08/11/28-using-flex-3-component-without-mxml-only-as3">thought</a> closely <a href="http://filt3r.free.fr/index.php/2007/08/11/28-using-flex-3-component-without-mxml-only-as3">about</a> this issue and even created a few <a href="http://ersatz.tv/2009/off-topic-flex-components-without-mxml">examples</a> using Flex-like button components, which I honestly couldn‚Äôt use for the color picker. <br><br><h5>  3. And the casket just opened </h5><br>  So in Google-Despair, I came across somewhere (sorry, I lost this link, but I think the technique is common and is quoted in many sources), creating an mx: Application container using the simplest mxml and then dynamically creating objects inside this container using the ActionScript class hung on the applicationComplete event. <br><br>  Looking at the class hierarchy for <a href="http://livedocs.adobe.com/flex/3/langref/mx/core/UIComponent.html">mx.core.UIComponent,</a> it becomes clear that they inherit from flash.display.Sprite and overload the addChild method, and our ‚Äúsolution to the forehead‚Äù becomes obvious at once ‚Äî for how you can add the Flex component ColorPicker by child of a simple Sprite, not a UIComponent, which is higher in the inheritance hierarchy.  So, the solution (see the code below) is to create the simplest FlexContainer.mxml file, which we, by the way, will now add to the mxml compiler.  FlexMain.main () is a method that adds to our container an instance of the RectContainer class, which, like Rect, is now inherited from the UIComponent, and not from Sprite, and accordingly the stage object in the RectContainer constructor is taken directly from the Application instance. application.  Now ColorPicker is added as a native to our rectangles and moves along with them with a bang. <br><br><h6>  FlexContainer.mxml: </h6><br> <code>&lt;?xml version="1.0" encoding="utf-8"?&gt; <br> &lt;mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" <br> layout="absolute" applicationComplete="FlexMain.main()"&gt; <br> &lt;/mx:Application&gt; <br></code> <br><br><h6>  FlexMain.as: </h6><br> <code>package { <br> import mx.controls.*; <br> import mx.core.*; <br> public class FlexMain { <br> public static function main ():void { <br> Application.application.addChild(new RectContainer()); <br> } <br> } <br> } <br></code> <br><br><h6>  RectContainer.as: </h6><br> <code>package { <br> import flash.events.*; <br> import flash.display.*; <br> import mx.core.Application; <br> import mx.core.UIComponent; <br> public class RectContainer extends UIComponent { <br> private var currentRect:Rect; <br> public var isDragging:Boolean; <br> <br> public function RectContainer() { <br> var stage:Stage = Application.application.stage; <br> stage.addEventListener(MouseEvent.MOUSE_MOVE,onMouseMove); <br> stage.addEventListener(MouseEvent.MOUSE_DOWN, onMouseDown); <br> stage.addEventListener(MouseEvent.MOUSE_UP,onMouseUp); <br> stage.scaleMode = StageScaleMode.NO_SCALE; <br> stage.addChild(this); <br> } <br> //        RectContainer.as <br></code> <br><br><h6>  Rect.as: </h6><br> <code>package { <br> import flash.events.*; <br> import flash.display.*; <br> import mx.core.UIComponent; <br> import mx.controls.ColorPicker; <br> import mx.events.ColorPickerEvent; <br> <br> public class Rect extends UIComponent { <br> public var color:uint = 0xff00ff; <br> public var container:RectContainer; <br> public var colorPicker:ColorPicker = new ColorPicker(); <br> public var _width:Number; <br> public var _height:Number; <br> <br> public function Rect() { <br> addEventListener(MouseEvent.MOUSE_MOVE,onMouseMove); <br> addEventListener(MouseEvent.MOUSE_UP,onMouseUp); <br> addEventListener(MouseEvent.MOUSE_DOWN,onMouseDown); <br> colorPicker.visible = false; <br> colorPicker.x = 0; <br> colorPicker.y = 0; <br> colorPicker.selectedColor = color; <br> addChild(colorPicker); <br> colorPicker.addEventListener(ColorPickerEvent.CHANGE,onColorChanged); <br> } <br> <br> public function draw(width:int,height:int):void { <br> _width = width; <br> _height = height; <br> graphics.clear(); <br> graphics.lineStyle(1); <br> graphics.beginFill(color); <br> graphics.drawRect(0,0,_width,_height); <br> graphics.endFill(); <br> const minSize:Number = 15; <br> if (width&gt;minSize &amp;&amp; height &gt; minSize) { <br> colorPicker.visible = true; <br> colorPicker.setActualSize(minSize,minSize); <br> } <br> } <br> <br> private function onMouseMove(evt:MouseEvent):void { <br> <br> } <br> <br> private function onMouseUp(evt:MouseEvent):void { <br> this.stopDrag(); <br> container.isDragging = false; <br> } <br> <br> private function onMouseDown(evt:MouseEvent):void { <br> container.isDragging = true; <br> this.startDrag(); <br> } <br> <br> private function onColorChanged(evt:ColorPickerEvent):void { <br> color = evt.color; <br> draw(_width,_height); <br> } <br> } <br> } <br></code> <br><br>  All code and compiled applications can be downloaded <a href="http://openfile.ru/576964/">here</a> : <br><br>  Thanks for reading, I hope the article was helpful. </div><p>Source: <a href="https://habr.com/ru/post/91468/">https://habr.com/ru/post/91468/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../91461/index.html">Overview of the server cabinet and CSV enclosure</a></li>
<li><a href="../91462/index.html">Xbox 360 Modding</a></li>
<li><a href="../91464/index.html">Trouble with SQL Server Express 2008 on VPS</a></li>
<li><a href="../91465/index.html">How SkyLink tried to take all my money and how I managed to get every penny</a></li>
<li><a href="../91466/index.html">100% Uptime, 24/7 Support, Unmetered Gigabit, ‚Äúhelp us abroad‚Äù or not to get caught as a startup</a></li>
<li><a href="../91471/index.html">We write functional / integration tests for the project on django</a></li>
<li><a href="../91472/index.html">MonoMac - Mono Project for MacOSX</a></li>
<li><a href="../91473/index.html">Installing jira on ubuntu</a></li>
<li><a href="../91474/index.html">Summary on Habr√©</a></li>
<li><a href="../91475/index.html">seedJS - CommonJS Package Manager</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>