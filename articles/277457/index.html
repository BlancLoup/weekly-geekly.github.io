<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We test the layout correctly</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is wrong with the layout testing 
 We often neglect it. Writing functional, integration and unit tests has long been a common practice. Layout, w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We test the layout correctly</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/4e1/fdd/5a7/4e1fdd5a7c4f432aac1ce57747a15160.png" alt="Makeup - a tool for comfortable manual regression testing of typesetting."><br><h3>  What is wrong with the layout testing </h3><br>  We often neglect it.  Writing functional, integration and unit tests has long been a common practice.  Layout, we usually spend much less time. <br><br>  The problem of testing the layout is that only a living person can say whether the block is well laid out on the page or not.  Therefore, most often we test HTML and CSS manually: check how the block will behave if there is too much (or too little) text or child elements in it;  We look so that all possible options for displaying the block look correct;  Remember how blocks must adapt to different devices and screen resolutions. <br><a name="habracut"></a><br><h3>  How to test the layout correctly </h3><br>  We do not need to invent anything new.  We can apply the same approaches that we use when writing autotests. <br><br>  First you need to look at the design requirements.  Based on this, make a list of all <i>significant</i> application <i>states</i> that need to be checked.  Next, the case is small - check each test case. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the article I will tell you how we created <a href="https://github.com/chaptykov/makeup">Makeup</a> for ourselves, how we changed our interface development process and how it simplified our life. <br><br>  Makeup is a graphical interface for quick and comfortable <i>manual</i> regression testing of typesetting based on the BEM methodology.  This is a tool for which we are preparing test data so that you can initialize any independent block with different data and quickly see it in all states of interest. <br><br>  The described approach can help if your project complies with 2 conditions: <br><br><ul><li>  You have reference designs for all blocks, and you want your project to exactly match this design; </li><li>  You follow the BEM methodology in HTML and CSS. </li></ul><br>  And now about everything in order. <br><br><h3>  How to measure the quality of the layout </h3><br>  The first version of Makeup (then it had no name yet) appeared in the file spec / index.html.  On this page, unit tests were run for all modules (read: blocks) of our application.  Everything was traditional: we initialized each module with different sets of test data and tested what we were interested in with tests. <br><br>  But this was not enough.  Despite the fact that these tests were strongly related to the layout, they could not answer the question of whether the module was well laid out and whether it would behave correctly in different circumstances. <br><br>  In the network you can find a huge number of check-lists on the quality of the layout.  Testing of many points from them can be easily entrusted to code analyzers.  But usually these checklists check the quality of work for indirect or irrelevant signs. <br><br>  By and large, there are only two quality criteria for the layout: <br><br><ul><li>  <b>matching layout:</b> layout should be identical to the design. </li><li>  <b>performance: the</b> layout should be displayed in the user's browser on all devices that interest us. </li></ul><br>  If either of the two points is not followed, the work done does not make any sense. <br><br><h3>  How to check compliance with the layout </h3><br>  Compare the layout with the original layout and find the differences.  But it is sometimes not so easy.  Remember, in children's magazines there were puzzles ‚Äúfind 10 differences‚Äù? <br><br><img src="https://habrastorage.org/files/5de/775/352/5de7753525af4e349426d9e4c0179833.png"><br><br>  Any engineer will instantly offer the obvious solution, how easy it is to find differences.  It is enough to superimpose one image on another and make the top image translucent. <br><br>  You can make it even more convenient - invert the colors for the upper translucent image.  Then, with a perfect match, we should see a uniform gray background. <br><br><img src="https://habrastorage.org/files/169/8da/ace/1698daaceb714d2ab6f3d42229e93fd0.png"><br><br><h3>  Why for this special tool </h3><br>  For the implementation of such ideas do not need a special tool.  If you want to compare the layout with the original design of the site page, then this approach can be implemented directly in the browser. <br><br><h4>  1. Add a picture with the layout </h4><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"index.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1280"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"psd"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h4>  2. Position on top of the page </h4><br><pre> <code class="css hljs"><span class="hljs-selector-id"><span class="hljs-selector-id">#psd</span></span> { <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: absolute; <span class="hljs-attribute"><span class="hljs-attribute">top</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">left</span></span>: <span class="hljs-number"><span class="hljs-number">50%</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> -<span class="hljs-number"><span class="hljs-number">640px</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> <span class="hljs-attribute"><span class="hljs-attribute">opacity</span></span>: .<span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> <span class="hljs-attribute"><span class="hljs-attribute">pointer-events</span></span>: none; <span class="hljs-comment"><span class="hljs-comment">/*      -webkit (-blink)  */</span></span> <span class="hljs-attribute"><span class="hljs-attribute">-webkit-filter</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">invert</span></span>(100%); } <span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:hover</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#psd</span></span> { <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> <span class="hljs-attribute"><span class="hljs-attribute">opacity</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre><br>  This principle works a huge number of existing tools: <br><br><ul><li>  Javascript plugins <br><ul><li>  Resemble.js </li></ul></li><li>  Browser Extensions <br><ul><li>  PerfectPixel </li><li>  1px </li></ul></li></ul><br>  If you wish, you will find a few dozen or hundreds of such tools. <br><br><h3>  What's the problem </h3><br>  This approach is applicable only in the case when, when developing, we can build an unambiguous correspondence between the layouts and the layout pages. <br><br><img src="https://habrastorage.org/files/dc5/4f7/477/dc54f7477ee3401db49de8d503c23a42.jpg"><br>  In fact, we are increasingly working with complex web applications.  And usually we do not use the term "page".  In terms familiar to us, a web application in terms of layout consists of an arbitrary set of BEM blocks and their states. <br><br><img src="https://habrastorage.org/files/b63/205/bbd/b63205bbddf44b63835aeffcd5efd31e.jpg"><br><br>  The state of a block is its final display with a certain set of elements, modifiers and with a certain content.  In other words, each block state is one case of its use. <br><br>  In practice, this means that if, for example, you have only 100 independent blocks on a project, and only 10 significant use cases are provided for each of them, then you will have to remember about 1000 unique states of your application. <br><br>  You can break the layout into smaller blocks, reducing the number of states in each, but the order of the number is unlikely to change much. <br><br>  1000 states is a lot.  No man can keep it all in his head.  And even more so to be confident in the quality of the layout of each block. <br><br><h3>  Like i did before </h3><br>  Earlier, when developing complex blocks with a large number of states, I used an incredibly slow way to compare the layout of a separate block with a design. <br><br><ul><li>  <b>‚åò + Shift + Control + 4</b> select the area of ‚Äã‚Äãthe page with the block, take a screenshot to the clipboard </li><li>  <b>‚åò + Tab</b> move to the next tab with Photoshop </li><li>  <b>‚åò + v</b> insert a screenshot </li><li>  <b>‚åò + 5</b> set the layer transparency 50% </li><li>  <b>v</b> choose the tool Move Tool </li><li>  <b>Shift + Arr</b> or <b>Arr √ó n we</b> push apart until it is not compatible with the layout </li><li>  <b>Delete</b> </li></ul><br>  After that, edit the CSS and repeat the entire sequence again.  Until the layout is perfect. <br><br>  This sequence can be learned to perform really fast, but the process will still take an enormous amount of time.  But such an approach will never give confidence in regression or refactoring.  Yes, and do not want to engage in such nonsense. <br><br><h3>  How we made another tool </h3><br>  We did not find a tool that would allow us at any time ... <br><br><ul><li>  be able to quickly and comfortably check the compliance of the block with the original design layouts and product requirements; </li><li>  to be sure that all significant use cases of the block work correctly; </li><li>  when making changes to the unit, simply and quickly check that all previous usage cases are not broken; </li><li>  conduct regression testing of layout; </li><li>  have an overview map of the project in terms of layout. </li></ul><br>  Therefore, we decided to make Makeup for ourselves. <br><br>  First, we added a comparison with the design on the page with unit tests.  Then we added a pair of sliders to control the display of the blocks.  And over time, all this developed into a separate interface, which became the basis of the workflow of developing interfaces in our team. <br><br><img src="https://habrastorage.org/files/4e1/fdd/5a7/4e1fdd5a7c4f432aac1ce57747a15160.png"><br>  In this illustration, almost all the features of Makeup.  This is an incredibly simple tool. <br><br><h3>  What you need to implement </h3><br><ul><li>  <b>Resources of your application:</b> templates (or just HTML), styles, JavaScript code, graphics - everything that is in the layout. </li><li>  <b>Images with the original design of the</b> blocks in different states. </li><li>  <b>A configuration file</b> that will show ‚ÄúMakeup‚Äù, in which way all of the above can be linked together. </li></ul><br><img src="https://habrastorage.org/files/808/324/d00/808324d007ed43cc9d4ba97ac9cdb19b.jpg"><br><br>  You can decide that writing and maintaining current configuration files is an unthinkable task.  When developing an application, we want to spend a minimal effort on describing the block structure, to have a tool that will help keep the entire layout under control.  In order to solve this problem, it is necessary to closely integrate this approach with the assembly of your application. <br><br>  Our team almost automatically collects the configuration based on the available test data.  Manually it remains to add only the ‚Äúpatches‚Äù of styles, snippets and links to documentation.  At the application assembly stage, all the necessary configuration files are generated and a separate port is created on which Makeup is running. <br><img src="https://habrastorage.org/files/4ba/a09/757/4baa09757dba4bcd892556acdae16db3.jpg"><br><br><h3>  How can I use </h3><br>  In our team, Makeup is the foundation for developing an application interface.  We actively use it at all stages of the life of the block. <br><br><ol><li>  <b>Development.</b>  When developing a block from scratch, you need an initial design, product requirements and an isolated development environment.  Conveniently, when it is at hand in one interface. </li><li>  <b>Code Review.</b>  When you look at someone else's work, you need to quickly see the list of changes;  Verify results with product requirements and design;  check the operation of all cases of use of the block. </li><li>  <b>Refactoring.</b>  When refactoring an existing block, you need to quickly see the whole block and all its possible states.  Sometimes there are many conditions, and some of them are not at all obvious.  After making changes, it is important to check that nothing is broken. </li></ol><br>  At the same time, you need to be aware that you can rely on the tool only if the test cases described by us provide sufficient coverage.  This is where the same principles work as when writing tests. <br><br>  If you add all the necessary test cases in a timely manner and use Makeup at all stages of development, you can sleep peacefully - your layout will not bring you any unexpected trouble. <br><br><h3>  How to pick up test cases </h3><br>  At the beginning of the article I used the term ‚Äúsignificant states‚Äù.  It's time to talk about how we choose meaningful cases in our work and how we are trying to provide good coverage for the layout. <br><br>  We concluded that it is enough to fix 3 types of states. <br><br><ul><li>  <b>States described in the design.</b> <br>  If the designer prepared a layout in which he drew a block in 4 different states, we need to describe all these states for Makeup. </li><li>  <b>States that caused a bug in the past</b> <br>  If the project has a bug related to the layout, it is not enough just to fix it.  It is considered a good form to write a test for this bug.  In this case, we also save a case in which the bug was reproduced in Makeup.  Then, when refactoring a block, when the developer checks all the states of the block, he can be sure that this bug is not reproduced. </li><li>  <b>Extreme states</b> <br>  Extreme states we call those in which the layout most often breaks: long texts (which may still not contain spaces), the absence of elements in the block and others. </li></ul><br><h3>  Can we stop testing the layout with our hands </h3><br>  If it is important for us to exactly match the original design, unfortunately, no.  But we can make the testing of the layout comfortable, fast and reliable. <br><br>  Therefore, we have made for ourselves a simple and convenient tool.  By and large, it simply displays the data that we ourselves save in the configuration files of the blocks.  But despite the seeming simplicity, for our team, Makeup has become the basis of the interface development workflow.  With it, we always know about the state of health of the project and can at any time see the full picture of the project from the point of view of layout. <br><br>  How do you test your layout? <br><br><h4>  Links </h4><br><ul><li>  <a href="https://github.com/chaptykov/makeup">Repository</a> </li><li>  <a href="http://2gis.github.io/makeup">Site</a> </li><li>  <a href="http://2gis.github.io/makeup/demo/">Demo</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/277457/">https://habr.com/ru/post/277457/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277447/index.html">We return ICQ to life (ICQ). Designer's opinion</a></li>
<li><a href="../277449/index.html">Web file manager Sprut.IO in OpenSource</a></li>
<li><a href="../277451/index.html">Dynamic data binding in HTML and JS</a></li>
<li><a href="../277453/index.html">Neon: Node + Rust</a></li>
<li><a href="../277455/index.html">How is the "compatibility" of financial transactions on rough IT-examples</a></li>
<li><a href="../277459/index.html">Automating stock purchases: large transaction processing architecture</a></li>
<li><a href="../277461/index.html">Traits out of the box</a></li>
<li><a href="../277463/index.html">Xeon Phi: Why do coprocessors use to create trading applications</a></li>
<li><a href="../277465/index.html">Initialized controllers in symfony and working with annotations</a></li>
<li><a href="../277467/index.html">The new locker "Locky"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>