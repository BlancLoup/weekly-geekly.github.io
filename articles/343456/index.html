<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Setting up Sublime Text 3, SW4 and STM32CubeMX for developing STM32 for Linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are a lot of similar articles on the Internet, but I would like to write a current variation. Personally, I suffered for a long time in a bundle...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Setting up Sublime Text 3, SW4 and STM32CubeMX for developing STM32 for Linux</h1><div class="post__text post__text-html js-mediator-article"><p>  There are a lot of similar articles on the Internet, but I would like to write a current variation.  Personally, I suffered for a long time in a bundle: Ubuntu is the main system, development under STM32 in the Windows 7 virtual machine. But one day I was very tired and I decided to spend several days searching for a solution and licking a complete environment for Linux Ubuntu.  I‚Äôll run ahead and say that I haven‚Äôt achieved the ideal, I couldn‚Äôt manage to make a realtime debug like in Keil.  Otherwise, everything is very decent. </p><br><p>  Attention, a lot of text and pictures! </p><a name="habracut"></a><br><p>  What I ended up with: </p><br><ul><li>  Sublime Text 3 with autocompletions and highlighting of all functions, including HAL and other project libraries; </li><li>  AC6 System Workbench for STM32 with customized perspectives and other goodies; </li><li>  Of course I use version control in Git. </li></ul><br><p>  Steps to complete: </p><br><ul><li>  Add required PPAs to apt; </li><li>  Install the necessary libraries; </li><li>  Install software; </li><li>  Make edits to configuration files; </li><li>  Finish all sorts of buns in the form of beautiful icons, search from the menu, etc. </li></ul><br><p>  The instructions are given for an absolutely clean machine based on Ubuntu 16.04, in your case some components may already be installed.  In this article and in the subsequent I will give examples for the debug board <a href="http://www.st.com/en/evaluation-tools/stm32f3discovery.html">STM32F3DISCOVERY</a> .  It is based on the MK STM32F303VCT6 with 256-Kbyte Flash and 48-Kbyte RAM in the LQFP100 package.  You can adapt the settings to your MK very easily thanks to STM32CubeMX. </p><br><blockquote>  Everything is indicated to the user named <strong>bulkin</strong> , do not forget to change it when setting up. </blockquote><br><h2 id="predvaritelno-ustanavlivaem-neobhodimyy-soft">  Pre-install the necessary software </h2><br><pre><code class="bash hljs">sudo apt install git clang cmake python-pip sudo pip install --upgrade pip</code> </pre> <br><h4 id="sozdadim-nuzhnye-direktorii-dlya-ustanovki-programm-i-hraneniya-bibliotek">  Create the necessary directories for installing programs and storing libraries. </h4><br><p>  I prefer to install non-PPA programs in a separate folder in the <strong>~ / Programs</strong> home directory.  First, I install with local user rights.  Secondly, the folder is named in English, because  Some programs do not like the Cyrillic alphabet on the way. <br>  Libraries I prefer to store in <strong>/ opt / libs</strong> . </p><br><div class="spoiler">  <b class="spoiler_title">Why to / opt?</b> <div class="spoiler_text"><p>  Yes, <em>/ opt</em> is OPTIONAL APPLICATIONS.  But I have a separate partition with btrfs with compression mounted on <em>/ opt</em> .  On all my machines, I configured the paths to my libraries in <em>/ opt / libs</em> .  Fool around and do everything according to the canons (use <em>/ usr / local / lib</em> and <em>/ usr / local / share</em> ) I see no reason, it is easy to get confused. </p></div></div><br><pre> <code class="bash hljs">mkdir ~/Programs sudo mkdir /opt/libs sudo chown bulkin:bulkin /opt/libs</code> </pre> <br><h4 id="dlya-stm32cubemx-i-eclipse-nam-ponadobyatsya">  For STM32CubeMX and Eclipse, we will need: </h4><br><ul><li>  Since  STM32CubeMX 32-bit application, you need the necessary libraries, if you have a 64-bit OS. </li><li>  Java Run Time Environment (we will use OpenJRE 8). </li></ul><br><h3 id="ustanavlivaem-32-bitnye-biblioteki">  Installing 32-bit libraries </h3><br><pre> <code class="bash hljs">sudo apt install lib32ncurses5</code> </pre> <br><h3 id="ustanavlivaem-open-jdk-8-jre">  Install the Open JDK 8 JRE </h3><br><pre> <code class="bash hljs">sudo apt install default-jre</code> </pre> <br><h3 id="ustanavlivaem-stm32cubemx">  Install STM32CubeMX </h3><br><p>  We act according to the <a href="http://www.st.com/content/ccc/resource/technical/document/user_manual/10/c5/1a/43/3a/70/43/7d/DM00104712.pdf/files/DM00104712.pdf/jcr:content/translations/en.DM00104712.pdf">instructions of the ST</a> . </p><br><p>  Download the <a href="http://www.st.com/en/development-tools/stm32cubemx.html">distribution</a> from the site ST (registration is required), unzip and run the file with the <em>.linux</em> extension.  If the installer does not start, most likely the 32-bit libraries are not installed.  The installation path is changed to <strong>/ home / bulkin / Programs / STM32CubeMX</strong> , set. </p><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/p9/vz/fy/p9vzfydu7cvhvk1miffounrf7si.png"></p></div></div><br><h4 id="sozdadim-krasivyy-yarlyk-i-dobavim-poisk-v-dash">  Create a beautiful label and add a search in Dash </h4><br><pre> <code class="bash hljs">touch ~/.<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/share/applications/CubeMX.desktop chmod ug+x ~/.<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/share/applications/CubeMX.desktop nano ~/.<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/share/applications/CubeMX.desktop</code> </pre> <br><p>  Insert the following content: </p><br><pre> <code class="hljs pgsql">[Desktop Entry] Version=<span class="hljs-number"><span class="hljs-number">1.0</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>=CubeMX <span class="hljs-keyword"><span class="hljs-keyword">Comment</span></span>=STM32 CubeMX Exec=/home/bulkin/Programs/STM32CubeMX/STM32CubeMX Icon=/home/bulkin/Programs/STM32CubeMX/help/STM32CubeMX.ico Terminal=<span class="hljs-keyword"><span class="hljs-keyword">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>=Application Categories=Utility;Application;</code> </pre> <br><p>  Now in dash, the icon will appear in the Applications section, the dash search will work after re-logging. </p><br><p>  Run STM32CubeMX, go to <strong>Help-&gt; Updater Settings</strong> settings and change the path for storing libraries to <em>/ opt / libs / STM32Cube / Repository /</em> </p><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/re/i8/lo/rei8loxxxqixijh_jn8sw8o_4bu.png"></p></div></div><br><p>  Install the library for STM32F3.  Open <strong>Help-&gt; Install New Libriaries</strong> , put the <strong>STM32F3 checkbox</strong> <em>Firmware Package</em> , click <strong>Install Now</strong> </p><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/hq/ll/ux/hqlluxeerb8krhkvvekdqynfjxo.png"></p></div></div><br><h2 id="ustanavlivaem-sublime-text-3">  Install Sublime Text 3 </h2><br><p>  In general, SW4 is quite self-sufficient IDE.  But I love to code it in ST3, and compilation and debug in SW4.  Installation instructions for ST3 for any distributions is <a href="https://www.sublimetext.com/docs/3/linux_repositories.html">here</a> . </p><br><pre> <code class="bash hljs">wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add - sudo apt install apt-transport-https <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"deb https://download.sublimetext.com/ apt/stable/"</span></span> | sudo tee /etc/apt/sources.list.d/sublime-text.list sudo apt update sudo apt install sublime-text cppcheck python-configparser sudo pip install --upgrade cmake sudo pip install cmakelint sudo pip install cubemx2cmake</code> </pre> <br><p>  <strong>After that, it is worth rewriting.</strong> </p><br><h3 id="nastroyka-sublime-text-3">  Setting Sublime Text 3 </h3><br><p>  First, install Package Control. <br>  Run ST3 and press <strong>CTRL + `</strong> , insert the code into the command line and press ENTER: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib.request,os,hashlib; h = <span class="hljs-string"><span class="hljs-string">'6f4c264a24d933ce70df5dedcf1dcaee'</span></span> + <span class="hljs-string"><span class="hljs-string">'ebe013ee18cced0ef93d5f746d80ef60'</span></span>; pf = <span class="hljs-string"><span class="hljs-string">'Package Control.sublime-package'</span></span>; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( <span class="hljs-string"><span class="hljs-string">'http://packagecontrol.io/'</span></span> + pf.replace(<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'%20'</span></span>)).read(); dh = hashlib.sha256(by).hexdigest(); print(<span class="hljs-string"><span class="hljs-string">'Error validating download (got %s instead of %s), please try manual install'</span></span> % (dh, h)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> dh != h <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> open(os.path.join( ipp, pf), <span class="hljs-string"><span class="hljs-string">'wb'</span></span> ).write(by)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/v0/xx/db/v0xxdb7m653kbartrv38kxbqphm.png"></p></div></div><br><p>  To complete the work we need these packages: </p><br><ul><li>  ARM Assembly (Backlight Assembler in the code) </li><li>  C Improved (Backlight C) </li><li>  CMakeEditor (Cmake Backlight) </li><li>  DocBlokr (Formatting Comments) </li><li>  EasyClangComplete (autocompletion of functions) </li><li>  Hex to Int preview (shows HEX value) </li><li>  SublimeAStyleFormatter (formats code by pressing CTRL + SHIFT + A) </li><li>  Sublimelinter </li><li>  Sublimelinter-contrib-cmakelint (cmake backlight) </li><li>  Sublimelinter-cppcheck (checks code for errors using cppcheck) </li><li>  Sublimelinter-annotations (Highlights FIXME, NOTE, TODO, etc.) </li></ul><br><p>  Install the necessary packages from the <strong>Preferences</strong> menu <strong>-&gt; Package Control -&gt; Install Package</strong> . </p><br><h4 id="nastroim-st3">  Configure ST3 </h4><br><p>  Open Preferences -&gt; Settings and paste into the right half: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"always_show_minimap_viewport"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"drag_text"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ensure_newline_at_eof_on_save"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fallback_encoding"</span></span>: <span class="hljs-string"><span class="hljs-string">"Cyrillic (Windows 1251)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"font_size"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"highlight_modified_tabs"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ignored_packages"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"Vintage"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"index_exclude_patterns"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"*.log"</span></span>, <span class="hljs-string"><span class="hljs-string">"*.bak"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"show_encoding"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"translate_tabs_to_spaces"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"trim_trailing_white_space_on_save"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> <br><h3 id="nastraivaem-pakety-st3">  Configure ST3 packages </h3><br><h4 id="easyclangcomplete">  EasyClangComplete </h4><br><p>  We configure <em>clang</em> on <em>C99</em> and we specify directories with basic libraries like <em>StdLib</em> . </p><br><p>  Open <strong>Preferences -&gt; EasyClangComplete -&gt; Settings</strong> and paste into the right half: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"common_flags"</span></span> : [ <span class="hljs-string"><span class="hljs-string">"-I/usr/include"</span></span>, <span class="hljs-string"><span class="hljs-string">"-I/usr/lib/clang/$clang_version/include"</span></span>, ], <span class="hljs-attr"><span class="hljs-attr">"c_flags"</span></span> : [ <span class="hljs-string"><span class="hljs-string">"-std=c99"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"clang_binary"</span></span> : <span class="hljs-string"><span class="hljs-string">"clang"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"verbose"</span></span> : <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"use_libclang_caching"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }</code> </pre> <br><h4 id="sublimelinter">  Sublimelinter </h4><br><ul><li>  Linter works only when loading / saving </li><li>  FIXME annotations are circled as an error, the rest as a warning </li><li>  CppCheck checks only the rules of Warning, Style, Performance and Portability, and also specify the standards C99 and C ++ 11 </li><li>  Do not show errors in a separate window when saving </li></ul><br><p>  Open <strong>Preferences -&gt; Sublimelinter -&gt; Settings</strong> and paste into the right half: </p><br><div class="spoiler">  <b class="spoiler_title">Lots of text, hid in spoiler</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"user"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"debug"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"delay"</span></span>: <span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-attr"><span class="hljs-attr">"error_color"</span></span>: <span class="hljs-string"><span class="hljs-string">"D02000"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gutter_theme"</span></span>: <span class="hljs-string"><span class="hljs-string">"Packages/SublimeLinter/gutter-themes/Default/Default.gutter-theme"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gutter_theme_excludes"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"lint_mode"</span></span>: <span class="hljs-string"><span class="hljs-string">"load/save"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"linters"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"annotations"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@disable"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"args"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"errors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"FIXME"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"excludes"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"warnings"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"NOTE"</span></span>, <span class="hljs-string"><span class="hljs-string">"README"</span></span>, <span class="hljs-string"><span class="hljs-string">"TODO"</span></span>, <span class="hljs-string"><span class="hljs-string">"@todo"</span></span>, <span class="hljs-string"><span class="hljs-string">"XXX"</span></span>, <span class="hljs-string"><span class="hljs-string">"WIP"</span></span> ] }, <span class="hljs-attr"><span class="hljs-attr">"clang"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@disable"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"args"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"excludes"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"extra_flags"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"include_dirs"</span></span>: [] }, <span class="hljs-attr"><span class="hljs-attr">"cmakelint"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@disable"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"args"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"excludes"</span></span>: [] }, <span class="hljs-attr"><span class="hljs-attr">"cppcheck"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@disable"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"args"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"enable"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"warning"</span></span>, <span class="hljs-string"><span class="hljs-string">"style"</span></span>, <span class="hljs-string"><span class="hljs-string">"performance"</span></span>, <span class="hljs-string"><span class="hljs-string">"portability"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"excludes"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"std"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"c99"</span></span>, <span class="hljs-string"><span class="hljs-string">"c++11"</span></span> ] }, }, <span class="hljs-attr"><span class="hljs-attr">"mark_style"</span></span>: <span class="hljs-string"><span class="hljs-string">"outline"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"no_column_highlights_line"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"passive_warnings"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"paths"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"linux"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"osx"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"windows"</span></span>: [] }, <span class="hljs-attr"><span class="hljs-attr">"python_paths"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"linux"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"osx"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"windows"</span></span>: [] }, <span class="hljs-attr"><span class="hljs-attr">"rc_search_limit"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">"shell_timeout"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show_errors_on_save"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show_marks_in_minimap"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tooltip_fontsize"</span></span>: <span class="hljs-string"><span class="hljs-string">"1rem"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tooltip_theme"</span></span>: <span class="hljs-string"><span class="hljs-string">"Packages/SublimeLinter/tooltip-themes/Default/Default.tooltip-theme"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tooltip_theme_excludes"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"tooltips"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"warning_color"</span></span>: <span class="hljs-string"><span class="hljs-string">"DDB700"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"wrap_find"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } }</code> </pre></div></div><br><h4 id="sublimeastyleformatter">  SublimeAStyleFormatter </h4><br><p>  Formatting is customized to my taste.  A detailed description of all the items is in <strong>Preferences -&gt; SublimeAStyleFormatter -&gt; Settings - Default</strong> </p><br><p>  Open <strong>Preferences -&gt; SublimeAStyleFormatter -&gt; Settings - User</strong> and paste: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"options_default"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"style"</span></span>: <span class="hljs-string"><span class="hljs-string">"google"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"indent"</span></span>: <span class="hljs-string"><span class="hljs-string">"spaces"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"indent-spaces"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">"indent-col1-comments"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"indent-switches"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"indent-cases"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"break-blocks"</span></span>: <span class="hljs-string"><span class="hljs-string">"default"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attach-namespaces"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"break-blocks"</span></span>: <span class="hljs-string"><span class="hljs-string">"default"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"add-brackets"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lineend"</span></span>: <span class="hljs-string"><span class="hljs-string">"linux"</span></span> } }</code> </pre> <br><h3 id="ustanavlivaem-ac6-system-workbench-for-stm32-sw4stm32">  Install AC6 System Workbench for STM32 (SW4STM32) </h3><br><p>  The entire installation process is described on the <a href="http://www.openstm32.org/Installing%252BSystem%252BWorkbench%252Bfor%252BSTM32%252Bwith%252Binstaller">OpenSTM32.org</a> site. </p><br><p>  We register on <a href="http://www.openstm32.org/">www.openstm32.org</a> and download the <a href="">installer</a> . </p><br><p>  Go to the download folder and enter </p><br><pre> <code class="bash hljs">bash install_sw4stm32_linux_64bits-latest.run</code> </pre> <br><p>  If you have <strong>gksudo</strong> installed, the installer will start in graphical mode.  I have not installed, because everything is in the terminal. </p><br><p>  Several times we enter <strong>1</strong> as an agreement with any nonsense.  Specify the installation path: </p><br><pre> <code class="hljs">/home/bulkin/Programs/SystemWorkbench</code> </pre> <br><p>  Again, we agree with everything, like a virgin for the first time, and wait for the end of the installation. </p><br><h4 id="dobavim-poisk-sw4-v-dash">  Add SW4 Search to Dash </h4><br><pre> <code class="bash hljs">chmod +x <span class="hljs-string"><span class="hljs-string">"/home/bulkin/ /sw4stm32_shortcut.desktop"</span></span> cp <span class="hljs-string"><span class="hljs-string">"/home/bulkin/ /sw4stm32_shortcut.desktop"</span></span> ~/.<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/share/applications/sw4stm32_shortcut.desktop</code> </pre> <br><h4 id="nastroyka-sw4">  SW4 setting </h4><br><p>  We start SW4, agree with the creation of the workspace, click on the <em>workbench</em> .  When you first start it will be installed ARM Toolchain. </p><br><p>  First, install a convenient topic.  Open Help-&gt; Install New Software, click <strong>Add ..</strong> and enter: </p><br><pre> <code class="hljs dos">Eclipse <span class="hljs-built_in"><span class="hljs-built_in">Color</span></span> Theme http://eclipse-<span class="hljs-built_in"><span class="hljs-built_in">color</span></span>-theme.github.io/update/</code> </pre> <br><p>  Click OK, select <em>Eclipse Color Theme</em> and click <strong>Next&gt;</strong> and then everything is done. </p><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ge/yi/hy/geyihy8pruka1oxg00_ekblj2jy.png"></p></div></div><br><p>  Include the theme: <strong>Window -&gt; Preferences -&gt; Appearance -&gt; Color Theme</strong> .  I love Monokai, and you can later pick the one you like. </p><br><p>  Well, it's time to start our first project and test the development environment in operation. </p><br><h1 id="proverka-nastroennoy-sredy-i-nebolshie-dovodki">  Testing a customized environment and minor tweaks </h1><br><p>  I repeat, I will give examples for the <a href="http://www.st.com/en/evaluation-tools/stm32f3discovery.html">STM32F3DISCOVERY</a> debug board.  I do everything as simple as possible, we need to check the settings of the development environment. </p><br><p>  Run STM32CubeMX, select New Project in the main window.  Open the Board Selector tab.  Choose our fee: </p><br><ul><li>  Type of board: Discovery </li><li>  MCU Series: STM32F3 </li><li>  From the list below, select STM32F3DISCOVERY </li></ul><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/g3/kj/t1/g3kjt146p2bvhdntn2yap0dnsum.png"></p></div></div><br><p>  And two clicks on our board. </p><br><h4 id="sdelaem-minimalnuyu-nastroyku-mk">  Make the minimum setting MK </h4><br><p>  In the left menu, turn on: </p><br><ul><li>  FreeRTOS: checkbox Enabled </li><li>  SYS: Trace Asynchronous Sw </li><li>  Timebase Source: TIM17 (you can choose any at the current stage) </li></ul><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/y8/fa/7z/y8fa7zmx10gwb8mpiqyo8l3vox8.png"></p></div></div><br><p>  Go to the Clock Configuration tab: </p><br><ul><li>  Enter 64 MHz in the HCLK field (maximum frequency on the built-in oscillator) </li></ul><br><h4 id="nastroim-sam-proekt">  Set up the project itself </h4><br><p>  Open <strong>Project-&gt; Settings</strong> from the top menu. </p><br><ul><li>  Specify the project name in the <em>Project Name</em> field: STM32Discovery-SW4-Test </li><li>  Specify the path in the field <em>Project Location</em> : / home / bulkin / workspace </li><li>  Select Toolchain: SW4STM32 </li></ul><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/6h/8q/wq/6h8qwqxomdhtynic5vve3iwwjf0.png"></p></div></div><br><p>  Open the <strong>Code Generator</strong> tab and turn on the "add necessary project configuration file" </p><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/4l/wb/id/4lwbidfrcyxkpo2hdwwphri-8zk.png"></p></div></div><br><p>  We press <strong>OK</strong> and now we are ready to create a project.  Click Generate Source Code in the top menu: <br><img src="https://habrastorage.org/webt/2f/ah/2d/2fah2dlaikafyagcdf7khbcfrki.png"></p><br><h4 id="proverim-sublime-text-3">  Check Sublime Text 3 </h4><br><p>  First you need to create CMakeList.txt.  To do this, open the console in the root of our project and enter: </p><br><pre> <code class="bash hljs">cubemx2cmake</code> </pre> <br><p>  From our <strong>STM32Discovery-SW4-Test.ioc</strong> will be created the necessary files to compile from the command line.  But we are only interested in <strong>CMakeLists.txt.template</strong> .  Rename it to <strong>CMakeLists.txt</strong> . </p><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ez/yi/5l/ezyi5lszyrujeogeonmgysbwqb0.png"></p></div></div><br><p>  <strong>Project-&gt; Add folder to Project ...</strong> and select the folder of our new project. <br>  First you need to add the missing paths to the libraries in <em>CMakeList.txt</em> .  This is necessary for the correct operation of the <em>EasyClangComplete</em> .  Left click on <em>CMakeList.txt</em> and make changes: <br>  Above the line <code>set(USER_INCLUDE Inc)</code> add: </p><br><pre> <code class="hljs lisp">set(<span class="hljs-name"><span class="hljs-name">STM32CUBEREPO</span></span> /opt/libs/STM32Cube/Repository/STM32Cube_FW_F3_V1.<span class="hljs-number"><span class="hljs-number">9.0</span></span>)</code> </pre> <br><p>  All subsequent <strong>set</strong> up to <strong>file</strong> change to: </p><br><pre> <code class="hljs cmake"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(USER_INCLUDE Inc) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(CMSIS_DEVICE_INCLUDE <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Drivers/CMSIS/Device/ST/STM32F3xx/<span class="hljs-keyword"><span class="hljs-keyword">Include</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(CMSIS_INCLUDE <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Drivers/CMSIS/<span class="hljs-keyword"><span class="hljs-keyword">Include</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(CMSIS_RTOS_INCLUDE <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Middlewares/Third_Party/FreeRTOS/Source/CMSIS_RTOS) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(HAL_INCLUDE <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Drivers/STM32F3xx_HAL_Driver/Inc) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(FREERTOS_INCLUDE <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Middlewares/Third_Party/FreeRTOS/Source/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>)</code> </pre> <br><p>  Well, in the <strong>include_directories</strong> section, at the very end, add <code>${FREERTOS_INCLUDE} ${CMSIS_DEVICE_INCLUDE}</code> . </p><br><pre> <code class="hljs cmake"><span class="hljs-keyword"><span class="hljs-keyword">include_directories</span></span>(<span class="hljs-variable"><span class="hljs-variable">${USER_INCLUDE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMSIS_DEVICE_INCLUDE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMSIS_INCLUDE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${HAL_INCLUDE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMSIS_RTOS_INCLUDE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${FREERTOS_INCLUDE}</span></span>)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Here is a CMakeList.txt in the end</b> <div class="spoiler_text"><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(MCU_FAMILY STM32F3xx) <span class="hljs-keyword"><span class="hljs-keyword">cmake_minimum_required</span></span>(VERSION <span class="hljs-number"><span class="hljs-number">3.6</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">project</span></span>(STM32Discovery-SW4-<span class="hljs-keyword"><span class="hljs-keyword">Test</span></span> C ASM) <span class="hljs-keyword"><span class="hljs-keyword">add_definitions</span></span>(-DSTM32F303xC) <span class="hljs-keyword"><span class="hljs-keyword">add_definitions</span></span>(-DUSE_HAL_LIBRARY) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(STM32CUBEREPO /opt/libs/STM32Cube/Repository/STM32Cube_FW_F3_V1.<span class="hljs-number"><span class="hljs-number">9.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(USER_INCLUDE Inc) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(CMSIS_DEVICE_INCLUDE <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Drivers/CMSIS/Device/ST/STM32F3xx/<span class="hljs-keyword"><span class="hljs-keyword">Include</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(CMSIS_INCLUDE <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Drivers/CMSIS/<span class="hljs-keyword"><span class="hljs-keyword">Include</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(CMSIS_RTOS_INCLUDE <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Middlewares/Third_Party/FreeRTOS/Source/CMSIS_RTOS) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(HAL_INCLUDE <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Drivers/STM32F3xx_HAL_Driver/Inc) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(FREERTOS_INCLUDE <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Middlewares/Third_Party/FreeRTOS/Source/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>(GLOB_RECURSE USER_INCLUDE_F <span class="hljs-variable"><span class="hljs-variable">${USER_INCLUDE}</span></span>/*.h) <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>(GLOB_RECURSE CMSIS_DEVICE_INCLUDE_F <span class="hljs-variable"><span class="hljs-variable">${CMSIS_DEVICE_INCLUDE}</span></span>/*.h) <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>(GLOB_RECURSE CMSIS_INCLUDE_F <span class="hljs-variable"><span class="hljs-variable">${CMSIS_INCLUDE}</span></span>/*.h) <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>(GLOB_RECURSE HAL_INCLUDE_F <span class="hljs-variable"><span class="hljs-variable">${HAL_INCLUDE}</span></span>/*.h) <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>(GLOB_RECURSE USER_SOURCES Src/*.c) <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>(GLOB_RECURSE HAL_SOURCES <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Drivers/STM32F3xx_HAL_DRIVER/Src/*.c) <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>(GLOB_RECURSE CMSIS_SYSTEM <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Drivers/CMSIS/Device/ST/STM32F3xx/Source/Templates/system_STM32F3xx.c) <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>(GLOB_RECURSE CMSIS_STARTUP <span class="hljs-variable"><span class="hljs-variable">${STM32CUBEREPO}</span></span>/Drivers/CMSIS/Device/ST/STM32F3xx/Source/Templates/gcc/startup_STM32F303xC.s) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(SOURCE_FILES <span class="hljs-variable"><span class="hljs-variable">${USER_SOURCES}</span></span> <span class="hljs-variable"><span class="hljs-variable">${HAL_SOURCES}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMSIS_SYSTEM}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMSIS_STARTUP}</span></span> STM32F303VCTx_FLASH.ld <span class="hljs-variable"><span class="hljs-variable">${USER_INCLUDE_F}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMSIS_DEVICE_INCLUDE_F}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMSIS_INCLUDE_F}</span></span> <span class="hljs-variable"><span class="hljs-variable">${HAL_INCLUDE_F}</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">include_directories</span></span>(<span class="hljs-variable"><span class="hljs-variable">${USER_INCLUDE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMSIS_DEVICE_INCLUDE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMSIS_INCLUDE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${HAL_INCLUDE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMSIS_RTOS_INCLUDE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${FREERTOS_INCLUDE}</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">add_executable</span></span>(<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.elf <span class="hljs-variable"><span class="hljs-variable">${SOURCE_FILES}</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(CMAKE_EXE_LINKER_FLAGS <span class="hljs-string"><span class="hljs-string">"${CMAKE_EXE_LINKER_FLAGS} -Wl,-Map=${PROJECT_SOURCE_DIR}/build/${PROJECT_NAME}.map"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(HEX_FILE <span class="hljs-variable"><span class="hljs-variable">${PROJECT_SOURCE_DIR}</span></span>/build/<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.hex) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(BIN_FILE <span class="hljs-variable"><span class="hljs-variable">${PROJECT_SOURCE_DIR}</span></span>/build/<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.bin) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_command</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">TARGET</span></span> <span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.elf PRE_BUILD <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMAKE_COMMAND}</span></span> -E <span class="hljs-keyword"><span class="hljs-keyword">make_directory</span></span> <span class="hljs-variable"><span class="hljs-variable">${PROJECT_SOURCE_DIR}</span></span>/build COMMENT <span class="hljs-string"><span class="hljs-string">"Creating build directory"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_command</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">TARGET</span></span> <span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.elf POST_BUILD <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMAKE_OBJCOPY}</span></span> -Oihex $&lt;TARGET_FILE:<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.elf&gt; <span class="hljs-variable"><span class="hljs-variable">${HEX_FILE}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMAKE_OBJCOPY}</span></span> -Obinary $&lt;TARGET_FILE:<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.elf&gt; <span class="hljs-variable"><span class="hljs-variable">${BIN_FILE}</span></span> COMMENT <span class="hljs-string"><span class="hljs-string">"Building ${HEX_FILE} Building ${BIN_FILE}"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_target</span></span>(flash WORKING_DIRECTORY <span class="hljs-variable"><span class="hljs-variable">${PROJECT_SOURCE_DIR}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> openocd -f openocd_flash.cfg COMMENT <span class="hljs-string"><span class="hljs-string">"Flashing the target processor..."</span></span> DEPENDS <span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.elf) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_command</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">TARGET</span></span> flash POST_BUILD COMMENT <span class="hljs-string"><span class="hljs-string">"Flashing finished!"</span></span>)</code> </pre> </div></div><br><blockquote>  It is worth explaining why we need these dances with a tambourine.  The fact is that during the creation of the project we chose the option "add libraries as links in the toolchain".  But <strong>cubemx2cmake</strong> indicates the relative path to the <em>HAL</em> libraries, and also does not add a couple of paths to the <em>CMSIS</em> and <em>FreeRTOS</em> libraries.  This will probably be fixed in future versions, but so far. </blockquote><p>  Now you need to reset the cache. Cmake: <strong>CTRL-SHIFT-P -&gt; EasyClangComplete: Clean current cmake cache</strong> </p><br><p>  Open Src / main.c Move the cursor to a function and rejoice in the pop-up windows with its description.  More information about the operation of EasyClangComplete can be found <a href="https://github.com/niosus/EasyClangComplete">here</a> . </p><br><p>  Let's try to format the code: press CTRL + ALT + F and enjoy how everything has changed.  If you prefer a different style, no problem, the settings in <strong>Preferences -&gt; SublimeAStyleFormatter</strong> . </p><br><h3 id="otkompiliruem-proekt-i-posmotrim-debug">  Let's compile the project and see debug </h3><br><p>  Run SW4 and import the project: </p><br><ul><li>  File -&gt; Import ... -&gt; General -&gt; Existing projects into workspace <br><ul><li>  Select root directory: / home / bulkin / workspace / STM32Discovery-SW4-Test </li><li>  Do not put the checkbox Copy projects into workspace </li></ul></li></ul><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/mb/wa/-l/mbwa-lxvejwbom76manmkghlebc.png"></p></div></div><br><p>  Click Finish. </p><br><p>  We select the project in <strong>Project explorer</strong> .  Compile <strong>Project -&gt; Build Project</strong> .  If everything was done without errors earlier, the project will be compiled in a few seconds.  And in the console at the bottom will be something like this: </p><br><pre> <code class="hljs pgsql">Generating binary <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Printing size information: arm-<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>-eabi-objcopy -O binary "STM32Discovery-SW4-Test.elf" "STM32Discovery-SW4-Test.bin" arm-<span class="hljs-keyword"><span class="hljs-keyword">none</span></span>-eabi-size "STM32Discovery-SW4-Test.elf" <span class="hljs-type"><span class="hljs-type">text</span></span> data bss <span class="hljs-type"><span class="hljs-type">dec</span></span> hex filename <span class="hljs-number"><span class="hljs-number">8724</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">5040</span></span> <span class="hljs-number"><span class="hljs-number">13780</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span>d4 STM32Discovery-SW4-Test.elf <span class="hljs-number"><span class="hljs-number">16</span></span>:<span class="hljs-number"><span class="hljs-number">42</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span> Build Finished (took <span class="hljs-number"><span class="hljs-number">6</span></span>s<span class="hljs-number"><span class="hljs-number">.173</span></span>ms)</code> </pre> <br><p>  We connect our board to the computer and try to download the firmware: <strong>Run -&gt; Run as Ac6 STM32 C / C ++ Application</strong> .  If all goes well, at the end of the console output will be: </p><br><pre> <code class="hljs pgsql">wrote <span class="hljs-number"><span class="hljs-number">10240</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> file <span class="hljs-keyword"><span class="hljs-keyword">Debug</span></span>/STM32Discovery-SW4-Test.elf <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.513113</span></span>s (<span class="hljs-number"><span class="hljs-number">19.489</span></span> KiB/s) ** Programming Finished ** ** Verify Started ** STM32F303VCTx.cpu: target state: halted target halted due <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> breakpoint, <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> mode: Thread xPSR: <span class="hljs-number"><span class="hljs-number">0x61000000</span></span> pc: <span class="hljs-number"><span class="hljs-number">0x2000002e</span></span> msp: <span class="hljs-number"><span class="hljs-number">0x2000a000</span></span> verified <span class="hljs-number"><span class="hljs-number">8748</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.104648</span></span>s (<span class="hljs-number"><span class="hljs-number">81.635</span></span> KiB/s) ** Verified OK ** ** Resetting Target **</code> </pre> <br><p>  Well, the most delicious.  Run the debugger.  <strong>Run -&gt; Debug</strong> (or just press F11).  SW4 will download the firmware and offer to open a separate perspective for the debugger.  I advise you to agree. </p><br><p>  Initially, our program will be stopped at <code>int main(void) {}</code> , this is the default breakpoint.  Run the program by pressing F8 to initialize all the settings of the MC, then stop by pressing the <em>Suspend</em> button in the top panel.  Let's try to light the LEDs.  In the upper right part of the perspective, open the <strong>I / O Registers</strong> tab, expand GPIO and right-click on <strong>GPIOE -&gt; ODR -&gt; Activate</strong> </p><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/gi/4f/ng/gi4fnguvjnri7oweey8s_o3ol_8.png"></p></div></div><br><p>  Now let's look at STM32CubeMX in our project that the LEDs are on the legs of PE8 - PE15: <br><img src="https://habrastorage.org/webt/qv/wf/58/qvwf58a9eauc0yc0zyuxzeqiqti.png"></p><br><p>  In the HEX Value column in the lines c <strong>GPIOE -&gt; ODR -&gt; ODR15</strong> by <strong>GPIOE -&gt; ODR -&gt; ODR8, set</strong> <strong>1</strong> and enjoy the magic of how the LEDs on the board light up.  Put <strong>0</strong> - go out. </p><br><div class="spoiler">  <b class="spoiler_title">Screen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xq/dt/9c/xqdt9cr0fms-gfxjxhpr88e0vk0.png"></p></div></div><br><p>  Unfortunately, such magic is possible only in the stopped state, unlike Keil uVision, there is no real-time here. <del>  (sad smiley) </del></p><br><p>  It remains only to configure Git </p><br><h2 id="nastroyka-git">  Git setup </h2><br><p>  Go through the terminal in the directory with our project and initialize Git, including the input of personal data: </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/workspace/STM32Discovery-SW4-Test git init git config --global user.email <span class="hljs-string"><span class="hljs-string">"nb******@yandex.ru"</span></span> git config --global user.name <span class="hljs-string"><span class="hljs-string">"Nikita Bulaev"</span></span></code> </pre> <br><p>  Create a .gitignore and add to it: </p><br><div class="spoiler">  <b class="spoiler_title">Content .gitignore</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">/<span class="hljs-keyword"><span class="hljs-keyword">Debug</span></span>/ .metadata bin/ tmp/ *.tmp *.bak *.swp *~.nib <span class="hljs-keyword"><span class="hljs-keyword">local</span></span>.properties .settings/ .loadpath .recommenders # <span class="hljs-keyword"><span class="hljs-keyword">External</span></span> tool builders .externalToolBuilders/ # Locally stored "Eclipse launch configurations" *.launch # CDT-specific (C/C++ Development Tooling) .cproject # sbteclipse plugin .target # Tern plugin .tern-project # TeXlipse plugin .texlipse # STS (Spring Tool Suite) .springBeans # Code Recommenders .recommenders/ # Scala IDE specific (Scala &amp; Java development <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Eclipse) .cache-main .scala_dependencies .worksheet</code> </pre> </div></div><br><p>  Well, let's make a commit: </p><br><pre> <code class="bash hljs">git add * git commit -a -m <span class="hljs-string"><span class="hljs-string">"Initial commit"</span></span></code> </pre> <br><p>  In general, further things go beyond the article on setting up the development environment.  This is a complete description of debugging, and all sorts of hotkeys ST3.  I would like to talk about this another time.  I hope this article will be useful, although now setting up the environment has become much easier than a year ago.  Good luck! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/343456/">https://habr.com/ru/post/343456/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343446/index.html">In a section: the news aggregator on Android with backend. Android Development: Architecture Development</a></li>
<li><a href="../343448/index.html">Does CDROM have a long time?</a></li>
<li><a href="../343450/index.html">Internet of things: Arduino in conjunction with the cloud</a></li>
<li><a href="../343452/index.html">Found a vulnerability in Mac OS High Sierra that allows superuser to log into an unprotected computer</a></li>
<li><a href="../343454/index.html">‚ÄúBlender for 28 reports, each of which is equal to ten articles‚Äù - an interview with the Program Committee of HolyJS 2017 Moscow</a></li>
<li><a href="../343458/index.html">Kotlin code style</a></li>
<li><a href="../343460/index.html">Announcement mitap Sync.NET # 5 in Kharkov</a></li>
<li><a href="../343462/index.html">Three myths about mobile payment security</a></li>
<li><a href="../343464/index.html">Classifying Sounds with TensorFlow</a></li>
<li><a href="../343466/index.html">Introduction to Neural Networks on Golang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>