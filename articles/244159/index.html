<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ATM attack with Raspberry Pi</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="They just don‚Äôt do it with ATMs: they are torn out of the wall, tied with a cable to the car, drilled, blown up and cut ( sometimes in the State Duma ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ATM attack with Raspberry Pi</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/pt/blog/244159/"><img src="https://habrastorage.org/getpro/habr/post_images/52b/b27/198/52bb27198d188a9ebed80df37be7ec83.jpg" alt="image"></a> <br><br>  They just don‚Äôt do it with ATMs: they are torn out of the wall, tied with a cable to the car, drilled, blown up and cut ( <a href="http://www.interfax.ru/business/403416">sometimes</a> in the State Duma building).  According <a href="http://www.plusworld.ru/daily/obem-bankomatnogo-skimminga-v-evrope-dostig-shestiletnego-minimuma/">to EAST statistics</a> , criminals are less likely to use skimming, preferring trapping and physical sabotage.  A lot of trouble for security specialists also brings another new trend - virus attacks on ATMs.  Here and Trojan.Skimer, and Backdoor.Ploutus, and very fresh malware Tyupkin, and other "applications", known and not very much.  Malware is loaded into an ATM computer, usually from external media, and is used for unauthorized issuance of money or interception of card data.  Positive Technologies experts Olga Kochetova and Alexey Osipov described another attack method at the <a href="https://www.blackhat.com/eu-14/">Black Hat Europe 2014</a> conference on computer security, held in Amsterdam in October. <a name="habracut"></a><br><br>  To test the security of the test ATM, which survived three forums at Positive Hack Days, the popular miniature controller Raspberry Pi was chosen.  The device hides easily inside the case and does not attract the attention of technicians, who, for example, change the paper in the built-in printers and therefore have the keys to the service area. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Finding documentation describing the interfaces of ATMs is not so difficult, and Alexey Lukatsky wrote about this five years ago in his Myths of Information Security.  ATM equipment and payment terminals, regardless of the manufacturer, have a common API for accessing and managing various modules and work on the Windows platform in accordance with the single standard of "extensions for financial services" (XFS). <br><br>  Knowing the API, you can take control of the ATM host computer and directly control various peripheral devices installed inside the ATM cabinet - a card reader, a PIN keypad, a touchscreen display, a banknote dispenser, etc. Do not forget about operating system vulnerabilities ATM systems, and Windows has them in <a href="http://habrahabr.ru/company/pt/blog/243047/">store</a> for many years to come. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Uxd0TRdE6sw%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhgu9GS86hDvtveW9zoFum2RidSOpg" frameborder="0" allowfullscreen=""></iframe><br><br><h4>  Weakness </h4><br>  Before installing the Raspberry Pi and connecting the device to the Ethernet, USB or RS-232 ports, the ATM must be opened.  At the top of the ATM is the service area.  This is where the computer that controls the ATM devices, network equipment (including badly protected GSM / GPRS modems) is located.  The service area is practically not controlled, as it is used by service personnel for various works.  It is much easier to get access to it than to the safe with money located below.  It can be opened with keys that are easy to manufacture or with very simple tools at <a href="http://www.securitylab.ru/news/440763.php">hand</a> . <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/KijIzHUtLjU%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhiTx0v5aqlYUbLImfUW3FRs-8c-og" frameborder="0" allowfullscreen=""></iframe><br><br>  But just open a little - you need to do it quickly and imperceptibly. <br><br>  At the Black Hat conference, Positive Technologies researchers demonstrated how long it would take attackers to install a microcomputer into an ATM service area to use it as a sniffer ‚Äî PIN interceptor and credit card number ‚Äî or a hardware skimmer that leaves no trace on the appearance of the ATM.  It took two minutes to unlock the ATM case, integrate the microcomputer, mask it and connect it to the Internet. <br><br>  In preparation for the performance, the Raspberry Pi has been programmed to manage ATM peripherals.  A Wi-Fi adapter was connected to the microcomputer, to which it was possible to connect from any device, from a smartphone for example.  Commands for issuing money to the dispenser were sent through a specially implemented web interface.  As an example, the issuance of several banknotes was shown, and after some refinement of the code being sent, the ATM immediately parted <a href="https://www.youtube.com/watch%3Fv%3DksEmXuV324I">with all the notes that were piled</a> .  By the way, in each cassette typical ATM fits from two to three thousand bills, and there are usually four such cassettes for several denominations. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f2/591/aa8/3f2591aa83649c944436d9a85ca4eaa4.jpg" alt="image"><br><br>  Needless to say, during the experiment, the ATM issued bills, leaving no entries in its computer, and the built-in video camera of the ATM did work, but, like other devices inside a captured ATM, was controlled with the help of Raspberry Pi. <br><br><h4>  Is it possible to protect </h4><br>  ATM security is not easy.  Much depends on the attack scenario.  For example, the ‚ÄúProtection‚Äù Research Center of the Ministry of Internal Affairs <a href="http://presuha.ru/release/380127-mvd-rossii-predlagaet-principialno-novuyu-sistemu-zaschity-bankomatov.html">recommends that</a> manufacturers use a smoke generator, an ultrasonic barrier and a xenon stroboscope, while British <a href="http://www.link.co.uk/Pages/Home.aspx">LINK</a> specialists prohibit standard locks to access the service area and more actively use webcams. <br><br>  However, the main problem, according to our researchers, is the ability to install any device or program (up to <a href="http://www.securitylab.ru/news/437797.php">Angry Birds</a> ) into an ATM, which is caused by the abundance of critical vulnerabilities in operating systems.  The situation could be changed by the joint work of bank equipment manufacturers on a new open specification that would ensure secure communication and effective authentication of ATM components: so that anyone who wants a key from the service area cannot easily connect anything to the system. </div><p>Source: <a href="https://habr.com/ru/post/244159/">https://habr.com/ru/post/244159/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244143/index.html">Bypassing the protection of the iOS client Dropbox</a></li>
<li><a href="../244145/index.html">Interview with Moses Uretsky, co-founder and director of Digital Ocean</a></li>
<li><a href="../244151/index.html">OpenVZ, Quagga and LiveMigration</a></li>
<li><a href="../244153/index.html">Facebook launches data center with new network architecture</a></li>
<li><a href="../244155/index.html">Multitasking in the Linux kernel: workqueue</a></li>
<li><a href="../244161/index.html">Trader trader competitor?</a></li>
<li><a href="../244163/index.html">Recognize barcodes on images using Python and OpenCV</a></li>
<li><a href="../244165/index.html">Beta new Opera Mini for Android with sync</a></li>
<li><a href="../244169/index.html">Amazon will compete for the creation of a "green Internet"</a></li>
<li><a href="../244171/index.html">A golden age of design</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>