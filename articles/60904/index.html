<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Own MobileMe Server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It's bad that Apple has a paid MobileMe account, and sometimes you need to store data online to use it from anywhere. But if there is no money or no c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Own MobileMe Server</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/5f7/27c/d5c/5f727cd5c63c96ae60e719cb3e000f57.png" alt="image"><br><br>  It's bad that Apple has a paid MobileMe account, and sometimes you need to store data online to use it from anywhere.  But if there is no money or no credit card with which you can pay your account, then this is not a hindrance if you put ... a wonderful dotMac program that allows you to make to: <br>  10.5 ‚ÄúLeopard‚Äù <br><ul><li>  .Mac prefpane </li><li>  iSync </li><li>  iDisk </li><li>  iDisk sync </li><li>  Backup </li></ul><br>  10.4 ‚ÄúTiger‚Äù <br><ul><li>  .Mac prefpane </li><li>  iSync support </li><li>  iDisk </li><li>  iDisk sync </li><li>  Backup </li></ul><br>  But for this you need to work hard <br><a name="habracut"></a><br><h4>  1. Download dotmac </h4><br> <code><a href="http://dotmac.googlecode.com/svn/trunk/"></a> svn checkout dotmac.googlecode.com/svn/trunk ~/dotmac</code> <br> <br><h4>  2. Configure Apache </h4><br>  And so we create a server on our own machine, for that, everything is in Leopard (but Apache does not work correctly).  First, let's make a backup of the modified Apache files: <br> <code>sudo cp /usr/libexec/apache2/mod_dav.so /usr/libexec/apache2/mod_dav.so.default <br> sudo cp /usr/libexec/apache2/mod_dav_fs.so /usr/libexec/apache2/mod_dav_fs.so.default</code> <br> <br>  now download and unzip the Apache in the Home directory: <br> <code><a href="http://archive.apache.org/dist/httpd/"></a> cd ~ <br> curl -O archive.apache.org/dist/httpd/httpd-2.2.6.tar.gz <br> gnutar -xzf httpd-2.2.6.tar.gz</code> <br> <br>  Now let's write a patch for the <i>dotmac</i> quota, so that it <i>includes</i> support for <i>iDisk</i> quotas <br> <code>cd ~/httpd-2.2.6 <br> patch -p1 &lt; ~/dotmac/Patches/Apache/quota.patch.txt <br> patch -p1 &lt; ~/dotmac/Patches/Apache/ampquotefix.patch</code> <br> <br>  Next, configure and install the patched modules (using <i>CFLAGS</i> install support for all platforms) <br> <code>./configure CFLAGS='-arch x86_64 -arch i386 -arch ppc -arch ppc64' --enable-modules=most --enable-mods-shared=all <br> make</code> <br> <br>  we change original modules for patched ones <br> <code>sudo cp ./modules/dav/main/.libs/mod_dav.so /usr/libexec/apache2/mod_dav.so <br> sudo cp ./modules/dav/fs/.libs/mod_dav_fs.so /usr/libexec/apache2/mod_dav_fs.so</code> <br> <br><h4>  3. Configure Perl </h4><br>  There is nothing to download, everything is there, so we will customize. <br>  We call it as follows: <br> <code>sudo su <br> cpan</code> <br> <br>  he will ask if you want to configure manually, write no, everything will be done automatically <br>  now the input line has changed to <u>cpan&gt;</u> it means you can install modules <br> <code>install HTTPD::UserAdmin <br> install MD5 <br> install XML::DOMcpan</code> <br> <br>  on the last team asks whether to queue dependencies, answer <b>yes</b> . <br>  We continue <br> <code>install HTTP::DAV</code> <br> <br>  if you are using a <i>G4</i> or <i>i386</i> processor then add <br> <code>install XML::LibXML <br> q</code> <br> <br>  If you have a <i>G5</i> or <i>Xeon</i> processor, do the following: <br> <code>get XML::LibXML <br> look XML::LibXML <br> # perl Makefile.PL <br> # nano Makefile</code> <br> <br>  will <u>throw</u> us back to bash where you need to edit <u>/var/root/.cpan/build/XML-LibXML-1.66/Makefile.PL</u> , change the <u>iarch -arch i386 -arch ppc</u> to <i>-arch ppc64 -arch x86_64 in it</i> (in 3 places ) <br> <code># make install <br> # exit <br> q <br> # exit</code> <br> <br>  <i>where # is bash commands</i> <br><br><h4>  4. Install the dotmac tree and Perl modules </h4><br>  we copy dotmac in the necessary directory <br> <code>sudo cp -r ~/dotmac/server/var/www/dotmac /Library/WebServer/dotmac <br> sudo mkdir /Library/WebServer/dotmac/userxml/testuser</code> <br> <br>  Now set permissions on dotmac folders: <br> <code>sudo chown -R www:www /Library/WebServer/dotmac <br> sudo chmod -R 755 /Library/WebServer/dotmac <br> sudo chown -R root:wheel /Library/WebServer/dotmac/private <br> sudo chown www:www /Library/WebServer/dotmac/private/iDiskUsers</code> <br> <br><h4>  5. Admin Password </h4><br>  The standard administrator password must be replaced with something secure and easily remembered by you. <br> <code>sudo htdigest /Library/WebServer/dotmac/private/iDiskAdmins idisk.mac.com admin</code> <br> <br>  Then the system will ask you to enter a password and confirm it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  6. Copy modified configuration files </h4><br>  Copy dotMac configuration files and change permissions so that they load with Apache <br> <code>sudo cp ~/dotmac/extras/platform_specific/Leopard/dotmac.conf /etc/apache2/other/dotmac.conf <br> sudo chown www:www /etc/apache2/other/dotmac.conf <br> sudo cp ~/dotmac/extras/platform_specific/Leopard/httpd-ssl.conf /etc/apache2/other/httpd-ssl.conf <br> sudo chown www:www /etc/apache2/other/httpd-ssl.conf</code> <br>  now we find my <u>$ dotMacIPAddress = '###. ###. ###. ###'</u> ; <br><br>  and change <i>###. ###. ###. ###</i> to your <i>IP</i> <br><br><h4>  7. Check the Apache server </h4><br>  For complete confidence, restart the computer.  We check Apache for correct settings via <u>apachectl</u> .  You should not see any mistakes!  If it does, go to the <i>Leopard Installation Guide #Troubleshooting | troubleshooting</i> to find a way to fix them. <br><br> <code>sudo apachectl configtest</code> <br> <br>  <i>Run /Applications/Utilities/Console.app and check the LOG FILES&gt; / var / log&gt; apache2 to see the Apache server running.</i>  <i>Start the Apache server using System Preferences&gt; Sharing and enable Web Sharing.</i>  <i>You should not have any errors and warnings in Console.app. If you still appear, then go to Leopard Installation Guide #Troubleshooting | troubleshooting to find a method of elimination.</i> <br><br><h4>  8. Configure hosts on the client machine </h4><br>  Now we will deceive .mac, that he would not climb on Apple's .mac server.  (Remember that the server must have a static IP address).  On each client machine, it is necessary to edit the hosts file so that it does not climb to the DNS server for the real address of the .mac server.  Open the <u>/ etc / hosts</u> file using nano or any other text editor. <br><br> <code>sudo nano /etc/hosts</code> <br> <br>  Go to the end of the file and enter (by changing <i>###. ###. ###. ###</i> to your <i>IP</i> ): <br><br> <code><a href="http://www.mac.com/"></a> <a href="http://www.mac.com/"></a> ###.###.###.### www.mac.com syncmgmt.mac.com idisk.mac.com configuration.apple.com lcs.mac.com certinfo.mac.com delta.mac.com notify.mac.com publish.mac.com homepage.mac.com <br> ###.###.###.### www.mac.com. syncmgmt.mac.com. idisk.mac.com. configuration.apple.com. lcs.mac.com. certinfo.mac.com. delta.mac.com. notify.mac.com. publish.mac.com. homepage.mac.com.</code> <br> <br>  Save (ctrl-o) and exit (ctrl-x).  You do not need to reboot to enter into force of these changes, but you need to clear the system's DNS cache with the following command: <br>  Mac OS X 10.5 Leopard: <br> <code>sudo dscacheutil -flushcache</code> <br> <br>  Mac OS X 10.4 Tiger: <br> <code>lookupd -flushcache</code> <br> <br><h4>  9. Account creation </h4><br>  For each user, you will have to create an account manually via the <i>iDiskAdmin</i> web form, to set a password and quota. <br><br>  Copy the sample <u>iDisk</u> folder into the <u>USERNAME</u> iDisk folder: <br><br> <code>sudo cp -r /Library/WebServer/dotmac/skel /Library/WebServer/dotmac/idisk/USERNAME <br> sudo chown -R www:www /Library/WebServer/dotmac/idisk/USERNAME</code> <br> <br>  Using Safari, go to <u><a href="http://configuration.apple.com/idiskAdmin">configuration.apple.com/idiskAdmin</a></u> under the admin and create a new user account <u>USERNAME</u> and set the quota. <br><br>  Restart the server: <br><br> <code>sudo apachectl graceful</code> <br> <br><h4>  10. Setting up a client certificate </h4><br>  The dotMac server will provide a certificate that the client must confirm and install before connecting to .mac.  This certificate must be manually added to the list of trust certificates for each client. <br><br>  Using Finder, connect (cmd-k) to <a href="https://idisk.mac.com/USERNAME">idisk.mac.com/USERNAME</a> <br><br>  You will be prompted to confirm the certificate.  Select <i>Show Certificate</i> and drag the certificate icon onto the desktop to create a dot.mac.com.cer file. <br><br>  <i>Open the / Applications / Utilities / Keychain Access.app and select login keychain (if necessary, click the Show Keychains button in the lower left).</i>  <i>Drag the certificate from Desktop to Keychain Access and select Always Trust when prompted.</i> <br><br><h4>  11. Configure the .mac client </h4><br>  Open <b>System Preferences&gt; .mac</b> and drive in a name and password. <br><br>  <i>it may sometimes be necessary to restart the dotMac server</i> <br><br><h4>  12. Done! </h4><br>  Now you have a full .mac account with iDisk and iSync support <br><br>  Now you can delete the Apache and dotMac sources. <br><br> <code>rm -r ~/httpd-2.2.6 <br> sudo rm -r ~/dotmac</code> <br> <br><h4>  Possible problems </h4><br>  If you have problems, try running sudo apachectl configtest and review the error log in Console.app and find ways to solve problems with your apache configuration and modules.  Many problems are discussed on the dotMac website. <br><br>  <b>Symptom:</b> Apache start / test error due to DAVSATMaxAreaSize. <br><br> <code>org.apache.httpd90519 $parms-&gt;add_config() has failed: Invalid command 'DAVSATMaxAreaSize', perhaps misspelled or defined by a module not included in the server configuration at /System/Library/Perl/Extras/5.8.8/darwin-thread-multi-2level/Apache2/PerlSections.pm line 203.\n</code> <br> <br>  <b>Problem:</b> The Apache DAV module (s) installed (mod_dav.so and / or mod_dav_fs.so) are not patched to support DAVSATMaxAreaSize.  You have not installed the correct Apple update for the Apache server. <br><br>  <b>Solution:</b> re-patch, create and install mod_dav.so and mod_dav_fs.so modules for Apache. <br><br>  <b>Symptom:</b> Apache start / test error due to lack of images. <br><br> <code>Can't load '/Library/Perl/5.8.8/darwin-thread-multi-2level/auto/XML/LibXML/LibXML.bundle' for module XML::LibXML: dlopen(/Library/Perl/5.8.8/dacd rwin-thread-multi-2level/auto/XML/LibXML/LibXML.bundle, 1): no suitable image found. Did find:\n\t/Library/Perl/5.8.8/darwin-thread-multi-2level/auto/XML/LibXML/LibXML.bundle: no matching architecture in universal wrapper at /System/Library/Perl/5.8.8/darwin-thread-multi-2level/DynaLoader.pm line 230"</code> <br> <br>  <b>Problem:</b> The module (s) that you compiled (mod_dav.so, mod_dav_fs.so or XML :: LibXML) are not built for your architecture.  You can verify this by using the following command (replace the corresponding paths and file name). <br><br> <code>file /usr/libexec/apache2/mod_dav.so</code> <br> <br>  <b>Solution:</b> You must be sure that the corresponding compiler flags are set correctly.  By default, only i386 and ppc7400 (G4) are included. <br><br>  Done! </div><p>Source: <a href="https://habr.com/ru/post/60904/">https://habr.com/ru/post/60904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../60879/index.html">Let's set a world record ... from a photo!</a></li>
<li><a href="../60890/index.html">Opening the VDS control panel!</a></li>
<li><a href="../60892/index.html">1000 year forecast</a></li>
<li><a href="../60894/index.html">Review of a very compact HD video flash camera JAY-tech VideoShot HD6 (traffic)</a></li>
<li><a href="../60900/index.html">Faty.ru</a></li>
<li><a href="../60905/index.html">Accelerator for IE8: Link encoder to QR code for quick transfer to phone</a></li>
<li><a href="../60906/index.html">Emacs for beginners: windows management, dedicated-mode</a></li>
<li><a href="../60912/index.html">Omegle - talk to someone</a></li>
<li><a href="../60913/index.html">Do you trust open proxies,% username%?</a></li>
<li><a href="../60914/index.html">Windows 7 Starter does not impose a limit on the number of applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>