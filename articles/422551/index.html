<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to steal money from a contactless card and Apple Pay</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article deals with popular myths and scenarios of fraud with contactless payment systems using the example of a real POS terminal, PayPass / payWa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to steal money from a contactless card and Apple Pay</h1><div class="post__text post__text-html js-mediator-article"><img alt="How to steal money from a contactless card from your pocket? How safe is PayPass and Apple Pay?" src="https://habrastorage.org/webt/gb/2f/ry/gb2frybl-08fyn1a0w1xxjap9f0.jpeg"><br><br>  The article deals with popular myths and scenarios of fraud with contactless payment systems using the example of a real POS terminal, PayPass / payWave cards and phones with the Google Pay / Apple Pay feature. <br><br>  Topics covered: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <b>Is it really possible to steal money by leaning against a pocket with a POS terminal?</b>  - we will try to fully reproduce this scenario of fraud from beginning to end, using a real POS-terminal and payment cards in real conditions. </li><li>  <b>What is the difference between physical and virtual Apple Pay cards?</b>  - how the physical card and the Apple Pay token are linked, and why Apple Pay is many times safer than a regular card. </li><li>  <b>We use a hardware NFC-sniffer (ISO 14443A)</b> - we will use the HydraNFC device to intercept data between the POS terminal and the card.  Consider what confidential data can be extracted from intercepted traffic. </li><li>  <b>We analyze the EMV protocol</b> - what data the card exchanges with the POS terminal, the request format used, mechanisms for protecting against fraud and replay attacks. </li><li>  <b>We investigate operations without a card (CNP, MO / TO)</b> - in which cases it is actually (!) Possible to steal money from a card, having only the requisites, which are considered contactless, and in which it is impossible. </li></ul><br>  <font color="red"><b>Attention!</b></font> <br><br>  The article describes in detail a hypothetical scheme of fraud, from beginning to end, through the eyes of a fraudster, in order to cover all aspects in which myths and delusions are cultivated.  Despite the provocative title, the main conclusion of the article is that <b>contactless payments are fairly safe, and attacks on them are time consuming and unprofitable</b> . <br><br>  <font color="red">The materials in the article are presented for informational purposes only.</font>  <font color="red">All scenes of the demonstration of fraud are staged and performed with the consent of the persons participating in them.</font>  <font color="red">All debited money from the cards were returned to their owners.</font>  <font color="red">Theft of money from cards is a criminal offense and is prosecuted.</font> <a name="habracut"></a><br><h1>  How it works? </h1><br>  To begin with, we will consider the basic concepts: any movement of money using payment cards is possible only through intermediaries connected to the payment system, for example, VISA or MasterCard.  Unlike transfers between individuals, debiting money from a card is available only to a legal entity (merchant) that has an acquiring agreement with a bank. <br><br><img src="https://habrastorage.org/webt/d5/1w/ce/d51wcetyqo_5ppr5467wwknaaus.png"><br>  <i><font color="99999">Transaction stages when paying via POS-terminal</font></i> <br><br>  The illustration above shows the classic payment scheme through the POS terminal.  It is this sequence of actions that occurs when, after payment at the checkout, you are awaiting confirmation at the terminal. <br><br><ol><li>  The buyer applies / inserts / inserts the card into the POS terminal; </li><li>  POS-terminal via the Internet transmits data to the acquiring bank; </li><li>  The acquiring bank, through the international payment system (IPS), applies to the issuing bank and asks whether the particular cardholder can pay for the purchase; </li><li>  The issuing bank confirms or rejects the purchase, after which the slip is printed (second check). </li></ol><br>  There are exceptions to this scheme, for example offline transactions, we will look at them further.  Also, if the acquiring bank and the issuing bank are the same bank, steps 2 and 4 are performed inside the same bank. <br><br>  Merchant - a person or organization providing goods or services <br><br>  Acquiring bank - a bank that provides the seller with the services of accepting payments through bank cards.  In this bank, usually, there is a seller‚Äôs bank account where the money debited from the card is credited. <br><br>  <b>Issuing</b> bank - the bank that issued the card.  It is the account of the cardholder, who debited the money. <br><br>  <b>The International Payment System</b> (IPS) is an international intermediary system between banks around the world, allowing banks to make payments among themselves without entering into an agreement with each bank separately.  All banks connected to the IPU, agree to work according to the same rules, which greatly simplifies the interaction.  For example, Visa, MasterCard, UnionPay, American Express, <s>WORLD</s> (no, WORLD does not work abroad). <br><br>  <b>Cardholder</b> - a person who has entered into a card service agreement with an issuing bank. <br><br><h1>  What is the difference between a regular Apple Pay or Google Pay card? </h1><br>  The procedure for linking a bank card to an Apple Pay or Google Pay system, due to the incomprehensibility of the process, often leads to confusion even among IT professionals.  I have heard many different myths about this technology. <br><br><h4>  Popular Apple Pay Myths </h4><br><ul><li>  <b><font color="D13CB8">The card is copied to the phone</font></b> <br>  This is not the case; the microprocessor card contains a protected memory area with cryptographic information that cannot be extracted after the card has been released.  Because of this, a chip card cannot be copied, in any way, at all.  <i><font color="99999">For the sake of fairness, it must be said that such attacks are possible, but their value exceeds the total amount of money that most readers of this article will spend in their entire life.</font></i> </li><li>  <b><font color="D13CB8">The phone connects to the Internet each time at the time of payment.</font></b> <br>  Google Pay / Apple Pay does not connect to the Internet at the time of payment through the POS-terminal.  All the necessary information is stored locally on the phone. </li><li>  <b><font color="D13CB8">For each payment a new card number is generated (PAN)</font></b> <br>  So it may seem, if you read Apple's press releases on Apple Pay technology.  But this is an erroneous interpretation of the concept of a token.  In fact, the details of the virtual card remain unchanged for a long time, you can check it with the latest digits of the card number in the slip (check) when paying for purchases. </li><li>  <b><font color="D13CB8">Paying Apple Pay / Google Pay charges an additional fee.</font></b> <br>  This is not the case; you will pay exactly as much as indicated on the price tag, and according to the terms of your agreement with the issuing bank whose card you have attached. </li><li>  <b><font color="D13CB8">Money can be written off twice</font></b> <br>  This myth concerns not only Google Pay / Apple Pay, but also ordinary bank cards.  I believe that it appeared because of the public transport payment systems, in which the terminal writes off money from a ticket each time it is presented, so you can write off funds two or more times if you do not carelessly hold the card.  In the case of POS terminals, this risk does not exist, since the terminal stops exchanging with the card as soon as it receives the necessary data. </li></ul><br><br><img src="https://habrastorage.org/webt/z5/mt/og/z5mtogccxmh5picpde0ng_nmnnk.png"><br>  <i><font color="99999">Linking a physical card to a "token" in the phone</font></i> <br><br>  Systems like Apple Pay operate on the basis of the <a href="https://www.emvco.com/emv-technologies/payment-tokenisation/">EMV Payment Tokenisation Specification</a> .  The procedure for associating a physical card and phone with Apple Pay is not described publicly, so we will analyze the process based on known data: <br><br><ol><li>  The vendor (Google, Apple, Samsung) gets the card information; </li><li>  Through the IPS, the provider asks if the card (this issuing bank) supports EMV Tokenisation; </li><li>  On the side of the IPS, a virtual card (token) is generated, which is loaded into the secure storage in the phone.  <i><font color="99999">I don‚Äôt know exactly where the private key of the virtual card is generated, whether it is transmitted via the Internet or generated locally on the phone, in this case it does not matter.</font></i> </li><li>  A generated virtual token card appears in the phone, the operations for which the issuing bank interprets as operations on the first physical card.  In the case of blocking a physical card, the token is also blocked. </li></ol><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"> Your browser does not support HTML5 video. <source src="https://zhovner.com/forever/applepay_different_pan.mp4" type="video/mp4"></video></div></div></div><br>  <i><font color="99999">Apple Pay allows you to read the details of a virtual card.</font></i>  <i><font color="99999">PAN number and expire date differ from the linked Alfa Bank Russian card.</font></i>  <i><font color="99999">By BIN of a virtual card (480099) MBNA AMERICA BANK is determined.</font></i> <br><br>  When paying by phone, the POS terminal sees a regular VISA or MasterCard card, and communicates with it in the same way as with a physical card.  A virtual token card contains all the attributes of a regular card: PAN number, expiration date, and so on.  In this case, the virtual card number and expiration date differ from the associated original card. <br><br><h2>  Scenario 1 - regular POS terminal </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fw/jz/mj/fwjzmjgmj7beldkf8bh4hdwmlay.jpeg"></div><br>  <i><font color="99999">Scammer armed with a POS terminal</font></i> <br><br>  The most popular plot of fraud in the heads of ordinary people: a fraudster clings to them in the crowd with the terminal turned on and writes off money.  We will try to reproduce this scenario in reality. <br><br>  <b>The conditions are as follows</b> : <br><br><ul><li>  A fraudster has a fully working <b>ordinary POS terminal</b> connected to an acquiring bank, the same as in stores and couriers.  Terminal firmware is not modified.  In our case, the Ingenico iWL250.  This is a portable POS terminal with a GPRS modem that supports contactless payment, is battery operated and is fully mobile. </li><li>  The fraudster does not use additional technical means, only the POS-terminal </li><li>  The debited funds are credited to the account of the fraudster, according to all the rules of banking systems </li></ul><br><h3>  Entity </h3><br><img src="https://habrastorage.org/webt/do/f_/qs/dof_qscba68g-7za5caz02pszqi.jpeg"><br><br>  To begin, we will need a legal entity with a checking account and connected acquiring.  We, like real scammers, will not issue anything in our name, but try to buy a ready-made legal entity.  face on the site for the same scam.  To do this, look at the ads from the first page of Google on the request "buy ip" and "buy ooo". <br><br> <a href=""><img src="https://habrastorage.org/webt/lu/7v/yc/lu7vycgengac_zvziy7cltrjl-k.png"></a> <br>  <i><font color="99999">Offers for sale of ready-made companies from fraudsters (clickable)</font></i> <br><br>  The price of the company on the black market with a current account ranges from 20 to 300 thousand rubles.  I managed to find several offers of LLC with a POS-terminal from 200 thousand rubles.  Such companies are issued to nominees, and the buyer receives the entire package of documents, along with the ‚Äúcash card‚Äù - this is a bank card tied to the checking account of the front company.  With such a card, a fraudster can cash money at an ATM. <br><br><blockquote>  For simplicity, we assume that the LLC + settlement account + acquiring and POS-terminal will cost the scammer <b>100,000 rubles</b> .  In fact, more, but we will simplify the life of our hypothetical fraudster, reducing the cost of the attack.  After all, the lower the cost of the attack, the easier it is to implement. </blockquote><br><h2>  We go to steal money </h2><br>  So, the fraudster received a POS terminal and is ready to go to a crowded place to lean against the victims and steal money from his pockets.  In our experiment, all the victims were previously instructed about our intentions, and all attempts to write off money were made with their consent.  In cases where the subjects did not have their own contactless bank cards, they were asked to put our card in the wallet.  Previously, the subjects found out exactly where and how they stored their cards, so the scammer knew in advance where the contactless card was in the bag / pocket. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="https://zhovner.com/forever/nfc_fraud_in_public.mp4" type="video/mp4"></video></div></div></div><br>  <i><font color="99999">Video: The crook raged at the mall</font></i> <br><br>  In case of a successful write-off, the transaction was canceled through the terminal menu, and the money was returned to the account of the subjects.  For all the time of the experiment, we tried to ‚Äústeal‚Äù the money from 20 subjects in the building of the shopping center and on the street.  The test result is described below. <br><br><h1>  Issue: PIN-free transaction limit </h1><br>  The limit on the maximum amount of the transaction without confirmation by the PIN code can be set both on the POS terminal itself (CVM Required Limit) and on the bank side.  In Russia, this limit is 1000‚Äö‚ÇΩ. <br><br><hr><br>  <font color="99999"><i><b>UPD</b> In the card settings, the authorization type of the Cardholder verification methods (CVMs) can be set as a signature on the check.</i></font>  <font color="99999"><i>In this case, the contactless transaction will pass on any amount without a PIN code.</i></font> <br><br><hr><br>  Our fraudster decides to write off at 999.99 rubles at a time.  If a repeated attempt to write off the amount below the limit in a short time period is requested, the PIN code will also be requested and, in most cases, it will not be possible to write off 999.99 rubles several times in a row.  Therefore, the most optimal strategy would be no more than one write-off from one card. <br><br><div style="text-align:center;"><img width="300" alt="POS-terminal with the amount of 999.99" src="https://habrastorage.org/webt/at/kg/lt/atkgltocfv4dmqiutgb-8rbcej8.png"></div><br>  <i><font color="99999">In Russia, the maximum amount of a debit without a PIN is 1000 rubles.</font></i> <br><br>  In fact, a lot of write-offs with the amount of 999.99 rubles in a short period of time can trigger the antifraud system on the side of the equator bank, therefore such a strategy is not optimal for a fraudster.  So, in real life, he would have to choose more diverse amounts, thereby reducing the potential income. <br><br>  By the way, many articles on this topic in Russian state that you can manually set your own limit on contactless operations without a PIN code.  I did not manage to find such an option in the main Russian banks.  Maybe you know about this opportunity?  This is about contactless payments, not any chip &amp; pin transactions. <br><br><h2>  Problem: Several cards in the wallet </h2><br>  This is an important point in this attack scenario, because in reality almost no one carries <b>a single card</b> in his pocket.  In most cases, the card is stored in a wallet along with other contactless cards, such as travel tickets or other bank cards. <br><br><div style="text-align:center;"><img width="300" src="https://habrastorage.org/webt/im/x5/j1/imx5j1sci8ml-89qidz1_w8tdow.png" alt="Wallet swollen from cards"></div><br>  Specifically, my Igenico iWL250 terminal, when it detects more than one card with SAK in the action field, indicates support for the 14443-4 protocol, returns an error: ‚Äúpresent one card‚Äù. <br><br>  But not all terminals do this.  For example, VeriFone Savings Bank POS Terminals choose a random card from several.  Some terminals simply ignore all cards, if there are more than one, without showing error messages. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="https://zhovner.com/forever/pos_terminal_declines_few_cards.mp4" type="video/mp4"></video></div></div></div><br>  <i><font color="99999">Attempt to count several cards in the wallet.</font></i>  <i><font color="99999">The POS terminal returns an error.</font></i> <br><br><h3>  Anticollision ISO 14443-3 </h3><br>  Reading one particular card from several is not an easy task at the physical level.  To solve this problem, there is a mechanism of anti-collisions.  It allows you to select one card if a response was received from several cards at once.  This is the very first stage of establishing communication with a contactless card in the ISO-14443A protocol.  At this stage, the reader is not able to find out which of the submitted cards is banking.  The only option is to choose more or less similar to a bank card, based on the answer SAK (Select Acknowledge). <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/_k/ie/yz/_kieyz-qmexulctjyhmfnjyvff8.png"></div>  <i><font color="99999">The value of the bits in the SAK response</font></i> <br><br>  So, for example, the ‚ÄúTroika‚Äù card (Mifare standard) used in Moscow public transport has the value <b>SAK = 0x08 (b00001000)</b> , in which the sixth bit is zero.  While all bank cards in the SAK answers, the sixth bit is 1, which means support for the ISO 14443-4 protocol. <br><br>  Therefore, all that a terminal can do when it detects several cards at the same time is to exclude cards that do not support ISO 14443-4, and choose one similar to a bank card.  Support of the ISO 14443-4 protocol, by the way, does not guarantee that this card will be a bank, but most likely there will not be any other type of cards supporting ISO 14443-4 in the wallet of an ordinary person. <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/4l/q0/e_/4lq0e_bzubjholfmtdiu29fmlxe.png"></div><br>  <i><font color="99999">A block diagram of the operation of the anticollision protocol</font></i> <br><br>  From personal experience: in spite of the presence of the anti-collision protocol, if there are at least three contactless cards in the wallet, it is <b><font color="red">extremely</font></b> difficult to read the correct card <b><font color="red">successfully</font></b> .  Most attempts fail with reading errors.  Moreover, it is difficult to do this on the run, clinging to other people's pockets and bags. <br><br>  However, we will assume that our fraudster is very lucky, and this restriction does not bother him. <br><br><h2>  Offline vs Online Transactions </h2><br>  In the frightening news stories they tell about fraudsters with POS-terminals in subway cars, who write money from your pockets right on the way.  In these plots it is not mentioned where the mobile Internet in the subway car is from.  Perhaps his terminal supports offline transactions? <br><br>  EMV specifications allow for offline transactions.  In this mode, the cancellation takes place without online confirmation from the issuing bank.  It works, for example, in public transport in Moscow and St. Petersburg.  In order not to take a queue at the entrance to the bus, while the terminal completes the online confirmation, you are immediately skipped without checking whether you have enough money in your account to pay for the fare.  At the end of the day, when the Internet appears on the terminal, the signed transactions are sent to the issuing bank.  If it turns out that at this moment you have no money to pay for travel, the card will be added to the stop list at all terminals in the city.  Debt can be repaid through your personal account by card number.  <a href="https://www.avtobus.spb.ru/for-passengers/oplata-bez-kontakta/">Read more</a> about the fare in the bus of St. Petersburg. <br><br>  Personally, I was not able to get a POS terminal that supports this feature, so in the scenario with the usual ‚Äúcivilian‚Äù POS terminal we will not consider the possibility of offline write-offs.  This does not change anything, except that the attacker will need to have Internet access at the terminal, so the attack, for example, in the metro, is much more complicated. <br>  There are terminal models that support WiFi, and in theory our scammer could use WiFi in the subway, after taking care of buying ad-free access to the MAC address of his POS terminal, so as not to have to perform authentication through the captive portal, since on the POS- the terminal cannot do this. <br><br><h2>  Counting profit </h2><br>  In our scenario, the cost of the attack was 100,000 rubles.  This means that in order to at least return investments, our hero needs to complete at least 100 transactions of 1 thousand rubles each.  Imagine that he was rather agile and ran around the city all day, clinging to everyone in a row, so that by the end he made 120 successful write-offs.  We will not take into account the acquiring commission (2% on average), the cashing commission (4-10%) and other commissions. <br><br>  Can he successfully cash out using a card linked to a current account? <br><br>  The reality is not so simple.  <b>Money will be credited to the fraudster account in only a few days!</b>  During this time, our fraudster should hope that none of the one hundred and twenty victims will dispute the transaction, which is highly unlikely.  Therefore, in reality, the fraudster‚Äôs account will be blocked before the money is credited to it. <br><br><blockquote>  <i>If a person noticed that a purchase was made on his card, which he did not make, he should contact the issuing bank and file a claim.</i>  <i>It takes up to 30 days to consider disputable operations on the territory of Russia, and up to 60 days for operations performed abroad.</i>  <i>During this time, the issuing bank sends a request to the acquiring bank, and if the acquiring bank confirms the fact of performing suspicious transactions, the terminal and funds in the current account of the owner of the terminal are blocked.</i> <br><br>  <b>Alexander Paderin, Managing Director of the Information Security Center of the Ural Bank for Reconstruction and Development (UBRD)</b> <br></blockquote><br><h2>  Conclusion </h2><br>  The cost of the attack in our scenario is $ 100,000.  In fact, it will be several times higher, so the fraudster will need much more effort in order to make a profit. <br><br>  In our scenario, a fraudster always charges at 999.99 rubles, which most likely will entail the triggering of the anti-fraud system on the side of the acquiring bank.  In reality, the fraudster will need to write off smaller amounts. <br><br>  To at least recoup the investment, the fraudster will need to handle several hundred victims.  Even if a dozen of them turn to the issuing bank and challenge the transaction, the fraudster's account is likely to be blocked.  A scenario in which the acquiring bank is in collusion with a fraudster is unlikely, because a license to work with an IPU costs much more than any potential profits from this type of fraud. <br><br>  Of the 20 subjects, only three managed to write off money from the card, which is 15% of the success of all attempts.  These were the artificial cases in which only one card was in the pocket.  In cases with a wallet and several cards, the terminal returned an error.  In a scenario with a terminal that uses a modified firmware and implements an anti-collision mechanism, the percentage of successful write-offs may be higher.  However, even in the case of the use of anticollisions, in real conditions on the run, it is so difficult to count one of several cards that successful write-off in such conditions can be considered luck.  In reality, the share of successful write-offs will hardly be higher than 10% of the number of attempts. <br><br><blockquote>  So, despite the fact that in theory such an attack is possible, in practice it turns out to be unprofitable and extremely difficult to implement.  The chance to get at least some profit is so small that it deprives of meaning the whole idea. <br></blockquote><br><h2>  Scenario 2 - Evil POS Terminal </h2><br>  Suppose our scammer works at the checkout in the store or by courier with a mobile POS-terminal.  In this case, he has the opportunity to catch the card data, which, in some case, may be enough to pay online. <br><br>  To begin with, let's look at exactly how a contactless transaction looks and what data the card exchanges with the POS terminal.  Since we are too lazy to read thousands of pages of the <a href="https://www.emvco.com/emv-technologies/contactless/">EMV Contactless Specifications</a> documentation, we simply intercept the exchange at the physical level using the HydraNFC sniffer. <br><br>  There is some difference between the EMV specification for MasterCard PayPass and Visa payWave.  This is the difference in the format of the signature and some data.  But for us it is irrelevant. <br><br><h2>  NFC sniffer </h2><br><img src="https://habrastorage.org/webt/bs/sx/oy/bssxoy5b-wmgyab33hakrihmfyc.png"><br>  <a href="https://hydrabus.com/hydranfc-1-0-specifications/">HydraNFC</a> is a fully open-source standalone ISO-14443A sniffer that saves captured APDU commands to an SD card.  The sniffer antenna is placed between the terminal and the card, and passively captures all the transmitted information. <br><br>  ‚Üí <a href="https://hydrabus.com/">Website about HydraBus and HydraNFC shild</a> <br>  ‚Üí <a href="https://github.com/hydrabus/hydrafw/">firmware sources</a> <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="https://zhovner.com/forever/hydranfc_pos_terminal_sniff.mp4" type="video/mp4"></video></div></div></div><br>  <i><font color="99999">Demonstration of the interception of exchange between the POS-terminal and the phone with Apple Pay</font></i> <br><br>  Looking ahead, I must say that at this level, payment by phone and a regular plastic card is no different.  For a POS terminal, this is a regular VISA card.  However, payment by telephone is much safer than with a physical card, and we will further examine why. <br><br><h2>  EMV protocol parsing </h2><br>  Here‚Äôs what a recorded dump looks like when paying for chocolates and a bottle of water with a total cost of 142.98 rubles using Apple Pay: <br><br><div class="spoiler">  <b class="spoiler_title">Raw data from a sniffer (open spoiler)</b> <div class="spoiler_text"><a href=""><img width="200" src="https://habrastorage.org/webt/ia/by/xg/iabyxg1ocokwqruiq9ew3qmwqws.png"></a><br>
<i><font color="99999">      ()</font></i><br>
<br>
<b>R (READER)</b> ‚Äî POS-<br>
<b>T (TAG)</b> ‚Äî  (   )<br>
<code>R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
T&lt;&lt; 04 00<br>
R&gt;&gt; 93 20 <br>
T&lt;&lt; 08 fe e4 ec fe <br>
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e <br>
T&lt;&lt; 20 fc 70 <br>
R&gt;&gt; 50 00 57 cd <br>
R&gt;&gt; 26 <br>
R&gt;&gt; 52 <br>
T&lt;&lt; 04 00 <br>
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e <br>
T&lt;&lt; 20 fc 70 <br>
R&gt;&gt; e0 80 31 73 <br>
T&lt;&lt; 05 78 80 70 02 a5 46 <br>
R&gt;&gt; 02 00 a4 04 00 0e 32 50 41 59 2e 53 59 53 2e 44 44 46 30 31 00 e0 42 <br>
T&lt;&lt; 02 6f 23 84 0e 32 50 41 59 2e 53 59 53 2e 44 44 46 30 31 a5 11 bf 0c 0e 61 0c 4f 07 a0 00 00 00 03 10 10 87 01 01 90 00 4b b3 <br>
R&gt;&gt; 03 00 a4 04 00 07 a0 00 00 00 03 10 10 00 bc 41 <br>
T&lt;&lt; 03 6f 31 84 07 a0 00 00 00 03 10 10 a5 26 9f 38 18 9f 66 04 9f 02 06 9f 03 06 9f 1a 02 95 05 5f 2a 02 9a 03 9c 01 9f 37 04 bf 0c 08 9f 5a 05 60 08 40 06 43 90 00 1d 66 <br>
R&gt;&gt; 02 80 a8 00 00 23 83 21 36 a0 40 00 00 00 00 01 42 98 00 00 00 00 00 00 06 43 00 00 00 00 00 06 43 18 09 18 00 e0 11 01 03 00 f9 14 <br>
T&lt;&lt; 02 77 62 82 02 00 40 94 04 18 01 01 00 9f 36 02 02 06 9f 26 08 d6 f5 6b 8a be d7 8f 23 9f 10 20 1f 4a ff 32 a0 00 00 00 00 10 03 02 73 00 00 00 00 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9f 6c 02 00 80 57 13 48 00 99 72 50 51 17 56 d2 31 22 01 00 00 05 20 99 99 5f 9f 6e 04 23 88 00 00 9f 27 01 80 90 00 af c8 <br>
R&gt;&gt; 03 00 b2 01 1c 00 c9 05 <br>
T&lt;&lt; 03 70 37 5f 28 02 06 43 9f 07 02 c0 00 9f 19 06 04 00 10 03 02 73 5f 34 01 00 9f 24 1d 56 30 30 31 30 30 31 34 36 31 38 30 34 30 31 37 37 31 30 31 33 39 36 31 36 37 36 32 35 90 00 a7 7b <br>
</code><br>
</div></div><br>
        . <br>
<br>
<b>R&gt;&gt; ‚Äî ,  POS- </b><br>
<b>T&gt;&gt; ‚Äî ,   (     Apple Pay) </b><br>
<br>
<h3>14443-A Select</h3><br>
          .  ,       OSI,        L2,  UID (Unique Identifier)   MAC- . <br>
<br>
<blockquote>   ISO-14443:<br>
<b>PCD</b> (proximity coupling device) ‚Äî  ,     POS-<br>
<b>PICC</b> (proximity integrated circuit card) ‚Äî ,        <br>
</blockquote><br>
      Apple Pay  ,              .      ,     ,     ,     .        ,     ,     .<br>
<br>
<pre><code class="plaintext">R&gt;&gt; 52 // WUPA (wake up)
R&gt;&gt; 52 // WUPA
R&gt;&gt; 52 // WUPA
R&gt;&gt; 52 // WUPA
R&gt;&gt; 52 // WUPA
R&gt;&gt; 52 // WUPA
R&gt;&gt; 52 // WUPA
T&lt;&lt; 04 00 // ATQA (Answer To Request type A) 
R&gt;&gt; 93 20 // Select cascade 1 (Anti Collision CL1 SEL)
T&lt;&lt; 08 fe e4 ec fe // UID (4 bytes) + BCC (Bit Count Check)
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e // SEL (select tag 0x9370) + UID + CRC16
T&lt;&lt; 20 fc 70  // SAK (Select Acknowledge 0x20) + CRC16 
R&gt;&gt; 50 00 57 cd // HALT (Disable communocaion 0x5000) + CRC16
R&gt;&gt; 26 // REQA
R&gt;&gt; 52 // WUPA
T&lt;&lt; 04 00 // ATQA
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e // SELECT
T&lt;&lt; 20 fc 70 // SAK
R&gt;&gt; e0 80 31 73 // RATS (Request Answer to Select 0xE080) + CRC16
T&lt;&lt; 05 78 80 70 02 a5 46 // ATS (Answer to select response)
</code></pre><br>
    <b>0x52</b> Wake-up (WUPA),        ,    Answer To Request type A (ATQA),     <b>0x04 0x00</b>.  ATQA       . <br>
<br>
  ATQA,     ,  ,        .  <b>0x93 0x20</b> Select cascade level 1 (SEL CL1)             UID.<br>
<br>
  <b>0x08 0xFE 0xE4 0xEC 0xFE</b>,    ‚Äî UID   Apple Pay    <b>0xFE</b> Bit Count Check (BCC)  .<br>
<br>
  ,       <b>0x93 0x70</b> (SELECT).    UID  <b>0x08 0xfe 0xe4 0xec</b> + <b>0xfe</b> BCC + <b>0xdd 0x6e</b> CRC16.<br>
<br>
  <b>0x20</b> Select Acknowledge (SAK) + <b>0xfc 0x70</b> CRC16.<br>
<br>
       SAK,     UID   SELECT,     . ,   ,  POS-  ,      ,      .<br>
<br>
<blockquote> UID   4, 7  10 .    ,   ,      Apple Pay, UID   4 . ,  Apple Pay   UID   ,     ,  UID  . ,     ,         ,       UID     . <br>
</blockquote><br>
   <b>0x50 0x00</b> HALT + <b>0x57 0xcd</b> CRC16.    .<br>
<br>
   ,     (WUPA),     ,   SELECT.    ‚Äî  , ,  -     .<br>
<br>
       <b>0xE0 0x80</b> Request Answer to Select (RATS) + <b>0x31 0x73 </b>CRC16.<br>
<br>
  <b>0x05 0x78 0x80 0x70 0x02</b> Answer to select response (ATS) + <b>0xA5 0x46</b> CRC16. <br>
<br>
<b><a href="https://de.wikipedia.org/wiki/Answer_to_Select">Answer to select</a></b> ‚Äî   Answer To Reset (ATR)   .            . <br>
<br>
   ¬´¬ª  ,       ,    ,   .  SELECT       ISO 14443A,    NFC-,    ,  .. <br>
<br>
<h4>   ‚Äî SELECT PPSE</h4><br>
<font color="grey"> : <a href="https://www.emvco.com/wp-content/plugins/pmpro-customizations/oy-getfile.php%3Fu%3D/wp-content/uploads/documents/EMVCo_PPSE_and_Application_Mgmt_for_SE_v1.0-1.pdf">EMV Contactless Specifications ‚Äî PPSE and Application Management for Secure Element</a></font><br>
<br>
   EMV-     PPSE (Payment System Environment).    ,      . <br>
<br>
    ,     ‚Äî VISA.       , ,          .        ,      ,    .       JCB  UnionPay.    . <br>
<br>
<b>APDU- SELECT PPSE</b><br>
<br>
<pre><code class="cpp">'00 A4 04 00 0E 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 00'
  00 A4 04 00 //  select 
   0E //  command data (14 )
    32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 // command data 2PAY.SYS.DDF01
    00 //  
</code></pre><br>
<b>  SELECT PPSE</b><br>
<br>
<pre><code class="cpp">'6F 23 84 0E 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 A5 11 BF 0C 0E 61 0C 4F 07 A0 00 00 00 03 10 10 87 01 01 90 00'</code></pre><br>
      -  TVL <a href="https://iso8583.info/lib/EMV/TLVs">iso8583.info/lib/EMV/TLVs</a>.   ,  :<br>
<br>
<img width="900" alt="EMV SELECT PPSE VISA RESPONE parsed" src="https://habrastorage.org/webt/yi/x_/_y/yix__y6me7kqdg9inwi05eyk1yq.png"><br>
         (AID).   ,   <b>A0000000031010</b>,  Visa International. <br>
<br>
AID   <b>4F</b>.       ,   .   ,   AID    5  16 ,      7 . <br>
<br>
  AID: <a href="https://www.eftlab.co.uk/index.php/site-map/knowledge-base/211-emv-aid-rid-pix">eftlab.co.uk/knowledge-base/211-emv-aid-rid-pix</a><br>
<br>
  AID<br>
<br>
<pre><code class="plaintext">A0000000031010 Visa International
A0000000032020 Visa International
A0000000041010 Mastercard International
A0000000043060 Mastercard International United States Maestro (Debit)
</code></pre><br>
Application Priority Indicator ‚Äî    . ,    ,     ,   ,     .        Visa International,    ,   .<br>
<br>
<b>   ‚Äî SELECT AID</b><br>
<br>
<pre><code class="cpp">'00 A4 04 00 07 A0 00 00 00 03 10 10'
  00 A4 04 00 //  select 
   07 //  command data (7 )
    A0 00 00 00 03 10 10 // AID Visa International
</code></pre><br>
   ,   . <br>
<br>
<h4> PDOL (Processing Options Data Object List)</h4><br>
<pre><code class="cpp">'6f 31 84 07 a0 00 00 00 03 10 10 a5 26 9f 38 18 9f 66 04 9f 02 06 9f 03 06 9f 1a 02 95 05 5f 2a 02 9a 03 9c 01 9f 37 04 bf 0c 08 9f 5a 05 60 08 40 06 43 90 00'
</code></pre><br>
  <br>
<br>
<img src="https://habrastorage.org/webt/lo/jr/dh/lojrdhsptl6kkauc02a5c0qwnme.png"><br>
         ,      ‚Äî PDOL (Processing Options Data Object List).         . <br>
<br>
PDOL     .    PDOL ‚Äî  .    PDOL   <a href="https://www.eftlab.co.uk/index.php/site-map/knowledge-base/145-emv-nfc-tags"></a>.<br>
<br>
 PDOL . ,    ‚Äî         .       .<br>
<br>
  PDOL:<br>
<br>
<pre><code class="cpp">9F 38 18 //   PDOL.  18 (24 ) 
 9F 66 ( 04) // Terminal Transaction Qualifiers (TTQ).    . 
  9F 02 ( 06) //  
   9F 03 ( 06) //  
   9F 1A ( 02) //     ISO3166-1
   95 ( 05) // Terminal Verification Results
    5F 2A ( 02) //  ,    ,   ISO4217
     9A ( 03) //    YYMMDD
      9C ( 01) //   
       9F 37 ( 04) //   
</code></pre><br>
            .<br>
<br>
<h4>    ‚Äî GET PROCESSING OPTIONS </h4><br>
<pre><code class="cpp">'80A8000023832136A0400000000001429800000000000006430000000000064318091800E011010300'
 80 A8 00 00 //  GET PROCESSING OPTIONS (GPO)
  23 //    (35 )
   83 //  PDOL-
    21 //  PDOL- (33 )
     36 A0 40 00 // Terminal Transaction Qualifiers (TTQ)
      00 00 00 01 42 98 //   (142,98 )
       00 00 00 00 00 00 //   
        06 43 //    (643 - )
         00 00 00 00 00 // Terminal Verification Results (TVR)
          06 43 //  (643 - russian ruble) 
           18 09 18 //  (18  2018 )
            00 //  
             E0 11 01 03 //   
</code></pre><br>
    ,  ,    ,       142,98 .        (E0110103).   <a href="https://www.emvlab.org/emvtags/show/t9F37/">9F37 Unpredictable Number</a>.    .              .             replay .<br>
<br>
<h4>   GET PROCESSING OPTIONS </h4><br>
<pre><code class="cpp">'7762820200409404180101009F360202069F2608D6F56B8ABED78F239F10201F4AFF32A00000000010030273000000004000000000000000000000000000009F6C02008057134800997250511756D23122010000052099995F9F6E04238800009F2701809000'
</code></pre><br>
      VISA  ,     c  <a href="https://iso8583.info/lib/VISA/VCPS/">VISA Contactless Payment Specification (VCSP)</a>.<br>
<br>
<img width="600" src="https://habrastorage.org/webt/n-/b0/la/n-b0laaskytjo0ahyyvlo6e7js0.png"><br>
<br>
Application Interchange Profile (AIP) ‚Äî      .    AIP  <b>00 40</b>.      <a href="https://www.emvco.com/wp-content/uploads/2017/05/EMV_v4.3_Book_3_Application_Specification_20120607062110791.pdf">EMV 4.3 Book 3</a>. <br>
<br>
<div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/rp/tc/ya/rptcyalvdwd6oaycintkbt02krq.png"></div><br>
        , ,    , Reserved For Future Use (RFU).   ,       Apple Pay,   .<br>
<br>
 AIP        (SDA,CDA,DDA) .          ‚Äî   .<br>
<br>
Application File Locator (AFL) ‚Äî      (SFI range of records)   AID.        READ RECORD.<br>
<br>
  AFL :<br>
<br>
Short File Identifier (SFI)  0x18.       .   0x18 (b00011000)   b00000011,   0x3.<br>
First record = 1<br>
Last record = 1<br>
..  ¬´¬ª ‚Ññ3    1  1,    .<br>
<br>
Application Transaction Counter (ATC) ‚Äî   ,         GET PROCESSING OPTIONS.    0xFFFF  0x7FFF,    . ,          .    ,     Apple Pay     518 (0x206) .<br>
<br>
Application Cryptogram (AC) ‚Äî  ,        .        -,       .       ( )   ,      .<br>
 <br>
Issuer Application Data (IAD) ‚Äî   ,   VISA. <i><font color="99999">     , .</font></i><br>
<br>
Card Transaction Qualifiers (CTQ) ‚Äî   VISA c   . ,            ,      .<br>
<br>
<img align="right" width="200" src="https://habrastorage.org/webt/vd/aw/ny/vdawnyz0tkkjbs-rradkbk0loiy.png">Track 2 Equivalent Data ‚Äî <font color="red">!</font>        expiration date,      .<br>
<br>
Form Facto Indicator (FFI) ‚Äî   VISA .  -    .    ,    .<br>
<br>
Cryptogram Information Data (CID) ‚Äî <i><font color="99999">     , .</font></i><br>
<br>
<h4> READ DATA RECORD</h4><br>
<pre><code class="cpp">'00 b2 01 1c 00'
</code></pre><br>
     ,   AFL:<br>
<br>
<img src="https://habrastorage.org/webt/od/jw/mv/odjwmvemclc5gd4q6dhvlcmqfjy.png"><br>
  ,    <b>0x1C</b>     ,      0x18 (b000011),   SFI,      0x04 (d100),    .<br>
<br>
<h2>  READ RECORD</h2><br>
<pre><code class="cpp">'70375F280206439F0702C0009F19060400100302735F3401009F241D5630303130303134363138303430313737313031333936313637363235'
</code></pre><br>
<img src="https://habrastorage.org/webt/x9/ke/vv/x9kevvho_se85wg6vlgkwrd4jtw.png"><br>
<br>
Application Usage Control (AUC) ‚Äî ,     ,    .<br>
<br>
<i><font color="99999">9F19 ‚Äî - ,    ‚Äî  Dynamic Data Authentication Data Object List (DDOL)</font></i><br>
<br>
EMV Tokenisation, Payment Account Reference (PAR) ‚Äî    ()  . <i><font color="99999">     , .</font></i><br>
<br>
<h1>     ?</h1><br>
         Apple Pay c   VISA.  MasterCard  ,    .   ,    ,     replay-.<i><font color="99999">        Magnetic Stripe (MSD),      replay-,         ,  ,   ,      ,   .</font><br>
</i><br>
<img src="https://habrastorage.org/webt/ys/kk/8_/yskk8_eztdatvwiziqusnqsa2ee.png"><br>
<i><font color="99999">       (PAN)    (expiration date) </font></i><br>
<br>
 ,          expiration date.  CVV     ,         -.       ,      <b>  PAN   ,     !</b><br>
<br>
<h2>    CVV (CNP, MO/TO)</h2><br>
    <a href="https://habr.com/post/347574/">¬´ Apple Pay        ¬ª</a>     Apple Pay    , ,     10     .          ,    expiration date.    ,       .  ,   .<br>
<br>
<img src="https://habrastorage.org/webt/ue/-q/wt/ue-qwtah0au0uftojwdu8qsrs3m.png"><br>
<i><font color="99999">    Amazon   CVV</font></i><br>
<br>
    ,      ,    Apple Pay      Client Present (CP),      .             Card not present (CNP),      . - ! <br>
<br>
<font color="r">    , ,       Apple Pay         ,    .      5  .     :)<br>
<br>
<h2> Apple Pay   </h2><br>
<div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/jz/cn/2n/jzcn2ndu1pfw-znat4mxtab6k8k.png"></div><br>
<i><font color="99999">Apple Pay vs   </font></i><br>
<br>
<ul>
<li> <b>Apple Pay   (  )    .</b>            POS-.  , ¬´¬ª        ,       ,   ,     ,   ,   .  Apple Pay  ,            ,       .</li>
<li><b>     </b> ‚Äî    Apple Pay      (13,56 ),   ,           .       .     Apple Pay     ,     .</li>
<li><b>       </b> ‚Äî         Card not present (CNP),      ,    ..     Apple Pay    . </li>
<li><b>   </b> ‚Äî        (Cardholder name)    .   ,   ,    .  Apple Pay    . </li>
</ul><br>
<h2></h2><br>
     .     ,         .         <a href="https://toster.ru/q/543598">   </a>.<br>
<br>
  , Apple Pay     .      CNP- (  )    ,         .<br>
<br>
<hr><br>
 :<br>
<br>
<ul>
<li> <a href="http://tehpos.ru/">tehpos.ru</a>   .</li>
<li><a href="https://www.ubrr.ru/">    </a>,     (    )  .</li>
<li> <a href="https://aj.ru/">aj.ru</a>     .</li>
<li> <a href="https://www.behance.net/aquamine">Aquamine</a>    .</li>
<li> <a href="https://habr.com/ru/users/jrun/" class="user_link">JRun</a>  Digital Security   .</li>
<li> <a href="https://habr.com/ru/users/alexgre/" class="user_link">AlexGre</a>     EMV.</li>
<li> <a href="https://habr.com/ru/users/shape/" class="user_link">shape</a>    EMV: <a href="https://iso8583.info/">iso8583.info</a></li>
</ul></font></div><p>Source: <a href="https://habr.com/ru/post/422551/">https://habr.com/ru/post/422551/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../422541/index.html">The drama of the holes in the "Union" turned into a phantasmagoria</a></li>
<li><a href="../422543/index.html">Think like a programmer. Problem solving lesson</a></li>
<li><a href="../422545/index.html">Ways to synchronize browser tabs</a></li>
<li><a href="../422547/index.html">To eliminate Specter and Meltdown, you may have to create a completely new type of processor.</a></li>
<li><a href="../422549/index.html">Corda: Kotlin</a></li>
<li><a href="../422553/index.html">Official browser extension Mega stole data and cryptocurrency of file sharing users</a></li>
<li><a href="../422555/index.html">Multi-modality in Android in terms of architecture. From A to Z</a></li>
<li><a href="../422561/index.html">How Yandex used computer vision to improve the quality of video broadcasts. DeepHD technology</a></li>
<li><a href="../422565/index.html">Friday's Skillbox webinars: everything for programmers and designers</a></li>
<li><a href="../422569/index.html">Hourly, time tracking app</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>