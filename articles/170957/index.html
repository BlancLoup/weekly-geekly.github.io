<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DMARC: protect your newsletter from fakes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Have you encountered the problem that emails from your service are faked for the purpose of extorting a password or other confidential data? Every day...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DMARC: protect your newsletter from fakes</h1><div class="post__text post__text-html js-mediator-article">  Have you encountered the problem that emails from your service are faked for the purpose of extorting a password or other confidential data?  Every day, thousands of spam, phishing and fraudulent emails that hackers disguise as messages from well-known services try to break through to users. <br><br>  Such letters cause damage to the addressees, which ultimately affects the reputation of both respectable services and mail providers. <br><br>  Now we are giving services that are conducting their mailings the opportunity to defend themselves against such fakes with the help of <a href="http://ru.wikipedia.org/wiki/DMARC">DMARC</a> technology (dmarc.org), which we were the first to support among the major mail services in runet. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/04f/c83/86b/04fc8386b53bd8db4b7fd80769c2589a.jpg"><br><br><a name="habracut"></a><h5>  How DMARC works </h5><br><br>  The essence of the technology is simple: you, as the owner of the domain from which you are mailing, can register in the DNS of your domain a policy defining what to do with letters that are considered fake. <br><br>  Emails can be missed, put in the Spam folder, or not accepted at all by the mail server. <br><br>  For this technology to work, you need to configure SPF for your domain and sign each letter with a DKIM signature.  In this case, the DKIM domain must match the domain in the From header. <br><br>  When receiving a letter, our server will check the validity of SPF and DKIM.  In case the validation of both DKIM and SPF is not passed, the DMARC policy of your domain will be applied to the letter. <br><br><h5>  I already want.  What should I do? </h5><br><br>  The first thing to do is decide how DMARC will be implemented.  We recommend doing it not immediately, but gradually: <br><br><ul><li>  At first, enable only receiving reports and skip all emails.  This is necessary to ensure that all letters are correctly signed. </li><li>  Next, you can enable the application of the policy only for some small percentage of traffic using the pct option </li><li>  If no problems are found in the reports, you can include a 100% policy. </li></ul><br><br>  Such a step-by-step approach will allow identifying problems with DKIM-signature, if any, in time and correct them before the policy is deployed to 100%. <br><br>  To enable the DMARC policy, you need to place a new TXT record in the DNS records of your site: <br><br><pre><code class="java hljs">_dmarc.exampledomain.ru. <span class="hljs-number"><span class="hljs-number">3600</span></span> IN TXT <span class="hljs-string"><span class="hljs-string">"v=DMARC1; p=none; rua=mailto:postmaster@exampledomain.ru "</span></span></code> </pre> <br><br>  In this form, the record means that all fake letters should be skipped, and reports should be sent to the mailbox postmaster@exampledomain.ru;  exampledomain.ru must be replaced with your domain. <br><br>  If you want to receive reports on a domain that does not match the DMARC domain, you need to place a TXT record for a special type of mail domain.  Suppose your domain with DMARC is exampledomain.ru, and you want to receive reports for the test.ru domain.  In this case, it is necessary to add a TXT-record in the DNS domain of the test.ru domain: <br><br><pre> <code class="java hljs">exampledomain.ru._report._dmarc.test.ru. <span class="hljs-number"><span class="hljs-number">3600</span></span> IN TXT <span class="hljs-string"><span class="hljs-string">"v=DMARC1"</span></span></code> </pre> <br><br>  At the moment we support sending only aggregated reports.  Sending samples that did not pass the test will be launched later. <br><br><h5>  What does a report look like? </h5><br><br>  Daily aggregated reports come in XML format from the address dmarc_support@corp.mail.ru. <br><br>  Below is an example of a report stating that 20 emails were sent from the same IP address, and they all passed the test. <br><pre> <code class="java hljs">&lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;<span class="hljs-number"><span class="hljs-number">1361304000</span></span>&lt;/begin&gt; &lt;end&gt;<span class="hljs-number"><span class="hljs-number">1361390400</span></span>&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support<span class="hljs-meta"><span class="hljs-meta">@corp</span></span>.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http:<span class="hljs-comment"><span class="hljs-comment">//corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</span></span></code> </pre><br>  There are many ready-made tools that make the processing of these reports more convenient.  You can find them on the DMARC website: <a href="http://www.dmarc.org/resources.html">http://www.dmarc.org/resources.html</a> . <br><br><h5>  What's next? </h5><br><br>  More information about configuring DMARC can be found in the <a href="http://help.mail.ru/mail-help/postmaster/dmarc">http://help.mail.ru/mail-help/postmaster/dmarc</a> help.  Include and comment - we will be grateful for questions, comments and ideas. <br><br>  <i>Denis Anikin,</i> <i><br></i>  <i>Technical Director Mail Mail.Ru</i> <i><br></i> </div><p>Source: <a href="https://habr.com/ru/post/170957/">https://habr.com/ru/post/170957/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../170937/index.html">Migration to Grunt v0.4</a></li>
<li><a href="../170945/index.html">Mobile Development Tools</a></li>
<li><a href="../170949/index.html">Wi-Fi with username and password for each user or do WPA2-EAP / TLS with improvised tools</a></li>
<li><a href="../170951/index.html">Badoo development process</a></li>
<li><a href="../170953/index.html">Pantech Burst - androidphone at a nice price</a></li>
<li><a href="../170959/index.html">Railgun protocol for traffic compression</a></li>
<li><a href="../170967/index.html">Color Management and UI Design</a></li>
<li><a href="../170975/index.html">QR Ladybird miniature unmanned multi-rotor ‚ÄúBug‚Äù</a></li>
<li><a href="../170977/index.html">Remote work - sucks. Long live the remote work!</a></li>
<li><a href="../170981/index.html">The start date of LeapMotion sales has become known.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>