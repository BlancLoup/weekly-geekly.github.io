<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Flash memory: problems for computer forensics</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the end of 2010, Graeme Bell and Richard Boddington published ‚ÄúSolid State Drives: The Solid State Drives: The Beginning of the End to Existing For...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Flash memory: problems for computer forensics</h1><div class="post__text post__text-html js-mediator-article">  At the end of 2010, Graeme Bell and Richard Boddington published <a href="http://www.jdfsl.org/subscriptions/JDFSL-V5N3-Bell.pdf">‚ÄúSolid State Drives: The Solid State Drives: The Beginning of the End to</a> Existing <a href="http://www.jdfsl.org/subscriptions/JDFSL-V5N3-Bell.pdf">Forensic</a> Data Recovery Techniques?‚Äù online communities.  And although the feature of the work of solid-state drives discussed in this article was first <a href="http://www.youtube.com/watch%3Fv%3DWcO7xn0wJ2I">announced in 2008 at the DEFCON 16 conference</a> , investigated by Microsoft and presented at the conference of developers of computer storage media in 2009 [1, 6th slide] and even mentioned in Russian seminars in 2010 [2, slides 10 and 11], recognition of the problem and a serious discussion of these features in the forensic community took place in March 2011. <br><br>  In this article I will try to tell about the features of the work of storage media based on the use of flash memory through the prism of computer forensics. <br><a name="habracut"></a><br><h4>  Briefly about computer forensics </h4><br>  The main focus of computer forensics is the study of computer-readable media with the aim of generating forensic evidence (conducting forensic computer and computer technical expertise) and collecting operational information that is not used as evidence in court.  Conventionally, computerized forensic science may also include related areas in which the study of computer information has an important role: the investigation of information security incidents in organizations, the study of information carriers for military (combat) purposes, etc. <br><br>  Since a forensic investigation of machine-readable media in a large number of cases is carried out to obtain forensic evidence, the method of conducting such investigations should ensure verification of the results by repeated research (this requirement is fixed in article 57 of the Criminal Procedure Code of the Russian Federation: <i>‚Äúthe expert does not have the right ... to conduct permissions of the inquiry officer, investigator, trial of the investigation, which may entail complete or partial destruction of objects or changes in their appearance or basic properties "</i> ).  With regard to the study of computer information requirements for repeatability of results are expressed in ensuring the immutability of information (although some scientists prefer to use the term <i>"integrity of information"</i> ) by various means: <br><ul><li>  software write locks that block any write commands sent to the examined storage medium by the operating system (on Linux, the software write lock can be feedback devices created in read-only mode using the ‚Äú <i>mount -o ro, loop / dev / &lt;device &gt; &lt;mount point&gt; "</i> ); </li><li>  hardware recording blockers that perform the same functions, but do not require the installation of any software (in simpler words: intermediary devices between computers and storage media, filtering transmitted commands); </li><li>  specialized operating systems that, in the process of loading and working, do not send write commands to connected media. </li></ul><br><h4>  The development of computer forensics in the initial stage </h4><br>  The development of forensic computer research methods can be identified by the following trends: <br><ul><li>  confirmation of the immutability (integrity) of the studied data by cryptographic hash functions; </li><li>  ensuring the immutability of the studied data by compulsory use of recording blockers or by researching forensic copies of information carriers created by copying the contents of one medium to another (sometimes such copies are called <i>bitwise</i> or <i>sector-by-sector</i> ); </li><li>  popularization of the indicated tendencies, their fixation in the methods of conducting judicial research. </li></ul><br>  It is not difficult to understand that the development of computer forensic science is influenced by the static nature of the contents of computer-readable media, which can be expressed in the form of a simple principle: <b>‚Äúthe data is changed only by a command‚Äù</b> .  This principle applies to floppy disks, hard disk drives and other ‚Äútraditional‚Äù media types, and changing the contents of these media without a command should be regarded as a malfunction (the appearance of bad sectors). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Of course, changing service data (SMART parameters) is not a serious problem, since such service information is rarely used in forensic science to solve any problems (and changing it is not considered critically, unlike changing file systems). <br><br><h4>  The development of flash memory through the prism of criminology </h4><br>  The massive use of flash memory in removable and non-removable computer storage media was made possible by solving the problem of wear of flash memory cells, which limits the number of possible cleaning cycles (rewriting) of individual memory blocks and significantly reduces flash memory resource due to uneven data recording in common file systems (some parts of the data are overwritten more often than others). <br><br>  To solve this problem, flash memory manufacturers began to use the wear leveling method, which consists in moving data from the most worn-out memory areas to less worn-out ones.  This process can be performed at the file system level or at the controller level: in the first case, the data is redistributed by the driver of the special file system, in the second case, the data is redistributed by the controller of the information carrier transparently to the operating system (the controller provides the necessary byte order when reading, that is, it recreates the original data structure due to the use of the correspondence table of logical memory addresses to the physical position of the memory cells). <br><br>  Flash memory, for leveling the wear of which you need to install an additional driver into the system and use a special file system, was not widely used among ordinary users, and the controller most commonly used are wear leveling algorithms. <br><br>  Thus, even when working with flash memory in ‚Äúread only‚Äù mode, there is a constant redistribution of data by the controller.  However, this process is completely transparent to the operating system and readers, therefore, there is no particular difficulty in conducting forensic studies of flash memory (although at the physical level, the data are redistributed, but at the logical level, they are static) if it were not for the two large <b>BUT</b> : <br><ol><li>  USB flash drives sometimes do not electrically connect blocks of memory cells until the first write command to these blocks [4]; </li><li>  effective wear leveling requires the presence of additional (backup) memory areas, as which it is advisable to use free (unoccupied) parts of these file systems. </li></ol><br>  The first ‚Äúbut‚Äù leads to the fact that when reading the unrecorded parts of the USB Flash drives, <i>random data</i> (noise) is <i>returned</i> , which, as it should be expected, changes with each reading. <br><br>  The second ‚Äúbut‚Äù leads manufacturers of solid-state drives (SSD) to the problem of (already solved) the definition and use of free (unoccupied) parts of these file systems for equalizing wear. <br><br>  These features are a <i>serious violation</i> of the ‚Äúdata change only on command‚Äù principle, on which modern computer forensics is based.  Moreover, the use of free (unoccupied) portions of file systems that contain deleted files and data from previous file systems to equalize the wear and tear results in serious data recovery problems (since the controller cleans it before using the free data portion, i.e. there is a destruction of deleted data, inherently similar to the overwriting of files with special programs). <br><br><h6>  How does flash wear leveling work using unallocated filesystem space? </h6><br>  <i>The simplified work algorithm can be described in several lines:</i> <br>  Flash memory cells that correspond (at the logical level) to data sections not used by the file system to store information in an explicit form are cleared, references to them are deleted (i.e., the operating system can no longer read the contents of these cells by reading the corresponding sections data), then cells are used to reallocate data at the physical level.  If at the time of cleaning the cells contained fragments of deleted files or previous file systems, then these data are deleted irretrievably (overwritten). <br><br>  In this case, the most interesting are the ways for the flash drive controller to detect the free portions of these file systems: <br><ul><li>  Trim ATA Detection [3]: The operating system that supports this ATA command automatically sends information about unused data to the controller when you delete files or formatting that you can use to level out wear; </li><li> detection by processing file system structures by a flash drive controller: the controller reads the stored data without the operating system, processes the structures of the most common file systems (for example: FAT), and identifies unallocated data that can be cleaned and used to smooth out wear. </li></ul><br>  It should be noted that this method of wear leveling is not used in modern USB Flash drives, but is used only in solid-state drives. <br><br><h4>  And how does this threaten computer forensics? </h4><br>  From the above principles of flash wear leveling, we can draw two conclusions: <br><ul><li>  the contents of flash memory can be changed on a logical level even when connecting storage media using write blockers or when mounting file systems in read-only mode; </li><li>  solid-state drives, self-identifying and using free (unallocated) space of file systems, lead to the rapid destruction of deleted data. </li></ul><br>  And form the following general principles of forensic work with flash memory: <br><ul><li>  you cannot use hash functions to confirm the immutability (integrity) of the contents of flash drives; </li><li>  the use of software and hardware write blockers does not ensure the immutability (integrity) of the studied data when working with flash drives; </li><li>  recovering deleted data from SSDs can be difficult; </li><li>  the only way to guarantee the immutability of the contents of flash memory during the study is to evaporate the memory modules and read them, followed by software data reconstruction using special software and hardware data recovery complexes. </li></ul><br><h4>  Links </h4><br><ol><li>  <a href="http://www.snia.org/events/storage-developer2009/presentations/thursday/NealChristiansen_ATA_TrimDeleteNotification_Windows7.pdf">Neil Christiansen.</a>  <a href="http://www.snia.org/events/storage-developer2009/presentations/thursday/NealChristiansen_ATA_TrimDeleteNotification_Windows7.pdf">ATA Trim / Delete Notification Support in Windows 7</a> (PDF). </li><li>  <a href="http://cryptanalysis.ru/RISSPA-Suhanov-2010-2.pdf">Sukhanov Maxim.</a>  <a href="http://cryptanalysis.ru/RISSPA-Suhanov-2010-2.pdf">Problems of computer forensics and how to solve them</a> (PDF). </li><li>  <a href="http://t13.org/Documents/UploadedDocuments/docs2008/e07154r6-Data_Set_Management_Proposal_for_ATA-ACS2.doc">Data Set Management Commands Proposal for ATA8-ACS2</a> (DOC). </li><li>  <a href="http://www.forensicfocus.com/index.php%3Fname%3DContent%26pid%3D366">Dominic Weber.</a>  <a href="http://www.forensicfocus.com/index.php%3Fname%3DContent%26pid%3D366">Flash drives and acquisition</a> . </li></ol></div><p>Source: <a href="https://habr.com/ru/post/115384/">https://habr.com/ru/post/115384/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../115376/index.html">SMS fraud from VKontakte</a></li>
<li><a href="../115379/index.html">Apple Interface Design Guide</a></li>
<li><a href="../115380/index.html">Video GarageBand for iPad</a></li>
<li><a href="../115381/index.html">Drawing in QT</a></li>
<li><a href="../115382/index.html">The Japanese still made another revolution in games</a></li>
<li><a href="../115385/index.html">Action Request System: Introduction</a></li>
<li><a href="../115386/index.html">Inventory management for small online stores</a></li>
<li><a href="../115387/index.html">Zen Coding v0.7</a></li>
<li><a href="../115388/index.html">Reverse engineering: tvali.ge service</a></li>
<li><a href="../115389/index.html">Single entry point to the web application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>