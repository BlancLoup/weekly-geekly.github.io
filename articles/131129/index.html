<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Return codes vs exception: a view from the bell tower</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After reviewing the post Return codes vs exceptions and comments to it, I noticed that one thread was missed in the discussion, the short thesis of wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Return codes vs exception: a view from the bell tower</h1><div class="post__text post__text-html js-mediator-article">  After reviewing the post <a href="http://habrahabr.ru/blogs/programming/130611/">Return codes vs exceptions</a> and comments to it, I noticed that one thread was missed in the discussion, the short thesis of which is the following: in some languages ‚Äã‚Äãthis problem is not even worth it, because  The question ‚Äúwhat to choose, return codes or exceptions‚Äù in such a language is low-level.  As, for example, there is no question how to implement the ‚Äúforeach‚Äù construction.  Because  for a programmer using the same ‚Äúforeach‚Äù, it makes no difference whether the creators of the while or for language or something else used the implementation of this operator.  The main thing is the pattern that represents this very operator. <br><br>  Stop talking about foreach.  I will show directly on the example of two very similar to each other operator, one of which uses the ‚Äúexception‚Äù as the implementation, the other - the ‚Äúreturn codes‚Äù. <br><a name="habracut"></a><br>  <b>process-exception</b> [ <b>mapping</b> &amp; <b>body</b> ] <br>  where <b>mapping</b> is a map of the form {exception 1 &lt;-&gt; processing method 1, exception 2 &lt;-&gt; processing method 2, ...}, <b>body</b> is the body of the operator in which an exception may occur. <br><br>  and the second statement: <br>  <b>process-retcode-answer</b> [ <b>mapping</b> &amp; <b>body</b> ] <br>  where <b>mapping</b> is a map of the form {return code 1 &lt;-&gt; processing method 1, return code 2 &lt;-&gt; processing method 2, ...}, <b>body</b> - the body of the operator, which ends with the response of the subroutine or of any called system that is needed process based on the return code. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's see, they work. <br><br><h4>  process-retcode-answer </h4><br><br>  Suppose we have functions for handling return codes of 0, -1, -2, and the processing logic for the remaining codes: <br><br><blockquote>  <font color="#66cc66">(</font> defn ok-processor <font color="#66cc66">[</font> result <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> println <font color="#66cc66">(</font> str <font color="#ff0000">"ok. result:"</font> result <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn error-processor <font color="#66cc66">[</font> result <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> println <font color="#66cc66">(</font> str <font color="#ff0000">"error. result:"</font> result <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn another-error-processor <font color="#66cc66">[</font> result <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> println <font color="#66cc66">(</font> str <font color="#ff0000">"another error. result:"</font> result <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn unknown-error-processor <font color="#66cc66">[</font> result <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> println <font color="#66cc66">(</font> str <font color="#ff0000">"unknown error. result:"</font> result <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> </blockquote><br><br>  We define the map of return codes for the names of the functions processing them: <br><br><blockquote>  <font color="#66cc66">(</font> def result-mapping <font color="#66cc66">{</font> <font color="#cc66cc">0</font> 'ok-processor <br>  - <font color="#cc66cc">1</font> 'error-processor <br>  - <font color="#cc66cc">2</font> 'another-error-processor <br>  <font color="#66cc66">:</font> <font>other</font> 'unknown-error-processor <font color="#66cc66">}</font> <font color="#66cc66">)</font> <br></blockquote><br><br>  Now we create test subroutines that return different return codes and the corresponding result: <br><br><blockquote>  <font color="#66cc66">(</font> defn test-call-ok <font color="#66cc66">[</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">[</font> <font color="#cc66cc">0</font> <font color="#ff0000">"test result"</font> <font color="#66cc66">]</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn test-call- <font color="#b1b100">error</font> <font color="#66cc66">[</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">[</font> - <font color="#cc66cc">1</font> <font color="#ff0000">"test result"</font> <font color="#66cc66">]</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn test-call-another- <font color="#b1b100">error</font> <font color="#66cc66">[</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">[</font> - <font color="#cc66cc">2</font> <font color="#ff0000">"test result"</font> <font color="#66cc66">]</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn test-call-unknown- <font color="#b1b100">error</font> <font color="#66cc66">[</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">[</font> - <font color="#cc66cc">1000</font> <font color="#ff0000">"test result"</font> <font color="#66cc66">]</font> <font color="#66cc66">)</font> </blockquote><br><br>  The work of our operator in this case looks like this: <br><br><blockquote>  <font color="#66cc66">(</font> process-retcode-answer result-mapping <font color="#66cc66">(</font> test-call-ok <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  ok <font color="#66cc66">.</font>  result <font color="#66cc66">:</font> <font>test</font> result <br><br>  <font color="#66cc66">(</font> process-retcode-answer result-mapping <font color="#66cc66">(</font> test-call- <font color="#b1b100">error</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  <font color="#b1b100">error</font> <font color="#66cc66">.</font>  result <font color="#66cc66">:</font> <font>test</font> result <br><br>  <font color="#66cc66">(</font> process-retcode-answer result-mapping <font color="#66cc66">(</font> test-call-another- <font color="#b1b100">error</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  another <font color="#b1b100">error</font> <font color="#66cc66">.</font>  result <font color="#66cc66">:</font> <font>test</font> result <br><br>  <font color="#66cc66">(</font> process-retcode-answer result-mapping <font color="#66cc66">(</font> test-call-unknown- <font color="#b1b100">error</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  unknown <font color="#b1b100">error</font> <font color="#66cc66">.</font>  result <font color="#66cc66">:</font> <font>test</font> result </blockquote><br><br>  Here in each body consists of only one method.  In reality, you can insert any sequence of functions instead. <br><br>  The advantage of this operator is that the processing of new codes or the modification of existing handlers is carried out transparently by implementing handlers and making the appropriate changes to the mapping, which can be in a separate file. <br><br>  No ifs.  This approach implements a fairly flexible return code processing pattern. <br><br><h4>  process-exception </h4><br><br>  By analogy with the previous example.  There are some exception handling functions: <br><br><blockquote>  <font color="#66cc66">(</font> defn arithmetic exception-processor <font color="#66cc66">[</font> e <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> println <font color="#66cc66">(</font> str <font color="#ff0000">"Arithmetic exception."</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn nullpointer-exception-processor <font color="#66cc66">[</font> e <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> println <font color="#66cc66">(</font> str <font color="#ff0000">"Nullpointer exception."</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn another-exception-processor <font color="#66cc66">[</font> e <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> println <font color="#66cc66">(</font> str <font color="#ff0000">"Other exception."</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> </blockquote><br><br>  Map exceptions to the names of the functions that process them: <br><br><blockquote>  <font color="#66cc66">(</font> def exception-mapping <font color="#66cc66">{</font> java <font color="#66cc66">.</font> lang <font color="#66cc66">.</font> ArithmeticException 'arithmetic-exception-processor <br>  java <font color="#66cc66">.</font>  lang <font color="#66cc66">.</font>  NullPointerException 'nullpointer-exception-processor <br>  java <font color="#66cc66">.</font>  lang <font color="#66cc66">.</font>  Exception 'another-exception-processor <font color="#66cc66">}</font> <font color="#66cc66">)</font> </blockquote><br><br>  We create test subroutines that generate various exceptions: <br><br><blockquote>  <font color="#66cc66">(</font> defn test-call-ok <font color="#66cc66">[</font> <font color="#66cc66">]</font> <br>  <font color="#ff0000">"test result"</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn test-throw-arithmetic-exception <font color="#66cc66">[</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">throw</font> <font color="#66cc66">(</font> new java <font color="#66cc66">.</font> lang <font color="#66cc66">.</font> ArithmeticException <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  <font color="#ff0000">"test resutl"</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn test-throw-nullpointer-exception <font color="#66cc66">[</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">throw</font> <font color="#66cc66">(</font> new java <font color="#66cc66">.</font> lang <font color="#66cc66">.</font> NullPointerException <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  <font color="#ff0000">"test resutl"</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn test-throw-other-exception <font color="#66cc66">[</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">throw</font> <font color="#66cc66">(</font> new java <font color="#66cc66">.</font> lang <font color="#66cc66">.</font> ClassNotFoundException <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  <font color="#ff0000">"test resutl"</font> <font color="#66cc66">)</font> </blockquote><br><br>  The work of our operator: <br><br><blockquote>  <font color="#66cc66">(</font> process-exception exception-mapping <br>  <font color="#66cc66">(</font> test-call-ok <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  <font color="#ff0000">"test result"</font> <br><br>  <font color="#66cc66">(</font> process-exception exception-mapping <br>  <font color="#66cc66">(</font> test-throw-arithmetic-exception <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  Arithmetic exception <font color="#66cc66">.</font> <br><br>  <font color="#66cc66">(</font> process-exception exception-mapping <br>  <font color="#66cc66">(</font> test-throw-nullpointer-exception <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  Nullpointer exception <font color="#66cc66">.</font> <br><br>  <font color="#66cc66">(</font> process-exception exception-mapping <br>  <font color="#66cc66">(</font> test-throw-other-exception <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  Other exception <font color="#66cc66">.</font> </blockquote><br><br>  The remarks at the end of the description of the previous statement apply here. <br><br><h4>  findings </h4><br><br>  These operators are very similar and, in principle, implement the same response processing pattern, but with a different implementation.  Here I prefer <b>process-retcode-answer</b> .  Although in other languages, options with return codes are not always beneficial in comparison with options that use exceptions (of course, depends on the conditions of the problem and the language itself - this has already been discussed). <br><br>  Here is the implementation of the above operators: <br><br><blockquote>  <font color="#66cc66">(</font> <font color="#b1b100">defmacro</font> process-exception <font color="#66cc66">[</font> mapping <font color="#66cc66">&amp;</font> body <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> catch-items <font color="#66cc66">(</font> map <font color="#66cc66">(</font> fn <font color="#66cc66">[</font> m <font color="#66cc66">])</font> <br>  ` <font color="#66cc66">(</font> <font color="#b1b100">catch</font> ~ <font color="#66cc66">(</font> first m <font color="#66cc66">)</font> e # <br>  <font color="#66cc66">(</font> ~ <font color="#66cc66">(</font> <font color="#b1b100">eval</font> <font color="#66cc66">(</font> second m <font color="#66cc66">)</font> <font color="#66cc66">)</font> e # <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">eval</font> mapping <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  ` <font color="#66cc66">(</font> try ~ @ body <br>  ~ @ catch-items <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> </blockquote><br><br><blockquote>  <font color="#66cc66">(</font> <font color="#b1b100">defmacro</font> process-retcode-answer <font color="#66cc66">[</font> mapping <font color="#66cc66">&amp;</font> body <font color="#66cc66">]</font> <br>  ` <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> answer # <font color="#66cc66">(</font> <font color="#b1b100">do</font> ~ @ body <font color="#66cc66">)</font> <br>  retcode # <font color="#66cc66">(</font> first answer # <font color="#66cc66">)</font> <br>  result # <font color="#66cc66">(</font> second answer # <font color="#66cc66">)</font> <br>  processor # <font color="#66cc66">(</font> <font color="#b1b100">get</font> ~ mapping retcode # <font color="#66cc66">)</font> <br>  processor # <font color="#66cc66">(</font> <font color="#b1b100">if</font> <font color="#66cc66">(</font> <font color="#b1b100">nil</font> ? processor # <font color="#66cc66">)</font> <font color="#66cc66">(</font> <font color="#66cc66">:</font> <font>other</font> ~ mapping <font color="#66cc66">)</font> processor # <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#66cc66">(</font> <font color="#b1b100">eval</font> processor # <font color="#66cc66">)</font> result # <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> </blockquote><br><br>  This rather exaggerated example shows that the basic elements of the language are not very important, as is the ability to extend the language with new constructions and also have the same functions of high order, lambda, and closures in it.  This language allows the programmer to become an artist.  He does not write patterns over and over.  He simply "creates" a language in which he can most naturally, visually and briefly formulate a solution to the task set before him.  Profession becomes not a craft, but an art. </div><p>Source: <a href="https://habr.com/ru/post/131129/">https://habr.com/ru/post/131129/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../131124/index.html">Google due to earthquake launched a site for finding people for Turkey</a></li>
<li><a href="../131125/index.html">Video review of Android applications and games - kedDroid</a></li>
<li><a href="../131126/index.html">Plugin to select the last line</a></li>
<li><a href="../131127/index.html">The limited resources of web startups are not a problem!</a></li>
<li><a href="../131128/index.html">Use Storyboard</a></li>
<li><a href="../131130/index.html">Difference of habrauys from normal people</a></li>
<li><a href="../131131/index.html">Aspia 0.2.5</a></li>
<li><a href="../131132/index.html">Scoop as it is</a></li>
<li><a href="../131133/index.html">Groupon. Show me the money or how knowledge of numbers can help a business</a></li>
<li><a href="../131135/index.html">Antineurons and learning from mistakes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>