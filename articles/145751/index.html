<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kopules - what it is and what they are</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This resource often speaks about working with random variables - well, a lot of where they are needed. Sometimes it happens that you need to determine...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Kopules - what it is and what they are</h1><div class="post__text post__text-html js-mediator-article">  This resource often speaks about working with random variables - well, a lot of where they are needed.  Sometimes it happens that you need to determine the dependence of two random variables on each other.  Here you will exclaim - "Pfff, so we are in school - correlation."  Here I want to upset you - Pearson's correlation is just one of many ways to show the dependence of two random variables.  In addition, it is linear.  That is, if the relationship between X and Y is not linear, but, say, quadratic, that is, X = Y ^ 2, then the Pearson correlation will show the absence of dependence.  But we know that it is not.  If you have not thought about this before, now you should have ideas - ‚ÄúHow is that?‚Äù, ‚ÄúAnd what can we do?‚Äù, <s>‚ÄúAaaa, we will all die!‚Äù</s> I will try to give answers to all these difficult questions under the cut . <br><a name="habracut"></a><br>  To begin, let me remind you that the cumulative distribution functions can be defined on any set of values, but they themselves have values ‚Äã‚Äãfrom 0 to 1. That is, they convert values ‚Äã‚Äãfrom a given set to a strictly defined range from 0 to 1. You can imagine that they ‚Äúarchive‚Äù .  For example, the normal function "archives" the range from minus infinity to plus infinity to this most notorious (0.1).  Lognormal distribution "archives" the range only from 0 to infinity.  And so on. <br><br>  Now imagine the process of "unarchiving".  It is made by inverse distribution functions.  They are also called quantile functions.  You already understood the point - these functions transform the range (0,1) into the range of values ‚Äã‚Äãspecified by this function.  All this, of course, with a bunch of restrictions, but for the "visual presentation", such a comparison is quite suitable. <br><br>  What is interesting is if we take 10 ^ 6 random variables generated according to the same principle (for example, the standard normal distribution) and another 10 ^ 6 according to the lognormal distribution law: <br><img src="https://habrastorage.org/storage2/bab/06d/880/bab06d8806fbb8fc7df40f4e2d9701c7.png"><br>  and then ‚Äúarchive‚Äù them, then the two million values ‚Äã‚Äãobtained will be evenly distributed from 0 to 1. <br><img src="https://habrastorage.org/storage2/d0a/75f/cef/d0a75fcef5021bca14ab0b8dc942febc.png"><br>  That is, in fact, any distribution can be generated from uniformly distributed values ‚Äã‚Äãand the inverse distribution function.  There would be such a function.  On this educational program we will finish. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now introduce you to the copula.  The formula definition is: <br><img src="https://habrastorage.org/storage2/64c/243/a2f/64c243a2fa05d5991ecf366f76ec4a86.png"><br><br>  where u is the ‚Äúarchived‚Äù value (u = F (x), F is the marginal distribution function).  We can also write that <br><br><img src="https://habrastorage.org/storage2/79c/196/5cc/79c1965cc66f5bd52eea738f344f5233.png"><br><br>  That is, it is a joint distribution function of several ‚Äúarchived‚Äù values.  You can say - "uh ... we just showed that the" archived "values ‚Äã‚Äãare equally distributed for all distribution functions."  This is true for individual quantities, we work with several at once.  Suppose we have two values ‚Äã‚Äã‚Äî one is normally distributed, the other is lognormal.  For starters, they will be independent of each other.  Marginal (when we consider values ‚Äã‚Äãseparately) distributions we have already shown above.  Now I will show how their joint distribution looks like: <br><img src="https://habrastorage.org/storage2/0cf/050/644/0cf050644e5a3e319c6f5605dc5f06f0.png"><br><br>  As you can see, the ‚Äúarchived‚Äù values ‚Äã‚Äãare evenly distributed over a square of 1 by 1. Now we will generate the same values, but let's say that there is a correlation between them equal to 0.8.  The result is shown in the following graph. <br><img src="https://habrastorage.org/storage2/5dd/740/faa/5dd740faa2a64391e9640cebd3f2ad14.png"><br>  As you can see, now the distribution of ‚Äúarchived‚Äù values ‚Äã‚Äãis uneven - it is more concentrated diagonally.  Here the limited use of correlation, as a measure of the dependence of quantities, is manifested.  By operating only with it, you can distribute the ‚Äúarchived‚Äù values ‚Äã‚Äãonly closer or farther from the diagonal.  The diagonal will be either 45 degrees if the correlation is positive, or 135 degrees if the correlation is negative.  <i>What if you want to show another dependency pattern?</i>  This is where the copulas come to your rescue.  From the formula definition of a copula it can be seen that it shows the distribution function on this square 1 for 1, if there are two quantities.  If there are more than two, then the copula will show the distribution in the n-dimensional cube 1 on 1 on 1 ... by 1. Using different copulas, you can show any distributions of the ‚Äúarchived‚Äù values.  Another important advantage of copulas is their independence from marginal distributions.  That is, you do not care what marginal distributions have values ‚Äã‚Äã- you work directly with the dependencies expressed through the dependencies of the ‚Äúarchived‚Äù values. <br><br>  Since a copula is still a function of probability, and not a distribution of quantities as such, it is graphically shown as a surface for which each point is equal to the joint probability of two quantities.  In other words, it is a plot of joint distribution density.  For clarity, I will give an example of several copulas: <br><br>  To begin, let us show the Gaussian copula density distribution function itself (gaussian copula) as well as its graphic display: <br><img src="https://habrastorage.org/storage2/2f6/252/813/2f6252813e7d19ce96ce5a463d7b389c.png"><br>  Where <img src="https://habrastorage.org/storage2/5fc/37d/af6/5fc37daf6c1432cfa27bc989edd89b45.png">  Is the normal distribution function, and <img src="https://habrastorage.org/storage2/b2c/d2e/69e/b2cd2e69e38745244e90acd89504bc59.png">  - the inverse function of the i-th marginal distribution, that is, the distribution of a specific value per se. <br><img src="https://habrastorage.org/storage2/8f4/ea4/12f/8f4ea412fa7ff3b29c177d88402c1680.png"><br><br>  As you can see, it is very similar to the distribution of ‚Äúarchived‚Äù random variables in the last example.  There is nothing strange in this, since the last example used just a Gaussian copula with the same correlation parameter of 0.8, with normal and lognormal marginal distribution functions. <br><br>  Next I would like to show Student Copula (Student Copula): <br><br><img src="https://habrastorage.org/storage2/9c0/bde/78a/9c0bde78a48b4909bc35bcad45adf5a3.png"><br>  Where t is the Student‚Äôs distribution function with a given covariance matrix and a given number of degrees of freedom <br><img src="https://habrastorage.org/storage2/22e/235/b27/22e235b272f540d1a362d17ba39fb68e.png"><br><br>  It can be seen that, unlike the Gaussian copula, the Student‚Äôs copula has a greater value at the extreme values ‚Äã‚Äã(1-1 and 0-0), which means thicker distribution tails.  Even more noticeable are the high values ‚Äã‚Äãin the corners 0-1 and 1-0, which means a pronounced inverse relationship at the ends of the ranges of definitions of marginal functions.  It should be noted that this graph was constructed for a positive correlation between the values.  In the case of zero correlation, in contrast to the Gaussian copula, where in this case there would be a uniform distribution over all the squares, the Student‚Äôs tug has the same weights for all angles.  This means that if one value takes a "tail" value, the other will also take a "tail" value, but with equal probability, right or left.  For ease of reading the graph of the density of the copula, you can mentally make a slice perpendicular to one of the axes.  The resulting graph will be a graph of the probability density of the loss of one "archived" value while fixing another. <br><br>  I would also like to show Clayton copula (Clayton copula), which determines the degree of coherence of the two quantities only by the alpha parameter, which must be strictly greater than 1. <br><img src="https://habrastorage.org/storage2/e12/512/e3d/e12512e3d6670610d8766e37b1767362.png"><br><br><img src="https://habrastorage.org/storage2/0d8/a89/5a3/0d8a895a3e45b59e0f15539938f40bcb.png"><br><br>  Here, the main weight lies at 0‚Äì0, that is, the values ‚Äã‚Äãwill most likely take values ‚Äã‚Äãfrom the left tail of the margin functions. <br><br>  In general, copulas make it possible to show any dependence of several quantities on each other, expanding the range of modeling.  For further reference, I cite a small list of references. <br><br>  <a href="http://www.mathworks.com/products/statistics/demos.html%3Ffile%3D/products/demos/shipping/stats/copulademo.html">Copula in Matlab</a> <br>  <a href="http%253A%252F%252Fwww.soa.org%252Flibrary%252Fjournals%252Fnorth-american-actuarial-journal%252F1998%252Fjanuary%252Fnaaj9801_1.pdf%26ei%3DDK_VT_abOMPBhAfi763kAw%26usg%3DAFQjCNHuQhoiZQU6HNopqpkjn4Fml_j4Dg%26sig2%3Daea1xxk4HTkscNLg651NgA">Understanding relationships using copulas</a> - Edward Frees, Emiliano Valdez <br>  <a href="http://www.math.uni-leipzig.de/~tschmidt/TSchmidt_Copulas.pdf">Coping with copulas</a> - Thorsten Schmidt </div><p>Source: <a href="https://habr.com/ru/post/145751/">https://habr.com/ru/post/145751/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145741/index.html">Sasha will help American users</a></li>
<li><a href="../145742/index.html">Hadron Collider, ten-point wind and switches</a></li>
<li><a href="../145746/index.html">ICANN opens a list of new top-level domains</a></li>
<li><a href="../145747/index.html">A fan of old technology restored Apple II</a></li>
<li><a href="../145748/index.html">Video footage of Apple WWDC 2012 Keynote</a></li>
<li><a href="../145752/index.html">iOS 6 renders slider highlights based on device position</a></li>
<li><a href="../145755/index.html">7 typical Russian problems in English speech</a></li>
<li><a href="../145756/index.html">Sony's latest budget Xperia miro and Xperia tipo</a></li>
<li><a href="../145757/index.html">Lesson 1. Getting to know Ext.NET</a></li>
<li><a href="../145760/index.html">Testing the EZ-Robots Kit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>