<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Long story about date localization without a year in PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Let's start with a simple task - output a localized date: there should be a day, the full name of the month in the locale language and a full year. No...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Long story about date localization without a year in PHP</h1><div class="post__text post__text-html js-mediator-article"> Let's start with a simple task - output a localized date: there should be a day, the full name of the month in the locale language and a full year.  Nowadays it is really very simple.  PHP has its own <a href="https://en.wikipedia.org/wiki/Internationalization_and_localization">i18n</a> extension, <a href="http://php.net/manual/en/book.intl.php"><code>intl</code></a> , which is included in the kernel from version 5.3.  And in this <code>intl</code> there is a class <code>IntlDateFormatter</code> , which in turn has several predefined formats.  We use it <code>LONG</code> format. <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">foreach</span></span></span><span class="php"> ([</span><span class="hljs-string"><span class="php"><span class="hljs-string">'en_US'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'ru_RU'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'es_ES'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'fa_IR'</span></span></span><span class="php">] </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">as</span></span></span><span class="php"> $locale) { $formatter = </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">new</span></span></span><span class="php"> IntlDateFormatter( $locale, IntlDateFormatter::LONG, IntlDateFormatter::NONE, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'Europe/Moscow'</span></span></span><span class="php"> ); </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $formatter-&gt;format(</span><span class="hljs-number"><span class="php"><span class="hljs-number">1455111783</span></span></span><span class="php">), PHP_EOL; }</span></span></code> </pre> <br>  <a href="https://3v4l.org/Q1bYG">Result</a> : <br><br><pre> <code class="hljs objectivec">February <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">2016</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>  <span class="hljs-number"><span class="hljs-number">2016</span></span> . <span class="hljs-number"><span class="hljs-number">10</span></span> de febrero de <span class="hljs-number"><span class="hljs-number">2016</span></span> €±€∞ ÔªëÔª≠Ô∫≠€åÔª©Ÿî €≤€∞€±€∂ Ôª°. <span class="hljs-comment"><span class="hljs-comment">//   - RTL-,       </span></span></code> </pre> <br>  So far so good.  And now let's change the conditions slightly: ‚Äú <strong>output a localized date: there should be a day and the full name of the month in the locale language</strong> ‚Äù.  That is, we do not want to display the year. <br><a name="habracut"></a><br>  The desired result looks like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs objectivec">February <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>  <span class="hljs-number"><span class="hljs-number">10</span></span> de febrero €±€∞ ÔªëÔª≠Ô∫≠€åÔª©Ÿî Ôª°. <span class="hljs-comment"><span class="hljs-comment">//     ,    ,  ,   </span></span></code> </pre> <br>  Actually, now the task is not as simple as it seems. <br><br>  Honestly, this entire post will be solely about this task. <br><br><h3>  Wait, wait, but why do you even need it? </h3><br>  Some, perhaps, may wonder, what kind of format would I need at all?  It‚Äôs pretty obvious if you‚Äôre working with a system that displays a tape of events with time stamps.  But if not, let's just take a look at Twitter. <br><br><img src="https://habrastorage.org/files/a4e/65c/d80/a4e65cd800604100a3448f3c0a7e5e0b.png" alt="twitter date formats"><br><br>  If the tweet was published recently, Twitter will show you a correctly formatted time interval.  If the tweet happened a long time ago, you will see a properly formatted date.  Moreover, if the tweet was published this year, then there will not be a year at this date.  And that's great, it's part of a good UX. <br><br>  The idea is that users quickly understand when it happened.  The extra data is noise. <br><br>  Now you know why.  Let's return to our task. <br><br><h3>  OK, then there must be a separate format for this, like <code>LONG</code> , but without a year, right? </h3><br>  Not this way.  <code>IntlDateFormatter</code> only four standard formats: <code>FULL</code> , <code>LONG</code> , <code>MEDIUM</code> and <code>SHORT</code> , and each of them has a year. <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> $formats = [ IntlDateFormatter::FULL, IntlDateFormatter::LONG, IntlDateFormatter::MEDIUM, IntlDateFormatter::SHORT, ]; </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">foreach</span></span></span><span class="php"> ($formats </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">as</span></span></span><span class="php"> $format) { $formatter = </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">new</span></span></span><span class="php"> IntlDateFormatter( </span><span class="hljs-string"><span class="php"><span class="hljs-string">'en_US'</span></span></span><span class="php">, $format, IntlDateFormatter::NONE, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'Europe/Moscow'</span></span></span><span class="php"> ); </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $formatter-&gt;format(</span><span class="hljs-number"><span class="php"><span class="hljs-number">1455111783</span></span></span><span class="php">), PHP_EOL; }</span></span></code> </pre> <br>  <a href="https://3v4l.org/MMDPS">Result</a> : <br><br><pre> <code class="hljs">Wednesday, February 10, 2016 February 10, 2016 Feb 10, 2016 2/10/16</code> </pre> <br>  If you think a little, it will become clear that it is impossible to determine in advance the constants for each custom format that a developer, designer, or manager can ever think of. <br><br><h3>  Ha, I just came up with a simple solution! </h3><br>  Come on?  Let me guess: <strong>you just want to cut a year out of what you get after formatting with <code>LONG</code></strong> , right?  Ready to argue that way.  Without examples it can be difficult to understand what the problem is.  Let's just see. <br><br>  I remind you that we have. <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">February</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">2016</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>  <span class="hljs-number"><span class="hljs-number">2016</span></span> . <span class="hljs-number"><span class="hljs-number">10</span></span> de febrero de <span class="hljs-number"><span class="hljs-number">2016</span></span> €±€∞ ÔªëÔª≠Ô∫≠€åÔª©Ÿî €≤€∞€±€∂ Ôª°.</code> </pre> <br>  Cut the year. <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">February</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>  . <span class="hljs-number"><span class="hljs-number">10</span></span> de febrero de €±€∞ ÔªëÔª≠Ô∫≠€åÔª©Ÿî Ôª°.</code> </pre> <br>  Do you see all these residual artifacts of the type <code>,</code> and the <code>.</code> and the <code>de</code> and definitely something else in the last line, which I cannot single out? <br><br>  Therefore - no, this is not even a close decision.  By the way, there is nothing shameful about it, it was my first ‚Äúquick fix‚Äù. <br><br><h3>  Well, there are patterns, let's use patterns! </h3><br>  Yes, <code>IntlDateFormatter</code> actually works only with patterns inside (format constants are simply converted to the corresponding pattern), and when creating you can specify your own. <br><br>  A pattern consists of several <a href="http://www.icu-project.org/apiref/icu4c/classSimpleDateFormat.html">predefined sequences of letters</a> . <br><br>  We'll see ... It looks like we need the "d MMMM" pattern. <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">foreach</span></span></span><span class="php"> ([</span><span class="hljs-string"><span class="php"><span class="hljs-string">'en_US'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'ru_RU'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'es_ES'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'fa_IR'</span></span></span><span class="php">] </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">as</span></span></span><span class="php"> $locale) { $formatter = </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">new</span></span></span><span class="php"> IntlDateFormatter( $locale, IntlDateFormatter::NONE, IntlDateFormatter::NONE, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'Europe/Moscow'</span></span></span><span class="php">, </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">null</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">"d MMMM"</span></span></span><span class="php"> ); </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $formatter-&gt;format(</span><span class="hljs-number"><span class="php"><span class="hljs-number">1455111783</span></span></span><span class="php">), PHP_EOL; }</span></span></code> </pre> <br>  <a href="https://3v4l.org/HX7Vb">Result</a> : <br><br><pre> <code class="hljs">10 February 10  10 febrero €±€∞ ŸÅŸàÿ±€åŸáŸî</code> </pre> <br>  Looks great!  Although wait, what's that for?  Oh... <br><br>  Remind we want <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">February</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>  <span class="hljs-number"><span class="hljs-number">10</span></span> de febrero €±€∞ ÔªëÔª≠Ô∫≠€åÔª©Ÿî Ôª°.</code> </pre> <br>  No, the guys are great, just one coincidence.  This is because you specified with the pattern not only parts of the date (day and month), but also the order in which they should go, and the separators.  As if you said ‚Äúthe day number must first go, then the full name of the month, and a space between them‚Äù.  For any locale.  This is complete nonsense. <br><br>  The truth is that the <strong>locale is not only a language, it is also a date formatting pattern</strong> .  And the pattern is not only <strong>what</strong> to include in the result, but also <strong>in what order</strong> to arrange it. <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">foreach</span></span></span><span class="php"> ([</span><span class="hljs-string"><span class="php"><span class="hljs-string">'en_US'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'ru_RU'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'es_ES'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'fa_IR'</span></span></span><span class="php">] </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">as</span></span></span><span class="php"> $locale) { $formatter = </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">new</span></span></span><span class="php"> IntlDateFormatter( $locale, IntlDateFormatter::LONG, IntlDateFormatter::NONE, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'Europe/Moscow'</span></span></span><span class="php"> ); </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $formatter-&gt;getPattern(), PHP_EOL; }</span></span></code> </pre> <br>  <a href="https://3v4l.org/CAtsW">Result</a> : <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">MMMM</span></span> d, y d MMMM y <span class="hljs-string"><span class="hljs-string">''</span></span>. d <span class="hljs-string"><span class="hljs-string">'de'</span></span> MMMM <span class="hljs-string"><span class="hljs-string">'de'</span></span> y d MMMM y G</code> </pre> <br>  See, they are all different. <br><br><h3>  But there must be a ready solution!  It can not be that it is not!  Or...? </h3><br>  <em>sigh</em> Yes, I thought the same way.  How is it even possible that in PHP, in an adult language with a developed ecosystem and one of the most powerful community, there may not be some basic functionality?  Sad but true: possible. <br><br>  There is at least one very important thing missing in <code>intl</code> - the <a href="http://icu-project.org/apiref/icu4c/classicu_1_1DateTimePatternGenerator.html"><code>DateTimePatternGenerator</code></a> class from ICU.  It is made exactly in order to solve our little puzzle and all other similar. <br><br><h3>  Wait, wait, wait, what's the ICU? </h3><br>  <a href="http://site.icu-project.org/">ICU</a> is "International Components for Unicode" - the components of internationalization for Unicode. <br><br>  Quotes from the ICU website. <br><br><blockquote>  ICU is a mature, widely used set of C / C ++ and Java library software providing unicode and globalization support for software applications.  CU C ++ and Java software is widely portable and gives </blockquote><br>  ... <br><br><blockquote>  Formatting: Format numbers, dates, times and amounts according to the conventions of a chosen locale.  This code includes the correct language, choosing the appropriate abbreviations, ordering fields correctly, etc.  This data also comes from the Common Locale Data Repository. </blockquote><br>  In short, this is such a cool set of libraries.  The <code>intl</code> extension itself is not capable of any magic, it is something like a proxy to these libraries. <br><br><pre> <code class="hljs php">$ php -i | grep intl -A5 intl Internationalization support =&gt; enabled version =&gt; <span class="hljs-number"><span class="hljs-number">1.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> ICU version =&gt; <span class="hljs-number"><span class="hljs-number">56.1</span></span> ICU Data version =&gt; <span class="hljs-number"><span class="hljs-number">56.1</span></span></code> </pre> <br>  To use <code>IntlDateFormatter</code> , ICU must be installed on your system (or you must build PHP with ICU initially).  Different versions of ICU will give different formatting results. <br><br><pre> <code class="hljs javascript">$ dpkg -S icu libicu52:amd64: <span class="hljs-regexp"><span class="hljs-regexp">/usr/</span></span>lib/x86_64-linux-gnu/libicule.so<span class="hljs-number"><span class="hljs-number">.52</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> libicu52:amd64: <span class="hljs-regexp"><span class="hljs-regexp">/usr/</span></span>lib/x86_64-linux-gnu/libicule.so<span class="hljs-number"><span class="hljs-number">.52</span></span> libicu52:amd64: <span class="hljs-regexp"><span class="hljs-regexp">/usr/</span></span>lib/x86_64-linux-gnu/libicutest.so<span class="hljs-number"><span class="hljs-number">.52</span></span> ...</code> </pre> <br>  (The system has version 52.1 installed, and PHP, as can be seen above, is compiled from 56.1. This is normal.) <br><br><h3>  Clear.  You mentioned some kind of <code>DateTimePatternGenerator</code> , tell </h3><br>  Exactly, <code>DateTimePatternGenerator</code> , this is, in my opinion, the most magical thing in ICU of those that are about formatting date-time. <br><br>  Another quote from the ICU website: <br><br><blockquote>  This class provides you with a "yy-mm-dd" format. <br><br>  By adding successive patterns.  Once it is done, it can be made using a skeleton,  The generator will return the "best fit" pattern to that skeleton. <br><br>  This is a method that has been used to get the best way to get it.  However, generators can be built directly from other data as well. </blockquote><br>  This is exactly what we need!  We feed the so-called "skeleton" (parts of the date that need to be included in the formatting result) to the <code>getBestPattern</code> method, and it returns the most appropriate pattern, and with it we already know what to do: transfer to <code>IntlDateFormatter</code> - and that's it! <br><br>  How it could work. <br><br><pre> <code class="hljs php">$skeleton = <span class="hljs-string"><span class="hljs-string">"MMMMd"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ([<span class="hljs-string"><span class="hljs-string">'en_US'</span></span>, <span class="hljs-string"><span class="hljs-string">'ru_RU'</span></span>, <span class="hljs-string"><span class="hljs-string">'es_ES'</span></span>, <span class="hljs-string"><span class="hljs-string">'fa_IR'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $locale) { $pgen = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IntlDateTimePatternGenerator($locale); $pattern = $pgen-&gt;getBestPattern($skeleton); $formatter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IntlDateFormatter( $locale, IntlDateFormatter::NONE, IntlDateFormatter::NONE, <span class="hljs-string"><span class="hljs-string">'Europe/Moscow'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, $pattern ); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $formatter-&gt;format(<span class="hljs-number"><span class="hljs-number">1455111783</span></span>), PHP_EOL; }</code> </pre> <br>  Result (probably would have been): <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">February</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>  <span class="hljs-number"><span class="hljs-number">10</span></span> de febrero €±€∞ ÔªëÔª≠Ô∫≠€åÔª©Ÿî Ôª°.</code> </pre> <br>  Yuhhhu  Dadada, I stupidly copied the ‚Äúdesired result‚Äù block.  In fact, I do not know what will be there, but I hope it will be so. <br><br><h3>  So what if I want to use the custom format right now? </h3><br>  As a result, I came to the second obvious solution: generate a config containing each custom pattern for each locale that your project supports.  And do this with the appearance of each new locale. <br><br>  Here is a simple snippet. <br><br><pre> <code class="hljs perl">&lt;?php // ... <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($locales as $locale) { $pattern = &lt;&lt;&lt;CONFIG <span class="hljs-string"><span class="hljs-string">'%s'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"%s"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> %s <span class="hljs-string"><span class="hljs-string">'long_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"%s"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> %s ], CONFIG; $mediumF = new IntlDateFormatter($locale, IntlDateFormatter::MEDIUM, IntlDateFormatter::NONE); $longF = new IntlDateFormatter($locale, IntlDateFormatter::LONG, IntlDateFormatter::NONE); <span class="hljs-keyword"><span class="hljs-keyword">printf</span></span>( $pattern, $locale, $mediumF-&gt;getPattern(), $mediumF-&gt;<span class="hljs-keyword"><span class="hljs-keyword">format</span></span>(<span class="hljs-number"><span class="hljs-number">1455111783</span></span>), $longF-&gt;getPattern(), $longF-&gt;<span class="hljs-keyword"><span class="hljs-keyword">format</span></span>(<span class="hljs-number"><span class="hljs-number">1455111783</span></span>) ); }</code> </pre> <br>  In the end, you will have something like <br><br><pre> <code class="hljs ruby"> <span class="hljs-string"><span class="hljs-string">'en_US'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"MMM d, y"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> Feb <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">2016</span></span> <span class="hljs-string"><span class="hljs-string">'long_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"MMMM d, y"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> February <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">2016</span></span> ], <span class="hljs-string"><span class="hljs-string">'ru_RU'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM y ''."</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> . <span class="hljs-number"><span class="hljs-number">2016</span></span> . <span class="hljs-string"><span class="hljs-string">'long_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMMM y ''."</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>  <span class="hljs-number"><span class="hljs-number">2016</span></span> . ], <span class="hljs-string"><span class="hljs-string">'es_ES'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM y"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> feb. <span class="hljs-number"><span class="hljs-number">2016</span></span> <span class="hljs-string"><span class="hljs-string">'long_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d 'de' MMMM 'de' y"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> de febrero de <span class="hljs-number"><span class="hljs-number">2016</span></span> ], <span class="hljs-string"><span class="hljs-string">'fa_IR'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM y G"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> €±€∞ ŸÅŸàÿ±€åŸáŸî €≤€∞€±€∂ ŸÖ. <span class="hljs-string"><span class="hljs-string">'long_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMMM y G"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> €±€∞ ŸÅŸàÿ±€åŸáŸî €≤€∞€±€∂ ŸÖ. ],</code> </pre> <br>  Then you need to <strong>manually</strong> walk through all these lines and remove from them the part responsible for displaying the year. <br><br><pre> <code class="hljs ruby"> <span class="hljs-string"><span class="hljs-string">'en_US'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"MMM d"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> Feb <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-string"><span class="hljs-string">'long_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"MMMM d"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> February <span class="hljs-number"><span class="hljs-number">10</span></span> ], <span class="hljs-string"><span class="hljs-string">'ru_RU'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> . <span class="hljs-string"><span class="hljs-string">'long_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMMM"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>  ], <span class="hljs-string"><span class="hljs-string">'es_ES'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> feb. <span class="hljs-string"><span class="hljs-string">'long_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d 'de' MMMM"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> de febrero ], <span class="hljs-string"><span class="hljs-string">'fa_IR'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> €±€∞ ŸÅŸàÿ±€åŸáŸî ŸÖ. <span class="hljs-string"><span class="hljs-string">'long_no_year'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMMM"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> €±€∞ ŸÅŸàÿ±€åŸáŸî ŸÖ. ],</code> </pre> <br>  When you have dozens of locales, it becomes exhausting work, JUST TRUST ME ( <em>silent crying is heard</em> ). <br><br>  And that is not all.  If you want to display such a date over time, you will have to load twice as many patterns.  Because you can't just take and put together a separately formatted date and time.  Add time to the end of the date, to the beginning or somewhere in the middle? <br><br><pre> <code class="hljs perl">&lt;?php <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ([<span class="hljs-string"><span class="hljs-string">'en_US'</span></span>, <span class="hljs-string"><span class="hljs-string">'ru_RU'</span></span>, <span class="hljs-string"><span class="hljs-string">'es_ES'</span></span>, <span class="hljs-string"><span class="hljs-string">'fa_IR'</span></span>] as $locale) { $pattern = &lt;&lt;&lt;CONFIG <span class="hljs-string"><span class="hljs-string">'%s'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"%s"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> %s <span class="hljs-string"><span class="hljs-string">'long_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"%s"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> %s ], CONFIG; $mediumF = new IntlDateFormatter($locale, IntlDateFormatter::MEDIUM, IntlDateFormatter::SHORT); $longF = new IntlDateFormatter($locale, IntlDateFormatter::LONG, IntlDateFormatter::SHORT); <span class="hljs-keyword"><span class="hljs-keyword">printf</span></span>( $pattern, $locale, $mediumF-&gt;getPattern(), $mediumF-&gt;<span class="hljs-keyword"><span class="hljs-keyword">format</span></span>(<span class="hljs-number"><span class="hljs-number">1455111783</span></span>), $longF-&gt;getPattern(), $longF-&gt;<span class="hljs-keyword"><span class="hljs-keyword">format</span></span>(<span class="hljs-number"><span class="hljs-number">1455111783</span></span>) ); }</code> </pre> <br>  <a href="https://3v4l.org/QQjmW">Result</a> : <br><br><pre> <code class="hljs ruby"> <span class="hljs-string"><span class="hljs-string">'en_US'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"MMM d, y, h:mm a"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> Feb <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">2016</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> PM <span class="hljs-string"><span class="hljs-string">'long_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"MMMM d, y 'at' h:mm a"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> February <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">2016</span></span> at <span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> PM ], <span class="hljs-string"><span class="hljs-string">'ru_RU'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM y ''., H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> . <span class="hljs-number"><span class="hljs-number">2016</span></span> ., <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> <span class="hljs-string"><span class="hljs-string">'long_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMMM y ''., H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>  <span class="hljs-number"><span class="hljs-number">2016</span></span> ., <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> ], <span class="hljs-string"><span class="hljs-string">'es_ES'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM y H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> feb. <span class="hljs-number"><span class="hljs-number">2016</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> <span class="hljs-string"><span class="hljs-string">'long_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d 'de' MMMM 'de' y, H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> de febrero de <span class="hljs-number"><span class="hljs-number">2016</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> ], <span class="hljs-string"><span class="hljs-string">'fa_IR'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM y Gÿå‚Äè H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> €±€∞ ŸÅŸàÿ±€åŸáŸî €≤€∞€±€∂ ŸÖ.ÿå‚Äè €±€¥<span class="hljs-symbol"><span class="hljs-symbol">:</span></span>€¥€≥ <span class="hljs-string"><span class="hljs-string">'long_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMMM y Gÿå ÿ≥ÿßÿπÿ™ H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> €±€∞ ŸÅŸàÿ±€åŸáŸî €≤€∞€±€∂ ŸÖ.ÿå ÿ≥ÿßÿπÿ™ €±€¥<span class="hljs-symbol"><span class="hljs-symbol">:</span></span>€¥€≥ ],</code> </pre> <br>  Remove the part responsible for the year, again, yes. <br><br><pre> <code class="hljs ruby"> <span class="hljs-string"><span class="hljs-string">'en_US'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"MMM d, h:mm a"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> Feb <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> PM <span class="hljs-string"><span class="hljs-string">'long_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"MMMM d, 'at' h:mm a"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> February <span class="hljs-number"><span class="hljs-number">10</span></span>, at <span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> PM ], <span class="hljs-string"><span class="hljs-string">'ru_RU'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM, H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> ., <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> <span class="hljs-string"><span class="hljs-string">'long_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMMM, H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> , <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> ], <span class="hljs-string"><span class="hljs-string">'es_ES'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMM H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> feb. <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> <span class="hljs-string"><span class="hljs-string">'long_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d 'de' MMMM, H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> de febrero, <span class="hljs-number"><span class="hljs-number">14</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">43</span></span> ], <span class="hljs-string"><span class="hljs-string">'fa_IR'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'medium_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMMÿå‚Äè H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> €±€∞ ŸÅŸàÿ±€åŸáŸîÿå‚Äè €±€¥<span class="hljs-symbol"><span class="hljs-symbol">:</span></span>€¥€≥ <span class="hljs-string"><span class="hljs-string">'long_no_year-short'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"d MMMMÿå ÿ≥ÿßÿπÿ™ H:mm"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> €±€∞ ŸÅŸàÿ±€åŸáŸîÿå ÿ≥ÿßÿπÿ™ €±€¥<span class="hljs-symbol"><span class="hljs-symbol">:</span></span>€¥€≥ ],</code> </pre> <br>  Yes, you just look at it, even a comma in Farsi is not an ordinary ‚Äúour‚Äù comma, but ÿå, you just cannot guess how to collect the result from individual dates and times. <br><br><h3>  But how does everyone else in the PHP world do this? </h3><br>  It‚Äôs hard to believe, but <strong>they either don‚Äôt bother at all with the localization of dates, or do it wrong</strong> . <br><br>  I looked into the source of several CMS, made in PHP. <br><br><blockquote>  I did not begin to look at frameworks, because I think that this is not a framework task.  Although there may be some very basic support ... Well, maybe.  Actually, I tried it, looked at Yii2, and <a href="https://github.com/yiisoft/yii2/issues/298">they just recommend using pure <code>intl</code></a> .  So let's get a better CMS. </blockquote><br><h4>  Drupal </h4><br>  From the very first search, I came across an <a href="https://www.drupal.org/node/2276183">amazing ticket with an intriguing name</a> - "Date intl support is broken, remove it".  Lolshto !?  And this is not a joke, they really did it. <br><br><img src="https://habrastorage.org/files/523/6ac/0b0/5236ac0b055e40928e0c47dc23726610.png" alt="intl was removed"><br><br>  In general, they solve the problem of formatting dates in approximately the same way (a pack of custom configs) <br>  , but before the patch (see the screenshot) there was an <code>intl</code> key just for the localization pattern.  And now they just do not care. <br><br>  Also, if I understood correctly (I‚Äôm not an active Drupal user enough), after installing the CMS, each user himself must use these pens to register all these patterns.  For each locale.  Well, or there is something that I don‚Äôt know about, but it looks that way. <br><br>  This is <a href="https://github.com/drupal/drupal/tree/8.1.x/core/modules/system/config/install">how it is done in 8.1.</a> <br><br><img src="https://habrastorage.org/files/375/a01/aa7/375a01aa7e2e480da7aa56799053a343.png" alt="date formats 8.1"><br><br>  But <a href="">in version 9.x</a> <br><br><img src="https://habrastorage.org/files/0b8/d84/fb3/0b8d84fb398a4e38b41b851bc03160d7.png" alt="date formats 9.x"><br><br>  (It seems that they have not had time to cut <code>intl</code> keys from this branch) <br><br>  In general, this is not so bad, but as a CMS user, I don‚Äôt want to study all possible cultures at all to find out what kind of date formatting is used by them.  All this work has already been done in the <a href="http://cldr.unicode.org/">CLDR</a> .  Of course, sometimes I need custom patterns, but all I agree on is specifying which parts of the date and time I want to see as a result (‚Äúonly day and month, please‚Äù or ‚Äúplease, I would have month and time without seconds "). <br><br><h4>  Wordpress </h4><br>  I have about the same relationship with WordPress, I am not one of the active users, so I used the search on Github.  It seems that the main <code>functions.php</code> interest to us here is the <code>date_i18n</code> from <code>functions.php</code> (by the way, guys, wtf? A file with functions from 5.2k lines of code? Seriously? We‚Äôve got the 2016th already.). <br><br><img src="https://habrastorage.org/files/be4/b4c/fa0/be4b4cfa099744f6a879d8749a6ca9ed.png" alt="wordpress date_i18n"><br><br>  I honestly spent half an hour trying to understand how it works.  But ... but ... yes, you just look at it. <br><br><img src="https://habrastorage.org/files/d61/653/f42/d61653f428684f7c8a7215ac329c5cb3.png" alt="wordpress date_i18n contents"><br><br>  Holy shit ... In short, it definitely does not look like a correctly implemented localization of dates, but at least because of <code>date_format</code> .  It seems that they are trying to localize the names of the months and days of the week, no more.  Connoisseurs correct me if I am mistaken. <br><br><h4>  Joomla! </h4><br>  I never touched Joomla at all.  Therefore, the scheme is the same. <br><br>  The result: almost the same as in Drupal, a pack of predefined formats that need to be set for each locale. <br><br>  <a href="">en-GB from default installation</a> <br><br><img src="https://habrastorage.org/files/602/1b0/fcb/6021b0fcbf854ab3b42ebc46b943cc26.png" alt="en-GB Joomla config"><br><br>  See these letters?  They tell us that <code>date_format</code> uses <code>date_format</code> (like many others) and does not use <code>intl</code> .  Is that justified?  In my opinion, no.  <code>intl</code> since version 5.3 is included in the kernel, and we already have PHP 7 in the yard, and 5.5 is the minimum requirement for most modern code.  That is, I absolutely understand when frameworks do not use any third-party extensions or chips of the latest versions of the language, because they believe that their code should work even on an iron, and they already have a lot of users who have code on irons of old versions.  But this is clearly not the case.  Call it "Legacy" or "technical debt" or something else and continue. <br><br><h4>  ModX Revolution </h4><br>  <a href="https://github.com/modxcms/revolution/blob/master/_build/data/transport.core.system_settings.php">transport.core.system_settings.php</a> <br><br><img src="https://habrastorage.org/files/283/016/0f4/2830160f49ef426282e7b8927a218990.png"><br><br>  <a href="https://github.com/modxcms/revolution/blob/master/core/model/modx/processors/resource/get.class.php">get.class.php</a> <br><br><img src="https://habrastorage.org/files/b92/24f/92c/b9224f92cd0040ee9b75884ca95f6240.png"><br><br>  <a href="https://github.com/modxcms/revolution/blob/master/core/model/smarty/plugins/modifier.date_format.php">modifier.date_format.php</a> <br><br><img src="https://habrastorage.org/files/5c5/eda/270/5c5eda270a75421f9dc7e383cde27bbf.png"><br><br>  <code>strftime</code> sounds a little better than <code>date_format</code> (there are formats that give a false sense of correct localization) or nothing when we talk about localization, but this function does not do what we need. <br><br><h4>  Magento2 </h4><br>  Magento is not a CMS in the generally accepted sense, it is an e-commerce platform, but it is widely known, and it even has a separate framework of its own.  So why not. <br><br>  And here I must say that this is the only code base in my review, in which the localization of dates is done <em>almost</em> correctly!  This is the only code in which I have met using <code>IntlDateFormatter</code> , moreover, it is used as the basis of the formatting component. <br><br><img src="https://habrastorage.org/files/354/b19/7d0/354b197d0630416a9160f003a5bc0443.png"><br><br>  But their code is not perfect.  We look in <a href="https://github.com/magento/magento2/blob/develop/lib/internal/Magento/Framework/Stdlib/DateTime/Timezone.php">Timezone.php</a> . <br><br><img src="https://habrastorage.org/files/3fc/e6f/5c0/3fce6f5c04724918ae625c890225d2f7.png"><br><br>  I could not find a place in which they would try to format a date without a year.  But there is a feeling that they are making the same mistake as we did a little earlier, trying to replace the year when formatting "dates with a long year."  Or not?  I am not a regular guru (although I am familiar with lookahead and lookbehind), so I‚Äôd better just execute the code from <code>getDateFormatWithLongYear</code> and see what happens. <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">foreach</span></span></span><span class="php"> ([</span><span class="hljs-string"><span class="php"><span class="hljs-string">'en_US'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'ru_RU'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'es_ES'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'fa_IR'</span></span></span><span class="php">] </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">as</span></span></span><span class="php"> $locale) { $dateFormat = (</span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">new</span></span></span><span class="php"> \IntlDateFormatter( $locale, \IntlDateFormatter::SHORT, \IntlDateFormatter::NONE ))-&gt;getPattern(); $formatWithLongYear = preg_replace( </span><span class="hljs-string"><span class="php"><span class="hljs-string">'/(?&lt;!y)yy(?!y)/'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'Y'</span></span></span><span class="php">, $dateFormat ); $formatter = </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">new</span></span></span><span class="php"> \IntlDateFormatter( $locale, \IntlDateFormatter::NONE, \IntlDateFormatter::NONE, </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">null</span></span></span><span class="php">, </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">null</span></span></span><span class="php">, $formatWithLongYear ); </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $formatter-&gt;format(</span><span class="hljs-number"><span class="php"><span class="hljs-number">1455111783</span></span></span><span class="php">), PHP_EOL; }</span></span></code> </pre> <br>  <a href="https://3v4l.org/00DEX">Result</a> : <br><br><pre> <code class="hljs coffeescript"><span class="hljs-number"><span class="hljs-number">2</span></span>/<span class="hljs-number"><span class="hljs-number">10</span></span>/<span class="hljs-number"><span class="hljs-number">2016</span></span> <span class="hljs-number"><span class="hljs-number">10.02</span></span><span class="hljs-number"><span class="hljs-number">.2016</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>/<span class="hljs-number"><span class="hljs-number">2</span></span>/<span class="hljs-number"><span class="hljs-number">2016</span></span> €≤€∞€±€∂<span class="hljs-regexp"><span class="hljs-regexp">/€≤/</span></span>€±€∞ ŸÖ.</code> </pre> <br>  It looks like success!  Well, sometimes this trick works.  Here the fact that they are so perverted is more important.  This is another confirmation that PHP lacks that pattern generator itself. <br><br>  And <code>getDateTimeFormat</code> is an obvious mistake.  They concatenate date and time patterns.  No, dudes, the order of displaying the date and time is not the same in all locales, we have already seen this above. <br><br>  You can also look <a href="https://github.com/magento/magento2/blob/develop/lib/internal/Magento/Framework/Stdlib/DateTime/DateTimeFormatter.php">here</a> .  Anyway, great job, Magento! <br><br><h3>  Do you want to say that you are the first to notice the problem? </h3><br>  Not at all.  The guys from HHVM have long ported this generator - <a href="https://github.com/facebook/hhvm/commit/bc84daf7816e4cd268da59d535dcadfc6cf01085">https://github.com/facebook/hhvm/commit/bc84daf7816e4cd268da59d535dcadfc6cf01085</a> .  Respect! <br>  And there is also a bug in the PHP tracker - <a href="https://bugs.php.net/bug.php%3Fid%3D70377">https://bugs.php.net/bug.php?id=70377</a> "Please add DateTimePatternGenerator to intl".  By the way, vote if this problem touches you too.  Suddenly there this vote really means something.  ~ By the way, there is no protection against CSRF ~. <br><br><h3>  Anyone can criticize.  Here I would have taken it myself! </h3><br>  Well, in general, after several rather miserable attempts to draw the community‚Äôs attention to the problem and ask some of the developers to add the missing things to the <code>intl</code> , I did - <a href="https://github.com/ksimka/intl_dtpg">https://github.com/ksimka/intl_dtpg</a> .  This extension, which essentially implements a single function (as a function or class method) ‚Äúfind the most appropriate pattern for this set of parts of the date and time‚Äù.  The same <code>DateTimePatternGenerator::getBestPattern</code> (there are still a lot of interesting things in this class, but personally I‚Äôm critically missing only this method so far). <br><br>  But the problem is that I don‚Äôt shave either in C ++ or C. Therefore, use it at your own risk (after introduction, we‚Äôll tell you if everything is fine there).  The extension is written in C ++ based on the PHPCPP method examples + google + stackoverflow.  Therefore, any improvements are extremely welcome. <br><br>  In general, right there we have guys from PHP core dev team, port already, pliz, these missing parts in <code>intl</code> someone, or at least zadolbayte PHP developers requests.  You can say that I forced you, threatening to force <code>go</code> training. <br><br>  That's all.  Thank you for reading to the end! <br></div><p>Source: <a href="https://habr.com/ru/post/278673/">https://habr.com/ru/post/278673/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278659/index.html">Adding network drives with personal folders for users via GPP using the example of Windows Server 2012R2</a></li>
<li><a href="../278661/index.html">Synchronization primitives overview - Semaphore and some lockless</a></li>
<li><a href="../278663/index.html">Ace7096v10: the smallest PLC in the world</a></li>
<li><a href="../278669/index.html">Happy birthday jeff ruskin</a></li>
<li><a href="../278671/index.html">HTML and CSS in Oracle Application Express. Part 1</a></li>
<li><a href="../278675/index.html">The legend of the silver pool, or how I looked for logical caching and retrieval errors</a></li>
<li><a href="../278677/index.html">AudioCodes Routers</a></li>
<li><a href="../278679/index.html">Own "Who called?" On the basis of Multifon</a></li>
<li><a href="../278681/index.html">How to parse text with bare hardware, without a processor and without software</a></li>
<li><a href="../278683/index.html">iTrace. How are the letters written?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>