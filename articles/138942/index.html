<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Notes Asterisker. Make a duty roster ...</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúWe decided to make a FAIR distribution of incoming calls,‚Äù the management said: ‚ÄúEvery day of the month, calls will be made by DIFFERENT routes to ma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Notes Asterisker. Make a duty roster ...</h1><div class="post__text post__text-html js-mediator-article">  ‚ÄúWe decided to make a <a href="http://myasterisk.ru/">FAIR</a> distribution of incoming calls,‚Äù the management said: ‚ÄúEvery day of the month, calls will be made by DIFFERENT routes to managers.  The schedule will be a month in advance. " <br>  So, then once a month I will need to shovel the entire <a href="http://myasterisk.ru/">Asterisk</a> dialplan in accordance with the established scheme.  Very happy ... <a name="habracut"></a><br>  How it worked before. <br><br>  All incoming calls receive secretaries and transfer to managers like: <br>  <i>exten =&gt; 555.1, Dial (SIP / 22 &amp; SIP / 23 &amp; SIP / 24 &amp; SIP / 25)</i> <br><br>  those.  at the same time everyone starts calling phones.  Who first grabbed the phone - "that and sneakers." <br>  But this scheme has ceased to like.  Requested a random distribution sequence.  Well, no question: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>exten =&gt; 555,1, Set (variant = $ [RAND (1,5)])</i> <i><br></i>  <i>exten =&gt; 555, n, Goto (n ($ {variant})</i> <i><br></i>  <i>exten =&gt; 555, n (1), Dial (SIP / 22)</i> <i><br></i>  <i>...</i> <br><br>  This design lasted almost a few months and no one complained.  That's just the sales season began to subside and ... decided to change the sequence of calls.  Like on Monday, first 22, then 25, then 23, etc. <br>  I had to resort to constructions like GotoIFTime, and throw the sequence into groups by days of the week. <br>  As a result, a couple of months everything was fine. <br>  And now decided to make a schedule for each month!  Well - we will simplify the procedure. <br><br>  <b>Decision.</b> <br><br>  To begin with, I built a tablet in the MySQL database of the form: Dat (date of the month) and variant (line with the sequence of manager sip numbers).  It turned out something like "10/12/2011" - "2324252122" <br>  Further, in order not to suffer, I made a view that returns an entry from the given table of the current day: <br><br>  <i>CREATE</i> <i><br></i>  <i>VIEW `view_grafik`</i> <i><br></i>  <i>AS</i> <i><br></i>  <i>SELECT variant FROM grafik_work WHERE dat = CURDATE ();</i> <br><br>  There were trifles: <br><br>  <i>exten =&gt; s, n, MYSQL (Connect uid localhost asterisk 12345678 asterisk)</i> <i><br></i>  <i>exten =&gt; s, n, MYSQL (Query result $ {uid} Select `variant` from view_grafik)</i> <i><br></i>  <i>exten =&gt; s, n, MYSQL (Fetch row $ {result} variant)</i> <i><br></i>  <i>exten =&gt; s, n, NoOp (- $ {row} - $ {variant})</i> <i><br></i>  <i>exten =&gt; s, n, MYSQL (Disconnect $ {uid})</i> <br><br>  That is, the output in the <i>$ {variant}</i> variable is the sequence itself.  Not forgetting to check for the "emptiness" of a variable, we proceed to the challenge: <br>  <i>exten =&gt; s, n, Set (count = 0)</i> <i><br></i>  <i>exten =&gt; s, n, While ($ [$ {count} &lt;= 5])</i> <i><br></i>  <i>exten =&gt; s, n, Set (begin = $ [$ {count} * 2]}</i> <i><br></i>  <i>exten =&gt; s, n, Set (nomer = $ {variant: $ [$ {begin}]: 2})</i> <i><br></i>  <i>exten =&gt; s, n, Dial (SIP / $ {nomer})</i> <i><br></i>  <i>exten =&gt; s, n, Set (count = $ [$ {count} +1])</i> <i><br></i>  <i>exten =&gt; s, n, EndWhile ()</i> <br><br>  Everything!  It remains to fill out the <a href="http://myasterisk.ru/">web-interface</a> by the days of the month. <br>  By the way. <br>  Faced an interesting problem when solving.  Pay attention to the construction: <i>$ {variant: $ [$ {begin}]: 2}.</i> <br>  It was originally a different kind: <i>$ {variant: $ {begin}: 2}</i> , but ... I got this: <br>  232425 <br>  2425 <br>  25 <br>  those.  it seems to be correct, but the string did not consist of two numbers.  That's only after the introduction of square quotes, everything began to work correctly. </div><p>Source: <a href="https://habr.com/ru/post/138942/">https://habr.com/ru/post/138942/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138937/index.html">Nokia 808 PureView - new 41 megapixel camera phone</a></li>
<li><a href="../138938/index.html">2 in 1: sound amplifier and "home" power supply</a></li>
<li><a href="../138939/index.html">JUST - JavaScript Template Engine</a></li>
<li><a href="../138940/index.html">A simple indicator of the keyboard layout in C ++</a></li>
<li><a href="../138941/index.html">Automatically add keywords to files in TortoiseSVN under Windows</a></li>
<li><a href="../138944/index.html">The line of smartphones HTC One officially presented</a></li>
<li><a href="../138945/index.html">Yandex translation to bash using zenity</a></li>
<li><a href="../138946/index.html">Sqrt-decomposition (root optimization)</a></li>
<li><a href="../138947/index.html">Implementing a hierarchy ‚Äî combining the Adjacency List and Materialized Path through one-to-many</a></li>
<li><a href="../138948/index.html">WikiLeaks begins publishing letters "shadow CIA"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>