<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to access all properties of an object without using "reflection"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Why get access to all the properties of the object and not to change its interface? For example, in order to write your own serialization . Or to send...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to access all properties of an object without using "reflection"</h1><div class="post__text post__text-html js-mediator-article">  Why get access to all the properties of the object and not to change its interface?  For example, in order to write <a href="http://sebastian-bergmann.de/archives/831-Freezing-and-Thawing-PHP-Objects.html">your own serialization</a> .  Or to send an object in an acceptable form using http.  Or for something else. <br><a name="habracut"></a><br>  Take for experiment a simple class. <br><br><pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">aClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $protected_property = <span class="hljs-string"><span class="hljs-string">'protected_value'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $private_property = <span class="hljs-string"><span class="hljs-string">'private_value'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $public_property = <span class="hljs-string"><span class="hljs-string">'public_value'</span></span>; } $an_object = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> aClass; var_dump($an_object); <span class="hljs-comment"><span class="hljs-comment">// object(aClass)#1 (3) { // ["protected_property":protected]=&gt; // string(15) "protected_value" // ["private_property":"aClass":private]=&gt; // string(13) "private_value" // ["public_property"]=&gt; // string(12) "public_value" // }</span></span></code> </pre> <br><br>  If you use the "reflection", then you can get all the properties of the object, for example, in this way. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="php hljs">$an_array = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $reflection = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReflectionClass($an_object); $properties = $reflection-&gt;getProperties(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($properties <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $property) { $property-&gt;setAccessible(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $an_array[$property-&gt;getName()] = $property-&gt;getValue($an_object); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$property-&gt;isPublic()) $property-&gt;setAccessible(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } var_dump($an_array); <span class="hljs-comment"><span class="hljs-comment">// array(3) { // ["protected_property"]=&gt; // string(15) "protected_value" // ["private_property"]=&gt; // string(13) "private_value" // ["public_property"]=&gt; // string(12) "public_value" // }</span></span></code> </pre><br><br>  There is an <a href="http://www.php.net/manual/en/language.types.array.php">easier way</a> to get all the properties as an array. <br><br><pre> <code class="php hljs">$an_array = (<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>) $an_object; var_dump($an_array); <span class="hljs-comment"><span class="hljs-comment">// array(3) { // [" * protected_property"]=&gt; // string(15) "protected_value" // [" aClass private_property"]=&gt; // string(13) "private_value" // ["public_property"]=&gt; // string(12) "public_value" // }</span></span></code> </pre><br><br>  It turned out a bit "dirty", if necessary, you can clear the keys from unnecessary data.  For example, like this: <br><br><pre> <code class="php hljs">$key = ($key{<span class="hljs-number"><span class="hljs-number">0</span></span>} === <span class="hljs-string"><span class="hljs-string">"\0"</span></span>) ? substr($key, strpos($key, <span class="hljs-string"><span class="hljs-string">"\0"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>) : $key;</code> </pre><br><br>  By the way, the reverse trick with converting an array into an object will not work.  Thus, you can get only the object stdClass. <br><br><pre> <code class="php hljs">$an_another_object = (object) $an_array; var_dump($an_another_object); <span class="hljs-comment"><span class="hljs-comment">// object(stdClass)#6 (3) { // ["protected_property":protected]=&gt; // string(15) "protected_value" // ["private_property":"aClass":private]=&gt; // string(13) "private_value" // ["public_property"]=&gt; // string(12) "public_value" // }</span></span></code> </pre><br><br>  There is still an undocumented way to get properties.  This method even looks like a <a href="https://bugs.php.net/bug.php%3Fid%3D45281">bug</a> , but it is not so, so it can be safely used. <br><br><pre> <code class="php hljs">$an_array = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); reset($an_object); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">list</span></span>($key, $val) = each($an_object)) $an_array[$key] = $val; var_dump($an_array); <span class="hljs-comment"><span class="hljs-comment">// array(3) { // [" * protected_property"]=&gt; // string(15) "protected_value" // [" aClass private_property"]=&gt; // string(13) "private_value" // ["public_property"]=&gt; // string(12) "public_value" // }</span></span></code> </pre><br><br>  In turn, to set a new value for an arbitrary property (including a private one), you can use <a href="https://bugs.php.net/bug.php%3Fid%3D45937">another undocumented method</a> . <br><br><pre> <code class="php hljs">$an_array[<span class="hljs-string"><span class="hljs-string">"\0aClass\0private_property"</span></span>] = <span class="hljs-string"><span class="hljs-string">'new_private_value'</span></span>; array_walk($an_object, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$val, $key, $array)</span></span></span></span>{$val = $array[$key];}, $an_array); var_dump($an_object); <span class="hljs-comment"><span class="hljs-comment">// object(aClass)#1 (3) { // ["protected_property":protected]=&gt; // string(15) "protected_value" // ["private_property":"aClass":private]=&gt; // string(17) "new_private_value" // ["public_property"]=&gt; // string(12) "public_value" // }</span></span></code> </pre><br><br>  <b>Conclusion</b> <br><br>  Using this or that case, remember that in this way you faithlessly intrude into the protected area of ‚Äã‚Äãthe object, thereby bypassing all the protection in the form of protected or private, and the object will not even know about it.  Therefore, if there is a possibility, it is better to make special access methods. </div><p>Source: <a href="https://habr.com/ru/post/138102/">https://habr.com/ru/post/138102/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138096/index.html">Excavations build photohosting VK</a></li>
<li><a href="../138097/index.html">Porting games to Nokia N9</a></li>
<li><a href="../138098/index.html">Argentina, Chile and Bolivia plan to create a lithium cartel modeled on OPEC</a></li>
<li><a href="../138100/index.html">The controller of the new Xbox will be touch</a></li>
<li><a href="../138101/index.html">The best way to learn Rails</a></li>
<li><a href="../138103/index.html">DIY server-side LESS file processing</a></li>
<li><a href="../138104/index.html">We improve usability in 5 minutes</a></li>
<li><a href="../138106/index.html">Acer is going to release a "cloud" smartphone</a></li>
<li><a href="../138107/index.html">Postmaster.mail.ru - smart statistics</a></li>
<li><a href="../138111/index.html">Using GDB on the example of MaNGOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>