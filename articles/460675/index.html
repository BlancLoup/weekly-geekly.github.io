<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Retrieving machine learning data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Want to learn about the three methods for obtaining data for your next ML project? Then read the translation of the Rebecca Vickery article published ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Retrieving machine learning data</h1><div class="post__text post__text-html js-mediator-article">  Want to learn about the three methods for obtaining data for your next ML project?  Then read the translation of the Rebecca Vickery article published on the Towards Data Science blog on the Medium website!  It will be interesting for beginners. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ba/ce/h3/baceh3syebhbwo_3rvemwpfl8l8.jpeg"></div><br>  Obtaining qualitative data is the first and most important step in any machine learning project.  Data Science specialists often use various methods for obtaining datasets.  They can use publicly available data, as well as data that is accessed through the API or obtained from various databases, but most often combine these methods. <br><br>  The purpose of this article is to provide a brief overview of three different data extraction methods using the Python language.  I will tell you how to do this with Jupyter Notebook.  In my previous <a href="https://towardsdatascience.com/five-command-line-tools-for-data-science-29f04e5b9c16%3Fsource%3Dpost_page---------------------------">article</a> I wrote about the use of some commands launched in the terminal. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  SQL </h3><br>  If you need to get data from a relational database, most likely you will work with the SQL language.  The SQLAlchemy library allows you to associate your code in a laptop with the most common types of databases.  Under the <a href="https://docs.sqlalchemy.org/en/13/core/engines.html">link</a> you will find information about which databases are supported and how to bind to each type. <br><br>  You can use the SQLAlchemy library to browse tables and query data, or write raw queries.  To bind to the database you will need a URL with your credentials.  Next, you need to initialize the <code>create_engine</code> method to create the connection. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sqlalchemy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> create_engine engine = create_engine(<span class="hljs-string"><span class="hljs-string">'dialect+driver://username:password@host:port/database'</span></span>)</code> </pre> <br>  Now you can write database queries and get results. <br><br><pre> <code class="python hljs">connection = engine.connect() result = connection.execute(<span class="hljs-string"><span class="hljs-string">"select * from my_table"</span></span>)</code> </pre> <br><h3>  Scrapping </h3><br>  Web scraping is used to download data from websites and extract necessary information from their pages.  There are many Python libraries available for this, but the easiest is <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/">Beautiful Soup</a> . <br><br>  You can install the package via pip. <br><br><pre> <code class="python hljs">pip install BeautifulSoup4</code> </pre> <br>  Let's take a simple example to figure out how to use it.  We are going to use Beautiful Soup and the <a href="https://docs.python.org/3/library/urllib.html">urllib</a> library to scrap the names of the hotels and their prices from the <a href="https://www.tripadvisor.co.uk/">TripAdvisor</a> website. <br><br>  First we import all the libraries we are going to work with. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> bs4 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BeautifulSoup <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib.request</code> </pre> <br>  Now we load content of the page which we will scrap.  I want to collect data on prices for hotels on the Greek island of Crete and take the URL address containing the list of hotels in this place. <br><br><img src="https://habrastorage.org/webt/vt/jj/7i/vtjj7icfxauctiw_juiik0oqgfo.png"><br><br>  The code below defines the URL as a variable and uses the urllib library to open the page, and the Beautiful Soup library to read it and return the results in a simple format.  Part of the data output is shown under the code. <br><br><pre> <code class="python hljs">URL = <span class="hljs-string"><span class="hljs-string">'https://www.tripadvisor.co.uk/Hotels-g189413-Crete-Hotels.html'</span></span> page = urllib.request.urlopen(URL) soup = BeautifulSoup(page, <span class="hljs-string"><span class="hljs-string">'html.parser'</span></span>) print(soup.prettify())</code> </pre> <br><img src="https://habrastorage.org/webt/ul/n3/sn/uln3sn1bwjzjeft182k2dgbp7qo.png"><br><br>  Now let's get a list with the names of the hotels on the page.  We will introduce the <code>find_all</code> function, which will allow you to extract parts of the document of interest to us.  You can filter it differently using the <code>find_all</code> function to pass a single line, regular expression, or list.  You can also filter one of the attributes of the tag - this is exactly the method that we apply.  If you are not familiar with the tags and attributes of the HTML language, refer to this <a href="https://en.wikipedia.org/wiki/HTML_attribute">article</a> for a brief overview. <br><br>  To understand how best to provide access to the data in the tag, we need to check the code for this element on the page.  We find the code to the name of the hotel by right-clicking on the name in the list, as shown in the figure below. <br><br><img src="https://habrastorage.org/webt/uh/k5/zs/uhk5zsci0kajsubpkghjff3qnye.png"><br><br>  After clicking on the <code>inspect</code> item code will appear, and the section with the name of the hotel will be highlighted in color. <br><br><img src="https://habrastorage.org/webt/pc/fh/ms/pcfhmsrk8knqsjzr2lzsif2d2j4.png"><br><br>  We see that the name of the hotel is the only piece of text in the class (class) with the name <code>listing_title</code> .  After the class comes the code and the name of this attribute to the <code>find_all</code> function, as well as the <code>div</code> tag. <br><br><pre> <code class="python hljs">content_name = soup.find_all(<span class="hljs-string"><span class="hljs-string">'div'</span></span>, attrs={<span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'listing_title'</span></span>}) print(content_name)</code> </pre> <br>  Each section of the code with the name of the hotel is returned as a list. <br><br><img src="https://habrastorage.org/webt/gi/u2/b1/giu2b1wmq7holjcoeyfqohasg6u.png"><br><br>  To extract the names of hotels from the code, we will use the Beautiful Soup library <code>getText</code> function. <br><br><pre> <code class="python hljs">content_name_list = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> div <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> content_name: content_name_list.append(div.getText().split(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]) print(content_name_list)</code> </pre> <br>  Hotel names are returned as a list. <br><br><img src="https://habrastorage.org/webt/z0/bc/t-/z0bct-wezpzc8exsahj_fywmjnq.png"><br><br>  In the same way we obtain price data.  The code structure for the price is shown below. <br><br><img src="https://habrastorage.org/webt/v0/ok/oy/v0okoymlgmsbc6dtxicxwa_yz38.png"><br><br>  As you can see, we can work with code that is very similar to the one used for hotels. <br><br><pre> <code class="python hljs">content_price = soup.find_all(<span class="hljs-string"><span class="hljs-string">'div'</span></span>, attrs={<span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'price-wrap'</span></span>}) print(content_price)</code> </pre><br>  In the case of the price there is a small complexity.  You can see it by running the following code: <br><br><pre> <code class="python hljs">content_price_list = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> div <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> content_price: content_price_list.append(div.getText().split(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]) print(content_price_list)</code> </pre> <br>  The result is shown below.  If the list of hotels shows a reduction in price, in addition to some text, both the initial price and the final price are returned.  To fix this problem, we simply return the price that is relevant today. <br><br><img src="https://habrastorage.org/webt/52/6j/mn/526jmnbmxhchiyee4jr3feptxom.png"><br><br>  We can use simple logic to get the latest price indicated in the text. <br><br><pre> <code class="python hljs">content_price_list = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> content_price: a_split = a.getText().split(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(a_split) &gt; <span class="hljs-number"><span class="hljs-number">5</span></span>: content_price_list.append(a_split[<span class="hljs-number"><span class="hljs-number">-4</span></span>:]) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: content_price_list.append(a_split) print(content_price_list)</code> </pre> <br>  This will give us the following result: <br><br><img src="https://habrastorage.org/webt/kx/d0/sn/kxd0snvrauaecf_q4lvpjdu8-z0.png"><br><br><h3>  API </h3><br>  API - application programming interface (from the English. Application programming interface).  From a data retrieval point of view, this is a web-based system that provides a data endpoint with which you can communicate through programming.  Usually the data is returned in JSON or XML format. <br><br>  This method will probably come in handy for you in machine learning.  I‚Äôll give a simple example of retrieving weather data from the <a href="https://darksky.net/dev">Dark Sky</a> public API.  To connect to it, you need to register, and you will have 1000 free calls per day.  This should be enough for the sample. <br><br>  To access data from Dark Sky, I will use the <code>requests</code> library.  First I need to get the correct URL for the request.  In addition to the forecast, Dark Sky provides historical weather data.  In this example, I‚Äôll take them and get the correct URL from the <a href="https://darksky.net/dev/docs">documentation</a> . <br><br>  The structure of this URL is: <br><br><pre> <code class="python hljs">https://api.darksky.net/forecast/[key]/[latitude],[longitude],[time]</code> </pre> <br>  We will use the <code>requests</code> library to get <br>  results for specific latitude and longitude, as well as date and time.  Imagine that after extracting the daily data on the prices of hotels in Crete, we decided to find out whether the pricing policy is related to the weather. <br><br>  For example, let's take the coordinates of one of the hotels in the list - Mitsis Laguna Resort &amp; Spa. <br><br><img src="https://habrastorage.org/webt/1j/4a/is/1j4aissalsvek5uw2opv3v9hdhw.png"><br><br>  First, create a URL with the correct coordinates, as well as the requested time and date.  Using the <code>requests</code> library, we will access the data in JSON format. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests request_url = <span class="hljs-string"><span class="hljs-string">'https://api.darksky.net/forecast/fd82a22de40c6dca7d1ae392ad83eeb3/35.3378,-25.3741,2019-07-01T12:00:00'</span></span> result = requests.get(request_url).json() result</code> </pre><br>  To make the results easier to read and analyze, we can convert the data into a data frame. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd df = pd.DataFrame.from_dict(json_normalize(result), orient=<span class="hljs-string"><span class="hljs-string">'columns'</span></span>) df.head()</code> </pre> <br><img src="https://habrastorage.org/webt/jw/1w/sv/jw1wsv_9ixycnrfu44l7qhloxb4.png"><br><br>  There are many more options for automating data extraction using these methods.  In the case of web scraping, you can write different functions to automate the process and facilitate data retrieval for more days and / or places.  In this article I wanted to do a review and give enough examples with the code.  The following materials will be more detailed: I will explain how to create large datasets and analyze them using the methods described above. <br><br>  Thank you for attention! </div><p>Source: <a href="https://habr.com/ru/post/460675/">https://habr.com/ru/post/460675/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../46066/index.html">Sequential - free photo viewer for Mac OS X</a></li>
<li><a href="../460661/index.html">All you need to know about Node.js</a></li>
<li><a href="../460665/index.html">Draft FAQ: Why do C ++ standards come out every three years?</a></li>
<li><a href="../460669/index.html">How to ensure the safety of development, saving time and nerves</a></li>
<li><a href="../460671/index.html">Ownership and borrowing in D</a></li>
<li><a href="../46068/index.html">Formatting Long SQL Queries</a></li>
<li><a href="../460683/index.html">Laravel Event Projector and Event Generation Concept</a></li>
<li><a href="../460685/index.html">Distributing files from Google Drive via nginx</a></li>
<li><a href="../460687/index.html">How do the banks from the inside</a></li>
<li><a href="../460695/index.html">What is DAA, and how does this system help drones?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>