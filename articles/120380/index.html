<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Password protection for transmission over an open channel (part 1)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Using https for authentication has long been a good tone rule. However, the need to purchase a certificate leads to the fact that many owners of web-r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Password protection for transmission over an open channel (part 1)</h1><div class="post__text post__text-html js-mediator-article">  Using https for authentication has long been a good tone rule.  However, the need to purchase a certificate leads to the fact that many owners of web-resources still use the public channel for authentication and your access passwords can be intercepted by an attacker who has access to the network in which you work.  It should be noted that the use of https in general does not guarantee protection against interception of transmitted traffic.  Today, there are solutions based on the use of special proxies and domain policies that allow you to successfully read https traffic in corporate networks.  Next on how to still protect the password from interception. <br><a name="habracut"></a><br>  How are things going now?  The most typical situation is that the server stores the user password H (pwd) in the database and in the authentication process, having received the password from the user, calculates the hash and compares it with the standard.  Storing the password hash in the database, instead of the password itself, allows you to protect yourself against theft of authentication data by an unscrupulous administrator or a third-party intruder.  But despite this, every time you authenticate, the password is transmitted in the communication channel in the clear.  And intercepting the password gives the attacker full access to the corresponding account.  An <a href="http://www.ietf.org/rfc/rfc2617">authentication digest</a> mechanism was <a href="http://www.ietf.org/rfc/rfc2617">developed</a> to protect against password interception.  I simplified the algorithm a bit for ease of understanding.  At each session the server sends a random number Rnd to the client, the client sends H (Rnd + H (pwd)) in response.  As a result, interception will not give anything to the attacker, but now there is a weak point - server database.  Stored in the database password or password hash will allow you to recreate the client response required for authorization.  The theft of such a database becomes a serious threat to the security of the authentication mechanism. <br><br>  The following is an example of how you can protect a transmitted password from interception without creating an additional threat.  In this small alterations will affect only your service and will not affect your users. <br><br>  So: <br><ol><li>  The server stores in the database the client password hash H (pwd); </li><li>  The client sends its Login to the server; </li><li>  The server sends the client a random number Rnd encrypted on the client's H (pwd); </li><li>  The client calculates a random number Rnd using its password, then encrypts its password pwd using a random number Rnd and sends it to the server; </li><li>  The server decrypts the client password using a random number Rnd, calculates the password hash and compares it with the standard. </li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/4cb/818/ece/4cb818ece3b90b2c81330c45a324d6e2.png" alt="image"><br>  For those who are easier to understand by reading the code - <a href="">examples</a> .  PHP server side.  Client - Javascript.  You can also see a <a href="http://www.webtoken.ru/cryptopass">demonstration</a> .  AES encryption built on <a href="http://www.movable-type.co.uk/scripts/aes.html">Chrisa Veness libraries</a> <br>  Of course, this solution is not a panacea, and it only makes sense to use it when it is not possible to use https.  However, the use of the described algorithm will protect the transmitted password from sniffing and MitM attacks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://habrahabr.ru/blogs/web_security/120876/">part 2</a> </div><p>Source: <a href="https://habr.com/ru/post/120380/">https://habr.com/ru/post/120380/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../120373/index.html">NSPK: injured and winners</a></li>
<li><a href="../120374/index.html">Practical use of Asterisk at home</a></li>
<li><a href="../120375/index.html">Patterns of Command and Strategy in terms of functional programming</a></li>
<li><a href="../120377/index.html">New in Windows Azure Development Center on MSDN</a></li>
<li><a href="../120378/index.html">Dropbox - we get an additional 9 GB in one day</a></li>
<li><a href="../120382/index.html">Social Media Monitoring</a></li>
<li><a href="../120383/index.html">Features of national automation MS Excel</a></li>
<li><a href="../120384/index.html">3D illusions</a></li>
<li><a href="../120386/index.html">Blackberry Playbook interaction with Blackberry phone</a></li>
<li><a href="../120387/index.html">Application of SharePoint in the Russian web development market</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>