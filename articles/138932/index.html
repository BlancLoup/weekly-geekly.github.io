<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bash-script with gui for playing video from Vkontakte in a regular player</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Often, doing my own thing, I like to open some movies / clips / series that do not require any attention, hanging the player somewhere in the corner o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bash-script with gui for playing video from Vkontakte in a regular player</h1><div class="post__text post__text-html js-mediator-article">  Often, doing my own thing, I like to open some movies / clips / series that do not require any attention, hanging the player somewhere in the corner of the screen.  In our age of fast Internet and a large number of free videos on social networks (for example, Vkontakte), it is in many ways convenient to watch them in the stream without cluttering up the hard disk with unnecessary files ... But, trying to implement the scheme described above, we are faced with the fact that the browser window hangs with player "somewhere" in the corner of the screen so as to do something useful, no longer distracting video playback, is not so simple.  In addition, flash usually eats more resources than a regular player in the system, which is somewhat critical for low-power netbooks. <br><br>  Therefore (and also because there is no playlist in the Vkontakte player, and this makes it distracting from the main occupation when the series ends), after weighing all the pros and cons and looking at the source code of the video pages, I realized that for the most part, they are not are very different, and bash is quite enough to implement a born idea ‚Äî all that is required to get a link to a video from a page is to pick up the necessary regular expressions and parse the data obtained by wget using standard commands such as grep, sed and tr. <br><a name="habracut"></a><br><h5>  Getting Video </h5><br>  The first, and, probably, the only problem was the need for authorization in the contact, to get the majority of pages.  Using wget, it was not possible to use cookies from the browser and, because of this, it became necessary to create a file with cookies directly for wget: <br><br> <code>wget -O- -q --save-cookies .vk-cookie.txt "http://vk.com/login.php?act=login&amp;email=$mail&amp;pass=$pass" &gt;&gt;/dev/null</code> <br> <br>  Further it seemed not very difficult to find patterns and phrases from which you can push off and, using the capabilities of the sed editor, get a link to the video.  But here, too, some problems were waiting: one of the biggest surprises was the difference in the values ‚Äã‚Äãobtained in such cases as 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote><pre> <code class="hljs kotlin">echo <span class="hljs-string"><span class="hljs-string">"/me/"</span></span> | sed <span class="hljs-string"><span class="hljs-string">"s/\//\\\//"</span></span>g&gt;&gt;<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> echo <span class="hljs-string"><span class="hljs-string">"/me/"</span></span> | sed s/<span class="hljs-string"><span class="hljs-string">'\/'</span></span>/<span class="hljs-string"><span class="hljs-string">'\\\/'</span></span>/g &gt;&gt;<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span>=`echo <span class="hljs-string"><span class="hljs-string">"/me/"</span></span> | sed s/<span class="hljs-string"><span class="hljs-string">'\/'</span></span>/<span class="hljs-string"><span class="hljs-string">'\\\/'</span></span>/g` <span class="hljs-keyword"><span class="hljs-keyword">var</span></span>=`echo <span class="hljs-string"><span class="hljs-string">"/me/"</span></span> | sed s#<span class="hljs-string"><span class="hljs-string">'\/'</span></span>#<span class="hljs-string"><span class="hljs-string">'\\\/'</span></span>#g` <span class="hljs-keyword"><span class="hljs-keyword">var</span></span>=`echo <span class="hljs-string"><span class="hljs-string">"/me/"</span></span> | sed <span class="hljs-string"><span class="hljs-string">"s/\//\\\//"</span></span>g`</code> </pre> </blockquote>  In the first and third cases, the command is not executed, reporting a syntax error somewhere in the middle of the line.  In the fifth case, the command does nothing with the string being transmitted.  And only using the second and fourth options - we get the desired result (replacing "/" with "\ /"). <br>  Before adding a file to the playlist or downloading it, it was necessary to implement a check for its presence on the server - which was very easy to do with the standard wget features: <blockquote><pre> <code class="hljs vbscript">wget --spider $addr &gt;&gt;/dev/<span class="hljs-literal"><span class="hljs-literal">null</span></span> # checking <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ $? -ne <span class="hljs-number"><span class="hljs-number">0</span></span> ]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> file <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> exist <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> fi</code> </pre></blockquote><br><br>  Putting it all together, I got a not very complicated script to watch the video.  But to add each file was necessary <ol><li>  Copy link to it </li><li>  Open console </li><li>  Call the script </li><li>  Send him a link </li><li>  Select file actions (save / play) </li></ol><br>  Not the shortest sequence of actions, especially.  when you add the whole season of some series.  Therefore, after some thought, I sat down to look for opportunities to facilitate the process, without its substantial complication. <br><br><h4>  Process simplification </h4><br>  The first point was the use of a very useful utility <b>xsel</b> , which allows you to access the system buffer.  So the team was shortened from ‚Äúvkvid http: //csNNNNNN.vk.com/uNNNNNN/video/nnnnnnnnnnn.mn‚Äù, where there was always a need to change the link, to the constant vkvid "$ (xsel -o)", which could be taken from team history without thinking. <br><br><h6>  Graphical interface </h6><br>  The next, quite expected step was the addition of some kind, and a GUI.  Difficult options were not even considered, since for them it would be necessary to rewrite the main part of the script.  Therefore, after a brief search, several options were found: Xdialog and wider in terms of Zeniti capabilities. <br><br>  But neither one nor the other does not allow to implement at least some complicated windows that consider several options in themselves, such as Radiobutton, checklist and text form. <br><br>  Therefore, the search was continued until another version of the GUI for Bash scripts was found - <a href="http://code.google.com/p/yad/"><b>YAD</b></a> .  This still quite young, developing project was almost completely suitable for the task. <br><br>  Creating a window that was not overloaded did not take much time: <br><br><img src="https://habrastorage.org/storage2/57e/624/507/57e6245073e0e7769b4078bf174943d0.png"><br><br><blockquote><pre> <code class="hljs mel">action=$(yad --center --width=<span class="hljs-number"><span class="hljs-number">400</span></span> --title=<span class="hljs-string"><span class="hljs-string">"Vkvideo Save"</span></span> --<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>=<span class="hljs-string"><span class="hljs-string">"Simple video downloader"</span></span> --form --field=<span class="hljs-string"><span class="hljs-string">"Select Resolution::CB"</span></span> --field=<span class="hljs-string"><span class="hljs-string">"Name"</span></span> --field=<span class="hljs-string"><span class="hljs-string">"Folder:DIR"</span></span> --field=<span class="hljs-string"><span class="hljs-string">"Keep Cookies:CHK"</span></span> <span class="hljs-string"><span class="hljs-string">"720!480!360!240"</span></span> <span class="hljs-string"><span class="hljs-string">"$tname"</span></span> <span class="hljs-string"><span class="hljs-string">"$HOME"</span></span> TRUE --<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>=<span class="hljs-string"><span class="hljs-string">"Open File:2"</span></span> --<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>=<span class="hljs-string"><span class="hljs-string">"Save File:0"</span></span> --<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>=<span class="hljs-string"><span class="hljs-string">"gtk-cancel:1"</span></span>)</code> </pre> </blockquote><br>  The result of executing the form is a string separated by "|", in disassembling which again the sed editor came in handy. <br><br><blockquote><pre> <code class="hljs bash"> tres=`<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$action</span></span> | sed -es/<span class="hljs-string"><span class="hljs-string">'|.*|'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/` tname=`<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$action</span></span> | sed -es/<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">"</span></span><span class="hljs-string"><span class="hljs-string">'|'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/ | sed -es/<span class="hljs-string"><span class="hljs-string">"|.*"</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/` tfolder=`<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$action</span></span> | sed -es/<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">"</span></span><span class="hljs-string"><span class="hljs-string">'|'</span></span><span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string">"</span></span><span class="hljs-string"><span class="hljs-string">'|'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/ | sed -es/<span class="hljs-string"><span class="hljs-string">"|.*"</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/`</code> </pre> </blockquote><br>  As an added bonus, the implementation of the file upload process when downloading a file was very simple.  In Zeniti and very similar to it Yad, it only took one line <pre> <code class="hljs perl"><code> wget $addr -O <span class="hljs-string"><span class="hljs-string">"$tfolder/$tname.$tres.mov"</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span> |sed -u <span class="hljs-string"><span class="hljs-string">'s/.* \([0-9]\+%\)\ \+\([0-9.]\+.\) \(.*\)/\1\n# Downloading at \2\/s, time left: \3/'</span></span>| yad --width=<span class="hljs-number"><span class="hljs-number">500</span></span> --center --title=<span class="hljs-string"><span class="hljs-string">"Downloading progress"</span></span> \ --text=<span class="hljs-string"><span class="hljs-string">"Downloading '$tname.$tres.mov' "</span></span> --progress --auto-<span class="hljs-keyword"><span class="hljs-keyword">close</span></span> --auto-<span class="hljs-keyword"><span class="hljs-keyword">kill</span></span> &amp;</code></code> </pre> <br><br>  After writing, the command was attached to a keyboard shortcut.  Thus, the number of operations required to add a file has been reduced to 2: <br><ol><li>  Copy link from Vkontakte video search </li><li>  Press the key combination and select to save or add to the playlist </li></ol><br><br>  For correct work you need: <br><ul><li>  enco </li><li>  Yad </li><li>  Player - written for two options - SMPlayer and VLC </li></ul><br><br>  Code: <br><blockquote><pre> <code class="hljs kotlin">#!/bin/bash #$<span class="hljs-number"><span class="hljs-number">1</span></span> link name #$<span class="hljs-number"><span class="hljs-number">2</span></span> resolution #$<span class="hljs-number"><span class="hljs-number">3</span></span> save file name #checking <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> existing cookies res=(<span class="hljs-number"><span class="hljs-number">720</span></span> <span class="hljs-number"><span class="hljs-number">480</span></span> <span class="hljs-number"><span class="hljs-number">360</span></span> <span class="hljs-number"><span class="hljs-number">240</span></span>) tadr=$<span class="hljs-number"><span class="hljs-number">1</span></span> tres=$<span class="hljs-number"><span class="hljs-number">2</span></span> tname=$<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -z <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">"</span></span> ]; then echo <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">"</span></span> tres=<span class="hljs-number"><span class="hljs-number">720</span></span> fi <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ ! -f <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$HOME</span></span></span><span class="hljs-string">/.vk-cookie.txt"</span></span> ]; then action1=$(yad --center --title=<span class="hljs-string"><span class="hljs-string">"Lost cookies"</span></span> --text=<span class="hljs-string"><span class="hljs-string">"You need to enter mail and password"</span></span> --form --field=<span class="hljs-string"><span class="hljs-string">'Mail'</span></span> --field=<span class="hljs-string"><span class="hljs-string">'Password'</span></span>:H --button=<span class="hljs-string"><span class="hljs-string">"gtk-ok:0"</span></span> --button=<span class="hljs-string"><span class="hljs-string">"gtk-cancel:1"</span></span>) mail=`echo $action1 | sed -es/<span class="hljs-string"><span class="hljs-string">'|.*|'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/` password=`echo $action1 | sed -es/<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$mail</span></span></span><span class="hljs-string">|"</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/ | tr -d <span class="hljs-string"><span class="hljs-string">'|'</span></span>` echo <span class="hljs-string"><span class="hljs-string">"Getting cookies"</span></span> wget -O- -q --save-cookies .vk-cookie.txt <span class="hljs-string"><span class="hljs-string">"http://vk.com/login.php?act=login&amp;email=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$mail</span></span></span><span class="hljs-string">&amp;pass=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pass</span></span></span><span class="hljs-string">"</span></span> &gt;&gt;/dev/<span class="hljs-literal"><span class="hljs-literal">null</span></span> echo <span class="hljs-string"><span class="hljs-string">"Cookies saved"</span></span> fi <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$SoD</span></span></span><span class="hljs-string">"</span></span> != <span class="hljs-string"><span class="hljs-string">"finishdone"</span></span> ] <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> echo <span class="hljs-string"><span class="hljs-string">"Page downloading...."</span></span> LANG=ru_RU.CP1251 wget -q --load-cookies .vk-cookie.txt <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tadr</span></span></span><span class="hljs-string">"</span></span> -O .tempf #download the page echo <span class="hljs-string"><span class="hljs-string">"Page recieved"</span></span> enconv -x=UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> -L ru .tempf grep -i ltag .tempf| egrep -o <span class="hljs-string"><span class="hljs-string">"http:\\\/\\\/cs[0-9]*.vkontakte.ru\\\/[az][0-9]*\\\/"</span></span>| sed -es/<span class="hljs-string"><span class="hljs-string">'http:\\\/\\\/cs'</span></span>/<span class="hljs-string"><span class="hljs-string">'http:\/\/cs'</span></span>/ | sed -es/<span class="hljs-string"><span class="hljs-string">'vkontakte.ru\\\/'</span></span>/<span class="hljs-string"><span class="hljs-string">'vk.com\/'</span></span>/| sed -es/<span class="hljs-string"><span class="hljs-string">'\\'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/ &gt;&gt; .tempama #<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> server and owner names echo video/&gt;&gt; .tempama <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string">"</span></span> == <span class="hljs-string"><span class="hljs-string">""</span></span> ]; then #echo `cat .tempf` egrep -o <span class="hljs-string"><span class="hljs-string">"md_title.*md_author"</span></span> .tempf | sed -es/<span class="hljs-string"><span class="hljs-string">'md_title\\\"\:\\\"'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/ |sed -es/<span class="hljs-string"><span class="hljs-string">'\\\"\,\\\"md_author.*'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/&gt;&gt;.tempnam tname=`cat .tempnam|sed s#<span class="hljs-string"><span class="hljs-string">' | '</span></span>#<span class="hljs-string"><span class="hljs-string">' '</span></span>#g|sed s#<span class="hljs-string"><span class="hljs-string">'[|,/,\]'</span></span>#<span class="hljs-string"><span class="hljs-string">' '</span></span>#g|tr --squeeze-repeats <span class="hljs-string"><span class="hljs-string">' '</span></span>| tr <span class="hljs-string"><span class="hljs-string">'[]{}'</span></span> <span class="hljs-string"><span class="hljs-string">'()()'</span></span>|sed s#<span class="hljs-string"><span class="hljs-string">' \([(,)]\)'</span></span>#<span class="hljs-string"><span class="hljs-string">'\1'</span></span>#g|sed s#<span class="hljs-string"><span class="hljs-string">'\([(,)]\) '</span></span>#<span class="hljs-string"><span class="hljs-string">'\1'</span></span>#g` rm .tempnam fi addr=`cat .tempama` addr=`echo $addr | tr -d <span class="hljs-string"><span class="hljs-string">' '</span></span>` <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ $addr == <span class="hljs-string"><span class="hljs-string">"video/"</span></span> ]; then tadr=$(yad --width <span class="hljs-number"><span class="hljs-number">500</span></span> --center --title=<span class="hljs-string"><span class="hljs-string">"Bad address"</span></span> --text=<span class="hljs-string"><span class="hljs-string">"Bad address. Reenter please"</span></span> --entry --button=<span class="hljs-string"><span class="hljs-string">"gtk-cancel:1"</span></span> ) rm .tempama rm .tempf <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> SoD=finishdone fi done echo <span class="hljs-string"><span class="hljs-string">"Ready for downloading"</span></span> action=$(yad --center --width=<span class="hljs-number"><span class="hljs-number">400</span></span> --title=<span class="hljs-string"><span class="hljs-string">"Vkvideo Save"</span></span> --text=<span class="hljs-string"><span class="hljs-string">"Simple video downloader"</span></span> --form --field=<span class="hljs-string"><span class="hljs-string">"Select Resolution::CB"</span></span> --field=<span class="hljs-string"><span class="hljs-string">"Name"</span></span> --field=<span class="hljs-string"><span class="hljs-string">"Folder:DIR"</span></span> --field=<span class="hljs-string"><span class="hljs-string">"Keep Cookies:CHK"</span></span> <span class="hljs-string"><span class="hljs-string">"720!480!360!240"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$HOME</span></span></span><span class="hljs-string">"</span></span> TRUE --button=<span class="hljs-string"><span class="hljs-string">"Open File:2"</span></span> --button=<span class="hljs-string"><span class="hljs-string">"Save File:0"</span></span> --button=<span class="hljs-string"><span class="hljs-string">"gtk-cancel:1"</span></span>) SO=$? tres=`echo $action | sed -es/<span class="hljs-string"><span class="hljs-string">'|.*|'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/` tname=`echo $action | sed -es/<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">"</span></span><span class="hljs-string"><span class="hljs-string">'|'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/ | sed -es/<span class="hljs-string"><span class="hljs-string">"|.*"</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/` tfolder=`echo $action | sed -es/<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">"</span></span><span class="hljs-string"><span class="hljs-string">'|'</span></span><span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string">"</span></span><span class="hljs-string"><span class="hljs-string">'|'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/ | sed -es/<span class="hljs-string"><span class="hljs-string">"|.*"</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/` echo $tfolder | sed <span class="hljs-string"><span class="hljs-string">"s$\/$\\\/$"</span></span>g&gt;&gt;tvar tvar=`cat tvar` keep=`echo $action | sed -es/<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">"</span></span><span class="hljs-string"><span class="hljs-string">'|'</span></span><span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string">"</span></span><span class="hljs-string"><span class="hljs-string">'|'</span></span><span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tvar</span></span></span><span class="hljs-string">"</span></span><span class="hljs-string"><span class="hljs-string">'|'</span></span>/<span class="hljs-string"><span class="hljs-string">''</span></span>/ | tr -d <span class="hljs-string"><span class="hljs-string">'|'</span></span>` rm tvar grep -i ltag .tempf| egrep -o <span class="hljs-string"><span class="hljs-string">'vtag\\\"\:\\\"[a-z0-9]*\\'</span></span>| sed <span class="hljs-string"><span class="hljs-string">'s/vtag\\\"\:\\\"//'</span></span>|sed -es/<span class="hljs-string"><span class="hljs-string">'\\'</span></span>/<span class="hljs-string"><span class="hljs-string">'\.'</span></span><span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">"</span></span><span class="hljs-string"><span class="hljs-string">'\.mov'</span></span>/ &gt;&gt;.tempam #<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> video file name addr=`cat .tempama .tempam` #recover full link addr=`echo $addr | tr -d <span class="hljs-string"><span class="hljs-string">' '</span></span>` #remove spaces rm .tempama rm .tempam rm .tempf case $keep <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> TRUE) ;; FALSE) rm $HOME/.vk-cookie.txt;; esac case $SO <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>) wget --spider $addr &gt;&gt;/dev/<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ $? -ne <span class="hljs-number"><span class="hljs-number">0</span></span> ]; then rm <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string">.</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">.mov"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ((i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= <span class="hljs-number"><span class="hljs-number">3</span></span> ; i++)) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ $i -ne <span class="hljs-number"><span class="hljs-number">0</span></span> ];then let <span class="hljs-string"><span class="hljs-string">"j = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string"> - 1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> j=<span class="hljs-number"><span class="hljs-number">0</span></span>; fi <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ ${res[$i]} -le $tres ]; then addr=`echo $addr | sed -es/<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${res[$j]}</span></span></span><span class="hljs-string">"</span></span>/<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${res[$i]}</span></span></span><span class="hljs-string">"</span></span>/` <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ ${res[$i]} -ne $tres ];then wget --spider $addr &gt;&gt;/dev/<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ $? -eq <span class="hljs-number"><span class="hljs-number">0</span></span> ]; then RtD=<span class="hljs-number"><span class="hljs-number">2</span></span> tres=${res[$i]} i=<span class="hljs-number"><span class="hljs-number">10</span></span> fi fi fi done <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> RtD=<span class="hljs-number"><span class="hljs-number">1</span></span> fi rand=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$RANDOM</span></span></span><span class="hljs-string"> `date`"</span></span> pipe=<span class="hljs-string"><span class="hljs-string">"/tmp/pipe.`echo '</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$rand</span></span></span><span class="hljs-string">' | md5sum | tr -d ' -'`"</span></span> mkfifo $pipe tdown=<span class="hljs-number"><span class="hljs-number">0</span></span> tnamesp=`echo <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string">"</span></span> |tr -d <span class="hljs-string"><span class="hljs-string">'|'</span></span>| tr <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-string"><span class="hljs-string">'_'</span></span>` wget -c $addr -O <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tfolder</span></span></span><span class="hljs-string">/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tnamesp</span></span></span><span class="hljs-string">.</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">.mov"</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span> | <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> read <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"`echo </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$data</span></span></span><span class="hljs-string"> | grep '^Length:'`"</span></span> ]; then total_size=`echo $<span class="hljs-keyword"><span class="hljs-keyword">data</span></span> | grep <span class="hljs-string"><span class="hljs-string">"^Length:"</span></span> | sed <span class="hljs-string"><span class="hljs-string">'s/.*\((.*)\).*/\1/'</span></span> | tr -d <span class="hljs-string"><span class="hljs-string">'()'</span></span>` fi <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"`echo </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$data</span></span></span><span class="hljs-string"> | grep '[0-9]*%' `"</span></span> ];then percent=`echo $<span class="hljs-keyword"><span class="hljs-keyword">data</span></span> | grep -o <span class="hljs-string"><span class="hljs-string">"[0-9]*%"</span></span> | tr -d <span class="hljs-string"><span class="hljs-string">'%'</span></span>` current=`echo $<span class="hljs-keyword"><span class="hljs-keyword">data</span></span> | grep <span class="hljs-string"><span class="hljs-string">"[0-9]*%"</span></span> | sed <span class="hljs-string"><span class="hljs-string">'s/\([0-9BKMG.]\+\).*/\1/'</span></span> ` echo $percent echo <span class="hljs-string"><span class="hljs-string">"#Name: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tnamesp</span></span></span><span class="hljs-string"> \nVideo size: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string"> \nFrom: $1\n</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$current</span></span></span><span class="hljs-string"> of </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$total_size</span></span></span><span class="hljs-string"> (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$percent</span></span></span><span class="hljs-string">%)\n"</span></span> fi <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$current</span></span></span><span class="hljs-string">"</span></span> != <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$total_size</span></span></span><span class="hljs-string">"</span></span> ];then tdown=fail fi done &gt; $pipe &amp; wget_info=`ps ax |grep <span class="hljs-string"><span class="hljs-string">"wget.*</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$addr</span></span></span><span class="hljs-string">"</span></span> |awk <span class="hljs-string"><span class="hljs-string">'{print $1"|"$2}'</span></span>` wget_pid=`echo $wget_info|cut -d<span class="hljs-string"><span class="hljs-string">'|'</span></span> -f1 ` zenity --progress --auto-close --text=<span class="hljs-string"><span class="hljs-string">"Connecting to </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$addr</span></span></span><span class="hljs-string">\n\n\n"</span></span> --width=<span class="hljs-string"><span class="hljs-string">"350"</span></span> --title=<span class="hljs-string"><span class="hljs-string">"Downloading"</span></span>&lt; $pipe <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"`ps -A |grep "</span></span>$wget_pid<span class="hljs-string"><span class="hljs-string">"`"</span></span> ];then kill $wget_pid rm $tnamesp.$tres.mov tdown=fail fi rm -f $pipe <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tdown</span></span></span><span class="hljs-string">"</span></span> != <span class="hljs-string"><span class="hljs-string">"fail"</span></span> ] then case $RtD <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>) echo <span class="hljs-string"><span class="hljs-string">"Resolution change. File "</span></span>$tnamesp<span class="hljs-string"><span class="hljs-string">"."</span></span>$tres<span class="hljs-string"><span class="hljs-string">".mov successfully saved"</span></span> yad --center --text-align=center --height=<span class="hljs-number"><span class="hljs-number">25</span></span> --title=<span class="hljs-string"><span class="hljs-string">"File Saved"</span></span> --no-buttons --timeout=<span class="hljs-number"><span class="hljs-number">8</span></span> --text=<span class="hljs-string"><span class="hljs-string">"Resolution change. File </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tnamesp</span></span></span><span class="hljs-string">.</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">.mov successfully saved"</span></span>;; <span class="hljs-number"><span class="hljs-number">1</span></span>) yad --center --text-align=center --height=<span class="hljs-number"><span class="hljs-number">25</span></span> --title=<span class="hljs-string"><span class="hljs-string">"File Saved"</span></span> --no-buttons --timeout=<span class="hljs-number"><span class="hljs-number">8</span></span> --text=<span class="hljs-string"><span class="hljs-string">"File </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tnamesp</span></span></span><span class="hljs-string">.</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">.mov successfully saved"</span></span> echo <span class="hljs-string"><span class="hljs-string">"File "</span></span>$tnamesp<span class="hljs-string"><span class="hljs-string">"."</span></span>$tres<span class="hljs-string"><span class="hljs-string">".mov successfully saved"</span></span>;; esac <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> yad --center --text-align=center --height=<span class="hljs-number"><span class="hljs-number">25</span></span> --title=<span class="hljs-string"><span class="hljs-string">"ERROR"</span></span> --no-buttons --timeout=<span class="hljs-number"><span class="hljs-number">8</span></span> --text=<span class="hljs-string"><span class="hljs-string">"File </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string">.</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">.mov has NOT been saved"</span></span> fi;; <span class="hljs-number"><span class="hljs-number">2</span></span>) wget --spider $addr &gt;&gt;/dev/<span class="hljs-literal"><span class="hljs-literal">null</span></span> # checking <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ $? -ne <span class="hljs-number"><span class="hljs-number">0</span></span> ]; then <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ((i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= <span class="hljs-number"><span class="hljs-number">3</span></span> ; i++)) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ $i -ne <span class="hljs-number"><span class="hljs-number">0</span></span> ];then let <span class="hljs-string"><span class="hljs-string">"j = </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string"> - 1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> j=<span class="hljs-number"><span class="hljs-number">0</span></span>; fi <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ ${res[$i]} -le $tres ]; then addr=`echo $addr | sed -es/<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${res[$j]}</span></span></span><span class="hljs-string">"</span></span>/<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${res[$i]}</span></span></span><span class="hljs-string">"</span></span>/` <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ ${res[$i]} -ne $tres ];then wget --spider $addr &gt;&gt;/dev/<span class="hljs-literal"><span class="hljs-literal">null</span></span> # checking <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ $? -eq <span class="hljs-number"><span class="hljs-number">0</span></span> ]; then i=<span class="hljs-number"><span class="hljs-number">10</span></span>; fi fi fi done fi echo <span class="hljs-string"><span class="hljs-string">"Playing file"</span></span> echo <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string">"</span></span> #vlc --started-from-file --playlist-enqueu <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$addr</span></span></span><span class="hljs-string">"</span></span> &amp; smplayer -minigui -add-to-playlist $addr &amp; sleep <span class="hljs-number"><span class="hljs-number">5</span></span> echo <span class="hljs-string"><span class="hljs-string">"File is playing"</span></span>;; esac exit</code> </pre></blockquote><br><br>  <b>UPD: The</b> ease of implementation of the progress bar was somewhat exaggerated.  Download GUI was disabled when the size of the saved part of the file exceeded 100 Mb.  Therefore, with the help of Google and <a href="http://ubuntuforums.org/showthread.php%3Ft%3D306515%26page%3D2">Ubuntuforums</a> , minor adjustments were made: <br><blockquote><pre> <code class="hljs bash">rand=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$RANDOM</span></span></span><span class="hljs-string"> `date`"</span></span> pipe=<span class="hljs-string"><span class="hljs-string">"/tmp/pipe.`echo '</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$rand</span></span></span><span class="hljs-string">' | md5sum | tr -d ' -'`"</span></span> mkfifo <span class="hljs-variable"><span class="hljs-variable">$pipe</span></span> wget -c <span class="hljs-variable"><span class="hljs-variable">$addr</span></span> -O <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tfolder</span></span></span><span class="hljs-string">/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string">.</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string">.mov"</span></span> 2&gt;&amp;1 | <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-built_in"><span class="hljs-built_in">read</span></span> data; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"`echo </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$data</span></span></span><span class="hljs-string"> | grep '^Length:'`"</span></span> ]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> total_size=`<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$data</span></span> | grep <span class="hljs-string"><span class="hljs-string">"^Length:"</span></span> | sed <span class="hljs-string"><span class="hljs-string">'s/.*\((.*)\).*/\1/'</span></span> | tr -d <span class="hljs-string"><span class="hljs-string">'()'</span></span>` <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"`echo </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$data</span></span></span><span class="hljs-string"> | grep '[0-9]*%' `"</span></span> ];<span class="hljs-keyword"><span class="hljs-keyword">then</span></span> percent=`<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$data</span></span> | grep -o <span class="hljs-string"><span class="hljs-string">"[0-9]*%"</span></span> | tr -d <span class="hljs-string"><span class="hljs-string">'%'</span></span>` current=`<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$data</span></span> | grep <span class="hljs-string"><span class="hljs-string">"[0-9]*%"</span></span> | sed <span class="hljs-string"><span class="hljs-string">'s/\([0-9BKMG.]\+\).*/\1/'</span></span> ` <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$percent</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"#Name: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tname</span></span></span><span class="hljs-string"> \nVideo size: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$tres</span></span></span><span class="hljs-string"> \nFrom: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$1</span></span></span><span class="hljs-string">\n</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$current</span></span></span><span class="hljs-string"> of </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$total_size</span></span></span><span class="hljs-string"> (</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$percent</span></span></span><span class="hljs-string">%)\n"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$current</span></span></span><span class="hljs-string">"</span></span> != <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$total_size</span></span></span><span class="hljs-string">"</span></span> ];<span class="hljs-keyword"><span class="hljs-keyword">then</span></span> tdown=fail <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span> <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> &gt; <span class="hljs-variable"><span class="hljs-variable">$pipe</span></span> &amp; wget_info=`ps ax |grep <span class="hljs-string"><span class="hljs-string">"wget.*</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$addr</span></span></span><span class="hljs-string">"</span></span> |awk <span class="hljs-string"><span class="hljs-string">'{print $1"|"$2}'</span></span>` wget_pid=`<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$wget_info</span></span>|cut -d<span class="hljs-string"><span class="hljs-string">'|'</span></span> -f1 ` zenity --progress --auto-close --text=<span class="hljs-string"><span class="hljs-string">"Connecting to </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$addr</span></span></span><span class="hljs-string">\n\n\n"</span></span> --width=<span class="hljs-string"><span class="hljs-string">"350"</span></span> --title=<span class="hljs-string"><span class="hljs-string">"Downloading"</span></span>&lt; <span class="hljs-variable"><span class="hljs-variable">$pipe</span></span></code> </pre> </blockquote><br>  <b>UPD2:</b> corrected a bug that manifests itself when saved, if the title contains special characters: [,], {.}, | <br><br>  The full version of the code is fixed. </div><p>Source: <a href="https://habr.com/ru/post/138932/">https://habr.com/ru/post/138932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138926/index.html">For the benefit of logistics</a></li>
<li><a href="../138927/index.html">JavaScript Conference</a></li>
<li><a href="../138929/index.html">Huawei at the MWC 2012</a></li>
<li><a href="../138930/index.html">Application Developer Days conference will be in May</a></li>
<li><a href="../138931/index.html">LG Optimus Vu at MWC 2012</a></li>
<li><a href="../138933/index.html">Customizing Magento using Event / Observer</a></li>
<li><a href="../138934/index.html">Search engine YossarianLives searches for metaphors</a></li>
<li><a href="../138937/index.html">Nokia 808 PureView - new 41 megapixel camera phone</a></li>
<li><a href="../138938/index.html">2 in 1: sound amplifier and "home" power supply</a></li>
<li><a href="../138939/index.html">JUST - JavaScript Template Engine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>