<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The neural network counting mechanism in PL / SQL for handwriting recognition</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dear colleagues, we are in a hurry to please everyone who is not indifferent to science-intensive tasks. Today we have prepared for you a translation ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The neural network counting mechanism in PL / SQL for handwriting recognition</h1><div class="post__text post__text-html js-mediator-article">  <i>Dear colleagues, we are in a hurry to please everyone who is not indifferent to science-intensive tasks.</i>  <i>Today we have prepared for you a translation of a curious publication from experts on databases from CERN, dedicated to the training and operation of neural networks using Python and tools based on Oracle PL / SQL.</i> <br><br><img src="https://habrastorage.org/web/9a2/157/848/9a2157848c8e4a4281f50b7f374edc37.png"><br><br>  In this article you will find an example of building and deploying a basic mechanism for counting an artificial neural network using <b>PL / SQL</b> .  The article is intended for educational purposes, in particular for Oracle practitioners who want to get acquainted with <b>neural networks</b> with a concrete example. <br><a name="habracut"></a><br>  Currently, <b>machine learning</b> and <b>neural networks</b> are current topics in data processing.  Many tools and platforms are now available for work and experiments with neural networks and <b>deep learning</b> (see links at the end of this article).  Recognition of handwritten numbers, in particular, using the <a href="http://yann.lecun.com/exdb/mnist/">MNIST database</a> , <a href="https://twitter.com/ylecun">Jan Lekun,</a> and others, is now an introductory example for familiarizing with neural networks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this article, you will see how to build and deploy a simple neural network <b>counting mechanism</b> to recognize handwritten numbers using <b>Oracle</b> and PL / SQL.  The end result is a small <b>PL / SQL</b> package with an accuracy of about 98%.  The neural network is created and trained using <a href="https://www.tensorflow.org/">TensorFlow</a> , and then transferred to Oracle for maintenance. <br><br>  One of the ideas that this article aims to illustrate is that counting neural networks is much simpler than their training: the operations necessary <b>to maintain a trained network</b> can be implemented relatively easily in many languages ‚Äã‚Äã/ programming environments.  Discussions on these topics are usually centered around platforms for ‚ÄúBig data‚Äù (for example, <a href="https://databricks.com/blog/2016/01/25/deep-learning-with-apache-spark-and-tensorflow.html">Spark</a> and <a href="http://spark.apache.org/docs/latest/mllib-guide.html">MLlib</a> ).  Interestingly, neural networks can also be successfully applied in the world of RDBMS.  This can be useful since a large amount of valuable data is currently stored in <b>relational databases</b> .  In the case of Oracle, the implementation of the counting mechanism is also simplified due to the presence of a mature PL / SQL environment with a package for <b>linear algebra</b> : <a href="http://docs.oracle.com/cd/E11882_01/appdev.112/e40758/u_nla.htm">UTL_NLA</a> . <br><br>  <b>Let's start from the end: how to deploy the MNIST PL / SQL package and recognize handwritten numbers in Oracle</b> <br><br>  One short PL / SQL package and two tables are all you need to play the next example (you can find the detailed code on <a href="https://github.com/LucaCanali/Miscellaneous/blob/master/PLSQL_Neural_Network/MNIST_oracle_plsql.ipynb">Github</a> ).  Tables: <br><br><ul><li>  <b>TENSORS_ARRAY</b> : This table contains numerical values ‚Äã‚Äãfor the vectors and matrices (tensors) that make up the neural network.  There are a total of 79510 floating point numbers encoded in four tensors using the UTL_NLA_ARRAY_FLT data type. </li><li>  <b>TESTDATA_ARRAY</b> : This table contains test images.  There are 10K images, each of which consists of 28 * 28 = 784 pixels.  Images are also encoded using the <b>UTL_NLA_ARRAY_FLT</b> data <b>type</b> . </li></ul><br>  The mechanism for counting the neural network from the example is in a package called <b>MNIST</b> .  It has an <b>INIT</b> procedure that loads the neural network components from the tensors_array table into PL / SQL variables and the <b>SCORE</b> function, which takes an image as input and returns a number ‚Äî the predicted value of the digit. <br><br>  Here is an example of its use, where the first picture in the testdata_array table is checked and correctly recognized as an image of the number 7 (the image label is consistent with the prediction MNIST.SCORE): <br><br><pre><code class="sql hljs">SQL&gt; exec mnist.init PL/SQL procedure successfully completed. SQL&gt; <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> mnist.score(image_array), label <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> testdata_array <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rownum</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>; MNIST.SCORE(IMAGE_ARRAY) LABEL <span class="hljs-comment"><span class="hljs-comment">------------------------ ---------- 7 7</span></span></code> </pre> <br><img src="https://habrastorage.org/web/901/5ce/0a7/9015ce0a74064af5bc036c843bc42168.png"><br><br>  <b>Figure 1</b> : This is a raster display of the test image used in the example.  It confirms that the MNIST.SCORE prediction is correct and indeed the picture is an image of the number 7, handwritten and encoded in a grid of 28x28 gray-scale pixels. <br><br>  Processing of all test images is also performed with a simple SQL command.  In the example in fig.  2, it takes 2 minutes to process 10,000 test images, an average of about 12 ms per image.  <b>The accuracy of the evaluation function is about 98%</b> .  It is calculated as follows: according to data labels, 9787 out of 10,000 images are estimated correctly.  Note also that the set of test images does not overlap with the images used to train the neural network.  Therefore, we can expect that the MNIST package has a digit recognition accuracy of about 98%, including when used on general input. <br><br>  The complete PL / SQL code and datapump <b>dump file</b> with the corresponding tables <a href="https://github.com/LucaCanali/Miscellaneous/tree/master/PLSQL_Neural_Network">can be found on Github</a> .  In the following paragraphs, I will explain how to build and train a neural network. <br><br><img src="https://habrastorage.org/web/30b/b9a/391/30bb9a391d244821b890b2e2b51b312f.png"><br><br>  <b>Figure 2</b> : The accuracy of the PL / SQL MNIST.SCORE evaluation function on a test set of 10K images is about 98%.  Processing takes about 12 ms per image. <br><br>  <b>Neural network</b> <br><br>  The neural network used in this article consists of three layers (see Fig. 3): one input layer, one hidden layer and one output layer.  If this topic is new to you, I recommend reading additional literature (see References) and, in particular, the book <a href="http://neuralnetworksanddeeplearning.com/">‚ÄúNeural Networks and Deep Learning‚Äù by</a> <a href="https://twitter.com/michael_nielsen">Michael Nielsen</a> , which will provide an excellent introduction to the topic and a series of step-by-step examples regarding the problem of recognizing handwritten numbers. <br><br><img src="https://habrastorage.org/web/00e/2c8/f57/00e2c8f57a0041b394e922789194494d.png"><br><br>  <b>Figure 3</b> : The artificial neural network used in this article consists of three layers.  The input layer contains 784 neurons, one per pixel of the incoming image.  To improve accuracy, a hidden layer of 100 neurons is added.  The output layer has 10 neurons, one for each possible output value (that is, numbers from 0 to 9). <br><br>  <b>Get training and test data, build and train a neural network.</b> <br><br>  Another important step for deploying neural networks is <b>learning</b> .  For this you need <b>data</b> , if possible a lot.  You also need an engine to do the necessary calculations.  Fortunately, there are many platforms available for working with neural networks that are free and relatively used for deployment (see References).  In this article, you will see how to use <a href="https://www.tensorflow.org/">TensorFlow from Google</a> and the Python environment.  TensorFlow comes with <a href="https://www.tensorflow.org/versions/r0.7/tutorials/mnist/beginners/index.html">instructions</a> for recognizing handwritten numbers in the <a href="http://yann.lecun.com/exdb/mnist/">MNIST database</a> .  The instruction includes training and test <b>data with labels</b> , as well as code samples. <br><br>  You can find the code I used to train the neural network on <a href="https://github.com/LucaCanali/Miscellaneous/blob/master/PLSQL_Neural_Network/MNIST_tensorflow_exp_to_oracle.ipynb">Github</a> .  Some highlights and code snippets are discussed below. <br><br>  <b>Data Import</b> : The sample data set that comes with TensorFlow includes 55,000 images for training and 10,000 images for testing.  They initially proceed from the work of <a href="https://twitter.com/ylecun">Jan Lekun</a> and colleagues.  Having a lot of high-quality data is very important for the success of the process.  In addition, the images have <b>labels</b> : they indicate how many are shown in the picture, and this information is very important because the exercise is to implement <a href="https://en.wikipedia.org/wiki/Supervised_learning">supervised learning</a> . <br><br>  <b>Definition of a neural network</b> : there are four tensors in the network (in this case, a vector and matrices): W0, W1, b0 and b1.  They are defined in the following code snippet.  To better understand their role, as well as the value of cross-entropy and the optimizer of gradient descent for neural network training, see the links, namely <a href="http://neuralnetworksanddeeplearning.com/">‚ÄúNeural Networks and Deep Learning‚Äù</a> and the <a href="https://www.tensorflow.org/get_started/mnist/beginners">TensorFlow</a> instruction. <br><br><img src="https://habrastorage.org/web/fd7/441/287/fd74412875e4473f9a45e668e3bb41a2.png"><br><br>  <b>Neural network</b> training: training takes place with several stages of optimization.  It is performed using 55,000 tagged images.  More than 30,000 iterations are performed using ‚Äúmini-portions‚Äù with a size of 100 images.  At each step, the gradient descent algorithm calculates the update of weights and offsets (W0, W1, bo, and b1) in order to minimize the loss function (cross_entropy).  Corresponding code snippet: <br><br><img src="https://habrastorage.org/web/6f4/58c/860/6f458c86074348f2b7cf667b4adad5f7.png"><br><br>  <b>Result</b> : as a result, the trained network has an <b>accuracy of about 98%</b> in predicting the images in the test set.  Please note that the test set consists of 10,000 images and does not match the set of images used for training (the training set contains 55,000 images). <br><br>  Higher accuracy can be obtained with more complex neural network configurations (see Links for details), but this is beyond the scope of this article. <br><br>  <b>Manual counting of a neural network, example in Python</b> <br><br>  The main result of the training operations is that the tensors (in this case, the matrices and vectors) that make up the neural network are now filled with useful values.  I believe that a good way to understand how it all works is to ‚Äústart the network manually‚Äù, that is, to start as an example the transition from the image of a handwritten digit to the prediction of its value by a trained neural network.  As a first step, we <b>extract the values ‚Äã‚Äãof the</b> trained tensors from our model into <a href="http://www.numpy.org/">numpy</a> arrays for further processing: <br><br><img src="https://habrastorage.org/web/cec/fb5/68a/cecfb568ad4f43f986b9432fa5d17673.png"><br><br>  An example of <b>"manual" network management</b> in Python is as follows: <br><br><img src="https://habrastorage.org/web/aec/f33/4a8/aecf334a89fb4c048a7043ec2163d33f.png"><br><br>  W0_matrix, b0_array, W1_matrix and b1_array are the tensors that make up the neural network after learning, <i>testimage</i> is the input layer, <a href="https://en.wikipedia.org/wiki/Sigmoid_function"><i>sigmoid</i></a> () is used as an activation function, <i>hidden_layer</i> represents the hidden network layer, <i>predicted</i> is the output layer, and <a href="https://en.wikipedia.org/wiki/Softmax_function"><i>softmax</i></a> () is a function that used to normalize output as a probability distribution.  At the end of the calculation, the <i>predicted [n]</i> array contains the prediction that the input image represents the digit ‚Äún‚Äù.  The <i>argmax ()</i> function finds the value ‚Äún‚Äù for which <b>predicted [n] is</b> maximum. <br><br>  The code shown above predicts a value of 7 for the test image.  The forecast is confirmed as the correct value of the label, and can also be visually confirmed by a raster display of the test image (see Fig. 1). <br><br>  <b>Migrate Test Data and Network to Oracle</b> <br><br>  The example from the previous paragraph on how to manually start the counting mechanism shows that the <b>maintenance of a</b> neural network can be straightforward, in some cases it is just a matter of performing some basic calculations with matrices.  This contrasts with the complexity of learning neural network models, where a specialized engine is often required, high quality of training data, and in more complex cases, more specialized equipment, such as a GPU card. <br><br>  The topic of the previous paragraph also set the stage for the next development: this is the movement of the neural network tensors and test data to Oracle and the implementation of the service mechanism there. <br><br>  There are many ways to export Python numpy arrays.  One of them is <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savetxt.html">to save the arrays in text format</a> .  Here you will see a method intended for direct export to Oracle using cx_Oracle, the Python library for interacting with Oracle.  For more examples and links on how to use cx_Oracle, I advise you to read the notes <a href="https://github.com/LucaCanali/Miscellaneous/blob/master/Oracle_Jupyter/Oracle_IPython_cx_Oracle_pandas.ipynb">"Oracle and Python and cx_Oracle"</a> . <br><br>  The code can be found on <a href="https://github.com/LucaCanali/Miscellaneous/blob/master/PLSQL_Neural_Network/MNIST_tensorflow_exp_to_oracle.ipynb">Github</a> , here are some relevant snippets: <br><br>  - <b>Create tables</b> for placement of definitions of tensors and test data: <br><br><pre> <code class="sql hljs">SQL&gt; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> tensors (<span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">20</span></span>), val_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, val <span class="hljs-keyword"><span class="hljs-keyword">binary_float</span></span>, primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, val_id)); SQL&gt; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> testdata (image_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, label <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, val_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, val <span class="hljs-keyword"><span class="hljs-keyword">binary_float</span></span>, primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(image_id, val_id));</code> </pre><br>  - From Python, open a connection to Oracle: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cx_Oracle ora_conn = cx_Oracle.connect(<span class="hljs-string"><span class="hljs-string">'mnist/&lt;a href="mnist@ORCL"&gt;mnist@ORCL&lt;/a&gt;'</span></span>) cursor = ora_conn.cursor()</code> </pre><br>  - An example of how <b>to transfer the matrix</b> W0 to the Oracle <i>tensors</i> table: <br><br><pre> <code class="python hljs">i=<span class="hljs-number"><span class="hljs-number">0</span></span> sql=<span class="hljs-string"><span class="hljs-string">"insert into tensors values ('W0', :val_id, :val)"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> column <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> W0_matrix: array_values = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> element <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> column: array_values.append((i, float(element))) i += <span class="hljs-number"><span class="hljs-number">1</span></span> cursor.executemany(sql, array_values) ora_conn.commit()</code> </pre><br>  Finally, you can export the <i>testdata</i> and <i>tensors tables</i> for later use.  In <a href="https://github.com/LucaCanali/Miscellaneous/tree/master/PLSQL_Neural_Network">the Github repository</a> you can find the dump file obtained using the following command (run as Oracle): <br><br><pre> <code class="bash hljs">$ expdp mnist/mnist tables=testdata,tensors directory=DATA_PUMP_DIR dumpfile=MNIST_tables.dmp</code> </pre><br>  <b>Oracle Optimizations for Linear Algebra</b> <br><br>  From the Oracle documentation: "The <a href="http://docs.oracle.com/cd/E11882_01/appdev.112/e40758/u_nla.htm">UTL_NLA</a> package provides a subset of <b>BLAS</b> and LAPACK operations (version 3.0) for vectors and matrices represented as VARRAYS."  This is very useful for performing the <b>calculations</b> necessary to service the neural network from this article. <br><br>  Below is a snippet of MNIST code to see how this works in practice.  The code performs the calculation <i>v_Y0 = v_Y0 + g_W0_matrix * p_testimage_array</i> , where <i>g_W0_matrix</i> is the <i>784x100</i> matrix, <i>p_testimage_array</i> is the vector of 784 elements (encodes 28x28 images), <i>and v_Y0</i> is the vector of 100 elements. <br><br><pre> <code class="python hljs">utl_nla.blas_gemv( trans =&gt; <span class="hljs-string"><span class="hljs-string">'N'</span></span>, m =&gt; <span class="hljs-number"><span class="hljs-number">100</span></span>, n =&gt; <span class="hljs-number"><span class="hljs-number">784</span></span>, alpha =&gt; <span class="hljs-number"><span class="hljs-number">1.0</span></span>, a =&gt; g_W0_matrix, lda =&gt; <span class="hljs-number"><span class="hljs-number">100</span></span>, x =&gt; p_testimage_array, incx =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>, beta =&gt; <span class="hljs-number"><span class="hljs-number">1.0</span></span>, y =&gt; v_Y0, incy =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>, pack =&gt; <span class="hljs-string"><span class="hljs-string">'C'</span></span> );</code> </pre><br>  To use UTL_NLA, tensors that make a neural network and test images must be stored in varrays from binary_float or, rather, be declared with the data type UTL_NLA_ARRAY. <br><br>  For this reason, it is also convenient to post-process the <i>tensors</i> and <i>testdata tables</i> as follows: <br><br><pre> <code class="sql hljs">SQL&gt; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> testdata_array <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> a.image_id, a.label, <span class="hljs-keyword"><span class="hljs-keyword">cast</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">multiset</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> testdata <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> image_id=a.image_id <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> val_id) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> utl_nla_array_flt) image_array <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">distinct</span></span> image_id, label <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> testdata) a <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> image_id; SQL&gt; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> tensors_array <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> a.name, <span class="hljs-keyword"><span class="hljs-keyword">cast</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">multiset</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensors <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=a.name <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> val_id) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> utl_nla_array_flt) tensor_vals <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">distinct</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensors) a;</code> </pre><br>  <b>The final step</b> that brings you back to the discussion in the section ‚ÄúLet's start at the end: how to deploy the MNIST PL / SQL package and recognize the handwritten numbers in Oracle‚Äù is to create the MNIST PL / SQL package that loads the tensors and performs the operations necessary to calculate the neural network, detailed code can be viewed on <a href="https://github.com/LucaCanali/Miscellaneous/blob/master/PLSQL_Neural_Network/MNIST_oracle_plsql.ipynb">Github</a> . <br><br>  <b>Conclusion and comments</b> <br><br>  This article describes an example of the implementation of the <b>counting</b> mechanism for an artificial <b>neural network</b> using a relational DBMS <b>Oracle</b> and PL / SQL.  This is a simple example implementation for familiarizing with neural networks: recognizing handwritten numbers in <a href="https://twitter.com/ylecun">the MNIST database</a> .  The network is trained using <a href="https://www.tensorflow.org/">TensorFlow</a> and then exported to Oracle.  The end result is a small PL / SQL package that provides digit recognition with an accuracy of around <b>98%</b> . <br><br>  In the near future, we can expect an <b>increase in the</b> deployment of <b>neural networks near sources and data warehouses</b> .  The example in this article of how to implement a neural network <b>maintenance</b> mechanism in an <b>Oracle</b> database shows that this is not only possible, but also <b>easy to implement</b> . <br><br>  <b>Maintenance of</b> neural networks is much <b>easier than</b> their learning.  Although training requires specialized software / platforms, knowledge of the subject area and a large amount of training data, trained networks can be imported and run on target systems, which in many cases requires low utilization of computational resources. <br><br>  This article was conceived as an <b>educational material</b> : instead of a more productive convolutional network, a simple neural <a href="https://en.wikipedia.org/wiki/Convolutional_neural_network">network of direct propagation is used</a> (see References).  Moreover, moving data from TensorFlow to Oracle and implementing the servicing engine in <b>PL / SQL</b> is a kind of ‚Äúcrutch‚Äù in the current state, and it is not intended for use in production. <br><br>  The code accompanying this article is available on <a href="https://github.com/LucaCanali/Miscellaneous/tree/master/PLSQL_Neural_Network">Github</a> . <br><br>  <b>Notes on how to create a test environment</b> <br><br>  The main components and tools for testing scripts in this article are: <br>  <b>Python</b> environment (on Linux with CentOS 7) installed using <a href="https://www.continuum.io/downloads">Anaconda</a> 4.1: Python 2.7, Jupyter Ipython notebook. <br>  <b>TensorFlow</b> , version 0.9 (last at the time of writing), installed in accordance with the instructions <a href="https://www.tensorflow.org/versions/r0.9/get_started/os_setup.html">https://www.tensorflow.org/versions/r0.9/get_started/os_setup.html</a> <br>  <b>Oracle's relational database engine</b> running on Linux.  Oracle scripts were tested on Oracle 11.2.0.4 and 12.1.0.2 <br><br>  <b>Links and thanks</b> <br><br>  An excellent introduction to neural networks and inspiration for this article was the book by <a href="https://twitter.com/michael_nielsen">Michael Nielsen</a> (Michael Nielsen) <a href="http://neuralnetworksanddeeplearning.com/">"Neural Networks and Deep Learning"</a> . <br>  The neural network learning code used in this article is an extension of Google's <a href="https://www.tensorflow.org/">TensorFlow</a> MNIST <a href="https://www.tensorflow.org/versions/r0.7/tutorials/mnist/beginners/index.html">instruction</a> . <br>  I also recommend: the <a href="https://docs.google.com/presentation/d/1TVixw6ItiZ8igjp6U17tcgoFrLSaHWQmMOwjlgQY9co/pub%3Fslide%3Did.g110257a6da_0_579">TensorFlow tutorial by Nartin Gorner</a> , <br>  <a href="https://www.oreilly.com/learning/hello-tensorflow">"Basic techniques for TensorFlow"</a> Aaron Schumacher (Aaron Schumacher), <br>  <a href="https://twitter.com/ylecun">MNIST Databases by</a> Yann LeCun, <br>  <a href="http://colah.github.io/posts/2014-10-Visualizing-MNIST/">MNIST Visualization by</a> Christopher Olah, <br>  <a href="https://github.com/rasbt/python-machine-learning-book">"Machine learning Python"</a> Sebastian Raschka (Sebastian Raschka). <br><br>  Other popular frameworks for working with neural networks and deep learning, in addition to <a href="https://www.tensorflow.org/">TensorFlow</a> , include <a href="http://deeplearning.net/software/theano/">Theano</a> and <a href="http://torch.ch/">Torch</a> among many others, see also this page on <a href="https://en.wikipedia.org/wiki/Comparison_of_deep_learning_software">Wikipedia</a> . <br><br><img src="https://habrastorage.org/files/a61/060/56f/a6106056fcce49a29cd997efd8bc97b9.png"><br><br>  In the summer we invite all fans of science-intensive tasks and computer science to <a href="http://pgday.ru/ru/2017/request/registration%3Futm_source%3Dhabr%26utm_medium%3Dpost%26utm_campaign%3Dneiron">visit</a> the <a href="http://pgday.ru/ru/2017/papers%3Futm_source%3Dhabr%26utm_medium%3Dpost%26utm_campaign%3Dneiron"><b>database</b></a> section of the same name <a href="http://pgday.ru/ru/2017/papers%3Futm_source%3Dhabr%26utm_medium%3Dpost%26utm_campaign%3Dneiron"><b>and computer science</b></a> at <b>PG Day'17 Russia</b> .  We will discuss blockchains, data modeling and visualization, DBMS profiling theory, data mining and some more interesting topics :) <br><br>  And do not forget that this year a section for specialists working with Oracle and other commercial databases will be held as part of PG Day.  First-class reports are expected from experts from major technology companies and a full-fledged master class on the <a href="http://pgday.ru/ru/2017/papers/125%3Futm_source%3Dhabr%26utm_medium%3Dpost%26utm_campaign%3Dneiron">performance diagnostics of the Oracle Database</a> . </div><p>Source: <a href="https://habr.com/ru/post/328824/">https://habr.com/ru/post/328824/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328812/index.html">Responsive and responsive typography with Hamster Framework. Treatment of hemorrhoids without surgery and pain</a></li>
<li><a href="../328814/index.html">The prospects of the mobile games market in Southeast Asia</a></li>
<li><a href="../328816/index.html">How "plastic" becomes the enemy of the underworld</a></li>
<li><a href="../328820/index.html">Bubi, baptize, peaks. Or its own CRM-system in Google Tables for a couple of hours</a></li>
<li><a href="../328822/index.html">Standards and templates for software development specifications</a></li>
<li><a href="../328826/index.html">Experimenting with Azure ML: Classification, Decision Trees</a></li>
<li><a href="../328828/index.html">Payment pages and solutions (or through thorns to the stars - and through many pictures)</a></li>
<li><a href="../328830/index.html">ICO vs IPO: Where is the money, Zin?</a></li>
<li><a href="../328832/index.html">The meeting place cannot be changed, or LK is waiting for all Android developers to visit</a></li>
<li><a href="../328834/index.html">Guide React Native - create an application for iOS. Part 1.2, 1.3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>