<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Overview of the firewall and intrusion prevention system of a new generation of SourceFire FirePower</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day dear readers. In this article, I would like to introduce you to Cisco's flagship information security solution. 

 The discussion will focus ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Overview of the firewall and intrusion prevention system of a new generation of SourceFire FirePower</h1><div class="post__text post__text-html js-mediator-article">  Good day dear readers.  In this article, I would like to introduce you to Cisco's flagship information security solution. <br><br>  The discussion will focus on the SourceFire Firepower product, which is an integrated intrusion protection system, a new generation firewall and Malware protection. <br><br>  SourceFire was acquired by Cisco in October 2013 and currently its solutions are the leader according to the Gartner rating agency in the field of intrusion prevention systems. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/b23/9ee/eab/b239eeeab8e085e755df870b2f35bebd.jpg" alt="image"><br><a name="habracut"></a><br>  <b>About SourceFire</b> <br><br>  A few words about the company SourceFire.  The company was founded in January 2001 in the state of Colombia by Martin Roesch (Martin Roesch) creator of the world famous opensource intrusion prevention system Snort IPS, which is currently the most widely used IPS system in the world (more than 4 million copies are currently loaded) .  In addition to Snort, the company develops such well-known opensource community as ClamAV and Razorback.  In addition to the very successful opensource projects that the company is very proud of, the commercial product of the company under the brand SourceFire, which has earned its place as a leader in the field of intrusion detection and prevention systems in the information security market according to the results of the Gartner rating agency (unchanged leader of the last 6 years!), Is also developing. NSS Labs testing lab and <a href="http://www.sourcefire.com/about-us/newsroom/awards%3Fpage%3D1">others</a> .  A separate group of experts - the VRT team (Vulnerability Research Team) - is responsible for developing the rules for detecting attacks and their timely updating.  The SourceFire commercial line is represented by two products: <br><br>  <i>SourceFire FirePower</i> is a new-generation intrusion prevention system with integrated firewalling of application level, content filtering and Malware protection at the network level. <br><br>  <i>SourceFire FireAmp</i> is a system for protecting against Malware threats at the host level running under Windows / MAC OSX, Android.  It can integrate with Malware protection at the network level - SourceFire FirePower. <br><br>  <b>FirePower Platform Overview</b> <br><br>  The product is presented in two deployment options: as a 64-bit virtual (VMWare hypervisor) and hardware complexes.  The functionality of the virtual platform does not support routing, switching and fault tolerance.  At the same time, the virtual appliance works fine as an inline bridge or IDS system on the SPAN port. <br><br>  A large number of hardware models with different performance, modular interface cards, functions of stacking and clustering are produced.  The performance of the models starts with the younger lines - 50 Mb / s, ending with the solutions of the class of large data centers - 60 Gbit / s (Fig. 1). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/24c/7ad/839/24c7ad839d5d7b8edff97107ecce53fa.png" alt="image"><br><br>  Fig.  one <br><br>  The performance of the virtual model is 100-150 Mbit / s per core. <br><br>  The 7000/7100 series models have RJ45 / SFP ports fixed on board, depending on the specific model. <br>  The 8100 series models have modular interface cards with supported interface types 1 Gb / s copper / optics and 10 Gb / s MM-SR and SM-LR optics.  The 8200 and 8300 Series models also support the 40 Gb / s MM-SR optical interfaces.  Most interface modules have the ability to configure the hardware bypass (including optical) in case of failure of the device. <br><br>  The older lineup of the FirePower 8200/8300 complexes supports the function of flexible performance enhancement by means of stacking.  For example, you can purchase a 8350 sensor with an IPS performance of 15 Gbit / s (platform performance of 30 Gbit / s) and at a time when you need to increase system performance, simply purchase another 8350, stack them and get a performance of 30 Gbit / s IPS and such This way you can stack up to 4 devices with IPS performance up to 60 Gbit / s. <br><br>  Fault tolerance features are implemented by clustering complexes into Active / Standby bundle with synchronization of session statuses. <br><br>  FirePower hardware solutions built on the RISC architecture, optimized code and a powerful computing platform with specialized network processors make it possible to achieve and exceed the performance declared by the manufacturer.  The declared performance characteristics are the real performance figures that the customer will receive in heavy load tests with fully enabled functionality.  This fact is confirmed by the annual testing of NSS Labs. <br><br>  <b>Defense Center Management System</b> <br><br>  FirePower is built using a centralized control system - Defense Center.  Locally, only the initial settings are available on the FirePower complexes themselves, which allow you to connect the device to the network and set up communication with the control center.  All further settings, reporting and monitoring are performed centrally in the Defense Center administration console. <br><br>  The Defense Center is presented both in the form of hardware platforms (see Fig. 2) with the maximum number of connected sensors ‚Äî 150 pieces, and in the form of a virtual machine under the VMWare hypervisor with the maximum number of sensors ‚Äî 25 pieces. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d23/7c3/fda/d237c3fda4955d6e9a82dd40ab79d23e.png" alt="image"><br><br>  Fig.  2 <br><br>  The control system in its hardware version has fault tolerance functions for models DC1500 and DC3500. <br><br>  <b>Available deployment topologies</b> <br><br>  For a virtual sensor, configurations are available both inline placement (see Fig. 3) with inspection and filtering of active traffic, as well as placement in IDS mode on a copy of traffic (SPAN) (see Fig. 4). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aa5/06a/45d/aa506a45d3e8a95d609406922d34fbf6.png" alt="image"><br><br>  Fig.  3 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/839/14d/663/83914d663d6e426ac164c1f314e0f0a0.png" alt="image"><br><br>  Fig.  four <br><br>  In the case of using a hardware platform, more complex topologies become available to us, since hardware complexes support switching functions at the hardware level with the support of the Spanning Tree Protocol (STP) and have routing functions using OSPF and RIP protocols. <br><br>  The platform allows you to build hybrid topologies (see Fig. 5). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eb7/379/12d/eb737912d5a71d64eb24b3cf68582f9c.png" alt="image"><br><br>  Fig.  five <br><br>  For proper processing by the IPS engine of an asymmetric traffic flow in the customer's network, the concept of Inline Set is introduced; for an example of such a configuration, see Fig.  6 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c38/747/d06/c38747d06b7cf46222e6bdaffff5cbdc.png" alt="image"><br><br>  Fig.  6 <br><br>  Let's not forget that many interface cards make it possible to configure bypass in the event of a reboot or failure on the platform, thus avoiding the interruption of services in the network. <br><br>  <b>Functional overview</b> <br><br>  <b>Firesight</b> <br><br>  ‚Äú <i>You can‚Äôt protect what you don‚Äôt know</i> ‚Äù is one of SourceFire‚Äôs slogans and it's hard to disagree.  With huge corporate networks under management, the IS service finds it increasingly difficult to track the emergence of new vulnerabilities on the company's resources, such as: <br><br><ul><li>  New patches in client applications that carry new vulnerabilities; </li><li>  Uncontrolled installation of applications by users; </li><li>  The ability to bring your device to the network and its uncontrolled connection; </li><li>  Exit and install operating system updates that treat old vulnerabilities and open new ones; </li><li>  The emergence of new network segments with new types of operating systems, such as, for example, equipment for automated process control systems, etc .; </li></ul><br>  As these networks grow, it becomes more and more difficult to monitor all these and other changes, and every day the process of tracking incidents and responding to them takes more and more time, and the effectiveness of dealing with real threats decreases.  It is good if periodic active scanning is performed on vulnerabilities by the information security team, but besides scanning, it is necessary to block the possibility of using detected vulnerabilities on the side of the intrusion prevention system.  Unfortunately, practice shows that the vast majority of administrators do not have the ability to tune the IPS signature set as often as the changing network requires.  After all, one can only assess the level of possible implementation of an attack on a target if one understands whether the target is vulnerable to a given attack, and for this one needs to know: <br><br><ul><li>  what service is subject to attack; </li><li>  what version of the operating system is installed on the attacked host and the version of its patch; </li><li>  what version of the patch for the attacked service is used; </li><li>  a list of known vulnerabilities for the above options, etc .; </li></ul><br>  What if the CIO itself can sit behind the attacked host ?!  Knowing all these and many other characteristics of the objects of attack or possible objects of attack, you can more effectively filter non-dangerous attacks and block with a necessary escalation of really dangerous invasions. <br><br>  SourceFire is fundamentally different from competing solutions, including the approach to the analysis of characteristic vulnerabilities in the protected network with the ability to <u>automatically adjust the signature set</u> !  The technology under the brand name FireSight allows you to visualize the network and get visibility (see Fig. 7): <br><br><ul><li>  current hosts / systems; </li><li>  operating systems with versions and patches on hosts; </li><li>  client software and its versions; </li><li>  users behind hosts; </li><li>  inherent vulnerabilities; </li><li>  data exchange between hosts in the passive mode; </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/388/177/f1e/388177f1eb8f8b3d765aa03f3ea4e5fe.png" alt="image"><br><br>  Fig.  7 <br><br>  The sensor analyzes traffic that is actively passing through it or traffic from a SPAN session, looks into traffic headers down to the application level and builds a ‚Äúmap‚Äù of the protected network with all its typical vulnerabilities based on the collected data.  This map is updated in real time.  The settings allow the complex to activate / deactivate signatures in the active signature sets that correspond to detectable vulnerabilities in the network.  Datacenter IPS 2014 NSS Labs testing results in an attack blocking efficiency of 99.4%, and 100% protection against evasion techniques. <br><br>  In addition to passively analyzed traffic, the solution supports uploading active scan results from it, for example, from Nessus. <br><br>  As an example of the information collected, I will give a profile of one of the hosts (see Fig. 8.9, 10.11). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b5/118/573/9b5118573a0719c5d79ea6cfa904d72a.png" alt="image"><br><br>  Fig.  eight <br><br>  List of applications on the host: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8cf/612/3dc/8cf6123dccb72516e71f059ca6b46c9b.png" alt="image"><br><br>  Fig.  9 <br><br>  List of host vulnerabilities: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eba/61a/e8c/eba61ae8ce337d80d263e712b135c9a3.png" alt="image"><br><br>  Fig.  ten <br><br>  An example of the description of one of the identified vulnerabilities with links to patches: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/027/691/cf7/027691cf7743b136f71d97e98d8a803c.png" alt="image"><br><br>  Fig.  eleven <br><br>  An example of recommended changes to the signature set based on the results of analytics of vulnerabilities and systems in the internal network is shown in Figure 12. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3a5/ad7/fb8/3a5ad7fb8f965303e09f7887f0997747.png" alt="image"><br><br>  Fig.  12 <br><br>  <b>Next-Generation Firewall (NGFW)</b> <br><br>  Firewall of the new generation, as it is now called, content-based ITU applications is implemented in SourceFire FirePower and uses signatures to determine the types of applications provided by the intrusion detection system engine.  NGFW is designed to filter not only at the level of ports and protocols, as it is classically implemented in ITU with stateful connection monitoring, but at the level of application-level protocols and functions of the applications themselves, thus looking deeper into transactions and stopping, for example, such activities like sending a file via Skype or accessing the functions of games on Facebook (see Fig 13,14).  Note, for example, that Facebook and Google work through the protocol of the 7th level of the OSI model - HTTP.  However, these ‚Äúportals‚Äù provide a huge number of functions in the form of web applications that cannot be controlled by classical ITU. <br><br>  NGFW Access Policy: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/456/fab/2ff/456fab2ff36b4844f207e2cfab6e7298.png" alt="image"><br><br>  Fig.  13 <br><br>  An example of the Skype File Transfer blocking rule: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fcb/93b/678/fcb93b678c1c1055ab39cbd6791e7187.png" alt="image"><br><br>  Fig.  14 <br><br>  As can be seen from Figure 13, we form our application filtering policy and intrusion detection policy in the access policy.  Each line of the access policy operates as an access control list entry (governing the access rule with the appropriate conditions). <br><br>  ACL conditions can be of the following types: <br><br><ul><li>  The zones between which filtering will be performed are logical zones to which a device interface may belong; </li><li>  Networks between which the traffic will be filtered; </li><li>  VLAN between which traffic is filtered; </li><li>  AD users whose traffic we want to filter; </li><li>  Applications that we want to restrict / allow access to; </li><li>  Ports tcp / udp, which will be filtered from / to; </li><li>  URLs broken down by category and reputation; </li></ul><br>  All these conditions can simultaneously appear in one rule and will be used as a logical AND (AND). <br><br>  After each ACL, you can see three icons (see Figure 15), which mean associated policies from left to right: <br><br><ul><li>  Intrusion Prevention Policy; </li><li>  File Filtering and Malware Protection Policy; </li><li>  Logging policy; </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/ce7/837/e57/ce7837e57dd72347ee6849a90c8fbdc2.png" alt="image"><br><br>  Fig.  15 <br><br>  If your network contains applications of its own design and they are not in the application database for filtering, you can easily add your own application to the application database.  Import the corresponding Pattern ASCII / HEX to search, or download an example of the application's network activity from the PCAP file. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9cb/f75/6db/9cbf756db07c49f02b2ba0af9c3b5f55.png" alt="image"><br><br>  Fig.  sixteen <br><br>  For each access policy, which can be set, you can assign a Security Intelligence filtering policy (Fig. 17).  This policy contains constantly updated lists of IP addresses of spammers, C &amp; C centers of botnets, open proxies, etc.  You can choose from the available lists, or load your own filtering lists from a file, or tell the system the URL where these lists are taken from. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aa2/240/772/aa2240772ef2f288d5a8088d90d50ec7.png" alt="image"><br><br>  Fig.  17 <br><br>  <b>FireAMP Malware Protection</b> <br><br>  FirePower solutions provide Malware protection at the network level.  The system analyzes the files passing through the device specified in the file policy (Fig. 18) formats and transmitted via the specified types of protocols.  About the features of solutions to protect against Malware can be found in the <a href="http://habrahabr.ru/company/cisco/blog/226699/">article by</a> Alexey Lukatsky ( <a href="http://habrahabr.ru/users/alukatsky/" class="user_link">alukatsky</a> ). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/882/e3e/276/882e3e2768cf5b9093378e367128d04d.png" alt="image"><br><br>  Fig.  18 <br><br>  The principle of the Malware protection is as follows.  The SHA-256 hash is removed from the file sent through the device and sent to the Defense Center, which in turn produces a query (Cloud Lookup) in the SourceFire cloud, finding out the disposition of this file (whether the file is clean or Malware) on the basis of the well-known Malware in the cloud .  For customers who do not want to send any data to the cloud, the server with the Malware database can be deployed directly on the corporate network, this configuration is called Private Cloud. <br><br>  If, as a result of removing the hash and the query into the database, the file disposition cannot be established, the device can be sent to the cloud-based sandbox, where the behavior of the file, its survival after reboot, generated network traffic, testing to run in the virtual environment will be analyzed , created processes, files, registry entries and techniques for hiding processes, attempts at self-reproduction, and so on.  According to the results of this testing, indices of malicious behavior are calculated, a small excerpt of the report is shown in Figure 19. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/89b/ea1/0e1/89bea10e1e108035fb51dba3912b3c47.png" alt="image"><br><br>  Fig.  nineteen <br><br>  If the file is executable (executable), FirePower removes more than 400 variables from the file (links to plug-in libraries, library names, icons used, environment variables, compiler settings, etc.) for analysis by the Spero engine using fuzzy prints algorithm ( Fuzzy fingerprinting).  The algorithm, referring to logical self-learning trees of signs and behavior of various kinds of Malware, located in the SourceFire cloud, gets a decision about the disposition of the file. <br><br>  A very important difference from classic anti-virus protection systems is that classic systems work at a specific point in time.  For example, a file is addressed for execution (execution), it is checked against the signature database and / or sandbox, and is forgotten after its conclusion about its purity / infection.  However, one should not forget that more than 65,000 (SourceFire statistics) copies of the new Malware appear for the world today, for which there are no signatures yet.  Malware can use launch delay techniques to avoid detection in sandboxes.  In view of the above considerations, Malware can pass by the network anti-virus and settle on the end nodes, where, as time passes, the distribution and operation of Malware will begin.  From the side of the antivirus, there will be no records of the past file, the time of its appearance and the source.  According to statistics, up to 30% of the unknown Malware carry with them and download up to 70% of the known Malware and vice versa. <br><br>  The FireAMP system provides a new approach with retrospective analysis, in which all paths of file distribution and their attributes are remembered.  In the case of a FireAMP host-based solution, all associated process activities, network activities, all I / O operations on the local host are remembered.  And when, say, 4 days later, it turns out that the downloaded file was previously unknown by Malware, a notification will be received from the SourceFire cloud and the file will be centrally blocked both at the network level and at the level of all Endpoint-infected systems.  Moreover, the system will show the file distribution path both over the network and on the host system, all additional components downloaded by the file and Malware programs, process calls and the parent process, which made it possible to become infected and initiate the spread of the threat. <br><br>  Malware detection example at the network level, Figure 20a, 21 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d71/c9c/1f9/d71c9c1f942cc5517da471ff40564bcb.png" alt="image"><br><br>  Fig.  20a <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1f/16e/0ac/d1f16e0acb5869193d4f0c1c8ca31385.png" alt="image"><br><br>  Fig.  20b <br><br>  In particular, in Figure 21 you can see the path of entry and further distribution of the file over the network, affected hosts, the moment of infection, the ports and protocols used. <br><br>  In Figure 20b, you can see more detailed information about the distribution and method of getting the threat directly to the host with all associated I / O operations. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bb4/d89/3ba/bb4d893bab2d722e6806b76580638874.png" alt="image"><br><br>  Fig.  21 <br><br>  <b>Compliance Whitelist function</b> <br><br>  Separately, I would like to note the useful feature of the white list of systems in the network.  Since FirePower can passively see the activity of users and applications on the network in real time, the system makes it possible to build profiles of Compliant systems.  Thus, you can specify which operating systems with which patches, client programs and applications we want to see in them in our network.  In the case of a deviation from the pattern, you can notify the administrator and use correlation methods (see the next chapter), including executing your own scripts and commands, and carry out actions to quarantine / correct problems. <br><br>  It should be noted that FirePower provides the ability to create and assign attributes of various types to hosts and set attributes as a result of a correlation action.  Attributes can be used when generating automatic notifications, including to increase the level of attack criticality and much more.  For example, increase the criticality of the attack when it is detected in the direction of the host with the value of the base attribute - non-compliant. <br><br>  Created attributes can be of the following types: <br><br><ul><li>  INTEGER </li><li>  TEXT </li><li>  Leaf </li><li>  URL </li></ul><br>  By default, each WhiteList has only one attribute that takes on the value: <br><br><ul><li>  Compliant </li><li>  Non-compliant </li><li>  Not evaluated </li></ul><br>  Each host will have a WhiteList attribute assigned to it with the value of this attribute from the above list. <br><br>  An example of creating a WhiteList can be seen in Figure 22. You select the allowed types and versions of the operating systems, in each operating system you select the allowed client applications, web applications and the allowed protocols of the transport and network layers. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/776/ad1/201/776ad1201e6dd9050d4b1dd77757cbfb.png" alt="image"><br><br>  Fig.  22 <br><br>  <b>Traffic profiles</b> <br><br>  As you may remember, FireSight technology also monitors connection parameters set by hosts on a network.  Based on the collected statistical data, and at least 29 connection parameters are collected, a so-called basic connection profile is compiled for each host.  In the configuration, it is possible to set which specific types of connections or application traffic will be profiled and for how long to build the base profile (Example Fig. 23). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b98/ec2/374/b98ec23744991b4767b7ef537acad95e.png" alt="image"><br><br>  Fig.  23 <br><br>  The example in Figure 23 shows that it is possible both to base profiles on the basis of all transmitted traffic and to more subtly distinguish the necessary flows. <br><br>  <b>Event correlation</b> <br><br>  A very powerful function for tracking, escalating and responding to events is embedded in the system - this is a correlation function.  Especially this function will appeal to enthusiasts and security professionals. <br><br>  In fact, this function provides an opportunity for an event to expose sets of conditions with their logical bundles for generating reactive effects (for an example of the correlation condition, see figure 24). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/050/31a/126/05031a12628f62cbd58da0fa16ab7afd.png" alt="image"><br><br>  Fig.  24 <br><br>  As a result of applying the above correlation condition, there will be an intrusion event: <br><br><ul><li>  addressed to a vulnerable platform (Impact 1); </li><li>  according to the rules of signatures not blocked; </li><li>  aimed at the Anroid or IPhone platform with Jailbrake; </li><li>  owned by a member of the Executives department (in Active Directory); </li></ul><br>  In the form of a small example, correlation conditions can be created for the following types of events (see Fig. 25, 26): <br><br><ul><li>  Security event (alert); </li><li>  Discovery event; </li><li>  User activity event (user activity); </li><li>  The host profile has changed or a vulnerability has been added (host input) (example of events Fig. 26); </li><li>  Connection established; </li><li>  The traffic profile has changed; </li><li>  Malware event detection; </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/222/088/dce/222088dcecb17aa9525867cfec7bc88d.png" alt="image"><br><br>  Fig.  25 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/71d/728/d1d/71d728d1d595288d00d2944a7a256093.png" alt="image"><br><br>  Fig.  26 <br><br>  We have considered the possibility of setting correlation conditions, and now we will see how we can respond to the fulfillment of these conditions. <br><br>  The result of the execution of the correlation rule can be one or more actions, such as: <br><br><ul><li>  Run NMAP scanning with the specified parameters on the source / direction of the attack; </li><li>  blocking an attacker on a Cisco router (RTBH); </li><li>  SHUN blocking on ITU Cisco ASA; </li><li>  setting the required attribute on the host; </li><li>  administrator notification via Email / SNMP / Syslog; </li><li>  execution of a self-written program written in C / BASH / TCSH / PERL with the ability to transfer variables from the event. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/b53/0fb/5ca/b530fb5ca16a16f9d132b31a85221aa1.png" alt="image"><br><br>  Fig.  27 <br><br>  <b>Monitoring and reporting system</b> <br><br>  The Defense Center control system provides very visual statistical information on the system as a whole, as well as the ability to delve into the details of detectable activities from any graph. <br><br>  To familiarize the administrator with the current picture of the use of network services, applications, operating systems, analysis of the relevance of activities to business processes and risks, the Summary Dashboard overview screen is available (see Fig. 28). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dd1/948/fba/dd1948fba456280145eb645f4f9e5e18.png" alt="image"><br><br>  Fig.  28 <br><br>  To start analyzing the past information security incidents, you can go to the Intrusion Events tab and see the aggregated information on detected and blocked attacks, statistics and go to a detailed review of each event of interest separately (see Figure 29). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/449/098/c09/449098c097afc2b1a515dbbe2482d5c5.png" alt="image"><br><br>  Fig.  29 <br><br>  Each incident can be studied in detail, including the contents of the packet that caused the signature to trigger, see Fig.  30. From the information window about the event, you can see the text of the signatures that worked, the attack signatures are written in the language of SNORT, which de facto has already become for many IS administrators the standard for writing IPS rules.  In the same window, you can perform tuning of the signature, configure filtering and summaries of events, change the action associated with the detection of this activity. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/391/c23/ec8/391c23ec8c5ee2afb9475b6819902fa9.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/b87/97a/4be/b8797a4be0d927b3f2fb7c2def9babd9.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/84c/f64/cdd/84cf64cddd0cefacfcabd548f469d9e4.png" alt="image"><br><br>  Fig.  thirty <br><br>  In addition to information about attacks, you can analyze and filter information of interest received by the system about the network as a whole.  To obtain general information about the network, or, if necessary, about its specific segments, there is the Context Explorer interface (see Fig. 31). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbe/359/58a/fbe35958a061223c82c24d302fc12029.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/547/378/b34/547378b348c2d9b3135e1ff63fa13606.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/bbc/8bc/28e/bbc8bc28ec4fd7f8b960bcaf372ca7e3.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/b99/44d/58a/b9944d58a48cf937071836baa2557648.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/48c/135/bc6/48c135bc6d34c1141df4fc7ed3d9ce62.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/b3a/a6c/1b5/b3aa6c1b5e49d1e977c00c591a70608b.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/078/061/4c4/0780614c4190f1c58ca1238198482952.png" alt="image"><br><br>  Fig.  31 <br><br>  In figure 31 you can see the statistical information: <br><br><ul><li>  correlation of data from the Security Intelligence database, security events, traffic and Malware events to assess possible threats within the network; </li><li>  the activity of specific users and their applications, detailing the level of risk applications; </li><li>  network operating systems and information exchange activities; </li><li>  assessment of safety events by impact level and priority level; </li><li>  statistics on the detection of malware activity and transmission of infected files; </li><li>  geolocation characteristic of hosts distributing malware, realizing hostile activity and the most intensive information exchange; </li><li>  statistics of the most frequently visited categories of sites, including the reputation and the most visited URLs; </li></ul><br>  The system provides the ability to generate your own reports using pre-defined templates as well as create templates yourself.  For making your own report templates, there is a whole Wizard (see Fig. 32), which allows you to include various types of graphical statistics objects, tabular data and directly the contents of packages with suspicious activity.  For the purpose of more flexible report generation, it is possible to set your own variables for substituting them into a template when generating a report.  Reports can be scheduled and sent to responsible persons. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a3e/12d/6a1/a3e12d6a13d6778467316fa9ecd036bc.png" alt="image"><br><br>  Fig.  32 <br><br>  <b>Conclusion</b> <br><br>  In conclusion, I would like to note that the comprehensive system for protecting the network from attacks, managing application policies and fighting the spread of Malware based on products of the acquired SourceFire company organically complement and strengthen Cisco's portfolio in the field of information security products.  We single out this class of solutions as promising and will actively develop them.  The company allocates major investments in the development of the technological branch of information security solutions, which undoubtedly is one of the strategic ones for the company.  In the near future, we are looking forward to an ever closer integration of SourceFire technologies with Cisco's classic architecture solutions and the company's product solutions.  Separately, I would like to dispel the concerns of industry colleagues regarding the development of free opensource products from the SourceFire company, all opensource initiatives will be preserved and they will have further active development. </div><p>Source: <a href="https://habr.com/ru/post/229195/">https://habr.com/ru/post/229195/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../229183/index.html">Microsoft warns of the expiration of the main support for popular versions of Windows</a></li>
<li><a href="../229185/index.html">NIC India issued digital certificates for Google domains</a></li>
<li><a href="../229187/index.html">Games for NES / Famicom / Dandy through the eyes of a programmer</a></li>
<li><a href="../229189/index.html">Custom javascript events</a></li>
<li><a href="../229191/index.html">PHP Zend certification today</a></li>
<li><a href="../229197/index.html">Firefly Alpha lightweight reusable booster design</a></li>
<li><a href="../229199/index.html">Simple Connection Pool without DataSource in Java</a></li>
<li><a href="../229203/index.html">HP Network Simulator is available for public use!</a></li>
<li><a href="../229205/index.html">How to tame a dragon using Intel technology?</a></li>
<li><a href="../229211/index.html">How to eat whale or the story of creating a line of mobile products</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>