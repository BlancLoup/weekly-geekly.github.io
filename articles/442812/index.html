<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÄúI don‚Äôt see any reason to use Python to work with Spark, except for laziness‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The other day we decided to talk with Dmitry Bugaychenko ( dmitrybugaychenko ), one of our teachers of the Scala Data Analysis program, and discuss to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>‚ÄúI don‚Äôt see any reason to use Python to work with Spark, except for laziness‚Äù</h1><div class="post__text post__text-html js-mediator-article"><p>  The other day we decided to talk with Dmitry Bugaychenko ( <a href="https://habr.com/ru/users/dmitrybugaychenko/" class="user_link">dmitrybugaychenko</a> ), one of our teachers of the Scala Data Analysis program, and discuss topical issues of using Scala in Data Science and Data Engineering.  Dmitry is an analyst at Odnoklassniki. </p><br><p><img src="https://habrastorage.org/webt/6h/7b/ut/6h7butyls-jgjkhi1plmqmd9gxy.jpeg" alt="image"></p><a name="habracut"></a><br><p>  <strong>- Dima, you work in classmates.</strong>  <strong>Tell me, what are you doing there?</strong> <strong><br></strong> <br>  In Odnoklassniki, I started working in 2011 on a draft recommendation for music.  It was a very interesting and difficult task - most of the music recommendation services at that time were based around well-cataloged publishing content, whereas we had a real UGC (user generated content), which we had to first brush and sort through.  In general, the resulting system proved to be quite good and decided to extend the experience to other sections of the site: recommendations of groups, friendship, ribbon ranking, etc.  In parallel with this, the team grew, the infrastructure developed, new algorithms and technologies were introduced.  Now I have a fairly wide range of responsibilities: coordination of efforts, the date of scientists, the development of DC-infrastructure, research projects, etc. </p><br><p>  <strong>- How long have you started using Spark?</strong>  <strong>What is the need?</strong> </p><br><p>  The first attempts to make friends with Spark were back in 2013, but were unsuccessful.  We had an urgent need for a powerful interactive tool that allows us to quickly test hypotheses, but Spark of that time could not provide the stability and scalability we need.  We made a second attempt a year later, in 2014, and this time everything turned out much better.  In the same year, we began to introduce streaming analytics tools based on Kafka and Samza, tried Spark Streaming, but then he could not start.  Due to relatively early implementation, by 2017 we were in a position of catching up for a while - a large amount of code on the first Spark prevented us from switching to the second, but in the summer of 2018 we solved this problem and are now working on 2.3.3.  In this version, streaming has already earned more stable and we have already done some new promotional tasks on it. </p><br><p>  <strong>- As I understand it, you use the Scala API, and not Python, as most.</strong>  <strong>Why is that?</strong> </p><br><p>  I honestly do not see any reason to use Python to work with Spark, except for laziness.  Scala API is more flexible and much more efficient, but no more difficult.  If you use the standard features of Spark SQL, the Scala code is almost identical to the corresponding Python code, the speed of work will be identical.  But if you try to make the simplest user function, the difference becomes obvious - the work of the Scala code remains just as effective, and the Python code turns the multi-core cluster into a pumpkin and starts burning kilowatts / hours for completely unproductive activities.  On the scale with which we have to work, we simply cannot afford such wastefulness. </p><br><p>  <strong>- C Python is understandable.</strong>  <strong>And if you compare with Java, then Scala is something better for data analysis in general?</strong>  <strong>In Java, a lot of things are written in the big data stack.</strong> </p><br><p>  We use Java very widely, including in machine learning.  In the most heavily loaded Scala applications, we try not to pull.  But if we are talking about interactive analysis and rapid prototyping, the laconic Scala becomes a plus.  The truth must always be borne in mind that when programming in Scala, it is very easy to shoot your legs off to the very ears - many constructions may not behave as one would expect from a common sense point of view, and some simple operations can cause unnecessary copying and attempts to materialize huge dataset in memory. </p><br><p>  <strong>- With all these advantages, why is Scala not so popular yet?</strong>  <strong>Does she clearly benefit from Python and Java?</strong> </p><br><p>  Scala is a very powerful tool that requires a fairly high qualification from the person who uses it.  In addition, during team development, additional requirements are imposed on the overall level of development culture: the Scala code is written very easily, but not always successfully read even by the author after some time, and under the hood of a simple API can create some kind of game.  Therefore, special attention should be paid to maintaining a single style, functional and load testing solutions. </p><br><p>  Well, making a comparison of JVM-languages, it is impossible not to mention Kotlin - it is gaining popularity, is considered by many more ‚Äúideologically verified‚Äù, and even supports Spark in the framework of the sparklin project, while the truth is in a very limited form.  We do not use it for Spark yet, but we are closely following the development. </p><br><p>  <strong>- Let's go back to Spark.</strong>  <strong>As I understand it, anyway, even this functionality of the Scala API did not suit you and you wrote some kind of your own fork to Spark?</strong> </p><br><p>  It would be wrong to call our project <a href="https://github.com/odnoklassniki/pravda-ml">PravdaML a</a> fork: this library does not replace, but complements the functionality of SparkML with new features.  We came to those solutions that were implemented there, trying to scale and put the ribbon ranking model on the replicable rails.  The fact is that when developing effective distributed machine learning algorithms, a lot of ‚Äútechnical‚Äù factors need to be taken into account: how to properly decompose data into nodes, at what point to cache, zadunsemplity, etc.  In standard SparkML there is no possibility to control these aspects, and they have to be moved beyond the ML pipeline, which has a negative effect on controllability and reproducibility. </p><br><p>  <strong>‚ÄúI remember you had two variants of the name ...‚Äù</strong> </p><br><p>  Yes, the original name ok-ml-pipelines seemed boring to the guys, so we are now in the process of ‚Äúrebranding‚Äù with the new name PravdaML. </p><br><p>  <strong>- Do many people use it outside of your team?</strong> </p><br><p>  I do not think that much, but we are working on it.  J </p><br><p>  <strong>- Now let's talk about the roles and professions in the field of working with data.</strong>  <strong>Say, should a data scientist write code in production or is it already some other profession and role?</strong> <strong><br></strong> <br>  The answer to this question is my opinion, and there is a harsh reality.  I have always believed that for a successful implementation of ML solutions a person must understand where and why all this is being implemented (who is the user, what are his needs, and what are the needs of the business), should understand what mathematical methods can be used to develop a solution, and how these methods can work from a technical point of view.  Therefore, in Odnoklassniki we still try to adhere to the model of a single responsibility, when a person comes up with some initiative, implements and implements it.  Of course, to solve individual issues, whether it is an effective DBMS or interactive layout, you can always attract people with more experience in these areas, but the integration of all this into a single mechanism remains for the scientist, as the person who best understands what should work on output </p><br><p>  But there is a harsh reality in the labor market, which is now very overheated in the field of ML, which leads to the fact that many young professionals do not consider it necessary to study anything besides ML itself.  As a result, finding a ‚Äúfull cycle‚Äù specialist is becoming increasingly difficult.  Although a good alternative has recently emerged: practice has shown that good programmers master ML fairly quickly and quite well.  J </p><br><p>  <strong>- Date engineer need to know Scala?</strong>  <strong>How good by the way?</strong>  <strong>Do I need to go into the jungle of functional programming?</strong> </p><br><p>  You definitely need to know Scala, if only because two such fundamental tools as Kafka and Spark are written on it, and you should be able to read their sources.  As for the ‚Äújungle of functional programming‚Äù, I would strongly advise them not to abuse too much: the more developers can read and understand the code, the better.  Even if for this it is sometimes necessary to turn the ‚Äúelegant‚Äù functional construction into a banal cycle. </p><br><p>  <strong>- Has the universe of professions in this area ceased to expand, or are we still waiting for the emergence of any new professions in it?</strong> </p><br><p>  I think that in ML and DS in the foreseeable future there will be a turning point related to automation: the main patterns that guide people when working with signs, choosing a model and its parameters, checking quality will be automated.  This will lead to the fact that the demand for specialists who ‚Äúselect the parameters‚Äù will decrease significantly, but AutoML-engineers will be able to implement and develop automated solutions. </p><br><p>  <strong>- You are actively teaching, as I understand it.</strong>  <strong>Why do you think this is important?</strong>  <strong>What is the motivation behind this?</strong> </p><br><p>  All of us sometime will depart from affairs and quality of our life will strongly depend on the one who will come to replace us.  Therefore, investment in next-generation education is one of the most important. </p><br><p>  <strong>- On our program <a href="http://gaurl.ru/U2FFml">"Data Analysis on Scala"</a> you will conduct several sessions.</strong>  <strong>Tell me briefly about them.</strong>  <strong>What is their importance?</strong> </p><br><p>  In these classes, we will just study how engineering and mathematics fit in: how to organize the process correctly, without introducing unnecessary barriers to ETL-&gt; ML-&gt; Prod.  The course will be built around the capabilities of Spark ML: basic concepts, supported transformations, implemented algorithms and their limitations.  We will also touch upon the area where the existing capabilities of SparkML are not enough, and it becomes necessary to use extensions like PravdaML.  Well, there will definitely be practice, and not only at the level of ‚Äúassemble a solution from ready-made cubes‚Äù, but also on how to understand that a new ‚Äúcube‚Äù is needed here, and how to implement it. </p><br><p>  <strong>- Is there any favorite word game with Scala?</strong>  <strong>Rock climbing wall, rock climber, cave art - use in your daily life?</strong> </p><br><p>  Is that the epithet "Indoscale", which we use in the address of particularly remarkable pieces of open source, the author of which clearly wanted to demonstrate the remarkable ability to construct unreadable code using functional abstractions. </p><br><p>  <strong>- Moscow or Peter?</strong> </p><br><p>  Each city has its own zest.  Moscow is a rich and well-groomed city with a fast rhythm.  Peter is calmer and filled with the charm of the former European capital.  Therefore, I like to come to Moscow for a visit, but I prefer to live in St. Petersburg. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/442812/">https://habr.com/ru/post/442812/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../442800/index.html">A simple telegram bot in python in 30 minutes</a></li>
<li><a href="../442802/index.html">The State Duma adopted bills on fakes and disrespect for the authorities in the second reading</a></li>
<li><a href="../442806/index.html">The preliminary program DUMP-2019 is ready. Speakers from Evil Martians, Tinkoff.ru, HTML Academy, SkyEng, 2GIS</a></li>
<li><a href="../442808/index.html">We invite you to the Droid Party - a meeting dedicated to the practical issues of developing Android applications and devices</a></li>
<li><a href="../442810/index.html">Myths of popular physics, continued: Gravity</a></li>
<li><a href="../442814/index.html">10 years have passed, and no one has figured out how to use the blockchain. And here again?</a></li>
<li><a href="../442816/index.html">Create your own game controller</a></li>
<li><a href="../442818/index.html">10 common mistakes in writing English and how to deal with them</a></li>
<li><a href="../442822/index.html">Data center at sea and in orbit: do they have practical meaning?</a></li>
<li><a href="../442824/index.html">Welcome to Silicon Valley</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>