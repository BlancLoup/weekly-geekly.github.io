<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ruby on Rails and Yandex. Photos API: show the latest photos on the home page</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For a couple of years I have been using the Yandex. Photos service for storing all my photos, and recently there was a desire on my homepage to displa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ruby on Rails and Yandex. Photos API: show the latest photos on the home page</h1><div class="post__text post__text-html js-mediator-article"><img src="http://fotki.yandex.ru/css/new/block/b-masterpiece-functions/yafotki.png" alt="image"><br>  For a couple of years I have been using the Yandex. Photos service for storing all my photos, and recently there was a desire on my homepage to display the last n photos uploaded to Yandex. Photos, thereby killing several birds with one stone: <br><ul><li>  homepage does not require administration; </li><li>  image storage and management is not required; </li><li>  no need to resize images for previews, etc. </li></ul><br><br>  No sooner said than done.  It turned out that the Photos provide a fairly convenient <a href="">API</a> via the AtomPub protocol.  Because  I planned to make a page on the Ruby on Rails platform, after a brief search I found a good library for working with <a href="http://www.pauldix.net/2009/02/feedzirra-a-ruby-feed-library-built-for-speed.html">feedzirra</a> .  The library was installed in a completely standard way: <br><blockquote><code><a href="http://gems.github.com/"></a> <font color="black">gem sources -a <font color="#008000">gems.github.com</font> gem install pauldix-feedzirra</font></code> <ol><li> <code><font color="black"><a href="http://gems.github.com/"></a> gem sources -a <font color="#008000">gems.github.com</font> gem install pauldix-feedzirra</font></code> </li> <li> <code><font color="black"><a href="http://gems.github.com/"></a> gem sources -a <font color="#008000">gems.github.com</font> gem install pauldix-feedzirra</font></code> </li> </ol></blockquote><br>  and further in ruby ‚Äã‚Äãit is enough to register its use: <br><blockquote><ol><li>  require <font color="#A31515">'feedzirra'</font> </li></ol></blockquote><br>  It's time to explore the API provided. <br><a name="habracut"></a><br>  Having studied the API provided by Yandex, it turned out that the list of the photos recently published by the user can be obtained at the following URL: <br><blockquote> <code><a href="http://api-fotki.yandex.ru/api/users/"></a> <font color="black">api-fotki.yandex.ru/api/users <font color="#0000ff">&lt;</font> <font color="#800000">_</font> <font color="#0000ff">&gt;</font> /photos/published/?limit= <font color="#0000ff">&lt;</font> <font color="#800000">__</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br>  besides authorization for this operation is not required.  The documentation was an example of the output XML, but it turned out that it does not quite correspond to reality.  The method of close debag problem was solved. <br><br>  So I created some kind of wrapper class for the image. <br><blockquote><ol><li>  <font color="#0000ff">class</font> ImageBundle </li><li>  attr_accessor: url,: album_link,: title,: xxl_url </li><li>  end </li></ol></blockquote><br>  here url is the address of a preview of a square-shaped picture, album_link is a link to an album, title is the name of a picture, xxl_url is an address of a large-format picture. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Further in the controller I filled the collection of the received data. <br><blockquote><ol><li>  feed = Feedzirra :: Feed.fetch_and_parse ( <font color="#A31515">"http://api-fotki.yandex.ru/api/users/ligrimp/photos/published/?limit=35"</font> ) </li><li>  @images = Array.  <font color="#0000ff">new</font> </li><li>  <font color="#0000ff">for</font> image <font color="#0000ff">in</font> feed.entries </li><li>  image_url = image.links [3] </li><li></li><li>  i = ImageBundle.  <font color="#0000ff">new</font> </li><li>  i.xxl_url = image_url.clone </li><li></li><li>  image_url [ <font color="#A31515">"XL"</font> ] = <font color="#A31515">"XXS"</font> </li><li>  i.url = image_url </li><li></li><li>  i.album_link = image.links [2] </li><li>  i.title = image.title </li><li>  @images &lt;&lt; i </li><li>  <font color="#0000ff">end</font> </li></ol></blockquote><br><br>  The output to the UI turned out to be a matter of technique, using <a href="http://haml-lang.com/">HAML</a> for markup and <a href="http://studioad.ru/blog/iload_3_image_gallery/2010-02-11-105">iLoad</a> , I got something like the following: <br><blockquote><ol><li>  - <font color="#0000ff">for</font> image <font color="#0000ff">in</font> @images </li><li>  % a {: href =&gt; image.xxl_url,: target =&gt; <font color="#A31515">"_blank"</font> <font color="#A31515">,:</font> rel =&gt; <font color="#A31515">"iLoad :: Yandex.fotki",:</font> title =&gt; image.title} </li><li>  % img {: src =&gt; image.url,: title =&gt; image.title} </li></ol></blockquote></div><p>Source: <a href="https://habr.com/ru/post/88511/">https://habr.com/ru/post/88511/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../88501/index.html">The ban on professional photography in Red Square has been lifted.</a></li>
<li><a href="../88502/index.html">Monitoring servers with Intel RMM using Zabbix</a></li>
<li><a href="../88505/index.html">Rospechat sponsors alternative VIM and RIF?</a></li>
<li><a href="../88507/index.html">Competition and new release of Cerebro</a></li>
<li><a href="../88509/index.html">Meet: MiniBot</a></li>
<li><a href="../88512/index.html">About small OS</a></li>
<li><a href="../88513/index.html">Java EE 6. What's new in Servlet API 3.0</a></li>
<li><a href="../88514/index.html">Trigram-based text generator (python)</a></li>
<li><a href="../88520/index.html">It's time to fade</a></li>
<li><a href="../88524/index.html">Maths. Symmetry of "pseudo-simple twins"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>