<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Encryption in NQ Vault turned out to be an ordinary XOR, and this is not the worst</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="NQ Vault is a rather popular (30 million users) Android application (there is a version for iOS) that allows you to encrypt selected SMS, photos and v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Encryption in NQ Vault turned out to be an ordinary XOR, and this is not the worst</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.netqin.ps">NQ Vault</a> is a rather popular (30 million users) Android application (there is a version for iOS) that allows you to encrypt selected SMS, photos and videos on the device.  View encrypted content through the application by entering a password.  The application has received good reviews and reviews in leading IT publications. <br><br>  User GitHub <a href="https://github.com/ninjadoge24">ninjadoge24</a> decided to check how well the application protects private data. <br><a name="habracut"></a><br>  The researcher began by creating a simple 1x1 pixel PNG file and adding the ‚ÄúNINJADOGE24‚Äù signature to the end of the file.  Then he uploaded the file to the device and encrypted it using NQ Vault with a simple password.  The location of the encrypted file was found in the application database (in SQLite format).  Comparison of the encrypted data with the source showed the first fail. <br><br>  Original file <br><pre><code class="hljs go"><span class="hljs-number"><span class="hljs-number">0000000</span></span>: <span class="hljs-number"><span class="hljs-number">8950</span></span> <span class="hljs-number"><span class="hljs-number">4e47</span></span> <span class="hljs-number"><span class="hljs-number">0d</span></span>0a <span class="hljs-number"><span class="hljs-number">1</span></span>a0a <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">000d</span></span> <span class="hljs-number"><span class="hljs-number">4948</span></span> <span class="hljs-number"><span class="hljs-number">4452</span></span> .PNG........IHDR <span class="hljs-number"><span class="hljs-number">0000010</span></span>: <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0001</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0001</span></span> <span class="hljs-number"><span class="hljs-number">0802</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0090</span></span> <span class="hljs-number"><span class="hljs-number">7753</span></span> ..............wS <span class="hljs-number"><span class="hljs-number">0000020</span></span>: de00 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0970</span></span> <span class="hljs-number"><span class="hljs-number">4859</span></span> <span class="hljs-number"><span class="hljs-number">7300</span></span> <span class="hljs-number"><span class="hljs-number">0003</span></span> b100 <span class="hljs-number"><span class="hljs-number">0003</span></span> .....pHYs....... <span class="hljs-number"><span class="hljs-number">0000030</span></span>: b101 f583 ed49 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0007</span></span> <span class="hljs-number"><span class="hljs-number">7449</span></span> <span class="hljs-number"><span class="hljs-number">4d</span></span>45 <span class="hljs-number"><span class="hljs-number">07d</span></span>f .....I....tIME.. <span class="hljs-number"><span class="hljs-number">0000040</span></span>: <span class="hljs-number"><span class="hljs-number">0401</span></span> <span class="hljs-number"><span class="hljs-number">0319</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>a3d ca0b <span class="hljs-number"><span class="hljs-number">0</span></span>c00 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>c69 <span class="hljs-number"><span class="hljs-number">5458</span></span> ....:=.......iTX <span class="hljs-number"><span class="hljs-number">0000050</span></span>: <span class="hljs-number"><span class="hljs-number">7443</span></span> <span class="hljs-number"><span class="hljs-number">6f</span></span>6d <span class="hljs-number"><span class="hljs-number">6d</span></span>65 <span class="hljs-number"><span class="hljs-number">6e74</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>bc aeb2 tComment........ <span class="hljs-number"><span class="hljs-number">0000060</span></span>: <span class="hljs-number"><span class="hljs-number">9900</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0f</span></span>49 <span class="hljs-number"><span class="hljs-number">4441</span></span> <span class="hljs-number"><span class="hljs-number">5408</span></span> <span class="hljs-number"><span class="hljs-number">1d</span></span>01 <span class="hljs-number"><span class="hljs-number">0400</span></span> fbff .....IDAT....... <span class="hljs-number"><span class="hljs-number">0000070</span></span>: <span class="hljs-number"><span class="hljs-number">00f</span></span>f <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0301</span></span> <span class="hljs-number"><span class="hljs-number">0100</span></span> c706 <span class="hljs-number"><span class="hljs-number">926f</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> ...........o.... <span class="hljs-number"><span class="hljs-number">0000080</span></span>: <span class="hljs-number"><span class="hljs-number">4945</span></span> <span class="hljs-number"><span class="hljs-number">4e44</span></span> ae42 <span class="hljs-number"><span class="hljs-number">6082</span></span> <span class="hljs-number"><span class="hljs-number">4e49</span></span> <span class="hljs-number"><span class="hljs-number">4e4</span></span>a <span class="hljs-number"><span class="hljs-number">4144</span></span> <span class="hljs-number"><span class="hljs-number">4f</span></span>47 IEND.B<span class="hljs-string"><span class="hljs-string">`.NINJADOG 0000090: 4532 340a E24.</span></span></code> </pre> <br>  Encrypted file <br><pre> <code class="hljs go"><span class="hljs-number"><span class="hljs-number">0000000</span></span>: <span class="hljs-number"><span class="hljs-number">8d</span></span>54 <span class="hljs-number"><span class="hljs-number">4</span></span>a43 <span class="hljs-number"><span class="hljs-number">090</span></span>e <span class="hljs-number"><span class="hljs-number">1e0</span></span>e <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">0409</span></span> <span class="hljs-number"><span class="hljs-number">4d</span></span>4c <span class="hljs-number"><span class="hljs-number">4056</span></span> .TJC........ML@V <span class="hljs-number"><span class="hljs-number">0000010</span></span>: <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">0405</span></span> <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">0405</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>c06 <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">0494</span></span> <span class="hljs-number"><span class="hljs-number">7357</span></span> ..............sW <span class="hljs-number"><span class="hljs-number">0000020</span></span>: da04 <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">0d</span></span>74 <span class="hljs-number"><span class="hljs-number">4</span></span>c5d <span class="hljs-number"><span class="hljs-number">7704</span></span> <span class="hljs-number"><span class="hljs-number">0407</span></span> b504 <span class="hljs-number"><span class="hljs-number">0407</span></span> .....tL]w....... <span class="hljs-number"><span class="hljs-number">0000030</span></span>: b505 f187 e94d <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">0403</span></span> <span class="hljs-number"><span class="hljs-number">704d</span></span> <span class="hljs-number"><span class="hljs-number">4941</span></span> <span class="hljs-number"><span class="hljs-number">03d</span></span>b .....M....pMIA.. <span class="hljs-number"><span class="hljs-number">0000040</span></span>: <span class="hljs-number"><span class="hljs-number">0005</span></span> <span class="hljs-number"><span class="hljs-number">071d</span></span> <span class="hljs-number"><span class="hljs-number">3e39</span></span> ce0f <span class="hljs-number"><span class="hljs-number">0804</span></span> <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">086d</span></span> <span class="hljs-number"><span class="hljs-number">505</span></span>c ....&gt;<span class="hljs-number"><span class="hljs-number">9.</span></span>......mP\ <span class="hljs-number"><span class="hljs-number">0000050</span></span>: <span class="hljs-number"><span class="hljs-number">7047</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>b69 <span class="hljs-number"><span class="hljs-number">6961</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>a70 <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span>b8 aab6 pGkiiajp........ <span class="hljs-number"><span class="hljs-number">0000060</span></span>: <span class="hljs-number"><span class="hljs-number">9d</span></span>04 <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>b4d <span class="hljs-number"><span class="hljs-number">4045</span></span> <span class="hljs-number"><span class="hljs-number">500</span></span>c <span class="hljs-number"><span class="hljs-number">1905</span></span> <span class="hljs-number"><span class="hljs-number">0004</span></span> fffb .....M@EP....... <span class="hljs-number"><span class="hljs-number">0000070</span></span>: <span class="hljs-number"><span class="hljs-number">04f</span></span>b <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">0705</span></span> <span class="hljs-number"><span class="hljs-number">0504</span></span> c302 <span class="hljs-number"><span class="hljs-number">966</span></span>b <span class="hljs-number"><span class="hljs-number">0404</span></span> <span class="hljs-number"><span class="hljs-number">0404</span></span> ...........k.... <span class="hljs-number"><span class="hljs-number">0000080</span></span>: <span class="hljs-number"><span class="hljs-number">4945</span></span> <span class="hljs-number"><span class="hljs-number">4e44</span></span> ae42 <span class="hljs-number"><span class="hljs-number">6082</span></span> <span class="hljs-number"><span class="hljs-number">4e49</span></span> <span class="hljs-number"><span class="hljs-number">4e4</span></span>a <span class="hljs-number"><span class="hljs-number">4144</span></span> <span class="hljs-number"><span class="hljs-number">4f</span></span>47 IEND.B<span class="hljs-string"><span class="hljs-string">`.NINJADOG 0000090: 4532 340a E24.</span></span></code> </pre><br>  What is it?  The signature at the end of the file remains untouched!  And the encryption of other sites suspiciously resembles a simple replacement.  Applying the XOR operation between the source and the ciphertext, the researcher received the key: 0x04.  Yes, exactly, <b>XOR with a single-byte key</b> , that is, a simple replacement.  Reminds childhood, "school" ciphers with a shift by several letters in alphabetical order, is not it?  And this is in an application that has a paid version for $ 7.99 per year! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It remained to find out why the signature at the end of the file remained unchanged.  After quickly writing a script for encrypting / decrypting and another experiment with a JPEG file, another sad truth was revealed: <b>only the first 128 bytes of the file are encrypted</b> , the rest remains untouched.  And why, if the first 128 bytes is enough?  The header is corrupted, the file will not open with standard applications, which is something that an inexperienced user needs.  And the speed of video encryption NQ Vault probably tearing all competitors on rags. <br><br>  And the final touch.  How is it possible to get a single-byte key from a password entered by a user?  The researcher tried to grope the algorithm, going through different passwords, but then spat, making a reasonable conclusion: why waste time on it, if you can use brute force and just go through the 256 possible options.  Anyone, even the most ancient Android device perfectly cope with this. <br><br>  <a href="https://ninjadoge24.github.io/">Full test report</a> . <br><br><h2>  Conclusion </h2><br>  There are probably thousands of such applications, both in Google Play and in the AppStore.  They just managed to successfully unleash it, while others did not.  But what is remarkable about this story.  First, how easily users trust promises of security.  In the mind of the user there is no big difference between an application for quickly uploading photos somewhere and an application that encrypts files or stores credit card data.  There is no understanding that for applications related to security, you need to apply special selection criteria.  Just promises, good appearance, user-friendly interface and even thousands of positive reviews are not enough here. <br><br>  Secondly, how can you trust reviews in specialized publications?  It is clear that most of them are paid, and this in itself is not bad, applications need to be promoted.  The main thing is that they are more or less objective.  And reputable publications really try to write objective reviews.  But when it comes to security, a simple review is again not enough.  We need to involve experts who can test this part. </div><p>Source: <a href="https://habr.com/ru/post/254899/">https://habr.com/ru/post/254899/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254887/index.html">WPF: Using Attached Property and Behavior</a></li>
<li><a href="../254889/index.html">Matreshka.js 2: From simple to simple</a></li>
<li><a href="../254891/index.html">We facilitate the support of iOS applications. Part 2 - location and network</a></li>
<li><a href="../254895/index.html">The taste and color 2 - not RGB one</a></li>
<li><a href="../254897/index.html">Lectures of the Technosphere. 1 semester Algorithms for intelligent processing of large amounts of data</a></li>
<li><a href="../254901/index.html">Universal Nixie-module on IN-12</a></li>
<li><a href="../254905/index.html">State Mandate to Kill the Universe and Counteract This (report at Bitcoin Conference Russia 2015)</a></li>
<li><a href="../254907/index.html">Web Bundle - the case of RarJPEG lives</a></li>
<li><a href="../254909/index.html">Some practical cryptography for .NET for dummies</a></li>
<li><a href="../254911/index.html">MPCMeter - indication of the progress of video viewing. Arduino + JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>