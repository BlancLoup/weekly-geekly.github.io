<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Progressive JPEG: new best practice</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In terms of bandwidth, the image - glutton. On average, they occupy the largest ( 62% ) average traffic sites and most often their transfer is a bottl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Progressive JPEG: new best practice</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/fe2/2af/6fa/fe22af6faf42cf35fafc79abfe191ec6.jpg" alt="Comparison of download speeds of progressive and sequential jpeg"><br>  In terms of bandwidth, the image - glutton.  On average, they occupy the largest ( <a href="httparchive.org/interesting.php">62%</a> ) average traffic sites and most often their transfer is a bottleneck.  When loading images, they tear the page, pushing other elements around and causing clumsy redrawing ( <i>note</i> : this, of course, you can get rid of a certain typesetting, but then you need to hardcore or limit the size of the pictures).  Loading an image on the page is perceived as either ‚Äútick, tick, tick, tick, tick, ready,‚Äù or there is nothing at first, and then suddenly ‚Äúboom!‚Äù And it appears from nowhere.  Everyone understands what is meant by ‚Äútick, tick, done‚Äù and ‚Äúboom‚Äù and this annoys us all a bit, because we feel how much time our charming and short lives have been lost waiting for the pictures to load. <br><a name="habracut"></a><br><br><h4>  Missed opportunity </h4><br>  Photos are the main culprit for slow rendering.  They are the <a href="httparchive.org/interesting.php">most frequently requested type of images</a> and, <a href="httparchive.org/interesting.php">on average, weigh more than others</a> .  They have millions of colors and the number of bits per pixel continues to increase.  They are beautiful and we do not want a compromise on quality. <br><br>  Web-optimized photos are jpeg, and jpeg is divided into two types: basic sequential (baseline) and progressive (progressive).  Sequential jpeg is a single scan of the image from top to bottom in full resolution, and progressive jpeg is a series of scans of improving quality.  So they are rendered - sequential jpeg is drawn from top to bottom (‚Äútick, tick, tick, ...‚Äù), and the progressive quickly marks out its territory and then improves (at least as planned). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Progressive jpeg is better because it is faster.  To appear faster is to be faster, and <b>perceived speed is more important than actual speed</b> .  Even if we save on the provided content, progressive jpeg gives as much as possible, as soon as possible.  He helps us in the difficult task of providing large and beautiful photos. <br><br>  In a local experiment ‚Äî an illustration at the beginning of the post ‚Äî on a strangled channel, an 80-kilobyte progressive jpeg appears on the page <b>earlier</b> than a 5-kilobyte serial jpeg (the same image reduced in size) in Firefox under Windows, which should make an impression.  Of course, on the first pass, progressive jpeg has a low resolution, but it contains as much information as a small image, or even more.  And if the page scale is reduced, for example, on a mobile device, then the low resolution is not even noticeable.  Adaptive images work for us right now ( <i>approx. Transl</i> .: Reference to <a href="http://ru.wikipedia.org/wiki/%25D0%2590%25D0%25B4%25D0%25B0%25D0%25BF%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B2%25D0%25B5%25D0%25B1-%25D0%25B4%25D0%25B8%25D0%25B7%25D0%25B0%25D0%25B9%25D0%25BD">responsive web design</a> )! <br><br>  Essentially progressive jpeg is better.  So what is the most common type of jpeg on the web?  Guess: <b>consistent</b> , and with a very large margin.  In a sample of thousands of images, 92.6% are consistent. <br><br>  Do not worry, we just need to declare that progressive jpeg is the best practice and drag the rest of the world to us on board.  But to make such an announcement, you need to be confident in it.  And for this, you first need to understand how things are today with the support of progressive jpeg browsers. <br><br><br clear="all"><h4>  Reality check number 1 </h4><br>  Progressive jpeg are drawn in all browsers, you should not worry about it.  We care <i>how</i> they are drawn. <br><br>  <b>Behavior of progressive jpeg in browsers</b> <br><table><tbody><tr><th>  <strong>Browser (specific version)</strong> </th><th>  <strong>Rendering progressive foreground jpeg (foreground)</strong> </th><th>  <strong>Rendering progressive jpeg background (background)</strong> </th></tr><tr><td>  Chrome (v 25.0.1323.1 dev Mac, 23.0.1271.97 m Win) </td><td>  <i>progressively (very fast!)</i> </td><td>  <i>progressively (very fast!)</i> </td></tr><tr><td>  Firefox (v 15.0.1 Mac, 12.0 Win) </td><td>  <i>progressively (very fast!)</i> </td><td>  instantly after downloading the file (slow) </td></tr><tr><td>  Internet Explorer 8 </td><td>  instantly after downloading the file (slow) </td><td>  instantly after downloading the file (slow) </td></tr><tr><td>  Internet Explorer 9 </td><td>  <i>progressively (very fast!)</i> </td><td>  instantly after downloading the file (slow) </td></tr><tr><td>  Safari (v 6.0 Desktop, v 6.0 Mobile) </td><td>  instantly after downloading the file (slow) </td><td>  instantly after downloading the file (slow) </td></tr><tr><td>  Opera (v 11.60) </td><td>  UPD: <i>progressive (very fast!)</i> ( <a href="http://habrahabr.ru/post/165645/">Proof</a> ) </td><td>  instantly after downloading the file (slow) </td></tr></tbody></table><br>  The results are disappointing, but overall, the browser market share with progressive rendering progressive jpeg goes up.  Support for now is about 65% (Chrome + Firefox + IE9). <br><br>  Unfortunately, browsers that do not render progressive jpeg progressively, draw them all at once after the image download is complete, which, in fact, makes them less progressive.  They become slower than successive jpeg.  Despite the fact that sequential rendering is not as fast and smooth as progressive, it at least gives at least something while we wait, and ‚Äútick, tick‚Äù is a kind of loading indicator (a good thing).  Don't underestimate the confidence that users feel when something is happening. <br><br>  Choosing progressive jpeg, we provide the majority of users with excellent impressions and a minority - a very significant minority - the worst impressions.  But choosing sequential jpeg because it is more suitable in the minority of views is a terrible compromise.  We need to offer users the best and look to the future. <br><br><br clear="all"><h4>  Reality check number 2 </h4><br>  You might ask, ‚ÄúWouldn't progressive jpeg weigh more than usual?‚Äù  Are we paying for ‚Äúlayers‚Äù? ‚Äù.  With some other types of multi-layered images - we pay, but not with jpeg.  Progressive jpeg is usually a few kilobytes less than its consistent version.  Stoyan Stefanov, in the process of building a graph of <a href="http://www.bookofspeed.com/chapter5.html">converting 10,000 random consecutive jpeg into progressive ones</a> , discovered a valuable practical rule: files larger than 10Kb will, more often, weigh less in the progressive version. <br><br>  It would be easier to convince if you could say that progressive jpeg always weigh less, so they should always be used.  It helps us in this.  He says: ‚ÄúAnother observation about the 10Kb rule: in cases where the weight of the sequential jpeg is less, it is less with a slight difference.  And when less progressive, it is usually much less.  So to say that you should always use progressive and become better - this is normal. " <br><br>  Just what I wanted to hear!  On each consecutive jpeg we gave, opportunities in file size and perceived download speed were missed.  The choice of the progressive option is safe and should always be the default choice.  And already when all jpeg are progressive, if you want to further optimize, then you can save a few bytes and only on the smallest images. <br><br>  The reason that consecutive jpeg is the most common on the network is, without a doubt, that image optimization tools create them by default.  However, everything I looked through - Photoshop, Fireworks, ImageMagick, jpegtran - can be saved in a progressive form.  So in order to render progressive jpeg, you need to consciously modify your image optimization process. <br><br>  For example, <a href="http://www.smushit.com/ysmush.it/">Smushit</a> can <a href="http://developer.yahoo.com/yslow/smushit/faq.html">translate</a> consecutive jpeg to progressive.  Smushit, by the way, can be run from the command line and integrated into the image optimization process. <br><br>  How to know that your jpeg is progressive?  Here are some ways to identify the type of jpeg: <br><ol><li> <b>ImageMagick</b> - from the command line, run: <code>identify -verbose mystery.jpg | grep Interlace</code>  <code>identify -verbose mystery.jpg | grep Interlace</code> The output will be either ‚ÄúInterlace: JPEG‚Äù or ‚ÄúInterlace: None.‚Äù </li><li>  <b>Photoshop</b> - Open the file.  Select File -&gt; Save for Web &amp; Devices.  If this is a progressive jpeg, then the Progressive flag will be marked. </li><li>  <b>Any browser</b> - Sequential jpeg will load from top to bottom, and progressive ones will behave differently.  If the file loads too quickly, a bandwidth limit may be necessary.  I use ipfw under Mac. </li></ol><br><br><h4>  Reality check number 3 </h4><br>  According to this <a href="http://www.faqs.org/faqs/jpeg-faq/part1/section-11.html">jpeg compression FAQ</a> , each progressive draw passages the CPU by about the same amount as the drawing of a whole sequential jpeg.  It doesn‚Äôt matter for desktops, but it probably does matter for mobile devices. <br><br>  Unnecessary computation is a flaw, but not a stumbling block.  Providing photos on weak hardware is a difficult task regardless of this.  I am in the know because I am writing a photo gallery application with endless scrolling and it falls on the iPad.  When processing a large number of images on mobile platforms, complex tasks will arise in any case. <br><br>  As you can see in the table, Mobile Safari does not render progressive jpeg progressively and probably because they load the CPU.  Progressive jpeg is not a <i>new</i> image format.  Therefore, consciously and without reason not to support progressive jpeg is not an option for browsers, even for mobile.  Hopefully, mobile browsers will soon cope with progressive rendering, but the reasons for the current lack of support make sense.  It is very disappointing, because just on mobile devices the speed increase and saving in file sizes provided by progressive jpeg would be very useful.  It was mentioned above that it seems to be the solution for adaptive images at the moment.  In fact, it could be, but the time has not come yet. <br><br><br clear="all"><h4>  Looking to the future </h4><br>  A month ago, Google jumped on board with its <a href="https://code.google.com/p/modpagespeed/">Mod_Pagespeed</a> service, making <code>convert_jpeg_to_progressive</code> <a href="http://googledevelopers.blogspot.com/2012/12/new-modpagespeed-cache-advances.html">main filter</a> .  <a href="http://www.chromium.org/spdy/spdy-whitepaper">SPDY</a> also does not lag behind, <a href="https://developers.google.com/speed/docs/mod_pagespeed/filter-image-optimize">translating jpeg more than 10Kb in progressive by default</a> , according to the practical rule of Stoyan.  Browsers that support incremental display, this will seem much faster.  As can be seen from the table above, which includes Google Chrome, such actions by Google make sense.  I will not say that if ‚Äúnon-causally-evil-do-web-faster‚Äù Google chose progressive jpeg as best practice, then we should all the more.  But this is further confirmation.  And most importantly, it shows that progressive jpeg - a format that has been in a kind of freezer for a decade - begins its return. <br><br>  Not all current browsers implement progressive rendering progressive jpeg.  Despite this, those that implement - really benefit because of this.  And besides, we get savings in file sizes.  Today it is the best option and worth using it.  Progressive jpeg is the future, not the past. </div><p>Source: <a href="https://habr.com/ru/post/165645/">https://habr.com/ru/post/165645/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165635/index.html">Why the new album of Bob Dylan came out with a circulation of 100 copies</a></li>
<li><a href="../165637/index.html">MIT has developed a synthetic "muscle" that works on water</a></li>
<li><a href="../165639/index.html">Tyunim keyboard correctly</a></li>
<li><a href="../165641/index.html">Programming on Android for a web developer or a quick start for the little ones. Part 3</a></li>
<li><a href="../165643/index.html">What's inside the cable station headend</a></li>
<li><a href="../165647/index.html">Sharing service of screenshots and code</a></li>
<li><a href="../165649/index.html">Javascript: from beginning to end</a></li>
<li><a href="../165657/index.html">The new Samsung refrigerator offers recipes based on its contents.</a></li>
<li><a href="../165659/index.html">Procrastination New tasks. Part 2</a></li>
<li><a href="../165661/index.html">Quipu is an esoteric programming language based on the Incas nodular script</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>