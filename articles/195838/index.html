<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Methods of forming a measurement with attributes type 1 and 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We are working on DWH in telecommunications, so the example I‚Äôm considering is called ‚ÄúSubscriber‚Äù. The principle is universal and it could be ‚ÄúClient...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Methods of forming a measurement with attributes type 1 and 2</h1><div class="post__text post__text-html js-mediator-article">  We are working on DWH in telecommunications, so the example I‚Äôm considering is called ‚ÄúSubscriber‚Äù.  The principle is universal and it could be ‚ÄúClient‚Äù or ‚ÄúPatient‚Äù - depending on the industry.  I hope the methodology will be useful for DWH developers from different industries. <br><br>  If you do not understand what DWH is, measurements and facts, I recommend reading Ralph Kimball‚Äôs book Dimensional Modeling.  This is a database for analytics and consolidated reporting of an enterprise, specifically on the formation and updating of dimensions - tables that store the attributes (fields) for selection (WHERE) in future queries. <a name="habracut"></a><br><br>  Our methodology is designed for Microsoft SQL Server. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Principle of change </h4><br>  The definition of the change of attributes of type 1 (rewritable) and 2 (with the history stored in measurement records) is made on the basis of comparison of checksums of the fields. <br><br>  For calculating checksums, the T-SQL CHECKSUM function is used, which does not support text, ntext, image types, which should not be placed in the measurements.  Using BINARY_CHECKSUM in practice has shown that false detection of changes in fields containing NULL is possible.  With this technique, it is possible to use custom checksum functions developed on .NET. <br><br><h4>  Measurement announcement </h4><br>  The dimension must be declared with a primary key containing a clustered index. <br><br>  Example of the SQL script of the ‚ÄúSubscriber‚Äù dimension ad: <br><br><pre><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> [DWH] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-comment"><span class="hljs-comment">/*     Dim */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> SCHEMA_ID(<span class="hljs-string"><span class="hljs-string">'Dim'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXECUTE</span></span>(<span class="hljs-string"><span class="hljs-string">'CREATE SCHEMA [Dim] AUTHORIZATION [dbo]'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dbo.sysobjects <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> = OBJECT_ID(N<span class="hljs-string"><span class="hljs-string">'[Dim].[]'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> OBJECTPROPERTY(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>, N<span class="hljs-string"><span class="hljs-string">'IsUserTable'</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">DROP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [Dim].[] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [Dim].[] ( [AccountKey] <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> CLUSTERED, [ ] <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ ] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> ([ ] <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (N<span class="hljs-string"><span class="hljs-string">'.'</span></span>, N<span class="hljs-string"><span class="hljs-string">'.'</span></span>, N<span class="hljs-string"><span class="hljs-string">' '</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> N<span class="hljs-string"><span class="hljs-string">' '</span></span>, [] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">16</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> N<span class="hljs-string"><span class="hljs-string">' '</span></span>, [ ] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'   '</span></span>, [  ] <span class="hljs-built_in"><span class="hljs-built_in">DATE</span></span>, [  ] <span class="hljs-built_in"><span class="hljs-built_in">DATE</span></span>, [] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'   '</span></span>, [] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'   '</span></span>, [] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'   '</span></span>, [ ] <span class="hljs-built_in"><span class="hljs-built_in">DATE</span></span>, [] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [] + <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> [] != N<span class="hljs-string"><span class="hljs-string">'   '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> N<span class="hljs-string"><span class="hljs-string">' '</span></span> + [] <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> N<span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> [] != N<span class="hljs-string"><span class="hljs-string">'   '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> N<span class="hljs-string"><span class="hljs-string">' '</span></span> + [] <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> N<span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>, [ ] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> N<span class="hljs-string"><span class="hljs-string">'   '</span></span>, ... [] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">200</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> N<span class="hljs-string"><span class="hljs-string">'   '</span></span>, [  SMS] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> N<span class="hljs-string"><span class="hljs-string">'   '</span></span>, [] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">200</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> N<span class="hljs-string"><span class="hljs-string">'   '</span></span>, [E-mail] <span class="hljs-keyword"><span class="hljs-keyword">NVARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> N<span class="hljs-string"><span class="hljs-string">'   '</span></span>, [ ] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> N<span class="hljs-string"><span class="hljs-string">': '</span></span> + [] + N<span class="hljs-string"><span class="hljs-string">', '</span></span> + N<span class="hljs-string"><span class="hljs-string">'  SMS: '</span></span> + [  SMS] + N<span class="hljs-string"><span class="hljs-string">', '</span></span> + N<span class="hljs-string"><span class="hljs-string">': '</span></span> + [] + N<span class="hljs-string"><span class="hljs-string">', '</span></span> + N<span class="hljs-string"><span class="hljs-string">'E-mail: '</span></span> + [E-mail], [StartTime] DATETIME2 <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [EndTime] DATETIME2 <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [Checksum1] <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [Checksum2] <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> IDENTITY_INSERT [Dim].[] <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> [Dim].[] ([AccountKey],[ ],[StartTime]) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">GETDATE</span></span>()) <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> IDENTITY_INSERT [Dim].[] <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span></code> </pre> <br><br>  It is necessary to impose on the measurement a conditional index on the business key with the condition [EndTime] IS NULL, containing the checksum fields.  The inclusion of checksums in the index, provided the cluster index of the primary key of the dimension table ([AccountKey]), allows you not to read the dimension table itself when performing the initial query.  At the same time, the index performs the function of controlling uniqueness - one valid entry for one business key. <br><br>  An example of an index for measuring ‚ÄúSubscriber‚Äù: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNIQUE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> IX__ <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [Dim].[] ([ ], [EndTime]) <span class="hljs-keyword"><span class="hljs-keyword">INCLUDE</span></span> ([Checksum1], [Checksum2]) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> [EndTime] <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span></code> </pre><br><br><h5>  Typical initial SQL query </h5><br>  The initial SQL query contains an internal subquery [i], which receives fields from the source copy tables and an external query [o], which generates checksums, and appends the current dimension row to the business key. <br><br>  An example of the initial request for the dimension ‚ÄúSubscriber‚Äù: <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> [o].*, [].[Checksum2] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [OLD_CHECKSUM2], [].[Checksum1] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [OLD_CHECKSUM1], [].[AccountKey] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [OLD_AccountKey] <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> i.*, <span class="hljs-keyword"><span class="hljs-keyword">CHECKSUM</span></span>( [ ], [], [ ], [  ], [], [], [], [ ], [], [], [], [], [ ], [ ] ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [CHECKSUM2], <span class="hljs-keyword"><span class="hljs-keyword">CHECKSUM</span></span>( [], [  SMS], [E-mail], [ ] ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [CHECKSUM1] <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">Raw</span></span>].... <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">Raw</span></span>].... ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> [i] <span class="hljs-comment"><span class="hljs-comment">--     ) AS [o] --      LEFT JOIN [Dim].[] ON [o].[ ] = [].[ ] AND [].[EndTime] IS NULL --     </span></span></code> </pre><br><br>  Type casting (this is typically CAST (... AS NVARCHAR (..)) or IIF (ISDATE ([...]) = 1, CAST ([...] AS DATE), NULL)), as well as all the binding source tables (LEFT JOIN) and conditional formation of fields (CASE, IIF) must be done in an internal query - inside FROM (...) AS [i]. <br><br>  If the logic of linking source tables is too complicated (for example, you need to pull some data out of the hierarchy) and it cannot be done inside FROM, then before data flow in SSIS, you will have to insert a SQL Task that forms intermediate data in separate tables (following your naming scheme). objects).  Temporary tables will not work because SSIS will not be able to determine output stream metadata. <br><br>  You can make sure that the interaction between the index and the initial query is correct by looking at its execution plan.  At the end of the execution plan there should be no reference to the table: <br><br><img src="https://habrastorage.org/storage3/16c/c71/ff1/16cc71ff12e7732bedf831b05ad1bacc.png" alt="image"><br><br><h4>  Typical data stream </h4><br>  The data of the formation of the dimension exits the initial SQL query described above and implements the further logic of the change. <br><br><img src="https://habrastorage.org/storage3/e3c/3a2/a63/e3c3a2a630cd266a14ae36dd1a0562a2.png" alt="image"><br><br>  In the operation ‚ÄúAdding StartTime‚Äù we add to the StartTime stream using the start time of the SSIS package (take the variable @ [System :: StartTime]) <br><br>  In the operation ‚ÄúDetect type 1 update‚Äù, we single out one stream - ‚ÄúType1 fields are updated‚Äù based on the expression! ISNULL (OLD_CHECKSUM1) &amp;&amp; CHECKSUM1! = OLD_CHECKSUM1. <br><br>  In the operation ‚ÄúUpdate type 1 fields by business key‚Äù we update all measurement records (including already closed records containing historical values ‚Äã‚Äãof type 2 fields) in which attributes of the first type have changed - for this we use the business key without the cutoff condition of irrelevant records (without condition on [EndTime]).  Example for ‚ÄúSubscriber‚Äù: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> [Dim].[] <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> [] = ?, [  SMS] = ?, [E-mail] = ?, [ ] = ? [Checksum1] = ? <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> [ ] = ?</code> </pre><br><br>  In the operation ‚ÄúIdentify type 2 update and new records‚Äù, we distinguish two streams: <br><ol><li>  ‚ÄúNew‚Äù based on the expression ISNULL (OLD_AccountKey) </li><li>  ‚ÄúUpdated Type2 fields‚Äù based on the expression CHECKSUM2! = OLD_CHECKSUM2 </li></ol><br><br>  In the operation ‚ÄúClose Measured Measurement Lines‚Äù, update [EndTime] for measurement records with the StartTime value from the stream.  Example for ‚ÄúSubscriber‚Äù: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> [Dim].[] <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> [EndTime] = ? <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> [AccountKey] = ?</code> </pre><br><br>  In the operation ‚ÄúInsert lines into dimension‚Äù we insert new lines, while in the [StartTime] field we insert StartTime from the stream, the measurement key and [EndTime] are ignored (NULL generated in the [EndTime] field will be a sign of the current record). <br><br>  When inserting on the last operation, it will not be possible to use Fast Load mode because the insertion performed in the same stream with updates must operate with a string without extending the lock to the table level, otherwise there will be conflicts between simultaneous operations.  Alternatively, you can spread the operations along different steps of the control flow, keeping intermediate results in Raw or Cache and following the order of operations. <br><br><h4>  Transaction use </h4><br>  At the level of the data flow container (or the general container, if you split the operations into steps of the control flow), it is desirable to enable the transaction.  To do this, set TransactionOption = Required (requires DTC) and IsolationLevel not lower than ReadCommitted. <br><br>  If there is no transaction, if the data flow is interrupted, a portion of the measurement records may remain closed without inserting the corresponding actual records.  At the next start, the missing entries will be inserted as new ones, but with a starting time different from the closing time of the previous line.  This should be taken into account if the facts are attached to the measurement by the method of attaching the record that is relevant at the moment of the occurrence of the fact - to operate with the measurement binding only the closing time. <br><br><h4>  Comparison with other methods </h4><br>  Compared to using the standard SQL Server Integration Services component, called Slowly Changing Dimension, this method does not use a comparison of each field with each field in a dimension row ‚Äî it does not even refer to the table to perform such a comparison.  This gives the main advantage - speed.  In addition, the standard Slowly Changing Dimension controls the whole chain of elements at once, and this creates difficulty with their customization.  For reasons unknown to me, the standard SSIS component may falsely detect changes (perhaps this is also related to NULL fields). <br><br>  Before the commercial components of third-party vendors there is a fundamental advantage of the method in that it is based on the standard components and functions supplied with the release of SQL Server.  Thus, it is not necessary to wait for updated components to upgrade to the next version of SQL Server. <br><br><h4>  Method modifications </h4><br>  A modified method is possible, in which the join is performed not in the SQL query, but in the SSIS data stream through the Lookup operation.  This leads to more calls to the database and replacing the effective Hash Match with less effective single requests.  On the other hand, this allows you to separate the source tables (copy tables that are formed at the boot stage from the source systems) and the measurement tables to different servers.  But the benefits of such an opportunity I doubt. <br><br>  It is possible to join in the SSIS stream through the Merge Join operation, but it will require retrieving the table and sorting it, which will negate the advantages of the index. <br><br>  The calculation of the checksum is also possible in the data stream, for example, a separate component, but in this case the advantage of not having the need for separate components disappears. <br><br>  Calculating the checksum in the data stream using Script Transformation on C # is a possible modification option if this complication makes sense. <br><br>  An overview of the implementation (with screenshots) of the modified method (in fact, the previous version) using the free third-party component for calculating checksums from Konesans and using a custom Lookup (to use the index) can be <a href="http://www.larionov.pro/2013/01/slowly-changing-dimensions-ssis.html">seen here</a> . </div><p>Source: <a href="https://habr.com/ru/post/195838/">https://habr.com/ru/post/195838/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../195820/index.html">Automated test report generation</a></li>
<li><a href="../195830/index.html">We write a game development framework - Mechanic Framework</a></li>
<li><a href="../195832/index.html">Binary heap: proof of the complexity of the construction of O (n)</a></li>
<li><a href="../195834/index.html">Linear representation of an octree using the Morton code</a></li>
<li><a href="../195836/index.html">Methods for solving color perception problems</a></li>
<li><a href="../195840/index.html">Conceptual model of an individual approach to teachers and students in the organization and planning of the educational process at the university</a></li>
<li><a href="../195842/index.html">Preparation of schedules in MatLab</a></li>
<li><a href="../195844/index.html">What can we expect from Ruby 2.1?</a></li>
<li><a href="../195846/index.html">Experience of construction of a kopter: WLtoys V949 + MultiWii 2.0</a></li>
<li><a href="../195848/index.html">RailsClub'Moscow 2013. Photos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>