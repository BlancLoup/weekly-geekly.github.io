<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SNR-ERD: From a ‚Äúping‚Äù machine to a line of equipment</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The beginning of the two thousandth is the rapid development of telecommunications networks. The installers, who spent the whole day on the roofs, lay...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SNR-ERD: From a ‚Äúping‚Äù machine to a line of equipment</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/afa/b1a/5b5/afab1a5b54e34b38b6f196f384f3d358.png" alt="image"><br><br>  The beginning of the two thousandth is the rapid development of <a href="http://nag.ru/">telecommunications</a> networks.  The installers, who spent the whole day on the roofs, laying the cable to the final subscriber, urgently needed devices to check the conformity of the cable to the connected port.  The problem of ‚Äúfreezing‚Äù of equipment was also acute.  The installers had to constantly ply between communication nodes and reboot them manually.  So the idea of ‚Äã‚Äãdeveloping the first <a href="http://shop.nag.ru/catalog/00007.Avtomatizatsiya-i-monitoring/05629.ERD-Kontrollery">SNR-ERD</a> . <br><a name="habracut"></a><br>  As a result, the specialists from ‚ÄúNAG‚Äù came up with the idea of ‚Äã‚Äãcreating a device that could be connected to the cable and ping a specific port.  A little later, the device was equipped with the function of remote rebooting the device.  This is how SNR-ERD-WEB appeared, which became a universal assistant for installers and network administrators. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/abb/fc3/fd6/abbfc3fd625748b3884a1023c80bd7c7.png" alt="image"></div><br>  <i>First ping</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first model was an eight-bit microcontroller with 8 kilobytes of flash memory and 500 bytes of RAM.  The device was controlled via a web interface.  The device could work with temperature sensors, reboot the equipment and control the door opening-closing sensors. <br><br>  The device has found the audience quickly enough.  Development and improvement of the device occurred regularly.  And most of the recommendations came from ERD buyers, who used the device in the field and understand what improvements it needs.  Already in the next modification, the device received the SNMP protocol, remote firmware upgrade, thermostat function, phase sensor. <br><br>  The great demand for the device spawned the development of a number of devices whose functionality was constantly expanding.  The next step in this chain was <a href="http://shop.nag.ru/catalog/00007.Avtomatizatsiya-i-monitoring/05629.ERD-Kontrollery/07975.SNR-ERD-23-termo-out">SNR-ERD-2</a> , which is still positioned as a budget tool for controlling <a href="http://shop.nag.ru/search%3Fword%3D%25D1%2586%25D0%25BE%25D0%25B4%26child_id%3D102">data center</a> parameters, and its modifications are in great demand. <br><br><img src="https://habrastorage.org/files/f86/56d/2ad/f8656d2adac543e493b45dd090adb7b2.png" alt="image"><br><br>  An inexpensive compact device with growing functionality enjoyed fairly good demand, which resulted in the development of a whole series of devices with a general index of SNR-ERD-2.  These devices are still positioned as a budget tool to control the basic physical parameters in <a href="http://shop.nag.ru/catalog/14864.Data-TSentr/14899.Mobilnyj-TSOD/19129.DataCube-4210">mini-DPC</a> . <br><br>  ERD-2 has been widely used by telecom operators for monitoring temperature in data centers (Data Centers).  For example, Mail.Ru Group has installed more than 800 ERD-2 pieces. <br><br>  Here is a review by Deputy Technical Director of the Mail.Ru Group, Sergey Kubasov: <br><br><blockquote>  ‚ÄúWe use ERD-2 to monitor the temperature in the data centers M100 (Mail.Ru Group) and ITSVA (Vkontakte).  When choosing a solution for us it was important: <br>  Price - in the case of ERD, the cost of one temperature sensor (together with the controller) is one of the lowest; <br>  Peripherals - for ERD it is enough to have any L2 switch, there is no need to buy any additional controllers for aggregations; <br>  Deployment rate - the product API is described in as much detail as possible; <br>  Delivery time - regardless of the volumes we requested, the shipment was carried out ‚Äúon the next day‚Äù or at a time acceptable to us; <br>  Production flexibility - small customization in the form of an increase in the length of the cable of the thermal sensor, was performed promptly and without additional questions; <br>  High reliability - for the entire period of operation I want to note a very low reject rate and the almost complete absence of failure; <br>  Support - we get answers on problems very quickly. <br><br>  What is missing: <br>  PoE - you have to pull food, which is very inconvenient; <br>  Humidity sensors - then we could have complete climate control on the ERD. ‚Äù </blockquote><br>  Client requests could not go unnoticed and after a while NAG specialists developed a third series device.  In addition to the already known functions, ERD-3 added: <br><br><ul><li>  RS-232 and RS-485 serial data interfaces; </li><li>  additional phase sensor; </li><li>  external port for connecting up to five 1-Wire sensors (SNR-DTS-2); </li><li>  the ability to install a GSM / GPRS module to implement a wireless data transmission channel, as well as sending SMS notifications; </li><li>  Passive PoE with 5V power supply. </li></ul><br>  Changed and device design.  The device was placed in a convenient metal housing and DIN rail mounting. <br><br><img src="https://habrastorage.org/files/8a7/ebe/1eb/8a7ebe1ebfcb4b689d4151842984ee9b.png" alt="image"><br><br>  ERD-3 are 3-in-1 devices: an Ethernet / RS232 or Ethernet / RS485 interface converter, a UPS (Uninterruptible power supply) controller with MegaTec protocol support, as well as a device for monitoring the status of sensors, medium temperature and voltage. <br>  By the way, quite recently ERD-2 was also produced in a metal case, which was a response to requests from integrator companies that were ready to build their solutions based on ERD, but the appearance of the device did not quite match their needs.  Therefore, now ERD-2 can be purchased in two versions: in heat shrinkage or metal case. <br><br><img src="https://habrastorage.org/files/757/495/86c/75749586c63e4901bc5cd464804ccbc6.png" alt="image"><br>  <i>Advanced ERD-2</i> <br><br>  Let's return to <a href="http://shop.nag.ru/catalog/00007.Avtomatizatsiya-i-monitoring/05629.ERD-Kontrollery/16094.SNR-ERD-3s">ERD-3</a> .  In addition to the widespread demand from providers, the device is demanded by integrators for small automation and the system of Automatic Metering System as an Ethernet / RS-485 and Ethernet / RS-232 for polling various resource counters.  On the basis of ERD devices, the software load ‚ÄúNAgruzka‚Äù, about which we wrote earlier, works. <br><br>  In the future, ERD-3 was enhanced by the GSM / GPRS module for use in solutions where GSM / GPRS was the main data transmission channel.  The device received the name ERD-GSM. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xxOg26zE23k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote>  ERD-GSM heat resistance test <br></blockquote><br>  However, time did not stand still and it became clear that modern requirements dictate the further development of the ERD device series, and for this new computational and hardware resources were needed. <br><br>  The 32-bit STM32F407 microcontroller from ST and the modern KSZ8031RNL PHY controller were chosen as the basis for the new hardware and software complex to work with the Ethernet network.  In connection with the change of platform, it was necessary to completely rewrite the software.  At the same time, it was decided to transfer functional software under the control of the real-time operating system RTOS.  The operating system allowed unleashing the control loop and building a function call based on flexible priorities.  Also, the device was able to power, both through external dedicated contacts, and PoE standards IEEE 802.3af-2003 and IEEE 802.3at-2009, as well as Passive PoE from 36 to 48 V. <br><br>  The transition to the new platform was carried out in several stages.  At first, a device with basic equipment, called ERD-Pro-mini, appeared on the light.  The first devices were going to artisanal in the laboratory "NAG". <br><br><img src="https://habrastorage.org/files/8ac/3fb/157/8ac3fb1573de46ee837421f06b076b90.jpg" alt="image"><br><br><img src="https://habrastorage.org/files/1b9/204/3ba/1b92043ba27145feb97fb97fb0eaa89f.jpg" alt="image"><br><br><img src="https://habrastorage.org/files/d7a/e36/069/d7ae360697bb4533b5a177174618fd6d.jpg" alt="image"><br><br><img src="https://habrastorage.org/files/e9c/de5/09f/e9cde509fb474c80bfce4e79d12a5d31.jpg" alt="image"><br><br><img src="https://habrastorage.org/files/956/341/a14/956341a1450f4b1688a2ea5a7b6bb3ea.jpg" alt="image"><br><br><img src="https://habrastorage.org/files/ce8/e3b/e6d/ce8e3be6dbf74fcd841ce8b584f0ea22.jpg" alt="image"><br><br><img src="https://habrastorage.org/files/046/9c7/eea/0469c7eea79f4087897ccc5e3271921e.jpg" alt="image"><br><br>  Now the device looks like this: <br><br><img src="https://habrastorage.org/files/ec4/8bf/dcf/ec48bfdcfcd745ba92baf581c47ffeed.jpg" alt="image"><br><br>  All the advantages of <a href="http://shop.nag.ru/catalog/00007.Avtomatizatsiya-i-monitoring/05629.ERD-Kontrollery/17680.SNR-ERD-Pro-mini-12">ERD-Pro-mini were</a> somewhat lost against the background of the shortcomings that were found already in use.  Due to the specifics of the case, an erroneous supply of power to the contacts, which were not designed for this, occurred, which, in turn, led to irreversible damage to the device. <br><br>  One of the main advantages of the ERD-3 was its enclosure itself, as well as the possibility of modular expansion and the availability of RS-232 and RS-485 interfaces, and the bottleneck was the 8-bit ATmega328 controller with its 32 KB of flash memory versus 1024 KB have STM32F407.  If the client asked to implement any new feature, then for this it was necessary to cut out some other one.  Thus, the task of combining the best of ERD-3 and ERD-Pro-mini appeared. <br><br>  The ERD-3 PCB is almost one and a half times smaller than the ERD-PRO-mini board.  Therefore, the density of the electronic components was significantly higher, and therefore the requirements for manufacturing the board became higher.  It was not a difficult task, but with direct development, it turned out that the new device should have a number of additional features, in addition to those already present in ERD-3 and ERD-PRO-mini. <br>  On board the device required to place: <br><br><ul><li>  protection against polarity reversal; </li><li>  boost DC / DC converter 12V, to power external sensors; </li><li>  5V DC / DC down converter, compatible with PoE standards; </li><li>  backup circuits with PoE power and a dedicated power connector; </li><li>  Precision DAC (DAC), for performing the function of PID regulation; </li><li>  powerful power relay for switching loads with voltage up to 250 V and current up to 10 A; </li><li>  five combined input and output ports, the so-called DIO ports (digital input / output); </li><li>  resettable fuses to protect DIO ports and DAC ports, </li><li>  additional external non-volatile memory for storing settings and measurement results. </li></ul><br>  Plus, the new device had to provide an average time between failures of 75,000 hours and also meet the requirements for resistance to electromagnetic effects for information technology equipment, according to GOST CISPR 24-2013. <br>  As a result, the light saw <a href="http://shop.nag.ru/catalog/00007.Avtomatizatsiya-i-monitoring/05629.ERD-Kontrollery/20485.SNR-ERD-4s">"Multifunctional controller SNR-ERD-4"</a> or simply abbreviated ERD-4. <br><br><img src="https://habrastorage.org/files/7c2/718/96f/7c271896fbdc4cf48977bd8a8c5c80ef.png" alt="image"><br><br>  In the process of developing <a href="http://shop.nag.ru/catalog/00007.Avtomatizatsiya-i-monitoring/05629.ERD-Kontrollery/20485.SNR-ERD-4s">ERD-4, it</a> was <a href="http://shop.nag.ru/catalog/00007.Avtomatizatsiya-i-monitoring/05629.ERD-Kontrollery/20485.SNR-ERD-4s">necessary</a> to design a schematic diagram, select components and make samples that were subjected to various experiments. For example, the test for resistance to air electrostatic discharges with a voltage of 8 kV. <br><br><img src="https://habrastorage.org/files/13d/13b/10e/13d13b10ea3b4c6e82c48c40fc764f37.png" alt="image"><br><br>  To comply with GOST CISPR 24-2013, experiments were conducted with the device's resistance to various types of interference. <br><br><img src="https://habrastorage.org/files/fa5/70c/161/fa570c1610ee4e1196fbae4b035cf5f1.png" alt="image"><br>  <i>ERD-4 Test for Nanosecond Pulse Interference Resistance</i> <br><br><img src="https://habrastorage.org/files/7de/481/f6a/7de481f6ac69478790ffff3694576221.png" alt="image"><br>  <i>ERD-4 test for resistance to high energy microsecond pulses</i> <br><br>  The device was tested in climatic chambers.  Limit voltages and currents were measured.  After going through dozens of samples, repeatedly tested, this is the final form of the printed circuit board. <br><br><img src="https://habrastorage.org/files/3d1/4d4/feb/3d14d4feb1c546d5b8a38c0249774b72.png" alt="image"><br><br>  We should also dwell on the description of the operation of the DIO ports and the DAC output. <br><br><img src="https://habrastorage.org/files/46c/fa2/6ed/46cfa26ed8b14dffa13947099a4e3ca9.png" alt="image"><br>  <i>Fragment of DIO port concept</i> <i><br></i> <br><br>  The feature of their implementation is that each port can work as an input (DI mode), and an output (DO mode).  This is achieved by the fact that the microcontroller is connected to each port with two GPIO pins through special decoupling circuits D11 and Q17.  This solution has increased the flexibility of ERD-4.  The user can now determine the necessary port configuration.  For example, the ‚Äú5 inputs + relay‚Äù configuration will be useful in those applications where you need to connect a large number of sensors with a relay output (perimeter security, control of water leaks).  The relay in this configuration may include a siren or groundwater pump.  If the user needs to control a large number of relays, contactors or starters, he can use the configuration of "5 outputs + relay".  Between these two extremes, any intermediate configurations are possible: ‚Äú2 inputs + 3 outputs‚Äù, ‚Äú4 inputs and 1 output‚Äù, etc. <br><br>  Also, for the first time in the ERD series, the ERD-4 outputs can switch loads with supply voltage up to 48V and with rated / pulse current up to 0.5 / 1A.  This allows you to significantly expand the possibilities of pairing ERD-4 with external switching devices and loads.  In particular, widely used 12 V and 24 V relays can be used. If it is planned to use five-volt switching devices, such as SNR-SMART sockets, the built-in voltage source allows supplying loads with total current up to 2 A. <br><br>  Especially for ERD-4, two mezzanine radio modules were developed.  One for work with GSM / GPRS, and another - for ISM networks in the 868 MHz range. <br><br>  GSM / GPRS module allows you to make a backup connection via GSM / GPRS and control via SMS.  The module for ISM 868 networks allows you to connect various wireless sensors, such as pulse counters, heat meters, phase sensors, etc. <br><img src="https://habrastorage.org/files/49a/2a4/fe3/49a2a4fe30f64c658f1ded5f58c07a41.png" alt="image"><br><img src="https://habrastorage.org/files/36c/db4/12f/36cdb412f96a4d969a9dc6531c19cb1d.png" alt="image"><br><img src="https://habrastorage.org/files/7c2/718/96f/7c271896fbdc4cf48977bd8a8c5c80ef.png" alt="image"><br><br>  Now <a href="http://shop.nag.ru/catalog/00007.Avtomatizatsiya-i-monitoring/05629.ERD-Kontrollery">SNR-ERD</a> is a whole line of devices demanded by telecom operators, integrators of automated systems, enterprises of the housing and utilities sector, banking structures and IT companies.  Devices are used at communication centers, in data centers, in various cabinets with equipment for automating environmental monitoring, perimeter monitoring, as well as for solving telecontrol tasks of various loads. </div><p>Source: <a href="https://habr.com/ru/post/403409/">https://habr.com/ru/post/403409/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../403399/index.html">YouTube employees are looking for hate on video. AI watches and learns</a></li>
<li><a href="../403401/index.html">UK lived a day without coal as a source of electricity for the first time since 1882</a></li>
<li><a href="../403403/index.html">Onion stops collecting donations for the Omega 2 microcomputer</a></li>
<li><a href="../403405/index.html">ZX Spectrum turned 35 years old</a></li>
<li><a href="../403407/index.html">Is the dream of a high-tech bright future attainable? Past</a></li>
<li><a href="../403411/index.html">Additive Technology Trends in 2017 - Video</a></li>
<li><a href="../403413/index.html">Created the first technology to fake any votes.</a></li>
<li><a href="../403415/index.html">Do not call me</a></li>
<li><a href="../403417/index.html">My salvation: a tour of Coworking 14</a></li>
<li><a href="../403419/index.html">An amateur Spanish beekeeper accidentally discovered that the larvae of a large wax moth devour plastic</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>