<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Some details about Class Based Views, part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings to you again, dear readers! I publish another article from the cycle about Class Based Views (hereinafter CBV) in Django. This time I, as pl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Some details about Class Based Views, part 3</h1><div class="post__text post__text-html js-mediator-article">  Greetings to you again, dear readers!  I publish another article from the cycle about Class Based Views (hereinafter CBV) in Django.  This time I, as planned, would like to consider a ListView (responsible for displaying a list of objects) and DetailView (responsible for displaying information about a particular object). <br><br>  <a href="http://habrahabr.ru/blogs/django/137168/">Part 1</a> , <a href="http://habrahabr.ru/blogs/django/137223/">Part 2</a> , <b>Part 3</b> , <a href="http://habrahabr.ru/blogs/django/137960/">Part 4</a> <br><br>  Also, as before, I will be happy to get feedback from readers - if you find an error or inaccuracy in the article, please inform us that we will make the article better together. <br><a name="habracut"></a><br><h5>  Quick links to find methods </h5><br>  <a href="https://habr.com/ru/post/137530/">get_paginate_by</a> <br>  <a href="https://habr.com/ru/post/137530/">get_allow_empty</a> <br>  <a href="https://habr.com/ru/post/137530/">get_context_object_name</a> <br>  <a href="https://habr.com/ru/post/137530/">get_object</a> <br>  <a href="https://habr.com/ru/post/137530/">get_slug_field</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Quick links to find attributes </h5><br>  <a href="https://habr.com/ru/post/137530/">paginate_by</a> <br>  <a href="https://habr.com/ru/post/137530/">paginator_class</a> <br>  <a href="https://habr.com/ru/post/137530/">allow_empty</a> <br>  <a href="https://habr.com/ru/post/137530/">context_object_name</a> <br>  <a href="https://habr.com/ru/post/137530/">object</a> <br>  <a href="https://habr.com/ru/post/137530/">slug_field</a> <br><br><h5>  Displaying a list of objects </h5><br>  Undoubtedly, this operation is required in the absolute majority of projects and, fortunately, it is provided for by the Django developers in the framework.  The methods and attributes described in the previous part, I think do not need an additional description, so I will take into account only the new ones encountered. <br><br>  In cases where it is necessary to display a huge number of objects, it is highly undesirable to display them all at the same time.  In this case, a mechanism is required for paginated data output (pagination).  The DetailView class inherits the admixture MultipleObjectMixin, which implements the functionality we need.  To determine the number of objects per page, use the method <a name="get_paginate_by"></a>  <b>get_paginate_by</b> , which by default returns an attribute value <a name="paginate_by"></a>  <b>paginate_by</b> .  With the help of the attribute, we can specify the number of objects displayed on 1 page without any special troubles. <br>  Sometimes it becomes necessary to implement paginal output in our own way, for this we can pass our pagination class to the attribute <a name="paginator_class"></a>  <b>paginator_class</b> .  By default, this attribute contains a link to the standard Paginator class, which is implemented in the django.core.paginator module.  Think twice, if you still decide to change it and check if the functionality you need is originally specified. <br>  Attribute <a name="allow_empty"></a>  <b>allow_empty</b> determines how to handle the situation when there is no object in the list.  If we set the value of this attribute to True (the default), then an empty list of objects will be returned.  If the value is False, error 404 will be returned. The value of this attribute is returned by the method <a name="get_allow_empty"></a>  <b>get_allow_empty</b> .  It can also be used if some additional verification or logic change is required. <br>  In the template, our list of objects will be available by name, which is set using the attribute <a name="context_object_name"></a>  <b>context_object_name</b> (or returned by <a name="get_context_object_name"></a>  <b>get_context_object_name</b> , discussed in the previous article).  Objects from the current page are in a variable named <a name="object_list"></a>  <b>object_list</b> .  Variable value <a name="is_paginated"></a>  <b>is_paginated</b> (boolean) determines whether our list of objects is <b>paged</b> .  For more information about the pagination system, you can find out in the <a href="https://docs.djangoproject.com/en/dev/topics/pagination/">documentation</a> . <br>  Attribute <a name="object_list"></a>  <b>object_list</b> stores a list of our objects.  It must be remembered that we must not forget to transfer the current page to our display for correct operation.  The easiest way is to use named groups in our urls.py file. <br><br><pre><code class="python hljs">url(<span class="hljs-string"><span class="hljs-string">r'^page/(?P&lt;page&gt;\d+)/$'</span></span>, PrivatePostList.as_view()),</code> </pre> <br><br>  Let's dilute the description with a small example of use: <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># coding: utf-8 from django.contrib.auth.decorators import login_required from django.utils.decorators import method_decorator from django.views.generic.list import ListView from content.models import Post class PrivatePostList(ListView): model = Post paginate_by = 10 context_object_name = 'posts' template_name = 'private_posts.html' @method_decorator(login_required) def dispatch(self, request, *args, **kwargs): """    login_required,       """ return super(PrivatePostList, self).dispatch(request, *args, **kwargs) def get_queryset(self): """             """ return Post.objects.filter(is_private=True, is_deleted=False)</span></span></code> </pre><br>  And here, approximately, this may look like in a template: <br><br><pre> <code class="html hljs xml">{% extends 'base.html' %} {% block title %}  {% endblock %} {% block content %} {% for post in object_list %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post_name"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ post.name }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post_text"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ post.text|safe }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post_info"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ post.author.username }}, {{ post.created_at|date:"dmY  H:i" }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% empty %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>   :(<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} {% if paginator.num_pages &gt; 1 %} {% if page_obj.has_previous %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/page{{ page_obj.previous_page_number }}/"</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;larr;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> {% endif %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"current_page"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ paginator.number }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> {% if page_obj.has_next %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/page{{ page_obj.next_page_number }}"</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;rarr;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> {% endif %} {% endif %} {% endblock %}</code> </pre><br><br>  I think at this stage you can finish the review of the DetailView functionality, if I missed something important, please inform me and I will add the article. <br><br><h5>  View information about an individual object </h5><br>  Now it is time to consider the functionality of the class DetailView, which is responsible for viewing a single object. <br>  To get a single object, we need to identify it by some parameter.  Usually, the so-called unique primary key (pk, id) is used for this.  Django also allows you to identify an object by the slug field, which can be any unique word.  Of course, for SEO it is sometimes more convenient to use slug, if the objects are articles or a list of users (such as here, for example, on Habr√©).  However, in other cases it makes no sense to use slug for identification (for example, viewing a comment or a personal message).  In such cases, the primary key is used. <br>  After we have chosen the method of identifying an object, we must inform Django of our choice by passing a variable with the appropriate name using the urls.py file path. <br><pre> <code class="python hljs">url(<span class="hljs-string"><span class="hljs-string">r'^post/(?P&lt;pk&gt;\d+)/$'</span></span>, PostDetail.as_view()),</code> </pre> <br>  Whatever method of identifying an object we accept, our object will be accessible using the method <a name="get_object"></a>  <b>get_object</b> .  This method alternately tries to find the variables pk and slug in the route, in this case a variable with the name pk will have a higher priority.  Using the method <a name="get_slug_field"></a>  <b>get_slug_field</b> we can override the name of the slug field of our model.  By default, this method returns an attribute value. <a name="slug_field"></a>  <b>slug_field</b>  Our object is stored in the attribute <a name="object"></a>  <b>object</b> . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.http <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Http404 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.views.generic.detail <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DetailView <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> content.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Post <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostView</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(DetailView)</span></span></span><span class="hljs-class">:</span></span> model = Post context_object_name = <span class="hljs-string"><span class="hljs-string">'post'</span></span> template_name = <span class="hljs-string"><span class="hljs-string">'private_post_detal.html'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_object</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""     404            login_required """</span></span> object = super(PostView, self).get_object() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.request.user.is_authenticated(): <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Http404 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> object</code> </pre><br><br>  At this stage, I think we can finish the consideration of the ListView and DetailView classes.  In the next article I will try to write about FormView and work with forms.  Thank you for taking the time to read.  As usual, I am open to criticism and bug reports.  I wish you all a good weekend!) </div><p>Source: <a href="https://habr.com/ru/post/137530/">https://habr.com/ru/post/137530/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137524/index.html">Installation and initial setup of ZINBA</a></li>
<li><a href="../137525/index.html">How to download Yandex.slovari only through design</a></li>
<li><a href="../137526/index.html">Consumer extremism or the desire to save when buying goods on the example of phones</a></li>
<li><a href="../137528/index.html">Chrome won first place in Russia</a></li>
<li><a href="../137529/index.html">Intel Anti-Theft Special Forces</a></li>
<li><a href="../137532/index.html">Augmented Reality Contact Lenses</a></li>
<li><a href="../137534/index.html">"One Last Thing" - a documentary about Steve Jobs (2011), professional Russian translation</a></li>
<li><a href="../137536/index.html">Writing an error handler for phpredis</a></li>
<li><a href="../137542/index.html">Minecraft Physics World</a></li>
<li><a href="../137543/index.html">Java SOAP Server with Apache CXF and Spring</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>