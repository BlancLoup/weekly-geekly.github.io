<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WDS and unattended installation of Windows 7</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, gentlemen, good! Habr in read-only mode I read for a long time, I decided to write an article here. I understand that the decision may not b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WDS and unattended installation of Windows 7</h1><div class="post__text post__text-html js-mediator-article">  Good day, gentlemen, good!  Habr in read-only mode I read for a long time, I decided to write an article here.  I understand that the decision may not be entirely correct from someone‚Äôs point of view, but for me it all works the way I wanted.  I work as a system administrator in an educational institution (GBOU SPO).  In the submission of a park of 150 cars of various configurations.  Before that, I already did a Windows XP image.  And now I have set the following task for myself - to make a unified image of the Win7 OS.  And that's how I coped with this task. <br><a name="habracut"></a><br><h4>  Start </h4><br>  We have the following: <br>  - Park of x86 architecture with various drivers; <br>  - server (also known as a domain controller) with pre-configured WDS; <br>  - a lot of software; <br>  - wsus offline update for downloading updates; <br>  - sysprep driver scanner to replace the local driver repository; <br><br>  Description of the installation and configuration of WDS, I will not give, because this good in the vast runet abound.  Here is one of them <a href="http://sergeyvasin.wordpress.com/2012/06/06/wds-install/">tyts</a> . <br>  Let's start with the installation of the OS, in this case we have Windows 7 Enterprise.  After its completion, we fill the system with software.  In my case, everything is a little easier.  The enterprise has an App-V server.  And all the necessary packages are pulled from it at the first launch.  On the final image are only a few important programs. <br><br><h5>  Generation and installation of updates </h5><br>  For this we need <a href="http://download.wsusoffline.net/">this program</a> .  After unpacking, run UpdateGenerator.exe, set the checkbox ‚ÄúWindows 7 / Server 2008r2 x86 global‚Äù and on ‚ÄúCreate Iso images, per selected product‚Äù and click ‚ÄúStart!‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/66b/8bd/3a3/66b8bd3a37b314ee16ddba0a28c6c161.png" alt="image"><br><br>  After completing the work in the iso folder, you will find your image with updates.  We mount it to our system and install it.  I want to note that the process is quite long.  When installing updates on this path - win7 creates a temporary user.  After the 1st system reboot, this account is logged in.  And in order not to be distracted once again for all this good - extract the image to any folder and run UpdateInstaller.exe.  Check ‚ÄúAutomatic reboot and recall‚Äù.  By pressing the "START" button you can safely go to drink tea. <br><br><h5>  Driver substitution </h5><br>  Everything is very simple.  From the <a href="http://driverpacks.net/">driverpacks.net</a> website <a href="http://driverpacks.net/">,</a> we download the necessary driver packages.  You can do in two ways.  Choose the whole packages you need, or choose specific drivers for your needs.  The price of the question is the size of the final image. <br>  After we received the driver - create a folder on the disk and unzip them there.  Next, download <a href="">this</a> and launch it.  Next - we prescribe the path to our folder with firewood.  Click alternately "scan", "default", "save", "done".  Everything, now when installing the driver will be searched in this directory.  Theoretically, you can put several driver scan points.  Ie, locally, we will look for drivers on the NIC, and everything else will drag on the network balls.  But I did not try it, only now I thought it up. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cd7/79c/66d/cd779c66d05d72552eba68f642841c55.png" alt="image"><br><br><h5>  Sealing and removing the profile </h5><br>  Since we will make an answer file - the following will be the best way to seal the OS.  When running sysprep.exe, select ‚ÄúSwitch to audit mode‚Äù.  After the reboot, remove the profile from which you installed the system, also check the folder C: \ Users for the presence of tails. <br>  Then - just call sysprep, but now choose ‚ÄúSwitch to the system's welcome window (OOBE)‚Äù and ‚ÄúShut down‚Äù.  After the work is finished, your PC will turn off and it will be ready to capture the image. <br><br><h5>  Create Answer File </h5><br>  Here I better provide you with a link to the source.  It describes the process of creating an answer file for both the installation image and the OS image itself. <br>  <a href="http://sergeyvasin.wordpress.com/2012/07/28/wds-answerfiles/">tyts</a> <br><br><h4>  the end </h4><br>  After all these actions, we have an automatic installation of the OS at 80%.  Why?  Because in my case, the choice of image, disk layout and input to the domain remained manual.  Some points could be replaced, for example, to put a full-fledged WSUS service on the server.  WDS could be supplemented with MDT, or deployed System Center Configuration Manager.  But I went this way.  Thank you for your attention, criticism welcome! <habracut></habracut></div><p>Source: <a href="https://habr.com/ru/post/207646/">https://habr.com/ru/post/207646/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../207628/index.html">Protection against DoS / DDoS attacks using autonomous system number (ASN) filtering</a></li>
<li><a href="../207636/index.html">We start the mobile direction in the company: what to prepare for and how to live</a></li>
<li><a href="../207638/index.html">Hints: API for entering email addresses and full name in one line</a></li>
<li><a href="../207640/index.html">Cost of servicing the regional component of EGISZ from Rostelecom</a></li>
<li><a href="../207644/index.html">10 facts about Python Meetup</a></li>
<li><a href="../207648/index.html">Let the computer make the decision or write the AI ‚Äã‚Äãto play together.</a></li>
<li><a href="../207650/index.html">Jekyll Practical Guide</a></li>
<li><a href="../207652/index.html">Team Programming Psychology</a></li>
<li><a href="../207654/index.html">Trivial encryption in malicious files</a></li>
<li><a href="../207656/index.html">Color alphabet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>