<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Listening Ukrainian mobile phones: how it is done and how to protect</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="You‚Äôve read more than once in news feeds about how secret services of different countries monitor negotiations and data transmission of ordinary citiz...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Listening Ukrainian mobile phones: how it is done and how to protect</h1><div class="post__text post__text-html js-mediator-article">  You‚Äôve read more than once in news feeds about how secret services of different countries monitor negotiations and data transmission of ordinary citizens.  Now the new scandal with the tapping of Ukrainian subscribers, allegedly carried out from the territory of Russia, is gaining momentum. <br><br>  We have already written about what threats exist in the world of mobile communications, and today we want to tell you again about one of the vectors of attacks aimed at mobile subscribers. <br><br>  In short, the scheme is as follows.  The attacker enters the SS7 signaling network, the channels of which send a service message Send Routing Info For SM (SRI4SM), specifying the telephone number of the attacked subscriber A as a parameter. In response, the home network of the subscriber A sends the technical information to the attacker: IMSI (international subscriber ID) and the address of the MSC switch that currently serves the subscriber. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/4cf/0cb/afe/4cf0cbafea2620a5687dc8480a07dcde.png" alt="image"><br><br>  Then, the attacker, using the Insert Subscriber Data (ISD) message, injects the updated subscriber profile into the VLR database, changing the address of the billing system in it to the address of its own, pseudobilling system. <a name="habracut"></a><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b57/638/ddc/b57638ddc625e14a95b467a93f923e1d.png" alt="image"><br><br>  Then, when the attacked subscriber makes an outgoing call, his switch addresses, instead of the actual billing system, the attacker's system, which gives the switch a directive to redirect the call to a third party, again controlled by the attacker. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/319/93f/960/31993f9602ff70b4368769aa9ae8e6d4.png" alt="image"><br><br>  On this third party, a conference call is organized from three subscribers, two of which are real (caller A and called B), and the third is introduced by the attacker unauthorized and has the ability to listen and record the conversation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ef6/231/151/ef623115102c0b31128c00c5467176c8.png" alt="image"><br><br>  I will tell the skeptics right away: this scheme is not fantastic and, as you can see, it is completely realizable in practice.  When developing the SS7 signaling system, there were no defense mechanisms against such attacks.  The implication was that the SS7 network itself was rather closed, and the ‚Äúalien‚Äù could not get there.  However, times are changing, and we are witnessing the malicious use of telephony technology.  Unfortunately, it is impossible to just and enable filtering SS7 messages from external networks, as this will affect the performance of services in roaming.  And no operator wants to deprive themselves of income. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/265/789/0aa/2657890aa9b2f0157ee3175a8f903726.png" alt="image"><br><br>  In the work of an operator providing services to a large number of subscribers, there is always a fine line between information security and the availability of services.  This is especially acute for mobile operators: the range of services is huge, it is different for all operators, and we want to serve not only our own, but also foreign subscribers in our network, and that our subscribers are not limited in opportunities while traveling abroad. <br><br><h4>  What to do </h4><br>  It would not be bad to close the so-called ‚Äúvulnerabilities‚Äù in the SS7 protocol stack, but any specialist will tell you that this is unrealistic.  The classic case of "this is not a bug, this is a feature." <br><br>  Instead of philosophizing about the architecture of mobile networks, you need to act.  For example, do the following: <br><br><ol><li>  Perform SS7 penetration testing. </li><li>  At the same time organize monitoring of signaling messages on the perimeter of the operator‚Äôs network by all available means. </li><li>  Analyze the information received and take measures to minimize risks. </li></ol><br><h4>  Penetration tests </h4><br>  A little about the benefits of penetration tests.  In the operator's network, their role is not only in identifying vulnerabilities, but also in solving operational problems.  For example, to understand what the inclusion of one or another security function may affect, you need to carry out many tests taking into account the characteristics of each network.  When conducting our SS7 signaling tests, we take into account 10 main types of attacks on the network and mobile subscribers. <br><br><ol><li>  Check for disclosure of confidential technical parameters: IMSI subscriber;  the address of the MSC switch where the subscriber is registered;  HLR DB address where the subscriber's profile is stored.  Knowing these parameters, the attacker will be able to conduct more complex attacks. </li><li>  Check for disclosure of cell data serving the subscriber.  Knowing the cell ID, an attacker can locate the subscriber.  In terms of urban coverage, the location of the subscriber can be determined with an accuracy of <a href="http://habrahabr.ru/company/pt/blog/191384/">tens of meters</a> . </li><li>  Check for the possibility of violation of subscriber availability for incoming calls (DoS per subscriber)  In the case of a successful attack, the victim subscriber stops receiving incoming calls and SMS.  In this case, the mobile device of the victim shows the presence of the network.  This state of the victim subscriber will last until the subscriber makes an outgoing call, moves into the range of another switch or restarts the phone. </li><li>  Check for the disclosure of private SMS-correspondence.  This attack is a consequence of attack number 3. In the event of a successful attack, incoming SMS start to arrive at the attacker's equipment, it will not be difficult to read them.  To ensure that SMS is not delivered to the recipient afterwards, a notification of receipt is sent to the SMS center. </li><li>  Checking the manipulation of USSD commands.  In the case of a successful attack, the attacker is able to send USSD commands on behalf of the subscriber.  Possible damage will be determined by a set of services provided by the operator for USSD (for example, whether it is possible to transfer funds between subscriber accounts using USSD commands). </li><li>  Check the possibility of substitution of the subscriber profile in the VLR.  In the case of a successful attack, an attacker gets the opportunity to use his equipment as an intelligent platform to expand the capabilities of voice calls and tariffication manipulations. </li><li>  Check for the possibility of redirecting outgoing calls.  It is a continuation of the attack. 6. In the event of a successful attack, the attacker is able to redirect the outgoing voice calls of the victim subscriber.  In addition, the attack allows the attacker to arrange a conference call, unauthorized "wedged" in the conversation. </li><li>  Check for the possibility of redirecting incoming calls.  In the case of a successful attack, the attacker gets the opportunity to redirect incoming voice calls intended to the victim subscriber.  In addition, calls to destinations with high rates may either not be charged, or the call charge will be charged to the victim subscriber. </li><li>  Check the resistance of the switch to a DoS attack.  In the case of a successful attack, the switch stops processing incoming calls to subscribers who are within its range. </li><li>  Checking the possibility of direct manipulations with billing.  In the event of a successful attack, the attacker gets the possibility of emptying the personal account, thus depriving the subscriber of the ability to make calls. </li></ol><br><h4>  How to protect </h4><br>  Our research has shown that the overwhelming majority of attacks on SS7 networks begin with the receipt of technical data about the subscriber (IMSI identifier, MSC switch addresses and HLR databases).  These parameters are obtained from the response to the very message SRI4SM, which is mentioned at the beginning of the article. <br><br>  One of the security solutions is the SMS Home Routing procedure proposed by the 3GPP organization in 2007.  Sometimes it is called SMS Firewall or SMS filter. <br><br>  An additional node is introduced into the operator's network, providing filtering of malicious messages SRI4SM.  The principle of its work is as follows.  When the SRI4SM message from another network arrives at the operator‚Äôs network, it is rerouted to the new filtering node.  This node sends a normal response, giving the address of the MSC switch and the HLR database its address, and the subscriber‚Äôs IMSI giving fake data.  If the SRI4SM message was generated by an attacker, then he will not receive any useful information in the response, and his attack will drown in the first stage.  If the SRI4SM message was the beginning of a legal transaction for sending an SMS message, the sender's network will transmit this SMS message to the filtering node, and he, in turn, will deliver the message to the addressee within his home network. <br><br>  7 years have passed since the issuance of this recommendation, but, as we see, far from all operators have launched such a solution.  And by the way, the SRI4SM message is not the only way to get an IMSI subscriber. <br><br><h4>  Instead of conclusion </h4><br>  The network of the mobile operator, like any other, is potentially vulnerable.  Due to the specificity of mobile networks, attacks in them may be more sophisticated than attacks on the Internet.  We recommend taking measures to protect such networks in accordance with the traditional scenario: pentest with the identification of problem areas, security audits with the installation of recommended settings, periodically checking the security settings in accordance with the template.  This is the minimum amount of work that will help raise the level of network security just above the plinth, but this is enough as a first step.  Subscribers will sleep better. <br><br>  PS During the <a href="http://www.phdays.ru/">Positive Hack Days IV</a> forum, we made a report on possible attacks in the networks of mobile operators, in which we heard wiretapping of telephone conversations from almost anywhere in the world. <br><br><div class="slideshow"><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=http://www.slideshare.net/slideshow/embed_code/35162151&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhhnLgW5HOsCN2DDWLP0WdBhQWjoZg" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></div><br>  Video: <a href="http://live.digitaloctober.ru/embed/2990">live.digitaloctober.ru/embed/2990#time1400670335</a> <br><br>  PPS In the comments abstract, please, from political preferences, so that this post does not provoke holivar, of which there is plenty on the Internet now.  The technical article is devoted to information security, not related to the nationality, country of residence, religion or gender of the reader. <br><br>  <b>Authors:</b> Sergey Puzankov and Dmitry Kurbatov, Research Center Positive Research. </div><p>Source: <a href="https://habr.com/ru/post/226977/">https://habr.com/ru/post/226977/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../226967/index.html">On the prerequisites of the socialist revolution in copyright</a></li>
<li><a href="../226969/index.html">Each by Landing Page. Sore</a></li>
<li><a href="../226971/index.html">Safe and smart web server on debian 7</a></li>
<li><a href="../226973/index.html">Live debian</a></li>
<li><a href="../226975/index.html">"Correct" speed limit in nginx. Myth or reality?</a></li>
<li><a href="../226979/index.html">Google Web Starter Kit: Mobile Website Builder</a></li>
<li><a href="../226981/index.html">"Dauria" in space</a></li>
<li><a href="../226983/index.html">A simple way to monitor the response time of Sphinx indexes using Zabbix</a></li>
<li><a href="../226985/index.html">"Epson Printing Factory" and a laser printer: break stereotypes</a></li>
<li><a href="../226987/index.html">Unity3D - writing plugins for Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>