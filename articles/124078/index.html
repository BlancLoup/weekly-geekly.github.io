<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a dynamic proxy object using the dynamic type</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Like many people who are faced with the task of writing the next UI for my application, I occasionally encounter the need to create my own model for t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a dynamic proxy object using the dynamic type</h1><div class="post__text post__text-html js-mediator-article">  Like many people who are faced with the task of writing the next UI for my application, I occasionally encounter the need to create my own model for the UI, which to some extent repeats the domain model, but at the same time expands and / or changes it.  And that's what came of it. <br><a name="habracut"></a><br><h4>  Formulation of the problem </h4><br>  For example, we have a Region class of such a structure. <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> Region { <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">int</font> Index { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;Region&gt; SubRegions { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Region { <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">int</font> Index { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;Region&gt; SubRegions { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Region { <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">int</font> Index { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;Region&gt; SubRegions { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Region { <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">int</font> Index { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;Region&gt; SubRegions { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Region { <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">int</font> Index { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;Region&gt; SubRegions { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Region { <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">int</font> Index { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;Region&gt; SubRegions { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Region { <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">int</font> Index { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;Region&gt; SubRegions { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> Region { <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">int</font> Index { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;Region&gt; SubRegions { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } }</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  And there is a task to show the user in the UI tree of regions, built on this model, as well as give the opportunity to select specific regions that are subject to some further processing.  If we make our UI according to MVVM architecture, then it is obvious that we will need to create a class of the <b>RegionViewModel</b> type, with a structure similar to the <b>Region</b> class, but with the additional <b>IsSelected</b> property.  In addition, it would be convenient if the <b>RegionViewModel's SubRegions</b> property returned an enumerator of type <b>IEnumerable &lt;RegionViewModel&gt;</b> , then all the UI code would be reduced to creating a <b>TreeView</b> <b>bindig</b> on the <b>RegionViewModel</b> list and getting all <b>RegionViewModel properties</b> that have the <b>IsSelected</b> property <b>true</b> .  And what's the problem?  The problem is that most of the code of the <b>RegionViewModel</b> class will be data forwarding to the <b>Region</b> class, which it wraps around.  Of course, such an implementation is possible, somewhat simplifying life: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> RegionViewModel </li><li>  { </li><li>  <font color="#0000ff">public</font> Region Value { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;  } </li><li>  <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;RegionViewModel&gt; SubRegions { <font color="#0000ff">get</font> { <font color="#008000">/*...*/</font> }} </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  But it also requires us to implement the <b>SubRegions</b> property with our hands.  And if the <b>Region</b> does not implement <b>INotifyPropertyChanged</b> , then most likely we will have to manually describe each property, adding a call to the corresponding event to the value setting. <br>  If a task similar to the one described above occurs quite often, then writing a model-view with my hands each time can be tiring.  Therefore, I asked myself the question of automating this process and this is what happened. <br><br><h4>  Possible solutions </h4><br>  If you look closely, it becomes clear that our task is to create a certain proxy generator that creates a proxy for a given class and complements it with some aspects, such as <b>INotifyPropertyChanged</b> , or / and adds new properties, methods, etc.  What does the .net stack offer us to create proxies? <br><br>  We can distinguish the following solutions <br><ul><li>  <a href="http://www.castleproject.org/dynamicproxy/index.html">DynamicProxy</a> by Castle </li><li>  <a href="http://msdn.microsoft.com/en-us/library/system.runtime.remoting.proxies.realproxy.aspx">RealProxy</a> from MS </li><li>  <a href="http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx">T4 based</a> code generation </li><li>  create something based on code instrumentation using <a href="http://www.sharpcrafters.com/">PostSharp</a> . </li><li>  Use the new one that appeared in C # 4.0 </li></ul><br>  I chose the 5th option, because  <b>RealProxy</b> will require intervention in the model classes themselves, the proxy from the castl will allow intercepting only virtual members of the class, postsharp costs money, and I just don‚Äôt like code generation for religious reasons.  Besides creating your own bike is always more interesting. <br><h4>  Implementation </h4><br>  And so, the main idea concludes as follows - we describe a class that inherits from the type DynamicObject and overrides <b>TryInvokeMember</b> , <b>TrySetMember</b> and <b>TryGetMember</b> . <br>  for example <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">bool</font> TryInvokeMember (InvokeMemberBinder binder, <font color="#0000ff">object</font> [] args, <font color="#0000ff">out</font> <font color="#0000ff">object</font> result) </li><li>  { </li><li>  result = _methods.ContainsKey (binder.Name)?  _methods [binder.Name] .DynamicInvoke ( <font color="#0000ff">new</font> [] { <font color="#0000ff">this</font> } .Concat (args) .ToArray ()): InvokeNativeMethod (binder.Name, args); </li><li></li><li>  result = GetResult (result); </li><li></li><li>  <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Affairs so that he took at the entrance of the desired object, and when you try to call a member of a class, prokidyval call to this object.  Add to this the ability to add new methods and property.  For the construction of the object we will use the pillar Fluent builder. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The proxy class code itself turned out to be quite large (about 280 lines), so those who want to see it can download the source code and all the examples from the link at the bottom of the post.  Here I will give examples of use. <br><br><h4>  Adding properties </h4><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">private</font> <font color="#0000ff">class</font> MyClass </li><li>  { </li><li>  MyClass _i; </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;  } </li><li>  <font color="#0000ff">public</font> MyClass Foo () </li><li>  { </li><li>  <font color="#0000ff">return</font> _i ??  (_i = <font color="#0000ff">new</font> MyClass {Name = <font color="#A31515">"_sdfdsfsdfsfd"</font> }); </li><li>  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;MyClass&gt; GetChilds () </li><li>  { </li><li>  <font color="#0000ff">yield</font> <font color="#0000ff">return</font> <font color="#0000ff">new</font> MyClass (); </li><li>  <font color="#0000ff">yield</font> <font color="#0000ff">return</font> <font color="#0000ff">new</font> MyClass (); </li><li>  } </li><li>  } </li><li></li><li>  [TestMethod] </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> TestAddProperties () </li><li>  { </li><li>  <font color="#0000ff">var</font> a = <font color="#0000ff">new</font> MyClass {Name = <font color="#A31515">"123"</font> }; </li><li></li><li>  Assert.AreEqual ( <font color="#A31515">"123"</font> , a.Name); </li><li>  dynamic proxy = DynamicProxy.Create (a) .AddProperty &lt; <font color="#0000ff">bool</font> &gt; ( <font color="#A31515">"IsSelected"</font> ) </li><li>  .AddProperty ( <font color="#A31515">"X"</font> , _ =&gt; x, (_, <font color="#0000ff">value</font> ) =&gt; x = <font color="#0000ff">value</font> ) </li><li>  .AddProperty ( <font color="#A31515">"LastName"</font> , <font color="#A31515">"FFFF"</font> ) </li><li></li><li></li><li>  proxy.Name = <font color="#A31515">"567"</font> ; </li><li>  proxy.IsSelected = <font color="#0000ff">true</font> ; </li><li>  proxy.X = 42; </li><li></li><li>  Assert.AreEqual ( <font color="#A31515">"567"</font> , a.Name); </li><li>  Assert.IsTrue (proxy.IsSelected); </li><li>  Assert.AreEqual (42, x); </li><li></li><li>  proxy.IsSelected = <font color="#0000ff">false</font> ; </li><li></li><li>  Assert.IsFalse (proxy.IsSelected); </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><h4>  Auto-create proxies for function and property values. </h4><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  [TestMethod] </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> TestChilds () </li><li>  { </li><li>  <font color="#0000ff">var</font> a = <font color="#0000ff">new</font> MyClass {Name = <font color="#A31515">"123"</font> }; </li><li></li><li>  Assert.AreEqual ( <font color="#A31515">"123"</font> , a.Name); </li><li>  Assert.AreEqual ( <font color="#A31515">"_sdfdsfsdfsfd"</font> , a.Foo (). Name); </li><li></li><li>  <font color="#0000ff">var</font> x = 0; </li><li></li><li>  dynamic proxy = DynamicProxy.Create (a) .AddProperty &lt; <font color="#0000ff">bool</font> &gt; ( <font color="#A31515">"IsSelected"</font> ) </li><li>  .AddProperty ( <font color="#A31515">"X"</font> , _ =&gt; x, (_, <font color="#0000ff">value</font> ) =&gt; x = <font color="#0000ff">value</font> ) </li><li>  .AddProperty ( <font color="#A31515">"LastName"</font> , <font color="#A31515">"FFFF"</font> ) </li><li>  .AddMethod ( <font color="#A31515">"Boo"</font> , <font color="#0000ff">new</font> Func &lt;DynamicProxy &lt;MyClass&gt;, <font color="#0000ff">int</font> , <font color="#0000ff">string</font> &gt; ((m, i) =&gt; ((MyClass) m) .Name + i.ToString ()))); </li><li></li><li></li><li>  proxy.Name = <font color="#A31515">"567"</font> ; </li><li>  proxy.IsSelected = <font color="#0000ff">true</font> ; </li><li>  proxy.X = 42; </li><li>  <font color="#0000ff">var</font> b = proxy.Foo (); </li><li>  b.IsSelected = <font color="#0000ff">true</font> ; </li><li></li><li>  Assert.AreEqual ( <font color="#A31515">"567"</font> , a.Name); </li><li>  Assert.AreEqual ( <font color="#A31515">"5674"</font> , proxy.Boo (4)); </li><li>  Assert.IsTrue (proxy.IsSelected); </li><li>  Assert.AreEqual (42, x); </li><li>  Assert.IsTrue (b.IsSelected); </li><li></li><li>  b.IsSelected = <font color="#0000ff">false</font> ; </li><li></li><li>  Assert.IsTrue (proxy.IsSelected); </li><li>  Assert.IsFalse (b.IsSelected); </li><li></li><li>  proxy.LastName = <font color="#A31515">"890"</font> ; </li><li>  <font color="#0000ff">var</font> d = proxy.Foo (); </li><li>  Assert.AreEqual ( <font color="#A31515">"FFFF"</font> , d.LastName); </li><li></li><li>  <font color="#0000ff">var</font> d2 = proxy.Foo (); </li><li>  d2.LastName = <font color="#A31515">"RRRRR"</font> ; </li><li></li><li>  Assert.AreEqual ( <font color="#A31515">"567"</font> , Foo (proxy)); </li><li></li><li>  Assert.AreEqual (d.LastName, d2.LastName); </li><li></li><li>  <font color="#008000">// It is possible <s>to rob the cows</s> to do an impassable caste</font> </li><li></li><li>  <font color="#0000ff">var</font> c = (MyClass) proxy; </li><li></li><li>  Assert.AreEqual ( <font color="#A31515">"567"</font> , c.Name); </li><li></li><li>  <font color="#0000ff">foreach</font> ( <font color="#0000ff">var</font> child <font color="#0000ff">in</font> proxy.GetChilds ()) </li><li>  { </li><li>  child.IsSelected = <font color="#0000ff">true</font> ; </li><li>  Assert.IsTrue (child.IsSelected); </li><li>  } </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Automatic implementation of <b>INotifyPropertyChanged is</b> also done <b>.</b> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  [TestMethod] </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> TestPropertyChange () </li><li>  { </li><li>  <font color="#0000ff">var</font> myClass = <font color="#0000ff">new</font> MyClass (); </li><li>  <font color="#0000ff">var</font> propertyName = <font color="#0000ff">string</font> .Empty; </li><li>  dynamic proxy = DynamicProxy.Create (myClass); </li><li></li><li>  ((INotifyPropertyChanged) proxy). PropertyChanged + = (s, a) =&gt; propertyName = a.PropertyName; </li><li></li><li>  proxy.Name = <font color="#A31515">"aaaa"</font> ; </li><li></li><li>  Assert.AreEqual ( <font color="#A31515">"Name"</font> , propertyName); </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><h4>  Practical use </h4><br>  Let's try using this proxy to solve the problem described in the beginning of the article.  To simplify this, we will generate a small tree of regions, let the user select the necessary ones and show the list of selected ones on the right.  Actually, this is how the window code is used. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> MainWindow () </li><li>  { </li><li>  Initializecomponent (); </li><li>  DataContext = <font color="#0000ff">this</font> ; </li><li>  Items = <font color="#0000ff">new</font> [] {DynamicProxy.Create (CreateRegions (). First ()). AddProperty &lt; <font color="#0000ff">bool</font> &gt; ( <font color="#A31515">"IsSelected"</font> )}; </li><li>  } </li><li></li><li>  <font color="#2B91AF">IEnumerable</font> &lt;Region&gt; GetSelectedItems ( <font color="#2B91AF">IEnumerable</font> &lt;dynamic&gt; items) </li><li>  { </li><li>  <font color="#0000ff">Return</font> items.Where (x =&gt; x.IsSelected) .Concat (items.SelectMany (x =&gt; GetSelectedItems (( <font color="#2B91AF">IEnumerable</font> &lt;dynamic&gt;) x.SubRegions))). Select (x =&gt; (Region) x); </li><li>  } </li><li></li><li>  <font color="#0000ff">private</font> <font color="#0000ff">void</font> ButtonClick ( <font color="#0000ff">object</font> sender, RoutedEventArgs e) </li><li>  { </li><li>  <font color="#0000ff">var</font> res = GetSelectedItems (Items) .Take (10) .ToList (); </li><li>  SelectedItems = res; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  And xaml to him <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Window</font> <font color="#ff0000">x: Class</font> <font color="#0000ff">= "WpfApplication1.MainWindow"</font> </li><li>  <font color="#ff0000">xmlns</font> <font color="#0000ff">= "http://schemas.microsoft.com/winfx/2006/xaml/presentation"</font> </li><li>  <font color="#ff0000">xmlns: x</font> <font color="#0000ff">= "http://schemas.microsoft.com/winfx/2006/xaml"</font> <font color="#ff0000">xmlns: WpfApplication1</font> <font color="#0000ff">= "clr-namespace: WpfApplication1"</font> </li><li>  <font color="#ff0000">Title</font> <font color="#0000ff">= "MainWindow"</font> <font color="#ff0000">Height</font> <font color="#0000ff">= "350"</font> <font color="#ff0000">Width</font> <font color="#0000ff">= "525"</font> <font color="#0000ff">&gt;</font> </li><li></li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> </li><li></li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">DataTemplate</font> <font color="#ff0000">DataType</font> <font color="#0000ff">= "{x: Type WpfApplication1: Region}"</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">WrapPanel</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">TextBlock</font> <font color="#ff0000">Text</font> <font color="#0000ff">= "{Binding Path = Name, StringFormat = '{} {0},'}"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">TextBlock</font> <font color="#ff0000">Text</font> <font color="#0000ff">= "{Binding Path = Index}"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">WrapPanel</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">DataTemplate</font> <font color="#0000ff">&gt;</font> </li><li></li><li></li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Grid.ColumnDefinitions</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">ColumnDefinition</font> <font color="#ff0000">Width</font> <font color="#0000ff">= "*"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">ColumnDefinition</font> <font color="#ff0000">Width</font> <font color="#0000ff">= "auto"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">ColumnDefinition</font> <font color="#ff0000">Width</font> <font color="#0000ff">= "*"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Grid.ColumnDefinitions</font> <font color="#0000ff">&gt;</font> </li><li></li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">TreeView</font> <font color="#ff0000">Grid</font> .  <font color="#ff0000">Column</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">ItemsSource</font> <font color="#0000ff">= "{Binding Items}"</font> <font color="#ff0000">BorderThickness</font> <font color="#0000ff">= "0"</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">TreeView.ItemTemplate</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">HierarchicalDataTemplate</font> <font color="#ff0000">ItemsSource</font> <font color="#0000ff">= "{Binding SubRegions}"</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">CheckBox</font> <font color="#ff0000">IsChecked</font> <font color="#0000ff">= "{Binding IsSelected, Mode = TwoWay}"</font> <font color="#ff0000">Content</font> <font color="#0000ff">= "{Binding Value}"</font> <font color="#0000ff">/&gt;</font> </li><li></li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">HierarchicalDataTemplate</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">TreeView.ItemTemplate</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">TreeView</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Button</font> <font color="#ff0000">Content</font> <font color="#0000ff">= "Show selected"</font> <font color="#ff0000">VerticalAlignment</font> <font color="#0000ff">= "Center"</font> <font color="#ff0000">Grid</font> .  <font color="#ff0000">Column</font> <font color="#0000ff">= "1"</font> <font color="#ff0000">Click</font> <font color="#0000ff">= "ButtonClick"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">ListBox</font> <font color="#ff0000">Grid</font> .  <font color="#ff0000">Column</font> <font color="#0000ff">= "2"</font> <font color="#ff0000">ItemsSource</font> <font color="#0000ff">= "{Binding SelectedItems}"</font> <font color="#ff0000">BorderThickness</font> <font color="#0000ff">= "0"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Window</font> <font color="#0000ff">&gt;</font> </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br><h4>  Application screenshot </h4><br><img src="http://lh6.googleusercontent.com/-Ris9P7RsQl0/Thnmta-rAiI/AAAAAAAAC7E/n8ngjgLtYzw/app.png" alt="image"><br><br><h4>  Links </h4><br><ol><li>  <a href="http://code.google.com/p/dynamicproxy-net/">Project sources</a> </li><li>  <a href="http://code.google.com/p/dynamicproxy-net/downloads/detail%3Fname%3DExample.zip">Compiled binaries</a> </li><li>  <a href="http://msdn.microsoft.com/en-us/library/system.dynamic.dynamicobject.aspx">DynamicObject</a> </li><li>  <a href="http://en.wikipedia.org/wiki/Model_View_ViewModel">MVVM</a> </li><li>  <a href="http://ru.wikipedia.org/wiki/Fluent_interface">Fluent interface</a> </li></ol><br>  Thanks for attention. <br></div><p>Source: <a href="https://habr.com/ru/post/124078/">https://habr.com/ru/post/124078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../124070/index.html">Video review of the updated Android Market</a></li>
<li><a href="../124071/index.html">Using the Yandex.Metrika API to display statistics</a></li>
<li><a href="../124074/index.html">QAForum2011 - teaching in battle or TeamLab as Pavlov's dog</a></li>
<li><a href="../124075/index.html">Connecting a GPS receiver to a laptop and creating a GPS tracker</a></li>
<li><a href="../124077/index.html">We connect AdMob advertising in Marmalade (extension for Android OS)</a></li>
<li><a href="../124079/index.html">Graph Export to Microsoft Excel</a></li>
<li><a href="../124080/index.html">Protection from unauthorized copying applications Blackberry PlayBook</a></li>
<li><a href="../124082/index.html">Installing SMS Linux (Slackware) on eBox-2300SX</a></li>
<li><a href="../124086/index.html">Chinese iPad 3</a></li>
<li><a href="../124088/index.html">QIWI Wallet no longer works with VKontakte rubles (earned again 07/19/11)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>