<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MultiWAN on the DIR-320</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many of my friends who work on the network, complain about their provider. As practice shows, it does not depend on the provider. Crashes happen to ev...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MultiWAN on the DIR-320</h1><div class="post__text post__text-html js-mediator-article">  Many of my friends who work on the network, complain about their provider.  As practice shows, it does not depend on the provider.  Crashes happen to everyone and they happen at the most inopportune moment.  Personally, I always wondered why not to connect several providers at once?  With modern prices on the Internet.  When I decided to connect the backup channel myself, I ran into a problem.  How to distribute Internet at home with minimal financial investment? <br><br>  I have long wanted to use the DIR-320, because it can be authorized in the network of my first provider using the 802.1X protocol with the new firmware.  In addition, you can upload dd-wrt firmware or ‚Äúfirmware from Oleg‚Äù, which are essentially based on Linux.  Perhaps with their help it will be possible to make 2 from 1 WAN port by default?  It turned out possible. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/94b/b2e/450/94bb2e450eb0007ba19974100e890e4f.jpg" alt="image"><br><a name="habracut"></a>  Solution under the cut. <habracut>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  1. Change the firmware </h4><br>  First you need to fill the firmware.  I chose the firmware from Oleg.  Firmware from Oleg in principle for ASUS WL-500.  This router is an analogue of the Asus WL-500gP V2 router with a reduced memory from 8 MB to 4 MB and without a second USB port.  The router is based on the BCM5354 processor, the RAM size is 32 MB, flash is 4 megabytes, 1 USB port, 1 internal COM port.  The price of this router is less than Asus routers with the same functionality.  We take the firmware here: <a href="http://code.google.com/p/wl500g/downloads/list%3Fcan%3D2%26q%3Dwl-500gpv2">http://code.google.com/p/wl500g/downloads/list?can=2&amp;q=wl-500gpv2</a> .  Choose WL500gpv2-1.9.2.7-d-r2624.trx because the other one is larger and simply does not fit into the DIR.  In Windows 7, we enable the tftp client: Start-&gt; Control Panel-&gt; Programs-&gt; Enable or Disable Windows Components-&gt; Put a check mark next to "TFTP Client" -&gt; OK.  For Linux, install the tftp client using the standard distribution tools, for example, for the Ubuntu family using the command in the terminal: <br><br> <code>sudo apt-get install tftp</code> <br> <br>  We create the flashing.cmd file in any text editor and save this file in the c: \ bin folder, in the same folder we put the firmware, renamed firmware.bin.  Content flashing.cmd: <br><br> <code>@Echo Off <br> :BEGIN <br> ping -n 1 -w 1 192.168.0.1 <br> If errorlevel 1 Goto BEGIN <br> If errorlevel 0 Goto FLASH <br> Goto END <br> <br> :FLASH <br> Echo *** Start Flashing **** <br> tftp -i 192.168.0.1 put c:\bin\firmware.bin <br> <br> :END</code> <br> <br>  Set the address of the computer network card 192.168.0.2, mask 255.255.255.0, the gateway and DNS do not need to be registered.  We connect a network cable to the network card of the computer, and plug the other end of the network cable into any router's LAN port; we do not turn on the power of the router.  Run the command line START-&gt; Run-&gt; cmd, and execute the command to go to the C \ folder: bin <br><br> <code>C:\&gt;cd c:\bin</code> <br> <br>  Press and hold the Reset button with a well-pressed match, turn on the power of the router, all indicators will light up and as soon as they turn off the indicators, except the indicator of the LAN port to which the cable is connected, release the Reset button and immediately execute the previously typed command in the previously launched command line : <br><br> <code>C:\bin&gt;flashing.cmd</code> <br> <br>  Observe the process of firmware. <br><br> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code></code> <h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code></code> </h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> <h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> </h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> <h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> </h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> <h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> </h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> <h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> </h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> <h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> </h4> <code><code>   192.168.0.1  32 : <br> <br>     . <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 0,  = 1 (100% ), <br> &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; &lt;&lt;&gt;&gt; <br>    192.168.0.1  32 : <br> <br>   192.168.0.1:  =32 =4 TTL=100 <br> <br>  Ping  192.168.0.1: <br> :  = 1,  = 1,  = 0 (0% ), <br>   -  : <br>  = 4,  = 4 ,  = 4  <br> *** Start Flashing **** <br>  : 3592480   11 s, 281134 / <br> C:\bin&gt; <br> <br>  ,     (~1-2 )      .       Reset ,     .  Reset.  .        192.168.1.1.     IP    (   WiFi)      DHCP. <br> <br> 2.   WAN <br>  WAN,        vlan1,    vlan0.   1    LAN   vlan2. <br> <br> nvram set vlan0ports="2 3 4 5*" <br> nvram set vlan2ports="1 5" <br> nvram set vlan2hwname=et0 <br> nvram set wan1_ifname=vlan1 <br> nvram set wan2_ifname=vlan2 <br> nvram commit <br> reboot</code> <br> <br>      WAN. <br> <br> 3.  1 WAN <br>  WAN   PPPoE.     .     .    ,   WAN.        . <br> <br> <code>vi /tmp/local/root/options.wan0</code> <br> <br>   i  : <br> <br> <code>noauth refuse-eap <br> user 'Login_PPPoE' <br> password 'Pass_PPPoE' <br> nomppe nomppc <br> plugin rp-pppoe.so nic-vlan1 <br> mru 1492 mtu 1492 <br> maxfail 0 <br> usepeerdns <br> persist <br> ipcp-accept-remote ipcp-accept-local noipdefault <br> ktune <br> default-asyncmap nopcomp noaccomp <br> novj nobsdcomp nodeflate <br> lcp-echo-interval 10 <br> lcp-echo-failure 6 <br> unit 0</code> <br> <br>      Esc   :wq (, w, q).  Login_PPPoE  Pass_PPPoE       .   : <br> <br> <code>pppd file /tmp/local/root/options.wan0 &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1</code> <br> <br>    ifconfig. <br> <br> 4.  2 WAN <br>   ,   WAN  802.1x .     wpa_supplicant    roboswitch.    3 ,      .     : <br> <br> <code><a href=""></a> wgt wl500g.googlecode.com/files/wpa_supplicant-0.6.9-mipsel.tgz -P /tmp/local/tmp/ <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/bin/wpa_supplicant.sh &gt; /tmp/local/bin/wpa_supplicant.sh <br> chmod +x /tmp/local/bin/wpa_supplicant.sh <br> tar -xzf /tmp/local/tmp/wpa_supplicant-0.6.9-mipsel.tgz -O opt/sbin/wpa_supplicant &gt; /tmp/local/sbin/wpa_supplicant <br> chmod +x /tmp/local/sbin/wpa_supplicant <br> vi /tmp/local/bin/wpa_supplicant.sh</code> <br> <br>       wgt    .  i   .   VLAN=$(nvram get wan_ifname); export VLAN  wan_ifname  wan2_ifname.    identity  password.   /opt/sbin/wpa_supplicant -i${IFNAME} -Droboswitch -c${CONF} -dd <br>    /opt/sbin/wpa_supplicant  /usr/local/sbin/wpa_supplicant      -B     .  Esc  :wq.  : <br> <br> <code>flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>    /tmp/local/   /usr/local/.      WAN : <br> <br> <code>/usr/local/bin/wpa_supplicant.sh &amp;&amp; sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2</code> <br> <br>    ifconfig. <br> <br> 5.   <br>    ,  2       .     2 : <br> <br> <code>ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>     Load Balancing, : <br> <br> <code>ip route del default <br> ip route add default dev vlan1 <br> ip route add default dev vlan2</code> <br> <br> 6.    <br> <code>vi /tmp/local/sbin/post-boot</code> <br> <br>  i. <br> <br> <code>#!/bin/sh <br> ifconfig vlan2 up <br> /usr/sbin/pppd file /tmp/ppp/options.wan0 <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan1 <br> /usr/local/bin/wpa_supplicant.sh <br> sleep 15 &amp;&amp; /sbin/udhcpc -b -i vlan2 <br> ip r add 10.152.1.0/24 dev vlan2 <br> ip r add 31.29.0.0/16 dev vlan2</code> <br> <br>  Esc  :wq. <br> <br> <code>chmod +x /tmp/local/sbin/post-boot</code> <br> <br> ! <br> PS      ,       .  DIR-320  usb-.   .    <a href="http://narod.ru/disk/25858495001/multiwan.tar.html">MultiWAN.tar</a> .   .      options.wan0  wpa_supplicant.sh   ,       .     DIR-320   start.sh.    .</code> </habracut></div><p>Source: <a href="https://habr.com/ru/post/129446/">https://habr.com/ru/post/129446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../129440/index.html">Mail.Ru Agent + ICQ = interoperability</a></li>
<li><a href="../129441/index.html">Bootstrap Fund launched - a new type of incubator / fund / business club</a></li>
<li><a href="../129442/index.html">New version of ABBYY TextGrabber: two in one</a></li>
<li><a href="../129443/index.html">The secrets of numerology in the invitation of Apple</a></li>
<li><a href="../129445/index.html">FreeRTOS: mutexes and critical sections</a></li>
<li><a href="../129451/index.html">ZRouter - we shove FreeBSD into a DLINK router</a></li>
<li><a href="../129452/index.html">Why can I stop writing on Habrahabr</a></li>
<li><a href="../129454/index.html">Userscripts. Go deep</a></li>
<li><a href="../129455/index.html">LGDC # 2 in November. We invite to participate</a></li>
<li><a href="../129456/index.html">Citizens! Give a chance to support</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>