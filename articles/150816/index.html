<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Converter for transferring contacts from Outlook to Android, for paranoids (open source, without using synchronization with Google and third-party utilities)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yesterday one comrade turned up, faced with the problem of transferring contacts from a smartphone to WM6 for a new Android device. After a week of va...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Converter for transferring contacts from Outlook to Android, for paranoids (open source, without using synchronization with Google and third-party utilities)</h1><div class="post__text post__text-html js-mediator-article">  Yesterday one comrade turned up, faced with the problem of transferring contacts from a smartphone to <a href="http://ru.wikipedia.org/wiki/Windows_Mobile">WM6</a> for a new Android device.  After a week of vain attempts, he lowered his hands and handed over the <a href="http://ru.wikipedia.org/wiki/CSV">csv file</a> obtained from Outlook, to which he quite simply managed to connect the phone's notebook. <br><br>  <i>He tried many converters and methods, but all of them either did not give the desired result - fast and free conversion in two clicks, or distorted information due to the curly implementation of the localization of his version of Autluk.</i>  <i>He refused to use contact binding to the account for religious and political reasons, the dictates of internal morality or way of life, I did not specify.</i> <br><br>  As a result, a little googling, but not finding a simple solution, we had to loosen the script on the <a href="http://www.gnu.org/software/gawk/">great and powerful</a> , which creates a <a href="http://ru.wikipedia.org/wiki/VCard">vcf-file of</a> contacts, which in turn is easily imported into Android using standard phone tools. <br><a name="habracut"></a><br><h4>  Initial data </h4><br>  Actually what had to face. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  CSV </h6><br>  A CSV file is a plain text file in which each row is a row of a data table, and the columns within a row are separated by a separator character, which can be selected by the user and is usually a tab, semicolon, comma, etc.  The first line often contains not field values, but field names. <br><br>  When exporting from Outlook, you must select all fields and allow placing the names of the fields in the first line (perhaps this is enabled by default). <br><br><div class="spoiler">  <b class="spoiler_title">The result is a text file of a similar format.</b> <div class="spoiler_text"><blockquote>  Appeal;  Name;  Fatherland;  Surname;  Suffix;  Organization;  Department;  Position;  Ulitsarabadres;  Street 2 address;  Street address;  Citybadres;  DomainAdmin;  Indexrabadres;  Stranarabadres;  Ulitsadomadres;  Street2domain;  Street 3 address;  City Maiden;  Areadomain;  Sweat code;  Stranadomares;  Street address;  Street 2 another address;  Street 3 another address;  City other address;  Area another address;  Index to another address;  Other address;  Telephone assistant;  Raboiifax;  Work phone;  Telephone2;  Callback;  Telephone in the machine;  Main telephone organization;  Homefax;  Home phone;  Telefonom2; ISDN;  Telephone portable;  Anotherfax;  Other phone;  Pager;  Main phone;  Radiotelephone;  Teletype telephones;  Telex;  Importance;  Webpage;  Anniversary;  Birthday;  Children;  Assistant's name;  Initials;  Categories;  Clue terms;  Code organization;  Linecode;  Postponed;  Floor;  User1;  User2;  User3;  User4;  Mark;  Potovyashikdomadres;  Store another address;  Sweat crabs;  Profession;  Location;  Location rooms;  Distance;  Head;  Information available to the Internet;  Server Directory;  Spouse;  Set;  Seth;  Hobby; private;  Adresselpot;  Tipalpots;  Short Names;  Address 2 slots;  Type 2 elpots;  Short2mealpots;  Address3elpots;  Tip3 Elpot;  Short3mealpots;  Language <b>[CRLF]</b> <br><br>  ;  Credit ;; Bee Line Account ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 067404 ;;; 067404 ;;;;;; ;;;  Plain ;;;;;;  K.BLS;  Service ;;;;;  Not determined;;;;;  Plain ;;;;;;;;;;;;;;;;  LYING;;;;;;;;;;  <b>[CRLF]</b> <br><br>  Other records </blockquote></div></div><br><h6>  vCard </h6><br>  This is a business card format.  On Android phones, this is the main format for exchanging contacts.  If you are trying to send a contact by mail or SMS, then the phone will attach exactly vcf-card.  The beauty of the format is that in one card (file) you can combine several contacts. <br><br><div class="spoiler">  <b class="spoiler_title">The converted entry from the example above looks like this.</b> <div class="spoiler_text"><blockquote>  BEGIN: VCARD <br>  VERSION: 3.0 <br>  CATEGORIES: Utility <br>  N: Bee Line Account;  Credit <br>  TEL; TYPE = cell: 067404 <br>  TEL; TYPE = home: 067404 <br>  END: VCARD </blockquote></div></div><br><h4>  Script converter </h4><br>  The script is written in a convenient, simple, lightweight, cross-platform, and a bunch of different <a href="http://www.gnu.org/software/gawk/manual/">awk</a> epithets.  The field separator inside the csv is indicated at the beginning (I got a csv with a semicolon).  Next, the map of csv fields to vCard fields is defined as an array of KEYS.  In general, these are all settings that should work by default. <br><br><div class="spoiler">  <b class="spoiler_title">outlook2vcard.awk</b> <div class="spoiler_text"><pre><code class="cpp hljs">BEGIN { FS = <span class="hljs-string"><span class="hljs-string">";"</span></span> KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"N.1"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"N.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"N.3"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"N.4"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"N.5"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ORG.1"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ORG.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TITLE"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=work.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"2"</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=work.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"3"</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=work.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=work.3"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=work.4"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=work.5"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=work.6"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=home.1"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=home.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"2"</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=home.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"3"</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=home.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=home.3"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=home.4"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=home.5"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=home.6"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=postal.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"2"</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=postal.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"3"</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=postal.2"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=postal.3"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=postal.4"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=postal.5"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"ADR;TYPE=postal.6"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=pager"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=work;TYPE=fax"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=work"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"2"</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=work"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=X-EVOLUTION-CALLBACK"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=car"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=work"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=home;TYPE=fax"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=home"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"2"</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=home"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"ISDN"</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=isdn"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=cell"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=fax"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=pager"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=pcs"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=msg"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"TEL;TYPE=msg"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"URL"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"X-ANNIVERSARY"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"BDAY"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"X-ASSISTANT"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"CATEGORIES"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"NOTE"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"1"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"2"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"3"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"4"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"X-SPOUSE"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"_"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">"EMAIL;TYPE=internet"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"2"</span></span>] = <span class="hljs-string"><span class="hljs-string">"EMAIL;TYPE=internet"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"2"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"2"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"3"</span></span>] = <span class="hljs-string"><span class="hljs-string">"EMAIL;TYPE=internet"</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"3"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">"3"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; KEYS[<span class="hljs-string"><span class="hljs-string">""</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; } FNR == <span class="hljs-number"><span class="hljs-number">1</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= NF; i++) { k = KEYS[$i]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span> != k) { MAPS[i] = k; } } } FNR != <span class="hljs-number"><span class="hljs-number">1</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> PROPS; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= NF; i++) { k = MAPS[i]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-string"><span class="hljs-string">""</span></span> != $i) &amp;&amp; (<span class="hljs-string"><span class="hljs-string">""</span></span> != k)) { PROPS[k] = $i; } } n = asorti(PROPS, SKEYS); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { l = <span class="hljs-string"><span class="hljs-string">""</span></span>; print(<span class="hljs-string"><span class="hljs-string">"BEGIN:VCARD"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"VERSION:3.0"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= n; i++) { k = SKEYS[i]; v = PROPS[k]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span> == split(k, a, <span class="hljs-string"><span class="hljs-string">"."</span></span>)) { k = a[<span class="hljs-number"><span class="hljs-number">1</span></span>]; x = <span class="hljs-number"><span class="hljs-number">0</span></span> + a[<span class="hljs-number"><span class="hljs-number">2</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { x = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l != k) { l = k; m = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"\r\n%s:"</span></span>, l); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (m &lt; x) { m++; <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">";"</span></span>); } <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"%s"</span></span>, v); } print(<span class="hljs-string"><span class="hljs-string">"\r\nEND:VCARD"</span></span>); } } <span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">die</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(str)</span></span></span><span class="hljs-function"> </span></span>{ print <span class="hljs-string"><span class="hljs-string">"Error at "</span></span> FILENAME <span class="hljs-string"><span class="hljs-string">":"</span></span> FNR <span class="hljs-string"><span class="hljs-string">" "</span></span> str <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> } <span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">warn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(str)</span></span></span><span class="hljs-function"> </span></span>{ print <span class="hljs-string"><span class="hljs-string">"Warning at "</span></span> FILENAME <span class="hljs-string"><span class="hljs-string">":"</span></span> FNR <span class="hljs-string"><span class="hljs-string">" "</span></span> str }</code> </pre> </div></div><br><h6>  How to run </h6><br>  Run the script from under the awk interpreter as follows: <br><pre> <code class="bash hljs">gawk -f outlook2vcard.awk inputfile.csv &gt;outputfile.vcf</code> </pre><br>  As input files, you can specify multiple csv files, then they will be merged. <br><br><h6>  A spoon of tar </h6><br>  The script does not automatically convert the Cyrillic encoding to <a href="http://ru.wikipedia.org/wiki/UTF-8">UTF-8</a> , which is native to Android.  This final chord must be done manually, either using <a href="http://www.opennet.ru/man.shtml%3Ftopic%3Diconv%26category%3D1%26russian%3D0">iconv</a> for unixoids, it is also available under <a href="http://gnuwin32.sourceforge.net/packages/libiconv.htm">gnuwin32</a> , or with a regular notepad (notepad.exe) for window vents, opening the file, and then saving it with a new name (Save As ...) and selecting UTF-8 encoding under the new file name. <br><br><h4>  Import to phone </h4><br>  The method is simple and is described in a pile of blogs and forums, but I will not be lazy and will bring it again.  The resulting file with the extension vcf must be put on the Androidphone memory card.  Then enter contacts, press the menu button and select ‚ÄúImport / Export - Import from a memory card‚Äù, voila. </div><p>Source: <a href="https://habr.com/ru/post/150816/">https://habr.com/ru/post/150816/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150809/index.html">Base station 4G LTE on a regular PC</a></li>
<li><a href="../150810/index.html">Note to translators: speeding up ABBYY Lingvo and other tools</a></li>
<li><a href="../150812/index.html">New look at brand promotion through social networks: Intel and Toshiba shoot a film with the participation of "mere mortals"</a></li>
<li><a href="../150813/index.html">How to copy files and folders in linux console excluding some of them by regular expression</a></li>
<li><a href="../150814/index.html">Creating a two-sided board (video)</a></li>
<li><a href="../150817/index.html">Android Tabs Tips</a></li>
<li><a href="../150818/index.html">Homemade spectrometers on Kickstarter for $ 35</a></li>
<li><a href="../150819/index.html">Back side backup</a></li>
<li><a href="../150820/index.html">ASN.1 in simple terms (part 2)</a></li>
<li><a href="../150821/index.html">5 LinguaLeo updates and secret plans for English learners</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>