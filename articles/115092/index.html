<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to return high-quality sound in Windows 7 - bitwise output, hardware effects (EAX, etc.)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to share experience on the topic of sound in Windows 7. 
 In fact, everything is not as bad as it first seems, and I'll show it to you now. 
 I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to return high-quality sound in Windows 7 - bitwise output, hardware effects (EAX, etc.)</h1><div class="post__text post__text-html js-mediator-article">  I want to share experience on the topic of sound in Windows 7. <br>  In fact, everything is not as bad as it first seems, and I'll show it to you now. <br><a name="habracut"></a>  I'll start over. <br><br><h4>  About audio subsystems </h4><br><h5>  Windows xp </h5><br>  Here the sound subsystem diagram is approximately as follows: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dd8/0c4/57d/dd80c457d7eb0fefa828e645a7692881.png" alt="Xp audio">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this case, through the DirectSound interface, the software had direct access to the hardware resources of the sound card ‚Äî mixing, sample rate conversion, various effects (including 3D positioning) ‚Äîin general, everything that was necessary, both for music / movies and games. <br>  Of course, there were some problems, in particular, with a Windows mixer (inaccurate volume control, forced poor-quality oversampling of everything and everyone to 48 kHz), but they were quite easily managed with Kernel Streaming (the same stream going by kmixer), and sometimes with the help of good drivers (for Creative, for example, those appear only in the X-Fi line. On the Audigy audio cards, the mixer behaves not quite adequately, but, if desired, it is not difficult to cope with this). <br><habracut><br><br><h5>  Vista seven </h5><br>  And so, our enthusiasts zvuvri lived, did not know grief, but then a new OS from Microsoft arrived, which of course had to contain dramatic changes (and it‚Äôs not so important which way). <br>  Thus, within the framework of the new concept of <i>abstraction from equipment</i> , Windows Vista, among other things, received a completely redesigned audio input / output subsystem.  And of course, reworked it is not the best way. <br>  This is what she looked like this time: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/85c/551/4ff/85c5514ff9a8b3ae0bcf15afe11def34.png" alt="Vista-7 audio"><br>  API - Application Programming Interface <br>  APO - Audio Processing Object <br>  CPT - Cross Process Transport <br>  KST - Kernel Streaming Transport <br><br>  Now I will explain.  The bottom line is this: all programs sharpened for output to DirectSound and unaware of the new interface are connected to WASAPI in general mode (WASAPI Shared), then the following happens: <br>  The components of WASAPI (using only CPU resources) perform all the necessary (and not so) transformations: <br><ol><li>  Bringing audio streams from different applications to the same type (specified in the Windows settings) - i.e.  to one number of channels, sampling rate, quantization depth. </li><li>  Mixing streams. </li></ol><br>  Plus, it is necessary to add the possibility of imposing in the process of processing software effects (the algorithms of which are incorporated in the sound card drivers).  For example, for Creative X-Fi sound cards, there is a poor emulation of the CMSS-3D effect. <br>  The quality of all these handlers, of course, is not the highest. <br>  Further, all this is sent via Kernel Transport to the sound card. <br>  Now let's try to objectively evaluate the advantages and disadvantages of the new system: <br><br>  + Basic processing capabilities for sound cards that do not know how to handle the sound "on their own" <br>  + input support for almost any audio format - multi-channel audio with a sampling rate of up to 192 kHz and a quantization depth of up to 32-bit float <br>  + increased stability (controversial statement, in principle) <br><br>  - forced resampling of dubious quality <br>  - mixing channels without environmental effects (or they are very primitive) <br>  - narrowing the dynamic range (especially in 16 bit mode) <br>  - lack of access to hardware DSP, i.e.  loss of all its functionality, including the effects of EAX in games (including on the cards where EAX was emulated programmatically - since there is no such thing in WASAPI) <br>  - clicks, wheezing and other consequences associated with the use of CPU resources. <br><br>  As you can see, most unlucky computer music lovers are audiophiles (I hope no one will be offended) and gamers. <br>  People who are not particularly interested in what is happening with the sound on the way to the sound card may even get a certain improvement (although, again, they probably don't care if they only work) <br>  And now, about how to overcome most of the above problems, because, to the great misfortune, with the release of the beloved by many Windows 7, Microsoft didn‚Äôt make any revolution in terms of sound. <br><br><h4>  Music lovers: accurate sound output </h4><br>  1. As I wrote above, most applications for audio output in Windows 7 (whether they want it or not) use WASAPI Shared mode.  But there is another mode - WASAPI Exclusive.  If you follow the block diagram, then in this mode everything that lies between the Application Programming Interface and the Kernel Streaming Transport is discarded - roughly speaking, the sound goes directly from the application through the WASAPI interface to the sound card. <br>  But it is necessary to make a <u>note</u> : since the WASAPI mixer is turned off in this mode, and there is still no access to the sound card mixer (for there is no DirectSound), when the application uses exclusive mode, playback of any other source via WASAPI becomes impossible. <br>  But, anyway, we get a bit-by-bit audio output to the sound card. <br><br>  2. There is another way.  If your sound card has a native ASIO driver, you are very lucky.  ASIO functions completely separate from WASAPI, so that when listening to music, the system sounds will not be turned off - the ASIO and WASAPI streams will be mixed by the sound card itself. <br>  Conclusion: if your ASIO driver is beyond doubt, use it. <br>  Yes, I almost forgot - it is <b>undesirable to use ASIO4ALL</b> - like Kernel Streaming, it is very unstable in this OS (apparently, due to the fact that other sounds coming through WASAPI periodically block Kernel Transport). <br><br>  Now <u>directly to the point</u> . <br><br>  Of course, for listening to music, I recommend <a href="http://audiophilesoft.ru/load/audiophilesoftware/foobar2000/3-1-0-5"><b>foobar2000</b></a> with ASIO Output plug-in or WASAPI output support - I cannot vouch for anything else.  Detailed settings for audio output through foobar2000 are described <a href="http://audiophilesoft.ru/publ/software/hq_pc_sound/4-1-0-24">here</a> . <br><br>  I‚Äôm disappointing <b>AIMP</b> lovers - WASAPI Exclusive is not supposed even in AIMP3 beta (Shared only), and ASIO is still lame in it (it doesn‚Äôt know how to set the correct number of output channels, which leads to bad results). <br><br>  <b>Winamp</b> users can offer <a href="http://www.winamp.com/plugin/asio-output-plugin/156466">ASIO output Plugin</a> plug-ins or even this: <a href="http://www.winamp.com/plugin/openal-output-1-0-0/221767">OpenAL Output</a> - by the way, another way to bypass WASAPI (as seen from the block scheme). <br><br><h4>  For film enthusiasts: about video players </h4><br>  With video players, the situation is almost the same.  We need to bring sound to the card in its original form.  This is especially important if you want to convert multi-channel sound to stereo using hardware effects like CMSS-3D to Creative X-Fi (surround sound in headphones or stereo speakers).  To do this, the sound must come to the sound card in a multi-channel form.  But here's the problem: WASAPI in general mode converts channels to the number specified in the Windows settings.  But even if you specify there, say, 5.1, - this parameter is synchronized with the sound card driver settings, and the DSP will not convert the sound - since the signal at the input corresponds to the number of channels settings.  Those.  Here the principle is as follows: in the sound card driver settings there should be the actual configuration of the connected playback device (headphones, speakers), and the sound should be not changed to the card. <br>  And so, here we again need WASAPI Exclusive.  I would advise using <a href="http://mpc-hc.sourceforge.net/">Media Player Classic HomeCinema</a> in conjunction with DirectShow <a href="http://forum.slysoft.com/forumdisplay.php%3Ff%3D85">ReClock</a> filter (only for 32-bit MPC), which, among other things, can output sound to WASAPI Exclusive. <br><br><h4>  Gamers: three-dimensional positioning, EAX </h4><br>  Yes, the introduction of a new sound subsystem, undoubtedly, caused outrage among many gamers, including  Happy owners of high-tech sound cards from Creative. <br>  And so, for those who, maybe, still do not know: the way out is found - OpenAL.  This library has access to everything related to hardware effects, three-dimensional positioning of sound sources, and so on.  Environmental Audio Extension - up to version 5.0. <br>  In addition, advanced developers of such games, such as STALKER: Call of Pripyat, built the engines of their games on OpenAL, for the other games designed for DirectSound, two programs were developed that convert DirectSound calls to OpenAL: <br><ul><li>  <a href="http://audiophilesoft.ru/load/sound_drivers/creative_alchemy/6-1-0-79">Creative ALchemy</a> (the latest version at the time of this writing) for <b>Creative's</b> <b>Audigy</b> and <b>X-Fi</b> cards </li><li>  and even <a href="http://audiophilesoft.ru/load/sound_drivers/realtek/6-1-0-6">3D SoundBack</a> for <b>Realtek HDA</b> cards, which, by the way, support EAX 2.0 (albeit programmatically) </li></ul><br><br><h4>  findings </h4><br>  And so, it seems that we have everything that we lacked right after the transition from Windows XP to Windows 7. Of course, not without much hassle, but what to do - Microsoft has thrown up such puzzles to us. <br><br>  Thank you for attention. </habracut></div><p>Source: <a href="https://habr.com/ru/post/115092/">https://habr.com/ru/post/115092/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../115083/index.html">Three tulips</a></li>
<li><a href="../115086/index.html">Cheat with like or dirty promotion</a></li>
<li><a href="../115087/index.html">ASUS at CeBIT 2011: New Megano Laptops, Tablet and Eco-Computers, 3D</a></li>
<li><a href="../115090/index.html">Happy holiday, beautiful half of the community!</a></li>
<li><a href="../115091/index.html">A simple text-to-speech converter using Google Translate</a></li>
<li><a href="../115093/index.html">SMM and SMO. Make friends and then sell</a></li>
<li><a href="../115094/index.html">Analyze newspapers and magazines with Facebook likes</a></li>
<li><a href="../115095/index.html">All male ITshnikam to March 8 :)</a></li>
<li><a href="../115096/index.html">At every corner of the deal</a></li>
<li><a href="../115097/index.html">Warner Bros. launches online movie rental on Facebook</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>