<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calendar of birthdays and anniversaries of Outlook contacts</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After switching from Google (Gmail, Contacts, Calendar) to MS Exchange and Outlook, the most I missed was the ‚ÄúBirthdays and Events of Contacts‚Äù calen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calendar of birthdays and anniversaries of Outlook contacts</h1><div class="post__text post__text-html js-mediator-article">  After switching from Google (Gmail, Contacts, Calendar) to MS Exchange and Outlook, the most I missed was the ‚ÄúBirthdays and Events of Contacts‚Äù calendar, in which the events of the same name were automatically created from the address book.  The standard Outlook function of creating a birthday record when editing a contact did not suit me, since  All new contacts with birthdays and anniversaries, as a rule, are created in a mobile phone account connected to Exchange via the ActiveSync protocol.  And with this method of data entry, no calendar entries are created. <br><br>  Therefore, the VBA script was written (since no free solution found on the Internet, I did not fit the functionality), which does the following: <br>  - re-saves birth dates and anniversaries of all contacts of the address book (thus, the birthdays and anniversaries of contacts are created in the calendar by the native Outlook function); <br>  - moves all records of such events from the standard calendar to the one specified by the user (so as not to litter the main calendar overloaded with entries); <br>  - corrects the ‚ÄúStore as‚Äù contact entries (as you know, iOS and Android work incorrectly with this field in Microsoft Exchange accounts) as follows: if the First Name or Last Name fields contain any values, then Keep As will take the value ‚ÄúFirst Name‚Äù, otherwise - ‚ÄúOrganization‚Äù (this is especially useful if you save the names of services and offices of any kind in the ‚ÄúOrganization‚Äù field, not ‚ÄúFirst Name‚Äù, such as ‚ÄúPizza Delivery‚Äù). <br><br>  In order to earn such an algorithm, no additional software needs to be installed. <br>  It takes only 2 actions: to allow execution of unsigned macros and copy the script itself through the clipboard (CTRL-C, CTRL-V) into Outlook. <br><a name="habracut"></a><br>  To allow unsigned macros to run, <br>  1. In Outlook, go to File -&gt; Settings -&gt; Trust Center -&gt; Trust Center Settings: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/245/ce4/48c/245ce448c9e6408a95b44bc05123b093.png"><br><br>  2. Macro settings -&gt; select ‚ÄúNotifications for all macros‚Äù: <br><br><img src="https://habrastorage.org/files/66f/891/956/66f8919561dc4f4bad3a8701b9e0fa0a.png"><br><br>  The next step is to insert the body of the script itself (macro) into Outlook. <br><br>  To do this, click on ALT-F11 in Outlook - go to the Microsoft Visual Basic for Applications editor -&gt; in the ‚ÄúProject‚Äù section, select ‚ÄúThisOutlookSession‚Äù: <br><br><img src="https://habrastorage.org/files/5f6/0c1/c7b/5f60c1c7bdf14a84819efc39bf5870ed.png"><br><br>  And in the opened window we insert the script: <br><br><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> olRobot() <span class="hljs-comment"><span class="hljs-comment">' Outlook VBA script by Sergii Vakula ' Auto generation the Birthdays and Anniversaries appointments of all Contact folders to a specific calendar ' Auto changing Contact's FileAs fields: FullName for humans, CompanyName for companies Dim objOL As Outlook.Application Dim objNS As Outlook.NameSpace Dim objItems As Outlook.Items Dim obj As Object Set objOL = CreateObject("Outlook.Application") Set objNS = objOL.GetNamespace("MAPI") On Error Resume Next ' ***************************************************************************************************** ' *** STAGE 1: Rebuilding Contact's Birthdays and Anniversaries to the main calendar, fixing FileAs *** ' ***************************************************************************************************** Dim Report As String Dim mySession As Outlook.NameSpace Dim myFolder As Outlook.Folder Set mySession = Application.Session ' Method 1: Ask for Contact folder 'MsgBox ("Select Contact folder by next step...") 'Call ContactsFolders(Session.PickFolder, Report) ' Method 2: Use default Contact folder and all subfolders 'Call ContactsFolders(objNS.GetDefaultFolder(olFolderContacts), Report) ' Method 3: Use all Contact folders For Each myFolder In mySession.Folders Call ContactsFolders(myFolder, Report) Next ' *************************************************************************************** ' *** STAGE 2: Moving Birthdays and Anniversaries appointments to a specific calendar *** ' *************************************************************************************** Dim objCalendar As Outlook.AppointmentItem Dim objCalendarFolder As Outlook.MAPIFolder Dim cAppt As AppointmentItem Dim moveCal As AppointmentItem Dim pattern As RecurrencePattern Set objCalendarFolder = objNS.GetDefaultFolder(olFolderCalendar) bodyMessage = "This is autocreated appointment" ' Method 1: Ask for specific calendar folder for birthdays and anniversaries MsgBox ("Select Birthdays and Anniversaries Calendar folder by next step...") Set newCalFolder = Session.PickFolder ' Method 2: Use pre-assigned calendar folder for birthdays and anniversaries 'Set newCalFolder = GetFolderPath("display name in folder list\Calendar\Birthdays and Anniversaries") 'Set newCalFolder = GetFolderPath("\\me@about.com\Calendar\Birthdays and Anniversaries") For i = newCalFolder.Items.Count To 1 Step -1 Set obj = newCalFolder.Items(i) If obj.Class = olAppointment And _ obj.GetRecurrencePattern.RecurrenceType = olRecursYearly And _ obj.AllDayEvent And _ obj.Body = bodyMessage Then Set objCalendar = obj objCalendar.Delete End If Err.Clear Next For i = objCalendarFolder.Items.Count To 1 Step -1 Set obj = objCalendarFolder.Items(i) If obj.Class = olAppointment And _ obj.GetRecurrencePattern.RecurrenceType = olRecursYearly And _ obj.AllDayEvent And _ (Right(obj.Subject, 11) = "'s Birthday" Or Right(obj.Subject, 14) = "'s Anniversary" Or _ Right(obj.Subject, 13) = " " Or Right(obj.Subject, 9) = "") Then Set objCalendar = obj Set cAppt = Application.CreateItem(olAppointmentItem) With cAppt .Subject = objCalendar.Subject .Start = objCalendar.Start .Duration = objCalendar.Duration .AllDayEvent = True .Body = bodyMessage .ReminderSet = False .BusyStatus = olFree End With Set pattern = cAppt.GetRecurrencePattern pattern.RecurrenceType = olRecursYearly cAppt.Save objCalendar.Delete Set moveCal = cAppt.Move(newCalFolder) 'moveCal.Categories = "moved" moveCal.Save End If Err.Clear Next Set objOL = Nothing Set objNS = Nothing Set obj = Nothing Set objContact = Nothing Set objItems = Nothing Set objCalendar = Nothing Set objCalendarFolder = Nothing Set cAppt = Nothing Set moveCal = Nothing Set pattern = Nothing Set mySession = Nothing Set myFolder = Nothing MsgBox ("Completed!" &amp; vbCrLf &amp; vbCrLf &amp; "All Contact's FileAs were fixed." &amp; vbCrLf &amp; "All Birthdays and Anniversaries appointments were re-created." &amp; vbCrLf &amp; vbCrLf &amp; "Contact folders that been processed:" &amp; vbCrLf &amp; Report &amp; vbCrLf &amp; "Calendar for Birhdays and Anniversaries:" &amp; vbCrLf &amp; newCalFolder.FolderPath &amp; vbCrLf &amp; vbCrLf &amp; "Have a nice day!") End Sub Function GetFolderPath(ByVal FolderPath As String) As Outlook.Folder Dim oFolder As Outlook.Folder Dim FoldersArray As Variant Dim i As Integer On Error GoTo GetFolderPath_Error If Left(FolderPath, 2) = "\\" Then FolderPath = Right(FolderPath, Len(FolderPath) - 2) End If FoldersArray = Split(FolderPath, "\") Set oFolder = Application.Session.Folders.Item(FoldersArray(0)) If Not oFolder Is Nothing Then For i = 1 To UBound(FoldersArray, 1) Dim SubFolders As Outlook.Folders Set SubFolders = oFolder.Folders Set oFolder = SubFolders.Item(FoldersArray(i)) If oFolder Is Nothing Then Set GetFolderPath = Nothing End If Next End If Set GetFolderPath = oFolder Exit Function GetFolderPath_Error: Set GetFolderPath = Nothing Exit Function End Function Private Sub ContactsFolders(CurrentFolder As Outlook.Folder, Report As String) Dim objItems As Outlook.Items Dim obj As Object Dim objContact As Outlook.ContactItem Dim strFileAs As String Dim SubFolder As Outlook.Folder Dim SubFolders As Outlook.Folders Set SubFolders = CurrentFolder.Folders If CurrentFolder.DefaultItemType = 2 Then Report = Report &amp; CurrentFolder.FolderPath &amp; vbCrLf Set objItems = CurrentFolder.Items For Each obj In objItems If obj.Class = olContact Then Set objContact = obj With objContact .Display If .FullName = "" Then strFileAs = .CompanyName Else strFileAs = .FullName End If .FileAs = strFileAs mybirthday = .Birthday myanniversary = .Anniversary .Birthday = Now .Anniversary = Now .Birthday = mybirthday .Anniversary = myanniversary .Save .Close 0 End With End If Err.Clear Next End If For Each SubFolder In SubFolders Call ContactsFolders(SubFolder, Report) Next Set SubFolder = Nothing Set SubFolders = Nothing End Sub</span></span></code> </pre> <br><br>  Save, close the editor and return to Outlook. <br><br>  All we have to do is execute this script.  To do this, press ALT-F8, select "ThisOutlookSession.olRobot" and press the "Run" button: <br><br><img src="https://habrastorage.org/files/8a7/22f/af5/8a722faf5e214aecbb5c782acd4e8a85.png"><br><br>  In the process of the script, a dialog box will open with a suggestion to specify in which calendar to place the birthdays and anniversaries of the ‚ÄúSelect Birthdays and Anniversaries Calendar folder by next step‚Äù: <br><br><img src="https://habrastorage.org/files/b2e/992/b00/b2e992b005a04e569ce59fcc6da34744.png"><img src="https://habrastorage.org/files/545/533/bbf/545533bbf0cf4dfe90ba5f4da79d97c0.png"><br><br>  Experienced users, pay attention to the different methods of obtaining primary information in the script body. <br><br>  If you had incorrect records about such events in the main calendar - run this script a second time, it will correct them. <br><br>  Now it‚Äôs enough to launch it by pressing ALT-F8 so that your calendar looks like candy. <br><br>  Enjoy! </div><p>Source: <a href="https://habr.com/ru/post/243505/">https://habr.com/ru/post/243505/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243495/index.html">Universe npm</a></li>
<li><a href="../243497/index.html">Computer Science Classic</a></li>
<li><a href="../243499/index.html">Electronic Cake in your pocket: development diary</a></li>
<li><a href="../243501/index.html">Repair of a loop of LEGO NXT</a></li>
<li><a href="../243503/index.html">Express Course "Project Planning"</a></li>
<li><a href="../243509/index.html">Add self-registration by users in ownCloud 6</a></li>
<li><a href="../243511/index.html">IOS Masque Vulnerability Check</a></li>
<li><a href="../243513/index.html">Examination of the task on the example of the task of checking the analyzer RBNF declarations</a></li>
<li><a href="../243515/index.html">Learning Swift is now easier.</a></li>
<li><a href="../243517/index.html">Prototype data center on methane</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>