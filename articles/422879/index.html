<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 34: why do routers break</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When your computer is infected with crypto-fiber, if your passwords are stolen by a trojan and fraudsters hijacked mail, if these credit cards were ta...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 34: why do routers break</h1><div class="post__text post__text-html js-mediator-article">  When your computer is infected with crypto-fiber, if your passwords are stolen by a trojan and fraudsters hijacked mail, if these credit cards were taken away with phishing and the money was withdrawn, this is terrible, but at least you can understand what happened and how to deal with it.  Antivirus clean up the crap, restore data from the backup (if it is, of course, there is), reissue the card.  Much worse, if you are quiet, not attracting attention, for a long time watching. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ch/kb/bk/chkbbkyc8cfdyhikitieqf_ft_u.jpeg"></div><br>  Typically, such a threat is relevant for public persons, large companies - in general, in cases where you have really valuable information.  Or not only: it seems that middle-level cybercriminals are also starting to try to play cyber espionage.  Researchers from the Chinese team of 360 Netlab were able to identify at least 7,500 Mikrotik routers that were hacked and sent traffic passing through them to the servers of cybercriminals ( <a href="https://threatpost.ru/bot-masters-collect-traffic-from-compromised-mikrotik-routers/28046/">news</a> ).  Given that this is not the only news about attacks on routers in general and Mikrotik in particular, today we will try to figure out what happened and what to do about it. <br><a name="habracut"></a><br>  Experts from 360 Netlab conducted a whole <a href="https://blog.netlab.360.com/7500-mikrotik-routers-are-forwarding-owners-traffic-to-the-attackers-how-is-yours-en/">study</a> .  Mikrotik routers can be reliably identified using the open TCP port 8291 - a utility is attached to it to control the router from a remote WinBox computer.  By the way the device responds to specific commands for this software, you can accurately identify that this is a router, and not just some device that has the same port open for some reason.  A total of 1.2 million Mikrotik routers with an open port were found, and this is quite a lot, considering that the port can certainly be closed for access from the outside. <br><br>  Of the 1.2 million routers, 370,000, or slightly more than 30 percent, have the vulnerability CVE-2018-14847.  This vulnerability was <a href="https://threatpost.ru/mikrotik-patched-zero-day-vulnerability-in-record-time/25811/">closed</a> in April of this year.  Here you can read the story of how an independent researcher tried to determine what exactly was patched.  In short, the vulnerability allows, without special authorization, to read remotely any file from the router, including badly protected access passwords (which have since been better protected).  In the description of the proof of concept on GitHub, it is <a href="https://github.com/BasuCert/WinboxPoC">stated</a> that routers with RouterOS firmware versions 6.29‚Äì6.42 are vulnerable, that is, the problem has existed for three years. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/sd/ru/qo/sdruqo97xdz9qwspucqwf3gxwra.png"></div><br>  The distribution map of vulnerable devices on the planet looks like this.  Russia is in second place after Brazil, with 40,000 un-upgraded routers.  How do attackers exploit vulnerabilities?  You can redirect user traffic to a page with an error message generated by the router itself, and on this page you can introduce the CoinHive currency miner.  This method of monetization is already known (see digest <a href="https://habr.com/company/kaspersky/blog/419425/">number 29</a> ), in August it was reported that the attack affected mainly Brazil, and two hundred thousand routers were subjected to it.  True, researchers from China clarify that the plan was so-so.  The fact is that in order to work properly, the miner must have access to the external network, which is blocked by the very settings that the error page shows to users. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_y/gc/cs/_ygccsnwahgekq8suu_fpu29qqu.png"></div><br>  And in any case, such an attack will be quickly detected, since the users (we are talking about routers designed for large organizations and small providers) will fall off the Internet.  The proxy server on the router can also be used more elegantly: for example, shifting the task of further scanning the network and attacking other routers onto an infected device.  In total, researchers found 239,000 routers on which the Socks4 proxy was activated, and this was done, according to Chinese experts, clearly with malicious intentions, " <i>without respect</i> ."  Of course, this option is not the only one, but why the army of routers with a proxy server is still used, access to which is possible only from a specific (apparently controlled by cybercriminals) subnet, is not precisely known. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tw/lr/t6/twlrt6ftix6p6dcu_upmmrxegam.png"></div><br>  But the most interesting finding of research is this one.  Mikrotik RouterOS allows you to redirect network packets processed by a router to a specified address.  The settings for such traffic output may look like the one shown in the screenshot above.  So, researchers from 360 Netlab have identified 7.5 thousand routers, who don‚Äôt know to whom they give all the traffic passing through them.  Okay, almost all of them: communications on ports 20, 21, 25, 110 and 143 are usually monitored, respectively, these are FTP protocols and SMTP mail and POP3 / IMAP.  Also, in some cases, ports 161 and 162 associated with the SNMP protocol were tracked, but why it is used is not clear.  The list of ports is relevant for the most common settings on the infected routers.  On some, other ports were tracked, for example, 80 (that is, all unencrypted web traffic) and 8080. <br><br>  And in the list of routers that have stolen traffic, Russia ranks first with 1628 infected routers, second and third are Iran and Brazil.  Why traffic is redirected, what happens next with it - we can only guess.  I suppose that the purpose of interception is both the search for new victims for inclusion in someone's botnet, and something like scientific research.  Many people are now concerned about how much data service providers collect on the Internet about us, in order ‚Äúbetter‚Äù for us to advertise goods.  The fact that crime collects information about us in order to attack us later is more dangerous. <br><br>  What to do?  It is clear that we need to do right now: <a href="https://mikrotik.com/download">update the router</a> .  Vulnerabilities soon six months, it is time to.  Then it would be nice to analyze the configuration in order to close access from the outside - it is not required in all cases.  What to do and who is to blame?  The author of the very proof of concept on this vulnerability <a href="https://n0p.me/winbox-bug-dissection/">sums up</a> his mini-study with the words ‚Äúdo not use mikrotik in enterprise‚Äù.  But this is such a dead end: "Oh, horror, we have found a terrible vulnerability, do not buy them ever again."  As if with other routers the situation is better.  In May, <a href="https://threatpost.ru/fbi-seizing-vpnfilter-c2-domain/26244/">it was reported</a> about a powerful botnet assembled by a VPNFilter attack from 500,000 devices, where Mikrotik devices were found, as well as LinkSys, Netgear and TP-Link. <br><br>  In Russia, Mikrotik routers are often used in small and medium-sized businesses, where they are configured either by incoming IT professionals, or by some of the owners-employees, and then, as a rule, they are forgotten: one thing, then the other, works - well.  Old firmware is an indirect indicator of the stable operation of the device.  But it turns out that no matter what router you have, it needs to be updated, you need to configure it with the most secure settings, disable external management interfaces if they are not needed.  Most likely, with the involvement of an external specialist.  Security is not free. <br><br>  <i>Disclaimer: The opinions expressed in this digest may not always coincide with the official position of Kaspersky Lab.</i>  <i>Dear editors generally recommend to treat any opinions with healthy skepticism.</i>  <i>And by the way, this is the 300th blog post on the Lab on Habre for the seven years of its existence.</i>  <i>What we and you, and we congratulate.</i> </div><p>Source: <a href="https://habr.com/ru/post/422879/">https://habr.com/ru/post/422879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../422869/index.html">We master new programming languages, based on the already studied</a></li>
<li><a href="../422871/index.html">Identifying content profiles in VK</a></li>
<li><a href="../422873/index.html">Pizza ala-semi-supervised</a></li>
<li><a href="../422875/index.html">Why you should not rent a VPS / VDS for 200 rubles or how to choose a virtual server</a></li>
<li><a href="../422877/index.html">"Is This IoT?" - learn not to call the Internet of Things everything</a></li>
<li><a href="../422881/index.html">Introducing the SOCI - C ++ Database Access Library</a></li>
<li><a href="../422883/index.html">Your copywriting sucks. Here's how to fix it.</a></li>
<li><a href="../422885/index.html">Gluing two apk-files into one</a></li>
<li><a href="../422887/index.html">Enigma Tamer: Mavis Beity (Lever), Margaret Rock</a></li>
<li><a href="../422891/index.html">Game over, guys</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>