<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unittest and abstract tests</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instead of intro 
 Unittest is probably the most famous framework for writing tests in Python. It is very easy to learn and easy to start using in you...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unittest and abstract tests</h1><div class="post__text post__text-html js-mediator-article"><h3>  Instead of intro </h3><br>  Unittest is probably the most famous framework for writing tests in Python.  It is very easy to learn and easy to start using in your project.  But nothing is perfect.  In this post I want to talk about one opportunity that I personally (I think, not just one) lack in unittest. <br><a name="habracut"></a><br><h3>  A bit about Unit tests </h3><br>  Before discussing (and condemning) the test framework, I consider it necessary to talk a bit about testing in general.  When I first heard the phrase ‚Äúunit testing,‚Äù I thought that these were the duties of some quality control service that checks software modules for compliance.  What was my surprise when I learned that programmers should write these same tests.  The first time I did not write tests ... in general.  Nothing will replace those feelings when you wake up in the morning and read from the user ‚ÄúThe program does not work.  With this urgent need to do something. "  At first it seemed to me that this is a completely normal process, until I wrote the first unit test, which found an error.  Unit tests generally seem useless exactly until they detect a problem.  Now I just can not commit a new feature without writing a test for it. <br>  But tests serve not only to verify the correctness of writing code.  Here is a list of functions that, in my opinion, perform tests: <br><br><ul><li>  Error detection in the program code </li><li>  Making programmers confident that their code works </li><li>  Corollary from the previous paragraph: the ability to safely make changes to the program </li><li>  Tests - a kind of documentation that most accurately describes the behavior of the system. </li></ul><br>  In a sense, tests repeat the structure of the program.  Are program design principles applicable to tests?  I believe that yes - this is the same program, even if it checks another. <br><br><h3>  Description of the problem </h3><br>  At some point, I got the idea to write an abstract test.  What do I mean by this?  This is such a test, which itself is not executed, but declares methods that depend on the parameters defined in the heirs.  And then I discovered that I can not do this humanly in unittest.  Here is an example: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SerializerChecker</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TestCase)</span></span></span><span class="hljs-class">:</span></span> model = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> serializer = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_fields_creation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> props = TestObjectFactory.get_properties_for_model(self.model) obj = TestObjectFactory.create_test_object_for_model(self.model) serialized = self.serializer(obj) self.check_dict(serialized.data, props)</code> </pre> <br>  I think, even without knowing the implementation of TestObjectFactory and the check_dict method, it is clear that props is a property dictionary for an object, obj is an object for which we are testing a serializer.  check_dict checks recursively for matching dictionaries.  I think many who are familiar with c unittest will immediately say that this test does not meet my definition of the abstract.  Why?  Because the test_fields_creation method will run from this class, which we absolutely do not need.  After some searching for information, I came to the conclusion that the most adequate option is not to inherit SerializerChecker from TestCase, but to implement the inheritors something like this: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VehicleSerializerTest</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(SerializerChecker, RecursiveTestCase)</span></span></span><span class="hljs-class">:</span></span> model = Vehicle serializer = VehicleSerialize</code> </pre> <br>  RecursiveTestCase is a descendant of TestCase that implements the check_dict method. <br><br>  This decision is ugly at once from several positions: <br><br><ul><li>  In the SerializerChecker class, we need to know that the descendant must inherit from TestCase.  This dependency can create problems for those unfamiliar with this code. </li><li>  The development environment stubbornly believes that I am wrong, since SerializerChecker does not have a check_dict method </li></ul><br><img src="https://habrastorage.org/webt/kx/qa/gt/kxqagtcytu8pj7df7tz8z_uj5kw.png" alt="image"><br><br>  <i>The error that gives the development environment</i> <br><br>  It may seem that you can simply add a stub for check_dict and all problems are resolved: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SerializerChecker</span></span></span><span class="hljs-class">:</span></span> model = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> serializer = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, data, props)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> NotImplementedError <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_fields_creation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> props = TestObjectFactory.get_properties_for_model(self.model) obj = TestObjectFactory.create_test_object_for_model(self.model) serialized = self.serializer(obj) self.check_dict(serialized.data, props)</code> </pre> <br>  But this is not a complete solution to the problem: <br><br><ul><li>  We, in fact, created an interface that implements not a descendant of this class, but RecursiveTestCase, which creates legitimate questions about the architecture. </li><li>  There are many assert * methods in TestCase.  Do we need to write a stub for each used?  Still seems like a good solution? </li></ul><br><h3>  Summarizing </h3><br>  Unittest does not provide the implied opportunity to "disable" the class inherited from TestCase.  I would be very happy if such a function were added to the framework.  And how do you solve this problem? </div><p>Source: <a href="https://habr.com/ru/post/447438/">https://habr.com/ru/post/447438/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447424/index.html">Reaktive - a multiplatform library for reactive Kotlin</a></li>
<li><a href="../447426/index.html">How, to whom and why go to consulting? Personal experience on the example of Big Data</a></li>
<li><a href="../447430/index.html">IntelliJ IDEA 2019.1: Customizing interface themes, switch expressions from Java 12, debugging inside Docker containers</a></li>
<li><a href="../447434/index.html">With love from Stepik: Hyperskill educational platform</a></li>
<li><a href="../447436/index.html">Webinar "Why do testers?"</a></li>
<li><a href="../447440/index.html">RBKmoney Payments under the hood - the logic of the payment platform</a></li>
<li><a href="../447442/index.html">Introducing shell-operator: it's even easier to create operators for Kubernetes</a></li>
<li><a href="../447446/index.html">IBM workshops: spring-summer 2019 - artificial intelligence, development in the cloud, chat bots, blockchain and other technologies</a></li>
<li><a href="../447448/index.html">Evolution of the intellect: the beginning</a></li>
<li><a href="../447450/index.html">Breaking a simple quack with Ghidra - Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>