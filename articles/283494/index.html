<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Developing a simple pedometer application on ReactNative</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, in programming circles, almost everyone knows about the Facebook library - React. 


 React is based on components. They are similar to the DOM...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Developing a simple pedometer application on ReactNative</h1><div class="post__text post__text-html js-mediator-article"><p><img src="http://www.developer-tech.com/media/img/news/reactive-nativingitup.png.800x600_q96.png" alt="image"><br>  Today, in programming circles, almost everyone knows about the Facebook library - React. </p><br><p>  React is based on components.  They are similar to the DOM elements of the browser, only written not in HTML, but using JavaScript.  Using components, according to Facebook, allows you to write an interface once and display it on all devices.  Everything is clear in the browser (these components are converted to DOM elements), but what about mobile applications?  Here, too, is predictable: React components are converted to native components. </p><br><p>  In this article I want to tell how to develop a simple application pedometer.  A piece of code showing the main points will be displayed.  The whole project is available at the <a href="https://github.com/Singree/react-native-example-app">link to GitHub</a> . </p><br><p>  So, let's begin. </p><a name="habracut"></a><br><h5>  <b>Requirements</b> </h5><br><p>  For iOS development, you will need OS X with Xcode.  With Android, everything is simpler: you can choose from Linux, OS X, Windows.  You will also have to install the Android SDK.  An iPhone and any Android smartphone with a Lollipop on board will be required for combat testing. </p><br><h5>  <b>Creating a project structure</b> </h5><br><p>  To begin, create a project structure.  To manipulate data in the application, we will use the idea of ‚Äã‚Äãflux, namely Redux, as its implementation.  You will also need a router.  As a router, I chose react-native-router-flux, since it supports Redux out of the box. </p><br><p>  A few words about Redux.  Redux is a simple library that stores application state.  You can hang event handlers on the state change, including display rendering.  I would like to get acquainted with redux using video tutorials. </p><br><p>  We proceed to the implementation.  Install react-native-cli with npm, with which we will perform further manipulations with the project. </p><br><pre><code class="javascript hljs">npm install -g react-native-cli</code> </pre> <br><p>  Next, create a project: </p><br><pre> <code class="javascript hljs">react-native init AwesomeProject</code> </pre> <br><p>  Install dependencies: </p><br><pre> <code class="javascript hljs">npm install</code> </pre> <br><p>  As a result, ios and android folders were created at the root of the project, in which there are ‚Äúnative‚Äù files for each of the platforms, respectively.  The index.ios.js and index.android.js files are application entry points. </p><br><p>  Install the necessary libraries: </p><br><pre> <code class="javascript hljs">npm install ‚Äîsave react-native-router-flux redux redux-thunk react-redux lodash</code> </pre> <br><p>  Create a directory structure: </p><br><pre> <code class="javascript hljs"> app/ actions/ components/ containers/ constants/ reducers/ services/</code> </pre> <br><p>  The actions folder will contain functions describing what happens to the data in the store. <br>  components, as the name implies, will contain components of individual interface elements. <br>  The containers contains the root components of each of the pages of the application. <br>  constants - the name speaks for itself. <br>  In reducers there will be so-called ‚Äúreductors‚Äù.  These are functions that change the state of an application depending on the data received. </p><br><p>  Create the app.js folder in the app / containers folder.  The redux wrapper acts as the root element of the application.  All routes are written as ordinary components.  The initial property tells the router which route should work when the application is initialized.  In the component property of the route we pass the component that will be shown when switching to it. </p><br><pre> <code class="javascript hljs">app/containers/app.js &lt;Provider store={store}&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Router</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">hideNavBar</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{true}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Route</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"launch"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">component</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{Launch}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">initial</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{true}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">wrapRouter</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{true}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Launch"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Route</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"counter"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">component</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{CounterApp}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Counter App"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Router</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Provider</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  In the app / containers directory, create launch.js.  launch.js is a normal component with a button to go to the counter page. </p><br><pre> <code class="javascript hljs">app/containers/launch.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Actions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native-router-flux'</span></span>; ‚Ä¶ &lt;TouchableOpacity onPress={Actions.counter}&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Counter</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/TouchableOpacity&gt;</span></span></code> </pre> <br><p>  Actions - an object in which each route corresponds to a method.  The names of such methods are taken from the name property of the route. <br>  In the file app / constants / actionTypes.js, we describe the possible counter events: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> INCREMENT = <span class="hljs-string"><span class="hljs-string">'INCREMENT'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DECREMENT = <span class="hljs-string"><span class="hljs-string">'DECREMENT'</span></span>;</code> </pre> <br><p>  In the app / actions folder, create a file counterActions.js with the contents: </p><br><pre> <code class="javascript hljs">app/actions/counterActions.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> types <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../constants/actionTypes'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">increment</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: types.INCREMENT }; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decrement</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: types.DECREMENT }; }</code> </pre> <br><p>  The increment and decrement functions describe the action taking place to the reducer.  Depending on the action, the reducer changes the state of the application.  initialState - describes the initial state of the repository.  When the application is initialized, the counter will be set to 0. </p><br><pre> <code class="javascript hljs">app/reducers/counter.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> types <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../constants/actionTypes'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">counter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = initialState, action = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> types.INCREMENT: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">count</span></span>: state.count + <span class="hljs-number"><span class="hljs-number">1</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> types.DECREMENT: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">count</span></span>: state.count - <span class="hljs-number"><span class="hljs-number">1</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state; } }</code> </pre> <br><p>  In the counter.js file there are two buttons to decrease and increase the counter value, and the current value is displayed. </p><br><pre> <code class="javascript hljs">app/components/counter.js <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { counter, increment, decrement } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; ‚Ä¶ &lt;Text&gt;{counter}&lt;<span class="hljs-regexp"><span class="hljs-regexp">/Text&gt; &lt;TouchableOpacity onPress={increment} style={styles.button}&gt; &lt;Text&gt;up&lt;/</span></span>Text&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TouchableOpacity</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;TouchableOpacity onPress={decrement} style={styles.button}&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">down</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/TouchableOpacity&gt;</span></span></code> </pre> <br><p>  Event handlers and the value of the counter itself are transferred from the container component.  Consider it below. </p><br><pre> <code class="javascript hljs">app/containers/counterApp.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {bindActionCreators} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Counter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/counter'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> counterActions <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/counterActions'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CounterApp</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { state, actions } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;Counter counter={state.count} {...actions} </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/&gt; ); } } /</span></span></span></span><span class="hljs-function"><span class="hljs-params">*      .   props.state     *</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/ export default connect(state =&gt; ({ state: state.counter }), /</span></span></span></span><span class="hljs-function"><span class="hljs-params">*    .      props.actions.increment(</span></span></span><span class="hljs-function">)  </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">actions</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">decrement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> */ (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">actions</span></span>: bindActionCreators(counterActions, dispatch) }) )(CounterApp);</code> </pre> <br><p>  As a result, we got a simple application that includes the necessary components.  This application can be taken as a basis for any application developed with ReactNative. </p><br><h5>  <b>Diagram</b> </h5><br><p>  Since we are developing a pedometer application, accordingly we need to display the measurement results.  The best way, I think, is a chart.  Thus, we will develop a simple bar chart (bar chart): the Y axis shows the number of steps, and X shows the time. </p><br><p>  ReactNative out of the box does not support canvas and, moreover, to use canvas, you must use a webview.  Thus, there are two options: write a native component for each of the platforms or use a standard set of components.  The first option is the most time-consuming, but, as a result, we get a productive and flexible solution.  Let's stop on the second variant. </p><br><p>  To display the data, we will transfer them to the component as an array of objects: </p><br><pre> <code class="javascript hljs">[ { label, <span class="hljs-comment"><span class="hljs-comment">//     X value, //  color //   } ]</span></span></code> </pre> <br><p>  Create three files: </p><br><pre> <code class="javascript hljs">app/components/chart.js app/components/chart-item.js app/components/chart-label.js</code> </pre> <br><p>  Below is the main component code of the diagram: </p><br><pre> <code class="javascript hljs">app/components/chart.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ChartItem <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./chart-item'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ChartLabel <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./chart-label'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Chart</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> data = props.data || []; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: data, <span class="hljs-attr"><span class="hljs-attr">maxValue</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.countMaxValue(data) } } <span class="hljs-comment"><span class="hljs-comment">/*        .*/</span></span> countMaxValue(data) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data.reduce(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">prev, curn</span></span></span><span class="hljs-function">) =&gt;</span></span> (curn.value &gt;= prev) ? curn.value : prev, <span class="hljs-number"><span class="hljs-number">0</span></span>); } componentWillReceiveProps(newProps) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> data = newProps.data || []; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: data, <span class="hljs-attr"><span class="hljs-attr">maxValue</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.countMaxValue(data) }); } <span class="hljs-comment"><span class="hljs-comment">/*       */</span></span> renderBars() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.data.map(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value, index</span></span></span><span class="hljs-function">) =&gt;</span></span> ( &lt;ChartItem value={value.value} color={value.color} key={index} barInterval={this.props.barInterval} maxValue={this.state.maxValue}/&gt; )); } /*        */ renderLabels() { return this.state.data.map((value, index) =&gt; ( &lt;ChartLabel label={value.label} barInterval={this.props.barInterval} key={index} labelFontSize={this.props.labelFontSize} labelColor={this.props.labelFontColor}/&gt; )); } render() { let labelStyles = { fontSize: this.props.labelFontSize, color: this.props.labelFontColor }; return( &lt;View style={[styles.container, {backgroundColor: this.props.backgroundColor}]}&gt; &lt;View style={styles.labelContainer}&gt; &lt;Text style={labelStyles}&gt; {this.state.maxValue} &lt;/Text&gt; &lt;/View&gt; &lt;View style={styles.itemsContainer}&gt; &lt;View style={[styles.polygonContainer, {borderColor: this.props.borderColor}]}&gt; {this.renderBars()} &lt;/View&gt; &lt;View style={styles.itemsLabelContainer}&gt; {this.renderLabels()} &lt;/View&gt; &lt;/View&gt; &lt;/View&gt; ); } } /*     */ Chart.propTypes = { data: PropTypes.arrayOf(React.PropTypes.shape({ value: PropTypes.number, label: PropTypes.string, color: PropTypes.string })), //    barInterval: PropTypes.number, //    labelFontSize: PropTypes.number, //      labelFontColor: PropTypes.string, //      borderColor: PropTypes.string, //   backgroundColor: PropTypes.string //    } export default Chart;</code> </pre> <br><p>  Component implements the graph column: </p><br><pre> <code class="javascript hljs">app/components/chart-item.js <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ChartItem</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-comment"><span class="hljs-comment">/*    ,     */</span></span> animatedTop: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Animated.Value(<span class="hljs-number"><span class="hljs-number">1000</span></span>), <span class="hljs-comment"><span class="hljs-comment">/*       */</span></span> value: props.value / props.maxValue } } componentWillReceiveProps(nextProps) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">value</span></span>: nextProps.value / nextProps.maxValue, <span class="hljs-attr"><span class="hljs-attr">animatedTop</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Animated.Value(<span class="hljs-number"><span class="hljs-number">1000</span></span>) }); } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { color, barInterval } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-comment"><span class="hljs-comment">/*        */</span></span> Animated.timing(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.animatedTop, {<span class="hljs-attr"><span class="hljs-attr">toValue</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">timing</span></span>: <span class="hljs-number"><span class="hljs-number">2000</span></span>}).start(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>( &lt;View style={[styles.item, {marginHorizontal: barInterval}]}&gt; &lt;Animated.View style={[styles.animatedElement, {top: this.state.animatedTop}]}&gt; &lt;View style={{flex: 1 - this.state.value}} /&gt; &lt;View style={{flex: this.state.value, backgroundColor: color}}/&gt; &lt;/Animated.View&gt; &lt;/View&gt; ); } } const styles = StyleSheet.create({ item: { flex: 1, overflow: 'hidden', width: 1, alignItems: 'center' }, animatedElement: { flex: 1, left: 0, width: 50 } });</code> </pre> <br><p>  Data Signature Component Code: </p><br><pre> <code class="javascript hljs">app/components/chart-label.js <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> ChartLabel = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { label, barInterval, labelFontSize, labelColor } = props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{[{marginHorizontal:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">barInterval</span></span></span></span><span class="xml"><span class="hljs-tag">}, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">styles.label</span></span></span></span><span class="xml"><span class="hljs-tag">]}&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{styles.labelWrapper}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{[styles.labelText,</span></span></span></span><span class="xml"><span class="hljs-tag"> {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fontSize:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">labelFontSize</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">color:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">labelColor</span></span></span></span><span class="xml"><span class="hljs-tag">}]}&gt;</span></span></span><span class="xml"> {label} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); }</code> </pre> <br><p>  As a result, we obtained a simple histogram implemented using a standard set of components. </p><br><h5>  <b>Pedometer</b> </h5><br><p>  ReactNative is a fairly young project that has only the basic set of tools for creating a simple application that takes data from the network and displays it.  But when there is a task of generating data on the device itself, you will have to work with writing modules in native languages ‚Äã‚Äãfor the platforms. </p><br><p>  At this stage, we have to write your pedometer.  Not knowing objective-c and java, as well as api devices, it is difficult to make it, but it is possible, everything rests on time.  Fortunately, there are projects such as Apache Cordova and Adobe PhoneGap.  They have been on the market for quite some time, and the community has written many modules for them.  These modules are easy to port under react.  All logic remains unchanged, you only need to rewrite the interface (bridge). </p><br><p>  In iOS, there is a great api for getting activity data - HealthKit.  Apple has good documentation that even implements ordinary simple tasks.  With Android, the situation is different.  All that we have is a set of sensors.  Moreover, the documentation says that, starting with api 19, it is possible to obtain data from the step sensor.  A huge number of devices work on Android, and bona fide Chinese manufacturers and not only (including quite well-known brands) install only the main set of sensors: accelerometer, light sensor and proximity sensor.  Thus, it is necessary to separately write the code for devices with Android 4.4+ and with a step sensor (as well as for older devices).  This will improve the accuracy of measurements. </p><br><p>  We proceed to the implementation. </p><br><p>  <em>Immediately make a reservation.</em>  <em>I apologize for the quality of the code.</em>  <em>I first encountered these programming languages ‚Äã‚Äãand had to understand at an intuitive level, since time was running out.</em> </p><br><h5>  <b>iOS</b> </h5><br><p>  Create two files with contents: </p><br><pre> <code class="javascript hljs">ios/BHealthKit.h #ifndef BHealthKit_h #define BHealthKit_h #<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> &lt;Foundation/Foundation.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"RCTBridgeModule.h"</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HealthKit; @interface BHealthKit : NSObject &lt;RCTBridgeModule&gt; @property (nonatomic) HKHealthStore* healthKitStore; @end #endif <span class="hljs-comment"><span class="hljs-comment">/* BHealthKit_h */</span></span> ios/BHealthKit.m #<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"BHealthKit.h"</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"RCTConvert.h"</span></span> @implementation BHealthKit RCT_EXPORT_MODULE(); - (NSDictionary *)constantsToExport { NSMutableDictionary *hkConstants = [NSMutableDictionary <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>]; NSMutableDictionary *hkQuantityTypes = [NSMutableDictionary <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>]; [hkQuantityTypes setValue:HKQuantityTypeIdentifierStepCount forKey:@<span class="hljs-string"><span class="hljs-string">"StepCount"</span></span>]; [hkConstants setObject:hkQuantityTypes forKey:@<span class="hljs-string"><span class="hljs-string">"Type"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hkConstants; } <span class="hljs-comment"><span class="hljs-comment">/*         HealthKit */</span></span> RCT_EXPORT_METHOD(askForPermissionToReadTypes:(NSArray *)types callback:(RCTResponseSenderBlock)callback){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!self.healthKitStore){ self.healthKitStore = [[HKHealthStore alloc] init]; } NSMutableSet* typesToRequest = [NSMutableSet <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (NSString* type <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> types) { [typesToRequest addObject:[HKQuantityType quantityTypeForIdentifier:type]]; } [self.healthKitStore requestAuthorizationToShareTypes:nil readTypes:typesToRequest completion:^(BOOL success, NSError *error) { <span class="hljs-comment"><span class="hljs-comment">/*   ,    callback   null,    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(success){ callback(@[[NSNull <span class="hljs-literal"><span class="hljs-literal">null</span></span>]]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/*    callback   */</span></span> callback(@[[error localizedDescription]]); }]; } <span class="hljs-comment"><span class="hljs-comment">/*        .     ,  ‚Äì   ,   ‚Äì callback */</span></span> RCT_EXPORT_METHOD(getStepsData:(NSDate *)startDate endDate:(NSDate *)endDate cb:(RCTResponseSenderBlock)callback){ NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init]; NSLocale *enUSPOSIXLocale = [NSLocale localeWithLocaleIdentifier:@<span class="hljs-string"><span class="hljs-string">"en_US_POSIX"</span></span>]; NSPredicate *predicate = [HKQuery predicateForSamplesWithStartDate:startDate endDate:endDate options:HKQueryOptionStrictStartDate]; [dateFormatter setLocale:enUSPOSIXLocale]; [dateFormatter setDateFormat:@<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd'T'HH:mm:ssZZZZZ"</span></span>]; HKSampleQuery *stepsQuery = [[HKSampleQuery alloc] initWithSampleType:[HKQuantityType quantityTypeForIdentifier:HKQuantityTypeIdentifierStepCount] predicate:predicate limit:<span class="hljs-number"><span class="hljs-number">2000</span></span> sortDescriptors:nil resultsHandler:^(HKSampleQuery *query, NSArray *results, NSError *error) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error){ <span class="hljs-comment"><span class="hljs-comment">/*      ,     callback */</span></span> callback(@[[error localizedDescription]]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } NSMutableArray *data = [NSMutableArray <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HKQuantitySample* sample <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> results) { double count = [sample.quantity doubleValueForUnit:[HKUnit countUnit]]; NSNumber *val = [NSNumber numberWithDouble:count]; NSMutableDictionary* s = [NSMutableDictionary <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>]; [s setValue:val forKey:@<span class="hljs-string"><span class="hljs-string">"value"</span></span>]; [s setValue:sample.sampleType.description forKey:@<span class="hljs-string"><span class="hljs-string">"data_type"</span></span>]; [s setValue:[dateFormatter stringFromDate:sample.startDate] forKey:@<span class="hljs-string"><span class="hljs-string">"start_date"</span></span>]; [s setValue:[dateFormatter stringFromDate:sample.endDate] forKey:@<span class="hljs-string"><span class="hljs-string">"end_date"</span></span>]; [data addObject:s]; } <span class="hljs-comment"><span class="hljs-comment">/*   ,  callback,    null,    ,   ‚Äì  . */</span></span> callback(@[[NSNull <span class="hljs-literal"><span class="hljs-literal">null</span></span>], data ]); }]; [self.healthKitStore executeQuery:stepsQuery]; }; @end</code> </pre> <br><p>  Next, these files need to be added to the project.  Open Xcode, right click on the root directory -&gt; Add Files to ‚Äúproject name‚Äù.  In the Capabilities section, turn on the HealthKit.  Further in the section General -&gt; Linked Frameworks and Libraries click ‚Äú+‚Äù and add HealthKit.framework. </p><br><p>  With the native part finished.  then go directly to the data in the js part of the project. <br>  Create the file app / services / health.ios.js: </p><br><pre> <code class="javascript hljs">app/services/health.ios.js <span class="hljs-comment"><span class="hljs-comment">/*    . BHealthKit   ,     BHealthKit.m */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { BHealthKit } = React.NativeModules; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> auth; <span class="hljs-comment"><span class="hljs-comment">//     function requestAuth() { return new Promise((resolve, reject) =&gt; { BHealthKit.askForPermissionToReadTypes([BHealthKit.Type.StepCount], (err) =&gt; { if (err) { reject(err); } else { resolve(true); } }); }); } //   . function requestData() { let date = new Date().getTime(); let before = new Date(); before.setDate(before.getDate() - 5); /*         ,    .*/ return new Promise((resolve, reject) =&gt; { BHealthKit.getStepsData(before.getTime(), date, (err, data) =&gt; { if (err) { reject(err); } else { let result = {}; /*           */ for (let val in data) { const date = new Date(data[val].start_date); const day = date.getDate(); if (!result[day]) { result[day] = {}; } result[day]['steps'] = (result[day] &amp;&amp; result[day]['steps'] &gt; 0) ? result[day]['steps'] + data[val].value : data[val].value; result[day]['date'] = date; } resolve(Object.values(result)); } }); }); } export default () =&gt; { if (auth) { return requestData(); } else { return requestAuth().then(() =&gt; { auth = true; return requestData(); }); } }</span></span></code> </pre> <br><h5>  <b>Android</b> </h5><br><p>  The code turned out to be voluminous, so I will describe the principle of operation. </p><br><p>  Android SDK does not provide storage, referring to which you can get data for a certain period of time, but only the possibility of obtaining data in real time.  To do this, use services that are constantly running in the background and perform the necessary tasks.  On the one hand, this is very flexible, but suppose that twenty pedometers are installed on the device and each application will have its own service that performs the same task as the other 19. </p><br><p>  We implement two services: for devices with a step sensor and without.  These are android / app / src / main / java / com / awesomeproject / pedometer / StepCounterService.java and android / app / src / main / java / com / awesomeproject / pedometer / StepCounterOldService.java files. </p><br><p>  In the android / app / src / main / java / com / awesomeproject / pedometer / StepCounterBootReceiver.java file, when the device starts, we describe which service will start depending on the device. </p><br><p>  In the android / app / src / main / java / com / awesomeproject / RNPedometerModule.java and RNPedometerPackage.java files, we implement the connection of the application with react. </p><br><p>  We get permission to use sensors by adding lines to android / app / src / main / AndroidManifest.xml </p><br><pre> <code class="javascript hljs">&lt;uses-feature android:name=<span class="hljs-string"><span class="hljs-string">"android.hardware.sensor.stepcounter"</span></span> android:required=<span class="hljs-string"><span class="hljs-string">"true"</span></span>/&gt; &lt;uses-feature android:name="android.hardware.sensor.stepdetector" android:required=‚Äútrue"/&gt; &lt;uses-feature android:name="android.hardware.sensor.accelerometer" android:required="true" /&gt;      ,    ,       . &lt;application&gt; ‚Ä¶ &lt;service android:name=".pedometer.StepCounterService"/&gt; &lt;service android:name=".pedometer.StepCounterOldService" /&gt; &lt;receiver android:name=".pedometer.StepCounterBootReceiver"&gt; &lt;intent-filter&gt; &lt;action android:name="android.intent.action.BOOT_COMPLETED" /&gt; &lt;/intent-filter&gt; &lt;/receiver&gt; &lt;/application&gt;</code> </pre> <br><p>  We connect the module to the application and run the services when the application starts. </p><br><pre> <code class="javascript hljs">android/app/src/main/java/com/awesomeproject/MainActivity.java ‚Ä¶ protected List&lt;ReactPackage&gt; getPackages() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Arrays.&lt;ReactPackage&gt;asList( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MainReactPackage(), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RNPedometerPackage(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) ); } ‚Ä¶ @Override public <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> onCreate(Bundle bundle) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(bundle); <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> can = StepCounterOldService.deviceHasStepCounter(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getPackageManager()); <span class="hljs-comment"><span class="hljs-comment">/*      ,      */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!can) { startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, StepCounterService.class)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, StepCounterOldService.class)); } }</code> </pre> <br><p>  Getting data javascript part.  Create app / services / health.android.js <br>  const Pedometer = React.NativeModules. PedometerAndroid; </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">/*      ,     . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> { Pedometer.getHistory(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { result = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(result); <span class="hljs-comment"><span class="hljs-comment">//      result = Object.keys(result).map((key) =&gt; { let date = new Date(key); date.setHours(0); return { steps: result[key].steps, date: date } }); resolve(result); } catch(err) { reject(err); }; }, (err) =&gt; { reject(err); }); }); }</span></span></code> </pre> <br><p>  As a result, we received two files, health.ios.js and health.android.js, which receive statistics on user activity from native platform modules.  Further, anywhere in the application expression: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Health <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;path&gt;health'</span></span>;</code> </pre> <br><p>  React Native connects the desired file, based on the prefix of the files.  Now we can use this function, without thinking, the application is running on IOS or Android. </p><br><p>  As a result, we wrote a simple pedometer application and reviewed the main points that you have to go through when developing your own application. </p><br><p>  In the end I want to highlight the advantages and disadvantages of ReactNative. </p><br><h6>  Benefits: </h6><br><ol><li>  a developer with JavaScript development experience can easily write an application; </li><li>  developing one application, you immediately get the opportunity to run it on Android and IOS; </li><li>  ReactNative has a fairly large set of implemented components that will often cover all your requirements; </li><li>  active community, which is rapidly writing various modules. </li></ol><br><h6>  Disadvantages: </h6><br><ol><li>  the same code does not always run smoothly on both platforms (often display problems); </li><li>  with a specific task, there are often no implemented modules and you have to write them yourself; </li><li>  performance.  In comparison with PhoneGap and Cordova, react is very fast, but still the native application will be faster. </li></ol><br><h6>  When is it advisable to choose ReactNative? </h6><br><p>  If you need to develop a simple application to retrieve data from the server and display it, then the choice is obvious.  If you are faced with the task of implementing a cool design, performance is critical, or there is a task that is difficult to solve with ready-made components, then you should think about it.  Since most will have to write in the native languages ‚Äã‚Äãof the platforms, building a pyramid from this is definitely not the best option. </p><br><p>  Thanks for attention. </p><br><p>  The article was prepared by: <a href="https://habrahabr.ru/users/greebn9k/" class="user_link">greebn9k</a> (Sergey Gribnyak), <a href="https://habrahabr.ru/users/boozzd/" class="user_link">boozzd</a> (Dmitry Shapovalenko), <a href="https://habrahabr.ru/users/silmarilion/" class="user_link">silmarilion</a> (Andrey Khakharev) </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/283494/">https://habr.com/ru/post/283494/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../283482/index.html">Once again about how not to make a ‚Äúsieve‚Äù from your network</a></li>
<li><a href="../283484/index.html">Errors when connecting payments on the Internet</a></li>
<li><a href="../283488/index.html">Removing the image from the OV7670 camera to a VGA monitor using FPGA</a></li>
<li><a href="../283490/index.html">Vulkan API (glNext) from Khronos Group</a></li>
<li><a href="../283492/index.html">Let's collect a moss-mite under a microscope or focus-stacking photos from the console</a></li>
<li><a href="../283496/index.html">In the Opera browser appeared power saving mode</a></li>
<li><a href="../283498/index.html">Announcement of the track Windows conference DevCon 2016</a></li>
<li><a href="../283502/index.html">Chess Ice and Flame</a></li>
<li><a href="../283504/index.html">Features of testing technology C / R in Linux</a></li>
<li><a href="../283508/index.html">Introducing the new Intel RealSense SR300 Camera</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>