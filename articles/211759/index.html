<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing software from source for MGTS ZTE F-660 router in chroot environment</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all! Thanks largely to MGTS and its GPON optical network, I became acquainted with the ZTE f-660 optical modem router. As soon as this device...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing software from source for MGTS ZTE F-660 router in chroot environment</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/676/175/7f2/6761757f23dadbb85701c87756d31b78.jpg"><br>  Hello to all!  Thanks largely to MGTS and its GPON optical network, I became acquainted with the ZTE f-660 optical modem router.  As soon as this device appeared at home, I immediately had the idea to install some firmware with software like dd-wrt or open-wrt. <br><a name="habracut"></a><br>  During external examination, a usb port was detected at the router. <br>  The following ways of using a router for domestic purposes came to mind: <br><ol><li>  SipProxy server; </li><li>  Torrent client; </li><li>  FTP server; </li><li>  Dlna server; </li><li>  Primitive web hosting. </li></ol><br>  Internet search did not give anything.  At various forums, there is basically a discussion of how to hang the wall or how to open the ports, moreover, I did not even find the ‚Äústock‚Äù firmware for it. But the router has telnet access (root root). When I started studying the inside of the firmware, I realized that everything is not so simple. The current firmware is tightly tied to the telephony and the optical modem, and changing it, I‚Äôll probably lose both the phone and the Internet at best, and at worst, the router can‚Äôt be restored without repairing. Besides, it can lead to penalties from MGTS for the replacement of ro  loss in the amount of ~ 1500R. <br>  The only option that I saw at that moment is to launch the programs I need in the chroot environment from a flash drive formatted in ntfs.  Naturally, I wanted to use the latest versions of the programs.  So I decided to compile everything from source. <br>  After examining the hardware base, I determined that there stands a regular mips processor running under Linux 2.6.30.  Accordingly, we need to build gcc-tools for this architecture.  To build the tulchan, I chose the usual ubuntu. <br>  Before installation, we need to put development tools <br><pre><code class="bash hljs">sudo apt-get install gcc g++ make grep gawk automake</code> </pre> <br>  I will give the script below, and here I will describe the general plan and what you need to pay special attention to: <br>  No patches needed; <br>  The call syntax is as follows ./make-mips-toolchan &lt;full path created by toolchan&gt;; <br>  To download all sources, use the get parameter; <br>  Do not use the option -j&gt; 1, fails to get a bunch of non-deterministic errors (Under ubuntu and gcc 4.8.1); <br>  CLFS = ‚Äú$ 1‚Äù directory in which we put the tulchan.  SYSROOT = ‚Äú$ CLFS / root‚Äù, the directory in which the result of the tool will be installed; <br>  If it doesn‚Äôt meet the first time, comment on the steps already completed in the script and continue further; <br>  In the script, the second parameter is the path to which the tulchans should be placed; <br>  Installation steps are as follows: <br><ul><li>  Put the kernel sources 2.6.30; </li><li>  We put utilities for working with binary files (linker) binutils; </li><li>  Put mips gcc cross-compiler (no support for threads); </li><li>  We use it to build the standard C library (eglibc); </li><li>  With the help of the standard library collected in the previous paragraph, we will assemble a full-fledged c ++ tulchan; </li></ul><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh TARGET="mips-unknown-linux-gnu" CLFS="$1" SYSROOT="$CLFS/root" HOST="x86_64-pc-linux-gnu" LINUX_VERSION=2.6.30 BINUTILS_VERSION=2.24 GCC_VERSION=4.8.2 EGLIB_VERSION=2.18-r24148 unset CFLAGS unset CXXFLAGS check_success() { if [ $? -ne 0 ] then echo Failed exit 1 fi echo Done } if [ "$2" = "get" ] then echo -n "Download sources..." wget http://www.kernel.org/pub/linux/kernel/v2.6/linux-$LINUX_VERSION.tar.bz2 wget http://ftp.gnu.org/gnu/binutils/binutils-$BINUTILS_VERSION.tar.gz wget http://ftp.gnu.org/gnu/gcc/gcc-$GCC_VERSION/gcc-$GCC_VERSION.tar.bz2 wget http://cross-lfs.org/files/eglibc-$EGLIB_VERSION.tar.xz echo -n "Extract archives..." tar -xjf linux-$LINUX_VERSION.tar.bz2 tar -xf binutils-$BINUTILS_VERSION.tar.gz tar -xjf gcc-$GCC_VERSION.tar.bz2 tar -xf eglibc-$EGLIB_VERSION.tar.xz cd ./gcc-$GCC_VERSION/ ./contrib/download_prerequisites cd .. check_success fi if [ "$2" = "clear" ] then rm -rfv $CLFS mkdir -p $SYSROOT check_success exit 1 fi mkdir -p $SYSROOT InstallKernelHeader() { echo -n "Install kernel headers..." cd linux-$LINUX_VERSION/ make mrproper make ARCH=mips headers_check make ARCH=mips INSTALL_HDR_PATH=$SYSROOT/usr headers_install cd .. check_success } InstallBinutils() { echo -n "Install binutils..." mkdir mips-binutils cd mips-binutils rm -rf ./* ../binutils-$BINUTILS_VERSION/configure --prefix=$CLFS --target=$TARGET --with-sysroot=$SYSROOT --disable-nls --disable-static --disable-multilib --enable-plugins make check_success make install check_success cd .. } InstallStaticGCC() { echo -n "Install static gcc..." mkdir mips-static-gcc cd mips-static-gcc rm -rf ./* ../gcc-$GCC_VERSION/configure --target=$TARGET --prefix=$CLFS --with-sysroot=$SYSROOT --disable-nls --disable-shared --without-headers --with-newlib --disable-decimal-float --disable-libgomp --disable-libmudflap --disable-libssp --disable-threads --disable-multilib --disable-libatomic --disable-libitm --disable-libsanitizer --disable-libquadmath --disable-target-libiberty --enable-languages=c --enable-checking=release make all-gcc check_success make all-target-libgcc check_success make install-gcc install-target-libgcc check_success cd .. } InstallEGLIB() { echo -n "Install eglibs header files..." mkdir mips-eglibs cd mips-eglibs rm -rf ./* BUILD_CC="gcc" \ CC="$CLFS/bin/$TARGET-gcc" \ AR="$CLFS/bin/$TARGET-ar" \ RANLIB="$CLFS/bin/$TARGET-ranlib" \ ../eglibc/libc/configure \ --prefix=/usr \ --with-headers=$SYSROOT/usr/include \ --build=$HOST \ --host=$TARGET \ --disable-profile --without-gd --without-cvs --enable-add-ons check_success make check_success make install install_root=$SYSROOT check_success cd .. } InstallFinallGCC() { echo -n "Install final gcc..." mkdir mips-final-gcc cd mips-final-gcc rm -rf ./* ../gcc-4.8.2/configure --prefix=$CLFS \ --build=$HOST --target=$TARGET --host=$HOST \ --with-sysroot=$SYSROOT --enable-shared --disable-static --enable-languages=c,c++ \ --with-libs=$SYSROOT/lib \ --enable-__cxa_atexit --enable-c99 --enable-long-long --enable-threads=posix \ --disable-multilib \ --enable-checking=release \ --disable-nls \ --enable-libstdcxx-time make AS_FOR_TARGET="$CLFS/bin/$TARGET-as" LD_FOR_TARGET="$CLFS/bin/$TARGET-ld" -j 4 check_success make install check_success cp $CLFS/mips-unknown-linux-gnu/lib/libgcc_s.so $SYSROOT/usr/lib cd $SYSROOT/usr/lib ln -s ./libgcc_s.so ./libgcc_s.so.1 cd - cd .. } InstallKernelHeader InstallBinutils InstallStaticGCC InstallEGLIB InstallFinallGCC</span></span></code> </pre><br>  From this point on, you have a full-fledged gcc-tulchan who is able to build programs under our router.  To do this, we need to specify the compiler and linker from the newly compiled toolchain to the stage of program configuration: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">unset</span></span> CFLAGS <span class="hljs-built_in"><span class="hljs-built_in">unset</span></span> CXXFLAGS <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> LD=<span class="hljs-string"><span class="hljs-string">"mips-unknown-linux-gnu-ld"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> CC=<span class="hljs-string"><span class="hljs-string">"mips-unknown-linux-gnu-gcc"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> AR=<span class="hljs-string"><span class="hljs-string">"mips-unknown-linux-gnu-gcc-ar"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> RANLIB=<span class="hljs-string"><span class="hljs-string">"mips-unknown-linux-gnu-ranlib"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> STRIP=‚Äúmips-unknown-linux-gnu-strip‚Äù</code> </pre><br>  All tools are ready and we can start assembling programs. <br>  As an example, we will collect the torrent client Transsmission and the sip proxy Sipproxd.  The general plan is: <br><ol><li>  Build statically linked bash interceptor; </li><li>  Building GnuInetCoreUtills networking utilities; </li><li>  Building basic utilities GnuCoreUtills; </li><li>  Build a text interface library NCurses (Need for Nano); </li><li>  Assembling the console notebook needed to edit the Nano configuration files; </li><li>  Build Zlib compression library; </li><li>  Build an openssl cryptographic library; </li><li>  Build a network library Curl (Need for transsmission); </li><li>  Build a library of events LibEvent (Need for transsmission); </li><li>  Build torrent client transsmission; </li><li>  Build the GnuSip library; </li><li>  Build SipProxy. </li></ol><br>  During the build process, I had to apply a series of patches, all of which are very simple, add or remove no more than one line. <br><br>  The script itself: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash check_success() { if [ $? -ne 0 ] then echo Failed exit 1 fi echo Done } if [ "$2" = "get" ] then echo -n "Download sources..." wget "http://ftp.gnu.org/gnu/coreutils/coreutils-8.22.tar.xz" wget "http://ftp.gnu.org/gnu/bash/bash-4.2.tar.gz" wget "http://www.openssl.org/source/openssl-1.0.1e.tar.gz" wget "http://zlib.net/zlib-1.2.8.tar.gz" wget "http://mirror.yandex.ru/pub/OpenBSD/OpenSSH/portable/openssh-6.4p1.tar.gz" wget "http://curl.haxx.se/download/curl-7.34.0.tar.gz" wget "http://download.transmissionbt.com/files/transmission-2.82.tar.xz" wget "http://ftp.gnu.org/gnu/inetutils/inetutils-1.9.2.tar.gz" wget "http://ftp.gnu.org/pub/gnu/ncurses/ncurses-5.9.tar.gz" wget "http://www.nano-editor.org/dist/v2.2/nano-2.2.6.tar.gz" wget "https://github.com/downloads/libevent/libevent/libevent-2.0.21-stable.tar.gz" wget "http://siproxd.tuxworld.ch/siproxd-01Feb2014.tar.gz" wget "http://ftp.gnu.org/gnu/osip/libosip2-4.1.0.tar.gz" echo -n "Extract archives..." tar -xf zlib-1.2.8.tar.gz &amp;&amp; rm zlib-1.2.8.tar.gz* tar -xf openssl-1.0.1e.tar.gz &amp;&amp; rm openssl-1.0.1e.tar.gz* tar -Jxf coreutils-8.22.tar.xz &amp;&amp; rm coreutils-8.22.tar.xz* tar -xf bash-4.2.tar.gz &amp;&amp; rm bash-4.2.tar.gz* tar -xf openssh-6.4p1.tar.gz &amp;&amp; rm openssh-6.4p1.tar.gz* tar -xf curl-7.34.0.tar.gz &amp;&amp; rm curl-7.34.0.tar.gz* tar -xf transmission-2.82.tar.xz &amp;&amp; rm transmission-2.82.tar.xz* tar -xf inetutils-1.9.2.tar.gz &amp;&amp; rm inetutils-1.9.2.tar.gz* tar -xf ncurses-5.9.tar.gz &amp;&amp; rm ncurses-5.9.tar.gz* tar -xf nano-2.2.6.tar.gz &amp;&amp; rm nano-2.2.6.tar.gz* tar -xf libevent-2.0.21-stable.tar.gz &amp;&amp; rm libevent-2.0.21-stable.tar.gz* tar -xf siproxd-01Feb2014.tar.gz &amp;&amp; rm siproxd-21Jan2014.tar.gz* tar -xf libosip2-4.1.0.tar.gz &amp;&amp; rm libosip2-4.1.0.tar.gz* check_success fi InstallCoreUtils() { cd coreutils-8.22 make clean ./configure --prefix=/ --host=$HOST patch Makefile &lt; ../dummymake.patch patch ./man/dummy-man &lt; ../dummyman.patch make -j 4 make install DESTDIR=$SYSROOT cd .. } InstallBash() { cd bash-4.2 make clean ./configure --without-bash-malloc --prefix=/ --host=$HOST #--enable-static-link patch execute_cmd.c &lt; ../bashjobcontrol.patch make -j 4 check_success make install DESTDIR=$SYSROOT check_success cd .. } InstallInetUtils() { cd inetutils-1.9.2 make clean ./configure --prefix=/usr --host=$HOST patch ./ifconfig/system/linux.c &lt; ../inetutilpathprocspath.patch make -j 4 check_success make install DESTDIR=$SYSROOT check_success cd .. } InstallZlib() { cd zlib-1.2.8 make clean ./configure --prefix=/usr make -j 4 check_success make install DESTDIR=$SYSROOT check_success cd .. } InstallOpenSSl() { cd openssl-1.0.1e make clean ./Configure linux-elf --prefix=/usr no-asm -fPIC make check_success make install INSTALL_PREFIX=$SYSROOT check_success cd .. } InstallOpenSSH() { cd openssh-6.4p1 make clean ./configure --prefix=/usr --host=$HOST --sysconfdir=/etc/ssh make LDFLAGS="-dynamic-linker /lib/ld.so.1 $SYSROOT/usr/lib/crt1.o $SYSROOT/usr/lib/crti.o $SYSROOT/usr/lib/crtn.o -L. -Lopenbsd-compat/ -L$SYSROOT/lib -lc -lgcc_s" CFLAGS="-DHAVE_SETLOGIN -UHAVE_PROC_PID -fPIC -g -O2 -Wall -Wpointer-arith -Wuninitialized -Wsign-compare -Wformat-security -Wsizeof-pointer-memaccess -Wno-pointer-sign -Wno-unused-result -fno-strict-aliasing -D_FORTIFY_SOURCE=2 -fno-builtin-memset -fstack-protector-all" -j 3 check_success -j 4 make DESTDIR=$SYSROOT STRIP_OPT="--strip-program=mips-unknown-linux-gnu-strip" install-nokeys check_success cd .. } InstallCurl() { cd curl-7.34.0 make clean ./configure --prefix=/usr --host=$HOST make check_success make install DESTDIR=$SYSROOT check_success cd .. } InstallLibEvent() { cd libevent-2.0.21-stable make clean ./configure --prefix=/usr --host=$HOST make -j 4 check_success make install DESTDIR=$SYSROOT check_success cd .. } InstallTransmission() { cd transmission-2.82 make clean with_ssl=$SYSROOT/usr CFLAGS="-w" \ LIBEVENT_CFLAGS="-I$SYSROOT/usr/include/curl" LIBEVENT_LIBS="-L$SYSROOT/usr/lib/ -levent" \ LIBCURL_CFLAGS="-I$SYSROOT/usr/include/event2" LIBCURL_LIBS="-L$SYSROOT/usr/lib/ -lcurl" \ LDFLAGS="-L$SYSROOT/usr/lib/ -lssl -ldl" \ ./configure --prefix=/usr --host=$HOST --disable-gtk --disable-cli --disable-libnotify --disable-nls --disable-mac --disable-wx --disable-beos make -j 4 check_success make install DESTDIR=$SYSROOT check_success cd .. } InstallNcurses() { cd ncurses-5.9 make clean ./configure --prefix=/usr --host=$HOST make check_success make install DESTDIR=$SYSROOT check_success cd .. } InstallNano() { cd nano-2.2.6 mkdir buidnano cd buidnano rm -rfv ./* make clean ../configure --prefix=/usr --host=$HOST CFLAGS="-I$SYSROOT/usr/include/ncurses" make -j 4 check_success make install DESTDIR=$SYSROOT check_success cd ../.. } InstallLibSip() { cd libosip2-4.1.0 make clean ./configure --prefix=/usr --host=$HOST make -j 4 check_success make install DESTDIR=$SYSROOT check_success cd .. } InstallSipProxd() { cd siproxd-0.8.2dev make clean ./configure --prefix=/usr --host=$HOST --with-libosip-prefix=$SYSROOT/usr replacestr=$SYSROOT/usr/lib sed -i -e 's|/usr/lib|'$replacestr'|g' $SYSROOT/usr/lib/libosipparser2.la sed -i -e 's|/usr/lib|'$replacestr'|g' $SYSROOT/usr/lib/libosip2.la patch ./src/dejitter.c &lt; ../siproxytime.patch make -j 4 check_success make install DESTDIR=$SYSROOT check_success cd .. } CLFS="$1" SYSROOT="$CLFS/root" HOST="mips-unknown-linux-gnu" export PATH=$CLFS/bin/:$PATH unset CFLAGS unset CXXFLAGS export LD="mips-unknown-linux-gnu-ld" export CC="mips-unknown-linux-gnu-gcc" export AR="mips-unknown-linux-gnu-gcc-ar" export RANLIB="mips-unknown-linux-gnu-ranlib" export STRIP="mips-unknown-linux-gnu-strip" InstallBash InstallInetUtils InstallCoreUtils InstallNcurses InstallNano InstallZlib InstallOpenSSl #InstallOpenSSH InstallCurl InstallLibEvent InstallTransmission InstallLibSip InstallSipProxd</span></span></code> </pre><br><br>  Next, you need to transfer our root folder which is located in the directory of our tool to a pre-formatted nfts flash drive.  Also on the USB flash drive you need to put a statically linked busybox ready can be taken from here: <a href="http://www.busybox.net/downloads/binaries/latest/busybox-mips">www.busybox.net/downloads/binaries/latest/busybox-mips</a> . <br>  Next, we need to "jump" into our sandbox by running a small script: <br><pre> <code class="bash hljs"><span class="hljs-meta"><span class="hljs-meta">#!/bin/ash export TERMINFO=/usr/share/terminfo export HOME=/root cp -rf /etc/* /mnt/usb1_1/root/etc mkdir -p /mnt/usb1_1/root/root mkdir -p /mnt/usb1_1/root/dev mkdir -p /mnt/usb1_1/root/proc mkdir -p /mnt/usb1_1/root/sys mkdir -p /mnt/usb1_1/root/dev/pts mount -o bind /dev /mnt/usb1_1/root/dev mount -o bind /proc /mnt/usb1_1/root/proc mount -o bind /sys /mnt/usb1_1/root/sys mount -o bind /dev/pts /mnt/usb1_1/root/dev/pts ./busybox-mips chroot /mnt/usb1_1/root/ /bin/bash</span></span></code> </pre><br>  We will see the bash interpreter command line.  Perform dynamic library configuration with the ldconfig -v command <br>  From this point on, we can do anything as we are separated from the main system. <br>  Let's start the transmission-daemon torrent client.  Go to 192.168.1.1:9091.  We see the standard response to unauthorized access <br><img src="//habrastorage.org/files/de7/e46/f43/de7e46f433c146ae9f1d3d6c487f3fad.png"><br>  Next, you need to edit the settings file (it was just created) <br><pre> <code class="bash hljs">nano /root/.config/transmission-daemon/settings.json</code> </pre><br>  Replace settings <br>  "Rpc-whitelist": "127.0.0.1" <br>  On <br>  "Rpc-whitelist": ‚Äú*. *. *. *‚Äù 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Press F2 to save and exit. <br>  Restart the daemon.  Go to the same address. <br><img src="//habrastorage.org/files/1aa/bb4/84b/1aabb484be204606965bb95dbc9ec598.png"><br>  Next, I will make a small digression and tell you about Sip-Proxy and the system which I understand is now used in MGTS.  Now MGTS almost completely rejects analog communication.  All calls go on the sip protocol, those in fact our router is essentially a normal sip client.  Consequently, we can use any sip-phone and connect to the sip-server and call from the Moscow number from anywhere.  It sounds tempting, but there is one problem.  The fact is that we can not connect to the SIP server as we are behind naty (in this judgment I do not claim objectivity just one of the versions).  We can use a sip proxy as a solution.  He will deal with the transfer of packets from clients to the server, pretending that he is a client, as the usual http-proxy actually does. <br>  Let's make some changes to the configuration file. <br>  cd / usr / etc / <br>  cp ./siproxd.conf.example ./siproxd.conf <br>  nano ./siproxd.conf <br>  We make the following changes: <br>  if_inbound = br0 <br>  if_outbound = nbif1 <br>  daemonize = 0 <br>  outbound_proxy_host = 192.168.68.97 <br>  outbound_proxy_port = 5060 <br>  F2-save <br>  Let's run the proxy server itself in logging mode <br>  siproxd -d -1 0 <br>  Let us enter the sip client settings in the router itself and indicate that the proxy is now itself.  After pressing the button to apply, we see how the logs are packets from our client. <br><img src="//habrastorage.org/files/e4e/59c/b84/e4e59cb8466e4b298b8c8d8ae0e8d9f1.png"><br>  00:16:23 accessctl.c: 99 access check = 3 <br>  00:16:23 security.c: 48 security_check_raw: size = 440 <br>  00:16:23 siproxd.c: 481 checking Max-Forwards (= 70) <br>  00:16:23 siproxd.c: 526 received SIP type REQ: REGISTER <br>  00:16:23 utils.c: 129 DNS lookup - previous resolution failed: msk.ims.mgts.ru <br><br>  But for some reason, the proxy tries to get the server address, instead of simply passing on the packet without change.  To be honest, this is one of the reasons why I posted an article on Habr√©.  I just do not know how to solve this problem, and I hope that the community will help to solve this problem. <br><br>  To summarize: as we can see, we managed to build a fairly large amount of software from sources.  I would especially like to note that all the collected software is fresh, we did not have to either flash the device or use any ancient repository.  At the same time, we used very simple patches.  If the note causes sufficient interest in the habr-community and I manage to solve the problem of sip-proxy, then in my next note I can consider issues related to installing on a multi-route router openssh, softether VPN and launching x11 applications.  In general, I would like to receive feedback and other articles on this topic from other authors may appear, because this terminal is very common in Moscow. <br><br>  Scripts and patches are in the <a href="http://yadi.sk/d/1KB-jaooHinYw">archive</a> . <br>  Update (Links corrected): <br>  For the laziest <a href="http://yadi.sk/d/mWN61cM0HimBj">archive</a> from the root directory of the stick, with installed programs </div><p>Source: <a href="https://habr.com/ru/post/211759/">https://habr.com/ru/post/211759/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../211741/index.html">6 things that Satya Nadella has to do right now</a></li>
<li><a href="../211743/index.html">Using CRTP Pattern in C #</a></li>
<li><a href="../211747/index.html">Do you know arrays?</a></li>
<li><a href="../211751/index.html">Just about make</a></li>
<li><a href="../211755/index.html">Bacula: for those who need to quickly and in pictures</a></li>
<li><a href="../211761/index.html">New buttons and a single payment solution Yandex.Money: two free seminars in Moscow</a></li>
<li><a href="../211763/index.html">IT certification from an employer's perspective</a></li>
<li><a href="../211765/index.html">The first version of the Cppcheck integration module in Visual Studio with open source has been released.</a></li>
<li><a href="../211767/index.html">What bread crumbs do online stores need (68% of websites make mistakes)?</a></li>
<li><a href="../211771/index.html">Athletes in Sochi allowed to use Apple devices</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>