<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to load FREEBSD</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="To begin with, we will describe the patient. I disassembled FREEBSD 8.0 Stable, namely the most minimal image for booting from CD-ROM (44 MB). I chose...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to load FREEBSD</h1><div class="post__text post__text-html js-mediator-article">  To begin with, we will describe the patient.  I disassembled FREEBSD 8.0 Stable, namely the most minimal image for booting from CD-ROM (44 MB).  I chose it because it is the smallest and most convenient (for the proceedings). <br>  So, the start for loading is standard - at address 0000: 7C00 the boot sector is loaded (just do not forget that the CD-ROM sector has 2 Kb each), and it is launched for execution.  As it turned out, with this CD-ROM, this sector is also a file / boot / cdboot, 1201 bytes in size.  This file consists of two parts - the main and a small stub, which will be needed later.  That is, we have a memory card like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f5/171/da5/4f5171da592bb2de61485fd21c6f0d20.png" alt="image"><br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What does this file CDBOOT?  Pretty much everything.  First, it loads the / boot / loader file at 0000: 9000, but immediately transfers it to the area under two megabytes (00200000).  This file consists of three parts.  Let's call them BTXLDR, BTX and LOADER. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a95/4a3/ec9/a954a3ec901a954b5d7b8920fd83e2e7.png" alt="image"><br><br>  Then he transfers the BTX back (to address 0000: 9000). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26e/e97/142/26ee97142e93272ba920bada784e4055.png" alt="image"><br><br>  Then he transfers the stub to the address 0000: A000 and launches the BTX program (from the address 0000: 9000).  That's all, CDBOOT doesn't work anymore, so we won't draw it: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a0/cc6/904/2a0cc69045fea1e47e11a94f39992c95.png" alt="image"><br><br>  BTX works further.  The only task of this program is to set up a protected mode environment and start another program (from the address A000).  Therefore, BTX configures interrupts, a table of descriptors, a task segment, and other wisdom of protected mode and starts the program from address A000.  And there, as you can see, we have a stub.  So it starts. <br>  The stub is a stub and that does almost nothing.  It causes a 30H interrupt with EAX = 1, passing the address 00200000 by the parameter. This interrupt is intercepted by the BTX and it starts to process it.  This interruption in BTX means the EXEC function, that is, ‚Äústart the program from the given address‚Äù.  Since the address is 00200000, BTXLDR is launched. <br>  BTXLDR is needed to solve one problem: the LOADER file is a standard ELF file typical of FREEBSD (and not only).  But the kernel is not there yet, and there is no one to handle such files.  Therefore, BTXLDR simply converts the ELF file into a regular set of codes, without any headers.  After this, the LOADER is transferred to the address 0000: A000. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/672/d90/102/672d9010248e511f1e7a31aaa5f67bf9.png" alt="image"><br><br>  And then ... There is a transition to the address 0000: 9000.  There we have a BTX.  Yes!  BTX is working the second time.  As you remember, it sets up protected mode and starts the program from address 0000: A000.  That's just where there is no longer a stub, but a full-fledged program - LOADER, without any headers, only the code. <br>  To tell what a LOADER is, you need not one article, but this one will end here.  If anyone is interested, then articles about LOADER will appear soon. </div><p>Source: <a href="https://habr.com/ru/post/131679/">https://habr.com/ru/post/131679/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../131671/index.html">Mouse and keyboard for PS3. Pleasant addition or necessary attribute?</a></li>
<li><a href="../131672/index.html">Training center MUK: schedule courses for November-December</a></li>
<li><a href="../131674/index.html">The second project of Glavstarta - "Sea Salons"</a></li>
<li><a href="../131675/index.html">Smoshniki whitewash</a></li>
<li><a href="../131676/index.html">Results Opera Startup Awards</a></li>
<li><a href="../131680/index.html">Export to ODT and Recognition of Old Texts Now Online</a></li>
<li><a href="../131681/index.html">Droider Chart. Issue 76 Bleed</a></li>
<li><a href="../131682/index.html">Interactive Embedded Solutions at Integrated Systems Russia</a></li>
<li><a href="../131683/index.html">What do I feel buying apps?</a></li>
<li><a href="../131684/index.html">APNG (animated PNG) in Google Chrome, Safari and IE</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>