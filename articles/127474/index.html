<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Virus without programming</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 A good friend, in his spare time engaged in repairing computers, shared another caught virus. Popular antivirus did not define it, whic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Virus without programming</h1><div class="post__text post__text-html js-mediator-article"><h5>  Introduction </h5><br>  A good friend, in his spare time engaged in repairing computers, shared another caught virus.  Popular antivirus did not define it, which is not surprising, and soon you will understand why. <br><br>  The process was hidden from the Windows Task Manager, but the Auslogics Task Manager displayed it as upp1.exe, located in the System32 directory of the system.  Moreover, if the OS is 64-bit or installed at the wrong address C: \ Windows, then Vir is still installed in C: \ Windows \ System32, creating non-existent directories along the way, respectively.  The process was in the autorun list and the branch was deleted using Autoruns.  But as soon as Autoruns is closed, a new copy of the virus named upp2.exe is launched.  If you delete it, rundl132.exe appears and so on.  Apparently, they run themselves and there is a check for the absence of a process.  It was solved very simply - by killing the process tree. <br><br><h5>  Study </h5><br>  The first thing I noticed was the size of the executable files, which was a little more than 1 MB for each exe.  I doubt that at least one self-respecting virus writer is capable of such. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We turn to the more interesting.  Having loaded one of the executable files into the HEX editor, I began to look at it fluently from the end ... And for good reason from the end! <br><a name="habracut"></a><br>  At the end of the file there were several hundred lines of text in UTF-8 encoding: <br><br><img src="https://habrastorage.org/storage1/57ac4ede/5dc8eb50/4f6d01ce/f36e5b51.png"><br>  My HEX editor does not support UTF-8 encoding, so I opened the executable file as text: <br><br><img src="https://habrastorage.org/storage1/4f79fd2d/32328f6e/d845ea3b/37032133.png"><br>  Among this text I was interested in the following: <br><br><img src="https://habrastorage.org/storage1/83a1ed3b/a82bb114/d38d2802/4e6fff5d.png"><br>  That's right, look what is, "Algorithm2".  Description from the author's website: " <i>Algorithm 2 is a free program for creating programs and games at home! With its help, anyone can create programs without having any programming knowledge.</i> ". <br>  Some kind of application development environment with the mouse without entering any code written using .NET.  I did not linger on that site, having downloaded and looked at examples, I launched upp1.exe in the IL disassembler: <br><br><img src="https://habrastorage.org/storage1/b7a6bfea/12b59140/ae6ba8e9/fe60bec3.png"><br>  Unfortunately, apart from the names of classes and namespaces, nothing interesting was found. <br><br>  In addition, it was discovered that the process downloads MDAC_TYP.EXE from microsoft.com.  I can assume that the malware can update and works with <a href="http://ru.wikipedia.org/wiki/MDAC">MDAC</a> . <br><br>  In system32, the files upp1.ver, upp2.ver and the engine directory are created.  In the engine directory at runtime, I found the g.obo, gm.obo, k.obo, ki.obo, t.obo files containing fragments of encrypted information, which I could not decrypt: <br><blockquote>  9tcLzYklFri4ABxuu0spYAad5Ed13rA + HUwS6 + fz3d 1JTRrhQ3eqHF4MwCU2k5pfE2FiOR6jz8 + NLOtK5YyIjBBo7RodD / 8r2G1KapUdSWfBzmH IauGuEQ53iweGHB3ooaFZVZwjeX2QMmWqPauhKidIJxBQeNT3LSzxYtZhlO4 = <br>  9tcLzYklFri4ABxuu0spYAad5Ed13rA + HUwS6 + fz3d1JTRrhQ3eqHF4MwCU2k 5pfE2FiOR6jz8 + NLOtK5YyIjKRrAUB + hCDBr98XIlTn chf chf i2 chf i2fy2fy2fyfy2fyfy2fyfy2fyfy2fyfy2fyfy2fyour <br><br>  And etc. </blockquote><br><br><h5>  Conclusion </h5><br>  On this, perhaps, everything.  If someone is interested in "digging", please - <a href="http://zalil.ru/31633002">system32.zip</a> ( <b>system32</b> password).  Please forgive that so little information has ever been interested in analyzing other people's applications and I have no experience in this. <br><br>  The sad thing is this: a virus written without programming, weighing more than 1 MB, and even requiring .NET. </div><p>Source: <a href="https://habr.com/ru/post/127474/">https://habr.com/ru/post/127474/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127468/index.html">The US government is opposed to combining AT & T and T-Mobile</a></li>
<li><a href="../127470/index.html">New at IFA 2011: Thinkpad tablet, Tablet S and Tablet P, Xperia arc S</a></li>
<li><a href="../127471/index.html">We shorten arbitrary links with G.CO service.</a></li>
<li><a href="../127472/index.html">Chrome's most important feature</a></li>
<li><a href="../127473/index.html">Proper validation of XML data in java-projects</a></li>
<li><a href="../127478/index.html">Jets - Flight & Seat Advisor - an application to select seats in airplanes</a></li>
<li><a href="../127479/index.html">5 reasons why it is worth switching from BTC to SolidCoin</a></li>
<li><a href="../127481/index.html">Optimization for the new price</a></li>
<li><a href="../127482/index.html">JavaScript scope and ‚Äúraising‚Äù variables and function declarations</a></li>
<li><a href="../127484/index.html">Sony, Toshiba and Hitachi create a single manufacturer of touchscreen LCD displays for mobile devices.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>