<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A set of Ruby libraries for CMS and media publishing site</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A set of libraries for the development of CMS media edition is almost no different from any other application. On the example of the application for R...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A set of Ruby libraries for CMS and media publishing site</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/626/ba0/98a/626ba098a3f64e76addcd3738887f87d.jpg"><br><br>  A set of libraries for the development of CMS media edition is almost no different from any other application.  On the example of the application for Ribbon and Sheets, we decided to comment on the choice of each library.  The description is made in the discussion format of each heme. <br><a name="habracut"></a><br>  Previous review article: <a href="http://habrahabr.ru/post/243939/">Media Edition Restart: Review</a> <br><br><h4>  CMS Lenta.ru </h4><br>  Written about the tape was relevant until April 2014. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'unicorn'</span></span></code> </pre> <br>  <b>foxweb</b> : There should be an explanation why not Puma. <br>  <b>7even</b> : He does not exist. <br>  <b>zaur</b> : This is my conservative approach that does not give guys the freedom to unlock the potential of the Puma web server.  I prefer to use the classic model of the web server when several processes are running.  And I don‚Äôt like the model where handlers compete to process requests in different threads in the classical interpreter.  The lack of confidence in the thread-safety of the MRI interpreter and the unwillingness of all to switch to jRuby or Rubinius predetermined the choice. <br>  <b>7even</b> : Ready to go to Rubinus. <br>  <b>foxweb</b> : Well now, yes. <br>  <b>zaur</b> : <b>7even</b> , just recently had a different opinion. <br>  <b>7even</b> : Rubinius is developing rapidly.  A few months ago, he fell on constructions like <code>%i(foo bar)</code> . <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'newrelic_rpm'</span></span> gem <span class="hljs-string"><span class="hljs-string">'newrelic-redis'</span></span></code> </pre> <br>  <b>foxweb</b> : Our Rails application and message queue in Redis worked under constant monitoring of the NewRelic service.  If finances allow, you should definitely use this tool on all critical projects.  NewRelic saves hours and hard work, quiet sleep for developers, and saves some of them from dismissal and even from physical injuries.  Before someone from the editorial office resorted with shouts of ‚ÄúNothing works!‚Äù, We already knew what server it was on, for what reason it was not working, who had broken it, who would fix it, and how much of the body would be amputated.  Some of the graphics we brought to the HTML-page, which is 24 hours a day, spinning on a large monitor on the wall.  Everyone always knew ‚Äúwhat we have with the site.‚Äù  Shoals of one developer sees the whole team.  NewRelic minimizes the reaction time "dropped - raised".  For online media, this is especially critical. <br>  <b>zaur</b> : When setting up the module, you should not forget to exclude the test and dev environments.  It is done in configuration files. <br><br><img src="https://habrastorage.org/files/d8e/5a3/ac7/d8e5a3ac765e416d89ef834ab57d9f9e.png"><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'rails'</span></span>, <span class="hljs-string"><span class="hljs-string">'~&gt; 3.2'</span></span></code> </pre> <br>  <b>foxweb</b> : This is Rails. <br>  <b>zaur</b> : With this old rails.  They did not switch over to new ones, everyone was afraid that ‚Äúeverything will break.‚Äù <br>  <b>foxweb</b> : To be more precise, most of the gems at that time were not adapted for Rails 4. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'faye'</span></span></code> </pre> <br>  <b>foxweb</b> : Faye - a simple implementation of WebSockets, pub / sub sharpened on the exchange of messages between different users sitting on the same site.  Initially, this is such a convenient chat on web-sockets.  In our project, Faye sent / received messages between editors sitting in the admin panel.  Someone saved the new text, someone uploaded 10 pictures - received messages.  After some time, the server reports that the pictures were generated and published - all those who are currently engaged in this article received messages.  All this was very convenient for the editors, increased the level of interaction and accelerated the work of the editors as a whole.  It was not necessary to write in Skype ‚Äúboys, nobody touch this news, I am saving it now!‚Äù Or ‚Äúgo to the gallery, I created it!‚Äù It was always clear which editors are currently running this particular article.  In combination with the journaling and versioning system, as well as the diff comparison service, the collective work of the editorial board on the same materials has become truly convenient.  The only thing that we didn‚Äôt manage to realize was separation by roles and access levels in the alert system.  It would be interesting to make it so that, for example, the editor-in-chief could see everything on a special page, without being ‚Äúglowing‚Äù anywhere, and the trainees would receive messages of a certain type.  Although, a lot of work went so that faye could not be used from the outside.  Anything can happen.  For example, authorization through cookies and tokens stored in Redis was implemented to some extent.  Token tied to a specific editor account.  Thanks to this, the editors could see the messages as if on behalf of the author - ‚ÄúVasily Petrov saved the document‚Äù.  In the basic version, faye doesn‚Äôt deal with user authorization and message protection, and is not at all connected with the Rails environment. <br>  <b>ksavelyev</b> : Well, in fact, not very simple, Faye is good for everyone, but does not scale. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'faye-redis'</span></span></code> </pre> <br>  <b>foxweb</b> : A plugin for faye that allows to use as an intermediate repository for pub / sub messages, as the name implies, Redis.  We used it only for authorization and storage of tokens (it seems). <br>  <b>zaur</b> : ... and for storing a queue of background processes, such as Resque or Cloudy (self-made video editing). <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'thin'</span></span></code> </pre> <br>  <b>foxweb</b> : Thin is the server for Faye. <br>  <b>zaur</b> : Not your favorite Puma. <br>  <b>7even</b> : And here <b>zaur</b> and not confused asynchronous server :) <br>  <b>ksavelyev</b> : Zaur had no choice, otherwise Faye doesn't work;) <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'pg'</span></span></code> </pre> <br>  <b>foxweb</b> : Glorious relocation from MySQL to Postgres.  We made a separate branch in git, everything was adjusted there, tested and sgorgil.  First, we dumped the structure into a SQL file.  Naturally, it turned out to be unsuitable for importing directly into Postgres.  It was necessary to replace, for example, quotes throughout the file, some things were corrected manually.  I think <b>7even</b> will write a great story about why MySQL in such projects is bad. <br>  <b>7even</b> : There is no hstore in MySQL :) In general, seriously, Postgres is much more popular in the Ruby community and, as a result, it's easier to google the solution to any problem.  Plus, custom data types (arrays, json and the same hstore) make life easier.  Psql (console client) is much more convenient (if you master it at least a little). <br>  <b>zaur</b> : But <b>ksavelyev</b> believes that it was necessary to completely switch to MongoDB. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'postgres_ext'</span></span> gem <span class="hljs-string"><span class="hljs-string">'activerecord-postgres-json'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">github:</span></span> <span class="hljs-string"><span class="hljs-string">'michaelbn/activerecord-postgres-json'</span></span> gem <span class="hljs-string"><span class="hljs-string">'activerecord-postgres-hstore'</span></span></code> </pre><br>  <b>zaur</b> : When <b>migrating</b> from MySQL to PostgreSQL, the rails were the third version.  Used these libraries to support PostgreSQL extensions. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'marionette-rails'</span></span></code> </pre> <br>  <b>ksavelyev</b> : Adds the Marionette library to Asset Pipelite.  Marionette adds another level of abstraction to Backbon, introduces the concept of a module, an application, and allows you to conveniently work with visual representations of collections.  Makes Bekbona almost that Angulyar. <br>  <b>zaur</b> : from Angular repudiated to the last. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'haml_assets'</span></span> gem <span class="hljs-string"><span class="hljs-string">'dust_assets'</span></span> gem <span class="hljs-string"><span class="hljs-string">'haml_coffee_assets'</span></span></code> </pre> <br>  <b>ksavelyev</b> : Adds support for haml / dust templates, allows you to write templates with the specified syntax and use them inside Asset Pipeline; as a result, inside the JS application, we get a variable containing the compiled and ready-to-use templates that were originally written in haml / dust. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'turbo-sprockets-rails3'</span></span></code> </pre> <br>  <b>ksavelyev</b> : Accelerates the execution of rake assets: precompile by compiling and merging only changed assets, contains additional functions for removing old assets. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'terminal-notifier-guard'</span></span></code> </pre> <br>  <b>foxweb</b> : A heme interface to the system pop-up notification utility.  During testing on Linux and OS X systems, a status message is displayed - successful, unsuccessful.  Convenient: the tests are run by themselves, at this time you can switch to another window, and a pop-up notification will remind you that the testing is complete. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'guard'</span></span> gem <span class="hljs-string"><span class="hljs-string">'guard-rspec'</span></span> gem <span class="hljs-string"><span class="hljs-string">'guard-zeus'</span></span></code> </pre> <br>  <b>foxweb</b> : Spring appeared in Rails 4.1 for background code preloading.  In Rails 3, Zeus had to be used for the same purpose.  If a developer changes a file, it will immediately be restarted by Zeus and running the tests related to it by RSpec.  Guard is known to many as a tool for tracking events related to changes to project files.  <code>guard-rspec</code> just runs tests when saving files. <br>  <b>zaur</b> : That one, that the second brought more inconvenience.  Start the desired test easier directly with your hands.  And so solid excuses for poor ruby ‚Äã‚Äãperformance. <br>  <b>7even</b> : It's not a matter of ‚Äúpoor ruby ‚Äã‚Äãperformance‚Äù, but of slow starting a rail application.  Naturally, if it started in a couple of seconds, these crutches would not be needed. <br>  <b>foxweb</b> : 470 specs in 14 seconds is fast enough. <br><br><img src="https://habrastorage.org/files/d22/c59/491/d22c59491e3d4a0b933ef96c487b9a29.jpeg"><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'rspec-rails'</span></span>, <span class="hljs-string"><span class="hljs-string">'~&gt; 2.14'</span></span></code> </pre> <br>  <b>foxweb</b> : It seems that we used to use TestUnit before, but then, with the submission of <b>7even, we</b> quickly switched to RSpec.  This brought the testing process to a new level.  We had a full TDD.  Then we stopped writing tests, because there was almost no new code, and some code was very difficult or impractical (in time) to cover with tests. <br>  <b>zaur</b> : A controversial decision, the majority won.  And this new level is called ‚Äúnafig tests‚Äù. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'ffaker'</span></span></code> </pre> <br>  <b>foxweb</b> : When creating new entities, it was necessary to test and fill with random data (first name, last name, email, position, etc.).  In the process of debugging, an ordinary programmer can make 1-3 records, then he gets bored, and the code remains underdeveloped.  Actually, with the help of the classes of this heme, you can generate very diverse and, most importantly, plausible information.  <b>7even</b> contributed to it by adding a generator of Russian names and surnames.  Thus, it was possible to debug performance on different data sets before deploying to production.  The use of this heme is not related to tests.  When writing tests, for example, standard rail fixtures were used. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'quiet_assets'</span></span></code> </pre> <br>  <b>foxweb</b> : silent asses? <br>  <b>ksavelyev</b> : Exactly, silent ones.  When the rail application is launched locally on the developer's machine in dev mode, the web server gives the static itself.  In production, Nginx deals with this, which keeps separate logs for assets.  In development, the information that the web server gave the stack of assets is usually not needed by anyone; this heme blocks the junk messages that the static files were given to the browser.  If necessary, if there is no such heme, you can always filter logs using grep, for example, the command <code>tail -f development.log | grep SELECT</code>  <code>tail -f development.log | grep SELECT</code> will monitor the log for the appearance of SQL queries in them. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'colorize'</span></span></code> </pre> <br>  <b>foxweb</b> : When outputting data to the console (maybe import logs or some rake tasks), it was possible to output color strings to the console using ruby ‚Äã‚Äãmethods, which increased the overall readability of the logs. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'rails-erd'</span></span></code> </pre> <br>  <b>foxweb</b> : At some point, the number of entities and connections between them increased so much that it became difficult to keep them in mind and transfer knowledge to new employees.  With the help of this gem it was possible in a couple of actions to generate model diagrams with links and a bunch of different options.  The diagram was then printed on a large sheet of A3 and thought a lot. <br>  <b>zaur</b> : Then they threw it away and painted on the blackboard. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'ruby_parser'</span></span></code> </pre> <br>  <b>foxweb</b> : Someone was experimenting with parsing Ruby.  Possibly for your own file annotation mechanism. <br>  <b>7even</b> : Not me. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'capistrano'</span></span></code> </pre> <br>  <b>foxweb</b> : With Capistrano, everything was fine until Mina appeared.  Capistrano worked slowly, but he knew how to make multi-server deploy.  Mina is fast, and her output is much more readable.  We didn‚Äôt manage to translate CMS and frontend to Mina, but special projects and, for example, Dom.leta.ru deploy or initially with the help of Mina.  Multiserver deploy is quite simply ‚Äúemulated‚Äù using a simple loop on the list of hosts (it seems there were a maximum of 4).  That is, just 4 deployments for 4 hosts in one run. <br>  <b>zaur</b> : Now for deployment, neither this nor that is used.  Switched to the control scheme using ansible.  Depla without interruption in the service provides HAProxy. <br>  <b>7even</b> : It became 5 times slower than mines, but zero-downtime. <br>  <b>foxweb</b> : I'll tell you a secret, it‚Äôs not even zero-downtime in the current setup;) <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'better_errors'</span></span> gem <span class="hljs-string"><span class="hljs-string">'binding_of_caller'</span></span></code> </pre> <br><img src="https://habrastorage.org/files/ba8/95b/93c/ba895b93cdc14df09910274b92ec0b6b.png"><br>  <b>ksavelyev</b> : better_errors significantly improves the standard information screen of the 500th error.  A call stack browser and an interactive ruby ‚Äã‚Äãconsole appear, allowing you to view the status of objects. <br>  <b>foxweb</b> : I do not understand how we used to debug rail applications without a console in the browser. <br>  <b>7even</b> : Tests should be written, but not manually referenced in the browser links. <br>  <b>ksavelyev</b> : If front-end vendors wrote tests in the backend, and backenders would do shadows and integrate fonts into the page, the world would definitely be better. <br>  <b>foxweb</b> : I meant exactly those cases when it is impossible to catch layout errors in a regular console, for example. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'jazz_hands'</span></span></code> </pre> <br>  <b>7even</b> : A set of pry, awesome_print and a few pry buns. <br>  <b>foxweb</b> : Adds beautiful coloring, syntax highlighting and output formatting to a standard rail console to the console.  Left in production, because I often had to climb into the console on working servers. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'active_record-annotate'</span></span></code> </pre> <br>  <b>7even</b> : For annotation of models, annotate_models were initially used, but at some point it began to break down on new data types in PostgreSQL - and we decided to write our own implementation. <br>  <b>foxweb</b> : you decided you wrote. <br>  <b>7even</b> : <a href="https://github.com/7even/active_record-annotate">Github</a> . <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'rabl'</span></span> gem <span class="hljs-string"><span class="hljs-string">'jbuilder'</span></span> gem <span class="hljs-string"><span class="hljs-string">'gon'</span></span></code> </pre> <br>  <b>zaur</b> : For serialization, we started using Rabl.  Awfully slow solution.  Gradually began to move to JBuilder.  And to transfer JSON to the page at the stage of HTML generation, Gon was used. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'fast_seeder'</span></span></code> </pre> <br>  <b>foxweb</b> : From the same rank as Ffaker, but it can use data from CSV files as a source. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'oj'</span></span></code> </pre> <br>  <b>7even</b> : The fastest JSON parser. <br>  <b>foxweb</b> : Peter is better than Moscow.  And the better?  Than Moscow. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'slim'</span></span></code> </pre> <br>  <b>foxweb</b> : At first there was Haml, but then it turned out that Slim is not only easier to read and write, but also renders faster.  To replace Haml with Slim for the entire project, you can use, for example, <a href="https://github.com/slim-template/haml2slim">haml2slim</a> . <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'russian'</span></span></code> </pre> <br>  <b>foxweb</b> : Famous heme for the russification of dates and standard rail messages. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'whenever'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">require:</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  <b>foxweb</b> : Chronifier is a library for managing cron-tasks in Ruby.  Something we had there once a day with the news this happened. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'redcarpet'</span></span></code> </pre> <br>  <b>foxweb</b> : Markdown to work with Markdown, but no one remembers where we used it. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'kaminari'</span></span></code> </pre> <br>  <b>foxweb</b> : Paginator - breaks up large lists into pages (1,2,3 ... 100). <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'truncate_html'</span></span></code> </pre> <br>  <b>ksavelyev</b> : Laziness-mother forces gems to be added from a single function to the gemfile.  In this case, it was lazy for us to correctly bite off a piece of HTML with a regular expression. <br>  <b>foxweb</b> : I didn't know about that. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'devise'</span></span> gem <span class="hljs-string"><span class="hljs-string">'devise-encryptable'</span></span></code> </pre> <br>  <b>zaur</b> : A classic of the genre for creating authorization on the site. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'mini_magick'</span></span></code> </pre> <br>  <b>foxweb</b> : Heme interface to ImageMagick. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'mimemagic'</span></span></code> </pre> <br>  <b>foxweb</b> : heme to determine the type of downloadable content. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'foreman'</span></span></code> </pre> <br>  <b>foxweb</b> : A simple process manager for a developer.  When working on a large project, you need to run a lot of small services.  Foreman launches everything you need with a single command.  In our example, these are Rails, Faye, tests, queuing, and image processing services. <br>  <b>7even</b> : Running tests through Foreman made their output so unreadable that I soon cut them out from Procfile. <br>  <b>foxweb</b> : Recalled, it seems, everything got into the general output along with the tests, including the Faye messages and application logs. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'faraday'</span></span></code> </pre> <br>  <b>7even</b> : Faraday is an indispensable library for accessing external network resources.  Thanks to the middleware system (similar to Rack), you can set all transformations of both the request and the response once - for example, add an OAuth authorization header to the request before sending it, or parse the JSON response and wrap it in Hashie :: Mash. <br>  <b>foxweb</b> : ‚ÄúExternal network resources‚Äù - commonplace HTTP requests for the old version of the site. <br>  <b>7even</b> : Ok, to any network resources.  In this case, the old version of the site, but we used faraday in a variety of situations - there were API and HTML. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'faraday_middleware'</span></span></code> </pre> <br>  <b>7even</b> : There are many useful middleware for faraday in this gem. <br>  <b>foxweb</b> : Is this, for example, JSON? <br>  <b>7even</b> : And, for example, <a href="">mashify</a> . <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'hashie'</span></span></code> </pre> <br>  <b>7even</b> : Hashie - a collection of hash extensions.  We used Hashie :: Mash - a variation of the hash, in which accessing elements goes not as accessing a key, but as calling a method of the same name (for example, not <code>user[:name]</code> , but <code>user.name</code> ).  Unfortunately, this gem was later abused and used as a substitute for models. <br>  <b>foxweb</b> : The layout was loved by the designers and called it ‚Äúdot-notation‚Äù. <br>  <b>7even</b> : That's what I'm talking about. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'nokogiri'</span></span></code> </pre> <br>  <b>foxweb</b> : A well-known library for parsing XML / HTML.  Actively used in the analysis of old archives.  With the help of it during the import process, we replaced outdated links, tags of pictures, cleaned out irrelevant code, garbage and many other things.  It seems to be even closed unclosed tags. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'eventmachine'</span></span> gem <span class="hljs-string"><span class="hljs-string">'em-synchrony'</span></span> gem <span class="hljs-string"><span class="hljs-string">'em-hiredis'</span></span></code> </pre><br>  <b>7even</b> : For video processing, a third-party E ******* m service was used, interaction with which went through their REST API.  On our side, a demon worked, which through the queue in radish received the path to the video file loaded by the editor, sent it to the server E ****, transferred it to another Redis queue, polled the server every 5 minutes - and when the processing was on the E *** side * was completed, the daemon was pumping out the finished files.  Since all these processes were to run in parallel, the daemon was written in EventMachine. <br>  <b>zaur</b> : Asterisks are not painted over. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'streamio-ffmpeg'</span></span></code> </pre> <br>  <b>7even</b> : This wrapper around ffmpeg allowed us to get the width, height, bit rate, duration and other metadata of the video file. <br>  <b>foxweb</b> : This data was later used to display video content on the site pages. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'ruby-progressbar'</span></span></code> </pre> <br>  <b>foxweb</b> : A simple implementation of the progress bar in the console.  Used when importing data from the old database to the new format.  When more than 500,000 materials are waiting for you in front of you, the progress bar helps you to plan time and meditate in the process.  The class is pretty simple.  At the input parameters are set such as a finite number of the cycle, all kinds of view settings, etc.  When outputting, he himself considers interest, time, turns the counter, moves the strip, in general, does everything that a normal progress bar does in any OS.  It is priceless to inform the editor-in-chief that it takes three days to import old data. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'version'</span></span></code> </pre> <br>  <b>foxweb</b> : A <b>trinket gem</b> that increments the version number in the VERSION file on request and puts the corresponding tag on commits in Git.  Played and forgotten. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'environment'</span></span></code> </pre> <br>  <b>zaur</b> : One of the bicycles, for distributing settings to different environments, of which there were more than three.  Design error, payback. <br>  <b>7even</b> : Sunk into oblivion. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'settings'</span></span></code> </pre> <br>  <b>7even</b> : Both configatron and rails_config were used to store application settings at different times.  But somewhere, gems didn‚Äôt work outside of the Rails context - which made it impossible for us to access the settings from Faye and the demon on the event machine - and somewhere there were other problems;  therefore, its own implementation was written.  It is currently available on <a href="https://github.com/roomink/settings">Github</a> . <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'bluepill'</span></span></code> </pre> <br>  <b>7even</b> : Everything is simple: monitoring services. <br>  <b>foxweb</b> : Often it was necessary to restart dropped or hung services directly on production.  Then we got tired and we put Bluepill.  Like Foreman, only for the server. <br>  <b>zaur</b> : Awful monitoring of services.  But others were no better.  It was necessary to be able to follow the process that could change the PID.  At the same time not many could do it.  The web server changed its process at the moment of zero-downtime restart.  For example, during deployment, for the smooth operation of the application, they used such wonderful Unicorn functionality. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'diffy'</span></span></code> </pre> <br>  <b>foxweb</b> : Awesomely useful editorial tool.  Allows you to view text editing history, as in Wikipedia.  Naturally, in order to have something to compare with, a version history must be kept.  She already worked with us, and to fasten such a tool was a matter of a couple of hours.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The useful effect for the editorial was enormous. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zaur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : There was a case when the editor made a typo. The site was corrected on time, but in the RSS on the main page Rambler. News left, of course, the wrong option. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksegoh</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : And then the guys learned the difference between Syria and Libya. </font></font><br><br><img src="https://habrastorage.org/files/cf1/018/360/cf10183603204cb78774a8919fc0d5d4.png"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zaur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : One of the use cases for versioning. You can follow the trainee writing a note. For example, he can consistently write news by paragraph. And can paint a plan in a few sentences, and further expand the text. That is, you can see the train of thought of a person, or reveal a copy-paste.</font></font><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'roo'</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foxweb</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Gem to extract data from Excel spreadsheets. </font><font style="vertical-align: inherit;">It was useful during the Olympics, when editors and content providers provided data on competitions and participants in a table. </font><font style="vertical-align: inherit;">There was neither time nor desire to fiddle with a web interface for working with tables.</font></font><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'net-scp'</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foxweb</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Also ‚ÄúOlympic‚Äù heme, provided the ability to pick up these same tables via SSH from file servers.</font></font><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'resque'</span></span> gem <span class="hljs-string"><span class="hljs-string">'resque-web'</span></span> gem <span class="hljs-string"><span class="hljs-string">'resque-pool'</span></span></code> </pre> <br> <b>zaur</b> :       .         ImageMagick.     (    )    Sidekiq (   ).   ,  ,  ,  .  ,         .    Resque,  ImageMagick.       . <br> <b>foxweb</b> :  ,     .     ,    JPEG , , PNG        , ,     ImageMagick. <br> <b>zaur</b> :   . ‚Äú‚Äù       .  ‚Äì  .  , ,  HTTP ‚Ä¶ <br><br><img src="https://habrastorage.org/files/4c8/cd1/298/4c8cd1298e554221bffea71759de4c0a.jpeg"><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'ar_after_transaction'</span></span></code> </pre> <br> <b>zaur</b> :   ,   . <br> <b>ksavelyev</b> :  ?           . <br><br><h4> API-    </h4><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'rails-api'</span></span></code> </pre> <br> <b>7even</b> :       API,  JSON,          ,   rails-api. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'active_model_serializers'</span></span></code> </pre> <br> <b>7even</b> :    rabl  jbuilder       JSON      rails-api,    . <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'awesome_pry'</span></span></code> </pre> <br> <b>7even</b> :    jazz_hands      Ruby (, ,  - ),            ‚Äî    -,     pry  awesome_print. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'ice_nine'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">require:</span></span> <span class="hljs-string"><span class="hljs-string">%w(ice_nine ice_nine/core_ext/object)</span></span></code> </pre> <br> <b>7even</b> :   .     ,       <code>#freeze</code> ;       <code>#freeze</code>       ‚Äî      ,     .       <code>#deep_freeze</code> . <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'highline'</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7even</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : For self-sufficiency of the application and the ability to test each route without using the front-end, a small console API client was written, in which the highline was useful.</font></font><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'rack-cors'</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7even</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Support for CORS requests.</font></font><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'database_cleaner'</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7even</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Since the tests use the database, database_cleaner was used to clear all the tables before each test. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zaur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : It also came in handy when they wrote their rake task to reset the database in dev mode. </font><font style="vertical-align: inherit;">This need arises because </font></font><a href="http://pow.cx/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> keeps the application running. </font><font style="vertical-align: inherit;">And, it means that the database had active connections that did not allow simply to re-create the database.</font></font><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'guard-yard'</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7even</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : A plugin for guard, which starts the generation of YARD documentation from changed files.</font></font><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'apiaryio'</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7even</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : API was decided to use apiary.io to document, and this heme allows you to generate documentation in HTML and view it locally.</font></font><br><br><pre> <code class="ruby hljs">group <span class="hljs-symbol"><span class="hljs-symbol">:development</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> gem <span class="hljs-string"><span class="hljs-string">'puma'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foxweb</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Puma is here, and in production it's still Unicorn.</font></font><br><br><pre> <code class="ruby hljs">group <span class="hljs-symbol"><span class="hljs-symbol">:production</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> gem <span class="hljs-string"><span class="hljs-string">'unicorn'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foxweb</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Unicorn is here, and Puma is still in development.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Frontend CMS Vedomosti </font></font></h4><br><pre> <code class="ruby hljs">source <span class="hljs-string"><span class="hljs-string">'https://rubygems.org'</span></span> source <span class="hljs-string"><span class="hljs-string">'https://rails-assets.org'</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ksavelyev</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : The source line rails-assets.org began to appear more and more often in projects with a rich front-end. </font><font style="vertical-align: inherit;">The point of adding another source is that rails-assets can make gems from almost any github repository. </font><font style="vertical-align: inherit;">In order for the repository to be transformed into a heme it is necessary that it be a valid bower repository. </font><font style="vertical-align: inherit;">By specifying an additional source, we can add type calls to the gem file </font></font><code>gem 'rails-assets-BOWER_PACKAGE_NAME'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">All JS / CSS resources of this gem will be available in the Asset Pipeline and then you can use them in your project as if you added the necessary files by hand.</font></font><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'puma'</span></span> gem <span class="hljs-string"><span class="hljs-string">'unicorn'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">group:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:production</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zaur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Well, you understand what I think about it.</font></font><br><br><img src="https://habrastorage.org/files/30b/b9c/191/30bb9c19103e478a97ea4ec1d017e4d1.jpeg"><br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'compass-rails'</span></span></code> </pre> <br> <b>ksavelyev</b> :     ,     ,    .      .    ‚Äî          SASS/SCSS.             ,      ,     CSS,  , ,     ,               .  ,    . <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'rails-assets-angular'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-angular-cookies'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-angular-animate'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-angular-sanitize'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-angular-ui-router'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-angular-promise-tracker'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-angular-loading-bar'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-restangular'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-angular-contenteditable'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-angular-ui-ace'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-angular-bootstrap-colorpicker'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails-assets-ng-sortable'</span></span></code> </pre> <br> <b>ksavelyev</b> :        bower-,      rails-assets,     . <br><br>   : <br><ul><li> <b>foxweb</b> (@foxweb) ‚Äî   ( !) </li><li> <b>7even</b> (@7even) ‚Äî   </li><li> <b>ksavelyev</b> (@ksavelyev) ‚Äî   </li><li> <b>ksegoh</b> ‚Äî   </li><li> <b>zaur</b> (@kavkaz) ‚Äî   </li></ul></div><p>Source: <a href="https://habr.com/ru/post/244157/">https://habr.com/ru/post/244157/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244145/index.html">Interview with Moses Uretsky, co-founder and director of Digital Ocean</a></li>
<li><a href="../24415/index.html">Register a trademark for protection?</a></li>
<li><a href="../244151/index.html">OpenVZ, Quagga and LiveMigration</a></li>
<li><a href="../244153/index.html">Facebook launches data center with new network architecture</a></li>
<li><a href="../244155/index.html">Multitasking in the Linux kernel: workqueue</a></li>
<li><a href="../244159/index.html">ATM attack with Raspberry Pi</a></li>
<li><a href="../24416/index.html">How and why I decided to make my online store</a></li>
<li><a href="../244161/index.html">Trader trader competitor?</a></li>
<li><a href="../244163/index.html">Recognize barcodes on images using Python and OpenCV</a></li>
<li><a href="../244165/index.html">Beta new Opera Mini for Android with sync</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>