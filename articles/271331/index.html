<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dynamic creation of Windows and Web CRUD interfaces and not only for business applications with XAF + Entity Framework. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have an old DXLibrary web application for recording literature and searching for interesting additions in the local library, written many years ago...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dynamic creation of Windows and Web CRUD interfaces and not only for business applications with XAF + Entity Framework. Part 1</h1><div class="post__text post__text-html js-mediator-article">  We have an old DXLibrary web application for recording literature and searching for interesting additions in the local library, written many years ago by a couple of hours one of the DevExpress eXpressApp Framework (XAF) developers.  Application data is stored in Microsoft SQL Server, and work with them is carried out through DevExpress eXpress Persistent Objects ORM (XPO).  Since <a href="">this miracle</a> is still tolerably fulfilling its extraordinary functions, I wanted to refresh its interface a little under current realities.  In addition to decorations, I want to change XPO under the hood to Microsoft ADO.NET Entity Framework (EF). <img src="https://habrastorage.org/files/0ba/ba7/343/0baba73431db4415acf43ec7d0573963.png" alt="image" align="right" width="200">  The main motive here for me is not that EF is better or worse (both ORMs have long proved that they are excellent for their tasks), but that until now there was no Russian-language integration guide for XAF and EF, although they are already "not the first year married."  There is a great desire to fill this gap + just want to implement several recent requests from users of the "librarian".  Finally, from version 15.1, XAF provides an updated web interface, adapted for touch-devices, which I would like to once again show the community that it‚Äôs no secret :-) <br><br>  This is the first and introductory part of a series of posts where I will try to show step by step the option of accelerated generation of both web and desktop line-of-business (LOB) applications using an existing database (DB) or a ready-made EF model representing the structure of the above described subject area .  The user interface will be created automatically based on a mix of ASP.NET WebForms / HTML5 and WinForms technologies, as well as the corresponding DevExpress visual components, assembled together in runtime under the strict guidance of XAF.  XAF is our modular MVC framework, and, in fact, formed over almost 10 years of existence and an ever-expanding set of best patterns &amp; practices for quickly creating Office-like business applications for .NET developers (learn more on <a href="http://habrahabr.ru/search/%3Fq%3D%255Bxaf%255D%26target_type%3Dposts">Habr√©</a> , the <a href="http://www.devexpress.com/xaf">site</a> ). <br><a name="habracut"></a><br><br><h2>  <font color="#888">Minimum requirements for passing</font> <br></h2><br>  1. .NET Framework 4+ and Visual Studio 2010+ (full and Community Edition versions are supported, except express) - then I will use Visual Studio 2013. <br>  2. Entity Framework 6 Tools (depending on the version of Visual Studio, they may already be embedded or require <a href="https://msdn.microsoft.com/en-us/data/ee712906">separate installation</a> ) <br>  3. The full version of DevExpress Universal v15.1, or a 30-day trial, which is <a href="https://go.devexpress.com/devexpressdownload_universaltrial.aspx">downloaded</a> from our site <a href="https://go.devexpress.com/devexpressdownload_universaltrial.aspx">for free, without registration and SMS</a> :-) and put in a couple of minutes on the SSD.  If you suddenly have access to <a href="">v15.2 Beta</a> , then it is better to use it. <br>  4. Microsoft SQL Server for data storage (any full / express / localdb versions starting from 2000 will do) or <a href="https://msdn.microsoft.com/library/dd363565.aspx">another database provider supported by EF</a> . <br>  five*.  It is also useful to get acquainted with EF and understand the basic principles of object-relational mapping ( <a href="https://ru.wikipedia.org/wiki/ORM">ORM</a> ) and Model-View-Controller ( <a href="https://ru.wikipedia.org/wiki/Model-View-Controller">MVC</a> ), which are the basis of working with our framework. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Before you begin, my thoughts on this kind of frameworks, customization options and the choice of ORM</b> <div class="spoiler_text">  It is important to understand that the XAF, in its essence, is not a code generator, as, for example, our similar products DevExpress <a href="https://documentation.devexpress.com/">MVVM Framework</a> &amp; <a href="https://documentation.devexpress.com/">Scaffolding Wizard</a> for WPF / WinForms.  On the contrary, XAF is a very dynamic <a href="https://en.wikipedia.org/wiki/Application_framework">application framework</a> that generates the user interface completely according to certain rules during execution.  So you don‚Äôt have to manually restart form generation after each change of your original data model (such as adding a new class or property) or losing custom code previously written in the generated forms - after launching the XAF application you will always automatically get the actual result of the " <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BA%25D0%25B0%25D1%2584%25D1%2584%25D0%25BE%25D0%25BB%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B3">scaffolding</a> " UI and DB according to your current data structure and rule set.  Practically, this means that by default no source code of <a href="https://ru.wikipedia.org/wiki/CRUD">CRUD</a> forms is generated in XAF, to which the developer would have direct access in Visual Studio, as it happens in the usual development of client applications.  Although the XAF developer still has full control over the final UI bricks of the System.Windows.Forms.Control type or HTML elements and can manipulate them as in any other .NET application, most of the time, a typical XAF development process is setting up the system for more high level, often through the structure of date models, cross-platform XML UI settings in the designer or through abstractions over UI elements in the code.  I repeat that there is access to a low level, nobody restricts you, you can also mix approaches, but this is required much less often, otherwise what is the benefit compared to traditional development?  I must admit that this is at the same time the greatest beauty and disadvantage of XAF, since at first it is difficult for people to reorganize and abstract themselves from operating with visual controls directly.  Hence the steep learning curve in the early stages. <br><br>  Probably, it is also worthwhile to immediately dispel doubts about the possibilities of UI and customization for the various needs of the customer in this kind of RAD tools, as they say, not a square-nested single!  To better present the UI of typical business applications that can be created using the framework, you can see the finished illustrations on the product page <a href="">here</a> , play live with the demo applications <a href="">online</a> (or better from the installer, so that you can also grab desktop versions) and, finally, look at Internet examples of production applications from real customers, for example, here is a good <a href="https://www.devexpress.com/Home/Case-Studies/ExelixisSoftware/">example</a> or a couple from the Galaxy familiar to many in the CIS with their AMM, CnP, EAM and other solutions ( <a href="http://www.galaktika.ru/amm/upravlenie-pozakaznym-proizvodstvom.html">one</a> , <a href="http://www.galaktika.ru/amm/upravlenie-serijnym-proizvodstvom.html">two</a> ).  The latter, by the way, came out of the "galactic" tuning studio :-) <a href="http://xafari.ru/">XAFARI</a> - a set of additional modules and components for the XAF platform.  In addition to commercial third-party extensions, it is impossible not to mention the free project <a href="http://www.expandframework.com/">http://www.expandframework.com</a> , which has been developing by the community for 5 years.  Immediately, I note that largely due to the use of the DevExpress visual components, it is quite possible to work with the created applications, both on a regular desktop and on touch devices with a smaller screen, for example, tablets, with a minimum of additional settings from the developer‚Äôs side (and even in good old <a href="https://documentation.devexpress.com/">WinForms</a> !), but more on that later. <br><br>  If you don‚Äôt have any ORM knowledge, then before you start working with XAF, you will certainly have to make hard choices.  On the one hand, we are dealing with XPO - a simple and still-living proprietary ORM library (learn more from Russian-speaking community reviews: <a href="http://geektimes.ru/post/74009/">one</a> , <a href="https://uriahas.wordpress.com/2013/08/01/%25D0%25B2%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5-%25D0%25B2-xpo-%25D0%25B8-orm/">two</a> ), which since 2006 has been the only choice for XAF, with a huge number of examples, documentation, video, free guaranteed support from the development company, and on the other - <a href="https://msdn.microsoft.com/en-us/library/ms178359(v%3Dvs.110).aspx">the recommended</a> open source technology for data access for .NET with b <b>about</b> larger number of developers in the labor market, good promotion and development from Microsoft, support for <a href="https://msdn.microsoft.com/ru-ru/library/dd363565.aspx">third-party companies</a> , and not at the base  Nanii and technical support for community forces <a href="http://stackoverflow.com/questions/tagged/entity-framework">StackOverflow</a> , <a href="https://social.msdn.microsoft.com/Forums/en-US/home%3Fcategory%3Ddataplatformdev">Social.MSDN</a> , <a href="http://forums.asp.net/1227.aspx/1%3FADO%2520NET%2520Entity%2520Framework%2520LINQ%2520to%2520SQL%2520NHibernate">forums.asp.net</a> (though without guarantees quick response no response at all).  We conducted surveys among our new users and it turned out that for many other things being equal, a significant factor in choosing a technology is the availability of guaranteed technical support (here it means help in case of problems or questions on how best to do it), rather than the fact that somewhere there are more or less of some functions.  Technically, if you do not take into account the fact that formally EF is supported by XAF and later XPO - from 2012, then the support of two libraries at the level of XAF itself and its modules is comparable in functionality and covered scenarios.  At the moment, the share of our EF users is growing, but still well behind XPO.  It seems that the release of EF 7 and also the alignment of the presence of examples on our side will also change this ratio.  More thoughts and feedback from our users on this topic can be found in my <a href="http://dennisgaravsky.blogspot.com/2014/12/looking-for-practical-experiences-with.html">blog on the topic</a> . <br></div></div><br><br><h2>  <font color="#888">Steps to create a new XAF solution with EF 6</font> <br></h2><br>  0. <a href="https://go.devexpress.com/devexpressdownload_universaltrial.aspx">Download the trial version of</a> DevExpress Universal from our website, wait for the successful installation; <br><br>  1. Open Visual Studio and launch the wizard for creating a new project with the name <b>DXLibraryV2</b> through the standard <b>FILE |</b>  <b>New |</b>  <b>Project ...</b> , using the search and selecting the <b>XAF Solution Wizard</b> (or initially calling the <a href="">special menu</a> : DEVEXPRESS | All Platforms | New Project ...) <br><div class="spoiler">  <b class="spoiler_title">(show ...)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/417/97e/cca/41797ecca63849b89af60664e4ae08ca.png" width="800"><br></div></div><br>  2. In the launched wizard, select the <b>Windows</b> and <b>Web</b> platform and click <b>Next.</b> <br><div class="spoiler">  <b class="spoiler_title">(show ...)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/daf/d00/19c/dafd0019c7e342eeba5e1be3c65caf72.png" width="800"><br></div></div><br>  3. Select the <b>Entity Framework Code First</b> to access the data and click <b>Next.</b> <div class="spoiler">  <b class="spoiler_title">(show ...)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/869/cbe/d8f/869cbed8f7cf4bc8af69d5079ff05359.png" width="800"><br></div></div><br>  4. Select <b>Authentication = Active Directory</b> , which means login to the application for the current Windows user, and click Next. <div class="spoiler">  <b class="spoiler_title">(show ...)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/96c/b1f/3ef/96cb1f3ef7f04d33a98fcf6663a6a766.png" width="800"><br></div></div><br>  5. Finish the work by clicking on <b>Finish</b> , as long as we do not need any more additional modules <div class="spoiler">  <b class="spoiler_title">(show ...)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/5c9/d35/e7e/5c9d35e7eb3a40a4912dd52f38a97314.png" width="800"><br></div></div><br><br><h2>  <font color="#888">Main parts of the created XAF solution</font> <br></h2><br>  As a result, the wizard will create us blanks for future applications according to the previously selected settings: <br><br><img src="https://habrastorage.org/files/5bc/a54/653/5bca54653cec470ba7012477c0e9e7d4.png" width="800"><br><br>  In a nutshell, we did: <br><ul><li>  DXLibraryV2.Module - one cross-platform module containing common code for all platforms (for example, business logic, data models, UI metamodel settings, working with the base and, in rare cases, universal UI editors) </li><li>  DXLibraryV2.Module.Wxx - a pair of platform-specific modules where code and settings specific to one of the platforms can live </li><li>  DXLibraryV2.Wxx - one executable application for each platform, i.e.  ASP.NET site and WinForms application.  By default, these applications will connect to Microsoft SQL Server to store connectionString data from application configuration files (Web.config and App.config). </li></ul><br>  For convenience, projects contain subfolders with speaking names and readme.txt files that can help newbies not to get lost ( <a href="https://documentation.devexpress.com/eXpressAppFramework/CustomDocument112569.aspx">learn more ...</a> ). <br><br>  If we launch DXLibraryV2.Web and DXLibraryV2.Win from Visual Studio right now, we‚Äôll get working applications for the web browser <b>*</b> and the Windows desktop, which are not yet specially trained, except for CRUD management of users, roles and security settings ‚Äî such simple admin in a minute: <br><br><img src="https://habrastorage.org/files/dd5/b46/be9/dd5b46be9f4d4afe9e37796a05316974.png" width="600"><br><img src="https://habrastorage.org/files/279/35d/a20/27935da2062944449144e57c5193b532.png" width="600"><br><br>  <b>*</b> To activate the new web style as in the picture above, at the time of this publication, you need to additionally add the <a href="https://documentation.devexpress.com/">WebApplication.SwitchToNewStyle</a> method to Session_Start.  In the future this will not be required. <br><br>  Next, let's figure out how this basic functionality came out, what are the features, where did the EF hide here and how would we modify it in the future to fit our needs. <br><br><h2>  <font color="#888">EF integration features</font> <br></h2><br>  First of all, the main EF support in XAF is implemented in the <b>DevExpress.ExpressApp.EF.v15.1.dll</b> builds (for .NET 4.0) and <b>DevExpress.ExpressApp.EF.45.v15.1.dll</b> (for .NET 4.5), which automatically referenced in XAF projects depending on the version of the .NET Framework.  If you use our project creation wizard, then all the necessary EF dependencies are added automatically.  If not, they can always be added to projects in the <a href="http://msdn.microsoft.com/en-us/data/ee712906">standard way via NuGet</a> . <br><br>  At the time of this writing, the latest XAF version supports <b>EF 6</b> , covering both code-based strategies using <b>DbContext</b> and an outdated strategy based on <b>ObjectContext</b> and <a href="https://msdn.microsoft.com/ru-ru/library/system.data.objects.dataclasses.entityobject(v%3Dvs.110).aspx">EntityObject</a> (older versions also have EF 5 support).  According to statistics, among our users, the popularity of the latter approach to the development of the data model is much lower than the first, and after rumors about the likely killing of EDMX <a href="http://blogs.msdn.com/b/adonet/archive/2014/10/21/ef7-what-does-code-first-only-really-mean.aspx">in the next generation of EF,</a> I think it will disappear altogether.  We do not have official support for the latest EF 7 beta at the moment due to constant changes, although work is already underway in this direction.  By itself, the new generation of EF already contains many interesting opportunities for us and our users and looks very promising. <br><br>  Technically, working with <a href="http://msdn.microsoft.com/en-us/data/jj193542">EF Code First</a> implies that we need to have <b>POCO business classes</b> that define the structures of our data model, and a heir from DbContext, which contains the necessary set of typed <a href="https://msdn.microsoft.com/ru-ru/library/gg696460(v%3Dvs.113).aspx">DbSet</a> business entity <a href="https://msdn.microsoft.com/ru-ru/library/gg696460(v%3Dvs.113).aspx">collections</a> that can be queried from the database.  Do you still remember that in the 5th step we chose the type of user authentication (AuthenticationActiveDirectory), thereby activating the built-in security system module (SecurityModule)?  So, as a result of this, the master project included in our successor DbContext ( <i>DXLibraryV2.Module \ BusinessObjects \ DXLibraryV2DbContext.cs</i> ) the necessary built-in User, Role entities (and other service parts) declared in the optional <a href="https://documentation.devexpress.com/">DevExpress.Persistent.BaseImpl.EF</a> library <a href="https://documentation.devexpress.com/">.v15.1</a> , coming as part of the standard XAF delivery and containing ready-made classes for typical cases. <br><br><img src="https://habrastorage.org/files/d46/1b3/fb6/d461b3fb6fb54bc69773e5d74e1ad4ca.png" width="950"><br><br>  The above entities are completely ordinary POCO classes that define some kind of data structure and logic, for example: <br><br><img src="https://habrastorage.org/files/b98/e2c/9a6/b98e2c9a63ed442eb8aa71aff11cb3fc.png" width="950"><br><br>  Then the type of user DbContext or ObjectContext (in the case of EDMX strategy) along with the selected connection string to the database taken from the configuration files of the executable applications is transferred to <b>EFObjectSpaceProvider</b> when configuring data access in the heirs of WebApplication ( <i>DXLibraryV2.Web \ WebApplication.cs</i> ) or WinApplication ( <i>DXLibraryV2.Win \ WinApplication.cs</i> ). <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DXLibraryV2WindowsFormsApplication</span></span> : <span class="hljs-title"><span class="hljs-title">WinApplication</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DXLibraryV2WindowsFormsApplication</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { InitializeComponent(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateDefaultObjectSpaceProvider</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">CreateCustomObjectSpaceProviderEventArgs args</span></span></span><span class="hljs-function">)</span></span> { args.ObjectSpaceProvider = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EFObjectSpaceProvider( <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(DXLibraryV2DbContext), TypesInfo, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, args.ConnectionString ); }</code> </pre> <br>  WxxApplication classes are executable applications for each of the platforms and associated services.  Their instances are created and configured each time they are started at application input points, for example, in the Session_Start method from DXLibraryV2.Web \ Global.asax.cs or the Main method from DXLibraryV2.Win \ Program.cs.  Among the necessary settings of the application, in addition to the security system components and the connection string, there is a list of dependent modules, which can consist of both third-party and our own modules, for example, the DXLibraryV2Module type ( <i>DXLibraryV2.Module \ Module.cs</i> ).  The XAF modules (inherited from <a href="https://documentation.devexpress.com/">ModuleBase</a> ), as well as the applications themselves (the successors of <a href="https://documentation.devexpress.com/eXpressAppFramework/clsDevExpressExpressAppXafApplicationtopic.aspx">XafApplication</a> ) are custom derivatives from <a href="https://msdn.microsoft.com/ru-ru/library/system.componentmodel.component(v%3Dvs.110).aspx">System.ComponentModel.Component</a> , for which visual designers are also available. <br><br><img src="https://habrastorage.org/files/c52/3d0/102/c523d0102de0453f91b85ca28410d263.png" width="950"><br><br>  Especially for the first launch of applications, the wizard encoded the test dataset in the UpdateDatabaseAfterUpdateSchema method of the heir of the <a href="https://documentation.devexpress.com/">ModuleUpdater</a> ( <i>DXLibraryV2.Module \ DatabaseUpdate \ Updater.cs</i> ), an analog of the Seed method in EF <a href="http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm">database initializers</a> . <br><br><img src="https://habrastorage.org/files/d85/e7a/830/d85e7a83068b491b8520be1bddf90e1a.png" width="950"><br><br>  As a result of practicing the ModuleUpdaters methods and the associated code, the framework created a new database on Microsoft SQL Server and the corresponding tables with entries: <br><br><img src="https://habrastorage.org/files/92f/e43/a9d/92fe43a9d362498a924efbc48baca605.png" width="600"><br><br>  Regardless of the choice of code-based or EDMX strategies, the EFObjectSpaceProvider works with the ObjectContext API, which is their common denominator, because inside DbContext in EF 6 it still contains an ObjectContext, which can be accessed through the cast to the <a href="https://msdn.microsoft.com/ru-ru/library/system.data.entity.infrastructure.iobjectcontextadapter(v%3Dvs.113).aspx">IObjectContextAdapter</a> .  In particular, we use its MetadataWorkspace to reflect information about types and their structure for the further construction of the CRUD user interface skeleton. <br><br>  As you can see from the sample code in ModuleUpdater above, in the context of XAF CRUD, it is recommended to perform operations not directly via DbContext / ObjectContext, but through this abstract entity <a href="https://documentation.devexpress.com/">IObjectSpace</a> or in our case its concrete implementation for EF - <b>EFObjectSpace</b> .  It is supplied by the aforementioned EFObjectSpaceProvider and uses the <a href="https://msdn.microsoft.com/ru-ru/library/system.data.objects.objectstatemanager(v%3Dvs.110).aspx">ObjectStateManager</a> and <a href="https://msdn.microsoft.com/ru-ru/library/system.data.objects.objectquery(v%3Dvs.110).aspx">CreateQuery</a> API inside to modify or read the data.  IObjectSpace, in essence, is an ORM-independent embodiment <a href="http://www.codeproject.com/Articles/770156/Understanding-Repository-and-Unit-of-Work-Pattern">of the Repository and Unit Of Work patterns</a> , and technically just a wrapper over the data context.  Working through the <a href="https://documentation.devexpress.com/">IObjectSpace API</a> , once you have written some business logic, you can migrate it to another ORM without changes.  More importantly, through the IObjectSpace, the XAF interface part interacts with the data, for example, receives them or ‚Äúlistens‚Äù to the changes and updates itself accordingly. <br><br><h2>  <font color="#888">Practical notes for the future</font> <br></h2><br>  <b>1.</b> During development and debugging of an application from a test database, after constant changes to the date structure of the model classes, it is convenient to temporarily disable the <a href="https://msdn.microsoft.com/data/jj591621.aspx">Code First Migrations feature of EF</a> , <a href="https://msdn.microsoft.com/data/jj591621.aspx">setting the</a> required <a href="http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm">database initializer</a> using the built-in API from the System.Data.Entity, for example like this (DXLibraryV2.Module \ Module.cs): <br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// Uncomment this code to delete and recreate the database each time the data model has changed. // Do not use this code in a production environment to avoid data loss. // #if DEBUG // Database.SetInitializer(new DropCreateDatabaseIfModelChanges&lt;DXLibraryV2DbContext&gt;()); // #endif</span></span></code> </pre><br><br>  <b>2.</b> It is not necessary to use the built-in User, Role classes from DevExpress.Persistent.BaseImpl.EF.v15.1 ‚Äî this is basically what new users need for a quick start.  XAF is not an end product and, in the first place, it is a flexible and expandable * framework for building applications, in which you can always replace the necessary parts with your own or start doing everything from scratch if you already know what and how.  So, for example, instead of the built-in parts of the security system, we could easily declare our entities according to the EF documentation and add them to our DbContext. <br><br>  <b>3.</b> For normal operation of many standard scripts, it is desirable to implement INotifyPropertyChanged support in your business classes (albeit manually, at least with the help of utilities <a href="https://github.com/Fody/PropertyChanged">like this</a> , which automatically insert the necessary implementation during compilation).  Alternatively, you can implement our special <a href="https://documentation.devexpress.com/">IObjectSpaceLink</a> interface and call ObjectSpace.SetModified (this) with your hands to trigger a notification of the change in the right places. <br><br>  <b>4.</b> From experience, clients can (and want) to place business logic right in the EF classes themselves instead of implementing individual controllers or services.  It‚Äôs not in our right to forbid them (although there are a <a href="http://stackoverflow.com/search%3Fq%3Danemic%2Bdomain%2Bmodel">lot of holivars</a> on the anemic model vs rich <a href="http://stackoverflow.com/search%3Fq%3Danemic%2Bdomain%2Bmodel">in StackOverFlow</a> , I remember even <a href="http://stackoverflow.com/search%3Fq%3Danemic%2Bdomain%2Bmodel">throwing</a> my own five kopecks <a href="http://stackoverflow.com/questions/4834918/objectcontext-aware-entity-in-ef-to-avoid-anemic-domain-model/28178827">here</a> ) and for such cases, in addition to the above-mentioned IObjectSpaceLink, the IXafEntityObject interface, which makes it easier to write logic on creation (OnCreated) , loading (OnLoaded) and saving entities (OnSaving). <br><br>  <b>5.</b> If you have a ready-made library of EF classes from the ASP.NET MVC project, it may be important for you to know that at the moment we have limited support for standard <a href="https://msdn.microsoft.com/ru-ru/library/system.componentmodel.dataannotations(v%3Dvs.110).aspx">Data Annotations</a> attributes affecting the appearance of the interface, for example DisplayFormat, UIHint.  At the same time, the standard attributes from EntityFramework.dll, System.ComponentModel.DataAnnotations.dll and other system assemblies that affect the behavior of the EF itself, work as they should, for example, StringLength, NotMapped, ComplexType.  Anyway, XAF has a <a href="https://documentation.devexpress.com/">lot of its universal attributes</a> for every taste and color, which allows you to speed up the configuration of the UI and related logic in simple cases.  Looking ahead, it is worth noting that, in general, for such a task it is preferable to use the Application Model ( <a href="http://habrahabr.ru/company/devexpress/blog/153755/">here I have</a> already told in more detail). <br><br><h2>  <font color="#888">Finally</font> <br></h2><br>  These are probably all the main features of integrating EF into XAF that you need to be aware of at this stage.  You can deepen your understanding with our online documentation here: <a href="https://documentation.devexpress.com/eXpressAppFramework/CustomDocument112670.aspx">eXpressApp Framework</a> &gt; <a href="https://documentation.devexpress.com/eXpressAppFramework/CustomDocument112683.aspx">Concepts</a> &gt; <a href="https://documentation.devexpress.com/eXpressAppFramework/CustomDocument113461.aspx">Business Model Design</a> &gt; <a href="https://documentation.devexpress.com/eXpressAppFramework/CustomDocument113462.aspx">Business Model Design with Entity Framework</a> and <a href="https://documentation.devexpress.com/">eXpressApp Framework&gt; Getting Started&gt; Basic Tutorial</a> (it also contains information about the framework and basic approaches in general).  Also, the XCRM, EFDemoCodeFirst, EFDemoModelFirst demos can be useful, which can be found in <i>% Public% \ Documents \ DevExpress Demos 15.1 \ Components \ eXpressApp Framework \</i> and which are quite complex and complete applications that demonstrate integration with almost all modules of the framework.  A bunch of examples and answers <a href="https://search.devexpress.com/%3Fq%3Dentity%2520framework%26m%3DDocumentation">in the knowledge base of technical support will</a> also not be superfluous to the mention. <br><br>  In the next series, we will directly create an EF data model using an existing database and also implement the basic logic of the original prototype application. <br><br>  Regards, <br>  Denis <br><br><h2>  <font color="#888">PS</font> <br></h2><br>  If you are interested in our products and after a more detailed study of them during the free trial period, you will want to purchase them, then by December 20, 2015, you can use the ten days to purchase a new package (~ $ 220 or ~ 14 thousand rubles at the current rate) licenses DevExpress Universal, which includes <a href="https://www.devexpress.com/Subscriptions/">XAF and a bunch of other</a> development <a href="https://www.devexpress.com/Subscriptions/">tools</a> for popular platforms.  To do this, you will need to <a href="http://store.softline.ru/developer-express-inc/universal-subscription/">go to the store Softline.ru</a> and after completing the order <br><div class="spoiler">  <b class="spoiler_title">enter code into a special field</b> <div class="spoiler_text">  Universal_XafEf <br></div></div><br>  Special thanks to our reseller for the fact that we quickly managed to agree on this action for the benefit of the Russian-speaking community of the CIS at such a time.  If you suddenly feel more comfortable kypit in valuta <a href="">directly from our site</a> , then for a similar discount, write <a href="">me an e-mail</a> with a link to this post.  There you can also send any questions on the XAF, suggestions or inform about possible problems. </div><p>Source: <a href="https://habr.com/ru/post/271331/">https://habr.com/ru/post/271331/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271319/index.html">Ossim. Creating a simple plugin for parsing logs</a></li>
<li><a href="../271321/index.html">How to solve the problem of machine understanding of natural language</a></li>
<li><a href="../271323/index.html">Drupal 8 released - critical look</a></li>
<li><a href="../271325/index.html">The digest of news from the world of development on Unity</a></li>
<li><a href="../271329/index.html">New Yandex.Webmaster</a></li>
<li><a href="../271333/index.html">Pirate metrics: how to create an email campaign based on the AARRR principle. Part 5</a></li>
<li><a href="../271337/index.html">Virtual quadrocopter on Unity + OpenCV (Part 3)</a></li>
<li><a href="../271339/index.html">‚ÄúMy code doesn't interest anyone‚Äù or why good web studios should challenge this</a></li>
<li><a href="../271341/index.html">New PandaLabs Quarterly Lab Quarterly Report</a></li>
<li><a href="../271343/index.html">Can nanoCAD replace western CAD solutions? Let's look for an answer ...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>