<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Continuous monitoring of the JVM with Zabbix</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Suppose you have a large application written in Java. This can be a web servlet hosted in a container or a standalone service. During the development ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Continuous monitoring of the JVM with Zabbix</h1><div class="post__text post__text-html js-mediator-article">  Suppose you have a large application written in Java.  This can be a web servlet hosted in a container or a standalone service.  During the development process (and even during operation) there is a need to track the processes occurring in the JVM: the work of the garbage collector, memory usage, the life cycle of threads, as well as other indicators specific to your project through MBean.  The easiest option is to use the profiler.  But alas, problems do not happen on a schedule, and it is impossible to know in advance when you need to connect the profiler, and keeping it on all the time is also not an option.  In such cases, the ideal solution is continuous monitoring.  About him and will be discussed.  But first, a couple of words about classical profiling. <br><a name="habracut"></a><br><h4>  Using the profiler </h4><br>  Perhaps the easiest and most accessible method of monitoring an application.  Profilers allow real-time monitoring of the state of the JVM, detailed analysis of the statistics of its work, up to an analysis of the activities of individual streams.  There are both free and paid solutions on the market: <br><ul><li>  <b>jconsole</b> is a utility included in the hiking set of coffee collectors ‚Äú <a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/">JDK Tools and Utils</a> ‚Äù.  Gives access to all basic JVM statistics, including direct work with MBeans. </li><li> <a href="http://visualvm.java.net/"><b>VisualVM</b></a> - advanced analogues of jconsole.  For some time ( <a href="http://www.oracle.com/us/corporate/press/018363">when someone bought someone</a> ) also comes with jdk.  You can read about VisualVM and the basics of profiling in <a href="http://habrahabr.ru/blogs/java/61857/">this article</a> .  From myself I‚Äôll just add that if you need to connect the profiler to the JVM on a remote server, and you don‚Äôt want to bother, just find the visualvm binary on it, and then call it via ssh with the X session broadcast: <br> <code>ssh -X login@domain /usr/bin/jvisualvm</code> <br> </li><li>  <a href="http://www.ej-technologies.com/products/jprofiler/overview.html"><b>JProfiler</b></a> is the leader among commercial profilers (if someone has a wealth of experience in its application, I will be glad to learn it). </li></ul><br><h4>  Continuous monitoring </h4><br>  Profilers have one major drawback - you cannot keep it open 24 hours a day, 7 days a week.  It is simply not intended for this.  Why do we need such monitoring?  Then, that you never know when your application will have problems.  Continuous monitoring allows you to perform a summary analysis of statistics for the day, day, month, build initial assumptions about the reasons for the incorrect operation of the service / application, based on the graphs of memory usage, flows, and other metrics.  For example, at night you run QA tests, and in the morning you analyze the behavior of the service based on continuous monitoring. <br><br>  I did not find a ready-made system for an acceptable combination of price and quality, therefore, having extensive experience with <a href="http://www.zabbix.com/ru/">Zabbix,</a> I decided to adapt it to fit my needs (for those who are familiar with Zapcat - a couple of words about it will be at the end of the article).  You can immediately ask: ‚Äúwhy Zabbix, not <a href="http://www.nagios.org/">Nagios</a> ?‚Äù.  I love finished products that work out of the box and do not require manual debugging and docking of modules. <br><br>  So, let's get down to server cooking ;-)!  To prepare the dish ‚ÄúContinuous monitoring JMX using Zabbix‚Äù we need: <br><ul><li>  Ubuntu Server 10.04 (Debian and RedHat can be used as substitutes) </li><li>  PostgreSQL or MySQL to taste </li><li>  Zabbix server </li><li>  Zabbix client </li><li>  Oracle Java (scripts from this article are oriented on JVM HotSpot) </li><li>  <a href="http://www.jolokia.org/">Jolokia</a> (JMX-HTTP bridge) - helps to avoid problems with setting up JMX RMI connections </li></ul><br>  Let me remind you that all actions are performed on a freshly installed OS. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Zabbix Quick Setup </h5><br>  If you already have a configured Zabbix server with client machines connected for monitoring, you can go directly to the next item. <br><br>  Zabbix server and agent can be supplied both from the repository and collected from source.  Usually there are very old versions of zabbix in the repositories, and they will work for tests, but for everyday use I recommend something newer.  So, we put from the repository: <br><br> <code>sudo apt-get install zabbix-agent zabbix-server-pgsql zabbix-frontend-php php5-pgsql tomcat6</code> <br> <br>  After installation, go to <a href="http://localhost/zabbix">localhost / zabbix Log in</a> as the Admin user with the password zabbix.  Go to the tab ‚ÄúConfiguration -&gt; Hosts‚Äù and click on the ‚ÄúZabbix Server‚Äù.  Change the status from ‚ÄúNot monitored‚Äù to ‚ÄúMonitored‚Äù.  Next, open the /etc/zabbix/zabbix_agentd.conf file in the editor and replace its contents with the suggested one: <br><br> <code>Server=127.0.0.1 <br> Hostname=redcraft <br> StartAgents=16 <br> DisableActive=1 <br> EnableRemoteCommands=1 <br> DebugLevel=4 <br> Timeout=30 <br> PidFile=/var/run/zabbix-agent/zabbix_agentd.pid <br> LogFile=/var/log/zabbix-agent/zabbix_agentd.log</code> <br> <br>  In Zabbix UI, go to ‚ÄúMonitoring -&gt; Last Data‚Äù and check that data has started to be collected from the local machine.  This completes the basic configuration of Zabbix, proceed to the preparation of JMX. <br><br><h5>  Connecting Jolkia JVM Agents </h5><br>  We'll use tomcat as an experimental JVM.  In order not to make connections to it using the RMI protocol, but to use HTTP, we use the JMX-HTTP bridge of Jolokia.  For tomcat on the official site is available <a href="http://www.jolokia.org/download.html">war-assembly</a> .  Rename the downloaded war file to jolokia.war and put it in / var / lib / tomcat6 / webapps.  Restart tomcat.  Open the address <a href="http://localhost/">localhost</a> : 8080 / jolokia and, if done correctly, we see the following information: <br><br> <code>{"timestamp":1328444565,"status":200,"request":{"type":"version"},"value":{"protocol":"6.1","agent":"1.0.2","info":{"product":"tomcat","vendor":"Apache","version":"6.0.24"}}}</code> <br> <br>  If you have a standalone application, then to connect jolokia to it, add the following parameter to the launch line: <br><br> <code>-javaagent:$LIBDIR/jolokia-agent.jar=port=9090,host=localhost</code> <br> <br>  where <i>$ LIBDIR / jolokia-agent.jar</i> is the path to the Jolokia JVM-Agent <br><br><h5>  Configure data collection with Jolokia </h5><br>  Now we have Zabbix and JVM with a JMX-HTTP bridge connected to it.  Need to organize data collection.  The data collection scheme will be as follows: <br><br><img src="http://lh5.googleusercontent.com/-QlvfXswQaxY/Ty6YJMC2UeI/AAAAAAAAAUU/qKzuZmkCxqw/s640/zabbix_jvm_monitoring.png" alt="image"><br><br>  Let me explain why I do not collect metrics directly, but use an intermediate buffer.  If you configure the scheme without it, then for each request the JMX statistics collection script will be launched, which is a more resource-intensive operation than reading from the buffer.  Therefore, I chose a model in which once every N seconds all metrics are collected, placed in files, and then read from files as needed. <br><br>  For data collection, we will use the ready-made library of work with the JMX-HTTP bridge.  The library is written in Perl and installed by means of CPAN: <br><br> <code>sudo cpan -i JMX::Jmx4Perl</code> <br> <br>  After a successful installation, try to get the first metrics with tomcat using jmx4perl: <br><br> <code><a href="http://localhost/"></a> jmx4perl localhost:8080/jolokia read java.lang:type=Memory HeapMemoryUsage</code> <br> <br>  The result of the team should look like this: <br><br> <code>{ <br> committed =&gt; 65470464, <br> init =&gt; 0, <br> max =&gt; 132579328, <br> used =&gt; 10264072 <br> }</code> <br> <br>  As you can guess, we have just received information about using JVM Tomcat Heap memory. <br><br>  Now you should write a script for collecting metrics, followed by placing them in the files of the specified directory.  You can write your own or use my example: <br><br><pre> <code class="hljs mel">#!/usr/bin/perl use strict; use warnings; use Error qw( :try ); use JMX::Jmx4Perl; use JMX::Jmx4Perl::Alias; use File::Path qw(make_path remove_tree); use Data::Dumper; my %source = ( GC_COPY_COLLECTION_COUNT =&gt; [<span class="hljs-string"><span class="hljs-string">"java.lang:name=Copy,type=GarbageCollector"</span></span>, <span class="hljs-string"><span class="hljs-string">"CollectionCount"</span></span>], GC_MARK_SWEEP_COLLECTION_COUNT =&gt; [<span class="hljs-string"><span class="hljs-string">"java.lang:name=ConcurrentMarkSweep,type=GarbageCollector"</span></span>, <span class="hljs-string"><span class="hljs-string">"CollectionCount"</span></span>], GC_COPY_COLLECTION_TIME =&gt; [<span class="hljs-string"><span class="hljs-string">"java.lang:name=Copy,type=GarbageCollector"</span></span>, <span class="hljs-string"><span class="hljs-string">"CollectionTime"</span></span>], GC_MARK_SWEEP_COLLECTION_TIME =&gt; [<span class="hljs-string"><span class="hljs-string">"java.lang:name=ConcurrentMarkSweep,type=GarbageCollector"</span></span>, <span class="hljs-string"><span class="hljs-string">"CollectionTime"</span></span>], THREAD_COUNT =&gt; [<span class="hljs-string"><span class="hljs-string">"THREAD_COUNT"</span></span>], MEMORY_HEAP_COMITTED =&gt; [<span class="hljs-string"><span class="hljs-string">"MEMORY_HEAP_COMITTED"</span></span>], THREAD_COUNT_DAEMON =&gt; [<span class="hljs-string"><span class="hljs-string">"THREAD_COUNT_DAEMON"</span></span>], THREAD_COUNT_STARTED =&gt; [<span class="hljs-string"><span class="hljs-string">"THREAD_COUNT_STARTED"</span></span>], MEMORY_HEAP_INIT =&gt; [<span class="hljs-string"><span class="hljs-string">"MEMORY_HEAP_INIT"</span></span>], RUNTIME_VM_VENDOR =&gt; [<span class="hljs-string"><span class="hljs-string">"RUNTIME_VM_VENDOR"</span></span>], MEMORY_HEAP_MAX =&gt; [<span class="hljs-string"><span class="hljs-string">"MEMORY_HEAP_MAX"</span></span>], RUNTIME_VM_NAME =&gt; [<span class="hljs-string"><span class="hljs-string">"RUNTIME_VM_NAME"</span></span>], CL_TOTAL =&gt; [<span class="hljs-string"><span class="hljs-string">"CL_TOTAL"</span></span>], CL_LOADED =&gt; [<span class="hljs-string"><span class="hljs-string">"CL_LOADED"</span></span>], CL_UNLOADED =&gt; [<span class="hljs-string"><span class="hljs-string">"CL_UNLOADED"</span></span>], THREAD_COUNT_PEAK =&gt; [<span class="hljs-string"><span class="hljs-string">"THREAD_COUNT_PEAK"</span></span>], RUNTIME_UPTIME =&gt; [<span class="hljs-string"><span class="hljs-string">"RUNTIME_UPTIME"</span></span>], MEMORY_HEAP_USED =&gt; [<span class="hljs-string"><span class="hljs-string">"MEMORY_HEAP_USED"</span></span>], RUNTIME_VM_VERSION =&gt; [<span class="hljs-string"><span class="hljs-string">"RUNTIME_VM_VERSION"</span></span>], ); my $log_dir = <span class="hljs-string"><span class="hljs-string">"/var/jmx"</span></span>; my $result = <span class="hljs-number"><span class="hljs-number">0</span></span>; my $port = $ARGV[<span class="hljs-number"><span class="hljs-number">0</span></span>]; my $cmd = $ARGV[<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(defined $cmd &amp;&amp; defined $port) { try { my $jmx = JMX::Jmx4Perl-&gt;new(url =&gt; <span class="hljs-string"><span class="hljs-string">"http://localhost:$port/jolokia/"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($cmd eq <span class="hljs-string"><span class="hljs-string">"DUMP"</span></span>) { make_path(<span class="hljs-string"><span class="hljs-string">"$log_dir/$port"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(my($key, $value) = each %source) { open FILE, <span class="hljs-string"><span class="hljs-string">"&gt;$log_dir/$port/$key"</span></span> or throw Error::Simple(<span class="hljs-string"><span class="hljs-string">"Could not open file"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> FILE $jmx-&gt;get_attribute(@$value) . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; close FILE; } $result = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { my $param = $source{$cmd}; $result = $jmx-&gt;get_attribute(@$param); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> Error with { $result = <span class="hljs-number"><span class="hljs-number">0</span></span>; # --- Uncomment <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> debug --- #my $ex = shift; #<span class="hljs-keyword"><span class="hljs-keyword">print</span></span> $ex-&gt;{-<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>}.<span class="hljs-string"><span class="hljs-string">"\n"</span></span>; #<span class="hljs-keyword"><span class="hljs-keyword">print</span></span> $ex-&gt;{-line}.<span class="hljs-string"><span class="hljs-string">"\n"</span></span>; # --- Debug block ended --- }; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $result = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> $result . <span class="hljs-string"><span class="hljs-string">"\n"</span></span>;</code> </pre><br><br>  Place the script in / usr / local / sbin and call it jmx_grabber.  There is a possibility that the script will not work.  This is associated with the first four metrics: GC_COPY_COLLECTION_COUNT, GC_MARK_SWEEP_COLLECTION_COUNT, GC_COPY_COLLECTION_TIME, GC_MARK_SWEEP_COLLECTION_TIME.  Metrics display nothing more than ‚Äúgarbage collector‚Äù (GC) statistics.  The names of the garbage collectors used in a particular JVM implementation may differ.  For JVM HotSpot I met two pairs: PS Scavenge + PS MarkSweep and ConcurrentMarkSweep + Copy.  If you have difficulties with determining the name of your GC, then run the command <br><br> <code><a href="http://localhost/"></a> jmx4perl localhost:8080/jolokia attributes | less</code> <br> <br>  and then search for the keyword "GarbageCollector".  You will find something like: <br><br> <code>java.lang:name=ConcurrentMarkSweep,type=GarbageCollector -- CollectionCount = 12 <br> java.lang:name=ConcurrentMarkSweep,type=GarbageCollector -- LastGcInfo = <br> java.lang:name=ConcurrentMarkSweep,type=GarbageCollector -- CollectionTime = 0 <br> java.lang:name=ConcurrentMarkSweep,type=GarbageCollector -- Name = ConcurrentMarkSweep <br> java.lang:name=ConcurrentMarkSweep,type=GarbageCollector -- Valid = [true]</code> <br> <br>  The value ‚Äújava.lang: name‚Äù is the name of one of the ‚Äúgarbage collectors‚Äù. <br><br>  Now we will write the script in bash to get data from the files: <br><br><pre> <code class="hljs kotlin">#!/bin/bash JMX_DIR=<span class="hljs-string"><span class="hljs-string">"/var/jmx"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -r <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$JMX_DIR</span></span></span><span class="hljs-string">/$1/$2"</span></span> ]; then cat <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$JMX_DIR</span></span></span><span class="hljs-string">/$1/$2"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> echo <span class="hljs-number"><span class="hljs-number">0</span></span>; fi</code> </pre><br><br>  For the work of written scripts, we need the following Perl libraries: File :: Path, Module :: Find, JSON, Error.  Install them: <br><br> <code>sudo cpan -i File::Path <br> sudo cpan -i Module::Find <br> sudo cpan -i JSON <br> sudo cpan -i Error</code> <br> <br>  Check whether everything is done correctly.  Call the script with the following parameters: <br><br> <code>/usr/local/sbin/jmx-grabber 8080 RUNTIME_VM_NAME</code> <br> <br>  The string "Java HotSpot (TM) Client VM" should return to us.  Now we will create the / var / jmx folder and call the script with different parameters: <br><br> <code>/usr/local/sbin/jmx-grabber 8080 DUMP</code> <br> <br>  Check the contents of the / var / jmx folder.  A subdirectory 8080 should appear in it containing JVM metrics files, one for each metric.  It is not difficult to guess that the 8080 is a local port that is listened to by either the jolokia agent (standalone installation) or tomcat with the jolokia container. <br><br>  Having configured the collection and reading of metrics, let's move on to the process of uploading them to Zabbix. <br><br><h5>  Unloading JVM metrics in Zabbix </h5><br><br>  Add two lines to the /etc/zabbix/zabbix_agentd.conf file: <br><br> <code>UserParameter=jmx_grabber[*],/usr/local/sbin/jmx-grabber $1 $2 <br> UserParameter=jmx_reader[*],/usr/local/sbin/jmx-stats-reader $1 $2</code> <br> <br>  After that, do not forget to restart the zabbix agent.  The added lines allow to access the file system scripts as usual Zabbix metrics.  There is an alternative way: you can use the zabbix trapper, and send statistics in the active mode, do not use the zabbix agent.  There are no big differences.  In the case of using Zabbix-agent, the data collection periods are set in Zabbix via the UI.  In case of using trapper, you will have to scatter cron-scripts of sending metrics via puppet (or its analogs). <br><br>  Now it's time to create templates.  I will not go deep into this process and attach the prepared <a href="">xml file of the template</a> that needs to be imported into Zabbix.  To do this, open the ‚ÄúConfiguration -&gt; Export / Import‚Äù tab (in the latest Zabbix versions, the import is in ‚ÄúConfiguration -&gt; Templates‚Äù, then the ‚ÄúImport Template‚Äù button) and select from the ‚ÄúImport‚Äù list: <br><br><img src="http://lh3.googleusercontent.com/-HhK9-B8f1rQ/TzBD3iDYlNI/AAAAAAAAAUo/FOC8GEcjx4U/s400/Screen%2520Shot%25202012-02-07%2520at%25203.16.20.png" alt="image"><br><br>  Now you need to assign the added template to our server.  Go to the ‚ÄúConfiguration -&gt; Hosts‚Äù tab and click on the ‚ÄúZabbix Server‚Äù.  In the "Linked templates" panel, add our template "Template_Multitenant_Tomcat_JMX_Toolkit".  Click on ‚ÄúSave‚Äù, then go to ‚ÄúMonitoring -&gt; Last Data‚Äù.  After 20 seconds you will receive the first statistics from the JVM Tomcat.  If the data does not arrive, check whether the zabbix-agent is running and configured correctly (see above).  After half an hour you can look at the graphs (‚ÄúMonitoring -&gt; Graphs‚Äù), there you will see something like the following for ‚ÄúTomcat JVM Memory‚Äù: <br><br><img src="http://lh4.googleusercontent.com/-ptnYIHNdGe4/TzBG1C4zcpI/AAAAAAAAAUw/nGzX3gpej40/s640/Tomcat%2520JVM%2520memory.png" alt="image"><br><br>  Most likely, you will have a question, but what if there are several JVMs on the same physical / virtual machine?  After all, port 8080 is clearly indicated in the template. Yes, this is an unpleasant feature, but in order to add several JVMs of one machine for monitoring, you need to create a separate template for each jolokia port from which data will be collected. <br><br><h5>  Testing </h5><br>  Well, we have a system for collecting metrics with JVM Tomcat.  It would be great to try it out in action.  For these purposes, I wrote a small service that creates threads, which, in turn, continuously generate objects in the JVM right up to their stop.  Externally accessible management interface looks like this: <br><br><img src="http://lh6.googleusercontent.com/-qZnnJUNhEEk/TzPjYWP5ggI/AAAAAAAAAU4/-l7wtAtgC9M/s800/Benchmark.png" alt="image"><br><br>  The ‚ÄúIncrease‚Äù and ‚ÄúDecrease‚Äù buttons increase and decrease the number of threads, while the Multiplier gives you control over the multiplier of the time delay of the stream before generating the next object.  Service can be <a href="">downloaded here</a> . <br><br>  Place the service in Tomcat, and then perform the following manipulations: <br><ul><li>  raise the number of threads to 20 and wait 5 minutes </li><li>  raise the number of threads to 50 and again wait 5 minutes </li><li>  reduce the stream delay multiplier to 50 and expect 5 minutes </li><li>  reset the number of threads to zero </li></ul><br><br>  As a result, we get the following graphs: <br><br><img src="http://lh5.googleusercontent.com/-ojXz0Bz2d14/TzP8Wd0wMmI/AAAAAAAAAVE/g_HaAn8sxXA/s400/Memory.png" alt="image"><br><br><img src="http://lh3.googleusercontent.com/-LX_T_B0-LWI/TzP8WAwvRII/AAAAAAAAAVA/WdaI8jZZofw/s400/GC.png" alt="image"><br><br><img src="http://lh3.googleusercontent.com/-lKTvQq9BFRk/TzP8WexyzcI/AAAAAAAAAVI/rXQhW7sZNnU/s400/Threads.png" alt="image"><br><br><h5>  Zapcat </h5><br>  When I said that I did not find acceptable ready-made solutions, I was a little devious.  One solution exists - this is <a href="http://www.kjkoster.org/zapcat/Zapcat_JMX_Zabbix_Bridge.html">Zapcat</a> .  And, by the way, using tomcat and Zabbix to cross it will not take more than 5 minutes.  Why did I reinvent the wheel?  There are two reasons for this: <br><ul><li>  zapcat has not been updated since 2008.  Not that it is really bad - it still worked tolerably well.  But I don‚Äôt really want to use a system that no one supports. </li><li>  zapcat agent will connect to standalone services directly in the application code.  For me, it looks as if a blood pressure monitor and other sensors were sewn to the children at birth, which could only be removed later through surgery.  I really did not want to make zapcat (which is no longer supported) part of the application.  This is not safe, and from an architectural point of view it is illiterate.  In theory, zapcat can be issued as a javaagent, but I did not find ready-made implementations that can be connected using the same directive. </li></ul><br>  In order to decide if you need the monitoring method I described, or if zapcat will be enough for you, as an easy-to-deploy alternative, ask the following questions: <br><ul><li>  Do I want to integrate monitoring tools into my application?  (relevant only for standalone-services) </li><li>  Do I want to perform additional processing of intermediate data that has already been collected in the file system (or cache).  You may want to calculate the average total for all copies of the services. </li><li>  Do I want to access the service / application of the jmx bridge using other tools other than zabbix? </li></ul><br><h4>  At last </h4><br>  The variant I proposed is not so much a complete monitoring system as a framework for building a service life control system based on specific tasks and needs.  Together with the ability of Zabbix to detect its agents and automatically add network nodes to the monitor, the task of controlling the operation of java-services is simplified many times. <br>  If you have any difficulties in setting up - write in a personal or in the comments, I will prompt as much as possible.  For those who do not want to manually configure the test bench, I suggest using the <a href="">ready-made way for VirtualBox</a> (login red, password password). <br>  Enjoy your experiments and stable JVM!  ;-) <br><br>  PS: I can respond to messages and comments only at lunch and in the evenings </div><p>Source: <a href="https://habr.com/ru/post/137641/">https://habr.com/ru/post/137641/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137633/index.html">Specialists from the Ruhr University managed to crack the encryption system satellite telephone</a></li>
<li><a href="../137634/index.html">Are you afraid that they will close ex.ua again? Not worth it - everything can be downloaded on the server of the Ministry of Internal Affairs of Ukraine</a></li>
<li><a href="../137636/index.html">Mail.Ru Group has acquired the service RuTwit.ru</a></li>
<li><a href="../137637/index.html">What to do?</a></li>
<li><a href="../137639/index.html">Unicode 6.1 standard released, 732 new characters added</a></li>
<li><a href="../137643/index.html">Designing synchronous circuits. Quick Start with Verilog HDL</a></li>
<li><a href="../137644/index.html">Why do companies need mobile apps or why there are so much junk in Markets</a></li>
<li><a href="../137647/index.html">‚ÄúGeolans‚Äù - a new phenomenon in the market of services</a></li>
<li><a href="../137650/index.html">Automatic image rotation on the monitor</a></li>
<li><a href="../137652/index.html">Once again about finding the greatest concentration in a cloud of points</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>