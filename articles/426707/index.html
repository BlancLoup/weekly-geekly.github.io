<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Matching system How we invented the bicycle</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue to talk about how we improve the life not only of our clients and partners, but also of the company's employees. It will be a question of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Matching system How we invented the bicycle</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/5a/ye/ur/5ayeuraj68c552yh9l_qczxbpau.jpeg"><br><br>  We continue to talk about how we improve the life not only of our clients and partners, but also of the company's employees.  It will be a question of introduction of the coordination system.  Consciously did not indicate the agreement of ‚Äúwhat‚Äù, since in the future it will become clear that, purely theoretically, the agreement of ‚Äúeverything‚Äù. <br><a name="habracut"></a><br><h3>  Reflections on the approval system </h3><br>  Initially, in our company, as in many others in which I had to work, and also in which I was a ‚Äúguest‚Äù or simply heard from my acquaintances, agreement negotiation was carried out (and at the time of writing this article is still being conducted) mail.  Naturally, this suits companies with a small number of personnel and counterparties.  There is no special need to invent and implement systems because of the signing of one or two contracts per month (or even a year) with the sole director-general on signing the decision.  A similar situation was observed with the payment of bills.  Every employee who interacts with contractors and who needs to pay something, requests an invoice and sends by mail to the accounting department with a request to ‚Äúpay‚Äù.  At the same time, the accounting department does not always pay bills without prior approval of payment with the employee‚Äôs immediate supervisor and / or company management.  Under certain conditions, the chain of approvals can be ‚Äúshortened‚Äù or, on the contrary, ‚Äúlengthened‚Äù. <br><br>  While there are not many employees and everyone knows all his colleagues, who is who and who is who the head - there are no special problems.  In the manual mode and under certain conditions, requests for payment are coordinated in the correspondence mode and paid (or rejected).  But our company is growing and from a certain point we crossed that invisible line, after which we need to think about automating these processes and the need to introduce something new. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Our Wishlist </h3><br>  We had our minimum system requirements: <br><br><ul><li>  User-friendly interface and highly desirable web-oriented (without the need to install clients) </li><li>  Customization flexibility </li><li>  Though we are not clinical, but paranoid.  Therefore, the services in which confidential information may appear, we want to keep in our closed perimeter </li></ul><br>  Initially, we analyzed the products of the ‚Äúelectronic document management system‚Äù family that are on the market.  We looked at the well-known systems: 1: Document circulation, ‚ÄúBUSINESS‚Äù, ‚ÄúTEZIS‚Äù.  Also looked at the systems that were made to order for other companies, as well as new items such as Allware. <br><br>  I can not say that the systems are bad.  In fact, almost all systems allow us to perform our basic ‚Äúwishes‚Äù and even more than we need.  But, as usual, the devil is in the details. <br><br>  First of all - the interface.  We are not accustomed to using the interface in the style of "1C".  We need a simple, intuitive interface, in which we will perform a minimum of actions to obtain the maximum result (and who does not want to?). <br>  Secondly, the price (paid in one step and then the cost of ownership of the product as a whole).  We do not need everything in systems that are offered out of the box.  But at the same time you have to pay immediately for everything.  And since now many are switching to a subscription system, they have to pay constantly and the amount, as usual, depends on a variety of conditions (number of users / connections, ability to work in the cloud, additional options, modules, etc.).  And to ‚Äújump off‚Äù from the system, if suddenly the price stopped arranging - it is problematic. <br>  Thirdly, there is no possibility to ‚Äúmanage‚Äù your ‚ÄúWishlist‚Äù. <br><br><h3>  Implementation </h3><br>  I won‚Äôt describe for a long time how and why in the end we stopped at the decision to ‚Äúinvent a bicycle‚Äù and write our electronic document management system.  The decision is made - you need to do.  We have already gone through the illness of trying to sell a product without requirements, so the process of writing the TK and its coordination initially started.  Fortunately, we had examples of implementations before our eyes, so the formation was rather painless. <br><br>  The only thing we had to break the spears was in the process of developing the architecture not to be tempted to satisfy the requirements ‚Äúas is‚Äù, to the detriment of flexibility and further ease of use.  The temptation was great, especially for the main customer, since the implementation and implementation period would be reduced by 2 times.  But we managed to convince both the leadership and ourselves that ‚Äúit is better to lose a day, then fly in 5 minutes‚Äù.  And I think that we made the right choice. <br><blockquote>  It is better to lose a day, then fly for 5 minutes. </blockquote>  The ‚Äústandard‚Äù stack - .Net Core 2 and EntityFramework, Angular 4, MS SQL, since we have a fairly large background in the application of tools and technologies.  Although the DBMS is of no special importance for us, for obvious reasons.  If necessary, move on to what we want. <br>  The result was a product that meets important requirements for us: <br><br><ul><li>  One workflow - different participants of the agreement (linked to the next item) </li><li>  Conditions for skipping the approval stage for specified conditions (any field in the application can be added to the condition with a specified check and, based on the validity of the condition, the need to move to the next approval step or its ‚Äúpass‚Äù is determined) </li><li>  Our ‚Äúproprietary‚Äù interface </li></ul><br>  Were also worked out and implemented such convenient and useful features as: <br><br><ul><li>  Setting the default values ‚Äã‚Äãof reference books (both user and system).  The user directory is an entity that allows you to define elements yourself by the user.  Created items will be available only to him.  In this case, the administrator of the system can add general elements to such a reference book that will be accessible to all users of the system. </li><li>  Determination of the most frequently used elements of directories for each user and the formation of lists in the interface based on this statistics (sorting) </li><li>  Fully customizable schemes from admin panel (structure and properties of fields to fill in) and presentation (arrangement of elements in the form) of each type of request for approval </li><li>  Flexible ACL </li><li>  Customizable search by each user for different sets of parameters.  Parameters can be any properties of application templates with the ability to select a condition that must be imposed on this field during filtering.  In this case, you can create as many sets for filtering.  Convenient for quick search in different cuts. </li><li>  Checking the validity of the entered values ‚Äã‚Äãbased on a given template for a specific field of the application </li></ul><br>  Of course, there was no ‚Äúcuriosity‚Äù.  First of all we are talking about configuring vorkflou.  We initially decided that we needed the ability to configure the business process tree.  So that from one point (stage) of coordination it would be possible to go on different branches, depending on the choice of the user (the coordinator).  Logical and flexible.  But already after we implemented this feature and launched the system in production, it seemed to us that in fact it was not necessary to give the user the right to choose (think about).  For him, everything should happen at the level of ‚ÄúReconcile‚Äù, ‚ÄúRefuse‚Äù.  Otherwise, we will not be able to deviate from the principle that the employee understands the subtleties of interaction in the company.  And to meet this condition vorkflou must be <b>linear</b> . <br><blockquote>  Of course, there was no ‚Äúcuriosity‚Äù. </blockquote>  As a result, we found a compromise - the architecture of the solution and the implementation of the workflow were left tree-like, while the use from the point of view of configuration was fixed at the level of ‚Äúagreement‚Äù.  And rightly so.  Since now, when analyzing the tasks related to the launch of new types of approvals, it became clear that at some stages, for specific types of requests, we need to provide an opportunity for the coordinator to choose various actions. <br><br>  Now a little about our ‚Äúknow-how‚Äù (at least we believe in it).  To achieve linearity and at the same time use one workflow for one approval scheme (under the scheme I mean entities that require engagement and the order of different roles ‚Äî agreement, invoice for payment, etc.), we have thought out and implemented the conditions mechanism skip the next stage (s) coordination.  In forming the conditions, we can use any essence of the approval card and compare it with ‚Äúsomething‚Äù. <br><br>  <i>For example, we have the following entities: Initiator, Amount, Currency, Counterparty.</i>  <i>And we need to, with an amount less than 100,000 rubles.</i>  <i>did not pass approval through employee A, in case of currency payments, necessarily connected to coordination B, and if the initiator is employee C, additional coordination is required for employee D. In this case, by employees we mean both individuals and a specific group.</i>  <i>To implement these points, we add all the points of agreement "in line".</i>  <i>Ie: Initiator-&gt; A-&gt; B-&gt; D-&gt; ...</i> <i><br><br></i>  <i>Next, conditions are formed on the ‚Äúskip‚Äù of the transition to each of the matching points.</i>  <i>For example, the Transition Initiator-&gt; A configures the condition ‚ÄúAmount &lt;100,000‚Äù, on (Initiator) A-&gt; B - Currency = ‚ÄúRuble‚Äù, (Initiator, A, B) -&gt; D - Initiator! = C.</i> <i><br><br></i>  <i>Why are brackets shown in transitions?</i>  <i>Because conditions can be fulfilled in a complex and ‚Äúunder the hood‚Äù, if we form a condition for the transition to the coordination point, we automatically generate another system transition that ‚Äúbypasses‚Äù this point (it was here that our tree-like architecture of the workflow helped us and there was nothing ‚ÄúCrutch‚Äù).</i> <br><br>  Well, a little fly in the barrel of honey.  We did not reach out to the implementation of a configurable notification management mechanism.  Although initially it was laid in the architecture of the project.  As usual, to speed up the launch process, we had to ‚Äútemporarily hard-code‚Äù a bit, and at the moment this hardcode remained.  And the idea was to create a mechanism similar to jira, which allows you to create your own notification scheme in which you can set triggers (events) and associate them with groups or specific employees and be able to ‚Äúbind‚Äù it to any type of application. <br><blockquote>  To speed up the launch process, I had to ‚Äútemporarily cheat‚Äù a little. </blockquote><h3>  Interfaces </h3><br>  Some interfaces of our system, so that there is an understanding of what was discussed at all <br><br><h4>  Dashboard </h4><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/kd/rc/fd/kdrcfdpzq9inrw57fthq_krr09u.jpeg" alt="dashboard" width="80%"></a> </div><br><br>  The first thing that the user of the system sees when it is opened (if you do not take into account the authentication process) is a dashboard.  It displays only active (incomplete) matching.  In this case, applications are divided into 2 segments: <br><br><ul><li>  Applications that require user approval (I am a performer) </li><li>  Applications that were initiated by the user (I am the author) </li></ul><br><h4>  Create a new application </h4><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/fz/vf/hx/fzvfhxn3ayokktbst4ctg78t-fc.jpeg" alt="Create application" width="80%"></a> </div><br><br>  The interface for creating a new application can have an idea (the number and arrangement of elements) absolutely any.  Here is a simple interface that demonstrates the ability to enter numbers, a choice from the list, a flag (check-box), date, attachments. <br>  The only thing you can pay attention to is the ‚ÄúCreate more‚Äù option.  When it is activated, after creating the current application, we are not in the dashboard or in the card of the application that has just been created, but the form for creating a new application of the same type as the one that was just created opens immediately.  It was implemented at the request of our employees, who have to create applications of the same type in batches. <br><br><h4>  Approval stage </h4><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/ii/p7/fe/iip7fe6wcpp8gvc2pwcrrlw0qli.jpeg" alt="Approval stage" width="80%"></a> </div><br><br>  This interface is not much different from the application creation form.  But it has a number of fundamental functional features: <br><br><ol><li>  Instead of creating buttons, there are buttons, clicks on which transfer the application to one of the states of the business process.  In the degenerate case described above, this is ‚ÄúReject‚Äù and ‚ÄúReconcile‚Äù </li><li>  Attachments, comments and a new entity log (action history) are in separate tabs. </li><li>  By default, all fields of the application, except for the comment, are inaccessible for editing.  At the same time, we have laid down the functionality that allows us to provide at any particular approval step the possibility to correct only a given set of fields. </li><li>  If you are the initiator of the application (you can always go to the approval card), and you have the option ‚ÄúCreate a duplicate‚Äù, when you click on it, the application creation form opens, the field values ‚Äã‚Äãof which (except for attachments) duplicate the field values ‚Äã‚Äãof the current application. </li></ol><br>  If you look closely, you can see an orange element in front of the field for selecting a Counterparty with a plus inside.  This is the personal directory management functionality.  Clicking on this item opens the form for adding a reference item. <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/rx/9r/2m/rx9r2msc1ngfb_d33lk7q6gzcfu.jpeg" width="40%"></a> </div><br><br>  Since in this case it is the Counterparty, the reference element we have contains two requisites - Name and TIN.  After creation, the user can immediately select this item from the drop-down list. <br><br><h4>  Search </h4><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/1o/9w/qf/1o9wqfjp9gzx4ogqgon2jvkf2tk.jpeg" width="80%"></a> </div><br><br>  In the search for applications, a set of properties is displayed at the top, the values ‚Äã‚Äãof which need to be sampled.  Sets are configurable by each user to fit their needs with the ability to quickly switch between them. <br><br><h4>  Business Process Administration </h4><br>  As part of business process management, we can create any number of route points and specify transitions.  The result is a transition graph.  And for each coordination point we can specify: <br><br><ul><li>  Who is coordinating at this point </li><li>  Permissions to perform actions at a given point in the route </li><li>  Conditions for skipping this point (approval stage) </li></ul><br><h5>  Matching </h5><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/13/tn/tb/13tntbfk4q34ve_y_af9d2rltpu.jpeg" width="80%"></a> </div><br><br>  In the ‚ÄúMatching‚Äù tab, you can add groups to which users can add to the approval process at this point in the business process. <br><br><h4>  Permissions for actions </h4><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/uv/4c/ma/uv4cmaqi75sv9yrwinhjbez0-ci.jpeg" width="80%"></a> </div><br><br>  Permissions can be a little more detailed.  To limit the actions of coordinating, associated with changes in the values ‚Äã‚Äãof fields (entities) in the application, a permission mechanism is introduced.  At the moment we have entered 4 permissions: <br><br><ul><li>  Attachment Download </li><li>  View attachments </li><li>  Commenting </li><li>  Change field values </li></ul><br>  If with the first three everything is more or less clear, then the permission to change the available fields should be commented.  By default, the coordinators cannot change any field values ‚Äã‚Äãin the application.  Only view mode is available.  In case it is necessary to allow changing specific fields of an application at a specific point of agreement, this option is activated and only those values ‚Äã‚Äãcan be selected from the list of fields of the application, whose values ‚Äã‚Äãcan be changed by the coordinating one. <br><br>  Although a bit far-fetched, but for example, this may be necessary if you have a separate position ‚Äúchecker of the correctness of filling the amount‚Äù, then give him the opportunity to change only the amount in the application and nothing more. <br><br><h4>  Pass conditions </h4><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/pa/qp/4c/paqp4cg89-far9hzehhuqypzhqk.jpeg" width="80%"></a> </div><br><br>  Pass conditions I described above.  Functionality is needed to form a single linear business process for all users of the system, and at the same time to carry out the movement of the application along the route in different ways, depending on the given condition and without user participation. <br><br>  A setting is prepared on the screenshot that will allow you to skip this waypoint if the initiator is in certain groups and the Currency is equivalent to the Russian ruble. <br><br><h3>  Instead of conclusion </h3><br>  Currently, our company has only one type of coordination.  But with the flexibility of customization that is incorporated in the system, we have the tools to configure any application card, where you can specify any number of fields, any presentation of the application card and any route matching with various conditions. <br><br>  The only thing that is required is to work the analyst on collecting the requirements and then transfer them to the system via the administration interface.  What we are doing now. <br><br>  The product is alive, periodically we make changes at the request of our employees, as a result of which its power and usability grows, and the implemented functions fulfill the task that our business faces, and we can always say with confidence that the requested functionality will be implemented in case if at all possible. </div><p>Source: <a href="https://habr.com/ru/post/426707/">https://habr.com/ru/post/426707/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../426693/index.html">Navigation service robot on the golf course. Construction and obstacle avoidance</a></li>
<li><a href="../426697/index.html">Working with devices on LibUsb from under Android</a></li>
<li><a href="../426701/index.html">Flutter - a new look at cross-platform development</a></li>
<li><a href="../426703/index.html">What was interesting on DataVizDay in Minsk</a></li>
<li><a href="../426705/index.html">Hyperledger Fabric Smart Contract Development and Testing</a></li>
<li><a href="../426709/index.html">JavaScript timers: all you need to know</a></li>
<li><a href="../426713/index.html">Intel Xeon W-3175X: 28 cores for home</a></li>
<li><a href="../426715/index.html">Russia is developing an analogue DMCA</a></li>
<li><a href="../426717/index.html">Illusion of deception: visual-optical illusion based on retro-prediction</a></li>
<li><a href="../426719/index.html">Hackathon on Data Science in SIBUR: how it was</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>