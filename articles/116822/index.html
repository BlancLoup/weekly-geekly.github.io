<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The speed of working with utf is obvious, but little known for beginners.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Now almost every article mentions that only utf should be used, because it is modern, universal and generally very useful. Without in any way denying ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The speed of working with utf is obvious, but little known for beginners.</h1><div class="post__text post__text-html js-mediator-article">  Now almost every article mentions that only utf should be used, because it is modern, universal and generally very useful.  Without in any way denying this fact, I would like to express bewilderment to those authors who simultaneously say the speed of the scripts, appealing to the fact that it is better to write ++ i than i ++, because of the speed of work. <br><br>  So the surprise is that working with utf is slower than with cp1251.  Because the size is larger and there is no ‚Äúalignment‚Äù of letters by bytes.  It's about <u>php / mysql</u> <br><br><a name="habracut"></a><br>  In fact, this is nothing particularly terrible.  In contrast to the jambs in the code, using utf does not slow down the work as much, but also slows down linearly, so the issue in most cases is very easy to solve by scaling.  If you have never tried to force out more powerful money from the customer / employer to the server, this should reassure you. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you are not reassured, then below are a few numbers that may be useful to you. <br>  <strong>Patient:</strong> not very powerful VDS, only one at the node (so it's easier to drag it here, but here it doesn't matter), a couple of tables for several million lines, a Russian text, a bit of English.  Before each test reboot, the server is no longer loaded.  Tests are conducted at least 3 times, the table goes average. <br><br><table><tbody><tr><th>  What kind of data </th><th>  UTF Results </th><th>  CP1251 results </th><th>  Cp1251 advantage </th></tr><tr><td>  <strong>MyISAM (text, text, int, int)</strong> </td><td>  ***** </td><td>  ***** </td><td>  ***** </td></tr><tr><td>  The original size of the database </td><td>  1.250 GB </td><td>  0.975 GB </td><td>  1.28 times </td></tr><tr><td>  Basic data </td><td>  706 MB </td><td>  479 MB </td><td>  1.47 times </td></tr><tr><td>  Index data </td><td>  544 MB </td><td>  496 MB </td><td>  1.09 times </td></tr><tr><td>  Request to delete parts of lines </td><td>  16 seconds </td><td>  7 sec </td><td>  2.28 times </td></tr><tr><td>  Removing fulltext index </td><td>  26 sec </td><td>  23 seconds </td><td>  1.13 times </td></tr><tr><td>  Building a fulltext index </td><td>  6 min 22 sec </td><td>  3 min 12 sec </td><td>  1.98 times </td></tr><tr><td>  Request to find an exact entry, 10 times <strong>* 1</strong> </td><td>  9.67 sec </td><td>  1.92 seconds </td><td>  5.03 times </td></tr><tr><td>  mysqldump export to file </td><td>  8.8 seconds </td><td>  4.9 sec </td><td>  1.79 times </td></tr><tr><td>  mysql import from file </td><td>  13.8 seconds </td><td>  8.7 sec </td><td>  1.58 times </td></tr><tr><td>  file size * .sql </td><td>  773 MB </td><td>  526 MB </td><td>  1.46 times </td></tr><tr><td>  Sphinx indexing </td><td>  103 sec </td><td>  41 sec </td><td>  2.51 times </td></tr><tr><td>  Sphinx base size </td><td>  680 MB </td><td>  433 MB </td><td>  1.57 times </td></tr><tr><td>  <strong>innoDB (text, text, int, int) <strong>* 3</strong></strong> </td><td>  ***** </td><td>  ***** </td><td>  ***** </td></tr><tr><td>  The original size of the database </td><td>  925 MB </td><td>  629 MB </td><td>  1.47 times </td></tr><tr><td>  Request to delete parts of lines </td><td>  21.2 seconds </td><td>  12 sec </td><td>  1.76 times </td></tr><tr><td>  Request to find the exact entry, 10 times </td><td>  33.47 seconds </td><td>  21.89 seconds </td><td>  1.52 times </td></tr><tr><td>  mysqldump export to file </td><td>  23 seconds </td><td>  17 sec </td><td>  1.35 times </td></tr><tr><td>  mysql import from file <strong>* 4</strong> </td><td>  8m 24sec </td><td>  5m 41 sec </td><td>  1.47 times </td></tr><tr><td>  file size * .sql </td><td>  748 MB </td><td>  510 MB </td><td>  1.46 times </td></tr><tr><td>  <strong>Memory int, char (128) <strong>* 2</strong></strong> </td><td>  ***** </td><td>  ***** </td><td>  ***** </td></tr><tr><td>  Memory table size </td><td>  515 MB </td><td>  179 MB </td><td>  2.87 times </td></tr><tr><td>  Memory table row length </td><td>  390 </td><td>  133 </td><td>  2.93 times </td></tr><tr><td>  Memory table 1000 searches, something found every time </td><td>  1.9 seconds </td><td>  0.32 seconds </td><td>  5.93 times </td></tr><tr><td>  Memory Table 1000 searches, nothing found </td><td>  1.8 sec </td><td>  0.28 sec </td><td>  6.42 times </td></tr></tbody></table><br><br>  <strong>* 1</strong> : Staying in shock from these numbers, a similar test was launched on localhost, the advantage was reduced to 3.02 times.  Perhaps something somewhere did not fall into the cache or unnecessarily fell out on the disk in the case of utf, there is more data. <br>  <strong>* 2</strong> : Memory tables are used to search for exact entries, they contain pure Russian text and some spaces, it turns out simply and quickly.  Approximately 2 million lines.  The size of memory tables in utf8 is 3 times larger than cp1251, since  a fixed size is used (for memory in another way) and uft8 in it reserves 3 bytes per character. <br>  <strong>* 3</strong> : For innoDB, the full-text index was not tested due to the lack of support in inDOB.  InnoDB used a table of a slightly different size than in MyISAM and another VTS, so there is no direct comparison of absolute results. <br>  <strong>* 4</strong> : It is very incomprehensible why the import in innoDB took so much.  For MyISAM, the difference between import and export is minimal. <br><br><hr><br>  And some common words.  Generally speaking, this ‚Äúarticle‚Äù in draft form appeared a few years ago.  Now only the Sphinx has been added here and the tests have been repeated.  And it arose as a result of a dispute at some forum, about the viability of utf and that they say other encodings will die in a year.  But not dead. <br>  And the problems in php / mysql, for example, are still very different.  You must write utf, then utf-8, then utf8.  And even utf can be both ru_RU.UTF and en_EN.UTF, which gives funny effects with iconv // ignore // translit, God knows why.  If you install php as a module, the locale is the same for the whole server with all the consequences, and even with the correct locale you cannot use normal functions for working with strings, you must use their counterparts that support this work.  In general, utf is certainly an advanced technology ... but it must be applied thoughtfully and without excessive fanaticism. <br><br>  PS: For those who like to compress traffic proxy servers note - html file in utf8 is 5-20% more, even in gzip-e <br><br></div><p>Source: <a href="https://habr.com/ru/post/116822/">https://habr.com/ru/post/116822/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116817/index.html">DOOM on PocketBook 360 Plus</a></li>
<li><a href="../116818/index.html">RIF 2011: Personal Data Protection</a></li>
<li><a href="../116819/index.html">If you are programming in C / C ++, your coding style is based on</a></li>
<li><a href="../116820/index.html">How to find a job in Sweden. Practical advice</a></li>
<li><a href="../116821/index.html">Eviterra.com - flights are easy and convenient</a></li>
<li><a href="../116823/index.html">And maybe the truth web 2.0 implies openness, or at least web 3.0</a></li>
<li><a href="../116824/index.html">Object tracking on video</a></li>
<li><a href="../116825/index.html">About documentation standards</a></li>
<li><a href="../116827/index.html">Operator comma</a></li>
<li><a href="../116830/index.html">Parsing XML with Simple Framework</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>