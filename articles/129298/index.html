<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About replacing the standard / sbin / init</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="init - the first user process in Unix-like operating systems 
 init - run directly by the system kernel. 
 init - is the parent of all user (userspace...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About replacing the standard / sbin / init</h1><div class="post__text post__text-html js-mediator-article">  <b>init</b> - the first user process in Unix-like operating systems <br>  <b>init</b> - run directly by the system kernel. <br>  <b>init</b> - is the parent of all user (userspace) system processes. <br><br>  The standard / sbin / init reads the configuration file / etc / inittab, starts the system and manages the system using several "execution levels" (runlevels). <br><br>  Using the <i>init</i> key of the same name, you can tell the Linux kernel to use a different file, instead of the standard / sbin / init 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's use this opportunity and add the following configuration to /boot/grub/menu.lst <br><blockquote>  <i>title linux kernel and custom init</i> <i><br></i>  <i>root (hd0,1)</i> <i><br></i>  <i>kernel /linux/vmlinuz-2.6.26-1-686 root = / dev / hda2 init = / linux / init</i> <i><br></i>  <i>initrd /linux/initrd.img-2.6.26-1-686</i> <i><br></i> </blockquote><br>  Who takes the opportunity to replace the init process?  Sometimes developers of embedded systems resort to this - in this way it is possible to simplify the development of a device and not drag along the whole environment of the operating system. <br><br>  In my case, the desire to replace init lay in a different plane - I wanted to check how the init process of the Xameleon system behaves when the Linux kernel executes.  Would you like to try too? <br><br><a name="habracut"></a>  How I changed the standard / sbin / init to Xameleon init.  (source code and description) <br><br>  To build the project we will use any modern Linux distribution with installed gcc development tools.  Let's write the simplest Makefile: <br><blockquote>  PROGRAM = init <br><br>  SRCS = init.cc <br><br>  LDFLAGS + = -static <br>  LIBS + = -lc <br><br>  all: <br>  g ++ -D POSIX -D LINUX $ (CFLAGS) $ (SRCS) $ (LIBS) $ (LDFLAGS) -o init <br></blockquote><br><br>  Actually, the article can not be read further - almost any source code compiled this way can be used as a replacement for init.  For curious readers, I post the original init process of the Chameleon operating system.  This is a specific init process - it can be used as the only operating system process - it contains the most primitive interpreter of several commands and the ability to start the process. <br><br>  While thinking through the article, I was tormented by doubts - under which license to put the init code.  After long and painful thought, the choice fell on the <a href="http://en.wikipedia.org/wiki/BSD_licenses">Two Clause BSD License</a> . <br><br>  The history of this source is simple - it was created for the Chameleon operating system and is now used by the Chameleon for its intended purpose.  Recently I got an idea - why not try your version of init on Linux?  A kind of compatibility test. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typeCommandEntry</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> * szCmd; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nLength; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> (*fHandler)( <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> argc, <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> * argv[], <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> * envp[] ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> * szHelpString; } typeCommandEntry; <span class="hljs-comment"><span class="hljs-comment">/////////////////////////////////////////////////////////////////////////////// // Callback's array // static typeCommandEntry CommandList[] = { { "help", 0, tcmdHelp, "Show list of built-in commands. Use 'help command-name' to see detail description of the command-name argument." }, { "exec", 0, tcmdExec, "Execite file. Please note that this command overwrites current process by new executable image" }, { "info", 0, tcmdSysInfo, "Show some information from the L4 KIP" }, { "memmap", 0, tcmdMemMap, "Show a kernel memory map" }, { "modules", 0, tcmdShowModules, "Show registered drivers" }, { "term", 0, tcmdDestroyProcess, "Destriy the init process" }, { "fork", 0, tcmdForkProcess, "Forks (creates copy of) the init process to another console." }, { "wait", 0, tcmdWaitProcess, "Waits for the process termination" }, { "kill", 0, tcmdKillProcess, "Sends signal to the process" }, { "trap", 0, tcmdTrapProcess, "Sends the trap signal to the process" }, { "reset", 0, tcmdReset, "Reset current console to the initial state" }, { "mount", 0, tcmdMount, "This command shows mounted filesyetems if used without arguments.\nUse 'mount device mount-point' to mount device into filesystem tree." }, { "umount", 0, tcmdUnmount, "Unmounts filesystem that provided as command argument. " }, { "cd", 0, tcmdChangeDir, "Change current directory" }, { "dir", 0, tcmdShowDirectory, "Show directory without parsing inodes" }, { "ls", 0, tcmdListDirectory, "List files into current directrory or files that reside to a path provded as command argument" }, { "chroot", 0, tcmdChangeRootDirectory, "Changes the root directory of the caller process." }, { "cat", 0, tcmdShowFile, "List file on active console" }, { "rm", 0, tcmdRemoveFile, "Remove file" }, { "rmdir", 0, tcmdRemoveDirectory, "Remove directory" }, { "mkdir", 0, tcmdMakeDirectory, "Create directory" }, { "ln", 0, tcmdMakeLink, "Link the file inode as a new file" }, { "mv", 0, tcmdMoveFile, "Moves file into another place. Please note that this command able to move files within same filesystem." }, { "df", 0, tcmdDiskInformation, "Show mounted partitions information" }, { "chown", 0, tcmdChangeOwner, "Chane owner of file or directory" }, { "sync", 0, tcmdFlushCaches, "Flush disk caches" }, { "cp", 0, tcmdCopyFile, "Copy file" }, { "setenv", 0, tcmdSetEnvironment, "Set environment variable" }, { "getenv", 0, tcmdGetEnvironment, "Get environment variable" }, { "unsetenv", 0, tcmdUnsetEnvironment, "Unset environent variable" }, { "pwd", 0, tcmdPwd, "Print working directory" }, { "dump", 0, tcmdDump, "Show file/device hex dump" }, { "env", 0, tcmdEnv, "Show current environment" }, { "exit", 0, tcmdExit, "Terminates init process. This command have no meaning in production sysstem, but usefull for debugging)" }, { "quit", 0, tcmdExit, "A synonym for the exit command" }, };</span></span></code> </pre> <br><br>  For example, to run a standard shell, use the command <br><blockquote>  / # exec / bin / sh </blockquote><br>  To turn off the computer <br><blockquote>  / # exec / sbin / halt </blockquote><br>  Sorry for the bad English in the code - the messages in Russian would be better, but at the stage of the init process, the Russian character generator is not yet loaded - this is the concern of the descendants of the first process. <br>  I accept patches. <br>  Did not try under FreeBSD.  If you suddenly do not meet - write. <br><br><h6>  Download xameleon init source code </h6><br>  <a href="http://narod.ru/disk/26585438001/xam_init.tgz.html">http://narod.ru/disk/26585438001/xam_init.tgz.html</a> <br><br>  Enjoy make. </div><p>Source: <a href="https://habr.com/ru/post/129298/">https://habr.com/ru/post/129298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../129292/index.html">A simple script to switch network settings</a></li>
<li><a href="../129293/index.html">On Github, a single ticket panel for all projects.</a></li>
<li><a href="../129294/index.html">Qt and mobile camera. Part 2, Meego</a></li>
<li><a href="../129295/index.html">ZTE T98 based on NVIDIA Tegra Kal-El is represented in China</a></li>
<li><a href="../129296/index.html">Let's Talk iPhone - October 4, 2011 21:00 MSK</a></li>
<li><a href="../129299/index.html">SlideShare has abandoned Flash in favor of HTML5</a></li>
<li><a href="../129300/index.html">Mobile Application Developers Forum Mobile People 2011</a></li>
<li><a href="../129303/index.html">Chrome extension for proofreaders on Habr√©</a></li>
<li><a href="../129304/index.html">Useful applications, games and documentation for modern DesktopLinux-systems</a></li>
<li><a href="../129306/index.html">Apple has not been able to get a multi-touch patent.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>