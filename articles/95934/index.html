<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Turn off the monitor from the keyboard</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The previous topic about ddccontrol , opened for me that you can turn off monitors by DDC . Do not drive to sleep, do not turn on the energy-saving mo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Turn off the monitor from the keyboard</h1><div class="post__text post__text-html js-mediator-article">  The previous <a href="http://habrahabr.ru/blogs/linux/94990/">topic about ddccontrol</a> , opened for me that you can turn off monitors by <a href="http://en.wikipedia.org/wiki/Display_Data_Channel">DDC</a> .  Do not drive to sleep, do not turn on the energy-saving mode, but really turn it off.  So that the power supply light on the face goes out (and does not blink at all!).  Like pushing off on the same face.  Of course, you can not only turn it off, but also turn it on.  Programmatically! <br><br>  1) This can be done programmatically (ddccontrol) <br>  2) It can be written in the script <br>  3) The script can be hung on the hotkey <br>  ... <br>  5) PROFIT ?? <br><br>  In the list of profits, you can record the ability to <b>enable / disable ONE button on the keyboard of ALL monitors</b> (I have two now and I plan more in the future).  The button on the keyboard is much more pleasant to click than the button of the monitor (at which it is necessary to aim, and the monitor can turn slightly when pressed, which is annoying). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  The task consists of three stages: <br>  0) Configure ddccontrol <br>  1) write a script that will adequately work on / off the monitors in any combination of the turned-off monitors. <br>  2) Find an unused button on the keyboard (and its code). <br>  3) Assign script launch to this code. <br><br><h1>  Ddccontrol setup </h1><br>  The setup is simple: you need to register the i2c-dev module in / etc / modules (modules that are loaded automatically when you boot) For the first run, you can get by with the <code>modprobe i2c-dev</code> command, which tries to load the module here and now. <br><br>  Next, we need to check that the monitor turns off the shutdown code, and the enable code turns on. <br><br>  I previously told how to work with ddccontrol, so I will not retell everything.  For my samsung (both) register 0xe1 enables / disables the monitor: <br><br>  <code>ddccontrol -r 0xe1 -w 1 dev:/dev/i2c-2</code> - on;  <code>-w 0</code> - off <br>  Similarly for dev: / dev / i2c-1. <br><br>  We can also get this value: <code>ddccontrol -r 0xe1 dev:/dev/i2c-1</code> <br><br>  Dropping all unnecessary, the desired line looks like this: <br><br>  Control 0xe1: + / 0/1 [???] (off) <br>  Control 0xe1: + / 1/1 [???] (on) <br><br>  We need to set up a simple grep for this: <br> <code>ddccontrol -r 0xe1 dev:/dev/i2c-1|grep -o +/./1|cut -b 3</code> <br>  In addition to the garbage on stderr (he does not care about us), we get a number at the output: 1 - on, 0 - off.  The ‚Äúempty string‚Äù situation will be treated with an ugly, but working summation with zero.  (empty + zero = zero). <br><br><h1>  Script </h1><br>  TK for the script: if at least one monitor is on, turn off all monitors.  If there are no included monitors, try to turn on all monitors.  Due to the specifics of ddcontrol, we will have to either allow ourselves to do sudo ddccontrol without a password (you can add the script yourself), or change the access rights for / dev / i2c- * files (I just changed the group for my own, this was enough).  Just in case, I remind you that SUID bits for shell scripts do not work.  You can change the group of device files for ddccontrol using the <code>sudo chgrp `id -gn` /dev/i2c-*</code> . <br><br>  Script text (I called it / usr / local / bin / <b>ddc-powerswitch</b> ): <br><br><blockquote><pre> #! / bin / sh
 reg = 0xe1
 begin = 1
 end = 2
 seq = `seq -f" dev: / dev / i2c -%. 0f "$ begin $ end`
 for dev in $ seq
 do
         state = $ ((($ state + 0) | (`ddccontrol -r $ reg $ dev | grep -o + /. / 1 ‚Äã‚Äã| cut -b 3` + 0)))
 done
 echo state = $ state
 for dev in $ seq
 do
         ddccontrol -r $ reg -w $ ((! $ state)) $ dev &amp;
 done
</pre><br></blockquote><br><br>  Comments on the code: begin / end - customizable.  For the first time you can register 0 and 6. <br>  If you remove the ampersand, it will be easier to debug, but the script will be slower to work. <br>  I do not recommend parallel poll of monitors, there will be race condition. <br><br><h1>  Button search </h1><br>  I decided to use an unused multimedia button on the keyboard.  For this, the xev program was used (run from the shell).  Press the desired button, see the code.  In my case, it was the ‚Äúmy computer‚Äù button (code 198) with a system icon with a monitor (monitor icon ‚Äî what can be better suited for on / off monitors, especially since it is from the very edge and is difficult to hit on it?) <br><br><h2>  Script assignment to hot key </h2><br>  I used the following method (the gurus will kick the curvature, asking for a demand-kick to make more direct decisions, with a system-wide binding): <br><br>  Edit (create) ~ / .xbindkeysrc file <br><pre> "ddc-powerswitch"
  F31
</pre><br>  (attention: quotes, space before F31) <br><br>  Now we will write the launch of everything that is needed in the autorun script.  For KDE, this is ~ / .kde / Autostart / ddc-hotkeys (do not forget to make it + x), for gnome ~ / .config / autostart (for older versions of the gnome is more difficult, <a href="http://www.captain.at/howto-autostart-program-in-kde-gnome.php">here</a> ). <br><br><blockquote><pre> xmodmap -e 'keycode 198 = F31'
 xbindkeys
</pre><br></blockquote><br><br>  Instead of 198, you need to specify the key code that you liked when communicating with xev. <br><br>  Actually, everything.  We have registered a hot key, have it registered where necessary.  Now, at the press of a button, if there is at least one monitor turned on, all monitors turn off.  If all monitors are turned off - turn on. </div><p>Source: <a href="https://habr.com/ru/post/95934/">https://habr.com/ru/post/95934/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../95926/index.html">Mini fraud to the maximum</a></li>
<li><a href="../95928/index.html">Mortal Kombat: Rebirth</a></li>
<li><a href="../95929/index.html">Who do you work for?</a></li>
<li><a href="../95930/index.html">About implicit ads, backwards compatibility and ABI</a></li>
<li><a href="../95931/index.html">Meet, QMMP - music player</a></li>
<li><a href="../95935/index.html">How you can easily and easily implement options in Ruby on Rails</a></li>
<li><a href="../95938/index.html">Tungstene recognizes Photoshop</a></li>
<li><a href="../95939/index.html">We lift FreshTel in Linux</a></li>
<li><a href="../95940/index.html">Russian team at international competitions in underwater robotics</a></li>
<li><a href="../95942/index.html">Illustrated synopsis of Kent Beck's lecture ‚ÄúFour Strategies for Responsive Design‚Äù (with comments)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>