<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Linear cryptanalysis for dummies</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi% username%! 
 Many people know that the DES algorithm has long been considered the default standard in the field of symmetric encryption. The first...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Linear cryptanalysis for dummies</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6c6/02b/630/6c602b6302ace732f9e3547627384473.jpg" alt="image"></div><br>  Hi% username%! <br>  Many people know that the DES algorithm has long been considered the default standard in the field of symmetric encryption.  The first successful attack on this unkillable algorithm was published in 1993, 16 years after its adoption as a standard.  The method, which the author called linear cryptanalysis, in the presence of 2 <sup>47</sup> pairs of open / encrypted texts, allows you to unlock the secret DES cipher key for 2 <sup>43</sup> operations. <br>  Under the cut, I will try to briefly outline the main points of this attack. <br><a name="habracut"></a><br><h4>  Linear cryptanalysis </h4><br>  Linear cryptanalysis is a special kind of attack on symmetric ciphers, aimed at recovering an unknown encryption key, using known open messages and corresponding ciphertexts. <br><br>  In the general case, an attack based on linear cryptanalysis is reduced to the following conditions.  The attacker has a large number of pairs of open / encrypted text obtained using the same encryption key K. The attacker's goal is to restore part or all of the K key. <br><br>  First of all, the attacker makes a study of the cipher and finds a so-called.  statistical counterpart, i.e.  The equation of the following form, which is executed with probability P ‚â† 1/2 for an arbitrary pair of open / closed text and a fixed key: <br>  P <sub>I1</sub> ‚äï P <sub>I2</sub> ‚äï ... ‚äï P <sub>Ia</sub> ‚äï C <sub>I1</sub> ‚äï C <sub>I2</sub> ‚äï ... C <sub>Ib</sub> = K <sub>I1</sub> ‚äï K <sub>I2</sub> ‚äï ... ‚äï K <sub>Ic</sub> <b>(1)</b> , <br>  where P <sub>n</sub> , C <sub>n</sub> , K <sub>n</sub> are the n-th bits of the text, ciphertext and key. <br>  After a similar equation is found, the attacker can recover 1 bit of key information using the following algorithm. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Algorithm 1</b> <br>  Let T be the number of texts for which the left side of equation (1) is 0, then <br>  If T&gt; N / 2, where N is the number of known open texts. <br>  Suppose that K <sub>I1</sub> ‚äï K <sub>I2</sub> ‚äï ... ‚äï K <sub>Ic</sub> = 0 (when P&gt; 1/2) or 1 (when P &lt;1/2). <br>  Otherwise <br>  Suppose that K <sub>I1</sub> ‚äï K <sub>I2</sub> ‚äï ... ‚äï K <sub>Ic</sub> = 1 (when P&gt; 1/2) or 0 (when P &lt;1/2). <br>  It is obvious that the success of the algorithm directly depends on the value of | P-1/2 |  and the number of open / closed text pairs available N. The greater the probability P of equality (1) differs from 1/2, the smaller the number of clear texts N is necessary for an attack. <br><br>  There are two problems that must be solved for the successful implementation of the attack: <br><ul><li>  How to find an effective equation of the form (1). </li><li>  How to get more than one bit of key information using such an equation. </li></ul><br>  Consider the solution of these issues on the example of the cipher DES. <br><br><h4>  DES description </h4><br>  But first, let's briefly describe the operation of the algorithm.  About DES said enough.  A full description of the cipher can be found on <a href="https://ru.wikipedia.org/wiki/DES">Wikipedia</a> .  However, to further explain the attack, we will need a number of definitions which are better to enter in advance. <br><br>  So, DES is a block cipher based on <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D1%2582%25D1%258C_%25D0%25A4%25D0%25B5%25D0%25B9%25D1%2581%25D1%2582%25D0%25B5%25D0%25BB%25D1%258F">a Feistel network</a> .  The cipher has a block size of 64 bits and a key size of 56 bits.  Consider the DES encryption scheme. <br><img src="https://habrastorage.org/getpro/habr/post_images/547/041/a67/547041a67a920918274e4ab4a6633357.png" alt="image"><br>  As can be seen from the figure, the following operations are performed when encrypting the text: <br><ol><li>  The initial permutation bits.  At this stage, the bits of the input block are mixed in a certain order. </li><li>  After that, the mixed bits are divided into two halves, which are fed to the input of the Feistel function.  For standard DES, the Feistel network includes 16 rounds, but there are other variants of the algorithm. </li><li>  The two blocks obtained in the last round of the transformation are combined and one more permutation is performed on the obtained block. </li></ol><br><br>  At each round of the Feistel network, the 32 low bits of the message go through function f: <br><img src="https://habrastorage.org/getpro/habr/post_images/6c7/49c/b2b/6c749cb2beae3bf4cf1fdf9f103c271e.png" alt="image"><br>  Consider the operations that are performed at this stage: <br><ol><li>  The input block passes through the extension function E, which converts a 32-bit block into a block with a length of 48 bits. </li><li>  The resulting block is formed with a round key K <sub>i</sub> . </li><li>  The result of the previous step is divided into 8 blocks of 6 bits each. </li><li>  Each of the received B <sub>i</sub> blocks passes through the S-Box <sub>i</sub> substitution function, which replaces the 6-bit sequence, with a 4-bit block. </li><li>  The resulting 32-bit block passes through the permutation P and is returned as the result of the function f. </li></ol><br><br>  From the point of view of cryptanalysis of the cipher, S blocks are of the greatest interest to us, which are designed to hide the connection between the input and output data of the function f.  For a successful attack on DES, we first build statistical counterparts for each of the S-boxes, and then extend them to the entire cipher. <br><br><h4>  S block analysis </h4><br>  Each S-block accepts a 6-bit sequence at the input, and for each such sequence a fixed 4-bit value is returned.  Those.  There are a total of 64 input and output options.  Our task is to show the relationship between input and output data of S blocks.  For example, for the third S-block of the DES cipher, the 3rd bit of the input sequence is equal to the 3rd bit of the output sequence in 38 cases out of 64. Therefore, we found the following statistical equivalent for the third S-block: <br>  S <sub>3</sub> (x) [3] = x [3], which is performed with the probability P = 38/64. <br>  Both sides of the equation represent 1 bit of information.  Therefore, if the left and right sides were independent of each other, the equation would have to be performed with a probability equal to 1/2.  Thus, we have just demonstrated the relationship between the input and output data of the 3rd S-block of the DES algorithm. <br><br>  Consider how you can find the statistical analogue of the S-block in the general case. <br><br>  For the S-box, S <sub>a</sub> , 1 ‚â§ Œ± ‚â§ 63 and 1 ‚â§ Œ≤ ‚â§ 15, the NS value of <sub>a</sub> (Œ±, Œ≤) describes how many times out of 64 possible XOR input bits S <sub>a</sub> superimposed on bits Œ± are equal to the XOR output bits superimposed on the bits Œ≤, i.e .: <br><img src="https://habrastorage.org/files/6ae/8b1/186/6ae8b11861b44c4982347a89ddc9d306.png">  where the symbol ‚Ä¢ - logical I. <br>  The values ‚Äã‚Äãof Œ± and Œ≤, for which NS <sub>a</sub> (Œ±, Œ≤) is most different from 32, describe the most effective statistical analogue of the S-block S <sub>a</sub> . <br><br>  The most effective analog was found in the 5th S-block of the DES cipher for Œ± = 16 and Œ≤ = 15 NS <sub>5</sub> (16, 15) = 12.  This means that the following equation holds: Z [2] = Y [1] ‚äï Y [2] ‚äï Y [3] ‚äï Y [4], where Z is the input sequence of the S-box and Y is the output sequence. <br>  Or taking into account the fact that in the DES algorithm, before entering the S-block, the data is added modulo 2 with a round key, i.e.  Z [2] = X [2] ‚äï K [2] we get <br>  X [2] ‚äï Y [1] ‚äï Y [2] ‚äï Y [3] ‚äï Y [4] = K [2], where X and Y are the input and output data of the function f without considering the permutations. <br>  The resulting equation is performed on all rounds of the DES algorithm with the same probability P = 12/64. <br>  The following table lists the effective ones, i.e.  having the greatest deviation from P = 1/2, statistical analogues for each s-block of the DES algorithm. <br><img src="https://habrastorage.org/files/99b/815/a6c/99b815a6cf194a54a4673ca8e2a1853f.PNG"><br><br><h4>  Construction of statistical analogues for several rounds of DES </h4><br>  We now show how to combine statistical analogues of several DES rounds and eventually get a statistical analog for the entire cipher. <br>  To do this, consider the three-round version of the algorithm: <br><img src="https://habrastorage.org/files/5a1/f88/346/5a1f8834660c4d15958d6249e5f9efde.PNG"><br>  Let us apply the effective statistical analogue of the 5th s-block to calculate certain bits of the X (2) value. <br>  We know that with the probability of 12/64 in the f-function, the equality <i>X [2] ‚äï Y [1] ‚äï Y [2] ‚äï Y [3] ‚äï Y [4] = K [2]</i> holds <i>,</i> where X [2] is the second input bit of the 5th S-box, it is essentially the 26th bit of the sequence obtained after expanding the input bits.  Analyzing the expansion function, it can be established that in place of 26 bits is the 17th bit of the X (1) sequence. <br>  Similarly, Y [1], ..., Y [4] are essentially the 17th, 18th, 19th and 20th bit of the sequence obtained before the permutation P. Examining the permutation P, we get that the bits Y [1] , ..., Y [4] are actually bits of Y (1) [3], Y (1) [8], Y (1) [14], Y (1) [25]. <br>  The key bit K [2] involved in the equations is the 26th subkey key of the first round K1 and then the statistical analogue takes the following form: <br>  <i>X (1) [17] ‚äï Y (1) [3] ‚äï Y (1) [8] ‚äï Y1 [14] ‚äï Y (1) [25] = K1 [26]</i> . <br>  Therefore, <i>X (1) [17] ‚äï K1 [26] = Y (1) [3] ‚äï Y (1) [8] ‚äï Y (1) [14] ‚äï Y (1) [25]</i> <b>(2)</b> with probability P = 12/64. <br>  Knowing the 3, 8, 14, 25 bits of the sequence Y (1) you can find 3, 8, 14, 25 bits of the sequence X (2): <br>  <i>X (2) [3] ‚äï X (2) [8] ‚äï X (2) [14] X (2) [25] = PL [3] ‚äï PL [8] PL [14] PL [25 ] ‚äï Y (1) [3] ‚äï Y (1) [8] ‚äï Y (1) [14] ‚äï Y (1) [25]</i> or taking into account equation (2) <br>  <i>X (2) [3] ‚äï X (2) [8] ‚äï X (2) [14] X (2) [25] = PL [3] ‚äï PL [8] PL [14] PL [25 ] ‚äï X (1) [17] ‚äï K1 [26] <b>(3)</b></i> with a probability of 12/64. <br><br>  We will find a similar expression using the last round.  This time we have the equation <br>  <i>X (3) [17] ‚äï K3 [26] = Y (3) [3] ‚äï Y (3) [8] ‚äï Y (3) [14] ‚äï Y (3) [25]</i> . <br>  Because <br>  <i>X (2) [3] ‚äï X (2) [8] ‚äï X (2) [14] ‚äï X (2) [25] = CL [3] ‚äï CL [8] CL [14] ‚äï CL [25 ] ‚äï Y (3) [3] ‚äï Y (3) [8] ‚äï Y (3) [14] ‚äï Y (3) [25]</i> <br>  we get that <br>  <i>X (2) [3] ‚äï X (2) [8] ‚äï X (2) [14] ‚äï X (2) [25] = CL [3] ‚äï CL [8] CL [14] ‚äï CL [25 ] ‚äï X (3) [17] ‚äï K3 [26]</i> <b>(4)</b> with a probability of 12/64. <br><br>  Equating the right sides of equations (3) and (4) we obtain <br>  <i>L [3] ‚äï L [8] ‚äï L [14] ‚äï L [25] ‚äï X (3) [17] ‚äï K3 [26] = PL [3] PL [8] PL [14] PL [ 25] ‚äï X (1) [17] ‚äï K1 [26]</i> with probability (12/64) <sup>2</sup> + (1-12 / 64) <sup>2</sup> . <br>  Taking into account that X (1) = PR and X (3) = CR, we obtain a statistical analogue <br>  <i>L [3, 8, 14, 25] ‚äï CR [17] ‚äï PL [3, 8, 14, 25] ‚äï PR [17] = K1 [26] ‚äï K3 [26]</i> <b>(5)</b> , <br>  which is performed with the probability (12/64) <sup>2</sup> + (1-12 / 64) <sup>2</sup> = 0.7. <br>  The statistical analogue described above can be represented graphically as follows (the bits in the figure are numbered from right to left and starting from zero): <br><img src="https://habrastorage.org/files/91d/180/1ec/91d1801ecd684621a34682a945cde591.png"><br>  All bits on the left side of the equation are known to the attacker, therefore he can apply algorithm 1 and find out the value of K1 [17] ‚äï K3 [17].  Let us show how using this statistical analogue, you can open not 1, but 12 bits of the encryption key K. <br><br><h4>  Known plain text attack on DES </h4><br>  We give a way with which you can expand the attack and get immediately 6 bits of the subkey of the first round. <br>  When composing equation (5), we took into account the fact that we do not know the value of F1 (PR, K1) [3, 8, 14, 25].  Therefore, we used its statistical analogue K1 [26] ‚äï PR [17]. <br>  Instead of the expression K1 [26] ‚äï PR [17], we return the value F1 (PR, K1) [3, 8, 14, 25] and we get the following equation: <br>  <i>L [3, 8, 14, 25] ‚äï CR [17] ‚äï PL [3, 8, 14, 25] ‚äï F1 (PR, K1) [3, 8, 14, 25] = K3 [26]</i> <b>(6)</b> which will be executed with a probability of 12/64.  The probability has changed since we left only the statistical counterpart from the third round, all other values ‚Äã‚Äãare fixed. <br><br>  Above, we have already determined that the value of F1 (PR, K1) [3, 8, 14, 25] is influenced by the input bits of the 5th S-block, namely the key bits K1 [25 ~ 30] and the bits of the PR block [16 ~ 21].  We show how having only a set of open / closed texts, you can restore the value of K1 [25 ~ 30].  To do this, we use algorithm 2. <br><br>  <b>Algorithm 2</b> <br>  Let N be the number of open / closed text pairs known before the attack.  Then to open the key, you must do the following steps. <br>  For (i = 0; i &lt;64; i ++) do <br>  { <br>  For (j = 0; j &lt;N; j ++) do <br>  { <br>  if (L <sub>j</sub> [3, 8, 14, 25] ‚äï CR <sub>j</sub> [17] ‚äï PL <sub>j</sub> [3, 8, 14, 25] ‚äï F1 (PR <sub>j</sub> , i) [3, 8, 14, 25] = 0 ) then <br>  T <sub>i</sub> = T <sub>i</sub> +1 <br>  } <br>  } <br>  As a probable sequence K1 [25 ~ 30], the value of i is taken such that the expression | T <sub>i</sub> -N / 2 |  has a maximum value. <br><br>  With a sufficient number of known open texts, the algorithm will most likely return the correct value of six bits of the subkey of the first round K1 [25 ~ 30].  This is explained by the fact that if the variable i is not equal to K1 [25 ~ 30], then the value of the function F1 (PR <sub>j</sub> , K) [3, 8, 14, 25] will be random and the number of equations for such a value i such that the left side is zero will tend to N / 2.  If the subkey is correctly guessed, the left side will be equal to the fixed bit K3 with probability 12/64 [26].  Those.  there will be a significant deviation from N / 2. <br><br>  Having received 6 bits of the K1 subkey, you can similarly open 6 bits of the K3 subkey.  All that is needed for this is to replace C in the equation (6) with P and K1 with K3: <br>  <i>PL [3, 8, 14, 25] ‚äï PR [17] ‚äï CL [3, 8, 14, 25] ‚äï F3 (CR, K3) [3, 8, 14, 25] = K1 [26]</i> . <br>  Algorithm 2 will return the correct K3 value [25 ~ 30] because the DES decryption process is identical to the encryption process, just the key sequence is reversed.  So in the first round of decryption the key K3 is used, and in the last one the key K1. <br><br>  After receiving 6 bits of the K1 and K3 subkeys, the attacker recovers 12 bits of the K key shared key, since  round keys are the usual permutation of the key K. The number of open texts required for a successful attack depends on the probability of a statistical counterpart.  To open 12 bits of a 3-round DES key, 100 pairs of open / closed texts are enough.  To open 12 bits of a 16-round DES key, about 2 <sup>44</sup> pairs of text are required.  The remaining 44 bits of the key are opened by normal brute force. <br><br><h4>  Links </h4><br>  <a href="http://www.cs.bilkent.edu.tr/~selcuk/teaching/cs519/Matsui-LC.pdf">Mitsuru Matsui - Linear cryptanalysis method of DES cipher</a> <br>  <a href="http://www.engr.mun.ca/~howard/PAPERS/ldc_tutorial.pdf">Tutorial on Linear and Differential Cryptanalysis</a> </div><p>Source: <a href="https://habr.com/ru/post/233905/">https://habr.com/ru/post/233905/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../233895/index.html">Why Habr popular science?</a></li>
<li><a href="../233897/index.html">Docsvision database structure. From developer to developer!</a></li>
<li><a href="../233899/index.html">Integrating Git into Sublime Text</a></li>
<li><a href="../233901/index.html">Review of Garmin, Huawei and Sony fitness bracelets</a></li>
<li><a href="../233903/index.html">DDoS great and terrible</a></li>
<li><a href="../233907/index.html">Why Bitcoin is Good</a></li>
<li><a href="../233911/index.html">A / B test is easy</a></li>
<li><a href="../233915/index.html">Description of the MMO component in the game engine "Tornado"</a></li>
<li><a href="../233917/index.html">7 basic usability principles for online stores (translation)</a></li>
<li><a href="../233921/index.html">MyKronoz ZeFit - pedometer bracelet with European roots</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>