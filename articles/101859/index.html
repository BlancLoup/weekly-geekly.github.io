<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Collaboration mechanism in MS Office 2010 + SharePoint 2010: protocols and packages</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The co-authorship mechanism appeared with the release of MS Office 2010 and SharePoint 2010. Many people describe the emerging functionality as ‚Äúlong ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Collaboration mechanism in MS Office 2010 + SharePoint 2010: protocols and packages</h1><div class="post__text post__text-html js-mediator-article">  The co-authorship mechanism appeared with the release of MS Office 2010 and SharePoint 2010. Many people describe the emerging functionality as ‚Äúlong awaited‚Äù; indeed, there is no sense in diminishing its usability.  But this article will discuss how this mechanism functions and what benefits can be derived from this.  New field for action in the end! <br><br><h4>  Interesting to the user </h4><br>  First of all, it is necessary to pay attention to how the work of the co-authorship mechanism looks.  Exploring the Internet, it turned out that it had already been done in sufficient detail, so I will not repeat myself and suggest that you <a href="http://www.ecm-journal.ru/print/Parallelnoe-redaktirovanie-v-Microsoft-Office-2010---nekotorye-tekhnicheskie-podrobnosti.aspx">familiarize</a> yourself. <br><br><h4>  Interesting to the developer </h4><br>  It was interesting for me to understand how the actions of the user correlate with the packages that are formed.  Learn to identify actions for forwarding packets.  This would allow collecting information on users' work (and in my case, employees) on the corporate portal by writing an HTTP Module.  Such information becomes useful, for example, for increasing the number of conversions or tracking the intensity of work on the preparation of documentation.  Moreover, practice has shown that it is more efficient and safer to listen to incoming packets to the server, rather than outgoing ones. <br><a name="habracut"></a><br>  Because of the caching of documents, the task is complicated by the fact that the information at the MS-FSSHTTP protocol level ambiguously determines the actions of the user in some cases.  For example, when an open document event occurs for the first time ‚Äî the document is downloaded and described by the package description is easy to determine, and when the document is opened a second time, it does not download the document, but compares it in the cache with the document on the server when it is opened, although semantically these two events mean starting a document. <br>  The collaboration mechanism works successfully in Word 2010, Excel 2010, OneNote 2010, SharePoint Workspace 2010 with SharePoint Foundation 2010 or SharePoint Server 2010. This is specified in the specifications. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Protocols and Packages </h5><br>  All communication between the SharePoint server and the MS Office 2010 user takes place using the MS-FSSHTTP (File Synchronization via SOAP over HTTP Protocol Specification) and MS-FSSHTTPB (Binary Requests for File Synchronization via SOAP Protocol Specification) protocols. <br>  For more convenience, I will immediately provide links to the protocol description: <br>  - MSDN about <a href="http://msdn.microsoft.com/en-us/library/dd943623.aspx">MS-FSSHTTP</a> or <a href="http://download.microsoft.com/download/8/5/8/858F2155-D48D-4C68-9205-29460FD7698F/%5BMS-FSSHTTP%5D.pdf">download MS-FSSHTTP specification</a> <br>  - MSDN about <a href="http://msdn.microsoft.com/en-us/library/dd965780.aspx">MS-FSSHTTPB</a> or <a href="http://download.microsoft.com/download/8/5/8/858F2155-D48D-4C68-9205-29460FD7698F/%5BMS-FSSHTTPB%5D.pdf">download MS-FSSHTTPB specification</a> <br><br>  When exchanging packets, the MS-FSSHTTP protocol transmits information about the entity with which the work begins (its Url), the author who starts working with the entity, the mode of operation (Read Only and Edit require different levels of privileges).  The MS-FSSHTTP portion of the packet is XML, which does not add any grace to this protocol.  The XML subsections in the package are numbered by the SubRequestToken parameter.  It becomes possible to check the integrity of the package using the DependsOn parameter.  The very same entity within the MS-FSSHTTP and MS-FSSHTTPB protocols is called a cell. <br>  The MS-FSSHTTP request structure fits into the following pattern: <br><blockquote><code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">s:Envelope</font> <font color="#ff0000">xmlns:s</font> <font color="#0000ff">="http://schemas.xmlsoap.org/soap/envelope/"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">s:Body</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RequestVersion</font> ‚Ä¶ <font color="#0000ff">&gt;</font> //     <br> <font color="#0000ff">&lt;</font> <font color="#800000">RequestCollection</font> ‚Ä¶ <font color="#0000ff">&gt;</font> // CorrelationID, guid  <br> //      . <br> <font color="#0000ff">&lt;</font> <font color="#800000">Request</font> ‚Ä¶ <font color="#0000ff">&gt;</font> // URL  <br> <font color="#0000ff">&lt;</font> <font color="#800000">SubRequest</font> ‚Ä¶ <font color="#0000ff">/&gt;</font> //  <br> <font color="#0000ff">&lt;/</font> <font color="#800000">SubRequest</font> <font color="#0000ff">&gt;</font> <br> ‚Ä¶ <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Request</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">RequestCollection</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">s:Body</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">s:Envelope</font> <font color="#0000ff">&gt;</font> <br></font> <br></code> </blockquote><br>  Some explanations for the structure of the MS-FSSHTTP protocol: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Request</font> <font color="#ff0000">Url</font> <font color="#0000ff">="http://serverName/documentFullPath"</font> <font color="#ff0000">RequestToken</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font></font> <br></code> </blockquote>  - mandatory protocol package structure indicating the document to which the request is addressed. <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">SubRequest</font> <font color="#ff0000">Type</font> <font color="#0000ff">="Coauth"</font> <font color="#ff0000">SubRequestToken</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font></font> <br></code> </blockquote>  - declaration of the co-authorship mode, the attached tag indicates which type of co-authorship is used. <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">SubRequest</font> <font color="#ff0000">Type</font> <font color="#0000ff">="SchemaLock"</font> <font color="#ff0000">SubRequestToken</font> <font color="#0000ff">="2"</font> <font color="#ff0000">DependsOn</font> <font color="#0000ff">="1"</font> <font color="#ff0000">DependencyType</font> <font color="#0000ff">="OnNotSupported"</font> <font color="#0000ff">&gt;</font></font> <br></code> </blockquote>  - indicates the presence of document blocking and its type in the nested tag.  In response, the server indicates whether you start working with the document first or join as a coauthor. <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">SubRequest</font> <font color="#ff0000">Type</font> <font color="#0000ff">="Cell"</font> <font color="#ff0000">SubRequestToken</font> <font color="#0000ff">="3"</font> <font color="#0000ff">&gt;</font></font> <br></code> </blockquote>  - carries direct information about changes in the document.  Contains the MS-FSSHTTPB part of the package. <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">SubRequest</font> <font color="#ff0000">Type</font> <font color="#0000ff">="WhoAmI"</font> <font color="#ff0000">SubRequestToken</font> <font color="#0000ff">="2"</font> <font color="#0000ff">/&gt;</font></font> <br></code> </blockquote>  - User information. <br><br>  Example of MS-FSSHTTP part of the packet from the user to the server (request): <br>  The package informs you that the 2MB.docx document is being accessed at the specified address and the user is ready to receive the document.  BinaryDataSize indicates the length of the value inside the tag, i.e.  MS-FSSHTTPB part. <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">s:Envelope</font> <font color="#ff0000">xmlns:s</font> <font color="#0000ff">="http://schemas.xmlsoap.org/soap/envelope/"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">s:Body</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RequestVersion</font> <font color="#ff0000">Version</font> <font color="#0000ff">="2"</font> <font color="#ff0000">MinorVersion</font> <font color="#0000ff">="0"</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/sharepoint/soap/"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RequestCollection</font> <font color="#ff0000">CorrelationId</font> <font color="#0000ff">="{010F340A-ACB5-442C-B11E-95CB877EEBA5}"</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/sharepoint/soap/"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Request</font> <font color="#ff0000">Url</font> <font color="#0000ff">="http://moss14/Something/2MB.docx"</font> <font color="#ff0000">RequestToken</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SubRequest</font> <font color="#ff0000">Type</font> <font color="#0000ff">="Cell"</font> <font color="#ff0000">SubRequestToken</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SubRequestData</font> <font color="#ff0000">PartitionID</font> <font color="#0000ff">="383adc0b-e66e-4438-95e6-e39ef9720122"</font> <font color="#ff0000">BinaryDataSize</font> <font color="#0000ff">="88"</font> <font color="#0000ff">&gt;</font> <br> DAALAJzPKfM5lAabBgIAAO4CAACqAiAAfrgx50XdqkSrgAx1+9FTDnoCC <br> ACUKaEPdwEWAgYAAwUAigICAADaAgYAAwAAygIIAAgAgAOEAEELAawCAFUDAQ== <br> <font color="#0000ff">&lt;/</font> <font color="#800000">SubRequestData</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">SubRequest</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SubRequest</font> <font color="#ff0000">Type</font> <font color="#0000ff">="WhoAmI"</font> <font color="#ff0000">SubRequestToken</font> <font color="#0000ff">="2"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SubRequest</font> <font color="#ff0000">Type</font> <font color="#0000ff">="Cell"</font> <font color="#ff0000">SubRequestToken</font> <font color="#0000ff">="3"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SubRequestData</font> <font color="#ff0000">PartitionID</font> <font color="#0000ff">="7808f4dd-2385-49d6-b7ce-37aca5e43602"</font> <font color="#ff0000">BinaryDataSize</font> <font color="#0000ff">="88"</font> <font color="#0000ff">&gt;</font> <br> DAALAJzPKfM5lAabBgIAAO4CAACqAiAAfrgx50XdqkSrgAx1+9FTDnoCC <br> ACUKaEPdwEWAgYAAwUAigICAADaAgYAAwAAygIIAAgAgAOEAEELAawCAFUDAQ== <br> <font color="#0000ff">&lt;/</font> <font color="#800000">SubRequestData</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">SubRequest</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SubRequest</font> <font color="#ff0000">Type</font> <font color="#0000ff">="ServerTime"</font> <font color="#ff0000">SubRequestToken</font> <font color="#0000ff">="4"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SubRequest</font> <font color="#ff0000">Type</font> <font color="#0000ff">="Cell"</font> <font color="#ff0000">SubRequestToken</font> <font color="#0000ff">="5"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SubRequestData</font> <font color="#ff0000">GetFileProps</font> <font color="#0000ff">="true"</font> <font color="#ff0000">BinaryDataSize</font> <font color="#0000ff">="88"</font> <font color="#0000ff">&gt;</font> <br> DAALAJzPKfM5lAabBgIAAO4CAACqAiAAfrgx50XdqkSrgAx1+9FTDnoCC <br> ACUKaEPdwEWAgYAAwUAigICAADaAgYAAwAAygIIAAgAgAOEAEELAawCAFUDAQ== <br> <font color="#0000ff">&lt;/</font> <font color="#800000">SubRequestData</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">SubRequest</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Request</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">RequestCollection</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">s:Body</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">s:Envelope</font> <font color="#0000ff">&gt;</font> <br></font> <br></code> </blockquote><br><h5>  Packet inspection </h5><br>  Studying the specifications and did not find the answer to how to determine the beginning of work with the document.  Therefore, it is necessary to check the signs of various types and sizes of documents detected during the analysis of packages, arrange a crash-test, otherwise it is difficult to call any sign true, but the work is justified.  Therefore, all traditionally used formats were analyzed with document sizes up to 30Mb. <br>  Results of the analysis: <br><ul><li>  The maximum packet size does not exceed 3MB, that is, a 30MB file is transferred in 10 packets. </li><li>  Only by analyzing MS-FSSHTTP you cannot solve the problem of determining the opening of a document (due to the work of the Upload Center with the caching function), the remaining actions are determined. </li><li>  Packages with MS-FSSHTTP-parts refer to the link <a href="http://moss14/_vti_bin/cellstorage.svc/CellStorageService">moss14 / _vti_bin / cellstorage.svc / CellStorageService</a> , the rest are not interesting in this task.  That is, it will be a filter for analyzing HTTP Request. </li></ul><br>  It's time to get acquainted with the MS-FSSHTTPB protocol.  The data is presented in Base64 encoding, and to determine the structure, it is necessary to translate into HEX and binary code.  Moreover, BinaryDataSize equal to 88 is the ‚Äúempty‚Äù MS-FSSHTTPB part, a pure MS-FSSHTTPB request pattern.  It contains all sections of the MS-FSSHTTPB request, but there is no information in the sections. <br>  If we talk about the distribution of roles between the two protocols, MS-FSSHTTP describes information that is visible outside the document, i.e.  all that we can find out without opening the file, and MS-FSSHTTPB informs about what is happening inside the document, what changes have been made, where in the document.  Thus, the information encoded in the MS-FSSHTTPB parts of the package allows you to synchronize the state of the documents from the co-authors, transferring only the changed parts of the document, thereby significantly reducing the load on the network.  True, another implementation, from my point of view, would not be logical. <br>  Consider the MS-FSSHTTB transmitted string, where the value of BinaryDataSize is 88. <br>  Original value from the MS-FSSHTTP XML tag: <br><blockquote> <code><font color="black">DAALAJzPKfM5lAabBgIAAO4CAACqAiAAfrgx50XdqkSrgAx1+9FTDnoCCACUKaEPdwEWAgYAAwUAigICAADaAg&lt;br&gt;YAAwAAygIIAAgAgAOEAEELAawCAFUDAQ==</font> <br></code> </blockquote><br>  Decoded HEX code (see MS-FSSHTTPB Specification p. 71-73): <br><blockquote> <code><font color="black">0c 00 0b 00 <font color="#008000">//Protocol Version + Minimum Version</font> <br> 9c cf 29 f3 39 94 06 9b <font color="#008000">//Signature</font> <br> 06 02 00 00 <font color="#008000">//CellRequest Start</font> <br> ee 02 00 00 <font color="#008000">//User Agent Start</font> <br> aa 02 20 00 <font color="#008000">//User Agent GUID</font> <br> 7e b8 31 e7 45 dd aa 44 ab 80 0c 75 fb d1 53 0e <font color="#008000">//GUID</font> <br> 7a 02 08 00 <font color="#008000">//User Agent Version</font> <br> 94 29 a1 0f <font color="#008000">//Version</font> <br> 77 01 16 02 06 00 <font color="#008000">//User Agent End + SubRequest Start</font> <br> 03 05 <font color="#008000">//Request DI + Request Type</font> <br> 00 8a 02 02 00 <font color="#008000">//Priority + Query Changes</font> <br> 00 da 02 06 00 <font color="#008000">//Allow Fragments/Reserved + Query Changes Request Argument</font> <br> 03 00 00 <font color="#008000">//Include Storage Manifest + Cell ID</font> <br> ca 02 08 00 <font color="#008000">//Query Changes Data Constraints</font> <br> 08 00 80 03 <font color="#008000">//Maximum Data Element</font> <br> 84 00 <font color="#008000">//Knowledge Start</font> <br> 41 <font color="#008000">//Knowledge End</font> <br> 0b 01 ac 02 <font color="#008000">//SubRequest End + Data Element Packege Start</font> <br> 00 55 03 01 <font color="#008000">//Reversed + Data Emlement Packege End + Cell Request End</font> <br></font> <br></code> </blockquote><br>  Now a new iteration and MS-FSSHTTPB analysis is added to the analysis performed earlier.  Depriving the reader of the pleasure of tedious examples, I cite the results of the analysis: <br><ul><li>  1. An empty packet is a signal of readiness to receive a document, and therefore helps to determine the event of opening a document from the server.  The key line for the filtering request module becomes: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">SubRequestData</font> <font color="#ff0000">GetFileProps</font> <font color="#0000ff">="true"</font> <font color="#ff0000">BinaryDataSize</font> <font color="#0000ff">="88"</font> <font color="#0000ff">&gt;</font></font> <br></code> </blockquote><br>  however, if the document was cached in the Upload Center, then the BinaryDataSize is greater than 88, i.e.  It will not be an empty template, because you need to check the document for validity.  To identify such a case was found another sign. <br></li><li>  2. The package verifying the cached document in the Upload Center also contains the string specified in item 1 of this list.  However, the value of the BinaryDataSize parameter is the greater, the larger the reconcilable document from the Upload Center. </li></ul><br>  For clarity, I will give an example of parsing such a package. <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">SubRequestData</font> <font color="#ff0000">GetFileProps</font> <font color="#0000ff">="true"</font> <font color="#ff0000">BinaryDataSize</font> <font color="#0000ff">="443"</font> <font color="#0000ff">&gt;</font> DAALAJzPKfM5lAabBgIAAO4CAACqAiAAfrgx50XdqkSrgAx1+ <br> 9FTDnoCCACUKaEPdwEWAgYAAwUAigICAADaAgYAAwAAygIIAAgAgAOEACYCIAD2NXoyYQc <br> URJaGUekAZnpNpAB4KCn1koJCYUFHqgOvQEOf2v3CNZY9eCgp9ZKCQmFBR6oDr0BDn9r9r <br> j3iPngoKfWSgkJhQUeqA69AQ5/a/fo+JkB4KCn1koJCYUFHqgOvQEOf2v0+ <br> QGpBeCgp9ZKCQmFBR6oDr0BDn9r9gkGeQngmRlDki07gDrGjv1Ojie167QDOAngmua8bdL <br> Ef8U6jv1Ojie167QBmD1ETASYCIAATHwkQgsj7QJiGZTP5NMIdbAFw0Qz5C0E3b9GZRKbD <br> JyMu3KcRrXsAOAAyADkAMgBGADUAMgA5AC0ANgAxADQAMgAtADQANwA0ADEALQBBAEEAMA <br> AzAC0AQQBGADQAMAA0ADMAOQBGAEQAQQBGAEQAfQAsADMALAAzAAAAtRMBJgIgAA7pdjoy <br> gAxNud3zxlApQz5MASAoDLmvG3SxH/FOo79To4nteu1mDwClEwFBCwGsAgBVAwE= <font color="#0000ff">&lt;/</font> <font color="#800000">SubRequestData</font> <font color="#0000ff">&gt;</font></font> <br> <br></code> </blockquote><br>  Decoded HEX code: <br><blockquote> <code><font color="black">0c 00 0b 00 <font color="#008000">//Protocol Version + Minimum Version</font> <br> 9c cf 29 f3 39 94 06 9b <font color="#008000">//Signature</font> <br> 06 02 00 00 <font color="#008000">//CellRequest Start</font> <br> ee 02 00 00 <font color="#008000">//User Agent Start</font> <br> aa 02 20 00 <font color="#008000">//User Agent GUID</font> <br> 7e b8 31 e7 45 dd aa 44 ab 80 0c 75 fb d1 53 0e <font color="#008000">//GUID</font> <br> 7a 02 08 00 <font color="#008000">//User Agent Version</font> <br> 94 29 a1 0f <font color="#008000">//Version</font> <br> 77 01 16 02 06 00 <font color="#008000">//User Agent End + SubRequest Start</font> <br> 03 05 <font color="#008000">//Request DI + Request Type</font> <br> 00 8a 02 02 00 <font color="#008000">//Priority + Query Changes</font> <br> 00 da 02 06 00 <font color="#008000">//Allow Fragments/Reserved + Query Changes Request Argument</font> <br> 03 00 00 <font color="#008000">//Include Storage Manifest + Cell ID</font> <br> ca 02 08 00 <font color="#008000">//Query Changes Data Constraints</font> <br> 08 00 80 03 <font color="#008000">//Maximum Data Element</font> <br> 84 00 <font color="#008000">//Knowledge Start</font> <br> \\  ,         <br> <br> 26 02 20 00 <font color="#008000">//cell knowledge range</font> <br> f6 35 7a 32 61 07 14 44 96 86 51 e9 00 66 7a 4d <font color="#008000">//GUID in cell knowlegde range</font> <br> a4 00 78 28 <br> 29 f5 92 82 42 61 41 47 aa 03 af 40 43 9f da fd <br> c2 35 96 3d 78 28 <br> 29 f5 92 82 42 61 41 47 aa 03 af 40 43 9f da fd <br> ae 3d e2 3e 78 28 <br> 29 f5 92 82 42 61 41 47 aa 03 af 40 43 9f da fd <br> fa 3e 26 40 78 28 <br> 29 f5 92 82 42 61 41 47 aa 03 af 40 43 9f da fd <br> 3e 40 6a 41 78 28 <br> 29 f5 92 82 42 61 41 47 aa 03 af 40 43 9f da fd <br> 82 41 9e 42 78 26 46 50 e4 8b 4e e0 0e b1 a3 bf 53 a3 89 ed 7a ed 00 <br> ce 02 78 26 <font color="#008000">//Pre DATA</font> <br> b9 af 1b 74 b1 1f f1 4e a3 bf 53 a3 89 ed 7a ed <font color="#008000">//GUID before FROM number</font> <br> 00 66 0f <font color="#008000">//FROM number</font> <br> 51 13 01 26 02 20 00 13 1f 09 10 82 c8 fb 40 98 86 65 33 f9 34 c2 1d 6c 01 70 d1 0c f9 0b 41 37 6f d1 99 44 a6 c3 27 23 2e dc a7 11 ad <br> 7b 00 38 00 32 00 39 00 32 00 46 00 35 00 32 00 39 00 2d 00 36 00 31 00 34 00 32 00 2d 00 34 00 37 00 34 00 31 00 2d 00 41 00 41 00 30 00 33 00 2d 00 41 00 46 00 34 00 30 00 34 00 33 00 39 00 46 00 44 00 41 00 46 00 44 00 7d 00 2c 00 33 00 2c 00 33 00 00 00 <br> b5 13 01 26 02 20 00 0e e9 76 3a 32 80 0c 4d b9 dd f3 c6 50 29 43 3e 4c 01 20 28 0c <font color="#008000">//DATA changeset</font> <br> b9 af 1b 74 b1 1f f1 4e a3 bf 53 a3 89 ed 7a ed <font color="#008000">//GUID before TO number</font> <br> 66 0f 00 <font color="#008000">//To number</font> <br> a5 <font color="#008000">//Cell range End</font> <br> 13 01 <font color="#008000">//Cell End</font> <br> <br> <font color="#008000">//      </font> <br> 41 <font color="#008000">//Knowledge End</font> <br> 0b 01 ac 02 <font color="#008000">//SubRequest End + Data Element Packege Start</font> <br> 00 55 03 <font color="#008000">//Reversed + Data Emlement Packege End + Cell Request End</font> <br></font></code> </blockquote><br>  It is not so easy to analyze the content of the cell knowledge range (see MS-FSSHTTPB p. 37).  I selected the repeated Data + GUID binding as part of the code transmitted to the variable FROM, but it is not necessarily present in the package with small sizes of the file being checked, therefore such a construction cannot be considered as a sign.  As for the semantics of such a construction, a similar construction is described in the responce packages.  We can try to explain why the request packet uses constructs from the responce, but why the description of these constructs is not in the request specification, it is difficult to explain the request.  Now pay attention to the data concluded between variable FROM and variable TO.  It is here that the cornerstone is located, namely, between the word ‚Äú7b 00‚Äù and ‚Äúb5 13‚Äù content fits into the regular expression ‚Äú\ w {2} [00]‚Äù, but you should not forget that spaces are set only to increase readability.  This sign confirmed itself on all tests with documents.  Hurray comrades!  But you can not stop and try to penetrate the semantics of such a structure.  An experienced developer may notice that data in this form is UTF-16 (hex) encoded.  Converting stock <br><br><blockquote> <code><font color="black">7b 00 38 00 32 00 39 00 32 00 46 00 35 00 32 00 39 00 2d 00 36 00 31 00 34 00 32 00 &lt;br&gt;2d 00 34 00 37 00 34 00 31 00 2d 00 41 00 41 00 30 00 33 00 2d 00 41 00 46 00 34 00 30 00 34 00 &lt;br&gt;33 00 39 00 46 00 44 00 41 00 46 00 44 00 7d 00 2c 00 33 00 2c 00 33 00 00 00</font></code> </blockquote> <br>  in UTF-16 (hex) we get <br><blockquote> <code><font color="black">{8292f529-6142-4741-aa03-af40439fdafd},3,3</font></code> </blockquote> <br><br>  As a result, it is found that in the design under study the parameters are transferred: GUID and two numerical parameters, which makes the construction meaningful and even allows the developer to try to understand its semantics.  It can be assumed that the GUID is used to check the cached document for validity.  This version has so far withstood all possible criticism and seems very successful! <br><br><h4>  Conclusion </h4><br>  In this article I tried to highlight the mechanism of co-authorship in MS Office 2010 + SharePoint 2010 at the level of the protocols.  I hope I have managed to lucidly explain some features that are not covered in the specifications of the protocols and which have not been previously paid attention to.  It should be noted that since the end of my personal investigation into the work of the MS-FSSHTTP and MS-FSSHTTPB protocols, the documentation on MSDN has been greatly enhanced. <br><br>  In general, the work of co-authors is very similar to the basic principles of editing documents in Unix-systems.  The differences are not so significant as to call the co-authorship mechanism innovative.  I would like to finish this article with this thought. <br><br>  I wish you interesting research! <br><br>  <font color="gray">Source <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font color="gray">Code Highlighter</font></a> .</font> </div><p>Source: <a href="https://habr.com/ru/post/101859/">https://habr.com/ru/post/101859/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../101850/index.html">Mushroom Kingdom Fusion v0.41 Beta</a></li>
<li><a href="../101852/index.html">DocMe - youtube for documents</a></li>
<li><a href="../101854/index.html">Habrafutbol!</a></li>
<li><a href="../101855/index.html">Learning English in twittere</a></li>
<li><a href="../101856/index.html">Internet Explorer: 15 years of history</a></li>
<li><a href="../101861/index.html">Why are we in this world, or the beginning of the path</a></li>
<li><a href="../101863/index.html">GTUG Campout 2010</a></li>
<li><a href="../101864/index.html">A conceptual golf scoring application shows how to properly develop applications for Windows Phone 7</a></li>
<li><a href="../101866/index.html">Using Intel Concurrency Checker in practice - some questions ...</a></li>
<li><a href="../101867/index.html">Snatch.exe - an innocent joke or another trojan?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>