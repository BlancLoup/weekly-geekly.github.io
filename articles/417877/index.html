<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How Tinder (slightly) hides your location</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This year, you and your buddy Steve Stevington started a user tracking startup. The business is based on a leak of WhatsApp metadata that you discover...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How Tinder (slightly) hides your location</h1><div class="post__text post__text-html js-mediator-article">  This year, you and your buddy Steve Stevington started a user tracking startup.  The business is based on a <a href="https://robertheaton.com/2017/10/09/tracking-friends-and-strangers-using-whatsapp/">leak of WhatsApp metadata that you discovered</a> .  You both would have to learn more about management, but still the company has grown into a powerful, though unstable company of 65 assorted trainees and students, freelancers and unpaid employees on probation.  You recently moved to a dandy new office in the 19th century literature department of the San Francisco Public Library, and you have an enviable reputation in online marketing. <br><br>  But under this glossy and dubious appearance lies rot.  You suspect that your good friend, co-founder and co-chief executive Steve Stevington is plotting against you.  He always runs out of the library at a strange time and disappears somewhere for hours on end.  When you ask him where he is going, he builds a strange grimace, which he probably considers a malicious grin - and says not to worry.  You instructed librarians to follow him several times, but they are all terrible in field work. <br><a name="habracut"></a><br>  You have been living in Silicon Valley for a long time - and you know what merciless villains happen when a large amount of money and user data is at stake.  Probably Steve Stevington is trying to convince investors to push you out of business.  You think that Peter Thiel will support you, but it‚Äôs hard to say about Aunt Martha.  So you need to figure out where Steve goes. <br><br>  Fortunately, he is an avid Tinder user. <cut></cut>  The Tinder application tracks the location of its users to tell potential couples how far they are from each other.  This allows users to make reasonable decisions: is it really worth it to go 13 kilometers to meet a pair of 6 or 6.5 points when they have a bath, ice cream in the fridge and work in the morning.  In other words, Tinder knows exactly where Steve is going.  And if you pick the right exploit, then you too will soon find out. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To determine the direction of the search, you looked at past leaks from Tinder users.  There were several.  In 2013, it was discovered that the <a href="https://qz.com/106731/tinder-exposed-users-locations/">Tinder servers send the exact coordinates of potential matches to the mobile application</a> .  Based on them, the application calculated the distance between users, but did not display coordinates in the interface.  However, an attacker could easily intercept Tinder's own network traffic, check the raw data and determine the exact location of the target. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/545/7f6/059/5457f6059c9e1af8adfaa8677d1c0e13.jpg"><br>  <i><font color="gray">Tinder API response including exact location</font></i> <br><br>  Tinder tried to quietly fix the vulnerability by shifting the distance calculation to the servers instead of the application.  After that, the network messages sent from the server to the application contained only these pre-calculated distances without actual locations.  However, Tinder casually sent distances in the form of non-rounded numbers with 15 decimal places. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/094/8f5/25b/0948f525bd667d3743b376bc7177b94c.jpg"><br>  <i><font color="gray">Tinder API response including exact distance</font></i> <br><br>  This negligence allowed the <a href="http://blog.includesecurity.com/2014/02/how-i-was-able-to-track-location-of-any.html">cunning researchers to again determine the exact location of the targets</a> using an exploit for trilateration.  The researchers sent three fake coordinates to Tinder with different locations of the user.  At each new location, they asked Tinder how far the target was.  Then three circles were drawn on the map with centers in fake coordinates and radii equal to the distances obtained.  The point of intersection is the coordinates of the target with an accuracy of 30 meters. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ee/72c/b75/4ee72cb750081d088adff413e07194d5.jpg"><br>  <i><font color="gray">Tinder Trilateralization Example</font></i> <br><br>  The Tinder security team looked at these people, who constantly force them to work, sighed and quietly fixed the vulnerability.  Now Tinder sends distance, rounded to kilometers, to the application.  You can still use this trilateration procedure to determine the coordinates of a target within a kilometer or so.  But in the densely populated city of San Francisco, this will not give an answer, where does the sneaky Steve Stevington go. <br><br>  On Friday afternoon, a gloating grimace reappeared on Steve Stevington's face, indicating that he was ready to perform various actions in unknown places.  You have to figure out where he goes before it‚Äôs too late.  You are locked in a private office - in the reading room of the library on the 4th floor.  After fifteen minutes of deep breathing and even deeper thoughts, you had a plan to reanimate the Tinder exploitation and try to find out where the Stephenator is going. <br><br>  Suppose Tinder now calculates the exact distances on the servers, rounds them to the nearest whole number, and then sends the rounded numbers to your phone.  You can launch a new attack in the same way as with trilateration.  Ship the fake Tinder locations and ask how far the target is.  Tinder can answer "8 kilometers", which in itself is of little use.  But then you can move one pixel northward asking for the distance with each step.  The server will respond "8 kilometers, 8 kilometers, 8 kilometers, 8 kilometers, 7 kilometers."  If your assumption about the rounding process is correct, then the point at which the answer changes is the exact distance to the target of 7.5 kilometers.  If you repeat this procedure three times and draw three circles, then we will again use the trilateration exploit. <br><br>  Go to action.  While Wilson has gone to the toilet, you lend his phone for testing - you know that he is using Tinder, and the unlock code is visible by the finger on the screen.  Speak to your unpaid probationary probationers so they won't call you on the phone and say nothing to Wilson ‚Äî and hurry to a secluded and deserted corner of your office in the fiction department for older school age.  There you open Tinder on both phones.  You continue svaypit until you get a match, and then write a short script in Python using <a href="https://github.com/charliewolf/pynder">pynder</a> to spoof Tinder API calls.  You place Wilson in the middle of San Francisco Bay, and then you try to determine its coordinates by changing your location pixel by pixel to find the point when the distance between you changes from one rounded number to another. <br><br>  But something is wrong.  Evening came, supper time passed, and you have not yet found Wilson.  You seem to be getting close, but not enough.  Circles are sometimes painfully close to the intersection, but usually do not give a meaningful answer where Wilson is.  You begin to despair.  Right at this moment Steve Stevington can sign a new contract with Peter Thiel and Aunt Martha.  Perhaps he has already updated your company‚Äôs LinkedIn page, renamed you ‚Äúadvisor‚Äù, ‚Äúassistant‚Äù or ‚Äúformer CEO‚Äù.  The library closes - and you move to the pantry.  Wilson continues to call, but probationers on probation do not pass you.  Even a fleeting thought of giving them a job jumps. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dd0/f57/7f6/dd0f577f6ae5e7a74a9e819fb89017cd.jpg"><br><br>  Frustrated, you take a step back and hit your head on the bottom shelf.  Getting out of a heap of cleaning products, you are considering the possibility that the assumptions may be wrong.  Tinder may not just round off exact distances.  You take a snack from a library employee's refrigerator to help the thinking process.  Stop drawing circles and start walking along the lines around the true location of Wilson, putting a mark on each change of distance. <br><br>  At two o'clock in the morning everything becomes clear. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f6f/bc6/1f2/f6fbc61f235072d12c5ad7601a974277.jpg"><br>  <i><font color="gray">Placing Marks on a Map Based on Tinder Distances</font></i> <br><br>  Now Tinder so jealously protects the privacy of users, that it breaks the boring clips of ordinary geometry.  He abandoned Euclid.  He does not need the <a href="https://en.wikipedia.org/wiki/Haversine_formula">Haversinus formula</a> .  Instead, when calculating the distance between matches, Tinder uses two innovations. <br><br>  First, and most importantly, it divides the city into squares of approximately 1 √ó 1 mile.  When calculating the distance, the location of the target is tied to the center of the current grid square.  Then, the approximate distance between you <i>and this anchored location is</i> calculated and returned. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c70/40e/ac2/c7040eac21f31af04acf613b3f0df997.jpg"><br>  <i><font color="gray">Tinder binds user locations to the grid</font></i> <br><br>  Secondly, it calculates distances as if by its unique formula.  For this, a map of coarse, predetermined distances is taken - and superimposed on the center of the square of the target.  Tinder looks up the attacker's location in this overlay and returns the appropriate distance.  In the normal calculation of the Euclidean distance, this would be a set of concentric circles. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/046/7ca/44e/0467ca44ec95e23290d311d42581e291.jpg"><br><br>  But Tinder seems to use a concentric squares overlay with strange curves at the corners as it moves away from the target. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a9a/9bd/a33/a9a9bda3337f9f250b28758e658af4ed.jpg"><br><br>  Among other things, this means that Tinder often returns slightly wrong distances.  You suspect that rounding corners are necessary to adjust for <i>too</i> irregular distances, which are northeast of each other. <br><br>  Mesh snapping is a key innovation in the Tinder approach.  This means that Tinder will always return the same distance if the target is located anywhere within the specified grid square.  Your trilateration exploit will not work.  And if Tinder correctly implemented the grid binding, then no purely remote exploit will ever work.  There is no way to find the location of a target with greater accuracy than the edges of one of the grid squares (approximately) 1 √ó 1 mile.  Even such crude surveillance can make Tinder users think.  But in fact, this is quite a reasonable behavior for the application, the main function of which is to tell strangers about where you are. <br><br>  You really do not know why Tinder applies such a strange layer of squares with rounded corners.  As long as user locations are tied to the grid, Tinder could use the normal Euclidean distance without risking privacy.  Perhaps, just a new metric is calculated faster, and despite the testaments of Gordon Moore, computers are still limited.  However, all this leads to the conclusion that Tinder is safe - in this very narrow aspect - and you screwed up. <br><br>  The library is in complete darkness, not counting the green glow of the copier.  You sadly, but carefully cover the tracks.  You clean the storeroom and throw Wilson's phone into an industrial library shredder.  You leave through the main entrance, steal a badly fastened bicycle and sadly roll home. <br><br>  The next morning, Steve Stevington gives you one of a couple of co-directors, who he worked on in his secret daytime pottery classes.  This is absolutely disgusting.  It would be better if he gave you one of a pair of ten-dollar bills and stayed in the office.  He worked a little and poorly, but you had to hold many meetings and lie a lot - usually this is his job.  But at least he didn't steal your company.  You pour Wilson's coffee into your ridiculous mug and wish health to your good friend. <br><br>  When you fall asleep at night, thoughts come to mind what is happening with the Tinder grid at the North Pole ... <br><br>  <i><a href="https://github.com/robert/tinder-locations">Your code from this article is published on Github</a> .</i>  <i>Please <a href="https://robertheaton.com/about">inform yourself</a> if you have any questions or find any errors.</i> </div><p>Source: <a href="https://habr.com/ru/post/417877/">https://habr.com/ru/post/417877/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../417867/index.html">How to estimate the duration of an IT project, and when it is not worth doing</a></li>
<li><a href="../417869/index.html">How to debug WebRTC</a></li>
<li><a href="../417871/index.html">At the finish line of suborbital tourism</a></li>
<li><a href="../417873/index.html">Ways to create popup windows</a></li>
<li><a href="../417875/index.html">Getting out of the rabbit burrow SPA with modern Rails</a></li>
<li><a href="../417879/index.html">How to take Microsoft exams for free [on the example of a recent competition]</a></li>
<li><a href="../417881/index.html">Digest of fresh materials from the world of the frontend for the last two weeks ‚Ññ323 (July 8 - 22, 2018)</a></li>
<li><a href="../417883/index.html">Creating a dialogue to select a ringtone</a></li>
<li><a href="../417885/index.html">About M and about V and about C</a></li>
<li><a href="../417887/index.html">Special purpose audio gadget: Stirlitz voice recorder, its real prototype and bold historical modeling</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>