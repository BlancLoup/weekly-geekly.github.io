<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As I png reduced 4 times</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This idea arose a year ago, when I came to the miscalculation of a web game project with a lot of animation, which was supposed to be done in high qua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As I png reduced 4 times</h1><div class="post__text post__text-html js-mediator-article">  This idea arose a year ago, when I came to the miscalculation of a web game project with a lot of animation, which was supposed to be done in high quality sprites (large sprites) and with high-quality alpha channel (in the sense, not with an indexed transparency color).  In this game you throw the dice on the table and it is necessary that they always fall in different ways. <br><br>  It was not difficult for me, including the animator, to make one such png-animation of the size of one frame 400 by 400.  Making dropping cubes was always different. It was a non-trivial task in no place.  However, motivated by a round sum of hairy hands, I started the assault, thinking first of all about how to make the game beautiful at the same time (as I‚Äôm originally a designer, 3D artist and esthet, and I‚Äôll never become a programmer), and this one will load in less than a thousand minutes. <br><a name="habracut"></a><br>  Wanting to estimate the volume of graphic animation files, I made a variation of the fall of one cube in a strip, in order to later reset several similar variations at different angles and, perhaps, it would be quite diverse.  When I assembled the sequence of frames in a horizontal strip, the thought of the GIF, its horizontal compression and indexed colors lit up immediately and released only last night. <br><br>  From my experience as an expert in animation of three-dimensional cubes, I know that while they are jumping and animating in every way, the importance of the quality of displaying their edges and other details is inversely proportional to speed.  Therefore, somewhere they can be shaken to the maximum both in alpha and rgb, and on frames where the movement calms down and the cube rises, it is already done at 100%.  That is, png with its huge size is claimed only in the last 5-10 frames from a 50-frame sequence - and only in that place of the frame where the cube stopped.  The desire to reap all that is possible, suggests itself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/9a6/db3/22c/9a6db322cb2f4121ba5574cd162d54ec.gif" alt="throw"><br><br>  Making a variation of the cube drop, I allowed that then it would be possible to make one alpha channel and six rgb variants with different textures (different final values ‚Äã‚Äãof the cube) for it.  While the cube is flying, it flies in a straight line, after the first strike it slightly deviates, and then deviates strongly, therefore the frame bar is not as thin as we would like, and most of each frame remains empty, which is painful for png, but it would not be problem for gif.  As a result, with all the tricks on one option in the png32 format, half a megabyte of kilobytes was consumed.  This is not taking into account that such variations of the fall should have been, say, 10 pieces at least, and a lot of other graphics were expected in the game. <br><br><h3>  But suddenly! </h3><br>  At that moment, when I already tasted some wonderful people offered the customer to make an order for 7 kopecks less and the order was shaved off, and everything written above lost its logical end.  Unpleasant right  However, I was left with an understanding of the clearly outlined problem: the alpha channel in modern large and beautiful images is sometimes wastefully used to the ugliness and with an understanding of how this problem can be solved. <br><br>  I waited a year, then sat down, found <a href="http://habrahabr.ru/post/154103/">this</a> article, took all the code from it, inserted semicolons in random places and turned out a javascript plugin that can create monstrous things with animation on the website, reduce the traffic of full-color RGBA according to my sore imagination. images 2-10 times and translate the use of large RGBA images on the site to the plane of reasonable.  Also, the function of splitting into sprites is immediately embedded in it, so it can be useful for those lucky people who are concerned with front-end optimization. <br><br>  <b>upd</b> <br>  <i>As a result of the publication and commenting, the optimal use of the plugin became clear: due to the fact that it processes images during the page loading, it will be especially interesting for those who use sprite cards or animations with transparency and bother with the pre-processing of these sprites cards, as well as who needs true-large images with transparency and the ability to twist the compression ratio.</i>  <i>For single and small images fit tinipng and similar services.</i> <br><br><h3>  Materiel </h3><br>  <i>It is assumed that you are able to pull out a black and white alpha channel from an existing image with transparency and shake it yourself in accordance with your wishes for quality and size.</i> <br><br>  During the page loading, the function alpha_spriter is called and 4 attributes are fed into it: <br><br><ol><li>  URL of rgb file with sprites </li><li>  The URL of the corresponding file with the alpha channel is again in any format, in most cases it is gif / png8. <br>  <i>Both files must be on the same domain.</i> </li><li>  Javascript-free form object with sprite markup.  Joke!  (Noticed?) The form is quite accurate and its example is available in the plugin code. </li><li>  Well, the function that you want to finish </li></ol><br>  At the same second, the function loads images, combines them using canvas into a full png32 and cuts onto sprites.  At the output, generated images are assigned by id (specified in the JS object), prepared in the document body in two variants: src for &lt;img&gt;, or background-image (over the other necessary background properties already set). <br><br>  The minimum first working version is immediately tested and successfully combines on a live project an image of a dancing snow leopard, sometimes rooster-like, and thus saves the it-infrastructure of one country from irreversible overheating. <br><br><img src="https://habrastorage.org/files/4bf/d00/4cc/4bfd004cc3cb448fbebd4e6c7a782688.png" alt="compare"><br><br>  I attach for comparison the timing of loading the page.  The page itself, the plugin and the test files can be found on the <a href="https://github.com/andreiselin/alpha_spriter">githaba</a> , if it is not prohibited here.  If it is forbidden - just do not click, please. <br><br><img src="https://habrastorage.org/files/b0d/86d/911/b0d86d9113be46e397d8da68072cd558.jpg" alt="time"><br><br>  Just in case, please note again that my canvas was doing its job in terms of the web environment and only from its origin.  This moment is specified. <br><br><h3>  Everything </h3><br>  Now tell me that there are already 10 such solutions and no one needs them.  About rgb8 and about alpha in css.  But seriously, I would like to first of all understand how much this is in demand and in case of that, finish up to the level of hi-end 3000 and make a sprite map generator.  Well, actually, if you have any wishes, well-wishers. <br><br>  Thank! <br><br><h3>  Bibliography </h3><br>  <a href="http://habrahabr.ru/post/154103/">That same article</a> , which served to accelerate the development of the plug-in and, possibly, caused its appearance - thanks, <a href="http://habrahabr.ru/users/sergof/" class="user_link">sergof</a> ! </div><p>Source: <a href="https://habr.com/ru/post/259613/">https://habr.com/ru/post/259613/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259603/index.html">Rounds - border-radius inset for images</a></li>
<li><a href="../259605/index.html">Geolocation without GPS (part 2)</a></li>
<li><a href="../259607/index.html">Developer Errors in MMO Testing</a></li>
<li><a href="../259609/index.html">How on PHDays V hacked the RB System</a></li>
<li><a href="../259611/index.html">Dagaz: Kicks to common sense (part 8)</a></li>
<li><a href="../259615/index.html">Data from Arduino in the form of charts and graphs</a></li>
<li><a href="../259619/index.html">Python Meetup 04/24/15: Python tests, Rest services on Flask and GUI application in 5 minutes</a></li>
<li><a href="../259621/index.html">"1-wire" for buttons with indication</a></li>
<li><a href="../259623/index.html">ADC as a random number generator</a></li>
<li><a href="../259625/index.html">Isomorphic applications. Looking to the future with React</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>