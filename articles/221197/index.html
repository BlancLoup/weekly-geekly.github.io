<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Particles System in crowd modeling (3)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue the conversation of 04/10/2014 ( Particles System in crowd modeling (2) ). 

 In this part: 


1. add the death of the shooter (because th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Particles System in crowd modeling (3)</h1><div class="post__text post__text-html js-mediator-article">  We continue the conversation of 04/10/2014 ( <a href="http://habrahabr.ru/post/218697/">Particles System in crowd modeling (2)</a> ). <br><br>  <b>In this part:</b> <br><ol><li>  add the death of the shooter (because the explosions are killing) </li><li>  play around with the settings of the emitters - I want epic </li></ol><br><br>  <b>add the death of the shooter (because the explosions are killing)</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In order to "kill the arrow", there are many different ways.  I will choose the most common - to reduce a certain "amount of health" to zero or less.  But in order to reduce anything, it is necessary to first provide it with health ( <i>HealthInitializer</i> ). <a name="habracut"></a><br>  During particle initialization, with the help of <i>HealthInitializer</i> , a new user variable <i>‚Äúhealth‚Äù is</i> added to the properties of the <i>Particle.dictionary</i> class <i>.</i> <br><br><pre><code class="actionscript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">package</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">waylines</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initializers</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> org.flintparticles.common.particles.Particle;</span></span> <span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> org.flintparticles.common.emitters.Emitter;</span></span> <span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> org.flintparticles.common.initializers.InitializerBase;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthInitializer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InitializerBase</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> health:int; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HealthInitializer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(health:int=100)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.health = health; } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( emitter : Emitter, particle : Particle )</span></span></span><span class="hljs-function"> : void </span></span>{ particle.dictionary[<span class="hljs-string"><span class="hljs-string">"health"</span></span>] = health; } } }</code> </pre> <br><br>  Particles got health, and now you can reduce it. <br>  Changes to the main code: <br><ul><li>  we initialize new property </li><li>  extend parent method <i>MainWaylines_2.explosion</i> </li></ul><br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e:Event=null)</span></span></span><span class="hljs-function">:void </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.setup(e); <span class="hljs-comment"><span class="hljs-comment">//  " "   -  emitterWaylines.addInitializer( new HealthInitializer(100)); }</span></span></code> </pre><br><pre> <code class="actionscript hljs"><span class="hljs-comment"><span class="hljs-comment">/* *   (     -     ) * 1.   explosion ""   emitterWaylines     emitterExplosion * 2.          . *   ,  ""    * -     ,      */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">explosion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e:MouseEvent)</span></span></span><span class="hljs-function">:void </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* *     -     emitterWaylines */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.explosion(e); <span class="hljs-comment"><span class="hljs-comment">/* *  copy-paste   * ,          */</span></span> ... var particles:Array = emitterExplosion.particlesArray; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length:int = particles.length; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r:int=<span class="hljs-number"><span class="hljs-number">0</span></span>; r&lt;length; r++) { ... if(Point.distance(explPoint, particlePoint) &lt; explRadius) { particleClone = Particle2D(particles[r]); particleClone.angVelocity = <span class="hljs-number"><span class="hljs-number">-5</span></span> + Math.random() * <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* *  " "   " " -    ... */</span></span> particleClone.lifetime += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//particleClone.age = 0; /* *       ( 10  40 ) */ particleClone.dictionary["health"] -= (10 + Math.random() * 30); } } }</span></span></code> </pre><br><br>  Everything is working.  It is not clear who hurt and who killed.  You can add color differentiation <s>pants pants</s> . <br>  Insert a couple of lines into <i>MainWaylines_3.explosion ()</i> : <br><br><pre> <code class="actionscript hljs"><span class="hljs-comment"><span class="hljs-comment">/* *        -    ,    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(particle.dictionary[<span class="hljs-string"><span class="hljs-string">"health"</span></span>] &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  "" -   addBlot(particle); //   particle.isDead = true; } else { //  "" -   Arrow(particle.image).color = getArrayColorByHealth(particle.dictionary["health"]); }</span></span></code> </pre><br><br>  <b>play around with the settings of the emitters - I want epic</b> <br><br>  <a href="http://flintparticles.org/">The particle library</a> , taken as the basis for working on an application, operates with physical laws (mass, gravity ...) - subtle matter, for me in any case (not techie).  Yes, and surely it would take to write your own add-ons - which is highly undesirable (I want to play with programming like with purchased children's dice, rather than sharpening myself on a lathe). <br>  Therefore: <br><ul><li>  I just Slow Emitters as much as I needed (100 times) </li><li>  increased the acceleration parameter (10 times) <i>new MinimumDistance (7, 6000)</i> </li><li>  increased the power of "anigravity" (10 times) <i>new Antigravities (emitterWaylinesForMonsterArrows, -4000000)</i> </li></ul><br><br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e:Event=null)</span></span></span><span class="hljs-function">:void </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.setup(e); <span class="hljs-comment"><span class="hljs-comment">//  " "   -  emitterWaylines.addInitializer( new HealthInitializer(100)); /* * " "    (  ) * - - .1 */ emitterWaylines.maximumFrameTime = .001; emitterWaylinesForMonsterArrows.maximumFrameTime = .001; /* * -      ,   ,    * (,        -        ,    ) */ emitterWaylines.addAction( new Antigravities(emitterWaylinesForMonsterArrows, -4000000) );//  400000 emitterWaylines.addAction( new MinimumDistance( 7, 6000 ) );//  600 }</span></span></code> </pre><br><br>  The potential enemy as a result began to move much slower - in proportion to its size relative to the map (if it‚Äôs goblins or zombies, for example).  The map itself can be scaled, the coordinates of the particles extrapolated to larger (smaller) screens. <br><br><img src="//habrastorage.org/files/a6c/13a/29e/a6c13a29e9b94c23a6879cbd66422f8d.png"><br><br>  Well, actually, this is what I wanted to share - the principle of crowd modeling using the Particle System.  The result is an almost finished prototype Model (MVC) for Tower Defense.  Of course, 60 fps, with such a particle density, cannot be achieved ... But - there is much to optimize (in the previous parts I have mentioned), to fasten a free render (Starling, Away3d) <br><br>  The code is available on <a href="https://code.google.com/p/particles-system-crowd/">google code</a> .  Class MainWaylines_3 <br><br>  PS: there will be time, I will definitely show a bolted render </div><p>Source: <a href="https://habr.com/ru/post/221197/">https://habr.com/ru/post/221197/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../221185/index.html">DevConf 2014 will be held on June 14 in Moscow - more than 1000 developers from communities will gather</a></li>
<li><a href="../221187/index.html">Introducing Intel XDK - Mobile Cross-Platform Development Tool</a></li>
<li><a href="../221189/index.html">Free group calls to Skype for all</a></li>
<li><a href="../221193/index.html">Who came up with nanotechnology?</a></li>
<li><a href="../221195/index.html">Browser game "Cyber ‚Äã‚ÄãDevelopment" - update</a></li>
<li><a href="../221199/index.html">Revolutionary computers on the way. It remains to learn how to program them.</a></li>
<li><a href="../221201/index.html">Migrating from Windows XP to 8.1 using SCCM 2012 R2 and MDT 2013</a></li>
<li><a href="../221203/index.html">Indikt - a new word in working with local data</a></li>
<li><a href="../221205/index.html">Digest KolibriOS # 4: and spring is not a hindrance</a></li>
<li><a href="../221209/index.html">Keyboards: separate, with even columns and half reversal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>