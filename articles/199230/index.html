<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>LeapMotion. What's inside?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So far work with a teapot is limited to drawing up documentation (which, undoubtedly, is quite boring for a habr - judging by the previous topic) I wi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>LeapMotion. What's inside?</h1><div class="post__text post__text-html js-mediator-article">  So far work with a teapot is limited to drawing up documentation (which, undoubtedly, is quite boring for a habr - judging by the <a href="http://habrahabr.ru/company/avi/blog/197372/">previous</a> topic) I will write about an abstract - about the inside of a piece of iron.  For the next project (lighting control), we needed to light the topic of OpenCV and the appropriate cameras for this business. <br>  At the same time, I also wanted to receive a depth map from the video - to change the brightness depending on the distance to the person. <br><img src="https://habrastorage.org/getpro/habr/post_images/8bb/7c1/e35/8bb7c1e35e2b6ce68a620b7f41f57e1c.jpg"><br>  Having learned that two cameras are used in the LeapMotion controller, we immediately ordered it ‚Äúto poke‚Äù. <br><br><a name="habracut"></a><br>  I think about what LeapMotion is, if they don't know, then at least everyone has heard.  If you still have not heard - then this is a small box-controller, which perceives the movement of hands, and allows these same movements to control the computer.  Here is a video that shows how this happens: <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/_d6KuiuteIA%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700253&amp;usg=ALkJrhg8ng-3SGMcPRffAn4rPqiT6OSqsA" frameborder="0" allowfullscreen=""></iframe><br>  I will not dwell on the details of anboxing and a review of the device itself, because it was done a long time before me, as many as <a href="http://habrahabr.ru/company/rozetked/blog/190404/">two</a> <a href="http://habrahabr.ru/post/169043/">times</a> . <br>  I will talk about a more interesting thing - how this thing actually works.  The device is ready for preparation: <br><img src="https://habrastorage.org/getpro/habr/post_images/bb8/401/285/bb8401285e7506bf65867976234d06b5.jpg"><br>  Speaking of it from all sides, the first opening is revealed - a rubber sticker on the bottom that is easily peeled off: <br><img src="https://habrastorage.org/getpro/habr/post_images/25a/017/88d/25a01788d5bf3ec222ec39e85f72a54e.jpg"><br>  Under it are found several screws: <br><img src="https://habrastorage.org/getpro/habr/post_images/a8a/6c6/f1d/a8a6c6f1d6e2e8a182663c3e741f4740.jpg"><br>  Which naturally immediately get out, and ... and nothing happens.  The device looks the same monolith as before.  Well, let's go on the other side in the literal and figurative sense: <br><img src="https://habrastorage.org/getpro/habr/post_images/7be/9f5/851/7be9f58512686e5d56e9d44c69734b5f.jpg"><br>  The dark surface on the front is an opaque IR-permeable plastic.  He is also glued to something, but by slow movements of the heat gun he was able to free himself from the grip of the glue and the body.  We remove it to the side, and we see EYES: <br><img src="https://habrastorage.org/getpro/habr/post_images/c30/79b/b76/c3079bb76284f13ea2517ab4101c5afc.jpg"><br>  They do not make such an impression on you, because you have already seen them in the title photo.  But when you remove the opaque plastic, and because of him <b>looking</b> at you - an unforgettable feeling. <br>  Remove the rubber seal, and see the first board: <br><img src="https://habrastorage.org/getpro/habr/post_images/eab/34a/43d/eab34a43d17f846296c7bffc0598b0ae.jpg"><br>  She holds on four screws.  We unscrew them, remove the upper board, and gain access to the bottom: <br><img src="https://habrastorage.org/getpro/habr/post_images/0ef/39c/18c/0ef39c18c2bcb801d3337967d0f1d9e6.jpg"><br>  Here it is, together with a black plastic liner and held by the screws that we saw earlier.  It is good that we have already unscrewed them :) <br>  Control inclusion, check the correct operation after disassembly: <br><img src="https://habrastorage.org/getpro/habr/post_images/bc7/ad7/578/bc7ad75788bf74e52728755107f71e37.jpg"><br>  It's okay  You can play on. <br><a name="foriya"></a><br>  When connecting the boards, they make up a sandwich like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/c14/db3/8c6/c14db38c6068d3e47c2fd3bfdc992f1a.jpg"><br>  The boards are connected like this (part of the father): <br><img src="https://habrastorage.org/getpro/habr/post_images/6cc/3bc/10a/6cc3bc10a3d1b4740f6ccef0330255ac.jpg"><br>  And the other part: <br><img src="https://habrastorage.org/getpro/habr/post_images/688/4f8/70f/6884f870f3078a8d1ccb19e5d12e874c.jpg"><br>  Of course, there is no need to show it in such detail, but I still rejoice at my macro lens.  Go to the boards (the lower side of the top board): <br><img src="https://habrastorage.org/getpro/habr/post_images/aab/9f3/ffe/aab9f3ffea7cbd61d1966636129457f8.jpg"><br>  It is located on the controller <a href="http://www.cypress.com/%3FdocID%3D44322">CYUSB301X</a> : <br><img src="https://habrastorage.org/getpro/habr/post_images/523/7a8/c15/5237a8c15e6b895e50a759acca4e6e4f.jpg"><br>  This is a 32-bit ARM9 controller from Cypress.  200 MHz, USB3.0 and 2.0, OTG.  Designed just to work with pictures and video. <br>  USB3.0 (I wonder why, would it really be enough for 2.0?) Connector: <br><img src="https://habrastorage.org/getpro/habr/post_images/ec9/2ef/88a/ec92ef88a979bdc43fbab75bb83d92e8.jpg"><br>  Located next to the MOSFET: <br><img src="https://habrastorage.org/getpro/habr/post_images/acf/705/1a1/acf7051a11a505adaf94547389431e11.jpg"><br>  And two large capacitors: <br><img src="https://habrastorage.org/getpro/habr/post_images/bc0/de1/bc2/bc0de1bc2d2a28a5fee709e6e9a5ef43.jpg"><br><br>  More on this side there is nothing interesting.  We look at the upper side of the first board: <br><img src="https://habrastorage.org/getpro/habr/post_images/8e4/41d/024/8e441d024ef4e2085ebb87324eaedb0e.jpg"><br>  This is a flash memory MXIC 25L3206E, SPI-interface, 32 megabits.  It stores the controller firmware.  For some reason, the developers did not use the Kipressov controller chip ‚Äî a firmware download via USB.  Maybe to speed up the download? <br>  Divorced UART: <br><img src="https://habrastorage.org/getpro/habr/post_images/4f2/724/3b6/4f27243b64253e2447cbc92c994c7239.jpg"><br>  Having seen it, we were so quickly soldered to it that we didn‚Äôt even have time to photograph contact pads without solder. <br><img src="https://habrastorage.org/getpro/habr/post_images/9f1/ef1/777/9f1ef177757bb8fcdd82b74fe15eeec3.jpg"><br>  Unfortunately, he is silent in him as a partisan - not a single byte. <br>  So, let's look at something more interesting, for example, on one of three infrared LEDs: <br><img src="https://habrastorage.org/getpro/habr/post_images/2ea/2fa/ad5/2ea2faad53c4c53a916e505f3407cc56.jpg"><br>  Next to it - apparently, the binding for controlling it - in the standby mode, the LEDs noticeably quench the brightness. <br>  And here is another central LED: <br><img src="https://habrastorage.org/getpro/habr/post_images/e8a/6fc/1c3/e8a6fc1c33eb7466ad837f56210f9053.jpg"><br>  The only difference is a slightly different lens shape.  Next to him - exactly the same strapping. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The rest of the board is pretty boring.  Two cameras with fisheye lenses, yes a connector. <br>  Once again we are surprised at the sensation of a face with eyes-cameras, and mouth-plug: <br><img src="https://habrastorage.org/getpro/habr/post_images/91f/f99/4f4/91ff994f4441a09d653e1aa9fd82b216.jpg"><br>  I think the developers did not accidentally stop at exactly this location of the components.  <b>¬∞ ¬∞ ¬∞</b> <br>  Cameras are black and white, with a resolution of only 640 √ó 480, but they can produce 60 frames per second. <br><img src="https://habrastorage.org/getpro/habr/post_images/6d9/776/096/6d97760965d3f3802dce11adb24ab085.jpg"><br>  Count.  0.3 megapixels, 60 frames, two cameras, uncompressed ... 640 * 480 * 60 * 2 = 35Mbytes / sec.  Apparently, therefore, they installed USB3.0, this speed is unattainable for 2.0, and it was more expensive to develop compression (in overhead) than to install a new chip. <br>  However, in the mode of USB2.0 devices also works, but reduces the frequency of the frame - the reaction becomes thoughtful. <br><br>  I wanted to look at the matrix - but the lenses of the cameras were sealed with a sealant: <br><img src="https://habrastorage.org/getpro/habr/post_images/8c2/c67/e91/8c2c67e91381f34e056122c0d4945199.jpg"><br>  So further we did not dare to disassemble, being afraid to break the focus.  The cameras take off completely in the <a href="http://habrahabr.ru/company/avi/blog/195580/">infrared range</a> - dark plastic cuts off all visible light, and transmits infrared radiation from the LEDs reflected from the skin of the hands.  As expected, with a bright source of infrared light behind (the sun, incandescent bulbs), the definition of the fingers begins to fade a little.  Use fluorescent and LED lamps.  :) <br><br><h4>  findings <br></h4>  In terms of circuitry, the device is pretty stupid.  In fact, just a backlit webcam that drives a video stream to a computer. <br>  A picture from two cameras looks like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/ae4/955/7c9/ae49557c9cc019777da2f65281f0212e.jpg"><br>  But on the computer, the picture is being processed; a depth map is constructed from two images: <br><img src="https://habrastorage.org/getpro/habr/post_images/d40/5b8/89c/d405b889cb0f1b26031ef6543f388473.jpg"><br>  And an <a href="http://www.youtube.com/watch%3Fv%3D353p4IozW-4">array of points</a> is created, with which the programs are already working: <br><img src="https://habrastorage.org/getpro/habr/post_images/b1b/7aa/4d6/b1b7aa4d63f8b8c9b9ca4f5ff7999148.png"><br><br>  You can work with the camera without using native software - good people dismantled the protocol and wrote <a href="https://github.com/openleap">programs</a> for working with it. <br><br>  For our purposes, unfortunately, this thing didn‚Äôt fit - the cameras are too close and it‚Äôs impossible to correctly determine a distance of more than a few meters.  Well, okay. <br><br>  Finally, a funny two-color LED: <br><img src="https://habrastorage.org/getpro/habr/post_images/9d0/93d/f40/9d093df40896d01a594d370fe5d2cb46.jpg"><br><br>  I remind you, if you do not want to miss the epic with a kettle and want to see all the new posts of our company, you can subscribe to <img src="https://habrastorage.org/getpro/habr/post_images/ce4/0f1/d16/ce40f1d1668436a03738295da0147749.png" alt="image">  <a href="http://habrahabr.ru/company/avi/">on the company page</a> (button "subscribe") </div><p>Source: <a href="https://habr.com/ru/post/199230/">https://habr.com/ru/post/199230/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../199220/index.html">MicroXperts U400-06. Aluminum Ultrabook Review</a></li>
<li><a href="../199222/index.html">Where does hard drive space disappear in Mac OS X</a></li>
<li><a href="../199224/index.html">Discovered the most distant galaxy: 30 billion light years from Earth</a></li>
<li><a href="../199226/index.html">Recipe i18n. Basis - Babel, json with coffee and a grant with hbs to your taste</a></li>
<li><a href="../199228/index.html">How to import non-imported</a></li>
<li><a href="../199234/index.html">Installer Testing: Automate Windows Login</a></li>
<li><a href="../199238/index.html">CryptoPati! - party hard!</a></li>
<li><a href="../199240/index.html">12-year-old student hacked government sites for Anonymous</a></li>
<li><a href="../199242/index.html">Optimus Popularis Keyboard Review (+ video)</a></li>
<li><a href="../199248/index.html">Andragogue Practitioner Tips: How We Learn</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>