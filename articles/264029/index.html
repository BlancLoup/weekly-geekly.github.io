<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A game for the little ones is a simple idea that is not a shame to include in the resume</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 
 My son, like all the children of programmers, probably got his first keyboard when he couldn‚Äôt sit. Now he is a little less than a year o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A game for the little ones is a simple idea that is not a shame to include in the resume</h1><div class="post__text post__text-html js-mediator-article"><h4>  Prehistory </h4><br>  My son, like all the children of programmers, probably got his first keyboard when he couldn‚Äôt sit.  Now he is a little less than a year old, but he already understands the difference between the "toy" and the "real" (Daddy's) keyboard - if you pound the buttons of the present, the picture changes on the screen, and the computer sometimes makes some sounds. <br><br> <a href="http://habrahabr.ru/post/264029/"><img src="https://habrastorage.org/files/6b1/47a/8e3/6b147a8e36ff490e87508a488dbd213b.jpg" alt="KDPV"></a> <br><br>  Since I don‚Äôt want to lose all my data, the child is sometimes allowed to click on the buttons of a locked computer.  Unfortunately, for a child it is not very fun, because the computer has only two modes (two pictures) - the password entry screen and the actual lock screen. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To make the process of mastering a computer more interesting for a baby, I decided to write him a simple game.  Being an experienced programmer, it was decided to build the whole process ‚Äúcorrectly‚Äù. <br><br><h4>  Requirements </h4><br>  The customer (my son, age &lt;1 year), like all normal customers, found it difficult to write in writing the consistent and complete requirements for the product, so I had to <s>help</s> write myself. <br><br>  Functional: <br><ul><li>  The application works in full screen mode. </li><li>  You can click on everything, but the most accessible methods of exit or program switching should be blocked. </li><li>  Visual feedback - the background color changes when you press, the pressed symbol is displayed in the center of the screen. </li><li>  Sound feedback - the application makes a sound when you press a key. </li><li>  Predictable behavior - the background color, symbol and sound must always be the same for the same key. </li></ul><br>  Not functional: <br><ul><li>  I should not be ashamed of the written code. </li><li>  The code should be valuable in itself. </li><li>  The architecture and all solutions must be ‚Äúcorrect‚Äù - as in a custom project. </li></ul><br>  In addition, it was decided to use a flexible, iterative approach to development with small development cycles resulting in receiving feedback (SCRUM). <br><br>  C # and Visual Studio were chosen as the programming language and development environment, as they provided the performer with the highest speed. <br><a name="habracut"></a><br><h4>  Implementation </h4><br>  From one of the old projects, the code was extracted to create an application deployed in full screen: <br><pre><code class="cs hljs">FormBorderStyle = FormBorderStyle.None; WindowState = FormWindowState.Maximized; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> screen = Screen.PrimaryScreen; Bounds = screen.Bounds;</code> </pre> <br>  Further, the <a href="https://github.com/gmamaladze/globalmousekeyhook">MouseKeyHook</a> library was found in the wilds of the Internet, with examples of how to block the Windows button.  Similarly, the examples were blocked by Alt-Tab and Ctrl-Esc.  Now you can exit the application only by Alt-F4. <br><br>  Next, code was written that initializes the random background color for the pressed key: <br><ul><li>  Used new random (seed), so that at each launch random gave the same values. </li><li>  To make the colors more or less meaningful, I randomly selected a value from the KnownColor enumeration, which was then converted to Color and assigned to Form.BackColor. </li><li>  Alphabetic characters and numbers were supported. </li><li>  The symbol was output ‚Äúas is‚Äù - the Q key could display ‚ÄúQ‚Äù, ‚Äúq‚Äù, ‚ÄúD‚Äù, ‚ÄúD‚Äù, depending on the active input language and the state of CapsLock. </li></ul><br>  The first alpha tests on themselves revealed the following implementation flaws: <br><ul><li>  Form.BackColor strongly disagrees to accept the color Transparent. </li><li>  Black is accepted, but the symbol is not visible on it. </li><li>  There are a number of keys that can be pressed, they have a symbol, but they are not processed by the program or do not display the symbol - Enter, Tab, Space, the block of numbers above the letters and the block of numeric keys on the right of the keyboard. </li><li>  I really didn‚Äôt like the KeyDown / KeyPress processing code - it was necessary to select the ranges of characters 'AZ' and '0-9', space, Enter.  There are many not very intelligible blocks of conditions and a complex code for calculating the size of an array of random colors and sampling colors from it. </li></ul><br>  In the second iteration, the following changes were made: <br><ul><li>  A simple WinForm utility is written that just ‚Äúlistens‚Äù to clicks, saves them to the Symbol-Key dictionary.  This allowed to solve the problem of the output of Russian / English letters. </li><li>  The utility has a save button to the file. </li><li>  Since the Space and Enter keys in this case triggered the button handler, and Tab caused the button to go, even if it was not selected, we had to handle these cases separately - set TabStop = false for the buttons and insert ActiveControl = null wherever possible. </li><li>  The utility helped to identify all significant keys - it remembered the key when KeyDown, but added it to the dictionary only by KeyPress, respectively, everything that does not have a symbolic representation (Alt. Shift, Ctrl, Windows, function keys) was ignored. </li><li>  Key processing in the game itself can be greatly simplified to a dictionary search. </li><li>  The file format was the simplest - ready sets are separated by a line break, and the fields (Key-Symbol-Color) in the set are separated by \ 0 (space, tab, and characters like a comma could not be used, since they could be part of the set) </li><li>  After saving, invisible characters were manually replaced with Unicode characters missing on the keyboard. </li><li>  The color was not chosen randomly, but was taken sequentially from enum KnownColor, starting from the next after KnownColor.Black (KnownColor.Transparent comes a little earlier). </li></ul><br>  Alpha testing on itself was quite successful and a demonstration was held to the customer. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/I4GlgWOZMhE%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQZBW8d-Zylb4VYhsBUrSRsdGcGg" frameborder="0" allowfullscreen=""></iframe><br><br>  The customer showed interest in the product, allocated 2 minutes for testing, evaluated the work as a whole positively and pointed out the following disadvantages: <br><ul><li>  Insufficient audio feedback (only the PrintScreen key emits sound). </li><li>  A small luminous button in the far right corner of the laptop (the screen goes out) is incorrectly processed. </li></ul><br>  Inspired by the support of the customer, <s>the</s> author‚Äôs <s>team</s> conducted a retrospective and made the following conclusions: <br><ul><li>  You need to use an external keyboard without power management buttons or mask the hardware button with your hand. </li><li>  It's time to move on to sound feedback. </li></ul><br>  For audio feedback, it was decided to make sounds that correspond to notes (piano keys).  A quick search on the Internet made it possible to find a formula for calculating the frequency of sound for each key, and this formula was promptly implemented in the C # code.  Console.Beep is used for direct sound output to the speakers (and that works the same!). <br>  The first run showed flaws: <br><ul><li>  The author inattentively read MSDN, namely the string ‚Äúranging from 37 to 32767 hertz‚Äù. </li><li>  Low sounds up to about 110 Hz sound disgusting and can not be shown to the customer. </li><li>  A sound duration of 300 ms is too long. </li><li>  The sound is output synchronously and causes a delay in drawing the background. </li></ul><br>  Based on the results, the following changes were made: <br><ul><li>  To form frequencies from 110 Hz (the 25th piano key, A2). </li><li>  The duration of the sound is 100ms. </li><li>  Output sound in a separate stream. </li><li>  The team expressed the suspicion that it is necessary to do Lock in the second thread for the execution time of Console.Beep.  Subsequently, the suspicion was not confirmed, but <s>it was too lazy to remove the</s> lock for didactic purposes. </li><li>  Use <a href="https://msdn.microsoft.com/en-us/library/b367a457(v%3Dvs.110).aspx">double buffer</a> when changing colors so that there are no bands on the screen when you quickly press the keys. </li></ul><br>  This version was highly appreciated by the team, and since there was some time left for the customer to demo, the team decided to refactor: <br><ul><li>  Implement the MVC pattern, select the game logic in the controller, in View, leave only the code specific for working with the form (switch to full screen, event handlers). </li><li>  Cover the controller with unit tests </li><li>  Extract the dictionary file with triples ‚ÄúKey-Symbol-Color‚Äù to resources and implement the Russian and English versions. </li><li>  Since on the working laptop (and we planned to hold a demo on it), I have an English locale, the locale setting through the config was implemented.  In this case, its own section was added to the config and a simple file was implemented for accessing this section, which returns the typed values ‚Äã‚Äãof the config variables. </li></ul><br><h4>  Total </h4><br>  As a result, we got a funny toy for a child, which develops fine motor skills and memory (for favorite colors and notes), as well as code that can be used to demonstrate the implementation of the ‚Äúright‚Äù approaches.  For example, for students or junior-developers. <br><br>  Here is a list of what you can learn by toy code: <br><ul><li>  Work with WinForms (full screen, double buffer, keyboard event handling) </li><li>  Work with localized resources. </li><li>  Use MVC pattern for WinForms (yes, it‚Äôs not necessary to switch to WPF for this). </li><li>  Use of the Singletone pattern (multi-threaded). </li><li>  Working with Moq when developing unit tests. </li><li>  Work with Shouldly when developing unit tests. </li><li>  Parsing lines / files. </li><li>  Multithreading and blocking threads. </li><li>  Working with a config file and creating your own sections. </li><li>  Correct coding style and use of comments and regions. </li><li>  Work with the debug console (logging events). </li><li>  Enumerating enum values ‚Äã‚Äãwith Enum.GetValues. </li><li>  Working with static Array methods (Copy, IndexOf). </li><li>  Work with unmanaged objects (using). </li><li>  ‚ÄúResponsive‚Äù work of the form - confirmation of the exit, using the save file dialog. </li><li>  Working with NuGet and pumping out packages at build. </li></ul><br>  The ready code is laid out as an <a href="https://github.com/igolets/EgorkaGame">open repository on GitHub</a> and is available with a MIT license. <br><br>  ps KDPV ¬© <a href="http://ru.depositphotos.com/5107450/stock-photo-little-child-is-typing-on.html">kobyakov</a> </div><p>Source: <a href="https://habr.com/ru/post/264029/">https://habr.com/ru/post/264029/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264017/index.html">Fighting bad URIs, spammers and php shells is a personal experience</a></li>
<li><a href="../264019/index.html">Algorithm for organizing logical volumes in the Windows OS environment</a></li>
<li><a href="../264021/index.html">How to transfer a project of 9 million lines of code to a 64-bit platform?</a></li>
<li><a href="../264023/index.html">Increased battery life in Android M</a></li>
<li><a href="../264025/index.html">We are flashing the Upvel UR-313N4G router on OpenWRT</a></li>
<li><a href="../264031/index.html">AccelEpi, or How EPAM Helped in Testing Drugs for Epilepsy</a></li>
<li><a href="../264033/index.html">As a regular Wordpress site, dial 99/100 in PageSpeed ‚Äã‚ÄãInsights</a></li>
<li><a href="../264035/index.html">Chat assistant to the site using Telegram in 15 minutes</a></li>
<li><a href="../264037/index.html">Advanced CSS filters</a></li>
<li><a href="../264039/index.html">Free grid control for Xamarin from DevExpress</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>