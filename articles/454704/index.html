<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>On the question of helicopter or how I spent the weekend</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you bought something, and there is no ‚ÄúMade in China‚Äù label on it, it means that you bought a fake. 

 My readers will be somewhat surprised that I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>On the question of helicopter or how I spent the weekend</h1><div class="post__text post__text-html js-mediator-article"><h3>  If you bought something, and there is no ‚ÄúMade in China‚Äù label on it, it means that you bought a fake. </h3><br><br>  My readers will be somewhat surprised that I decided not to praise my development, but where to go ... I recently bought in ‚ÄúFunny prices‚Äù (well, it's nee, now they are a serious organization and they are called ‚ÄúFix Price‚Äù) funny toy ‚ÄúFlying ball with light ¬ª, Numerous links on the Internet you will find yourself. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dg/uw/md/dguwmdlsd9tph6m6vrsjdvmslbm.jpeg"></div><br>  I played with her for about twenty minutes and overcame my desire to find out what's inside the device, resulting from two sources: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  I am an engineer and I wonder how such a toy works (or rather, I already guess how it works and I would like to check my guesses); </li><li>  I am an entrepreneur in the past and I wonder how the Chinese (I didn‚Äôt write that the toy was made in China, but it seems to be quite obvious) can do such things for very little money.  I completely forgot to say how much such a toy costs - I bought it for 199 rubles, less than three dollars, Karl. </li></ol><a name="habracut"></a><br>  Since I am one, and there are two sources of desire, I could not resist for a long time and crawled over a screwdriver. <br><br>  <b>ATTENTION:</b> since there is a (most likely lithium) battery in the toy that is not equipped with a protection card (I didn‚Äôt notice it), any manipulations that could lead to a short circuit or overcharge it are at your own risk.  The battery, of course, is small and we should not come to a catastrophe, but who knows.  In any case, safety glasses are highly recommended. <br><br><h4>  Superficial glance </h4><br>  We disassemble the body and in our hands we find the insides of the ‚Äúmiracle of technology‚Äù, so that we can observe the battery, the engine with the drive on the plastic gears, the axis (two pieces) with propellers and the mechanism for stabilizing the plane of rotation (well, I think that this is exactly what the propellers do) and, most importantly, the management fee for all this wealth.  On the board we see a chip with 8 legs (I guessed, there is an MK, but somehow the legs are not enough, not enough to control six LEDs), a chip with 5 legs (hmm) and a chip with 3 legs (I guessed it, the motor switch-on transistor) .  In addition, we have the discretes in the form of a power switch, an IR emitter, an IR receiver, a charging connector, 6 large and 1 small LEDs, as well as scattering - Conder and resistors. <br><br><h4>  Battery </h4><br>  I measure the voltage on the battery, the benefit of the wiring is available, and I observe 3.74V (probably lithium), I plug in the charging cable and the voltage rises to 4.18V (exactly lithium). <br><br>  It seems everything is clear, then the 5-foot chip is just a charger controller (something like 4054) and a small LED signals the charging process.  Then a charging current reference resistor must be connected to foot 5, measuring its nominal is 2k3, which corresponds to a current of 400 mA, a full charge (before the LED goes out) takes 15 minutes.  We calculate the battery capacity, we get 0.4A * 15min / (60min / h) = 100 mAh. <br><br>  Check the resulting capacity by the method of discharge, for which we measure the discharge current.  Since I don‚Äôt want to solder, I turn on the ammeter instead of the switch, shunting its contacts.  The LEDs (all six) caught fire, a current of 52 mA went, after 2 seconds the engine rotated the engine and the current ... fell and became 44 mA.  Some kind of garbage, not a measurement, cannot connect the motor to reduce the current, despite the fact that all the LEDs continue to work. <br><br><h4>  It does not happen, but there is </h4><br>  I measure the voltage on the battery and see that when the engine is running it drops from 4.1 V to 3.8 V. Yeah, the battery just has a large output resistance, which explains the decrease in current through the switch, and the motor current (judging by the drop, significant) goes around the ammeter .  And precisely, the positive wire of the engine is nailed to the battery plus, and in the negative there is a three-legged chip - a field effect transistor.  This solution eliminates the flow of significant motor current through the weak contacts of the switch, but leads to certain inconveniences, which will be discussed further.  Not including toys, I connect the ammeter between the drain and the source, the engine starts spinning, the starting current is 1.4 A, the steady state is 1.1 A. Then the battery capacity is 1.1A * 6min / (60min / hour) = 110mAh - it converges with the previously calculated one. <br><br>  The parameters of the motor are determined indirectly - 2.8V * 1.1A = 3W (anyone can convert to horsepower) - not bad for such a small crumb.  Why were there no such people when I went to a model aircraft club as a child?  During operation, the engine significantly heats up, but no more than 35-40 degrees.  It would be interesting to determine the type of engine, I can not think of anything except the collector one, but we will leave it for later, disassembling the engine will most likely be an irreversible procedure. <br><br>  A device with 3 legs and a figovina with 2 look out of the case from the board. Since the figovina is surrounded by a tube that forms a radiation pattern, it is an IR range sensor.  Then the device with 3 legs - the backlight LED, also IR.  We follow the tracks and find that the device is nailed to the ground and the leg of the MK, and the figoin is to the ground and power, which means we were mistaken.  Strange somehow, it is precisely when you put your finger on the tube that the engine speed rises, but, probably, this is a side flare. <br><br><h4>  The most interesting </h4><br>  Only one mysterious element remains - an 8-foot microcircuit, that is, from a functional point of view, there are no questions - this is engine control, but it is unclear at what exactly it is implemented.  What functions should it implement: <br><br><ol><li>  Initial delay ~ 2 seconds after power up; </li><li>  Change of rotational speed by controlling the transistor - PWM modulation with variable duty cycle; </li><li>  Reception of a signal from the sensor of presence of obstacles; </li><li>  Battery voltage monitoring to avoid overdischarge; </li><li>  (last, but not least) engine shutdown when blades hit an obstacle. </li></ol><br>  By the way, what kind of Chinese are great in terms of safety - there is engine protection, there is hand protection - soft plastic blades, design protection is - fastening of the blades with unfastening during mechanical overload.  Everything that could be invented for ease of use, invented, it remains only to envy the foresight of the developers (well, or to the rich experience of injuries and destruction, then you should not envy). <br><br>  It seems to have another function, but this is not accurate: <br><br>  6) adaptive correction of the control system, since right after launching the helicopter makes significant fluctuations in height, but over time their amplitude decreases and it begins to keep an almost stable distance to ground level.  If it is turned off and on again, the process is repeated, so this is not a consequence of the discharge of the battery. <br><br>  Let us return to the controlling element and estimate the possible implementations. <br><br><ol><li>  Each function, in principle, can be implemented on a timer type 555, but all at once on one case - I definitely can not, so it is unlikely. </li><li>  On a chip like the quad OU 324, you can probably implement all the functions at once, but there is clearly a different body. </li><li>  Custom or semi-custom analog chip in the device for $ 3 is not funny. </li><li>  But the MK will cope with all the tasks listed above, this is the basic version, the previous ones were called upon to demonstrate my broad technical outlook more quickly. </li></ol><br>  What resources will be required from the MC for the implementation of these functions: <br><br><ol><li>  Timer (preferably with PWM mode) to control the motor; </li><li>  A comparator (preferably ADC, but possible without it) for monitoring motor overload; </li><li>  Comparator (again, you can ADC) to control the IR sensor; </li><li>  A comparator (you can use BOD) to control power; </li><li>  4 or 3 free legs to connect the above; </li><li>  RAM - 8 registers will be enough, if you take another 16 cells, then more and do not think of why; </li><li>  Program memory - 1KB flash should be enough for everything and with a margin. </li></ol><br>  Probably, in our time it is more difficult to find an MC that does not have the listed resources than satisfies the stated requirements.  Based on the case, it could be STM8, PIC, Tiny, MSP430 and so on.  But I put on the relatively new MK Taiwanese company Padauk, which have all the necessary resources, but differ from the listed competitors at an incredible price - 3 cents in a batch of 300 pieces.  For our latitudes, these MKs seem to be exotic, but for manufacturers from a country located to the south - why not. <br><br>  The marking on the instrument case has been carefully removed, but we have indirect evidence.  The fact is that the MK of the specified company has a specific power layout - 1 and 8 legs (as it was at 555, which hints ...) as opposed to the classic 4 and 8, so we just need to ring the food chain.  Well, then make sure that all the necessary signals are also attached to the findings, which can be identified as general-purpose ports.  As for the interval timer, I got excited, his power supply pinout is inverse to MK, so a direct replacement is impossible, although I don‚Äôt understand why this is so. <br><br><h4>  Small quibbles and attacks </h4><br>  PNP: in the process of further study of the circuit, an unexpected (and even somewhat frightening) effect appeared - when searching (using a dial with an avometer) of the MK's leg connected to the gate of the motor control transistor, the latter suddenly started up - I would recommend my Chinese colleagues to reduce the nominal locking resistor between shutter and ground (now 27k) to eliminate such situations (if this is not part of the protection against reverse engineering). <br><br>  Well, one more note - even if the MC decides to stop the engine and goes into standby mode, the LEDs will continue to glow and will discharge the battery.  Of course, the current is not at all the same as during operation, but still significant (tens of milliamperes) and is quite capable of re-discharging the battery.  I managed to land the battery to 2.78 and the voltage continued to fall at a speed of weaving in 2 seconds. <br><br>  I would add another transistor to turn on the earth of the LEDs or put them directly on the legs of the MK, especially since three free ones remained. <br><br>  And here are the results of dialing (in brackets the leg function of the PMS15A type MK): <br><br><ol><li>  The infrared sensor is connected to foot 4 (); </li><li>  The gate of the transistor is connected to foot 6 (); </li><li>  The source of the transistor through a resistor is connected to foot 5 (). </li><li>  Earth and power are connected to feet 8 and 5, respectively. </li></ol><br>  We found no contradictions, so we can easily consider the MK identified with the Padauk PS15, it has 64 bytes of RAM, 0.5 kB of single program memory, an 8-bit PWM timer, comparator and BOD (here it is called LVR) at 2.7V (Since the engine is turned off during discharge, when the blue LED goes out, it is very similar).  Yes, it can be a PMS150C, but it has too much program memory, a whole kilobyte for such a simple task. <br><br>  Actually, on this the engineering side of curiosity is satisfied, you can draw a diagram of the device, but it‚Äôs lazy, and there‚Äôs no need - I‚Äôm not going to produce them anyway, and it will become clear after satisfying the claims of the business part.  Let's estimate what the equivalent stuffing will cost us, we mean only the electronic part, without a constructive part. <br><br><h4>  And do not count us, wealthy moles? </h4><br>  The battery is on Ali (I just don‚Äôt see any sense in domestic resources) there is something similar to our case, the capacity is somewhat higher (250 mAh) and provided with a protection board - worth 35+ rubles (hereinafter I will give prices in hard currency energy superpower, and not in the country‚Äôs unintelligible green notes, which will suffer a final collapse from minute to minute). <br><br>  The engine (oh, I completely forgot to disassemble it, but apart from the collector engine, no one adequately responds to voltage changes by PWM modulation, although I saw different opinions on this matter) - Ali (found in the note above) was found for 20+ rubles. <br><br>  Management fee: <br><br><ol><li>  4054 I decided to look at Platan and was somewhat surprised when its price was no higher than the prices for ChipFind.  I once got used to the fact that the price of the Plane should be divided by 2 and I am glad that I was mistaken.  Although the pricing policy of this supplier puzzles me a little: we can order the device for the price of 22 from 20 pieces, we can buy from the presence of 39 from 10 pieces, or buy from the presence of 40 from 86 pieces or wait 2 weeks for the purchase of 130 from 1. Of course , I do not have a company of such scale as Platan, but I can‚Äôt call a normal proposal like that.  Well, on Ali, it costs 200 rubles for 50 pieces.  The total cost of 22 (Platan) /2.5 (Ali). </li><li>  MK - probably the most inexpensive component - 2 rubles, I still can not believe this figure.  Although the cost of ownership will be somewhat higher - you need to add soldering costs, then it will still be more expensive than a transistor. </li><li>  IR emitter (TSAL6100) - 6/6. </li><li>  IR receiver (included in the set for 6 rubles) - / 3. </li><li>  the transistor 20V, 2A (n327) 5/4. </li><li>  6 bright LEDs in 3 colors (HL3010) 2 / 0.2 * 6 = 12 / 1.2. </li><li>  Resistors and capacitors size 0603 total 16 pieces 0.3 / 0.2 * 16 = 4.8 / 3.2. </li><li>  switch (3 / 0.4) / power connector (8/8) / and power cable / 8. </li><li>  printed circuit board area (DPP + M + 2Sh) 0.4dm * 0.2dm = 0.08 * 170 (Resonit) / = 13 /. </li><li>  mounting of the board 5 + 8 + 3 + 2 + 3 + 6 * 2 + 25 * 2 + 3 + 3 = 88 soldering points * 0.5 = 44. </li></ol><br>  Total we get 189/153 rubles (of course, the calculation cannot be called absolutely accurate, but I estimate the error at 30 percent) and the conclusion is disappointing - only electronics takes almost the entire selling price from us, but the whole structure, logistics, profit of the manufacturer, the seller‚Äôs profit and taxes, so the chances of making such a helicopter for such a price differ from zero by a negligible amount. <br><br>  And one last note: this ball is sold on Ali for 206 rubles with a remote control and shipped for 250 rubles, a similar product (slightly with a different body, in the form of a helicopter or a devil, not a ball) is sold in the same 350+ rubles that kind of weird.  In general, I was probably just lucky with the purchase, which is indirectly confirmed by the behavior of my spouse, who bought three more copies of this toy the next day ‚Äî one for each grandson and granddaughter, but she is not inclined to buy any garbage at inflated prices. <br><br>  The general conclusion from the above written will be somewhat unexpected: <br>  God bless China (and America at the same time). <br><br>  <b>PS I</b> enclose a photo, according to which I (unsuccessfully) tried to restore the scheme, may be useful: <br><br><img src="https://habrastorage.org/webt/if/ox/fq/ifoxfqa87vjjaufululldud8pqo.jpeg"></div><p>Source: <a href="https://habr.com/ru/post/454704/">https://habr.com/ru/post/454704/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454694/index.html">‚ÄúThick and thin‚Äù or how I mastered neural networks</a></li>
<li><a href="../454696/index.html">How to organize a hackathon as a student 101. Part one</a></li>
<li><a href="../454698/index.html">Acronis Design: Additional Designer Tools</a></li>
<li><a href="../4547/index.html">Fitzpatrick on Moscow Echo</a></li>
<li><a href="../454702/index.html">Zabbix: LLD-monitoring of SIM-cards Yeastar TG</a></li>
<li><a href="../454706/index.html">Presented by Polaris to keep Kubernetes clusters healthy</a></li>
<li><a href="../454708/index.html">Do I need a pillow astronauts?</a></li>
<li><a href="../454712/index.html">WWDC 2019: Highlights from the Keynote Robot Presentation</a></li>
<li><a href="../454714/index.html">We study MITER ATT & CK. Mobile Matrices: Device Access. Part 2</a></li>
<li><a href="../454716/index.html">Employees do not want a new software - go on about or bend your line?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>