<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Animated textures in opengl</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The use of textures in OpenGL is a fairly common topic on various training sites and forums. But the code needed to make an animated texture, everythi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Animated textures in opengl</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/e1c/471/81a/e1c47181ad724cf7af2fc08236e8ffe5.png" width="100" align="left">  The use of textures in OpenGL is a fairly common topic on various training sites and forums.  But the code needed to make an animated texture, everything becomes not so simple.  I know of 2 ways to do this and I will describe 1 of them. <br><a name="habracut"></a><br>  The problem is that the data transfer bus between the CPU and the GPU becomes an obstacle.  And for each frame to load a new texture into the video memory, it also becomes problematic in higher resolution. <br><br>  The first way is to use 2 intermediate <a href="http://www.songho.ca/opengl/gl_pbo.html">pixel buffers</a> : in one buffer it is rendered, and read from the other, and <a href="https://habrahabr.ru/post/228531/">DMA is</a> used for this purpose, which significantly speeds up the process. <br><br>  The second method is much simpler: use <a href="https://gamedevelopment.tutsplus.com/tutorials/an-introduction-to-spritesheet-animation--gamedev-13099">Spritesheet</a> .  This method was used in the first console consoles, and I will describe it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The idea is to place images of several frames on one texture, and in order to choose which frame you need to transfer only texture coordinates to the GPU.  To generate Sprite Sheet, <a href="http://www.piskelapp.com/">you can use this site</a> , or download on the Internet.  I downloaded this photo: <br><br><img src="https://habrastorage.org/files/a8a/e09/158/a8ae09158f1b4f3b86b155f61120012a.jpg"><br><br>  We proceed to the implementation.  To do this, you need to connect several third-party libraries. <br><br><ul><li>  <a href="http://glew.sourceforge.net/">glew</a> - actually OpenGL itself <br></li><li>  <a href="http://www.glfw.org/">glfw</a> - library for creating windows and <a href="http://www.glfw.org/">opengl</a> context <br></li><li>  <a href="http://freeimage.sourceforge.net/index.html">FreeImage</a> - a library for opening and decoding images <br></li></ul><br>  We load and render a square with a texture, there are many tutorials on how to do this, for example <a href="https://open.gl/textures">this one</a> .  For convenience, we will create a structure in which information on the number of rows and columns in the Sprite Sheet will be stored, as well as the current frame. <br><br><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpriteAnimator</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> currentFreme; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rows; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> columns; };</code> </pre> <br>  To use the animation you need to calculate and change the texture coordinates for each frame.  For this, the functions are used initSpriteAnimation - for initialization, and spriteAnimationNextFrame - for recalculation of texture coordinates on the following frame: <br><br><pre> <code class="hljs pgsql">SpriteAnimator initSpriteAnimation( <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>, <span class="hljs-type"><span class="hljs-type">float</span></span> * texCoord) { SpriteAnimator animator; animator.currentFreme = <span class="hljs-number"><span class="hljs-number">0</span></span>; animator.<span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>; animator.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>; spriteAnimationUpdate(animator, texCoord); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> animator; } <span class="hljs-type"><span class="hljs-type">void</span></span> spriteAnimationNextFrame(SpriteAnimator &amp; animator, <span class="hljs-type"><span class="hljs-type">float</span></span> * texCoord) { const <span class="hljs-type"><span class="hljs-type">int</span></span> maxFrame = animator.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> * animator.<span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (maxFrame == animator.currentFreme) { animator.currentFreme = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { animator.currentFreme++; } spriteAnimationUpdate(animator, texCoord); } <span class="hljs-type"><span class="hljs-type">void</span></span> spriteAnimationUpdate(SpriteAnimator &amp; animator, <span class="hljs-type"><span class="hljs-type">float</span></span> * texCoord) { const <span class="hljs-type"><span class="hljs-type">int</span></span> X = <span class="hljs-number"><span class="hljs-number">0</span></span>; const <span class="hljs-type"><span class="hljs-type">int</span></span> Y = <span class="hljs-number"><span class="hljs-number">1</span></span>; const <span class="hljs-type"><span class="hljs-type">int</span></span> V0 = <span class="hljs-number"><span class="hljs-number">0</span></span>; const <span class="hljs-type"><span class="hljs-type">int</span></span> V1 = <span class="hljs-number"><span class="hljs-number">2</span></span>; const <span class="hljs-type"><span class="hljs-type">int</span></span> V2 = <span class="hljs-number"><span class="hljs-number">4</span></span>; const <span class="hljs-type"><span class="hljs-type">int</span></span> V3 = <span class="hljs-number"><span class="hljs-number">6</span></span>; const <span class="hljs-type"><span class="hljs-type">float</span></span> frameWidth = <span class="hljs-number"><span class="hljs-number">1.</span></span>f / animator.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>; const <span class="hljs-type"><span class="hljs-type">float</span></span> frameHeight = <span class="hljs-number"><span class="hljs-number">1.</span></span>f / animator.<span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>; const <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> = animator.<span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> - animator.currentFreme / animator.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>; const <span class="hljs-type"><span class="hljs-type">int</span></span> col = animator.currentFreme % animator.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>; texCoord[V0 + X] = frameWidth * col; texCoord[V0 + Y] = frameHeight * <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>; texCoord[V1 + X] = frameWidth * (col + <span class="hljs-number"><span class="hljs-number">1</span></span>); texCoord[V1 + Y] = frameHeight * <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>; texCoord[V2 + X] = frameWidth * (col + <span class="hljs-number"><span class="hljs-number">1</span></span>); texCoord[V2 + Y] = frameHeight * (<span class="hljs-keyword"><span class="hljs-keyword">row</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>); texCoord[V3 + X] = frameWidth * col; texCoord[V3 + Y] = frameHeight * (<span class="hljs-keyword"><span class="hljs-keyword">row</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre><br>  And actually, the rendering cycle itself: <br><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!glfwWindowShouldClose(<span class="hljs-keyword"><span class="hljs-keyword">window</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">render</span></span>(shader); Sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span> / <span class="hljs-number"><span class="hljs-number">25</span></span>); spriteAnimationNextFrame(animator, texCoord); glfwSwapBuffers(<span class="hljs-keyword"><span class="hljs-keyword">window</span></span>); glfwPollEvents(); }</code> </pre><br>  The animation has a <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B0%25D0%25B4%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D1%258F_%25D1%2587%25D0%25B0%25D1%2581%25D1%2582%25D0%25BE%25D1%2582%25D0%25B0.">frame rate of</a> 25 frames per second, so a delay of 1/25 sec is used.  Not the best solution, but the simplest. <br><br>  The result is an animation like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/29f/5a2/c40/29f5a2c400f94e5391bae07039c563f6.gif"></div><br><div class="spoiler">  <b class="spoiler_title">Further example entirely:</b> <div class="spoiler_text"><pre> <code class="hljs go">#include &lt;chrono&gt; #include &lt;thread&gt; #include &lt;GL\glew.h&gt; #include &lt;GLFW\glfw3.h&gt; #include &lt;FreeImage.h&gt; #define Sleep(ms) std::this_thread::sleep_for(std::chrono::milliseconds(ms)); float position[] = {<span class="hljs-number"><span class="hljs-number">-1.f</span></span>, <span class="hljs-number"><span class="hljs-number">-1.f</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.f</span></span>, <span class="hljs-number"><span class="hljs-number">-1.f</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.f</span></span>, <span class="hljs-number"><span class="hljs-number">1.f</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1.f</span></span>, <span class="hljs-number"><span class="hljs-number">1.f</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}; float texCoord[] = { <span class="hljs-number"><span class="hljs-number">0.f</span></span>, <span class="hljs-number"><span class="hljs-number">0.f</span></span>, <span class="hljs-number"><span class="hljs-number">1.f</span></span>, <span class="hljs-number"><span class="hljs-number">0.f</span></span>, <span class="hljs-number"><span class="hljs-number">1.f</span></span>, <span class="hljs-number"><span class="hljs-number">1.f</span></span>, <span class="hljs-number"><span class="hljs-number">0.f</span></span>, <span class="hljs-number"><span class="hljs-number">1.f</span></span> }; GLuint indexes[] = { <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> char vertexShader[] = <span class="hljs-string"><span class="hljs-string">"attribute vec4 a_position;"</span></span> <span class="hljs-string"><span class="hljs-string">"attribute vec2 a_texCoord;"</span></span> <span class="hljs-string"><span class="hljs-string">"out vec2 v_texCoord;"</span></span> <span class="hljs-string"><span class="hljs-string">"void main(void) {"</span></span> <span class="hljs-string"><span class="hljs-string">" v_texCoord = a_texCoord;"</span></span> <span class="hljs-string"><span class="hljs-string">" gl_Position = a_position;"</span></span> <span class="hljs-string"><span class="hljs-string">"}"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> char fragmentShader[] = <span class="hljs-string"><span class="hljs-string">"uniform sampler2D text;"</span></span> <span class="hljs-string"><span class="hljs-string">"in vec2 v_texCoord;"</span></span> <span class="hljs-string"><span class="hljs-string">"void main (void) { "</span></span> <span class="hljs-string"><span class="hljs-string">" gl_FragColor = texture(text, v_texCoord);"</span></span> <span class="hljs-string"><span class="hljs-string">"}"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> Shader { GLuint program; GLuint position; GLuint texCoord; GLuint tex; }; <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> SpriteAnimator { unsigned <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> currentFreme; unsigned <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rows; unsigned <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> columns; }; GLuint loadTexture(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> char * path) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> w, h; GLuint tex; FIBITMAP *dib(<span class="hljs-number"><span class="hljs-number">0</span></span>); FREE_IMAGE_FORMAT fif = FreeImage_GetFileType(path, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fif == FIF_UNKNOWN) fif = FreeImage_GetFIFFromFilename(path); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fif == FIF_UNKNOWN) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (FreeImage_FIFSupportsReading(fif)) { dib = FreeImage_Load(fif, path); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!dib) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } w = FreeImage_GetWidth(dib); h = FreeImage_GetHeight(dib); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> char * data = (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> char *)FreeImage_GetBits(dib); glGenTextures(<span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;tex); glBindTexture(GL_TEXTURE_2D, tex); glTexImage2D(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">0</span></span>, GL_RGB, w, h, <span class="hljs-number"><span class="hljs-number">0</span></span>, GL_BGR, GL_UNSIGNED_BYTE, data); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR); glBindTexture(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tex; } Shader createShader() { Shader shader; GLint statusF, statusV; GLuint vertexShaderId = glCreateShader(GL_VERTEX_SHADER); GLuint fragmentShaderId = glCreateShader(GL_FRAGMENT_SHADER); char * srcPrt; srcPrt = (char *)vertexShader; glShaderSource(vertexShaderId, <span class="hljs-number"><span class="hljs-number">1</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GLchar **)&amp;srcPrt, NULL); srcPrt = (char *)fragmentShader; glShaderSource(fragmentShaderId , <span class="hljs-number"><span class="hljs-number">1</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GLchar **)&amp;srcPrt, NULL); glCompileShader(vertexShaderId); glCompileShader(fragmentShaderId); glGetShaderiv(vertexShaderId, GL_COMPILE_STATUS, &amp;statusV); glGetShaderiv(fragmentShaderId, GL_COMPILE_STATUS, &amp;statusF); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (statusV == GL_FALSE){ <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (statusF == GL_FALSE) { <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> } shader.program = glCreateProgram(); glAttachShader(shader.program, vertexShaderId); glAttachShader(shader.program, fragmentShaderId); glLinkProgram(shader.program); glUseProgram(shader.program); shader.position = glGetAttribLocation(shader.program, <span class="hljs-string"><span class="hljs-string">"a_position"</span></span>); shader.texCoord = glGetAttribLocation(shader.program, <span class="hljs-string"><span class="hljs-string">"a_texCoord"</span></span>); glEnableVertexAttribArray(shader.position); glEnableVertexAttribArray(shader.texCoord); shader.tex = loadTexture(<span class="hljs-string"><span class="hljs-string">"FireSpriteSheet.jpg"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> shader; } void render(Shader &amp; shader) { glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); glClearColor(<span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">1.</span></span>); glUseProgram(shader.program); glBindTexture(GL_TEXTURE_2D, shader.tex); glVertexAttribPointer(shader.position, <span class="hljs-number"><span class="hljs-number">3</span></span>, GL_FLOAT, GL_FALSE, <span class="hljs-number"><span class="hljs-number">3</span></span> * sizeof(float), position); glVertexAttribPointer(shader.texCoord, <span class="hljs-number"><span class="hljs-number">2</span></span>, GL_FLOAT, GL_FALSE, <span class="hljs-number"><span class="hljs-number">2</span></span> * sizeof(float), texCoord); glDrawElements(GL_TRIANGLES, sizeof(indexes) / sizeof(indexes[<span class="hljs-number"><span class="hljs-number">0</span></span>]), GL_UNSIGNED_INT, indexes); glBindTexture(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">0</span></span>); glUseProgram(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } void spriteAnimationUpdate(SpriteAnimator &amp; animator, float * texCoord); SpriteAnimator initSpriteAnimation( <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rows, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> columns, float * texCoord) { SpriteAnimator animator; animator.currentFreme = <span class="hljs-number"><span class="hljs-number">0</span></span>; animator.rows = rows; animator.columns = columns; spriteAnimationUpdate(animator, texCoord); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> animator; } void spriteAnimationNextFrame(SpriteAnimator &amp; animator, float * texCoord) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> maxFrame = animator.columns * animator.rows - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (maxFrame == animator.currentFreme) { animator.currentFreme = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { animator.currentFreme++; } spriteAnimationUpdate(animator, texCoord); } void spriteAnimationUpdate(SpriteAnimator &amp; animator, float * texCoord) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> X = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Y = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> V0 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> V1 = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> V2 = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> V3 = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float frameWidth = <span class="hljs-number"><span class="hljs-number">1.f</span></span> / animator.columns; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> float frameHeight = <span class="hljs-number"><span class="hljs-number">1.f</span></span> / animator.rows; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> row = animator.rows - animator.currentFreme / animator.columns; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> col = animator.currentFreme % animator.columns; texCoord[V0 + X] = frameWidth * col; texCoord[V0 + Y] = frameHeight * row; texCoord[V1 + X] = frameWidth * (col + <span class="hljs-number"><span class="hljs-number">1</span></span>); texCoord[V1 + Y] = frameHeight * row; texCoord[V2 + X] = frameWidth * (col + <span class="hljs-number"><span class="hljs-number">1</span></span>); texCoord[V2 + Y] = frameHeight * (row + <span class="hljs-number"><span class="hljs-number">1</span></span>); texCoord[V3 + X] = frameWidth * col; texCoord[V3 + Y] = frameHeight * (row + <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> main() { GLFWwindow* window; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!glfwInit()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; window = glfwCreateWindow(<span class="hljs-number"><span class="hljs-number">640</span></span>, <span class="hljs-number"><span class="hljs-number">480</span></span>, <span class="hljs-string"><span class="hljs-string">"Simple animated texture with OpenGL"</span></span>, NULL, NULL); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!window) { glfwTerminate(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } glfwMakeContextCurrent(window); glewInit(); Shader shader = createShader(); SpriteAnimator animator = initSpriteAnimation(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, texCoord); while (!glfwWindowShouldClose(window)) { render(shader); Sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span> / <span class="hljs-number"><span class="hljs-number">25</span></span>); <span class="hljs-comment"><span class="hljs-comment">//Sleep(1000); spriteAnimationNextFrame(animator, texCoord); glfwSwapBuffers(window); glfwPollEvents(); } glfwDestroyWindow(window); glfwTerminate(); return 0; }</span></span></code> </pre><br></div></div><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/311346/">https://habr.com/ru/post/311346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311336/index.html">8 tips on lead generation from Khalisi</a></li>
<li><a href="../311338/index.html">Mobile trade on the example of Mobi-S</a></li>
<li><a href="../311340/index.html">Neuromarketing: how brain research helps brands sell</a></li>
<li><a href="../311342/index.html">SAP F & R: Order Creation Process. Part 2</a></li>
<li><a href="../311344/index.html">‚ÄúThe best performance is a story about a painful struggle and victory over evil‚Äù, - Vladimir Krasilshchik about technical reports</a></li>
<li><a href="../311348/index.html">Data Science Week 2016. Review of the third and fourth day</a></li>
<li><a href="../311350/index.html">How to create a theme for Magento 2 from scratch</a></li>
<li><a href="../311352/index.html">New PostgreSQL 9.6 Release: Postgres Professional Contributions</a></li>
<li><a href="../311354/index.html">About degrees of freedom in statistics</a></li>
<li><a href="../311366/index.html">Will the formal verification of a microkernel code allow creating super-reliable OS?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>