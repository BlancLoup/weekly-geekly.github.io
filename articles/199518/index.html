<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We load SNMP monitoring data into Oracle</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago, I wrote an article on optimizing data loading in an Oracle database. Judging by the abundance of comments that followed, the article ar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We load SNMP monitoring data into Oracle</h1><div class="post__text post__text-html js-mediator-article">  Some time ago, I wrote <a href="http://habrahabr.ru/post/196828">an article</a> on optimizing data loading in an Oracle database.  Judging by the abundance of comments that followed, the article aroused a keen interest, but judging by the same comments (as well as the subsequent <a href="http://habrahabr.ru/post/197718">article</a> about loading data into PostgreSQL), it was not understood by many in the way I had hoped for.  For the most part, I myself am to blame for this, since, in the process of simplifying the presentation of the material, I lost my temper so much that the task was no longer understandable to others (this, in turn, had a negative impact on understanding the reasons for choosing the methods used to solve it). <br><br>  Today, I want to correct the mistakes made.  I will talk about the real task of processing SNMP monitoring data, paying maximum attention to technical details.  I will try to justify the choice of approaches for its solution and compare their performance.  Also, I will pay attention to those technical issues that may cause difficulties for beginners.  Before <a href="https://habrahabr.ru/users/denkrep/" class="user_link">proceeding</a> further, I want to express my gratitude to <a href="https://habrahabr.ru/users/denkrep/" class="user_link">DenKrep</a> , <a href="https://habrahabr.ru/users/xlix123/" class="user_link">xlix123</a> , <a href="https://habrahabr.ru/users/zhekappp/" class="user_link">zhekappp</a> and all the other comrades who gave an incredible amount of useful advice, during the discussion of the previous article. <br><a name="habracut"></a><br><h4>  What is all this for? </h4><br>  I want to say at once that I am not at all interested in such questions as: <br><br><ol><li>  What is the maximum speed you can load data into Oracle? </li><li>  What is faster than Oracle or PostgreSQL? </li><li>  How fast can I insert into the database table? </li></ol><br>  For the most part, these questions, and similar ones, do not make sense (at least apart from the details of the hardware configuration).  I absolutely deliberately do not say a word about the hardware on my Oracle server.  In my opinion, it does not matter.  But what then is important? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It is important that there is a real task, for example, collecting SNMP monitoring data, during the execution of which, a large amount of data is constantly generated that needs to be processed.  In this case, the following points are significant: <br><br><ol><li>  It is not enough just to insert data into a table (how exactly the data should be processed and why, I will tell in the next section) </li><li>  Data is not generated on the database server (most likely there will be several data collection servers transferring data to a single database) </li><li>  The data is constantly being received and must also be constantly processed, it is desirable to minimize the data processing time (to ensure the minimum response time to the occurrence of any emergency situation) </li><li>  The loss of a part of the data is allowed (if a failure occurs, we will find it on the next survey cycle, even if some of the current data is lost) </li><li>  The history of changes in the basic parameters should be maintained for a long time. </li></ol><br>  I consider various options for solving this problem and compare their performance.  Of course, the goal is to find the most productive solution. <br><br><h4>  Formulation of the problem </h4><br>  For a start, let's recall exactly what data we get using SNMP?  In fact, we can get the values ‚Äã‚Äãof some predefined variables by requesting the OID we are interested in using a GET request.  For example, by requesting OID = 1.3.6.1.2.1.1.3.0, we can get the value of such an important for monitoring value as <a href="http://tools.cisco.com/Support/SNMP/do/BrowseOID.do%3Flocal%3Den%26translate%3DTranslate%26objectInput%3DsysUpTime">sysUpTime</a> .  The values ‚Äã‚Äãof variables accessed via SNMP are not necessarily numeric.  These may be strings. <br><br>  But SNMP is not limited to access to a set of scalar variables.  Variable values ‚Äã‚Äãcan be grouped into tables.  In each row of the table, the values ‚Äã‚Äãof variables associated with a particular resource are grouped.  To access each value, it is necessary to supplement the OID assigned to the table column with some identifier that defines the resource description string.  This row identifier will be called the resource index. <br><br>  In the case of polling the list of interfaces (1.3.6.1.2.1.2), the resource identifier is an integer, but, for other tables, this can be an IP address or something else defined by the <a href="http://www.ietf.org/rfc/rfc1157.txt">specification</a> .  The difficulty lies in the fact that we do not know the index of the polled resource in advance and we can not get the value of the variable of interest using a GET request. <br><br>  To read values ‚Äã‚Äãin tables, you need to use GETNEXT queries that return the OID and the value of the variable following in lexicographical order after the OID specified in the query.  So passing the OID column, which is the OID prefix of the variable of interest, we get the corresponding value from the first row of the table.  To get the value of the next line, we send the OID received in response to the first request, and so on, until the table has been completely reviewed. <br><br>  In order to optimize performance (by reducing the number of requests sent), we can send several column OIDs in one request.  In addition, in version 2 of SNMP, the ability to form BULK requests was added.  One BULK query replaces several GETNEXT queries executed one after the other, which allows you to read the entire table in one query (with a sufficient BULK value).  I already told about all this <a href="http://habrahabr.ru/post/196308/">earlier</a> . <br><br>  I repeat all this in order to make it clear - the tables are not constant!  The description (for example, somewhere in the database) of the interface table manually, with assigning OIDs to it, is completely meaningless.  Rows of tables can be added and deleted when the hardware is reconfigured.  Moreover, the index of some existing interface may change!  In fact, one of the tasks of the SNMP monitoring system is to automate the tracking of all changes to the tables being viewed. <br><br>  What will it look like in the database?  Pretty simple: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/963/e2f/ab2/963e2fab2084f880bd59f0de127703ae.png" alt="image"><br><br>  The data obtained in the monitoring process, we will bind to resources (ae_resource).  Resources, in turn, will be linked into a two-level hierarchy.  At the top level, the device resource will be presented.  With it, by owner_id, child resources will be associated, for example, interfaces (the fact that these are interfaces, and not something else, will be determined by the type_id value from the ae_resource_type directory).  The device_id values ‚Äã‚Äãfor the parent and all child resources will be the same and point to the hardware description. <br><br>  You may notice that the ae_resource table has the start_date and end_date fields.  Keeping them up to date is our task.  We need to create new resources, as necessary, by putting them the start date of the action in start_date and complete the action of obsolete resources by setting end_date.  To identify resources, the name field will be used (in the case of interfaces, this value of the ifDescr attribute is 1.3.6.1.2.1.2.2.1.2).  We will save the resource index in the res_num field (if it is changed, the resource with the old index value should be closed, after which a new resource should be created). <br><br>  The need to keep the list of interfaces up-to-date is the main reason why the data will have to be processed (although the usual insertion of the received data into the table would take much less time).  But if we still process the data, why not get the maximum benefit from it?  In the process of monitoring, we get a lot of data, some of which do not change or change slightly.  We can reduce the amount of data stored in the database (which will have a beneficial effect on both its volume and performance), if it saves only significant changes.  But how to determine which changes are meaningful?  Politicians will help us with this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/576/b68/cde/576b68cde0cefb6c074a6e0bee13787f.png" alt="image"><br><br>  The value of each parameter we receive will be associated with some domain (ae_domain).  A regular expression (regexp) will help validate the correctness of a value.  Before saving to the database, the value can be converted to some other domain (for example, we get strings in hexadecimal representation, which would be a good idea to convert to a more familiar form).  The conversion rules will be determined by the ae_domain_convert table. <br><br>  What changes will be considered significant?  It depends on the domain.  By default, any change in value will be considered significant (that is, if the value has not changed, the database will not be written to).  For some parameters, it makes sense to set special rules.  For example, sysUpTime (after an appropriate conversion) is a monotonically increasing numeric value.  Decreasing this value means that the host has rebooted.  Setting a specific policy for this domain will allow us to write to the database only decrease value events (meaning reload), while not the received value, but the previous value (that is, the maximum achieved uptime) will be written to the database. <br><br>  In ae_threshold we will set the thresholds, the intersection of which (in a given direction) will be considered as a significant change.  Additionally, we introduce a special type of threshold (delta), which determines the absolute value of the difference between the previous and the obtained value.  Setting such a threshold can be convenient, for example, for traffic counters, such as ifInOctets (1.3.6.1.2.1.2.2.1.10). <br><br>  Entirely, the data scheme will look as follows: <br><br><div class="spoiler">  <b class="spoiler_title">Data schema</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/408/add/251/408add251b7ae333504c5a0f8f550678.png" alt="image"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Script</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_platform_model_seq <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_platform_model ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_platform_model <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">' '</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_platform_model_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_platform_model(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_platform_model <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_platform_model primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_device_seq <span class="hljs-keyword"><span class="hljs-keyword">cache</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_device ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, model_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, start_date <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sysdate</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, end_date <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_device <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_device_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_device(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_device_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_device(device_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_device_model_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_device(model_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_device_zone_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_device(zone_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_device <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_device primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_device <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_device_model <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (model_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_platform_model(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_resource_class_seq <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource_class ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, owner_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, is_logical <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource_class <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">' '</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> ae_resource_class.is_logical <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">'  '</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_resource_class_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_resource_class(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_resource_class_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_resource_class(owner_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource_class <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> ae_resource_class_ck <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> (is_logical <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource_class <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_resource_class primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_resource_type_seq <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource_type ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, owner_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, parent_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, class_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource_type <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">' '</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_resource_type_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_resource_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_resource_type_owner_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_resource_type(owner_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_resource_type_parent_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_resource_type(parent_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource_type <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_resource_type primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource_type <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_resource_type <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (class_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_resource_class(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource_type <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_resource_type_owner <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (owner_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_resource_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource_type <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_resource_type_parent <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (parent_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_resource_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_resource_seq <span class="hljs-keyword"><span class="hljs-keyword">cache</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, device_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, owner_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, type_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, res_num varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, res_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, tmp_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, start_date <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sysdate</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, end_date <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_resource_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_resource(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_res_dev_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_resource(device_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_res_dev_type_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_resource(type_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_res_dev_res_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_resource(res_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_res_dev_res_tmp_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_resource(tmp_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_resource primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_res_device <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (device_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_device(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_res_dev_parent <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (owner_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_resource(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_resource <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_res_dev_type <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (type_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_resource_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_policy_type ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_policy_type <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">'  '</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_policy_type_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_policy_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_policy_type_uk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_policy_type(<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_policy_type <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_policy_type primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state_policy ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, type_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state_policy <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">'  '</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_state_policy_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_state_policy(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_state_policy_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_state_policy(type_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state_policy <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_state_policy primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state_policy <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_state_policy <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (type_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_policy_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_threshold_type ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_threshold_type_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_threshold_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_threshold_type <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_threshold_type primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_threshold_seq <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_threshold ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, type_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, policy_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_threshold_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_threshold(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_threshold_direction_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_threshold(type_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_threshold_profile_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_threshold(policy_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_threshold <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_threshold primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_threshold <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_threshold_type <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (type_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_threshold_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_threshold <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_threshold_policy <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (policy_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_state_policy(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_domain_convert_seq <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_domain ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, policy_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, regexp varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span>), is_case_sens <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_domain_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_domain(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_domain_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_domain(policy_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_domain <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> ae_domain_ck <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> (is_case_sens <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_domain <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_domain primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_domain <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_domain <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (policy_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_state_policy(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_parameter_seq <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_parameter ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, domain_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, parent_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_parameter_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_parameter(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_parameter_uk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_parameter(<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_parameter_domain_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_parameter(domain_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_parameter_parent_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_parameter(parent_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_parameter <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_parameter primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_parameter <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_parameter_domain <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (domain_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_domain(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_parameter <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_parameter <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (parent_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_parameter(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_state_seq <span class="hljs-keyword"><span class="hljs-keyword">cache</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, res_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, param_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>), datetime <span class="hljs-built_in"><span class="hljs-built_in">timestamp</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current_timestamp</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">' '</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> ae_state.datetime <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">'    '</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_state_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_state(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_state_res_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_state(res_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_state_param_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_state(param_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_state primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_state_res <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (res_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_resource(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_state_param <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (param_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_parameter(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_state_log_seq <span class="hljs-keyword"><span class="hljs-keyword">cache</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state_log ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, res_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, param_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>), datetime <span class="hljs-built_in"><span class="hljs-built_in">timestamp</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current_timestamp</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) pctfree <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> (datetime) ( <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> ae_state_log_p1 <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">less</span></span> <span class="hljs-keyword"><span class="hljs-keyword">than</span></span> (maxvalue) ); <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state_log <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">'   '</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_state_log_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_state_log(datetime, <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state_log <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_state_log primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(datetime, <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_profile_type_seq; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile_type ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_type_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_type_uk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile_type(<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile_type <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_profile_type primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_profile_seq; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, type_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, is_default <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, model_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, script_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_type_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile(type_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_model_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile(model_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_script_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile(script_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> ae_profile_ck <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> (is_default <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_profile primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_profile_type <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (type_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_profile_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> ae_profile_detail_seq; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile_detail ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, type_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, profile_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, model_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, param_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unique</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_detail_pk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile_detail(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_detail_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile_detail(profile_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_detail_type_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile_detail(type_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_detail_model_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile_detail(model_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_profile_detail_param_fk <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_profile_detail(param_id); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile_detail <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> pk_ae_profile_detail primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile_detail <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_profile_detail <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (profile_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_profile(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile_detail <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_profile_detail_type <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (type_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_resource_type(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_profile_detail <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> fk_ae_profile_detail_model <span class="hljs-keyword"><span class="hljs-keyword">foreign</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (model_id) <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> ae_platform_model(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> <span class="hljs-keyword"><span class="hljs-keyword">temporary</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ae_state_tmp ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, device_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, profile_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, param_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">num</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>), datetime <span class="hljs-built_in"><span class="hljs-built_in">timestamp</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current_timestamp</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">commit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ae_state_tmp_ix <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ae_state_tmp(device_id, profile_id, param_id, <span class="hljs-keyword"><span class="hljs-keyword">num</span></span>);</code> </pre> <br></div></div><br>  Now it remains to fill out the reference data: <br><br><div class="spoiler">  <b class="spoiler_title">Test data</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_POLICY_TYPE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_POLICY_TYPE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'uptime'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_POLICY_TYPE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">'threshold'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_STATE_POLICY (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION, TYPE_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_STATE_POLICY (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION, TYPE_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'uptime'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_DOMAIN (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, REGEXP, IS_CASE_SENS, DESCRIPTION, POLICY_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">'((\d+)\D*,\s*)?(\d+):(\d+):(\d+)(\.\d+)?'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'SNMP uptime'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_DOMAIN (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, REGEXP, IS_CASE_SENS, DESCRIPTION, POLICY_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-string"><span class="hljs-string">'\d+'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'SNMP '</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_DOMAIN (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, REGEXP, IS_CASE_SENS, DESCRIPTION, POLICY_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-string"><span class="hljs-string">'([a-fA-F\d])+'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'SNMP '</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_DOMAIN (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, REGEXP, IS_CASE_SENS, DESCRIPTION, POLICY_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-string"><span class="hljs-string">'.*'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'SNMP  '</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_DOMAIN (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, REGEXP, IS_CASE_SENS, DESCRIPTION, POLICY_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-string"><span class="hljs-string">'\d+'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'SNMP uptime ( )'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PARAMETER (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, DOMAIN_ID, PARENT_ID, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">101</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">'uptime'</span></span>, <span class="hljs-string"><span class="hljs-string">'SNMP Uptime'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PARAMETER (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, DOMAIN_ID, PARENT_ID, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">102</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">'ifIndex'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PARAMETER (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, DOMAIN_ID, PARENT_ID, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">103</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">'ifName'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PARAMETER (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, DOMAIN_ID, PARENT_ID, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">104</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">'ifInOctets'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PARAMETER (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, DOMAIN_ID, PARENT_ID, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">105</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">'ifOutOctets'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PLATFORM_MODEL (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'test'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PROFILE_TYPE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'mon'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PROFILE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, TYPE_ID, IS_DEFAULT, MODEL_ID, SCRIPT_ID, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">'test'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_RESOURCE_CLASS (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, IS_LOGICAL, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION, OWNER_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_RESOURCE_CLASS (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, IS_LOGICAL, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION, OWNER_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_RESOURCE_TYPE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, CLASS_ID, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION, OWNER_ID, PARENT_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'Host'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_RESOURCE_TYPE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, CLASS_ID, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION, OWNER_ID, PARENT_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'Interface'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PROFILE_DETAIL (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, TYPE_ID, PROFILE_ID, MODEL_ID, PARAM_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">104</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PROFILE_DETAIL (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, TYPE_ID, PROFILE_ID, MODEL_ID, PARAM_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">105</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PROFILE_DETAIL (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, TYPE_ID, PROFILE_ID, MODEL_ID, PARAM_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PROFILE_DETAIL (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, TYPE_ID, PROFILE_ID, MODEL_ID, PARAM_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">101</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PROFILE_DETAIL (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, TYPE_ID, PROFILE_ID, MODEL_ID, PARAM_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">102</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_PROFILE_DETAIL (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, TYPE_ID, PROFILE_ID, MODEL_ID, PARAM_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">103</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_DEVICE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, MODEL_ID, START_DATE, END_DATE) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">TO_DATE</span></span>(<span class="hljs-string"><span class="hljs-string">'10/30/2013 15:37:16'</span></span>, <span class="hljs-string"><span class="hljs-string">'MM/DD/YYYY HH24:MI:SS'</span></span>), <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_RESOURCE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, DEVICE_ID, OWNER_ID, TYPE_ID, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, RES_NUM, RES_ID, START_DATE, END_DATE, TMP_ID) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'127.0.0.1'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">TO_DATE</span></span>(<span class="hljs-string"><span class="hljs-string">'10/30/2013 15:24:44'</span></span>, <span class="hljs-string"><span class="hljs-string">'MM/DD/YYYY HH24:MI:SS'</span></span>), <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_THRESHOLD_TYPE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'increase'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_THRESHOLD_TYPE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'decrease'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_THRESHOLD_TYPE (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>, DESCRIPTION) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">'delta'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> AE_THRESHOLD (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>, TYPE_ID, POLICY_ID, <span class="hljs-keyword"><span class="hljs-keyword">VALUE</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'100'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br></div></div><br>  And prepare the preparation of the test code: <br><br><div class="spoiler">  <b class="spoiler_title">Test code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.acme.ae.tests.jdbc; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> oracle.jdbc.driver.OracleCallableStatement; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> oracle.sql.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.CallableStatement; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.Connection; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.DriverManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.SQLException; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String CLASS_NAME = <span class="hljs-string"><span class="hljs-string">"oracle.jdbc.driver.OracleDriver"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String USER_CONN = <span class="hljs-string"><span class="hljs-string">"jdbc:oracle:thin:@192.168.124.5:1523:new11"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String USER_NAME = <span class="hljs-string"><span class="hljs-string">"ais"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String USER_PASS = <span class="hljs-string"><span class="hljs-string">"ais"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> AUTO_COMMIT_MODE = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> BULK_SIZE = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ALL_SIZE = <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String TRACE_ON_SQL = <span class="hljs-string"><span class="hljs-string">"ALTER SESSION SET EVENTS '10046 trace name context forever, level 12'"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Long DEVICE_ID = <span class="hljs-number"><span class="hljs-number">0L</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Long PROFILE_ID = <span class="hljs-number"><span class="hljs-number">1L</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Long UPTIME_PARAM_ID = <span class="hljs-number"><span class="hljs-number">101L</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Long IFNAME_PARAM_ID = <span class="hljs-number"><span class="hljs-number">103L</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Long INOCT_PARAM_ID = <span class="hljs-number"><span class="hljs-number">104L</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String FAKE_NUM_VALUE = <span class="hljs-string"><span class="hljs-string">"0"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Connection c = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> ClassNotFoundException, SQLException </span></span>{ Class.forName(CLASS_NAME); c = DriverManager.getConnection(USER_CONN, USER_NAME, USER_PASS); c.setAutoCommit(AUTO_COMMIT_MODE); CallableStatement st = c.prepareCall(TRACE_ON_SQL); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { st.execute(); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { st.close(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { c.close(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ Test t = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Test(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { t.start(); t.test_plsql(); <span class="hljs-comment"><span class="hljs-comment">//      } finally { t.stop(); } } catch (Exception e) { System.out.println(e.toString()); } } }</span></span></code> </pre><br></div></div><br>  For a detailed analysis of performance, we will use event 10046 tracing on the server, with subsequent processing of the tkprof utility. <br><br><h4>  The slowest way (plsql) </h4><br>  We will start testing with the most obvious one-by-one processing.  In addition to the actual performance evaluation, writing this code will help us better understand how the data will be processed. <br><br><div class="spoiler">  <b class="spoiler_title">PL / SQL code</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> AIS.ae_monitoring <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> addValue( p_device <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> , p_profile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> , p_param <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> , p_num <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> varchar2 , p_val <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> varchar2 ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> ae_monitoring; / <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> <span class="hljs-keyword"><span class="hljs-keyword">body</span></span> AIS.ae_monitoring <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> g_ifName_parameter <span class="hljs-keyword"><span class="hljs-keyword">constant</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">103</span></span>; g_default_policy constant number default 1; g_uptime_policy constant number default 2; g_threshold_policy constant number default 3; g_increase_type constant number default 1; g_decrease_type constant number default 2; g_delta_type constant number default 3; procedure addValue( p_device in number , p_profile in number , p_param in number , p_num in varchar2 , p_val in varchar2 ) as cursor c_res(p_type number) is <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> r.id, r.name <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ae_resource r <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> r.device_id = p_device <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r.res_num = p_num <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r.type_id = p_type <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r.start_date &lt;= <span class="hljs-keyword"><span class="hljs-keyword">sysdate</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sysdate</span></span> &lt;= nvl(r.end_date, <span class="hljs-keyword"><span class="hljs-keyword">sysdate</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>); cursor c_state(p_resid number) is <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.value <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ae_state s <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> s.res_id = p_resid <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> s.param_id = p_param; l_resid ae_resource.id%type default null; l_resname ae_resource.name%type default null; l_oldval ae_state.value%type default null; l_restype ae_profile_detail.type_id%type default null; l_owntype ae_resource_type.owner_id%type default null; l_owner ae_resource.id%type default null; l_policy ae_state_policy.type_id%type default null; l_polid ae_state_policy.id%type default null; l_count number default 0; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-comment"><span class="hljs-comment">--    select d.type_id, r.owner_id into l_restype, l_owntype from ae_profile_detail d inner join ae_resource_type r on (r.id = d.type_id) where d.profile_id = p_profile and d.param_id = p_param; --  ID  if not l_owntype is null then select r.id into l_owner from ae_resource r where r.device_id = p_device and r.type_id = l_owntype; end if; --    if p_param = g_ifName_parameter then open c_res(l_restype); fetch c_res into l_resid, l_resname; if c_res%notfound or l_resname &lt;&gt; p_val then --     update ae_resource set end_date = sysdate where id = l_resid; --     insert into ae_resource(id, device_id, owner_id, type_id, res_num, name) values (ae_resource_seq.nextval, p_device, l_owner, l_restype, p_num, p_val); end if; close c_res; return; end if; --  ID  open c_res(l_restype); fetch c_res into l_resid, l_resname; if c_res%notfound then --    ,     insert into ae_resource(id, device_id, owner_id, type_id, res_num, name) values (ae_resource_seq.nextval, p_device, l_owner, l_restype, p_num, p_val) returning id into l_resid; end if; --     open c_state(l_resid); fetch c_state into l_oldval; if c_state%notfound then l_oldval := null; end if; close c_state; --     select l.type_id, l.id into l_policy, l_polid from ae_parameter p inner join ae_domain d on (d.id = p.domain_id) inner join ae_state_policy l on (l.id = d.policy_id) where p.id = p_param; --     select count(*) into l_count from ae_threshold t where t.policy_id = l_polid and (( t.type_id = g_increase_type and l_oldval &lt;= t.value and p_val &gt;= t.value ) or ( t.type_id = g_decrease_type and l_oldval &gt;= t.value and p_val &lt;= t.value ) or ( t.type_id = g_delta_type and abs(p_val - l_oldval) &gt;= t.value )); --    ae_state_log     if l_oldval is null or l_count &gt; 0 or ( l_policy = g_uptime_policy and p_val &lt; l_oldval) or ( l_policy = g_default_policy and p_val &lt;&gt; l_oldval) then insert into ae_state_log(id, res_id, param_id, value) values (ae_state_log_seq.nextval, l_resid, p_param, decode(l_policy, g_uptime_policy, nvl(l_oldval, p_val), p_val)); end if; --  ae_state update ae_state set value = p_val , datetime = current_timestamp where res_id = l_resid and param_id = p_param; if sql%rowcount = 0 then insert into ae_state(id, param_id, res_id, value) values (ae_state_seq.nextval, p_param, l_resid, p_val); end if; close c_res; exception when others then if c_res%isopen then close c_res; end if; if c_state%isopen then close c_state; end if; raise; end; end ae_monitoring; /</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Java code</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String ADD_VAL_SQL = <span class="hljs-string"><span class="hljs-string">"begin ae_monitoring.addValue(?,?,?,?,?); end;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_plsql</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"test_plsql:"</span></span>); CallableStatement st = c.prepareCall(ADD_VAL_SQL); Long timestamp = System.currentTimeMillis(); Long uptime = <span class="hljs-number"><span class="hljs-number">0L</span></span>; Long inoct = <span class="hljs-number"><span class="hljs-number">0L</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= ALL_SIZE; i++) { <span class="hljs-comment"><span class="hljs-comment">//  uptime st.setLong(1, DEVICE_ID); st.setLong(2, PROFILE_ID); st.setLong(3, UPTIME_PARAM_ID); st.setString(4, FAKE_NUM_VALUE); st.setString(5, uptime.toString()); st.execute(); //    st.setLong(1, DEVICE_ID); st.setLong(2, PROFILE_ID); st.setLong(3, IFNAME_PARAM_ID); st.setString(4, Integer.toString((i % 100) + 1)); st.setString(5, Integer.toString((i % 100) + 1)); st.execute(); //    st.setLong(1, DEVICE_ID); st.setLong(2, PROFILE_ID); st.setLong(3, INOCT_PARAM_ID); st.setString(4, Integer.toString((i % 100) + 1)); st.setString(5, inoct.toString()); st.execute(); //   uptime += 100L; if (uptime &gt;= 1000) { uptime = 0L; } inoct += 10L; } } finally { st.close(); } Long delta_1 = System.currentTimeMillis() - timestamp; System.out.println((ALL_SIZE * 1000L) / delta_1); timestamp = System.currentTimeMillis(); c.commit(); Long delta_2 = System.currentTimeMillis() - timestamp; System.out.println(delta_2); System.out.println((ALL_SIZE * 1000L) / (delta_1 - delta_2)); }</span></span></code> </pre><br></div></div><br>  Obviously, for correct support of this interface list code, it is necessary that the interface name is transferred to the database before the other attributes of the resource. <br><br>  Test results are quite predictable: <br><br><div class="spoiler">  <b class="spoiler_title">results</b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">OVERALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TOTALS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FOR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">NON-RECURSIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATEMENTS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">count</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">current</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Parse</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Execute</span></span> 3000 4<span class="hljs-selector-class"><span class="hljs-selector-class">.23</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.13</span></span> 7 102942 6615 3000 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fetch</span></span> 0 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span> 3001 4<span class="hljs-selector-class"><span class="hljs-selector-class">.23</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.13</span></span> 7 102942 6615 3000 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">parse</span></span>: 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">execute</span></span>: 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waiting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">following</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">events</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Event</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Max</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wait</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">to</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 3002 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">from</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 3002 5<span class="hljs-selector-class"><span class="hljs-selector-class">.92</span></span> 7<span class="hljs-selector-class"><span class="hljs-selector-class">.12</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">latch</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">log</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">file</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sync</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">OVERALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TOTALS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FOR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">RECURSIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATEMENTS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">count</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">current</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Parse</span></span> 69 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Execute</span></span> 17261 2<span class="hljs-selector-class"><span class="hljs-selector-class">.42</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.36</span></span> 7 9042 6615 3160 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fetch</span></span> 14000 0<span class="hljs-selector-class"><span class="hljs-selector-class">.38</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.37</span></span> 0 93900 0 13899 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span> 31330 2<span class="hljs-selector-class"><span class="hljs-selector-class">.81</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.74</span></span> 7 102942 6615 17059 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">parse</span></span>: 10 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">execute</span></span>: 10 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waiting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">following</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">events</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Event</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Max</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wait</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">db</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">file</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sequential</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">read</span></span> 7 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span></code> </pre><br></div></div><br>  We perform a very large number of requests and spend a lot of time on networking. <br><br><h4>  We use mass processing (temporary) </h4><br>  The most radical way to deal with overhead is to move to mass processing.  We can pre-save a set of data for processing in a table, and then process the data not one record at a time, but all at once.  Of course, for intermediate data storage, you can use regular tables, but using <a href="http://www.oracle-base.com/articles/misc/temporary-tables.php">GTT</a> for this purpose is more profitable, due to lower journaling overhead. <br><br>  To insert data into a temporary table, we will use DML, rather than stored procedure calls, which will allow us to use <a href="http://www.tutorialspoint.com/jdbc/jdbc-batch-processing.htm">JDBC batch</a> to reduce network overhead. <br><br>  When using this approach, it is not required that the interface name is processed before the rest of its parameters.  It is enough that the names of all the interfaces being processed are present in the data set being processed. <br><br><div class="spoiler">  <b class="spoiler_title">PL / SQL code</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> AIS.ae_monitoring <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> saveValues; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> ae_monitoring; / <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> <span class="hljs-keyword"><span class="hljs-keyword">body</span></span> AIS.ae_monitoring <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> g_ifName_parameter <span class="hljs-keyword"><span class="hljs-keyword">constant</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">103</span></span>; g_default_policy constant number default 1; g_uptime_policy constant number default 2; g_threshold_policy constant number default 3; g_increase_type constant number default 1; g_decrease_type constant number default 2; g_delta_type constant number default 3; procedure saveValues as <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-comment"><span class="hljs-comment">--  ,    merge into ae_resource d using ( select t.id, t.device_id, t.num, t.value name, p.type_id, o.id owner_id from ae_state_tmp t inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource_type r on (r.id = p.type_id) left join ae_resource o on (o.device_id = t.device_id and o.type_id = r.owner_id) where t.param_id = g_ifName_parameter ) s on ( d.device_id = s.device_id and d.res_num = s.num and d.type_id = s.type_id and d.start_date &lt;= sysdate and sysdate &lt;= nvl(d.end_date, sysdate + 1) ) when matched then update set d.tmp_id = s.id where d.name &lt;&gt; s.name when not matched then insert (id, device_id, owner_id, type_id, res_num, name) values (ae_resource_seq.nextval, s.device_id, s.owner_id, s.type_id, s.num, s.name); --   ae_resource insert into ae_resource(id, device_id, owner_id, type_id, res_num, name) select ae_resource_seq.nextval, t.device_id, o.id, p.type_id, t.num, t.value from ae_state_tmp t inner join ae_resource c on (c.tmp_id = t.id) inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource_type r on (r.id = p.type_id) left join ae_resource o on (o.device_id = t.device_id and o.type_id = r.owner_id); --    update ae_resource set end_date = sysdate , tmp_id = null where tmp_id &gt; 0; --    ae_state_log insert into ae_state_log(id, res_id, param_id, value) select ae_state_log_seq.nextval, id, param_id, value from ( select distinct r.id, t.param_id, decode(l.type_id, g_uptime_policy, nvl(s.value, t.value), t.value) value from ae_state_tmp t inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource r on ( r.device_id = t.device_id and r.res_num = t.num and r.type_id = p.type_id and r.start_date &lt;= sysdate and sysdate &lt;= nvl(r.end_date, sysdate + 1)) left join ae_state s on (s.res_id = r.id and s.param_id = t.param_id) inner join ae_parameter a on (a.id = p.param_id) inner join ae_domain d on (d.id = a.domain_id) inner join ae_state_policy l on (l.id = d.policy_id) left join ae_threshold h on ( h.policy_id = l.id and (( h.type_id = g_increase_type and s.value &lt;= h.value and t.value &gt;= h.value ) or ( h.type_id = g_decrease_type and s.value &gt;= h.value and t.value &lt;= h.value ) or ( h.type_id = g_delta_type and abs(t.value - s.value) &gt;= h.value ))) where ( s.id is null or not h.id is null or ( l.type_id = g_uptime_policy and t.value &lt; s.value ) or ( l.type_id = g_default_policy and t.value &lt;&gt; s.value ) ) and t.param_id &lt;&gt; g_ifName_parameter ); --  ae_state merge into ae_state d using ( select t.param_id, t.value, r.id res_id from ae_state_tmp t inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource r on ( r.device_id = t.device_id and r.res_num = t.num and r.type_id = p.type_id and r.start_date &lt;= sysdate and sysdate &lt;= nvl(r.end_date, sysdate + 1)) where t.param_id &lt;&gt; g_ifName_parameter ) s on (d.res_id = s.res_id and d.param_id = s.param_id) when matched then update set d.value = s.value , d.datetime = current_timestamp when not matched then insert (id, param_id, res_id, value) values (ae_state_seq.nextval, s.param_id, s.res_id, s.value); --   commit write nowait; end; end ae_monitoring; /</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Java code</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> BULK_SIZE = <span class="hljs-number"><span class="hljs-number">200</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String INS_VAL_SQL = <span class="hljs-string"><span class="hljs-string">"insert into ae_state_tmp(id, device_id, profile_id, param_id, num, value) values (?,?,?,?,?,?)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String SAVE_VALUES_SQL = <span class="hljs-string"><span class="hljs-string">"begin ae_monitoring.saveValues; end;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_temporary</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"test_temporary:"</span></span>); CallableStatement st = c.prepareCall(INS_VAL_SQL); Long timestamp = System.currentTimeMillis(); Long uptime = <span class="hljs-number"><span class="hljs-number">0L</span></span>; Long inoct = <span class="hljs-number"><span class="hljs-number">0L</span></span>; Long ix = <span class="hljs-number"><span class="hljs-number">1L</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bulk = BULK_SIZE; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= ALL_SIZE; i++) { <span class="hljs-comment"><span class="hljs-comment">//  uptime st.setLong(1, ix++); st.setLong(2, DEVICE_ID); st.setLong(3, PROFILE_ID); st.setLong(4, UPTIME_PARAM_ID); st.setString(5, FAKE_NUM_VALUE); st.setString(6, uptime.toString()); st.addBatch(); //    st.setLong(1, ix++); st.setLong(2, DEVICE_ID); st.setLong(3, PROFILE_ID); st.setLong(4, IFNAME_PARAM_ID); st.setString(5, Integer.toString((i % 100) + 1)); st.setString(6, Integer.toString((i % 100) + 1)); st.addBatch(); //    st.setLong(1, ix++); st.setLong(2, DEVICE_ID); st.setLong(3, PROFILE_ID); st.setLong(4, INOCT_PARAM_ID); st.setString(5, Integer.toString((i % 100) + 1)); st.setString(6, inoct.toString()); st.addBatch(); if (--bulk &lt;= 0) { st.executeBatch(); bulk = BULK_SIZE; } //   uptime += 100L; if (uptime &gt;= 1000) { uptime = 0L; } inoct += 10L; } if (bulk &lt; BULK_SIZE) { st.executeBatch(); } } finally { st.close(); } Long delta_1 = System.currentTimeMillis() - timestamp; System.out.println((ALL_SIZE * 1000L) / delta_1); timestamp = System.currentTimeMillis(); st = c.prepareCall(SAVE_VALUES_SQL); timestamp = System.currentTimeMillis(); try { st.execute(); } finally { st.close(); } Long delta_2 = System.currentTimeMillis() - timestamp; System.out.println(delta_2); System.out.println((ALL_SIZE * 1000L) / (delta_1 - delta_2)); }</span></span></code> </pre><br></div></div><br>  Run this code for execution and get: <br><br><pre> <code class="hljs pgsql">java.<span class="hljs-keyword"><span class="hljs-keyword">sql</span></span>.SQLException: ORA<span class="hljs-number"><span class="hljs-number">-30926</span></span>:         ORA<span class="hljs-number"><span class="hljs-number">-06512</span></span>:  "AIS.AE_MONITORING", <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-number"><span class="hljs-number">205</span></span> ORA<span class="hljs-number"><span class="hljs-number">-06512</span></span>:  <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  If you think the reason for this error becomes clear.  If the data set contains conflicting data for some variable (we managed to read it several times), a problem arises.  With the normal operation of SNMP monitoring, such a situation should not arise, but we must provide for something to prevent the application from falling if it does. <br><br>  The first thing that comes to mind is the storage of aggregated data for each variable.  We will add a new record if it does not already exist or update an existing one, write a new value in it: <br><br><div class="spoiler">  <b class="spoiler_title">Java code</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> BULK_SIZE = <span class="hljs-number"><span class="hljs-number">200</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String MERGE_VAL_SQL = <span class="hljs-string"><span class="hljs-string">"merge into ae_state_tmp d "</span></span> + <span class="hljs-string"><span class="hljs-string">"using ( select ? id,? device_id,? profile_id,? param_id,? num,? value "</span></span> + <span class="hljs-string"><span class="hljs-string">" from dual"</span></span> + <span class="hljs-string"><span class="hljs-string">" ) s "</span></span> + <span class="hljs-string"><span class="hljs-string">"on ( d.device_id = s.device_id and d.profile_id = s.profile_id and "</span></span> + <span class="hljs-string"><span class="hljs-string">" d.param_id = s.param_id and d.num = s.num ) "</span></span> + <span class="hljs-string"><span class="hljs-string">"when matched then "</span></span> + <span class="hljs-string"><span class="hljs-string">" update set d.value = s.value "</span></span> + <span class="hljs-string"><span class="hljs-string">"when not matched then "</span></span> + <span class="hljs-string"><span class="hljs-string">" insert (id, device_id, profile_id, param_id, num, value) "</span></span> + <span class="hljs-string"><span class="hljs-string">" values (s.id, s.device_id, s.profile_id, s.param_id, s.num, s.value)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String SAVE_VALUES_SQL = <span class="hljs-string"><span class="hljs-string">"begin ae_monitoring.saveValues; end;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_temporary</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"test_temporary:"</span></span>); CallableStatement st = c.prepareCall(MERGE_VAL_SQL); ...</code> </pre><br></div></div><br>  Now we are dealing with the same problem, but at the stage of the batch request: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">java</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.sql</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.BatchUpdateException</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">ORA-00600</span></span>:   , : <span class="hljs-selector-attr"><span class="hljs-selector-attr">[6704]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[2]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[0]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[6301696]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span></code> </pre><br>  It is necessary to refuse batch: <br><br><pre> <code class="hljs axapta"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> BULK_SIZE = <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br>  The results have noticeably improved: <br><br><div class="spoiler">  <b class="spoiler_title">results</b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">OVERALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TOTALS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FOR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">NON-RECURSIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATEMENTS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">count</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">current</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Parse</span></span> 2 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Execute</span></span> 1001 1<span class="hljs-selector-class"><span class="hljs-selector-class">.02</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.01</span></span> 0 9002 3503 3001 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fetch</span></span> 0 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span> 1003 1<span class="hljs-selector-class"><span class="hljs-selector-class">.02</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.01</span></span> 0 9002 3503 3001 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">parse</span></span>: 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">execute</span></span>: 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waiting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">following</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">events</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Event</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Max</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wait</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">to</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 1002 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">from</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 1002 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.41</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">log</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">file</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sync</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">OVERALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TOTALS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FOR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">RECURSIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATEMENTS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">count</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">current</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Parse</span></span> 23 0<span class="hljs-selector-class"><span class="hljs-selector-class">.01</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.01</span></span> 0 1 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Execute</span></span> 23 0<span class="hljs-selector-class"><span class="hljs-selector-class">.21</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.21</span></span> 43 29392 348 111 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fetch</span></span> 11 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 27 0 10 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span> 57 0<span class="hljs-selector-class"><span class="hljs-selector-class">.22</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.23</span></span> 43 29420 348 121 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">parse</span></span>: 8 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">execute</span></span>: 6 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waiting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">following</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">events</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Event</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Max</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wait</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">db</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">file</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sequential</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">read</span></span> 41 0<span class="hljs-selector-class"><span class="hljs-selector-class">.01</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.01</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">db</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">file</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">scattered</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">read</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span></code> </pre><br></div></div><br><h4>  Alternative approach (distinct) </h4><br>  We can simplify our lives at the data insertion stage (at the same time getting rid of the ORA-600 capability) by adding grouping at the mass processing stage.  In this case, we can not be shy with BULK_SIZE, setting it to the maximum. <br><br><div class="spoiler">  <b class="spoiler_title">PL / SQL code</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> AIS.ae_monitoring <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> saveValuesDistinct; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> ae_monitoring; / <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> <span class="hljs-keyword"><span class="hljs-keyword">body</span></span> AIS.ae_monitoring <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> g_ifName_parameter <span class="hljs-keyword"><span class="hljs-keyword">constant</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">103</span></span>; g_default_policy constant number default 1; g_uptime_policy constant number default 2; g_threshold_policy constant number default 3; g_increase_type constant number default 1; g_decrease_type constant number default 2; g_delta_type constant number default 3; procedure saveValuesDistinct as <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-comment"><span class="hljs-comment">--  ,    merge into ae_resource d using ( select t.id, t.device_id, t.num, t.value name, p.type_id, o.id owner_id from ( select device_id, profile_id, param_id, num , max(id) keep (dense_rank last order by datetime) id , max(value) keep (dense_rank last order by datetime) value , max(datetime) datetime from ae_state_tmp group by device_id, profile_id, param_id, num ) t inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource_type r on (r.id = p.type_id) left join ae_resource o on (o.device_id = t.device_id and o.type_id = r.owner_id) where t.param_id = g_ifName_parameter ) s on ( d.device_id = s.device_id and d.res_num = s.num and d.type_id = s.type_id and d.start_date &lt;= sysdate and sysdate &lt;= nvl(d.end_date, sysdate + 1) ) when matched then update set d.tmp_id = s.id where d.name &lt;&gt; s.name when not matched then insert (id, device_id, owner_id, type_id, res_num, name) values (ae_resource_seq.nextval, s.device_id, s.owner_id, s.type_id, s.num, s.name); --   ae_resource insert into ae_resource(id, device_id, owner_id, type_id, res_num, name) select ae_resource_seq.nextval, t.device_id, o.id, p.type_id, t.num, t.value from ( select device_id, profile_id, param_id, num , max(id) keep (dense_rank last order by datetime) id , max(value) keep (dense_rank last order by datetime) value , max(datetime) datetime from ae_state_tmp group by device_id, profile_id, param_id, num ) t inner join ae_resource c on (c.tmp_id = t.id) inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource_type r on (r.id = p.type_id) left join ae_resource o on (o.device_id = t.device_id and o.type_id = r.owner_id); --    update ae_resource set end_date = sysdate , tmp_id = null where tmp_id &gt; 0; --    ae_state_log insert into ae_state_log(id, res_id, param_id, value) select ae_state_log_seq.nextval, id, param_id, value from ( select distinct r.id, t.param_id, decode(l.type_id, g_uptime_policy, nvl(s.value, t.value), t.value) value from ( select device_id, profile_id, param_id, num , max(id) keep (dense_rank last order by datetime) id , max(value) keep (dense_rank last order by datetime) value , max(datetime) datetime from ae_state_tmp group by device_id, profile_id, param_id, num ) t inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource r on ( r.device_id = t.device_id and r.res_num = t.num and r.type_id = p.type_id and r.start_date &lt;= sysdate and sysdate &lt;= nvl(r.end_date, sysdate + 1)) left join ae_state s on (s.res_id = r.id and s.param_id = t.param_id) inner join ae_parameter a on (a.id = p.param_id) inner join ae_domain d on (d.id = a.domain_id) inner join ae_state_policy l on (l.id = d.policy_id) left join ae_threshold h on ( h.policy_id = l.id and (( h.type_id = g_increase_type and s.value &lt;= h.value and t.value &gt;= h.value ) or ( h.type_id = g_decrease_type and s.value &gt;= h.value and t.value &lt;= h.value ) or ( h.type_id = g_delta_type and abs(t.value - s.value) &gt;= h.value ))) where ( s.id is null or not h.id is null or ( l.type_id = g_uptime_policy and t.value &lt; s.value ) or ( l.type_id = g_default_policy and t.value &lt;&gt; s.value ) ) and t.param_id &lt;&gt; g_ifName_parameter ); --  ae_state merge into ae_state d using ( select t.param_id, t.value, r.id res_id from ( select device_id, profile_id, param_id, num , max(id) keep (dense_rank last order by datetime) id , max(value) keep (dense_rank last order by datetime) value , max(datetime) datetime from ae_state_tmp group by device_id, profile_id, param_id, num ) t inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource r on ( r.device_id = t.device_id and r.res_num = t.num and r.type_id = p.type_id and r.start_date &lt;= sysdate and sysdate &lt;= nvl(r.end_date, sysdate + 1)) where t.param_id &lt;&gt; g_ifName_parameter ) s on (d.res_id = s.res_id and d.param_id = s.param_id) when matched then update set d.value = s.value , d.datetime = current_timestamp when not matched then insert (id, param_id, res_id, value) values (ae_state_seq.nextval, s.param_id, s.res_id, s.value); --   commit write nowait; end; end ae_monitoring; /</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Java code</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> BULK_SIZE = <span class="hljs-number"><span class="hljs-number">200</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String INS_VAL_SQL = <span class="hljs-string"><span class="hljs-string">"insert into ae_state_tmp(id, device_id, profile_id, param_id, num, value) values (?,?,?,?,?,?)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String SAVE_VALUES_DISTINCT_SQL = <span class="hljs-string"><span class="hljs-string">"begin ae_monitoring.saveValuesDistinct; end;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_temporary_distinct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"test_temporary:"</span></span>); CallableStatement st = c.prepareCall(INS_VAL_SQL); Long timestamp = System.currentTimeMillis(); Long uptime = <span class="hljs-number"><span class="hljs-number">0L</span></span>; Long inoct = <span class="hljs-number"><span class="hljs-number">0L</span></span>; Long ix = <span class="hljs-number"><span class="hljs-number">1L</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bulk = BULK_SIZE; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= ALL_SIZE; i++) { <span class="hljs-comment"><span class="hljs-comment">//  uptime st.setLong(1, ix++); st.setLong(2, DEVICE_ID); st.setLong(3, PROFILE_ID); st.setLong(4, UPTIME_PARAM_ID); st.setString(5, FAKE_NUM_VALUE); st.setString(6, uptime.toString()); st.addBatch(); //    st.setLong(1, ix++); st.setLong(2, DEVICE_ID); st.setLong(3, PROFILE_ID); st.setLong(4, IFNAME_PARAM_ID); st.setString(5, Integer.toString((i % 100) + 1)); st.setString(6, Integer.toString((i % 100) + 1)); st.addBatch(); //    st.setLong(1, ix++); st.setLong(2, DEVICE_ID); st.setLong(3, PROFILE_ID); st.setLong(4, INOCT_PARAM_ID); st.setString(5, Integer.toString((i % 100) + 1)); st.setString(6, inoct.toString()); st.addBatch(); if (--bulk &lt;= 0) { st.executeBatch(); bulk = BULK_SIZE; } //   uptime += 100L; if (uptime &gt;= 1000) { uptime = 0L; } inoct += 10L; } if (bulk &lt; BULK_SIZE) { st.executeBatch(); } } finally { st.close(); } Long delta_1 = System.currentTimeMillis() - timestamp; System.out.println((ALL_SIZE * 1000L) / delta_1); timestamp = System.currentTimeMillis(); st = c.prepareCall(SAVE_VALUES_DISTINCT_SQL); timestamp = System.currentTimeMillis(); try { st.execute(); } finally { st.close(); } Long delta_2 = System.currentTimeMillis() - timestamp; System.out.println(delta_2); System.out.println((ALL_SIZE * 1000L) / (delta_1 - delta_2)); }</span></span></code> </pre><br></div></div><br>    : <br><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">OVERALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TOTALS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FOR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">NON-RECURSIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATEMENTS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">count</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">current</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Parse</span></span> 2 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Execute</span></span> 1001 0<span class="hljs-selector-class"><span class="hljs-selector-class">.36</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.33</span></span> 0 96 6616 3001 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fetch</span></span> 0 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span> 1003 0<span class="hljs-selector-class"><span class="hljs-selector-class">.36</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.33</span></span> 0 96 6616 3001 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">parse</span></span>: 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">execute</span></span>: 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waiting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">following</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">events</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Event</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Max</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wait</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">to</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 1002 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">from</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 1002 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.41</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">log</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">file</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sync</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">OVERALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TOTALS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FOR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">RECURSIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATEMENTS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">count</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">current</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Parse</span></span> 30 0<span class="hljs-selector-class"><span class="hljs-selector-class">.01</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.01</span></span> 0 3 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Execute</span></span> 30 0<span class="hljs-selector-class"><span class="hljs-selector-class">.41</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.40</span></span> 3 48932 1104 218 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fetch</span></span> 8 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 176 0 8 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span> 68 0<span class="hljs-selector-class"><span class="hljs-selector-class">.44</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.43</span></span> 3 49111 1104 226 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">parse</span></span>: 8 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">execute</span></span>: 7 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waiting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">following</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">events</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Event</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Max</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wait</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">db</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">file</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sequential</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">read</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span></code> </pre><br></div></div><br>   ,     ,     . <br><br><h4>   (collection) </h4><br>    <a href="https://habrahabr.ru/users/denkrep/" class="user_link">DenKrep</a> ,        ,    GTT        .          ?     JDBC batch   PL/SQL- ( ,      ),     ! <br><br>      Java-    <a href="http://www.sql.ru/forum/153108/faq-java-oracle-peredacha-priem-massivov"></a> .   ,     : <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">replace</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ae_state_rec <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> ( device_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, profile_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, param_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">num</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">300</span></span>) ) / <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">replace</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ae_state_tab <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ae_state_rec; /</code> </pre><br>     Oracle Client 11g,    [ORACLE_HOME]/jdbc/lib/classes12.zip  [ORACLE_HOME]/jdbc/lib/ojdbc5.jar. ,  ,  [ORACLE_HOME]/jdbc/lib/nls_charset12.zip      ,   ,      (   ,    NULL). <br><br>       ?  ,      addValue  : <br><br><pre> <code class="sql hljs"> ... procedure addValues( p_tab in ae_state_tab ) as <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> .. p_tab.count <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> addValue( p_device =&gt; p_tab(i).device_id , p_profile =&gt; p_tab(i).profile_id , p_param =&gt; p_tab(i).param_id , p_num =&gt; p_tab(i).num , p_val =&gt; p_tab(i).value ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">commit</span></span> write <span class="hljs-keyword"><span class="hljs-keyword">nowait</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ...</code> </pre><br> Java-  : <br><br><div class="spoiler"> <b class="spoiler_title">Java-</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String ADD_VALUES_SQL = <span class="hljs-string"><span class="hljs-string">"begin ae_monitoring.addValues(?); end;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_collection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"test_collection:"</span></span>); OracleCallableStatement st = (OracleCallableStatement)c.prepareCall(ADD_VALUES_SQL); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> oracleId = CharacterSet.CL8MSWIN1251_CHARSET; CharacterSet charSet = CharacterSet.make(oracleId); Long timestamp = System.currentTimeMillis(); Long uptime = <span class="hljs-number"><span class="hljs-number">0L</span></span>; Long inoct = <span class="hljs-number"><span class="hljs-number">0L</span></span>; RecType r[] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RecType[ALL_SIZE * <span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ix = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= ALL_SIZE; i++) { <span class="hljs-comment"><span class="hljs-comment">//  uptime r[ix++] = new RecType( new NUMBER(DEVICE_ID), new NUMBER(PROFILE_ID), new NUMBER(UPTIME_PARAM_ID), new CHAR(FAKE_NUM_VALUE, charSet), new CHAR(uptime.toString(), charSet)); //    r[ix++] = new RecType( new NUMBER(DEVICE_ID), new NUMBER(PROFILE_ID), new NUMBER(IFNAME_PARAM_ID), new CHAR(Integer.toString((i % 100) + 1), charSet), new CHAR(Integer.toString((i % 100) + 1), charSet)); //    r[ix++] = new RecType( new NUMBER(DEVICE_ID), new NUMBER(PROFILE_ID), new NUMBER(INOCT_PARAM_ID), new CHAR(Integer.toString((i % 100) + 1), charSet), new CHAR(inoct.toString(), charSet)); //   uptime += 100L; if (uptime &gt;= 1000) { uptime = 0L; } inoct += 10L; } RecTab t = new RecTab(r); try { st.setORAData(1, t); st.execute(); } finally { st.close(); } System.out.println((ALL_SIZE * 1000L) / (System.currentTimeMillis() - timestamp)); }</span></span></code> </pre><br></div></div><br><br>      ,      : <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> INSTANTIABLE, supertype_owner, supertype_name, LOCAL_ATTRIBUTES <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> all_types <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> type_name = :<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> owner = :<span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre><br>  : <br><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">OVERALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TOTALS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FOR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">NON-RECURSIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATEMENTS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">count</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">current</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Parse</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Execute</span></span> 4 4<span class="hljs-selector-class"><span class="hljs-selector-class">.35</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.31</span></span> 5 136053 6610 3 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fetch</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 9 0 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span> 9 4<span class="hljs-selector-class"><span class="hljs-selector-class">.35</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.31</span></span> 5 136062 6610 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">parse</span></span>: 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">execute</span></span>: 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waiting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">following</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">events</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Event</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Max</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wait</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">to</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 6 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">from</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 6 0<span class="hljs-selector-class"><span class="hljs-selector-class">.23</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.34</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">more</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">data</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">from</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 41 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">OVERALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TOTALS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FOR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">RECURSIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATEMENTS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">count</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">current</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Parse</span></span> 77 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Execute</span></span> 17270 2<span class="hljs-selector-class"><span class="hljs-selector-class">.97</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.92</span></span> 5 6046 6610 3160 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fetch</span></span> 14013 0<span class="hljs-selector-class"><span class="hljs-selector-class">.49</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.49</span></span> 1 129930 0 13909 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span> 31360 3<span class="hljs-selector-class"><span class="hljs-selector-class">.48</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.43</span></span> 6 135976 6610 17069 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">parse</span></span>: 8 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">execute</span></span>: 11 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waiting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">following</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">events</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Event</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Max</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wait</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">db</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">file</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sequential</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">read</span></span> 6 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span></code> </pre><br></div></div><br>  ,      ,     ,     plsql. <br><br><h4>     (bulk) </h4><br> ,     ,       .        SQL-,    ,    ?     <a href="http://www.oracle.com/technetwork/issue-archive/2008/08-mar/o28plsql-095155.html">BULK COLLECT</a> ,       .  ,      <a href="http://stackoverflow.com/questions/5165580/how-to-use-a-table-type-in-a-select-from-statement">TABLE</a> : <br><br><div class="spoiler"> <b class="spoiler_title">PL/SQL-</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> AIS.ae_monitoring <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> saveValues( p_tab <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ae_state_tab ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> ae_monitoring; / <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> <span class="hljs-keyword"><span class="hljs-keyword">body</span></span> AIS.ae_monitoring <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> g_ifName_parameter <span class="hljs-keyword"><span class="hljs-keyword">constant</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">103</span></span>; g_default_policy constant number default 1; g_uptime_policy constant number default 2; g_threshold_policy constant number default 3; g_increase_type constant number default 1; g_decrease_type constant number default 2; g_delta_type constant number default 3; procedure saveValues( p_tab in ae_state_tab ) as <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-comment"><span class="hljs-comment">--  ,    merge into ae_resource d using ( select t.device_id, t.num, t.value name, p.type_id, o.id owner_id from ( select device_id, profile_id, param_id, num , max(value) value from table( p_tab ) group by device_id, profile_id, param_id, num ) t inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource_type r on (r.id = p.type_id) left join ae_resource o on (o.device_id = t.device_id and o.type_id = r.owner_id) where t.param_id = g_ifName_parameter ) s on ( d.device_id = s.device_id and d.res_num = s.num and d.type_id = s.type_id and d.start_date &lt;= sysdate and sysdate &lt;= nvl(d.end_date, sysdate + 1) ) when not matched then insert (id, device_id, owner_id, type_id, res_num, name) values (ae_resource_seq.nextval, s.device_id, s.owner_id, s.type_id, s.num, s.name); --    ae_state_log insert into ae_state_log(id, res_id, param_id, value) select ae_state_log_seq.nextval, id, param_id, value from ( select distinct r.id, t.param_id, decode(l.type_id, g_uptime_policy, nvl(s.value, t.value), t.value) value from ( select device_id, profile_id, param_id, num , max(value) value from table( p_tab ) group by device_id, profile_id, param_id, num ) t inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource r on ( r.device_id = t.device_id and r.res_num = t.num and r.type_id = p.type_id and r.start_date &lt;= sysdate and sysdate &lt;= nvl(r.end_date, sysdate + 1)) left join ae_state s on (s.res_id = r.id and s.param_id = t.param_id) inner join ae_parameter a on (a.id = p.param_id) inner join ae_domain d on (d.id = a.domain_id) inner join ae_state_policy l on (l.id = d.policy_id) left join ae_threshold h on ( h.policy_id = l.id and (( h.type_id = g_increase_type and s.value &lt;= h.value and t.value &gt;= h.value ) or ( h.type_id = g_decrease_type and s.value &gt;= h.value and t.value &lt;= h.value ) or ( h.type_id = g_delta_type and abs(t.value - s.value) &gt;= h.value ))) where ( s.id is null or not h.id is null or ( l.type_id = g_uptime_policy and t.value &lt; s.value ) or ( l.type_id = g_default_policy and t.value &lt;&gt; s.value ) ) and t.param_id &lt;&gt; g_ifName_parameter ); --  ae_state merge into ae_state d using ( select t.param_id, t.value, r.id res_id from ( select device_id, profile_id, param_id, num , max(value) value from table( p_tab ) group by device_id, profile_id, param_id, num ) t inner join ae_profile_detail p on (p.profile_id = t.profile_id and p.param_id = t.param_id) inner join ae_resource r on ( r.device_id = t.device_id and r.res_num = t.num and r.type_id = p.type_id and r.start_date &lt;= sysdate and sysdate &lt;= nvl(r.end_date, sysdate + 1)) where t.param_id &lt;&gt; g_ifName_parameter ) s on (d.res_id = s.res_id and d.param_id = s.param_id) when matched then update set d.value = s.value , d.datetime = current_timestamp when not matched then insert (id, param_id, res_id, value) values (ae_state_seq.nextval, s.param_id, s.res_id, s.value); --   commit write nowait; end; end ae_monitoring; /</span></span></code> </pre><br></div></div><br><div class="spoiler"> <b class="spoiler_title">Java-</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String BULK_VALUES_SQL = <span class="hljs-string"><span class="hljs-string">"begin ae_monitoring.saveValues(?); end;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_bulk</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"test_bulk:"</span></span>); OracleCallableStatement st = (OracleCallableStatement)c.prepareCall(BULK_VALUES_SQL); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> oracleId = CharacterSet.CL8MSWIN1251_CHARSET; CharacterSet charSet = CharacterSet.make(oracleId); Long timestamp = System.currentTimeMillis(); Long uptime = <span class="hljs-number"><span class="hljs-number">0L</span></span>; Long inoct = <span class="hljs-number"><span class="hljs-number">0L</span></span>; RecType r[] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RecType[ALL_SIZE * <span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ix = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= ALL_SIZE; i++) { <span class="hljs-comment"><span class="hljs-comment">//  uptime r[ix++] = new RecType( new NUMBER(DEVICE_ID), new NUMBER(PROFILE_ID), new NUMBER(UPTIME_PARAM_ID), new CHAR(FAKE_NUM_VALUE, charSet), new CHAR(uptime.toString(), charSet)); //    r[ix++] = new RecType( new NUMBER(DEVICE_ID), new NUMBER(PROFILE_ID), new NUMBER(IFNAME_PARAM_ID), new CHAR(Integer.toString((i % 100) + 1), charSet), new CHAR(Integer.toString((i % 100) + 1), charSet)); //    r[ix++] = new RecType( new NUMBER(DEVICE_ID), new NUMBER(PROFILE_ID), new NUMBER(INOCT_PARAM_ID), new CHAR(Integer.toString((i % 100) + 1), charSet), new CHAR(inoct.toString(), charSet)); //   uptime += 100L; if (uptime &gt;= 1000) { uptime = 0L; } inoct += 10L; } RecTab t = new RecTab(r); try { st.setORAData(1, t); st.execute(); } finally { st.close(); } System.out.println((ALL_SIZE * 1000L) / (System.currentTimeMillis() - timestamp)); }</span></span></code> </pre><br></div></div><br>     : <br><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">OVERALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TOTALS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FOR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">NON-RECURSIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATEMENTS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">count</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">current</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Parse</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Execute</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.20</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.20</span></span> 4 696 1095 3 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fetch</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 9 0 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span> 9 0<span class="hljs-selector-class"><span class="hljs-selector-class">.20</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.20</span></span> 4 705 1095 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">parse</span></span>: 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waiting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">following</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">events</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Event</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Max</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wait</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">to</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 6 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">from</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 6 0<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.19</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SQL</span></span>*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Net</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">more</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">data</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">from</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">client</span></span> 41 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">OVERALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TOTALS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FOR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ALL</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">RECURSIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATEMENTS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">count</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">current</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rows</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Parse</span></span> 30 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 0 0 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Execute</span></span> 38 0<span class="hljs-selector-class"><span class="hljs-selector-class">.18</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.17</span></span> 4 591 1095 217 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fetch</span></span> 46 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0 96 0 30 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">total</span></span> 114 0<span class="hljs-selector-class"><span class="hljs-selector-class">.18</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.18</span></span> 4 687 1095 247 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">parse</span></span>: 7 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Misses</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">library</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">during</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">execute</span></span>: 7 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Elapsed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waiting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">following</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">events</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Event</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Times</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Max</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wait</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Waited</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">db</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">file</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sequential</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">read</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span></code> </pre><br></div></div><br><h4>  findings </h4><br>    ,     Oracle    (bulk)    .    GTT (temporary, distinct)       ,   ,    Java-.  temporary,  ,    ORA-600,   batch    . <br><br>        ‚Äî  .     <a href="https://github.com/GlukKazan/traces">GitHub</a> . <br></div><p>Source: <a href="https://habr.com/ru/post/199518/">https://habr.com/ru/post/199518/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../199508/index.html">IEEE 802.11s Wi-Fi Mesh for the smallest part one</a></li>
<li><a href="../199510/index.html">Drupal.org updated to Drupal 7</a></li>
<li><a href="../199512/index.html">Bender: ideological fighter for minimal CSS / Javascript</a></li>
<li><a href="../199514/index.html">IconBIT NetTAB Mercury Q7 Review: The Only 6.5-inch Smartphone in Russia</a></li>
<li><a href="../199516/index.html">Development of the AppJS project is terminated, then use node-webkit</a></li>
<li><a href="../199520/index.html">How to live without const?</a></li>
<li><a href="../199526/index.html">iON Air Pro 2 Wi-Fi: the flagship "underwater" camera - the nuances and features</a></li>
<li><a href="../199528/index.html">Soon, laptops will be able to use USB ports for charging</a></li>
<li><a href="../199530/index.html">ZTE introduced its modular smartphone ECO-MOBIUS</a></li>
<li><a href="../199534/index.html">PACT Conference (Parallel Architects and Compilation Techniques) 2013. Attendance Report</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>