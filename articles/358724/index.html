<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experience in building an integration platform based on ServiceMix (Camel) and RabbitMQ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As soon as the company has at least two information systems that need to exchange data, the question arises how to organize their interaction. The opt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experience in building an integration platform based on ServiceMix (Camel) and RabbitMQ</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ge/gi/co/gegiconfwag8g2kmxnd_ar4yakg.jpeg" width="60%" align="left">  As soon as the company has at least two information systems that need to exchange data, the question arises how to organize their interaction.  The options are many: file exchange, links between databases, web or rest services, various messaging systems, outdated RPC and CORBA, new-fashioned gRPC, etc.  The choice depends on the preferences of the project participants and on the capabilities of the systems (system architecture, platform used, availability of a ready-made API, etc.).  Suppose you have chosen some kind of exchange, the systems began to interact, everything is fine.  But then a third system emerges, with which you also need to integrate, then a fourth, etc.  It is necessary to sit down again and choose the mode of exchange, and it‚Äôs not a fact that we can limit ourselves to the technologies already used (somewhere this is dictated by the limitations of the new systems, somewhere the developer insisted on another technology or wanted to try something new).  As the number of systems grows, the number and complexity of the interactions between them grow, the number of technologies used grows.  As a result, the entire integration architecture of the company begins to resemble the tangled tangle of multi-colored threads, somehow linking the company's systems, which are more and more difficult to unravel when parsing errors and completions.  Sooner or later, thoughts of creating a unified integration environment begin to come in, which will transparently and expandably connect all systems together. <br><br>  In this article I will talk about the experience of using Apache ServiceMix (Camel) and RabbitMQ to build such an integration environment. <br><a name="habracut"></a><br><h2>  Stack technology </h2><br><h3>  RabbitMQ </h3><br>  RabbitMQ is an AMQP based messaging system.  I will not describe the system in detail, on Habr√© there are already a few articles that describe in detail the functionality of the system, I‚Äôll tell you about where and how RabbitMQ is used here. <br><br><img src="https://habrastorage.org/webt/cy/gj/ou/cygjouggja5hrso04j1lhsvtw_s.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Through RabbitMQ we exchange data with the company's information systems.  A set of queues is created for each system.  For example, you need to organize a search for customers by name and date of birth in the accounting system.  Create a couple of queues.  One incoming with respect to the accounting system, we will send requests to it with the name and date of birth of the client.  The accounting system listens to the incoming queue and processes incoming requests.  The second is outgoing, to which the accounting system will send answers with a list of found customers that match the conditions of the request. <br><br>  Why it is convenient: <br><br><ul><li>  Messages that are stored in the queue are persistent.  Those.  if the system is unavailable for a while, the messages will not disappear anywhere and will be processed after the system has risen.  Restarting the RabbitMQ itself also does not result in the loss of messages. </li><li>  The queue serves as a buffer that the system can handle in comfort mode, avoiding peak loads.  It is clear that for requests that the user is waiting for in the interface, this will not work.  In this case, an immediate response is needed.  But for all sorts of asynchronous interactions fits very well. </li><li>  Asynchronous interaction mode.  It also supports synchronous calls. </li></ul><br>  Teaching the system to interact with RabbitMQ is not difficult.  RabbitMQ has ready-made clients for various platforms (Java, .Net, Python, etc.).  The client is simple and straightforward.  Code that reads messages from a queue and / or sends messages to a queue takes up several lines.  It is clear that not every system can be made friends with RabbitMQ, for example, in the case of Legacy and box systems, this will be difficult.  In this case, the exchange is built using technologies that support these systems, somewhere we call stored procedures in the database, somewhere we use web and rest services, somewhere else.  In order to organize such interaction for many other integration tasks, Apache ServiceMix is ‚Äã‚Äãused. <br><br><h3>  Apache ServiceMix </h3>  ServiceMix - Karaf container with a predefined set of bundles that will be useful for solving various integration tasks. <br><br><img src="https://habrastorage.org/webt/5z/wh/_s/5zwh_sd8qqwp5qcmzqhmlro3kte.jpeg"><br><br>  A little more detail about what is included in the product: <br><br><ol><li>  Actually Karaf is the container in which the bundles work and which allows them to be managed: set / delete / stop / start, view logs, see dependencies of components, etc. </li><li>  A wide range of bundles that perform classic integration functions: validation, various transformations (for example, from JSON to XML, transformations using XSLT, etc.), enrichment, routing, split and join, monitoring, execution of integration processes, etc. . </li><li>  A wide range of different adapters: file adapters, adapters for web and rest services, JMS, RabbitMQ, Kafka, etc.  A complete list of adapters can be found on the Camel website. </li></ol><br>  Restricting the use of only pre-installed bundles is unlikely to succeed, but for the beginning of the set should be enough.  Since  we work with the Karaf container, then you can install any necessary bundles, you can do this either by installing features (bundle bundles) or simply by installing individual bundles.  Of course, you can write your own bundles, or wrap in third-party java libraries. <br><br><h2>  Apache camel </h2><br>  A key component of ServiceMix is ‚Äã‚Äãthe Apache Camel framework, which allows you to build integration processes that are called routes in Camel terminology. <br>  Let me show you with an example of what a route is: <br><br><img src="https://habrastorage.org/webt/tk/hn/ol/tkhnolyocsy70rx9smsulx_4m6a.jpeg"><br><br>  This is an example of a simple route that converts incoming multi-format messages to a common output format.  Depending on the message format, the route routes it to the appropriate transformation, which converts the message to a general format, and then sends the result to the output. <br><br>  Camel supports various notations for describing routes, the most common Java DSL and Spring XML.  We use Spring XML.  This is how the route in the picture would look like in Spring XML notation: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Normalizer"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" endpoint"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--           --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">choice</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">when</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xpath</span></span></span><span class="hljs-tag">&gt;</span></span>/*[local-name()='Format_1']<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xpath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xslt:classpath:xslt/Format_1_Transformation.xslt"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">when</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">when</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xpath</span></span></span><span class="hljs-tag">&gt;</span></span>/*[local-name()='Format_2']<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xpath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xslt:classpath:xslt/Format_2_Transformation.xslt"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">when</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">when</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xpath</span></span></span><span class="hljs-tag">&gt;</span></span>/*[local-name()='Format_3']<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xpath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xslt:classpath:xslt/Format_3_Transformation.xslt"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">when</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">choice</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" endpoint"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  A very nice addition is that Camel is perfectly integrated with Spring.  You can use the familiar Spring XML, in which the bins are defined, and in the same Spring XML you can define Camel routes.  In this case, bins can be called from routs, and bins can be accessed from routs.  Calling bins from routs is implemented with Camel's intrinsic flexibility; you can pass a message body to a bin method, you can pass headers + body, or you can pass only the value of a specific XML message tag specified via an XPATH expression, and use the result of the method in the choice to determine route.  And all this is almost one line. <br><br>  Here is an example of Camel style elegance: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">camel:camelContext</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Bean method invocation"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" endpoint"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">when</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">simple</span></span></span><span class="hljs-tag">&gt;</span></span>${bean:authManager?method=checkToken(${body})}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">simple</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">when</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">camel:camelContext</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"authManager"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pachage.AuthManager"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthManager</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkToken</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Body Document xml, @XPath(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"/Root/Token/@Value"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String token) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> checkSessionToken(token); } }</code> </pre><br>  Another important concept in Camel is the endpoint (hereinafter referred to as endpoint).  Routes can read messages from endpoints, can send messages to endpoints.  Endpoint may be, for example, a RabbitMQ queue, a file in a directory, a published rest service, etc.  If the route reads endpoint, then when a message arrives at this endpoint, the route starts processing it.  This allows you to publish the route, i.e.  give the opportunity to access it by external systems.  If you have a router that performs some task, for example, checks the correctness of the data filled in the questionnaire, then you can publish it as a web service, or give the opportunity to access it through JMS, or you can do both to external systems could use the capabilities of your route, someone through calls to the web service, and someone through the exchange of messages through the JMS queue. <br><br>  Endpoints are also used to enable routes to interact with each other.  One route can send a message to an endpoint that reads another route, thus passing the message to it for processing.  This allows you to create your own palette of routes, implementing various functions that are in demand in different places of your application.  For example, logging messages.  Instead of performing the same set of logging actions each time, you can simply transfer the processing of messages to a route specially designed for this purpose. <br><br><h2>  Integration architecture </h2><br>  Our company uses a number of information systems.  In order to organize an integration environment through which systems will exchange data, you first need to connect our systems to the integration platform.  For this, an adapter is developed for each system on ServiceMix, which will be responsible for exchanging data with the system and converting data formats. <br><br><img src="https://habrastorage.org/webt/wb/2h/zs/wb2hzsq8fqs4m9zytjrgdretpiq.jpeg"><br>  For each system, one data exchange technology is selected between the system and ServiceMix.  You can choose a few, but this complicates the implementation, both on the system side and on the ServiceMix side.  In general, the use of several different technologies is not justified, but technically it can be fully implemented.  We mainly use RabbitMQ to communicate with systems (we create sets of queues through which ServiceMix exchanges messages with integrable systems).  But there are other cases in which the set of ready-made adapters, which is part of ServiceMix, helps us a lot.  For example, in the case of our accounting system, we use stored procedures in the database.  To call stored procedures, use the MyBatis component, which allows you to map messages that run on ServiceMix to the parameters of stored procedures.  Here is an example of such a mapping for the user login procedure by its ID: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"setLogin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">statementType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CALLABLE"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">parameterType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"java.util.Map"</span></span></span><span class="hljs-tag">&gt;</span></span> {call esb.SetLogin ( @UserId=#{UserId, mode=IN}, @LoginId=#{LoginId, mode=IN} )} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Adapters are also responsible for converting the formats in which the systems interact with the integration platform to the internal format.  Someone prefers to exchange in JSON format, someone uses their own XML format, but inside the integration platform the components exchange data in the internal canonical XML format.  Now XML is losing popularity due to its heaviness and the emerging alternatives in the form of JSON, Protobuf, etc.  But, in my opinion, XML is still convenient for solving integration problems.  There are many useful technologies, such as XSLT and XPATH, that greatly simplify life, plus it is quite human-readable. <br><br>  Routing of messages between components (adapters) is carried out on the basis of routing rules.  Routes within a single component of the integration platform interact via internal Camel endpoints (direct, seda).  Between themselves, the components are exchanged via RabbitMQ queues.  This makes the components of the integration platform independent.  The fall of one component does not affect the performance of others.  With a temporary increase in load, messages will accumulate in the component queue, without affecting the rest of the exchange. <br><br><img src="https://habrastorage.org/webt/ek/oa/ah/ekoaahoa7xhkihjueuiolzoislw.jpeg"><br><br>  How is such an architecture better than direct interaction between systems on a point-to-point basis: <br><br><ul><li>  Each system needs to support only one protocol and interaction format. </li><li>  Details of the exchange with other systems are hidden from the systems behind the integration platform.  Systems interact only with the integration platform and may not even know about the existence of other systems, at least not to care about the features of interaction with them. </li><li>  Systems are loosely coupled, which gives additional flexibility, for example, if you need to replace one system with a new one. </li><li>  Monitoring, testing and integration support tools are centralized on the integration platform side. </li></ul><br><h2>  fault tolerance </h2><br><img src="https://habrastorage.org/webt/n5/lm/ps/n5lmpsupchl3tlptud8jeggz6o8.jpeg"><br><br>  Fault tolerance at the RabbitMQ level is achieved by creating a cluster and synchronizing queues.  Each message that enters the queue on one of the RabbitMQ nodes is replicated to other nodes according to the synchronization policy (you can replicate to all the nodes of the cluster, you can replicate to a certain number of nodes, you can not replicate at all).  We use a configuration of three nodes with replication of messages to all nodes.  This allows the cluster to remain fully functional in the event that two of the three nodes fall.  But you need to understand that this is the most costly option in terms of the processing time of each message and the disk space occupied.  On the client, all three nodes are registered to RabbitMQ, while the connection is opened to one of the nodes, but if it drops, the client transparently switches to the other nodes and continues to work. <br><br>  ServiceMix fault tolerance is achieved by using a cluster of two ServiceMix nodes.  In this case, part of the bundles work in parallel, if this is permissible.  For example, adapters that read one RabbitMQ queue can easily do this in parallel, one message will always receive only one of them, but the messages will be evenly distributed between the two nodes.  In the event of a fall of one of the nodes, the second node takes over the entire load.  Some bundles are active only on one node, but when it drops, bundles are activated on the second node.  For example, if the adapter reads a shared network directory, then simultaneously reading the same file can lead to duplication and collisions.  This mode of operation is achieved through the use of shared locks based on Hazelcast.  The bundle that first captures the lock goes into active mode and performs its function, the second bundle hangs waiting for the lock to be released. <br><br><h2>  Hello world </h2><br>  At the end I want to give a simple example of Hello world application on Camel, which we will run on ServiceMix.  Our application will simply write the phrase ‚ÄúHello world‚Äù to the ServiceMix log once when launching the bundle (for example, when you deploy the bundle or restart ServiceMix). <br><br><ol><li>  We download the ServiceMix distribution, unpack and run servicemix.sh (bat). </li><li>  Create and configure a new maven project. <br>  In src / main / resources, you need to create the META-INF directory in which to create the spring subdirectory. <br>  Since  we need to build a bundle - edit pom.xml (add the packaging and build instructions): <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span>4.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>HelloWorld<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>HelloWorld<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0-SNAPSHOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>HelloWorld<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>HelloWorld<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span>bundle<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.apache.felix<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>maven-bundle-plugin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.0.1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">instructions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Bundle-SymbolicName</span></span></span><span class="hljs-tag">&gt;</span></span>${project.artifactId}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Bundle-SymbolicName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Import-Package</span></span></span><span class="hljs-tag">&gt;</span></span>*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Import-Package</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Export-Package</span></span></span><span class="hljs-tag">&gt;</span></span>${project.groupId};version=${project.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Export-Package</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">instructions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  There is no need to add any maven dependencies. <br></li><li>  Configure Camel context and route. <br>  In the spring directory, you need to create a file camel-context.xml (the loader automatically searches for a file with a description of the Camel context in META-INF / spring and starts routes).  In the file camel-context.xml we place the following contents (comments are given in the text): <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">beans</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.springframework.org/schema/beans"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:osgi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.springframework.org/schema/osgi"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:camel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://camel.apache.org/schema/spring"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd http://www.springframework.org/schema/osgi http://www.springframework.org/schema/osgi/spring-osgi.xsd http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  Camel  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">camel:camelContext</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://camel.apache.org/schema/spring"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HelloWorldContext"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HelloWorldRoute"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--          --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"timer://startTimer?repeatCount=1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      Hello world --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">setBody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constant</span></span></span><span class="hljs-tag">&gt;</span></span>Hello world<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constant</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">setBody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">log</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">message</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${body}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">camel:camelContext</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">beans</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In order for our route to perform its task (recorded the text ‚ÄúHello world‚Äù in the log), you need to send a message to it.  In our case, this task is solved by the timer <em>&lt;from uri = "timer: // startTimer? RepeatCount = 1" /&gt;</em> , which, following the instructions <em>repeatCount = 1</em> , sends a message to the route entry once.  Since  the timer sends an empty message to the input of the route, we need to fill it with something - put the text ‚ÄúHello world‚Äù <em>&lt;setBody&gt;</em> in the message body.  At the end of the route, we output the contents of the message body to the log <em>&lt;log message = "$ {body}"&gt;</em> . <br></li><li>  Putting our project: <em>mvn package</em> </li><li>  Deploy the assembled bundle. <br>  One way to secure a bundle in ServiceMix is ‚Äã‚Äãto copy the jar file into the deploy directory.  Copy the built jar to the <em>ServiceMix / deploy</em> directory. </li></ol><br>  Now look at the ServiceMix log: <em>ServiceMix / data / log / servicemix.log</em> .  In addition to the information that we installed and launched the new bundle, the inscription ‚ÄúHello world‚Äù should appear: <br><br>  <em>HelloWorldRoute |</em>  <em>43 - org.apache.camel.camel-core - 2.16.3 |</em>  <em>Hello world</em> <br><br>  Try to enter the ssh console and view the Camel context-list contexts and the route-list routes list.  In the output of the commands, you will find our HelloWorldContext and HelloWorldRoute. <br><br><h2>  findings </h2><br>  In conclusion, I want to say that ServiceMix and Camel are excellent products for building integration solutions.  The functionality is amazing, for almost any task you can find an elegant and simple solution.  It can be seen that the products are very well thought out, the developers really did their best.  In our company, ServiceMix has been used for 2 years already, at the moment we have integrated about 16 of our information systems and have developed more than 150 integration services.  Some components still had problems, but there are always similar components from which to choose or, as a last resort, develop your component.  In general, the products work stably and reliably, personally my impression is the most positive.  The undoubted advantage is the openness of the source code and the absence of the need to buy a license.  At the same time, the products are absolutely not inferior to commercial counterparts.  I also want to note that ServiceMix and Camel can be used not only for solving integration tasks.  For example, Karaf is perfect for deploying web applications into it.  We use this feature to provide web interfaces to administrators for setting up an integration platform.  Camel integrates seamlessly with various business components.  For example, we use Drools (business rules engine) to assign incoming transactions to the corresponding portfolio according to certain rules (enrichment of the transaction with a portfolio), which are configured by users from the middle office.  A very interesting product is Activiti (BPM engine), which can work in a Karaf container and integrate with Camel.  Together, this allows you to create very interesting solutions that combine integration and business functions. </div><p>Source: <a href="https://habr.com/ru/post/358724/">https://habr.com/ru/post/358724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358714/index.html">Two types of PHP extensions. Zend extension VS PHP module</a></li>
<li><a href="../358716/index.html">Documentation Support in ASP.NET Web API</a></li>
<li><a href="../358718/index.html">‚ÄúDig‚Äù into the user using in-depth interviews</a></li>
<li><a href="../358720/index.html">How I implemented graphQL for InterSystems platforms</a></li>
<li><a href="../358722/index.html">Welcome to .Net mitap in Raiffeisenbank UPD Broadcast</a></li>
<li><a href="../358726/index.html">The devil is not so bad as it is described, or how I passed the CISSP exam</a></li>
<li><a href="../358728/index.html">‚ÄúAccording to the GDPR‚Äù: how do social networks change their privacy policies and how they work with PD</a></li>
<li><a href="../358730/index.html">IT Relocation. Review of the pros and cons of living in Bangkok a year later</a></li>
<li><a href="../358732/index.html">Our long-term experiment - the introduction of Dell EMC ScaleIO in the KROK Cloud</a></li>
<li><a href="../358734/index.html">Splunk. A selection of useful materials from TS Solution</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>