<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>React.js - Guide for Rails developers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the initial level, such transfers are my contribution to the development of the rails community. 
 Further in the text everything that is in italic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>React.js - Guide for Rails developers</h1><div class="post__text post__text-html js-mediator-article">  <i>At the initial level, such transfers are my contribution to the development of the rails community.</i> <br>  <i>Further in the text everything that is in italics, my comments (there will not be many of them)</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7f8/0c6/fe0/7f80c6fe03d73212bc0768490700c3de.png" alt="image"><br><br>  <b>Introduction to React.js</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>React.js</b> is a new popular guy from the JavaScript team of frameworks, he stands out for his simplicity.  When other frameworks implement the full <b>MVC</b> (Model View Controller) approach, we can tell React to implement only the View (Mapping) (fact - some people rewrite part of the mapping (V) of these frameworks using React). <br><br>  Reactor applications are based on the two basic principles of Components and States.  Components may consist of smaller components built-in or custom.  The states that the guys from Facebook call a one-way reactive data stream, meaning that our interface (UI) will respond to every state change. <br><br>  One good feature of React.js is that it does not require any additional dependencies, which ensures its connectivity with any js library.  Using this, we will include it in our Rails stack to create an external interface or you can say to create "Rails on steroids." <br><br><h1>  Layout for tracking application expenses </h1><br><br>  For this guide, we will create a small application from scratch to track our actions.  Each record ( <i>further, the same as a Record</i> ) will consist of a date, name and amount.  A record will be treated as a Credit if its amount is greater than zero, otherwise it will be considered a cash card.  Here is the project layout: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b1/641/e13/3b1641e134a4819b1ba616aa202a05b8.png" alt="image"><br><br>  In total, the application will behave like this: <br><ol><li>  When the user creates a new record through the horizontal form, it will be inserted into the table of records. </li><li>  User can edit any existing entry. </li><li>  Clicking the Delete button will remove the association from the table. </li><li>  Adding, editing or deleting an existing entry will update the amount in boxes at the top of the page. </li></ol><br><br><h1>  Initializing React.js to a Rails project </h1><br><a name="habracut"></a><br>  First of all, we need to create our new project, let's call it <b>Accounts.</b> <br><pre><code class="bash hljs">rails new accounts</code> </pre> <br>  For the user interface of this project we will use <code>bootstrap</code> .  The installation process is beyond the scope of this article, but you can install the official <code>bootstrap-sass</code> using instructions from the <a href="https://github.com/twbs/bootstrap-sass">git repository</a> . <br><br>  Now our project is installed.  Continue to connect <code>React</code> .  For this guide, I decided to connect it from the official gem because we will use some cool features of this gem, but there is another way to achieve our goal of using Rails or we can download the source code from the official page and paste into our <code>javascripts</code> folder. <br><br>  If you have been developing Rails applications, you know how easy it is to install <code>react-rails</code> : Add <code>react-rails</code> to your <code>Gemfile</code> <br><pre> <code class="ruby hljs"> gem <span class="hljs-string"><span class="hljs-string">'react-rails'</span></span>, <span class="hljs-string"><span class="hljs-string">'~&gt; 1.0'</span></span></code> </pre><br>  Then kindly tell the rails to set a new gem. <br><pre> <code class="bash hljs">bundle install</code> </pre><br>  <b>React-rails</b> comes with installing a script that will create the <code>components.js</code> file inside the <code>app/assets/javascripts</code> folder where our <b>React</b> components will live. <br><pre> <code class="bash hljs">rails g react:install</code> </pre><br>  If you look in your <code>application.js</code> file after launching the installation, you will see 3 new lines: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//= require react //= require react_ujs //= require components</span></span></code> </pre><br>  Essentially, this includes the React library, components, and similar files are stored in <code>ujs</code> As you might guess from the file name, <code>react-rails</code> contains an unobtrusive JS driver that will help you install our React components and also handle Turbolinks events. <br><br><h1>  Resource creation </h1><br><br>  We will create a <code>Record</code> resource, which will consist of the date (date) of the title (title) and the amount (amount). <br>  Instead of using <code>scaffold</code> 'a generation, we will use a <code>resource</code> generator, <br>  we will not use all the files and methods created using the scaffold generator.  Otherwise, it would be possible to run the scapold and then delete unused files / methods, but our project would be a bit dirty in that case.  After that, inside the project, run the following command: <br><pre> <code class="bash hljs">rails g resource Record title date:date amount:<span class="hljs-built_in"><span class="hljs-built_in">float</span></span></code> </pre><br>  After this magic, we have a new model (Model) controller (Controller) and routes (routes).  Now we will create a database and start the migrations: <br><pre> <code class="bash hljs">rake db:create db:migrate</code> </pre><br>  Plus, you can create a couple of records through <br><pre> <code class="bash hljs">rails console Record.create title: <span class="hljs-string"><span class="hljs-string">'Record 1'</span></span>, date: Date.today, amount: 500 Record.create title: <span class="hljs-string"><span class="hljs-string">'Record 2'</span></span>, date: Date.today, amount: -100</code> </pre><br>  Do not forget to start your server <br><pre> <code class="bash hljs">rails s</code> </pre> <br>  Done!  We can write code. <br><br><h1>  Nested Components: Records List </h1><br><br>  For our first task, we need to render any record created within the table. <br>  First, we need to create an <code>index</code> action inside the <code>RecordsController</code> controller: <br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># app/controllers/records_controller.rb class RecordsController &lt; ApplicationController def index </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@records</span></span></span><span class="hljs-comment"> = Record.all end end</span></span></code> </pre><br>  Now we need to create a new <code>index.html.erb</code> file in <code>apps/views/records/</code> , this file will be the bridge between our Rails application and the React components.  To accomplish this task, we will use the helper method <code>react_component</code> , which gets the name React, the component we want to render along with the data that we pass to it. <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%#</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">views</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">records</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">index.html.erb</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">react_component</span></span></span><span class="hljs-tag"> '</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Records</span></span></span><span class="hljs-tag">', { </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data:</span></span></span><span class="hljs-tag"> @</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">records</span></span></span><span class="hljs-tag"> } %&gt;</span></span></code> </pre><br>  It is worth noting that this helper is provided by the react-rails gem, if you decide to use another integration React method, this helper will not be available. <br><br>  Now you can go to <code>localhost:3000/records</code> .  Obviously something is wrong, all because there are no Records (React components).  But if you take the generated HTML inside the browser, we can insert something like this. <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-react-class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Records"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-react-props</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{...}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  With this markup, <code>react_ujs</code> will determine, we are trying to render the React component and create an instance of it, including the settings we send via <code>react_component</code> , in our case, the <code>@records</code> content <br><br>  It's time to create our first component, inside the <code>javascripts/components</code> directory create a new file: <code>records.js.coffee</code> , this file will contain our <code>Records</code> component. <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/records.js.coffee @Records = React.createClass render: -&gt; React.DOM.div className: 'records' React.DOM.h2 className: 'title' 'Records'</span></span></code> </pre><br>  Each component requires a render method that will change the rendering of its components, the method must return an instance of the <code>ReactComponent</code> class, so when React implements the re-render it will be executed optimally. <br><br>  Comment.  In another case, an instance of <code>ReactComponents</code> inside the render method can be written using JSX syntax. <br>  Equivalent to code above: <br><pre> <code class="coffeescript hljs"> render: <span class="hljs-function"><span class="hljs-function">-&gt;</span></span> `<span class="javascript"><span class="javascript">&lt;div className=</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"records"</span></span></span><span class="javascript">&gt; </span><span class="xml"><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag"> </span></span></span><span class="hljs-attr"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">=</span></span></span><span class="hljs-string"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="javascript"><span class="xml"> Records </span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span><span class="javascript"> &lt;</span><span class="hljs-regexp"><span class="javascript"><span class="hljs-regexp">/div&gt;</span></span></span></span>`</code> </pre><br>  For me personally, when I work with CoffeeScript, I prefer to use <code>React.DOM</code> syntax because the code will be converted to a hierarchical structure, as in HAML On the other hand, if you try to integrate React into an existing project with ERB, you can reuse existing ERB code and convert it to JSX. <br><br>  Refresh your browser <br><br><img src="https://i.imgur.com/jrehS5B.png" alt="image"><br><br>  Fine.  We have rendered our first React component.  Now it's time to display our records. <br><br>  In addition, the render method of the React components relies on the use of settings for exchanging with other components and states in order to understand whether re-rendering is necessary or not.  We need to initialize the state and properties of our component with the required values. <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/records.js.coffee @Records = React.createClass getInitialState: -&gt; records: @props.data getDefaultProps: -&gt; records: [] render: -&gt; ...</span></span></code> </pre><br>  The <code>getDefaultProps</code> method will initialize the settings of our components in the case when we forget to transfer data, when we instantiate it and the <code>getInitialState</code> method will generate the initial state of our components.  Now we generally need to display records using our Rails view. <br><br>  It seems that we need a helper method for formatting the number of lines, we can insert simple formatting of lines and make it available for all <code>coffee</code> files. Create a new <code>utils.js.coffee</code> file in <code>javascripts/</code> with the following content: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/utils.js.coffee @amountFormat = (amount) -&gt; '$ ' + Number(amount).toLocaleString()</span></span></code> </pre><br>  We need to create a new Record component, display each individual record, create a new <code>record.js.coffee</code> file in the <code>javascripts/components</code> directory and insert the following code: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record.js.coffee @Record = React.createClass render: -&gt; React.DOM.tr null, React.DOM.td null, @props.record.date React.DOM.td null, @props.record.title React.DOM.td null, amountFormat(@props.record.amount)</span></span></code> </pre><br>  Record component should be displayed in a table column containing a cell for each attribute of the record.  Do not worry about these <code>null</code> in <code>React.DOM.*</code> Calls, this means that we are not passing attributes to the components <code>React.DOM.*</code> we will update the render method inside the Records components with the following code: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/records.js.coffee @Records = React.createClass ... render: -&gt; React.DOM.div className: 'records' React.DOM.h2 className: 'title' 'Records' React.DOM.table className: 'table table-bordered' React.DOM.thead null, React.DOM.tr null, React.DOM.th null, 'Date' React.DOM.th null, 'Title' React.DOM.th null, 'Amount' React.DOM.tbody null, for record in @state.records React.createElement Record, key: record.id, record: record</span></span></code> </pre><br>  Did you see what just happened?  We created a table with a header and body inside.  We created a Record element for each existing record.  In other words, we put in build-in / custom React components, Cool.  true? <br><br>  When we have dynamic inheritors (in our case, records), we need to provide a configuration key for dynamic generation of items, so React does not have a long update time for our UI (user interface) because we are passing <br>  key: <code>record.id</code> along with the current record when creating a Record element.  If we do not do this, we need to get a warning in our JS browser console (and probably in the near future, sometimes, get a headache). <br><br><img src="https://i.imgur.com/vETiEeFg.png" alt="image"><br><br>  You can see the code for this section <a href="https://github.com/fervisa/accounts-react-rails/tree/bf1d80cf3d23a9a5e4aa48c86368262b7a7bd809">here</a> or you can see the section <a href="https://github.com/fervisa/accounts-react-rails/commit/bf1d80cf3d23a9a5e4aa48c86368262b7a7bd809">changes</a> . <br><br><h1>  The relationship between parents and children: creating Records </h1><br><br>  Now we display all the created records. It would also be great to include a form for creating a new record.  Let's add this feature to our React / Rails application.  First, we need to add our controller's <code>create method</code> (don't forget to use <code>_strongparams</code> ) <br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RecordsController</span></span></span><span class="hljs-class"> &lt; ApplicationController ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">create</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">record</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Record</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">record_params</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">record</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">save</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">render</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">json</span></span></span><span class="hljs-class">: @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">record</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">else</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">render</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">json</span></span></span><span class="hljs-class">: @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">record</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">errors</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">status</span></span></span><span class="hljs-class">: :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unprocessable_entity</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">record_params</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">params</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">require</span></span></span><span class="hljs-class">(:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">record</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">permit</span></span></span><span class="hljs-class">(:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">date</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  Next, we need to create a React component and track the creation of a new record.  The component will have its own state to store the date (date) title (title) and amount (amount). <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record_form.js.coffee @RecordForm = React.createClass getInitialState: -&gt; title: '' date: '' amount: '' render: -&gt; React.DOM.form className: 'form-inline' React.DOM.div className: 'form-group' React.DOM.input type: 'text' className: 'form-control' placeholder: 'Date' name: 'date' value: @state.date onChange: @handleChange React.DOM.div className: 'form-group' React.DOM.input type: 'text' className: 'form-control' placeholder: 'Title' name: 'title' value: @state.title onChange: @handleChange React.DOM.div className: 'form-group' React.DOM.input type: 'number' className: 'form-control' placeholder: 'Amount' name: 'amount' value: @state.amount onChange: @handleChange React.DOM.button type: 'submit' className: 'btn btn-primary' disabled: !@valid() 'Create record'</span></span></code> </pre><br>  Nothing creative, just the inline form of bootstrap.  Notice how we determine the attribute value by setting the input's value (input's), the <code>onChange</code> attribute attaches and processes the method that was called with each keystroke, the handleChange <code>handleChange</code> method will use the attribute name, which input caused the event and updated the value state. <br> <code># app/assets/javascripts/components/record_form.js.coffee <br> <br> @RecordForm = React.createClass <br> ... <br> handleChange: (e) -&gt; <br> name = e.target.name <br> @setState "#{ name }": e.target.value <br></code> <br>  We simply use the string interpreter to dynamically define the key of keys equivalent to <code>@setState title: e.target.value</code> when the name matches title.  But why should we use <code>@setState</code> ?  Why can't we just set the desired &lt;co value in <a href="https://habrahabr.ru/users/state/" class="user_link">state</a> as we usually do in regular&gt; JS objects?  Because <code>@setState</code> must perform 2 actions, this is: <br><ol><li>  Update Status Components </li><li>  Plan UI check / update based on new state </li></ol><br>  It is very important to have this information in memory every time we use the state inside our component.  Let's look at the submit button, only at the end of the render method. <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record_form.js.coffee @RecordForm = React.createClass ... render: -&gt; ... React.DOM.form ... React.DOM.button type: 'submit' className: 'btn btn-primary' disabled: !@valid() 'Create record'</span></span></code> </pre><br>  We defined the <code>disabled</code> attribute along with the value <code>!@valid()</code> , implying that we are going to implement a valid method to evaluate if the data provided by the user is correct. <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record_form.js.coffee @RecordForm = React.createClass ... valid: -&gt; @state.title &amp;&amp; @state.date &amp;&amp; @state.amount</span></span></code> </pre><br>  For simplicity, we only validate the <code>@state</code> attribute with empty lines again.  Thus, each time the state receives updates, the <code>Create record</code> button on / off depends on the validation of the data. <br><br><img src="https://i.imgur.com/EuPQ64m.png" alt="image"><br><br>  Now our controller and form are in place.  The time has come to send our new record to the server.  We need to process the event presentation forms.  To accomplish the task, we need to add an attribute of our form to <code>onSubmit</code> and a new <code>handleSubmit</code> method (we did the same with the <code>onChange</code> event). <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record_form.js.coffee @RecordForm = React.createClass ... handleSubmit: (e) -&gt; e.preventDefault() $.post '', { record: @state }, (data) =&gt; @props.handleNewRecord data @setState @getInitialState() , 'JSON' render: -&gt; React.DOM.form className: 'form-inline' onSubmit: @handleSubmit ...</span></span></code> </pre><br>  View the new method line by line: <br><ol><li>  Prevent submission form </li><li>  POST new record information of the current URL </li><li>  Successful callback </li></ol><br><br>  A successful callback is the key to this process, after successfully creating a new record, someone must report this action, and the status is updated to the new value.  Do you remember when I mentioned that this component interacts with other components through settings (or <code>@props</code> )?  So, it is.  Our current component sends information back to the parent component via <code>@props.handleNewRecord</code> informing about the creation of a new record. <br><br>  As you could guess when we create our <code>RecordForm</code> element, we need to pass a <code>handleNewRecord</code> setting with a link to a method in it, something like <code>React.createElement RecordForm</code> , <code>handleNewRecord: @addRecord</code> .  Well, the parent Records component is ‚Äúeverywhere‚Äù as it has a state with all of the existing records. We need to update this state with the new record created. <br>  Add a new <code>addRecord</code> method inside the <code>records.js.coffee</code> and create a new <code>RecordForm</code> element, just after the h2 title (inside the render method). <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/records.js.coffee @Records = React.createClass ... addRecord: (record) -&gt; records = @state.records.slice() records.push record @setState records: records render: -&gt; React.DOM.div className: 'records' React.DOM.h2 className: 'title' 'Records' React.createElement RecordForm, handleNewRecord: @addRecord React.DOM.hr null</span></span></code> </pre><br>  Update your browser, fill out the form with a new record, click on <code>Create record</code> not surprising, this time the record was added almost immediately and the form became empty after clicking.  The update was just completed, of course the backend was filled with new data. <br><img src="https://i.imgur.com/635Wuv7.png" alt="image"><br><br>  If you use another JS framework together with React ( <b>Angular</b> for example) and create similar features, then you may have problems, because your POST request does not include the CSRF token required by Rails, so why haven't we encountered this question?  Just because we use <code>jquery</code> to interact with our backend and <code>Rails jquery_ujs</code> unobtrusive driver, will include a CSRF token on each of our AJAX requests.  Cool. <br><br>  You can see the result of the code in <a href="https://github.com/fervisa/accounts-react-rails/tree/f4708e19f8be929471bc0c8c2bda93f36b9a7f23">this</a> section, or see the changes <a href="https://github.com/fervisa/accounts-react-rails/commit/f4708e19f8be929471bc0c8c2bda93f36b9a7f23">here.</a> <br><br><h1>  Component reuse </h1><br><br>  What would the application want without some (good) indicators?  Let's add some boxes at the top of our window with some information used.  We denote 3 boxes for boxes: Total amount of credits, total amount of debit and balance. <br>  Does this look like working with three components or maybe just one of the settings? <br><br>  We can create a new <code>AmountBox</code> component that will receive the settings: the amount of text and type.  Creating a new file will call <code>amount_box.js.coffee</code> from <code>javascripts/components/</code> and insert the following code: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/amount_box.js.coffee @AmountBox = React.createClass render: -&gt; React.DOM.div className: 'col-md-4' React.DOM.div className: "panel panel-#{ @props.type }" React.DOM.div className: 'panel-heading' @props.text React.DOM.div className: 'panel-body' amountFormat(@props.amount)</span></span></code> </pre><br>  We simply use the bootstrap panel, the element displays information in the "blocky" method and sets the color through the type of setting. <br>  We also have an included and very simple number of formatted methods called <code>amountFormat</code> that read the number of settings and display it in a currency format. <br><br>  There is a complete solution in the order.  We need to create this element 3 times within our main component to transfer the required settings depending on the data we want to display.  Let's create calculation methods.  First, open the <code>Record</code> component and add the following method: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/records.js.coffee @Records = React.createClass ... credits: -&gt; credits = @state.records.filter (val) -&gt; val.amount &gt;= 0 credits.reduce ((prev, curr) -&gt; prev + parseFloat(curr.amount) ), 0 debits: -&gt; debits = @state.records.filter (val) -&gt; val.amount &lt; 0 debits.reduce ((prev, curr) -&gt; prev + parseFloat(curr.amount) ), 0 balance: -&gt; @debits() + @credits() ...</span></span></code> </pre><br>  The amount of <code>credits</code> all entries with a value greater than 0. The sum of debits of all entries with a sum less than 0 and the value of the balance.  Now we have in the right place calculating methods.  We just need to create the <code>AmountBox</code> element inside, to render the method (just above the <code>RecordForm</code> component) <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/records.js.coffee @Records = React.createClass ... render: -&gt; React.DOM.div className: 'records' React.DOM.h2 className: 'title' 'Records' React.DOM.div className: 'row' React.createElement AmountBox, type: 'success', amount: @credits(), text: 'Credit' React.createElement AmountBox, type: 'danger', amount: @debits(), text: 'Debit' React.createElement AmountBox, type: 'info', amount: @balance(), text: 'Balance' React.createElement RecordForm, handleNewRecord: @addRecord ...</span></span></code> </pre><br>  We are done with this feature!  Update your browser.  You must have seen 3 displayed boxes, we calculated the amounts earlier.  But wait!  Is there some more!  Create a new record and see the magic in the work. <br><br><img src="https://i.imgur.com/YWEcQHh.png" alt="image"><br><br>  You can see the result <a href="https://github.com/fervisa/accounts-react-rails/tree/8d6f0a4fb62f2a9abd5d34d502461388863302cb">code</a> <br>  corrections <a href="https://github.com/fervisa/accounts-react-rails/commit/8d6f0a4fb62f2a9abd5d34d502461388863302cb">here</a> <br><br><h1>  setState / replaceState: deleting entries </h1><br><br>  The next feature on our list is the deletion of a record.  We need a new action column in our table of records.  This column will have a Delete button for each entry, a pretty standard UI.  As in our previous example, we need to create and delete a method in our Rails controller. <br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># app/controllers/records_controller.rb class RecordsController &lt; ApplicationController ... def destroy </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@record</span></span></span><span class="hljs-comment"> = Record.find(params[:id]) </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@record</span></span></span><span class="hljs-comment">.destroy head :no_content end ... end</span></span></code> </pre><br>  This is all the server side code we need for this feature.  Now open your <code>Records React</code> component and add a column in the actions to the header in the table header. <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/records.js.coffee @Records = React.createClass ... render: -&gt; ... # almost at the bottom of the render method React.DOM.table React.DOM.thead null, React.DOM.tr null, React.DOM.th null, 'Date' React.DOM.th null, 'Title' React.DOM.th null, 'Amount' React.DOM.th null, 'Actions' React.DOM.tbody null, for record in @state.records React.createElement Record, key: record.id, record: record</span></span></code> </pre><br>  Finally, open the Record component and add an extra column with the Delete link. <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record.js.coffee @Record = React.createClass render: -&gt; React.DOM.tr null, React.DOM.td null, @props.record.date React.DOM.td null, @props.record.title React.DOM.td null, amountFormat(@props.record.amount) React.DOM.td null, React.DOM.a className: 'btn btn-danger' 'Delete'</span></span></code> </pre><br>  Save your file, update your browser and We have a non-working button without any events attached to it. <br><br><img src="https://i.imgur.com/JV1KVNK.png" alt="image"><br><br>  Let's add some functionality.  As we learned from our <code>RecordForm</code> component using the list: <br><ol><li>  Delete the event of the internal child component Record (onClick) </li><li>  Perform action (send DELETE request to the server in this case) </li><li>  Notify Records of parent components about this action (sending / receiving handler method through settings) </li><li>  Update Record Component State </li></ol><br><br>  To implement the first step, we can add an <code>OnClick</code> handler to the <code>Record</code> in the same way, we added a handler for <code>onSubmit</code> to the <code>RecordForm</code> to create new records.  Fortunately for us, React implements most of the common browser events in a normal way.  Therefore, we do not have to worry about cross-browser compatibility (you can look at the full list of events <a href="http://facebook.github.io/react/docs/events.html">here</a> ). <br><br>  Open the recording component again, add a new method, the <code>handleDelete</code> and the <code>OnClick</code> attribute to our ‚Äúuseless‚Äù delete button as follows: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record.js.coffee @Record = React.createClass handleDelete: (e) -&gt; e.preventDefault() # yeah... jQuery doesn't have a $.delete shortcut method $.ajax method: 'DELETE' url: "/records/#{ @props.record.id }" dataType: 'JSON' success: () =&gt; @props.handleDeleteRecord @props.record render: -&gt; React.DOM.tr null, React.DOM.td null, @props.record.date React.DOM.td null, @props.record.title React.DOM.td null, amountFormat(@props.record.amount) React.DOM.td null, React.DOM.a className: 'btn btn-danger' onClick: @handleDelete 'Delete'</span></span></code> </pre><br>  When the click on the delete button occurs, the <code>handleDelete</code> sends an AJAX request to the server. <br>  to delete an entry on the backend and after that the parent component will be told about this action through the <code>handleDeleteRecord</code> handler is available through the settings, this means we need to regulate the creation of Record elements in the parent component, <br>  to enable the additional property <code>handleDeleteRecord</code> , as well as implement the actual handler method in the ancestors: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/records.js.coffee @Records = React.createClass ... deleteRecord: (record) -&gt; records = @state.records.slice() index = records.indexOf record records.splice index, 1 @replaceState records: records render: -&gt; ... # almost at the bottom of the render method React.DOM.table React.DOM.thead null, React.DOM.tr null, React.DOM.th null, 'Date' React.DOM.th null, 'Title' React.DOM.th null, 'Amount' React.DOM.th null, 'Actions' React.DOM.tbody null, for record in @state.records React.createElement Record, key: record.id, record: record, handleDeleteRecord: @deleteRecord</span></span></code> </pre><br>  Basically, our <code>deleteRecord</code> method copies the current record state component, the search index of the record you want to delete.  cute standard js operations. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We have introduced a new way to interact with the state of </font></font><code>replaceState</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the main difference between </font></font><code>setState</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>replaceState</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is that the former will only update a state of an object key, and the second will be completely override the current state of the component to any new object that we send. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After updating the last bit of the code, refresh the browser window and try to delete the record, two things should happen:</font></font><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The record should disappear from the table </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The indicator should instantly update the count (no other code is needed for this). </font></font></li></ol><br><br><img src="https://i.imgur.com/fjoCUYN.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We are almost done, but before installing the last feature, we can apply a small refactoring at the same time, introduce a new React function. </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Refactor: State Helpers </font></font></h1><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Last feature. We will add an additional button </font></font><code>Edit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">after each </font></font><code>Delete</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">button to our table. When we click on the button, </font></font><code>Edit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it will switch the entire line and readonly state to the editing state by opening the inline form, where the user can update the contents of the records. After submitting the updated content or canceling the action to the line, the record will return to its original read-only state. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you guessed from the previous chapter, we need to process several data to switch each state of records within our component </font></font><code>Record</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This is a case of using what React calls reactive data streams. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's add the edit flag and the handleToggle method to record.js.coffee:</font></font><br><br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record.js.coffee @Record = React.createClass getInitialState: -&gt; edit: false handleToggle: (e) -&gt; e.preventDefault() @setState edit: !@state.edit ...</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The default edit flag will be turned off, and the </font></font><code>handleToggle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">edit will change from false to true, and vice versa, we just need to start </font></font><code>handleToggle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an </font></font><code>OnClick</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">event </font><font style="vertical-align: inherit;">with the user </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we need to manage two versions of the read / read_and edit line and display them conditionally depending on the editing. Fortunately for us, as long as our visualization method returns the React element, we are free to perform any actions in it;</font></font> we <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we can define several auxiliary methods </font></font><code>recordRow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>recordForm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">call them conditionally inside the visualization depending on the content </font></font><code>@ state.edit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We already have the first option </font></font><code>recordRow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, this is our current visualization method. </font><font style="vertical-align: inherit;">Let's move the rendering content to our brand new method </font></font><code>recordRow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and add additional code to it:</font></font><br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record.js.coffee @Record = React.createClass ... recordRow: -&gt; React.DOM.tr null, React.DOM.td null, @props.record.date React.DOM.td null, @props.record.title React.DOM.td null, amountFormat(@props.record.amount) React.DOM.td null, React.DOM.a className: 'btn btn-default' onClick: @handleToggle 'Edit' React.DOM.a className: 'btn btn-danger' onClick: @handleDelete 'Delete' ...</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We just added an extra </font></font><code>React.DOM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">A member waits for a signal from </font></font><code>onClick</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for a call. </font></font><code>handleToggle</code> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Move on. </font><font style="vertical-align: inherit;">The implementation </font></font><code>recordForm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">should be of the following structure but with an input field in each cell. </font><font style="vertical-align: inherit;">We will use the new </font></font><code>ref</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attribute for our inputs, make them available; </font><font style="vertical-align: inherit;">since this component does not process the state, this new attribute will allow our component to read the data provided by the user through</font></font><code>@refs:</code> <br><br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record.js.coffee @Record = React.createClass ... recordForm: -&gt; React.DOM.tr null, React.DOM.td null, React.DOM.input className: 'form-control' type: 'text' defaultValue: @props.record.date ref: 'date' React.DOM.td null, React.DOM.input className: 'form-control' type: 'text' defaultValue: @props.record.title ref: 'title' React.DOM.td null, React.DOM.input className: 'form-control' type: 'number' defaultValue: @props.record.amount ref: 'amount' React.DOM.td null, React.DOM.a className: 'btn btn-default' onClick: @handleEdit 'Update' React.DOM.a className: 'btn btn-danger' onClick: @handleToggle 'Cancel' ...</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do not worry. </font><font style="vertical-align: inherit;">This method could be more but it is just an html syntax.</font></font><br>  Comment.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We call </font></font><code>@handleEdit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">when the user clicks a button </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, we are going to use the same thread as one implementation to delete the records. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Did you notice the difference in how they are created </font></font><code>React.DOM.inputs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">We use </font></font><code>defaultValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the default instead of specifying the initial input data, this is because using only the value without </font></font><code>OnChange</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will eventually be created only for reading input. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally, the visualization method comes down to the following code:</font></font><br><br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record.js.coffee @Record = React.createClass ... render: -&gt; if @state.edit @recordForm() else @recordRow()</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can update your browser to play with the new switching behavior, but it does not represent any changes, since we did not realize the real possibility of updating. </font></font><br><br><img src="https://i.imgur.com/dwNuuXw.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To handle updates of records, we need to add an update method to our Rails controller:</font></font><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># app/controllers/records_controller.rb class RecordsController &lt; ApplicationController ... def update </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@record</span></span></span><span class="hljs-comment"> = Record.find(params[:id]) if </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@record</span></span></span><span class="hljs-comment">.update(record_params) render json: </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@record</span></span></span><span class="hljs-comment"> else render json: </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@record</span></span></span><span class="hljs-comment">.errors, status: :unprocessable_entity end end ... end</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's go back to our record component, we need to implement a method </font></font><code>handleEdit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that will send an AJAX request to the server with updated record information, then it notifies the parent component by sending an updated version of the record using the method </font></font><code>handleEditRecord</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, this method will be received through </font></font><code>@props</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, just as we did it before when deleting records:</font></font><br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/record.js.coffee @Record = React.createClass ... handleEdit: (e) -&gt; e.preventDefault() data = title: React.findDOMNode(@refs.title).value date: React.findDOMNode(@refs.date).value amount: React.findDOMNode(@refs.amount).value # jQuery doesn't have a $.put shortcut method either $.ajax method: 'PUT' url: "/records/#{ @props.record.id }" dataType: 'JSON' data: record: data success: (data) =&gt; @setState edit: false</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For simplicity, we did not check the user data, we simply read it through </font></font><code>React.findDOMNode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>@ refs.fieldName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) .value and send it literally to the backend. Updating the status to switch to edit mode for success is not mandatory, but the user will certainly thank us for it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Last but not least, we just need to update the state on the Records component to overwrite the old record with the new version of the child record and let React perform its magic. The implementation might look like this:</font></font><br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># app/assets/javascripts/components/records.js.coffee @Records = React.createClass ... updateRecord: (record, data) -&gt; index = @state.records.indexOf record records = React.addons.update(@state.records, { $splice: [[index, 1, data]] }) @replaceState records: records ... render: -&gt; ... # almost at the bottom of the render method React.DOM.table React.DOM.thead null, React.DOM.tr null, React.DOM.th null, 'Date' React.DOM.th null, 'Title' React.DOM.th null, 'Amount' React.DOM.th null, 'Actions' React.DOM.tbody null, for record in @state.records React.createElement Record, key: record.id, record: record, handleDeleteRecord: @deleteRecord, handleEditRecord: @updateRecord</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As we learned in the previous section, using a </font></font><code>React.addons.update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">change in our state can lead to more specific methods. </font><font style="vertical-align: inherit;">The final link between Records and Record is the method </font></font><code>@updateRecord</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it is transmitted through the </font></font><code>handleEditRecord</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">settings. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Update your browser for the last time and try to update some existing entries, notice how the boxes at the top of the page, monitor each entry that you change. </font></font><br><img src="https://i.imgur.com/qLPVSlU.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We have done! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We just built a small Rails + React application from scratch! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can see the result of the code </font></font><a href="https://github.com/fervisa/accounts-react-rails/tree/1a62dd0e48b31aa55659e0035e754cee1776aa61"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> new edits </font></font><a href="https://github.com/fervisa/accounts-react-rails/commit/1a62dd0e48b31aa55659e0035e754cee1776aa61"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a> <br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Final thought: React.js, simplicity and flexibility </font></font></h1><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We looked at some of the functionality of React and found out that it barely introduces new concepts. I heard comments like people say X or Y framework, JavaScript has a steep learning curve due to all the newly-introduced concepts, this is not a React case; it implements basic JavaScript concepts such as event handlers and bindings, which makes it easy to learn and learn. Again, one of his strengths is his simplicity.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We also learned by example how to integrate it into ‚Äúactive work and how well it plays along with CoffeeScript, jQuery, Turbolinks, and the rest of the rails.‚Äù The rail orchestra, so to speak. </font><font style="vertical-align: inherit;">But this is not the only way to achieve the desired results. </font><font style="vertical-align: inherit;">For example, if you don‚Äôt use Turbolinks (which means you don‚Äôt need react_ujs) you can use Rails assets instead of the react-reils heme, you could use JBuilder to build more complex JSON responses instead of rendering JSON objects; </font><font style="vertical-align: inherit;">however, you can still get the same excellent results.</font></font></div><p>Source: <a href="https://habr.com/ru/post/281735/">https://habr.com/ru/post/281735/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../281725/index.html">News of the world of IT. April</a></li>
<li><a href="../281727/index.html">Angular 2 Beta, training course "Tour of Heroes" part 2</a></li>
<li><a href="../281729/index.html">Security Week 15: Badlock is not impressed, more cryptographs, another vulnerability in iMessage</a></li>
<li><a href="../281731/index.html">Manifesto of future changes through the prism of the market</a></li>
<li><a href="../281733/index.html">Palantir: Object Model</a></li>
<li><a href="../281737/index.html">Information for admirals of space fleets</a></li>
<li><a href="../281739/index.html">Competition for the best publication about the development, design or testing of a mobile application</a></li>
<li><a href="../281743/index.html">Hacker talked about the compromise of the Hacking Team</a></li>
<li><a href="../281745/index.html">Can all financial models be erroneous: 7 sources of risk of losses</a></li>
<li><a href="../281747/index.html">Aggregate functions in dplyr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>