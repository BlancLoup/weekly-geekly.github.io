<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing and configuring Puppet version 3.8 using the example of Centos 6.5</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Puppet, Chef, Ansible are the so-called configuration management systems, which can often be found in foreign IT job vacancies such as Server / DevOps...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing and configuring Puppet version 3.8 using the example of Centos 6.5</h1><div class="post__text post__text-html js-mediator-article">  <b>Puppet, Chef, Ansible</b> are the so-called configuration management systems, which can often be found in foreign IT job vacancies such as Server / DevOps Admin.  In fact, these are powerful tools that can fully configure the zero server or quickly enough to massively reconfigure a set of 1-100 + servers.  Work with packages, with the command line, configuration files, everything is available. <br><br>  An overview can be found in the publication <a href="http://habrahabr.ru/post/163811/">How to become a puppeteer</a> . <br><br>  Actually, the writing of this initial article for Puppet led me to a very poor description in the results found on the Internet.  And even with the use of official <a href="http://docs.puppetlabs.com/">documentation you</a> manage to stumble upon a bunch of rakes and pitfalls and get not what you expected. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The reason for using the 3.8 branch, instead of 4.3, is to use this version on ‚Äúmy‚Äù servers due to the presence of these packages in the repo.  The paid Enterprise option is also not considered, since I have not worked with it.  The reason for using Centos is that it is widely distributed, including modified versions from Amazon. <br><br>  For local tests, you can use two virtualboxes on VirtualBox under <b>CentOS-6.5-x86_64</b> . <br><br><a name="habracut"></a><br>  To begin with, two interfaces are configured: to go to the external Internet and to create a local network for puppet.  The hostname will conditionally be pmaster.test.net, and the node for the client (more nodes are possible) stage.test.net.  We will register them on all nodes in hosts (of course, if only you do not have your own DNS server for them). <br><br><pre><code class="bash hljs">10.1.1.10 pmaster.test.net 10.1.1.11 stage.test.net</code> </pre> <br>  Additional recommendation from off site - open port 8140. <br><br>  <i>upd.</i>  <i>iscsi</i> <br>  It is also recommended to set SELINUX = permissive parameter in / etc / sysconfig / selinux, at the very least disabled. <br><br>  The current version of the installation manual from puppetlabs is <a href="https://docs.puppetlabs.com/guides/install_puppet/pre_install.html">here</a> , which shows very important nuances that are missing in your article, for example, NTP. <br>  <i>/ upd.</i>  <i>iscsi</i> <br><br><h4>  Install / configure client / server pair </h4><br>  We begin the installation of the server.  We import two repos for packages into the system: <br><br><pre> <code class="bash hljs">rpm -ivh http://yum.puppetlabs.com/puppetlabs-release-el-6.noarch.rpm rpm -ivh http://mirror.logol.ru/epel/6/i386/epel-release-6-8.noarch.rpm</code> </pre><br>  Put the server package: <br><br><pre> <code class="bash hljs">yum ‚Äìy install puppet-server</code> </pre><br>  In the load put an exotic type: <br><br><pre> <code class="bash hljs">hiera 1.3.4-1.el6 ruby 1.8.7.374-4.el6_ rubygems 1.3.7</code> </pre><br>  T. h. Who is critical, be careful with updates.  As a result, we get: <br><br>  <b>/etc/init.d/puppetmaster</b> is the first way to work through the service for tests and node registration.  Next, we will switch to the option of working through heme under Apache. <br><br>  <b>/ etc / sysconfig / puppet</b> - microconfig.  It is recommended to uncomment a line to get separate logs. <br><br><pre> <code class="bash hljs">PUPPET_LOG=/var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/puppet/puppet.log</code> </pre><br>  <b>/ etc / puppet / environments</b> - can be used to divide customers into groups, a very ambiguous technology, needed if there are at least 30 nodes and is often replaced with the exotic R10K add-in. <br><br>  <b>/ etc / puppet / hieradata</b> - used for storage, quite an interesting technology, requires a separate article. <br><br>  <b>/etc/puppet/manifests/site.pp</b> is the main class launch configuration from the client configuration modules. <br><br>  <b>/ etc / puppet / modules</b> - the modules for setting up clients, which are essentially a set of classes (manifests) written in DSL similar to Ruby, are downloaded / written here.  If desired, you can even make inserts in pure Ruby. <br><br>  <b>/ var / lib / puppet</b> - as long as we don‚Äôt climb here, it will be necessary for certificates. <br><br>  <b>/etc/puppet/puppet.conf</b> is the main server configuration config. <br><br>  Add to the [main] section: <br><br><pre> <code class="bash hljs"> confdir = /etc/puppet server = pmaster.test.net certname = pmaster.test.net environmentpath = <span class="hljs-variable"><span class="hljs-variable">$confdir</span></span>/environments basemodulepath = <span class="hljs-variable"><span class="hljs-variable">$confdir</span></span>/modules default_manifest = <span class="hljs-variable"><span class="hljs-variable">$confdir</span></span>/manifests hiera_config = <span class="hljs-variable"><span class="hljs-variable">$confdir</span></span>/hiera.yaml environment_timeout = unlimited dns_alt_names = pmaster.test.net,stage.test.net vardir=/var/lib/puppet</code> </pre><br>  <b>dns_alt_names</b> - here you can write nodes that can work with the server through certificates.  For those who have servers sitting behind the proxy and they want to pull modules with forgeapi.puppetlabs.com, it will be useful to know that puppet do not care for your system http_proxy = proxy01.int: 8080 and https_proxy = proxy02.int: 8080 and have to score in the config section. <br><br><pre> <code class="bash hljs">[user] http_proxy_host = proxy01.int http_proxy_port = 8080</code> </pre><br>  To check all current server settings there is a useful command: <br><br><pre> <code class="bash hljs">puppet config <span class="hljs-built_in"><span class="hljs-built_in">print</span></span></code> </pre><br>  And even the daemon does not need to reboot, all the time he rereads his configs. <br><br>  At this temporarily everything. <br><br><h4>  Starting the client installation </h4><br>  We import two repos for packages into the system: <br><br><pre> <code class="bash hljs">rpm -ivh http://yum.puppetlabs.com/puppetlabs-release-el-6.noarch.rpm rpm -ivh http://mirror.logol.ru/epel/6/i386/epel-release-6-8.noarch.rpm</code> </pre><br><br>  Put the client package: <br><br><pre> <code class="bash hljs">yum ‚Äìy install puppet</code> </pre><br>  We need: <br><br>  <b>/etc/init.d/puppet</b> is a client daemon for auto-checking, has anything changed on the server.  We will use com line. <br><br>  <b>/ etc / sysconfig / puppet</b> - microconfig.  We bring it to the form like: <br><br><pre> <code class="bash hljs">PUPPET_SERVER=pmaster.test.net PUPPET_PORT=8140 PUPPET_LOG=/var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/puppet/puppet.log PUPPET_EXTRA_OPTS=--waitforcert=500</code> </pre><br>  <b>/etc/puppet/puppet.conf</b> - the main config. <br><br>  Add to the [main] section: <br><br> <code>server = pmaster.test.net <br></code> <br><br>  Now we need to generate and sign certificates.  The server will be self-signed and will be generated when the server starts.  On the client we make a request for verification: <br><br><pre> <code class="bash hljs">puppet agent --<span class="hljs-built_in"><span class="hljs-built_in">test</span></span> --ca_server=pmaster.test.net</code> </pre><br>  Here we can wait for the first stone of the type "forgot about the port or service on the server."  Implicitly you will see an error: <br><br><pre> <code class="bash hljs">Error: Could not request certificate: No route to host - connect(2)</code> </pre><br>  Using the ‚Äìdebug key, get more detailed: <br><br><pre> <code class="bash hljs">Debug: Creating new connection <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> https://pmaster.test.net:8140 Error: Could not request certificate: No route to host - connect(2)</code> </pre><br>  Well, if everything is fine, something like: <br><br><pre> <code class="bash hljs">Info: Caching certificate <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ca Info: csr_attributes file loading from /etc/puppet/csr_attributes.yaml Info: Creating a new SSL certificate request <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> stage.test.net Info: Certificate Request fingerprint (SHA256): 89:19:56:C4:76:0F:7F:C3:14:F3:D7:91:81:8C:A3:07:C5:55:AC:32:35:F5:93:6A:1B:17:DE:AC:EB:5D:DD:44 Info: Caching certificate <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ca Exiting; no certificate found and waitforcert is disabled</code> </pre><br>  Go back to the server and check the list of serts: <br><br><pre> <code class="bash hljs">puppet cert list --all <span class="hljs-string"><span class="hljs-string">"stage.test.net"</span></span> (SHA256) 89:19:56:C4:76:0F:7F:C3:14:F3:D7:91:81:8C:A3:07:C5:55:AC:32:35:F5:93:6A:1B:17:DE:AC:EB:5D:DD:44 + <span class="hljs-string"><span class="hljs-string">"pmaster.test.net"</span></span> (SHA256) 67:F8:6A:01:58:9B:1F:24:46:12:4E:5D:FB:39:60:12:79:4C:2C:6C:BE:EF:D2:27:52:95:6C:AE:B3:6C:05:1E (alt names: <span class="hljs-string"><span class="hljs-string">"DNS:pmaster.test.net"</span></span>, <span class="hljs-string"><span class="hljs-string">"DNS:stage.test.net"</span></span>)</code> </pre><br>  If it is without a plus, then it must be signed: <br><br><pre> <code class="bash hljs">puppet cert --sign ‚Äìall Notice: Signed certificate request <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> stage.test.net Notice: Removing file Puppet::SSL::CertificateRequest stage.test.net at <span class="hljs-string"><span class="hljs-string">'/var/lib/puppet/ssl/ca/requests/stage.test.net.pem'</span></span></code> </pre><br>  The result should appear in / var / lib / puppet / ssl.  If something went wrong, we erase everything there and repeat it again.  Actually now we have a ready configuration and you can see the available <a href="https://forge.puppetlabs.com/">folk art</a> , or search for something directly for yourself from the command line: <br><br><pre> <code class="bash hljs">puppet module search passwd Notice: Searching https://forgeapi.puppetlabs.com ... NAME DESCRIPTION AUTHOR KEYWORDS fraenki-vpasswd Manage virtual users @fraenki dovecot proftpd virtual user passwd wcooley-name_service Type &amp; provider to manage system name service configuration @wcooley dns files ldap passwd lookup group reidmv-local_user Example <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> user pattern @reidmv user <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> passwd</code> </pre><br>  See the names with a hyphen?  This is a format like author_name-module_name.  We will write the first test module to understand the scheme of their use, and not to hammer all the code in site.pp. <br><br>  Go to <b>/ etc / puppet / modules</b> and generate the skeleton: <br><br><pre> <code class="bash hljs"> puppet module generate myname-mytest</code> </pre><br>  We press 8 input times, because all this can then be altered. <br><br>  Get the directory myname-mytest, which is renamed to mytest.  You need the full name if you want to knock out and upload your module to the public forge.  We are interested in the <b>/etc/puppet/modules/mytest/manifests/init.pp</b> file.  In class mytest, we hammer in the very pseudo-type of type <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mytest</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">file</span></span></span><span class="hljs-class"> { '/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tmp</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puppettestfile</span></span></span><span class="hljs-class">': </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">path</span></span></span><span class="hljs-class"> =&gt; '/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tmp</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puppettestfile</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ensure</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">file</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">text</span></span></span><span class="hljs-class">' } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">file</span></span></span><span class="hljs-class"> { '/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tmp</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puppettestdir</span></span></span><span class="hljs-class">': </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">path</span></span></span><span class="hljs-class"> =&gt; "/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tmp</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puppettestdir</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ensure</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">directory</span></span></span><span class="hljs-class"> } }</span></span></code> </pre><br>  Of the features: <br><br>  - quotes and apostrophes are interchangeable, but sometimes quotes are better; <br>  - at the end of the commas put to the penultimate line. <br><br>  Now in <b>/etc/puppet/manifests/site.pp</b> add the type code: <br><br><pre> <code class="ruby hljs">node default { } node <span class="hljs-string"><span class="hljs-string">'stage.test.net'</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> mytest }</code> </pre><br>  To test the client run: <br><br><pre> <code class="bash hljs">puppet agent ‚Äì<span class="hljs-built_in"><span class="hljs-built_in">test</span></span></code> </pre><br>  And we get something like: <br><br><pre> <code class="bash hljs">puppet agent --<span class="hljs-built_in"><span class="hljs-built_in">test</span></span> Info: Retrieving pluginfacts Info: Retrieving plugin Info: Caching catalog <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> stage.test.net Info: Applying configuration version <span class="hljs-string"><span class="hljs-string">'1448981968'</span></span> Notice: /Stage[main]/Mytest/File[/tmp/puppettestdir]/ensure: created Notice: /Stage[main]/Mytest/File[/tmp/puppettestfile]/ensure: defined content as <span class="hljs-string"><span class="hljs-string">'{md5}1e2db57dd6527ad4f8f281ab028d2c70'</span></span> Notice: Finished catalog run <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.15 seconds</code> </pre><br>  Check: <br><br><pre> <code class="bash hljs"> ls -l /tmp/puppet* -rw-r--r-- 1 root root 9 Dec 1 09:54 /tmp/puppetenv -rw-r--r-- 1 root root 9 Dec 1 09:59 /tmp/puppettestfile</code> </pre><br>  Now what is the apache option for?  I suspect performance and caching.  I will not say how many fiery words were said towards the offs of the docks during the installation and configuration process, but in the end the correct version looked like this: <br><br>  Stop service: <br><br><pre> <code class="bash hljs">/etc/init.d/puppetmaster stop</code> </pre><br>  Put a bunch of good: <br><br><pre> <code class="bash hljs">yum install httpd yum install mod_passenger yum install mod_ssl yum install gcc-c++ yum install libcurl-devel openssl-devel zlib-devel httpd-devel ruby-devel gem install rack gem install passenger</code> </pre><br>  Run the exotic crap, which knocked the module.  He can swear at the end, that is, check the build and reconfigure the Apache later. <br><br><pre> <code class="bash hljs"> passenger-install-apache2-module ls -l /usr/lib/ruby/gems/1.8/gems/passenger-5.0.21/buildout/apache2/mod_passenger.so</code> </pre><br>  Now you need to create a boot loader for puppet: <br><br><pre> <code class="bash hljs">mkdir -p /usr/share/puppet/rack/puppetmasterd mkdir /usr/share/puppet/rack/puppetmasterd/public /usr/share/puppet/rack/puppetmasterd/tmp cp /usr/share/puppet/ext/rack/config.ru /usr/share/puppet/rack/puppetmasterd/ chown puppet:puppet /usr/share/puppet/rack/puppetmasterd/config.ru</code> </pre><br>  Hello again <b>/etc/puppet/puppet.conf</b> Add a section. <br><br><pre> <code class="bash hljs">[master] always_cache_features = <span class="hljs-literal"><span class="hljs-literal">true</span></span> ssl_client_header = SSL_CLIENT_S_DN ssl_client_verify_header = SSL_CLIENT_VERIFY</code> </pre><br>  We configure the module and the host in Apache.  My version is <b>/etc/httpd/conf.d/passenger.conf</b> . <br><br><pre> <code class="bash hljs">LoadModule passenger_module /usr/lib/ruby/gems/1.8/gems/passenger-5.0.21/buildout/apache2/mod_passenger.so &lt;IfModule mod_passenger.c&gt; PassengerRoot /usr/lib/ruby/gems/1.8/gems/passenger-5.0.21 PassengerDefaultRuby /usr/bin/ruby &lt;/IfModule&gt; PassengerHighPerformance on PassengerMaxPoolSize 12 PassengerPoolIdleTime 600 PassengerMaxRequests 1000 PassengerStatThrottleRate 120 Listen 8140 &lt;VirtualHost *:8140&gt; SSLEngine on SSLProtocol ALL -SSLv2 -SSLv3 SSLCipherSuite EDH+CAMELLIA:EDH+aRSA:EECDH+aRSA+AESGCM:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:EECDH:+CAMELLIA256:+AES256:+CAMELLIA128:+AES128:+SS SSLHonorCipherOrder on SSLCertificateFile /var/lib/puppet/ssl/certs/pmaster.test.net.pem SSLCertificateKeyFile /var/lib/puppet/ssl/private_keys/pmaster.test.net.pem SSLCertificateChainFile /var/lib/puppet/ssl/ca/ca_crt.pem SSLCACertificateFile /var/lib/puppet/ssl/ca/ca_crt.pem SSLCARevocationFile /var/lib/puppet/ssl/ca/ca_crl.pem SSLVerifyClient optional SSLVerifyDepth 1 SSLOptions +StdEnvVars +ExportCertData RequestHeader <span class="hljs-built_in"><span class="hljs-built_in">unset</span></span> X-Forwarded-For RequestHeader <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> X-SSL-Subject %{SSL_CLIENT_S_DN}e RequestHeader <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> X-Client-DN %{SSL_CLIENT_S_DN}e RequestHeader <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> X-Client-Verify %{SSL_CLIENT_VERIFY}e DocumentRoot /usr/share/puppet/rack/puppetmasterd/public RackBaseURI / &lt;Directory /usr/share/puppet/rack/puppetmasterd/&gt; Options None AllowOverride None Order allow,deny allow from all &lt;/Directory&gt; ErrorLog /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/httpd/puppet-server_error.log CustomLog /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/httpd/puppet-server_access.log combined &lt;/VirtualHost&gt;</code> : EECDH + aRSA + AESGCM: EECDH + aRSA + SHA384: EECDH + aRSA + SHA256: EECDH: + CAMELLIA256: + AES256: + CAMELLIA128: + AES128: + SS <code class="bash hljs">LoadModule passenger_module /usr/lib/ruby/gems/1.8/gems/passenger-5.0.21/buildout/apache2/mod_passenger.so &lt;IfModule mod_passenger.c&gt; PassengerRoot /usr/lib/ruby/gems/1.8/gems/passenger-5.0.21 PassengerDefaultRuby /usr/bin/ruby &lt;/IfModule&gt; PassengerHighPerformance on PassengerMaxPoolSize 12 PassengerPoolIdleTime 600 PassengerMaxRequests 1000 PassengerStatThrottleRate 120 Listen 8140 &lt;VirtualHost *:8140&gt; SSLEngine on SSLProtocol ALL -SSLv2 -SSLv3 SSLCipherSuite EDH+CAMELLIA:EDH+aRSA:EECDH+aRSA+AESGCM:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:EECDH:+CAMELLIA256:+AES256:+CAMELLIA128:+AES128:+SS SSLHonorCipherOrder on SSLCertificateFile /var/lib/puppet/ssl/certs/pmaster.test.net.pem SSLCertificateKeyFile /var/lib/puppet/ssl/private_keys/pmaster.test.net.pem SSLCertificateChainFile /var/lib/puppet/ssl/ca/ca_crt.pem SSLCACertificateFile /var/lib/puppet/ssl/ca/ca_crt.pem SSLCARevocationFile /var/lib/puppet/ssl/ca/ca_crl.pem SSLVerifyClient optional SSLVerifyDepth 1 SSLOptions +StdEnvVars +ExportCertData RequestHeader <span class="hljs-built_in"><span class="hljs-built_in">unset</span></span> X-Forwarded-For RequestHeader <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> X-SSL-Subject %{SSL_CLIENT_S_DN}e RequestHeader <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> X-Client-DN %{SSL_CLIENT_S_DN}e RequestHeader <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> X-Client-Verify %{SSL_CLIENT_VERIFY}e DocumentRoot /usr/share/puppet/rack/puppetmasterd/public RackBaseURI / &lt;Directory /usr/share/puppet/rack/puppetmasterd/&gt; Options None AllowOverride None Order allow,deny allow from all &lt;/Directory&gt; ErrorLog /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/httpd/puppet-server_error.log CustomLog /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/httpd/puppet-server_access.log combined &lt;/VirtualHost&gt;</code> </pre><br>  Actually there was a launch of the service: <br><br><pre> <code class="bash hljs">/etc/init.d/httpd start</code> </pre><br>  And to protest it on the client: <br><br><pre> <code class="bash hljs">puppet agent --<span class="hljs-built_in"><span class="hljs-built_in">test</span></span></code> </pre><br>  I also noticed that in the 3.8.4 branch now having changed the module code, I had to restart the puppetmaster or httpd service in order for the changes to be applied right away, before it did not ignore it. <br><br>  Creating a more complex module, using Hiera and R10K and at the same time a description of working with chef, which is essentially the heir to puppet but with its own problems, is a topic for a separate article, if you get your hands on it. </div><p>Source: <a href="https://habr.com/ru/post/272199/">https://habr.com/ru/post/272199/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272189/index.html">Feature javascript protocol or generation of random password in the browser tab</a></li>
<li><a href="../272191/index.html">Welcome to TechDay in Moscow on December 10</a></li>
<li><a href="../272193/index.html">How to calculate the time for testing</a></li>
<li><a href="../272195/index.html">A couple of words about the "death" of Flash, Animate CC and Web standards</a></li>
<li><a href="../272197/index.html">Release close ...</a></li>
<li><a href="../272201/index.html">The steady beauty of indecent models</a></li>
<li><a href="../272203/index.html">Where does IaaS work?</a></li>
<li><a href="../272205/index.html">10 attacks on web applications in action</a></li>
<li><a href="../272207/index.html">Kazakhstan introduces its CA to listen to all TLS traffic</a></li>
<li><a href="../272209/index.html">GDG DevFest Nizhny Novgorod 2015: photo report from the event</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>