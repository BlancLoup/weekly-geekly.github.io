<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Technical details. Meltdown Vulnerability - CVE-2017-5754</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the author 


 Important! Vulnerability is actually 3 vulnerabilities - Meltdown, Specter 1, Specter 2 
 Hello habr! Today we have a translation ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Technical details. Meltdown Vulnerability - CVE-2017-5754</h1><div class="post__text post__text-html js-mediator-article"><h1 id="ot-avtora">  From the author </h1><br><p>  <strong>Important!</strong>  <strong>Vulnerability is actually 3 vulnerabilities - Meltdown, Specter 1, Specter 2</strong> <br>  Hello habr!  Today we have a translation of a <a href="https://meltdownattack.com/meltdown.pdf">note</a> about the vulnerability of Meltdown (CVE-2017-5754).  Only the first page and the main part of the note for understanding this vulnerability have been translated. </p><br><h1 id="meltdown">  Meldown </h1><br><h2 id="obschee">  General </h2><br><p>  The security of a modern computer system (author's note. Smartphones, computers, practically any wearable devices with the ability to run code not from the manufacturer) is based on the isolation of the address space, for example, the kernel memory is marked inaccessible and protected from access by the user.  In this post we bring you Meltdown.  Meltdown exploits the side-effect of out-of-order execution in modern processors in order to read data from the kernel, including personal information and passwords.  Out-of-queue performance greatly affects performance and is included in most modern processors.  The attack is independent of the operating system and does not exploit software vulnerabilities.  Meltdown breaks all system security based on isolation of the address space including the paravirtualized one. <br>  Meltdown allows you to read part of the memory of other processes and virtual machines.  We show that the KAISER system has an important side effect in the form of blocking Meltdown (but is a crutch).  We insist on the inclusion of KAISER immediately to prevent information leaks. </p><a name="habracut"></a><br><h2 id="vvedenie">  Introduction </h2><br><p>  Security of a modern computer system based on isolation of the address space.  Operating systems guarantee isolation of individual processes.  In modern processors, state separation between kernel processes (kernel process) and user processes (user process) is provided by the hypervisor bit.  The whole concept is that this bit is cleared in the user process and set in the kernel process.  The change of processes occurs by interruption (interrupt) and system calls (system call / syscall).  Currently, memory addressing does not change during system calls and interrupts.  Meltdown runs on Intel processors from the 2010s, and can also potentially affect processors from other manufacturers (author's note: AMD, VIA).  Meltdown exploits the side-effect of out-of-order execution in modern processors to read data from the kernel, including personal information and passwords. </p><br><p>  The processor, instead of waiting for data from external buses with a long delay and idle, starts executing instructions and fills the parts of the kernel that are idle.  But these actions have a side effect - the difference in the execution time of instructions. </p><br><p>  Vulnerable processors allow an unprivileged process to execute code out of turn and load data from kernel memory into a temporary register.  Even more - the processor performs calculations based on the value of this register, for example, loading data from an array of data depending on the register value.  The processor guarantees the correct execution of the code, resetting the execution result, for example, the recorded register, if the prediction result is incorrect.  Thus, there are no problems at the architectural level.  But, as it was noted, executing out of turn has a side effect - filling the cache depending on the code executed out of turn.  Thus, the attacker can read all the data in the address space of the kernel using the micro-architecture feature. </p><br><p>  Meltdown works on modern personal computers and laptops, as well as servers in the clouds.  Also in the sandboxes based on the division of the kernel - paravirtualization and sandbox inside the process. </p><br><p>  The KAISER countermeasure prevents attacks targeting KASLR and inadvertently protects against a Meltdown attack. </p><br><h2 id="abstraktnyy-primer">  Abstract example </h2><br><pre><code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">raise_exception</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>(probe_array[data * <span class="hljs-number"><span class="hljs-number">4096</span></span>])</code> </pre> <br><p>  The second line will never be executed. <br>  Whatever the error is caused, it translates the execution-out-of-line state in the context of the error ‚Äî most often the kernel. <br><img src="https://habrastorage.org/webt/j2/yp/no/j2ypnonit1egsjn4pljetxq_wpu.png"></p><br><p>  Despite the fact that the second line of code was not executed <em>at the architectural level</em> , it changed the state of the cache <em>at the world architecture level</em> . <br><img src="https://habrastorage.org/webt/8p/qt/vg/8pqtvg5nxvql_gidm_mr1viqxyu.png" alt="time to access the probe_array array pages">  . </p><br><p>  As you can see, the access time to different areas of the array is different, since the cache loaded part of the memory that it had access to during the out-of-queue execution. </p><br><p>  Thus, we can transfer data from the out-of-queue execution state, which executes instructions in privileged mode, to the attacker's user process. <br>  Further, based on the fact that access to data already in the cache is less than the time during which the processor rolls back the action performed out of turn, the attacker reads the value of the part of the core memory in the processor cache.  Sometimes reading attempts end in failure.  the processor has time to reset the execution-out-of-queue pipeline before it reads the data (0.003%) and allows reading data at a speed of 503KB / s on the i7 6700K. </p><br><p>  The thread that takes advantage of this vulnerability will fail with an error, so in order to exploit the vulnerability, the process must be able to create a child thread, with access to the memory of the child thread. </p><br><h2 id="podverzhennost-uyazvimosti">  Vulnerability vulnerability </h2><br><h3 id="linux">  Linux </h3><br><p>  We successfully exploited this vulnerability in kernel versions from 2.6.32 to 4.13.0. <br>  KAISER patch eliminates this vulnerability. </p><br><h3 id="windows">  Windows </h3><br><p>  We successfully reproduced this vulnerability in Windows 10 (comment perev. Version is not specified) </p><br><h3 id="konteynery">  Containers </h3><br><p>  The attack can be played in containers such as OpenVZ, Docker, LXC. </p><br><h3 id="ogranicheniya-v-amd-i-arm">  Limitations in AMD and ARM. </h3><br><p>  We were not able to reproduce this vulnerability on ARM and AMD, but perhaps our implementation is too slow. <br>  <strong>BUT!</strong>  <strong>We managed to reproduce the vulnerability associated with running out of turn on both processors.</strong> <br>  <strong>Important!</strong>  <strong>Operating system patches prevent Meltdown, but not Specter</strong> <br>  <strong>Important!</strong>  <strong>This vulnerability may be present in other processors!</strong> <br>  Sorry for the short note!  I will not do this anymore :). </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/346074/">https://habr.com/ru/post/346074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346064/index.html">How to build a community. Translation of the book "Social Architecture": Preface. Crowd wisdom</a></li>
<li><a href="../346066/index.html">Github flow</a></li>
<li><a href="../346068/index.html">‚ÄúNot again, but again‚Äù: Sea-Me-We 3 submarine cable failed for the second time in a year</a></li>
<li><a href="../346070/index.html">Who "leaves the clouds": Western IT startups who abandoned the virtual infrastructure</a></li>
<li><a href="../346072/index.html">DPC without GeForce and Titan: NVIDIA changed license agreement</a></li>
<li><a href="../346078/index.html">How exactly does Meltdown work?</a></li>
<li><a href="../346080/index.html">Alan Kay: How are things for all mankind, the view "from space"</a></li>
<li><a href="../346086/index.html">Docker-compose: the perfect working environment</a></li>
<li><a href="../346090/index.html">11 libraries (sets of components) for React, which are worth knowing in 2018</a></li>
<li><a href="../346098/index.html">Compile a DNS query manually</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>