<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WebRTC or how I taught our CRM to call phones</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The company in which I had the opportunity to work, sells services on the Internet. Every morning, the duty shift disassembles the total stack of accu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WebRTC or how I taught our CRM to call phones</h1><div class="post__text post__text-html js-mediator-article">  The company in which I had the opportunity to work, sells services on the Internet.  Every morning, the duty shift disassembles the total stack of accumulated orders and starts calling customers to clarify orders.  During the day, operators also accept incoming calls.  Before starting my venture, they used such a desktop SIP client for calls: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/58e/3c6/a09/58e3c6a09f97951c4a98ea5bc6539b1f.png"><br><br>  This dialer was installed on the computer of each employee, received calls and called where necessary.  To make any changes to the settings, you had to bypass all the machines and do everything manually.  At the same time, if an employee works remotely, he had to advise him by telephone on how to do this.  And often it was quite difficult. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But the main problem was the lack of integration with our web-system and database.  Such seemingly simple tasks as opening a client‚Äôs card to an incoming call, saving call statistics for each of the employees and monitoring their activity from the administrative web interface are very difficult to do with the desktop softphone, even if it has the appropriate integration capabilities with browser, for example using plugins. <br><br>  There was an idea to combine all the internal work and calls in one system and database.  I spent a long time finishing our CRM with the function of a built-in dialer with recording conversations. <br>  For the implementation of calls considered a number of technologies and came to the conclusion that there are not so many of them.  There was a pair of open-source and commercial implementations, as well as several SAAS services that were not suitable due to internal security policies - to handle calls through their own server. <br><br>  At the beginning I tried to use <a href="http://sipml5.org/">sipml5</a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/015/0d2/ff6/0150d2ff603c2a34dd79f15dbf6be9a3.png" alt="image"><br><a name="habracut"></a><br>  Documentation had to be collected piece by piece from the network.  As a result, I got a more or less working phone with a SIP stack on the browser side: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c61/117/06f/c6111706f85e234415904c36103ffbcd.png" alt="image"><br><br>  Installation, testing and configuration lasted about 2 weeks, as a result I found a number of small but unpleasant bugs that could not be circumvented, for example, one of them was associated with Websockets settings via SSL.  And after the release of Chrome browser version 35 of the web, the phone refused to work at all. <br><br>  In addition, I did not want to open SIP accounts to operators, and the SIP stack on the browser side assumes their open use and sending via Websockets.  Even if Websockets work through SSL, the potential attacker has the opportunity to detach the js code and pull out the SIP password.  There was an option to delegate SIP Digest authentication to our Web server, but it was not possible to get to its implementation. <br><br>  This is what browser-side SIP requests look like in the debug console: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b4/edc/8f2/0b4edc8f2445eb3a0a77bb14f0dae4df.png" alt="image"><br><br>  Full access to the SIP stack from Javascript is generally not bad.  This has its advantages, for example, you can try to fix some integration bug in JS SIP signaling.  But there is one nuance.  Slightly more than 90% of SIP vendors do not currently support the RFS 7118 specification of the JS SIP dated January 2014, which means that the webrtc2sip module should work as a stateful SIP proxy and actually duplicate server side SIP stack support.  Such an alignment seemed very difficult for further work and support, and I decided to leave the SIP stack on the browser side and find some simpler and more understandable API for such tasks with the server part that could be hosted. <br><br>  As a result, I started testing <a href="http://flashphoner.com/">Web Call Server</a> .  This is not SAAS and allows you to handle calls through your server, which in this case required: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f2b/c28/2d7/f2bc282d70d10669cf515fe86dc00e08.png" alt="image"><br><br>  In terms of functions, it is about the same as in sipml5, the same WebRTC calls to SIP and back.  There is still support for Flash, but it was not necessary, since all operators use mainly Chrome and Firefox browsers, and those who use IE had to switch to more ‚Äúcorrect‚Äù browsers. <br><br>  The load is given <a href="https://github.com/flashphoner/flashphoner_client/tree/wcs_video">to an open source JS softphone</a> that can be redrawn and adapted for a web page. <br><br>  The main difference from sipml5 is interaction with the server through the API, and not through SIP over Websockets.  Those.  There is no SIP stack on the browser side.  It is located only on the server side.  This made the front-end task a bit easier for the developer, since  The SIP stack on the browser side threw him into confusion, and when working with the Javascript API and CSS, it became possible to focus on the interface part. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f69/0a6/2ab/f690a62abac808879b609c96de37b552.png" alt="image"><br><br>  So, how I implemented all this. <br><br>  1. Took such a <a href="http://aws.amazon.com/ec2/">server on Amazon EC2</a> : <br>  Memory and disk space is not much required.  Is that for the logs.  And the computational power of the CPU in such tasks can be important, so it took not the weakest instance. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5be/5e4/35e/5be5e435e29d27a8d1acc37663775fb9.png" alt="image"><br><br>  2. Raised Apache for the web-interface, installed and launched WCS server. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/43f/a5e/944/43fa5e944a9230a6c13d166b00cf6329.png" alt="image"><br><br>  3. On the chrome page a standard web-phone appeared, the code of which is on <a href="https://github.com/flashphoner/flashphoner_client/tree/wcs_video">github</a> . <br>  I didn‚Äôt really like the phone interface, immediately decided to redesign it, and the debugging console on the right turned out to be quite useful.  It is a pity that later it had to be removed in order not to frighten a normal user. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/607/b92/f25/607b92f257cf849c7c3fdc8abbf885d5.png" alt="image"><br><br>  4. Tested a web-phone on the ability to call.  Used for this our previous SIP-accounts.  Everything works as it should.  And on the cell phone calls, and on the SIP-phones, and holding calls and transfers, and blackjack and ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a64/e9c/68a/a64e9c68a573754369e664a5105d3ead.png" alt="image"><br><br>  Similarly, phoning with a mobile phone. <br><br>  5. Adapted the web-phone code for my web-CRM, redrawn its design and now it looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4b1/41e/2c8/4b141e2c88dd0f700ed852127183137b.png" alt="image"><br><br>  It is worthwhile to dwell on adaptation in detail, since  redrawing the design is not limited. <br>  The first serious task was the automatic registration of a web-phone on a SIP server.  Otherwise, the operator would have to re-enter the SIP login and password, after he entered the login and password for the CRM system.  There was a question how to integrate. <br><br>  It turned out that the <a href="">API</a> has a special function loginByToken for this: <br><br><pre><code class="html hljs xml">function loginByToken(token) {     trace("Phone - loginByToken "+ token);       connectingViewBeClosed = false;       var result = flashphoner.loginByToken(flashphonerLoader.urlServer, token, document.URL);       closeLoginView();       openConnectingView("Connecting...", 0); }</code> </pre> <br>  In order to understand how this function works, I had to try hard. <br>  With the help of documentation and examples, we managed to find out that it all works like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1af/524/67b/1af52467bb80c370e55414dad521dcea.png" alt="image"><br><br>  1) When creating a token on the CRM side, the AES encryption algorithm is used, which is encrypted with a string that includes the SIP login and user password, as well as other necessary information. <br><br>  The encryption key is known only to our server, where CRM is deployed, as well as the WCS server.  In addition, the validity of the token is specified by a special attribute expires so that it is not possible to reuse it. <br>  Token cryptography occurs in AES CTR mode.  Below is an example with openssl, in which an encrypted token is generated with the transfer of a SIP password: <br><br><pre> <code class="html hljs xml"> echo -ne '<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ok"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"test"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">registerRequired</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">login</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"user5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">authenticationName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"user5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">password</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"password"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">outboundProxy</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"proxy.my"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"proxy.my"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5060"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">visibleName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AAA"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">api_key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"App1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">expires</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1394839040761100000"</span></span></span><span class="hljs-tag">/&gt;</span></span>' | openssl enc -aes-128-ctr -nosalt -K 8263D535FFFFFFFF7B0F60 -iv 00000000000000000000000000000000 | xxd -p</code> </pre> <br><br>  As a result, got something like: <br><br><pre> <code class="html hljs xml"> CRM:cf4693eedaafda1390b261dcf29d45bd3556d64b1f69cd84db8c3ac8721e7e139b80be75e39da18154e897596e9317084faee0d24d6a6197b62a93a2647b263059167b2664179a5866738260c77372e04fe22104ebe1c7530e9215f50d111fd24384755d28d06673e866159c0b6b83289c045619e8481f9c2a6b56b182f393a7dea06b38b7856436895402a5b40f0525a17822ae0f3204b606e4f0169d1ca9176e8e1b696683d12c7db8208946c204e94f3c8ff285f2bcef4ca9b12187cf541ce37d508d3663ef65f944b01db9aea5c0f10002a376d051cbf1b19bc34f76b6d2a4e1ad1450ae412b51b3af1d3860167f5416b3d2c9eeff94d60b82279e8685beb543893e8a09dee640d7366e478d0d1ee7368e0b63b511</code> </pre><br><br>  On the left, the name of our application is ‚ÄúCRM‚Äù, and on the right, the previously created token. <br>  I insert this token into the flashphoner.xml config of the web-phone in the following form: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">token</span></span></span><span class="hljs-tag">&gt;</span></span>CRM:cf4693eed...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">token</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  In this case, the automatic token registration procedure will start immediately after the page reloads. <br>  2 and 3) loginByToken and decryption. <br><br>  On the server side, the encryption keys for AES are specified in the config: <br><br><pre> <code class="html hljs xml"> CRM=8263D535FFFFFFFF7B0F60</code> </pre> <br><br>  Thus, when a token with the ‚ÄúCRM:‚Äù prefix comes in, the corresponding key is used to decrypt it. <br><br>  As a result of the decryption, the WCS server receives the previously encrypted string: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ok"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"test"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">registerRequired</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">login</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"user5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">authenticationName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"user5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">password</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"password"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">outboundProxy</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"proxy.my"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"proxy.my"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5060"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">visibleName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AAA"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">api_key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"App1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">expires</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1394839040761100000"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br><br>  and from this XML string takes all the data necessary for SIP registration. <br><br>  3) As soon as the server has decrypted the data, it sends a SIP REGISTER request for SIP and sends a normal Digest authentication to 401 responses using the login and password decoded in the previous SIP step. <br><br><pre> <code class="html hljs xml">REGISTER sip:sipnet.ru;lr SIP/2.0 Call-ID: 345ec5157b1a66de3a3a275bdba36197@192.168.1.90 CSeq: 2 REGISTER From: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sip:crm1@sipnet.ru</span></span></span><span class="hljs-tag">&gt;</span></span>;tag=73a499a8 To: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sip:crm1@sipnet.ru</span></span></span><span class="hljs-tag">&gt;</span></span> Via: SIP/2.0/UDP 192.168.1.90:30000;branch=z9hG4bK2622ce723c34760d6a3f43dd631329e1 Max-Forwards: 70 User-Agent: WebRTC Allow: UPDATE,MESSAGE,BYE,ACK,REFER,INVITE,NOTIFY,INFO,OPTIONS,CANCEL Contact: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sip:crm1@192.168.1.90:30000</span></span></span><span class="hljs-tag">&gt;</span></span>;expires=3600 Expires: 3600 Authorization: Digest username="crm1",realm="etc.tario.ru",nonce="4A0674BEDF81E0B3F65D",uri="sip:sipnet.ru;lr",response="0762b862c544007f4fb7c43277312a3d",algorithm=MD5,opaque="opaq",qop=auth,cnonce="1234567890",nc=00000001 Content-Length: 0</code> </pre><br><br>  In this case, only the CRM and Web Call Server itself know the SIP login and password.  On the browser, this data in open form do not fall. <br>  Thus, I managed to embed the phone into the operator‚Äôs page, without forcing it to store two different accounts - one for CRM, the other for SIP, because it is very inconvenient.  Now immediately after the page loads, loginByToken is called and the phone enters the ready state. <br><br>  Some results of the introduction of browser calls: <br><br>  1. Calls are now made from the site and are accepted on the site, where all actions are recorded in the system. <br><br>  2. It became possible to listen to recorded conversations, which helps to resolve conflicts with clients and disagreements between employees.  This is important for our distributed office. <br><br>  3. The number of received calls increased by about 20%.  It became clear that the operators did not always pick up the phone when the client called. <br>  At the moment, we can say that everything works as intended.  Problem situations were resolved without serious immersion in the SIP materiel. <br><br>  Among the shortcomings can be noted the impossibility of installation under Windows.  By the way, the installation under Linux and integration also had to be tricky and it seems that only an advanced user / developer will master it. <br><br>  WebRTC audio calls work stably and without any additional browser plug-ins, such as Flash Player.  So one can say that I managed to realize the planned integration and two weeks of work were spent not in vain. <br></div><p>Source: <a href="https://habr.com/ru/post/224897/">https://habr.com/ru/post/224897/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../224879/index.html">Anemic Domain Model [Translation]</a></li>
<li><a href="../224883/index.html">Kerio Control for Windows to Kerio Control Appliance Migration Guide</a></li>
<li><a href="../224889/index.html">Google maps clustering</a></li>
<li><a href="../224891/index.html">(May 25, Kiev) Fighters of the invisible front or the story of how to protect themselves from DDoS-attacks in a short time using Radware</a></li>
<li><a href="../224895/index.html">The main international standards and best practices for auditing information technology</a></li>
<li><a href="../224901/index.html">Automatic downloading of the list of prohibited sites from the Roskomnadzor service</a></li>
<li><a href="../224903/index.html">5 mistakes made when starting a startup</a></li>
<li><a href="../224905/index.html">Startup Village 2014 through the eyes of the Webot robot</a></li>
<li><a href="../224907/index.html">ERP development on tryton: Part 3</a></li>
<li><a href="../224911/index.html">Creating audio plugin, part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>