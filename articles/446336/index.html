<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to disable standard passwords and make everyone hate you</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Man, as is known, is a lazy creature. And even more so when it comes to choosing a sustainable password. 

 I think each administrator has ever encoun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to disable standard passwords and make everyone hate you</h1><div class="post__text post__text-html js-mediator-article">  Man, as is known, is a lazy creature.  And even more so when it comes to choosing a sustainable password. <br><br>  I think each administrator has ever encountered the problem of using light and standard passwords.  This phenomenon is often found among the top echelons of the company's management.  Yes, it is among those who have access to secret or commercial information and it would be highly undesirable to eliminate the consequences of a password leak / hack and further incidents. <br><a name="habracut"></a><br>  In my practice, there was a case when, in an Active Directory domain with password policy enabled, accountants on their own got the idea that a password like ‚ÄúPas $ w0rd1234‚Äù perfectly rolls up to the requirements of the policy.  The consequence was the widespread use of this password anywhere and everywhere.  Sometimes he differed only in a set of numbers. <br><br>  I really wanted to be able to not only include the password policy and determine the set of characters, but also filter by dictionary.  To exclude the possibility of using such passwords. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Microsoft kindly informs us by reference that anyone who knows how to hold the compiler in their hands, the IDE, and who can correctly pronounce C ++, is able to compile and use the library itself according to its own understanding.  Your humble servant is not capable of this, so I had to look for a ready-made solution. <br><br>  After a <s>long</s> hour of searching, two solutions to the problem were revealed.  I, of course, speak about OpenSource solution.  After all, paid options - from and to. <br><br>  <u>Option number 1.</u>  <a href="https://github.com/jephthai/OpenPasswordFilter"><b>OpenPasswordFilter</b></a> <br><br>  There are no kommites like 2 years ago. The native installer works one time, you have to tinker with your hands.  Creates its own separate service.  When updating the password file, the DLL does not automatically pick up the changed content, you need to stop the service, wait for a timeout, edit the file, start the service. <br><br>  <b><u>Not ice!</u></b> <br><br>  <u>Option number 2.</u>  <a href="https://github.com/ryanries/PassFiltEx"><b>PassFiltEx</b></a> <br><br>  The project is active, alive and you don‚Äôt even have to kick a cold body. <br><br>  Setting the filter consists of copying two files and creating several registry entries.  The password file is not in lock, that is, it is editable and, according to the idea of ‚Äã‚Äãthe author of the project, it is simply read once a minute.  Also, with the help of additional registry entries, you can configure additional settings for both the filter itself and even the nuances of the password policy. <br><br>  So. <br>  Given: Active Directory domain test.local <br>  Windows 8.1 test workstation (irrelevant for the task condition) <br>  PassFiltEx password filter <br><br><ul><li>  Download the latest <a href="https://github.com/ryanries/PassFiltEx/releases">PassFiltEx</a> release <a href="https://github.com/ryanries/PassFiltEx/releases">link.</a> </li><li>  Copy <i>PassFiltEx.dll</i> to <i>C: \ Windows \ System32</i> (or <i>% SystemRoot% \ System32</i> ). <br>  Copy <i>PassFiltExBlacklist.txt</i> to <i>C: \ Windows \ System32</i> (or <i>% SystemRoot% \ System32</i> ).  If necessary, we supplement it with our own templates. <br><br><img src="https://habrastorage.org/webt/zx/sd/b0/zxsdb02bnin4jtlhaoyl6nutaom.png"><br></li><li>  Edit the registry branch: <b>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Lsa</b> =&gt; <i>Notification Packages</i> <br>  Add <i>PassFiltEx</i> to the end of the list.  (You do not need to specify the extension.) The full list of packages used for checking will look like this " <i>rassfm scecli PassFiltEx</i> ". <br><br><img src="https://habrastorage.org/webt/y-/mb/7h/y-mb7h4kebzs6y9m08vhjk8nt74.png"><br></li><li>  Reboot the domain controller. </li><li>  Repeat the above procedure for all domain controllers. </li></ul><br>  You can also add the following registry entries, which gives you more flexibility in using this filter: <br><br>  Section: <b>HKLM \ SOFTWARE \ PassFiltEx</b> - created automatically. <br><br><ul><li>  <b>HKLM \ SOFTWARE \ PassFiltEx \ BlacklistFileName</b> , REG_SZ, Default: PassFiltExBlacklist.txt <br><br>  <i>BlacklistFileName</i> - allows you to specify a custom path to the file with password templates.  If this registry entry has a blank value or does not exist, then the default path is used, namely <i>% SystemRoot% \ System32</i> .  You can even specify the network path, but you need to remember that the template file must have clear permissions to read, write, delete, modify. <br></li><li>  <b>HKLM \ SOFTWARE \ PassFiltEx \ TokenPercentageOfPassword</b> , REG_DWORD, Default: 60 <br><br>  <i>TokenPercentageOfPassword</i> - allows you to specify the percentage occurrence of the mask in the new password.  The default value is 60%.  For example, if a percentage entry of 60 is specified and the starwars string is in the template file, then the password is <b>Starwars1!</b>  will be rejected, while the password <b>starwars1! DarthVader88</b> will be accepted, because the percentage entry string in the password is less than 60% <br></li><li>  <b>HKLM \ SOFTWARE \ PassFiltEx \ RequireCharClasses</b> , REG_DWORD, Default: 0 <br><br>  <i>RequireCharClasses</i> - allows you to expand the requirements for passwords compared to the standard complexity requirements of ActiveDirectory passwords.  The built-in complexity requirements require 3 of 5 possible different kinds of characters: Upper case, Lower case, Number, Special, and Unicode.  Using this registry entry, you can set your own password complexity requirements.  The value that can be specified is a set of bits, each of which is a corresponding power of two. <br><br>  That is - 1 = lower case, 2 = upper case, 4 = number, 8 = special character, and 16 = Unicode character. <br><br>  Thus, with a value of 7, the requirements will be ‚ÄúUpper case <b>AND</b> lower case <b>AND</b> number,‚Äù and with value 31, ‚ÄúUpper case <b>AND</b> lower case <b>AND</b> number <b>AND</b> special <b>AND</b> symbol Unicode character‚Äù. <br><br>  You can even combine - 19 = ‚ÄúUppercase <b>AND</b> lowercase <b>AND</b> Unicode character‚Äù. <br></li><li><img src="https://habrastorage.org/webt/ej/ms/m8/ejmsm8emoirxr4utvi3csyfj04o.png"><br></li></ul><br>  A number of rules when creating a template file: <br><br><ul><li>  Patterns are case-insensitive.  Therefore, the entry in the <b>starwars</b> file and <b>StarWarS</b> will be defined as the same value. </li><li>  The blacklist file is reread every 60 seconds, so you can safely edit it, in a minute the new data will already be used by the filter. </li><li>  There is currently no Unicode support for pattern checking.  That is, you can use Unicode characters in passwords, but the filter will not work.  This is not critical, because I have not seen users who use Unicode passwords. </li><li>  It is advisable to avoid blank lines in the template file.  In the debug, then you see an error when loading data from the file.  The filter works, but why unnecessary exceptions? </li></ul><br>  For debugging in the archive there are batch files that allow you to create a log and then parse it using, for example, <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D44226">Microsoft Message Analyzer.</a> <br><br>  This password filter uses Event Tracing for Windows. <br><br>  The ETW provider for this password filter is <b>07d83223-7594-4852-babc-784803fdf6c5</b> .  For example, you can configure the event tracing after the next reload: <br><br><pre><code class="plaintext hljs">logman create trace autosession\PassFiltEx -o %SystemRoot%\Debug\PassFiltEx.etl -p "{07d83223-7594-4852-babc-784803fdf6c5}" 0xFFFFFFFF -ets</code> </pre> <br>  Tracing will start after the next system reboot.  To stop: <br> <code>logman stop PassFiltEx -ets &amp;&amp; logman delete autosession\PassFiltEx -ets</code> <br>  All these commands are listed in the <i>StartTracingAtBoot.cmd</i> and <i>StopTracingAtBoot.cmd scripts</i> . <br><br>  For one-time testing of the filter operation, you can use <i>StartTracing.cmd</i> and <i>StopTracing.cmd</i> . <br><br>  In order to conveniently read the exhaust debug of this filter in <i>Microsoft Message Analyzer,</i> it is recommended to use the following settings: <br><br><img src="https://habrastorage.org/webt/2e/uw/jt/2euwjtx8kmejlaapk5lracynrbw.png"><br><br><img src="https://habrastorage.org/webt/-h/il/1p/-hil1pp6kmegzzkyinh_tijdckw.png"><br><br>  When you stop the log and parse in <i>Microsoft Message Analyzer</i> , everything looks like this: <br><br><img src="https://habrastorage.org/webt/py/tm/fq/pytmfq1svwed4xm15q9hzq5ah30.png"><br><br>  Here you can see that there was an attempt to set a password for the user - the magic word <b>SET</b> in debug tells us about it.  And the password was rejected due to its presence in the template file and more than 30% compliance in the input text. <br><br>  When a successful attempt to change the password, we see the following: <br><br><img src="https://habrastorage.org/webt/bn/zb/3b/bnzb3byjzc8uqpo4xbg9kiqynwa.png"><br><br>  There is some inconvenience for the end user.  When trying to change a password that falls into the list of a template file, the message on the screen is not different in <s>intelligence and wit</s> from the standard message when the password policy does not pass. <br><br><img src="https://habrastorage.org/webt/5o/ml/dt/5omldtb8mlpzve1dm-2hnyuqzza.png"><br><br>  Therefore, be prepared for calls and shouts: "I entered the password as it should, but it does not work." <br><br><h3>  Total </h3><br>  This library allows you to prohibit the use of simple or standard passwords in the Active Directory domain.  Say "No!" To passwords of the form: "P @ ssw0rd", "Qwerty123", "ADm1n098". <br>  Yes, of course, users will love you even more for such concern about their security and the need to invent furious passwords.  And, perhaps, the number of calls and requests to help with the password you add.  But you have to pay for security. <br><br>  <u>Links to used resources:</u> <br><br>  An article on Microsoft regarding the custom password filter library: <a href="https://docs.microsoft.com/en-us/windows/desktop/secmgmt/password-filters">Password Filters</a> <br>  PassFiltEx: <a href="https://github.com/ryanries/PassFiltEx">PassFiltEx</a> <br>  Release Link: <a href="https://github.com/ryanries/PassFiltEx/releases">Latest Release</a> <br>  Password Lists: <br>  DanielMiessler lists: <a href="https://github.com/danielmiessler/SecLists">Link.</a> <br>  Wordlist from weakpass.com: <a href="https://weakpass.com/wordlist">Link.</a> <br>  Wordlist from berzerk0 repo: <a href="https://github.com/berzerk0/Probable-Wordlists">Link.</a> <br>  Microsoft Message Analyzer: <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D44226">Microsoft Message Analyzer.</a> </div><p>Source: <a href="https://habr.com/ru/post/446336/">https://habr.com/ru/post/446336/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446326/index.html">Solving problems with traffic rules</a></li>
<li><a href="../446328/index.html">Why do we need SMS reception services and what do they eat?</a></li>
<li><a href="../446330/index.html">Spaghetti Automatic Machines</a></li>
<li><a href="../446332/index.html">IBM System i (aka AS / 400) - How we did auto tests for green screen applications</a></li>
<li><a href="../446334/index.html">Thinking about IT careers and tips for beginners</a></li>
<li><a href="../446338/index.html">SVG 3D: create, rotate and animate</a></li>
<li><a href="../446340/index.html">Operating Systems: Three Easy Pieces. Part 1: Intro (translation)</a></li>
<li><a href="../446342/index.html">The Impact of Transparent Huge Pages on System Performance</a></li>
<li><a href="../446344/index.html">Building blocks distributed applications. Second approximation</a></li>
<li><a href="../446346/index.html">Develop applications for Android - as if to be (demonetized) by YouTube</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>