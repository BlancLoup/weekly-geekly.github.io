<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Cloud Endpoints in Java: A Guide. Part 2 (Frontend)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part One: Google Cloud Endpoints on Java: A Guide. part 1 
 Part Three: Google Cloud Endpoints on Java: A Guide. part 3 
 Part Four: Working with the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Cloud Endpoints in Java: A Guide. Part 2 (Frontend)</h1><div class="post__text post__text-html js-mediator-article">  Part One: <a href="http://habrahabr.ru/post/268863/">Google Cloud Endpoints on Java: A Guide.</a>  <a href="http://habrahabr.ru/post/268863/">part 1</a> <br>  Part Three: <a href="http://habrahabr.ru/post/271385/">Google Cloud Endpoints on Java: A Guide.</a>  <a href="http://habrahabr.ru/post/271385/">part 3</a> <br>  Part Four: <a href="http://habrahabr.ru/post/274239/">Working with the database in Google App Engine / Google Cloud Endpoints in Java: Objectify framework</a> <br>  Part Five: <a href="http://habrahabr.ru/post/275211/">Google Cloud Storage with Java: Images and Other Files in the Clouds</a> <br><br>  In the first part, we looked at creating a project on <a href="https://cloud.google.com/appengine/docs/java/endpoints/">Google Cloud Endpoints with Java</a> , in this article we will focus on creating a frontend to our API. <br><br>  In addition to the tools used in the first part, we will need: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://angularjs.org/">AngularJS</a> , and an initial overview of how it works, optionally <a href="http://getbootstrap.com/">Bootstrap</a> or <a href="http://foundation.zurb.com/">Foundation</a> . <br><br>  The simplest web server on the local machine for testing, and the server for application deployment. <br><a name="habracut"></a><br><h1>  Local server </h1><br>  The application on AngularJS consists of the usual set of "static" files: .html, .js, .css + image files, fonts, etc.  It would seem, since this is usually a one-page application, you can simply open index.html in the browser.  However, if you try to just open index.html in Google Chrome, we can see a page without main content and something like this in the console: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/206/63b/3d0/20663b3d045db2775269310fdeabf905.png" alt="image"><br><br>  In Firefox, the same application can work without a web server, but links like src = "// ... or href =" ... turn into file: /// ... <br>  Well, <a href="https://developers.google.com/web/tools/chrome-devtools/">Chrome DevTools</a> , as my taste is much more convenient. <br><br>  Therefore, it will still be preferable to use a web server on a local machine.  You can use <a href="http://www.sinatrarb.com/">Sinatra</a> on Ruby, <a href="https://nodejs.org/">NodeJS</a> , good old <a href="httpd.apache.org/">Apache HTTP Server ("httpd")</a> .  The App Engine Java SDK also includes a development web server running on a local machine, and simulates GAE service services including a database (datastore). <br>  In IntelliJ IDEA, when editing a .html file, browser icons are highlighted, if you click on the file, it will open on a local web server running IntelliJ IDEA. <br><br>  In my opinion, the most simple and versatile option is Python (especially since you most likely have it already installed): <br><pre><code class="bash hljs">python -m SimpleHTTPServer &lt;port&gt;</code> </pre> <br>  in this case, "python" means starting Python version 2.x (by default), "-m" - starting the <a href="https://docs.python.org/2/using/cmdline.html">module</a> , " <a href="httpserver.html">SimpleHTTPServer</a> " - the module itself is the simplest http-server and included in the standard installation (i.e. You installed Python, then this module is already present), optionally - the port number, if this parameter is not specified, then by default it will be 8000. <br>  <i>This command should be executed in the project directory, where our index.htm is located</i> , which will be given by default in / on the web server, and on <a href="http://localhost/">localhost</a> : 8000 / (http://127.0.0.1:8000/) we get static http -server.  This is convenient because there are no settings in the directory itself, and generally no settings are needed. <br><br><h1>  Depla </h1><br>  You can place a front-end web application for our API on any web server where you can place static files, for example, on free <a href="https://pages.github.com/">GitHub Pages</a> (see also <a href="https://help.github.com/articles/setting-up-a-custom-domain-with-github-pages/">Setting up a custom domain with GitHub Pages</a> ) or on <a href="http://aws.amazon.com/">Amazon Web Services (AWS)</a> . <br><br>  Naturally the logical solution is to place the frontend on GAE.  It may be in one project.  In our manual, for educational purposes, we will place the backend and front-end in different projects on GAE.  In the previous section, we created two projects for this in the developer console.  The frontend will be a live project in hello-habrahabr-webapp, and the backend will be in hello-habrahabr-api. <br><br><h2>  Domain </h2><br>  In addition to the existing domain name of the form {project ID} .appspot.com, we can use our own domain registered either through <a href="https://domains.google.com/">Google Domains</a> , or from another registrar, or several domains for one project.  Previously, this feature was only available for domains used in <a href="https://www.google.com/work/apps/business/">Google Apps</a> , but more recently, the binding to Google Apps has been removed. <br><br>  In order to add a domain, select the project in the developer console and go to the menu: Compute -&gt; App Engine -&gt; Settings -&gt; Custom domains.  Then choose 'Register a new domain' to register a domain with Google, or if we already have a domain 'Add a custom domain' <br><br><img src="https://habrastorage.org/getpro/habr/post_images/47c/e33/137/47ce331373a15969d4d6d8e6a5d4dc17.png" alt="image"><br><br>  If we add a domain that is not registered with Google, then we first need to verify that you own the domain and add the domain to the list of verified google accounts for your account: enter the domain name in the field labeled 1, click 'Verify' and go to the verification page: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/33c/f66/a95/33cf66a95e68bd2df09a3c1105cfb643.png" alt="image"><br><br>  if the domain is registered with godaddy.com or another major one, for verification you need to select a provider and login in the window that will open: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ee3/a4f/d26/ee3a4fd26fc360f31e9b2c3bb1df9384.png" alt="image"><br><br>  and confirm: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aa2/e15/9c0/aa2e159c0c765f84567ef96ee8d7d4d8.png" alt="image"><br><br>  Or make a manual verification, instructions will be shown by clicking on 'Add a TXT record.' <br><br>  On the page ( <a href="https://www.google.com/webmasters/verification/">www.google.com/webmasters/verification</a> ): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a4/4dd/7db/2a44dd7db41656da2f251855470fc50d.png" alt="image"><br><br>  You can add ‚Äúproperties‚Äù of verified domains, for example, add an additional google account from which you can manage your domain in Google services. <br><br>  After verifying the domain, in the section labeled 2. (if we just added a new domain, then we need to reload the page so that the new domain is available for selection) we can assign this domain to the current project, either ‚Äúentirely‚Äù or create and assign a subdomain , or both. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9bd/e56/7e0/9bde567e063da9be5038e783bab4fe19.png" alt="image"><br><br>  After selecting a domain and clicking the 'Add' button, you should make changes to the domain registrar settings (DNS Zone File) according to the instructions given in the section under number 3: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/419/a64/3a8/419a643a86bbd82256eeb7149e041405.png" alt="image"><br><br>  Attention: after clicking the 'Add' button, nothing visually reflects, you need to go to another section (for example, 'Application settings'), and return to 'Custom domains' again - now there should be shown the added (sub) domains and their settings. <br><br>  Now the project will be (not immediately, but within 24 hours) available at {project ID} .appspot.com, as well as at the added addresses (domains). <br><br><h1>  SSL setup </h1><br>  Access to the address {project ID} .appspot.com can be done either via http or https <br>  In order to provide access via https to our own domain, we need an SSL certificate signed by a certification authority (English Certification authority, CA) whose signature is accepted by browsers. <br>  The leading <a href="https://en.wikipedia.org/wiki/Certificate_authority">service</a> providers of the certification center are currently <a href="http://www.symantec.com/">Symantec</a> with the <a href="https://www.geotrust.com/">GeoTrust</a> , <a href="https://www.thawte.com/">Thawte</a> , <a href="https://www.symantec.com/ssl-certificates/">Verisign</a> , the same <a href="https://www.godaddy.com/web-security/ssl-certificate">Godaddy</a> , and <a href="https://www.comodo.com/">Comodo</a> brands.  The largest market share, and lower prices from Comodo.  If you purchase certificates through resellers, the price is usually even lower. <br><br>  To start / learn, you can use the <a href="https://www.comodo.com/e-commerce/ssl-certificates/free-ssl-certificate.php">free Comodo certificate for 90 days</a> (issued free of charge once per domain) and / or a similar offer for 30 days from <a href="https://www.freessl.com/">RapidSSL</a> . <br><br>  In order to receive a certificate, you need to send the provider a <a href="https://en.wikipedia.org/wiki/Certificate_signing_request">certificate signing request (CSR)</a> ( <a href="https://en.wikipedia.org/wiki/Certificate_signing_request">certificate signing request</a> ).  Some services offer certificate generation on the site, however, in this case there is no guarantee that only you will have the secret key, therefore it is better to generate the CSR yourself.  To do this, use the <a href="https://www.openssl.org/">OpenSSL</a> utility. <br><br>  First, create a configuration file for CSR (let's call it scr.conf): <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># csr.conf # you can rename scr.conf, scr.key, scr.csr to filenames you prefer, # but with the same filename extensions [req] default_bits = 2048 # default_md = sha512 default_keyfile = csr.key #name of keyfile distinguished_name = req_distinguished_name prompt = yes # If 'prompt = no' provide right values to properties, not to _default properties # and remove or comment _default properties. # Use 'yes' and _default to see and correct values interactively encrypt_key = no # # req_extensions = v3_req #this is for multi-domain certificate [req_distinguished_name] # # Use your company name, e-mai, domain names as default values # if you enter '.', the field will be left blank # countryName = Country Name (2 letter code) countryName_default = GB stateOrProvinceName = State or Province Name (full name) stateOrProvinceName_default = City of London localityName = Locality Name (eg, city) localityName_default = London organizationName = Organization name organizationName_default = MyCompany Limited organizationalUnitName = Organizational Unit Name (eg, section) organizationalUnitName_default = . commonName = This is fully qualified domain name that you wish to secure # eg www.example.com or mail.example.com commonName_default = www.my-domain.com emailAddress = Email Address emailAddress_default = admin@my-domain.com # [v3_req] # subjectAltName = @alt_names #this is for multi-domain certificate # [alt_names] #this is for multi-domain certificate # DNS.1 = my-domain.net #this is for multi-domain certificate # DNS.2 = my-domain.org #this is for multi-domain certificate # DNS.3 = myseconddomain.com #this is for multi-domain certificate # to generate .csr: # openssl req -newkey rsa:2048 -sha512 -out csr.csr -config csr.conf # or: # openssl req -newkey rsa:2048 -sha512 -nodes -out csr.csr -config csr.conf # Note: If the "-nodes" is entered the key will NOT be encrypted with a # DES pass phrase, ( see: # https://support.comodo.com/index.php?/Default/Knowledgebase/Article/View/1/19/csr-generation-using-openssl-apache-wmod_ssl-nginx-os-x # ) # # to verify .csr: # openssl req -text -noout -verify -in csr.csr # # in one command generate and verify: # openssl req -newkey rsa:2048 -out csr.csr -config csr.conf &amp;&amp; openssl req -text -noout -verify -in csr.csr #</span></span></code> </pre><br><br>  now run the command: <br><br><pre> <code class="bash hljs">openssl req -newkey rsa:2048 -out csr.csr -config csr.conf</code> </pre><br><br>  if in the settings we specified 'prompt = yes', then we have the opportunity to view the input values ‚Äã‚Äãand change them.  If you do not need to change the default values, simply press 'Enter' <br><br>  As a result, we will create two new files: csr.key is a private key, and csr.csr is a CSR (certificate signing request) <br><br>  You can check the CSR with the command: <br><pre> <code class="bash hljs">openssl req -text -noout -verify -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> csr.csr</code> </pre><br>  The .csr file needs to be opened with a text editor, inside there will be something like: <br><pre> <code class="bash hljs">-----BEGIN CERTIFICATE REQUEST----- MIIC5TCCAc0CAQAwgZ8xCzAJBgNVBAYTAkdCMRcwFQYDVQQIDA5DaXR5IG9mIExv bmRvbjEPMA0GA1UEBwwGTG9uZG9uMRowGAYDVQQKDBFNeUNvbXBhbnkgTGltaXRl NZBB4bDdgJ+uyNZq54dM1tUvzSolv/+LAY78/z85edqLH4nc5CxgMEn8hurFOpB4 RXS+ShhpBsJr6RJhSk2xkRe/idkM/TUon/7n1TUthFpjv2tYQZ6on3iWUZ61FDuM mNPHGMIX+sn/OceViRtlu1Lx+t4JV9dTJQ== -----END CERTIFICATE REQUEST-----</code> </pre><br>  The contents of the file will need to be copied and pasted into a form on the website, something like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e6e/55d/21a/e6e55d21a69523430a4173af6244adea.png" alt="image"><br><br>  For the simplest verification of domain ownership, you should have access to the e-mail issued by whois, or to one of the email addresses in this domain: <br>  admin @ <br>  administrator @ <br>  postmaster @ <br>  hostmaster @ <br>  webmaster @ <br><br>  Either you need to place http: //yourdomain.com/{Upper case value of MD5 hash of CSR} .txt or modify the DNS CNAME record by specifying again the corresponding hash. <br><br>  Extended verification: Extended Business Verification or abbreviated as EV, requires the provision of documents to the organization for which the certificate is issued, but allows you to get a certificate with a green line (GreenBar) in the browser which reflects the name of the organization that owns the certificate. <br><br>  After passing the check, you can download from the provider's website or receive an e-mail file of the form {your domain or order number} .crt, usually in a package (.zip) with certificates of the certification center, which also have the extension .crt This .zip file needs to be unzipped in a separate directory. <br><br>  Our certificate we can check and view the information contained in it with the command: <br><pre> <code class="bash hljs">openssl x509 -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> { }.crt -text -noout</code> </pre><br>  where {file name} .crt is the name of our certificate file. <br><br>  Now for GAE, we need to convert our private key from .key format to .pem format: <br><pre> <code class="bash hljs">openssl rsa -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> *.key &gt; forGAE.key.pem</code> </pre><br><br>  <b><i>Attention</i></b> : in this command, you do not need to specify the -text parameter, as recommended on Google, since this command adds unnecessary and unnecessary text to the key in this case.  If you try to load a key, you get the message: <br>  'The private key you selected doesn‚Äôt have to be valid' <br>  This is most likely the reason.  Open the file with a text editor and delete everything above the line ----- BEGIN RSA PRIVATE KEY ----- <br>  Or convert the key again, without the -text option. <br><br>  2) connect (oncatenate) all .crt files from the resulting .zip file (and our certificate, and server certificates), with a command like this: <br> <code>cat mydomain_com.crt ASecureServerCA.crt ATrustCA.crt ATrustExternal.crt &gt; concat.crt <br></code> <br><br>  <b><i>Attention</i></b> : the <i>order of the files is important</i> , (just cat * .crt&gt; concat.crt will not work in this case) our received certificate of our domain must go first, then certificates of the certification center will have different names of files, but not similar ones in the example. <br><br>  Now check the resulting files: <br><br><pre> <code class="bash hljs">openssl x509 -noout -modulus -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> concat.crt | openssl md5</code> </pre><br>  and <br><pre> <code class="bash hljs">openssl rsa -noout -modulus -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> forGAE.key.pem | openssl md5</code> </pre><br><br>  must provide the same value (note: but not in the case of multi-domain certificates). <br><br>  Now in the developer‚Äôs console menu, go to Compute -&gt; Settings -&gt; SSL Sertificates -&gt; Upload a new certificate <br><br><img src="https://habrastorage.org/getpro/habr/post_images/008/4c6/96c/0084c696cdf9c12566a1f7760da60af4.png" alt="image"><br><br>  In the 'Name' field, enter the name that we want to give our certificate in the developer console. <br>  In 'PEM encoded X.509 public key certificate' we load our concat.crt <br>  In the 'Unencrypted PEM encoded RSA private key' field we load our key in .pem format (forGAE.key.pem) <br>  Click 'Upload' <br><br><img src="https://habrastorage.org/getpro/habr/post_images/64d/ceb/411/64dceb411f58ce711b1a5b5161e051f3.png" alt="image"><br><br>  Check the checkboxes in front of the domain names for which we can (and want) to activate the certificate (these are the ones specified in the certificate itself, of course), and click the blue 'Save' button: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0e7/abc/c5a/0e7abcc5a9744969e9b91f9394819b15.png" alt="image"><br><br>  Now in the address bar of the browser we will type the name of our domain indicating the httpS: // protocol at the beginning <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5b8/b63/aa2/5b8b63aa2c39c22bcd9354c3c349512a.png" alt="image"><br><br>  There is nothing on the site yet, but at the beginning of the address bar we will see a green lock, by clicking on it we can view the certificate data. <br>  SSL is working. <br><br><h1>  Application skeleton </h1><br>  Also as in the <a href="http://habrahabr.ru/post/268863/">first part we</a> use Maven: <br><pre> <code class="bash hljs">mvn archetype:generate -Dappengine-version=1.9.28 -Dapplication-id=hello-habrahabr-webapp -Dfilter=com.google.appengine.archetypes:</code> </pre><br>  (hello-habrahabr-webapp - in this case, the project ID) <br><br>  But since this project will not have Cloud Points API, then instead of archetype No. 2, we select archetype No. 1 (the basic skeleton of the application on GAE): <br><pre> <code class="bash hljs">1: remote -&gt; com.google.appengine.archetypes:appengine-skeleton-archetype (A skeleton application with Google App Engine)</code> </pre><br>  the rest is similar to what is stated in the <a href="http://habrahabr.ru/post/268863/">first part</a> , but with a different project ID. <br>  Thus, Maven will create a hello-habrahabr-webapp folder for us, with a file structure similar to the previous project, but in this case the src / main / java / directory will be empty and we will not need it for the frontend now. <br><br>  Similarly, as we did before, we edit pom.xml (in &lt;appengine.version&gt; 1.9.27 &lt;/appengine.version&gt; you can now change to the latest 1.2.8).  Go to the directory src / main / webapp / WEB-INF / edit the files appengine-web.xml and web.xml <br>  The web.xml us is now almost empty, so we‚Äôll add (between &lt;web-app&gt; &lt;/ web-app&gt;) the security-constraint and welcome-file-list sections: <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-app</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2.5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Force SSL for entire site --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- (server automatically redirects the requests to the SSL port if you try to use HTTP ) --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security-constraint</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-resource-collection</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-resource-name</span></span></span><span class="hljs-tag">&gt;</span></span>Entire Application<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-resource-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span>/*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-resource-collection</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user-data-constraint</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">transport-guarantee</span></span></span><span class="hljs-tag">&gt;</span></span>CONFIDENTIAL<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">transport-guarantee</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user-data-constraint</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security-constraint</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Welcome file list --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">welcome-file-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">welcome-file</span></span></span><span class="hljs-tag">&gt;</span></span>index.html<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">welcome-file</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">welcome-file-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-app</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Create set.account.sh and commit.push.build.and.upload.sh scripts in this project similar to those in the first part, and run the commands: <br><pre> <code class="bash hljs">git init gcloud init git config credential.helper gcloud.sh git remote add google https://source.developers.google.com/p/hello-habrahabr-webapp git push --all google set.account.sh commit.push.build.and.upload.sh</code> </pre><br>  We are convinced that the project is successfully assembled and uploaded to the server. <br><br>  Maven collects the project into a .war file located in the target directory and uploads it to the GAE server.  The same file can be deployed to another compatible java-server (Tomcat, Jetty).  To run a .war file that will be deployed to GAE on a local machine, you need: <br><br>  1) have <a href="https://cloud.google.com/sdk">Google Cloud SDK</a> installed (installation was discussed in the <a href="http://habrahabr.ru/post/268863/">first part</a> ) <br><br>  2) install the Cloud SDK app-engine-java component: <br><pre> <code class="bash hljs">gcloud components update app-engine-java</code> </pre><br>  3) make sure that Java 7 is on the default machine (the deployment with the mvn appengine: update command is also possible at 8), if not, then (on Linux) edit ~ / .bashrc <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> JAVA_HOME=/usr/lib/jvm/java-7-oracle/ <span class="hljs-comment"><span class="hljs-comment">#     Java 7 (   ) export PATH=$JAVA_HOME/bin:$PATH</span></span></code> </pre><br>  and restart with the command: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ~/.bashrc</code> </pre><br>  4) if not already created, create a .war by running in the project directory: <br><pre> <code class="bash hljs">mvn clean install</code> </pre><br>  The .war file we can find at the address in target / {project ID} - {version} .war <br>  5) in the project directory run the command: <br><pre> <code class="bash hljs">mvn gcloud:run</code> </pre><br>  The server will be available at <a href="http://localhost/">localhost</a> : 8080, and <a href="http://localhost/">localhost</a> : 8000 will be the administrative panel of the local server. <br><br><h1>  API access without authentication </h1><br>  Let's start with the simple.  Last time, we created a simple API available without authentication ('myApi API') by POST request to <a href="https://hello-habrahabr-api.appspot.com/_ah/api/myApi/v1/register">hello-habrahabr-api.appspot.com/_ah/api/myApi/v1/register</a> (file YourFirstAPI.java).  Let's modify this file somewhat so that it displays information in logs, which I recall are available in the developer‚Äôs console in the project menu: Monitoring -&gt; Logs, and also contained the method that processes the GET request: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.appspot.hello_habrahabr_api; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.Api; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.ApiMethod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.ApiMethod.HttpMethod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.logging.Logger; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Random; <span class="hljs-meta"><span class="hljs-meta">@Api</span></span>(name = <span class="hljs-string"><span class="hljs-string">"myApi"</span></span>, <span class="hljs-comment"><span class="hljs-comment">//The api name must match '[az]+[A-Za-z0-9]*' version = "v1", scopes = {Constants.EMAIL_SCOPE}, description = "first API for this application.") public class YourFirstAPI { @SuppressWarnings("unused") private static final Logger LOG = Logger.getLogger(YourFirstAPI.class.getName()); @ApiMethod( name = "registerPOST", path = "register", httpMethod = HttpMethod.POST ) @SuppressWarnings("unused") public MessageToUser registerPOST(final UserForm userForm) { LOG.warning("[YourFirstAPI] (HTTP Method: POST): userForm: {name: " + userForm.getName() + ", age: " + userForm.getAge() + ", ishuman: " + userForm.getIshuman() + "}" ); MessageToUser messageToUser = new MessageToUser(); messageToUser.setMessage("Hi, " + userForm.getName() + ", you are registered on our site"); Random random = new Random(); messageToUser.setUsernumber(random.nextInt(100) + 1); messageToUser.setIsregistered(true); return messageToUser;} @ApiMethod( name = "getGreeting", path = "getgreeting", httpMethod = HttpMethod.GET ) @SuppressWarnings("unused") public MessageToUser getGreeting(final UserForm userForm) { LOG.warning("[YourFirstAPI] (HTTP Method: GET): userForm: {name: " + userForm.getName() + ", age: " + userForm.getAge() + ", ishuman: " + userForm.getIshuman() + "}" ); MessageToUser messageToUser = new MessageToUser(); messageToUser.setMessage("Hi, " + userForm.getName() + ", nice to meet you :)"); Random random = new Random(); messageToUser.setUsernumber(random.nextInt(100) + 1); messageToUser.setIsregistered(false); return messageToUser;} }</span></span></code> </pre><br><br>  and upload it to the server (use the previously created commit.push.build.and.upload.sh script) <br><br>  Now in the project in which we create the frontend we will create a form for such a request.  Moving to the src / main / webapp / directory is a place where you can place static files starting from index.html, directories other than WEB-INF / will also be available for queries.  Moreover, since this is still a Java server, then of course any such file can also be generated by a servlet. <br><br>  So, index.html: <br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"favicon.ico?"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- JQUERY 2.1.4 --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/jquery-2.1.4.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- BOOTSTRAP 3.3.5 --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/bootstrap.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/bootstrap-theme.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/bootstrap.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ANGULARJS 1.4.7 --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/angular.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/angular-route.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- &lt;script src="https://code.jquery.com/jquery-2.1.4.min.js"&gt;&lt;/script&gt; &lt;link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"&gt; &lt;link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css"&gt; &lt;script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"&gt;&lt;/script&gt; &lt;script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.min.js"&gt;&lt;/script&gt; &lt;script src="https://code.angularjs.org/1.4.7/angular-route.min.js"&gt;&lt;/script&gt; --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- angular-google-gapi --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- https://github.com/maximepvrt/angular-google-gapi/releases --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/angular-google-gapi.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ngProgress --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- https://github.com/VictorBjelkholm/ngProgress --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/ngprogress.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/ngProgress.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- angular-google-gapi --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- https://github.com/maximepvrt/angular-google-gapi/releases --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/angular-google-gapi.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ~~~ MY APP ~~~ --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- main app module --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js/app.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- controllers --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js/simpleformcontroller.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js/authformcontroller.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Cloud Endpoints Frontend<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-app</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myApp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-view</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-view</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  We have prescribed <a href="https://code.angularjs.org/1.4.7/docs/api">AngularJS</a> with the module (from the standard set) <a href="https://code.angularjs.org/1.4.7/docs/api/ngRoute">ngRoute</a> . <br><br>  And also, for the site to have a user-friendly look, we will add <a href="http://getbootstrap.com/">Bootstrap</a> (+ <a href="https://jquery.com/">jQuery</a> ), and AngularJS the <a href="https://github.com/VictorBjelkholm/ngProgress">ngProgress</a> module.  The latter is used to display process indicators (progress bar), we will use it to show the user the progress of requests. <br><br>  We denoted the angualrjs application as ‚ÄúmyApp‚Äù () and specified the place to insert the templates (&lt;ng-view&gt; &lt;/ ng-view&gt;) to the application, and indicated two angularjs-controllers: js / simpleformcontroller.js and js / authformcontroller.js , respectively, for working with requests with and without authentication. <br><br>  We will need the angular-google-gapi module to work with authentication, and will be discussed further. <br><br>  Now create the main app.js module: <br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span>; ( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// create main module var app = angular.module("myApp", [ 'ngRoute', // https://code.angularjs.org/1.4.7/docs/api/ngRoute 'ngProgress' // https://github.com/victorbjelkholm/ngprogress ] ); // routes app.config(function ($routeProvider) { $routeProvider.when('/', { templateUrl: "templates/simpleform.html", controller: "SimpleFormController" }).when('/auth/', { templateUrl: "templates/authform.html", controller: "AuthFormController" }) .otherwise({redirectTo: '/'}) } ); }() );</span></span></code> </pre><br><br>  And the js / simpleformcontroller.js controller: <br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span>; ( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> SimpleFormController = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$scope, $http, ngProgressFactory</span></span></span><span class="hljs-function">) </span></span>{ $scope.progressbar = ngProgressFactory.createInstance(); $scope.progressbar.setColor(<span class="hljs-string"><span class="hljs-string">'blue'</span></span>); $scope.data = {}; <span class="hljs-comment"><span class="hljs-comment">// data from form (ng-model="data. ...") // $http configuration object // https://code.angularjs.org/1.4.7/docs/api/ng/service/$http#usage $scope.postReq = { method: 'POST', url: 'https://hello-habrahabr-api.appspot.com/_ah/api/myApi/v1/register', data: $scope.data // 'data' for POST }; $scope.getReq = { method: 'GET', url: 'https://hello-habrahabr-api.appspot.com/_ah/api/myApi/v1/getgreeting', params: $scope.data // 'params:' for GET }; $scope.actionPost = function() { $scope.progressbar.start(); console.log("request sent:"); // for testing console.log($scope.postReq); // for testing // AJAX request: // $http(req).then(function(){...}, function(){...}); $http($scope.postReq).then(function(response) { // success: $scope.progressbar.complete(); $scope.serverresponse = response; $scope.errormessage = null; console.log("response received:"); console.log(response); }, // comma operator, see: https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Comma_Operator function(response) { // error: $scope.progressbar.complete(); $scope.errormessage = response; $scope.serverresponse = null; console.log("get Error form server:"); console.log(response); }); }; $scope.actionGet = function() { $scope.progressbar.start(); console.log("request sent:"); // for testing console.log($scope.getReq); // for testing // AJAX request: // $http(req).then(function(){...}, function(){...}); $http($scope.getReq).then(function(response) { // success: $scope.progressbar.complete(); $scope.serverresponse = response; $scope.errormessage = null; console.log("response received:"); console.log(response); }, // comma operator, see: https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Comma_Operator function(response) { // error: $scope.progressbar.complete(); $scope.errormessage = response; $scope.serverresponse = null; console.log("get Error form server:"); console.log(response); }); }; $scope.clear = function() { $scope.serverresponse = null; $scope.errormessage = null; $scope.data = null; }; }; // $inject property annotation // see: https://code.angularjs.org/1.4.7/docs/guide/di SimpleFormController.$inject = ['$scope', '$http', 'ngProgressFactory']; angular.module('myApp') .controller('SimpleFormController', SimpleFormController); }());</span></span></code> </pre><br><br>  So: we created the module ‚ÄúMyApp‚Äù, the controller ‚ÄúSimpleFormController‚Äù and in it functions for GET and POST requests to the 'myApi API' (which in turn are processed by the code in the file YourFirstAPI.java) In this case, we will download data from by pressing the buttons, but of course you can download the data immediately when the controller is loaded. <br><br>  Now we create the templates / simpleform.html template in which there will be an html form for the API request and the server response will be displayed: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Navigation Bar --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nav</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"navbar navbar-inverse"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"navbar-brand"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#/"</span></span></span><span class="hljs-tag">&gt;</span></span>Front-end for Cloud Endpoints API<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nav navbar-nav"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"active"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#/"</span></span></span><span class="hljs-tag">&gt;</span></span>Home<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#/auth/"</span></span></span><span class="hljs-tag">&gt;</span></span>Auth<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nav</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Form --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fieldset</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">legend</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"font-weight: bold;"</span></span></span><span class="hljs-tag">&gt;</span></span>Submit your data to server<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">legend</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> Name: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-model</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"data.name"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> Age: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"range"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"120"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">step</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-model</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"data.age"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-model</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"data.age"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ageNumber"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"col-md-3"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"col-md-5"</span></span></span><span class="hljs-tag">&gt;</span></span>years old<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> Is a human: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"checkbox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-model</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"data.ishuman"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"data.ishuman"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fieldset</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Submit GET"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"actionGet()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Submit POST"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"actionPost()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"reset"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"clear()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Server Response --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"panel panel-default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-hide</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(serverresponse != null || errormessage != null)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"panel-body"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"serverresponse != null"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"panel-body"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Response from server: <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {{ serverresponse.data.message }} and your number is: {{serverresponse.data.usernumber}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"errormessage != null"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"panel-body"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Error from server: <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {{errormessage.data.error.message}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total at this stage: index.html, templates / simpleform.html, js / app.js, js / simpleformcontroller.js </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To test, start the server in the src / main / webapp / directory:</font></font><br><pre> <code class="bash hljs">python -m SimpleHTTPServer</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and test the application: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e38/154/a95/e38154a958ad94c7416f91e906d69135.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/51a/8af/f2d/51a8aff2dfe15e27b32e372c59bf4806.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If everything is fine, deploy it.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API access with Google account login / password authentication (OAuth 2.0) </font></font></h1><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Preparing the backend </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At the beginning in the developer‚Äôs console in the project‚Äôs backend (we had hello-habrahabr-api) in the menu: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APIs &amp; auth -&gt; Credentials -&gt; Add Credentials -&gt; OAuth 2.0 Client ID </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we have to register the addresses from which Javascript can access the API (Authorized JavaScript origins) using Google‚Äôs OAuth 2.0, i.e. In our case, we will register hello-habrahabr-webapp.appspot.com and / or our domain for which we have made SSL certificates, as discussed above. If you need the ability to log in from the local server, then you need to register localhost + port number, for example </font></font><a href="http://localhost/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localhost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 8000 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the 'Name' field, enter an arbitrary configuration name, for example, 'Web Client', and save the configuration with the "Save" button:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/676/d8b/b0d/676d8bb0dd8415fced352bf334bb69dc.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You need to copy the contents of the ‚ÄúClient ID‚Äù field, like: 647700180043-m8et0au4vhgiv2n4iqr2hssn0mkkl7q0.apps.googleusercontent.com, or load the JSON file with all the configuration settings by clicking on the icon that is marked in red in the picture. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In a project with an API (we have this hello-habrahabr-api) in the Constants.java file: WEB_CLIENT_ID, you need to assign the Client ID value, and EMAIL_SCOPE - ‚Äú </font></font><a href="https://www.googleapis.com/auth/userinfo.email"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.googleapis.com/auth/userinfo.email</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù:</font></font><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.appspot.hello_habrahabr_api; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.Constant; <span class="hljs-comment"><span class="hljs-comment">/** * Contains the client IDs and scopes for allowed clients consuming your API. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Constants</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String WEB_CLIENT_ID = <span class="hljs-string"><span class="hljs-string">"647700180043-m8et0au4vhgiv2n4iqr2hssn0mkkl7q0.apps.googleusercontent.com"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String ANDROID_CLIENT_ID = <span class="hljs-string"><span class="hljs-string">"replace this with your Android client ID"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String IOS_CLIENT_ID = <span class="hljs-string"><span class="hljs-string">"replace this with your iOS client ID"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String ANDROID_AUDIENCE = WEB_CLIENT_ID; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String EMAIL_SCOPE = <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/auth/userinfo.email"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String API_EXPLORER_CLIENT_ID = Constant.API_EXPLORER_CLIENT_ID; }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now we modify our OAuth2Api.java, in the @ Api annotation you need to register: </font></font><br><pre> <code class="java hljs"> scopes = {Constants.EMAIL_SCOPE}, clientIds = {Constants.WEB_CLIENT_ID, Constants.API_EXPLORER_CLIENT_ID},</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This means that this class will process requests from web clients to which the specified Client ID is assigned (the client must not only send the correct Client ID, but also the request must be from the domain specified in the APIs &amp; auth - Credentials configuration) with email authentication . </font><font style="vertical-align: inherit;">If these parameters are not specified in OAuth2Api.java, then API requests will respond with error 401. Accordingly, if you do not specify Constants.API_EXPLORER_CLIENT_ID, then when testing in the API Explorer, i.e. </font><font style="vertical-align: inherit;">the web interface at the address of the form {project ID} .appspot.com / _ah / api / explorer will also receive an error 401 (that is, the </font></font><a href="http-responses"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server cannot authenticate the user</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OAuth2Api.java in the new edition:</font></font><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.appspot.hello_habrahabr_api; <span class="hljs-comment"><span class="hljs-comment">/** * explore on: https://apis-explorer.appspot.com/apis-explorer/?base=https://hello-habrahabr-api.appspot.com/_ah/api#p/oAuth2Api/v1/ */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.Api; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.ApiMethod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.ApiMethod.HttpMethod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.response.UnauthorizedException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.appengine.api.users.User; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.appengine.repackaged.com.google.gson.Gson; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Random; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.logging.Logger; <span class="hljs-meta"><span class="hljs-meta">@Api</span></span>(name = <span class="hljs-string"><span class="hljs-string">"oAuth2Api"</span></span>, <span class="hljs-comment"><span class="hljs-comment">// The api name must match '[az]+[A-Za-z0-9]*' version = "v1", scopes = {Constants.EMAIL_SCOPE}, clientIds = {Constants.WEB_CLIENT_ID, Constants.API_EXPLORER_CLIENT_ID}, description = "API using OAuth2") public class OAuth2Api { @SuppressWarnings("unused") private static final Logger LOG = Logger.getLogger(OAuth2Api.class.getName()); @ApiMethod( name = "getUserInfo", path = "getuserinfo", httpMethod = HttpMethod.POST ) @SuppressWarnings("unused") public MessageToUser getUserInfo(final User user, final UserForm userForm) throws UnauthorizedException { if (user == null) { LOG.warning("User not logged in"); throw new UnauthorizedException("Authorization required"); } MessageToUser messageToUser = new MessageToUser(); Gson gson = new Gson(); messageToUser.setMessage( "Hi, " + userForm.getName() + ", your data from Google: " + gson.toJson(user) ); Random random = new Random(); messageToUser.setUsernumber(random.nextInt(100) + 1); messageToUser.setIsregistered(true); return messageToUser; } }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We can test our API in the API Explorer, and move on to the frontend. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Frontend for authenticated requests </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For access to the API with Google authentication, the API provides the </font></font><a href="https://developers.google.com/api-client-library/javascript/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Client Library for JavaScript API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , for our application we will use the AngularJS module on the AngularJS web client </font></font><a href="https://github.com/maximepvrt/angular-google-gapi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">angular-google-gapi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is essentially a wrapper for the specified library and makes its use with AngularJS much more comfortable. </font><font style="vertical-align: inherit;">For basic instructions on using the module, see </font></font><a href="https://github.com/maximepvrt/angular-google-gapi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/maximepvrt/angular-google-gapi.</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We added</font></font><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vendors/angular-google-gapi.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">at index.html </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add a dependency to the main application module (var app = angular.module ('myApp', ['angular-google-gapi']);), and set the configuration using app.run (...). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It will look like this (js / app.js):</font></font><br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span>; ( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// create main module var app = angular.module("myApp", [ 'ngRoute', // https://code.angularjs.org/1.4.7/docs/api/ngRoute 'ngProgress', // https://github.com/victorbjelkholm/ngprogress 'angular-google-gapi' // https://github.com/maximepvrt/angular-google-gapi/ - add app.run() after app.config() ]); // routes app.config(function ($routeProvider) { $routeProvider.when('/', { templateUrl: "templates/simpleform.html", controller: "SimpleFormController" }).when('/auth/', { templateUrl: "templates/authform.html", controller: "AuthFormController" }).otherwise({redirectTo: '/'}) }); app.run(['GAuth', 'GApi', 'GData', '$rootScope', function (GAuth, GApi, GData, $rootScope) { $rootScope.gdata = GData; // var CLIENT = '647700180043-m8et0au4vhgiv2n4iqr2hssn0mkkl7q0.apps.googleusercontent.com'; var BASE = 'https://hello-habrahabr-api.appspot.com/_ah/api'; GApi.load('oAuth2Api', 'v1', BASE); GAuth.setClient(CLIENT); // see: https://github.com/maximepvrt/angular-google-gapi/issues/8 GAuth.setScope("https://www.googleapis.com/auth/userinfo.email"); GAuth.checkAuth().then( function () { // action if it's possible to authenticate user at startup of the application console.log("user authenticated, $rootScope.gapi.user: "); console.log(console.log($rootScope.gapi.user)); }, function () { // action if it's impossible to authenticate user at startup of the application console.log("user not authenticated, $rootScope.gapi.user: "); console.log(console.log($rootScope.gapi.user)); } ); $rootScope.login = function () { // shows auth window from Google GAuth.login().then( function () { console.log('user logged in'); console.log(console.log($rootScope.gapi.user)); }); }; /* * As stated on * https://cloud.google.com/appengine/docs/java/endpoints/consume_js: * "There is no concept of signing out using the JS client library, * but you can emulate the behavior if you wish by any of these methods: * - Resetting the UI to the pre signed-in state. * - Setting any signed-in variables in your application logic to false * - Calling gapi.auth.setToken(null);" // &lt;- * * */ $rootScope.logout = function () { GAuth.logout().then( function () { console.log('user logged out'); console.log(console.log($rootScope.gapi.user)); }); }; } ]); }() );</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Please note that we have placed the login () and logout () functions in $ rootScope, in our example this is not essential, but they will be available in different parts of the application (when there are these different parts). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now the js / authformcontroller controller. js:</font></font><br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span>; ( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> AuthFormController = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$scope, $rootScope, $http, GApi, GAuth, ngProgressFactory</span></span></span><span class="hljs-function">) </span></span>{ $scope.progressbar = ngProgressFactory.createInstance(); $scope.progressbar.setColor(<span class="hljs-string"><span class="hljs-string">'#00F'</span></span>); $scope.data = {}; <span class="hljs-comment"><span class="hljs-comment">// object to store form data $scope.authrequest = function () { $scope.progressbar.start(); GAuth.checkAuth().then( function () { // if it's possible to authenticate user GApi.executeAuth( // execute request 'oAuth2Api', 'getUserInfo', $scope.data // data to send to server ) .then(function (resp) { // receive response $scope.userinfofromserver = resp; console.log("GApi.executeAuth() get resp:"); console.log(resp); $scope.progressbar.complete(); }); }, function () { // if it's impossible to authenticate user $scope.userinfofromserver = {}; $scope.userinfofromserver.message = 'User not logged in '; console.log("GAuth.checkAuth() - failed: "); console.log(console.log($rootScope.gapi.user)); $scope.progressbar.complete(); } ); }; $scope.clear = function () { $scope.userinfofromserver = null; $scope.data = null; }; }; // $inject property annotation // see: https://code.angularjs.org/1.4.7/docs/guide/di AuthFormController.$inject = ['$scope', '$rootScope', '$http', 'GApi', 'GAuth', 'ngProgressFactory']; angular.module('myApp') .controller('AuthFormController', AuthFormController); }() );</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Please note that before running GApi.executeAuth (), we run GAuth.checkAuth () - this is different from the approach used by the author of the module, but it seems to me more logical, GApi.executeAuth () will update the authentication before sending the request, In this way, the user will not receive authorization errors when requesting after a long period of inactivity on the site, etc. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The $ rootScope will now contain a gapi.user object, which contains accessible information about the logged in user:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> user.email </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> user.picture (user avatar, url picture) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> user.id (Google id (number)) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> user.name (username, or if it is missing, email) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> user.link (link to Google+ user‚Äôs page if it exists) </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Thus, in the template, we can show the photo and email to the logged in user, use this in templates / authform.html: </font></font><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Navigation Bar --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nav</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"navbar navbar-inverse"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"navbar-brand"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#/"</span></span></span><span class="hljs-tag">&gt;</span></span>Front-end for Cloud Endpoints API<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nav navbar-nav"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#/"</span></span></span><span class="hljs-tag">&gt;</span></span>Home<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"active"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#/auth/"</span></span></span><span class="hljs-tag">&gt;</span></span>Auth<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nav navbar-nav navbar-right"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gapi.user"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"navbar-brand"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"padding-top: 0;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{gapi.user.picture}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"navbar-brand"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"padding-top: 0; padding-bottom: 0;"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nav navbar-nav navbar-right"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"!gapi.user"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"active"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"login()"</span></span></span><span class="hljs-tag">&gt;</span></span>login<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gapi.user"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span>{{gapi.user.email}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gapi.user"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logout()"</span></span></span><span class="hljs-tag">&gt;</span></span>logout<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nav</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Form --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fieldset</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">legend</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"font-weight: bold;"</span></span></span><span class="hljs-tag">&gt;</span></span>Submit your request to server<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">legend</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> Your name: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-model</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"data.name"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fieldset</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Auth request"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"authrequest()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"reset"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"clear()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Server Response --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"panel panel-default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"font-weight: bold;"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-hide</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(userinfofromserver != null)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"panel-body"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"userinfofromserver"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"panel-body"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> User's data from server (reg # {{userinfofromserver.usernumber}}): <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>{{userinfofromserver.message}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's reload the home page of our website: </font></font><br><br><img src="https://raw.githubusercontent.com/ageyev/cloud-endpoints-tutorial/master/habrahabr/images2/Selection_022.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the console, we see that the script tried to immediately recognize the user, but the user is still ‚Äúunfamiliar‚Äù. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Follow the 'Auth' link: </font></font><br><img src="https://raw.githubusercontent.com/ageyev/cloud-endpoints-tutorial/master/habrahabr/images2/Selection_023.png" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enter the name in the 'Your name' field and click the 'Auth request' button: </font></font><br><img src="https://raw.githubusercontent.com/ageyev/cloud-endpoints-tutorial/master/habrahabr/images2/Selection_024.png" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we log in (the 'login' link in the navigation bar) using a Google account: </font></font><br><img src="https://raw.githubusercontent.com/ageyev/cloud-endpoints-tutorial/master/habrahabr/images2/Selection_025.png" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After the login, our navigation bar will show the user's photo from Google account, email with which the user has logged in, and the link 'logout'. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If we now send the request to the server again (using the 'Auth request' button), we will receive the server's response as befits a logged in user:</font></font><br><img src="https://raw.githubusercontent.com/ageyev/cloud-endpoints-tutorial/master/habrahabr/images2/Selection_026.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this way, we can implement the connection of the web client and server over a secure channel and with user authentication without the need to store passwords on our own server. </font><font style="vertical-align: inherit;">As I said in the previous article, the trend may be the lack of proper username-password authentication on sites and the use of </font></font><a href="http://oauth.net/2/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OAuth 2.0</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> authentication by </font><font style="vertical-align: inherit;">reliable providers.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Additional materials: </font></font></h3><br><ul><li> <a href="https://cloud.google.com/appengine/docs/java/endpoints/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud Endpoints Tutorial from Google</font></font></a> </li><li> <a href="https://cloud.google.com/appengine/docs/java/endpoints/annotations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Endpoint Annotations</font></font></a> </li><li> <a href="https://cloud.google.com/appengine/docs/java/javadoc/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google App Engine Java API (Javadoc)</font></font></a> </li><li> <a href="https://cloud.google.com/solutions/angularjs-cloud-endpoints-recipe-for-building-modern-web-applications"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AngularJS + Cloud Endpoints - A Recipe for Building Modern Web Applications</font></font></a> </li><li> <a href="https://github.com/maximepvrt/angular-google-gapi/tree/gh-pages"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sample web application code using angular-google-gapi, from the author of the module (on GitHub)</font></font></a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/270459/">https://habr.com/ru/post/270459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270447/index.html">Design development for MyOffice applications</a></li>
<li><a href="../270449/index.html">Some repositories to help learners and teachers of Python and machine learning.</a></li>
<li><a href="../270451/index.html">7 enhanced features of Visual Studio 2015 Enterprise</a></li>
<li><a href="../270453/index.html">Big data from A to Z. Part 3: Techniques and strategies for developing MapReduce-applications</a></li>
<li><a href="../270457/index.html">Apple TV</a></li>
<li><a href="../270461/index.html">Web two-null shortcuts for Java</a></li>
<li><a href="../270463/index.html">Nginx + Lua + Redis. Effectively process the session and give the data</a></li>
<li><a href="../270465/index.html">Using Matalysis in computer games</a></li>
<li><a href="../270469/index.html">Full Binary XML Replacement</a></li>
<li><a href="../270471/index.html">What's new and interesting in IntelliJ IDEA 15</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>