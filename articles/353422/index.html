<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Three-dimensional engine on Excel formulas for dummies</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will tell you how I managed to port the rendering algorithm of three-dimensional scenes to Excel formulas (without macros). 

 For t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Three-dimensional engine on Excel formulas for dummies</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/s4/zz/-b/s4zz-bypjmx9cweazahw02smw9a.png"><br><br>  In this article I will tell you how I managed to port the rendering algorithm of three-dimensional scenes to Excel formulas (without macros). <br><br>  For those who are not familiar with computer graphics, I tried to describe all the steps as simply as possible and in more detail.  In principle, for understanding the formulas should be enough knowledge of the school course of mathematics (+ the ability to multiply the three-dimensional matrix by the vector). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I also made a small web application where you can practice creating formulas for arbitrary shapes and generate your Excel file. <br><br>  Caution: 19 pictures and 3 animations under the cut. <br><a name="habracut"></a><br><h1>  What happened </h1><br><ul><li>  <a href="http://pallada-92.github.io/181210_excel/cube.xlsx">File with cube and torus</a> </li><li>  <a href="http://pallada-92.github.io/181210_excel/teapot.xlsx">File with a kettle</a> </li><li>  <a href="https://beta.observablehq.com/%40pallada-92/excel-3d-engine-emulator">ObservableHQ laptop with its Excel files generator</a> </li></ul><br>  In Excel files at the top you can change the following cells: <br><br><ul><li> <code>alpha:</code> horizontal camera rotation in degrees </li><li>  <code>beta:</code> vertical camera rotation in degrees, </li><li>  <code>dist:</code> distance from the camera to the origin, </li><li>  <code>fov:</code> camera zoom. </li></ul><br>  To rotate the camera, you need to give Excel the right to change the file. <br><br>  In the case of downloading your Excel file from ObservableHQ, the cells must be painted manually.  You need to select all the small square cells and select ‚ÄúConditional Formatting‚Äù ‚Üí ‚ÄúColor Scales‚Äù. <br><br><h1>  Ray marching </h1><br>  The Ray Marching algorithm was popularized by I√±igo Quilez in 2008 after the <a href="http://www.iquilezles.org/www/material/nvscene2008/rwwtt.pdf">presentation of Rendering Worlds with Two Triangles</a> about a compact three-dimensional engine for the demostsen. <br><br>  After that, I√±igo Quilez created the <a href="https://www.shadertoy.com/">Shadertoy</a> website, and most of the works sent there use the described methodology.  It turned out that using it you can create photo-realistic scenes, see, for example, <a href="http://iquilezles.org/www/articles/raymarchingdf/raymarchingdf.htm">this gallery</a> . <br><br>  Ray Marching is a very easy-to-implement and efficient algorithm that allows rendering quite complex scenes.  Why then is it not used on video cards?  The fact is that video cards are sharpened to work with three-dimensional figures consisting of triangles, for which Ray Marching is not so effective. <br><br>  <i>Update:</i> See also <a href="https://habr.com/post/353422/">this comment</a> from <a href="https://habr.com/users/drzlodberg/" class="user_link">DrZlodberg</a> about the disadvantages of this method. <br><br><h1>  The principle of the engine </h1><br><ul><li>  The object is described as a function. </li><li>  Match each pixel of the result of the beam leaving the camera. </li><li>  For each ray find the coordinates of the intersection with the object. </li><li>  At the intersection point to determine the color of the pixel. </li></ul><br>  I think that in one form or another, all these subtasks are solved in any three-dimensional engine. <br><br><h1>  Description of the object </h1><br>  You can think of three ways to describe a three-dimensional object: <br><br><ul><li>  An explicit formula that, by a ray coming out of the camera, returns the point of intersection with the object (or, for example, the direction of the tangent in it). </li><li>  Membership function  By a point in space, it tells whether it belongs to an object or not. </li><li>  Real function.  For points inside the object, it is negative, outside - positive. </li></ul><br>  This article will use the special case of the third option, called the <b>signed distance function (SDF)</b> . <br><br>  The SDF receives a point of space as input and returns the distance to the nearest point of the object.  For points inside it is equal to the distance to the boundary of the object with a minus sign. <br><br><h1>  Finding the intersection of the beam and the object </h1><br>  Suppose we have a beam emanating from a camera, and we want to find its intersection point with an object. <br><br>  Several ways come to mind to find this point: <br><br><ul><li>  Go through the points on the ray with some steps. </li><li>  Having a point inside the object and outside, run a binary search to clarify the intersection. </li><li>  Either run any method for finding the roots of the SDF function (which is negative inside the object and positive outside) on the ray. </li></ul><br>  But here we will use another method: <b>Ray Marching</b> . <br><br>  This is a simple algorithm that only works with SDF. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i8/lw/kc/i8lwkctxsiuffnuaywdgie6fawk.gif" width="400"></div><br><br>  Let's parameterize the ray by distance from its beginning by the function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.632ex" height="2.66ex" viewBox="0 -832 7160.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-61" x="451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-79" x="981" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-28" x="1478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-74" x="1868" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-29" x="2229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-3D" x="2896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-28" x="3953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-78" x="4342" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-2C" x="4915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-79" x="5360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-2C" x="5857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-7A" x="6302" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-29" x="6771" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> ray (t) = (x, y, z) </script>  . <br>  Then <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-21"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.406ex" height="2.66ex" viewBox="0 -832 2758 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-61" x="451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-79" x="981" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-28" x="1478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-30" x="1868" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-29" x="2368" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> ray (0) </script>  - this is the camera itself.  Here is the algorithm: <br><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-26"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.101ex" height="1.937ex" viewBox="0 -728.2 2196.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-3D" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-30" x="1695" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> t = 0 </script></li><li>  To repeat <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> N </script>  time: <br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F </font></font></span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.675ex" height="2.66ex" viewBox="0 -832 8901.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-3D" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-74" x="1695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-2B" x="2279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-53" x="3280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-44" x="3925" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-46" x="4754" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-28" x="5503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-72" x="5893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-61" x="6344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-79" x="6874" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-28" x="7371" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-74" x="7761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-29" x="8122" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-29" x="8512" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> t = t + SDF (ray (t)) </script></li></ul></li><li>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt; </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.576ex" height="2.057ex" viewBox="0 -780.1 4553.6 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-3C" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-54" x="1695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-4D" x="2400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-61" x="3451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-78" x="3981" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> t <TMax </script>  then return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-52"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.083ex" height="2.66ex" viewBox="0 -832 2619 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-61" x="451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-79" x="981" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-28" x="1478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-74" x="1868" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-29" x="2229" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> ray (t) </script>  as an intersection point, otherwise report that the ray does not intersect the object. </li></ul><br>  Here <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> N </script>  the number of iterations we can afford. <br>  The more <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> N </script>  the more accurate the algorithm. <br><br>  Number <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.638ex" height="2.057ex" viewBox="0 -780.1 2858 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-4D" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-61" x="1756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-78" x="2285" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> TMax </script>  this is the distance from the camera, within which we expect to find the object. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/o5/z8/jq/o5z8jqv5kfwup2zmgvsfmvkintm.gif" width="400"></div><br><br><br><h1>  Why does the algorithm work? </h1><br>  Does the algorithm always reach the point of intersection with the object (more precisely, it will strive for it)?  The object may have a complex shape and its other parts may come close to the beam, preventing the algorithm from converging to the intersection point.  In fact, this can not be: other parts of the object will necessarily be at some non-zero distance from the beam (otherwise it would intersect them), which we denote <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-mtext" id="MJXp-Span-69">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; </font></font></span><span class="MJXp-mn" id="MJXp-Span-76"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.904ex" height="2.057ex" viewBox="0 -780.1 4264.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-64" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-65" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-6C" x="1240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-74" x="1538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-61" x="1900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-3E" x="2707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMAIN-30" x="3763" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> \ delta> 0 </script>  .  Then the SDF function will be more <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-mtext" id="MJXp-Span-78">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.643ex" height="2.057ex" viewBox="0 -780.1 2429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-64" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-65" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-6C" x="1240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-74" x="1538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353422/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi50D1JbEynaW3mzDZ2Lu_QZL4-CA#MJMATHI-61" x="1900" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> \ delta </script>  for any point of the ray (except for points very close to the intersection point).  Therefore, sooner or later he will approach the point of intersection. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y8/bi/zq/y8bizqbyxpbpelc9znupeivqfm4.gif" width="400"></div><br>  On the other hand, if the algorithm converges to a certain point, then the distance between adjacent iterations tends to zero. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-mtext" id="MJXp-Span-85">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">w</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> \ Rightarrow </script>  SDF (distance to the nearest point of the object) also tends to zero <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-96"><span class="MJXp-mtext" id="MJXp-Span-97">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">w</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> \ Rightarrow </script>  in the limit <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">f</span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-113">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> Sdf = 0 </script><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-114"><span class="MJXp-mtext" id="MJXp-Span-115">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">w</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> \ Rightarrow </script>  the algorithm converges to the point of intersection of the beam with the object. <br><br><h1>  Getting the color of the pixel at the intersection point </h1><br>  Imagine that for each pixel we found an intersection point with an object.  We can draw these values ‚Äã‚Äã(that is, the distance from the camera to the point of intersection) directly and get these images: <br><br><img src="https://habrastorage.org/webt/6o/bc/ou/6obcouluk0mgrerhhjxrb7-c3vi.png"><br><br>  Given that this was obtained using Excel, not bad.  But I want to know if it is impossible to make colors more similar to how we see objects in life. <br><br>  In computer graphics, the basic method of calculating color is <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D1%2582%25D0%25B5%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25BF%25D0%25BE_%25D0%25A4%25D0%25BE%25D0%25BD%25D0%25B3%25D1%2583">Phong shading</a> .  According to Phong, the resulting color consists of three components: background, specular and diffuse.  Taking into account the fact that we are not striving for photo-realistic renders, it suffices to use only the diffuse component.  The formula for this component follows from <a href="https://en.wikipedia.org/wiki/Lambert%2527s_cosine_law">Lambert's law</a> and states that the color of a pixel is proportional to the <b>cosine of the</b> angle between the normal to the surface and the direction to the light source. <br><br>  Further, to simplify the calculations, assume that the light source and the camera are the same.  Then we, in essence, need to find the sine of the angle between the beam emanating from the camera and the surface of the object: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0n/qc/0k/0nqc0k55v2hn9gdjzq4gohmzcok.png" width="300"></div><br>  Required angle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-126"><span class="MJXp-mtext" id="MJXp-Span-127">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> \ varphi </script>  I marked one arc in the drawing.  The value of its sine is denoted as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> k </script>  . <br><br>  Usually, when using Ray Marching method, to find the normal to the object, do the following: consider the SDF value at six points (it is easy to reduce the number of points to four) near the intersection point and find the gradient of this function, which should coincide with the normal.  It seemed to me that this is too much calculation for Excel, and I would like to find the desired angle easier. <br><br>  If you look at the rate of convergence of the algorithm, you can see that if the angle between the ray and the object is straight, then one iteration is enough.  If the angle is small, then the algorithm will converge very slowly. <br><br>  <b>Is it possible to get information about the angle to the surface based on the rate of convergence of the algorithm?</b>  If so, no additional calculations will be required at all: it is enough to analyze the values ‚Äã‚Äãof the previous iterations. <br><br>  Draw a drawing.  Denote <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-msubsup" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-139" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> I_n </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-140"><span class="MJXp-msubsup" id="MJXp-Span-141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-143" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">n</span><span class="MJXp-mo" id="MJXp-Span-145">+</span><span class="MJXp-mn" id="MJXp-Span-146">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> I_ {n + 1} </script>  - points obtained at adjacent iterations of the algorithm.  Suppose that the points are close enough to the object, that it can be replaced with a plane, the angle with which we want to find.  Let be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">R</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">F</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-156" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> R = SDF (I_n) </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">r</span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">F</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-167" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">n</span><span class="MJXp-mo" id="MJXp-Span-169">+</span><span class="MJXp-mn" id="MJXp-Span-170">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> r = SDF (I_ {n + 1}) </script>  - distance from points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-172"><span class="MJXp-msubsup" id="MJXp-Span-173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-175" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> I_n </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-176"><span class="MJXp-msubsup" id="MJXp-Span-177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-179" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">n</span><span class="MJXp-mo" id="MJXp-Span-181">+</span><span class="MJXp-mn" id="MJXp-Span-182">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> I_ {n + 1} </script>  up the plane.  Then, according to the algorithm, the distance between <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-183"><span class="MJXp-msubsup" id="MJXp-Span-184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-186" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> I_n </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-187"><span class="MJXp-msubsup" id="MJXp-Span-188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-190" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">n</span><span class="MJXp-mo" id="MJXp-Span-192">+</span><span class="MJXp-mn" id="MJXp-Span-193">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> I_ {n + 1} </script>  equally <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">R</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> R </script>  . <br><br><img src="https://habrastorage.org/webt/jl/is/tq/jlistqqxtnf3jeolvh9l6ktxex8.png"><br><br>  On the other hand, if we denote <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> X </script>  - the point of intersection of the ray and the figure, then <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-198"><span class="MJXp-msubsup" id="MJXp-Span-199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-201" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">X</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">R</span><span class="MJXp-mrow" id="MJXp-Span-205"><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> I_nX = R / k </script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-208"><span class="MJXp-msubsup" id="MJXp-Span-209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-211" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">n</span><span class="MJXp-mo" id="MJXp-Span-213">+</span><span class="MJXp-mn" id="MJXp-Span-214">1</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">X</span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">r</span><span class="MJXp-mrow" id="MJXp-Span-218"><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> I_ {n + 1} X = r / k </script>  , Consequently <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">R</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-226" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-msubsup" id="MJXp-Span-227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-229" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">n</span><span class="MJXp-mo" id="MJXp-Span-231">+</span><span class="MJXp-mn" id="MJXp-Span-232">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-236" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">X</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-241" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">n</span><span class="MJXp-mo" id="MJXp-Span-243">+</span><span class="MJXp-mn" id="MJXp-Span-244">1</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">X</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-247">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">c</span><span class="MJXp-mrow" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">R</span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">r</span></span><span class="MJXp-mrow" id="MJXp-Span-256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">k</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> R = I_nI_ {n + 1} = I_nX - I_ {n + 1} X = \ frac {R - r} {k} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">k</span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-261">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">c</span><span class="MJXp-mrow" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">R</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">r</span></span><span class="MJXp-mrow" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">R</span></span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-273">1</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">c</span><span class="MJXp-mrow" id="MJXp-Span-280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">r</span></span><span class="MJXp-mrow" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">R</span></span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-285">1</span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-287">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">c</span><span class="MJXp-mrow" id="MJXp-Span-292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">F</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-299" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">n</span><span class="MJXp-mo" id="MJXp-Span-301">+</span><span class="MJXp-mn" id="MJXp-Span-302">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">F</span><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-311" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> k = \ frac {R - r} {R} = 1 - \ frac {r} {R} = 1 - \ frac {SDF (I_ {n + 1})} {SDF (I_ {n})} </script></p><br>  That is, the pixel intensity is equal to one minus the ratio of the SDF functions of adjacent iterations! <br><br><h1>  We describe simple shapes. </h1><br>  Examples of SDF for sphere, cube and torus: <br><table><tbody><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-314"><span class="MJXp-mtext" id="MJXp-Span-315">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">t</span><span class="MJXp-mrow" id="MJXp-Span-320"><span class="MJXp-msubsup" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-323" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-327" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-331" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">r</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> \ sqrt {x ^ 2 + y ^ 2 + z ^ 2} - r </script></td><td><img src="https://habrastorage.org/webt/sz/oq/84/szoq84bcidxdhmxcq2oq-5vdl0y.png" width="150"></td></tr><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-334"><span class="MJXp-mtext" id="MJXp-Span-335">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">x</span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-340"><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">x</span><span class="MJXp-mrow" id="MJXp-Span-343"><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-346"><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">y</span><span class="MJXp-mrow" id="MJXp-Span-349"><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-352"><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">z</span><span class="MJXp-mrow" id="MJXp-Span-355"><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">e</span><span class="MJXp-mrow" id="MJXp-Span-363"><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-365">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> \ max (| x |, | y |, | z |) - side / 2 </script></td><td width="170"><img src="https://habrastorage.org/webt/xl/uv/kk/xluvkk2xewtwy2mugt0g7cr6vua.png" width="150"></td></tr><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-366"><span class="MJXp-mtext" id="MJXp-Span-367">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">t</span><span class="MJXp-mrow" id="MJXp-Span-372"><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-374">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">t</span><span class="MJXp-mrow" id="MJXp-Span-379"><span class="MJXp-msubsup" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-382" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-386" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">R</span><span class="MJXp-msubsup" id="MJXp-Span-389"><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-391" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-395" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">r</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> \ sqrt {(\ sqrt {x ^ 2 + z ^ 2} - R) ^ 2 + y ^ 2} - r </script></td><td><img src="https://habrastorage.org/webt/zf/6a/bl/zf6abl_zt9gqafxmt-ld09ox4zu.png" width="150"></td></tr></tbody></table><br>  Shapes can be moved and compressed along the axes: <br><table><tbody><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">e</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">x</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">y</span><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-408">0.3</span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">z</span><span class="MJXp-mo" id="MJXp-Span-411" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> cube (x, y + 0.3, z) </script></td><td width="170"><img src="https://habrastorage.org/webt/hu/qd/a3/huqda3kzbufxggsskgov0upuw-0.png" width="150"></td></tr><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">e</span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">x</span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-420">2</span><span class="MJXp-mtext" id="MJXp-Span-421">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">y</span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">z</span><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> cube (x, 2 \ cdot y, z) </script></td><td><img src="https://habrastorage.org/webt/-7/ys/m4/-7ysm4dntktjqwnyciq-oykacww.png" width="150"></td></tr></tbody></table><br>  Figures can also be combined, intersected and subtracted.  That is, the SDF supports the basic operations of <a href="https://en.wikipedia.org/wiki/Constructive_solid_geometry">constructive solid geometry</a> : <br><table><tbody><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-430"><span class="MJXp-mtext" id="MJXp-Span-431">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">n</span><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">e</span><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">x</span><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">y</span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">z</span><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">e</span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">x</span><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">y</span><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">z</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> \ min (sphere (x, y, z), cube (x, y, z)) </script></td><td width="170"><img src="https://habrastorage.org/webt/6x/yn/4q/6xyn4qsr5qscuffk4wuxa06yxso.png" width="150"></td></tr><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-462"><span class="MJXp-mtext" id="MJXp-Span-463">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">x</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">e</span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">x</span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">y</span><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">z</span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">e</span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">x</span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">y</span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">z</span><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> \ max (sphere (x, y, z), cube (x, y, z)) </script></td><td><img src="https://habrastorage.org/webt/jy/mr/lj/jymrljnxfzrt7jhlxztgnm5dime.png" width="150"></td></tr><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-494"><span class="MJXp-mtext" id="MJXp-Span-495">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">x</span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">e</span><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">x</span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">y</span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">z</span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">e</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">x</span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">y</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">z</span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> \ max (-sphere (x, y, z), cube (x, y, z)) </script></td><td><img src="https://habrastorage.org/webt/75/yu/o9/75yuo9m8bvqohhzczxn5x9r5arw.png" width="150"></td></tr></tbody></table><br>  The attentive reader may have noticed that in some figures (for example, a cube), as well as for some operations (for example, compression), the above formulas do not always return the distance to the nearest point of the object, that is, SDF is not formally.  Nevertheless, it turned out that they can still be fed to the input of the SDF engine and it will correctly display them. <br><br>  This is a small part of what you can do with the SDF, a full list of figures and operations can be found at <a href="http://www.iquilezles.org/www/articles/distfunctions/distfunctions.htm">www.iquilezles.org/www/articles/distfunctions/distfunctions.htm</a> <br><br>  Combining all the above formulas, we get the first figure: <br><table><tbody><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-527"><span class="MJXp-mtext" id="MJXp-Span-528">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">n</span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mspace" id="MJXp-Span-533" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-534">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">d</span><span class="MJXp-mtext" id="MJXp-Span-539">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">x</span><span class="MJXp-mo" id="MJXp-Span-543" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-544"><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">x</span><span class="MJXp-mrow" id="MJXp-Span-547"><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-550">0.3</span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-552"><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">y</span><span class="MJXp-mrow" id="MJXp-Span-555"><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-558">0.3</span><span class="MJXp-mo" id="MJXp-Span-559" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-560"><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">z</span><span class="MJXp-mrow" id="MJXp-Span-563"><span class="MJXp-mo" id="MJXp-Span-564" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-566">0.3</span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-569">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">t</span><span class="MJXp-mrow" id="MJXp-Span-574"><span class="MJXp-msubsup" id="MJXp-Span-575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-577" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-581" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-585" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-587">0.375</span><span class="MJXp-mo" id="MJXp-Span-588" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-590">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-591">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-592">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">d</span><span class="MJXp-mtext" id="MJXp-Span-597">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">t</span><span class="MJXp-mrow" id="MJXp-Span-602"><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-604">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">t</span><span class="MJXp-mrow" id="MJXp-Span-609"><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">x</span><span class="MJXp-mo" id="MJXp-Span-612" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-613">0.25</span><span class="MJXp-msubsup" id="MJXp-Span-614"><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-616" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">z</span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-621">0.25</span><span class="MJXp-msubsup" id="MJXp-Span-622"><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-624" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-626">0.25</span><span class="MJXp-msubsup" id="MJXp-Span-627"><span class="MJXp-mo" id="MJXp-Span-628" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-629" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-633" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-635">0.05</span><span class="MJXp-mspace" id="MJXp-Span-636" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-637" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> \ min (\\ \ quad \ max (| x | - 0.3, | y | - 0.3, | z | - 0.3, - \ sqrt {x ^ 2 + y ^ 2 + z ^ 2} + 0.375), \ \ \ quad \ sqrt {(\ sqrt {(x - 0.25) ^ 2 + (z - 0.25) ^ 2} - 0.25) ^ 2 + y ^ 2} - 0.05 \\) </script></td><td width="170"><img src="https://habrastorage.org/webt/_o/im/_5/_oim_5jfi044yw05mmna6yworjm.png" width="150"></td></tr></tbody></table><br><h1>  Formula Kettle </h1><br>  With a kettle a little harder: you need a plan <br><br><img src="https://habrastorage.org/webt/nn/yt/pw/nnytpwwwsu-gaaamxn36xocvaoy.png"><br><br>  Carefully write the formula: <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-638"><span class="MJXp-mtext" id="MJXp-Span-639">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">n</span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mspace" id="MJXp-Span-644" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-645">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">d</span><span class="MJXp-mtext" id="MJXp-Span-650">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">t</span><span class="MJXp-mrow" id="MJXp-Span-655"><span class="MJXp-msubsup" id="MJXp-Span-656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-658" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">y</span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-663">0.27</span><span class="MJXp-msubsup" id="MJXp-Span-664"><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-666" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-670" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-671" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-672">0.05</span><span class="MJXp-mspace" id="MJXp-Span-673" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-674">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">d</span><span class="MJXp-mtext" id="MJXp-Span-679">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">t</span><span class="MJXp-mrow" id="MJXp-Span-684"><span class="MJXp-msubsup" id="MJXp-Span-685"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-687" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-689">2.5</span><span class="MJXp-mtext" id="MJXp-Span-690">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">t</span><span class="MJXp-msubsup" id="MJXp-Span-695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-697" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-701" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-703">0.4</span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-705" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-706">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">d</span><span class="MJXp-mtext" id="MJXp-Span-711">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">t</span><span class="MJXp-mrow" id="MJXp-Span-716"><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-718">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">t</span><span class="MJXp-mrow" id="MJXp-Span-723"><span class="MJXp-msubsup" id="MJXp-Span-724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-726" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-727" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-730" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-732">0.3</span><span class="MJXp-msubsup" id="MJXp-Span-733"><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-735" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">y</span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-740">0.18</span><span class="MJXp-msubsup" id="MJXp-Span-741"><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-743" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-745">0.02</span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-747" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-748">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">d</span><span class="MJXp-mtext" id="MJXp-Span-753">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">x</span><span class="MJXp-mo" id="MJXp-Span-757" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mspace" id="MJXp-Span-758" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-759">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">x</span><span class="MJXp-mo" id="MJXp-Span-766" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">y</span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-769">0.7</span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-771" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-772">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">d</span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">y</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-781">0.09</span><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-783" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-784">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">d</span><span class="MJXp-mtext" id="MJXp-Span-790">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">t</span><span class="MJXp-mrow" id="MJXp-Span-795"><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-797">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">t</span><span class="MJXp-msubsup" id="MJXp-Span-802"><span class="MJXp-mrow" id="MJXp-Span-803" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-804" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">x</span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-807">0.55</span><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-810" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">y</span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-815">0.09</span><span class="MJXp-msubsup" id="MJXp-Span-816"><span class="MJXp-mo" id="MJXp-Span-817" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-818" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-821">0.1</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-822" style="vertical-align: 0.82em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-824" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">z</span><span class="MJXp-mo" id="MJXp-Span-826" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-827">0.1</span><span class="MJXp-msubsup" id="MJXp-Span-828"><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-830" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-832">0.04</span><span class="MJXp-mo" id="MJXp-Span-833" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-834" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-835">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">d</span><span class="MJXp-mo" id="MJXp-Span-840" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-842" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-843">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">d</span><span class="MJXp-mtext" id="MJXp-Span-848">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">x</span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mspace" id="MJXp-Span-853" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-854">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">d</span><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-861" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-862" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">y</span><span class="MJXp-mo" id="MJXp-Span-864" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-865">0.09</span><span class="MJXp-mo" id="MJXp-Span-866" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-867" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-868" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">d</span><span class="MJXp-mtext" id="MJXp-Span-873">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">t</span><span class="MJXp-mrow" id="MJXp-Span-878"><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-880">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">t</span><span class="MJXp-mrow" id="MJXp-Span-885"><span class="MJXp-mo" id="MJXp-Span-886" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">x</span><span class="MJXp-mo" id="MJXp-Span-888" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-889">0.35</span><span class="MJXp-msubsup" id="MJXp-Span-890"><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-892" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">y</span><span class="MJXp-mo" id="MJXp-Span-896" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-897">0.09</span><span class="MJXp-msubsup" id="MJXp-Span-898"><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-900" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-902">0.1</span><span class="MJXp-msubsup" id="MJXp-Span-903"><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-905" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-906" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-907" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">z</span><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-910">0.1</span><span class="MJXp-msubsup" id="MJXp-Span-911"><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-913" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-915">0.04</span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-917" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-918">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">d</span><span class="MJXp-mo" id="MJXp-Span-923" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-925" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> \ min (\\ \ quad \ sqrt {x ^ 2 + (y - 0.27) ^ 2 + z ^ 2} - 0.05 \\ \ quad \ sqrt {x ^ 2 + 2.5 \ cdot y ^ 2 + z ^ 2 } - 0.4, \\ \ quad \ sqrt {(\ sqrt {x ^ 2 + z ^ 2} - 0.3) ^ 2 + (y - 0.18) ^ 2} - 0.02, \\ \ quad \ max (\\ \ qquad x + y - 0.7, \\ \ qquad - y + 0.09, \\ \ qquad \ sqrt {(\ sqrt {(x - 0.55) ^ 2 + (y - 0.09) ^ 2) - 0.1} ^ 2 + ( z - 0.1) ^ 2} - 0.04, \\ \ quad), \\ \ quad \ max (\\ \ qquad - (- y + 0.09), \\ qqad \ sqrt {(\ sqrt {(x - 0.35 ) ^ 2 + (y - 0.09) ^ 2} - 0.1) ^ 2 + (z - 0.1) ^ 2} - 0.04, \\ \ quad), \\) </script><br><br>  And we select the desired angle.  Done: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uv/t8/xt/uvt8xtpanpkz9x5rsohbzi6dlw8.png" width="500"></div><br><hr><br><h1>  Camera </h1><br>  All that is left for us is to find the corresponding beam in the space leaving the camera for a given pixel on the screen.  More precisely, you must be able to find the point of this beam by distance from the camera.  That is, we need a function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">y</span><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">s</span><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">t</span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">d</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> ray (s, t, d) </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">s</span><span class="MJXp-mo" id="MJXp-Span-940" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> s, t </script>  - pixel coordinates, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> d </script>  - distance from the beginning of the beam (camera). <br><br>  For convenience of calculation, the coordinates of the pixels will be set relative to the center of the screen.  Given that the screen consists of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-944"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> rows </script>  rows and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> cols </script>  columns, we expect coordinates within <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">s</span><span class="MJXp-mtext" id="MJXp-Span-956">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">n</span><span class="MJXp-mtext" id="MJXp-Span-959">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">t</span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-966">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">c</span><span class="MJXp-mrow" id="MJXp-Span-971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">s</span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mn" id="MJXp-Span-977">2</span></span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-979">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">c</span><span class="MJXp-mrow" id="MJXp-Span-984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">s</span></span><span class="MJXp-mrow" id="MJXp-Span-989"><span class="MJXp-mn" id="MJXp-Span-990">2</span></span><span class="MJXp-mtext" id="MJXp-Span-991">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">t</span><span class="MJXp-mo" id="MJXp-Span-997" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">t</span><span class="MJXp-mtext" id="MJXp-Span-1000">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">n</span><span class="MJXp-mtext" id="MJXp-Span-1003">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">t</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-1009" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1010">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">c</span><span class="MJXp-mrow" id="MJXp-Span-1015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">s</span></span><span class="MJXp-mrow" id="MJXp-Span-1020"><span class="MJXp-mn" id="MJXp-Span-1021">2</span></span><span class="MJXp-mo" id="MJXp-Span-1022" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1023">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">c</span><span class="MJXp-mrow" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">s</span></span><span class="MJXp-mrow" id="MJXp-Span-1033"><span class="MJXp-mn" id="MJXp-Span-1034">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1035">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">t</span><span class="MJXp-mo" id="MJXp-Span-1041" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> s \ in \ left [- \ frac {cols} {2}, \ frac {cols} {2} \ right], t \ in \ left [- \ frac {rows} {2}, \ frac {rows} {2} \ right] </script><br><br><img src="https://habrastorage.org/webt/ky/pm/6f/kypm6fy1z1-mnxj66yms_czb-xu.png"><br><br>  Next, you need to decide on the type of camera projection: orthogonal, perspective, or "fisheye."  In terms of complexity of implementation, they are about the same, but in practice, perspective is most often used, so we will use it. <br><br><img src="https://habrastorage.org/webt/yz/rx/vt/yzrxvt5j0fdbt3pelb-zt50io8k.png"><br><br>  Most of the calculations in this chapter could have been avoided, for example, by placing the camera at a point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1042"><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1044">1</span><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1046">0</span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1048">0</span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> (1, 0, 0) </script>  and directing along the axis <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> X </script>  .  But given the fact that the figures are also aligned along the axes, the result would not be a very interesting perspective.  So in the case of a cube, we would see it as a square. <br><br>  To ensure that the camera can be rotated, it is necessary to carefully conduct a number of calculations with <a href="https://ru.wikipedia.org/wiki/%25D0%25A3%25D0%25B3%25D0%25BB%25D1%258B_%25D0%25AD%25D0%25B9%25D0%25BB%25D0%25B5%25D1%2580%25D0%25B0">Euler angles</a> .  So we get three input variables: angle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1052"><span class="MJXp-mtext" id="MJXp-Span-1053">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> \ alpha </script>  angle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1059"><span class="MJXp-mtext" id="MJXp-Span-1060">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> \ beta </script>  and distance <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> dist </script>  .  They determine both the position and the direction of the camera (the camera always looks at the origin of coordinates). <br><br>  With the help of <a href="http://www.wolframalpha.com/input/%3Fi%3DRotationMatrix%255Ba,%2B%257B0,%2B1,%2B0%257D%255D.RotationMatrix%255Bb,%2B%257B0,%2B0,%2B1%257D%255D">WolframAlpha</a> we find the rotation matrix: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1070"><span class="MJXp-merror" id="MJXp-Span-1071"><span class="MJXp-mtext" id="MJXp-Span-1072">\&nbsp;begin&nbsp;{pmatrix}&nbsp;x&nbsp;\\&nbsp;y&nbsp;\\&nbsp;z&nbsp;\&nbsp;end&nbsp;{pmatrix}&nbsp;=&nbsp;\&nbsp;underbrace&nbsp;{\&nbsp;begin&nbsp;{pmatrix}&nbsp;\&nbsp;cos&nbsp;(\&nbsp;alpha)&nbsp;\&nbsp;cos&nbsp;(\&nbsp;beta)&nbsp;&amp;&nbsp;-&nbsp;\&nbsp;cos&nbsp;(\&nbsp;alpha)&nbsp;\&nbsp;sin&nbsp;(&nbsp;\&nbsp;beta)&nbsp;&amp;&nbsp;\&nbsp;sin&nbsp;(a)&nbsp;\\&nbsp;\&nbsp;sin&nbsp;(\&nbsp;beta)&nbsp;&amp;&nbsp;\&nbsp;cos&nbsp;(\&nbsp;beta)&nbsp;&amp;&nbsp;0&nbsp;\\&nbsp;-&nbsp;\&nbsp;cos&nbsp;(\&nbsp;beta)&nbsp;\&nbsp;sin&nbsp;(\&nbsp;alpha)&nbsp;&amp;&nbsp;\&nbsp;sin&nbsp;(\&nbsp;alpha)&nbsp;\&nbsp;sin&nbsp;(\&nbsp;beta)&nbsp;&amp;&nbsp;\&nbsp;cos&nbsp;(\&nbsp;alpha)&nbsp;\&nbsp;end&nbsp;{pmatrix}}&nbsp;_&nbsp;{M&nbsp;(\&nbsp;alpha,&nbsp;\&nbsp;beta)}&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;x&nbsp;'\\&nbsp;y'&nbsp;\\&nbsp;z&nbsp;'\&nbsp;end&nbsp;{pmatrix}</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-54"> \ begin {pmatrix} x \\ y \\ z \ end {pmatrix} = \ underbrace {\ begin {pmatrix} \ cos (\ alpha) \ cos (\ beta) & - \ cos (\ alpha) \ sin ( \ beta) & \ sin (a) \\ \ sin (\ beta) & \ cos (\ beta) & 0 \\ - \ cos (\ beta) \ sin (\ alpha) & \ sin (\ alpha) \ sin (\ beta) & \ cos (\ alpha) \ end {pmatrix}} _ {M (\ alpha, \ beta)} \ begin {pmatrix} x '\\ y' \\ z '\ end {pmatrix} </script></p><br><br>  If you apply it to a vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1073"><span class="MJXp-mo" id="MJXp-Span-1074" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">t</span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1080">0</span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1082">0</span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> (dist, 0, 0) </script>  , we will get the coordinates of the camera (do not ask me where the minus disappeared): <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1084"><span class="MJXp-mtext" id="MJXp-Span-1085">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">n</span><span class="MJXp-mrow" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">X</span><span class="MJXp-mspace" id="MJXp-Span-1103" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">Y</span><span class="MJXp-mspace" id="MJXp-Span-1108" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">Z</span><span class="MJXp-mtext" id="MJXp-Span-1113">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">d</span><span class="MJXp-mrow" id="MJXp-Span-1117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">x</span></span><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">M</span><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">a</span><span class="MJXp-mo" id="MJXp-Span-1134" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1135">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">a</span><span class="MJXp-mo" id="MJXp-Span-1140" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">n</span><span class="MJXp-mrow" id="MJXp-Span-1147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">t</span><span class="MJXp-mspace" id="MJXp-Span-1159" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1160">0</span><span class="MJXp-mspace" id="MJXp-Span-1161" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1162">0</span><span class="MJXp-mtext" id="MJXp-Span-1163">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">d</span><span class="MJXp-mrow" id="MJXp-Span-1167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">x</span></span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">t</span><span class="MJXp-mtext" id="MJXp-Span-1180">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">n</span><span class="MJXp-mrow" id="MJXp-Span-1186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">x</span></span><span class="MJXp-mtext" id="MJXp-Span-1194">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">s</span><span class="MJXp-mo" id="MJXp-Span-1198" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1199">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">a</span><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1206">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">t</span><span class="MJXp-mtext" id="MJXp-Span-1211">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">s</span><span class="MJXp-mo" id="MJXp-Span-1215" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1216">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">a</span><span class="MJXp-mo" id="MJXp-Span-1221" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1222" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1223">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">n</span><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1228">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">a</span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1234" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1235">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">n</span><span class="MJXp-mo" id="MJXp-Span-1239" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1240">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">a</span><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1247">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">t</span><span class="MJXp-mtext" id="MJXp-Span-1252">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">s</span><span class="MJXp-mo" id="MJXp-Span-1256" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1257">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">a</span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1263">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">d</span><span class="MJXp-mrow" id="MJXp-Span-1267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">x</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-56"> \ begin {pmatrix} camX \\ camY \\ camZ \ end {pmatrix} = M (\ alpha, \ beta) \ begin {pmatrix} dist \\ 0 \\ 0 \ end {pmatrix} = dist \ begin {pmatrix } \ cos (\ alpha) \ cdot \ cos (\ beta) \\ \ sin (\ beta) \\ \ sin (\ alpha) \ cdot \ cos (\ beta) \ end {pmatrix} </script></p><br><br><img src="https://habrastorage.org/webt/0g/oa/pi/0goapi2ortddar41ylkt8xn9wes.png"><br><br>  Subsequent calculations will be specific to the perspective projection.  The main object is a <i>screen</i> (it is red in the figure, italic in the text).  This is an imaginary rectangle at some distance in front of the camera, having, as you might guess, a one-to-one correspondence with the pixels of a regular screen.  The camera is actually just a point with coordinates. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1275"><span class="MJXp-mo" id="MJXp-Span-1276" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">X</span><span class="MJXp-mo" id="MJXp-Span-1281" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">Y</span><span class="MJXp-mo" id="MJXp-Span-1286" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">Z</span><span class="MJXp-mo" id="MJXp-Span-1291" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> (camX, camY, camZ) </script>  .  The rays corresponding to the pixels begin at the point of the camera and pass through the corresponding point on the <i>screen</i> . <br><br>  The <i>screen</i> does not have exact location and size.  More precisely, they depend on the distance to the camera: if you move the screen further, you will need to do more.  Therefore, we agree that the distance from the camera to the screen is 1. Then we can calculate the value of the vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-mo" id="MJXp-Span-1293" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">x</span><span class="MJXp-mn" id="MJXp-Span-1295">0</span><span class="MJXp-mo" id="MJXp-Span-1296" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">y</span><span class="MJXp-mn" id="MJXp-Span-1298">0</span><span class="MJXp-mo" id="MJXp-Span-1299" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">z</span><span class="MJXp-mn" id="MJXp-Span-1301">0</span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> (x0, y0, z0) </script>  connecting the point of the camera and the center of the screen (it is the same as at the center of the camera, only multiplied not by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> dist </script>  and on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1310">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> -1 </script>  ): <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1311"><span class="MJXp-mtext" id="MJXp-Span-1312">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">n</span><span class="MJXp-mrow" id="MJXp-Span-1318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">x</span><span class="MJXp-mn" id="MJXp-Span-1327">0</span><span class="MJXp-mspace" id="MJXp-Span-1328" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">y</span><span class="MJXp-mn" id="MJXp-Span-1330">0</span><span class="MJXp-mspace" id="MJXp-Span-1331" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">z</span><span class="MJXp-mn" id="MJXp-Span-1333">0</span><span class="MJXp-mtext" id="MJXp-Span-1334">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">d</span><span class="MJXp-mrow" id="MJXp-Span-1338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">x</span></span><span class="MJXp-mo" id="MJXp-Span-1346" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">M</span><span class="MJXp-mo" id="MJXp-Span-1348" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1349">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">a</span><span class="MJXp-mo" id="MJXp-Span-1355" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1356">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">a</span><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1362">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">n</span><span class="MJXp-mrow" id="MJXp-Span-1368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">x</span></span><span class="MJXp-mo" id="MJXp-Span-1376" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1377">1</span><span class="MJXp-mspace" id="MJXp-Span-1378" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1379">0</span><span class="MJXp-mspace" id="MJXp-Span-1380" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1381">0</span><span class="MJXp-mtext" id="MJXp-Span-1382">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">d</span><span class="MJXp-mrow" id="MJXp-Span-1386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">x</span></span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1395" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1396">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">n</span><span class="MJXp-mrow" id="MJXp-Span-1402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">x</span></span><span class="MJXp-mtext" id="MJXp-Span-1410">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">s</span><span class="MJXp-mo" id="MJXp-Span-1414" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1415">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">a</span><span class="MJXp-mo" id="MJXp-Span-1421" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1422">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426">t</span><span class="MJXp-mtext" id="MJXp-Span-1427">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">s</span><span class="MJXp-mo" id="MJXp-Span-1431" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1432">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">a</span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1438" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1439">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">n</span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1444">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448">a</span><span class="MJXp-mo" id="MJXp-Span-1449" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1450" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1451">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">n</span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1456">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">a</span><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1463">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">t</span><span class="MJXp-mtext" id="MJXp-Span-1468">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">s</span><span class="MJXp-mo" id="MJXp-Span-1472" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1473">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">a</span><span class="MJXp-mo" id="MJXp-Span-1478" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1479">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">d</span><span class="MJXp-mrow" id="MJXp-Span-1483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">x</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-61"> \ begin {pmatrix} x0 \\ y0 \\ z0 \ end {pmatrix} = M (\ alpha, \ beta) \ begin {pmatrix} -1 \\ 0 \\ 0 \ end {pmatrix} = - \ begin { pmatrix} \ cos (\ alpha) \ cdot \ cos (\ beta) \\ \ sin (\ beta) \\ \ sin (\ alpha) \ cdot \ cos (\ beta) \ end {pmatrix} </script></p><br><br>  Now we need to determine the <i>screen</i> size.  It depends on the angle of view of the camera, which is measured in degrees and corresponds to what is called ‚Äúzoom‚Äù in video cameras.  The user sets it with a variable. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">v</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> fov </script>  (field of view).  Since the screen is not square, it is necessary to clarify what is meant by the vertical viewing angle. <br><br>  So, to determine the height of the screen, you need to find the base of an isosceles triangle with a vertex angle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">v</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> fov </script>  and height 1: remembering trigonometry, we get <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1499"><span class="MJXp-mn" id="MJXp-Span-1500">2</span><span class="MJXp-mtext" id="MJXp-Span-1501">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">n</span><span class="MJXp-mtext" id="MJXp-Span-1505">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">t</span><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">v</span><span class="MJXp-mrow" id="MJXp-Span-1514"><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-1516">2</span><span class="MJXp-mtext" id="MJXp-Span-1517">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1520">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">t</span><span class="MJXp-mo" id="MJXp-Span-1523" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> 2 \ tan \ left (fov / 2 \ right) </script>  .  Based on this, you can determine the size of one pixel on the <i>screen</i> : <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">e</span><span class="MJXp-mo" id="MJXp-Span-1534" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1535">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">c</span><span class="MJXp-mrow" id="MJXp-Span-1540"><span class="MJXp-mn" id="MJXp-Span-1541">2</span><span class="MJXp-mtext" id="MJXp-Span-1542">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">n</span><span class="MJXp-mtext" id="MJXp-Span-1546">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550">t</span><span class="MJXp-mo" id="MJXp-Span-1551" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">v</span><span class="MJXp-mrow" id="MJXp-Span-1555"><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-1557">2</span><span class="MJXp-mtext" id="MJXp-Span-1558">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">t</span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">s</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-65"> pixelSize = \ frac {2 \ tan \ left (fov / 2 \ right)} {rows} </script></p><br><br>  Next, applying the rotation matrix to the vectors <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1570"><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1572">0</span><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1574">0</span><span class="MJXp-mo" id="MJXp-Span-1575" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1576">1</span><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> (0, 0, 1) </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1578"><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1580">0</span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1582">1</span><span class="MJXp-mo" id="MJXp-Span-1583" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1584">0</span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> (0, 1, 0) </script>  get vectors <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1586"><span class="MJXp-mtext" id="MJXp-Span-1587">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">e</span><span class="MJXp-mrow" id="MJXp-Span-1596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">u</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> \ overline {u} </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1598"><span class="MJXp-mtext" id="MJXp-Span-1599">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">e</span><span class="MJXp-mrow" id="MJXp-Span-1608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">v</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> \ overline {v} </script>  , setting the horizontal and vertical directions of the <i>screen</i> (to simplify the calculations, they are also pre-multiplied by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> pixelSize </script>  ): <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1620"><span class="MJXp-mtext" id="MJXp-Span-1621">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">n</span><span class="MJXp-mrow" id="MJXp-Span-1627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1633">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">x</span><span class="MJXp-mspace" id="MJXp-Span-1637" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">y</span><span class="MJXp-mspace" id="MJXp-Span-1640" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">z</span><span class="MJXp-mtext" id="MJXp-Span-1643">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">d</span><span class="MJXp-mrow" id="MJXp-Span-1647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">x</span></span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">e</span><span class="MJXp-mtext" id="MJXp-Span-1665">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670">M</span><span class="MJXp-mo" id="MJXp-Span-1671" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1672">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">a</span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1679">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">a</span><span class="MJXp-mo" id="MJXp-Span-1684" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1685">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">n</span><span class="MJXp-mrow" id="MJXp-Span-1691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">x</span></span><span class="MJXp-mn" id="MJXp-Span-1699">0</span><span class="MJXp-mspace" id="MJXp-Span-1700" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1701">0</span><span class="MJXp-mspace" id="MJXp-Span-1702" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1703">1</span><span class="MJXp-mtext" id="MJXp-Span-1704">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">d</span><span class="MJXp-mrow" id="MJXp-Span-1708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">x</span></span><span class="MJXp-mo" id="MJXp-Span-1716" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">e</span><span class="MJXp-mtext" id="MJXp-Span-1726">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">n</span><span class="MJXp-mrow" id="MJXp-Span-1732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">x</span></span><span class="MJXp-mtext" id="MJXp-Span-1740">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">n</span><span class="MJXp-mo" id="MJXp-Span-1744" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1745">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">a</span><span class="MJXp-mo" id="MJXp-Span-1751" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1752" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1753">0</span><span class="MJXp-mspace" id="MJXp-Span-1754" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1755">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">s</span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1760">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">a</span><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1767">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">d</span><span class="MJXp-mrow" id="MJXp-Span-1771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">x</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-71"> \ begin {pmatrix} ux \\ uy \\ uz \ end {pmatrix} = pixelSize \ cdot M (\ alpha, \ beta) \ begin {pmatrix} 0 \\ 0 \\ 1 \ end {pmatrix} = pixelSize \ begin {pmatrix} \ sin (\ alpha) \\ 0 \\ \ cos (\ alpha) \ end {pmatrix} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1779"><span class="MJXp-mtext" id="MJXp-Span-1780">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">n</span><span class="MJXp-mrow" id="MJXp-Span-1786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795">x</span><span class="MJXp-mspace" id="MJXp-Span-1796" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">y</span><span class="MJXp-mspace" id="MJXp-Span-1799" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">z</span><span class="MJXp-mtext" id="MJXp-Span-1802">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1803">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">d</span><span class="MJXp-mrow" id="MJXp-Span-1806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">x</span></span><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">e</span><span class="MJXp-mtext" id="MJXp-Span-1824">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829">M</span><span class="MJXp-mo" id="MJXp-Span-1830" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1831">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">a</span><span class="MJXp-mo" id="MJXp-Span-1837" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1838">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">a</span><span class="MJXp-mo" id="MJXp-Span-1843" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1844">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849">n</span><span class="MJXp-mrow" id="MJXp-Span-1850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">x</span></span><span class="MJXp-mn" id="MJXp-Span-1858">0</span><span class="MJXp-mspace" id="MJXp-Span-1859" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1860">1</span><span class="MJXp-mspace" id="MJXp-Span-1861" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1862">0</span><span class="MJXp-mtext" id="MJXp-Span-1863">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1864">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">d</span><span class="MJXp-mrow" id="MJXp-Span-1867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1874">x</span></span><span class="MJXp-mo" id="MJXp-Span-1875" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884">e</span><span class="MJXp-mtext" id="MJXp-Span-1885">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1888">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1889">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">n</span><span class="MJXp-mrow" id="MJXp-Span-1891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898">x</span></span><span class="MJXp-mtext" id="MJXp-Span-1899">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1900">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902">s</span><span class="MJXp-mo" id="MJXp-Span-1903" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1904">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909">a</span><span class="MJXp-mo" id="MJXp-Span-1910" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1911">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915">t</span><span class="MJXp-mtext" id="MJXp-Span-1916">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919">n</span><span class="MJXp-mo" id="MJXp-Span-1920" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1921">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">a</span><span class="MJXp-mo" id="MJXp-Span-1926" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1927" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1928">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1929">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931">s</span><span class="MJXp-mo" id="MJXp-Span-1932" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1933">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937">a</span><span class="MJXp-mo" id="MJXp-Span-1938" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1939" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-1940">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1941">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">n</span><span class="MJXp-mo" id="MJXp-Span-1944" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1945">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1947">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">a</span><span class="MJXp-mo" id="MJXp-Span-1951" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1952">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1956">t</span><span class="MJXp-mtext" id="MJXp-Span-1957">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960">s</span><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1962">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966">a</span><span class="MJXp-mo" id="MJXp-Span-1967" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1968">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971">d</span><span class="MJXp-mrow" id="MJXp-Span-1972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1976">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1979">x</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-72"> \ begin {pmatrix} vx \\ vy \\ vz \ end {pmatrix} = pixelSize \ cdot M (\ alpha, \ beta) \ begin {pmatrix} 0 \\ 1 \\ 0 \ end {pmatrix} = pixelSize \ begin {pmatrix} \ cos (\ alpha) \ cdot \ sin (\ beta) \\ \ cos (\ beta) \\ \ sin (\ alpha) \ cdot \ cos (\ beta) \ end {pmatrix} </script></p><br>  Thus, we now have all the components to find the direction of the beam coming out of the camera and corresponding to the pixel with the coordinates <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">s</span><span class="MJXp-mo" id="MJXp-Span-1982" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> s, t </script><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1985">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1986">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1989">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1990">r</span><span class="MJXp-mo" id="MJXp-Span-1991" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992">s</span><span class="MJXp-mo" id="MJXp-Span-1993" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994">t</span><span class="MJXp-mo" id="MJXp-Span-1995" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1996" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1997">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2002">n</span><span class="MJXp-mrow" id="MJXp-Span-2003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2004">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011">x</span><span class="MJXp-mn" id="MJXp-Span-2012">0</span><span class="MJXp-mspace" id="MJXp-Span-2013" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014">y</span><span class="MJXp-mn" id="MJXp-Span-2015">0</span><span class="MJXp-mspace" id="MJXp-Span-2016" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017">z</span><span class="MJXp-mn" id="MJXp-Span-2018">0</span><span class="MJXp-mtext" id="MJXp-Span-2019">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2021">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022">d</span><span class="MJXp-mrow" id="MJXp-Span-2023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030">x</span></span><span class="MJXp-mo" id="MJXp-Span-2031" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2032">s</span><span class="MJXp-mtext" id="MJXp-Span-2033">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2035">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038">n</span><span class="MJXp-mrow" id="MJXp-Span-2039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2041">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2044">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048">x</span><span class="MJXp-mspace" id="MJXp-Span-2049" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2050">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051">y</span><span class="MJXp-mspace" id="MJXp-Span-2052" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054">z</span><span class="MJXp-mtext" id="MJXp-Span-2055">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2058">d</span><span class="MJXp-mrow" id="MJXp-Span-2059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2061">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2062">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066">x</span></span><span class="MJXp-mo" id="MJXp-Span-2067" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2068">t</span><span class="MJXp-mtext" id="MJXp-Span-2069">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2071">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2074">n</span><span class="MJXp-mrow" id="MJXp-Span-2075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2078">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2079">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2083">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084">x</span><span class="MJXp-mspace" id="MJXp-Span-2085" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2087">y</span><span class="MJXp-mspace" id="MJXp-Span-2088" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090">z</span><span class="MJXp-mtext" id="MJXp-Span-2091">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2093">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2094">d</span><span class="MJXp-mrow" id="MJXp-Span-2095"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2096">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2097">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2099">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2102">x</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-74"> raydir (s, t) = \ begin {pmatrix} x0 \\ y0 \\ z0 \ end {pmatrix} + s \ begin {pmatrix} ux \\ uy \\ uz \ end {pmatrix} + t \ begin {pmatrix } vx \\ vy \\ vz \ end {pmatrix} </script></p><br><br>  It is almost what you need.  Only it is necessary to take into account that the beginning of the beam is at the point of the camera and that the direction vector must be normalized: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2104">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2106">y</span><span class="MJXp-mo" id="MJXp-Span-2107" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2108">s</span><span class="MJXp-mo" id="MJXp-Span-2109" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2110">t</span><span class="MJXp-mo" id="MJXp-Span-2111" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2112">d</span><span class="MJXp-mo" id="MJXp-Span-2113" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2114" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2115">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2117">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2118">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2120">n</span><span class="MJXp-mrow" id="MJXp-Span-2121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2122">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2123">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2125">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2128">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2129">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2130">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132">X</span><span class="MJXp-mspace" id="MJXp-Span-2133" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2135">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2136">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137">Y</span><span class="MJXp-mspace" id="MJXp-Span-2138" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2140">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2142">Z</span><span class="MJXp-mtext" id="MJXp-Span-2143">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2146">d</span><span class="MJXp-mrow" id="MJXp-Span-2147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2152">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2153">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2154">x</span></span><span class="MJXp-mo" id="MJXp-Span-2155" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156">d</span><span class="MJXp-mtext" id="MJXp-Span-2157">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2158">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2159">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2160">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161">t</span><span class="MJXp-mtext" id="MJXp-Span-2162">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2163">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2165">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2166">c</span><span class="MJXp-mrow" id="MJXp-Span-2167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2169">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2172">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2173">r</span><span class="MJXp-mo" id="MJXp-Span-2174" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2175">s</span><span class="MJXp-mo" id="MJXp-Span-2176" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2177">t</span><span class="MJXp-mo" id="MJXp-Span-2178" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-2179"><span class="MJXp-mtext" id="MJXp-Span-2180">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2182">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2183">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2184">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2185">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2187">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2188">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2189">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2190">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2191">r</span><span class="MJXp-mo" id="MJXp-Span-2192" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2193">s</span><span class="MJXp-mo" id="MJXp-Span-2194" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">t</span><span class="MJXp-mo" id="MJXp-Span-2196" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-2197">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2199">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2201">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">t</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-75"> ray (s, t, d) = \ begin {pmatrix} camX \\ camY \\ camZ \ end {pmatrix} + d \ cdot \ frac {raydir (s, t)} {\ lVert raydir (s, t) \ rVert} </script></p><br>  So we got the desired function. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2204">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2205">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2206">y</span><span class="MJXp-mo" id="MJXp-Span-2207" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2208">s</span><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210">t</span><span class="MJXp-mo" id="MJXp-Span-2211" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212">d</span><span class="MJXp-mo" id="MJXp-Span-2213" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76"> ray (s, t, d) </script>  which returns the point of the beam at a distance <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77"> d </script>  from its beginning, I correspond to a pixel with coordinates <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">s</span><span class="MJXp-mo" id="MJXp-Span-2218" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2219">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> s, t </script>  . <br><br><h1>  Excel </h1><br>  The Excel file that results is a book consisting of&gt; 6 sheets: <br><br><ul><li>  The first sheet of <b>R</b> contains everything the end user needs: the cells with parameters <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2221">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2222">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2224">s</span><span class="MJXp-mo" id="MJXp-Span-2225" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2228">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2229">s</span><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2232">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">v</span><span class="MJXp-mo" id="MJXp-Span-2234" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2238">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239">a</span><span class="MJXp-mo" id="MJXp-Span-2240" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2241">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244">a</span><span class="MJXp-mo" id="MJXp-Span-2245" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-79"> rows, cols, fov, alpha, beta, dist </script>  , as well as cells with the result, painted on a black and white scale. </li><li>  Sheet <b>N</b> preassigns values <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2250"><span class="MJXp-mtext" id="MJXp-Span-2251">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2254">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">c</span><span class="MJXp-mrow" id="MJXp-Span-2256"><span class="MJXp-mn" id="MJXp-Span-2257">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2258"><span class="MJXp-mtext" id="MJXp-Span-2259">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2265">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2266">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2267">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2268">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2270">r</span><span class="MJXp-mo" id="MJXp-Span-2271" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2272">s</span><span class="MJXp-mo" id="MJXp-Span-2273" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2274">t</span><span class="MJXp-mo" id="MJXp-Span-2275" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-2276">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2279">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> \ frac {1} {\ lVert raydir (s, t) \ rVert} </script>  . </li><li>  Sheets <b>X</b> , <b>Y</b> , <b>Z</b> calculate coordinates <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283">X</span><span class="MJXp-mo" id="MJXp-Span-2284" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285">y</span><span class="MJXp-mo" id="MJXp-Span-2286" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81"> X, y, z </script>  vectors <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2290">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2291">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2292">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2294">r</span><span class="MJXp-mo" id="MJXp-Span-2295" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2296">s</span><span class="MJXp-mo" id="MJXp-Span-2297" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2298">t</span><span class="MJXp-mo" id="MJXp-Span-2299" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82"> raydir (s, t) </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2300"><span class="MJXp-mtext" id="MJXp-Span-2301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2302">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2303">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">c</span><span class="MJXp-mrow" id="MJXp-Span-2306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2308">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2309">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2310">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2312">r</span><span class="MJXp-mo" id="MJXp-Span-2313" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2314">s</span><span class="MJXp-mo" id="MJXp-Span-2315" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316">t</span><span class="MJXp-mo" id="MJXp-Span-2317" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-2318"><span class="MJXp-mtext" id="MJXp-Span-2319">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2321">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2322">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2323">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2324">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2325">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2326">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2327">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2328">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2329">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2330">r</span><span class="MJXp-mo" id="MJXp-Span-2331" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2332">s</span><span class="MJXp-mo" id="MJXp-Span-2333" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334">t</span><span class="MJXp-mo" id="MJXp-Span-2335" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-2336">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2337">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2339">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2340">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-83"> \ frac {raydir (s, t)} {\ lVert raydir (s, t) \ rVert} </script>  . </li><li>  Sheets <b>i1</b> , <b>i2</b> , ... contain iterations of the Ray Marching algorithm for each pixel. </li></ul><br>  All sheets are built according to the same scheme: <br><br><img src="https://habrastorage.org/webt/zx/ap/-f/zxap-fai-u7wbyuhirp43c4b1aa.png"><br><br><ul><li>  The first line contains 1-6 ‚Äúglobal‚Äù variables (blue).  They can be used in all sheets. </li><li>  Most of the sheet is occupied by pixel calculations (green).  This is a rectangle of size. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2344">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2346">s</span><span class="MJXp-mtext" id="MJXp-Span-2347">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2349">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2350">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2352">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2355">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> rows \ times cols </script>  .  In the tables at the end of the article, these cells are designated as <code>**</code> </li><li>  Sheets <b>X</b> , <b>Y,</b> and <b>Z</b> also use intermediate calculations in rows and columns (orange).  The second row and first column are reserved for them.  In the tables at the end of the article, these cells are designated <code>A*</code> and <code>*2</code> .  The idea is that to store values <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2358">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2363">r</span><span class="MJXp-mo" id="MJXp-Span-2364" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2365">s</span><span class="MJXp-mo" id="MJXp-Span-2366" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367">t</span><span class="MJXp-mo" id="MJXp-Span-2368" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85"> raydir (s, t) </script>  over all pixels it is not necessary to add three more sheets (for each of the coordinates) since the formula for its calculation is divided into the sum of two components: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2370">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2372">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375">r</span><span class="MJXp-mo" id="MJXp-Span-2376" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377">s</span><span class="MJXp-mo" id="MJXp-Span-2378" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">t</span><span class="MJXp-mo" id="MJXp-Span-2380" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2381" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2382">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2383">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2387">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2389">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2390">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2391">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392">e</span><span class="MJXp-msubsup" id="MJXp-Span-2393"><span class="MJXp-mrow" id="MJXp-Span-2394" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-2395">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2396">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2397">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2399">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2400">n</span><span class="MJXp-mrow" id="MJXp-Span-2401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2402">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2403">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2405">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2407">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2409">x</span><span class="MJXp-mn" id="MJXp-Span-2410">0</span><span class="MJXp-mspace" id="MJXp-Span-2411" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412">y</span><span class="MJXp-mn" id="MJXp-Span-2413">0</span><span class="MJXp-mspace" id="MJXp-Span-2414" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">z</span><span class="MJXp-mn" id="MJXp-Span-2416">0</span><span class="MJXp-mtext" id="MJXp-Span-2417">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2418">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2419">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2420">d</span><span class="MJXp-mrow" id="MJXp-Span-2421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2422">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2424">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2425">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2427">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2428">x</span></span><span class="MJXp-mo" id="MJXp-Span-2429" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430">s</span><span class="MJXp-mtext" id="MJXp-Span-2431">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2432">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2433">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2434">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2436">n</span><span class="MJXp-mrow" id="MJXp-Span-2437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2438">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2439">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2440">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2441">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2443">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2444">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2445">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2446">x</span><span class="MJXp-mspace" id="MJXp-Span-2447" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2448">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449">y</span><span class="MJXp-mspace" id="MJXp-Span-2450" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">z</span><span class="MJXp-mtext" id="MJXp-Span-2453">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2455">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2456">d</span><span class="MJXp-mrow" id="MJXp-Span-2457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2458">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2459">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2460">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2463">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2464">x</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2465" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2466">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2467">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2468">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2469">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2470">x</span><span class="MJXp-mrow" id="MJXp-Span-2471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2473">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2475">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2477">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2479">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2480">s</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2481" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2482">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2484">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2486">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2487">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2488">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2489">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2490">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2491">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2492">e</span><span class="MJXp-msubsup" id="MJXp-Span-2493"><span class="MJXp-mrow" id="MJXp-Span-2494" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2495">t</span><span class="MJXp-mtext" id="MJXp-Span-2496">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2497">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2498">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2501">n</span><span class="MJXp-mrow" id="MJXp-Span-2502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2503">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2504">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2505">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2506">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2508">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2509">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2510">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2511">x</span><span class="MJXp-mspace" id="MJXp-Span-2512" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2513">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514">y</span><span class="MJXp-mspace" id="MJXp-Span-2515" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2516">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2517">z</span><span class="MJXp-mtext" id="MJXp-Span-2518">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2519">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2521">d</span><span class="MJXp-mrow" id="MJXp-Span-2522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2523">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2524">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2525">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2526">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2527">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2528">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2529">x</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2530" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2531">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2533">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2534">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535">x</span><span class="MJXp-mrow" id="MJXp-Span-2536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2537">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2538">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2540">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2541">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2542">s</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-86"> raydir (s, t) = \ underbrace {\ begin {pmatrix} x0 \\ y0 \\ z0 \ end {pmatrix} + s \ begin {pmatrix} ux \\ uy \\ uz \ end {pmatrix}} _ { \ mbox {by columns}} + \ underbrace {t \ begin {pmatrix} vx \\ vy \\ vz \ end {pmatrix}} _ {\ mbox {by rows}} </script></p><br>  Thus, we predict the first addendum by column and second by row, and when we need to get the value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2544">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2545">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2546">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2547">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2548">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549">r</span><span class="MJXp-mo" id="MJXp-Span-2550" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2551">s</span><span class="MJXp-mo" id="MJXp-Span-2552" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2553">t</span><span class="MJXp-mo" id="MJXp-Span-2554" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87"> raydir (s, t) </script>  we add the cell value to the row <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> s </script>  and column <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89"> t </script>  . <br></li></ul><br><table><tbody><tr><td colspan="3" align="center">  Sheet <b>R</b> </td></tr><tr><td width="33" align="right"><pre>  I1 </pre></td><td width="50" align="right">  rows: </td><td> <code>50</code> </td> </tr><tr><td align="right"><pre>  V1 </pre></td><td align="right">  cols: </td><td> <code>77</code> </td> </tr><tr><td align="right"><pre>  AI1 </pre></td><td align="right">  fov: </td><td> <code>39</code> </td> </tr><tr><td align="right"><pre>  AV1 </pre></td><td align="right">  dist: </td><td> <code>1,4</code> </td> </tr><tr><td align="right"><pre>  BI1 </pre></td><td align="right">  alpha: </td><td> <code>35</code> </td> </tr><tr><td align="right"><pre>  Bv1 </pre></td><td align="right">  beta: </td><td> <code>20</code> </td> </tr><tr><td align="right"><pre>  ** </pre></td><td colspan="2"> <code>=(i14! <i>XN</i> - i13! <i>XN</i> &lt; 0,00000000000001; 0,09; (0; (1; (i15! <i>XN</i> - i14! <i>XN</i> ) / (i14! <i>XN</i> - i13! <i>XN</i> ))))</code> </td> </tr></tbody></table><br><br><table><tbody><tr><td colspan="3" align="center">  Sheet <b>N</b> </td></tr><tr><td width="33" align="right"><pre>  I1 </pre></td><td width="75" align="right">  pixelSize: </td><td> <code>=TAN(R!AI1 / 2) / (R!I1 / 2)</code> </td> </tr><tr><td align="right"><pre>  ** </pre></td><td colspan="2"> <code>=1 / ((X!A <i>N</i> + X! <i>X</i> 2; 2) + (Y!A <i>N</i> ; 2) + (Z!A <i>N</i> + Z! <i>X</i> 2; 2))</code> </td> </tr></tbody></table><br><br><table><tbody><tr><td colspan="3" align="center">  Sheet <b>X</b> </td></tr><tr><td width="33" align="right"><pre>  I1 </pre></td><td width="50" align="right">  camX: </td><td> <code>=R!AV1 * COS(R!BV1) * COS(R!BI1)</code> </td> </tr><tr><td align="right"><pre>  V1 </pre></td><td align="right">  ux: </td><td> <code>=-N!I1 * SIN(R!BI1)</code> </td> </tr><tr><td align="right"><pre>  AI1 </pre></td><td align="right">  vx: </td><td> <code>=N!I1 * SIN(R!BV1) * COS(R!BI1)</code> </td> </tr><tr><td align="right"><pre>  AV1 </pre></td><td align="right">  x0: </td><td> <code>=-COS(R!BV1) * COS(R!BI1)</code> </td> </tr><tr><td align="right"><pre>  A * </pre></td><td colspan="2"> <code>=AI1 * (() - 2 - (R!I1 + 1) / 2)</code> </td> </tr><tr><td align="right"><pre>  * 2 </pre></td><td colspan="2"> <code>=AV1 + V1 * (() - 1 - (R!V1 + 1) / 2)</code> </td> </tr><tr><td align="right"><pre>  ** </pre></td><td colspan="2"> <code>=( <i>Z</i> 2 + A <i>N</i> ) * N! <i>Z</i> <i>N</i></code> </td> </tr></tbody></table><br><br><table><tbody><tr><td colspan="3" align="center">  Sheet <b>Y</b> </td></tr><tr><td width="33" align="right"><pre>  I1 </pre></td><td width="50" align="right">  camY: </td><td> <code>=R!AV1 * SIN(R!BV1)</code> </td> </tr><tr><td align="right"><pre>  V1 </pre></td><td align="right">  vy: </td><td> <code>=-N!I1 * COS(R!BV1)</code> </td> </tr><tr><td align="right"><pre>  AI1 </pre></td><td align="right">  y0: </td><td> <code>=-SIN(R!BV1)</code> </td> </tr><tr><td align="right"><pre>  A * </pre></td><td colspan="2"> <code>=AI1 + V1 * (() - 2 - (R!I1 + 1) / 2)</code> </td> </tr><tr><td align="right"><pre>  ** </pre></td><td colspan="2"> <code>=A <i>N</i> * N! <i>Z</i> <i>N</i></code> </td> </tr></tbody></table><br><br><table><tbody><tr><td colspan="3" align="center">  Sheet <b>Z</b> </td></tr><tr><td width="33" align="right"><pre>  I1 </pre></td><td width="50" align="right">  camZ: </td><td> <code>=R!AV1 * COS(R!BV1)) * SIN(R!BI1)</code> </td> </tr><tr><td align="right"><pre>  V1 </pre></td><td align="right">  uz: </td><td> <code>= N!I1 * COS(R!BI1)</code> </td> </tr><tr><td align="right"><pre>  AI1 </pre></td><td align="right">  vz: </td><td> <code>= N!I1 * SIN(R!BV1) * SIN(R!BI1)</code> </td> </tr><tr><td align="right"><pre>  AV1 </pre></td><td align="right">  z0: </td><td> <code>=-COS(R!BV1) * SIN(R!BI1)</code> </td> </tr><tr><td align="right"><pre>  A * </pre></td><td colspan="2"> <code>=AI1 * (() - 2 - (R!I1 + 1) / 2)</code> </td> </tr><tr><td align="right"><pre>  * 2 </pre></td><td colspan="2"> <code>=AV1 + V1 * (() - 1 - (R!V1 + 1) / 2)</code> </td> </tr><tr><td align="right"><pre>  ** </pre></td><td colspan="2"> <code>=( <i>Z</i> 2 + A <i>N</i> ) * N! <i>Z</i> <i>N</i></code> </td> </tr></tbody></table><br><br><table><tbody><tr><td colspan="3" align="center">  <b>I1</b> sheet </td></tr><tr><td width="33" align="right"><pre>  I1 </pre></td><td width="75" align="right">  dist0: </td><td> <code>= <b>formula(</b> X!I1, Y!I1, Z!I1 <b>)</b></code> </td> </tr><tr><td align="right"><pre>  ** </pre></td><td colspan="2"> <code>=I1 + <b>formula(</b> X!I1 + X! <i>XN</i> * I1, Y!I1 + Y! <i>XN</i> * I1, Z!I1 + Z! <i>XN</i> * I1 <b>)</b></code> </td> </tr></tbody></table><br><br><table><tbody><tr><td colspan="3" align="center">  Sheets <b>i2</b> , <b>i3</b> , ... </td></tr><tr><td align="right"><pre>  ** </pre></td><td colspan="2"> <code>=i <i>(n-1)</i> ! <i>XN</i> + <b>formula(</b> X!I1 + X! <i>XN</i> * i <i>(n-1)</i> ! <i>XN</i> , Y!I1 + Y! <i>XN</i> * i <i>(n-1)</i> ! <i>XN</i> , Z!I1 + Z! <i>XN</i> * i <i>(n-1)</i> ! <i>XN</i> <b>)</b></code> </td> </tr></tbody></table><br><br>  Notes: <br><br><ul><li>  Since in Excel calculations are made in radians, the arguments of all trigonometric functions are multiplied by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2559"><span class="MJXp-mtext" id="MJXp-Span-2560">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2561">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2562">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2564">c</span><span class="MJXp-mrow" id="MJXp-Span-2565"><span class="MJXp-mtext" id="MJXp-Span-2566">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2567">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2568">i</span></span><span class="MJXp-mrow" id="MJXp-Span-2569"><span class="MJXp-mn" id="MJXp-Span-2570">180</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90"> \ frac {\ pi} {180} </script>  (Excel has a <code>RADIANS</code> function for this).  In order not to confuse the formulas, I removed these multiplications in the tables above. </li><li>  Where the <b><code>formula</code></b> is written, you must insert one of these formulas: <br><br><div class="spoiler">  <b class="spoiler_title">Excel cube formula</b> <div class="spoiler_text"><pre> MIN (
   MAX (
     ABS (x) - 0.3, ABS (y) - 0.3, ABS (z) - 0.3,
     -SQRT (POWER (x, 2) + POWER (y, 2) + POWER (z, 2)) + 0.375
   ),
   SQRT (POWER (SQRT (POWER (x - 0.25, 2) + POWER (z - 0.25, 2)) - 0.25, 2) + POWER (y, 2)) - 0.05
 )
</pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Excel Formula Teapot</b> <div class="spoiler_text"><pre> MIN (
   SQRT (POWER (SQRT (POWER (x, 2) + POWER (z, 2)) - 0.3, 2) + POWER (y - 0.18, 2)) - 0.02,
   SQRT (POWER (x, 2) + POWER (y, 2) * 2.5 + POWER (z, 2)) - 0.4,
   MAX (
     x + y - 0.15 - 0.05 - 0.5,
     - (y) + 0.19 - 0.1,
     SQRT (POWER (SQRT (POWER (x - 0.55, 2) + POWER (y - 0.09, 2)) - 0.1, 2) + POWER (z - 0.1, 2)) - 0.04
   ),
   MAX (
     - (- (y) + 0.19 - 0.1),
     SQRT (POWER (SQRT (POWER (x - 0.35, 2) + POWER (y - 0.09, 2)) - 0.1, 2) + POWER (z - 0.1, 2)) - 0.04
   ),
   SQRT (POWER (x, 2) + POWER (y - 0.27, 2) + POWER (z, 2)) - 0.05
 )
</pre><br></div></div><br></li></ul><br>  <b>How does this article compare with the article <a href="https://habr.com/post/348704/">‚Äú3D-engine written on MS Excel formulas‚Äù</a> ?</b> <br><br>  That engine is only suitable for rendering mazes and ellipsoids.  One-dimensional Raycaster is used, from which data stripes are created up and down creating the illusion of walls.  But there is implemented a full-fledged game logic, here the goal is only a three-dimensional engine. </div><p>Source: <a href="https://habr.com/ru/post/353422/">https://habr.com/ru/post/353422/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353410/index.html">Device and mechanism of work of Prometheus Operator in Kubernetes</a></li>
<li><a href="../353412/index.html">What is frozen on feature freeze</a></li>
<li><a href="../353414/index.html">Analysis of the main concepts of concurrency</a></li>
<li><a href="../353416/index.html">NumPy in Python. Part 2</a></li>
<li><a href="../353418/index.html">Improving performance through access control</a></li>
<li><a href="../353424/index.html">Aircraft control system simulation</a></li>
<li><a href="../353426/index.html">How to upload custom log to Splunk + logs for Fortinet</a></li>
<li><a href="../353428/index.html">Telegram lock - prepare for the worst?</a></li>
<li><a href="../353430/index.html">18 rules of the perfect psd layout - a useful checklist for designers</a></li>
<li><a href="../353432/index.html">How to write an exchange with 50 suppliers and do not go crazy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>