<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New vulnerability in Android allows attackers to modify applications without affecting their signatures.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A serious vulnerability (CVE-2017-13156) in Android allows attackers to change the code in applications without affecting their signatures. The root o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New vulnerability in Android allows attackers to modify applications without affecting their signatures.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Janus1.JPG/1280px-Janus1.JPG" alt="image"><br><br>  A serious vulnerability (CVE-2017-13156) in Android allows attackers to change the code in applications without affecting their signatures.  The root of the problem is that the file can be a valid APK file and a valid DEX file at the same time.  They called him the vulnerability of Janus in honor of the Roman god of duality. <br><a name="habracut"></a><br><h3>  Janus Vulnerability </h3><br>  The vulnerability of Janus is related to the possibility of adding additional bytes to APK and DEX files.  On the one hand, the APK file is a zip archive that can contain arbitrary bytes at the beginning, before its zip records (in general, between its zip records).  The JAR signature scheme only considers zip entries.  It ignores any extra bytes when calculating or verifying the application signature.  On the other hand, a DEX file may contain arbitrary bytes at the end, after regular sections of lines, classes, method definitions, etc.  Thus, the file can be a valid APK file and a valid DEX file at the same time. <br><br><img src="https://www.guardsquare.com/files/media/guardsquare2017/Apk_Dex_Dual.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Another key element is the seemingly innocuous feature of the Dalvik / ART virtual machine.  Theoretically, the Android runtime loads an APK file, extracts its DEX file, and then runs its code.  In practice, the virtual machine can load and execute both APK files and DEX files.  When he receives an APK file, he still looks at the magic bytes in the header to decide what type of file it is.  If it finds a DEX header, it loads the file as a DEX file.  Otherwise, it downloads the file as an APK file containing a zip entry with a DEX file.  Thus, it may misinterpret DEX / APK files. <br><br>  An attacker can use this duality.  It can add a malicious DEX file to the APK file without affecting its signature.  Then, the Android runtime accepts the APK file as a valid update of the legitimate earlier version of the application.  However, Dalvik VM loads the code from the attached DEX file. <br><br><h3>  Threat </h3><br>  Although Android apps are self-signed, signature verification is important when updating Android apps.  When a user downloads an application update, the Android runtime compares his signature with the signature of the original version.  If the signatures match, the Android runtime continues to install the update.  The updated application inherits the permissions of the original application.  Therefore, attackers can use a Janus vulnerability to mislead the update process and get unverified code with powerful permissions installed on unsuspecting users' devices. <br><br>  There are several serious scenarios.  An attacker could replace a trusted application with high privileges (for example, a system application) with a modified update in order to abuse its permissions.  Depending on the target application, this may allow a hacker to access confidential information stored on the device, or even completely capture the device.  Alternatively, an attacker could pass a modified clone of a sensitive application as a legitimate update, for example, in the context of banking or communications.  A cloned application may look and behave like the original application, but introduce malicious behavior. <br><br>  The zip file format is archaic and is prone to issues such as master key vulnerability and Janus vulnerability.  Ambiguous mail files probably lead to similar vulnerabilities in different contexts and in different systems.  The main reason is redundancy in the format.  When designing data formats, protocols, data structures, and code in general, you should always strive to avoid redundancy.  Any discrepancies lead to mistakes or worse. <br><br><h3>  Scope and mitigation </h3><br>  Any script still requires the user to install a malicious update from a source outside the Google Play store.  It may be relatively easy to fool some users, because the application may still look exactly the same as the original application, and has the appropriate signature.  For experts, general reverse engineering tools do not show the code entered.  Users should always be vigilant when downloading applications and updates. <br><br>  Janus vulnerability affects the latest Android devices (Android 5.0 and newer).  Applications signed using the APK v2 subscription scheme and running on devices that support the latest subscription scheme (Android 7.0 and later) are protected from this vulnerability.  Unlike the v1 scheme, this v2 scheme considers all the bytes in the APK file.  Older applications and newer applications running on older devices remain susceptible.  Developers should at least always use the v2 signature scheme. <br><br>  Android applications that use the DexGuard unauthorized access detection mechanism are better protected from cloning attacks.  The mechanism performs additional checks to ensure that the protected applications have not been modified in any way.  We recommend using unauthorized access detection and other levels of DexGuard protection against reverse engineering and cloning. </div><p>Source: <a href="https://habr.com/ru/post/344354/">https://habr.com/ru/post/344354/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344344/index.html">ReactOS 0.4.7: Pavel Durov is no longer Pyuschn</a></li>
<li><a href="../344346/index.html">Five ideas "for service", or Impressions of the Moscow "Heisenbag"</a></li>
<li><a href="../344348/index.html">We calculate the exact address of any user by phone number or email address</a></li>
<li><a href="../344350/index.html">Development of indie games by one person (history, tips)</a></li>
<li><a href="../344352/index.html">Optional Arguments in Go Functions</a></li>
<li><a href="../344356/index.html">Why Go Design is Bad for Smart Programmers</a></li>
<li><a href="../344358/index.html">Digital events in Moscow from 11 to 17 December</a></li>
<li><a href="../344360/index.html">PHP Digest number 121 (November 20 - December 10, 2017)</a></li>
<li><a href="../344362/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ292 (December 4 - 10, 2017)</a></li>
<li><a href="../344366/index.html">30-hour hakaton Yandex. Weather, or how to predict precipitation on signals from users</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>