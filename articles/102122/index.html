<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Features of using GD-lib on PHP hosting with limited resources</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This problem had to be dealt with after the event on the hosting ‚ÄúX‚Äù, where rather small images could not be converted using this library. But the wor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Features of using GD-lib on PHP hosting with limited resources</h1><div class="post__text post__text-html js-mediator-article">  This problem had to be dealt with after the event on the hosting ‚ÄúX‚Äù, where rather small images could not be converted using this library.  But the worst thing was that the script just died, leaving the information only in the logs.  So I had to find out <a name="habracut"></a><br><br>  From reliable sources (logs) it was known that there is not enough memory to copy the image into it.  Those.  it was necessary to preliminarily check its sufficient availability before using the library (the variant manipulation with memory_limit is not considered), having foreseen how much memory it is going to grab. <br><br>  So, the GD library can create images with a palette of 2 ^ 8 colors and 2 ^ 24.  T.zh.  theoretically, the maximum image size is 2 ^ 16 x 2 ^ 16.  Total per pixel is 5 or 7 bytes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's test it in practice - create square images with the createImage and createImageTrueColor functions.  And let us reduce the practice and theory in one graph: <br><br><img src="http://imagepost.ru/images/194/t1.jpg"><br><br>  It can be seen that the results diverge, but the theory for 8 bits and practice for 24 bits practically coincide. <br><br>  Let's try to get the empirical values ‚Äã‚Äãof "average memory cost" by 1 pixel in two palettes.  We build graphics. <br><br><img src="http://imagepost.ru/images/194/t2.jpg"><br><br>  It is seen that for large values ‚Äã‚Äãthey asymptotically tend to 2 and 5 bytes, respectively. <br><br>  But with small image sizes (approximately 100 pixels per side) they can reach 3 and 6 bytes per pixel.  We will not bother with the approximating function (although it would be worth it) and just take an average of 2.5 and 5.5 bytes per pixel, respectively. <br><br>  As a result, we obtain the following function to test the possibility of using the GD library in the current operational environment: <br><br><blockquote><code><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> <font color="black">Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> <ol> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li></li><li></li><li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/8371/s"></a> <a href="http://s-c.me/8371/h"></a> <a href="http://www.php.net/manual/en/function.trim.php"></a> <a href="http://www.php.net/manual/en/function.strtolower.php"></a> <a href="http://www.php.net/manual/en/function.strlen.php"></a> <a href="http://www.php.net/manual/en/function.ini-get.php"></a> Copy Source | Copy HTML <font color="#0000ff">function</font> returnBytes( <font color="#cc6633">$v</font> ) { <font color="#cc6633">$v</font> = trim( <font color="#cc6633">$v</font> ); <font color="#0000ff">switch</font> (strtolower( <font color="#cc6633">$v</font> [strlen( <font color="#cc6633">$v</font> )- <font color="#008000">1</font> ])) { <font color="#0000ff">case</font> <font color="#008000">'g'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'m'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; <font color="#0000ff">case</font> <font color="#008000">'k'</font> : <font color="#cc6633">$v</font> *= <font color="#008000">1024</font> ; } <font color="#0000ff">return</font> <font color="#cc6633">$v</font> ; } <font color="#0000ff">function</font> checkMemoryForGDUsage( <font color="#cc6633">$w</font> , <font color="#cc6633">$h</font> , <font color="#cc6633">$trueColor</font> = <font color="#0000ff">false</font> ){ <font color="#0000ff">return</font> (((returnBytes(ini_get( <font color="#008000">"memory_limit"</font> ))-memory_get_usage())) &gt; ( <font color="#cc6633">$w</font> * <font color="#cc6633">$h</font> * ( <font color="#008000">2</font> . <font color="#008000">5</font> + (((int) <font color="#cc6633">$trueColor</font> ) * <font color="#008000">3</font> ))))? <font color="#0000ff">true</font> : <font color="#0000ff">false</font> ; }</font></code> </li> </ol></blockquote><br><br>  Actually everything, now the call to the checkMemoryForGDUsage function with the planned widths, heights and palettes, before creating an image, can save (under successful circumstances) from fatal error. </div><p>Source: <a href="https://habr.com/ru/post/102122/">https://habr.com/ru/post/102122/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../102106/index.html">Creating an FB2 version of the latest issue of a magazine / newspaper</a></li>
<li><a href="../102109/index.html">The crisis in the economy and ethics in business</a></li>
<li><a href="../102112/index.html">RIP "Well, Wait!" Or copyright story</a></li>
<li><a href="../102119/index.html">Geoip</a></li>
<li><a href="../102121/index.html">R. Feynman "The nature of physical laws" (second lecture)</a></li>
<li><a href="../102124/index.html">Your Web-PDF printer in 10 minutes</a></li>
<li><a href="../102125/index.html">Sports Tracker Service Overview</a></li>
<li><a href="../102126/index.html">A study of simple crackme's (part 3)</a></li>
<li><a href="../102128/index.html">Removal of extra costs for customers for online stores with courier delivery</a></li>
<li><a href="../102129/index.html">Packard Bell Laptop Power Recovery</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>