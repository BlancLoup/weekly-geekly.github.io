<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Four levels of one-page apps that you need to know about</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, we will develop a React application from scratch, discuss the domain and its services, storage, application services, and view. 



 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Four levels of one-page apps that you need to know about</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/8v/ck/hv/8vckhvqca44x9c5d4kbzrss-ro4.jpeg" alt="image"></p><br><p>  In this article, we will develop a React application from scratch, discuss the domain and its services, storage, application services, and view. </p><a name="habracut"></a><br><p><img src="https://habrastorage.org/webt/g9/ye/dz/g9yedzysulqav3fucnwbdnbqwsa.png"><br>  <em>Four levels of single page (SPA) applications</em> </p><br><p>  Every successful project needs a clear architecture that is understandable to all members of the development team.  Let's say you recently came to the team.  Timlid talks about the proposed architecture for the new application: </p><br><p><img src="https://habrastorage.org/webt/wb/6r/9i/wb6r9iwlvlafcogl9sddoliytlg.png"></p><br><p>  It describes the requirements: </p><br><p>  <em>Our application will display a list of articles.</em>  <em>At the same time, users will be able to create and delete articles, as well as post likes.</em> </p><br><p>  And then the team leader asks you to implement it! </p><br><h2 id="voprosov-net-nachnyom-s-arhitektury">  No questions, let's start with architecture </h2><br><p>  I chose the <a href="https://github.com/facebook/create-react-app">Create React App</a> and <a href="https://flow.org/">Flow</a> for type checking.  In order not to inflate the code, our application will be without styles.  And now let's talk about the declarative nature of modern frameworks, affecting the concept of state. </p><br><h2 id="sovremennye-freymvorki-deklarativny">  Modern frameworks are declarative. </h2><br><p>  React, Angular, Vue are <a href="https://tylermcginnis.com/imperative-vs-declarative-programming/">declarative</a> , they push us to use elements of functional programming. </p><br><p>  Have you ever enjoyed your childhood ‚Äúcartoons‚Äù drawn on the pages of a notebook or notebook, which had to be quickly turned over, with homemade <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B8%25D0%25BD%25D0%25B5%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584">filmmakers</a> ? </p><br><p>  <em><strong>Kineograph</strong> (Kineograph) - a device for creating an animated image consisting of separate frames, printed on sheets of paper, stitched into a notebook.</em>  <em>The viewer, looking through the notebook in a special way, observes the effect of animation.</em> </p><br><p>  And here is part of the <a href="https://reactjs.org/">React</a> description: </p><br><p>  <em>Create simple views for each state of your application, and React, when the data changes, will effectively update and draw only the necessary components.</em> </p><br><p>  And here is part of the description of <a href="https://angular.io/">Angular</a> : </p><br><p>  <em>Quickly create functionality with simple, declarative templates.</em>  <em>Extend the template language with your own components.</em> </p><br><p>  Familiar sounds? </p><br><p>  The frameworks help us build applications from submissions.  Views (views) personify the state.  But what is a condition? </p><br><h2 id="sostoyanie">  condition </h2><br><p>  The status displays all changed data in the application. </p><br><p>  You clicked the URL - this is the state;  made an Ajax call to get a list of movies - this is also a state;  you put the information in the local storage - and this is the state. </p><br><p>  The state is formed from <strong>immutable objects.</strong> </p><br><p>  An <a href="http://enterprisecraftsmanship.com/2016/05/12/immutable-architecture">immutable architecture has</a> many advantages, one of which relates to the state level. </p><br><p>  Here is a quote from React's <a href="https://reactjs.org/docs/optimizing-performance.html">Performance Optimization</a> Guide: </p><br><p>  <em>Immutability makes change tracking cheaper.</em>  <em>Any change always leads to the creation of a new object, so we only need to check if the object reference has changed.</em> </p><br><h2 id="uroven-domena">  Domain Level </h2><br><p>  The domain describes the state and contains the business logic.  It represents the core of the application and should not depend on the level of the view.  We need the ability to use your domain, regardless of the framework. </p><br><p><img src="https://habrastorage.org/webt/bx/pc/gd/bxpcgduyjyvyoj8phekldkp3_va.png"><br>  <em>Domain Level</em> </p><br><p>  As we work with immutable architecture, the domain level will consist of entities and services of the domain.  The use of an <a href="https://en.wikipedia.org/wiki/Anemic_domain_model">anemic domain model</a> in OOP is controversial, especially in large applications, but it is quite suitable for working with immutable data.  For me, at one time, was the opening <a href="https://www.pluralsight.com/courses/refactoring-anemic-domain-model">course of</a> Vladimir Horikov. </p><br><p> Since we need to display a list of articles, we first model the essence of the <code>Article</code> . </p><br><p>  All future objects of type <code>Article</code> should be immutable.  Flow can <a href="https://flow.org/en/docs/react/redux/">force this by making</a> each property read-only (see the plus sign in front of each property). </p><br><p>  Article.js: </p><br><pre> <code class="hljs lua">// @flow export <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> Article = { +id: <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>; +likes: number; +title: <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>; +author: <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>; }</code> </pre> <br><p>  Now, using the ‚Äúfactory‚Äù function template, create an <code>articleService</code> .  This moment is beautifully explained <a href="https://www.youtube.com/watch%3Fv%3DImwrezYhw4w">here</a> . </p><br><p>  Since we only need one <code>articleService</code> in the application, we export as a singleton.  The <code>createArticle</code> method will allow you to create <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze">frozen objects</a> like <code>Article</code> .  Each new article will receive a unique automatically generated ID and 0 likes, and we specify only the author and title. </p><br><p>  <em>The <code>Object.freeze()</code> method freezes an object, that is, it prevents new properties from being added to the object.</em>  <em>( <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze">c</a> )</em> </p><br><p>  The <code>createArticle</code> method returns a maybe-type <code>Article</code> . </p><br><p>  <em><a href="https://flow.org/en/docs/types/maybe">Maybe-types</a> ( <a href="https://en.wikipedia.org/wiki/Option_type">optional types</a> ) force you to check whether an Article object exists before performing operations on it.</em> </p><br><p>  If the field required to create an article fails validation, the <code>createArticle</code> method returns null.  Someone will say that it is better to throw a user-defined exception.  But if we make it do this, and the upper levels do not implement exception catching blocks, the program will crash during execution. </p><br><p>  The <code>updateLikes</code> method will help update the number of likes of an existing article by returning a copy of it with a new counter. </p><br><p>  Finally, the <code>isTitleValid</code> and <code>isAuthorValid</code> do not allow <code>createArticle</code> to work with corrupted data. </p><br><p>  ArticleService.js: </p><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> v1 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'uuid'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> R <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ramda'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> type {Article} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./Article"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> validators <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./Validators"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> type ArticleFields = { +title: string; +author: string; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> type ArticleService = { createArticle(articleFields: ArticleFields): ?Article; updateLikes(article: Article, likes: number): Article; isTitleValid(title: string): boolean; isAuthorValid(author: string): boolean; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const createArticle = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(articleFields: ArticleFields)</span></span></span><span class="hljs-function">: ?Article =&gt;</span></span> { const {title, author} = articleFields; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isTitleValid(title) &amp;&amp; isAuthorValid(author) ? Object.freeze({ id: v1(), likes: <span class="hljs-number"><span class="hljs-number">0</span></span>, title, author }) : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const updateLikes = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(article: Article, likes: number)</span></span></span><span class="hljs-function"> =&gt;</span></span> validators.isObject(article) ? Object.freeze({ ...article, likes }) : article; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const isTitleValid = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(title: string)</span></span></span><span class="hljs-function"> =&gt;</span></span> R.allPass([ validators.isString, validators.isLengthGreaterThen(<span class="hljs-number"><span class="hljs-number">0</span></span>) ])(title); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const isAuthorValid = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(author: string)</span></span></span><span class="hljs-function"> =&gt;</span></span> R.allPass([ validators.isString, validators.isLengthGreaterThen(<span class="hljs-number"><span class="hljs-number">0</span></span>) ])(author); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const ArticleServiceFactory = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ createArticle, updateLikes, isTitleValid, isAuthorValid }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const articleService = ArticleServiceFactory();</code> </pre> <br><p>  Checks are very important for maintaining data consistency, especially at the domain level.  Service <code>Validators</code> can be built from pure functions. </p><br><p>  Validators.js: </p><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> @flow <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const isObject = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(toValidate: any)</span></span></span><span class="hljs-function"> =&gt;</span></span> !!(toValidate &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> toValidate === <span class="hljs-string"><span class="hljs-string">'object'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const isString = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(toValidate: any)</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> toValidate === <span class="hljs-string"><span class="hljs-string">'string'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const isLengthGreaterThen = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(length: number)</span></span></span><span class="hljs-function"> =&gt;</span></span> (toValidate: string) =&gt; toValidate.length &gt; length;</code> </pre> <br><p>  Exceptionally for demonstration purposes, these checks are filed with a pinch of salt.  In JavaScript, it is not so easy to check if an object is really an object :) </p><br><p>  Now we have set the domain level! </p><br><p>  I am glad that we can use our code immediately, regardless of the framework.  Now let's see how <code>articleService</code> helps to create an article about one of my favorite books, as well as to update the number of likes. </p><br><p>  domain-demo.js: </p><br><pre> <code class="hljs lua">// @flow import {articleService} from <span class="hljs-string"><span class="hljs-string">"../domain/ArticleService"</span></span>; const article = articleService.createArticle({ title: <span class="hljs-string"><span class="hljs-string">'12 rules for life'</span></span>, author: <span class="hljs-string"><span class="hljs-string">'Jordan Peterson'</span></span> }); const incrementedArticle = article ? articleService.updateLikes(article, <span class="hljs-number"><span class="hljs-number">4</span></span>) : null; console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">'article'</span></span>, article); /* const itWillPrint = { id: <span class="hljs-string"><span class="hljs-string">"92832a9a-ec55-46d7-a34d-870d50f191df"</span></span>, likes: <span class="hljs-number"><span class="hljs-number">0</span></span>, title: <span class="hljs-string"><span class="hljs-string">"12 rules for life"</span></span>, author: <span class="hljs-string"><span class="hljs-string">"Jordan Peterson"</span></span> }; */ console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">'incrementedArticle'</span></span>, incrementedArticle); /* const itWillPrintUpdated = { id: <span class="hljs-string"><span class="hljs-string">"92832a9a-ec55-46d7-a34d-870d50f191df"</span></span>, likes: <span class="hljs-number"><span class="hljs-number">4</span></span>, title: <span class="hljs-string"><span class="hljs-string">"12 rules for life"</span></span>, author: <span class="hljs-string"><span class="hljs-string">"Jordan Peterson"</span></span> }; */</code> </pre> <br><h2 id="uroven-hraneniya">  Storage level </h2><br><p>  The data obtained when creating and updating articles embody the state of the application.  You need to hold this data somewhere, the ideal candidate for this is the repository. </p><br><p><img src="https://habrastorage.org/webt/yp/4l/h-/yp4lh-jbaevuxtos6mbgxlzebvk.png"><br>  <em>Storage level</em> </p><br><p>  You can simulate the state using an array of articles. </p><br><p>  ArticleState.js: </p><br><pre> <code class="hljs pgsql">// @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> {Article} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "./Article"; export <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ArticleState = Article[];</code> </pre> <br><p>  <code>ArticleStoreFactory</code> implements the ‚Äúpublish-subscribe‚Äù template and export <code>articleStore</code> as a singleton. </p><br><p>  The repository contains articles and performs unchangeable add, delete, and update operations with them.  Remember that the repository only operates on articles.  Only <code>articleService</code> can create and update them.  Interested parties can subscribe and unsubscribe in the <code>articleStore</code> , which stores in its memory a list of all subscribers and notifies them of changes. </p><br><p>  <a href="https://gist.github.com/intojs/3acd875bf72c42c559e80e0495039bb5">ArticleStore.js</a> : </p><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {update} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"ramda"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> type {Article} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../domain/Article"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> type {ArticleState} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./ArticleState"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> type ArticleStore = { addArticle(article: Article): void; removeArticle(article: Article): void; updateArticle(article: Article): void; subscribe(subscriber: Function): Function; unsubscribe(subscriber: Function): void; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const addArticle = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(articleState: ArticleState, article: Article)</span></span></span><span class="hljs-function"> =&gt;</span></span> articleState.concat(article); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const removeArticle = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(articleState: ArticleState, article: Article)</span></span></span><span class="hljs-function"> =&gt;</span></span> articleState.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a: Article)</span></span></span><span class="hljs-function"> =&gt;</span></span> a.id !== article.id); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const updateArticle = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(articleState: ArticleState, article: Article)</span></span></span><span class="hljs-function"> =&gt;</span></span> { const index = articleState.findIndex(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a: Article)</span></span></span><span class="hljs-function"> =&gt;</span></span> a.id === article.id); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> update(index, article, articleState); }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const subscribe = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(subscribers: Function[], subscriber: Function)</span></span></span><span class="hljs-function"> =&gt;</span></span> subscribers.concat(subscriber); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const unsubscribe = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(subscribers: Function[], subscriber: Function)</span></span></span><span class="hljs-function"> =&gt;</span></span> subscribers.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s: Function)</span></span></span><span class="hljs-function"> =&gt;</span></span> s !== subscriber); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const notify = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(articleState: ArticleState, subscribers: Function[])</span></span></span><span class="hljs-function"> =&gt;</span></span> subscribers.forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s: Function)</span></span></span><span class="hljs-function"> =&gt;</span></span> s(articleState)); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const ArticleStoreFactory = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { let articleState: ArticleState = Object.freeze([]); let subscribers: Function[] = Object.freeze([]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { addArticle: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(article: Article)</span></span></span><span class="hljs-function"> =&gt;</span></span> { articleState = addArticle(articleState, article); notify(articleState, subscribers); }, removeArticle: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(article: Article)</span></span></span><span class="hljs-function"> =&gt;</span></span> { articleState = removeArticle(articleState, article); notify(articleState, subscribers); }, updateArticle: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(article: Article)</span></span></span><span class="hljs-function"> =&gt;</span></span> { articleState = updateArticle(articleState, article); notify(articleState, subscribers); }, subscribe: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(subscriber: Function)</span></span></span><span class="hljs-function"> =&gt;</span></span> { subscribers = subscribe(subscribers, subscriber); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> subscriber; }, unsubscribe: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(subscriber: Function)</span></span></span><span class="hljs-function"> =&gt;</span></span> { subscribers = unsubscribe(subscribers, subscriber); } } }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const articleStore = ArticleStoreFactory();</code> </pre> <br><p>  Our implementation of the repository is quite suitable as an illustration and helps to understand the concept itself.  In real projects, I recommend using state management systems <a href="https://redux.js.org/">Redux</a> , <a href="https://github.com/ngrx">ngrx</a> , <a href="https://github.com/mobxjs/mobx">MobX,</a> or at least <a href="https://medium.com/bucharestjs/the-developers-guide-to-redux-like-state-management-in-angular-3799f1877bb">Observable</a> - <a href="https://medium.com/bucharestjs/the-developers-guide-to-redux-like-state-management-in-angular-3799f1877bb">data services</a> . </p><br><p>  So, now we have configured domain and storage levels. </p><br><p>  Let's create two articles, two subscribers to the repository, and see how subscribers will be notified of the changes. </p><br><p>  store-demo.js: </p><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> type {ArticleState} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../store/ArticleState"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {articleService} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../domain/ArticleService"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {articleStore} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../store/ArticleStore"</span></span>; const article1 = articleService.createArticle({ title: <span class="hljs-string"><span class="hljs-string">'12 rules for life'</span></span>, author: <span class="hljs-string"><span class="hljs-string">'Jordan Peterson'</span></span> }); const article2 = articleService.createArticle({ title: <span class="hljs-string"><span class="hljs-string">'The Subtle Art of Not Giving a F.'</span></span>, author: <span class="hljs-string"><span class="hljs-string">'Mark Manson'</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (article1 &amp;&amp; article2) { const subscriber1 = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(articleState: ArticleState)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'subscriber1, articleState changed: '</span></span>, articleState); }; const subscriber2 = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(articleState: ArticleState)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'subscriber2, articleState changed: '</span></span>, articleState); }; articleStore.subscribe(subscriber1); articleStore.subscribe(subscriber2); articleStore.addArticle(article1); articleStore.addArticle(article2); articleStore.unsubscribe(subscriber2); const likedArticle2 = articleService.updateLikes(article2, <span class="hljs-number"><span class="hljs-number">1</span></span>); articleStore.updateArticle(likedArticle2); articleStore.removeArticle(article1); }</code> </pre> <br><h2 id="servisy-prilozheniya">  Application Services </h2><br><p>  This level is useful for performing operations related to the state flow, such as Ajax calls for receiving data from the server, or state projections. </p><br><p><img src="https://habrastorage.org/webt/ta/ri/id/tariidpfzebtnonxkgmr9xjwqqq.png"><br>  <em>Application Services Level</em> </p><br><p>  For some reason, the designer requires that the names of the authors be written in capital letters.  The requirement is stupid, and we do not want to spoil our model because of it.  To work with this feature, create an <code>ArticleUiService</code> .  The service takes a portion of the state ‚Äî the author‚Äôs name ‚Äî and projects it, returning to the caller the version written in capital letters. </p><br><p>  ArticleUiService.js: </p><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> @flow <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const displayAuthor = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(author: string)</span></span></span><span class="hljs-function"> =&gt;</span></span> author.toUpperCase();</code> </pre> <br><p>  Here is a demo using this service. </p><br><p>  app-service-demo.js: </p><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {articleService} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../domain/ArticleService"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> articleUiService <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../services/ArticleUiService"</span></span>; const article = articleService.createArticle({ title: <span class="hljs-string"><span class="hljs-string">'12 rules for life'</span></span>, author: <span class="hljs-string"><span class="hljs-string">'Jordan Peterson'</span></span> }); const authorName = article ? articleUiService.displayAuthor(article.author) : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(authorName); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> It will <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> JORDAN PETERSON <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (article) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(article.author); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> It will <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> Jordan Peterson }</code> </pre> <br><h2 id="uroven-predstavleniya">  Presentation level </h2><br><p>  Now we have a fully functional application, independent of the framework.  It's ready for React to breathe life into it.  The presentation layer consists of a presentational and container components.  The mapping components are responsible for how the elements look, and the container components are responsible for how the elements work.  More details are described in the <a href="https://medium.com/%40dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0">article by</a> Dan Abramov. </p><br><p><img src="https://habrastorage.org/webt/co/bh/td/cobhtd9ilfvsnfvehd-voi8wpzg.png"><br>  <em>Presentation level</em> </p><br><p>  Create an <code>App</code> component consisting of the <code>ArticleFormContainer</code> and the <code>ArticleListContainer</code> . </p><br><p>  App.js: </p><br><pre> <code class="hljs pgsql">// @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, {Component} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'./App.css'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {ArticleFormContainer} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "./components/ArticleFormContainer"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {ArticleListContainer} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "./components/ArticleListContainer"; <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Props = {}; <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> App extends Component&lt;Props&gt; { render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;div className="App"&gt; &lt;ArticleFormContainer/&gt; &lt;ArticleListContainer/&gt; &lt;/div&gt; ); } } export <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> App;</code> </pre> <br><p>  Now create an <code>ArticleFormContainer</code> .  No matter, React, Angular - forms turn out difficult.  I also recommend to get acquainted with the <a href="http://ramdajs.com/">Ramda</a> library and see how its methods complement the declarative nature of our code. </p><br><p>  The form takes the data entered by the user and passes it to the articleService.  Based on this data, the service creates an Article and adds it to the ArticleStore so that the article can take other components from there.  All logic is initially stored in the submitForm method. </p><br><p>  ArticleFormContainer.js: </p><br><pre> <code class="hljs pgsql">// @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, {Component} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> R <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ramda'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> {ArticleService} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../domain/ArticleService"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> {ArticleStore} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../store/ArticleStore"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {articleService} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../domain/ArticleService"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {articleStore} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../store/ArticleStore"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {ArticleFormComponent} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "./ArticleFormComponent"; <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Props = {}; <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> FormField = { <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: string; <span class="hljs-keyword"><span class="hljs-keyword">valid</span></span>: <span class="hljs-type"><span class="hljs-type">boolean</span></span>; } export <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> FormData = { articleTitle: FormField; articleAuthor: FormField; }; export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ArticleFormContainer extends Component&lt;Props, FormData&gt; { articleStore: ArticleStore; articleService: ArticleService; constructor(props: Props) { super(props); this.state = { articleTitle: { <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">valid</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }, articleAuthor: { <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">valid</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> } }; this.articleStore = articleStore; this.articleService = articleService; } changeArticleTitle(event: Event) { this.setState( R.assocPath( [<span class="hljs-string"><span class="hljs-string">'articleTitle'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span>], R.path([<span class="hljs-string"><span class="hljs-string">'target'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span>], event) ) ); } changeArticleAuthor(event: Event) { this.setState( R.assocPath( [<span class="hljs-string"><span class="hljs-string">'articleAuthor'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span>], R.path([<span class="hljs-string"><span class="hljs-string">'target'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span>], event) ) ); } submitForm(event: Event) { const articleTitle = R.path([<span class="hljs-string"><span class="hljs-string">'target'</span></span>, <span class="hljs-string"><span class="hljs-string">'articleTitle'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span>], event); const articleAuthor = R.path([<span class="hljs-string"><span class="hljs-string">'target'</span></span>, <span class="hljs-string"><span class="hljs-string">'articleAuthor'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span>], event); const isTitleValid = this.articleService.isTitleValid(articleTitle); const isAuthorValid = this.articleService.isAuthorValid(articleAuthor); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isTitleValid &amp;&amp; isAuthorValid) { const newArticle = this.articleService.createArticle({ title: articleTitle, author: articleAuthor }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newArticle) { this.articleStore.addArticle(newArticle); } this.clearForm(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { this.markInvalid(isTitleValid, isAuthorValid); } }; clearForm() { this.setState((state) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> R.pipe( R.assocPath([<span class="hljs-string"><span class="hljs-string">'articleTitle'</span></span>, <span class="hljs-string"><span class="hljs-string">'valid'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>), R.assocPath([<span class="hljs-string"><span class="hljs-string">'articleTitle'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span>], <span class="hljs-string"><span class="hljs-string">''</span></span>), R.assocPath([<span class="hljs-string"><span class="hljs-string">'articleAuthor'</span></span>, <span class="hljs-string"><span class="hljs-string">'valid'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>), R.assocPath([<span class="hljs-string"><span class="hljs-string">'articleAuthor'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span>], <span class="hljs-string"><span class="hljs-string">''</span></span>) )(state); }); } markInvalid(isTitleValid: <span class="hljs-type"><span class="hljs-type">boolean</span></span>, isAuthorValid: <span class="hljs-type"><span class="hljs-type">boolean</span></span>) { this.setState((state) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> R.pipe( R.assocPath([<span class="hljs-string"><span class="hljs-string">'articleTitle'</span></span>, <span class="hljs-string"><span class="hljs-string">'valid'</span></span>], isTitleValid), R.assocPath([<span class="hljs-string"><span class="hljs-string">'articleAuthor'</span></span>, <span class="hljs-string"><span class="hljs-string">'valid'</span></span>], isAuthorValid) )(state); }); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;ArticleFormComponent formData={this.state} submitForm={this.submitForm.bind(this)} changeArticleTitle={(event) =&gt; this.changeArticleTitle(event)} changeArticleAuthor={(event) =&gt; this.changeArticleAuthor(event)} /&gt; ) } }</code> </pre> <br><p>  Please note that the <code>ArticleFormContainer</code> returns exactly the form that the user sees, that is, the submitted <code>ArticleFormComponent</code> .  This component displays container-passed data and generates events like <code>changeArticleTitle</code> , <code>changeArticleAuthor</code> and <code>submitForm</code> . </p><br><p>  <a href="https://gist.github.com/intojs/4a41a3817de53c9c8767d11d96d61d79">ArticleFormComponent.js</a> : </p><br><pre> <code class="hljs pgsql">// @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> {FormData} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./ArticleFormContainer'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Props = { formData: FormData; changeArticleTitle: <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span>; changeArticleAuthor: <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span>; submitForm: <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span>; } export const ArticleFormComponent = (props: Props) =&gt; { const { formData, changeArticleTitle, changeArticleAuthor, submitForm } = props; const onSubmit = (submitHandler) =&gt; (event) =&gt; { event.preventDefault(); submitHandler(event); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;form noValidate onSubmit={onSubmit(submitForm)} &gt; &lt;div&gt; &lt;label htmlFor="article-title"&gt;Title&lt;/label&gt; &lt;<span class="hljs-keyword"><span class="hljs-keyword">input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>="text" id="article-title" <span class="hljs-type"><span class="hljs-type">name</span></span>="articleTitle" autoComplete="off" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>={formData.articleTitle.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>} onChange={changeArticleTitle} /&gt; {!formData.articleTitle.<span class="hljs-keyword"><span class="hljs-keyword">valid</span></span> &amp;&amp; (&lt;p&gt;Please fill <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the title&lt;/p&gt;)} &lt;/div&gt; &lt;div&gt; &lt;label htmlFor="article-author"&gt;Author&lt;/label&gt; &lt;<span class="hljs-keyword"><span class="hljs-keyword">input</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>="text" id="article-author" <span class="hljs-type"><span class="hljs-type">name</span></span>="articleAuthor" autoComplete="off" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>={formData.articleAuthor.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>} onChange={changeArticleAuthor} /&gt; {!formData.articleAuthor.<span class="hljs-keyword"><span class="hljs-keyword">valid</span></span> &amp;&amp; (&lt;p&gt;Please fill <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the author&lt;/p&gt;)} &lt;/div&gt; &lt;button <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>="submit" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="Submit" &gt; <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> article &lt;/button&gt; &lt;/form&gt; ) };</code> </pre> <br><p>  Now we have a form for creating articles, the list has come.  <code>ArticleListContainer</code> subscribes to <code>ArticleStore</code> , gets all articles and displays <code>ArticleListComponent</code> . </p><br><p>  ArticleListContainer.js: </p><br><pre> <code class="hljs bash">// @flow import * as React from <span class="hljs-string"><span class="hljs-string">'react'</span></span> import <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> {Article} from <span class="hljs-string"><span class="hljs-string">"../domain/Article"</span></span>; import <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> {ArticleStore} from <span class="hljs-string"><span class="hljs-string">"../store/ArticleStore"</span></span>; import {articleStore} from <span class="hljs-string"><span class="hljs-string">"../store/ArticleStore"</span></span>; import {ArticleListComponent} from <span class="hljs-string"><span class="hljs-string">"./ArticleListComponent"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> State = { articles: Article[] } <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> Props = {}; <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> class ArticleListContainer extends React.Component&lt;Props, State&gt; { subscriber: Function; articleStore: ArticleStore; constructor(props: Props) { super(props); this.articleStore = articleStore; this.state = { articles: [] }; this.subscriber = this.articleStore.subscribe((articles: Article[]) =&gt; { this.setState({articles}); }); } <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">componentWillUnmount</span></span></span></span>() { this.articleStore.unsubscribe(this.subscriber); } <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span></span>() { <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> &lt;ArticleListComponent {...this.state}/&gt;; } }</code> </pre> <br><p>  <code>ArticleListComponent</code> is the component responsible for the presentation.  It gets the available articles through the properties and <code>ArticleContainer</code> components of <code>ArticleContainer</code> . </p><br><p>  ArticleListComponent.js: </p><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> type {Article} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../domain/Article"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {ArticleContainer} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./ArticleContainer"</span></span>; type Props = { articles: Article[] } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const ArticleListComponent = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(props: Props)</span></span></span><span class="hljs-function"> =&gt;</span></span> { const {articles} = props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;div&gt; { articles.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(article: Article, index)</span></span></span><span class="hljs-function"> =&gt;</span></span> ( &lt;ArticleContainer article={article} key={index} /&gt; )) } &lt;/div&gt; ) };</code> </pre> <br><p>  <code>ArticleContainer</code> transfers the article data to the <code>ArticleComponent</code> .  It also implements the <code>likeArticle</code> and <code>removeArticle</code> . </p><br><p>  The <code>likeArticle</code> method updates the number of likes by replacing the article in the repository with an updated copy, and the <code>removeArticle</code> method removes the article from the repository. </p><br><p>  ArticleContainer.js: </p><br><pre> <code class="hljs pgsql">// @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, {Component} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> {Article} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../domain/Article"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> {ArticleService} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../domain/ArticleService"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> {ArticleStore} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../store/ArticleStore"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {articleService} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../domain/ArticleService"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {articleStore} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../store/ArticleStore"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {ArticleComponent} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "./ArticleComponent"; <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Props = { article: Article; }; export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ArticleContainer extends Component&lt;Props&gt; { articleStore: ArticleStore; articleService: ArticleService; constructor(props: Props) { super(props); this.articleStore = articleStore; this.articleService = articleService; } likeArticle(article: Article) { const updatedArticle = this.articleService.updateLikes(article, article.likes + <span class="hljs-number"><span class="hljs-number">1</span></span>); this.articleStore.updateArticle(updatedArticle); } removeArticle(article: Article) { this.articleStore.removeArticle(article); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;div&gt; &lt;ArticleComponent article={this.props.article} likeArticle={(article: Article) =&gt; this.likeArticle(article)} deleteArticle={(article: Article) =&gt; this.removeArticle(article)} /&gt; &lt;/div&gt; ) } }</code> </pre> <br><p>  <code>ArticleContainer</code> transfers these articles to the <code>ArticleComponent</code> , which displays them.  Also, this method, by executing the corresponding callbacks, notifies the container component about pressing the Like or Delete buttons. </p><br><p>  Remember the insane requirement, how should the name of the author look like?  <code>ArticleComponent</code> uses <code>ArticleUiService</code> from the application level to project a portion of the state from its original value (string without capital letters) to the desired, written in capital letters. </p><br><p>  ArticleComponent.js: </p><br><pre> <code class="hljs pgsql">// @flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> {Article} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../domain/Article"; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> articleUiService <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "../services/ArticleUiService"; <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Props = { article: Article; likeArticle: <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span>; deleteArticle: <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span>; } export const ArticleComponent = (props: Props) =&gt; { const { article, likeArticle, deleteArticle } = props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;div&gt; &lt;h3&gt;{article.title}&lt;/h3&gt; &lt;p&gt;{articleUiService.displayAuthor(article.author)}&lt;/p&gt; &lt;p&gt;{article.likes}&lt;/p&gt; &lt;button <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>="button" onClick={() =&gt; likeArticle(article)} &gt; <span class="hljs-keyword"><span class="hljs-keyword">Like</span></span> &lt;/button&gt; &lt;button <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>="button" onClick={() =&gt; deleteArticle(article)} &gt; <span class="hljs-keyword"><span class="hljs-keyword">Delete</span></span> &lt;/button&gt; &lt;/div&gt; ); };</code> </pre> <br><h2 id="otlichno">  Fine! </h2><br><p>  Now we have a fully functional React-application with a reliable and understandable architecture.  Anyone new to the team can read this article and confidently connect to our work :) </p><br><p>  The finished application is <a href="https://intojs.github.io/architecting-single-page-applications/">here</a> , and the GitHub repository is <a href="https://github.com/intojs/architecting-single-page-applications">here</a> . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/351710/">https://habr.com/ru/post/351710/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351698/index.html">The most common questions on the interview programmer graphics</a></li>
<li><a href="../351700/index.html">Trends in outsourcing. Forecast for 2020</a></li>
<li><a href="../351704/index.html">History of ES6 Modules</a></li>
<li><a href="../351706/index.html">Learn OpenGL. Lesson 4.11 - Smoothing</a></li>
<li><a href="../351708/index.html">Preview RamblerFront & # 4</a></li>
<li><a href="../351712/index.html">Security Week 9: Miner eliminates competitors, snapshots for traffic lights and extremely intrusive cameras</a></li>
<li><a href="../351714/index.html">Evil by Design: interfaces from Mephistopheles (part two)</a></li>
<li><a href="../351716/index.html">The conference program of the Neurodata Lab and ITMO for Emotion AI, St. Petersburg, March 30</a></li>
<li><a href="../351718/index.html">March 24, Moscow - CocoaHeads Special Event</a></li>
<li><a href="../351720/index.html">Change management</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>