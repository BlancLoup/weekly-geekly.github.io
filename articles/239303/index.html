<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How not to calculate the matrix exponent</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Post is written under the influence of post user pchelintsev_an . 

 In this article I will try to tell you what computational difficulties can be enc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How not to calculate the matrix exponent</h1><div class="post__text post__text-html js-mediator-article">  <em>Post is written under the influence of <a href="http://habrahabr.ru/post/233587/">post</a> user <a href="https://habrahabr.ru/users/pchelintsev_an/" class="user_link">pchelintsev_an</a> .</em> <br><br>  In this article I will try to tell you what computational difficulties can be encountered if we go along the ‚Äúnaive‚Äù way of calculating the matrix exponent.  The article may be useful to those who would like to get acquainted with computational mathematics, but already familiar with such concepts as the system of ordinary differential equations and the Cauchy problem.  The experiments were conducted using the <a href="https://www.gnu.org/software/octave/">GNU Octave</a> system. <br><a name="habracut"></a><br><h4>  What is the matrix exponent in general and what is it used for? </h4><br>  The matrix exponential arises when considering the Cauchy problem for a linear system of ordinary differential equations with constant coefficients: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5d1/b27/a5d/5d1b27a5d83bf87d88ad06f5acc35fd5.gif" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Sometimes such systems arise after partial discretization of partial differential equations, for example, in finite element methods.  Then the matrix A is some finite-dimensional approximation of the differential operator.  As a consequence, the number of rows of matrix A can easily reach thousands, millions and even several billions.  Such matrices cannot even be stored as a square array, so they are stored in special <a href="https://en.wikipedia.org/wiki/Sparse_matrix">sparse</a> presentation formats. <br><br>  The solution to the ODE system can be written explicitly: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eab/5a0/914/eab5a0914aace7539e2157a70ba155cc.gif" alt="image"><br><br>  Here a matrix exponent appears, which is defined as the sum of a series <br><br><img src="https://habrastorage.org/getpro/habr/post_images/460/ce2/a35/460ce2a35820f0b3a01185dd790af5c6.gif" alt="image"><br><br>  In fact, the matrix exponent is obtained by the formal substitution of the matrix A into the Taylor series for e <sup>z</sup> (The <em>mathematician notes that the series converges absolutely for any matrix and any t</em> ).  Conveniently, using the matrix exponential, one can calculate the solution at any time moment t.  For example, if this system is solved by some method of numerical integration, for example, <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%2590%25D0%25B4%25D0%25B0%25D0%25BC%25D1%2581%25D0%25B0">Adams</a> or <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25A0%25D1%2583%25D0%25BD%25D0%25B3%25D0%25B5_%25E2%2580%2594_%25D0%259A%25D1%2583%25D1%2582%25D1%2582%25D1%258B">Runge-Kutta</a> , then the elapsed time will be proportional to time t.  However, the solution through the matrix exponential is possible only for autonomous systems with constant coefficients. <br><br>  In the course of differential equations for practical calculations of the matrix exponential, a method is proposed for reducing the matrix to <a href="https://ru.wikipedia.org/wiki/%25D0%2596%25D0%25BE%25D1%2580%25D0%25B4%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25B0_%25D0%25BC%25D0%25B0%25D1%2582%25D1%2580%25D0%25B8%25D1%2586%25D0%25B0">Jordan form</a> : if matrix A is represented as SJS <sup>-1</sup> , where J is the Jordan form, S is the transition matrix to the Jordan basis, then the matrix exponent A is expressed through the matrix exponent J : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2e3/fdc/bee/2e3fdcbee6e4320b620e60994303918f.gif" alt="image"><br><br>  The matrix exponent of the Jordan matrix J is written out explicitly.  However, this method requires the calculation of the system of eigenvectors, as well as vectors attached to them.  This task is much more difficult than the original one.  Moreover, even for a real matrix A, its Jordan form J can be complex. <br><br><h4>  Summation series </h4><br>  So, we have an infinite series and the desire to calculate it in the foreseeable time.  The obvious way is to finish the summation on some term, discarding the remainder.  In this case, the summation of the series ends if the next kth term in the norm is small: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c2e/d3d/c63/c2ed3dc632cd9ef9221b8c98284d1a8d.gif" alt="image"><br><br><h5>  Matrix norms </h5><br>  Let us briefly dwell on the norm of the matrix.  There are quite a few different norms of the matrix.  You can enter a rate based on the requirement <br><img src="https://habrastorage.org/getpro/habr/post_images/79e/c3d/b8b/79ec3db8b1fec1fd455a17d387fc4464.gif" alt="image"><br><br>  In this case, we speak about the norm of the matrix induced (or subordinate) to some vector norm.  For the most commonly used vector norms, the corresponding matrix norms are of the form: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c02/d43/2ef/c02d432ef76f937f3ced1da53144a30c.gif" alt="image"><br><br>  The first two norms of the matrix are considered elementary, and for the latter, it is required to calculate the singular number, which is very difficult.  In addition to induced norms, there are a number of other norms.  The Frobenius norm is practically convenient, which, on the one hand, is easily calculated, and on the other hand, it is closely related to the singular numbers A. In fact, this is the Euclidean norm of the vector obtained by ‚Äústretching‚Äù the matrix into one row: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d5/d74/060/6d5d74060d3499dd03fd212301368468.gif" alt="image"><br><br><h4>  Surprises in the summation series </h4><br>  To understand the difficulties that arise when summing up the Taylor series, it is not necessary to refer to the matrix exponent example.  Let us simply try to plot the e <sup>-x</sup> function on the interval [0, 50], summing up in the same way the Taylor series for the exponent.  Summation is completed if the next addendum does not exceed 10 <sup>-20</sup> .  Let's use the following code on Octave: <br><br><pre><code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[y]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myexp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, eps)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xk</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ones</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(size(x)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xk</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> = 0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xk</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xk</span></span></span><span class="hljs-function"> .* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function"> / </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function"> + </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xk</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">until</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(max(abs(xk)</span></span></span><span class="hljs-function">) &lt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eps</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">linspace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0, 50, 2000)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myexp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(-x, 1e-20)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, 'b', x, exp(-x)</span></span></span><span class="hljs-function">, '</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function">'); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">axis</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([0 50 -0.1 1.1])</span></span></span><span class="hljs-function">;</span></span></code> </pre> <br>  The result is rather strange: <br><br><br><br>  At x&gt; 30, the graph of the function starts to behave erratically and has nothing to do with the exponent. <br><br>  The reason for this effect is in the accumulation of rounding errors.  For example, in calculating e <sup>-35</sup> , 132 terms were summed, of which the minimum absolute value was the last term s <sub>132</sub> ‚âà 5.8674 ¬∑ 10 <sup>-21</sup> , and the maximum absolute value had the term 35: s <sub>35</sub> ‚âà -1.067 ¬∑ 10 <sup>14</sup> .  Since Octave performs calculations with double precision (about 16 significant digits), the rounding of the 35th term has already introduced an error of the order of 0.01, which significantly exceeds the value œµ = 10 <sup>-20</sup> and the value of the sum of the series e <sup>-35</sup> ‚âà 6.305 ¬∑ 10 <sup>-16</sup> <br><br>  Is the Taylor series so hopeless?  No, rounding errors will not make a significant contribution if the sum of the summable terms does not reach such huge values.  For example, such an algorithm will work reliably with small values ‚Äã‚Äãof x (| x | ‚â≤ 1).  For the matrix exponent, the similar condition is <img src="http://latex.codecogs.com/gif.latex?%5C%7Ct%5Cmathbf%7BA%7D%5C%7C%20%5Clesssim%201" alt="image">  .  In addition to computational stability, such a choice of x ensures fast convergence, that is, it suffices to take only a few terms from the series to obtain acceptable accuracy. <br><br><h4>  Argument Doubling Method </h4><br>  Note that the matrix exponent satisfies the following relation: <br><br><img src="http://latex.codecogs.com/gif.latex?e%5E%7Bt%5Cmathbf%7BA%7D%7D%3D%5Cleft%28%20e%5E%7B%5Cfrac%7Bt%7D%7BN%7D%5Cmathbf%7BA%7D%7D%20%5Cright%20%29%5EN" alt="image"><br><br>  This means that the matrix exponent can be calculated for the matrix <img src="http://latex.codecogs.com/gif.latex?%5Cfrac%7Bt%7D%7BN%7D%5Cmathbf%7BA%7D" alt="image">  and then raise the result to the power of N. Taking as N = 2 <sup>p,</sup> you can use the fast exponentiation algorithm for p matrix multiplications: <br><br><ol><li>  Calculate matrix exponent <img src="http://latex.codecogs.com/gif.latex?%5C%5C%5Cmathbf%7BB%7D%20%3A%3D%20%5Cexp%5Cleft%5C%7B%5Cfrac%7Bt%7D%7B2%5Ep%7D%5Cmathbf%7BA%7D%5Cright%5C%7D" alt="image"></li><li>  Multiply B by yourself <img src="http://latex.codecogs.com/gif.latex?%5Cmathbf%7BB%7D%20%3A%3D%20%5Cmathbf%7BB%7D%20%5Ccdot%20%5Cmathbf%7BB%7D" alt="image">  by repeating this operation p times </li><li>  As a result <img src="http://latex.codecogs.com/gif.latex?e%5E%7Bt%5Cmathbf%7BA%7D%7D%20%3D%20%5Cmathbf%7BB%7D" alt="image"></li></ol><br>  The number p can (and should) be chosen from considerations of computational stability of step 1 of the algorithm, that is, <br><img src="http://latex.codecogs.com/gif.latex?p%20%3D%20%5Clceil%5Clog_2%20%5C%7Ct%5Cmathbf%7BA%7D%5C%7C%5Crceil" alt="image"><br><br>  Corresponding Octave code: <br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[B]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">taylorexp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t, A, eps, max_terms)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eye</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(size(A)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ak</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> = 0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">while</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">norm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Ak, 'fro')</span></span></span><span class="hljs-function"> &gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eps</span></span></span><span class="hljs-function"> &amp;&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> &lt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">max_terms</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ak</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t / k)</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ak</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function"> + </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ak</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[B]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">argdbl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t, A, eps, max_terms)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ceil</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(log2(abs(t)</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">norm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(A, 'fro')</span></span></span><span class="hljs-function">)); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">taylorexp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t / pow2(p)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eps</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">max_terms</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function"> = 1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br><br><h4>  Pade approximation method </h4><br>  A segment of the Taylor series is not the only way to approximately calculate the value of a function.  Better approximations of a function can be obtained not in the form of polynomials, but in the form of rational functions.  The best approximations in the form of a ratio of two polynomials of given degrees are called <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BF%25D0%25BF%25D1%2580%25D0%25BE%25D0%25BA%25D1%2581%25D0%25B8%25D0%25BC%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F_%25D0%259F%25D0%25B0%25D0%25B4%25D0%25B5">Pade approximants</a> .  For example, the Pad√© approximation by the ratio of two quadratic polynomials for the exponent is written as: <br><br><img src="http://latex.codecogs.com/gif.latex?e%5Ez%20%5Capprox%20%5Cfrac%7B1%20&amp;plus;%20%5Cfrac%7Bz%7D%7B2%7D%20&amp;plus;%20%5Cfrac%7Bz%5E2%7D%7B12%7D%7D%7B1%20-%20%5Cfrac%7Bz%7D%7B2%7D%20&amp;plus;%20%5Cfrac%7Bz%5E2%7D%7B12%7D%7D" alt="image"><br><br>  A similar approximation for the matrix exponential will be: <br><br><img src="http://latex.codecogs.com/gif.latex?e%5E%7Bt%5Cmathbf%7BA%7D%7D%20%5Capprox%20%5Cleft%28%5Cmathbf%7BE%7D%20-%20%5Cfrac%7Bt%7D%7B2%7D%5Cmathbf%7BA%7D%20&amp;plus;%20%5Cfrac%7Bt%5E2%7D%7B12%7D%5Cmathbf%7BA%7D%5E2%20%5Cright%20%29%5E%7B-1%7D%20%5Cleft%28%5Cmathbf%7BE%7D%20&amp;plus;%20%5Cfrac%7Bt%7D%7B2%7D%5Cmathbf%7BA%7D%20&amp;plus;%20%5Cfrac%7Bt%5E2%7D%7B12%7D%5Cmathbf%7BA%7D%5E2%20%5Cright%20%29" alt="image"><br><br>  Pad√© approximants can be used for step 1 in the doubling algorithm.  The main difficulty associated with Pade approximants is the need to invert the matrix once.  For large matrices, this can be quite laborious. <br><br><h4>  Accuracy analysis </h4><br>  How to make sure the matrix exponent is calculated correctly?  Is it enough that <img src="http://latex.codecogs.com/gif.latex?%5C%7Ce%5E%7Bt%5Cmathbf%7BA%7D%7D%20-%20%5Cmathbf%7BB%7D%5C%7C%20%3C%20%5Cvarepsilon" alt="image">  Or is a more ‚Äúintelligent‚Äù check required? <br><br>  Recall that the matrix exponent arose not on level ground, but as a result of solving a certain system of ordinary differential equations.  The eigenvalues ‚Äã‚Äãof the matrix A characterize the rates of the processes occurring in the system described by this system of differential equations.  For example, the matrix: <br><br><img src="http://latex.codecogs.com/gif.latex?%5Cmathbf%7BA%7D%20%3D%20%5Cbegin%7Bpmatrix%7D%20-1000%20%26%200%20%26%200%5C%5C0%20%26%200%20%26%201%20%5C%5C%200%20%26%20-1%20%26%200%20%5Cend%7Bpmatrix%7D" alt="image"><br><br>  describes a system with one rapidly decaying process (eigenvalue -1000) and two oscillatory processes (eigenvalues ‚Äã‚Äã¬± <em>i</em> ).  A good criterion for the correctness of the calculation of the matrix exponent can be the ratio: <br><br><img src="http://latex.codecogs.com/gif.latex?%5Clambda%28e%5E%7Bt%5Cmathbf%7BA%7D%7D%29%20%3D%20e%5E%7Bt%5Clambda%28%5Cmathbf%7BA%7D%29%7D" alt="image"><br>  connecting the eigenvalues ‚Äã‚Äãof the matrix A and its matrix exponent. <br><br><h4>  Computational experiment </h4><br>  To begin with, we investigate algorithms for performance on random matrices of different sizes.  As methods, we use the Taylor series summation method, the argument doubling method, and the <b>expm</b> function built into Octave.  Initially, we also wanted to compare the correspondence of eigenvalues, but this idea had to be abandoned, since all three algorithms equally failed this check with matrix sizes N ‚â≥ 50. Perhaps the culprit was the <b>eig</b> eigenvalue determination function that <b>does</b> not work accurately or the conditionality of the eigenvalue definition problem itself values ‚Äã‚Äãfor these matrices. <br><br><br><br>  Based on the graph, the doubling method works about twice as long as the library function (it may be worthwhile to weaken the exaggerated accuracy requirement), while direct summation has even a different asymptotic ‚âàO (N <sup>3.7</sup> ), while the others have the asymptotic O (N <sup>3</sup> ). <br><div class="spoiler">  <b class="spoiler_title">Speed ‚Äã‚ÄãTesting Code</b> <div class="spoiler_text"><pre> <code class="matlab hljs">tries = <span class="hljs-number"><span class="hljs-number">10</span></span>; N = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> N &lt; <span class="hljs-number"><span class="hljs-number">1000</span></span> taylortime = <span class="hljs-number"><span class="hljs-number">0</span></span>; dbltime = <span class="hljs-number"><span class="hljs-number">0</span></span>; expmtime = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> it = <span class="hljs-number"><span class="hljs-number">1</span></span>:tries A = <span class="hljs-built_in"><span class="hljs-built_in">rand</span></span>(N); A = <span class="hljs-number"><span class="hljs-number">0.5</span></span> * (A + A'); tic; B2 = argdbl(<span class="hljs-number"><span class="hljs-number">1</span></span>, A, <span class="hljs-number"><span class="hljs-number">1e-20</span></span>, <span class="hljs-number"><span class="hljs-number">1e10</span></span>); dbltime = dbltime + toc; tic; B3 = expm(A); expmtime = expmtime + toc; tic; B1 = taylorexp(<span class="hljs-number"><span class="hljs-number">1</span></span>, A, <span class="hljs-number"><span class="hljs-number">1e-20</span></span>, <span class="hljs-number"><span class="hljs-number">1e10</span></span>); taylortime = taylortime + toc; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> taylortime = <span class="hljs-number"><span class="hljs-number">1e3</span></span> * taylortime / tries; dbltime = <span class="hljs-number"><span class="hljs-number">1e3</span></span> * dbltime / tries; expmtime = <span class="hljs-number"><span class="hljs-number">1e3</span></span> * expmtime / tries; printf(<span class="hljs-string"><span class="hljs-string">'%d,%f,%f,%f\n'</span></span>, N, taylortime, dbltime, expmtime); fflush(stdout); N = <span class="hljs-built_in"><span class="hljs-built_in">round</span></span>(N * <span class="hljs-number"><span class="hljs-number">1.25</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br></div></div><br><br>  Next, let's check how the algorithm works with large eigenvalues.  Consider the following system of ordinary differential equations: <br><br><img src="http://latex.codecogs.com/gif.latex?%5C%5Cx_1%27%28t%29%20%3D%20-500%20x_1%28t%29%20&amp;plus;%20500%20x_2%28t%29%20&amp;plus;%20x_3%28t%29%20%5C%5Cx_2%27%28t%29%20%3D%20500%20x_1%28t%29%20-%20500%20x_2%28t%29%20&amp;plus;%20x_3%28t%29%20%5C%5Cx_3%27%28t%29%20%3D%20-x_1%28t%29%20-%20x_2%28t%29" alt="image"><br>  With the initial condition: <br><br><img src="http://latex.codecogs.com/gif.latex?%5Cmathbf%7Bx%7D%20%3D%20%5Cbegin%7Bpmatrix%7D1%20%260%26%201%20%5Cend%7Bpmatrix%7D%5E%5Cmathsf%7BT%7D" alt="image">  . <br><br>  Its peculiarity is that one of its eigenvalues ‚Äã‚Äãis -1000 (a rapidly decaying solution), and the other two are equal to ¬± <em>i</em> ‚àö2 (oscillatory solutions).  If the imaginary eigenvalues ‚Äã‚Äãare distorted, it will be clearly visible.  Take the time step œÑ = 0.038, find the matrix exponent <img src="http://latex.codecogs.com/gif.latex?%5Cmathbf%7BB%7D%20%3D%20e%5E%7B%5Ctau%20%5Cmathbf%7BA%7D%7D" alt="image">  different ways.  The solution of the system on the grid with step œÑ is obtained by the following simple algorithm: <br><ol><li>  The initial solution is known from the initial condition. </li><li>  Knowing the solution u <sub>n</sub> at time t <sub>n</sub> , the solution at time t <sub>n + 1</sub> = t <sub>n</sub> + œÑ is obtained from it by multiplying by the matrix exponent B: <br><br><img src="http://latex.codecogs.com/gif.latex?%5Cmathbf%7Bu%7D_%7Bn&amp;plus;1%7D%20%3D%20%5Cmathbf%7BB%7D%20%5Cmathbf%7Bu%7D_n" alt="image"><br></li><li>  Repeat the second point until the end of the integration segment is reached. </li></ol><br>  Let's look at the obtained numerical trajectories (only the first component of the vector is displayed): <br><br><br><br>  All trajectories, except those obtained by direct summation of the Taylor series, visually coincide.  Please note that the graph does not go out of the initial condition x <sub>1</sub> (0) = 1. In fact, the graph exponentially approaches the point y = 1, just the characteristic ‚Äúrotation‚Äù of the graph (‚àº 1/1000) is much less than the time step œÑ = 0.038. <br><div class="spoiler">  <b class="spoiler_title">TAC decision code</b> <div class="spoiler_text"><pre> <code class="matlab hljs">mu = <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[B]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trueexp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t, mu)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ (exp(-mu*t) + cos(sqrt(2)*t))/2.,(-exp(-mu*t) + cos(sqrt(2)*t))/2.,sin(sqrt(2)*t)/sqrt(2); (-exp(-mu*t) + cos(sqrt(2)*t))/2.,(exp(-mu*t) + cos(sqrt(2)*t))/2.,sin(sqrt(2)*t)/sqrt(2); -(sin(sqrt(2)*t)/sqrt(2)),-(sin(sqrt(2)*t)/sqrt(2)),cos(sqrt(2)*t); ]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[-mu/2, mu/2, 1; mu/2, -mu/2, 1; -1, -1, 0]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t</span></span></span><span class="hljs-function"> = 0:.038:100; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[1 0 1]</span></span></span><span class="hljs-function">'; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B1</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trueexp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t(2)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mu</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B2</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">expm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t(2)</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B3</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">taylorexp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t(2)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function">, 1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-function">-20, 1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e10</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B4</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">argdbl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t(2)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function">, 1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-function">-20, 1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e10</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y1</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y2</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y3</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y4</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function"> = 2:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y1</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B1</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y1</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y2</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B2</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y2</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y3</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B3</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y3</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y4</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B4</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y4</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('%f', t(i)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y1</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(' %e %e %e', y(1)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y2</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(' %e %e %e', y(1)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y3</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(' %e %e %e', y(1)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y4</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(' %e %e %e', y(1)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('\n')</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Why such a strange time step</b> <div class="spoiler_text">  All the norms of the matrix A have a magnitude of about 1000. Accordingly, the norm of the matrix œÑA will be about 38. This value corresponds to the area (see the graph for the e <sup>-x</sup> function above), where rounding errors become significant when using the Taylor series head-on summation.  If you take a step more, errors will grow catastrophically, the solution will quickly go beyond the digit capacity, if you take a step smaller, the effect will not be so noticeable. <br></div></div><br><br>  We can say that the example is synthetic, and in practice it will not occur, however it is not.  There are many so-called <a href="https://ru.wikipedia.org/wiki/%25D0%2596%25D1%2591%25D1%2581%25D1%2582%25D0%25BA%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0">rigid Cauchy problems</a> , which are characterized by a strong scatter of eigenvalues ‚Äã‚Äã(in fact, the speeds of physical processes). <br><br><h4>  Further reading </h4><br>  About various ways of calculating the matrix exponential can be found in the article (eng.) [2].  A wonderful two-volume book has been written on the methods for solving ordinary differential equations and rigid problems [3,4] <br><br><h4>  List of used sources </h4><br><ol><li>  <em>Fedorenko R.P.</em>  <a href="http://inis.jinr.ru/sl/Simulation/%25D0%25A4%25D0%25B5%25D0%25B4%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BD%25D0%25BA%25D0%25BE%2520%25D0%25A0.,%2520%25D0%2592%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5%2520%25D0%25B2%2520%25D0%25B2%25D1%258B%25D1%2587%25D0%25B8%25D1%2581%25D0%25BB%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D1%2583%25D1%258E%2520%25D1%2584%25D0%25B8%25D0%25B7%25D0%25B8%25D0%25BA%25D1%2583,%25201994.pdf">Introduction to computational physics.</a>  M .: Publishing House of Moscow.  Phys.-tech.  in-that, 1994. - 528.  ¬ß 17 </li><li>  <em>Cleve Moler and Charles</em> <a href="http://libgen.org/scimag5/10.1137/S00361445024180.pdf">Nineteen of the Matrix, Twenty-Five Years Later</a> // SIAM Rev., 45 (1), 3‚Äì49.  (47 pages) </li><li>  <em>Heirer E., Nersett S., Vanner G.</em> The solution of ordinary differential equations.  Non-rigid tasks.  M .: Mir, <br>  1990. - 512 s. </li><li>  <em>Hayrer E., Vanner G.</em> Solution of ordinary differential equations.  Hard and differential algebraic problems.  M .: Mir, 1999. - 685 p. </li></ol></div><p>Source: <a href="https://habr.com/ru/post/239303/">https://habr.com/ru/post/239303/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../239291/index.html">‚ÄúBleed the mind. Inexpensive. Is there any sense of a mask for lucid dreams?</a></li>
<li><a href="../239293/index.html">New free courses virtual academy Microsoft Virtual Academy, October 2014</a></li>
<li><a href="../239295/index.html">The history of the development of Xenonauts - an independent remake of X-COM</a></li>
<li><a href="../239297/index.html">Hey iCloud, where are my notes?</a></li>
<li><a href="../239299/index.html">RTMFP protocol overview</a></li>
<li><a href="../239305/index.html">Exploit source code for ‚Äúunrecoverable‚Äù vulnerability in USB devices published on GitHub</a></li>
<li><a href="../239307/index.html">Festival 404: first impressions</a></li>
<li><a href="../239311/index.html">Linux internal device or how Linux works</a></li>
<li><a href="../239313/index.html">Request to extend the free version of SaaS is a bad sign</a></li>
<li><a href="../239315/index.html">Three Nicholas, or how I came up with the service for Eycharov</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>