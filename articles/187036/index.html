<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Where did the user blocking policy go?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At one point, the administrator decides to make sure that the user blocking policy works on all domain controllers. On the domain controller, rsop.msc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Where did the user blocking policy go?</h1><div class="post__text post__text-html js-mediator-article">  At one point, the administrator decides to make sure that the user blocking policy works on all domain controllers.  On the domain controller, rsop.msc runs and gives the administrator the expected picture: <br><img src="https://habrastorage.org/storage2/4c9/605/68a/4c960568a5655d8a8aa27cbe61005707.png"><br>  But on the second admin server, a light shock lurks: <br><img src="https://habrastorage.org/storage2/052/9e4/3d3/0529e43d308c9114272707f6894096ad.png"><br>  It is worth noting immediately that all servers are in ‚Äúou = Domain Controllers‚Äù and the same policies apply to them.  OS controllers: 2008 R2. <br><br>  I propose to make this little Friday's riddle. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first thought, that in some way the policy was not applied, is immediately dismissed by issuing summary data on the team <br><pre><code class="dos hljs">gpresult /R</code> </pre>  The set of applied policies for all controllers is the same. <br><br>  The morale is finally undermined by the following command: <br><pre> <code class="dos hljs">gpresult /Z /S ad2</code> </pre>  does not mention anything about the ‚ÄúAccount Lockout Policy‚Äù section.  At the same time for the first controller <br><pre> <code class="dos hljs">gpresult /Z /S ad1</code> </pre><br>  lists the section "Account Lockout Policy" with all the parameters. <br><br>  <u>Check your controllers - you may be surprised at the result</u> . <br>  The most interesting thing is that the policy works!  If you try the specified number of times to make a failed entry through the second controller (for example, using an LDAP bind), the user is blocked. <br><br>  I suggest that the community, in the comments, set forth its versions of the reasons for what is happening, as well as suggestions on how to test the performance of the user's blocking policy. <br><br>  In the evening I undertake to lay out the answer to this question in any case. <br><br>  <b>UPD.</b>  <b>Judging by the number of assumptions in the comments and by voting for this post - the topic is not interesting and it will not be possible to arrange a discussion with ‚Äúdrawing out‚Äù the nuances of AD.</b>  <b>It is a pity, perhaps I would have discovered something new for myself.</b> <br><br><h5>  Since I promised to post the answer </h5><br>  There is a document <a href="http://support.microsoft.com/kb/927908">KB927908</a> in which it is described that on domain controllers running 2003 the RSoP server does not display the established values ‚Äã‚Äãof the part of the policies, namely: <br>  Policies in Computer Configuration / Windows Settings / Security Settings / Account Policies / Password Policy: <br><ul><li>  Enforce password history </li><li>  Maximum password age </li><li>  Minimum password age </li><li>  Minimum password length </li><li>  Password meet meet requirements </li><li>  Store password using reversible encryption for all users in the domain </li></ul><br>  Policies in Computer Configuration / Windows Settings / Security Settings / Account Policies / Account Lockout Policy: <br><ul><li>  Account lockout duration </li><li>  Account lockout threshold </li><li>  Reset account lockout counter after </li></ul><br>  Policies in Computer Configuration / Windows Settings / Security Settings / Local Policies / Security Options: <br><ul><li>  Network Security: Force logoff when logon hours expire </li></ul><br><br>  in practice, I observed the described problem on both 2008 and 2008 R2 servers. <br>  It also indicates that you can use the command line utility to view the current policy on domain controllers without the role of the PDC emulator: <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">net</span></span> accounts /domain</code> </pre><br><br><h5>  Features of applying policies on DC </h5><br>  Regarding the peculiarities of the policy of blocking users, you should also read document <a href="http://support.microsoft.com/kb/259576/en-us">KB259576</a> , which says that some of the settings on domain controllers are applied <u>only from policies that are tied to the domain root.</u>  And the user blocking policy is included in this list. <br><br><h5>  What is the special role of the PDC emulator in applying user blocking policies? </h5><br>  First of all, how the policy is implemented - in fact, when determining the criteria for blocking a user, DC takes parameters from the attributes of the domain object. <br><img src="https://habrastorage.org/storage2/ad4/dda/4f2/ad4dda4f232428970afd9918a668d830.png"><br>  So when applying the policy, these values ‚Äã‚Äãin the attributes are set by the controller with the role of the PDC emulator. <br>  About this you can read an <a href="http://agorbunov.blogspot.ru/2011/12/group-policy.html">interesting detective story</a> . <br><br>  Perhaps this is why RSoP does not display this policy on other controllers ‚Äî they do not need it ‚Äî they have parameters in the directory. </div><p>Source: <a href="https://habr.com/ru/post/187036/">https://habr.com/ru/post/187036/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../187026/index.html">Exporting a drawing from 2D Compass to SVG</a></li>
<li><a href="../187028/index.html">Cyber ‚Äã‚ÄãSecurity. Weekly Review July 8 - July 14, 2013</a></li>
<li><a href="../187030/index.html">Finnish startup Uniqul opens a payment system based on face recognition</a></li>
<li><a href="../187032/index.html">Webmaster! Have you paid Google AdSense tax?</a></li>
<li><a href="../187034/index.html">ETegro Hyperion RS430 G4 - ready for Big Data</a></li>
<li><a href="../187038/index.html">Texts for online stores</a></li>
<li><a href="../187040/index.html">Scientific and educational comics for children</a></li>
<li><a href="../187044/index.html">Search all AD user groups by LDAP protocol</a></li>
<li><a href="../187046/index.html">Adding synchronized transcription text to HTML5 video</a></li>
<li><a href="../187052/index.html">8 things that a developer should not be afraid of</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>