<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Get network folder reports using PowerShell</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jeffrey Hicks has published another article on PowerShell, this time dedicated to managing file servers. We decided to break it into two parts: buildi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Get network folder reports using PowerShell</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/storage2/552/fb0/ecc/552fb0ecc229f4d58aa660ef7008b1f2.png">  Jeffrey Hicks has published another article on PowerShell, this time dedicated to managing file servers.  We decided to break it into two parts: building reports on the file server and directly managing file balls.  In the first part, we consider the reports. <br>  The post will address the following questions: <br><ul><li>  How to display a list of all network folders on the computer (s) </li><li>  Create reports on the size of network folders </li><li>  Determine file ownership </li><li>  We find the date of creation of files. We reveal ‚Äúold‚Äù files and files created over a certain period of time. </li></ul><br>  So, under the cut, you will find the translation of the article <a href="http://www.windowsitpro.com/content1/topic/windows-powershell-file-server-management-143789/catpath/windows-powershell/">File Server Management with Windows PowerShell</a> . <br><a name="habracut"></a><br><br><h4>  Get all network folders </h4><br>  To begin with, we define what is shared.  The task is simple: we simply query the Win32_Share class to use Windows Management Instrumentation (WMI).  You do not even need to log in to the file server.  You can run this command from anywhere. <br><br><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-WmiObject -<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> -Win32_Share -computername chi-fp01</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Instead of chi-fp01, specify the name of the computer that interests us. <br><br>  By running this command you will receive all network folders, including printers (if any).  But since we are talking about file balls, let's limit the query.  All Win32_Share instances have a Type property, as shown in Table 1. <br><img src="https://habrastorage.org/storage2/8e2/bc0/881/8e2bc0881ca66fbed899e367f4d54f17.jpg"><br><br>  Add a filter to the original command: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-WmiObject -<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> -Win32_Share -computername chi-fp01 ‚Äì<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> <span class="hljs-string"><span class="hljs-string">"Type=0"</span></span></code> </pre><br><br>  Thus, we display only the necessary information. <br><br><img src="https://habrastorage.org/storage2/e1c/255/fbe/e1c255fbef15b4b9be369d3cb0296116.jpg"><br><br>  But if you are also looking for hidden folders - those that end with a dollar sign ($) - the filter will have to be slightly rewritten: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-WmiObject -<span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> win32_share -computername chi-fp01 ‚Äì<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> <span class="hljs-string"><span class="hljs-string">"Type=0 AND name like '%$'"</span></span></code> </pre><br><br>  In WMI, a percent sign (%) is used instead of a wildcard.  Print all folders except those that are hidden a little more difficult. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-WmiObject -<span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> win32_share -computername chi-fp01‚Äì<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> <span class="hljs-string"><span class="hljs-string">"type=0 AND name like '%[^$]'"</span></span></code> </pre><br><br>  The command <b>displays</b> all <b>Win32_Share</b> objects whose <b>Type</b> property is 0 and the name does not end with $. <br><br><h4>  Get the size of the network folder </h4><br><br>  Quite often, information is needed on how much space the file balls take.  Use <b>Get-ChildItem</b> , or its abbreviation <b>dir</b> , and pass the results to <b>Measure-Object</b> : <br><br><pre> <code class="vbscript hljs">dir c:\shares\<span class="hljs-keyword"><span class="hljs-keyword">public</span></span> -recurse | where {-<span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> $_.PSIsContainer}| Measure-Object -<span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> length -Sum -Minimum -Maximum</code> </pre><br><br>  As a result, you will receive information on the total number of objects, size in bytes, the smallest and largest file sizes.  In the previous command, applied the filter.  In PowerShell 3.0, the same thing can be made easier, but the command I used works both v2.0 and 3.0.  It is best run locally.  The code in Example 1 combines this command with our WMI technique to get a report on the size of the high-level folders. <br><br>  <b>Example 1: Report on the size of high-level network folders</b> <br><br><pre> <code class="vbscript hljs">$share=<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-WmiObject -<span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Win32_Share -ComputerName CHI-FP01 -<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> <span class="hljs-string"><span class="hljs-string">"name='Sales'"</span></span> $sb={ Param ($path) dir $path | where {$_.PSIscontainer} | foreach { $stats=dir $_.Fullname -recurse -errorAction <span class="hljs-string"><span class="hljs-string">"SilentlyContinue"</span></span> | where {-<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> $_.PSIscontainer} | Measure-object -<span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Length -sum <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>-Object -<span class="hljs-built_in"><span class="hljs-built_in">TypeName</span></span> PSObject -<span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> @{ Computername=$env:Computername Path=$_.Name Fullname=$_.Fullname SizeKB=[math]::<span class="hljs-built_in"><span class="hljs-built_in">Round</span></span>(($stats.sum/<span class="hljs-number"><span class="hljs-number">1</span></span>KB),<span class="hljs-number"><span class="hljs-number">2</span></span>) NumberFiles=$stats.count } #<span class="hljs-keyword"><span class="hljs-keyword">property</span></span> } #foreach } #sb $results=Invoke-Command -ScriptBlock $sb -ComputerName $share.__SERVER -ArgumentList @($share.path) -HideComputerName</code> </pre><br><br>  You can format or process <b>$ results</b> as your heart desires.  Need a digestible table?  Just use the following command: <br><br><pre> <code class="vbscript hljs">$results | Format-Table Computername,Fullname,SizeKB,NumberFiles -autosize</code> </pre><br><br><img src="https://habrastorage.org/storage2/a4b/100/905/a4b100905fc5a858528fd8a5761b105e.jpg"><br><br>  Thus, it is possible to make a full report on the use of all folders on the file server.  Save time, use example 2. <br><br>  <b>Example 2: Report on the use of file sphere</b> <br><br><pre> <code class="vbscript hljs">$sb={ #<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> the file shares locally. $shares=<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-WmiObject -<span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Win32_Share -<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> <span class="hljs-string"><span class="hljs-string">"type=0"</span></span> foreach ($share <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $shares) { #Suppress any access denied <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> messages. Write-Host <span class="hljs-string"><span class="hljs-string">"Measuring $($share.path)"</span></span> -ForegroundColor Green $stats=dir $share.path -Recurse -ErrorAction SilentlyContinue | Where {-<span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> $_.PSIscontainer} | Measure-Object -<span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Length -Sum $hash=@{ Computername=$env:Computername Path=$share.path Share=$share.Name SizeKB=[math]::<span class="hljs-built_in"><span class="hljs-built_in">Round</span></span>(($stats.sum/<span class="hljs-number"><span class="hljs-number">1</span></span>KB),<span class="hljs-number"><span class="hljs-number">2</span></span>) Files=$stats.count } #Write a custom object <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the pipeline <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> share. <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>-Object -<span class="hljs-built_in"><span class="hljs-built_in">TypeName</span></span> PSObject -<span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> $hash } #foreach $share }#sb $results = Invoke-Command -ScriptBlock $sb -ComputerName CHI-FP01 -HideComputerName</code> </pre><br><br>  And again I will slightly format the table. <br><br><pre> <code class="vbscript hljs">$results | sort SizeKB ‚ÄìDescending | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> Computername,Share,SizeKB,Files | ft -auto</code> </pre><br><br><img src="https://habrastorage.org/storage2/2ca/905/cc0/2ca905cc0cd706fb3d2b3dbfe274b538.jpg"><br><br><h4>  Get files by owner </h4><br><br>  Moving on - find the owners of the files.  If you use quotas, reports are likely to get.  Otherwise, all you need to do is extract the ACL of the file that includes the owner and aggregate the results.  It is best to add the owner of the file as a custom property. <br><br><pre> <code class="vbscript hljs">$data=dir | where {-<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> $_.PSIsContainer} | <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> name, @{Name=<span class="hljs-string"><span class="hljs-string">"Owner"</span></span>;Expression={(<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ACL $_.fullname).Owner}}, length</code> </pre><br><br>  We can group by the property of the new owner and then process the new object. <br><br><pre> <code class="vbscript hljs">$data | group owner | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> Name,Count,@{Name=<span class="hljs-string"><span class="hljs-string">"Size"</span></span>;Expression={($_.Group | Measure-Object -<span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Length -sum).Sum}}</code> </pre><br><br>  A couple of efforts and you can apply the same approach to the file ball, as indicated in the code of example 3. <br><br>  <b>Example 3: Group file balls by owner</b> <br><br><pre> <code class="vbscript hljs">$sb={ Param($path) $data=dir $path | where {-<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> $_.PSIsContainer} | <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> name, @{Name=<span class="hljs-string"><span class="hljs-string">"Owner"</span></span>;Expression= {(<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ACL $_.fullname).Owner}},length $data | group -<span class="hljs-keyword"><span class="hljs-keyword">property</span></span> owner | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> @{Name=<span class="hljs-string"><span class="hljs-string">"Computername"</span></span>;Expression={$env:computername}}, @{Name=<span class="hljs-string"><span class="hljs-string">"Path"</span></span>;Expression={$path}},Name,Count,@{Name= <span class="hljs-string"><span class="hljs-string">"Size"</span></span>;Expression={ ($_.Group | Measure-Object -<span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Length -sum).Sum}} } #sb &lt;# Run the command remotely <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> suppress the RunspaceID since we don<span class="hljs-comment"><span class="hljs-comment">'t really need it. #&gt; Invoke-Command -ScriptBlock $sb -ComputerName CHI-FP01 -ArgumentList @("c:\shares\public") -HideComputerName | Select * -ExcludeProperty RunspaceID</span></span></code> </pre><br><br>  I also have to point out that there may be problems: with files whose name is more than 260 characters or contains unusual characters, especially if you are trying to run Get-ACL.  In PowerShell 3.0, this cmdlet has the <b>-LiteralPath</b> parameter, which helps solve the above problems. <br><br>  Again, we derive a readable table. <br><br><pre> <code class="vbscript hljs">$data | Sort Size | ft -auto</code> </pre><br><br><img src="https://habrastorage.org/storage2/d67/ce8/643/d67ce864362abf38301b776ffd87ed59.jpg"><br><br><h4>  Get files by creation date </h4><br><br>  The last reporting technique I want to demonstrate is the creation of a report with the most recently created files.  In fact, we create a collection of objects that we can use in several ways.  You may want to use objects or delete or move files, or you may want to build a report that you can send to management.  Always create PowerShell commands so that you can use them later. <br>  Determining the age of the file is not so easy.  In PowerShell, a file object (file type object) has several properties that you may want to use.  For example, the command: <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-item c:\work\wishlist.txt | Format-List Name,*<span class="hljs-built_in"><span class="hljs-built_in">time</span></span></code> </pre><br>  gives the output shown in the screenshot below. <br><br><img src="https://habrastorage.org/storage2/d32/add/552/d32add55253408388a9c673d3882ab3a.jpg"><br><br>  Personally, I think it's better to use <b>LastWriteTime</b> , which means when the file was last accessed.  I have encountered situations when <b>LastAccessTime was</b> updated through third-party programs, for example, antivirus, which in itself does not mean the truth.  And <b>LastAccessTime has</b> been deactivated since Windows Vista, although you can enable it.  You also need to be careful, because these values ‚Äã‚Äãcan vary depending on whether you copy or move files between disks.  But you can solve it yourself.  Using this file as an example, we can force PowerShell to tell us how old the file is.  See example 4. <br><br>  <b>Example 4. Determining the age of files</b> <br><pre> <code class="vbscript hljs">PS C:\work&gt; <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-item wishlist.txt | format-list name, CreationTime,LastWriteTime, &gt;&gt; @{Name=<span class="hljs-string"><span class="hljs-string">"Age"</span></span>;Expression={(<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>)-$_.LastWriteTime}}, &gt;&gt; @{Name=<span class="hljs-string"><span class="hljs-string">"Days"</span></span>;Expression={((<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>) -$_.LastWriteTime).TotalDays}} &gt;&gt; Name : wishlist.txt CreationTime : <span class="hljs-number"><span class="hljs-number">11</span></span>/<span class="hljs-number"><span class="hljs-number">23</span></span>/<span class="hljs-number"><span class="hljs-number">2010</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">31</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span> PM LastWriteTime : <span class="hljs-number"><span class="hljs-number">2</span></span>/<span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-number"><span class="hljs-number">2011</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">36</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> AM Age : <span class="hljs-number"><span class="hljs-number">511.06</span></span>:<span class="hljs-number"><span class="hljs-number">42</span></span>:<span class="hljs-number"><span class="hljs-number">17.4251748</span></span> Days : <span class="hljs-number"><span class="hljs-number">511.279372271039</span></span></code> </pre><br><br>  The <b>Age</b> property is a <b>TimeSpan</b> object, and the <b>Days</b> property is just the <b>TotalDays</b> property of this object.  But since we can do this for one file, we can do it for others. Let's take a look at my shared folder and find all the files that have not changed in the last 400 days. <br><br><pre> <code class="vbscript hljs">dir c:\shares\<span class="hljs-keyword"><span class="hljs-keyword">public</span></span> -recurse | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> Fullname,CreationTime,LastWriteTime, @{Name=<span class="hljs-string"><span class="hljs-string">"Age"</span></span>;Expression={(<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>)-$_.LastWriteTime}}, @{Name=<span class="hljs-string"><span class="hljs-string">"Days"</span></span>;Expression={[<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>]((<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>) -$_.LastWriteTime).TotalDays}}, @{Name=<span class="hljs-string"><span class="hljs-string">"Owner"</span></span>;Expression={(<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ACL $_.fullname).Owner}} | Where {$_.Days -ge <span class="hljs-number"><span class="hljs-number">400</span></span>} | Sort Days -Descending</code> </pre><br><br>  I will go further and include the file owner.  The screenshot below shows the results from running this code in a remote session on my file server. <br><br><img src="https://habrastorage.org/storage2/87e/a33/27d/87ea3327d602eaca4c27fe3cbd559467.jpg"><br><br>  I can save these results to a variable and use them at any time.  Since I have the full name of the file, transfer to another command, for example, Remove-Item, is not difficult. <br>  One of my favorite techniques is determining how many files were changed in a year. <br><br><pre> <code class="vbscript hljs">dir c:\shares\sales -recurse | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> Fullname,LastWriteTime, @{Name=<span class="hljs-string"><span class="hljs-string">"Age"</span></span>;Expression={(<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>)-$_.LastWriteTime}}, @{Name=<span class="hljs-string"><span class="hljs-string">"Year"</span></span>;Expression={$_.LastWriteTime.<span class="hljs-built_in"><span class="hljs-built_in">Year</span></span>}} | Group-Object <span class="hljs-built_in"><span class="hljs-built_in">Year</span></span> | Sort Name</code> </pre><br><br>  As you can see in the screenshot, everything looks combed.  Need details?  You can analyze the <b>Group</b> property, which is a collection of files. <br><br><img src="https://habrastorage.org/storage2/ff1/75e/6e6/ff175e6e6d6d756c68c440a03ad941b1.jpg"><br><br>  It is useful to know how many files did not change in 30, 90 or 180 days.  Unfortunately, there is no easy way to use <b>Group-Object</b> for this, so I need to "go some other way";  see example 5. <br><br>  <b>Example 5: Determine the period of file changes</b> <br><br><pre> <code class="vbscript hljs">$path=<span class="hljs-string"><span class="hljs-string">"c:\scripts"</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> some other properties <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> we want <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> further #break down <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> bucket. $files=dir $path -recurse | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> Fullname,CreationTime,LastWriteTime,Length, @{Name=<span class="hljs-string"><span class="hljs-string">"Age"</span></span>;Expression={(<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>)-$_.LastWriteTime}}, @{Name=<span class="hljs-string"><span class="hljs-string">"Days"</span></span>;Expression={[<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>]((<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>) -$_.LastWriteTime).TotalDays}} $hash=@{ Path=$path Over= ($files | Where {$_.Days -gt <span class="hljs-number"><span class="hljs-number">365</span></span>} | Measure-Object).Count <span class="hljs-comment"><span class="hljs-comment">'365Days'= ($files | Where {$_.Days -gt 180 -AND $_.Days -le 365} | Measure-Object).Count '180Days'= ($files | Where {$_.Days -gt 90 -AND $_.Days -le 180} | Measure-Object).Count '90Days'= ($files | Where {$_.Days -gt 30 -AND $_.Days -le 90} | Measure-Object).Count '30Days'= ($files | Where {$_.Days -gt 7 -AND $_.Days -le 30} | Measure-Object).Count '7Days'= ($files | Where {$_.Days -gt 0 -AND $_.Days -le 7} | Measure-Object).Count } New-Object -TypeName PSObject -Property $hash | Select Path,Over,365Days,180Days,90Days,30Days,7Days</span></span></code> </pre><br><br>  The figure below shows the result when I ran this code for a folder with my scripts, which, as I know, has a dense age distribution (decent age distribution).  My code does not include actual files, but it would be too difficult to change my example. <br><br><img src="https://habrastorage.org/storage2/777/0db/b81/7770dbb812d3675362c759de0d5513d6.jpg"><br><br>  The post is based on the first part of the article <a href="http://www.windowsitpro.com/content1/topic/windows-powershell-file-server-management-143789/catpath/windows-powershell">File Server Management with Windows PowerShell</a> . <br><br>  Bonus: <br><br>  Speaking of how to find files using PowerShell and WMI, Jeffrey Hicks writes on his blog (part <a href="http://jdhitsolutions.com/blog/2013/01/find-files-with-wmi-and-powershell/">1</a> and <a href="http://jdhitsolutions.com/blog/2013/02/find-files-with-wmi-and-powershell-revisited/">2</a> ). </div><p>Source: <a href="https://habr.com/ru/post/168377/">https://habr.com/ru/post/168377/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168367/index.html">Windows hosting from Amazon Web Services</a></li>
<li><a href="../168369/index.html">Map and GIS components for GitHub developers</a></li>
<li><a href="../168371/index.html">Ultrabook review Acer Aspire S7-391</a></li>
<li><a href="../168373/index.html">Evasi0n under the microscope</a></li>
<li><a href="../168375/index.html">Google Chrome OS experience on the Acer C7 Chromebook</a></li>
<li><a href="../168381/index.html">How we unpacked and installed Wi-Fi Aruba Networks</a></li>
<li><a href="../168383/index.html">Build Symfony2 projects using Jenkins</a></li>
<li><a href="../168385/index.html">"Spy shoes" from O2 is not only for walking</a></li>
<li><a href="../168391/index.html">Do not be fooled by your customers.</a></li>
<li><a href="../168393/index.html">Soloten told about mobile technologies in MIRBIS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>