<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bot for telegram with status in DBMS and text classification</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Since My classifier from the past post still works (however, the parameters out of the box are not always successful, so I rendered the opportunity to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bot for telegram with status in DBMS and text classification</h1><div class="post__text post__text-html js-mediator-article">  Since  My classifier from the <a href="https://habrahabr.ru/post/315118/">past post</a> still works (however, the parameters out of the box are not always successful, so I rendered the opportunity to slightly adjust the Conv1d layers and the hidden layer) - I decided to fasten it to the bot.  Yes, I was late for this HYIP) By the way, I‚Äôll clarify in advance that I haven‚Äôt tried to fasten Russian yet, although this shouldn‚Äôt be a problem - the necessary features are supported in nltk, word2vec training is not conceptually different from English, and pre-trained models seem to be available . <br><br>  Well, immediately there are questions: <br><br><ul><li>  under what platforms to cut it - while decided to stop on the telegram.  In theory, the design makes it easy to add wrappers for other platforms (as if someone would need it) </li><li>  how to describe the "script".  Bike your structure with classes and entities on top of YAML </li><li>  well, it would be nice to store bots / state in some database </li></ul><br><a name="habracut"></a><br><h2>  Requirements </h2><br>  You will need: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <a href="https://bitbucket.org/alex43210/pynlc">pynlc</a> .  Instructions for installing aids (keras, nlkt, gensim and their dependencies) - <a href="https://habrahabr.ru/post/315118/">in my last post</a> </li><li>  <a href="https://bitbucket.org/alex43210/robot">robot</a> </li><li>  <a href="https://bitbucket.org/alex43210/robotframework">robotframework</a> .  You need to put sqlalchemy </li><li>  <a href="https://bitbucket.org/alex43210/robotframework_telegram">robotframework_telegram</a> .  <a href="https://github.com/python-telegram-bot/python-telegram-bot">Python-telegram-bot is required</a> </li></ul><br><h2>  To hell with details, give an example </h2><br><div class="spoiler">  <b class="spoiler_title">Python code</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> robotframework_telegram <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RobotFrameworkTelegram <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> config <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: bots = RobotFrameworkTelegram({ <span class="hljs-string"><span class="hljs-string">'DATABASE_URI'</span></span>: <span class="hljs-string"><span class="hljs-string">'URI'</span></span>, <span class="hljs-string"><span class="hljs-string">'KEEP_WORD_VECTORS'</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">'ROBOT_CONFIGURATIONS'</span></span>: <span class="hljs-string"><span class="hljs-string">'robot_configurations'</span></span>, <span class="hljs-string"><span class="hljs-string">'KEEP_ROBOTS'</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">'OUTPUT_HANDLERS'</span></span>: {}, <span class="hljs-string"><span class="hljs-string">'TOKENS'</span></span>: [ <span class="hljs-comment"><span class="hljs-comment"># Your tokens here ], 'NO_ANSWER_MESSAGE': 'Sorry, I can\'t answer now.', 'NO_INSTANCE_MESSAGE': 'Sorry, robot not instantiated yet. ' + \ 'You\'ll get answer after instantiation - it can take few minutes', 'TELEGRAM_WORKERS_PER_BOT': 1, 'WORKER_COUNT': 2, 'WORKER_SLEEP_TIME': 0.2, 'LOGGER': logging, }) bots.start_polling()</span></span></code> </pre> <br></div></div><br>  For the data (structure and dump of the postgres database, word2vec, the configuration of the trained bot) - <a href="https://drive.google.com/file/d/0B7cY3wBgM-aBRG02RDlPc0t0ejg/view%3Fusp%3Dsharing">here</a> . <br><br><h2>  Script Description </h2><br>  In my case, the bot script can be described as a tree (well, in fact - taking into account "goto" - rather a graph), whose node can contain conditions: <br><br><ul><li>  about the custom text class </li><li>  about the types of entities used </li></ul><br>  In addition to the tree in the script are: <br><br><ul><li>  data for classifier training </li><li>  entity types (conditional {"city": ["Moscow", "Tokeyo", "Ottava"]}) </li><li>  Their synonyms (no less conditional {"Moscow": ["Default city"]}) </li><li>  (optional) additional parameters of the classifier.  For example, in the case of my ‚Äúweather‚Äù example, the network configuration, which will be built according to standard parameters - the worst overkill, because I reduced the number of sizes of filters and neurons of the output layer. </li></ul><br>  for example <br><div class="spoiler">  <b class="spoiler_title">a bunch of yaml</b> <div class="spoiler_text"><pre> <code class="hljs sql">script: text: Hello. I'm weather robot. How can I <span class="hljs-keyword"><span class="hljs-keyword">help</span></span> you? <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">main</span></span> children: - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: city_conditions <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>: <span class="hljs-string"><span class="hljs-string">"Conditions in {%print $city%} is next."</span></span> conditions: <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>: conditions entity_variables: city: $city - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: city_temperature <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>: <span class="hljs-string"><span class="hljs-string">"Temperature in {%print $city%} is next."</span></span> conditions: <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>: temperature entity_variables: city: $city - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: conditions <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>: Okay, <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> city name. conditions: <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>: conditions children: - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: conditions_city_selected <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>: <span class="hljs-string"><span class="hljs-string">"{%goto city_conditions%}"</span></span> conditions: entity_variables: city: $city - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: temperature <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>: Okay, <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> city name. conditions: <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>: temperature children: - <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: temperature_city_selected <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>: <span class="hljs-string"><span class="hljs-string">"{%goto city_temperature%}"</span></span> conditions: entity_variables: city: $city entities: city: - Moscow - Tokyo - Ottava synonyms: Moscow: - <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> city - DC classes: temperature: - How hot <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> it today? - <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> it hot outside? - Will it be uncomfortably hot? - Will it be sweltering? - How cold <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> it today? - <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> it cold outside? - Will it be uncomfortably cold? - Will it be frigid? - What <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the expected <span class="hljs-keyword"><span class="hljs-keyword">high</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> today? - What <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the expected temperature? - Will <span class="hljs-keyword"><span class="hljs-keyword">high</span></span> temperatures be dangerous? - <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> it dangerously cold? - <span class="hljs-keyword"><span class="hljs-keyword">When</span></span> will the heat subside? - <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> it hot? - <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> it cold? - How cold <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> it <span class="hljs-keyword"><span class="hljs-keyword">now</span></span>? - Will we have a cold <span class="hljs-keyword"><span class="hljs-keyword">day</span></span> today? - <span class="hljs-keyword"><span class="hljs-keyword">When</span></span> will the cold subside? - What highs <span class="hljs-keyword"><span class="hljs-keyword">are</span></span> we expecting? - What lows <span class="hljs-keyword"><span class="hljs-keyword">are</span></span> we expecting? - <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> it warm? - <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> it chilly? - What<span class="hljs-string"><span class="hljs-string">'s the current temp in Celsius? - What is the temperature in Fahrenheit? conditions: - Is it windy? - Will it rain today? - What are the chances for rain? - Will we get snow? - Are we expecting sunny conditions? - Is it overcast? - Will it be cloudy? - How much rain will fall today? - How much snow are we expecting? - Is it windy outside? - How much snow do we expect? - Is the forecast calling for snow today? - Will we see some sun? - When will the rain subside? - Is it cloudy? - Is it sunny now? - Will it rain? - Will we have much snow? - Are the winds dangerous? - What is the expected snowfall today? - Will it be dry? - Will it be breezy? - Will it be humid? - What is today'</span></span>s expected humidity? - Will the blizzard hit us? - <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> it drizzling? classifier_params: filter_sizes: [<span class="hljs-number"><span class="hljs-number">1</span></span>] hidden_size: <span class="hljs-number"><span class="hljs-number">100</span></span> nb_filter: <span class="hljs-number"><span class="hljs-number">150</span></span> min_class_confidence: <span class="hljs-number"><span class="hljs-number">0.8</span></span></code> </pre><br></div></div><br>  Switching from one state to another (and at the same time - extracting entities) to another happens like this: <br><br><ul><li>  classify input.  We retrieve the class with the greatest "similarity".  We add its name before the user text.  For example - ‚ÄúHow cold in Moscow now?‚Äù Is converted to ‚Äútemperature How cold in Moscow now?‚Äù </li><li>  we get the child nodes of the current node (by default - main) </li><li>  for each descendant (in order): <br><br><ul><li>  if it imposes restrictions on the class - we check the entry into the class, if it does not enter - go to the next descendant </li><li>  if there are types of entities whose references need to be saved - we check the occurrences of all possible entities (and their synonyms) of this type and save them in the dictionary under the corresponding name.  If not all types are found, go to the next child.  In the process of a ‚Äúpattern‚Äù {‚Äúcity‚Äù: "$ city"} from "what temperature expected in Moscow and Ottava" {"$ city" will be extracted: [‚ÄúMoscow‚Äù, ‚ÄúOttava‚Äù]} </li></ul></li></ul><br><h2>  Under the hood, part 1 </h2><br>  <a href="https://bitbucket.org/alex43210/robot">Awful bitbucket code</a> .  For starters - singled out such entities: <br><br><ul><li>  Classifier  With him, probably, everything seems to be clear </li><li>  Scenario.  It contains complete information about scripts - a tree, a list of classes, a list of entity types, a list of their equivalent names, etc.  <a href="https://bitbucket.org/alex43210/robot/src/c2570efb2af8fe11077b2f466a926be27f44eef4/robot/script.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robot / script.py</a> </li><li>  Script tree node.  Contains data about 1 node - text template, conditions (including class and entities), child elements.  <a href="https://bitbucket.org/alex43210/robot/src/c2570efb2af8fe11077b2f466a926be27f44eef4/robot/script.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robot / script.py</a> </li><li>  The state of the robot.  Includes the name of the current node and the variables selected from user input.  <a href="https://bitbucket.org/alex43210/robot/src/c2570efb2af8fe11077b2f466a926be27f44eef4/robot/robot_state.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robot / robot_state.py</a> </li><li>  Output handler  It can be used, for example, to display the value of a variable (print), go to another node (goto).  <a href="https://bitbucket.org/alex43210/robot/src/c2570efb2af8fe11077b2f466a926be27f44eef4/robot/output_processing.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robot / output_processing.py</a> </li><li>  Robot.  Actually, it connects the classifier, the script and the output handler.  The input has its own state and text, and the output has a new state.  <a href="https://bitbucket.org/alex43210/robot/src/c2570efb2af8fe11077b2f466a926be27f44eef4/robot/robot.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robot / robot.py</a> </li></ul><br>  Now this is possible: <br><br><pre> <code class="python hljs">script = Script.load(os.path.join(os.path.dirname(__file__), <span class="hljs-string"><span class="hljs-string">"script.yaml"</span></span>)) text_processor = TextProcessor(<span class="hljs-string"><span class="hljs-string">"english"</span></span>, [[<span class="hljs-string"><span class="hljs-string">"turn"</span></span>, <span class="hljs-string"><span class="hljs-string">"on"</span></span>], [<span class="hljs-string"><span class="hljs-string">"turn"</span></span>, <span class="hljs-string"><span class="hljs-string">"off"</span></span>]], Word2Vec.load_word2vec_format( os.path.join(os.path.dirname(__file__), <span class="hljs-string"><span class="hljs-string">"100d.txt"</span></span>) )) robot = Robot(script, text_processor) state, output = robot.output() self.assertEqual(output, <span class="hljs-string"><span class="hljs-string">"Hello. I'm weather robot. How can I help you?"</span></span>) self.assertIsNotNone(state) self.assertEqual(state.stage, <span class="hljs-string"><span class="hljs-string">"main"</span></span>) self.assertEqual(state.variables, {}) state, output = robot.answer(state, <span class="hljs-string"><span class="hljs-string">"How cold it'll be in Moscow today?"</span></span>) self.assertIsNotNone(state) self.assertEqual(state.stage, <span class="hljs-string"><span class="hljs-string">"city_temperature"</span></span>) self.assertEqual(state.variables, {<span class="hljs-string"><span class="hljs-string">"$city"</span></span>: [<span class="hljs-string"><span class="hljs-string">"Moscow"</span></span>]}) self.assertEqual(output, <span class="hljs-string"><span class="hljs-string">"Temperature in Moscow is next."</span></span>)</code> </pre><br>  You can already try to run something, but I went further. <br><br><h2>  Wrapper around robot and sqlalchemy.  Yet without telegram </h2><br>  <a href="https://bitbucket.org/alex43210/robotframework">Even more awful bitbucket code</a> .  Again we divide entities: <br><br><ul><li>  Tongue.  Contains a name for nltk and a set of exceptions for cutting stop words.  <a href="https://bitbucket.org/alex43210/robotframework/src/48748769f358a4694080fda8294f6241b2e771ed/robotframework/models/language.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robotframework / models / language.py</a> </li><li>  Subject area.  Contains a link to the language and word2vec, which is trained on the texts of the desired subject area in this language (will be loaded into memory at the first call and unloaded if more than the specified number of word2vec-in is already loaded).  <a href="https://bitbucket.org/alex43210/robotframework/src/48748769f358a4694080fda8294f6241b2e771ed/robotframework/models/domain.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robotframework / models / domain.py</a> </li><li>  Robot.  Contains a reference to the subject area, a script and a reference to the classifier's config (again, the classifier will be created upon the first call. If the classifier is not trained, it will be pre-trained and saved. Unloaded if the corresponding parameter is exceeded).  <a href="https://bitbucket.org/alex43210/robotframework/src/48748769f358a4694080fda8294f6241b2e771ed/robotframework/models/robot.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robotframework / models / robot.py</a> </li><li>  User.  All that is needed from him here is to be uniquely identifiable.  <a href="https://bitbucket.org/alex43210/robotframework/src/48748769f358a4694080fda8294f6241b2e771ed/robotframework/models/user.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robotframework / models / user.py</a> </li><li>  Dialogue.  Just refers to the user and the robot.  <a href="https://bitbucket.org/alex43210/robotframework/src/48748769f358a4694080fda8294f6241b2e771ed/robotframework/models/conversation.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robotframework / models / conversation.py</a> </li><li>  Record dialogue.  It contains its source (robot / user), text and status of the robot.  <a href="https://bitbucket.org/alex43210/robotframework/src/48748769f358a4694080fda8294f6241b2e771ed/robotframework/models/conversation_item.py%3Fat%3Dmaster%26fileviewer%3Dfile-view-default">robotframework / models / conversation_item.py</a> </li><li>  The app is a singleton with all sorts of technical functionality.  Now - initializes sqlalchemy </li></ul><br>  Something like this: <br><br><img src="https://habrastorage.org/files/ff2/641/1b2/ff26411b2e8b4488971270ac1a0d28d1.png"><br><br>  Code example: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> robotframework <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sqlalchemy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> select app = Application({ <span class="hljs-string"><span class="hljs-string">'DATABASE_URI'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'KEEP_WORD_VECTORS'</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span> }) robot = Robot.filter(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> query: query.where(Robot.id == <span class="hljs-number"><span class="hljs-number">1</span></span>))[<span class="hljs-number"><span class="hljs-number">0</span></span>] user = User.filter(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> query: query.where(User.id == <span class="hljs-number"><span class="hljs-number">1</span></span>))[<span class="hljs-number"><span class="hljs-number">0</span></span>] conversation = robot.converse(user) <span class="hljs-comment"><span class="hljs-comment">#print(robot.instance) items = lambda: print([str(item) for item in conversation.items]) items() conversation.output() conversation.answer('How hot it\'ll be in Moscow today?') conversation.answer('Okay, turn off') items()</span></span></code> </pre><br>  Well, as a result: <br><br><pre> <code class="hljs json">[] [<span class="hljs-string"><span class="hljs-string">"Hello. I'm weather robot. How can I help you?"</span></span>, <span class="hljs-string"><span class="hljs-string">"How hot it'll be in Moscow today"</span></span>, <span class="hljs-string"><span class="hljs-string">"Temperature in Moscow is next"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>]</code> </pre> <br>  The last entry is empty, because  in the script there is no node on which to go in this case. <br><br>  In the configuration - the following options: <br><br><pre> <code class="python hljs">{ <span class="hljs-string"><span class="hljs-string">'DATABASE_URI'</span></span> : <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-comment"><span class="hljs-comment"># URI   sqlalchemy   'KEEP_WORD_VECTORS': 3, #       "" word2vec,    ,   ()     'KEEP_ROBOTS': 3, #     'ROBOT_CONFIGURATIONS': 'robot_configurations', # ,     , 'OUTPUT_HANDLERS': {} }</span></span></code> </pre><br>  Now we seem to have all the means for more or less adequate storage of robots, their states and auxiliary data.  And - the ability to fasten them to different messengers (and not only), screwing the appropriate wrapper. <br><br><h2>  Telegram </h2><br>  <a href="https://bitbucket.org/alex43210/robotframework_telegram">Before viewing the code is recommended stock up on sedation</a> .  The wrapper adds a couple more fields to the models (telegram_chat_id in Conversation, telegram_bot_id in Robot).  Well, multithreading in all fields. <br><br>  Here is an example: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> robotframework_telegram <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RobotFrameworkTelegram <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> config <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: bots = RobotFrameworkTelegram({ <span class="hljs-string"><span class="hljs-string">'DATABASE_URI'</span></span>: <span class="hljs-string"><span class="hljs-string">'URI'</span></span>, <span class="hljs-string"><span class="hljs-string">'KEEP_WORD_VECTORS'</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">'ROBOT_CONFIGURATIONS'</span></span>: <span class="hljs-string"><span class="hljs-string">'robot_configurations'</span></span>, <span class="hljs-string"><span class="hljs-string">'KEEP_ROBOTS'</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">'OUTPUT_HANDLERS'</span></span>: {}, <span class="hljs-string"><span class="hljs-string">'TOKENS'</span></span>: [ <span class="hljs-comment"><span class="hljs-comment"># Your tokens here ], 'NO_ANSWER_MESSAGE': 'Sorry, I can\'t answer now.', 'NO_INSTANCE_MESSAGE': 'Sorry, robot not instantiated yet. ' + \ 'You\'ll get answer after instantiation - it can take few minutes', 'TELEGRAM_WORKERS_PER_BOT': 1, 'WORKER_COUNT': 2, 'WORKER_SLEEP_TIME': 0.2, 'LOGGER': logging, }) bots.start_polling()</span></span></code> </pre><br>  And the dialogue obtained during the test <br><br><blockquote>  [7:14:55 AM] <br>  / start <br>  [7:14:56 AM] robotframework_demo_weather: <br>  Sorry, robot not instantiated yet.  You'll get answer after instantiation - it can take a few minuutes <br>  Hello.  I'm weather robot.  How can I help you? <br>  [7:16:07 AM] #: <br>  It's cold? <br>  [7:16:08 AM] robotframework_demo_weather: <br>  Okay, type city name. <br>  [7:16:11 AM] #: <br>  Moscow <br>  [7:16:11 AM] robotframework_demo_weather: <br>  Temperature in Moscow is next. <br><br>  [7:40:25 AM] #: <br>  / start <br>  [7:40:26 AM] robotframework_demo_weather: <br>  Hello.  I'm weather robot.  How can I help you? <br>  [7:40:48 AM] #: <br>  What is your destination, robot?  Seems like you must not answer <br>  [7:40:48 AM] robotframework_demo_weather: <br>  Sorry, I can't answer now. </blockquote></div><p>Source: <a href="https://habr.com/ru/post/316838/">https://habr.com/ru/post/316838/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316828/index.html">Building compact collimators for high power LEDs</a></li>
<li><a href="../316830/index.html">ISUII AmigaVirtual - universal AI for everyone</a></li>
<li><a href="../316832/index.html">Demo cloud access to Ultimate 2C</a></li>
<li><a href="../316834/index.html">Tips for Indie Developers: The Dark Triad and Five Tips with Top ROI</a></li>
<li><a href="../316836/index.html">How not to use the Repository pattern</a></li>
<li><a href="../316840/index.html">How to gently get into the guts of WebRTC when transmitting voice and video</a></li>
<li><a href="../316844/index.html">JetBrains tools are half cheaper for companies</a></li>
<li><a href="../316846/index.html">CTFzone write-ups - MISC it all up</a></li>
<li><a href="../316848/index.html">10 unique Internet entrepreneurs of Russia</a></li>
<li><a href="../316850/index.html">Veeam Availability Suite 9.5 - about updates to Veeam ONE, as well as free NFR keys</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>