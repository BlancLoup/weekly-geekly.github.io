<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to hack the defense of the project Allen-Bradley PLC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Brief background 
 For some time using one of the control systems of those. The process necessitated the revision of the PLC project. Since the system...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to hack the defense of the project Allen-Bradley PLC</h1><div class="post__text post__text-html js-mediator-article"><h2>  Brief background </h2><br>  For some time using one of the control systems of those.  The process necessitated the revision of the PLC project.  Since the system was installed by an American company, the project was implemented on the Allen Bradley controller, namely, 1756-L61.  Coincidence?  I do not think. <br><br>  Although the love of Americans for Allen Bradley is rather just my observation.  And in no case advertising this manufacturer of controllers. <br><br>  Get to the point.  Sections of the project were protected from editing, due to the ‚Äúwise‚Äù developer policy in the style of ‚ÄúDon't touch anything, without us!  This will violate the safety standards of the managed unit.  Etc." 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I admit, no one set a goal to change the technological logic of the object. <br><br>  It was only about creating a couple of variables for later output to the Operator Panel with the ability to change the setpoint. <br><br>  But the defense did not even allow creating a new variable instead of a constant.  Therefore, the desire to break the protection completely overwhelmed. <br><a name="habracut"></a><br><h2>  Let's get started </h2><br>  I used RSLogix 5000 V19.01.00 (CPR 9 SR 3) to connect to the controller. <br><br><img src="https://habrastorage.org/files/f43/15e/13a/f4315e13aea64ace8df6e27c751ad4f4.png"><br><br>  The gray background of the project editor shows a ban on editing the section. <br><br>  Go to File-&gt; Save as ... and save the file in RSLogix 5000 .L5X XML format: <br><br><img src="https://habrastorage.org/files/cf9/bf9/401/cf9bf9401bfa462e8fcd83655858c6c1.png"><br><br>  Open the saved project * .L5X in a text editor, such as Notepad ++. <br><br>  Copy the contents and go to the online descriptor: <a href="http://skdatmonster.github.io/DecryptSourceProtection/index.html">skdatmonster.github.io/DecryptSourceProtection/index.html</a> .  Paste the content into the left window. <br><br>  Attention!  Copying may take some time.  Expect in anticipation.  My file was 1.9 MB in size: it took about 15-20 real seconds. <br><br><img src="https://habrastorage.org/files/bfc/e5a/0ab/bfce5a0ab4184df9aed53a2350ea78d0.png"><br><br>  Copied?  Click ‚ÄúDecrypt-&gt;‚Äù. <br><br>  We get a picture similar to this one.  Where ‚ÄúUnpacked encoded data‚Äù is a failed decryption attempt.  Scroll a little lower - Hallelujah!  Here it is - the decrypted key. <br><br><img src="https://habrastorage.org/files/b4f/988/519/b4f98851937348d4a4babf688d33ebc6.png"><br><br>  Now we are ready to proceed to the second part, namely, to unprotect each section of the project. <br><br>  Using Notepad ++, we create the sk.dat unlock file and paste into it the project protection key that is already known to us. <br><br>  Go to Tools -&gt; Security -&gt; Configure Source Protection.  Click "Specify" and select the path to our file sk.dat. <br><br><img src="https://habrastorage.org/files/4cb/787/63f/4cb78763f35d4f709b4222c7df74c5d9.png"><br><br>  Further, it is still easier - select the project section and click ‚ÄúUnprotect‚Äù. <br><br><img src="https://habrastorage.org/files/15b/055/f9f/15b055f9ff01437fa5479e69d1f40f72.png"><br><br>  The attributes of Source Key and Viewable will disappear, confirming the fact of unlocking the section.  Thus, we do this with every interesting for us, in terms of editing section. <br><br>  Connect online to our controller - it will offer to upload the project.  We agree. <br><br><img src="https://habrastorage.org/files/edc/e14/917/edce149172ae40209b207e525f53c499.png"><br><br>  And after a couple of minutes, after unloading the project, we go into any section from which we previously removed protection.  Voila! <br><br><img src="https://habrastorage.org/files/cd7/a7b/a3d/cd7a7ba3dcda42eeb207c02e6a625922.png"><br><br>  The white background of the project code editor confirms that now we can edit the section.  The goal is achieved. <br><br>  In the event that the file is subsequently moved or deleted with the project unprotection key, editing will be prohibited.  Consequently, you will have to repeat the steps to create a new sk.dat file. <br><br><h2>  Afterword </h2><br>  Ironically, or perhaps even because of the ‚Äúlush‚Äù fantasy of the code developer, in my case, the key was different from the password to access the Operator Panel of the control system, only one character.  Namely - underscore. <br><br>  <i>Good luck to all!</i> </div><p>Source: <a href="https://habr.com/ru/post/280846/">https://habr.com/ru/post/280846/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../280836/index.html">Do not miss the virtual hackathon from Microsoft with the support of Forbes</a></li>
<li><a href="../280838/index.html">What is Simics?</a></li>
<li><a href="../280840/index.html">How not the most successful default behavior can mask the wrong work for years.</a></li>
<li><a href="../280842/index.html">Archiving as a work of art</a></li>
<li><a href="../280844/index.html">A supercomputer based on a TrueNorth chip with a power consumption of 2.5 W was created in the USA</a></li>
<li><a href="../280848/index.html">FlashSort sorting method</a></li>
<li><a href="../280856/index.html">Checking the Samba project using PVS-Studio under Linux</a></li>
<li><a href="../280858/index.html">Why our studio does not make free concepts</a></li>
<li><a href="../280860/index.html">Competition GraphHPC-2016 for the fastest implementation of the parallel algorithm Community Detection: Results</a></li>
<li><a href="../280862/index.html">The most interesting of the vSphere 6 arsenal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>