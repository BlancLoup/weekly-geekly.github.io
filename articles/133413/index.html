<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Java. Stop the task</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For nearly a year I have been hard at work on Java coding. Faced a rather serious problem in my opinion related to multithreading, it seems to me, ins...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Java. Stop the task</h1><div class="post__text post__text-html js-mediator-article"> For nearly a year I have been hard at work on Java coding.  Faced a rather serious problem in my opinion related to multithreading, it seems to me, insoluble in the framework of the current implementation of JVM from Oracle (this applies to JDK 1.5 and higher).  The fact is that at the moment in Java there is no way to safely stop the execution of any thread.  This post explains why this is exactly what proposes to start a discussion on how to solve this problem. <br><a name="habracut"></a><br>  It would seem a trivial task: we have some <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html">Thread</a> (flow), which, we know for sure, is hopelessly frozen (it may be looped, maybe something else), while consuming some resources.  What should we do with it?  I would like to free our resources.  It would seem that easier?  But no, a detailed study of the issue turned out that the JVM simply did not have instructions for correctly stopping the hung thread.  The old <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html">Thread.stop ()</a> method has <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html">been</a> declared deprecated and committed to the strictest anathema.  As stated in javadoc, this method is ‚Äúessentially unsafe.‚Äù  Well, if we are not safe, we will not use it; give us another, safe method.  But another safe oddly is not offered.  Of course, a very safe <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html">Thread.interrupt ()</a> instruction is proposed.  But it is safe, unfortunately, because absolutely nothing does!  This is just a message to the stream: "Please stop."  But if the thread ignored this message, then ... as stated in the documentation ‚ÄúIf the thread does not respond to Thread.interrupt (), you can use tricks specific to your application‚Äù.  Thank you for allowing.  What is called, spin as you want. <br><br>  Everything becomes even more complicated if the task is running in the thread pool, through, for example, <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html">ExecutorService.submit (Runnable)</a> .  At the same time, we don‚Äôt even know in which particular thread this task is performed and can no longer even use the forbidden Thread.stop ().  On the other hand, we have a reference to <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html">Future</a> , and Future has a method <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html">Future.cancel (boolean)</a> , which should cancel the execution of the task.  But if the task has already started, calling Future.cancel (true) will not actually stop it.  In the depths of the <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/FutureTask.html">FutureTask</a> implementation <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/FutureTask.html">, the</a> following code is executed: <br><br> <code>if (mayInterruptIfRunning) { <br> Thread r = runner; <br> if (r != null) <br> r.interrupt(); } <br></code> <br>  Those.  again, the thread in which the task is executed is only recommended to stop execution.  In addition, we do not even have the opportunity to know whether the task is being carried out at the moment or not.  There is, it seems, the <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html">Future.isDone ()</a> method, but again by, it returns true not only when the task has completed, but immediately after calling Future.cancel (), even if the task is still running (after all, Future.cancel (true) does not stops the task that has already started running). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Well, if we write all the code ourselves, then we can accurately handle <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html">Thread.isInterrupted ()</a> in the right places and everything will be OK.  But if we run third-party code?  If we have a server extensible with plugins?  Any crookedly written plug-in can easily lead to an inoperative state of the entire server because we cannot correctly interrupt the execution of a hung plug-in. <br><br>  I admit, I do not know a satisfactory solution.  Maybe the Thread.stop () method is not so dangerous?  I'd love to hear the opinions of Java programmers practitioners on this. </div><p>Source: <a href="https://habr.com/ru/post/133413/">https://habr.com/ru/post/133413/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../133406/index.html">Jvm on javascript</a></li>
<li><a href="../133408/index.html">Parse the GNU Coreutils source code: yes utility</a></li>
<li><a href="../133409/index.html">Methods of malware analysis: Unpacking drivers in Ring3</a></li>
<li><a href="../133410/index.html">Google webinar content on creating mobile sites</a></li>
<li><a href="../133411/index.html">X Neural Switcher - Cookbook (Part 3). Keylogger</a></li>
<li><a href="../133414/index.html">We build a tracked Bluetooth robot with a camera. Part 1</a></li>
<li><a href="../133415/index.html">Brute force card number, CVV2 and expiration date using the Master Bank website</a></li>
<li><a href="../133416/index.html">Tester conferences of the world. Continuation</a></li>
<li><a href="../133417/index.html">Platform @ Mail.Ru // Reports from the Mail.Ru Technology Forum 2011: text of the report, video, presentation</a></li>
<li><a href="../133418/index.html">School DDoS and whether to be afraid of him</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>