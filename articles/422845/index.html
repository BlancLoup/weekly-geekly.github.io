<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to make TV really smart?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few years ago, recommender systems were just beginning to conquer their consumers. Online stores are actively using algorithms of recommendations, o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to make TV really smart?</h1><div class="post__text post__text-html js-mediator-article">  A few years ago, recommender systems were just beginning to conquer their consumers.  Online stores are actively using algorithms of recommendations, offering their customers more and more new products based on their consumer history. <br><br>  In the client service, recommender systems became relevant not so long ago.  In connection with the increase in the proposed content, customers began to get lost in the information flow of what, where and when they need to look.  The headache of video content lovers took pay TV operators and online cinemas to treat. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0fd/633/59e/0fd63359ed366334f9c5a3f6b0db1a8c.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As an effective way to solve the eternal problem of ‚Äúwhat to see?‚Äù, Recommendatory systems appeared that work on the basis of one or another mathematical model. <br><br>  Two years ago, we introduced a recommendation system, later supplemented it with editorials and felt a noticeable effect both in sales and in the duration of using our service. <br><a name="habracut"></a><br><h2>  What is a recommendation system </h2><br>  The recommendation system is when you want to watch something, but do not know what it is, and the TV guesses your preferences very well.  This is content filtering that selects movies and TV shows based on preferences and analysis of user behavior.  The system used by the operator must predict the reaction of the viewer to a particular element and offer content that he may like. <br><br>  When programming recommender systems, three main methods are used: collaborative filtering, content-based filtering and knowledge-based systems. <br><br>  <b>The collaborative filtering is</b> based on three stages: collecting user information, building a matrix for calculating associations, and issuing a valid recommendation. <br><br>  A good example of collaborative filtering is the Cinematch system, which Netflix uses.  Users explicitly or implicitly give marks to watched films, and recommendations are formed taking into account both their own user ratings and the ratings of other viewers.  To do this, the system selects users with similar preferences, whose ratings are close to their own.  Based on the opinion of this circle of people, the viewer is automatically given a recommendation: watch a particular film. <br><br>  For the most correct operation of the recommendation system, of course, the fundamental role is played by the accumulated and collected data.  The more data is accumulated about the consumption profile of a subscriber, the more accurate the recommendations are given to him. <br><br>  <b>Content recommendation system are</b> formulated based on the attributes assigned to each element.  If you watch movies of a certain genre, the system will automatically offer you content that is close to your genre in certain positions.  It is on the basis of such a recommendation system that the Pandora site operates. <br><br>  <b>Expert recommender systems</b> offer recommendations not on the basis of ratings, but on the basis of similarities between user requirements and product description, or depending on the restrictions set by the user when specifying the desired product.  Therefore, a system of this type is obtained uniquely, because it allows the client to clearly indicate what he wants. <br><br>  Expert systems are most effective in contexts where the amount of available data is limited, and collaborative filtering works best in environments where there are large data arrays.  But when the data is diversified, it is possible to solve the same problem by different methods.  So, it will be optimal to combine the recommendations obtained in several ways, thereby increasing the quality of the system as a whole. <br><br>  It is a similar hybrid system from the company E-Contenta works in our service <a href="https://habr.com/article/322882/">WiFire TV</a> .  It was commissioned and debugged in December 2016 and works according to the following principle: if the system knows a lot about the user or about the content, then the collaborative filtering algorithms prevail.  If the content is new, or not enough information has been collected on user interaction with it, then content algorithms are used to evaluate content similarity based on the available metadata. <br><br><h2>  How did the recommendation algorithms line up? </h2><br>  In order to build a personalized collection in E-Contenta, it was necessary to rank all available content according to the likelihood that a particular user would be interested in this content. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/367/a54/f5f/367a54f5fda8e0f368edebdb781c9083.png" alt="image"><br><br>  The user's interest is first of all determined at the moment when he clicks on the content recommended to him, and the probability is defined as the ratio of the number of clicks to the number of times when this content was recommended to this user. <br><br>  <b>p (click) = Nclik / Npokazov</b> <br><br>  The difficulty lies in the fact that the user needs to recommend something that he has never seen, which means there is simply no data on the number of clicks or impressions to calculate this probability. <br><br>  Therefore, instead of the actual probability, it was decided to use an estimate of this probability, in other words, the predicted value. <br><br>  The idea of ‚Äã‚Äãa collaborative filter is simple: <br><br><ol><li>  Take historical data viewing by users of content </li><li>  Based on this data, group users by the content they viewed. </li><li>  For a given user to predict the probability of his interest in a specific unit of content, based on historical data of other users belonging to the same group. </li></ol><br>  Thus, users are jointly involved in the content selection process. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6b2/9c3/089/6b29c3089b10d074fa2bf46b04867b04.png" alt="image"><br><br>  There are many different options for implementing this approach: <br><br>  1. Build a model using directly identifiers of content units: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/394/5ee/a5e/3945eea5e234c29e64f5dac9c2151597.png" alt="image"><br><br>  The disadvantage of this approach is that the model does not ‚Äúsee‚Äù any links between content units.  For example, "Terminator" and "Terminator 2" for her will be as far from each other as "Alien" and "Good night, Kids!".  In addition, the matrix itself is very sparse (many empty cells and few filled). <br><br>  2. Instead of identifiers use the words included in the title of articles, broadcasts or films: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/01e/4e6/68c/01e4e668c2c370824d2a50a2e7e65707.png" alt="image"><br><br>  3. For films, the names of actors, directors, or data from IMDb: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ade/d36/0e6/aded360e6170cfc87bd40d6421734062.png" alt="image"><br><br>  The second and third options partially eliminate the drawbacks of the first approach, taking into account the links of content that has common features (of the same director or the same words in the title).  However, the sparsity of the matrix also decreases, but, as they say, there is no limit to perfection. <br><br>  Storing a complete set of user ratings in memory is very expensive.  Taking a rough estimate of the number of Runet users of 80 million people and the size of the IMDb base of 370 thousand films, we get the required size of 27 Terabytes. The singular decomposition is a method of reducing the dimensionality of the matrix. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c8b/101/2f8/c8b1012f8d8e8248063973ff53ea7b96.png" alt="image"><br>  <i>A large matrix T is represented as a product of a set of smaller matrices.</i> <br><br>  In other words, the search for the "core" of the matrix, which has the same properties as the full matrix, but much smaller.  Along with a decrease in dimension, the discharge also decreases.  In this article we will not go into the subtleties of implementation, especially since ready-made libraries already exist for a number of programming languages. <br><br><h2>  Technical difficulties </h2><br>  <b>Cold start</b> <br><br>  The situation when the lack of data for a new content or user does not allow to give high-quality recommendations, also known as ‚ÄúCold Start‚Äù, is a typical problem for collaborative filtering. <br><br>  One solution is to mix in the recommendations of several pieces of content for which not enough data has been collected.  The new user will be recommended the most popular content. <br><br>  <b>Most popular</b> <br><br>  Using the above approach, it is important not to forget that its consequence will be a systematic increase in the frequency of the ‚Äúmost popular‚Äù in the list of recommended.  By learning from the behavior of users who are often offered the ‚Äúmost popular‚Äù, the recommender system risks learning to recommend only the most popular content. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/511/4b9/10c/5114b910c74da3f0a365c3e6172fbab1.jpg" alt="image"><br><br>  The main difference of personal recommendations from the banal recommendations of the most popular content is that they take into account individual tastes, which can differ significantly from the "average". <br><br>  Thus, the sampling of user reactions to the content used to train the recommender model should be normalized. <br><br>  <b>Availability, resiliency and scalability</b> <br><br>  The number of users of the resource can create a load of hundreds and thousands of requests to the recommender system per second.  However, the failure of one or several servers should not lead to a denial of service. <br><br>  The classic solution in this case would be to use a load balancer that sends a request to one of the cluster servers.  In addition, each of the servers is able to process the incoming request.  In case of failure of any of the servers in the cluster, the balancer automatically switches the load to the servers remaining in service.  By selecting HTTP as the transport protocol, we can use Nginx as a load balancer. <br><br>  As the resource audience grows, the number of servers in a cluster can grow.  In this case, it is important to minimize the cost of preparing a new server. <br><br>  The recommendation system requires the installation of a number of components on which it is functionally based.  Docker is used to automate the deployment of a recommender system with all its dependencies. <br><br>  Docker allows you to collect all the necessary components, ‚Äúpack‚Äù them into an image and put such an image into the storage (registry), and then download and deploy it on a new server in a matter of minutes.  An important advantage of Docker is that the ‚Äúoverhead‚Äù when using it is minimal: the time it takes to call an application in a docker container increases by a few nanoseconds compared to an application running on a regular operating system. <br><br>  Another important advantage is the ability to quickly return to the previous stable version of the application in the event of a new failure (you just need to take the old version from the registry). <br><br>  The second type of requests to the system, the maintenance of which must be taken care of are requests that track user actions.  So that the user does not have to wait until the system fully processes the action performed by him, the processing is performed independently of the process of recording actions. <br><br>  In the E-Contenta, Apache Kafka was chosen as a platform for transferring data on user actions to handlers.  Kafka implements the architectural pattern Message-Oriented Middleware), which is able to provide guaranteed delivery of tens and hundreds of thousands of messages per second and act as a buffer that protects processors from excessive data at peak times. <br><br>  <b>Full autonomy self-learning</b> <br><br>  New content and new users regularly appear - without regular training, the quality of the model degrades.  Training should be performed on separate servers so that the learning process, which requires significant computational resources, does not affect the performance of the combat servers. <br><br>  The classic solution for orchestrating regular distributed tasks is Jenkins.  The scheduled service launches the acquisition and normalization of new training samples, training of the recommendatory model, delivery of new models and updating of all servers in the cluster, which allows maintaining the quality of recommendations without additional efforts.  In the event of a failure in any of the steps, Jenkins automatically returns the system to the previous stable state and notifies the administrator about the failure. <br><br><h2>  How we did it on WifireTV </h2><br>  In addition, in order for the system to work properly, we invited an independent television meter and invited him to measure the television viewing of subscribers.  The obtained unique data is enlivened using data science algorithms.  Continuous feedback from subscribers interacting with the recommendations fills the base of machine learning algorithm use cases and allows the recommendations to change depending on the implicit signs of changing preferences of subscribers, such as time of year, approaching holidays or changing family composition. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/882/68f/6a8/88268f6a8f1575e2bda5d912026708d7.png" alt="image"><br><br>  In the process of testing, we had to solve the problem associated with the recommendation of television content - how to help our subscribers understand streams of broadcasts.  The task is further complicated by the services of deferred viewing.  We have built in a system that instead of endless cyclic channel switching helps to find an interesting program already in 2-3 button presses.  To this end, the recommender system monitors the release of a new series of programs and predicts the interest of viewers in irregular programs and broadcasts of films.  In fact, machine algorithms replace the work of the responsible editor. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0ec/870/91f/0ec87091fd5d9672492b89eb4943df58.png" alt="image"><br><br>  Work with streaming television has its own specifics.  For example, often the same popular TV shows go on different channels.  In this case, the recommender system has to understand the duplication of information and choose a recommendation based on the preferences of the subscriber regarding the channels, the start time of transmission, etc.  Such duplication of information also occurs when the subscriber has a subscription to the SD and HD versions of the channels. <br><br>  All these two years, we experimented with different versions of recommender systems and found a middle ground that allows us to improve the indicators of audience engagement and more effectively monetize existing content.  We use the automatic selection of recommendations described above with manual configuration - editorial collections. <br><br>  This approach allowed significantly (10 times) to increase the monetization of VOD and SVOD services. <br><br>  <b>Editorial recommendations</b> are collections of thematic films and serials tied to high-profile premieres, holidays, and memorable dates.  It is very convenient - to notify subscribers and give them the opportunity to watch new movies, old hits or unpopular, but in our opinion very interesting films in terms of content and plot.  We closely communicate with our suppliers (online cinemas and additional video services, such as ivi, megogo, amediateka) and personally select each film that will be interesting for our subscriber. <br><br>  On holidays we make special selections on a certain subject.  For example, for Victory Day, these are films of a military theme.  On the first of September - a selection of content for children, which consists of educational programs, cartoons, and documentaries. <br><br>  Manual selection perfectly increases the loyalty of our subscribers.  According to our most conservative estimates, about 10% of our subscriber base watches movies every month that we recommend and this figure is constantly growing. <br><br><h2>  What is the result? </h2><br>  Currently, the Wifire TV is powered by an intelligent recommendation system from E-Contenta.  It is based on data science and metadata of 90% of operator‚Äôs subscribers.  The algorithm takes into account hundreds of data: what the subscriber is watching, what movies and programs are popular, when he uses the service and who is now in front of the screen.  We want to convey to our subscribers the value of a subscription to premium channel packages, mixing them with relevant user programs in recommendations.  We also want to show what to acquire and watch legal video content - this is normal, convenient and simple. <br><br>  The recommendation system will prompt the subscriber interesting films, even if they have long been out of the category of new products: thus the extensive video catalog ceases to be a dusty library, and becomes an interactive showcase that adapts flexibly to the tastes and moods of subscribers. </div><p>Source: <a href="https://habr.com/ru/post/422845/">https://habr.com/ru/post/422845/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../422835/index.html">DevOps on the edge of the universe</a></li>
<li><a href="../422837/index.html">How to get to DevOps, how to study and what to read</a></li>
<li><a href="../422839/index.html">Sharing knowledge: Master's, StudentTalks, online courses and other learning initiatives</a></li>
<li><a href="../422841/index.html">Encounter #RuPostgres - quiz and the last call</a></li>
<li><a href="../422843/index.html">Introducing the World of Counterfeit ICs: Counterfeit Detection Techniques</a></li>
<li><a href="../422851/index.html">Why the future of data storage is still behind the tape</a></li>
<li><a href="../422857/index.html">Implementing your IoC container</a></li>
<li><a href="../422859/index.html">The Ministry of Communications offered to switch to SIM cards with encryption from the FSB</a></li>
<li><a href="../422861/index.html">About building JDK 8 on Ubuntu, the quality of Hotspot code, and why everything is felled in C ++</a></li>
<li><a href="../422863/index.html">Tribes, guilds, build train and no TDD: how does mobile development work in Uber, Spotify, Odnoklassniki and Avito</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>