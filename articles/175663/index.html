<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing Nexus 1000V on vSphere 5.1 (Part One)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Cisco Nexus 1000v is a distributed virtual switch ( DVS ). This switch is a machine that is installed into the vSphere infrastructure (Virtual Sup...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing Nexus 1000V on vSphere 5.1 (Part One)</h1><div class="post__text post__text-html js-mediator-article"> <b>The Cisco Nexus 1000v</b> is a distributed virtual switch ( <b>DVS</b> ).  This switch is a machine that is installed into the vSphere infrastructure (Virtual Supervisor Module) and the virtual switch itself, which is installed into the kernel of the hypervisor as an update (Virtual Ethernet Module). <br>  <b>VSM</b> can be reserved by High Availability ( <b>HA</b> ) technology - one active second stand-by. <br><br><a name="habracut"></a><br><br>  There is an <a href="http://www.cisco.com/en/US/products/ps10785/index.html">iron version of the</a> Cisco Nexus - a model of the <b>Cisco Nexus 1100 Virtual Services Appliance</b> , I have never worked with it, but as far as I understand it is a kind of iron server, there will be a machine with <b>VSM</b> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Data Center Architecture with Cisco Nexus 1000V: <br><br><img src="https://habrastorage.org/storage2/fa3/849/b52/fa3849b52195fd35541878507857ac35.png"><br><br>  Structurally, Cisco Nexus 1000v - modular switch.  The first two modules are reserved for management ( <b>VSM</b> ) and the remaining 64 modules for connecting virtual machines ( <b>VEM</b> ). <br>  Here is a <a href="http://www.cisco.com/en/US/prod/collateral/switches/ps9441/ps9902/solution_overview_c22-526262.pdf">comparison of the</a> Cisco Nexus 1000v with a vSwitch and a standard DVS, you can read.  Just recently, information appeared that <b>IBM</b> also released an analogue of <b>DVS</b> , I can‚Äôt say anything about it - I didn‚Äôt test it. <br>  <b>VSM</b> has 3 interfaces - Control, Management and Packet. <br><br>  <b>Control</b> - monitors the status of the <b>VEM</b> and controls them. <br><br>  <b>Management</b> - port for managing the supervisor. <br><br>  <b>Packet</b> - port for <b>CDP</b> , <b>IGMP</b> and <b>LACP</b> protocols. <br><br>  The recommendations say that you need to use different VLANs under Control and Packet.  It looks reasonable, it is also worth considering - that <b>Control</b> should be in the same VLAN with Management interfaces of hosts. <br><br>  The VEM can be downloaded from <a href="https://my.vmware.com/group/vmware/info/slug/datacenter_cloud_infrastructure/vmware_vcloud_suite/5_1">the</a> VMware <a href="https://my.vmware.com/group/vmware/info/slug/datacenter_cloud_infrastructure/vmware_vcloud_suite/5_1">site</a> - and the VSM (virtual machine applins) from the <a href="http://software.cisco.com/download/type.html%3Fmdfid%3D282646785">Cisco</a> site. <br><br>  Inside the <b>VMS is</b> <b>NX-OS</b> , the operating system that is used on all Cisco Nexus devices. <br>  Well and the most important, Cisco follows in the direction of product development for virtual data centers - so they have a bunch of products that require the Cisco Nexus 1000v installed. <br><br><img src="https://habrastorage.org/storage2/2cb/c82/d09/2cbc82d09df2b7f1466d3b822e966db5.png"><br><br>  In the picture, those products that require the Nexus 1000v are highlighted in red. <br>  In detail about all products it is better to read on <a href="http://google.com/">these Internet.</a> <br><br>  I will describe them briefly: <br><br>  <b>The Cisco ASA 1000v</b> is the virtual counterpart of the Cisco ASA (formerly the Cisco PIX), a firewall for virtual machines. <br>  <b>Cisco vWaaS</b> is a virtual solution from Cisco for application optimization. <br>  <b>Cisco VSG</b> - Virtual Security Gateway, supports security policies at the level of virtual machines, VLAN and infrastructure. <br>  About VSM I already wrote above. <br>  <b>The Cisco Cloud Service Router (CSR) 1000v</b> is a Cisco virtual router, I really want to see what it is and think that I‚Äôll see it in the near future and review it. <br>  <b>Citrix NetScaler VPX</b> is a Citrix solution, virtualized by load-balancer with great traffic protection capabilities. <br>  The picture also does not show <b>Cisco Nexus 1000v InterCloud</b> , which will be an applains installed in the cloud in the provider‚Äôs cloud (as long as there is support for the Amazon public cloud) and allowing you to completely manage your infrastructure, move machines and manage security policies through a single console. <br><br><img src="https://habrastorage.org/storage2/455/ab4/e17/455ab4e174a69d6fec6a7a82fd69c467.png"><br><br>  He is promised in the middle of the year, while very little is known about him - but I hope that we will be able to work with him in the near future. <br><br>  Regarding licensing of Cisco Nexus 1000v, currently there are 2 licenses, <b>Essential Edition</b> and <b>Advanced Edition</b> . <br><br>  Here is a comparison: <br><img src="https://habrastorage.org/storage2/f0b/acb/5f1/f0bacb5f1c7bedb024a875dc88cc3f54.png"><br><br>  The Essential version is free, and the extended version costs $ 695 for each socket.  You will also need an Enterprise Plus license for vSphere. <br><br>  <b>Installation requirements.</b> <br><br>  <b>Cisco Nexus 1000V Installer App.</b> <br><br>  - The host must have one or more physical network interfaces on the standard VMware switches used (it is better to have several NICs - because during migration you will need to transfer networks from a standard switch to a new distributed Nexus) <br>  - A standard VMware switch should not have machines running on it, to prevent the loss of their connection to the network during migration. <br>  - You need to configure the VSM connection to the vCenter server. <br>  - The host should have only one standard VMware switch. <br>  - Make sure you have not previously installed any VEM before installing VSM. <br>  - VCenter administrator rights are required. <br><br>  <b>Requirements for hosts.</b> <br><br>  - Must be installed vCenter <br>  - Must be installed vSphere Client <br>  - You must have a VMware Enterprise Plus license <br>  - Hosts must be running ESX / ESXi from version 4.1 <br>  - For fault tolerance, there should be two network interfaces.  But it is possible to install with only one on the host. <br>  - When using several switches (meaning physical, to which hosts are connected), you need to make sure that the trunk has all the necessary VLANs between the switches and on the necessary interfaces (including Packet and Control VLAN). <br>  - Control and Management must be configured on the host to use the VSM. <br>  - All vmnics must have the same configuration. <br><br>  <b>Iron Switch Requirements</b> <br><br>  - If you use several switches, it is necessary to register trunks everywhere with all VLANs between all switches that are used. <br>  - It is necessary to configure STP on those ports to which the hosts connect - it is required to enable BPDU Guard. <br>  - It is necessary to transfer all ports to which hosts connect to trunk mode, if there is a need to use untagged traffic - use Native VLAN. <br><br>  <b>VSM requirements</b> <br><br>  - Separate IP <br>  - Installed vCenter and VMware Update Manager (VUM) <br>  - In a fail-safe installation (i.e., when you install two VSM machines in HA mode), you must first configure the first machine, and then only install the second one. <br><br>  <b>VEM requirements</b> <br><br>  - If a cluster is used, before installing VEM via VUM, you must turn off VMware HA, DRS, FT (Fault tolerance) and VMware distributed power management (DPM) <br>  - If the hosts are in ESXi stateless mode, then you need to enable the Pxe Booted ESXi host settings option by following the link: Home&gt; Update Manager&gt; Configuration&gt; ESXi host / cluster. <br>  - Installation of VEM is possible either in automatic mode (through the installation of the .jar file, through the host CLX ESX \ ESXi and via VUM). <br><br>  Let's go directly to the Cisco Nexus 1000v installation. <br><br>  1) Adding networks. <br><br>  As I wrote above, for Nexus 1000v you need 3 grids - Packet, Management and Control. <br>  You need to go to the host in the <b>Configuration -&gt; Networking</b> tab and add these networks to the standard vSwitch. <br><br><img src="https://habrastorage.org/storage2/946/cd5/78c/946cd578c5d3d1d4c44bf7da08f1fcd0.png"><br><br>  Connection type we set the Virtual machine naturally - and preferably for different Packet and Control networks different VLANs. <br><br><img src="https://habrastorage.org/storage2/ae0/e88/d5a/ae0e88d5ad1d86e58c9d400bdebe89f9.png"><br><br>  I have a test stand - so I pushed everything into a single VLAN.  For Management, I use the standard VM Network, which contains all of my <b>VMs</b> . <br><br>  2) Installing VSM <br>  First, download the archive from cisco.com (you need an account to download), currently the latest version is 4.2.1.SV2.1.1a. <br>  There will be several folders in the archive, in the folder <b>Nexus -&gt; VSM -&gt; Install</b> lies the OVF template, and it should be installed. <br>  Connect to the vCenter through the vSphere client, select <b>File&gt; Deploy OVF Template</b> <br><br><img src="https://habrastorage.org/storage2/74d/6c6/1b6/74d6c61b6cd7bfd36eb32b6610555a28.png"><br><br>  Then, step by step, when asked for the configuration, select the Nexus 1000V Installer for the main server of the HA cluster. <br>  You can also select the manual configuration of the Nexus 1000V to specify all the parameters in the initial installation dialog after deploying a VM from this template. <br><br><img src="https://habrastorage.org/storage2/627/058/67e/62705867e923b3dc913d29cd6e884b84.png"><br><br>  In the network selection step, we select those networks for the traffic that was created earlier: <br><br><img src="https://habrastorage.org/storage2/216/420/af6/216420af605a334a48b96ceafa44b5f3.png"><br><br>  In the settings window: <br><br><img src="https://habrastorage.org/storage2/10d/73f/2c6/10d73f2c6ae9d2c69da76ea4efff8eab.png"><br><br>  <b>VSM Domain ID</b> is the domain number, for each individual switch the Cisco Nexus 1000v should be different if several different DVS are to be used. <br>  <b>Password</b> - the password to access the switch (standard admin login). <br>  <b>Management IP Address</b> , <b>Management IP Subnet Mask</b> , <b>Management IP Gateway</b> - the corresponding IP settings for management will be assigned to the Management interface. <br><br>  We start VM, we wait while it is loaded and we log in on it: <br><br><img src="https://habrastorage.org/storage2/c9d/15b/acb/c9d15bacb6d5bcd9b250b2a6c4709b2c.png"><br><br>  This concludes the first part. <br>  In the <a href="http://habrahabr.ru/post/171639/">second part</a> I will explain how to configure <b>VSM</b> and install <b>VEM</b> . </div><p>Source: <a href="https://habr.com/ru/post/175663/">https://habr.com/ru/post/175663/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../175651/index.html">Problems of long PHP scripts</a></li>
<li><a href="../175655/index.html">How we improved the work of the support service in Yandex.Mail</a></li>
<li><a href="../175657/index.html">Code as an argument in Cach√© ObjectScript</a></li>
<li><a href="../175659/index.html">Globals MUMPS: Extreme Database Programming. Part 1</a></li>
<li><a href="../175661/index.html">Windows Phone and continuous integration into TeamCity</a></li>
<li><a href="../175665/index.html">Browser Games (Poll)</a></li>
<li><a href="../175669/index.html">PXE boot menu with System Center Configuration Manager</a></li>
<li><a href="../175671/index.html">Petman from Boston Dynamics is ready to serve</a></li>
<li><a href="../175677/index.html">Counter of individual time counting on pure JavaScript</a></li>
<li><a href="../175681/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ51 (March 30 - April 5, 2013)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>