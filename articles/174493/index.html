<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Don Jones "Creating a unified IT monitoring system in your environment" Chapter 4.Monitoring: a look beyond the limits of the data center</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This chapter discusses how to combine external and internal monitoring. What to look for when building the system, what are the limitations. How not t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Don Jones "Creating a unified IT monitoring system in your environment" Chapter 4.Monitoring: a look beyond the limits of the data center</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage2/8f2/ee6/916/8f2ee6916836f81ec54ebdfc62f848f8.png"><br>  This chapter discusses how to combine external and internal monitoring.  What to look for when building the system, what are the limitations.  How not to miss the little things and get the opportunity to view the picture not only from the bottom up, but also from the top down. <br><br><a name="habracut"></a><br>  <b><b>Content</b></b> <b><b><br><br></b></b>  <b><b><a href="http://habrahabr.ru/post/173537/">Chapter 1. Managing your IT environment: four things you do wrong</a></b></b> <b><b><br></b></b>  <b><b><a href="http://habrahabr.ru/post/173815/">Chapter 2. Elimination of management practices for individual sites in IT management</a></b></b> <b><b><br></b></b>  <b><b><a href="http://habrahabr.ru/post/174267/">Chapter 3. We combine everything into a single IT management cycle</a></b></b> <b><b><br></b></b>  <b><b><a href="http://habrahabr.ru/post/174493/">Chapter 4. Monitoring: a look beyond the data center</a></b></b> <b><b><br></b></b>  <b><b><a href="http://habrahabr.ru/post/175039/">Chapter 5: Turning Problems into Solutions</a></b></b> <b><b><br></b></b>  <b><b><a href="http://habrahabr.ru/post/175975/">Chapter 6: Unified Case Management</a></b></b> <b>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </b> <h4>  Chapter 4: Monitoring: A look beyond the data center </h4><br>  IT has already gone beyond our own data centers and virtually every organization has one or two services outsourced.  Although we may always have our own home monitoring and management tools, we need to understand that in most cases, monitoring should continue <i>outside of</i> our data center.  This also applies to the placement of remote services and to a more accurate understanding of what our users actually experience when working with such services. <br><br><h5>  Technical meter monitoring versus end user experience (EUE) </h5><br>  I call the traditional approach to IT monitoring ‚Äúfrom the inside out‚Äù (or upside down).  It starts in the data center and gradually moves to the end user.  Figure 4.1 shows how a typical monitoring system starts with a backend: a DBMS server, applications, web servers, cloud servers, and so on.  The most reasonable argument in favor of such a structure is that we have the best control over the equipment installed in our data center.  If everything works well inside the datacenter, then there is every reason to believe that the end users who use the services of the datacenter should be quite happy. <br><img src="https://habrastorage.org/storage2/795/f11/200/795f11200088c4e236ad055b203d6218.png"><br>  <b>Figure 4.1: Monitoring by the data center.</b> <br><br>  Most SLAs are based on this approach.  We prescribe in them a certain value of service availability, set threshold figures for metrics, information for which is collected in the data center: CPU utilization, networks, disks, etc.  We are also interested in low-level parameters: response time to requests, disk response time, network latency, and so on. <br><br>  There is something deeply wrong in the initial premises of this approach: if you got a beautiful brick during construction, it‚Äôs not a fact that you can build a house out of it that does not fall apart.  In other words, what end users feel when working is not a simple sum of data center technical metrics.  If the data center works well, then users <i>are usually</i> happy, but this is not always the case. <br><br>  Obviously, tracking the key parameters of the data center is extremely important, but these are <i>not the only</i> things that need to be monitored and measured.  Now in the industry there is a perception that we need direct measurements of what the user is experiencing.  In fact, ‚Äúend user experience‚Äù or EUE has become a common term in advanced circles of IT managers. <br><br>  We can give another example.  Suppose you come to a restaurant: your steak, it seems, is not roasted, they brought you the wrong side dish and the waiter is rude.  And the manager, who is standing in the kitchen, thinks that everything is in order: the steak is hot, the vegetables, too, and the waiter smiles at him every time the manager sees him (her).  He only thinks about the kitchen backend, and he knows nothing about your unfulfilled expectations.  In restaurants, this problem is solved by the fact that the manager periodically goes into the hall and asks the guests if everything is in order?  This is how EUE is monitored: instead of evaluating the metrics of our internal kitchen, we need to go into our pile of cubicles - in the sense of a restaurant - and check for ourselves what is happening there. <br><br><h5>  How EUE makes SLA better </h5><br>  You set the metrics for those values ‚Äã‚Äãthat in EUE will, in fact, <i>be</i> quite different: how many seconds are needed to complete such a transaction, and so on.  If this metric does not correspond to the real situation, you can begin to understand the details of the infrastructure, why it is not so.  And again we need to draw a traditional data center in the picture.  But at the same time, instead of using the metric 'query execution time' or some other purely technical one, we take the 'user perception' metric and use it to troubleshoot when the user believes that something is wrong with us.  Figure 4.2.  shows how EUE monitoring turns our model. <br><br><img src="https://habrastorage.org/storage2/e89/262/03e/e8926203e6224a04f938899348a328d3.png"><br>  <b>Figure 4.2: EUE monitoring.</b> <br><br>  You still have thresholds and other restrictions, but they are all set at the historically established levels at which the EUE was executed.  As shown in fig.  4.3., A non-operational EUE is your starting point, from which you must begin to understand the deeper and more technical levels of measurements that can be established, which is the problem of the end user. <br><br><img src="https://habrastorage.org/storage2/ed8/f5c/025/ed8f5c025649ea4fab77f025352ed111.gif"><br>  <b>Figure 4.3: Tracking the cause of a bad EUE.</b> <br><br>  In real life, the emerged EUE problem is not always accompanied by tangible changes in the backend.  The response time of the DBMS server is reduced by a millisecond or two, which causes the application server to take an additional half-second to process transactions, which leads to a slowdown for a second of the front-end server displaying the next page of information, and as a result the user application runs two seconds more .  Multiply these few seconds by the length of the working day, and you will find that an hour or more is lost, and the user is forced to say to many customers of the company: ‚ÄúSorry for so long, the computer slows down something today.  In fig.  4.3., Marked with red flags, the slow-responding DBMS server and cloud computing service.  By separateness, none of them trigger an alarm, but their joint work causes a problem that is noticeable to the end user.  Usually a small fluctuation on the DBMS server does not trigger the alarm - a whole cascade of events leads to a bad EUE.  One thing we know for sure: if EUE starts to deviate from the expected one, this is a reason to start investigating the causes.  Since we are looking for the <i>source of the problem</i> , and not just doing normal monitoring, we will look more closely at minor deviations in the operation of the infrastructure. <br><br>  Being able to measure EUE allows you to create more realistic SLAs.  Instead of telling your users ‚ÄúWe guarantee the system‚Äôs response to a request within 2 seconds,‚Äù you say, ‚ÄúSuch a transaction will take no more than 3 seconds to process‚Äù.  This means that the user can measure these things by himself: ‚ÄúWe press the input and count - one, two, three ... oh, it worked out!‚Äù.  This type of SLA establishes a framework that is <i>relative</i> to the user and is understandable to him.  They <i>know</i> when the system began to work slowly, because they measure the same things as you. <br><br>  Ideally, you will be aware of a decrease in the system‚Äôs performance before it is learned by the user, or very close to that, because you have a tool for measuring processes from the point of view of users. <br><br><h5>  How to do it: Synthetic transactions, transaction tracking, etc. </h5><br>  This type of monitoring is not always simple.  Of course, it is not so difficult to place monitoring agents on end-user computers, but what to do with a web application, where end users are actually external clients of your company?  They will be completely unhappy with the proposal to install agent monitoring software, and only so that <i>you</i> can measure the performance of <i>your</i> application. <br><br>  Instead, modern monitoring systems rely on <i>transaction</i> <i>tracking</i> methods.  In this case, monitoring components at your end allows you to see how a particular transaction goes through the entire system with an accurate measurement of the time from its inception to its completion.  This can be done at various levels of detail.  For example, a toolkit that allows software performance profiling can perform <i>very</i> detailed information tracking through individual software modules.  At the system management level, which is just above, you can only track the start and end time of a transaction. <br><br>  Often, this approach to determining the real state of a system can be accomplished by inserting <i>synthetic transactions</i> into it.  The monitoring system pretends to be a client, puts transactions into the system, and the result will not make any changes to the data and will be ignored.  This allows the monitoring system to understand in more detail the actual execution time of various operations.  This approach is illustrated in Figure 4.4. <br><img src="https://habrastorage.org/storage2/8a3/868/6ba/8a38686ba37c4c2e717239e5d9f6272e.gif"><br>  <b>Figure 4.4: Using transaction tracking to monitor EUE.</b> <br><br>  There is a large number of variations of these methods, as well as specialized software, with the help of which all this can be implemented.  To summarize, I would like to say that we must always remember that all this activity is aimed at measuring only one thing: EUE.  From this point of view, you are not trying to understand the state of your system performance, or to find the main source of the problem.  You are just trying to understand if there is a problem at all. <br><br><h5>  Monitoring from top to bottom: from EUE to the root of all evil </h5><br>  EUE is considered an extremely high level diagnostic;  she simply says - ‚Äúsomething went wrong,‚Äù but she doesn‚Äôt say specifically.  To understand the reasons, you need to return to the traditional monitoring system that you have always known and loved, only this time, you will no longer look in an empty place: you will look for the source of a guaranteed existing problem. <br><br>  By the way, this is <i>not the</i> moment to uncover special software - we discussed this in previous chapters.  You still intend to use a monitoring system that allows you to see everything on ‚Äúone glass‚Äù.  However, this does not necessarily mean a certain shell that unites specialized tools, it means a monitoring system that allows you to see each of your systems.  If you have a correct understanding of what should be the performance at the level of each component, then such a system can quickly tell you <i>where the</i> problem is.  And <i>only now</i> you can get a specialized tool and tackle a particular problem - again, knowing <i>where the</i> problem is and what component you are looking at is <i>really</i> its source. <br><br><blockquote>  <b>Where does EUE come from</b> <br>  Why can't you just use a more careful selection of boundary values ‚Äã‚Äãin your monitoring system, which monitors the state of your backend from which you can understand that EUE deviates from the expected values?  The reason is that EUE evaluates the performance of the entire system.  The database may run slower, but its behavior does not affect the rest of the infrastructure.  A slow-running router does not necessarily lead to a deterioration of the EUE, although in combination with other factors it can be a turning point.  That is why you need to look <i>directly</i> at how things are at the end users, and only <i>then</i> look for the root of all evil. </blockquote><br><br><h5>  Monitoring using agents vs agentless monitoring </h5><br>  There are many arguments in favor of each of the best ways to monitor.  Do you install agents?  Some people do this and believe that agents provide the most detailed way to provide information.  Others do not believe in the installation of agents and, quite rightly, indicate that not all elements of the environment can <i>in principle be</i> installed agents.  Routers or services located outside of your responsibility usually do not give any information to the monitoring software, or support it with restrictions. <br>  In one case, we can install agents, as shown in Figure 4.5. <br><img src="https://habrastorage.org/storage2/1cd/a0f/8af/1cda0f8af27d53c4e72aed337ac4a5dc.gif"><br>  <b>Figure 4.5: Monitoring by agents.</b> <br><br>  Usually agents return information to a centralized monitoring system.  Depending on the approach chosen, you can put these agents wherever they can <i>in principle</i> be installed, perhaps even on user computers for spot monitoring (although they usually try not to do this) <br><br>  Some monitoring solutions will allow you to do without installing agents on each system (you may not need to do this everywhere).  As shown in Figure 4.6, these solutions typically use external tools to evaluate system performance. <br><br><img src="https://habrastorage.org/storage2/8d6/e54/c64/8d6e54c641ef79c4cff9ddc239c7ca7b.gif"><br>  <b>Figure 4.6: Agentless Monitoring.</b> <br><br>  Whether agentless monitoring can collect a large amount of data, or in general, all data in principle depends largely on the type of components on your network and what technologies are used.  This is an important competitive point among many software vendors, and this requires close attention. <br><br>  The ‚Äúmonitoring provider‚Äù in Figure 4.6.  is my starting point if we are talking about modern applications.  You almost always have to deploy hybrid systems that rely partly on agents, and partly on agentless monitoring, if only because some of the monitoring objects will be outside of your data center. <br><br><h5>  Monitoring what doesn't belong to you </h5><br>  Equipment located outside our office and / or responsibility is the place where normal monitoring does not work.  It is unlikely that Amazon will send you detailed statistics on the performance of their Elastic Compute Cloud (EC2), Microsoft is unlikely to do the same for its Windows Azure.  SalesForce.com is not going to send you the response time values ‚Äã‚Äãof the DBMS or the utilization parameters of the central processors of their web servers.  Even the hosting company where you host your servers is not going to show you detailed information about the percentage of lost packets on your routers and other statistics from your infrastructure. <br><br>  But, generally, these numbers <i>are important</i> to you.  If you have an application that depends on cloud computing components, colocation servers, SaaS decisions, or <i>any</i> other outsourcing component, then the performance of these components will affect the <i>performance of your applications</i> and your EUE.  In short, if Amazon has performance problems, your users will have the same thing.  And this is where <i>hybrid monitoring</i> comes into play.  Figure 4.7 shows that it looks like some kind of external monitoring application that collects key performance information from most of the outsourced providers for cloud components.  The collected data is shown in red lines, the data that is transmitted to your central monitoring console is green. <br><br>  A lot of what I listed in previous chapters is starting to form one picture: <br><ul><li>  You need your internal systems and external components that are displayed in a single view.  There is no way to work with your subsystems as <i>a system</i> if you do not have the ability to assemble all the component parts into a single monitoring space. </li><li>  A key competitive feature for hybrid monitoring services is the number of external components that can be monitored.  Make sure that the solution you choose is able to monitor everything that you have, including services and equipment that is outsourced. </li><li>  Tracking EUE user expectations is important because there can be large fluctuations between external services and your use of them.  For example, you absolutely do not need to be aware of whether Azure responds slowly during periods when users do not use this service.  You need to pay attention to it, and receive notifications about its state only if <i>your</i> users experience problems while working with it. </li></ul><br><img src="https://habrastorage.org/storage2/4d0/a03/f5d/4d0a03f5dd44f5b8108222ddb075ddcf.gif"><br>  <b>Figure 4.7: Hybrid monitoring.</b> <br>  In fact, this way of monitoring external, outsourced components is key, because most organizations feel that they cannot rely on cloud computing.  ‚ÄúHow will we manage this?‚Äù, They ask themselves questions, ‚ÄúHow will we monitor it?‚Äù  In addition to data security, this is perhaps the most serious issue that arises when companies begin to consider adding ‚Äúclouds‚Äù to their portfolio of IT solutions.  They can be monitored <i>in this</i> way: using specialized monitoring services that add a ‚Äúcloud‚Äù to your single control screen.  Such tools place components outside the company at the same level of control as the local components and allow you to monitor them in a similar way. <br><br>  An interesting path that some vendors choose when developing an architecture for such solutions.  Many of them sell local solutions, which are in many ways similar to what is shown in Fig.  4.7.  In fact, they monitor the cloud components on the provider side, but at the same time send this information to you;  then their solution collects data from your local equipment and presents the information in a consolidated form. <br><br>  But this is not the only way.  In fig.  4.8.  shows a diagram of a <i>remote (hosted) monitoring solution</i> in which your <i>internal</i> performance information is sent to the cloud (shown by blue lines), then the cloud is combined with information about the performance of your cloud components (red lines) and displayed in a single view on the web. portal or some other way. <br><br><img src="https://habrastorage.org/storage2/e67/2d3/b87/e672d3b87d5152a623b79488ef9a5d28.png"><br>  <b>Figure 4.8: External, hybrid monitoring.</b> <br><br>  This is a rather interesting model that removes most of your responsibility for monitoring, which allows you to concentrate on the services provided to users.  But one should not think that it will be the right model for any organization, although, as an option, it should be considered. <br><br><h5>  Critical Limits: When you need to control <i>everything</i> </h5><br>  The last important element of the puzzle is to make sure that you monitor everything.  All-all-all !!!  See Figure 4.9, with the infrastructure we used throughout this chapter.  Is there anything missing on it?  If we track each of the components shown, will monitoring be sufficient? <br><img src="https://habrastorage.org/storage2/89f/c6e/217/89fc6e217b4f0e785c5577e60a863e60.gif"><br>  <b>Figure 4.9: Is everything here that needs to be controlled?</b> <br><br>  Definitely not.  In this scheme there are many gaps and for the most part these are things that can have a significant impact on performance.  Look at fig.4.10 - everything here is a little bit fuller and more detailed. <br><br><img src="https://habrastorage.org/storage2/569/a76/57d/569a7657d366ac4106a61e86c70591ae.gif"><br>  <b>Figure 4.10: Make sure you control everything.</b> <br><br>  Routers, switches, firewalls, directory service servers, DNS - external and internal, and perhaps much more.  If your EUE starts to deviate from the usual values, then navrenoe, you already have to look for the root of evil;  but you can only do this if your monitoring solution can <i>see</i> any potential source of the problem. <br><br>  It is for this reason that most monitoring solutions nowadays offer an autodiscovery function, and besides, there is always the possibility to add components yourself.  Autodiscovery can catch the missing items, about which no one even imagined that they are also part of the overall system.  Infrastructure elements such as marshurtizators and switches.  Dependencies between directory services and DNS.  Potential bottlenecks such as firewalls and proxy servers.  This is <i>all</i> important for normal operation, and it is necessary that everything be assembled into a single picture, through which the overall state of the system will be monitored. <br><br><h5>  Conclusion </h5><br>  Monitoring is a solution that allows us to manage the SLA, helps to find out the place where the problem originates, and helps us keep the systems in a state suitable for the business to perform their tasks.  But traditional monitoring does not always mean the only or best way to meet the needs of the business.  More importantly, as businesses increasingly depend on components outside their local systems, traditional monitoring cannot gather all the necessary information into a single space.  But these tasks are within the power of hybrid monitoring systems.  Using a combination of traditional monitoring techniques, obtaining performance data from cloud systems, as well as other methods, we can collect information about the health of systems into a single view, a common panel of indicators and a complete picture. <br><br><h5>  In the next chapter ... </h5><br>  In the next chapter, we turn to the fundamental problem that every organization has to contend with: <i>repeatability</i> .  In other words, after the problem is solved, how can you be able to solve it faster if it happens again?  We will look at how to turn problems into solutions and how we can improve the provision of services in the future. <br></div><p>Source: <a href="https://habr.com/ru/post/174493/">https://habr.com/ru/post/174493/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../174481/index.html">Mozilla offers to create "heavy" 3D-games for the web on their new engine</a></li>
<li><a href="../174483/index.html">One of the biggest DDoS attacks in history.</a></li>
<li><a href="../174485/index.html">Popcap gives away a free arcade game to Peggle</a></li>
<li><a href="../174489/index.html">Information security policy - development experience and recommendations</a></li>
<li><a href="../174491/index.html">There are several reasons for a messy and quick blog post.</a></li>
<li><a href="../174495/index.html">Dot rollback changes. Versioning 1C good or evil. The author's idea of ‚Äã‚Äãa system for collecting versions on 1C systems</a></li>
<li><a href="../174497/index.html">Samba 3 file server in Active Directory domain</a></li>
<li><a href="../174499/index.html">High Level APIs for Linux Containers</a></li>
<li><a href="../174501/index.html">GNOME 3.8 released</a></li>
<li><a href="../174503/index.html">Digitimes: Windows RT will no longer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>