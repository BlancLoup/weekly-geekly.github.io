<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Preparing your environment and compiling Shareaza today</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Shareaza is a free file-sharing client and download manager for Windows with support for Gnutella, Gnutella2, eDonkey2000, BitTorrent, DC ++, FTP and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Preparing your environment and compiling Shareaza today</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  Shareaza is a free file-sharing client and download manager for Windows with support for Gnutella, Gnutella2, eDonkey2000, BitTorrent, DC ++, FTP and HTTP protocols.  Able to work with magnet-, ED2K-, piolet- and Gnutella-links, as well as with standard HTTP- and FTP-links.  Translated into 27 languages. </blockquote><br>  ¬© Wikipedia <br><br>  So I decided to do a randomly sequential download in the Shareaza client. <br><br>  Looked at the code on the site.  <a href="">http://sourceforge.net/p/shareaza/code/9293/tree/trunk/shareaza/DownloadTransfer.cpp#l375</a> Apparently this is where all the magic happens.  But before the modifications you need to compile and install Shareaza.  About this and post. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Training. <br><br>  On the disc, I was overlooked with a document on how to prepare the environment and compile it.  Unfortunately, it is a bit outdated, so I upgraded it a bit. <br><br><div class="spoiler">  <b class="spoiler_title">A Quick Guide - How to setup Visual Studio 2008 on WinXP to compile builds of Shareaza</b> <div class="spoiler_text"><h2>  A Quick Guide - How to setup Visual Studio 2008 on WinXP to compile builds of Shareaza </h2><br>  1. Install: <br><br>  <b>Microsoft Visual Studio 2008</b> <br>  Full Edition. <br><br>  <b>Microsoft Visual C ++ 2008 Feature Pack</b> <br>  This fixes a lot of VS2008 errors. <br>  You can download the pack from <br>  <a href="http://www.microsoft.com/downloads/details.aspx%3FFamilyId%3DD466226B-8DAB-445F-A7B4-448B326C48E7%26amp%3Bdisplaylang%3Den">http://www.microsoft.com/downloads/details.aspx?FamilyId=D466226B-8DAB-445F-A7B4-448B326C48E7&amp;displaylang=en</a> <br><br>  <b>Microsoft Windows SDK</b> <br>  If you are installing the Windows SDK <br>  installed. <br>  In my case, Microsoft Windows v6.0A SDK was installed by default with Microsoft.Visual.Studio.Team.System.2008.Team.Suite. <br><br>  <b>Microsoft DirectX SDK</b> <br>  Must be August 2007 or earlier version, including March 2008, can be a file - dxtrans.h <br>  You can download August 2007 from <br>  <a href="http://www.microsoft.com/downloads/details.aspx%3FFamilyID%3D529f03be-1339-48c4-bd5a-8506e5acf571%26amp%3Bdisplaylang%3Den">http://www.microsoft.com/downloads/details.aspx?FamilyID=529f03be-1339-48c4-bd5a-8506e5acf571&amp;displaylang=en</a> <br>  or by using this direct link <br>  <a href="">http://download.microsoft.com/download/3/3/f/33f1af6e-c61b-4f14-a0de-3e9096ed4b3a/dxsdk_aug2007.exe</a> <br><br>  2. <b>Download &amp; copy gzip.exe</b> into your windows path eg.  C: \ WINDOWS \ system32 <br>  I am using version 1.2.4 which you can download from <a href="http://www.gzip.org/">http://www.gzip.org/</a> . <br><br>  3. To setup the boost library <b>download boost_1_54_0.zip</b> from <br>  <a href="http://sourceforge.net/project/showfiles.php%3Fgroup_id%3D7586%26amp%3Bpackage_id%3D8041">http://sourceforge.net/project/showfiles.php?group_id=7586&amp;package_id=8041</a> . <br>  The library. <br>  Uncompress boost_1_54_0.zip to your PC. <br><br>  4. <b>Add VS2008 Include Dir Listings</b> <br>  You need to make sure that <br>  Visual Studio is pointing to and including boost &amp; DirectX. <br>  Go to Tools -&gt; Options -&gt; Projects and Solutions -&gt; VC ++ Directories -&gt; Win 32 - Include Files <br>  Make sure you‚Äôre on the list.  If they are not there add them. <br>  ie C: \ Program Files \ boost_1_54_0 <br>  ie C: \ Program Files \ Microsoft DirectX SDK (August 2007) \ Include <br><br>  5. <b>Download and install Unicode Inno Setup QuickStart Pack self-installing package</b> from <br>  <a href="http://www.jrsoftware.org/isdl.php">http://www.jrsoftware.org/isdl.php</a> . <br>  Make sure you install the "Unicode Inno Setup QuickStart Pack" not the standard setup / install.  The "QuickStart Pack" doesn‚Äôt include componets.  Also make sure you install Inno on your C drive.  I‚Äôve been setting up the program for the last five years.  This is a script that has been adopted in the compiling.  To avoid this potential problem <br><br>  6. <b>Download and install TortoiseSVN</b> from <a href="http://tortoisesvn.net/">http://tortoisesvn.net</a> . <br>  Use TortoiseSVN "Checkout" with URL repository <br>  <a href="https://shareaza.svn.sourceforge.net/svnroot/shareaza/trunk/">https://shareaza.svn.sourceforge.net/svnroot/shareaza/trunk/</a> <br>  to download current code. <br><br>  Once all the above you can complile. <br><br>  Open in VS2008 the following source file \ vc9 \ Shareaza.sln <br>  This will open the "Solution" <br>  Go into Build -&gt; Configuration Manager and set Shareaza build config <br>  eg Configuration = Debug / Platform = Win32 <br>  Then select "Rebuild Solution" to start to compile <br>  Find the newly compiled installer in \ setup \ builds folder. <br><br>  The following is a review of the numbers and changes. <br>  <a href="">http://cia.vc/stats/project/shareaza/.rss</a> . <br><br>  As a side note, I found it up with VS2008 was less <br>  problematic than VS2005. <br><br>  Enjoy;) <br></div></div><br><br>  An attempt to compile Shareaza immediately after executing the instructions failed: <br>  1 It turned out that lost <pre> <code class="hljs objectivec"><code class="diff">. <br> <span class="hljs-number"><span class="hljs-number">2</span></span>     Windows <span class="hljs-number"><span class="hljs-number">7</span></span>   XP . <br> <span class="hljs-number"><span class="hljs-number">3</span></span>   RazaWebHook64.dll              . <br> <br> <b class="spoiler_title"> .</b> Index: setup/scripts/main.iss =================================================================== --- setup/scripts/main.iss (revision <span class="hljs-number"><span class="hljs-number">9293</span></span>) +++ setup/scripts/main.iss (working <span class="hljs-keyword"><span class="hljs-keyword">copy</span></span>) @@ <span class="hljs-number"><span class="hljs-number">-240</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span> +<span class="hljs-number"><span class="hljs-number">240</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span> @@ <span class="hljs-meta"><span class="hljs-meta">#endif Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\RatDVDReader.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\Win32\{#ConfigurationName}\RazaWebHook32.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly uninsrestartdelete sortfilesbyextension regserver noregerror -Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\x64\{#ConfigurationName}\RazaWebHook64.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly uninsrestartdelete sortfilesbyextension regserver noregerror +; Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\x64\{#ConfigurationName}\RazaWebHook64.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly uninsrestartdelete sortfilesbyextension regserver noregerror Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\SkinScanSKS.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\SWFPlugin.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\VirusTotal.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Index: shareaza/LibraryFolders.cpp =================================================================== --- shareaza/LibraryFolders.cpp (revision 9293) +++ shareaza/LibraryFolders.cpp (working copy) @@ -776,17 +776,17 @@ void CLibraryFolders::Maintain() { CQuickLock oLock( Library.m_pSection ); - +/*// CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; IShellLibrary &gt;</span></span></span><span class="hljs-meta"> pIShellLib; if ( ( Windows.dwMajorVersion &gt; 6 || ( Windows.dwMajorVersion == 6 &amp;&amp; Windows.dwMinorVersion &gt;= 1 ) ) &amp;&amp; Settings.Library.UseWindowsLibrary ) pIShellLib.CoCreateInstance( CLSID_ShellLibrary ); - +//*/ for ( POSITION pos = GetFolderIterator() ; pos ; ) { CLibraryFolder* pFolder = GetNextFolder( pos ); pFolder-&gt;Maintain( TRUE ); - +/*// if ( pIShellLib &amp;&amp; theApp.m_pfnSHCreateItemFromParsingName ) { CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; IShellItem &gt;</span></span></span><span class="hljs-meta"> psiFolder; @@ -794,8 +794,9 @@ if ( psiFolder ) pIShellLib-&gt;AddFolder( psiFolder ); } +//*/ } - +/*// if ( pIShellLib ) { pIShellLib-&gt;SetIcon( (LPCWSTR)CT2W( Skin.GetImagePath( IDR_LIBRARYFRAME ) ) ); @@ -803,6 +804,7 @@ CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; IShellItem &gt;</span></span></span><span class="hljs-meta"> psiLibrary; pIShellLib-&gt;SaveInKnownFolder( FOLDERID_UsersLibraries, CLIENT_NAME_T, LSF_OVERRIDEEXISTING, &amp;psiLibrary ); } +//*/ } ////////////////////////////////////////////////////////////////////// Index: shareaza/Shareaza.cpp =================================================================== --- shareaza/Shareaza.cpp (revision 9293) +++ shareaza/Shareaza.cpp (working copy) @@ -694,7 +694,7 @@ // oTasks.AddTask( _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"shareaza:command:search"</span></span></span><span class="hljs-meta">), _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">), LoadString( IDS_SEARCH_TASK ) + _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"..."</span></span></span><span class="hljs-meta">), theApp.m_strBinaryPath, - IDR_SEARCHFRAME ); // oTasks.AddTask( _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"shareaza:command:download"</span></span></span><span class="hljs-meta">), _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">), LoadString( IDS_DOWNLOAD_TASK ) + _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"..."</span></span></span><span class="hljs-meta">), theApp.m_strBinaryPath, - IDR_DOWNLOADSFRAME ); - // For VS2008: + /*/ For VS2008: CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; ICustomDestinationList &gt;</span></span></span><span class="hljs-meta"> pList; if ( SUCCEEDED( pList.CoCreateInstance( CLSID_DestinationList ) ) ) { @@ -724,6 +724,7 @@ VERIFY( SUCCEEDED( pList-&gt;CommitList() ) ); } + //*/ } return CWinApp::Register(); @@ -747,6 +748,7 @@ { SHAddToRecentDocs( SHARD_PATHW, lpszPathName ); +/*/ if ( Windows.dwMajorVersion &gt; 6 || ( Windows.dwMajorVersion == 6 &amp;&amp; Windows.dwMinorVersion &gt;= 1 ) ) { if ( m_pfnSHCreateItemFromParsingName ) @@ -759,6 +761,7 @@ } } } +//*/ } CDocument* CShareazaApp::OpenDocumentFile(LPCTSTR lpszFileName) Index: shareaza/StdAfx.h =================================================================== --- shareaza/StdAfx.h (revision 9293) +++ shareaza/StdAfx.h (working copy) @@ -173,6 +173,7 @@ #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;string&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;utility&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;vector&gt;</span></span></span><span class="hljs-meta"> +#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;limits&gt;</span></span></span><span class="hljs-meta"> // // Boost Index: shareaza/WndMain.cpp =================================================================== --- shareaza/WndMain.cpp (revision 9293) +++ shareaza/WndMain.cpp (working copy) @@ -435,7 +435,7 @@ // Task Bar - m_pTaskbar.CoCreateInstance( CLSID_TaskbarList ); +// m_pTaskbar.CoCreateInstance( CLSID_TaskbarList ); // Tray @@ -654,7 +654,7 @@ m_brshDockbar.DeleteObject(); - m_pTaskbar.Release(); +// m_pTaskbar.Release(); // Destroy main window CMDIFrameWnd::OnClose(); @@ -1581,7 +1581,7 @@ m_bTrayIcon = Shell_NotifyIcon( NIM_MODIFY, &amp;m_pTray ); } - // Task Bar + /*/ Task Bar if ( ! m_bTrayHide &amp;&amp; m_pTaskbar ) { CString sAppBarTip; @@ -1603,6 +1603,7 @@ } m_pTaskbar-&gt;SetThumbnailTooltip( hWnd, sAppBarTip ); } + //*/ } // This function runs some basic checks that everything is okay- disks, directories, local network is Index: shareaza/WndMain.h =================================================================== --- shareaza/WndMain.h (revision 9293) +++ shareaza/WndMain.h (working copy) @@ -90,7 +90,7 @@ BOOL m_bTrayIcon; // Is tray icon available? BOOL m_bTrayUpdate; // Is tray data need to be updated? NOTIFYICONDATA m_pTray; // Tray icon data - CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; ITaskbarList3 &gt;</span></span></span><span class="hljs-meta"> m_pTaskbar; // Windows task bar +// CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; ITaskbarList3 &gt;</span></span></span><span class="hljs-meta"> m_pTaskbar; // Windows task bar BOOL m_bTimer; CString m_sMsgStatus; DWORD m_nAlpha; // Main window transparency (0...255)</span></span></code></code> <div class="spoiler"> <code class="hljs objectivec"><b class="spoiler_title"><code class="diff">. <br> <span class="hljs-number"><span class="hljs-number">2</span></span>     Windows <span class="hljs-number"><span class="hljs-number">7</span></span>   XP . <br> <span class="hljs-number"><span class="hljs-number">3</span></span>   RazaWebHook64.dll              . <br> <br></code>  . Index: setup/scripts/main.iss =================================================================== --- setup/scripts/main.iss (revision <span class="hljs-number"><span class="hljs-number">9293</span></span>) +++ setup/scripts/main.iss (working <span class="hljs-keyword"><span class="hljs-keyword">copy</span></span>) @@ <span class="hljs-number"><span class="hljs-number">-240</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span> +<span class="hljs-number"><span class="hljs-number">240</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span> @@ <span class="hljs-meta"><span class="hljs-meta">#endif Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\RatDVDReader.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\Win32\{#ConfigurationName}\RazaWebHook32.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly uninsrestartdelete sortfilesbyextension regserver noregerror -Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\x64\{#ConfigurationName}\RazaWebHook64.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly uninsrestartdelete sortfilesbyextension regserver noregerror +; Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\x64\{#ConfigurationName}\RazaWebHook64.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly uninsrestartdelete sortfilesbyextension regserver noregerror Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\SkinScanSKS.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\SWFPlugin.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\VirusTotal.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Index: shareaza/LibraryFolders.cpp =================================================================== --- shareaza/LibraryFolders.cpp (revision 9293) +++ shareaza/LibraryFolders.cpp (working copy) @@ -776,17 +776,17 @@ void CLibraryFolders::Maintain() { CQuickLock oLock( Library.m_pSection ); - +/*// CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; IShellLibrary &gt;</span></span></span><span class="hljs-meta"> pIShellLib; if ( ( Windows.dwMajorVersion &gt; 6 || ( Windows.dwMajorVersion == 6 &amp;&amp; Windows.dwMinorVersion &gt;= 1 ) ) &amp;&amp; Settings.Library.UseWindowsLibrary ) pIShellLib.CoCreateInstance( CLSID_ShellLibrary ); - +//*/ for ( POSITION pos = GetFolderIterator() ; pos ; ) { CLibraryFolder* pFolder = GetNextFolder( pos ); pFolder-&gt;Maintain( TRUE ); - +/*// if ( pIShellLib &amp;&amp; theApp.m_pfnSHCreateItemFromParsingName ) { CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; IShellItem &gt;</span></span></span><span class="hljs-meta"> psiFolder; @@ -794,8 +794,9 @@ if ( psiFolder ) pIShellLib-&gt;AddFolder( psiFolder ); } +//*/ } - +/*// if ( pIShellLib ) { pIShellLib-&gt;SetIcon( (LPCWSTR)CT2W( Skin.GetImagePath( IDR_LIBRARYFRAME ) ) ); @@ -803,6 +804,7 @@ CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; IShellItem &gt;</span></span></span><span class="hljs-meta"> psiLibrary; pIShellLib-&gt;SaveInKnownFolder( FOLDERID_UsersLibraries, CLIENT_NAME_T, LSF_OVERRIDEEXISTING, &amp;psiLibrary ); } +//*/ } ////////////////////////////////////////////////////////////////////// Index: shareaza/Shareaza.cpp =================================================================== --- shareaza/Shareaza.cpp (revision 9293) +++ shareaza/Shareaza.cpp (working copy) @@ -694,7 +694,7 @@ // oTasks.AddTask( _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"shareaza:command:search"</span></span></span><span class="hljs-meta">), _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">), LoadString( IDS_SEARCH_TASK ) + _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"..."</span></span></span><span class="hljs-meta">), theApp.m_strBinaryPath, - IDR_SEARCHFRAME ); // oTasks.AddTask( _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"shareaza:command:download"</span></span></span><span class="hljs-meta">), _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">), LoadString( IDS_DOWNLOAD_TASK ) + _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"..."</span></span></span><span class="hljs-meta">), theApp.m_strBinaryPath, - IDR_DOWNLOADSFRAME ); - // For VS2008: + /*/ For VS2008: CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; ICustomDestinationList &gt;</span></span></span><span class="hljs-meta"> pList; if ( SUCCEEDED( pList.CoCreateInstance( CLSID_DestinationList ) ) ) { @@ -724,6 +724,7 @@ VERIFY( SUCCEEDED( pList-&gt;CommitList() ) ); } + //*/ } return CWinApp::Register(); @@ -747,6 +748,7 @@ { SHAddToRecentDocs( SHARD_PATHW, lpszPathName ); +/*/ if ( Windows.dwMajorVersion &gt; 6 || ( Windows.dwMajorVersion == 6 &amp;&amp; Windows.dwMinorVersion &gt;= 1 ) ) { if ( m_pfnSHCreateItemFromParsingName ) @@ -759,6 +761,7 @@ } } } +//*/ } CDocument* CShareazaApp::OpenDocumentFile(LPCTSTR lpszFileName) Index: shareaza/StdAfx.h =================================================================== --- shareaza/StdAfx.h (revision 9293) +++ shareaza/StdAfx.h (working copy) @@ -173,6 +173,7 @@ #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;string&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;utility&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;vector&gt;</span></span></span><span class="hljs-meta"> +#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;limits&gt;</span></span></span><span class="hljs-meta"> // // Boost Index: shareaza/WndMain.cpp =================================================================== --- shareaza/WndMain.cpp (revision 9293) +++ shareaza/WndMain.cpp (working copy) @@ -435,7 +435,7 @@ // Task Bar - m_pTaskbar.CoCreateInstance( CLSID_TaskbarList ); +// m_pTaskbar.CoCreateInstance( CLSID_TaskbarList ); // Tray @@ -654,7 +654,7 @@ m_brshDockbar.DeleteObject(); - m_pTaskbar.Release(); +// m_pTaskbar.Release(); // Destroy main window CMDIFrameWnd::OnClose(); @@ -1581,7 +1581,7 @@ m_bTrayIcon = Shell_NotifyIcon( NIM_MODIFY, &amp;m_pTray ); } - // Task Bar + /*/ Task Bar if ( ! m_bTrayHide &amp;&amp; m_pTaskbar ) { CString sAppBarTip; @@ -1603,6 +1603,7 @@ } m_pTaskbar-&gt;SetThumbnailTooltip( hWnd, sAppBarTip ); } + //*/ } // This function runs some basic checks that everything is okay- disks, directories, local network is Index: shareaza/WndMain.h =================================================================== --- shareaza/WndMain.h (revision 9293) +++ shareaza/WndMain.h (working copy) @@ -90,7 +90,7 @@ BOOL m_bTrayIcon; // Is tray icon available? BOOL m_bTrayUpdate; // Is tray data need to be updated? NOTIFYICONDATA m_pTray; // Tray icon data - CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; ITaskbarList3 &gt;</span></span></span><span class="hljs-meta"> m_pTaskbar; // Windows task bar +// CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; ITaskbarList3 &gt;</span></span></span><span class="hljs-meta"> m_pTaskbar; // Windows task bar BOOL m_bTimer; CString m_sMsgStatus; DWORD m_nAlpha; // Main window transparency (0...255)</span></span></b></code> <div class="spoiler_text"> <code class="hljs objectivec"><code class="diff">. <br> <span class="hljs-number"><span class="hljs-number">2</span></span>     Windows <span class="hljs-number"><span class="hljs-number">7</span></span>   XP . <br> <span class="hljs-number"><span class="hljs-number">3</span></span>   RazaWebHook64.dll              . <br> <br></code> <b class="spoiler_title"> .</b> Index: setup/scripts/main.iss =================================================================== --- setup/scripts/main.iss (revision <span class="hljs-number"><span class="hljs-number">9293</span></span>) +++ setup/scripts/main.iss (working <span class="hljs-keyword"><span class="hljs-keyword">copy</span></span>) @@ <span class="hljs-number"><span class="hljs-number">-240</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span> +<span class="hljs-number"><span class="hljs-number">240</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span> @@ <span class="hljs-meta"><span class="hljs-meta">#endif Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\RatDVDReader.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\Win32\{#ConfigurationName}\RazaWebHook32.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly uninsrestartdelete sortfilesbyextension regserver noregerror -Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\x64\{#ConfigurationName}\RazaWebHook64.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly uninsrestartdelete sortfilesbyextension regserver noregerror +; Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\x64\{#ConfigurationName}\RazaWebHook64.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly uninsrestartdelete sortfilesbyextension regserver noregerror Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\SkinScanSKS.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\SWFPlugin.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Source: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{#Compiler}\{#PlatformName}\{#ConfigurationName}\VirusTotal.dll"</span></span></span><span class="hljs-meta">; DestDir: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"{app}"</span></span></span><span class="hljs-meta">; Flags: overwritereadonly replacesameversion restartreplace uninsremovereadonly sortfilesbyextension regserver Index: shareaza/LibraryFolders.cpp =================================================================== --- shareaza/LibraryFolders.cpp (revision 9293) +++ shareaza/LibraryFolders.cpp (working copy) @@ -776,17 +776,17 @@ void CLibraryFolders::Maintain() { CQuickLock oLock( Library.m_pSection ); - +/*// CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; IShellLibrary &gt;</span></span></span><span class="hljs-meta"> pIShellLib; if ( ( Windows.dwMajorVersion &gt; 6 || ( Windows.dwMajorVersion == 6 &amp;&amp; Windows.dwMinorVersion &gt;= 1 ) ) &amp;&amp; Settings.Library.UseWindowsLibrary ) pIShellLib.CoCreateInstance( CLSID_ShellLibrary ); - +//*/ for ( POSITION pos = GetFolderIterator() ; pos ; ) { CLibraryFolder* pFolder = GetNextFolder( pos ); pFolder-&gt;Maintain( TRUE ); - +/*// if ( pIShellLib &amp;&amp; theApp.m_pfnSHCreateItemFromParsingName ) { CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; IShellItem &gt;</span></span></span><span class="hljs-meta"> psiFolder; @@ -794,8 +794,9 @@ if ( psiFolder ) pIShellLib-&gt;AddFolder( psiFolder ); } +//*/ } - +/*// if ( pIShellLib ) { pIShellLib-&gt;SetIcon( (LPCWSTR)CT2W( Skin.GetImagePath( IDR_LIBRARYFRAME ) ) ); @@ -803,6 +804,7 @@ CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; IShellItem &gt;</span></span></span><span class="hljs-meta"> psiLibrary; pIShellLib-&gt;SaveInKnownFolder( FOLDERID_UsersLibraries, CLIENT_NAME_T, LSF_OVERRIDEEXISTING, &amp;psiLibrary ); } +//*/ } ////////////////////////////////////////////////////////////////////// Index: shareaza/Shareaza.cpp =================================================================== --- shareaza/Shareaza.cpp (revision 9293) +++ shareaza/Shareaza.cpp (working copy) @@ -694,7 +694,7 @@ // oTasks.AddTask( _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"shareaza:command:search"</span></span></span><span class="hljs-meta">), _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">), LoadString( IDS_SEARCH_TASK ) + _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"..."</span></span></span><span class="hljs-meta">), theApp.m_strBinaryPath, - IDR_SEARCHFRAME ); // oTasks.AddTask( _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"shareaza:command:download"</span></span></span><span class="hljs-meta">), _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">), LoadString( IDS_DOWNLOAD_TASK ) + _T(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"..."</span></span></span><span class="hljs-meta">), theApp.m_strBinaryPath, - IDR_DOWNLOADSFRAME ); - // For VS2008: + /*/ For VS2008: CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; ICustomDestinationList &gt;</span></span></span><span class="hljs-meta"> pList; if ( SUCCEEDED( pList.CoCreateInstance( CLSID_DestinationList ) ) ) { @@ -724,6 +724,7 @@ VERIFY( SUCCEEDED( pList-&gt;CommitList() ) ); } + //*/ } return CWinApp::Register(); @@ -747,6 +748,7 @@ { SHAddToRecentDocs( SHARD_PATHW, lpszPathName ); +/*/ if ( Windows.dwMajorVersion &gt; 6 || ( Windows.dwMajorVersion == 6 &amp;&amp; Windows.dwMinorVersion &gt;= 1 ) ) { if ( m_pfnSHCreateItemFromParsingName ) @@ -759,6 +761,7 @@ } } } +//*/ } CDocument* CShareazaApp::OpenDocumentFile(LPCTSTR lpszFileName) Index: shareaza/StdAfx.h =================================================================== --- shareaza/StdAfx.h (revision 9293) +++ shareaza/StdAfx.h (working copy) @@ -173,6 +173,7 @@ #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;string&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;utility&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;vector&gt;</span></span></span><span class="hljs-meta"> +#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;limits&gt;</span></span></span><span class="hljs-meta"> // // Boost Index: shareaza/WndMain.cpp =================================================================== --- shareaza/WndMain.cpp (revision 9293) +++ shareaza/WndMain.cpp (working copy) @@ -435,7 +435,7 @@ // Task Bar - m_pTaskbar.CoCreateInstance( CLSID_TaskbarList ); +// m_pTaskbar.CoCreateInstance( CLSID_TaskbarList ); // Tray @@ -654,7 +654,7 @@ m_brshDockbar.DeleteObject(); - m_pTaskbar.Release(); +// m_pTaskbar.Release(); // Destroy main window CMDIFrameWnd::OnClose(); @@ -1581,7 +1581,7 @@ m_bTrayIcon = Shell_NotifyIcon( NIM_MODIFY, &amp;m_pTray ); } - // Task Bar + /*/ Task Bar if ( ! m_bTrayHide &amp;&amp; m_pTaskbar ) { CString sAppBarTip; @@ -1603,6 +1603,7 @@ } m_pTaskbar-&gt;SetThumbnailTooltip( hWnd, sAppBarTip ); } + //*/ } // This function runs some basic checks that everything is okay- disks, directories, local network is Index: shareaza/WndMain.h =================================================================== --- shareaza/WndMain.h (revision 9293) +++ shareaza/WndMain.h (working copy) @@ -90,7 +90,7 @@ BOOL m_bTrayIcon; // Is tray icon available? BOOL m_bTrayUpdate; // Is tray data need to be updated? NOTIFYICONDATA m_pTray; // Tray icon data - CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; ITaskbarList3 &gt;</span></span></span><span class="hljs-meta"> m_pTaskbar; // Windows task bar +// CComPtr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; ITaskbarList3 &gt;</span></span></span><span class="hljs-meta"> m_pTaskbar; // Windows task bar BOOL m_bTimer; CString m_sMsgStatus; DWORD m_nAlpha; // Main window transparency (0...255)</span></span></code> </div></div></pre><br></div><p>Source: <a href="https://habr.com/ru/post/191748/">https://habr.com/ru/post/191748/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../191738/index.html">Dell Webcast: Alienware Line Update</a></li>
<li><a href="../191740/index.html">Virtuilarks arrived!</a></li>
<li><a href="../191742/index.html">Hackay Transcend WiFi SDHC memory card</a></li>
<li><a href="../191744/index.html">GetThemAll or take the best from the Internet!</a></li>
<li><a href="../191746/index.html">Rights holders and the Internet - from dispute to the market. Yandex Position</a></li>
<li><a href="../191750/index.html">Google Translate: a guide for the complete idiot</a></li>
<li><a href="../191754/index.html">In the Windows Phone Store for $ 19</a></li>
<li><a href="../191756/index.html">IMAP on boost :: asio</a></li>
<li><a href="../191758/index.html">Moto X officially went on sale</a></li>
<li><a href="../191762/index.html">Various methods for loading associations in Ruby on Rails</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>