<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Query Profiler in Phoenix. And a little bit about how stacktrace works in Elixir / Erlang</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In our company, we use Elixir, the framework Phoenix and Ecto. And recently at work I was given the task of making a query profiler in the database in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Query Profiler in Phoenix. And a little bit about how stacktrace works in Elixir / Erlang</h1><div class="post__text post__text-html js-mediator-article"><p>  In our company, we use Elixir, the framework Phoenix and Ecto.  And recently at work I was given the task of making a query profiler in the database in order to find out the narrow points of the system that should be optimized.  Thus the tasks were the following: </p><br><ol><li>  Find out which functions are most often applied to the database (query calls) </li><li>  Find out which functions create the longest and slowest queries (query time) </li><li>  Results must be accumulated and displayed as a list / graph. </li></ol><br><p>  Like everything, I initially decided to try existing solutions.  A simple Google search gave me a few articles, and some solutions a la: </p><br><p>  <a href="https://github.com/parroty/exprof">https://github.com/parroty/exprof</a> <br>  <a href="http://erlang.org/doc/man/fprof.html">http://erlang.org/doc/man/fprof.html</a> <br>  <a href="https://github.com/proger/eflame">https://github.com/proger/eflame</a> <br>  <a href="https://github.com/TheRealReal/new-relixir">https://github.com/TheRealReal/new-relixir</a> </p><br><p>  and etc. </p><br><p>  A quick inspection immediately made it clear that existing solutions are not suitable.  Some do not allow to accumulate results, some even consider general calls and no matter whether the database is there or not, something is paid and also does not have the necessary functionality.  Having scratched a turnip, I realized that I would have to write my own personal profiler. </p><a name="habracut"></a><br><div style="text-align:center;"><img src="http://demotivation.me/images/20090810/oje0xu5ksgn4.jpg" alt="image"></div><br><br><p>  Fortunately, Ecto (DSL for working with the database) has the ability to configure the logger and see all the information after the execution of the request, as follows: </p><br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">config</span></span> <span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:my_greap_app</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">MyGreatApp</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Repo</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">loggers</span></span>: <span class="hljs-selector-attr"><span class="hljs-selector-attr">[{EctoProfiler, :log, []</span></span>}]</code> </pre> <br><p>  This means that we can write our own module with the name <strong>EctoProfiler,</strong> which necessarily has a public <strong>log</strong> function that takes one argument.  And do something interesting inside this function.  In particular, look at the information that this argument contains, and it contains a <a href="https://hexdocs.pm/ecto/Ecto.LogEntry.html">lot of things</a> and almost everything we need, but unfortunately does not contain information about where the call came from. </p><br><h3 id="stacktrace">  Stacktrace </h3><br><p>  This is where stacktrace comes on the scene.  You can call and view information about it in elixir in various ways.  I will use the Process module method: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">Process</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.info</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">self</span></span>(), <span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:current_stacktrace)</span></span></code> </pre> <br><p>  But, there are some nuances.  See the module below: </p><br><pre> <code class="hljs ruby">defmodule StacktraceTest <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> @moduledoc <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">-</span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">&gt;</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.() <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-function"> {:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ok</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>} <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> after {<span class="hljs-symbol"><span class="hljs-symbol">:ok</span></span>, f()} <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">raise</span></span></span><span class="hljs-function"> "</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fail</span></span></span><span class="hljs-function">" </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rescue</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">-</span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">&gt;</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">g</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IO</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inspect</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Process</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">info</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">self</span></span></span></span><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:current_stacktrace</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">g</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Process</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">info</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">self</span></span></span></span><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:current_stacktrace</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  The question is a million dollars.  What do we get at points <strong>f</strong> and <strong>g</strong> when running <code>StacktraceTest.a</code> ? </p><br><p>  I'm sure not every experienced elixir-ist will correctly answer it. </p><br><p>  By running this module, and calling the function, we get the following: </p><br><pre> <code class="hljs ruby">iex(<span class="hljs-number"><span class="hljs-number">2</span></span>)&gt;{<span class="hljs-symbol"><span class="hljs-symbol">:current_stacktrace</span></span>, [ {Process, <span class="hljs-symbol"><span class="hljs-symbol">:info</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'lib/process.ex'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">646</span></span>]}, {StacktraceTest, <span class="hljs-symbol"><span class="hljs-symbol">:f</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'iex'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">29</span></span>]}, {StacktraceTest, <span class="hljs-symbol"><span class="hljs-symbol">:</span><span class="hljs-string"><span class="hljs-symbol"><span class="hljs-string">"-d/0-after$^0/0-0-"</span></span></span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'iex'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span>]}, {StacktraceTest, <span class="hljs-symbol"><span class="hljs-symbol">:d</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'iex'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span>]}, {StacktraceTest, <span class="hljs-symbol"><span class="hljs-symbol">:c</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'iex'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span>]}, {<span class="hljs-symbol"><span class="hljs-symbol">:erl_eval</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:do_apply</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'erl_eval.erl'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">670</span></span>]}, {<span class="hljs-symbol"><span class="hljs-symbol">:elixir</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:eval_forms</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'src/elixir.erl'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">233</span></span>]} ]} {<span class="hljs-symbol"><span class="hljs-symbol">:ok</span></span>, {<span class="hljs-symbol"><span class="hljs-symbol">:current_stacktrace</span></span>, [ {Process, <span class="hljs-symbol"><span class="hljs-symbol">:info</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'lib/process.ex'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">646</span></span>]}, {StacktraceTest, <span class="hljs-symbol"><span class="hljs-symbol">:d</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'iex'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span>]}, {StacktraceTest, <span class="hljs-symbol"><span class="hljs-symbol">:c</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'iex'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span>]}, {<span class="hljs-symbol"><span class="hljs-symbol">:erl_eval</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:do_apply</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'erl_eval.erl'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">670</span></span>]}, {<span class="hljs-symbol"><span class="hljs-symbol">:elixir</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:eval_forms</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'src/elixir.erl'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">233</span></span>]}, {IEx.Evaluator, <span class="hljs-symbol"><span class="hljs-symbol">:handle_eval</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'lib/iex/evaluator.ex'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">245</span></span>]}, {IEx.Evaluator, <span class="hljs-symbol"><span class="hljs-symbol">:do_eval</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, [<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span> <span class="hljs-string"><span class="hljs-string">'lib/iex/evaluator.ex'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">line:</span></span> <span class="hljs-number"><span class="hljs-number">225</span></span>]} ]}}</code> </pre> <br><p>  Above is what the function <strong>f produced</strong> , below - <strong>g</strong> .  It seems everything is cool, the information is exhaustive, but no.  Attentive reader, immediately ask, but where are the function calls <strong>a</strong> , <strong>b</strong> ? </p><br><p>  Here we come to the most interesting. </p><br><p>  <strong>If function <u><em>a</em></u> returns the same value that function <u><em>b</em></u> (tail chain) returns, then function <u><em>a</em></u> does not fall into stacktrace.</strong>  This is a consequence of the optimization of the last call, the so-called tail recursion in Erlang / Elixir.  Each function call in the tail means that the stack frame for the calling function is destroyed.  This behavior is BEAM (Erlang VM).  And it is impossible to change anything here without rewriting the virtual machine code.  A detailed discussion was here <a href="https://github.com/elixir-lang/elixir/issues/6357">https://github.com/elixir-lang/elixir/issues/6357</a> </p><br><p>  Therefore, the function <strong>e</strong> is also not included in stacktrace.  <code>rescue/catch</code> are end calls, but <code>after</code> (in the <strong>d</strong> function) is not. </p><br><p>  Unfortunately, Stacktrace also contains no arguments, called functions.  This means that you will not be able to detail the information in <code>handle_info</code> and other callbacks regarding the messages that are being called.  The reason also lies in the way Erlang handles the stack.  Since it is stored for some time, and the arguments can be arbitrarily large, the stacktrace in this case would eat all the memory.  This is by the way the reason that Erlang plans to redo the processing and storage of the call stack in case of errors (there are just arguments).  There is a <a href="https://github.com/elixir-lang/elixir/issues/7097">discussion</a> about this. </p><br><p>  Someone will ask why I did not use the standard <code>debugger</code> that comes out of the box in Erlang and which saves the arguments.  I thought about it, but <code>debugger</code> does not allow saving the call frame in a variable and then processing this data in any way.  Only in the file or in the console.  Therefore, the decision with him disappeared immediately. </p><br><p>  So we received a call frame.  All the relevant information we have.  Time to process it. </p><br><h2 id="profilirovschik">  Profiler </h2><br><p>  Using all this information was written by your own profiler.  I will not give here a detailed description of his work with code examples.  Who is interested - can get acquainted with him on <a href="https://github.com/DmitryKK/ecto_profiler"><strong>github</strong></a> </p><br><p>  Here I will only briefly describe the principle of operation: </p><br><ol><li>  We receive information about the query in the database (in particular, the query time - <code>query_time</code> ), which is transmitted to us by Ecto </li><li>  We retrieve the call frame </li><li>  We leave only those modules created within the application from the stektrais (all dependency modules and Elixir itself are excluded) </li><li>  We save the data in two tables Mnesia (data is not stored on disk, but stored only in memory): <br><ul><li>  with a unique key of the form <code>Module.function/arity</code> </li><li>  with a unique key equal to the resulting frame rate </li></ul></li><li>  Both tables contain a key and attributes: <code>calls</code> - number of requests, <code>query_time</code> - total time of requests.  The table with the trace also contains information about the function where the call came first in the stack. </li><li>  Each new call increments the counter <code>calls</code> and <code>query_time</code> . </li><li>  The data is formatted and output as a list via the web interface (the interface also added information about the average query time equal to query_time / calls). </li></ol><br><h2 id="itogo">  Total </h2><br><p>  Unfortunately, the solution has drawbacks related to the operation of the glasstrack described above.  But you can easily get information about how your application works and draw conclusions about optimization. </p><br><p>  PS As for the plugin itself.  I will be glad to any additions and PR.  Maybe someone add buns and make a beautiful interface :) </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/347146/">https://habr.com/ru/post/347146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347132/index.html">We comprehend C deeper using assembler. Part 3</a></li>
<li><a href="../347134/index.html">16 Tons. How I saved a dying WordPress site with very superficial knowledge of this CMS</a></li>
<li><a href="../347138/index.html">Making games in Python 3 and Pygame: Part 1</a></li>
<li><a href="../347140/index.html">How to cook AR on android</a></li>
<li><a href="../347144/index.html">CoffeeMiner: hacking WiFi to embed a crypto miner in HTML pages</a></li>
<li><a href="../347148/index.html">The digest of interesting materials for the mobile # 237 developer (January 15-21)</a></li>
<li><a href="../347152/index.html">Account Manager: accounts, tokens and all-all-all. Yandex lecture</a></li>
<li><a href="../347154/index.html">Service control panel. Part 2. On the way to the frontend</a></li>
<li><a href="../347158/index.html">Even faster acceleration of WebAssembly: new streaming and layered compiler in Firefox</a></li>
<li><a href="../347160/index.html">Quantum race: 2017 developments</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>