<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Access to the information. Internal audit</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tedious Brief Introduction. 
 As a rule, when protecting information, the entire security perimeter is built from the outside. Probably logical becaus...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Access to the information. Internal audit</h1><div class="post__text post__text-html js-mediator-article"><h4>  <s>Tedious</s> Brief Introduction. </h4><br>  As a rule, when protecting information, the entire security perimeter is built from the outside.  Probably logical because  the main threats are coming from there.  But the search for vulnerabilities from the outside is quite a laborious and creative exercise, involving the search for holes in php, SQL injection, network vulnerabilities, searching a couple of billions of md5 hashes, etc. <br><br>  This leaves out of consideration the possibility of access to information from within.  Which is protected as a rule is much weaker.  Apparently it is believed that if there are holes - they are all outside - because  inside something monolithic and impenetrable.  <s>Alas</s> Fortunately, this is not the case (Information gives work on both sides of the front).  After all, it is insider information that is most valuable from all angles and is becoming increasingly valuable. <br><br>  So.  In my short article I want to slightly immerse the reader in the slightly childlike and naive world of large organizations, where the majority believe in <s>Santa Claus</s> words: everything is very good and ‚Äúwho will break the inside?‚Äù. <br><img src="https://habrastorage.org/storage2/3cf/d0c/571/3cfd0c5717d8f13417bec4133ad09e4a.jpg"><br><a name="habracut"></a><br><h4>  Situation: </h4><br><ul><li>  Big company (thousands of PCs) </li><li>  Availability of database and software of own or third-party developers </li><li>  There is no pass-through authentication between the domain account, database and software.  Those.  dozens of applications - everywhere your login and password </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Classic problems: </h4><br><ul><li>  Shaggy programs are not obvious enough and changing the password is difficult.  Those.  after the user's entry, he continues to use the password given to him.  Often, the user even thinks that it is necessary.  I personally used the application from one of the largest corporations in the world every day many times, and only 2 years later I found a dialogue with the proposal to change the password.  Before that, I used the standard password ‚Äú12345‚Äù </li><li>  In large firms, a large staff turnover.  An annual turnover of 10-30% of staff is ridiculous for a firm of 10, 20 or 50 people.  And if the company has 1,000 people?  Those.  several hundred people annually leave and, of <s>course,</s> as a rule, access to the domain is blocked.  What about other applications? </li><li>  And if the employee did not quit, and moved from one unit to another?  For example, the former domain administrator and moved to the business unit.  The perfect insider through which you can get all the information about the company.  He not only knows where the key information of the company is, but how to get it. </li><li>  The employee goes on a very long vacation.  Do everyone remember to block access in these cases? </li><li>  An employee does not leave or translate anywhere.  But it uses the password "" (no password) or "12345678" </li><li>  All of the above problems can be multiplied by human negligence, laziness and the banal overloading of personnel service and iT, which already lack enough turnover. <br>  In general, the result of this list of problems - the larger the company, the more internal problems it accumulates.  Because  in small ones, as a rule, everything is tied to a domain, 1C and a pair of standard software complexes </li></ul><br><br><h4>  Solutions (Ideally) </h4><br><ul><li>  user training (‚Äúmeaning? teach - tomorrow quit‚Äù - management response) </li><li>  tie everything to the domain and to the domain account (technically it is not always realizable, it requires, as a rule, money and resources that are difficult to justify) </li><li>  get rid of the keyboard password, with reference to the tangible medium (difficulties in using specialized software and hardware, as well as constant ‚Äúoh - forgotten at home‚Äù and combating it - screwing the hardware key to the reader connector) </li><li>  use "captcha", limiting login attempts by the number of attempts, ip-address and other creative approaches in self-written software </li></ul><br><br><h4>  Solutions (in practice) </h4><br><ul><li>  wait for an incident - plug a specific hole </li><li>  regular perimeter audit </li></ul><br>  The last pro-active option, which I want to consider in practice.  A general algorithm that fits most applications: <br><ol><li>  open the list of employees </li><li>  open the program </li><li>  we select application for check </li><li>  enter the login / password combinations until the list of employees and simple passwords is over </li></ol><br><img src="https://habrastorage.org/storage2/d85/d79/1fd/d85d791fdc5edc40a13d5742a2afe9b8.jpg"><br><br>  Agree - nothing complicated, but rather time-consuming process if done by hand.  Even the "sweetness" of victory - the detection of 1.2, well, or 100 "bad guys" will not give anything.  After a few months, when you re-check, you will have to shovel the entire list + bonus in the form of new employees.  Need to automate. <br><br>  You can write on anything.  Personally, I will not break copies - previously I did such things on Delphi and VS, but after a casual acquaintance with the scripting language AutoIT stopped on it.  This piece is just made for the FAST writing of click-intro universal utility tools.  Those.  when there is no goal to count 9 ^ 9 ^ 9 combinations per second as hashes, working directly with the API application (especially if it is under Citrix), and it‚Äôs enough to click on a dozen different applications across several password combinations ‚Äî for the real list of employees. <br><br>  As the simplest example in my article, I want to set an example of an audit of Internet access in an organization. <br><br><h4>  Specific example </h4><br>  Squid-proxy.  There is no limit on password selection.  Those.  it is possible to go through logins until the blue one at a high speed also in parallel.  But let's be honest - the result in 1 minute or a few days - it does not matter.  The speed of checking one password is about 5 seconds per one account.  The main thing is the lack of manual labor and so far the only program in the world sorting out passwords on a proxy server is enough for success.  Leaving in the evening from work, we start, in the morning we are reaping the result. <br>  The results of the scan in my case I do not publish, because  they were <s>shocking</s> sad. <br><br><pre><code class="html hljs xml">; (c) lokkii ; ProxyLoginChecker v. 0.1 beta ; 1)     (passwd)  Squid    Win- (  -8)      ; 2)    : out.txt    ,   ,    ,    log.txt        login:time $file_in = FileOpen("passwd", 0) ;        If $file_in = -1 Then MsgBox(0, "Error", "    passwd") Exit EndIf $file_out = FileOpen("out.txt", 2) ;     If $file_out = -1 Then MsgBox(0, "Error", "    out.txt") Exit EndIf $file_log = FileOpen("log.txt", 2) ;     If $file_log = -1 Then MsgBox(0, "Error", "    log.txt") Exit EndIf ;      ,     While 1 $line = FileReadLine($file_in) if @error = -1 Then ExitLoop ;      squid ; : ;pupkin_pp:x:544:502:%  :/dev/null:/dev/null ; : $login = pupkin_pp ; $pwd = pup123 ; $fio =    $login = StringLeft($line, StringInStr($line, ":x:")-1+‚Äù_Nov-filial‚Äù); "pupkin_pp_Nov-filial" $pwd = StringLeft($login, 3) &amp; ‚Äú123‚Äù; ‚Äúpup123" $line = StringTrimLeft( $line, StringInStr($line, "502:")+3 ) ;     $line = StringTrimLeft( $line, StringInStr($line, "%")) ;     (  )  "%" -  $fio = StringReplace ( $line, ":/dev/null:/dev/null", "") ;    $proxy = "192.168.0.1:8080" HttpSetProxy ( 2 , $proxy , $login, $pwd); $size = InetGetSize("http://        /.txt") if $size == 33333 then FileWriteLine($file_out, $login &amp; ";"&amp; $pwd &amp; ";" &amp; $fio &amp; @CRLF) FileWriteLine($file_log, $login &amp; ";" &amp; @HOUR &amp; ":" &amp; @MIN &amp; ":" &amp; @SEC &amp; @CRLF) Wend FileClose($file_in) FileClose($file_out) FileClose($file_log)</code> </pre> <br><br><h4>  findings </h4><br>  Now you can <s>burn someone else‚Äôs traffic and crawl on porn sites with SPECIAL content, exposing your colleague, hindering your career growth,</s> to conclude about the quality of passwords in the whole organization.  And think about the organizational measures to remedy the situation. <br>  Thanks for reading!  I hope that the article was interesting for you (only the source code was omitted), makes you think and bring new ideas to your work. <br><br>  ps  Though I prefer to use passwords like ‚Äúpassword‚Äù, on Wi-Fi access points ‚Äú123456789‚Äù, etc.  But nevertheless I cry - do not do it! </div><p>Source: <a href="https://habr.com/ru/post/149859/">https://habr.com/ru/post/149859/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149853/index.html">DVelum - PHP + ExtJS4 development platform</a></li>
<li><a href="../149855/index.html">How are arduino born</a></li>
<li><a href="../149856/index.html">Creative Sound Blaster Recon3D Omega Wireless Wireless Headset Overview</a></li>
<li><a href="../149857/index.html">Lua: how to stop embedding and start living</a></li>
<li><a href="../149858/index.html">The experience of organizing WiFi at the conference</a></li>
<li><a href="../149860/index.html">About the color of the sky</a></li>
<li><a href="../149861/index.html">More than a watch: a review of the Sony SmartWatch</a></li>
<li><a href="../149862/index.html">Latin America on the side of Ecuador</a></li>
<li><a href="../149863/index.html">A selection of CSS3 generators to simplify front-end development</a></li>
<li><a href="../149864/index.html">Menu with smooth color inversion</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>