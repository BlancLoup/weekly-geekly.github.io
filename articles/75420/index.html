<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>jQuery plugin for receiving form data + ajax file uploader</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear Habroskoobschestvo! Without trying to hide the excitement, I publish my first post, the theme of which was my modest jQuery-bike for qu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>jQuery plugin for receiving form data + ajax file uploader</h1><div class="post__text post__text-html js-mediator-article"><img src="http://img21.imageshack.us/img21/8959/jquery.jpg" alt="image" align="left">  Good day, dear Habroskoobschestvo!  Without trying to hide the excitement, I publish my first post, the theme of which was my modest jQuery-bike for quick and painless collection of data entered by the user on the page (just a small reservation for those who scream - ‚Äúfuck him! Why another similar plugin? ", I will answer: firstly - and perhaps this is exactly one of the hack-readers and I was looking for, secondly - for self-development, thirdly: for my own convenience and painless use in my software products). <br><br>  So, besides, actually my small plug-in, we need the latest version of jQuery itself, as well as a small plug-in to it that implements the conversion of objects / arrays into a json string, so that the data can be quickly transferred to the server. <br>  <b>updated</b> <br><br>  <b>updated 2</b> - added multiboot! <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <br>  Now let's proceed to the description of the plug-in methods.  They are few :) More precisely - three. <br><br>  First: <b>$ .form.get</b> ( <i>formName, toJson, multi</i> ).  The function returns data from the specified form as an array or json-string.  Briefly about the main thing, that is, about the input variables. <ul><li>  <i>formName</i> - as the name implies, pass the name of the form here. </li><li>  <i>toJson</i> - <b>true / false</b> .  If <b>true</b> , then a json string containing the form values ‚Äã‚Äãis returned.  If <b>false</b> , then the object.  The default is <b>true</b> . </li><li>  <i>multi</i> - also accepts <b>true / false</b> .  If <b>true is</b> passed, then the function realizes that there may be several inputs with the same name on the page, and it collects the values ‚Äã‚Äãof all these form elements of the same name into a numbered array.  Passing <b>false</b> , we indicate that input inputs of the same name are not foreseen on the form, and you can not hesitate to push values ‚Äã‚Äãas a string (exceptions are the select elements with the multiple attribute and checkboxes).  By default, <b>false</b> is passed; </li></ul><br>  Second: <b>$ .form.set</b> ( <i>formName, elemName, value</i> ) Used to set new values ‚Äã‚Äãfor the form element.  Input parameters: <ul><li>  <i>formName</i> is the same as in the previous function. </li><li>  <i>elemName</i> - the value of the name attribute of the form element </li><li>  <i>value</i> is a string or an array containing the new element values. </li></ul><br>  Third: <b>$ .form.save</b> ( <i>params</i> ) In essence, this is a wrapper that receives the necessary form and sends it via a post request to the server.  Input parameter one, this is the object of the following form: <br>  { <br>  <i>name</i> : "", // name of form <br>  <i>url</i> : "", // server script address <br>  <i>params</i> : {}, // object containing additional parameters passed to the server script <br>  <i>multi</i> : false, // the same as in previous functions <br>  <i>test</i> : false, // <b>true / false</b> - if <b>true</b> , the server response is output using the alert function <br>  <i>callback</i> : function (data) {}, // function, called after the post-request.  Accepts server response as sole parameter. <br>  } <br>  If any of the parameters is not passed, they will be replaced with the default values.  But it is clear that if you do not pass the name and url, you get bileberda =) <br><br>  And finally: in order to specify the name of the form for the input, select and textarea elements I used the class attribute.  Initially I tried to enter my form attribute, but this was not cross-browser) <br><br><br>  Plugin code at the end of the article <br><br>  <b>UPD</b> <br><br>  So, updated the script and demo.  Now the plugin supports ajax-upload files with a progress bar.  Flash for the bootloader is <b>not required</b> .  To display the progress bar, jQueryUI is used. <br><br>  In order to use input: file with our plugin, add an element like this to the page: <br>  &lt;input type = "file" name = "file" class = "upload"&gt; <br>  Next, on the document.ready event, we hang the function that converts this input into our ajax loader: <br><br>  $ .form.makeUpload ('. upload [name = test]', { <br>  upload: 'upload.php? action = uploadFile', <br>  progress: 'upload.php? action = progress', <br>  directory: 'uploads', <br>  multi: true <br>  autoUpload: true <br>  }); <br><br>  Here is the result: <br><img src="http://img693.imageshack.us/img693/6976/upload.jpg" alt="image"><br><br>  You can get data from such elements with the same <b>$ .form.get</b> function <b>.</b> <br><br>  Return values ‚Äã‚Äãafter loading the file: <br><ul><li>  <i>directory</i> - the directory on the server where the file was uploaded </li><li>  <i>serverFileName</i> - the file name on the server </li><li>  <i>path</i> - directory + "/" + serverFileName </li><li>  <i>size</i> - file size in bytes </li><li>  <i>isUploaded</i> - 0 or 1. Was the file uploaded at all?  :) </li></ul><br>  The <b>$ .form.makeUpload</b> function accepts two incoming parameters. <br><ul><li>  <i>multi</i> - enable multiboot, true \ false.  False by default </li><li>  <i>selector</i> - the object selector \ objects to be converted to the loader </li><li>  <i>params</i> - an object with the following keys: <ul><li>  <i>upload</i> - the address of the server script that is responsible for the upload file </li><li>  <i>progress</i> - the address of the server script that displays the progress of the file download </li><li>  <i>serverFileName</i> is the name that will be assigned to the file on the server.  If this parameter contains the word <b>% real%</b> , then it is replaced with the real file name. </li><li>  <i>directory</i> - the directory where the file will be uploaded </li><li>  <i>autoUpload</i> - true \ false - whether to start upload immediately after selecting a file </li><li>  <i>onSelect</i> is the function to which the object is passed, which I am currently describing) Called at the moment the file was selected </li><li>  <i>onStart</i> is a function that is called when the file upload is started. </li><li>  <i>onComplete</i> is also a function.  Called at the moment the file download is complete.  Accepts as an object the object containing the <i>path</i> keys (path to the file on the server), <i>size</i> (size in bytes), <i>name</i> (file name) </li></ul></li></ul>  PHP code file upload.php, which both aploadad and shows progress aploada: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); else { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } else { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php function uploadFile() { <font color="#0000ff">if</font> ( <font color="#0000ff">sizeof</font> ($_FILES)) { $dir = getDir(); <font color="#0000ff">if</font> ($dir != <font color="#A31515">''</font> &amp;&amp; !is_dir($dir)) mkdir($dir); <font color="#0000ff">foreach</font> ($_FILES <font color="#0000ff">as</font> $file) { $filename = str_replace( <font color="#A31515">'%real%'</font> , $file[ <font color="#A31515">'name'</font> ], $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_serverFileName_def'</font> ]); move_uploaded_file($file[ <font color="#A31515">'tmp_name'</font> ], $dir. <font color="#A31515">"/"</font> .$filename); } } } function getDir() { $dir = <font color="#A31515">''</font> ; <font color="#0000ff">if</font> ($_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ] != <font color="#A31515">''</font> ) $dir = $_POST[$_POST[ <font color="#A31515">'inputName'</font> ]. <font color="#A31515">'_directory'</font> ]; <font color="#0000ff">return</font> $dir; } function progress() { <font color="#0000ff">if</font> (!isset($_POST[ <font color="#A31515">'file'</font> ])) die(); $filename = $_POST[ <font color="#A31515">'file'</font> ]; <font color="#0000ff">if</font> (function_exists( <font color="#A31515">"uploadprogress_get_info"</font> )) { $r = uploadprogress_get_info($_POST[ <font color="#A31515">'key'</font> ]); <font color="#0000ff">if</font> (is_array($r)) $r = array_merge($r,array( <font color="#A31515">"result"</font> =&gt;1)); <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); $r = array( <font color="#A31515">"result"</font> =&gt; -1, <font color="#A31515">"size"</font> =&gt; $size); } echo json_encode($r); } <font color="#0000ff">else</font> { $size = 0; <font color="#0000ff">if</font> (file_exists($_POST[ <font color="#A31515">'file'</font> ])) $size = filesize($_POST[ <font color="#A31515">'file'</font> ]); echo json_encode(array( <font color="#A31515">"result"</font> =&gt; 0, <font color="#A31515">"size"</font> =&gt; $size)); } } <font color="#0000ff">if</font> (isset($_GET[ <font color="#A31515">'action'</font> ])) { <font color="#0000ff">if</font> ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'uploadFile'</font> ) uploadFile(); elseif ($_GET[ <font color="#A31515">'action'</font> ] == <font color="#A31515">'progress'</font> ) progress(); } ?&gt;</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Well.  while everything seems to be.  Thank you all for your attention) <br><br><br><br>  Thank you all for the karma!  Perez in jquery. <br><br>  <b>Attention to those who have already downloaded the plugin!</b>  jquery.form.js and upload.php changed.  Multiboot added and fixed one bug! <br><br>  The plug-in is already used in the personal account of the <a href="http://sms-uslugi.ru/">SMS services</a> company, working there as a donor for the needs of customers pouring excel-files with subscriber bases for subsequent SMS mailings.  =) Among the clients there are a lot of office workers with different types of IE, no one has problems with apload.  Use;) <br><br>  Since the hosting that keeps these files is gone, I post the plugin code here, the demo is missing) Do not forget to connect jQuery and jQuery UI! <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">jQuery.form = {&lt;br&gt;    set: <font color="#0000ff">function</font> (form,name,values)&lt;br&gt;    {&lt;br&gt; <font color="#0000ff">var</font> selector = <font color="#A31515">"."</font> +form+ <font color="#A31515">"[name="</font> +name+ <font color="#A31515">"]"</font> ;&lt;br&gt; <font color="#0000ff">if</font> ($(selector). <font color="#0000ff">is</font> ( <font color="#A31515">':checkbox'</font> ))&lt;br&gt;        {&lt;br&gt; <font color="#0000ff">if</font> (!$.isArray(values)) values = <font color="#0000ff">new</font> Array(values);&lt;br&gt;            $(selector).removeAttr( <font color="#A31515">"checked"</font> );&lt;br&gt; <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0; i &lt; values.length; i++)&lt;br&gt;                $(selector+ <font color="#A31515">"[value='"</font> +values[i]+ <font color="#A31515">"']"</font> ).attr( <font color="#A31515">"checked"</font> , <font color="#A31515">"checked"</font> );&lt;br&gt; <font color="#0000ff">return</font> ;&lt;br&gt;        }&lt;br&gt; <font color="#0000ff">if</font> ($(selector). <font color="#0000ff">is</font> ( <font color="#A31515">':radio'</font> ))&lt;br&gt;        {&lt;br&gt;            $(selector).removeAttr( <font color="#A31515">"checked"</font> );&lt;br&gt;            $(selector+ <font color="#A31515">"[value='"</font> +values+ <font color="#A31515">"']"</font> ).attr( <font color="#A31515">"checked"</font> , <font color="#A31515">"checked"</font> ); <font color="#0000ff">return</font> ;&lt;br&gt;        }&lt;br&gt;        $(selector).val(values);&lt;br&gt; <font color="#0000ff">return</font> ;&lt;br&gt;    },&lt;br&gt;    save: <font color="#0000ff">function</font> ( <font color="#0000ff">params</font> ) <font color="#008000">//name,url,key,callback,params,multi</font> &lt;br&gt;    {&lt;br&gt; <font color="#0000ff">var</font> p = {&lt;br&gt;            name: <font color="#A31515">'form'</font> ,&lt;br&gt;            url: <font color="#A31515">''</font> ,&lt;br&gt;            key: <font color="#0000ff">null</font> ,&lt;br&gt;            test: <font color="#0000ff">false</font> ,&lt;br&gt;            callback: <font color="#0000ff">function</font> (){},&lt;br&gt; <font color="#0000ff">params</font> :{},&lt;br&gt;            multi: <font color="#0000ff">false</font> &lt;br&gt;        }&lt;br&gt;        p = $.extend(p, <font color="#0000ff">params</font> );&lt;br&gt; <font color="#0000ff">var</font> form = $.form.get(p.name, <font color="#0000ff">false</font> ,p.multi);&lt;br&gt; <font color="#0000ff">if</font> ( p.key != <font color="#0000ff">null</font> )&lt;br&gt;        {&lt;br&gt; <font color="#0000ff">var</font> c = {};&lt;br&gt;            c[p.key] = form;&lt;br&gt;            form = c;&lt;br&gt;        }&lt;br&gt;        form = $.toJSON(form);&lt;br&gt; <font color="#0000ff">if</font> (p. <font color="#0000ff">params</font> == <font color="#0000ff">null</font> ) p. <font color="#0000ff">params</font> = {p:form};&lt;br&gt; <font color="#0000ff">else</font> p. <font color="#0000ff">params</font> .p = form;&lt;br&gt;        $.post(p.url,p. <font color="#0000ff">params</font> , <font color="#0000ff">function</font> (data){&lt;br&gt; <font color="#0000ff">if</font> (p.test)&lt;br&gt;                alert(data);&lt;br&gt;            data = $.parseJSON(data);&lt;br&gt; <font color="#0000ff">if</font> (data.code == 1)&lt;br&gt;                $.form.ok(p.name,data.descr,data.title);&lt;br&gt; <font color="#0000ff">else</font> $.form.error(p.name,data.descr,data.title);&lt;br&gt;            p.callback(data);&lt;br&gt;        }, <font color="#A31515">'html'</font> );&lt;br&gt;    },&lt;br&gt;    get: <font color="#0000ff">function</font> (form,json,multi){&lt;br&gt; <font color="#0000ff">if</font> (multi == <font color="#0000ff">null</font> ) multi = <font color="#0000ff">false</font> ;&lt;br&gt; <font color="#0000ff">if</font> (json == <font color="#0000ff">null</font> ) json = <font color="#0000ff">true</font> ;&lt;br&gt; <font color="#0000ff">if</font> (form == <font color="#0000ff">null</font> || form.length == 0)&lt;br&gt;        {&lt;br&gt; <font color="#0000ff">if</font> (!json) <font color="#0000ff">return</font> {};&lt;br&gt; <font color="#0000ff">else</font> <font color="#0000ff">return</font> $.toJSON({});&lt;br&gt;        }&lt;br&gt; <font color="#0000ff">var</font> selector = <font color="#A31515">"input."</font> +form+ <font color="#A31515">":radio:checked,input."</font> +form+ <font color="#A31515">":checkbox:checked,input."</font> +form+ <font color="#A31515">":text,input."</font> +form+ <font color="#A31515">":hidden,input."</font> +form+ <font color="#A31515">":file,input."</font> +form+ <font color="#A31515">":password,textarea."</font> +form+ <font color="#A31515">",select."</font> +form;&lt;br&gt; <font color="#0000ff">var</font> inputs = $(selector);&lt;br&gt; <font color="#0000ff">var</font> values = {};&lt;br&gt;        $.each(inputs, <font color="#0000ff">function</font> (){&lt;br&gt; <font color="#0000ff">var</font> name = $( <font color="#0000ff">this</font> ).attr( <font color="#A31515">"name"</font> );&lt;br&gt; <font color="#0000ff">var</font> value = $( <font color="#0000ff">this</font> ).val();&lt;br&gt;            &lt;br&gt; <font color="#0000ff">if</font> (($.isArray(value) &amp;&amp; value[0] == <font color="#0000ff">null</font> ) || value == <font color="#0000ff">null</font> )&lt;br&gt; <font color="#0000ff">return</font> ;&lt;br&gt; <font color="#0000ff">if</font> ($( <font color="#0000ff">this</font> ). <font color="#0000ff">is</font> ( <font color="#A31515">':file'</font> ))&lt;br&gt;            {&lt;br&gt; <font color="#0000ff">var</font> name = $( <font color="#0000ff">this</font> ).attr( <font color="#A31515">"name"</font> );&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> key = $( <font color="#0000ff">this</font> ).attr( <font color="#A31515">"key"</font> );&lt;br&gt; <font color="#0000ff">var</font> s = <font color="#A31515">"input[type=hidden][key="</font> +key+ <font color="#A31515">"]"</font> ;            &lt;br&gt; <font color="#0000ff">var</font> v = {};&lt;br&gt;                v.directory = $(s+ <font color="#A31515">"[name="</font> +name+ <font color="#A31515">"_directory]"</font> ).attr( <font color="#A31515">"value"</font> );&lt;br&gt;                v.serverFileName = $(s+ <font color="#A31515">"[name="</font> +name+ <font color="#A31515">"_serverFileName]"</font> ).attr( <font color="#A31515">"value"</font> );&lt;br&gt;                v.path = $(s+ <font color="#A31515">"[name="</font> +name+ <font color="#A31515">"_path]"</font> ).attr( <font color="#A31515">"value"</font> );&lt;br&gt;                v.size = $(s+ <font color="#A31515">"[name="</font> +name+ <font color="#A31515">"_size]"</font> ).attr( <font color="#A31515">"value"</font> );&lt;br&gt;                v.isUploaded = $(s+ <font color="#A31515">"[name="</font> +name+ <font color="#A31515">"_isUploaded]"</font> ).attr( <font color="#A31515">"value"</font> );&lt;br&gt; <font color="#0000ff">if</font> (v.isUploaded == <font color="#0000ff">false</font> || v.isUploaded == 0 || v.isUploaded == <font color="#A31515">"0"</font> ) <font color="#0000ff">return</font> ;&lt;br&gt; <font color="#0000ff">if</font> (!multi &amp;&amp; !$.form.intervals[key].wasMulti) values[name] = v;&lt;br&gt; <font color="#0000ff">else</font> &lt;br&gt;                {&lt;br&gt; <font color="#0000ff">if</font> (values[name] == <font color="#0000ff">null</font> ) values[name] = <font color="#0000ff">new</font> Array();&lt;br&gt;                    values[name][values[name].length] = v;&lt;br&gt;                }&lt;br&gt; <font color="#0000ff">return</font> ;&lt;br&gt;            }&lt;br&gt; <font color="#0000ff">if</font> (multi || $( <font color="#0000ff">this</font> ). <font color="#0000ff">is</font> ( <font color="#A31515">':checkbox'</font> ))&lt;br&gt;            {&lt;br&gt; <font color="#0000ff">if</font> ($( <font color="#0000ff">this</font> ). <font color="#0000ff">is</font> ( <font color="#A31515">":checkbox"</font> ) &amp;&amp; !$( <font color="#0000ff">this</font> ).attr( <font color="#A31515">"checked"</font> )) <font color="#0000ff">return</font> ;&lt;br&gt; <font color="#0000ff">if</font> (values[name] == <font color="#0000ff">null</font> ) values[name] = <font color="#0000ff">new</font> Array();&lt;br&gt;                values[name][values[name].length] = value;&lt;br&gt;            }&lt;br&gt; <font color="#0000ff">else</font> &lt;br&gt;            {&lt;br&gt;                values[name] = value;&lt;br&gt;            }&lt;br&gt;        });&lt;br&gt;&lt;br&gt; <font color="#0000ff">if</font> (json == <font color="#0000ff">false</font> )&lt;br&gt; <font color="#0000ff">return</font> values;&lt;br&gt; <font color="#0000ff">else</font> &lt;br&gt; <font color="#0000ff">return</font> $.toJSON(values);&lt;br&gt;    },&lt;br&gt;    addInputFile: <font color="#0000ff">function</font> (form,name,container)&lt;br&gt;    {&lt;br&gt; <font color="#0000ff">var</font> key = $( <font color="#A31515">'.'</font> +form+ <font color="#A31515">'[name='</font> +name+ <font color="#A31515">']'</font> ).attr( <font color="#A31515">"key"</font> );&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> p = {};&lt;br&gt; <font color="#0000ff">var</font> oldparams = $.form.intervals[key];&lt;br&gt;        p.upload = oldparams.upload;&lt;br&gt;        p.progress = oldparams.progress;&lt;br&gt;        p.serverFileName = oldparams.serverFileName_def;&lt;br&gt;        p.directory = oldparams.directory;&lt;br&gt;        p.autoUpload = oldparams.autoUpload;&lt;br&gt;        p.multi = <font color="#0000ff">false</font> ;&lt;br&gt;        p.wasMulti = oldparams.wasMulti;&lt;br&gt;        p.onSelect = oldparams.onSelect;&lt;br&gt;        p.onStart = oldparams.onStart;&lt;br&gt;        p.onComplete = oldparams.onComplete;&lt;br&gt;&lt;br&gt;        $(container).append( <font color="#A31515">"&lt;input type=file name="</font> +name+ <font color="#A31515">" class="</font> +form+ <font color="#A31515">"&gt;"</font> );&lt;br&gt;        $.form.makeUpload( <font color="#A31515">'.'</font> +form+ <font color="#A31515">'[name='</font> +name+ <font color="#A31515">']'</font> ,p, <font color="#A31515">'multi'</font> );&lt;br&gt;    },&lt;br&gt;    uploadChange: <font color="#0000ff">function</font> (key,param,value){&lt;br&gt;        $( <font color="#A31515">"input[key='"</font> +key+ <font color="#A31515">"'][name='"</font> +param+ <font color="#A31515">"']"</font> ).attr( <font color="#A31515">"value"</font> ,value);&lt;br&gt;    },&lt;br&gt;    makeUpload: <font color="#0000ff">function</font> (selector, <font color="#0000ff">params</font> ,add){&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> elements = $(selector);&lt;br&gt;        $.each(elements, <font color="#0000ff">function</font> (){&lt;br&gt; <font color="#0000ff">var</font> p = {&lt;br&gt;                upload: <font color="#A31515">"/upload.php?action=uploadFile"</font> ,&lt;br&gt;                progress: <font color="#A31515">"/upload.php?action=progress"</font> ,&lt;br&gt;                serverFileName: <font color="#A31515">"%real%"</font> ,&lt;br&gt;                directory: <font color="#A31515">""</font> ,&lt;br&gt;                userParam: <font color="#A31515">""</font> ,&lt;br&gt;                autoUpload: <font color="#0000ff">false</font> ,&lt;br&gt;                multi: <font color="#0000ff">false</font> ,&lt;br&gt;                wasMulti: <font color="#0000ff">false</font> ,&lt;br&gt;                onSelect: <font color="#0000ff">function</font> (){},&lt;br&gt;                onStart: <font color="#0000ff">function</font> (){},&lt;br&gt;                onComplete: <font color="#0000ff">function</font> (){},&lt;br&gt;                name:$(selector).attr( <font color="#A31515">"name"</font> )&lt;br&gt;            }&lt;br&gt; <font color="#0000ff">if</font> ($( <font color="#0000ff">this</font> ).attr( <font color="#A31515">"key"</font> )!= <font color="#0000ff">null</font> ) <font color="#0000ff">return</font> ;&lt;br&gt; <font color="#0000ff">var</font> date = <font color="#0000ff">new</font> Date();&lt;br&gt; <font color="#0000ff">var</font> key = date.getMilliseconds().toString()+date.getMinutes().toString()+date.getSeconds().toString()+Math.round(Math.random()*(1000000 - 0)).toString();&lt;br&gt;            p = $.extend(p, <font color="#0000ff">params</font> );&lt;br&gt; <font color="#0000ff">if</font> (add == <font color="#0000ff">null</font> )&lt;br&gt;                p.wasMulti = p.multi;&lt;br&gt; <font color="#0000ff">else</font> (p.wasMulti = <font color="#0000ff">true</font> );&lt;br&gt;            p.selector = <font color="#A31515">"[type=file][key="</font> +key+ <font color="#A31515">"]"</font> ;&lt;br&gt;            p.key = key;&lt;br&gt;            p.serverFileName_def = p.serverFileName;&lt;br&gt;            $( <font color="#0000ff">this</font> ).attr( <font color="#A31515">"key"</font> ,key).change( <font color="#0000ff">function</font> (){&lt;br&gt; <font color="#0000ff">if</font> ($( <font color="#A31515">"#submit_"</font> +key).length == 0)&lt;br&gt;                {&lt;br&gt;                    $.form.intervals[key].onSelect($.form.intervals[key]);&lt;br&gt;                    $( <font color="#0000ff">this</font> ).after( <font color="#A31515">"&lt;input type=submit value='' id=submit_"</font> +key+ <font color="#A31515">"&gt;"</font> );&lt;br&gt; <font color="#0000ff">if</font> ($.form.intervals[key].autoUpload == <font color="#0000ff">true</font> )&lt;br&gt;                        $( <font color="#A31515">"#submit_"</font> +key).click();&lt;br&gt;                }&lt;br&gt;            });&lt;br&gt;            $( <font color="#0000ff">this</font> ).wrap( <font color="#A31515">"&lt;form key='"</font> +key+ <font color="#A31515">"' onsubmit=\"return $.form.uploadSelectedFile(this)\" name=wfUpload_"</font> +key+ <font color="#A31515">" action='"</font> +p.upload+ <font color="#A31515">"' target=iframe_"</font> +key+ <font color="#A31515">" enctype='multipart/form-data' method=post&gt;&lt;/form&gt;"</font> )&lt;br&gt;            $( <font color="#0000ff">this</font> ).parent().append( <font color="#A31515">"&lt;input type=hidden name=key value='"</font> +key+ <font color="#A31515">"'&gt;"</font> );&lt;br&gt;            $( <font color="#0000ff">this</font> ).before( <font color="#A31515">'&lt;input type="hidden" name="UPLOAD_IDENTIFIER" value="'</font> +key+ <font color="#A31515">'"&gt;'</font> );&lt;br&gt; <font color="#0000ff">var</font> span = $( <font color="#0000ff">this</font> ).parent();&lt;br&gt; <font color="#0000ff">var</font> html =&lt;br&gt; <font color="#A31515">"&lt;input type=hidden name='"</font> +p.name+ <font color="#A31515">"_directory' key='"</font> +key+ <font color="#A31515">"' value='"</font> +p.directory+ <font color="#A31515">"'&gt;"</font> +&lt;br&gt; <font color="#A31515">"&lt;input type=hidden name='"</font> +p.name+ <font color="#A31515">"_serverFileName' key='"</font> +key+ <font color="#A31515">"' value='"</font> +p.serverFileName+ <font color="#A31515">"'&gt;"</font> +&lt;br&gt; <font color="#A31515">"&lt;input type=hidden name='"</font> +p.name+ <font color="#A31515">"_serverFileName_def' key='"</font> +key+ <font color="#A31515">"' value='"</font> +p.serverFileName_def+ <font color="#A31515">"'&gt;"</font> +&lt;br&gt; <font color="#A31515">"&lt;input type=hidden name='"</font> +p.name+ <font color="#A31515">"_path' key='"</font> +key+ <font color="#A31515">"' value=''&gt;"</font> +&lt;br&gt; <font color="#A31515">"&lt;input type=hidden name='inputName' key='"</font> +key+ <font color="#A31515">"' value='"</font> +p.name+ <font color="#A31515">"'&gt;"</font> +&lt;br&gt; <font color="#A31515">"&lt;input type=hidden name='userParam' key='"</font> +key+ <font color="#A31515">"' value='"</font> +p.userParam+ <font color="#A31515">"'&gt;"</font> +&lt;br&gt; <font color="#A31515">"&lt;input type=hidden name='"</font> +p.name+ <font color="#A31515">"_isUploaded' key='"</font> +key+ <font color="#A31515">"' value='0'&gt;"</font> +&lt;br&gt; <font color="#A31515">"&lt;input type=hidden name='"</font> +p.name+ <font color="#A31515">"_size' key='"</font> +key+ <font color="#A31515">"' value=''&gt;"</font> +&lt;br&gt; <font color="#A31515">"&lt;span uploaded=0 class=uploadDescr style='display:none' key='"</font> +key+ <font color="#A31515">"'&gt;&lt;/span&gt;"</font> +&lt;br&gt; <font color="#A31515">"&lt;iframe style='display:none;' onLoad=$.form.uploadComplete('"</font> +key+ <font color="#A31515">"') name=iframe_"</font> +key+ <font color="#A31515">" id=iframe_"</font> +key+ <font color="#A31515">"&gt;&lt;/iframe&gt;"</font> ;&lt;br&gt;            $(span).append(html);&lt;br&gt; <font color="#0000ff">if</font> ($.form.intervals[key] == <font color="#0000ff">null</font> )&lt;br&gt;                $.form.intervals[key] = p;&lt;br&gt;        });&lt;br&gt; <font color="#0000ff">if</font> ( <font color="#0000ff">params</font> .multi == <font color="#0000ff">true</font> )&lt;br&gt;        {&lt;br&gt; <font color="#0000ff">var</font> l = elements.length;&lt;br&gt; <font color="#0000ff">if</font> (l &gt; 0 &amp;&amp; $( <font color="#A31515">'#more_files_'</font> +$(elements[l-1]).attr( <font color="#A31515">"key"</font> )).length == 0)&lt;br&gt;                $(elements[l-1]).parent( <font color="#A31515">'form'</font> ).after( <font color="#A31515">"&lt;br&gt;&lt;input type=submit value='   ' onclick=$.form.addInputFile('"</font> +$(elements[l-1]).attr( <font color="#A31515">"class"</font> )+ <font color="#A31515">"','"</font> +$(elements[l-1]).attr( <font color="#A31515">"name"</font> )+ <font color="#A31515">"','#more_files_"</font> +$(elements[l-1]).attr( <font color="#A31515">"key"</font> )+ <font color="#A31515">"')&gt;&lt;br&gt;"</font> ).after( <font color="#A31515">'&lt;span id=more_files_'</font> +$(elements[l-1]).attr( <font color="#A31515">"key"</font> )+ <font color="#A31515">'&gt;&lt;/span&gt;'</font> );&lt;br&gt;        }&lt;br&gt;    },&lt;br&gt;    uploadSelectedFile: <font color="#0000ff">function</font> (s, <font color="#0000ff">params</font> )&lt;br&gt;    {&lt;br&gt; <font color="#0000ff">var</font> p = {&lt;br&gt;            width:100,&lt;br&gt;            height:15&lt;br&gt;        }&lt;br&gt;        p = $.extend(p, <font color="#0000ff">params</font> );&lt;br&gt; <font color="#0000ff">var</font> key = $(s).attr( <font color="#A31515">"key"</font> );&lt;br&gt;        $( <font color="#A31515">"#submit_"</font> +key).attr( <font color="#A31515">"disabled"</font> , <font color="#A31515">"disabled"</font> );&lt;br&gt; <font color="#0000ff">var</font> span = $(s).children( <font color="#A31515">".uploadDescr"</font> );&lt;br&gt; <font color="#0000ff">var</font> style = {display: <font color="#A31515">'none'</font> , margin: <font color="#A31515">"10px"</font> };&lt;br&gt;        $(span).html( <font color="#A31515">"&lt;div class=progressbar&gt;&lt;/div&gt; &lt;span style='text-align:right;' class=uploadedFileDetailInfo&gt; . , ...&lt;/span&gt;"</font> ).css(style);&lt;br&gt; <font color="#0000ff">var</font> bar = $(span).children( <font color="#A31515">'div.progressbar'</font> );&lt;br&gt;        bar.progressbar({value: 0});&lt;br&gt; <font color="#008000">//alert($.form.intervals[key].selector);</font> &lt;br&gt; <font color="#0000ff">var</font> fname = $($.form.intervals[key].selector).attr( <font color="#A31515">"value"</font> );&lt;br&gt;        fname = fname.split( <font color="#A31515">'\\');&lt;br&gt;        $.form.intervals[key].realFileName = fname[fname.length-1];&lt;br&gt;        $.form.intervals[key].key = key;&lt;br&gt;        $.form.intervals[key].bar = bar;&lt;br&gt;        $.form.intervals[key].span = span;&lt;br&gt;        $($.form.intervals[key].span).attr("uploaded",0);&lt;br&gt;        $.form.intervals[key].onStart($.form.intervals[key]);&lt;br&gt;        //$.form.uploadProgress(key);&lt;br&gt;        $.form.intervals[key].interval = setInterval('</font> $.form.uploadProgress( <font color="#A31515">"'+key+'"</font> ) <font color="#A31515">',1000);&lt;br&gt;    },&lt;br&gt;    uploadProgress: function(key){&lt;br&gt;        $.ajax({&lt;br&gt;            error:function(XMLHttpRequest, textStatus, errorThrown) {&lt;br&gt;            },&lt;br&gt;            start:function(){},&lt;br&gt;            beforeSend:function ( request ) {&lt;br&gt;                request.setRequestHeader( '</font> Cookie <font color="#A31515">', document.cookie );&lt;br&gt;            },&lt;br&gt;            url:$.form.intervals[key].progress,&lt;br&gt;            data:{&lt;br&gt;                key:key,&lt;br&gt;                file:$.form.intervals[key].directory+"/"+$.form.intervals[key].realFileName&lt;br&gt;            },&lt;br&gt;            complete:function(){},&lt;br&gt;            dataType:'</font> html <font color="#A31515">',&lt;br&gt;            type:'</font> post <font color="#A31515">',&lt;br&gt;            success:function(data){&lt;br&gt;                data = $.parseJSON(data);&lt;br&gt;                if (data.result == 1)&lt;br&gt;                {&lt;br&gt;                    var timelast=data.time_last;&lt;br&gt;                    var total = data.bytes_total;&lt;br&gt;                    var speed = data.speed_average;&lt;br&gt;                    var bytes = data.bytes_uploaded;&lt;br&gt;                    var eta = data.est_sec;&lt;br&gt;                    var min = Math.round(eta / 60);&lt;br&gt;                    var sec = eta - min*60;&lt;br&gt;                    if(min==0){var time=sec+" ."}else{var time=min+" ."+sec+" ."}&lt;br&gt;                    var speeds = $.form.speeds(speed);&lt;br&gt;                    var percents = Math.round(bytes * 100 / total);&lt;br&gt;                    $.form.intervals[key].size = total;&lt;br&gt;                    $($.form.intervals[key].span).children('</font> .uploadedFileDetailInfo <font color="#A31515">').html("&lt;b&gt;"+percents+"%&lt;/b&gt;, &lt;i&gt;:&lt;/i&gt; &lt;b&gt;"+speeds+"&lt;/b&gt;, &lt;i&gt;&lt;/i&gt; &lt;b&gt;"+$.form.fsize(bytes)+"&lt;/b&gt; &lt;i&gt;&lt;/i&gt; &lt;b&gt;"+$.form.fsize(total)+"&lt;/b&gt;");&lt;br&gt;                    $.form.intervals[key].bar.progressbar('</font> value <font color="#A31515">',percents);&lt;br&gt;                }&lt;br&gt;                if (data.result == -1 )&lt;br&gt;                    $.form.intervals[key].size = data.size;&lt;br&gt;                if (data.result == 0)&lt;br&gt;                {&lt;br&gt;                    $.form.intervals[key].size = data.size;&lt;br&gt;                    //alert(data.size);&lt;br&gt;                    if ($($.form.intervals[key].span).attr("uploaded") == 0)&lt;br&gt;                        $($.form.intervals[key].span).html("     .    ...");&lt;br&gt;                }&lt;br&gt;&lt;br&gt;                $($.form.intervals[key].span).slideDown();&lt;br&gt;        }});&lt;br&gt;    },&lt;br&gt;    uploadCompleteAfterTimer:function(key){&lt;br&gt;        if ($.form.intervals[key].realFileName == null ) return;&lt;br&gt;        clearInterval($.form.intervals[key].interval);&lt;br&gt;        var size = "false";&lt;br&gt;        if ($.form.intervals[key].size != null) size = $.form.intervals[key].size;&lt;br&gt;        var serverFileName = $.form.str_replace('</font> %real% <font color="#A31515">',$.form.intervals[key].realFileName,$.form.intervals[key].serverFileName);&lt;br&gt;        var value = $.form.intervals[key].directory+"/"+serverFileName;&lt;br&gt;        $("input[key="+key+"][name="+$.form.intervals[key].name+"_path]").attr("value",value);&lt;br&gt;        $("input[key="+key+"][name="+$.form.intervals[key].name+"_isUploaded]").attr("value",1);&lt;br&gt;        $("input[key="+key+"][name="+$.form.intervals[key].name+"_size]").attr("value",size);&lt;br&gt;        $("input[key="+key+"][name="+$.form.intervals[key].name+"_serverFileName]").attr("value",serverFileName);&lt;br&gt;        $($.form.intervals[key].span).attr("uploaded",1);&lt;br&gt;        $("#submit_"+key).remove();&lt;br&gt;        $(".uploadDescr[key="+key+"]").html(" !!!");&lt;br&gt;        var opt = {&lt;br&gt;            path:value,&lt;br&gt;            size:size,&lt;br&gt;            name:$.form.intervals[key].realFileName&lt;br&gt;        };&lt;br&gt;        $.form.intervals[key].onComplete(opt);&lt;br&gt;    },&lt;br&gt;    uploadComplete:function(key){&lt;br&gt;            setTimeout("$.form.uploadCompleteAfterTimer('</font> <font color="#A31515">"+key+"</font> <font color="#A31515">')",500);&lt;br&gt;    },&lt;br&gt;    intervals:{},&lt;br&gt;    "fsize":function(x) {&lt;br&gt;        x = Math.round(x / 1024);&lt;br&gt;        if (x &lt; 1000) {&lt;br&gt;            return x + " " + "";&lt;br&gt;        }&lt;br&gt;        x = Math.round(x * 100 / 1024) / 100;&lt;br&gt;        return x + " " + "";&lt;br&gt;    },&lt;br&gt;    "speeds":function (x) {&lt;br&gt;        x = Math.round(x / 1024);&lt;br&gt;        if (x &lt; 1000) {&lt;br&gt;            return x + " " + "/";&lt;br&gt;        }&lt;br&gt;        x = Math.round(x * 100 / 1024) / 100;&lt;br&gt;        return x + " " + "/";&lt;br&gt;    },&lt;br&gt;    "str_replace":function (search, replace, subject, count) {&lt;br&gt;        var i = 0, j = 0, temp = '</font> <font color="#A31515">', repl = '</font> <font color="#A31515">', sl = 0, fl = 0,&lt;br&gt;                f = [].concat(search),&lt;br&gt;                r = [].concat(replace),&lt;br&gt;                s = subject,&lt;br&gt;                ra = r instanceof Array, sa = s instanceof Array;&lt;br&gt;        s = [].concat(s);&lt;br&gt;        if (count) {&lt;br&gt;            this.window[count] = 0;&lt;br&gt;        }&lt;br&gt;&lt;br&gt;        for (i=0, sl=s.length; i &lt; sl; i++) {&lt;br&gt;            if (s[i] === '</font> <font color="#A31515">') {&lt;br&gt;                continue;&lt;br&gt;            }&lt;br&gt;            for (j=0, fl=f.length; j &lt; fl; j++) {&lt;br&gt;                temp = s[i]+'</font> <font color="#A31515">';&lt;br&gt;                repl = ra ? (r[j] !== undefined ? r[j] : '</font> ') : r[0];&lt;br&gt;                s[i] = (temp).split(f[j]).join(repl);&lt;br&gt; <font color="#0000ff">if</font> (count &amp;&amp; s[i] !== temp) {&lt;br&gt; <font color="#0000ff">this</font> .window[count] += (temp.length-s[i].length)/f[j].length;}&lt;br&gt;            }&lt;br&gt;        }&lt;br&gt; <font color="#0000ff">return</font> sa ? s : s[0];&lt;br&gt;    }&lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> </div><p>Source: <a href="https://habr.com/ru/post/75420/">https://habr.com/ru/post/75420/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../75413/index.html">CakePHP Questions</a></li>
<li><a href="../75414/index.html">The human immune system: a biological antivirus. Heuristic Algorithms</a></li>
<li><a href="../75417/index.html">Where to buy EEE 901 Linux 20GB in Moscow?</a></li>
<li><a href="../75418/index.html">Programming microcontrollers PIC16 / PIC18 in C. The third article. Something about iron</a></li>
<li><a href="../75419/index.html">Student toolbox</a></li>
<li><a href="../75423/index.html">‚ÄúOink - Oink‚Äù attacks</a></li>
<li><a href="../75424/index.html">What is a tumblr?</a></li>
<li><a href="../75425/index.html">SharePoint 2010 Beta is available for download to TechNet and MSDN subscribers.</a></li>
<li><a href="../75426/index.html">Communicator Highscreen Zeus based on Android OS</a></li>
<li><a href="../75427/index.html">Houston, we have problems!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>