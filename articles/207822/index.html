<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We calculate what year is now from the Big Bang on Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In connection with the coming year 2014 from the birth of Christ, the question may arise: ‚ÄúAnd what is actually the year now without being tied to rel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We calculate what year is now from the Big Bang on Python</h1><div class="post__text post__text-html js-mediator-article">  In connection with the coming year 2014 from the birth of Christ, the question may arise: ‚ÄúAnd what is actually the year now without being tied to religions?‚Äù I will try to answer it, or rather, show how it can be calculated quite easily without dismounting from the chair. <br><br>  We will count from the beginning of the Universe, that is, the Big Bang.  I will omit many reservations to get the result in the minimum number of formulas and lines of code (yes, we will program in Python!).  As a bonus, we also estimate how much <b>dark energy</b> we have in the Universe. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b84/9c8/253/b849c8253774357b399281ac5df43ec3.jpg"><br>  <i>Supernova 1994D as seen with the Hubble Space Telescope.</i>  <i>Foto: Pete Chalis - Harvard Smithsonian Center of Astrophysics</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Curious?  Then let's go! <br><a name="habracut"></a><br><br><h4>  Briefly about the physical side of the issue </h4><br><br>  Have you heard about Hubble?  There is also a telescope named after him.  So he discovered the fact that the Universe is increasing in size, or rather, the galaxies nearby, run away, and the farther they are from us, the faster they move away.  How can the universe grow?  The analogy may be simple.  Imagine yourself an ant on a balloon inflated.  It will seem to you that the world is slowly increasing, and the other ants on the ball are farther and farther away, although nothing happens to your body. <br><br>  Returning to Hubble.  How did he establish this fact?  There are two points: <br><ul><li>  First, we must measure the speed of the galaxy.  Here we need the Doppler effect.  We all know about the classic experiment with the whistle of the train at the moment when it sweeps along the apron.  When an object moves away from us, the wavelength it radiates is extended.  From this amendment, you can find the speed.  In astronomy, this increase is called the redshift and denoted by the letter <b>z</b> .  Some known spectral line is observed and, finding its displacement, they calculate the speed. </li><li>  Secondly, the distance to the galaxy.  Just because the distance to them is not measured.  Here we will need an additional object - type Ia supernovae.  These are the explosions of stars, in which the same amount of energy is released.  For the brightness that we observe, you can calculate the distance to the explosion itself and to the galaxy in which this explosion occurred.  Pictured above is a galaxy and a supernova explosion.  In terms of brightness, it surpasses the entire galaxy, in which about a hundred billion stars. </li></ul><br><br><h5>  And where is the age of the universe? </h5><br>  By measuring the speed with which the Universe is increasing, we can estimate when it was a point.  This moment can be called the beginning of everything and estimate how many years ago it was. <br><br><h4>  Prepare the system </h4><br>  We will need <b>Python</b> (the version is unimportant, I will use 2.7, the differences from 3. * are minimal): <br> <code>sudo apt-get install python</code> <br>  For calculations we will use <b>Numpy</b> and <b>Scipy</b> : <br> <code>pip install numpy</code> <br> <code>pip install scipy</code> <br>  And for <b>Matplotlib</b> charts: <br> <code>pip install matplotlib</code> <br> <br>  For gentlemen without root, I recommend this build: <a href="https://store.continuum.io/cshop/anaconda/">store.continuum.io/cshop/anaconda</a> <br>  For Windows users: <a href="https://code.google.com/p/pythonxy/">code.google.com/p/pythonxy</a> <br><br>  We believe that the system prepared.  Everything that goes further can be run online (right in the Python console), or in iPython.  As you like. <br><br><h4>  Download data </h4><br>  The beauty of modern astrophysics in the complete openness of observational data.  We will use this catalog of type Ia supernovae, which I wrote about above: <a href="http://supernova.lbl.gov/Union/">supernova.lbl.gov/Union</a> <br>  We will need this file: <a href="http://supernova.lbl.gov/Union/figures/SCPUnion2.1_mu_vs_z.txt">supernova.lbl.gov/Union/figures/SCPUnion2.1_mu_vs_z.txt</a> <br><br><h4>  Start writing code </h4><br>  Let's connect libraries which will be required later. <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt</code> </pre><br><br>  Load the data from the file and create three auxiliary arrays: <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  5  ,        . #  0 ,    ,       data=np.loadtxt('SCPUnion2.1_mu_vs_z.txt',skiprows=5,converters={0: lambda s: 0}) #         z = data[:,1] #    distance modulus        DM = data[:,2] DM_err=data[:,3]</span></span></code> </pre><br><br>  The fact that such a distance modulus and how to get the distance from an object from it is succinctly written on the <a href="http://be.wikipedia.org/wiki/%25D0%259C%25D0%25BE%25D0%25B4%25D1%2583%25D0%25BB%25D1%258C_%25D0%25B0%25D0%25B4%25D0%25BB%25D0%25B5%25D0%25B3%25D0%25BB%25D0%25B0%25D1%2581%25D1%2586%25D1%2596">Belarusian Wikipedia</a> . <br><br>  We convert this quantity, the existence of which is caused solely by the convenience of observers, into a physical one.  The distance to the object is written in the array <b>DL</b> : <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    def DM2DL(DM): return 10**(DM/5-1)/1e4 #     DL=DM2DL(DM)</span></span></code> </pre><br><br>  When calculating Distance Modulus, the authors of the catalog suggested that the luminosity of the supernova is -19.3, as described in the description.  They did this work for us. <br><br>  Now in the variable <b>z</b> we have redshifts and in <b>DL</b> - distances in Megaparsecs (1 parse = 3e16 meters = 3.3 light years).  You can build a picture and see what happened: <br><pre> <code class="python hljs">plt.plot(DL,z,<span class="hljs-string"><span class="hljs-string">'.'</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">r'$D_{L}\;\mathrm{[Mpc]}$'</span></span>,size=<span class="hljs-number"><span class="hljs-number">18</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">r'$z$'</span></span>,size=<span class="hljs-number"><span class="hljs-number">18</span></span>)</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/21c/6d7/e0f/21c6d7e0f5d2e57d2569199c7a6a6e2a.png"><br><br>  Now let's convert the redshift, <b>z</b> , to speed.  To begin, we need a function to convert the speed into a redshift, that is, the inverse function: <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        #   c=29979245800 # cm/s #       def v2z(v): return sqrt((1.0+v/c)/(1.0-v/c))-1.0</span></span></code> </pre><br>  The formula is taken from here: <a href="http://en.wikipedia.org/wiki/Redshift">en.wikipedia.org/wiki/Redshift#Redshift_formulae</a> <br><br>  To convert in the opposite direction, we will calculate in advance the correspondence between z_list and v_list, after which we will write a function that interpolates between points: <br><pre> <code class="python hljs">v_list=linspace(<span class="hljs-number"><span class="hljs-number">0</span></span>,c,<span class="hljs-number"><span class="hljs-number">100</span></span>) z_list=v2z(v_list) <span class="hljs-comment"><span class="hljs-comment"># plt.plot(z_list,v_list) def z2v(z): return np.interp(z,z_list,v_list)/1e5 v=z2v(z) # km/s</span></span></code> </pre><br><br>  Let's look at the speed of an object depending on its distance from us: <br><pre> <code class="python hljs">plt.plot(DL,v,<span class="hljs-string"><span class="hljs-string">'.'</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">r'$D_{L}\;\mathrm{[Mpc]}$'</span></span>,size=<span class="hljs-number"><span class="hljs-number">18</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">r'$v\;\mathrm{[km/s]}$'</span></span>,size=<span class="hljs-number"><span class="hljs-number">18</span></span>)</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/a66/b8d/69f/a66b8d69f37135b913d1dbd220bd4dc6.png"><br><br>  This picture clearly shows that the farther the object, the faster it moves away from us.  Let's try to profit direct.  The slope of the straight line (derivative) at point 0 is called the Hubble constant, <b>H</b> , and is measured in km / s / Mps.  You can find this slope by fitting, but we will go in a simple way.  Just pick the slope: <br><br><pre> <code class="python hljs">plt.plot(DL,v,<span class="hljs-string"><span class="hljs-string">'.'</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">r'$D_{L}\;\mathrm{[Mpc]}$'</span></span>,size=<span class="hljs-number"><span class="hljs-number">18</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">r'$v\;\mathrm{[km/s]}$'</span></span>,size=<span class="hljs-number"><span class="hljs-number">18</span></span>) temp=np.array([<span class="hljs-number"><span class="hljs-number">0.0</span></span>,<span class="hljs-number"><span class="hljs-number">20.0</span></span>]) plt.plot(temp,<span class="hljs-number"><span class="hljs-number">50.0</span></span>*temp,<span class="hljs-string"><span class="hljs-string">'r'</span></span>) plt.plot(temp,<span class="hljs-number"><span class="hljs-number">70.0</span></span>*temp,<span class="hljs-string"><span class="hljs-string">'g'</span></span>) plt.plot(temp,<span class="hljs-number"><span class="hljs-number">100.0</span></span>*temp,<span class="hljs-string"><span class="hljs-string">'m'</span></span>) plt.legend((<span class="hljs-string"><span class="hljs-string">'data'</span></span>,<span class="hljs-string"><span class="hljs-string">'H=50'</span></span>,<span class="hljs-string"><span class="hljs-string">'H=70'</span></span>,<span class="hljs-string"><span class="hljs-string">'H=100'</span></span>))</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5e2/9b9/002/5e29b90024f5e445dc7f0d42249626b5.png"><br>  And an enlarged version: <br><img src="https://habrastorage.org/getpro/habr/post_images/dc8/8e2/21b/dc88e221bc6ae5b1e7c464b97092e825.png"><br><br>  The most accurate guess: H = 70 km / s / Mps.  That is, the object located in 1 Mps away from us at a speed of 70 km / s.  In other words, we were with him at one point so many years ago (assuming that the speed of divergence was constant): <br><br>  <b>(1 Mps) / (70 km / s) = 1 / H = 14,000,000,000 years ago</b> <br><br>  <i>( <a href="https://www.google.com/search%3Fq%3D1%252F(70%2Bkm%252Fs%252FMpc)%2Bin%2Byears">Google is</a> good at converting various units of measurement.)</i> <br><br>  So, after a few lines of code, we found that the age of the universe is about 14 billion years.  First, it is a very rough estimate.  Secondly, we did not appreciate the measurement error, which must be done in any experiment.  We also did not say how we know the brightness of supernova explosions, and why we consider them the same.  These are also separate interesting topics.  Nevertheless, such a rough estimate gives a good result!  A more accurate analysis with all known observations gives a result of 13.813 ¬± 0.058 billion years. <br><br>  At the time, Hubble observed only the very beginning of such a diagram (from his 1929 article <a href="http://apod.nasa.gov/diamond_jubilee/d_1996/hub_1929.html">apod.nasa.gov/diamond_jubilee/d_1996/hub_1929.html</a> ) <br><img src="https://habrastorage.org/getpro/habr/post_images/199/f11/b1e/199f11b1e910d1d031fd15daba1bc9e0.gif"><br>  and received instead of 70, the number 500. However, the error is less than 10 times, which is defended for hit. <br><br><h4>  Dark energy? </h4><br><br>  In the figures you can see that the line fits only at the beginning of the diagram.  Further, the linear approximation does not fit at all.  For the next step, we will need to dive a bit into cosmology.  In the simplest model, the Universe consists of matter and of dark energy (Einstein's lambda term), and at the same time is flat.  Having designated the part of the Universe, consisting of matter, for Omega_M and another part of the Universe of some dark energy, for Omega_L, and Omega_M + Omega_L = 1, I can express the distance to an object through redshift using the formula (you can read more on Wikipedia: <a href="http://en.wikipedia.org/wiki/Distance_measures_(cosmology)">[1]</a> <a href="http://en.wikipedia.org/wiki/Friedmann%25E2%2580%2593Lema%25C3%25AEtre%25E2%2580%2593Robertson%25E2%2580%2593Walker_metric">[2]</a> ): <br><br>  <i>Introduce the auxiliary function E (z):</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/244/ef8/f1e/244ef8f1e976a739cc89ae73543d2bff.png" alt="image"><br>  <i>Omega_k, which appears here, is responsible for the curvature of the universe.</i>  <i>For simplicity, we consider it flat, that is, Omega_k = 0.</i>  <i>Therefore, in the following formula, we need a middle line:</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/54f/a76/28e/54fa7628e9010391a883445544589ff7.png" alt="image"><br>  <i>Key integral</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/644/7a8/7ba/6447a87ba82e8536b08764eef137850e.png" alt="image"><br>  <i>Additional factor (1 + z), the origin of which is too long to explain :):</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/057/18c/dde/05718cdde70a262fe7a1ecc59602cf7a.png" alt="image"><br><br>  Next, write the code that calculates the integral: <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  E_z def e_Z(z, OmegaM): OmegaL=1.0-OmegaM return (OmegaM*(1.0+z)**3+OmegaL)**(-0.5) #   scipy   import scipy.integrate as si #  def D_L(z, OmegaM): dh=4286.0 #   c/H,  H    70 // D_c=dh*si.quad(e_Z,0.0,z,args=(OmegaM))[0] return D_c*(1.0+z) #    ,       def D_L_batch(z,OmegaM,H): DL=z.copy() for i in range(len(z)): DL[i]=D_L(z[i],OmegaM,H) return DL #   plt.plot(DL,v,'.') plt.xlabel(r'$D_{L}\;\mathrm{[Mpc]}$',size=18) plt.ylabel(r'$v\;\mathrm{[km/s]}$',size=18) #      z-  0  1.5, 100  temp_z=np.linspace(0,1.5,100) #       v- temp_v=z2v(temp_z) #         Omega_M plt.plot(D_L_batch(temp_z,0.01,70.0),temp_v,'r') plt.plot(D_L_batch(temp_z,0.27,70.0),temp_v,'g') plt.plot(D_L_batch(temp_z,0.99,70.0),temp_v,'m') plt.legend(('data',r'$\Omega_M=0.01$',r'$\Omega_M=0.27$',r'$\Omega_M=0.99$'),loc=4)</span></span></code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/072/e02/faa/072e02faaddf80bde9f6f8bc24ce0195.png"><br>  The green curve fits the data a little better.  For the sake of simplicity, we forget about the error of fitting the theory into the data.  The conclusion is the following.  The amount of dark energy and matter are comparable today (models in which the ratio of 100 to 1 does not fit into the data).  This is quite an interesting fact.  About ~ 70% of the Universe is some kind of dark energy, the nature of which we do not understand yet.  The remaining ~ 30% of matter is also not as simple as it seems.  From it only the fifth part is baryonic matter (that of which we consist), and the rest is <b>dark matter</b> .  As for it, its amount can also be estimated some other time. <br><br>  Well, here we are.  Lastly, I‚Äôll just say that this is far from the only way to measure the geometry and age of the Universe.  There are several of them.  And remarkably, they all speak in favor of the theory of the Big Bang and the expanding Universe. <br><br>  Happy celebration of the name day of Jesus, gentlemen!  :) </div><p>Source: <a href="https://habr.com/ru/post/207822/">https://habr.com/ru/post/207822/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../207812/index.html">The best of the world of PHP for 2013 + competition from the company JetBrains! The digest of interesting materials ‚Ññ32</a></li>
<li><a href="../207814/index.html">PHP framework 2013</a></li>
<li><a href="../207816/index.html">Financing increases your risk</a></li>
<li><a href="../207818/index.html">Automator service that uploads images to Yandex. Photos</a></li>
<li><a href="../207820/index.html">Asterisk: DND mode on the BLF key</a></li>
<li><a href="../207824/index.html">What color is the moon?</a></li>
<li><a href="../207830/index.html">Cellular Automatics on Dart</a></li>
<li><a href="../207832/index.html">Intel Inside: disassemble the latest Digma devices on the Intel platform and wonder about the progress of Chinese engineering</a></li>
<li><a href="../207834/index.html">Our experience in optimizing nginx to distribute video content</a></li>
<li><a href="../207838/index.html">For improving the search for information on Habr√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>