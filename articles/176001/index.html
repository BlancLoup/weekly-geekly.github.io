<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ASP.NET MVC Lesson 1. Start</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The purpose of the lesson: To study the Global.asax and web application launch behavior, processing the web request. Learning Nuget and Connecting Log...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ASP.NET MVC Lesson 1. Start</h1><div class="post__text post__text-html js-mediator-article">  <b>The purpose of the lesson:</b> To study the Global.asax and web application launch behavior, processing the web request.  Learning Nuget and Connecting Logging. <br><br><h5>  Start </h5><br>  Create an ASP.NET MVC 4 Web Application "Lesson1" application (Figure 1.): <br><br><img src="https://habrastorage.org/storage2/ab8/247/78f/ab824778ffc23afca87e93b7295e7ffe.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><img src="https://habrastorage.org/storage2/bb5/1d0/335/bb51d0335feaff42704b5f81bd29b8ff.jpg"><br><br>  We will not launch the application, but install it immediately (if you haven‚Äôt already done so) the NuGet extension: <br><br><img src="https://habrastorage.org/storage2/41a/823/53f/41a82353fd83ff2276f181bc37f78c46.jpg"><br><br>  NuGet Package Manager is an extension for Visual Studio that allows you to add modules to existing projects that greatly simplify the work.  When creating the ‚ÄúBasic‚Äù asp.net mvc4 application, many modules were initially added to the application itself.  We can find their list by clicking on Manage NuGet Packages ... in the context menu of the project: <br><br><img src="https://habrastorage.org/storage2/2d6/69f/7fb/2d669f7fb8c8c72bad66e5a15286a62d.jpg"><br><br><img src="https://habrastorage.org/storage2/b43/b1f/59f/b43b1f59f00184f4e5683825fd4d1a01.jpg"><br><br>  About them in order: <br><br><ul><li>  <b>Entity Framework</b> - provides work with the database </li><li>  <b>jQuery (+ jQuery UI, jQuery Validation)</b> is a popular javascript framework (we‚Äôll talk about it later). </li><li>  <b>Json.NET</b> - classes for working with json-data format. </li><li>  <b>knockoutjs</b> - javascript library for working with Model View ViewModel architecture.  ( <a href="http://knockoutjs.com/">http://knockoutjs.com/</a> ) </li><li>  <b>Microsoft.Net Framework 4 Http Client Libraries</b> is a program interface for working with HttpContext. </li><li>  <b>Microsoft ASP.NET MVC 4</b> - in fact, the classes of the MVC design pattern (what is the subject of study) </li><li>  <b>Microsoft ASP.NET Razor 2</b> - view-engine.  There are also ASPX and Spark - we will also talk about them later </li><li>  <b>Microsoft ASP.NET Universal Providers Core Libraries (Microsoft ASP.NET Universal Providers for LocalDB)</b> - provides tools to support all SQL Server 2005 (and later) and for SQL Azure. </li><li>  <b>Microsoft ASP.NET Web API (Microsoft ASP.NET Web API Client Libraries, Microsoft ASP.NET Web API Core Libraries, Microsoft ASP.NET Web API Web Host)</b> - for creating REST applications, working with XML, JSON, and so on </li><li>  <b>Microsoft ASP.NET Web Optimization Framework</b> - optimizes data transfer, for example, minimizes js code </li><li>  <b>Microsoft ASP.NET WebPages 2</b> - a set of classes for working in View </li><li>  <b>Microsoft jQuery Unobtrusive Ajax (Microsoft jQuery Unobtrusive Validation)</b> - jQuery library to support ajax / validation </li><li>  <b>Microsoft.Web.Infrastructure</b> - allows you to dynamically register HTTP-modules at runtime </li><li>  <b>Modernizr</b> - js-library that allows you to use html5 and css3 in older browsers </li><li>  <b>WebGrease</b> - allows minifying html, css, js. </li></ul><br>  Now that we‚Äôve roughly figured out what our application consists of, let's run it. <br>  To do this, you need to create a HomeController: <br><br><img src="https://habrastorage.org/storage2/17f/e71/d62/17fe71d62a1d4504f0f809c6a7f8c70c.jpg"><br><br><img src="https://habrastorage.org/storage2/29d/9ba/d2e/29d9bad2e6969dff4c6c975070c5004c.jpg"><br><br>  For the Index method (action), add a View and select ~ Views / Shared / _Layout.cshtml as the layout (of the master page type): <br><br><img src="https://habrastorage.org/storage2/187/ba5/42d/187ba542d3ce1005e00ff350d5a59f5f.jpg"><br><br><img src="https://habrastorage.org/storage2/56f/0f6/849/56f0f684990ce0ac9f0a0689ee5e4808.jpg"><br><br>  Actually, we can run. <br>  All we will see is: <br><br><img src="https://habrastorage.org/storage2/778/79b/2a3/77879b2a3bbf19b1869801b09cf38aa8.jpg"><br><br>  Why it was necessary to call the controller Home and how it works, we will study in more detail in the following lessons. <br><br><h5>  Global.asax </h5><br>  And now let's pay attention to the Global.asax file: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MvcApplication</span></span> : <span class="hljs-title"><span class="hljs-title">System</span></span>.<span class="hljs-title"><span class="hljs-title">Web</span></span>.<span class="hljs-title"><span class="hljs-title">HttpApplication</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Application_Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { AreaRegistration.RegisterAllAreas(); FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters); RouteConfig.RegisterRoutes(RouteTable.Routes); BundleConfig.RegisterBundles(BundleTable.Bundles); } }</code> </pre> <br>  The MvcApplication class inherits HttpApplication and contains instructions for initializing the application.  There are a few more events to which you can add code.  Consider them: <br><br><ul><li>  <b>public void Init ()</b> - the application is initialized or on the first call.  It is called for all instances of the HttpApplication object. </li><li>  <b>public void Dispose ()</b> - called immediately before the destruction of the HttpApplication object.  This is an ideal place to clean up previously used resources. </li><li>  <b>Application_Error</b> - Occurs when an unhandled exception occurs in an application. </li><li>  <b>Application_Start</b> - occurs when the first HttpApplication instance is created.  This allows you to create objects available to all instances of the HttpApplication class. </li><li>  <b>Application_End</b> - occurs when all previously created instances of the HttpApplication class are destroyed.  This event occurs only once during the entire lifetime of the application. </li><li>  <b>Application_BeginRequest</b> - occurs when the application receives a request.  The first time this event occurs for a page request when a user enters a URL. </li><li>  <b>Application_EndRequest</b> - The last event that occurs for a request to the application. </li><li>  <b>Application_PreRequestHandlerExecute</b> - occurs before ASP.NET starts the page handler or web service. </li><li>  <b>Application_PostRequestHandlerExecute</b> - occurs when ASP.NET finishes processing. </li><li>  <b>Applcation_PreSendRequestHeaders</b> - occurs before ASP.NET sends HTTP headers to the client (browser). </li><li>  <b>Application_PreSendContent</b> - occurs before ASP.NET sends HTTP content to the client (browser). </li><li>  <b>Application_AcquireRequestState</b> ‚Äî Occurs when ASP.NET receives the current state (session state) associated with the current request. </li><li>  <b>Application_ReleaseRequestState</b> - occurs when ASP.NET completes the execution of all events.  As a result, all modules retain their current state. </li><li>  <b>Application_ResolveRequestCache</b> - occurs when ASP.NET executes an authorization request.  This allows caching modules to process the request and serve from the cache, bypassing the execution handler. </li><li>  <b>Application_UpdateRequestCache</b> - occurs when ASP.NET completes the execution of the handler so that caching modules can save the result for use in subsequent responses. </li><li>  <b>Application_AuthenticateRequest</b> - occurs when the identification module identifies the current user as valid.  Currently, user credentials are already verified. </li><li>  <b>Application_AuthorizeRequest</b> - occurs when the authorization module confirms that the user can have access to resources. </li><li>  <b>Session_Start</b> - occurs when a new user visits the site. </li><li>  <b>Session_End</b> - it comes when the user's session time expires, or he leaves the site. </li></ul><br>  Good.  Now, to see firsthand that this is exactly what is happening, we will add logging and do this by adding the NLog module to NuGet. <br><br><h5>  Package manager console </h5><br>  NuGet has a console for executing commands to install / remove / search for modules, and other things, such as <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BA%25D0%25B0%25D1%2584%25D1%2584%25D0%25BE%25D0%25BB%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B3">scaffolding</a> . <br>  To display all installed modules we write: <br><pre> <code class="bash hljs">Get-Package</code> </pre><br>  To get all modules available for installation: <br><pre> <code class="bash hljs">Get-Package ‚ÄìListAvailable</code> </pre><br>  For all available modules called NLog <br><pre> <code class="bash hljs">Get-Package -ListAvailable -Filter NLog</code> </pre><br>  Or <br><pre> <code class="bash hljs">Get-Package -ListAvailable | <span class="hljs-built_in"><span class="hljs-built_in">where</span></span> {<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.Id -match <span class="hljs-string"><span class="hljs-string">"NLog"</span></span>} ( )</code> </pre><br>  To install the NLog module, you must first select a project (if there are more than one in the solution) and enter the command: <br><pre> <code class="bash hljs">Install-Package NLog</code> </pre><br><br><img src="https://habrastorage.org/storage2/536/155/fad/536155fadd87edca1a3a46fcaaec973b.jpg"><br><br>  Files are copied to the project, links to assemblies are added, and web.config can be updated. <br>  To remove a module from a project, it is necessary that it is not associated with other modules.  Delete this: <br><br><pre> <code class="bash hljs">Uninstall-Package NLog</code> </pre><br><h5>  Nlog </h5><br>  After installation, we use the documentation on NLog ( <a href="https://github.com/nlog/nlog/wiki/Tutorial">https://github.com/nlog/nlog/wiki/Tutorial</a> ) and add to Web.config: <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configSections</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nlog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NLog.Config.ConfigSectionHandler, NLog"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nlog</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.nlog-project.org/schemas/NLog.xsd"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">targets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logfile"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fileName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"C://file.txt"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">targets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rules</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logger</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">minlevel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Info"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">writeTo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logfile"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rules</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nlog</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  We will fix it later.  Add to the code (Global.asax.cs): <br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MvcApplication</span></span> : <span class="hljs-title"><span class="hljs-title">NinjectHttpApplication</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> NLog.Logger logger = NLog.LogManager.GetCurrentClassLogger();</code> </pre><br>  and <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Application_Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { logger.Info(<span class="hljs-string"><span class="hljs-string">"Application Start"</span></span>); AreaRegistration.RegisterAllAreas(); FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters); RouteConfig.RegisterRoutes(RouteTable.Routes); BundleConfig.RegisterBundles(BundleTable.Bundles); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { logger.Info(<span class="hljs-string"><span class="hljs-string">"Application Init"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { logger.Info(<span class="hljs-string"><span class="hljs-string">"Application Dispose"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Application_Error</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { logger.Info(<span class="hljs-string"><span class="hljs-string">"Application Error"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Application_End</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { logger.Info(<span class="hljs-string"><span class="hljs-string">"Application End"</span></span>); }</code> </pre><br>  Run and complete the application (Stop).  Open the file C: //file.txt.  We will see what happened. <br><br><pre> <code class="bash hljs">2012-09-18 19:18:11.5668|INFO|Lesson1.MvcApplication|Application Start 2012-09-18 19:18:13.7319|INFO|Lesson1.MvcApplication|Application Init 2012-09-18 19:18:14.2709|INFO|Lesson1.MvcApplication|Application Init 2012-09-18 19:18:14.2769|INFO|Lesson1.MvcApplication|Application BeginRequest 2012-09-18 19:18:14.3579|INFO|Lesson1.MvcApplication|Application AuthenticateRequest 2012-09-18 19:18:14.3579|INFO|Lesson1.MvcApplication|Application AuthorizeRequest 2012-09-18 19:18:14.3579|INFO|Lesson1.MvcApplication|Application ResolveRequestCache 2012-09-18 19:18:14.3989|INFO|Lesson1.MvcApplication|Session Start 2012-09-18 19:18:14.3989|INFO|Lesson1.MvcApplication|Application AcquireRequestState 2012-09-18 19:18:14.3989|INFO|Lesson1.MvcApplication|Application PreRequestHandlerExecute 2012-09-18 19:18:15.9580|INFO|Lesson1.MvcApplication|Application PreRequestHandlerExecute 2012-09-18 19:18:15.9580|INFO|Lesson1.MvcApplication|Application ReleaseRequestState 2012-09-18 19:18:15.9580|INFO|Lesson1.MvcApplication|Application UpdateRequestCache 2012-09-18 19:18:15.9580|INFO|Lesson1.MvcApplication|Application EndRequest 2012-09-18 19:18:15.9580|INFO|Lesson1.MvcApplication|Application PreSendRequestHeaders 2012-09-18 19:18:35.6061|INFO|Lesson1.MvcApplication|Session End 2012-09-18 19:18:38.0833|INFO|Lesson1.MvcApplication|Application Dispose 2012-09-18 19:18:38.0833|INFO|Lesson1.MvcApplication|Application End 2012-09-18 19:18:39.1383|INFO|Lesson1.MvcApplication|Application Dispose</code> </pre><br>  Registration is performed in Application_Start: <br><ul><li>  Area, </li><li>  Filter (filters) </li><li>  Bundle (kits), </li><li>  Route (routes). </li></ul><br>  Details on Filter initialization, Bundle and Route are located in the App_Start folder. <br><br><h5>  WebActivator </h5><br>  WebActivator is a module that allows you to run the code until the very first start of App_Start.  This may be necessary in order to, for example, create a test database before launching. <br>  Install: <br><br><pre> <code class="bash hljs">Install-Package WebActivatorEx</code> </pre><br><br>  Add a class to the App_Start folder: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">assembly: WebActivator.PreApplicationStartMethod(typeof(PreStartApp), </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Start"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Lesson1.App_Start</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PreStartApp</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> NLog.Logger logger = NLog.LogManager.GetCurrentClassLogger(); <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">        </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public static void Start() { logger.Info("Application PreStart"); } } }</span></span></code> </pre><br>  In the log file, we see that the Application PreStart line is executed before the Application Start: <br><pre> <code class="bash hljs">2012-09-19 10:29:01.3950|INFO|Lesson1.App_Start.PreStartApp|Application PreStart 2012-09-19 10:29:01.6290|INFO|Lesson1.MvcApplication|Application Start</code> </pre><br>  Create four files separately for trace (tracing), debug (debugging), info (information), error (errors).  Determine the place of recording: <b>/ Contents / logs / [current date]</b> We will rewrite the configuration: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nlog</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autoReload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.nlog-project.org/schemas/NLog.xsd"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logDirectory"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${basedir}/Content/logs/${shortdate}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">targets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileLogTrace"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fileName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${logDirectory}/trace.txt"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileLogDebug"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fileName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${logDirectory}/debug.txt"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileLogInfo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fileName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${logDirectory}/info.txt"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileLogErrors"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fileName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${logDirectory}/errors.txt"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">targets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rules</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logger</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Trace"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">writeTo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileLogTrace"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logger</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Debug"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">writeTo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileLogDebug"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logger</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Info"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">writeTo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileLogInfo"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logger</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">minlevel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Warn"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">writeTo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileLogErrors"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rules</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nlog</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><h5>  Log2Console </h5><br>  For NLog there is also a cool Log2Console program that allows you to get logs right in the program window. <br><br><img src="https://habrastorage.org/storage2/b04/796/970/b047969706fd6b3be30054ac4726ed8f.jpg"><br><br>  Run the program and configure the receiver: <br><br><img src="https://habrastorage.org/storage2/8da/d50/227/8dad50227849223d5358552484bc63e5.jpg"><br><br>  In Web.config we write: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TcpOutlet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NLogViewer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tcp4://localhost:4505"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br>  I pay attention that you need to write <b>address = "tcp4: // ..."</b> , and not <b>address = "tcp: // ..."</b> <br><br>  All sources are located at <a href="https://bitbucket.org/chernikov/lessons">https://bitbucket.org/chernikov/lessons</a> </div><p>Source: <a href="https://habr.com/ru/post/176001/">https://habr.com/ru/post/176001/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../175989/index.html">Launch .NET MicroFramework on STM32F4Discovery (translation)</a></li>
<li><a href="../175991/index.html">LibreOffice in the corporate sector - from theory to practice</a></li>
<li><a href="../175993/index.html">Open government and all other state structures as platforms</a></li>
<li><a href="../175995/index.html">10 Tips for Initially Setting Up a Hyper-V Environment</a></li>
<li><a href="../175999/index.html">ASP.NET MVC. Lesson 0. Introduction</a></li>
<li><a href="../176005/index.html">Ultrabook Acer Aspire S7-191 video review</a></li>
<li><a href="../176007/index.html">ASP.NET MVC Lesson 2. Dependency Injection</a></li>
<li><a href="../176013/index.html">#FailOverConf - how it was, presentations and videos</a></li>
<li><a href="../176015/index.html">Whatsapp not for sale</a></li>
<li><a href="../176017/index.html">ASP NET.MVC Lesson 3. Working with the Database</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>