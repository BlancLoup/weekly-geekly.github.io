<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Text at any cost: Miette</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yes, you are not mistaken, and this is not a deja vu. You probably once (if a frequenter) saw this topic . Much time has passed since then, and I cont...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Text at any cost: Miette</h1><div class="post__text post__text-html js-mediator-article">  Yes, you are not mistaken, and this is not a deja vu.  You probably once (if a frequenter) saw <a href="http://habrahabr.ru/blogs/php/72745/">this topic</a> .  Much time has passed since then, and I continue to receive letters with questions and requests for advice on the topic of reading textual information from binary data formats.  And this means that the topic is still relevant, interesting for the programming community. <br><br>  For this year (and indeed it has been more than a year) I have changed my place of work and have been doing completely different things and haven‚Äôt been programming for a long time (I don‚Äôt program much, to be precise) with PHP.  The new project obliged me to improve in python (and feel its power), so one Sunday evening it was decided to rewrite and, most importantly, improve some of my libraries for reading text.  Today, I will present to the public a young <a href="https://github.com/don-ramon/Miette">Miette</a> opensource-project (‚Äú <a href="https://github.com/don-ramon/Miette">tasty</a> ‚Äù if translated from French), which is designed (in any future) to read Microsoft Office files. <br><br>  Myett‚Äôs main task will be primarily to read plain text from office formats, but this time I would like to go further and create the impossible: force the parser to read the formatting (at least minimal).  The task is difficult, but quite feasible, if there is time in the evenings and interest (and perhaps feasible help in the form of testing and joint development) from the part of the suffering population.  But these are just plans and, so to speak, a hobby. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Naturally, python differs in many ways from PHP and, in my opinion, has somewhat more functionality, so the principle of building libraries in a project is somewhat different than the old PHP hack.  In this case, it was decided to forbid myself, as a developer and customer in one person, to load any large blocks into memory.  Miett reads data gradually, on demand, as Word itself does.  This makes it lightweight and undemanding to RAM.  In the future, I will try to go through the initial profiler and find narrow necks that should be optimized further. <br><br>  Go ahead? <a name="habracut"></a><br><br>  I advise you to review the <a href="http://habrahabr.ru/blogs/php/72745/">old article</a> and source code for <a href="">cfb</a> and <a href="">doc</a> in PHP before reading further. <br><br><h4>  Project structure </h4><br>  The project consists (and subsequently will consist of) directories, each of which contains a reader of a particular type of file.  Now there is a reader on Compound File Binary File Format, which is a wrapper over the data of most office files, and for DOC (Microsoft Word).  Next, add support for XLS and PPT. <br><br>  CFB contains two main objects - Reader and DirectoryEntry, on which the rest of the "readers" are built.  The first provides an interface for working with "entries in the directory" that make up the CFB storage.  With the Reader class, you can access the required entry by name and number.  For the root entry (‚ÄúRoot Entry‚Äù), a forwarding was made to the attribute, which, as can be replaced in the DirectoryEntry class, largely orders and standardizes work with mini FAT. <br><br>  DirectoryEntry implements the minimal interface for working with files: read ([size]), seak (offset, [whence]) and tell ().  This again simplifies working with "occurrences" and, in general, in the spirit of python.  You can still read the whole entry with read () without a parameter, but when reading a few bytes, you will get quite an advantageous solution that no extra bit will read.  In addition, you can access the left / right sibling and child "entries" through the appropriate attributes - this makes walking around the CFB tree convenient and unobtrusive. <br><br>  On the example of DocTextReader you can see an example of working with CFB.  As you can see, unlike the PHP implementation, we try to read a smaller amount of data into RAM, constantly moving through the doc file.  We get help from the additional DirectoryEntry get_byte, get_short and get_long methods that read the corresponding number of bytes from a certain place.  Implemented probros main "entries" 0 / 1Table and WordDocument as class attributes. <br><br>  This implementation has a test character, in the future DocTextReader will have standardized methods for reading a specified number of bytes from the selected position, and possibly some other functions of the file class. <br><br><h4>  Usage example </h4><br>  And finally, an example of using the library. <br><br> <code><b>from</b> doc <i>.</i> text <b>import</b> DocTextReader <br> <br> doc <i>=</i> DocTextReader <i>(</i> <b>'parus.doc'</b> <i>)</i> <br> root_entry <i>=</i> doc <i>.</i> root_entry <br> word_document <i>=</i> doc <i>.</i> get_entry_by_name <i>(</i> <b>'WordDocument'</b> <i>)</i> <br> one_table <i>=</i> root_entry <i>.</i> child <i>.</i> left_sibling <i>.</i> left_sibling <br> <br> fc_clx <i>=</i> self <i>.</i> word_document <i>.</i> get_long <i>(</i> 0x01a2 <i>)</i> <br> <br> one_table <i>.</i> seek <i>(</i> fc_clx <i>)</i> <br> <b>print</b> one_table <i>.</i> read <i>(</i> 1 <i>)</i> <br> <b>print</b> one_table <i>.</i> tell <i>(</i> <i>)</i> <i># fc_clx + 1</i> <br> <br> <b>print</b> doc <i>.</i> read <i>(</i> <i>)</i></code> <br> <br>  PS I hope Miette and I will not disappoint you.  Stay tuned for updates on <a href="https://github.com/don-ramon/Miette">GitHub</a> :) </div><p>Source: <a href="https://habr.com/ru/post/109124/">https://habr.com/ru/post/109124/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../109114/index.html">250 MW solar power station to be built in California</a></li>
<li><a href="../109116/index.html">Stupid phpbb3 integration with any site</a></li>
<li><a href="../109117/index.html">Hacking programs for dummies</a></li>
<li><a href="../109118/index.html">Google may acquire Groupon for $ 6 billion</a></li>
<li><a href="../109120/index.html">Migration appeared in Yii</a></li>
<li><a href="../109125/index.html">We connect to the player from Vogue headphones and volume control</a></li>
<li><a href="../109127/index.html">Facebook video chat with roulette</a></li>
<li><a href="../109128/index.html">Meeting lovers UMPC, Tablet PC and MID. Moscow</a></li>
<li><a href="../109129/index.html">Screencasts on how to cut and pull</a></li>
<li><a href="../109133/index.html">CSS Problem</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>