<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Homemade OpenPnP Component Installer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Back in 2012, my work began in the field of electronics, while the Internet introduced me to many good people, some of whom we communicate to this day...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Homemade OpenPnP Component Installer</h1><div class="post__text post__text-html js-mediator-article"> Back in 2012, my work began in the field of electronics, while the Internet introduced me to many good people, some of whom we communicate to this day.  Usually we share our experiences, successes and failures, discuss new electronics, various ideas and what‚Äôs new you can develop or explore. <br><br>  Since then, a certain tradition was born at the beginning of each year to compile a TODO sheet, in which any ideas, including delusions, were recorded.  In the process, the list was replenished, and at the end of the year the results were summed up, which turned out to be not. <br><br>  On New Year's holidays I went through the old screw and accidentally stumbled upon those very records.  It was found that everything is somehow already implemented.  All but one, SMD installer. <br><a name="habracut"></a><br>  We discussed the idea of ‚Äã‚Äãits creation more than once, but the mechanic frightened us - what if it didn't work out.  Therefore, it is still it was more like an impossible dream. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Under the influence of nostalgia, it was useful to watch videos, sigh, realizing that the dream remained a dream.  Then, purely out of curiosity, I looked at what the world opensource offers and came across Openpnp.  I won‚Äôt say that I haven‚Äôt heard about it before, but as a few, those who repeated the design, it was very alarming.  This time their site was studied in more detail, among other things, there was a bom list, firmware for the controller and a program for the PC.  Then, having turned off the brain for a second, I ordered the first part from the list and decided that it was too late to retreat. <br><br>  I hope from this introduction it became clear that the author had not previously assembled pick and place machines.  There was no purpose and make a commercial product.  Therefore, I do not exclude that later in the text there will be errors in terms and some conclusions may be incorrect.  It was just interesting for me to repeat the device, deal with its principles and try my hand.  I would like to share this with the reader. <br><br>  The first thing that is misleading is what OpenPnP is all about.  Even today it is difficult to answer this question.  Iron can be very different, for example, at the heart of my build is iron from OpenBuilds and the Smoothieboard controller, both companies have nothing to do with OpenPnP.  You can easily throw out any component of the piece of iron and change it to another.  The principles remain common: there is a PC program of the same name into which you download pick and place from your tracer, then the program issues commands to the controller, go there, turn it on. <br><br>  Appearance of the program. <br><br><img src="https://habrastorage.org/webt/px/5q/ia/px5qiawh4llae-h_zpa_4uanj9y.png"><br><br>  As mentioned above, the main frame is taken from OpenBuilds, V-slot slats are used as guides.  For me, they were a discovery, in a nutshell, it is difficult to explain all their advantages, but it is very easy to make any constructions of them. <br><br><img src="https://habrastorage.org/webt/fy/ge/_q/fyge_qgsjtnvpnymflnq7vmrwhy.jpeg"><br><br>  If you need something to attach to the rail, then threaded plates are inserted into the side, their official name is t-nut. <br><br><img src="https://habrastorage.org/webt/2b/kz/vm/2bkzvm_z503hvv4qorgc_-jx8-i.jpeg"><br><br>  They are single and double.  It looks like an ordinary plate with thread, I even thought about finding something similar in local stores at the beginning, since they are not cheap.  However, do not be fooled by their apparent simplicity.  They have a thread protruding above the plate and this turned out to be very important when tightening the screw.  The mount is very solid. <br><br>  How is the movement along the axes?  The basic idea is to insert a carriage into the side depressions, to the top platform of which you can attach anything. <br><br><img src="https://habrastorage.org/webt/xs/st/3m/xsst3ma5jzklsccf_pj7dc6qyve.jpeg"><br><br>  The carriage itself is simple - it is a plate with four rollers.  The position of the rollers is adjusted by the eccentric nuts, they help adjust the pressure of the wheels to the rail.  It depends on how tight it will move. <br><br>  An end plate is attached to the rail from each end. <br><br><img src="https://habrastorage.org/webt/n1/pk/el/n1pkeljxxojlqqw1gh4mjr3q6hy.jpeg"><br><br>  On the side of the plate there are holes to which a Nema17 motor is attached.  A gear wheel is put on the motor, which pulls the belt, the belt is attached to the carriage with two ends.  Thus, when the motor turns in one direction, the carriage moves forward, when in the other - back. <br><br><img src="https://habrastorage.org/webt/b-/7m/8z/b-7m8zjn6ij8o9xotpfx8ugxwxi.jpeg"><br><br>  At the second end of the rail just shaft, which slides the belt. <br><br><img src="https://habrastorage.org/webt/qy/nm/tw/qynmtw497wgdypnyr_dfy0rxwvg.jpeg"><br><br>  Now the subtleties that have arisen.  End plate  I do not know how hard it is in the original, the fact is that the prices for openbuilds are mostly adequate, but not an adequate price for delivery.  Therefore, almost everything was bought with Ali.  Including this detail. <br><br>  The plates are very easy to bend, and the lower "ear" and strives to break off.  In the original assembly, the frame is fastened just for him, I also had to use the side holes.  But otherwise it did not play a role, kept dead on the rail. <br><br>  About rails.  This is one of the few parts that I bought in Russia, because there is an opinion that they are being driven from China bent.  Check whether this desire was not, but to buy them from the locals was still a quest.  According to ads, they are everywhere, in fact or not available, or no one wants to contact you because of 3m.  Very often, under the guise of a V-slot, they offer a T-slot, which are very similar and more accessible.  There is an opinion that they are replaceable in this case, but did not dare to check.  As a result, they were available only in one place, it came to pay for the delivery more than the price of the rails themselves. <br><br>  Screws.  In the original, all fasteners with hexagon heads.  In the beginning it was not clear why.  Firstly, it is difficult to get them the right length, and secondly, they are much more expensive.  Therefore, I took part of the fastener for a cross-head screwdriver, honestly regretted it more than once.  Hexagon at times easier to unscrew, and when you still do not understand how it works, you had to unscrew it 10 times. <br><br>  Field size  The length of the original slats 400x400.  I think many, like me, rarely collect large size boards.  Therefore, the size seemed to me huge.  In practice, this was not the case.  Though a small part, but the limit switches eat up, another part goes to the corner plates, another part to the head, etc.  As a result, the real field is slightly more than 250x250, and this is not so much anymore. <br><br>  Springs for belt tension.  In the beginning, I ignored them.  It seemed like a useless thing.  In practice, in the first runs along the Y axis there was always a small error.  As a result, I had to figure out what springs are with the strange 7/32 marking. " <br><br><img src="https://habrastorage.org/webt/x4/2m/du/x42mdukos3rbq7updlepbuzxt4g.jpeg"><br><br>  Otherwise, there are no questions at all with the basis, the mechanics are going to be very simple.  The complete process of assembling a single rail is well shown in the video. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Aj6Vo5oeRyY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Perhaps you will have the same question as me, why was it not to take a threaded stud as a guide?  Why these rails, belts, gears?  There is an opinion that caught one of the forums that the shaft under its own weight will have a slight curvature in the center, which will create an error.  And to make an exact shaft will be much more expensive. <br><br>  The next question will immediately arise: how exactly does this whole design go?  Honestly, I do not know how to evaluate.  Subjectively - very accurately, exceeded expectations.  If you put an iron ruler and ride along it, controlling the camera, then millimeter to millimeter.  I did not notice an obvious accumulation of error. <br><br>  The next part of the story is the controller.  In the original OpenPnP, there is a Smoothieboard, focused on 3D printers, but this does not prevent them from fitting to the pnp machine.  If you dig deep, then he has an LPC1769 microcontroller and a pair of stepper drivers on board.  Let some readers condemn me, but the price of 150 euros excluding delivery, for a fee of this level seemed to me inadequate.  The most interesting thing is that the board is positioned as opensource, but I could not find the sane version of pcb or gerberas. <br><br>  As a result, the problem was solved by itself, it turned out that the Chinese have a similar fee. <br><br><img src="https://habrastorage.org/webt/ub/fa/1n/ubfa1nvuosb_cp53kuxj0-k75yk.jpeg"><br><br>  We must immediately make a reservation that the boards are very similar, but not identical.  The stones are the same and the GPIO layout is similar, so the software is suitable.  And yet there are minor differences.  All settings are stored in a text file on a memory card.  There are a lot of settings and this is a topic for a separate article.  There is Ethernet on board, and if you enable it, you can navigate along the axes through a web browser. <br><br>  Otherwise, the board is controlled via USB-UART, on the PC it is defined as an ordinary virtual COM port, i.e.  the program throws U codes G codes, and the controller only executes them.  In total, the machine has 3 main axes: X is the upper beam, when the head goes left to the right, it pulls only one motor.  Y - the lower 2 rails, up and down pull two motors simultaneously.  Z - lowering the nozzle up, down.  In this case, the machine uses the right-sided coordinate system, i.e.  the lower right corner - the house is 0, 0. The house is defined by limit switches, in fact, ordinary GPIO.  An additional C axis is also used, which is responsible for the component rotation. <br><br>  There is nothing special to say about the controller's problems, but globally all the sores inherent in the COM port are obvious - sometimes the port itself hangs until the board is rebooted.  There was a bug that the controller sometimes went the wrong way, but it was treated with a fresh firmware. <br><br>  Now the most important thing is the head.  Here with her the most was incomprehensible.  Here it is worth explaining how the component is generally captured - by vacuum.  A 12V pump is used for this, the tube goes from it to the valve.  In the original, the pump only works when it approaches a component, I didn‚Äôt have a big field driver on the board, like on the original board, so I temporarily left the pump to rumble constantly. <br><br>  The valve is normally closed, i.e.  the air is not sucked in.  When the head approaches the component, a signal is given, the valve opens and the pump sucks air through the tube.  The tube clings to the motor with a hollow shaft, on the other side of the motor a nozzle is connected through an adapter. <br><br>  What had to face.  The tube should be polyurethane, because it is tough enough not to overwhelm.  Nema8 motors are absolutely identical in the picture, but the seller sent the motor not with a smooth shaft, because of which it was impossible to fix the adapter with the nozzle.  I had to order new ones. <br><br>  The nozzle itself in the original boma was <br><br><img src="https://habrastorage.org/webt/fl/sz/j3/flszj3n29j3g01yn-bsiwfy0b7o.jpeg"><br><br>  Experiments have shown that it is impossible to use it, as seen in the photo it is a piece of a tube.  Because of this, there are a lot of problems with calibration, as the nozzle still firmly rests on the component.  Meanwhile, on the vidos I prayed for, there was another nozzle with a spring, which eventually had to be ordered. <br><br><img src="https://habrastorage.org/webt/cv/3y/hr/cv3yhridfm5xjsdxh9ykio4ya_0.jpeg"><br><br>  The nozzle is lowered by the Z-motor, i.e.  he turns and presses the rocker on the part holding the C-motor (the one with the hollow shaft). <br><br><img src="https://habrastorage.org/webt/a-/5q/w2/a-5qw2js1hqz3s1p6oreh1m0wnq.jpeg"><br><br>  That, in turn, moves along a linear guide and is connected by a spring, i.e.  when the engine does not press on the Z axis, the head returns to its original state due to the spring.  The C axis, the motor with a hollow shaft :) is designed to deploy the component. <br><br>  Now the most important thing is how does this whole structure work in assembly?  Runs the program on the PC.  It loads pick and place from your tracer.  You select the necessary components and specify the fiducial point, i.e.  anchor points on the board.  They look like copper rounders on the board. <br><br><img src="https://habrastorage.org/webt/a9/yu/c1/a9yuc1q6ilbjkvl9u0cbogoh-sg.jpeg"><br><br>  Coming to the ‚Äúhouse‚Äù, i.e.  in the lower right corner to the limit switches so that the machine understands its coordinates.  Next you need to specify where the board is located.  For this, you need to drive your hands to the bottom left corner of the board, very approximately.  We start the search for fiducial point, this procedure is needed to understand the exact origin of coordinates and the angle of inclination of the board.  The search is made by a camera, which is located on the head - upper vision.  Point recognition is done using opencv. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/aeW66c9oN5Y" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  In total, the position of the board is known, due to the upper view and components, due to the relative coordinates unloaded from pick and place.  It remains only to start the process of placement. <br><br>  Here comes the moment at which while I stopped.  As it turned out, starting movement along the axes and lowering the nozzle is not the most important thing in this business. <br><br><img src="https://habrastorage.org/webt/cf/pb/uo/cfpbuo--en2tu1fcwi8pm-ahr8y.jpeg"><br><br>  The problem was the supply of components.  The simplest option assumes that the tape with components will be pasted somewhere near the board.  As with the board coordinates, for each component you need to specify where the tape is located.  To tell the truth, the process turns out to be quite tedious, so you need to immediately do the automatic feeding of components, but this is another story. <br><br>  So, to draw a line to all of the above.  The experience was interesting.  And yes, it was worth it, even though it is still not a complete solution.  The mechanics are not as scary as they are painted.  The world opensource, though still not so friendly, but still need to say thank you to everyone who is selflessly working for the benefit of the people.  I really hope that there will be more to tell on this topic in the future. <br><br>  The first tests with the old nozzle <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/KOifjS7IsBo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Tests with a new nozzle <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/08ekcxOTW9k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/417773/">https://habr.com/ru/post/417773/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../417761/index.html">GitLab moves from Azure to the Google Cloud Platform. Moving news and maintenance dates</a></li>
<li><a href="../417763/index.html">MVIDroid: review of the new MVI library (Model-View-Intent)</a></li>
<li><a href="../417767/index.html">Text analysis using convolutional neural networks</a></li>
<li><a href="../417769/index.html">User Memory Design: How to Design Ages</a></li>
<li><a href="../417771/index.html">ICANN plan: the corporation proposed a new model for managing root DNS servers</a></li>
<li><a href="../417775/index.html">The mechanism of commissions in Bitcoin and why be friends with miners</a></li>
<li><a href="../417777/index.html">"Reading for the weekend": 25 materials for beginners vinyl lovers</a></li>
<li><a href="../417779/index.html">Using Unity3D in a native iOS / Android application for modeling open space lighting</a></li>
<li><a href="../417781/index.html">NASA probe "touches" the sun - and will not melt</a></li>
<li><a href="../417783/index.html">Optimizations used in Python: list and tuple</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>