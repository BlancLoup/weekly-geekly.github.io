<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Receivers demonstrate full-featured exploit for Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Researchers at the Israeli company NorthBit demonstrated one of the first experimental full-featured exploits for Android of all versions up to 5.1. T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Receivers demonstrate full-featured exploit for Android</h1><div class="post__text post__text-html js-mediator-article">  Researchers at the Israeli company <a href="http://north-bit.com/">NorthBit</a> demonstrated one of the first experimental full-featured exploits for Android of all versions up to 5.1.  The exploit is based on the already closed update of the <i>Nexus Security Bulletin - September 2015</i> vulnerability identifier CVE-2015-3864 (Stagefright), which caused a lot of noise last year.  The vulnerability was present in the Android library called Stagefright, which is used in the system component mediaserver.  It allowed attackers to get full access to the device by sending a specially crafted MMS message to the user. <br><br><img src="https://habrastorage.org/files/f95/f81/3fa/f95f813fa42049e6a6c973b85ff5b000.png"><br><br>  Exploit NorthBit called Metaphor.  In addition to a detailed description of the exploitation mechanism of the vulnerability, the researchers presented vulnerabilities in Android to bypass the DEP &amp; ASLR defense mechanisms that are used to protect against exploits relying on the location of the shell-code in the data area, and also rely on fixed addresses in Android memory for stable operation vulnerabilities.  As in Windows, the traversal is performed using the well-known ROP and heap-spray methods. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  Attack using exploit is divided into several steps. <br><br><ol><li>  At the first stage, an attack vector is selected, for example, a malicious MitM or XSS redirection, a malicious link in the message, and malicious HTTP content. </li><li>  Part of the exploit on a web page in the form of JavaScript code creates a so-called.  the attack session and gets the device ID Device ID, and then sends this information to the attacker's server.  This code specializes in conducting the entire subsequent operation process involving several malicious MPEG4 files. </li><li>  If the ID is necessary for the attackers, the MPEG4 video file (crash.mp4) is sent to the victim in a special way. </li><li>  Android uses the mediaserver process to play this video file, which causes the mediaserver system process to crash.  Such a step is necessary for setting the process to the initial state, which will allow to correctly perform the exploitation of the vulnerability.  After a crash, the process will automatically start again. </li><li>  Next, the exploit code sends a request to the remote server of the attackers to get another MPEG4 file called leak.mp4.  It is required for the disclosure of Android system memory pointers and the ASLR bypass. </li><li>  The remote server, based on the device ID information sent to it by the exploit in the previous step, returns to it leak.mp4, as well as a relative offset in the system libc.so file to form the ROP gadgets and DEP bypass. </li><li>  To play leak.mp4, Android again draws on the mediaserver process, which parses fake file metadata and is used by the exploit to bypass ASLR.  To bypass the ASLR, the universal method of calculating the delta through the vulnerable place of its initial formation is used on the Android-based Linux algorithm for ARM 32-bit.  The result of the ASLR bypass is the successful detection in memory of the header of the executable ELF file, on the basis of which a delta is formed to calculate the absolute addresses in the process. </li><li>  At this stage, all the preparatory actions are completed and the JavaScript code queries the remote server itself for the RCE exploit for the CVE-2015-3864 vulnerability, providing it with the device ID mentioned and some additional information about the location of the Android modules in memory. </li><li>  The remote server sends the malicious code JavaScript file rce.mp4, as well as all the information about the addresses in memory necessary for successful exploitation of the vulnerability.  Addresses were calculated in advance with leak.mp4. </li><li>  At the last stage, malicious JavaScript code launches rce.mp4 for execution, which leads to the triggering of a vulnerability and remote code execution.  Since the exploit is performed in the context of the mediaserver system process, it gets extended privileges on Android. </li></ol><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/I507kD0zG6k%3Ffeature%3Doembed&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhifl7iL0uDlE_5YzrOHEAgegXULZw" frameborder="0" allowfullscreen=""></iframe><br>  Fig.  Demonstration of the exploit Metaphor.  The victim follows the link to the animal web page, where the malicious video content with the exploit is located. <br><br>  According to market analysts, hundreds of millions of devices running Android work on versions of this mobile OS that are vulnerable to Metaphor.  Installing Android updates for your devices is the best measure to protect against this kind of vulnerabilities, but what should users of smartphones whose manufacturers do not adapt for them are new firmware released by Google.  Well, there is no definitive answer to this question yet ... We recommend users not to follow phishing links (as it was shown in the video) and use antivirus software as one of the main measures to protect their device. <br><br>  A full description of the functioning of Metaphor can be found at this <a href="http://file///C:/Users/Artem/Downloads/NorthBit-Metaphor.pdf">link</a> . <br>  The described vulnerability was closed by Google last September with the update of <i>Nexus Security Bulletin - September 2015</i> . <br><br><img src="https://habrastorage.org/files/7b9/030/6ba/7b90306bacea49be9241664cc9dd922a.png"></div><p>Source: <a href="https://habr.com/ru/post/279699/">https://habr.com/ru/post/279699/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../279681/index.html">New home for repository or history of moving to GitLab</a></li>
<li><a href="../279685/index.html">The digest of interesting materials for the mobile # 145 developer (March 14-20)</a></li>
<li><a href="../279687/index.html">Distribution of applications. Part 1: Creating a Formula for Homebrew</a></li>
<li><a href="../279689/index.html">2.3 Working with custom data streams</a></li>
<li><a href="../279695/index.html">Yet another instructions for obtaining the Let's Encrypt ssl certificate</a></li>
<li><a href="../279701/index.html">We use Yii2 migrations for working with multiple databases</a></li>
<li><a href="../279703/index.html">How to create the perfect pull request</a></li>
<li><a href="../279705/index.html">Is there a visible border on the web?</a></li>
<li><a href="../279709/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ203 (March 14 - 20, 2016)</a></li>
<li><a href="../279711/index.html">Access problem and interesting Windows registry key</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>