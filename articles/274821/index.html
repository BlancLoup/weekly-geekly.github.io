<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to predict a stock price: An adaptive filtering algorithm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A group of Brazilian scientists has published a study on the creation of a tool for predicting the behavior of assets traded on the stock market. The ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to predict a stock price: An adaptive filtering algorithm</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/itinvest/blog/274821/"><img src="https://habrastorage.org/files/6ab/ab4/c28/6abab4c287bb4554b6efe25e36763a17.jpg"></a> <br><br>  A group of Brazilian scientists has published a <a href="http://arxiv.org/pdf/1501.07504.pdf">study</a> on the creation of a tool for predicting the behavior of assets traded on the stock market.  The paper presents a detailed description of the method and method of calculation for such forecasts.  We present to your attention the most interesting moments of this document. <a name="habracut"></a><br><br><h4>  What is an adaptive filter </h4><br>  An adaptive filter is a tool that is capable of learning to achieve a given level of correspondence of the output to the real state of affairs.  By adaptability is meant the ability to respond to changes in input data in real time to achieve higher performance.  In practice, adaptive algorithms are implemented by two classical methods - the gradient method and least squares (LMS and RLS).  Such a filter can be used for a wide range of tasks - filtering, spectral analysis or search for signals, etc. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Figure 1 shows the universal scheme for applying an adaptive filter in a predictive framework, where k is the iteration number, x (k) is the incoming signal, y (k) is the output of the adaptive filter, which is the prediction of the desired answer d (k), and e (k ) - error signal, defined as the difference between the desired response and the output of the filter, that is, e (k) = d (k) - y (k). <br><br>  The recursive adaptive least squares algorithm (RLS, recursive Least-Squares) makes it possible to achieve high performance and speed of convergence when used in time-varying media. <br><br><img src="https://habrastorage.org/files/887/a71/483/887a71483c7748f6bb15ebb2c3d34e67.png"><br><br>  <i>Fig.</i>  <i>1. General block diagram of an adaptive filter for signal prediction</i> <br><br>  Another important parameter is the so-called observation window, that is, the time period of the analysis, which usually has a rectangular or exponential correspondence.  The parameter controlling the correspondence and duration of the observation window is called forgetting coefficients <code>Œª</code> (it is applied to the algorithm's memory), <code>0 &lt;&lt; Œª &lt; 1</code> and the object function looks like this: <br><br><img src="https://habrastorage.org/files/736/2e6/26f/7362e626f60a4264a20b41b0e4227071.png"><br><br>  This function is convex in the multidimensional space <code>w(k)</code> , that is, Œæ <sup>d</sup> (k) has only one global minimum and no local minimum.  Thus, we can reach this point by setting the gradient Œæ <sup>d</sup> (k) to zero, which will lead to the following formula: <br><br><img src="https://habrastorage.org/files/dfc/c9a/9a6/dfcc9a9a6ab9455f91b63407401ad5d0.png"><br><br><h4>  Using an adaptive filter in the stock price prediction framework </h4><br>  The purpose of this study is to understand how viable is the option of using adaptive filtering as a tool for predicting stock prices on real exchanges.  An adaptive LMS filter was successfully used to predict traffic in wireless networks [Liang (2002)].  In the current case, adaptive filtering was used to obtain an estimate of the possible value of the shares of Petrobras shares traded on the Brazilian Bovespa Stock Exchange in S√£o Paulo (ticker PETR3). <br><br>  In order to create a PETR3 price movement prediction module, an adaptive digital FIR filter with 100 real coefficients was used.  RLS with a forgetting factor of 0.98 was used as an adaptation algorithm.  A predictability window of 16 days was also used.  The simulation was performed on the MATLAB platform, trade information was used as input data from 01/03/2000 to 09/23/2009.  The values ‚Äã‚Äãof the daily stock prices correspond to the closing time of the auction.  Figure 2 shows the convergence of the coefficients of the adaptive filter used in the creation of the PETR3 price movement predictions. <br><br><img src="https://habrastorage.org/files/ba8/6d8/597/ba86d859722244f189cd63d143a25e59.png"><br><br>  <i>Fig.</i>  <i>2. Convergence of the coefficients of an adaptive filter launched to generate Petrobras stock price predictions (PETR3 on the Brazilian stock market).</i> <br><br>  The evolution of the filter coefficients clearly demonstrates the presence of convergence in a period that approximately coincides with the prediction time.  The abscissa shows the number of trading days involved in the simulation.  The real valuation of PETR3 stocks on the Brazilian stock market during this period is shown by the red line in Figure 3. There, the black prices for the filter are also indicated. <br><br><img src="https://habrastorage.org/files/061/a1f/4f1/061a1f4f13594f23b1f3126338a0027c.png"><br><br>  <i>Fig.</i>  <i>3. PETR3 share price in the Brazilian stock market during the analysis period for filtering.</i>  <i>Red shows the real market trend, black shows the estimate generated by the adaptive filter.</i> <br><br>  Obviously, there is a correspondence between the predicted prices and how things were actually in the market.  To confirm this fact, a specific trading day was simulated - specifically, 2,450 days from the beginning of the observations of 1/3/2000 year.  Figure 4 shows the zoom of the prediction made by the adaptive filter: <br><br><img src="https://habrastorage.org/files/9ed/081/66d/9ed08166de6c43ae806d611cf53ad4b2.png"><br><br>  <i>Fig.</i>  <i>4. Prediction of stock prices on a specific day</i> <br><br><h4>  Adaptive filter performance for predicting selected asset prices </h4><br>  Consider the strategy of investing in PETR3 stocks using predictions generated by the filter since 2473 (shown in Figure 5).  Filtering is performed using an RLS-algorithm with 100 coefficients and a forgetting coefficient Œª = 0.98.  The estimated trend of PETR3 stock price movements for the 16-day window is shown by a dotted line in Figure 5. <br><br><img src="https://habrastorage.org/files/9fc/ffa/115/9fcffa1155614beda8a781f6a2db8492.png"><br><br>  <i>Fig.</i>  <i>5. The behavior of the asset PETR3 in the period from 08/18/2009 to 09/22/2009.</i>  <i>Dotted line - prediction of the adaptive filter, red - the real price of shares on the market.</i> <br><br>  The prediction curve indicates the need to purchase an asset on the trading day of 09/02/2009 and the sale of shares at the time of 09/17/2009 - thus the sale should occur at the time of the rise preceding the price reduction.  The real price chart suggests that if such a strategy were implemented, the purchase of shares would pass at a price of 37.86, and the sale would be at 41.05, which would yield a profit of 8.43% of the volume of investments.  Although this example is only a special case, it illustrates the possible effectiveness of predictions based on adaptive filtering.  Further tests were conducted for other trading days, and the results were generally the same. <br><br><h4>  Creating an adaptive filter and prediction accuracy </h4><br>  Despite the positive test results, the proposed method leaves some questions.  One of them sounds like this - for which type of assets does it work better?  How many FIR coefficients should be used to improve the quality of the prediction module?  Does the result affect the value of the forgetting coefficient? <br><br>  To assess the quality of predictions made using adaptive filtering, a correlation is used - this is a measure of similarity for analyzing the quality of the match between the predicted signal and real quotes on the stock exchange within a given prediction window. <br><br>  The accuracy analysis is performed by studying the correlation values ‚Äã‚Äãas a function of the number of filter coefficients and the size of the prediction window.  Figure 5 shows a 3D graph of the correlation between 08/18/2009 and 09/22/2009: <br><br><img src="https://habrastorage.org/files/1f2/62c/e98/1f262ce9860a421ca706ae31244ed0d7.png"><br><br>  <i>Fig.</i>  <i>6. Correlation 3D-graph between the predicted signals and real stock quotes.</i> <br><br>  Chart 6 was converted to a three-dimensional contour chart presented in Figure 7. It shows better the zone of increased correlation between the generated predicted signal and the real stock prices in the market. <br><br><img src="https://habrastorage.org/files/42c/f80/189/42cf8018955a417ab493fdc37b66f8ad.png"><br><br>  To study the effect of the number of filter coefficients for adaptive predictions, a side space profile was created from Figure 6 (shown in Fig. 8), which shows correlation peaks visible to an observer located in the right side of the space.  Obviously, the region between the 30 and 100 coefficients represents a high correlation.  Accordingly, using 30 or fewer coefficients is not enough to get an accurate prediction. <br><br><img src="https://habrastorage.org/files/d58/ec7/0c3/d58ec70c398543d4aa01e0f1999939ec.png"><br><br>  <i>Fig.</i>  <i>8. Correlation profile, taking into account the number of coefficients.</i> <br><br>  The first section of high correlation is not particularly useful, since it can only be achieved with a very small prediction window.  The best option in this particular scenario is to choose the number of coefficients between 60 and 100. <br><br>  Then, in order to assess the influence of the prediction window on the quality of the predictions obtained, the front profile of the three-dimensional space from Figure 6 was created (Fig. 9).  It shows the behavior of the maximum correlation based on the size of the prediction window.  Obviously, the choice of a very short window leads to a high correlation (indeed, the prices of stocks of trading days following one another show a high correlation).  However, this gives us practically nothing in terms of creating investment strategies in the stock market. <br><br><img src="https://habrastorage.org/files/1b7/93d/ee7/1b793dee794b431aa0d6a9f7b652499d.png"><br><br>  <i>Fig.</i>  <i>9. Correlation profile taking into account the size of the prediction window (from 1 to 30 trading days of the Brazilian stock market).</i> <br><br>  An unexpected result - experiments showed that the choice of a prediction window measuring about 10 days is extremely inefficient.  In contrast, predictions on the window in about 15 business days show much better results.  Just as it was supposed, too long prediction windows lead to a decrease in correlation. <br><br>  Thus, the most optimal prediction window in this particular case is 15-20 days. <br><br>  Table 1 presents a summary of the number of coefficients used, the length of the prediction window, the date of purchase and sale of shares according to the proposed strategy of the filter, the price of transactions, as well as the total profit of transactions. <br><br><img src="https://habrastorage.org/files/451/37c/224/45137c22492b4c338fbfdb1ce96f4954.png"><br><br>  As can be seen, the use of an adaptive filter made it possible to achieve a profit, on average, in the amount of 7% of the volume of investments. </div><p>Source: <a href="https://habr.com/ru/post/274821/">https://habr.com/ru/post/274821/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274809/index.html">Quick work with JSON in Swift</a></li>
<li><a href="../274811/index.html">Java and time: part one</a></li>
<li><a href="../274813/index.html">Shaders in libgdx for dummies</a></li>
<li><a href="../274815/index.html">Servo browser engine architecture</a></li>
<li><a href="../274819/index.html">All you need to know about the growing popularity of Malvertising</a></li>
<li><a href="../274825/index.html">Algorithm Deflate for example PNG format</a></li>
<li><a href="../274827/index.html">Alternative memory allocators</a></li>
<li><a href="../274829/index.html">Take a step to the FPGA</a></li>
<li><a href="../274831/index.html">E-book as a display</a></li>
<li><a href="../274833/index.html">Create a hardware random number generator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>