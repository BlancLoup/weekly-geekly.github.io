<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Notification of unread incoming letter using Yoctupuce-Demo</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction: 
 I was inspired by 2 articles, this one and this one . I really liked the idea of ‚Äã‚Äãthe first article, but I thought that buying an Ard...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Notification of unread incoming letter using Yoctupuce-Demo</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/76a/23c/fb2/76a23cfb213b3427df6ea6597732994d.jpg" alt="image"><br><br><h4>  Introduction: </h4><br>  I was inspired by 2 articles, <a href="http://habrahabr.ru/post/137179/">this one</a> and <a href="http://habrahabr.ru/post/138502/">this one</a> .  I really liked the idea of ‚Äã‚Äãthe first article, but I thought that buying an Arduino for this idea would be too ‚Äúfat‚Äù.  Then, when I stumbled upon a second article, I realized that Yoctopuce-demo is just what I need!  And I decided to order it. <br><a name="habracut"></a><br><br><h4>  Package: </h4><br>  After 25 days, I received an envelope from Switzerland in the mail.  It contained the chip itself, packed in an antistatic bag with the name and date of production.  There was also a cable and a letter with instructions.  The chip was 2x2 cm in size, it had 2 LEDs, and one button.  Unfortunately, you can only interact with the 1m LED, but that's enough for us.  The device worked without drivers, but you had to download VirtualHub, which is available for all platforms on the manufacturer‚Äôs website.  It weighs only 170 kb.  A detailed review of the chips is <a href="http://habrahabr.ru/post/138502/">here</a> , so I will not describe it in detail. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/f9e/11e/517/f9e11e517fa753b346ebbe1e8e7c379a.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Selection of programming language: </h4><br>  On the manufacturer's website you can download libraries to the following languages: Javascript, PHP, C ++, C #, .NET, Delphi.  My choice immediately fell on Javascript.  And here's why: it is extremely clear and simple to develop, runs directly from the browser and does not require installation.  Moreover, it is cross-platform, which is important.  Included with the library is a folder with examples for all devices.  Here is <a href="http://pastebin.com/atweug6J">pastebin.com/atweug6J</a> sample code for Yoctopuce-Demo.  In this example, the program checks if the device is connected every 0.5 seconds.  There are 2 buttons (On / Off LED). <br><br><h4>  What's next: </h4><br>  Next, I had a problem: How to check for unread emails?  Javascript cannot connect via POP or IMAP itself and check their availability.  But there was a way out.  Gmail has a feed at: <a href="https://mail.google.com/mail/feed/atom/">mail.google.com/mail/feed/atom</a> .  At this address, we will be issued unread messages.  You only need to be logged in to Gmail in your browser.  We look at the source code and find the line X, where X is the number of unread messages.  This is what we need!  It remains only to count this number.  And this is done very simply: <br><br> <code>if (window.XMLHttpRequest) <br> {// code for IE7+, Firefox, Chrome, Opera, Safari <br> xmlhttp=new XMLHttpRequest(); <br> } <br> else <br> {// code for IE6, IE5 <br> xmlhttp=new ActiveXObject("Microsoft.XMLHTTP"); <br> } <br> xmlhttp.open("GET","https://mail.google.com/mail/feed/atom",false); <br> xmlhttp.send(); <br> xmlDoc=xmlhttp.responseXML; <br> <br> fullcount= <br> xmlDoc.getElementsByTagName("fullcount")[0].childNodes[0].nodeValue;</code> <br> <br>  It remains only to slightly change the source code of the example that came with the libraries and the trick is done.  Let's use the ready-made refresh function, adding to it the load of the fullcount variable.  Next, compare fullcount with 0, and depending on this, turn on or off the light bulb.  You can also increase the time between updates.  To do this, simply change the value of setTimeout from 500 to 5000. That's it.  Checking works! <br><img src="https://habrastorage.org/getpro/geektimes/post_images/283/d0f/a3d/283d0fa3d32bb42ed4b9f382fb41fbca.jpg" alt="image"><br><br>  <b>Update:</b> With <br> <code>module = yFindModule(serial); <br> module.set_beacon(true);</code> <br>  You can turn on / off the flashing blue LED. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/22f/c98/b33/22fc98b33f85d820c6251691d8c7dc64.jpg" alt="image"><br><br><h4>  Why is this convenient? </h4><br>  You will ask this question.  I already have an email client that immediately after receiving the message will inform me, why should I make an external device?  Everything is very simple.  For example, you are watching a movie, or playing a game and you receive a letter (Any application with fullscreen). You will not notice your email client alerts, but you will always notice a green light bulb. <br><br><h4>  Conclusion: </h4><br>  It turned out a small handy script.  About the pros, I have already said.  I found only one minus - you need to be logged in to gmail in the browser.  The script is not perfect, a lot of things can be improved and added.  If you have any ideas - write in the comments.  I will be glad to feedback. <br><br><h4>  References: </h4><br>  Full script code: <a href="http://pastebin.com/VwVFeghW">pastebin.com/VwVFeghW</a> - corrected link <br>  Manufacturer website: <a href="http://www.yoctopuce.com/">www.yoctopuce.com</a> </div><p>Source: <a href="https://habr.com/ru/post/140345/">https://habr.com/ru/post/140345/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140336/index.html">Android evolution: from G1 to Galaxy Nexus</a></li>
<li><a href="../140337/index.html">Setting up a Cherokee web service under Ubuntu 11.04 to work with WordPress</a></li>
<li><a href="../140338/index.html">cache-js. caching function</a></li>
<li><a href="../140340/index.html">Overview of the router NETGEAR WNDR3800</a></li>
<li><a href="../140344/index.html">What is travis-ci.org and what is it eaten with?</a></li>
<li><a href="../140346/index.html">Blog-based social network XenForo</a></li>
<li><a href="../140347/index.html">Installing Mercurial Server and Using SSH Authorization</a></li>
<li><a href="../140348/index.html">Car super-watch</a></li>
<li><a href="../140349/index.html">Broker Factor Revealed</a></li>
<li><a href="../140350/index.html">Development: proper timing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>