<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>My first overlay program</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In times of widespread domination of tablets and smartphones, it is hard to believe that, quite recently, one could get a lot of pleasure by playing w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>My first overlay program</h1><div class="post__text post__text-html js-mediator-article">  In times of widespread domination of tablets and smartphones, it is hard to believe that, quite recently, one could get a lot of pleasure by playing with a calculator.  Of course, I mean not a normal (or even engineering) calculator, but a <a href="http://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25B0_%25D0%25913-34">programmable one</a> .  I want to talk about a device that literally turned my life around and actually pushed me to become a programmer. <br><a name="habracut"></a><br>  In the late 70s of the last century, with the computer technology in the USSR was tight.  My father worked as a programmer.  In my memory will remain forever and trips to his work in the Central Department Store, where I played in <a href="http://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B8%25D0%25BC_%2528%25D0%25B8%25D0%25B3%25D1%2580%25D0%25B0%2529">him</a> with the computer <a href="http://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B8%25D0%25BD%25D1%2581%25D0%25BA_%2528%25D0%25BA%25D0%25BE%25D0%25BC%25D0%25BF%25D1%258C%25D1%258E%25D1%2582%25D0%25B5%25D1%2580%2529">Minsk</a> and the long stuffing programs with brass rings on the tablets for Sparks, used at that time by Sberbank.  To have, in my personal possession, something capable of carrying out programs, I, of course, could not even dream of. <br><br>  Everything changed with the advent of programmable calculators (PMK).  Now I could dream.  This is exactly what I did, reading articles in the <a href="http://technicamolodezhi.ru/">Technique of Youth</a> , since it was not possible to acquire this programmable miracle in Kazan.  But, one day, my parents and I went to Moscow. <br><br>  Having made considerable efforts, I convinced my parents to buy the <a href="http://ru.wikipedia.org/wiki/%25D0%259C%25D0%259A-61">MK-61 which was</a> not cheap at that time, and, on surrender, the filing of old <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B2%25D0%25B0%25D0%25BD%25D1%2582_%2528%25D0%25B6%25D1%2583%25D1%2580%25D0%25BD%25D0%25B0%25D0%25BB%2529">Quant</a> magazines, after which, having barricaded themselves in the apartment of our relatives, I stopped reacting to external irritants, right up to the time of departure. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I re-read everything that was printed at that time on programmable calculators, started a common notebook and diligently rewrote the programs I liked the most.  Gradually, I approached the fact that I was able to make corrections and improvements in them (the experience gained in the vigils on programming Sparks was not in vain).  After a while, I was able to write programs on my own. <br><br>  When I was already fairly well accustomed to the MK-61, one of my friends had purchased an improved version - <a href="http://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25B0_%25D0%259C%25D0%259A-52">MK-52</a> .  According to the command system, it practically did not differ from the MK-61, but had the opportunity to save programs in the EPROM and was supplied with several cartridges with ready-made programs.  Of course, I immediately wanted to write something specifically for her. <br><br><div class="spoiler">  <b class="spoiler_title">Lyrical digression</b> <div class="spoiler_text">  I must say that the issue of storing programs for the PMK, at that time, was of great interest.  Each time typing a rather large program anew was really uncomfortable.  In addition, the introduced program was required to be carefully re-checked for various kinds of errors. <br><br>  Enthusiasts have proposed many circuit solutions to this problem.  Once I even saw an article describing a device for storing calculator programs on magnetic tapes.  The release of the MK-52 put an end to this not simple question. <br></div></div><br>  The choice fell on "Battleship".  I wanted to do it for a long time, but I couldn‚Äôt have crammed into all the required functionality in the short space of the calculator.  The ability to load programs from the EPROM allowed the program to be divided into two parts.  The first block - arranged the ships, the second (the actual game) provided a dialogue with the user.  Part of the subroutines was used by both blocks. <br><br><div class="spoiler">  <b class="spoiler_title">Here is how this miracle looked (the picture is not for the faint of heart)</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/f02/d72/f21/f02d72f21790bd93c1681ac3f909fc00.jpg" alt="image"></div></div><br>  Since in this form, this cave painting is practically impossible to decipher, I will give this code in a more readable form: <br><br><div class="spoiler">  <b class="spoiler_title">Ship placement unit</b> <div class="spoiler_text"><pre><code class="bash hljs">00|46 01.07 02.12 03.08 04.11 05.34 06.15 07.45 08|53 09:75 10.06 11.53 12:67 13.5E 14:08 15.62 16.53 17:37 18.6E 19.01 20.11 21.4E 22|53 23:34 24.6E 25.02 26.10 27.4E 28.53 29:34 30.5D 31:08 32.63 33.50 34|62 35.02 36.10 37|65 38.12 39.01 40.10 41.DE 42.38 43.BE 44.52 45.11 46.4E 47.53 48:58 49.6E 50.02 51.10 52.4E 53.53 54:58 55.5D 56:22 57.27 58|61 59|65 60.12 61.01 62.10 63.DE 64.38 65.BE 66.52 67|65 68.12 69.01 70.10 71.DE 72.37 73.35 74.52 75|66 76.01 77.01 78.12 79.20 80.10 81.35 82.46 83.07 84.12 85.07 86.10 87.4E 88.65 89.04 90.15 91.12 92.45 93.01 94.11 95.59 96:A2 97.65 98.07 99.15 A0.13 A1.45 A2|52</code> </pre> </div></div><div class="spoiler">  <b class="spoiler_title">Loadable game block</b> <div class="spoiler_text"><pre> <code class="bash hljs">00.40 01.50 02.57 03:41 04.0B 05.15 06.45 07.14 08.06 09.10 10.4E 11.02 12.53 13:67 14.57 15:22 16.0F 17.DE 18.39 19.BE 20.64 21.52 22|53 23:75 24.01 25.53 26:67 27.5E 28.22 29.15 30.53 31:59 32.6E 33.06 34.11 35.62 36.12 37.65 38.17 39.11 40.52 41|53 42:58 43.6E 44.01 45.11 46.4E 47.53 48:58</code> </pre></div></div><br>  Here I use command codes, since their designations proposed by the manufacturer of the PMC are not very convenient for printing ‚Äúlistings‚Äù.  The correspondence of the codes to the commands can be seen on the table (kindly drawn by me in the same years): <br><br><div class="spoiler">  <b class="spoiler_title">Command codes MK-52</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/843/5de/81d/8435de81d1dadf617e7b54c0264cfd02.jpg" alt="image"></div></div><div class="spoiler">  <b class="spoiler_title">A brief tour of the command system</b> <div class="spoiler_text">  With some practice, command codes were easily remembered (which was necessary, since the entered programs needed to be checked).  The most frequently used were: <br><br><ol><li>  Arithmetic instructions (10‚Äì13) that perform the corresponding action with two lower registers of the operational stack (X, Y) and placing the result in X </li><li>  Commands for writing and reading from memory registers (40-4E and 60-6E respectively) </li><li>  Commands that control the execution of the program (50-5E), among which should be noted the stop command (50), as well as the commands for calling the subroutine (53) and returning from it (52) </li><li>  The indirect addressing commands (B0-BE, D0-DE) were very useful, allowing you to access the memory register whose number was written to another register </li></ol><br>  Although hexadecimal digits were used in the command codes, their display on the screen caused footage from the Predator movie: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/322/0b8/759/3220b8759d3bbfb2f06c79a538dcef90.png" alt="image"></div></div><br>  For convenience, I selected in the code the addresses of transition teams (a colon after the team address), as well as entry points (a vertical bar).  This allows you to more clearly see the relationship of the subroutines (the subroutine call command is particularly interesting, located at address 22 and providing a kind of ‚Äúpolymorphism.‚Äù When accessing this subroutine, control was transferred to different places, depending on which block was loaded). <br><br>  It can be noted that the transitions to the middle (and not to the beginning) of the subroutines were not something extraordinary.  Due to the extremely limited size of addressable memory, literally everything had to be saved.  The transitions to the address of another transition (interpreted in this case as a command code) were considered as special chic. <br><br>  Since there is no longer a working calculator at hand, I used an <a href="http://www.emulator3000.org/c3.htm">emulator</a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/41b/64c/8a0/41b64c8a09ac29a8e241462e13f3f5a4.png" alt="image"><br><br>  All prepared images were uploaded to <a href="https://github.com/GlukKazan/MK52">GitHub</a> . <br><br>  The first <a href="">image</a> can be used for the placement of "ships": <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8dd/456/469/8dd45646921c83b017ae9bcb4d79ae5a.png" alt="image"><br><br>  The initial value for the pseudo-random number generator (0.1234567) can be changed.  After launching the program (i / o s / n), the program works for quite a long time, ultimately deriving the address for loading the game module from the EPROM (the ability to automatically access the EPROM from the program was absent): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/749/96f/3fe/74996f3fe956628b551feb2e86d0d185.png" alt="image"><br><br>  Since the emulator (at least the version I used) completely ignored my attempts to access the EPROM, I prepared an <a href="">image</a> with a game module hammered in by my hands and a ship layout already completed. <br><br>  The arrangement itself is stored in memory registers from the 7th to the D. Here is an example of the second line (the 8th register): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/016/824/cbb/016824cbb8156083b7c465b70e10c5eb.png" alt="image"><br><br>  The twos encode the position of the "ships".  Based on the above initial value, the following arrangement was generated: <br><br><pre> <code class="bash hljs">0 0 0 0 1 0 1 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0</code> </pre><br>  You can see that the program has placed nine non-contiguous "single-deck ships" on a field of 7x7 cells. <br><br>  To start the game, you must enter the number of ships (9 w / o s / n) and then enter the coordinates of the "shots" (for example, 2 V ^ 2 s / n).  Since we spotted the location of the ‚Äúships‚Äù, we had no difficulty in sinking the ‚Äúsingle-point‚Äù: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ecf/955/da3/ecf955da3fb599fd8c4764def820223c.png" alt="image"><br><br>  However, the second time it will not be possible to get on it: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b95/a9f/b6e/b95a9fb6e43893f6aa8b036282396f10.png" alt="image"><br><br>  Let's try (2  ^ 2  / ).  As expected, the calculator strikes back: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f1b/fc6/75f/f1bfc675f18328f87c6bce797a5a5b26.png" alt="image"><br><br>  The first digit here is the vertical coordinate (starting from the bottom up), the second is horizontal (from left to right). <br><br>  A little later, I noticed that by changing just a couple of commands (in the very first photo with the text of the program, they are marked in red), it is possible to ensure that the ships being placed can touch, not the corners, but the sides (images <a href="">0003</a> and <a href="">0004</a> ).  The result was the following arrangement of "multi-fenders": <br><br><pre> <code class="bash hljs">0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 1 0 1 0 0 1 0 0 0 1 0 0 0</code> </pre><br>  God knows that, but not bad, considering that only two teams had to be changed. <br><br>  Separately, it should be said about bugs (even more likely about bugs), although this is a topic for a separate article, if not their cycle.  The fact is that the calculators of the series being described were literally crammed with various examples of errors and undocumented behavior.  Among the amateurs, this led to the development of a culture of exploring these undocumented possibilities, known under the generic name <a href="http://ru.wikipedia.org/wiki/%25D0%2595%25D0%25B3%25D0%25B3%25D0%25BE%25D0%25B3%25D0%25BE%25D0%25BB%25D0%25BE%25D0%25B3%25D0%25B8%25D1%258F">EGOGG</a> . <br><br>  Some examples of such bugs are funny, others are dangerous, and some of them are surprisingly useful.  A good example of such potentially useful behavior is the execution of the ‚Äúenter order‚Äù (VP) command after writing to the memory register.  In the program execution mode, it led to the "cutting off" of the first digit of the number in the X register (displayed on the indicator), and with step-by-step execution (yes yes, it was like that), the team worked out quite well.  To achieve any other reasonable way of such a result was impossible. <br><br>  Frightened by the non-standard behavior of the VP team, I corrected the program by changing the sequence of commands 35.VP 36.1, to 35.IP2 36.x (in the 2nd register I had to store the constant 10).  Since there is no live calculator, I can no longer verify whether the command to the VI resulted in an error in this context.  Under the emulator, both options work quite normally. <br><br>  Unfortunately, I do not know the implementation of an emulator that reproduces all examples of undocumented behavior. <br><br>  After all this, there were Microsha, BK-shki and Spectrum.  There was <a href="http://ru.wikipedia.org/wiki/%25D0%2595%25D0%25A1_%25D0%25AD%25D0%2592%25D0%259C">EU-1046</a> , which I encountered at the institute.  There were PDP-shki and VAX-s.  Before the advent of the IBM PC, the wait was not long. <br></div><p>Source: <a href="https://habr.com/ru/post/197344/">https://habr.com/ru/post/197344/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197330/index.html">Habra Glass - how to make geosocial service</a></li>
<li><a href="../197332/index.html">Public properties, getters and setters or magic methods?</a></li>
<li><a href="../197334/index.html">The digest of news from the world of mobile development for the last week ‚Ññ28 (October 7‚Äî13, 2013)</a></li>
<li><a href="../197336/index.html">10 golden rules of twitter</a></li>
<li><a href="../197340/index.html">Idea Presentation: Mobile Office</a></li>
<li><a href="../197346/index.html">Project ‚ÄúBacup of the Planet‚Äù</a></li>
<li><a href="../197348/index.html">The first program for OS X do-it-yourself - the clipboard manager</a></li>
<li><a href="../197350/index.html">The Large Hadron Collider with my own eyes. Part 4</a></li>
<li><a href="../197358/index.html">Node.js and new frontend on the web</a></li>
<li><a href="../197360/index.html">KolibriOS: Interview with Sergey Kuzmin (Wildwest)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>