<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Android text display</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Displaying textual information is probably the most basic and important part of many Android applications. This article will talk about TextView. Ever...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Android text display</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/mc/2_/_o/mc2__o7rq1m6ex9alol6ivz5vey.png"></div><br><p>  Displaying textual information is probably the most basic and important part of many Android applications.  This article will talk about TextView.  Every developer, starting with ‚ÄúHello World,‚Äù is constantly confronted with this user interface element.  From time to time, when working with text, you have to think about implementing various design solutions or improving performance when rendering a screen. </p><br><p>  I will talk about the TextView device and some subtleties of working with it.  Key tips were taken from reports of past Google I / O. </p><a name="habracut"></a><br><h1 id="textview-pod-kapotom">  TextView under the hood </h1><br><p>  For rendering text in Android, a whole stack of various libraries is used under the hood.  They can be divided into two main parts - java code and native code: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hb/p0/gg/hbp0ggycnpeisn8v8hwyqkkmvfq.png" width="800"></div><br><p>  Java code is essentially part of the Android SDK available to application developers, and new features from it can be ported to the support library. </p><br><p>  The TextView core itself is written in C ++, which limits the porting to the support library of new features implemented there from new versions of the operating system.  The core is the following libraries: </p><br><ul><li>  Minikin is used to measure the length of text, line breaks and words by syllables. </li><li>  ICU provides Unicode support. </li><li>  HarfBuzz finds for Unicode characters the corresponding graphic elements (glyphs) in fonts. </li><li>  FreeType makes bitmaps of glyphs. </li><li>  Skia is an engine for drawing 2D graphics. </li></ul><br><h2 id="izmerenie-dliny-teksta-i-perenos-strok">  Measuring text length and line breaks </h2><br><p>  If you pass the string to the Minikin library, which is used inside the TextView, then the first thing it determines is which glyphs the string consists of: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qt/1o/uk/qt1ouktu4gn9x0wncbgiy2a7qkg.png" width="800"></div><br><p> As you can see from this example, matching Unicode characters with glyphs will not always be one to one: here 3 characters at once will correspond to one glyph ffi.  In addition, it is worth paying attention that the necessary glyphs can be found in various system fonts. </p><br><p>  Finding glyphs only in system fonts can lead to difficulties, especially if icons or emojis are displayed through the characters, and it is supposed to combine characters from different fonts in one line.  Therefore, starting with <strong>Android Q (29)</strong> , it became possible to create your own list of fonts that come with the application.  This list will be used to search for glyphs: </p><br><pre> <code class="kotlin hljs">textView.typeface = TypeFace.CustomFallbackBuilder( FontFamily.Builder( Font.Builder(assets, ‚Äúlato.ttf‚Äù).build() ).build() ).addCustomFallback( FontFamily.Builder( Font.Builder(assets, ‚Äúkosugi.ttf‚Äù).build() ).build() ).build()</code> </pre> <br><p>  Now, using <code>CustomFallbackBuilder</code> when matching characters with glyphs, the SDK will sort through the specified font family in order, and if it cannot be found, the search will continue in system fonts (and through the <code>setSystemFallback()</code> method you can specify the preferred system font family).  <code>CustomFallbackBuilder</code> has a limit on the number of font family - you can add no more than 64 fonts. </p><br><p>  The Minikin library splits strings into words and measures individual words.  To speed up work, starting with <strong>Lollipop (21)</strong> , a system <abbr title="least recently used">LRU</abbr> cache of words is used.  Such a cache gives a huge performance gain: a call to <code>Paint.measureText()</code> for a cached word will take an average of 3% of the time it first calculates its size. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/d2/f1/om/d2f1omfjlqmmfqalip3whmes-1o.png" width="800"></div><br><p>  If the text does not fit the specified width, Minikin arranges line breaks and words in the text.  Starting with <strong>Marshmallow (23),</strong> you can control its behavior by specifying the <code>breakStrategy</code> and <code>hyphenationFrequency</code> special attributes for TextView. </p><br><p>  With the value <code>breakStrategy=simple</code> library will simply arrange hyphens sequentially, passing through the text: as soon as the line ceases to fit, the hyphenation is put before the last word. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/im/lc/cr/imlccruuhjr59qzrtpwjmrf6hhk.png" width="600"></div><br><p>  In the value <code>balanced</code> library will try to make line breaks so that the lines are aligned in width. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/v5/ys/kc/v5yskcuiwypdyponmrdqep7zaq8.png" width="600"></div><br><p>  <code>high_quality</code> has almost the same behavior as <code>balanced</code> , with the exception of some differences (one of them: on the penultimate line, hyphenation can be not only separate words, but also words by syllables). </p><br><p>  The <code>hyphenationFrequency</code> attribute allows <code>hyphenationFrequency</code> to control the strategy for word wrapping by syllables.  A value of <code>none</code> will not do automatic hyphenation, <code>normal</code> will make a small frequency of hyphenation, and <code>full</code> , accordingly, will use the maximum number of words. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ng/cr/hs/ngcrhsphklaxxe842klpnx8mhnw.png" width="600"></div><br><p>  Text rendering performance depending on the selected flags (measured on <strong>Android P (28)</strong> ): </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tx/5r/33/tx5r339s93s1nq6go8hieqhv6fq.png" width="600"></div><br><p>  Given a fairly strong performance hit, Google developers, starting with version <strong>Q (29)</strong> and <strong>AppCompat 1.1.0</strong> , decided to turn off hyphenation by default.  If word wrapping is important in the application, now you need to enable it explicitly. </p><br><p>  When using word wrap, one must take into account that the current selected language in the operating system will affect the operation of the library.  Depending on the language, the system will select special dictionaries with transfer rules. </p><br><h1 id="stili-teksta">  Text styles </h1><br><p>  There are several ways to style text in Android: </p><br><ul><li>  <strong>A single style</strong> that applies to the entire TextView element. </li><li>  <strong>Multi-style (multi style)</strong> - several styles at once, which can be applied to the text, at the level of paragraph or individual characters.  There are several ways to do this: <br><ul><li>  drawing text on canvas </li><li>  html tags </li><li>  special markup elements - spans </li></ul></li></ul><br><p>  A single style implies the use of XML styles or XML attributes in TextView markup.  In this case, the system will apply the values ‚Äã‚Äãfrom the resources in the following order: TextAppearance, theme (Theme), default style (Default style), style from the application, and the highest priority is the values ‚Äã‚Äãof the View attributes. </p><br><p>  Using resources is a fairly simple solution, but, unfortunately, it does not allow you to apply style to parts of the text. </p><br><p>  Html tags are another simple solution that provides features such as making individual words bold, italic, or even highlighting lists with dots in the text.  All that a developer needs is to make a call to the <code>Html.fromHtml()</code> method, which will turn the tagged text into text marked up by spans.  But this solution has limited capabilities, as it recognizes only part of the html tags and does not support CSS styles. </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> text = <span class="hljs-string"><span class="hljs-string">"My text &lt;ul&gt;&lt;li&gt;bullet one&lt;/li&gt;&lt;li&gt;bullet two&lt;/li&gt;&lt;/ul&gt;"</span></span> myTextView.text = Html.fromHtml(text)</code> </pre> <br><p>  Various methods of styling TextView can be combined, but it is worth remembering the priority of a particular method, which will affect the final result: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zm/hr/hl/zmhrhluqvvcv77s1b85gkxbtcww.png" width="400"></div><br><p>  Another way - drawing text on the canvas - gives the developer complete control over the text output: for example, you can draw text along a curved line.  But such a solution, depending on the requirements, can be quite difficult to implement and is beyond the scope of this article. </p><br><h1 id="spans">  Spans </h1><br><p>  TextView uses spans to fine-tune the styles.  Using spans you can change the color of a range of characters, make part of the text as links, change the size of the text, draw a dot in front of a paragraph, etc. </p><br><p>  The following categories of spans can be distinguished: </p><br><ul><li>  <strong>Character spans</strong> - applied at the character level of the string. <br><ul><li>  <strong>Appearance affecting</strong> - do not change the text size. </li><li>  <strong>Metric affecting</strong> - resize text. </li></ul></li><li>  <strong>Paragraph spans</strong> - applied at the paragraph level. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zy/os/x2/zyosx2ovroe15y3bd94qridaaou.png"></div><br><p>  The Android framework has interfaces and abstract classes with methods that are called during <code>onMeasure()</code> and TextView rendering, these methods give spans access to lower-level objects like <code>TextPaint</code> and <code>Canvas</code> .  Using the span, the Android framework checks which interfaces this object implements to invoke the necessary methods. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fv/do/er/fvdoerpx8zxykjxvt9ru4kigica.png" width="600"></div><br><p>  The android framework defines about 20+ spans, so before you make your own, it is better to check if the SDK is suitable. </p><br><h3 id="appearance-vs-metric-affecting-spans">  Appearance vs metric affecting spans </h3><br><p>  The first category of spans affects how the characters in the string will look: character color, background color, underlined or strikethrough characters, etc.  These spans implement the <code>UpdateAppearance</code> interface and inherit from the <code>CharacterStyle</code> class, which provides access to the <code>TextPaint</code> object. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/or/8f/zl/or8fzltp5mvoyhvdey8tz1uoqhg.png"></div><br><p>  Metric affecting span affects the size of the text and layout, therefore, the use of such a span requires not only redrawing the TextView, but also the call <code>onMeasure()</code> / <code>onLayout()</code> .  These spans are usually inherited from the <code>MetricAffectingSpan</code> class, which inherits from the <code>CharacterStyle</code> mentioned above. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_h/hs/hd/_hhshd0pcadvdievngojmtsqzlu.png"></div><br><h2 id="character-vs-paragraph-affecting-spans">  Character vs paragraph affecting spans </h2><br><p>  Paragraph span affects the whole block of text: it can change the alignment, indentation or even insert a point at the beginning of the paragraph.  Such spans should be inherited from the <code>ParagraphStyle</code> class and inserted into the text exactly from the beginning of the paragraph to its end.  If the range is incorrect, then the span will not work. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/76/_n/uj/76_nujhr8rrwz-mne8bgq8p2pfu.png"></div><br><p>  On Android, paragraphs are considered to be the part of the text separated by newlines ( <code>\n</code> ). </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/s1/p1/kq/s1p1kq9esdaakdpwh_rkxdvdygw.png"></div><br><h2 id="napisanie-svoih-spanov">  Writing Your Spans </h2><br><p>  When writing your own spans, you need to decide what the span will affect in order to choose which class to inherit from: </p><br><ul><li>  Affects text at character level ‚Üí <code>CharacterStyle</code> </li><li>  Affects text at paragraph level -&gt; <code>ParagraphStyle</code> </li><li>  Affects text view ‚Üí <code>UpdateAppearance</code> </li><li>  Affects text size - <code>UpdateLayout</code> </li></ul><br><p>  Here is an example of a span for changing the font: </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomTypefaceSpan</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> font: Typeface?) : MetricAffectingSpan() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateMeasureState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(textPaint: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">TextPaint</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = update(textPaint) <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateDrawState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(textPaint: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">TextPaint</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = update(textPaint) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(textPaint: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">TextPaint</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { textPaint.apply { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> old = typeface <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> oldStyle = old?.style ?: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> font = Typeface.create(font, oldStyle) typeface = font <span class="hljs-comment"><span class="hljs-comment">//    } } }</span></span></code> </pre> <br><p>  Imagine that we want to create our own span for highlighting blocks of code, for this we will edit our previous span - we will add, after installing the font, also changing the background color of the text: </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CodeBlockSpan</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> font: Typeface?) : MetricAffectingSpan() { ‚Ä¶ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(textPaint: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">TextPaint</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { textPaint.apply { <span class="hljs-comment"><span class="hljs-comment">//    ‚Ä¶ bgColor = lightGray //    } } }</span></span></code> </pre> <br><p>  Apply span to the text: </p><br><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">//    span spannable.setSpan(CodeBlockSpan(typeface), ...)</span></span></code> </pre> <br><p>  But you can get exactly the same result by combining two spans: take our previous <code>CustomTypefaceSpan</code> and <code>BackgroundColorSpan</code> from the Android framework: </p><br><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">//    spannable.setSpan(BackgroundColorSpan(lightGray), ...) //   spannable.setSpan(CustomTypefaceSpan(typeface), ...)</span></span></code> </pre> <br><p>  These two solutions will have a difference.  The fact is that self-written spans cannot implement the <code>Parcelable</code> interface, unlike system ones. </p><br><p>  When transmitting a stylized line through Intent or the clipboard in case of a span of self-written markup will not be saved.  When using spans from the framework, the markup will remain. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/is/nw/uu/isnwuux9cosllp6h0kgawifcepo.png" width="600"></div><br><h2 id="ispolzovanie-spanov-v-tekste">  Using spans in text </h2><br><p>  There are two interfaces for stylized text in the framework: <code>Spanned</code> and <code>Spannable</code> (with unchanged and mutable markup, respectively) and three implementations: <code>SpannedString</code> (unchanged text), <code>SpannableString</code> (unchanged text) and <code>SpannableStringBuilder</code> (mutable text). </p><br><div class="scrollable-table"><table><thead><tr><th></th><th>  Mutable text </th><th>  Variable markup </th></tr></thead><tbody><tr><td>  <strong>Spanned</strong> string </td><td>  not </td><td>  not </td></tr><tr><td>  <strong>Spannable</strong> string </td><td>  not </td><td>  Yes </td></tr><tr><td>  <strong>Spannablestring</strong> builder </td><td>  Yes </td><td>  Yes </td></tr></tbody></table></div><br><p>  <code>SpannableStringBuilder</code> , for example, is used inside an <code>EditText</code> that needs to change text. </p><br><p>  You can add a new span to a line using the method: </p><br><p> <code>setSpan(Object what, int start, int end, int flags)</code> </p> <br><p>  The span is passed through the first parameter, then the range of indices in the text is indicated.  And the last parameter can be controlled, what will be the behavior of the span when inserting new text: whether the span will spread to the text inserted at the start or end point (if you insert new text in the middle, the span will automatically apply to it, regardless of the flag values) . </p><br><p>  The classes listed above differ not only semantically, but also in how they are arranged internally: <code>SpannedString</code> and <code>SpannableString</code> use arrays to store spans, and <code>SpannableStringBuilder</code> uses an <a href="https://en.wikipedia.org/wiki/Interval_tree">interval tree</a> . </p><br><p>  If you conduct tests for the speed of rendering text depending on the number of spans, you will get the following results: when using up to ~ 250 spans in a row, <code>SpannableString</code> and <code>SpannableStringBuilder</code> work at about the same speed, but if the markup elements become more than 250, then <code>SpannableString</code> starts lose.  Thus, if the task is to apply a style to some text, then when choosing a class, one should be guided by semantic requirements: whether the line and styles will be mutable.  But if markup requires more than 250 spans, then you should always give <code>SpannableStringBuilder</code> to <code>SpannableStringBuilder</code> . </p><br><h2 id="proverka-na-nalichie-spana-v-tekste">  Check for span in the text </h2><br><p>  The task periodically arises to check whether there is a certain span in the spanned line.  And on Stackoverflow you can find this code: </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T&gt;</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasSpan</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(spanned: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Spanned</span></span></span></span><span class="hljs-function"><span class="hljs-params">, clazz: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Class</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">T</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> spans: Array&lt;<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> T&gt; = spanned.getSpans(<span class="hljs-number"><span class="hljs-number">0</span></span>, spanned.length, clazz) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> spans.isNotEmpty() }</code> </pre> <br><p>  Such a solution will work, but it is inefficient: you have to go through all the spans, check whether each of them belongs to the passed type, collect the result into an array, and in the end just check that the array is not empty. </p><br><p>  A more efficient solution would be to use the <code>nextSpanTransition()</code> method: </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T&gt;</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasSpan</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(spanned: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Spanned</span></span></span></span><span class="hljs-function"><span class="hljs-params">, clazz: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Class</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">T</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> limit = spanned.length <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> spanned.nextSpanTransition(<span class="hljs-number"><span class="hljs-number">0</span></span>, limit, clazz) &lt; limit }</code> </pre> <br><h2 id="razmetka-teksta-v-razlichnyh-yazykovyh-resursah">  Text markup in various language resources </h2><br><p>  Such a problem may arise when you want to highlight a specific word using markup in various string resources.  For example, we need to highlight the word <em>‚Äútext‚Äù</em> in the English version and <em>‚Äútexto‚Äù</em> in the Spanish: </p><br><pre> <code class="xml hljs"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- values-en/strings.xml --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag">&gt;</span></span>Best practices for text in Android<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- values-es/strings.xml --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtitle‚Äù</span></span></span><span class="hljs-tag">&gt;</span></span>Texto en Android: mejores pr√°cticas<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  If you need something simple, for example, to highlight the word in bold, then you can use the usual html tags ( <code>&lt;b&gt;</code> ).  In the UI, you just need to set the string resource in the TextView: </p><br><pre> <code class="kotlin hljs">textView.setText(R.string.title)</code> </pre> <br><p>  But if you need something more complex, for example, changing the font, then html can no longer be used.  The solution is to use the special <code>&lt;annotation&gt;</code> .  This tag allows you to define any key-value pair in an xml file.  When we pull a string from resources, these tags are automatically converted to <code>Annotation</code> spans, arranged in the text with the corresponding keys and values.  After that, you can parse the list of annotations in the text and apply the necessary spans. </p><br><p>  Suppose we need to change the font using <code>CustomTypefaceSpan</code> . </p><br><p>  Add a tag and define a <em>‚Äúfont‚Äù</em> key and a value for it ‚Äî the type of font that we want to use is <em>‚Äútitle_emphasis‚Äù</em> : <br></p><pre> <code class="xml hljs"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- values-en/strings.xml --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag">&gt;</span></span>Best practices for <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">annotation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">font</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtitle_emphasis‚Äù</span></span></span><span class="hljs-tag">&gt;</span></span>text<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">annotation</span></span></span><span class="hljs-tag">&gt;</span></span> in Android<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- values-es/strings.xml --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtitle‚Äù</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">annotation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">font</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtitle_emphasis‚Äù</span></span></span><span class="hljs-tag">&gt;</span></span>Texto<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">annotation</span></span></span><span class="hljs-tag">&gt;</span></span> en Android: mejores pr√°cticas<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Pull the string from the resources, find the annotations with the <em>‚Äúfont‚Äù</em> key and arrange the spans: </p><br><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">//      SpannedString,     span' val titleText = getText(R.string.title) as SpannedString //    val annotations = titleText.getSpans(0, titleText.length, Annotation::class.java) //     SpannableString //      val spannableString = SpannableString(titleText) //     for (annotation in annotations) { //     "font" if (annotation.key == "font") { val fontName = annotation.value //   ,     if (fontName == "title_emphasis") { val typeface = getFontCompat(R.font.permanent_marker) //  span    ,    spannableString.setSpan( CustomTypefaceSpan(typeface), titleText.getSpanStart(annotation), titleText.getSpanEnd(annotation), Spannable.SPAN_EXCLUSIVE_EXCLUSIVE ) } } } styledText.text = spannableString</span></span></code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yq/62/mm/yq62mmgvajffkxkzk3qntsnxhw4.png" width="600"></div><br><p>  It was mentioned above that spans from outside the Android framework cannot implement <code>Parcelable</code> and are transmitted via Intent.  But this does not apply to annotations that implement <code>Parcelable</code> .  So you can pass the annotated string through Intent and parse in exactly the same way by arranging your spans. </p><br><h1 id="kak-tekst-raspolagaetsya-v-textview">  How text is placed in a TextView </h1><br><p>  TextView can display not only text, but also pictures.  You can also set various indents in front of the text.  Under the hood, this works so that TextView creates a child class, Layout, which is responsible directly for displaying text.  This is an abstract class that has three implementations; usually you don‚Äôt have to work directly with them unless you write your own control: </p><br><ul><li>  <strong>BoringLayout is</strong> used for simple texts, does not support line <strong>breaks</strong> , RTL and other things, but it is the most lightweight.  TextView uses it if the text meets all restrictions. </li><li>  <strong>StaticLayout is</strong> used in TextView for other cases. </li><li>  <strong>DynamicLayout is</strong> used for mutable text in an EditText. </li></ul><br><p>  Layout has many methods that let you know the various parameters of the displayed text: the coordinates of the lines, baseline, the coordinates of the beginning and end of the text in the line, etc.  (more details can be found in the <a href="https://developer.android.com/reference/android/text/Layout.html">documentation</a> ) </p><br><p>  Such methods can be very helpful.  For example, some developers are faced with the task of extracting part of the text into rounded rectangles, and are trying to find its solution through spans that are not applicable in solving this problem. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8b/-2/df/8b-2df4-wo4ghk8tkwss6l48bfy.png" width="300"></div><br><p>  But methods of the Layout class can come to the rescue.  Here is a sample solution: </p><br><p>  Using annotations, we select the words that should be circled in rectangles. </p><br><p>  Then create 4 drawable resources for all cases of text wrapping, which should be enclosed in rectangles: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q4/ry/oj/q4ryojq_lsj3sdyyehvprallpl8.png" width="600"></div><br><p>  Next, we find the annotations we need in the text, as described above.  Now we have the indexes of the beginning and end of such an annotation.  Through the Layout methods, you can find out the line number on which the annotated text begins and on which it ends: </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> startLine = layout.getLineForOffset(spanStartIndex) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> endLine = layout.getLineForOffset(spanEndIndex)</code> </pre> <br><p>  Next, you have to draw one or more rectangles.  Let's consider a simple case when the annotated part of the text appeared on one line, then we need only one rectangle with four rounded corners.  Define its coordinates and draw: </p><br><pre> <code class="kotlin hljs">... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (startLine == endLine) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> lineTop = layout.getLineTop(startLine) <span class="hljs-comment"><span class="hljs-comment">//    val lineBottom = layout.getLineBottom(startLine) //    val startCoor = layout.getPrimaryHorizontal(spanStartIndex).toInt() //    val endCoor = layout.getPrimaryHorizontal(spanEndIndex).toInt() //    //   drawable.setBounds(startCoor, lineTop, endCoor, lineBottom) drawable.draw(canvas) ...</span></span></code> </pre><br><p>  As you can see from this example, Layout stores a lot of useful information on the displayed text, which can help in the implementation of various non-standard tasks. </p><br><h1 id="proizvoditelnost-textview">  TextView Performance </h1><br><p>  A TextView, like any View, passes through three phases when displayed: <code>onMeasure()</code> , <code>onLayout()</code> and <code>onDraw()</code> .  At the same time, <code>onMeasure()</code> takes the most time, unlike the other two methods: at this moment, the Layout class is recreated and the text size is calculated.  So changing the size of the text (for example, changing the font) entails a lot of work.  Changing the color of the text will be more lightweight because it only requires calling <code>onDraw()</code> .  As mentioned above, the system has a global word cache with calculated sizes.  If the word is already in the cache, then calling <code>onMeasure()</code> for it will take 11-16% of the time that would have been required for a complete calculation. </p><br><h2 id="uskorenie-pokaza-teksta">  Speeding up text </h2><br><p>  In 2015, Instagram developers accelerated the display of comments on photos using the global cache.  The idea was to virtually draw the text before showing it on the screen, thus ‚Äúwarming up‚Äù the system cache.  When it was time to show the text, the user saw it much faster, since the text was already measured and was in the cache. </p><br><p>  Starting with <strong>Android P (28)</strong> , Google developers have added to the API the ability to perform the phase of measuring text size in advance in the background thread - <code>PrecomputedText</code> (and the backport for the API starting with <strong>Android I (14)</strong> - <code>PrecomputedTextCompat</code> ).  Using the new API, 90% of the work will be done in the background thread. </p><br><p>  Example: </p><br><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">// UI thread val params: PrecomputedText.Params = textView.getTextMetricsParams() val ref = WeakReference(textView) executor.execute { // background thread val text = PrecomputedText.create("Hello", params) val textView = ref.get() textView?.post { // UI thread val textView = ref.get() textView?.text = text } }</span></span></code> </pre> <br><h2 id="pokaz-bolshogo-teksta">  Show large text </h2><br><p>  If you need to show large text, then do not immediately transfer it to a TextView.  Otherwise, the application may stop working smoothly or completely freeze, as it will do a lot of work on the main thread to show huge text that the user may not even scroll to the end.  The solution is to split the text into parts (e.g. paragraphs) and display the individual parts in the RecyclerView.  For even greater speedup, you can pre-calculate the size of text blocks using PrecomputedText. </p><br><p>  To facilitate the embedding of PrecomputedText in RecyclerView, Google developers made special methods <code>PrecomputedTextCompat.getTextFuture()</code> and <code>AppCompatTextView.setTextFuture()</code> : </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(vh: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = getData(position) vh.textView.setTextSize(...) vh.textView.setFontVariationSettings(...) <span class="hljs-comment"><span class="hljs-comment">//    val future = PrecomputedTextCompat.getTextFuture( data.text, vh.textView.getTextMetricsParamsCompat(), myExecutor ) //  future  TextView,      onMeasure() vh.textView.setTextFuture(future) }</span></span></code> </pre> <br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Since RecyclerView creates new elements during scrolling that are not yet visible to the user, such a solution will have enough time to do the work in the background before the element is shown to the user. </font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It should be remembered that after calling the method </font></font><code>getTextFuture()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you cannot change the style of the text (for example, put a new font), otherwise an exception will occur, since the values ‚Äã‚Äãwith which it was called </font></font><code>getTextFuture()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will not coincide with those that appear in the TextView.</font></font></p><br><h2 id="chto-nuzhno-znat-kogda-ustanavlivaesh-tekst-v-textview"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What you need to know when setting text in a TextView </font></font></h2><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When the method is called </font></font><code>TextView.setText()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, a copy of the line is actually created inside:</font></font></p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == SPANNABLE || movementMethod != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { text = spannableFactory.newSpannable(spannable) <span class="hljs-comment"><span class="hljs-comment">//  } else { text = new SpannedString(spannable) //  }</span></span></code> </pre> <br><p>       span'  TextView,       <code>setText()</code> ,      . </p><br><p>    ,      .  TextView    ,  -,   .    ,      .    ,    ,     TextView   <code>spannableFactory</code> : </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MySpannableFactory</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Spannable.Factory</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">newSpannable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(source: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">CharSequence</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Spannable { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> source <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? Spannable ?: <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.newSpannable(source) } } textView.spannableFactory = MySpannableFactory()</code> </pre> <br><p>         <code>textView.setText(spannable, BufferType.SPANNABLE)</code> ,      . </p><br><p>  Google         span'  RecyclerView,      . </p><br><p>      TextView,     span,        <code>setText()</code> .      TextView      span. TextView   spannable-    span',  : </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> spannable = textView.getText() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Spannable <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> span = CustomTypefaceSpan(span) spannable.setSpan(span, ...)</code> </pre> <br><p>      span,      TextView,         TextView .       ,   <code>invalidate()</code> ,    ‚Äì <code>requestLayout()</code> : </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> spannable = textView.getText() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Spannable <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> span = CustomTypefaceSpan(span) spannable.setSpan(span, ...) span.setTypeface(anotherTypeface) textView.requestLayout() <span class="hljs-comment"><span class="hljs-comment">// re-measure and re-draw // or textView.invalidate() // re-draw</span></span></code> </pre> <br><h2 id="ispolzovanie-autolink">  autoLink </h2><br><p>  TextView     .         <code>autoLink</code> .   <code>autoLink=‚Äùweb‚Äù</code> TextView          URL          <code>URLSpan</code> .   ,     SDK   <code>setText()</code> : </p><br><pre> <code class="java hljs">spannable = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpannableString(string); Matcher m = pattern.matcher(text); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (...) { <span class="hljs-comment"><span class="hljs-comment">//      String utl = ‚Ä¶ URLSpan span = new URLSpan(url); spannable.setSpan(span, ...); }</span></span></code> </pre> <br><p>      UI ,     <code>autoLink=‚Äùweb‚Äù</code>   RecyclerView.          .        <code>LinkifyCompat</code> : </p><br><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,       background thread val spannable = SpannableString(string) LinkifyCompat.addLinks(spannable, Linkify.WEB_URLS) //   RecyclerView override fun onBindViewHolder(holder: ViewHolder, position: Int) { holder.textView.setText(spannable, BufferType.SPANNABLE) // ... }</span></span></code> </pre> <br><p>  <code>autoLink</code>      <code>map</code> ‚Äì    (      <code>all</code> ).       .   ,        WebView,      !    SDK   <code>Linkify.gatherMapLinks()</code>    ,      : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((address = WebView.findAddress(string)) != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { ... }</code> </pre> <br><p>   WebView  TODO   SDK: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String addr)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Rewrite this in Java so it is not needed to start up chromium // Could also be deprecated return getFactory().getStatics().findAddress(addr); }</span></span></code> </pre> <br><p>     ?     Smart Linkify,       <strong>Android P (28)</strong> ,          ,      .    : </p><br><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">// UI thread val text: Spannable = ‚Ä¶ val request = TextLinks.Request.Builder(text) val ref = WeakReference(textView) executor.execute { // background thread TextClassifier.generateLinks(request).apply(text) val textView = ref.get() textView?.post { // UI thread val textView = ref.get() textView?.text = text } }</span></span></code> </pre> <br><p>    Linkify,      .        toolbar   ,     Google . </p><br><p>  Smart Linkify    :  ,    . </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9t/nc/qb/9tncqbkanp8avsnmisd-ax0z7ae.gif" width="300"></div><br><h1 id="magnifier"> Magnifier </h1><br><p>   <strong>Android P (28)</strong> ,     ‚Äì Magnifier,       .           . </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fi/nn/or/finnor2svtuttfn1v-lxwkblgwm.gif" width="400"></div><br><p>      TextView, EditText  WebView,            :  API <a href="https://developer.android.com/guide/topics/text/magnifier"> </a> . </p><br><h1 id="zaklyuchenie">  Conclusion </h1><br><p>          Android   ,   , : </p><br><ul><li>         </li><li>    </li><li>   ,   TextView (, EditText) </li></ul><br><p>  -     ,      Google I/O'19 <a href="https://www.youtube.com/watch%3Fv%3DfpSfCvP36aA">‚ÄúBest Practices for Using Text in Android‚Äù</a> . </p><br><a name="links"></a><br><h1 id="poleznye-ssylki">  useful links </h1><br><h2 id="stati">  Articles </h2><br><ul><li> <a href="https://medium.com/androiddevelopers/spantastic-text-styling-with-spans-17b0c16b4568">Florina Muntenescu. "Spantastic text styling with Spans"</a> </li><li> <a href="https://medium.com/androiddevelopers/underspanding-spans-1b91008b97e4">Florina Muntenescu. "Underspanding spans"</a> </li><li> <a href="https://medium.com/androiddevelopers/styling-internationalized-text-in-android-f99759fb7b8f">Florina Muntenescu. "Styling internationalized text in Android"</a> </li><li> <a href="https://instagram-engineering.com/improving-comment-rendering-on-android-a77d5db3d82e">Instagram Engineering. "Improving Comment Rendering on Android"</a> </li><li> <a href="https://medium.com/%40Cuong.Le/text-rendering-on-android-9a27fc59c8a6">Daniel Lee. "Text rendering on Android"</a> </li><li> <a href="https://medium.com/appnroll-publication/what-is-new-in-android-p-precomputedtext-2a62ec9e8613">Mariusz DƒÖbrowski. "What is new in Android P ‚Äî PrecomputedText"</a> </li><li> <a href="https://medium.com/google-developers/recyclerview-prefetch-c2f269075710">Chet Haase. "RecyclerView Prefetch"</a> </li><li> <a href="https://medium.com/androiddevelopers/prefetch-text-layout-in-recyclerview-4acf9103f438">Chris Craik. "Prefetch Text Layout in RecyclerView"</a> </li></ul><br><h2 id="doklady">  Reports </h2><br><ul><li> <a href="https://www.youtube.com/watch%3Fv%3Dx-FcOX6ErdI">Best practices for text on Android (Google I/O '18)</a> </li><li> <a href="https://www.youtube.com/watch%3Fv%3DvXqwRhjd7b4">Use Android Text Like a Pro (Android Dev Summit '18)</a> </li><li> <a href="https://www.youtube.com/watch%3Fv%3DfpSfCvP36aA">Best Practices for Using Text in Android (Google I/O'19)</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/461787/">https://habr.com/ru/post/461787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461773/index.html">Airtest IDE - a new way in testing automation of mobile games?</a></li>
<li><a href="../461775/index.html">3 cases for using Celery in a Django application</a></li>
<li><a href="../461779/index.html">80% of your company data is not available to you. What to do with it?</a></li>
<li><a href="../46178/index.html">Ingraham - the systemist in the style of the 50s</a></li>
<li><a href="../461785/index.html">Disadvantages of RISC-V</a></li>
<li><a href="../46179/index.html">Stages of development of a promotional site. Task formulation</a></li>
<li><a href="../461793/index.html">Ivan Ponomarev about Kafka Streams API at jug.msk.ru meeting</a></li>
<li><a href="../461797/index.html">Tales of service. A frivolous post about serious work</a></li>
<li><a href="../4618/index.html">J & P: You can make good money on smartphones</a></li>
<li><a href="../46180/index.html">Party in honor of the new premises! (Moscow, December 9, 18:00)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>