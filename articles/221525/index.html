<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>One approach to debugging solutions for SharePoint</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Of course, you are familiar with the possible options for debugging solutions that are developed for SharePoint and fit into it. If not, then in more ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>One approach to debugging solutions for SharePoint</h1><div class="post__text post__text-html js-mediator-article">  Of course, you are familiar with the possible options for debugging solutions that are developed for <strong>SharePoint</strong> and fit into it.  If not, then in more detail about this you can read <a href="http://msdn.microsoft.com/ru-ru/library/ee231550.aspx">here</a> or <a href="http://msdn.microsoft.com/en-us/library/ff650703.aspx">here</a> and I will only briefly give a sequence of possible actions. <br><br>  In the article itself, I will describe one of the approaches that will help simplify the process of debugging the business logic of your decision. <br><br>  The standard debugging process and the process itself are as follows: <br><a name="habracut"></a><br><ol><li>  Enable debugging in web.config <br><ul><li>  CallStack = "true" </li><li>  customErrors mode = "Off" </li><li>  compilation debug = "true" </li></ul><br></li><li>  Debugging process <br><ul><li>  Attaching to the processes w3wp.exe / SPUCWorkerProcess.exe / OWSTimer.exe; </li><li>  Set the required breakpoints; </li><li>  Perform the required operation and step-by-step debugging of the code. </li></ul><br></li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After each modification of the code, in order to debug it in such a way, it is necessary that this solution be immersed in <strong>SharePoint</strong> .  This is accompanied by many additional operations, such as withdrawing an existing solution, adding a new one, re-activating features, clearing the cache, and so on.  Each such deployment is not important from the studio, it is done either manually, each separate launch of this kind of debugging takes a lot of time.  It‚Äôs not scary once, but if after each change you try to debug the code, the debugging process will take much more time than the development process itself.  This approach, of course, has one very big plus - the programmer quickly gets used to writing workable code with a minimum number of debugging processes :) But in fact, such debugging starts to strain pretty quickly. <br><br>  The standard debugging process for <strong>SharePoint</strong> will also come in handy, of course.  Without it, as without hands, when it will be necessary to debug the development with more / less vital data or it will be necessary to rely on events occurring in <strong>SharePoint</strong> .  But now is not about that. <br><br>  The proposed option is very simple, in fact, this is the creation of a console application in which objects of our business logic will be created, methods called, results recorded, and so on.  It would seem that everything becomes clear immediately, but it is better to create such a project step by step and see what problems can be and how to solve them: <br><br>  1. Create a new project using the <strong>SharePoint 2013</strong> template <strong>- Empty Project</strong> and name it <strong>SharePointApplication</strong> : <br><img src="https://habrastorage.org/getpro/habr/post_images/0de/96b/264/0de96b26460f5bf3ec73c9fec1fdea75.png"><br><br>  2. Specify the type of solution (Farm solution. But you know what is the difference between Farm and Sandbox Solution? Now let's not go into details, in another article) and specify the address of our site-collection in SharePoint: <br><img src="https://habrastorage.org/getpro/habr/post_images/f98/cfc/db9/f98cfcdb92c9ab21aef507d5bb69bbba.png"><br><br>  3. Next, we create a simple <strong>DEMO</strong> class for example with the <strong>SPWeb</strong> class extension method, which will be responsible for updating the filtered lists of this node in the part of the property responsible for opening list forms in a modal window or not: <br><br><ul><li>  Add a new class to the project and name it Demo.cs: <br><img src="https://habrastorage.org/getpro/habr/post_images/790/1ba/e60/7901bae60d979af6b31e6eb24d0fe323.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/11d/0cc/4f8/11d0cc4f8ad93a5eea0ba9b2cbffaf0b.png"><br></li><li>  Inside the class, insert the following code: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.SharePoint; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">SharePointApplication</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Demo</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateNoDialog</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> SPWeb Web, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Filter</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Lists = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;splist&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!String.IsNullOrEmpty(Filter)) { Lists = Web.Lists.Cast&lt;splist&gt;() .Where(x =&gt; x.Title.ToLower().IndexOf(Filter.ToLower(), System.StringComparison.Ordinal) != <span class="hljs-number"><span class="hljs-number">-1</span></span>) .ToList(); } Lists.ForEach(x =&gt; { x.NavigateForFormsPages = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; x.Update(); }); } } }</code> </pre> <br></li><li>  The result is the following picture: <br><img src="https://habrastorage.org/getpro/habr/post_images/025/60c/826/02560c8262cf624966920a4990629d73.png"><br></li></ul><br>  4. Create a web part with a filter input field and a button to call this method: <br><ul><li>  Add a new web part to the project and name it <strong>DemoWebPart</strong> <br><img src="https://habrastorage.org/getpro/habr/post_images/126/7b5/03e/1267b503e51241e07dbd763499017c21.png"><br></li><li>  In the <strong>Elements.xml</strong> file associated with this web part, you must specify the group name ( <strong>DemoGroup</strong> ) in which the created web part will be displayed: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Elements</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/sharepoint/"</span></span></span><span class="hljs-tag"> &gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DemoWebPart"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">List</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"113"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_catalogs/wp"</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">File</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DemoWebPartDemoWebPart.webpart"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SharePointApplication_DemoWebPart.webpart"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GhostableInLibrary"</span></span></span><span class="hljs-tag"> &gt;</span></span>      <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Group"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DemoGroup"</span></span></span><span class="hljs-tag"> /&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">File</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Module</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Elements</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></li><li>  In the file <strong>DemoWebPart.webpart,</strong> you must specify the displayed title and description of the web part: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">webParts</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">webPart</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WebPart/v3"</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">metaData</span></span></span><span class="hljs-tag">&gt;</span></span>      <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SharePointApplication.DemoWebPart.DemoWebPart, $SharePoint.Project.AssemblyFullName$"</span></span></span><span class="hljs-tag"> /&gt;</span></span>      <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">importErrorMessage</span></span></span><span class="hljs-tag">&gt;</span></span>$Resources:core,ImportErrorMessage;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">importErrorMessage</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">metaData</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span>      <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span>        <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Title"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag">&gt;</span></span> -<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span>        <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Description"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag">&gt;</span></span>-     <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span>      <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">webPart</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">webParts</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br></li><li>  In the file <strong>DemoWebPart.ascx</strong> you need to write the following code: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Assembly</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$SharePoint.Project.AssemblyFullName$"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Assembly</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.Web.CommandUI, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Tagprefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SharePoint"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.SharePoint.WebControls"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Assembly</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.SharePoint, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Tagprefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Utilities"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.SharePoint.Utilities"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Assembly</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.SharePoint, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Tagprefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Web.UI"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Assembly</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.SharePoint"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Tagprefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"WebPartPages"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.SharePoint.WebPartPages"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Assembly</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.SharePoint, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Control</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"C#"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AutoEventWireup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">CodeBehind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DemoWebPart.ascx.cs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Inherits</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SharePointApplication.DemoWebPart.DemoWebPart"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asp:Label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ResultLabel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">runat</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"server"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Label"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Visible</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"False"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ForeColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Green"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asp:Label</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asp:TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"FilterBox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">runat</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"server"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asp:TextBox</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asp:Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ExecuteButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">runat</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"server"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">OnClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ExecuteButton_OnClick"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br><br></li><li>  In the file <strong>DemoWebPart.ascx.cs</strong> you need to add a function: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteButton_OnClick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { SPContext.Current.Web.UpdateNoDialog(FilterBox.Text); ResultLabel.Text = DateTime.Now.ToString()+<span class="hljs-string"><span class="hljs-string">" !"</span></span>; ResultLabel.Visible = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; ResultLabel.ForeColor = System.Drawing.Color.Green; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception Error) { <span class="hljs-comment"><span class="hljs-comment">//       . ResultLabel.Text = DateTime.Now.ToString() + "  ! " + Error.Message; ResultLabel.Visible = true; ResultLabel.ForeColor = System.Drawing.Color.Red; } }</span></span></code> </pre><br><br></li></ul><br>  5. Deploy the solution on our website. <br><img src="https://habrastorage.org/getpro/habr/post_images/a66/cab/926/a66cab92631241889c94f5cdeb2d6e63.png"><br><br>  6. Place the required web part on the page and test its performance. <br><ul><li>  Go to the page where we plan to host the web part. <br><img src="https://habrastorage.org/getpro/habr/post_images/793/082/64e/79308264efd01bfafc77081120bc78e1.png"><br></li><li>  In Ribbon, click Page - Edit: <br><img src="https://habrastorage.org/getpro/habr/post_images/456/079/a65/456079a6537a94d4b3d891b36e76eea8.png"><br></li><li>  In the modified view, select Insert - Web Part - DemoGroup - Demo Web Part and the Add button: <br><img src="https://habrastorage.org/getpro/habr/post_images/80d/921/934/80d921934732a6176dfd79b2ffe1fbbc.png"><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f08/26b/017/f0826b0175d728addb144d7b2f673c65.png"><br></li><li>  Specify the filter value (MyLists, for example) and click the Run button: <br><img src="https://habrastorage.org/getpro/habr/post_images/a16/6c4/73b/a166c473bfe7cc4a6c8ced8738a9168b.png"><br></li></ul><br>  7. Now we understand that if something went wrong and it was necessary to look for the cause of the problem, you need to connect the w3wp process and monitor what is happening, make changes to the code, deploy again, check and so on.  The main part of the checks (at least business logic) can be checked in the console application. <br><br>  8. Add a new console application to our solution and name it ExecuteApplication. <br><img src="https://habrastorage.org/getpro/habr/post_images/1da/91e/f75/1da91ef75ee8871c3183ea13ae68d70d.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1fd/207/4ae/1fd2074ae91efdc88f7c5ff9f6791740.png"><br><br>  9. Change the application launch mode to x64 platform. <br><ul><li>  Go to the project properties: <br><img src="https://habrastorage.org/getpro/habr/post_images/152/117/6be/1521176be6d1ddb79f354ff7d25e2ac3.png"><br></li><li>  Go to the Build tab and enter x64 in the Perform target field: <br><img src="https://habrastorage.org/getpro/habr/post_images/4f3/fbf/502/4f3fbf502cbb9f2eb7c29aa245bfc157.png"><br></li></ul><br><br>  10. Install the console application with the project to run: <br><img src="https://habrastorage.org/getpro/habr/post_images/81a/e0e/ab0/81ae0eab08b9c36fd40b8a55999eb029.png"><br><br>  11. We connect to the project a library from a neighboring project, in which our objects and methods are located: <br><img src="https://habrastorage.org/getpro/habr/post_images/a6e/c35/dfa/a6ec35dfa6e84cc86724b948a08f8ae3.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b91/616/dca/b91616dca45badfc6b62ec3f77123774.png"><br><br>  12. In the main method of the console application, we create a connection to our SharePoint site, in the context of which it will work and call the necessary function that we want to test.  Sample code is as follows: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.SharePoint; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> SharePointApplication; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">ExecuteApplication</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Site = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SPSite(<span class="hljs-string"><span class="hljs-string">"http://cib_dev3/a/snitko/"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Web = Site.RootWeb) { Web.UpdateNoDialog(<span class="hljs-string"><span class="hljs-string">"MyLists"</span></span>); } } } } }</code> </pre><br><br>  13. We start the project and monitor what is happening in real time: <br><img src="https://habrastorage.org/getpro/habr/post_images/9b6/7b5/cff/9b67b5cff11525ccebcdf7eabdcfa870.png"><br><br>  14. If we see the following error ( <em>Microsoft SharePoint is not supported in a 32-bit process. Use a 64-bit executable file.),</em> Then we most likely did not complete item number 9. Sometimes the error may look different (for example, the site is unavailable) , but the essence of the error is the same: <br><img src="https://habrastorage.org/getpro/habr/post_images/f7b/d57/d41/f7bd57d41610d2648ebd8b94b80e9d12.png"><br><br>  15. If after the changes in the class and the next launch of the project we see the following error ( <em>Method not found: "Void SharePointApplication.Demo.UpdateNoDialogNew (Microsoft.SharePoint.SPWeb, System.String)".),:</em> <br><img src="https://habrastorage.org/getpro/habr/post_images/bbe/359/8c0/bbe3598c0d525848f1899b3667aff018.png"><br><br>  This is most likely due to the fact that the assembly from the neighboring solution exists both locally (in the project) and in the GAC, but in the GAC the assembly is older, but at the start it is more priority.  Thus, it turns out that when writing code, the studio does not issue errors, because it uses the assembly locally, and when starting the solution it reports that the assembly (which is in the GAC) does not have the methods that you call.  To do this, before launching the console application, put the modified library of the neighboring project in the GAC. <br><br><ul><li>  You need to find gacutil.exe (included in the Windows SDK. For example, you can take it <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D24826">here</a> ), create a folder in the file system and place the contents of the archive in this folder.  For example, C: \ gacutil. </li><li>  Go to the SharePointApplication project (with the basic business logic), go to the project properties on the Build Events tab: <br><img src="https://habrastorage.org/getpro/habr/post_images/007/256/2ba/0072562ba7496d3ed0cab83e4d9faa57.png"><br></li><li>  In the Post Build Event field we write the following code: <br><pre> <code class="html hljs xml">"C:\gacutil\gacutil.exe" /i "$(TargetPath)</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/94e/d2d/52f/94ed2d52f50ee6534f1bbe02f95b88da.png"><br></li><li>  It turned out that the event ‚ÄúAfter building the project‚Äù, which is called when the project starts, added the installation of the final library of the current project (it is located on the path $ (TargetPath) - this is a Visual Studio constant that forms the required path itself) in the GAC using the gacutil utility . </li><li>  As a result, there is no more error when launching the console application. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/1dc/561/5f3/1dc5615f301d5fdcc6402698d6d0cb2c.png"><br><br>  <strong>Congratulations</strong> !  The process of debugging the main business logic is now working on ur. <br><br>  Today we have reviewed one of the approaches for more convenient and quick debugging for solutions on <strong>SharePoint</strong> , as well as several typical problems that a developer may encounter when using this approach. <br><br></div><p>Source: <a href="https://habr.com/ru/post/221525/">https://habr.com/ru/post/221525/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../221511/index.html">Samsung launches SSD technology on 3 bits per cell for data centers</a></li>
<li><a href="../221513/index.html">Solving the problem with non-bootable configs in Thinstation 5</a></li>
<li><a href="../221515/index.html">Long ago, when Habr was without invites, and Bash could be read completely in 2 days, we did satellite Internet in Astrakhan</a></li>
<li><a href="../221519/index.html">Sapper: Royal Engineer</a></li>
<li><a href="../221521/index.html">Asynchronous Php extension to work with Cassandra without Thrift</a></li>
<li><a href="../221527/index.html">Is fundamental education in CS important and a view from Yandex on professions in the world of information technology?</a></li>
<li><a href="../221529/index.html">The seventh issue of TsODY.RF magazine</a></li>
<li><a href="../221531/index.html">Linux for professionals: video editing (and a bit of compositing)</a></li>
<li><a href="../221539/index.html">FZ-229 - hands off the main mobile account</a></li>
<li><a href="../221543/index.html">Installing Archlinux on an Android phone in the second section of SD or just a subfolder of the system memory card</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>