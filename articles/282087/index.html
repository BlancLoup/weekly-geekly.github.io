<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Investigate the "Inspector" Roskomnadzor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aqua mine 
 The auditor, a software hardware complex for monitoring access to sites from the registry by providers, began in October 2015, when the co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Investigate the "Inspector" Roskomnadzor</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/3df/3d7/1cc/3df3d71cc5e6cb3b1c3eb69a29ef4972.jpg" alt="FSB good"><br>  <sup><a href="https://www.behance.net/aquamine">Aqua mine</a></sup> <br>  The auditor, a software hardware complex for monitoring access to sites from the registry by providers, began in October 2015, when the company MFI Soft, the same company that made SORMy, won the tender for software development for 84 million rubles.  Under the terms of the tender, the developer had to provide workable software for Windows and Linux and 700 hardware "Agents" before December 12, 2015, in just 2.5 months, and it seems that everything was ready even a couple of weeks before the deadline.  Already at the beginning of December, voluntary-compulsory providers were asked to install one of three variants of the Auditor: as an image of a VMWare virtual machine based on OpenWRT 14.07, as a program service under Windows, or as an iron ‚ÄúAgent‚Äù that represented TP-Link MR3020 router with OpenWRT installed on it and the necessary software.  Many providers refused to install the complex due to the fact that it was not certified, and only they would be harmed, and the other devices simply did not get, and they had to install a software version. <br><br>  So, I have in my hands the latest version of the VMWare image and Exe file of the Examiner.  Let's see what's inside! <br><img src="https://habrastorage.org/getpro/habr/post_images/2b3/897/ce1/2b3897ce1ae3cb92ab22f99b8b6707a3.png" alt="image"><a name="habracut"></a><br><br><h3>  VM Image Investigation </h3>  First of all, I converted the image to RAW, in order to be able to just mount it without running it in a virtual machine.  For this, there is a wonderful utility in qemu, qemu-img, which can convert all popular image formats of virtual machines to each other: <br><pre><code>$ qemu-img convert -O raw ra-wrt-x86-disk1.vmdk rev-clean.raw</code></pre>       kpartx   multipath-tools,        ,        ,   ,   :<br>
<pre><code>$ sudo kpartx -a rev-clean.raw</code></pre>       ext2  ext4:<br>
<pre><code>                         Disk: /dev/loop1
          Size: 52.5 MiB, 55050240 bytes, 107520 sectors
                Label: dos, identifier: 0x00000000

    Device         Boot    Start     End  Sectors  Size  Id Type
&gt;&gt;  /dev/loop1p1   *         512    8703     8192    4M  83 Linux  
    /dev/loop1p2            9216  107519    98304   48M  83 Linux
</code></pre>  ‚Äî ,   /boot.    Grub2  .  .<br>
       OpenWRT.         OpenWRT?  ‚Äî    !<br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code>2014-04-10+18:34:34.0000000000  ./lib/firmware/rtl_nic/rtl8105e-1.fw
2014-04-10+18:34:34.0000000000  ./lib/firmware/rtl_nic/rtl8106e-1.fw
2014-04-10+18:34:34.0000000000  ./lib/firmware/rtl_nic/rtl8106e-2.fw
2014-04-10+18:34:34.0000000000  ./lib/firmware/rtl_nic/rtl8168d-1.fw
‚Ä¶
2014-09-16+23:45:16.0000000000  ./lib/netifd/netifd-proto.sh
2014-09-16+23:45:16.0000000000  ./lib/netifd/netifd-wireless.sh
2014-09-16+23:45:16.0000000000  ./lib/netifd/utils.sh
2014-09-21+14:46:54.0000000000  ./bin/ipcalc.sh
‚Ä¶
2015-10-23+12:04:49.0000000000  ./bin/revizor_postboot
2015-10-23+12:04:49.0000000000  ./bin/revizor_postupdate
2015-10-23+12:04:49.0000000000  ./dev
2015-10-23+12:04:49.0000000000  ./dev/console
2015-10-23+12:04:49.0000000000  ./etc/agent_id
2015-10-23+12:04:49.0000000000  ./etc/config/dropbear
2015-10-23+12:04:49.0000000000  ./etc/dropbear/dropbear_dss_host_key
2015-10-23+12:04:49.0000000000  ./etc/dropbear/dropbear_rsa_host_key
2015-10-23+12:04:49.0000000000  ./etc/opkg.conf
2015-10-23+12:04:49.0000000000  ./etc/shadow
2015-10-23+12:04:49.0000000000  ./etc/shells
2015-10-23+12:04:49.0000000000  ./etc/ssl
2015-10-23+12:04:49.0000000000  ./etc/ssl/certs
2015-10-23+12:04:49.0000000000  ./etc/ssl/certs/revizor_opkg.crt
2015-10-23+12:04:49.0000000000  ./root
2015-10-23+12:04:49.0000000000  ./root/.ssh
2015-10-23+12:04:49.0000000000  ./root/.ssh/id_rsa
2015-10-23+14:49:17.0000000000  ./etc/crontabs
2015-10-23+14:49:17.0000000000  ./etc/crontabs/root
2015-10-23+14:49:17.0000000000  ./etc/revizor_server
2015-10-29+14:27:19.0000000000  ./bin/revizor_boot
2015-10-29+14:27:19.0000000000  ./etc/config/network
2015-10-29+14:27:19.0000000000  ./etc/netfallback.conf
2015-10-29+14:27:19.0000000000  ./etc/rc.local
2015-11-03+15:43:21.0000000000  ./etc/init.d/dropbear
2015-11-03+15:43:21.0000000000  ./usr/lib/opkg/info/dropbear.conffiles
2015-11-03+15:43:21.0000000000  ./usr/lib/opkg/info/dropbear.control
2015-11-03+15:43:21.0000000000  ./usr/sbin/dropbear
2015-11-03+17:05:22.0000000000  ./bin/admin/admsrv
2015-11-03+17:05:22.0000000000  ./bin/revizor_logger
2015-11-03+17:05:22.0000000000  ./bin/revizor_preboot
2015-11-03+17:05:22.0000000000  ./etc/passwd
2015-11-09+17:10:52.0000000000  ./bin
2015-11-09+17:10:52.0000000000  ./bin/admin/admcli
2015-11-09+17:10:52.0000000000  ./bin/revizor_updater
2015-11-09+17:10:52.0000000000  ./etc/config
2015-11-09+17:10:52.0000000000  ./etc/config/system
2015-11-09+17:10:52.0000000000  ./etc/dropbear
2015-11-09+17:10:52.0000000000  ./etc/dropbear/authorized_keys
2015-11-09+17:10:52.0000000000  ./etc/inittab
2015-11-13+12:06:31.0000000000  ./bin/admin/netfallback
2015-11-16+15:31:23.0000000000  ./bin/admin
2015-11-16+15:31:23.0000000000  ./bin/admin/pwd-sh
2016-02-09+11:09:52.0000000000  ./etc
2016-02-09+11:09:52.0000000000  ./etc/revizor_firmware_version
2016-02-09+11:09:53.0000000000  ./bin/ash
2016-02-09+11:09:53.0000000000  ./bin/cat
2016-02-09+11:09:53.0000000000  ./bin/chgrp
‚Ä¶</code></pre></div></div>    :    23 ,      , , , 16     ,     9 .<br>
<br>
  ,   ,   ‚Äî     <b>/etc/rc.local</b>:<br>
<pre><code># Put your custom commands here that should be executed once
# the system init finished. By default this file does nothing.

/bin/admin/admsrv &amp;
/bin/admin/netfallback &amp;
/bin/revizor_boot &amp;
exit 0</code></pre><b>/bin/admin/admsrv</b>    admin      <b>/etc/agent_id</b>,         ( DICK-BUTT-I386),   ,  MD5,      12 ,    .     <b>/etc/agent_id</b>    ‚Äî 28  ,        80√ó24. , ,  -    Shift+PgUp/PgDown.     SSH- (dropbear)   2222,  ,  2   .<br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code>#!/bin/sh

sleep 2
chmod a+rw /etc/opkg.conf
chmod a+rw /etc/netfallback.conf

ADMIN_PORT=2222
ADMIN_TIMEOUT=120

read ADMIN_PWD &lt;/etc/agent_id
if [ ! -z ADMIN_PWD ]; then
  ADMIN_PWD=`echo $ADMIN_PWD | tail -c +2 | md5sum | head -c 12`
  if [ ! -z ADMIN_PWD ]; then
    echo "admin password: $ADMIN_PWD" | revizor_logger
    echo -e "$ADMIN_PWD\n$ADMIN_PWD" | passwd admin
  fi
fi

/usr/sbin/dropbear -F -p 0.0.0.0:$ADMIN_PORT -n -K 30 -I 300 &amp;
PID=$!

sleep $ADMIN_TIMEOUT
kill -9 $PID</code></pre></div></div><br>
  <b>/bin/admin/netfallback</b>   ‚Äî   5       IP-  DHCP-,     192.168.0.254,      30   ,    DHCP-       IP-.<br>
     <b>/bin/revizor_boot</b>        <b>opkg.conf</b>,      cron,       15 .   .<br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code>#!/bin/sh

if [ ! -f /rom/etc/opkg.conf ]; then
  read REVIZOR_SERVER &lt;/etc/revizor_server
  if [ -z "$REVIZOR_SERVER" ]; then
    REVIZOR_SERVER="revizor.mfisoft.ru"
  fi

  mkdir -p /rom/etc
  OPKG_CFG=`cat /etc/opkg.conf | grep -v '^src revizor '`
  echo "$OPKG_CFG" &gt; /rom/etc/opkg.conf
  echo "src revizor https://$REVIZOR_SERVER/updates/openwrt-x86/common" &gt;&gt; /rom/etc/opkg.conf
  cp -f /rom/etc/opkg.conf /etc/opkg.conf
fi

rm -f /usr/lib/opkg/lock
/bin/revizor_preboot

sleep 2
/bin/revizor_updater -f /rom/etc/opkg.conf

/etc/init.d/cron start
/bin/revizor_postboot</code></pre><br>
 <b>/bin/revizor_preboot</b>  <b>/bin/revizor_postboot</b> .</div></div><br>
 <b>/bin/admin/pwd-sh</b>,     - (  <b>/etc/inittab</b>  tty1  ttyS0),      ‚Äî  SSH-  localhost.   ,  OpenWRT     ,     ,      ,       .      ,     root-,   Enter      .  ,       getty,      ,  getty      .  ,  - ,     getty,        SSH,  SSH-  .   ,      ,        -  root,  , SSH-    .<br>
<br>
   admin   <b>/bin/admin/admcli</b>,     :<br>
<pre><code>system reboot
system resetfs
system update
log
info
ifconfig
route
arp
ping
nslookup
traceroute
net proxy clear
net proxy set
net fallback</code></pre>     ¬´ ¬ª,    opkg:<br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code>Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 12303214825491704792 (0xaabdccb2d4c0abd8)
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: C=RU, ST=Russia, O=MFISOFT
        Validity
            Not Before: Oct 21 10:21:46 2015 GMT
            Not After : Aug  5 10:21:46 2289 GMT
        Subject: C=RU, ST=Russia, O=MFISOFT
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (1024 bit)
                Modulus:
                    00:cc:ed:e0:84:c4:7b:4e:49:2d:11:86:41:0f:f8:
                    51:97:42:91:76:34:38:96:e0:9e:a4:3c:7b:30:f6:
                    15:b2:1e:03:0e:12:46:96:f9:57:a1:db:2d:63:8a:
                    dc:01:2e:e7:10:56:8d:c3:d5:de:5a:bb:d7:75:e3:
                    6b:e3:d5:6a:04:4d:f4:65:81:05:07:d7:d0:a8:29:
                    ab:9d:83:81:00:04:73:27:39:db:d3:c8:ba:d3:78:
                    41:84:d9:8b:62:21:00:51:fc:78:06:ce:f7:db:e6:
                    5b:fd:d7:b6:2b:0f:72:9e:63:d8:06:f1:dd:2d:c5:
                    17:f1:a9:b8:d3:5e:ad:6c:d5
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Subject Key Identifier: 
                F6:F9:BB:39:1B:20:4F:B4:11:B5:CE:EA:C2:F5:95:DB:24:DB:49:53
            X509v3 Authority Key Identifier: 
                keyid:F6:F9:BB:39:1B:20:4F:B4:11:B5:CE:EA:C2:F5:95:DB:24:DB:49:53

            X509v3 Basic Constraints: 
                CA:TRUE
    Signature Algorithm: sha256WithRSAEncryption
         16:31:a0:2f:01:1b:06:a3:31:d3:d2:50:38:b4:c2:57:ec:6d:
         a0:25:5e:e0:35:68:92:dd:38:fc:1a:ef:88:2d:e8:b9:1b:d7:
         f5:ef:97:14:75:ef:65:1c:f9:ae:61:43:05:49:74:08:8a:d5:
         19:01:e3:63:ff:69:57:34:74:9e:b8:7d:6d:5b:2a:66:59:a6:
         9d:b4:a3:3f:41:91:30:26:1f:0e:3a:24:2b:36:0e:68:f8:e8:
         44:f5:5a:18:ea:5e:48:8e:a9:8f:03:25:87:ba:60:9c:93:ac:
         cb:43:b7:ee:6d:6c:85:88:77:40:a7:b4:a8:c9:ce:d0:29:6d:
         78:0a
-----BEGIN CERTIFICATE-----
MIICMDCCAZmgAwIBAgIJAKq9zLLUwKvYMA0GCSqGSIb3DQEBCwUAMDAxCzAJBgNV
BAYTAlJVMQ8wDQYDVQQIDAZSdXNzaWExEDAOBgNVBAoMB01GSVNPRlQwIBcNMTUx
MDIxMTAyMTQ2WhgPMjI4OTA4MDUxMDIxNDZaMDAxCzAJBgNVBAYTAlJVMQ8wDQYD
VQQIDAZSdXNzaWExEDAOBgNVBAoMB01GSVNPRlQwgZ8wDQYJKoZIhvcNAQEBBQAD
gY0AMIGJAoGBAMzt4ITEe05JLRGGQQ/4UZdCkXY0OJbgnqQ8ezD2FbIeAw4SRpb5
V6HbLWOK3AEu5xBWjcPV3lq713Xja+PVagRN9GWBBQfX0Kgpq52DgQAEcyc529PI
utN4QYTZi2IhAFH8eAbO99vmW/3XtisPcp5j2Abx3S3FF/GpuNNerWzVAgMBAAGj
UDBOMB0GA1UdDgQWBBT2+bs5GyBPtBG1zurC9ZXbJNtJUzAfBgNVHSMEGDAWgBT2
+bs5GyBPtBG1zurC9ZXbJNtJUzAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBCwUA
A4GBABYxoC8BGwajMdPSUDi0wlfsbaAlXuA1aJLdOPwa74gt6Lkb1/XvlxR172Uc
+a5hQwVJdAiK1RkB42P/aVc0dJ64fW1bKmZZpp20oz9BkTAmHw46JCs2Dmj46ET1
WhjqXkiOqY8DJYe6YJyTrMtDt+5tbIWId0CntKjJztApbXgK
-----END CERTIFICATE-----</code></pre></div></div><br>
  SSH  ,   :<pre><code>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCAxFzEe20FUIegQ8p25S/b1SIhVi0XTWZtLDF7FLpMsoxi+JhgzoVEwmCIpoQ9c5Flid0jiqKCVhnm8GRe+qjkxibAOa8WlfiQ16eapqA0Dd6laFW4RzTTiinebPRlLJBsj8xGhrvf4lsKXng5+ZDWXnrz7pICbh62U7MYNEpOuy9x4P4285Xq9ccIuCrCAS8rZ4TdFdzeM+270asIQB/vsQ2joJ1vNn3WzdISmRepknR4eTo6H881vHAiWVTpGioXssvOGyLYfqn0rqVECC9/tknV0hQJP+iYU3mov4+JYvRVa+5m1DLD0Nj0QWKFXl79VNxstwyOt6RDvQrhlxNB root@revizor-agent</code></pre>    ?<br>
<br>
<h3>!</h3>     ,     .     :<br>
<a href="https://n01.rfc-revizor.ru/updates/openwrt-x86/common/Packages">n01.rfc-revizor.ru/updates/openwrt-x86/common/Packages</a><br>
<br>
 ,     ¬´revizor¬ª:<br>
<pre><code>Package: revizor
Version: 1.2.2-34720
Depends: libc, libstdcpp, libpthread, libpcre, libopenssl
Section: utils
Architecture: x86
MD5Sum: 0afc31c21b785690ca38a89d24d749ed
Size: 322098
Filename: revizor_1.2.2-34720_x86.ipk
Source: package/revizor
Description: revizor agent</code></pre>  !<br>
<a href="">n01.rfc-revizor.ru/updates/openwrt-x86/common/revizor_1.2.2-34720_x86.ipk</a><br>
<br>
  IPK     .tar.gz   DEB-.    abelyak.<br>
<img src="https://habrastorage.org/getpro/habr/post_images/176/519/1a2/1765191a2f1beed76bdd919befba4ca9.png" alt="image"><br>
        ELF-: <b>revizor-crypto</b>  <b>urlcheck</b>.   ,   ,   ,  ,        ,       .  ,       , ,       .<br>
<br>
    ‚Äî  <b>urlcheck</b>.    C++,  ,  libevent   OpenSSL-,    :<br>
<ul>
<li> HTTP/HTTPS GET/POST-   URL</li>
<li>    URL   IP- (     DNS)</li>
<li>     DPI:     ,     URL,  URL</li>
<li>              </li>
<li> ICMP-   </li>
<li> traceroute   </li>
<li> SSH-      Socks5-</li>
<li>   syslog   </li>
<li> </li>
</ul><br>
  IPv6    .<br>
<br>
   Lens,     ,    JSON-RPC,    URL <a href="https://n01.rfc-revizor.ru/rpclens/">n01.rfc-revizor.ru/rpclens</a>. Lens   ¬´¬ª,    .    , ,    .    -      ,        ya.ru, google.ru, cbr.ru, gov.ru, hotlog.ru, kremlin.ru, onf.ru, ria.ru, rostelecom.ru, kp.ru,   URL    .               -.  - ,     ,      ,      SSH-  Socks5-,    <b>urlcheck</b>,       curl,  ,      wkhtmltoimage.<br>
 ,      , ,      ,    ,      DNS-.<br>
<br>
<h3>!</h3>   API     HTTPS,     ,  GeoTrust,      ,   ,         ¬´ ¬ª,      .   ,         :  TP-Link MR3020   4 ,    x86   .<br>
 mitmproxy!<br>
<br>
      <b>SetMyParams</b>,      ,      4     .<br>
<pre><code>POST /rpclens HTTP/1.1
Host:            n01.rfc-revizor.ru
Connection:      close
Content-Length:  176

{"method":"SetMyParams","params":{"version":"WRT-1.2.2.34720","traf":{"duration":3600,"bytes_in":24055,"bytes_out":32636}},"id":"DICK-BUTT-I386---1AE822EF40","session_id":1488}</code></pre><br>
<br>
<pre><code>Server:                  nginx
Date:                    Mon, 01 Apr 2016 12:34:56 GMT
Content-Type:            text/html
Transfer-Encoding:       chunked
Connection:              keep-alive
X-Powered-By:            PHP/5.2.6
X-Frame-Options:         SAMEORIGIN
X-Content-Type-Options:  nosniff

{"jsonrpc":"2.0","result":{"status":"done"},"id":"DICK-BUTT-I386---1AE822EF40"}</code></pre><br>
   <b>GetMyTasks</b>,       -   .      :<br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code>{"method":"GetMyTasks","params":"","id":"DICK-BUTT-I386---1AE822EF40","session_id":1488}</code></pre><br>
<pre><code>{"jsonrpc":"2.0","result":{"tasks":[{"id_task":"493629","id_task_meta":null,"type":"check","priority":"1","checklist":"own","checklist_count":"2","params":"{\"checklist\":{\"group_id\":1,\"records\":{\"records_type\":2},\"requests\":{\"get\":1,\"post\":0,\"use_dns\":1,\"check_escaped\":0,\"add_slashes\":0,\"add_dot\":0,\"randomize\":0,\"report_success\":0,\"max_redirects\":5,\"use_dns_only\":1,\"all_resolved_ips\":0},\"screenshots\":{\"fail_screenshots\":1,\"skip_if_protocol_exist\":0,\"skip_if_exists_hours\":null,\"skip_if_over\":null,\"only_200\":1,\"skip_3xx\":null}}}","status":"CREATED","completion":null,"result":null,"pass":null,"fail":null,"passed_items":null,"failed_items":null,"id_creator":"WWW-ANUS-PYOS","id_lens":"DICK-BUTT-I386---1AE822EF40","ts_create":"1461299321","ts_start":null,"ts_stop":null}],"params":{"DnsThreadsMax":20,"MAXfailedChecklistDownloadCount":100,"MAXfailedReportUploadCount":25,"whiteCheckMinInterval":60000,"connectTimeout":10000,"soTimeout":10000,"maxTotalConnections":50,"maxHttpsConnections":20,"maxContentSize":3000},"ts":1461299347,"zip":1,"tests":[{"id":1,"statusCode":"200","header":null,"headerRegexp":null,"contentRegexp":"\u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d","content":null},{"id":9,"statusCode":"200","header":null,"headerRegexp":null,"contentRegexp":"\u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d","content":null},{"id":2661,"statusCode":"409","header":null,"headerRegexp":null,"contentRegexp":".*","content":null},{"id":2919,"statusCode":"404","header":null,"headerRegexp":null,"contentRegexp":".*","content":null},{"id":2922,"statusCode":"403","header":null,"headerRegexp":null,"contentRegexp":".*","content":null},{"id":2923,"statusCode":"451","header":null,"headerRegexp":null,"contentRegexp":".*","content":null},{"id":2924,"statusCode":"500","header":null,"headerRegexp":null,"contentRegexp":".*","content":null},{"id":2925,"statusCode":"502","header":null,"headerRegexp":null,"contentRegexp":".*","content":null},{"id":2926,"statusCode":"503","header":null,"headerRegexp":null,"contentRegexp":".*","content":null},{"id":2932,"statusCode":"307","header":null,"headerRegexp":null,"contentRegexp":".*","content":null},{"id":2936,"statusCode":"301","header":null,"headerRegexp":null,"contentRegexp":".*","content":null},{"id":2967,"statusCode":"302","header":null,"headerRegexp":null,"contentRegexp":".*","content":null},{"id":2968,"statusCode":"302","header":"Location","headerRegexp":"62.33.207.195","contentRegexp":null,"content":null},{"id":3228,"statusCode":"404","header":"Connection","headerRegexp":"close","contentRegexp":null,"content":null},{"id":3580,"statusCode":"307","header":"Location","headerRegexp":".*","contentRegexp":null,"content":null}]},"id":"DICK-BUTT-I386---1AE822EF40"}</code></pre></div></div>   ,    -    ¬´¬ª  ¬´¬ª,   IP-    62.33.207.195  ,    ,  -.<br>
<br>
  SSH-  ,    <b>tunnel_on</b>     ,     ,     :<br>
<pre><code>"method":"GetMyTasks","params":"","id":"DICK-BUTT-I386---1AE822EF40","session_id":1488}    

{"jsonrpc":"2.0","result":{"tasks":[{"id_task":"148411","id_task_meta":null,"type":"service","priority":"1","checklist":null,"checklist_count":"0","params":"{\"format\":1,\"command\":\"tunnel_on\",\"param1\":64123,\"param2\":60000}","status":"RUNNING","completion":"0","result":null,"pass":"0","fail":"0","passed_items":null,"failed_items":null,"id_creator":"N01-KONA-CHAN","id_lens":"DICK-BUTT-I386---1AE822EF40","ts_create":"1460000000","ts_start":"1460000000","ts_stop":null}],"params":{"DnsThreadsMax":20,"MAXfailedChecklistDownloadCount":100,"MAXfailedReportUploadCount":25,"whiteCheckMinInterval":60000,"connectTimeout":10000,"soTimeout":10000,"maxTotalConnections":50,"maxHttpsConnections":20,"maxContentSize":3000},"ts":1460000000,"zip":1,"tests":null},"id":"DICK-BUTT-I386---1AE822EF40"}</code></pre>    SSH- Dropbear,      ,    fork()  execv(),   :<br>
<pre><code>/usr/bin/ssh -y -y -K 30 -N -T -R 0.0.0.0:6412:127.0.0.1:1080 -p 22 -i /root/.ssh/id_rsa</code></pre>  <b>-y</b>    SSH- (?), <b>-N</b>  <b>-T</b>   ,  <b>-R</b>       , ..       (64123)        1080 ,     Socks5-.<br>
 ,   <b>-R</b>    <b>-D</b>,       ICMP Administratively Prohibited.<br>
 ,         .      ,        , ,   1024  65535?  ,      1000 .  ,    ,  ,   ulimit,    OpenSSH. , Socks5- , 65 SSH- ,        !<br>
  ?    -    <b>tunnel_on</b>  ,  ,     -  ,    ,     ,      .     Socks5-   , ,      ,    .<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a0f/33e/4aa/a0f33e4aa84004275667f0ed184382e2.png" alt="image"><br>
<sub>    ,       ,     !</sub><br>
<br>
<h3> </h3> API  HTTPS,    TLS-  SSH-?    4  ROM  1500‚ÇΩ  ?    Debian Oldstable   ?  84     .<br>
 ,     -   <a href="https://github.com/ValdikSS/blockcheck">Blockcheck</a>?  ‚Ä¶<br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text">            URL.<br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/18e/780/1ec/18e7801ec2e82139a35c5f49ba192ce0.png" alt="image"></div></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/282087/">https://habr.com/ru/post/282087/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282075/index.html">Week before the 5th International Mobile Conference MBLT16</a></li>
<li><a href="../282077/index.html">Chat bot development for Bitrix24</a></li>
<li><a href="../282079/index.html">Low FPS while scrolling the page. Problem solving background-attachment: fixed</a></li>
<li><a href="../282081/index.html">Mathematical model of perception (Part 1)</a></li>
<li><a href="../282085/index.html">Long archival data storage, or How to see my great-grandmother's selfie?</a></li>
<li><a href="../282089/index.html">The Basics of Developing 3D Games in Intel XDK at BabylonJS</a></li>
<li><a href="../282093/index.html">Liscript - we realize TCO</a></li>
<li><a href="../282099/index.html">Django development for Windows using Docker-machine</a></li>
<li><a href="../282103/index.html">Rake, emulator, animator (upd@21.06)</a></li>
<li><a href="../282105/index.html">Rudolf Svoren - a man of legend (the author of the book "Electronics step by step"). Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>