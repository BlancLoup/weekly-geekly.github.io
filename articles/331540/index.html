<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Static call script</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Description of the script for replacing the numbers of any operators on the site. Constructor for visual script customization. Header substitution for...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Static call script</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/web/e63/103/3a4/e631033a41f344adbd5e16d05e2294f9.jpg"></p><br><p>  Description of the script for replacing the numbers of any operators on the site.  Constructor for visual script customization.  Header substitution for different traffic sources. </p><a name="habracut"></a><br><h2 id="dlya-chego-nuzhen-skript">  What is the script for? </h2><br><p>  The script for changing phone numbers on the site helps to set up the conditions when a certain number should appear.  Numbers can be of any operators, it‚Äôs only important that you can get statistics on calls to these numbers. </p><br><p>  The script also remembers where the visitor came from.  If for the first time he came from Yandex, and then, repeatedly from the bookmarks, the phone number associated with Yandex is displayed. </p><br><p>  Suppose you need to determine how many calls from users who come from advertising Yandex Direct and articles on websites.  To track the two sources of traffic will require 3 numbers.  One number will count calls from all other sources. </p><br><p>  To do this, you need to install a script on the site that determines where the visitor came from and shows him the desired phone number. </p><br><h2 id="kak-ustanovit-i-nastroit-skript">  How to install and configure the script </h2><br><p>  <a href="">Download the script</a> and connect to the site. </p><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'/js/sipuni-calltracking.js'</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Add the CSS class ct_phone in the elements where the numbering will take place.  If the number is in the header and in the basement of the site, then for all numbers you need to add a class. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ct_phone"</span></span></span><span class="hljs-tag">&gt;</span></span>+7 888 888-88-88<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Paste the substitution code.  It can be inserted anywhere on the page, as long as it is after the elements in which the substitution occurs. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> sipuniCalltracking({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">sources</span></span></span><span class="javascript">: { </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'yadirect'</span></span></span><span class="javascript">:{</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'utm_source'</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'direct.yandex.ru'</span></span></span><span class="javascript">}, </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'articles'</span></span></span><span class="javascript">:{</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'ref'</span></span></span><span class="javascript">: </span><span class="hljs-regexp"><span class="javascript"><span class="hljs-regexp">/(habrahabr|oborot.ru)/ig</span></span></span><span class="javascript">} }, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">phones</span></span></span><span class="javascript">: [ {</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'src'</span></span></span><span class="javascript">:</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'yadirect'</span></span></span><span class="javascript">, </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'phone'</span></span></span><span class="javascript">:[</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'+74951111114'</span></span></span><span class="javascript">]}, {</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'src'</span></span></span><span class="javascript">:</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'articles'</span></span></span><span class="javascript">, </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'phone'</span></span></span><span class="javascript">:[</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'+74952222224'</span></span></span><span class="javascript">]} ], </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">pattern</span></span></span><span class="javascript">:</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'+# (###) ###-##-##'</span></span></span><span class="javascript"> }, </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  If substitution is required only in the header of the site, then the code can be inserted directly below the numbers.  In this case, the substitution of numbers is almost imperceptible. </p><br><p>  For no particular reason, I do not recommend to execute the code in the readiness event of the DOM model or in the Google Tag Manager, because the substitution of numbers becomes more noticeable. </p><br><h2 id="nastroyka-s-pomoschyu-konstruktora">  Customization using the constructor </h2><br><p>  To simplify customization, we created a <a href="https://sipuni.com/ru_RU/tools/calltracking">constructor</a> .  To work with the designer, I advise you to read the entire article in order to understand the values ‚Äã‚Äãof the parameters. </p><br><p>  In the first section, you need to create traffic sources and conditions how to determine them.  Below, you set the appropriate traffic sources and phone numbers.  Ready script at the bottom of the page. </p><br><p><img src="https://habrastorage.org/web/4cb/710/240/4cb710240a694b69a632d02b816c2014.png"></p><br><p>  In the designer there are examples of determining the sources of traffic.  They can be used as a basis, and expanded if required. </p><br><p><img width="421" src="https://habrastorage.org/web/f6a/9f2/296/f6a9f2296f3141b0939d88c8b6ef7295.png"><br></p><br><p>  When all set up ready-made code can be copied at the bottom of the page. </p><br><p><img src="https://habrastorage.org/web/ea5/522/0c0/ea55220c0e97438a99f14a7d89ba7588.png"></p><br><h2 id="nastroyka-istochnikov-trafika">  Configure traffic sources </h2><br><p>  In the sources array, traffic sources are specified. </p><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'articles'</span></span>:{<span class="hljs-string"><span class="hljs-string">'ref'</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/(habrahabr|oborot.ru)/ig</span></span>}</code> </pre> <br><p>  In this example, articles is the name of the source.  This name is used in the phones array.  The ref key means to search for the source address, and the value is a regular expression with which to execute the search. </p><br><p>  The following search locations are supported: </p><br><ul><li>  ref - the address from which the visitor came to your site. </li><li>  dst - the address of the page on which the visitor came. </li><li>  utm <em>is only a parameter starting with utm</em> . </li></ul><br><p>  In this example, utm_medium will search for the substring email. </p><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'email'</span></span>: {<span class="hljs-string"><span class="hljs-string">'utm_medium'</span></span>: <span class="hljs-string"><span class="hljs-string">'email'</span></span>}</code> </pre> <br><p>  By replacing the substring with a regular expression, you can use more complex search rules. </p><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'email'</span></span>: {<span class="hljs-string"><span class="hljs-string">'utm_medium'</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/(email|eml)/ig</span></span> }</code> </pre> <br><p>  If searching for a substring or a regular expression is not enough, it is possible to set a function.  The value of the search location is supplied to the function parameter, and the function must return true or false. </p><br><pre> <code class="javascript hljs"> <span class="hljs-string"><span class="hljs-string">'ydirect_openstat'</span></span>: {<span class="hljs-string"><span class="hljs-string">'dst'</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">subject</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> o = query.getRawParam(subject, <span class="hljs-string"><span class="hljs-string">'_openstat'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (o &amp;&amp; a2b(o).indexOf(<span class="hljs-string"><span class="hljs-string">'direct.yandex.ru'</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">-1</span></span>); } }</code> </pre> <br><p>  In this function, the _openstat parameter is unpacked from the page address and verified that it is from Yandex Direct. </p><br><h2 id="sootvetstvie-istochnikov-trafika-i-nomerov-telefona">  Matching traffic sources and phone numbers </h2><br><p>  After setting up the traffic sources, you need to set the correspondence of numbers and sources. </p><br><pre> <code class="javascript hljs">phones: [ {<span class="hljs-string"><span class="hljs-string">'src'</span></span>:<span class="hljs-string"><span class="hljs-string">'yadirect'</span></span>, <span class="hljs-string"><span class="hljs-string">'phone'</span></span>:[<span class="hljs-string"><span class="hljs-string">'+74951111114'</span></span>]}, {<span class="hljs-string"><span class="hljs-string">'src'</span></span>:<span class="hljs-string"><span class="hljs-string">'articles'</span></span>, <span class="hljs-string"><span class="hljs-string">'phone'</span></span>:[<span class="hljs-string"><span class="hljs-string">'+74952222224'</span></span>]} ],</code> </pre> <br><p>  If the site displays multiple numbers at the same time, they need to be listed in the phone array. </p><br><pre> <code class="javascript hljs">targets: [<span class="hljs-string"><span class="hljs-string">'.phone1'</span></span>, <span class="hljs-string"><span class="hljs-string">'.phone2'</span></span>], <span class="hljs-attr"><span class="hljs-attr">phones</span></span>: [ {<span class="hljs-string"><span class="hljs-string">'src'</span></span>:<span class="hljs-string"><span class="hljs-string">'yadirect'</span></span>, <span class="hljs-string"><span class="hljs-string">'phone'</span></span>:[<span class="hljs-string"><span class="hljs-string">'+74951111114'</span></span>, <span class="hljs-string"><span class="hljs-string">'+78121111114'</span></span>]}, {<span class="hljs-string"><span class="hljs-string">'src'</span></span>:<span class="hljs-string"><span class="hljs-string">'articles'</span></span>, <span class="hljs-string"><span class="hljs-string">'phone'</span></span>:[<span class="hljs-string"><span class="hljs-string">'+74952222224'</span></span>, <span class="hljs-string"><span class="hljs-string">'+78122222224'</span></span>]} ],</code> </pre> <br><p>  The targets parameter sets selectors for items in which to replace numbers.  The number of targets must match the number of phones in the phone parameter </p><br><p>  HTML will look like this: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"phone1"</span></span></span><span class="hljs-tag">&gt;</span></span>+7 495 888-88-88<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"phone2"</span></span></span><span class="hljs-tag">&gt;</span></span>+7 812 888-88-88<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  By default, targets have one selector - .ct_phone </p><br><h2 id="otobrazhenie-nomerov">  Number display </h2><br><p>  The numbers are displayed according to the pattern parameter.  By default, it is </p><br><pre> <code class="javascript hljs">+# (###) ###-##-##</code> </pre> <br><p>  Instead of # characters, numbers from numbers will be substituted. </p><br><p>  The template must be set for specific numbers.  The default template allows you to display 11-digit Russian numbers, but will not be able to correctly display the Belarusian number, because it has 12 digits. </p><br><p>  In the template, you can use HTML tags.  For example, if you want to separate the number from the city code. </p><br><pre> <code class="javascript hljs">+# (###) &lt;strong&gt;###-##-##&lt;<span class="hljs-regexp"><span class="hljs-regexp">/strong&gt;</span></span></code> </pre> <br><p>  If the pattern parameter is made empty, the number will be displayed as it is written in the phones section. </p><br><p>  If the template is not enough, the display of the number can be done using the callback function.  The function parameter is supplied with an array from the list of phones. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">substCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(p){ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'top_phone'</span></span>).innerText=someComplexModification(p.phone[<span class="hljs-number"><span class="hljs-number">0</span></span>]); } } sipuniCalltracking({ <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: substCallback, <span class="hljs-attr"><span class="hljs-attr">sources</span></span>: { ... }, <span class="hljs-attr"><span class="hljs-attr">phones</span></span>: [ {<span class="hljs-string"><span class="hljs-string">'src'</span></span>:<span class="hljs-string"><span class="hljs-string">'yadirect'</span></span>, <span class="hljs-string"><span class="hljs-string">'phone'</span></span>:[<span class="hljs-string"><span class="hljs-string">'+74951111114'</span></span>]}, {<span class="hljs-string"><span class="hljs-string">'src'</span></span>:<span class="hljs-string"><span class="hljs-string">'articles'</span></span>, <span class="hljs-string"><span class="hljs-string">'phone'</span></span>:[<span class="hljs-string"><span class="hljs-string">'+74952222224'</span></span>]} ], }, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>);</code> </pre> <br><h2 id="podmena-zagolovkov-stranicy-dlya-raznyh-istochnikov-trafika">  Substitution of page headers for different traffic sources </h2><br><p>  The script can be used to replace any page content depending on the sources of traffic. </p><br><h3 id="podmena-zagolovkov-dlya-raznyh-klyuchevyh-slov">  Header substitution for different keywords </h3><br><p>  A simple version of the substitution, when instead of phone numbers indicated by the title. </p><br><pre> <code class="javascript hljs">sipuniCalltracking({ <span class="hljs-attr"><span class="hljs-attr">pattern</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">sources</span></span>: { <span class="hljs-string"><span class="hljs-string">'yadirect_ustanovka'</span></span>:{<span class="hljs-string"><span class="hljs-string">'utm_keyword'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>}, <span class="hljs-string"><span class="hljs-string">'yadirect_rassrochka'</span></span>:{<span class="hljs-string"><span class="hljs-string">'utm_keyword'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>} }, <span class="hljs-attr"><span class="hljs-attr">phones</span></span>: [ {<span class="hljs-string"><span class="hljs-string">'src'</span></span>:<span class="hljs-string"><span class="hljs-string">'yadirect_ustanovka'</span></span>, <span class="hljs-string"><span class="hljs-string">'phone'</span></span>:[<span class="hljs-string"><span class="hljs-string">'   '</span></span>]}, {<span class="hljs-string"><span class="hljs-string">'src'</span></span>:<span class="hljs-string"><span class="hljs-string">'yadirect_rassrochka'</span></span>, <span class="hljs-string"><span class="hljs-string">'phone'</span></span>:[<span class="hljs-string"><span class="hljs-string">'   '</span></span>]} ] }, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>);</code> </pre> <br><p>  Now we need to add a CSS class in the header tag. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ct_phone"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  If the visitor came to the announcement of gas boilers with the installation, the title ‚ÄúGas boilers with installation‚Äù will appear to him.  Since the script remembers where the visitor came from for the first time, when you re-enter the site, he will still see ‚ÄúGas boilers with installation‚Äù. </p><br><p>  In the pattern parameter, we submit an empty string so that the pattern is not applied to the lines in the output. </p><br><p>  You can change the title and subtitle, and make the CSS classes clearer by setting targets. </p><br><pre> <code class="javascript hljs">pattern:<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">targets</span></span>: [<span class="hljs-string"><span class="hljs-string">'.title'</span></span>, <span class="hljs-string"><span class="hljs-string">'.subtitle'</span></span>], <span class="hljs-attr"><span class="hljs-attr">phones</span></span>: [ {<span class="hljs-string"><span class="hljs-string">'src'</span></span>:<span class="hljs-string"><span class="hljs-string">'yadirect_ustanovka'</span></span>, <span class="hljs-string"><span class="hljs-string">'phone'</span></span>:[ <span class="hljs-string"><span class="hljs-string">'   '</span></span>, <span class="hljs-string"><span class="hljs-string">'       '</span></span>]}, {<span class="hljs-string"><span class="hljs-string">'src'</span></span>:<span class="hljs-string"><span class="hljs-string">'yadirect_rassrochka'</span></span>, <span class="hljs-string"><span class="hljs-string">'phone'</span></span>:[ <span class="hljs-string"><span class="hljs-string">'   '</span></span>, <span class="hljs-string"><span class="hljs-string">'   6 '</span></span>]} ],</code> </pre> <br><p>  Mark up the CSS classes title and subtitle elements in which we change the content. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"subtitle"</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h3 id="podmena-soderzhimogo-pri-pomoschi-callback-funkcii">  Substitution of content using the callback function. </h3><br><p>  For a more complex substitution option, you can use the function.  This option will podoytet if you want to replace the image.  The dictionary from the list of phones is passed to the function or null if the source is not found. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">substCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(p){ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'header_img'</span></span>).src=p.phone[<span class="hljs-number"><span class="hljs-number">1</span></span>]; }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'header_img'</span></span>).src = <span class="hljs-string"><span class="hljs-string">'/default.png'</span></span>; } } sipuniCalltracking({ <span class="hljs-attr"><span class="hljs-attr">pattern</span></span>:<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">targets</span></span>:[<span class="hljs-string"><span class="hljs-string">'.title'</span></span>], <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: substCallback, <span class="hljs-attr"><span class="hljs-attr">sources</span></span>:{ ... }, <span class="hljs-attr"><span class="hljs-attr">phones</span></span>:[ {<span class="hljs-attr"><span class="hljs-attr">src</span></span>:<span class="hljs-string"><span class="hljs-string">'yadirect_dostavka'</span></span>, <span class="hljs-attr"><span class="hljs-attr">phone</span></span>:[<span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">'/kotel_dostavka.png'</span></span>]}, {<span class="hljs-attr"><span class="hljs-attr">src</span></span>:<span class="hljs-string"><span class="hljs-string">'yadirect_ras'</span></span>, <span class="hljs-attr"><span class="hljs-attr">phone</span></span>:[<span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">'/kotel_ras.png'</span></span>]} ] }, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>);</code> </pre> <br><h2 id="proverka-i-otladka-koda-podmeny">  Check and debug substitution code </h2><br><p>  You can check the script in jsFiddle.  In order to connect the script file use this <a href="">link</a> .  Directly jsFiddle does not allow to connect files from GitHub therefore the link is converted using <a href="https://rawgit.com/">rawgit.com</a> service </p><br><h3 id="stranica-prizemleniya-i-referrer">  Landing Page and Referrer </h3><br><p>  In normal mode, the second parameter of the script is the window object.  For debugging, use a dictionary instead, in which specify the referrer and landing page. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> wnd = { <span class="hljs-attr"><span class="hljs-attr">document</span></span>:{<span class="hljs-attr"><span class="hljs-attr">referrer</span></span>:<span class="hljs-string"><span class="hljs-string">'http://yandex.ru'</span></span>}, <span class="hljs-attr"><span class="hljs-attr">location</span></span>:{<span class="hljs-attr"><span class="hljs-attr">href</span></span>:<span class="hljs-string"><span class="hljs-string">'http://mysite.com/?utm_keyword=dostavka'</span></span>} }; sipuniCalltracking({ ‚Ä¶ }, wnd);</code> </pre> <br><h3 id="otklyuchenie-zapominaniya-istochnika-posetitelya">  Turn off remembering the source of the visitor </h3><br><p>  When debugging, it is important to disable the mechanism for storing the visitor‚Äôs source in the cookie.  To do this, add two parameters: </p><br><pre> <code class="javascript hljs">cookie_ttl_days: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">cookie_key</span></span>: <span class="hljs-string"><span class="hljs-string">'test1'</span></span>,</code> </pre> <br><h3 id="primer">  Example </h3><br><p>  Example jsFiddle to test the script: <a href="https://jsfiddle.net/xndmnydj/1/">https://jsfiddle.net/xndmnydj/1/</a> </p><br><h3 id="ne-zabyt">  Not forget </h3><br><p>  After debugging, do not forget to remove the cookie_ttl_days and cookie_key and replace the wnd parameter with the window. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Static call tracking has several advantages over dynamic: there is no shortage of numbers when traffic increases, there are no collisions when the number is shown to another person, and the previous visitor calls on it. </p><br><p>  Static call tracking is suitable for evaluating the performance of advertising channels, for example, organic, social networks, contextual advertising.  This will help the script described in the article. </p><br><p>  We created the script for our clients, but since it works with the numbers of any operators, we decided to make it open, the license is MIT. </p><br><p>  Plans to add the installation through a package manager, such as Browserify or Webpack. </p><br><p>  ‚Üí <a href="https://github.com/sipuni/static-calltracking">GitHub repository</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/331540/">https://habr.com/ru/post/331540/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331530/index.html">30+ online resources for learning programming in 2017</a></li>
<li><a href="../331532/index.html">Integration of scenario testing in the development of solutions based on the 1C platform</a></li>
<li><a href="../331534/index.html">The source code of the Windows 10 operating system has leaked to the network [small part]</a></li>
<li><a href="../331536/index.html">We transfer grades from Imhonet to the Must App</a></li>
<li><a href="../331538/index.html">Russia vs Mexico: a historic robots football game driven by fans via Twitter</a></li>
<li><a href="../331542/index.html">Guide: how to use Python for algorithmic trading on the exchange. Part 1</a></li>
<li><a href="../331544/index.html">Mikrotik: Balancing in the CPSU and the observance of speed limits</a></li>
<li><a href="../331546/index.html">Installing ArchLinux ARM next to Android without chroot</a></li>
<li><a href="../331548/index.html">Connect: Modern Frontend Tips</a></li>
<li><a href="../331552/index.html">Autoencoders in Keras, Part 3: Variational autoencoders (VAE)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>