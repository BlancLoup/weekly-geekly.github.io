<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The book "Machine learning: algorithms for business"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habrozhiteli! Marcos Lopez de Prado shares what is usually hidden — the most profitable machine learning algorithms that he used for two decades t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The book "Machine learning: algorithms for business"</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habr.com/ru/company/piter/blog/454778/"><img src="https://habrastorage.org/webt/k-/o9/ha/k-o9halv16duzlosiubpnqxjz_o.jpeg" align="left" alt="image"></a>  Hi, Habrozhiteli!  Marcos Lopez de Prado shares what is usually hidden — the most profitable machine learning algorithms that he used for two decades to manage the large pools of funds of the most demanding investors. <br><br>  Machine learning changes almost every aspect of our life, MO algorithms perform tasks that until recently trusted only proven experts.  In the near future, machine learning will dominate in finance, fortune telling on the tea leaves will be a thing of the past, and investments will no longer be synonymous with gambling. <br><br>  Take the chance to take part in the “machine revolution” to get to know the first book, which provides a complete and systematic analysis of machine learning methods applied to finance: starting with financial data structures, marking a financial series, weighing the sample, differentiating the time series ... and ending the whole part devoted to the proper backtesting of investment strategies. <br><a name="habracut"></a><br><h3>  Excerpt  Understanding risk strategy </h3><br><h3>  15.1.  Relevance </h3><br>  Investment strategies are often implemented in terms of positions held until one of two conditions is fulfilled: 1) a condition for exiting a position with profits (taking profits) or 2) a condition for exiting a position with losses (stopping a loss).  Even when the strategy does not explicitly declare a loss stop, there is always an implicit stop loss limit at which the investor can no longer finance his position (margin call) or incurs damage caused by an increase in unrealized loss.  Since most strategies have (explicitly or implicitly) these two exit conditions, it makes sense to model the distribution of outcomes through a binomial process.  This, in turn, will help us understand which combinations of frequency rates, risks, and payouts are uneconomical.  The purpose of this chapter is to help you evaluate when a strategy is vulnerable to small changes in any of these dimensions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Consider a strategy that produces n equally distributed mutually independent rates per year, where the outcome Xi of the bet i ∈ [1, n] is the profit π&gt; 0 with probability P [Xi = π] = p and loss –π with probability P [Xi = –Π] = 1 - p.  You can think of p as the accuracy of a binary classifier, in which an affirmative means a bet on an opportunity, and a negative outcome means an omission of an opportunity: true statements are rewarded, false statements are punished, and negative outcomes (true or false) do not have payments.  Since the outcomes of the bets {Xi} i = 1, ..., n are independent, we will calculate the expected moments per bet.  The expected profit from one bet is E [Xi] = πp + (–π) (1 - p) = π (2p - 1).  Dispersion is <img src="https://habrastorage.org/webt/dx/7g/bp/dx7gbpiulze7wqks_wis2xaxn8k.png" alt="image">  where <img src="https://habrastorage.org/webt/sd/dt/na/sddtna1cjrfxoqjyqdh4qxo0rke.png" alt="image">  = π2p + (–π) 2 (1 - p) = π2, therefore, V [Xi] = π2 - π2 (2p - 1) 2 = π2 [1– (2p - 1) 2] = 4π2p (1 - p ).  For n equally distributed mutually independent rates per year, the average Sharpe ratio (θ) is <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hq/xg/am/hqxgam3ao2-vx6lp7nhmzijcktc.png" alt="image"></div><br>  Notice how π balances the above equation, because the payouts are symmetrical.  As in the Gaussian case, θ [p, n] can be understood as a solo t-value1.  This illustrates the fact that even for small <img src="https://habrastorage.org/webt/zd/fr/qi/zdfrqi4neknyr9-au1fq5lthzmi.png" alt="image">  Sharpe ratio can be made high for sufficiently large n.  This serves as an economic basis for high-frequency trading, where p may be slightly higher than .5, and an increase in n is the key to successful exchange activity.  The Sharpe Ratio is a function of accuracy, and not of correctness, because omission of possibility (negative statement) is not rewarded or punished directly (although too many negative statements can lead to small n, which will reduce the Sharpe ratio to zero). <br><br>  For example, for <img src="https://habrastorage.org/webt/fm/qn/un/fmqnunukjiuc0mplffgp9jvowee.png" alt="image">  and to achieve an average Sharpe ratio of 2, 396 rates per year are required.  Listing 15.1 tests this result experimentally.  Figure 15.1 shows the Sharpe ratio as a function of accuracy for different frequency rates. <br><br>  Listing 15.1.  Sharpe Ratio as a function of the number of bets <br><br><pre><code class="plaintext hljs">out,p=[],.55 for i in xrange(1000000): rnd=np.random.binomial(n=1,p=p) x=(1 if rnd==1 else -1) out.append(x) print np.mean(out),np.std(out),np.mean(out)/np.std(out)</code> </pre> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xd/e5/wj/xde5wjijs-8bzmoplxlo9a_pmsq.png" alt="image"></div><br>  This equation clearly expresses the trade-off between accuracy (p) and frequency (n) for a given Sharpe ratio (θ).  For example, in order to give an average Sharpe coefficient of 2, a strategy that produces only weekly rates (n = 52) will require a fairly high accuracy of p = 0.6336. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4v/qt/al/4vqtalrzeh8rfu63sttrd0awg9m.png" alt="image"></div><br><h3>  15.3.  Asymmetrical payouts </h3><br>  Consider a strategy that produces n equally distributed mutually independent rates per year, where the outcome Xi of the bet i ∈ [1, n] is π + with probability P [Xi = π +] = p, and the outcome π– (π– &lt;π + ) happens with probability P [Xi = π_] = 1 - p.  The expected profit from one bet is E [Xi] = pπ + + (1 - p) π– = (π + - π–) p + π–.  The variance is V [Xi] =, where <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wv/3x/ro/wv3xrosf7epczdd-pvc6ilggw-g.png" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sn/y7/yb/sny7yb3zwt5aktefnm81ir9bkiw.png" alt="image"></div><br>  Finally, we can solve the previous equation for 0 ≤ p ≤ 1 and get <br><img src="https://habrastorage.org/webt/pi/eg/nv/piegnvmbanwxvauf0__m49h8qdk.png" alt="image"><br><br>  Where: <br>  a = (n + θ2) (π + - π–) 2; <br>  b = [2nπ - θ2 (π + - π -)] (π + - π–); <br><img src="https://habrastorage.org/webt/2w/wn/ge/2wwngeaeempudrksfpblwsktloa.png" alt="image"><br><br>  Note: Listing 15.2 tests these symbolic operations using the SymPy Live Python shell running on the Google App Engine cloud service: <a href="http://live.sympy.org/">live.sympy.org</a> . <br><br>  Listing 15.2.  Using the symPy library for symbolic operations <br><br><pre> <code class="plaintext hljs">&gt;&gt;&gt; from sympy import * &gt;&gt;&gt; init_printing(use_unicode=False,wrap_line=False,no_global=True) &gt;&gt;&gt; p,u,d=symbols('pu d') &gt;&gt;&gt; m2=p*u**2+(1-p)*d**2 &gt;&gt;&gt; m1=p*u+(1-p)*d &gt;&gt;&gt; v=m2-m1**2 &gt;&gt;&gt; factor(v)</code> </pre> <br>  The above equation answers the following question: for a given trade rule characterized by the parameters {π–, π +, n}, what is the degree of accuracy p necessary to achieve a Sharpe ratio of θ *?  For example, in order to get θ = 2 for n = 260, π– = –.01, π + = .005, we need p = .72.  Due to the large number of bets, a very small change in p (from p = .7 to p = .72) advanced the Sharpe ratio from θ = 1.173 to θ = 2. On the other hand, this also tells us that this strategy is vulnerable to small changes in p.  Listing 15.3 implements the derivation of the intended accuracy.  In fig.  15.2 shows the assumed accuracy as a function of n and π–, where π + = 0.1 and θ * = 1.5.  As the threshold π– becomes more negative for a given n, a higher degree p is required to achieve θ * for a given threshold π +.  As the number n becomes smaller for a given threshold π–, a higher degree p is required to achieve θ * for a given π +. <br><br>  Listing 15.3.  Calculate Expected Accuracy <br><br><pre> <code class="plaintext hljs">def binHR(sl,pt,freq,tSR): ´´´</code> </pre> <br>  Given a trade rule characterized by the parameters {sl, pt, freq}, what is the minimum accuracy required to achieve a Sharp coefficient equal to tSR? <br><br>  1) Inputs <br>  sl: stop loss threshold <br>  pt: profit threshold <br>  freq: number of bids per year <br>  tSR: target annual Sharpe ratio <br>  2) Exit <br>  p: minimum degree of accuracy p required to achieve tSR <br>  ´´´ <br>  a = (freq + tSR ** 2) * (pt-sl) ** 2 <br>  b = (2 * freq * sl-tSR ** 2 * (pt-sl)) * (pt-sl) <br>  c = freq * sl ** 2 <br>  p = (- b + (b ** 2–4 * a * c) **. 5) / (2. * a) <br>  return p <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sv/cp/ig/svcpiggh6er6g5pmqxarx-xhlf8.png" alt="image"></div><br>  Listing 15.4 solves θ [p, n, π–, π +] for the estimated frequency of betting n.  In fig.  15.3 shows the estimated frequency depending on p and π–, where π + = 0.1, and θ * = 1.5.  As the threshold π– becomes more negative for a given degree p, a higher number n is required to achieve θ * for a given threshold π +.  As for a given threshold π–, the degree p becomes smaller, a higher number n is required, which is necessary to achieve θ * for a given threshold π +. <br><br>  Listing 15.4.  Calculate the estimated frequency of betting <br><br><pre> <code class="plaintext hljs">def binFreq(sl,pt,p,tSR): ´´´</code> </pre> <br>  Given a trade rule characterized by the parameters {sl, pt, freq}, what number of bids per year is needed to achieve the Sharp tSR with a degree of accuracy p? <br><br>  Note: radical equation, check for extraneous solution. <br><br>  1) Inputs <br>  sl: stop loss threshold <br>  pt: profit threshold <br>  p: degree of accuracy p <br>  tSR: target annual Sharpe ratio <br>  2) Exit <br>  freq: the number of required rates per year <br>  ´´´ <br>  freq = (tSR * (pt-sl)) ** 2 * p * (1-p) / ((pt-sl) * p + sl) ** 2 # possible extraneous <br>  if not np.isclose (binSR (sl, pt, freq, p), tSR): return <br>  return freq <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ob/pi/zk/obpizkycvzwx-vebvt3l7us5mmk.png" alt="image"></div><br><br>  »More information about the book can be found on <a href="https://www.piter.com/collection/best/product/mashinnoe-obuchenie-algoritmy-dlya-biznesa">the publisher's website.</a> <br>  » <a href="https://storage.piter.com/upload/contents/978544611154/978544611154_X.pdf">Table of Contents</a> <br>  » <a href="https://storage.piter.com/upload/contents/978544611154/978544611154_p.pdf">Excerpt</a> <br><br>  For Habrozhiteley a 25% discount on coupon - <b>Machine Learning</b> <br><br>  Upon payment of the paper version of the book, an electronic version of the book is sent to the e-mail. </div><p>Source: <a href="https://habr.com/ru/post/454778/">https://habr.com/ru/post/454778/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454766/index.html">HBO, thank you for reminding me ... "Chernobyl first-aid kit" of a Belarusian pharmacist</a></li>
<li><a href="../45477/index.html">What kind of Internet startup students can come up with in one hour?</a></li>
<li><a href="../454770/index.html">Samsung Startup Membership - a new program for startups in Russia</a></li>
<li><a href="../454774/index.html">We wrote the most useful code in our life, but we threw it in the trash. Together with us</a></li>
<li><a href="../454776/index.html">Freelance or office? Freelancer Answer</a></li>
<li><a href="../45478/index.html">In a galaxy far far away VTB24</a></li>
<li><a href="../454788/index.html">Weapons of a cautious investor: we consider the fair value of investment bonds</a></li>
<li><a href="../454790/index.html">Java Native Image: use test</a></li>
<li><a href="../454792/index.html">Visualization of sorting exchanges</a></li>
<li><a href="../4548/index.html">SUP! SUP! SUP!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>