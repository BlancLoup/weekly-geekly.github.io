<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Learn OpenGL. Lesson 5.9 - Deferred Rendering</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In previous articles we used forward lighting (forward rendering or forward shading) . This is a simple approach in which we draw an object with all t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Learn OpenGL. Lesson 5.9 - Deferred Rendering</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/20f/e6a/5f3/20fe6a5f38cfacad9ea8355ca097e8f4.png" width="200" align="left"><br><p>  In previous articles we used forward lighting <em>(forward rendering or forward shading)</em> .  This is a simple approach in which we draw an object with all the light sources taken into account, then we draw the next object along with all the lights on it, and so on for each object.  It is quite simple to understand and implement, but at the same time it turns out rather slowly in terms of performance: for each object you have to go through all the sources of light.  In addition, direct lighting works inefficiently on scenes with a large number of overlapping objects, since most of the pixel shader calculations are not useful and will be overwritten with values ‚Äã‚Äãfor closer objects. </p><br><p>  Deferred lighting or deferred rendering (deferred shading or deferred rendering) bypasses this problem and drastically changes the way we draw objects.  This gives new opportunities to significantly optimize scenes with a large number of light sources, allowing you to draw hundreds or even thousands of light sources with acceptable speed.  Below is a scene from 1847 point sources of light, drawn using deferred lighting (image provided by Hannes Nevalainen).  Something similar would have been impossible with a direct calculation of the lighting: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9f2/a49/463/9f2a49463bee47aa077aa59b8dfc7ca6.png" alt="img1"></p><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Content</b> <div class="spoiler_text"><p>  Part 1. Start <br><br></p><br><ol><li>  <a href="https://habrahabr.ru/post/310790/">Opengl</a> </li><li>  <a href="https://habrahabr.ru/post/311198/">Creating a window</a> </li><li>  <a href="https://habrahabr.ru/post/311234/">Hello window</a> </li><li>  <a href="https://habrahabr.ru/post/311808/">Hello triangle</a> </li><li>  <a href="https://habrahabr.ru/post/313380/">Shaders</a> </li><li>  <a href="https://habrahabr.ru/post/315294/">Textures</a> </li><li>  <a href="https://habrahabr.ru/post/319144/">Transformations</a> </li><li>  <a href="https://habrahabr.ru/post/324968/">Coordinate systems</a> </li><li>  <a href="https://habrahabr.ru/post/327604/">Camera</a> </li></ol><br><p>  Part 2. Basic lighting <br><br></p><br><ol><li>  <a href="https://habrahabr.ru/post/329592/">Colors</a> </li><li>  <a href="https://habrahabr.ru/post/333932/">Lighting Basics</a> </li><li>  <a href="https://habrahabr.ru/post/336166/">Materials</a> </li><li>  <a href="https://habrahabr.ru/post/337550/">Texture Cards</a> </li><li>  <a href="https://habrahabr.ru/post/337642/">Sources of light</a> </li><li>  <a href="https://habrahabr.ru/post/338254/">Multiple light sources</a> </li></ol><br><p>  Part 3. Loading 3D Models 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </p><br><ol><li>  <a href="https://habrahabr.ru/post/338436/">Assimp library</a> </li><li>  <a href="https://habrahabr.ru/post/338436/">Mesh mesh class</a> </li><li>  <a href="https://habrahabr.ru/post/338998/">3D model class</a> </li></ol><br><p>  Part 4. OpenGL advanced features <br><br></p><br><ol><li>  <a href="https://habrahabr.ru/post/342610/">Depth test</a> </li><li>  <a href="https://habrahabr.ru/post/344238/">Stencil test</a> </li><li>  <a href="https://habrahabr.ru/post/343096/">Mixing colors</a> </li><li>  <a href="https://habrahabr.ru/post/346964/">Face clipping</a> </li><li>  <a href="https://habrahabr.ru/post/347354/">Frame buffer</a> </li><li>  <a href="https://habrahabr.ru/post/347750/">Cubic cards</a> </li><li>  <a href="https://habrahabr.ru/post/350008/">Advanced data handling</a> </li><li>  <a href="https://habrahabr.ru/post/350156/">Advanced GLSL</a> </li><li>  <a href="https://habrahabr.ru/post/350782/">Geometric shader</a> </li><li>  <a href="https://habrahabr.ru/post/352962/">Instancing</a> </li><li>  <a href="https://habrahabr.ru/post/351706/">Smoothing</a> </li></ol><br><p>  Part 5. Advanced Lighting <br><br></p><br><ol><li>  <a href="https://habrahabr.ru/post/353054/">Advanced lighting.</a>  <a href="https://habrahabr.ru/post/353054/">Model Blinna-Phong.</a> </li><li>  <a href="https://habrahabr.ru/post/353632/">Gamma Correction</a> </li><li>  <a href="https://habrahabr.ru/post/353956/">Shadow maps</a> </li><li>  <a href="https://habr.com/post/354208/">Omnidirectional shadow maps</a> </li><li>  <a href="https://habr.com/post/415579/">Normal mapping</a> </li><li>  <a href="https://habr.com/post/416163/">Parallax mapping</a> </li><li>  <a href="https://habr.com/post/420409/">Hdr</a> </li><li>  <a href="https://habr.com/post/420375/">Bloom</a> </li><li>  Deferred rendering </li></ol></div></div><br><p>  The idea of ‚Äã‚Äãdeferred lighting is that we set aside the most computationally complex parts (such as lighting) for later.  Deferred lighting consists of two passes: in the first pass, geometric <em>(geometry pass)</em> , the whole scene is drawn and various information is saved into a set of textures, called G-buffer.  For example: positions, colors, normals and / or specularity of the surface for each pixel.  The graphic information stored in the G-buffer is later used to calculate the illumination.  The following is the G-Buffer content for one frame: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/046/982/04a/04698204af1866fdb21330aca39484b0.png" alt="img2"></p><br><p>  In the second pass, called the lighting pass, we use G-buffer textures when we draw a full-screen rectangle.  Instead of using the vertex and fragment shaders separately for each object, we draw pixel by pixel the entire scene at once.  The lighting calculation remains exactly the same as with the direct pass, but we take the necessary data only from the G-buffer and shader variables <em>(uniforms)</em> , and not from the vertex shader. </p><br><p>  The image below shows the overall drawing process well. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2d5/a9c/f88/2d5a9cf881383e8d058c7ef1a731ce9e.png" alt="img3"></p><br><p>  The main advantage is that the information stored in the G-buffer belongs to the closest fragments that are not obscured by anything: the depth test leaves only them.  Because of this, we calculate the lighting for each pixel only once, without doing any work.  Moreover, deferred illumination gives us the opportunity for further optimizations, allowing us to use much more light sources than with direct illumination. </p><br><p>  However, there are a couple of drawbacks: the G-buffer stores a large amount of information about the scene.  In addition, position type data is required to be stored with high accuracy; as a result, the G-buffer takes up quite a lot of memory space.  Another disadvantage is that we will not be able to use translucent objects (since information is stored in the buffer only for the nearest surface) and smoothing of the MSAA type will not work either.  There are several workarounds to solve these problems, they are discussed at the end of the article. </p><br><p>  <em>(Approx. Trans. - G-buffer takes up a lot of memory space. For example, for a 1920 * 1080 screen and using 128 bits per pixel, the buffer will take 33mb. The requirements for memory bandwidth grow - much more data is written and read)</em> </p><br><h3 id="g-bufer">  G-buffer </h3><br><p>  G-Buffer is the texture used to store the lighting-related information used in the last rendering pass.  Let's see what information we need to calculate the lighting for direct rendering: </p><br><ul><li>  3d position vector: used to find out the position of a fragment relative to the camera and light sources. </li><li>  Diffuse color of the fragment (reflectivity for red, green and blue - in general, color). </li><li>  3d normal vector (to determine at what angle the light falls on the surface) </li><li>  float for storing the mirror component </li><li>  The position of the light source and its color. </li><li>  Camera position. </li></ul><br><p> With the help of these variables, we can calculate the lighting according to the Blinna-Phong model already familiar to us.  The color and position of the light source, as well as the position of the camera can be common variables, but the other values ‚Äã‚Äãwill be different for each image fragment.  If we pass exactly the same data into the final pass of deferred lighting, which we would use in the direct pass, we will get the same result, despite the fact that we will draw fragments in the usual 2D rectangle. </p><br><p>  In OpenGL, there are no restrictions on what we can store in the texture, so it makes sense to store all the information in one or more screen-sized textures (called G-Buffer) and use them all in the lighting pass.  Since the size of the textures and the screen is the same, we will get the same input data as in direct lighting. </p><br><p>  In pseudocode, the overall picture looks like this: </p><br><pre><code class="hljs ruby"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(...) /<span class="hljs-regexp"><span class="hljs-regexp">/ render loop { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 1.  :  /</span></span>    g- glBindFramebuffer(GL_FRAMEBUFFER, gBuffer); glClear(GL_COLOR_BUFFER_BIT <span class="hljs-params"><span class="hljs-params">| GL_DEPTH_BUFFER_BIT); gBufferShader.use(); </span><span class="hljs-keyword"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span><span class="hljs-params">(Object obj : Objects) { ConfigureShaderTransformsAndUniforms(); obj.Draw(); } // 2.  :  g-     glBindFramebuffer(GL_FRAMEBUFFER, 0); glClear(GL_COLOR_BUFFER_BIT); lightingPassShader.use(); BindAllGBufferTextures(); SetLightingUniforms(); RenderQuad(); }</span></span></code> </pre> <br><p>  Information that is required for each pixel: <strong>position</strong> vector, <strong>normal</strong> vector, <strong>color</strong> vector and value for the <strong>mirror</strong> component.  In the geometric passage, we draw all the objects in the scene and store all this data in a G-buffer.  We can use <em>multiple render targets (multiple render targets)</em> to fill all the buffers in a single drawing pass, such an approach was discussed in the previous article about glow implementation: <a href="https://learnopengl.com/Advanced-Lighting/Bloom%255D">Bloom</a> , <a href="https://habr.com/post/420375/">transfer to Habr√©</a> . </p><br><p>  For a geometric passage, we will create a framebuffer with the obvious name gBuffer, to which we will add several color buffers and one depth buffer.  For storing positions and normals, it is preferable to use a texture with high accuracy (16 or 32-bit float values ‚Äã‚Äãfor each component), a diffuse color and specular reflection values ‚Äã‚Äãwill be stored in the default texture (8 bits per component). </p><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> gBuffer; glGenFramebuffers(<span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;gBuffer); glBindFramebuffer(GL_FRAMEBUFFER, gBuffer); <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> gPosition, gNormal, gColorSpec; <span class="hljs-comment"><span class="hljs-comment">//   glGenTextures(1, &amp;gPosition); glBindTexture(GL_TEXTURE_2D, gPosition); glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB16F, SCR_WIDTH, SCR_HEIGHT, 0, GL_RGB, GL_FLOAT, NULL); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST); glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, gPosition, 0); //   glGenTextures(1, &amp;gNormal); glBindTexture(GL_TEXTURE_2D, gNormal); glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB16F, SCR_WIDTH, SCR_HEIGHT, 0, GL_RGB, GL_FLOAT, NULL); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST); glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT1, GL_TEXTURE_2D, gNormal, 0); //    +    glGenTextures(1, &amp;gAlbedoSpec); glBindTexture(GL_TEXTURE_2D, gAlbedoSpec); glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, SCR_WIDTH, SCR_HEIGHT, 0, GL_RGBA, GL_UNSIGNED_BYTE, NULL); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST); glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT2, GL_TEXTURE_2D, gAlbedoSpec, 0); //  OpenGL,        unsigned int attachments[3] = { GL_COLOR_ATTACHMENT0, GL_COLOR_ATTACHMENT1, GL_COLOR_ATTACHMENT2 }; glDrawBuffers(3, attachments); //           . [...]</span></span></code> </pre> <br><p>  Since we use several rendering targets, we must explicitly tell OpenGL which buffers from the GBuffer attached to which we are going to draw in <code>glDrawBuffers()</code> .  It is also worth noting that we store positions and the normals have 3 components each, and we store them in RGB textures.  But at the same time, we immediately put both the color and the coefficient of specular reflection into one RGBA texture - thanks to this, we use one less buffer.  If your implementation of deferred rendering becomes more complex and uses more data, you will easily find new ways to combine the data and arrange it in textures. </p><br><p>  In the future, we must render the data in the G-buffer.  If each object has a color, a normal and a specular reflection coefficient, we can write something like the following shader: </p><br><pre> <code class="hljs mel">#version <span class="hljs-number"><span class="hljs-number">330</span></span> core <span class="hljs-keyword"><span class="hljs-keyword">layout</span></span> (location = <span class="hljs-number"><span class="hljs-number">0</span></span>) out vec3 gPosition; <span class="hljs-keyword"><span class="hljs-keyword">layout</span></span> (location = <span class="hljs-number"><span class="hljs-number">1</span></span>) out vec3 gNormal; <span class="hljs-keyword"><span class="hljs-keyword">layout</span></span> (location = <span class="hljs-number"><span class="hljs-number">2</span></span>) out vec4 gAlbedoSpec; <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> vec2 TexCoords; <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> vec3 FragPos; <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> vec3 Normal; <span class="hljs-keyword"><span class="hljs-keyword">uniform</span></span> sampler2D texture_diffuse1; <span class="hljs-keyword"><span class="hljs-keyword">uniform</span></span> sampler2D texture_specular1; void main() { <span class="hljs-comment"><span class="hljs-comment">//       G- gPosition = FragPos; //          G- gNormal = normalize(Normal); //   gAlbedoSpec.rgb = texture(texture_diffuse1, TexCoords).rgb; //       gAlbedoSpec.a = texture(texture_specular1, TexCoords).r; }</span></span></code> </pre> <br><p>  Since we use several rendering targets, with the help of the <code>layout</code> specify what and in what buffer of the current framebuffer we render.  Please note that we do not save the mirror image coefficient in a separate buffer, since we can store the float value in the alpha channel of one of the buffers. </p><br><blockquote>  Keep in mind that when calculating lighting it is extremely important to store all variables in the same coordinate space, in this case we store (and make calculations) in the space of the world. </blockquote><p>  If we now render several nanosuits into a G-buffer and draw its contents by projecting each buffer onto a quarter of the screen, we will see something like this: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/046/982/04a/04698204af1866fdb21330aca39484b0.png" alt="img4"></p><br><p>  Try to visualize the position and normal vectors and make sure they are correct.  For example, the normal vectors pointing to the right will be red.  Similarly with objects located to the right of the center of the scene.  After you are satisfied with the contents of the G-buffer, let's move on to the next part: the lighting aisle. </p><br><h3 id="prohod-osvescheniya">  Lighting passage </h3><br><p>  Now that we have a large amount of information in the G-buffer, we are able to fully compute the lighting and the final colors for each pixel of the G-buffer, using its content as input to the algorithms for calculating the lighting.  Since the G-buffer values ‚Äã‚Äãrepresent only visible fragments, we will perform complex lighting calculations exactly once for each pixel.  Due to this, deferred lighting is quite effective, especially in complex scenes in which with direct rendering for each pixel it is often necessary to calculate the lighting several times. </p><br><p>  For the lighting pass, we are going to render a full-screen rectangle (a bit like the post-processing effect) and perform a slow calculation of the lighting for each pixel. </p><br><pre> <code class="hljs lisp">glClear(<span class="hljs-name"><span class="hljs-name">GL_COLOR_BUFFER_BIT</span></span> | GL_DEPTH_BUFFER_BIT)<span class="hljs-comment"><span class="hljs-comment">; glActiveTexture(GL_TEXTURE0); glBindTexture(GL_TEXTURE_2D, gPosition); glActiveTexture(GL_TEXTURE1); glBindTexture(GL_TEXTURE_2D, gNormal); glActiveTexture(GL_TEXTURE2); glBindTexture(GL_TEXTURE_2D, gAlbedoSpec); //         shaderLightingPass.use(); SendAllLightUniformsToShader(shaderLightingPass); shaderLightingPass.setVec3("viewPos", camera.Position); RenderQuad();</span></span></code> </pre> <br><p>  We attach <em>(bind)</em> all the necessary G-buffer textures before rendering, and in addition we set the lighting-related values ‚Äã‚Äãof the variables in the shader. </p><br><p>  The fragmentary shader of the lighting pass is very similar to the one we used in the meeting lessons.  Fundamentally new is the way we get input data for lighting directly from the G-buffer. </p><br><pre> <code class="hljs mel">#version <span class="hljs-number"><span class="hljs-number">330</span></span> core out vec4 FragColor; <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> vec2 TexCoords; <span class="hljs-keyword"><span class="hljs-keyword">uniform</span></span> sampler2D gPosition; <span class="hljs-keyword"><span class="hljs-keyword">uniform</span></span> sampler2D gNormal; <span class="hljs-keyword"><span class="hljs-keyword">uniform</span></span> sampler2D gAlbedoSpec; struct Light { vec3 Position; vec3 Color; }; const <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> NR_LIGHTS = <span class="hljs-number"><span class="hljs-number">32</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uniform</span></span> Light lights[NR_LIGHTS]; <span class="hljs-keyword"><span class="hljs-keyword">uniform</span></span> vec3 viewPos; void main() { <span class="hljs-comment"><span class="hljs-comment">//    G- vec3 FragPos = texture(gPosition, TexCoords).rgb; vec3 Normal = texture(gNormal, TexCoords).rgb; vec3 Albedo = texture(gAlbedoSpec, TexCoords).rgb; float Specular = texture(gAlbedoSpec, TexCoords).a; //     vec3 lighting = Albedo * 0.1; //    vec3 viewDir = normalize(viewPos - FragPos); for(int i = 0; i &lt; NR_LIGHTS; ++i) { //   vec3 lightDir = normalize(lights[i].Position - FragPos); vec3 diffuse = max(dot(Normal, lightDir), 0.0) * Albedo * lights[i].Color; lighting += diffuse; } FragColor = vec4(lighting, 1.0); }</span></span></code> </pre> <br><p>  The lighting shader accepts 3 textures that contain all the information recorded in the geometry pass and which the G-buffer consists of.  If we take the input data for lighting from the textures, we get exactly the same values ‚Äã‚Äãas if with normal direct rendering.  At the beginning of the fragment shader, we obtain the values ‚Äã‚Äãof the lighting variables by simply reading from the texture.  Note that we get both the color and the specular reflection coefficient from the same texture - <code>gAlbedoSpec</code> . </p><br><p>  Since for each fragment there are values ‚Äã‚Äã(as well as uniform variables of the shader) necessary for calculating the lighting according to the Blinna-Phong model, we do not need to change the code for calculating the lighting.  The only thing that was changed was a way to get input values. </p><br><p>  Running a simple demonstration with 32 small light sources looks like this: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/73d/9cf/044/73d9cf044e097e086fb317ac0c220339.png" alt="img5"></p><br><p>  One of the drawbacks of deferred lighting is the impossibility of mixing, since all g-buffers for each pixel contain information about only one surface, while mixing uses combinations of several fragments.  <a href="https://learnopengl.com/Advanced-OpenGL/Blending">(Blending)</a> <a href="https://habr.com/post/343096/">translation</a> .  Another disadvantage of deferred lighting is that it forces you to use one method of calculating lighting that is common to all objects;  although this limitation can be somehow circumvented by adding information about the material to the g-buffer. </p><br><p>  To cope with these shortcomings (especially the lack of blending), rendering is often divided into two parts: deferred lighting rendering, and the second part with direct rendering is intended for superimposing something on the stage or using shaders that are not combined with deferred lighting.  <em>(Note lane. From examples: adding translucent smoke, fire, glass)</em> To illustrate the work, we will draw light sources like small cubes by direct rendering, since the lighting cubes require a special shader (they are uniformly lit in one color). </p><br><h3 id="kombiniruem-otlozhennyy-renderig-s-pryamym">  We combine the deferred rendering with direct. </h3><br><p>  Suppose we want to draw each light source in the form of a 3d cube with the center coinciding with the position of the light source and emitting light with the color of the source.  The first idea that comes to mind is direct rendering of cubes for each light source over the results of the pending rendering.  Ie, we draw the cubes as usual, but only after deferred rendering.  The code will look something like this: </p><br><pre> <code class="hljs perl">//    [...] RenderQuad(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>          shaderLightBox.use(); shaderLightBox.setMat4(<span class="hljs-string"><span class="hljs-string">"projection"</span></span>, projection); shaderLightBox.setMat4(<span class="hljs-string"><span class="hljs-string">"view"</span></span>, view); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (unsigned <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; lightPositions.size(); i++) { model = glm::mat4(); model = glm::translate(model, lightPositions[i]); model = glm::scale(model, glm::vec3(<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">25</span></span>f)); shaderLightBox.setMat4(<span class="hljs-string"><span class="hljs-string">"model"</span></span>, model); shaderLightBox.setVec3(<span class="hljs-string"><span class="hljs-string">"lightColor"</span></span>, lightColors[i]); RenderCube(); }</code> </pre> <br><p>  These rendered cubes do not take into account the depth values ‚Äã‚Äãfrom the deferred rendering and as a result, always draws on top of the already rendered objects: this is not what we are seeking. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/e6a/59a/41b/e6a59a41b4c5ad658abae4841c9008de.png" alt="img6"></p><br><p>  First we need to copy the depth information from the geometric passage to the depth buffer, and only then draw the glowing cubes.  Thus, fragments of glowing cubes will be drawn only if they are closer than the already drawn objects. </p><br><p>  We can copy the contents of the framebuffer to another framebuffer using the <code>glBlitFramebuffer</code> function.  We have already used this function in the example with smoothing: ( <a href="https://learnopengl.com/">anti-aliasing</a> ), <a href="https://habr.com/post/351706/">translation</a> .  The <code>glBlitFramebuffer</code> function copies the user-specified part of the framebuffer to the specified part of another framebuffer. </p><br><p>  For objects drawn in the deferred aisle, we retained the depth in the g-buffer of the framebuffer object.  If we simply copy the contents of the g-buffer depth buffer to the default depth buffer, the luminous cubes will be drawn as if the entire scene geometry was drawn using a direct rendering pass.  As briefly explained in the anti-aliasing example, we need to set up framebuffers for reading and writing: </p><br><pre> <code class="hljs lisp">glBindFramebuffer(<span class="hljs-name"><span class="hljs-name">GL_READ_FRAMEBUFFER</span></span>, gBuffer)<span class="hljs-comment"><span class="hljs-comment">; glBindFramebuffer(GL_DRAW_FRAMEBUFFER, 0); //   - glBlitFramebuffer( 0, 0, SCR_WIDTH, SCR_HEIGHT, 0, 0, SCR_WIDTH, SCR_HEIGHT, GL_DEPTH_BUFFER_BIT, GL_NEAREST ); glBindFramebuffer(GL_FRAMEBUFFER, 0); //        [...]</span></span></code> </pre> <br><p>  Here we copy the entire contents of the framebuffer depth buffer into the default depth buffer (If necessary, you can copy the color buffers or the stensil buffer in the same way).  If we now render the glowing cubes, they will be drawn as if the geometry of the scene is real (although it is drawn as simple). </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ce2/92d/576/ce292d57678320f98fb946c2a28aefbb.png" alt="img7"></p><br><p>  The source code of the demo can be found <a href="https://learnopengl.com/code_viewer_gh.php%3Fcode%3Dsrc/5.advanced_lighting/8.1.deferred_shading/deferred_shading.cpp">here</a> . </p><br><p>  With this approach, we can easily combine deferred rendering with direct.  This is excellent, as we will be able to apply mixing and drawing objects that require special shaders that are not applicable when deferring rendering. </p><br><h3 id="bolshe-istochnikov-sveta">  More light sources </h3><br><p>  Delayed lighting is often praised for the ability to draw a huge number of light sources without a significant reduction in performance.  The delayed illumination in itself does not allow to draw a very large number of light sources, since we still have to count the contribution of all light sources for each pixel.  To draw a huge number of light sources, a very beautiful optimization is used, applicable to the deferred rendering - the scope of the light sources.  (light volumes) </p><br><p>  Usually, when we draw fragments in a highly illuminated scene, we take into account the contribution of <strong>each</strong> light source on the scene, regardless of its distance from the fragment.  If most of the light sources never affect the fragment, why do we spend time on calculations for them? </p><br><p>  The idea of ‚Äã‚Äãthe scope of the light source is to find the radius (or volume) of the light source - that is, the area in which the light is able to reach the surface.  Since most light sources use some kind of attenuation, we can find the maximum distance (radius) the light can reach.  After that, we perform complex calculations of illumination only for those light sources that affect this fragment.  This saves us from a huge amount of computation, since we calculate the lighting only where it is needed. </p><br><p>  With this approach, the main trick is to determine the size of the field of action of the light source. </p><br><h3 id="vychislenie-oblasti-deystviya-istochnika-sveta-radiusa">  The calculation of the scope of the light source (radius) </h3><br><p>  To obtain the radius of the light source, we must solve the attenuation equation for the brightness, which we consider dark - it can be 0.0 or something slightly more illuminated, but still dark: for example, 0.03.  To demonstrate how to calculate the radius, we will use one of the most complex, most common attenuation functions from the <a href="https://learnopengl.com/">light caster example.</a> </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="36.662ex" height="3.142ex" viewBox="0 -987.6 15784.8 1352.7" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-46" x="0" y="0"></use><g transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-69" x="298" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-67" x="644" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-68" x="1124" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="1701" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-3D" x="2479" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-66" x="3785" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="4336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="4787" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="5317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-49" x="5750" y="0"></use><g transform="translate(6255,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="1201" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2B" x="1478" y="0"></use><g transform="translate(2478,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6C" x="1201" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2217" x="3861" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="4584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2B" x="5330" y="0"></use><g transform="translate(6330,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-71" x="1201" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2217" x="7828" y="0"></use><g transform="translate(8551,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32" x="741" y="583"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> F_ {light} = \ frac {I} {K_c + K_l * d + K_q * d ^ 2} </script></p><br><p>  We want to solve this equation for the case when <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.184ex" height="2.66ex" viewBox="0 -780.1 4815.5 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-46" x="0" y="0"></use><g transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-69" x="298" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-67" x="644" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-68" x="1124" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="1701" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-3D" x="2479" y="0"></use><g transform="translate(3535,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-30" x="779" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-2"> F_ {light} = 0.0 </script>  i.e. when the light source is completely dark.  However, this equation will never reach the exact value of 0.0, so there is no solution.  However, we can instead solve the equation for brightness for a value close to 0.0, which can be considered almost dark.  In this example, we consider acceptable brightness value in <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.794ex" height="2.419ex" viewBox="0 -780.1 4217 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-36" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ frac {5} {256} </script>  - divided by 256, since the 8-bit framebuffer can contain 256 different brightness values. </p><br><blockquote>  The selected attenuation function becomes almost dark at a distance of the range, if we limit it to a lower brightness than 5/256, then the scope of the light source will become too large - this is not so effective.  Ideally, a person should not see a sudden sharp border of light from a light source.  Of course, this depends on the type of scene, a higher minimum brightness value gives smaller areas of light sources and increases the efficiency of calculations, but can lead to noticeable artifacts in the image: the lighting will be sharply cut off at the boundaries of the light source action area. </blockquote><p>  The damping equation that we need to solve becomes: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.17ex" height="2.419ex" viewBox="0 -780.1 15142.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-36" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-3D" x="4494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-66" x="5801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="6351" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="6803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="7332" y="0"></use><g transform="translate(7766,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-78" x="1408" y="0"></use></g></g><g transform="translate(9706,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-65" x="1473" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6E" x="1940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-75" x="2540" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="3113" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="3642" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-69" x="4004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="4349" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6E" x="4835" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ frac {5} {256} = \ frac {I_ {max}} {Attenuation} </script></p><br><p>  Here <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.508ex" height="2.419ex" viewBox="0 -780.1 1940.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-78" x="1408" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-5"> I_ {max} </script>  - the brightest component of the light (of the r, g, b channels).  We use the brightest component, since the other components will have a weaker limit on the scope of the light source. </p><br><p>  Continue to solve the equation: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.796ex" height="2.419ex" viewBox="0 -780.1 14981.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-36" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="4467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="4900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="5424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="5909" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-41" x="6271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="7021" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="7383" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-65" x="7744" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6E" x="8211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-75" x="8811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="9384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="9913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-69" x="10275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="10620" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6E" x="11106" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-3D" x="11984" y="0"></use><g transform="translate(13040,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-78" x="1408" y="0"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> \ frac {5} {256} \ cdot Attenuation = I_ {max} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.796ex" height="2.419ex" viewBox="0 -780.1 14981.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-65" x="1473" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6E" x="1940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-75" x="2540" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="3113" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="3642" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-69" x="4004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="4349" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6E" x="4835" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-3D" x="5713" y="0"></use><g transform="translate(6769,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-78" x="1408" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="8960" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="9393" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="9917" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="10402" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-66" x="11014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="11564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="12016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="12545" y="0"></use><g transform="translate(12979,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-36" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="14480" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> Attenuation = I_ {max} \ cdot \ frac {256} {5} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="49.456ex" height="3.142ex" viewBox="0 -987.6 21293.5 1352.7" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="1201" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2B" x="1478" y="0"></use><g transform="translate(2478,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6C" x="1201" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="3889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="4323" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="4846" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="5332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="5693" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2B" x="6439" y="0"></use><g transform="translate(7439,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-71" x="1201" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="8965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="9398" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="9922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="10407" y="0"></use><g transform="translate(10769,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32" x="741" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-3D" x="12025" y="0"></use><g transform="translate(13081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-78" x="1408" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="15272" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="15705" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="16229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="16714" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-66" x="17326" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="17876" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="18328" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="18857" y="0"></use><g transform="translate(19291,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-36" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="20792" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> K_c + K_l \ cdot d + K_q \ cdot d ^ 2 = I_ {max} \ cdot \ frac {256} {5} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="53.459ex" height="3.142ex" viewBox="0 -987.6 23016.9 1352.7" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="1201" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2B" x="1478" y="0"></use><g transform="translate(2478,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6C" x="1201" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="3889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="4323" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="4846" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="5332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="5693" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2B" x="6439" y="0"></use><g transform="translate(7439,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-71" x="1201" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="8965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="9398" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="9922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="10407" y="0"></use><g transform="translate(10769,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32" x="741" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2212" x="11969" y="0"></use><g transform="translate(12970,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-49" x="0" y="0"></use><g transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-78" x="1408" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="15161" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-64" x="15594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6F" x="16118" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="16603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-66" x="17215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="17765" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="18217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="18746" y="0"></use><g transform="translate(19180,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-36" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="20681" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-3D" x="21460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-30" x="22516" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> K_c + K_l \ cdot d + K_q \ cdot d ^ 2 - I_ {max} \ cdot \ frac {256} {5} = 0 </script></p><br><p>  The last equation is a quadratic equation in the form <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.89ex" height="2.539ex" viewBox="0 -935.7 7271.9 1093.4" role="img" focusable="false" style="vertical-align: -0.366ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32" x="809" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2B" x="1778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-62" x="2778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-78" x="3208" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2B" x="4003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="5003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-3D" x="5715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-30" x="6771" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> a x ^ 2 + b x + c = 0 </script>  with the following solution: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="58.401ex" height="3.021ex" viewBox="0 -883.9 25144.9 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-66" x="2156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="2707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="3158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="3688" y="0"></use><g transform="translate(4121,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2212" x="0" y="0"></use><g transform="translate(778,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6C" x="1201" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2B" x="2161" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-73" x="3412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-71" x="3881" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="4342" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-74" x="4793" y="0"></use><g transform="translate(5155,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32" x="1274" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6C" x="1201" y="-464"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2212" x="1577" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-34" x="2578" y="0"></use><g transform="translate(3078,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-71" x="1201" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-28" x="4354" y="0"></use><g transform="translate(4743,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="1201" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-2212" x="6221" y="0"></use><g transform="translate(7222,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-6D" x="622" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="8384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-78" x="8913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-66" x="9736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-72" x="10286" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-61" x="10738" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-63" x="11267" y="0"></use><g transform="translate(11701,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-36" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-35" x="13202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-29" x="13703" y="0"></use></g></g><g transform="translate(23369,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420565/&amp;xid=17259,1500004,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgOzVv6UToZ15YrAbqRMv0w5E_EAA#MJMATHI-71" x="1201" y="-213"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> x = \ frac {-K_l + \ sqrt {K_l ^ 2 - 4 K_q (K_c - I_max \ frac {256} {5})}} {2 K_q} </script></p><br><p>  We obtained a general equation that allows us to substitute parameters (constant attenuation coefficients, linear and quadratic) in order to find x, the radius of the source of light. </p><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> constant = <span class="hljs-number"><span class="hljs-number">1.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> linear = <span class="hljs-number"><span class="hljs-number">0.7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> quadratic = <span class="hljs-number"><span class="hljs-number">1.8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> lightMax = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::fmaxf(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::fmaxf(lightColor.r, lightColor.g), lightColor.b); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> radius = (-linear + <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::sqrtf(linear * linear - <span class="hljs-number"><span class="hljs-number">4</span></span> * quadratic * (constant - (<span class="hljs-number"><span class="hljs-number">256.0</span></span> / <span class="hljs-number"><span class="hljs-number">5.0</span></span>) * lightMax))) / (<span class="hljs-number"><span class="hljs-number">2</span></span> * quadratic);</code> </pre> <br><p>  The formula returns a radius between approximately 1.0 and 5.0, depending on the maximum brightness of the light source. </p><br><p>  We find this radius for each light source on the scene and use it in order to take into account for each fragment only those light sources within the scope of which it is located.  Below is a converted lighting passage that takes into account the areas of action of light sources.  Please note that this approach is implemented only for training purposes and is poorly suited for practical use (we will discuss why soon). </p><br><pre> <code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Light</span></span></span><span class="hljs-class"> {</span></span> [...] <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> Radius; }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ [...] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; NR_LIGHTS; ++i) { <span class="hljs-comment"><span class="hljs-comment">//         float distance = length(lights[i].Position - FragPos); if(distance &lt; lights[i].Radius) { //     [...] } } }</span></span></code> </pre> <br><p>  The result is exactly the same as before, but now for each light source, its effect is taken into account only within its area of ‚Äã‚Äãoperation. </p><br><p>  <a href="https://learnopengl.com/code_viewer_gh.php%3Fcode%3Dsrc/5.advanced_lighting/8.2.deferred_shading_volumes/deferred_shading_volumes.cpp">Final demo code.</a>  . </p><br><h3 id="realnoe-primenenie-oblasti-deystviya-istochnika-sveta">  The real application of the scope of the light source. </h3><br><p>  The fragment shader shown above will not work in practice and serves only to illustrate how we can get rid of unnecessary lighting calculations.  In reality, the video card and the GLSL shader language optimizes loops and branching very poorly.  The primary reason for this is that the execution of the shader on the video card is performed in parallel for different pixels, and many architectures impose a restriction that, when executed in parallel, different streams must compute the same shader.  Often this leads to the fact that a running shader always calculates all the branches, so that all shaders work the same time.  <em>(Taken by the lane. This does not affect the result of the calculations, but it can reduce the performance of the shader.)</em> Because of this, it may turn out that our radius check is useless: we will still calculate the lighting for all sources! </p><br><p>  A suitable approach for using the light effect area is to render the spheres with a radius as the light source.  The center of the sphere coincides with the position of the light source, so that the sphere contains within itself the scope of the light source.  There is a small trick here - we use basically the same pending fragmentary shader to draw a sphere.  When drawing a sphere, the fragment shader is called just for those pixels affected by the light source, we render only the right pixels and skip all the others.  The picture in the picture below: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/873/902/ae4/873902ae47fa7d5ae40d3db3cbc4943a.png" alt="img8"></p><br><p>       ,      .     ,   ,             .       <em>_*__</em>  <br> <em>_ + __</em> ,             . </p><br><p>       :       (    ) ,   ,       , -      (    ).         stenil . </p><br><p>          ,     ,    ,     .     (  )      :  c <em>(deferred lighting)</em>     <em>(tile-based deferred shading)</em> .                   MSAA.             . </p><br><h3 id="otlozhennyy-rendering-vs-pryamoy">   vs  </h3><br><p>   (  )  -    ,           ,                .   ,     ‚Äî   ,   MSAA,       . </p><br><p>               (  ),     (  g-  ..)        .         ,        . </p><br><p>     :   ,      ,        ,      . ,         ,      ,              .      .     parallax mapping,               ,    .       ,       . </p><br><h3 id="dopolnitelnye-ssylki">  Additional links </h3><br><ul><li> <a href="http://ogldev.atspace.co.uk/www/tutorial35/tutorial35.html">Tutorial 35: Deferred Shading ‚Äî Part 1</a> ‚Äî   OGLDev      .           . </li><li> <a href="https://software.intel.com/sites/default/files/m/d/4/1/d/8/lauritzen_deferred_shading_siggraph_2010.pdf">Deferred Rendering for Current and Future Rendering Pipelines</a> : c  Andrew Lauritzen     <em>(tile-based deferred shading)</em>   c <em>(deferred lighting)</em> . </li></ul><br><p> <strong>PS</strong>    <a href="https://t.me/joinchat/Cpb05A46UPpMWdNVVCb4Vg">-</a>   .       ,   ! </p></div><p>Source: <a href="https://habr.com/ru/post/420565/">https://habr.com/ru/post/420565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420553/index.html">Jeff Bezos and his relationship to philanthropy, philanthropy, and human projects</a></li>
<li><a href="../420555/index.html">Alan Kay: ‚ÄúComputers are instruments whose music is ideas‚Äù</a></li>
<li><a href="../420559/index.html">How IaaS comes to retail and manufacturing: who and why switched to virtual infrastructure</a></li>
<li><a href="../420561/index.html">Image reconstruction: 1 km of optical fiber, artificial neural network and deep learning</a></li>
<li><a href="../420563/index.html">Analysis of the report by Dmitry Stolyarov on monitoring Kubernetes</a></li>
<li><a href="../420567/index.html">When testing through a public method starts to stink (example)</a></li>
<li><a href="../420571/index.html">Smart Headphones - Trends 2018: Environment Filtering, Audio Trainer, Head Gestures, and Direct Connection to Alexa</a></li>
<li><a href="../420573/index.html">Android Academy: now in Moscow</a></li>
<li><a href="../420575/index.html">What to read about the sound in movies, videos and games</a></li>
<li><a href="../420577/index.html">The digest of interesting materials for the mobile developer # 266 (August 13 ‚Äî August 19)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>