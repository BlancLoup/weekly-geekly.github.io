<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Admin Generator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Briefly, the essence of the problem: you needed a lot of admins, wrote the admin generator. 



 How does it work: 


- described entities in JSON; 
-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Admin Generator</h1><div class="post__text post__text-html js-mediator-article"><p>  <b>Briefly, the essence of the problem:</b> you needed a lot of admins, wrote the admin generator. <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2a6/608/5bc/2a66085bcec694228a383e5a2e6b155d.jpg"></div><table><tbody><tr><td><p>  <b>How does it work:</b> </p><br><ul><li>  described entities in JSON; <br></li><li>  generated a database schema (PostgreSQL); <br></li><li>  generated procedures for the database; <br></li><li>  generated server (NodeJS or PHP); <br></li><li>  generated admin area (HTML file); <br></li><li>  rolled, grabbed, copied it all; <br></li><li>  you can get to work; </li></ul></td><td><p>  <b>Content:</b> <br></p><br><ul><li>  how did you come to this; <br></li><li>  why not take a ready-made solution; <br></li><li>  what happened; <br></li><li>  what did not work out; <br></li><li>  how it works; <br></li><li>  about UX; </li></ul></td></tr></tbody></table><a name="habracut"></a><h2>  How did it start </h2><br><p>  The fact is that I constantly had to impose admins for different services.  New project, new server, new admin panel.  Sometimes they were written from scratch, sometimes they were copied.  Somewhere on the 13th admin I am despondent.  I wanted to make a difference.  Therefore, a new admin panel for the statistics department was created in the style of 98 Windows.  Further, urgently, using the ‚Äúbudding‚Äù method, the admin panel of the licensing department was obtained, followed by the admin panel of the new gaming portal. <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cda/26b/add/cda26badd8749c59e4a9ca60654ba38f.png"></div><br><p>  By this point, it became clear that some components are the same in all projects.  Yes, and examples of use are also repeated: <br></p><br><ul><li>  display the list; <br></li><li>  create / edit / delete item; <br></li><li>  assign a one-to-many relationship or many-to-many; <br></li></ul><br><p></p><p>  Next, a generator was written that, using templates, created the main code base.  It is clear that all the "Wishlist" had to finish manually, but it was already a big step forward.  After another three admins, it became clear that you need to generate not only the layout, but, preferably, both the server API and the database schema.  This was not necessary in all projects, but in the fleeting ‚Äúchick chick and production‚Äù was the very thing.  Since  different admin branches received fixes of different bugs, by the end of the summer it became obvious that it would be very good to merge all the fixes into one branch and update the generator qualitatively.  This is what I began to do in the evenings and weekends. <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eb0/321/4cc/eb03214cc0ddc5a943466408ac145705.gif"></div><br><p>  <i>Scalable copy / past level of admin of the first version generator</i> </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/668/604/d15/668604d150c9ee003ed519ce31f296ca.png"></div><br><br><h2>  Are there ready admins and admin generators? </h2><br><p>  <a href="https://habrahabr.ru/post/102401/">Yes</a> , thousands of <a href="https://toster.ru/q/12337">them</a> .  What is wrong with them: <br></p><br><ul><li>  <b>Clearance for a specific language or framework</b> <b><br></b> <p>  For example, if you are using Laravel (PHP framework), you can use SleepingOwl.  But if you have a backend on Java, then you can‚Äôt tie it without PHP. <br><br></p></li><li>  <b>Solidity</b> <b><br></b> <p>  Solidity follows from the previous paragraph.  On the one hand, there can be a very cool system that dynamically changes the admin area, depending on the database schema.  On the other hand, you can not remove this link.  If you only need layout, it will hurt.  It will also be painful when you want to connect the admin panel to your authorization system (in many large offices there are single authorization systems that control access to all systems of all users from one management point). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </p></li><li>  <b>Clearance for sites</b> <b><br></b> <p>  Probably half of the admin generators collect different variations of CMS systems.  Some of them are very cool, but they are fundamentally not suitable for content management.  If you drive a database of books into them, then it will be very painful to just pick up and throw 100 books into categories. <br><br></p></li><li>  <b>Difficulty customization</b> <b><br></b> <p>  Well, this is so clear.  "You can not make a universal admin panel, each project is individual" (c). <br></p></li></ul><br><p></p><h3>  What is very much missing in the admin area: <br></h3><br><ul><li><p>  The ability to create a many-to-many relationship without switching to content editing mode.  Example: there is a list of 100 games, you need to quickly tag them.  In most admins, you need to open "game editing", put down a tag, return to the "game list". <br></p></li><li><p>  The ability to batch affixing, deleting or editing.  Example: select 15 banners and immediately assign them another promotion channel. <br><br></p></li><li><p>  No logging.  Example: we look at the content and want to immediately find out who edited it and when, and what specifically changed it. <br><br></p></li><li><p>  The ability to duplicate an object and all its records with one click.  Example: make a copy of an advertising company with all its banners and sites. <br><br></p></li><li><p>  The ability to import / export data to Excel.  Example: managers need one-time verification of content and sales in Excel, or send a list of something to partners. <br><br></p></li><li><p>  Complex search filters (by group of properties and with an exception).  Example: select all books from the ‚ÄúClassic‚Äù and ‚ÄúNovels‚Äù categories, except for those whose id: 20, 30, 65, and those who are marked with the ‚ÄúSales hit‚Äù tag.  In SQL, we will do this on the fly, and for managers in admin, filters, as a rule, will not allow such tricks. <br></p></li></ul><br><p>  I decided to fix these problems.  It is clear that in fact, if you raise the question of code generation, then the "hotele" becomes even more.  Here we need the output of statistics, which pulls the analysis of the data, and the tools to add a ‚Äúbusiness logic‚Äù to process the influence of data on each other, etc.  The topic is very extensive, but in view of the limitations of my motivation and man-hours of development, I cannot implement all the projects.  While I would like to finish at least the minimum basic functionality. </p><br><h2>  What exactly can be done? <br></h2><br><p>  Looking ahead, login / password: <i>demodemo / qwerty123456</i> and set the rights for <u>viewing</u> only (if someone breaks and the demos become useless ahead of time) </p><br><img src="https://habrastorage.org/getpro/habr/post_images/d4f/60c/1f4/d4f60c1f4c72e51b8f2a776ce42e26f6.jpg" align="left"><h5>  <b>Price</b> </h5><p>  Let's start with the simple.  Here one guy trades wholesale radio parts.  We urgently need to withdraw the price on the site with the search.  He doesn't have any 1C-warehouse.  Out, brought out: <a href="https://goo.gl/OIPQXv">https://goo.gl/OIPQXv</a> <br></p><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a35/eb4/75b/a35eb475b24f6fead7c061799889f039.png" align="left"><h5>  <b>Parody JIRA</b> </h5><p>  By tradition, JavaScript developers TODO sheet is supposed to write.  Let's write a todo list of group companies.  That there were subsidiaries, divisions, departments.  And inside the departments there are already tasks.  Tasks are scattered on employees.  Each employee has two sheets: current tasks and a queue of tasks for the future.  Akhalay-makhalay, ready: <a href="https://goo.gl/6UWqRn">https://goo.gl/6UWqRn</a> <i>(demodemo / qwerty123456)</i> <br></p><br><p>  Yes of course.  We also need comments on the tasks and so that the files can be attached.  This is the minimum set.  But this admin panel was generated in the previous version, which has not yet supported this.  The new one has already been fixed. <br></p><br><img src="https://habrastorage.org/getpro/habr/post_images/2eb/cde/287/2ebcde287704e196bcbdccf1e8304a8d.jpg" align="left"><h5>  <b>CRM</b> </h5><p>  We want our CRM.  There will be companies, their offices, and key individuals scattered around the offices.  We can look at the description of the company or the dossier on each key person with whom our manager directly conducts work (such as: client card).  Next, you need the ability to create an "event" associated with a key person (for example: a call, a letter, a meeting).  Let there be separate lists: what we have to do now, what we expect from the client, a list of jambs in our relationship.  Um ... weakly just seven objects.  Let's add separate entities with different types of clients (private, legal entities, etc.) and division by profile (carriers, tour operators, hotels, etc.).  Chik-chik, hugged: <a href="https://goo.gl/OcJU8g">https://goo.gl/OcJU8g</a> <i>(demodemo / qwerty123456)</i> <br></p><br><p>  Probably, we still need all sorts of reports, bills and a warehouse of goods, but on the one hand, I can‚Äôt even imagine how bookkeeping and warehouse work, on the other hand, maybe they should make a separate admin panel, since  These are other departments with other business processes. <br></p><br><p>  Yes, of course, we also need integration with PBX, advertising platforms, and electronic mail.  But this is not a ‚Äúchik-chik demo‚Äù in 30 minutes. </p><br><h3>  JSON at the entrance - NSI editor at the output </h3><br><p> In general, the essence of this - it is the editors of the nomenclature and reference information (NSI).  The closer your project is to the NSI editor, the more you get out of the box.  Data visualization, analytics and logic will have to be written for now. <br><br>  But even so, you can sketch a la protodim ERP-system.  Actually, the awareness of this very motivated to further action.  Further, by searching and viewing different demos, it became clear that: <br></p><br><ul><li><p>  many ERP systems of the ‚Äústart-up‚Äù level are not much superior in functionality to the ‚Äúchik-chik demo‚Äù.  But because of the kodo-generation, the ‚Äúchik-chik demo‚Äù can greatly surpass them. <br></p></li><li><p>  Many ERP systems are built on the same principle of code-generation and deployment of a heap of configs.  For example, there was such a thing ‚ÄúEtalon‚Äù, which, judging by the descriptions, was one-on-one like this bike, only under DOS.  Again - thousands of them. <br></p></li></ul><br><h3>  Why do you need it? </h3><br><p>  Suppose you write in Java, and you are constantly tormented by Angulyar.  Here you can generate admin panel and do not climb into the front.  Well, or another option - you need to create a lot of tables for your architecture (yes, yes, I know that you, Java, you can roll out a scheme from a class and vice versa - generate a class according to the database schema), but suddenly not everyone can.  Or the scheme will need to roll the architect who does not write in Java, but only works with the base.  Or you generally have a clean front and cannot master relational databases - here, at least, there will be at least some indices (although it is clear that the database schema is locked up with its ‚Äúdenormalization‚Äù, but suddenly).  Well, or your hands are burning with the desire to nag start-up ‚Äúrocket sains‚Äù, and there is no desire to engage in everyday life to create the project infrastructure. <br></p><br><h3>  Well for home projects from three tables come down.  We have a little project, a different story. <br></h3><br><p>  No :) Because  Since the code generation and admin composition are slightly less than completely from the configs, then you can deploy a project of 1000 objects.  Another question - why?  Usually there are more than 20 entities in one project - pain (there will already be from 40 to 100 tables in the database).  Therefore, large projects are divided into microservices, and microservice is already in the region of 100 tables. <br></p><br><p>  Plus, we can set separate settings for connecting to the database, not only for each entity, but also for its logs.  Consequently, ‚Äúout of the box‚Äù we can write logs in a separate database and operate with entities from different databases in the same admin panel. <br></p><br><p>  Plus, the authorization was originally made by a separate module, just because the admin panel is collected on the pipeline and there is a separate access control system (hello to fans of ESIA, OIB `Sonat` <u>%</u> , your <u>%_system_access control%</u> ). <br></p><br><h3>  A little about how it works and how much it weighs <br></h3><br><p>  First we need to describe all the entities and their connections in the form of JSON.  This is one of the most difficult stages. </p><br><div class="spoiler">  <b class="spoiler_title">Something like this</b> <div class="spoiler_text"><pre><code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"objects"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"distributionChannel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"logic"</span></span>: <span class="hljs-string"><span class="hljs-string">"DistributionChannel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logicSmall"</span></span>: <span class="hljs-string"><span class="hljs-string">"distributionChannel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"layout"</span></span>: <span class="hljs-string"><span class="hljs-string">"distribution_channel"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"properties"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"create"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>: <span class="hljs-string"><span class="hljs-string">"input"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>: <span class="hljs-string"><span class="hljs-string">"textarea"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-number"><span class="hljs-number">500</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"update"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>: <span class="hljs-string"><span class="hljs-string">"input"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>: <span class="hljs-string"><span class="hljs-string">"textarea"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-number"><span class="hljs-number">500</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"search"</span></span>: {} }, <span class="hljs-attr"><span class="hljs-attr">"visualization"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"main"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"history"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span> } } } }, ...</code> </pre> <br></div></div><br><p>  Next, run the node and create more detailed configs. </p><br> <code>node config <br></code> <br><div class="spoiler">  <b class="spoiler_title">It will turn out some big spoilers</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"objects"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"distributionChannel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"logic"</span></span>: <span class="hljs-string"><span class="hljs-string">"DistributionChannel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logicSmall"</span></span>: <span class="hljs-string"><span class="hljs-string">"distributionChannel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"layout"</span></span>: <span class="hljs-string"><span class="hljs-string">"distribution_channel"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"aside"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"create"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">" DistributionChannel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"buttons"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"popup_button"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"icon"</span></span>: <span class="hljs-string"><span class="hljs-string">"menu"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"distribution_channel_aside_create_button_popup_menu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"popup_button"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"icon"</span></span>: <span class="hljs-string"><span class="hljs-string">"search"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"distribution_channel_aside_create_button_popup_search"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"content"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"input"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>:<span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"distribution_channel_aside_create_name"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"textarea"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>:<span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"distribution_channel_aside_create_description"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"button"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"distribution_channel_aside_create_button_create"</span></span> } ] }</code> </pre><br></div></div><br><p>  We can rearrange the fields, add or cut something.  Next, we already generate the code (which, for the most part, is also configs files) </p><br><pre> <code class="hljs pgsql">node <span class="hljs-keyword"><span class="hljs-keyword">sql</span></span> node nodejs node <span class="hljs-keyword"><span class="hljs-keyword">admin</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">An example of one of the hundreds of JS files created</b> <div class="spoiler_text"><pre> <code class="hljs javascript">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-string"><span class="hljs-string">"use strict"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToggleStyleContentSearchConfig</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">common</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"content__search__processing"</span></span>, <span class="hljs-attr"><span class="hljs-attr">className</span></span>: <span class="hljs-string"><span class="hljs-string">"hidden"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"content__search__not_found"</span></span>, <span class="hljs-attr"><span class="hljs-attr">className</span></span>: <span class="hljs-string"><span class="hljs-string">"hidden"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"content__search__result"</span></span>, <span class="hljs-attr"><span class="hljs-attr">className</span></span>: <span class="hljs-string"><span class="hljs-string">"hidden"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">processing</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"content__search__processing"</span></span>, <span class="hljs-attr"><span class="hljs-attr">className</span></span>: <span class="hljs-string"><span class="hljs-string">"loading__icon search_status__loading"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">notFound</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"content__search__not_found"</span></span>, <span class="hljs-attr"><span class="hljs-attr">className</span></span>: <span class="hljs-string"><span class="hljs-string">"search_status__message"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">result</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"content__search__result"</span></span>, <span class="hljs-attr"><span class="hljs-attr">className</span></span>: <span class="hljs-string"><span class="hljs-string">"search__container__result"</span></span> } ] }; } <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = ToggleStyleContentSearchConfig; })();</code> </pre><br></div></div><br><p>  When the files are ready, we execute the generated SQL (to create a schema in the database).  Copy the server files to a separate folder.  Deploy  It remains to collect statics </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">gulp</span></span> gulp easy</code> </pre><br><p>  Statics will be collected in one HTML file, which will need to be uploaded to the server.  If everything went well, you can try to relieve the static (-40% without or -8% with gzip) </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">gulp</span></span> hard</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Few of those.</b>  <b class="spoiler_title">characteristics + principles of development, the current state of the project, plans for the future</b> <div class="spoiler_text"><p>  Some numbers: <br></p><br><ul><li>  <b>Database</b> (now PostgreSQL, I plan to add MySQL) <br><p>  1 entity = (1 table of objects + table of logs) + n * (connection table many to many + table of logs); <br></p><br><p>  1 entity = 5 procedures for an object (creating + editing + deleting + searching + getting one object) + 4 log procedures (creating + deleting + searching + getting one log) + n * procedures for links (creating + deleting + searching) + n * logs for links (create + delete + search); <br></p><br><p>  Total: (2 + n * 2) tables and (9 + (n * 3 * 3)) procedures, where n is the number of many-to-many connections <br></p><br></li><li>  <b>Server</b> (now NodeJS, I plan to add PHP) <br><p>  Only six files, since  everything went well with an instance of the same class with configs. <br></p><br></li><li>  <b>Client</b> (JS Vanilla) <br><p>  1 Entity = ~ 10 HTML files + ~ 50 JS + n * files (~ 25 files for many-to-many links) <br></p><br></li></ul><p>  <b>Total:</b> A model of 12 entities will have approximately 50 tables, 160 procedures, 1000 static files (HTML + CSS + JS).  Static after assembly and compression will weigh ~ 1 MB (all in one HTML file).  There is also a ‚Äúmiracle plugin‚Äù that can be added after the Google compiler to ~ 600kb, and after the gzip arrives at the client ~ 85kb, we <s>replace the gzip with brotli, and we boost it to 79kb</s> .  Most of the project files (from 85%) are similar configs for JSON in a wrapper.  Therefore, the project can be very flexibly set up after file generation, and very tightly compressed on the assembly <s>, and add copy / past function with search and replace by folder</s> . <br></p><br><h3>  The principles that formed the basis of the bike: <br></h3><br><ul><li><p>  Layout is a single HTML file that is not associated with the server.  The only thing that binds them is the format of AJAX requests and responses.  Want your backend - boldly replace. <br></p></li><li><p>  The backend does not know the structure of the database, but it knows the names of the stored and the arguments.  Want your database schema - write your own. <br></p></li><li><p>  Anything that can be described by configs should be described by configs.  Usually they make up more than 85% of the project files (the more entities, the greater the percentage). <br></p></li><li><p>  All files and configs should be decomposed so that the new functionality can be added to the copy / past of the desired folder.  It is clear that something will still have to fix hands in the code, but the less of these moments - the better. <br></p></li></ul><br><div class="spoiler">  <b class="spoiler_title">And then immediately: - Temples evil!</b>  <b class="spoiler_title">Only ORM !!! 11</b> <div class="spoiler_text"><p>  Not really.  This argument is appropriate, if you store business logic in storage - then yes.  But there is no business logic.  The whole essence of the store: give, create, or change the record, without any logic.  Well, logging is not through triggers, but only upon request by the server of the corresponding procedure.  The question arises: ‚ÄúWhat if we want to change the database?  Hranimki will have to be rewritten, and if through ORM it is not. ‚ÄùWell, personally, I, and none of my friends, have come across the fact that the project changes the database on the fly.  And if such a situation arises, then, most likely, ‚Äúrewriting ten patterns of generation of stored data into another subset of the SQL language‚Äù will be the least problem. <br></p><br></div></div><br><h3>  Current status of the project: <br></h3><br><ul><li><p>  in September, almost from scratch had to redo everything.  But the search became better, there were logs of objects, design, etc. <br></p></li><li><p>  In November, features and the first two services with a new base began to appear.  Left-handed mode, position changes, link log, batch processing, etc. <br></p></li><li><p>  in December, it was necessary to rewrite the server, the base and put on the front rocking up.  I thought that before the end of December I would have time to build a stable version, but I did not have time.  Here, communication with the base has become strictly through procedures, search by groups, search with exceptions, the ability to add comments, etc. <br></p></li></ul><br><div class="spoiler">  <b class="spoiler_title">Well, or something like that</b> <div class="spoiler_text"><p>  <b>Implemented by:</b> </p><br><ul><li>  create / edit / delete entity; <br></li><li>  search with filters, sorting and page output; <br></li><li>  creating / editing a simple connection between two entities; <br></li><li>  the ability to set / change position; <br></li><li>  logging the creation / editing of an entity; <br></li><li>  logging of creation / editing of a simple connection of two entities; <br></li><li>  view logs; <br></li><li>  generation of custom selects (the list of values ‚Äã‚Äãof which is sewn up and not loaded); <br></li><li>  batch add / delete links (many to many) for entities; <br></li><li>  simlink on the field to skip its creation (for date-binding, an example: one partner field, for all entities in the small panels).  referenceElementId; <br></li><li>  generation of independent entity lists; <br></li><li>  the ability to change the size of the working area; <br></li><li>  Search by id list of objects; <br></li><li>  automatic adjustment of the number of lines when searching; <br></li><li>  highlighting a search query in the search results; <br></li><li>  display mode "for left-handers"; <br></li><li>  insert search (create / edit) in a random place.  For example: comments to taske; <br></li></ul><br><p>  <b>Small bugs:</b> </p><br><ul><li>  search error: filter ref_channel_id.  It is necessary to generate LEFT JOIN requests for such searches and filters + ext.  fields in the search form; <br></li><li>  repair the output of the names of objects in the search for ref_ links (example lock, column cost); <br></li><li>  displaying server error details; <br></li><li>  file stripping + new project structure.  It is necessary to make a cleaner final sorts assembly; <br></li><li>  correct the behavior of batch object allocation; <br></li><li>  fix the calculation of the number of search string for the screen; <br></li><li>  data typing in queries; <br></li><li>  checking the file before overwriting always writes an error to the console (which in fact does not exist).  It is annoying, but not critical; <br></li></ul><br><p>  <b>Not implemented functionality:</b> </p><br><ul><li>  position change logging; <br></li><li>  display / edit nested arrays (for example: a list of translations, instead of a name or a list of payments, instead of a payment method); <br></li><li>  determining the order of loading entities; <br></li><li>  definition of related fields (autoswitch all, when changing one. For example: changing partner or promotion channel); <br></li><li>  download files on the fly; <br></li><li>  file download "list"; <br></li><li>  upload search results to CSV (export); <br></li><li>  Download results from CSV (import); <br></li><li>  copying is reverse / not reverse; <br></li><li>  add state recovery by logs (when the object state details have been opened); <br></li><li>  batch deletion of entities; <br></li><li>  description and removal of the post-compressor in a separate project; <br></li><li>  convenient generator for config as a separate application; <br></li><li>  correct logging object history.  The field is_remove make change_type (0 - created, 1 - edited, 2 - deleted) <br></li><li>  localization; <br></li><li>  adaptation for mobile phones / tablets; <br></li><li>  creating a client window; <br></li><li>  search filters as an array, not a single value (multiple ‚Äúincluding‚Äù and ‚Äúexcluding‚Äù samples); <br></li><li>  the ability to select the display screen (main / aside) for each type of operation; <br></li><li>  subfolders through the parent_id field.  There is a field - there is a folder, there is a change in the search filter; <br></li><li>  keyboard control; <br></li><li>  redo the welcome screen.  Put on it a graph of the connection of the project entities (as in the banner admin); <br></li><li>  write a seo text; <br></li><li>  connect plugin pagination scrolled; <br></li><li>  consider an authorization system for third-party projects.  Modify the authorization module (remove the Draft User); <br></li></ul><br><p>  <b>Not implemented server functionality:</b> </p><br><ul><li>  comments to the tables in the database; <br></li><li>  checking the fields in the "service" object, and not when creating the "REST API"; <br></li><li>  generation of documentation on API methods; <br></li><li>  authorization module that is not tied to Sonata; <br></li><li>  DB scheme tied to the access of Partners or with the presence of restrictions for users; <br></li><li>  PHP server generation; <br></li></ul><br></div></div><br><p>  The great advantage is that this is not a ‚Äútheoretical development‚Äù.  Each component was already in old projects or is on current ones.  Accordingly, the list of "hotelok" and the order of their implementation is dictated by the pain of exploitation <s>(well, the experience of the development of foreign admins generators)</s> . <br></p><br><h3>  What are the plans for the next month: </h3><br><ul><li><p>  <s>finally build a stable version with procedures</s> <br></p></li><li><p>  Roll to PHP, because  the server on the node in the usual shabashka not deploy.  Yes, and maintain easier and cheaper.  (Roughly speaking, for 1500 rubles. For a year it is already possible to deploy an admin panel for ~ 20 thousand records.) <br></p></li><li><p>  add work with files <br></p></li><li><p>  write a script to install out of the box, but now it takes half an hour to dig in to deploy the project <s>(and this despite the fact that I know every file in the project)</s> . <br></p></li></ul><br><br></div></div><br><h2>  About UX <br></h2><br><p>  Writing the basic functionality is pretty boring.  When I get bored, I switch to bugs and features.  Here is one of them.  There are right-side and left-side interfaces.  Those who do localization - collect two options (hello badoo).  I have + 2 more options: for left-handers and right-handers.  The difference is that the interface is not completely mirrored, but only control panels.  It is more convenient for Russian left-handed users to use mirrored control panels, but read the information in the tables from left to right.  And left-handed Arab - on the contrary, the European layout of the panels, but the reverse order of the columns in the table. <br></p><br><p>  <i>Right-handed European</i> <br></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/388/e61/1da/388e611dac1916573fc4517a2c639231.png"></div><br><p></p><br><p>  <i>Lefty Arab</i> <br></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/492/ae8/7ac/492ae87acc85a2f7107dda043745813b.png"></div><br><p></p><br><p>  <i>Left-handed european</i> <br></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a42/7a6/061/a427a606112abbb61367a27102ddd418.png"></div><br><p></p><br><p>  <i>Right handed arab</i> <br></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a23/86c/041/a2386c0412ab24358f2af879579afe70.png"></div><p></p><p>  In different projects you need a different ratio of zones "search results" and "element editing".  For example, in a book application for editing books there is a rather narrow panel on the right.  And in the game application - it is better to change the game in the central part.  It also affects the preferences of a particular manager who works with the project.  Therefore, in the new version, the ratio of the ‚Äúsearch‚Äù and ‚Äúedit‚Äù zones can be changed in the settings. <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ab/348/e23/6ab348e23a2c067c374d70cd4c57b1b6.gif"></div><br><p>  Those who work with statistics, as a rule, spend a lot of time in Excel or similar programs.  They are accustomed to strings about 16px high.  Those who work with various CMS sites and web snouts on bootstrap, are accustomed to the line height of 32px.  Therefore, the line height is also rendered in the settings. <br></p><br><p>  <a href="https://habrahabr.ru/post/143887/">There is an opinion</a> that scrolling is evil.  Why it happened - the topic of a separate article.  I agree with that.  But to specify the exact number of lines that fit on the screen is impossible, because  everyone has different monitors.  Therefore, the admin panel at startup calculates the optimal number of lines for the current settings with this monitor.  They are always exactly as much as the maximum fit on the screen without creating a vertical scroll. <br></p><br><h2>  Finally </h2><br><p>  What do you think, colleagues? </p><br><p>  Cataloger books, parts, or any other regulatory information, with a web-muzzle nobody needs? </p><br><div class="spoiler">  <b class="spoiler_title">inb4:</b> <div class="spoiler_text"><ul><li>  it was already in django <br></li><li>  Where is the link to github? <br></li><li>  on a real project does not take off! <br></li><li>  Fu, rewrite for PHP, put a minus !!! 11 <br></li><li>  where are the charts?  stata on the main - this is the base! <br></li><li>  chop configs! = code-generation <br></li><li>  everything is buggy, the product is raw <br></li><li>  The interface is incomprehensible! <br></li><li>  why not React  ªa? <br></li><li>  it happened before‚Ä¶ <br></li><li>  and where to download the installation file? <br></li><li>  no data analysis is needed! <br></li><li>  why not mongodb? <br></li><li>  LIKE is slow! <br></li><li>  and the documentation will be? <br></li><li>  Why is the test coverage zero? <br></li><li>  layout is not flexbox, kill yourself! <br></li><li>  Is there a version for mobile phones? <br></li><li>  article about anything! <br></li><li>  my layout has gone! <br></li></ul><br></div></div><p></p><p></p></div><p>Source: <a href="https://habr.com/ru/post/318332/">https://habr.com/ru/post/318332/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318322/index.html">19 unexpected finds in the Node.js documentation</a></li>
<li><a href="../318324/index.html">Personal experience: how we chose the DLP system</a></li>
<li><a href="../318326/index.html">Boring about decoding</a></li>
<li><a href="../318328/index.html">ABBYY Cloud OCR SDK subscriptions: ‚Äúshut up and take my money!‚Äù</a></li>
<li><a href="../318330/index.html">Dataset study with IMDB</a></li>
<li><a href="../318334/index.html">NancyFX framework and REST-style services</a></li>
<li><a href="../318336/index.html">Creating custom go-profiles with pprof. Remember stacks</a></li>
<li><a href="../318338/index.html">Can a company with tens of thousands of employees be Agile: MTS experience</a></li>
<li><a href="../318340/index.html">Burnout freelancer on Upwork. Causes, tools, solutions</a></li>
<li><a href="../318342/index.html">The release of the alpha version of the Internet of Things protocol stack</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>