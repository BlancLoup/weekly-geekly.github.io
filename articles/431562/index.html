<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to taxi with legacy code when the project was needed for yesterday</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hey. My name is Ivan Melnychuk, I am the Head of Development Department in the Ukrainian IT-company. In the publication I want to share personal profe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to taxi with legacy code when the project was needed for yesterday</h1><div class="post__text post__text-html js-mediator-article">  Hey.  My name is Ivan Melnychuk, I am the Head of Development Department in the Ukrainian IT-company.  In the publication I want to share personal professional approaches regarding the solution of the legacy code issue in the context of the rapid development of the project and talk about the techniques our team resorts to in cases of ‚Äúwhen features need to be handed over‚Äú for yesterday ‚Äù. <br><br><h3>  We deal with the project </h3><br>  In order to convey how accurate, thoughtful and painstaking, should be work with Legacy, I will give an analogy with the house of cards. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/e10/658/dbbe10658bed914e04ba9514627493f7.jpg" alt="image"></div><br>  This is what the outdated code looks like.  If we decide to remove or replace at least one card from this building, we risk losing the entire house and leveling its remnants with the ground. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Legacy behaves in approximately the same way.  Therefore, the work of a programmer who took on the task of modernizing and ‚Äúbreathing a second life‚Äù into a project should be in some degree a jeweler.  Most programmers try to avoid and generally ‚Äújump off the topic‚Äù of technical duty.  Even compiled a hit parade of the most common quotes that had to be heard from programmers caught up in legacy conditions: <br><a name="habracut"></a><br><ol><li>  <i>We made a ‚Äúsimple‚Äù site, and now you want to get a new ‚Äúbun‚Äù, and we need to rewrite it all, since we have a legacy ...</i> </li><li>  <i>No one knows how this works ..</i> </li><li>  <i>To add a module, you need to check the whole site - only in this way we will understand what and where can get out ...</i> </li><li>  <i>I will not go there in any case, everything is already bad there ...</i> </li></ol><br>  But programming experience shows that life exists after legacy.  After all, there is no problem in programming.  There are only tasks that need to be addressed.  And before drawing up an action plan ‚Äúto overcome the hereditary code,‚Äù you need to understand how bad things are on the project as a whole.  In the course of the practice, I identified 6 stages of the problematic project: <br><br><ol><li>  <i>No technical documentation.</i>  The lowest threshold of problematic, as you can potestit and come to preliminary guesses about how it should work. </li><li>  <i>No business documentation.</i>  If all documentation (both technical and business) is missing, the sensation ‚Äúit seems, we have got into history‚Äù involuntarily comes.  After all, even a business does not remember how this should work, which means that the team, at least, does not have an understanding of the expected result. </li><li>  <i>There is no one who developed it.</i>  If, in addition to the lack of documentation, there is also no developer who could explain how the project was supposed to work, it already smacks of fried. </li><li>  <i>We do not know what the user should receive in the end.</i>  It's one thing when questions arise only around the backend, but if we still have absolutely no idea what should be displayed at the front, then this is already close to the state of ‚Äúthe patient is more dead than alive‚Äù. </li><li>  <i>200+ usage of each function and they are called getA</i> .  The fifth level of difficulty: when you enter Legacy, you see function A and 200 usage, and no one knows why ... </li><li>  <i>There are no programmers who would like / could develop.</i>  No comments. </li></ol><br><h3>  Understand business </h3><br>  Business counts money.  A business does not want to spend additional financial resources just on reworking what is already working.  A business will never buy an idea: ‚ÄúI will do it in a new way because I don‚Äôt like it‚Äù.  Therefore, always offer more. <br><br>  Often, developers push business to useless ideas.  On this occasion, there is a separate ‚Äúfund of golden quotes‚Äù. <br><br><ul><li>  <i>We are hiring a new team for high-quality code ‚Äúcutting‚Äù.</i>  That is, we need a group of specialists who will do the project in parallel with the existing team.  Not the fact that the result will be different, but the business should already contain two projects. </li><li>  <i>Stop adding features, now only refactoring!</i>  Officially, you declare to business: An absolute taboo on features, you can only bring order under the hood.  Unofficially, you said: there will be no large-scale improvements and improvements to the project, only we will ‚Äúfix‚Äù something locally. </li><li>  <i>I already have everything I need on WP, I just need to migrate the database.</i>  This is a ‚Äúnovice‚Äù symptom.  Juna's favorite song: this is such a simple site, it only works for an hour or two ... </li></ul><br>  It is necessary to negotiate with the business regarding the reincarnation of the outdated code, which is served with the sauce of new profitable features, from the position of opening new business horizons.  However, before the negotiations you need to answer the following questions: <br><br><ol><li>  <b>Is business ready to grow?</b>  It is necessary to understand: does the business have a request for raising the financial bar, or is it just necessary for the service to work more competently. </li><li>  <b>Prototype stage?</b>  Often, a business orders a simple prototype with which it wants to ‚Äúfeel‚Äù the market at the time the product is relevant.  And only if he starts to make money, the business is ready to develop the feature into a more perfect and complete project. </li><li>  <b>Development completed and now only support?</b>  It is important to understand the full range of tasks. </li><li>  <b>Is there enough fire in our eyes and will it not go out?</b>  The project should inspire, not demotivate.  It is very important that your team wants to engage in the reincarnation of Legacy, otherwise people will gradually scatter to more interesting projects for them. </li><li>  <b>Is there an architect?</b>  This is the most important question - do you have a person who can do the right architecture and start writing already good code?  There is no point even trying to start, if there is no architect.  Otherwise, in a week you will become the one who created the problematic legacy. </li></ol><br>  When you sell ideas to business, focus on the messages ‚Äúnew, create, add‚Äù ... The business responds perfectly to the offers from the series: ‚ÄúWe will make you a new feature and at the same time project X will be faster ...‚Äù and ‚ÄúTo increase the conversion, we will add a new ... " <br><br><h3>  P - Planning </h3><br>  For quick and effective work with technical debt, you need a plan. <br><br>  1. <i>Definition of tasks on which we will parasitize.</i>  Why parasitize?  It often happens: we sold a feature, and by it we partially mean refactoring. <br><br>  2. <i>Determining high level requirements.</i>  It is necessary to prescribe a clear business request on a ‚Äúhigh standard‚Äù in order to compile the correct documentation. <br><br>  3. <i>Definition of the main modules of the system, the imposition of modules.</i>  Before starting refactoring, you need to understand the main modules of the system: where, how, what and with what can interact and delimit the code into sections. <br><br>  4. <i>Definition of integration.</i>  When creating a specific module, we must think in advance about the possibility of building it into the next legacy. <br><br>  5. <i>Definition of the team.</i>  One in the field of refactoring is not a warrior.  A team is a very important element of a successful outcome.  The enthusiasm, team drive and excellent interaction between the participants of the must have process. <br><br>  6. <i>How are we going to test?</i>  If you are going to take a quality project, then you need to think in advance and options for testing the product. <br><br>  Along with the above, it is also important to determine what the desired end result should be, draw up a scaling plan and prescribe the bottlenecks of the project.  For example, in the case of code scaling, it is important to understand where problems could potentially arise in highload conditions (this could be a database, or heavy queries, or a grid, or some other intermediate link that could ‚Äúfall‚Äù). <cut></cut><br><br>  It is equally important to define the boundaries of the project, where the old code was and where the new masterpiece will be.  You should also consider approaches on microservices, or DDD, or maybe some other ‚Äúnanomage‚Äù will be needed. <br><br><h3>  Ninja Legacy Techniques </h3><br>  After the ‚Äúpreparatory work‚Äù we approach technicians who facilitate the process of rescuing technical debt.  There is no universal recipe and panacea for all ills, but as you work on highload projects you have compiled a list of ingredients with which you can make a really ‚Äútasty‚Äù code. <br><br>  1. <b>Do not reinvent the wheel.</b>  For me, this is the main code hacking hack.  Everything is already thought up to you, you should not resort to dancing with tambourines and other experiments to solve problems with the legacy code. <br><br>  2. <b>Code standard.</b>  Without a single standard, each developer will write in his own way.  ‚ÄúAuthor's style‚Äù will contribute to chaos and increase code-trash even more. <br><br>  3. <b>Code review.</b>  There is only one presence of the code standard.  It is also necessary that the team be responsible for checking it.  Otherwise, everything will return to normal, that is, to the level of the old code. <br><br>  4. <b>Static Code analyzers, PHP mess detector detector etc (instead of thousands of books)</b> .  These and other automatic types of technology will be needed to speed up the process, in particular with the same review code. <br><br>  5. <b>We try microservices.</b>  Separately, there may also be modules or libraries.  Why microservices?  Their advantage is to maximize the isolation of logic and limit it to a specific API.  The advantage of the latter is that the API is a more monolithic entity compared to the ‚Äúadapter in the code that can be fixed‚Äù.  However, the API has one drawback in the form of additional costs for the network. <cut></cut><br><br>  6. <b>Database architecture, data sources.</b>  It is the database that is considered the first ‚Äúbottleneck‚Äù of any legacy.  But everyone designs as he wants, and even in SQL you can find non-flawed flaws.  Here are some tips for working with the new database: <br><br><ul><li>  <i>Screw nothing, thirst all.</i>  If you want to change the old wrong data structure to a new data format, faster and more productive, you can go two ways.  The first is to put a new base, completely removing the old one, and come what may.  The second is in the case of a hard legacy in parallel to introduce a new format.  Figuratively speaking, plant a new one near the old tree.  Why is the second way justified and more promising?  Because everything new will work qualitatively, and if problems arise during the deployment or at the integration stage, you can simply roll back the code, without having to roll back all complex database migrations. </li><li>  <i>A new database is created in the correct structure.</i>  When creating a new resource, it is important to control the places where we are writing a new structure.  In parallel, you need to create support for the old structure, since it is inappropriate to get rid of it completely.  That is, we continue to write new material, and at the same time we support the old template, in which we transmit everything new, and thus we allow the old to work too - as if in the old way, but supporting the new structure. </li><li>  <i>We control the whole record.</i>  Do not miss the details of the field of attention, in order to guarantee the support of the database. </li></ul><br>  7. <b>No SQL?</b>  If from an architectural point of view you can operate on entities, operate on them.  The concept of something definite and finite will help you not to create unnecessary, duplicating relaying. <cut></cut><br><br>  8. <b>Decorators, adapters, mediators ...</b> These patterns are one of the main ones for integrating the new code into the old Legacy. <br><br>  9. <b>Plan B, or rollback plan for integration.</b>  Many make the mistake of forgetting about it.  It is vital in the situation ‚Äúwhen something goes wrong‚Äù when pouring new material.  That is, as soon as we begin to build architecture, already at this stage we must understand how we will roll it back in the event of a bug. <br><br>  10. <b>New code without (docks) tests after a week becomes legacy.</b>  No matter how beautiful your code is, without documentation in a week it will be in the status of ‚Äúlegacy‚Äù - because of its incomprehensibility. <br><br>  11. <b>Testing.</b>  If unit tests are not affordable, then we use Smoke, functional and integration tests.  How realistic is it to sell unit tests to businesses under the dressing ‚Äúto make the work beautiful?‚Äù.  In our realities, this is more rare than regularity.  If for some reason it does not add up to ‚Äúunits‚Äù, then we turn to Smoke, functional or integration tests, and also do not forget that we can delegate a task, for example, to a manual tester. <br><br><h3>  Instead of an epilogue </h3><br>  The most important thing in this story is to do the work and not leave legacy after itself and 6 problem stages (listed in order from simple to more complex): <br><br><ul><li>  No technical documentation </li><li>  No business documentation </li><li>  There is no one who developed it. </li><li>  We do not know what the user should receive. </li><li>  200 + usage of each function and they are called getA () </li><li>  There is no one who would like / could develop it. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/431562/">https://habr.com/ru/post/431562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../431548/index.html">Solar Dozor - what is behind the stars?</a></li>
<li><a href="../431550/index.html">Injection Molded Films (IMD): How It Works</a></li>
<li><a href="../431554/index.html">Facebook counter from old electric meter</a></li>
<li><a href="../431556/index.html">Sidenis about working with insurance corporations, agile coaching and prohibited technologies</a></li>
<li><a href="../431560/index.html">Access to SS7 signaling networks via radio subsystem - now it is possible</a></li>
<li><a href="../431564/index.html">The greatest mistake in the history of physics</a></li>
<li><a href="../431566/index.html">MEMS accelerometers and gyroscopes - we understand the specification</a></li>
<li><a href="../431568/index.html">Fintech Digest: payment by phone number, ATMs are attacking again, institutionalization of the cryptosphere</a></li>
<li><a href="../431570/index.html">Security Study of Parking Payment Systems</a></li>
<li><a href="../431572/index.html">How to write functional requirements</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>