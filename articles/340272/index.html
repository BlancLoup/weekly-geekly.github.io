<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bypass the limitations of WEB-browsers on the engine Chromium. From one iframe we change the contents of another iframe</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 
 A small introduction to understanding ‚Äúwhy do I need this‚Äù. It so happened that the organization in which I work produces several product...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bypass the limitations of WEB-browsers on the engine Chromium. From one iframe we change the contents of another iframe</h1><div class="post__text post__text-html js-mediator-article"><h2>  Prehistory </h2><br>  A small introduction to understanding ‚Äúwhy do I need this‚Äù.  It so happened that the organization in which I work produces several products, the result of one of them is an HTML document.  Desktop products, and the HTML document has to be opened in a web browser from a local disk.  Everything would be fine if it were not for the limitations of browsers that run on the Chromium ‚Äúengine‚Äù.  In my case, in ‚Äúchrome‚Äù it is impossible to change the src of another iframe from one iframe.  Rather, this restriction can be circumvented if ‚Äúchrome‚Äù is run with the key: chrome.exe - allow-file-access-from-files.  But, unfortunately, this only works if a single copy of the ‚Äúchrome‚Äù is not loaded.  All this imposes limitations or, rather, inconvenience when working with documents. <br><a name="habracut"></a><br><h2>  Solve the problem </h2><br>  We borrow the concept of instance (instance) from OOP, for ease of description.  Here the instance will mean the window with the document, or this is the window of the main document, or the document window embedded with the iframe. <br><br>  Further I will describe how it works. <br><br>  We have 3 instances: <i>index.html</i> - main, starting, <i>center.html</i> and <i>bottom.html</i> - implemented using iframe. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In fact, our document is much more difficult, for understanding, I give an example at the end of the article. <br><br><p> <a href=""><img src="https://habrastorage.org/webt/59/e0/d0/59e0d048d1184861540516.png"></a> </p><br><p>  <b>The</b> <i>goal</i> is to dynamically control the loading of content in the <i>bottomFrame</i> from <i>centerFrame</i> , and in the <i>centerFrame</i> from <i>indexLeftPanel</i> .  Since the two embedded instances cannot do anything directly with each other, we will write a ‚Äúmessage dispatcher‚Äù in the main instance.html instance.  Those.  when the main instance is loaded, the ‚Äúregister‚Äù will be loaded (in the figure, arrow No. 1) in the embedded one and they will be able to exchange messages.  Thus, with the implemented documents, it is possible to manage other documents (arrows ‚Ññ2, 3). </p><br><p>  To begin, load <i>center.html</i> in <i>centerFrame</i> , to do this, click ‚ÄúChange HTML in center frame‚Äù. <br><br>  Everything is normal here, changing <i>centerFrame.src</i> happens in the usual way from <i>mainlayout.js</i> , loaded into <i>index.html</i> , because it happens in one instance - <i>index.html</i> : <br><br></p><pre><code class="javascript hljs">listeners: { <span class="hljs-attr"><span class="hljs-attr">click</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mainFrame = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"centerFrame"</span></span>); mainFrame.src = <span class="hljs-string"><span class="hljs-string">'layout/center.html'</span></span>; } }</code> </pre> <br>  To exchange messages between windows from different instances, you need to do a series of gestures.  Cooking <i>index.html</i> : <br><br><pre> <code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener) { <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">"message"</span></span>, listener, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.attachEvent(<span class="hljs-string"><span class="hljs-string">"onmessage"</span></span>, listener); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">listener</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sO = event.data; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sO) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sO.action == acNavigate) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> iframe = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(sO.frame); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (iframe) iframe.src = sO.source; } } } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt;</span></span></code> </pre><br>  Messages from <i>center.html</i> will be sent to the <i>function listener (event)</i> . <br><br><p>  Cooking <i>center.html</i> : <br><br></p><pre> <code class="javascript hljs">&lt;iframe id=<span class="hljs-string"><span class="hljs-string">"centerFrame"</span></span> src=<span class="hljs-string"><span class="hljs-string">""</span></span> width=<span class="hljs-string"><span class="hljs-string">"100%"</span></span> height=<span class="hljs-string"><span class="hljs-string">"100%"</span></span> frameborder=<span class="hljs-string"><span class="hljs-string">"0"</span></span> onload=<span class="hljs-string"><span class="hljs-string">"loadPage_centerFrame()"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadPage_centerFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> centerFrame = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"centerFrame"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (centerFrame) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sO = sendObject; sO.action = acInit; centerFrame.contentWindow.postMessage(sO, <span class="hljs-string"><span class="hljs-string">'*'</span></span>); } }</code> </pre><br>  This code should be executed in the instance.html instance. <br>  The <i>loadPage_centerFrame ()</i> function <i>will</i> be executed after assigning an event handler in the center.html <i>instn</i> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener) { <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">"message"</span></span>, listener, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.attachEvent(<span class="hljs-string"><span class="hljs-string">"onmessage"</span></span>, listener); }</code> </pre><br>  Due to this, the instance <i>center.html</i> will receive a link to the <i>index.html</i> window and store it in the <i>mainWindow</i> variable: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mainWindow = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">listener</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ mainWindow = event.source; }</code> </pre><br><p>  All is ready. <br><br>  Yes, the <i>sendObject</i> record is passed to the <i>loadPage_centerFrame ()</i> <i>function</i> , in fact, this record is not used in the prototype, unlike the real docks, in which this record is used to transfer service information. <br><br>  Now we <i>‚Äôll</i> load <i>bottom.html</i> into <i>bottomFrame by</i> clicking on the ‚ÄúChange HTML <i>under</i> bottom frame‚Äù <i>link</i> from <i>center.html</i> .  When you click on the link, the function from <i>crossdocmess.js is called</i> : <br><br></p><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">linkclick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">frame, link</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mainWindow) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sO = sendObject; sO.action = acNavigate; sO.frame = frame; sO.source = link; mainWindow.postMessage(sO, <span class="hljs-string"><span class="hljs-string">"*"</span></span>); } }</code> </pre><br>  Using the <i>sendObject</i> entry fields, <i>you</i> can implement various functionalities.  In this example, navigation is implemented, i.e.  we transfer to what embedded iframe what document to assign. <br><p>  <a href="https://drive.google.com/open%3Fid%3D0B0lt_f-LGoVJYmRxUjFOMGFFTk0">Working prototype</a> </p><br><p></p><div class="spoiler">  <b class="spoiler_title">Example of a real document:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/59/e0/d2/59e0d254a1c30795649857.png"></div></div></div><p>Source: <a href="https://habr.com/ru/post/340272/">https://habr.com/ru/post/340272/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340262/index.html">Recommender system on the knee as a means against existential crisis</a></li>
<li><a href="../340264/index.html">8 key decisions in development on React</a></li>
<li><a href="../340266/index.html">What you need to know the head of the IT department?</a></li>
<li><a href="../340268/index.html">The philosophy of static code analysis: we have 100 programmers, the analyzer found few errors, is it useless?</a></li>
<li><a href="../340270/index.html">The New Stack statistics about the difficulties of implementing Kubernetes</a></li>
<li><a href="../340274/index.html">Install XenForo + Memcahed + ElasticSearch on a Plesk domain and use the Elastic Stack to analyze data</a></li>
<li><a href="../340276/index.html">The problem with letters in text format</a></li>
<li><a href="../340278/index.html">Roskomnadzor checks: practical aspects</a></li>
<li><a href="../340280/index.html">Technology, sports and finance: 5 redesigns of 2017</a></li>
<li><a href="../340282/index.html">Adding records with OAuth 2: Laravel Passport + Unity. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>