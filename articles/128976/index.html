<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The build environment for the Midnight Commander project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuation 

 Few of those familiar with the words linux, * bsd do not know about Midnight Commander. I am not too mistaken if I say that everyone u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The build environment for the Midnight Commander project</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/blogs/linux/129989/">Continuation</a> <br><br>  Few of those familiar with the words linux, * bsd do not know about Midnight Commander.  I am not too mistaken if I say that everyone used it at first.  A great tool for the tasks that it solves, besides available on many platforms.  Recently, a project previously developed under the wing of gnome.org has received a second life.  <a href="http://www.midnight-commander.org/">The new project site is</a> pleased with the pace of development.  Here are just support for current versions of packages in distros lame. <br><br>  The last thing that is available in Debian is 4.7.0.9, and this despite the fact that quite recently 4.7.5.4 was released in which there are a number of goodies.  The project provided binary builds for RedHat-based systems and did not support those for Debian / Ubuntu.  I decided to fill this gap by running the automatic build environment. <br><a name="habracut"></a><br>  In the process of preparing and launching the <a href="http://blog.tataranovich.com/2011/09/midnight-commander.html">build environment</a> , it became necessary to automate some of the operations: <br><ol><li>  build a package from the GIT project Midnight Commander; </li><li>  check the availability of a new release; </li><li>  update local repository; </li><li>  update server repository. </li></ol><h5>  Build a package from GIT </h5><br>  Included in the basic functionality of the assembly environment.  Actually, everything was started up for assembling the latest changes into packages for the purpose of testing them.  On startup, it checks if there have been changes in the repository since the last successful build of the package.  If not, then the assembly stops. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If changes are found, then a test for the ability to correctly compile and run the installation is launched.  To do this, run: <br><br><pre><code class="bash hljs">./autogen.sh ./configure --prefix=/usr --sysconfdir=/etc --libexecdir=/usr/lib/mc make dist make make install DESTDIR=/tmp/mc</code> </pre> <br>  If the previous step is completed without errors, then the source package is started.  When ‚Äúmake dist‚Äù is executed, an archive of the form mc- &lt;version&gt; .tar.gz is created, which is further reduced to the form mc_ &lt;version&gt; ~ git &lt;YYYYMMDD&gt; .orig.tar.gz.  Next, the resulting archive is unpacked, the debian-specific parts are added to it, the package version is incremented and the build process starts. <br><br>  If the package build succeeds, the Debian Policy compliance check begins.  First, the package is checked in lintian (the output is saved in a separate file for quick error analysis), then in piuparts.  If the package passes the tests successfully, the build begins for the target platforms. <br><ul><li>  Debian Lenny / Squeeze (i386, amd64); </li><li>  Ubuntu Maverick / Natty (i386, amd64). </li></ul>  Build runs through pbuilder to ensure collection in a minimal environment. <br><br><h5>  Local repository update </h5><br>  Apt-ftparchive is used to manage the local repository.  After starting the update procedure, the latest builds are obtained from the build environment.  Service information is updated and Release files are signed.  To sign files in automatic mode, we had to generate a subkey for an existing one and entrust it to gpg-agent. <br><br>  This solves the problem of key leakage, which is used to sign packages - you can create a revocation key and update the primary key on the servers.  In this case, the primary secret key is missing on the server of the build environment. <br><br><h5>  Server Repository Update </h5><br>  To upload changes to the local repository to the server, use rsync.  I did not create a key for rsync ssh without a password, but I made it available via ssh-agent.  If necessary, this will block the key with one command. <br><br><h5>  Check availability of new release </h5><br>  To be aware of the release of new stable versions, uscan is configured, which, when launched with the --report key, checks the availability of new versions in <a href="http://www.midnight-commander.org/download/">www.midnight-commander.org/download</a> while skipping versions of the XXX-preY type.  If there is a positive response from uscan, the release build starts, which eventually ends up in the main branch of my repository. <br><br><h5>  At last </h5><br>  APT settings for stable versions: <br><br><pre> deb http://www.tataranovich.com/debian lenny main
 deb http://www.tataranovich.com/debian squeeze main
 deb http://www.tataranovich.com/debian maverick main
 deb http://www.tataranovich.com/debian natty main
</pre><br>  APT settings for nightly builds: <br><br><pre> deb http://www.tataranovich.com/debian lenny nightly
 deb http://www.tataranovich.com/debian squeeze nightly
 deb http://www.tataranovich.com/debian maverick nightly
 deb http://www.tataranovich.com/debian natty nightly
</pre><br>  So that the version from the nightly builds does not replace the stable release, you need to register in / etc / apt / preferences <br><br><pre>  Package: *
 Pin: release c = nightly
 Pin: origin www.tataranovich.com
 Pin-Priority: -1 </pre><br><br>  <b>UPD1:</b> To prevent APT from swearing at the inability to verify the key, before using the repository, you need to import my public key (at the same time it will float the subkey that I use to sign packages).  For example: <br><pre> <code class="bash hljs">gpg --keyserver pgp.mit.edu --recv-keys 0x2EE7EF82 gpg --<span class="hljs-built_in"><span class="hljs-built_in">export</span></span> 0x2EE7EF82 | sudo apt-key add -</code> </pre> <br>  or <br><pre> <code class="bash hljs">wget -q -O- http://www.tataranovich.com/tataranovich.asc | sudo apt-key add -</code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/128976/">https://habr.com/ru/post/128976/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128969/index.html">MRM-system BrandMaker: now in Russia</a></li>
<li><a href="../128970/index.html">HTML & CSS Aspects</a></li>
<li><a href="../128972/index.html">We receive the image from an optical sensor of a computer mouse by means of Arduino</a></li>
<li><a href="../128974/index.html">Vhdl Reconfigurable Design</a></li>
<li><a href="../128975/index.html">Actors as a special case of dataflow</a></li>
<li><a href="../128977/index.html">The site of the payment system Monety.Ru is now in a new design</a></li>
<li><a href="../128978/index.html">Happy birthday, Android!</a></li>
<li><a href="../128979/index.html">What is behind the "new buttons" Facebook?</a></li>
<li><a href="../128980/index.html">+ Calendar button; Lyrics for mp3 tag</a></li>
<li><a href="../128981/index.html">Music channel in TeamSpeak</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>