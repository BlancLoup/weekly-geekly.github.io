<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Lock on access_log, an easy way to shoot a leg or eliminate competitors</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Another example of how easy it is to shoot yourself in the leg, this time ‚Äúoverdoing‚Äù while protecting the site. 
 I don‚Äôt call names as always, but t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Lock on access_log, an easy way to shoot a leg or eliminate competitors</h1><div class="post__text post__text-html js-mediator-article">  Another example of how easy it is to shoot yourself in the leg, this time ‚Äúoverdoing‚Äù while protecting the site. <br>  I don‚Äôt call names as always, but the story is indicative as-is, i.e.  as an example, how not to "protect" their servers.  Oh, tell them, say - and all to no avail. <br><br>  It was necessary here the other day to do an ‚Äúaudit‚Äù of a commercial project ... well, they were very requested. <br>  Site traffic has fallen, not quite at all, but quite noticeable.  We looked at the logs, search engine analytics, etc.  etc.  Everything seems to be normal, and who comes, he does not even leave immediately. <br>  But I will not go around and so on - after analyzing the logs of bans over IP, one pattern emerged - in a short time a huge number of IP addresses fell into the ban.  All polls for one reason - ostensibly as botsearch.  Logged logs for the last month, too, were horrified by their size, and it was not even necessary to look in there, and so everything is clear.  Those.  The following happened: a bunch of customers just could not get to the site. <br>  The question ‚Äúsomething changed about a month ago?‚Äù Received a negative answer. <br><br>  I will not tire here with detective reading, after a brief search - oil painting.  A certain direct competitor of this site contributed to the ‚Äúleakage‚Äù of customers, or rather, and organized this ‚Äústrange non-attendance‚Äù. <br><a name="habracut"></a><br>  Description of the ‚Äúattack‚Äù scenario: <br><ul><li>  there is a popular site "mysite", where they included blocking scanning bots by access; </li><li>  another, possibly comparablely popular, site ‚Äúothersite‚Äù (for example, a direct competitor ‚Äúmysite‚Äù with the same target audience), does in some way on its page a hidden include (for example, in a hidden frame), where it calls for example the 3rd URL the ‚Äúmysite‚Äù addresses corresponding to the search filter for this lock. </li><li>  Any visit by potential customers to the ‚Äúothersite‚Äù page almost guarantees that they will not be able to get to the ‚Äúmysite‚Äù website.  Those.  N times clicking somewhere on the ‚Äúothersite‚Äù page - the user's browser makes N * 3 ‚Äúunsuccessful‚Äù calls for the ‚Äúmysite‚Äù site, which results in blocking this user's IP address (after maxretry has been reached). </li><li>  as a result, the site ‚Äúmysite‚Äù will not be available for this client (its IP address was banned) </li></ul><br>  By the way, the blocking here was carried out not by access_log, but due to high server load, directly from the web server.  In the language of nginx, a postprocessor was plugged into a location that was working on 404 and other errors, after the filtering of the IP address blocking service after filtering by certain regular expressions by URLs.  Well, type nginx-botsearch filter fail2ban, but without the tedious rasparzivaniya logs (which is often very expensive). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      However, in the same way, you can shoot yourself in the foot, for example, simply by activating some jail in fail2ban that use filters such as " <a href="">nginx-botsearch</a> ", " <a href="">apache-botsearch</a> " or many other filters set on the access-log web server in a huge the number of plying on the Internet for "protection" from bots.  Here, for example, <a href="https://github.com/fail2ban/fail2ban/pull/1070">another such filter</a> , waiting for a pull-request in fail2ban.  And there are hundreds of such descriptions and even more. <br><br>  But back to the attack itself.  What is remarkable, most likely these bad people hired someone from the blackhat-s (well, they didn‚Äôt come to it themselves) probably for hacking the competitors site.  Perhaps you needed a customer base, or were looking for a way for a better DDoS, and you never know what else.  Well, those, having discovered such a ‚Äúprotection‚Äù against a fool, have probably already sold them several URLs, or include it themselves, as a simple opportunity to ‚Äúeliminate the competitor‚Äù.  In any case, the likelihood that such a practice has not been massively adopted is different from zero. <br><br>  Speculation - speculation, but the fact of "attack" and some damage there is. <br>  Therefore, be careful and turn on the head.  Well, or call a friend supervisor ... </div><p>Source: <a href="https://habr.com/ru/post/260647/">https://habr.com/ru/post/260647/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260637/index.html">Retrospective development of Crash Bandicoot, or how the developers packed the whole game in 2MB RAM</a></li>
<li><a href="../260639/index.html">Sensors and microcontrollers. Part 3. We measure current and voltage.</a></li>
<li><a href="../260641/index.html">200 design and engineering blogs</a></li>
<li><a href="../260643/index.html">My little relays: Autowatering is magic</a></li>
<li><a href="../260645/index.html">We use SVG on the site</a></li>
<li><a href="../260649/index.html">Review of the book Design Patterns on the .NET Platform</a></li>
<li><a href="../260653/index.html">Stories about the developers: Lazybit Team, the winning team of the Russian final of the Imagine Cup 2015</a></li>
<li><a href="../260657/index.html">How to write a plugin for TiddlyWiki</a></li>
<li><a href="../260659/index.html">And again about DevOps</a></li>
<li><a href="../260661/index.html">Organizing Clean Completion of Go Applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>