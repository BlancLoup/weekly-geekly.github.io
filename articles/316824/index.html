<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The recipe for developing a bot under Telegram</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, dear readers of Habrahabr! 

 In this topic, I want to share with you the experience of developing a bot under Telegram for 4 days. Th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The recipe for developing a bot under Telegram</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/e3f/e52/29e/e3fe5229e32b49b9b296b524fd8e8ccc.png"><br><br>  Good afternoon, dear readers of Habrahabr! <br><br>  In this topic, I want to share with you the experience of developing a bot under Telegram for 4 days.  This bot translates all voice messages it receives into text.  I tried to do it quickly, but qualitatively - I learned a couple of technologies.  I will try to describe my process of overcoming mistakes and barriers in as much detail as possible;  to prove that, even without the necessary skills, to launch your product is not so difficult. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The article may be interesting to both newcomers to programming - to see how many obstacles stand in the way of the finished product, and to more advanced specialists - to laugh somewhere, cry somewhere, write a ‚Äúvital‚Äù comment somewhere. <br><br><h2>  Preamble </h2><br>  And so, what can a programmer do in 4 days? <br><a name="habracut"></a><br>  Write a module, write one screen of an iOS application, write 15% of a complex bot under Telegram, raise or lower MMR in Dota2 or rank in Overwatch.  He can spend the weekend in nature, go to the gym, swim in the pool, write 500-1000 lines of code in the application for clients who will never be used by anyone or the customer‚Äôs relatives or relatives.  You can get to the Silicon Valley for the last money, watch a couple of TV shows, meet a lot of people at one or two conferences, poke in the documentation of the Assembler. <br><br>  And what if I say that all this is complete nonsense?  What if I tell you a secret: everything is not so simple.  Time is a relative thing, you can measure it with different values ‚Äã‚Äãand coefficients;  My favorite criterion is the ratio of time to benefit.  What if I tell you that a programmer can launch a new product on the market in 4 days?  Intrigued?  - Read on. <br><br><h2>  Motivation </h2><br>  ‚ÄúOur own ivangai‚Äù was recently added to the Telegram community of programmers in our community and started wildly littering left and right with voice messages (who knows, all of a sudden it‚Äôs just hard for a guy to write with his fingers on the keyboard).  Naturally, people are tired of listening to two or three hours a day messages to get into the essence of the conversation - and then someone suggested creating a bot that would automatically translate all the voices into text.  This is exactly the moment when the eyes light up. <br><br><h2>  Voice to text translation </h2><br>  I did not know how long it would take me to develop such a bot, but I already had enough experience behind them with bots from our warm, cozy chat and an open source freelance exchange in Telegram.  Without hesitation, I sat down for development - the stage of connecting the Telegam Bot API modules went like clockwork.  What's next?  Speech recognition module - google ‚Äúvoice recognition api‚Äù and get among the first links a list of the best services.  At the head is the Google Speech API in beta - and take it. <br><br>  We receive all voice messages by a bot and somehow we direct towards Google.  But, here's a bad luck: almost all npm modules of work with this service are either outdated or do not work.  We try to use the built-in API under Node.js, written by Google experts - it works.  What is authentication?  Having tried a lot of options from the documentation from Google - which, incidentally, is also 50 to 50 is outdated or does not work - and here it is, the keys came up. <br><br>  By the way, here is the code I used: <br><br><div class="spoiler">  <b class="spoiler_title">Push me!</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Speech = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'@google-cloud/speech'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> speech = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Speech({ <span class="hljs-attr"><span class="hljs-attr">projectId</span></span>: <span class="hljs-string"><span class="hljs-string">'voicy-151205'</span></span>, <span class="hljs-attr"><span class="hljs-attr">credentials</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'path/to/certificate/file.json'</span></span>) }); speech.startRecognition(filepath, { <span class="hljs-string"><span class="hljs-string">'encoding'</span></span>: <span class="hljs-string"><span class="hljs-string">'LINEAR16'</span></span>, <span class="hljs-string"><span class="hljs-string">'sampleRate'</span></span>: <span class="hljs-number"><span class="hljs-number">16000</span></span>, <span class="hljs-string"><span class="hljs-string">'languageCode'</span></span>: <span class="hljs-string"><span class="hljs-string">'en-US'</span></span>, }) .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">results</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> operation = results[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> operation.promise(); }) .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">transcription</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(transcription[<span class="hljs-number"><span class="hljs-number">0</span></span>]); })</code> </pre> </div></div><br><h2>  Google Audio Formats and Limitations </h2><br>  What is there to send voices to Google?  Yeah, you need to get audio files from Telegram and send them to the Speech API servers - we try, it does not work.  What's the matter?  The .oga format, usual for Telegram, is not accepted - you need to decode it.  What do we have to convert media?  Of course, ffmpeg, known since early childhood (thanks to my dad, who once made me understand him a long time ago).  How to connect it to the node?  Oops!  There is an npm module sharpened specifically for this.  In which format do you need to convert .oga files?  It turned out, Google accepts .flac - we convert, try, everything is accepted, Google responds with text, success. <br><br>  But it was not there!  Google does not translate files into text longer than 60 seconds unless you upload them to the Google Cloud Storage service.  What is it?  Immediately try the module, written by Google programmers, do not even look in the direction of outdated npm ready-made solutions.  Great, files are uploaded, processed by the service, text is returned.  By the way, Google has a strange concept of time - audio files 30 seconds long, for some reason, are defined as 60 seconds.  It's okay - try a file longer than 30 seconds and step on the next rake - Google accepts long files only in the ‚ÄúLINEAR16‚Äù encoding. <br><br>  What is LINEAR16?  We are looking for in the ffmpeg documentation - there is nothing like that.  Great, how so?  We work on.  We are looking for what this format or codec is for the beast - it turns out that this is ‚Äú16 bit signed little endian‚Äù data.  It's good that I read a couple of books on Computer Science and I know what ‚Äú16 bit‚Äù is and why it is ‚Äúlittle endian‚Äù.  We are looking for what this format represents in ffmpeg - aha: ‚Äús16le‚Äù!  We try to convert - it turns out, Google accepts and responds with the text, ‚ÄúMission accomplished‚Äù. <br><br>  Caution: below is the code that helped me with the conversion (I need to preinstall ffmpeg on the machine)! <br><br><div class="spoiler">  <b class="spoiler_title">Push me!</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ffmpeg = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fluent-ffmpeg'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> temp = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'temp'</span></span>); ffmpeg.ffprobe(filepath, (err, info) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fileSize = info.format.duration; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> output = temp.path({ <span class="hljs-attr"><span class="hljs-attr">suffix</span></span>: <span class="hljs-string"><span class="hljs-string">'.flac'</span></span> }); ffmpeg() .on(<span class="hljs-string"><span class="hljs-string">'end'</span></span>, () =&gt; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(output)) .input(filepath) .setStartTime(<span class="hljs-number"><span class="hljs-number">0</span></span>) .duration(fileSize) .output(output) .audioFrequency(<span class="hljs-number"><span class="hljs-number">16000</span></span>) .toFormat(<span class="hljs-string"><span class="hljs-string">'s16le'</span></span>) .run(); });</code> </pre> </div></div><br><h2>  Monetization </h2><br>  But what is it?  What are $ 2 for using Speech API?  Are they all there in Google collapsed with oak?  How did we use more than two hours to convert voice to text?  It won't work at all - they will add my bot to 100-1000 chats, and then what should I do?  From breakfast to save on the support of the bot will not work - not the scale.  You need to somehow screw up the payment.  Let there be 600 free seconds for each chat, and then we will ask for coverage of the cost of the Google Speech API. <br><br>  How to tie payment to bot in Telegram?  Clear instructions, as well as monetization tools, have not yet been delivered to Telegram - you need to somehow resolve the issue outside.  Which payment service to use?  So-so-so, I recently read about the guy who became the youngest billionaire - he created his own payment service.  We google, we see - Stripe, and we use it.  What is it with us?  They have a convenient Checkout - but of course we will not use the standard form, we will make our own. <br><br><h2>  Frontend </h2><br>  Where to look to make interactive pages?  I am an iOS programmer, I recently plunged into server development ‚Äî so my feet were slightly rinsed ‚Äî and then the frontend arrived, what kind of attack?  We google quickly what technologies are used to create interactive sites.  Angular 2, jQuery, Vanila.js - jQuery looks the simplest, and we take it - all the more, I had fun with it once upon a time.  We google YouTube tutorials on jQuery - one treshak for 2-3 hours, we will understand along the way, tutorials and responses to Stack Overflow. <br><br>  We quickly draw the structure of the site - a logo, a form, a couple of lines of text and a button.  How to do it?  I heard something about Bootstrap.  We google, we go through a couple of lessons on Bootstrap 3 - we also google, we fasten a picture, a form, a button - it seems like, even adaptively it turned out.  We change the site's background from white to something more creative (slightly grayish), and that site is ready. <br><br>  JQuery time!  We decide to make payment in a separate project - we launch ‚Äúexpress payments‚Äù on the command line, we get the project.  Great, where do I get scripts?  Like, right on the site?  Something is wrong - indeed, you can put them in a separate file, and we will do this.  We fasten error handling to a separate label, check the Stripe form (well, they give all the necessary user interface in the Checkout module), we fasten our new project to the same database, check the payment - it passes, everything works.  Along the way, of course, due to the lack of familiar front-end developers of tools, myriad times we reload the web page manually. <br><br>  Here are the files that I got (carefully, not very clean code) with my small comments: <br><br><div class="spoiler">  <b class="spoiler_title">Push me!</b> <div class="spoiler_text"><div class="spoiler">  <b class="spoiler_title">index.hjs</b> <div class="spoiler_text"><pre> <code class="hljs django"><span class="xml"><span class="hljs-meta"><span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">head</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">title</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Voicy payments</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">title</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- Bootstrap, jQuery,    global.js,    style.css  Stripe--&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">link</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"/javascripts/global.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"https://checkout.stripe.com/checkout.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">link</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'stylesheet'</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'/stylesheets/style.css'</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">head</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- -,   id ,     --&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">img</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"/images/logo.png"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Voicy"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"center-block"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"center-block text-center"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Chat ID:</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"center-block text-center"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ chatId }}</span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text-center"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ seconds }}</span></span><span class="xml"><span class="xml"> seconds are left in this chat.</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text-center"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">You can buy more seconds below.</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text-center"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">b</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">$0.4 per 200 seconds</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">b</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"center"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!--  ‚Äî  ,    --&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"form-inline"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"buy"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"form-group"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!--,      ,     chatId   --&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"chatId"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ chatId }}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- ,   ,    --&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"number"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"form-control"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"numberOfSeconds"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Enter number of seconds"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!--  ‚Äî info, error  success,       global.js--&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">small</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"infoLabel"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"form-text text-info"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">small</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">small</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"errorLabel"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"form-text text-danger"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">small</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">small</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"successLabel"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"form-text text-success"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">small</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"btn btn-primary center-block"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"buyButton"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Buy</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">global.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    $(document).ready(function() { //   ‚Äî  ,    var chatId; var amount; //    Stripe Checkout var handler = StripeCheckout.configure({ key: '***', image: 'https://pay.voicybot.com/images/stripe.png', locale: 'auto', // alipay: true, // ,  - AliPay // bitcoin: true, //     ‚Äî     US   closed: function() { //  ,  info,   stripe $("#successLabel").empty(); $("#errorLabel").empty(); }, token: function(token) { //    ,   token        //    (,   ‚Äî     ) $("#infoLabel").empty(); $("#successLabel").empty(); $("#errorLabel").empty(); //  ,    $("#infoLabel").append('Processing payment on Voicy servers...'); //   ,    index.js $.ajax({ type: 'POST', url: 'buy', data: { 'token': token.id, 'chatId': chatId, 'amount': amount }, dataType: 'json', encode: true }) .done(function(data) { //  :   ‚Äî   "";  ‚Äî   if (data['error']) { $("#infoLabel").empty(); $("#successLabel").empty(); $("#errorLabel").empty(); $("#errorLabel").append(data['error']); } else { $("#infoLabel").empty(); $("#successLabel").empty(); $("#errorLabel").empty(); $("#successLabel").append('Thank you for the payment!'); } }); } }); //  Stripe,    ,    window.addEventListener('popstate', function() { $("#infoLabel").empty(); $("#successLabel").empty(); $("#errorLabel").empty(); handler.close(); }); //   ‚Äî      "Buy" $('form').submit(function(event) { event.preventDefault(); //      var seconds = $('input[name=numberOfSeconds]').val(); //      chatId = $('input[name=chatId]').val(); //  chat id    //    ‚Äî     200 ,   if (!seconds || seconds &lt; 200) { $("#infoLabel").empty(); $("#successLabel").empty(); $("#errorLabel").empty(); $("#errorLabel").append('Please purchase at least 200 seconds'); } else { //    ‚Äî    ... var purch = seconds * 0.002 * 100; amount = seconds; $("#infoLabel").empty(); $("#successLabel").empty(); $("#errorLabel").empty(); $("#infoLabel").append('Please pay at Stripe Checkout'); // ...    Stripe handler.open({ name: 'Voicy Bot', description: 'Purchasing ' + seconds + ' seconds', currency: 'USD', amount: purch, // alipay: true, // bitcoin: true }); } }); });</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">index.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Express router     HTTP   jQuery const express = require('express'); const router = express.Router(); // db ‚Äî  ,          const db = require('../helpers/db'); // Stripe ‚Äî       const stripe = require("stripe")("***"); /**   */ router.post('/buy', (req, res, next) =&gt; { //  token  stripe,      const token = req.body.token; //  id ,     const chatId = parseInt(req.body.chatId); // ,    const amount = parseInt(req.body.amount); var charge = stripe.charges.create({ amount: amount * 0.002 * 100, //     source: token, currency: "USD", description: "Buying seconds for Voicy" }, (err, charge) =&gt; { if (err) { res.send({ error: err.message }); //     jQuery } else { db.findChat(chatId) //     id .then((chat) =&gt; { // ,   "" chat.seconds = parseInt(chat.seconds) + amount; //     return chat.save() //   .then((newChat) =&gt; { res.send({ success: true }); //  ""   jQuery }); }) .catch((err) =&gt; { res.send({ error: err.message }); //     jQuery }) } }); }); /*    */ router.get('/:id', (req, res, next) =&gt; { const chatId = parseInt(req.params.id); // id ,     db.findChat(chatId) //    id .then((chat) =&gt; { //  ?   404! if (!chat) { const err = new Error(); err.status = 404; err.message = 'No chat found'; throw err; } // ?    ! return chat; }) .then((chat) =&gt; { //   ,       id  res.render('index', { chatId: chat.id, seconds: chat.seconds, }); }) .catch(err =&gt; next(err)); //      (     ) });</span></span></code> </pre></div></div></div></div><br><h2>  Main website </h2><br>  Any good project needs a good website - but I don‚Äôt really want to spend money on hosting.  We buy a domain name and send it directly to GitHub Pages, the benefit, with this experience is enough from previous open source projects.  We take the standard template, fill it with the necessary data, slightly modify the index.html - that's it. <br><br><h2>  Nginx and SSL </h2><br>  But how will users trust me if the form of payment is not available via https?  Do not worry - swam, we know!  We start CertBot on the server, we receive the necessary SSL certificates.  So far, the application is available on pay. * Domain * .com: 3000 - it's useless to send users here.  We configure Nginx to redirect all requests from http to https and hang the proxy from port 80 to 3000 - check, go to the site, work. <br><br>  If anyone is interested, here is the nginx configuration file: <br><br><div class="spoiler">  <b class="spoiler_title">Push me!</b> <div class="spoiler_text"><pre> <code class="nginx hljs"><span class="hljs-comment"><span class="hljs-comment"># HTTP -     HTTPS: server { listen 80; listen [::]:80 default_server ipv6only=on; return 301 https://$host$request_uri; } # HTTPS -      Node.js : server { listen 443; server_name your_domain_name; ssl on; #    Lets Encrypt: ssl_certificate /etc/letsencrypt/live/pay.voicybot.com/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/pay.voicybot.com/privkey.pem; ssl_session_timeout 5m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_prefer_server_ciphers on; ssl_ciphers '***'; #     localhost:3001: location / { proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-NginX-Proxy true; proxy_pass http://localhost:3000/; proxy_ssl_session_reuse off; proxy_set_header Host $http_host; proxy_cache_bypass $http_upgrade; proxy_redirect off; } }</span></span></code> </pre> </div></div><br><h2>  Conclusion </h2><br>  My story ended abruptly, as everything turned out to be ready: one server receives all voice messages and translates them into text, the second is responsible for safely paying for the processing time of the voices, and GitHub distributes the project‚Äôs main website.  The main thing that I wanted to describe in this article is that the process of creating a product, although laborious, can fit in 40-80 hours thanks to the already existing tools on the Internet. <br><br>  Let me remind you that this small project includes: <br><br><ul><li>  Google's neural network that converts voice to text </li><li>  A good website, created in the absence of any design or front-end skills </li><li>  A smart payment tool that, by the way, works in all browsers and even with AliPay and Bitcoins </li><li>  The database of chat and users, on which you can always look statistics </li><li>  Convert audio files between different formats </li><li>  Complex server with SSL, with two raised complex applications </li><li>  The absence of any human factor: everything works automatically </li></ul><br>  If you still think that you do not have enough skills to create your own product - look around, everything has already been done for you.  Unlike the same 2000, today the creation of a product does not require a deep knowledge of algorithms and data structures.  What are you waiting for? <br><br><h2>  Thanks </h2><br>  Thank you so much for reading to the end!  I will be happy to answer all comments on the article.  I do not attach the link to the bot itself (although it is fully working), since this is against the rules of Habrahabr. <br><br><h2>  Rock on. </h2></div><p>Source: <a href="https://habr.com/ru/post/316824/">https://habr.com/ru/post/316824/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316814/index.html">The most necessary program in the world</a></li>
<li><a href="../316816/index.html">Chaos and gremlins: testing web interfaces</a></li>
<li><a href="../316818/index.html">Electrode is an open source platform from WalmartLabs for ReactJS / NodeJS applications.</a></li>
<li><a href="../316820/index.html">A small survey of hosting (~ 100) on the service VDS</a></li>
<li><a href="../316822/index.html">Automated recovery of MS SQL databases from backups</a></li>
<li><a href="../316826/index.html">Jupyter Notebook features that you may not have heard of</a></li>
<li><a href="../316828/index.html">Building compact collimators for high power LEDs</a></li>
<li><a href="../316830/index.html">ISUII AmigaVirtual - universal AI for everyone</a></li>
<li><a href="../316832/index.html">Demo cloud access to Ultimate 2C</a></li>
<li><a href="../316834/index.html">Tips for Indie Developers: The Dark Triad and Five Tips with Top ROI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>