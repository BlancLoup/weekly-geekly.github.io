<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Support for Advanced Format - optimal work with high-capacity disks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Advanced Format is a new hard disk layout format needed to address large amounts of disk space. All manufacturers of modern hard drives, including HGS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Support for Advanced Format - optimal work with high-capacity disks</h1><div class="post__text post__text-html js-mediator-article">  Advanced Format is a new hard disk layout format needed to address large amounts of disk space.  All manufacturers of modern hard drives, including HGST, are switching to this format. <br>  One of the main features of Advanced Format is an increase in the size of the sector from 512 to 4096 bytes.  To maintain compatibility with programs designed for the old format, new disks have an emulation mode called ‚Äú512e‚Äù. <br>  Most modern operating systems support Advanced Format.  In order to achieve optimal I / O performance, it is necessary that the disk partitioning be carried out correctly, and that data is recorded in 4-kilobyte blocks by both the operating system and application programs.  The latest operating systems by default fulfill all the conditions necessary for effective work with Advanced Format.  When using older software, special utilities may be required to adjust the disk subsystem for optimal performance. <br><a name="habracut"></a><br>  Advanced Format Device <br>  In the middle of Figure 1, eight consecutive 512-byte sectors are depicted.  In addition to user data, each sector contains service information: markup data and an error correction code.  When replacing eight 512-byte sectors with one 4-kilobyte one, the amount of required overhead information is reduced (see the bottom of the figure).  Thus, when working with large files (and the average file size has increased compared to the times when the 512-byte format was used, the disk space is used more efficiently).  In addition, more space is allocated to the error correction code, which ensures better data integrity. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a48/b8e/3aa/a48b8e3aa0a22f0f93c1efadf041a5b4.jpg" width="952" height="597"><br>  Fig.  1. Comparison of 512-byte and 4-kilobyte formats (1). <br><br>  Compatibility <br>  A significant part of the operating hardware and software are designed for a sector size of 512 bytes and expect data to be sent in 512-byte blocks.  Emulation of this exchange is implemented in new disks at the interface level.  When a request is made to read a block, the disk reads the entire sector (which does not take much time) and transfers only the necessary block to the program.  If the program receives a request to write a block, the disk reads a whole sector, puts the received block into it and overwrites the entire sector (see Fig. 2).  Time elapses between reading and writing, and the disk can complete several revolutions during this time. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/b24/37d/412/b2437d412df90ed77cf13f23b0c72fa0.jpg" width="1024" height="369"><br>  Fig.  2. In emulation mode, when writing a 512-byte block, the disk first reads a sector, puts a block into it, and then writes a sector <br><br>  Providing speed <br>  To achieve the highest performance, it is necessary that the recording format on the disc matches the format of the disc.  In the ideal case, the recording should be performed in 4-kilobyte blocks and each block should be written to one sector.  This condition is satisfied if both the operating system and application programs are configured to work with 4-kilobyte blocks, and the disk partitioning is performed correctly. <br>  Most modern operating systems use file systems in which disk space is allocated 4-kilobyte blocks, or clusters.  The 4-kilobyte block corresponds to eight 512-byte sectors (see Fig. 3). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f96/5f5/2c7/f965f52c7b3f3e4621d956f35e9315d0.jpg" width="1024" height="126"><br>  Fig.  3. Cluster correspondence to sector in emulation mode. <br><br>  Alignment of section boundaries <br>  When using operating systems that write data to 4-kilobyte clusters (most modern operating systems), it is important that their borders be aligned with the sector boundaries of the disk.  In emulation mode, the 512e disk cannot prevent a partition from being placed from a block whose number is not a multiple of eight.  If this happens, one cluster will be located in two sectors (see Fig. 4).  Thus, when reading or writing a 4-kilobyte cluster, you will need to respectively read or write 8 kilobytes - twice as much.  And if when reading the difference in speed is not large, then when writing, it will be noticeable. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f27/735/aff/f27735aff0ba7c7e24562612a3792c58.jpg" width="1024" height="115"><br>  Fig.  4. Placement of the cluster is not from the beginning of the sector. <br><br>  Operating systems supporting Advanced Format <br>  In the following operating systems, the cluster size is 4 KB, and during installation the disk partitioning is performed correctly: <br>  ‚Ä¢ Microsoft Windows Vista SP1 and newer; <br>  ‚Ä¢ Microsoft Windows 7; <br>  ‚Ä¢ Microsoft Server 2008; <br>  ‚Ä¢ Mac OS X 10.4 and newer; <br>  ‚Ä¢ Linux Ubuntu 8.04+, SUSE, Linux kernel 2.6.34+ (you must use the Linux Partitioning Utility). <br><br>  Operating systems that do not automatically match clusters to sectors: <br>  ‚Ä¢ Microsoft Windows XP; <br>  ‚Ä¢ Microsoft Server 2003; <br>  ‚Ä¢ Microsoft Windows Home Server V1. <br><br>  HGST Align Tool <br>  You can use the HGST utility for Windows to correct the logical partitioning of disks that are not aligned with sector boundaries.  You can download it at <a href="http://www.hgst.com/support/downloads">www.hgst.com/support/downloads</a> . <br>  In addition, Advanced Format is supported by a number of third-party disk utilities: <br><br>  Disk partitioning tools <br>  For Linux: <br>  GPARTED 2.1+ (with the -a optimal or -a minimal options). <br>  <a href="http://www.gnu.org/software/parted/manual/parted.html">www.gnu.org/software/parted/manual/parted.html</a> <br><br>  For Windows: <br>  Acronis Disk Director Home 11 or Paragon Partition Manager 11. <br><br>  For Mac: <br>  Disk Utility (bundled with Mac OS X 10.4+), creates a GPT partition (GUID Partition Table). <br><br>  Additional information: <br>  <a href="http://www.idema.org/">www.idema.org</a> (documents on Advanced Format, including specifications) <br>  en.wikipedia.org/wiki/Advanced_Format <br>  <a href="http://www.t13.org/">www.t13.org</a> , document: ATA8-ACS (ATA Command Set) <br>  <a href="http://www.t10.org/">www.t10.org</a> , document: SBC-3 (SCSI Block Commands) <br>  Microsoft Windows 7 and Advanced Format Hotfix (KB981208): <br>  <a href="http://support.microsoft.com/kb/982018">support.microsoft.com/kb/982018</a> <br>  Intel Rapid Storage Technology (RST): <a href="http://www.intel.com/support/chipsets/imsm/sb/CS-031502.htm">www.intel.com/support/chipsets/imsm/sb/CS-031502.htm</a> <br><br>  (1) Hereinafter, the figures are taken from Hitachi Advanced Format Technology Brief - <a href="http://www.hgst.com/tech/techlib.nsf/techdocs/3D2E8D174ACEA749882577AE006F3F05/">www.hgst.com/tech/techlib.nsf/techdocs/3D2E8D174ACEA749882577AE006F3F05</a> $ file / AFtechbrief.pdf </div><p>Source: <a href="https://habr.com/ru/post/190564/">https://habr.com/ru/post/190564/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../190550/index.html">Choosing a Voice VoIP Gateway</a></li>
<li><a href="../190552/index.html">Fluid Dynamics Simulation: Lattice Boltzmann Method</a></li>
<li><a href="../190556/index.html">Localization of projects on .NET with an interpreter of functions</a></li>
<li><a href="../190560/index.html">Apportable SDK - Objective-C / Cocoa Touch for Android</a></li>
<li><a href="../190562/index.html">Meetings of the Meet Magento Russia 2013 Conference</a></li>
<li><a href="../190566/index.html">HHVM: testing performance and compatibility with Joomla, Bitrix and Wordpress</a></li>
<li><a href="../190572/index.html">The process of developing and rolling out releases in Badoo. Automatic testing. Developer Environment</a></li>
<li><a href="../190580/index.html">Studio Trailers returned to Habr</a></li>
<li><a href="../190582/index.html">Moscow, September 12, Windows Camp - come, it will be interesting!</a></li>
<li><a href="../190584/index.html">The whole truth about the UTF-8 flag</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>