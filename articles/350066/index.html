<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>APTSimulator - testing countering APT threats</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="APT Simulator is a framework for checking protective equipment and actions to investigate incidents in a Windows environment that simulates the activi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>APTSimulator - testing countering APT threats</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/vu/cz/gn/vuczgnz3gekvdegnaiaqo8qxw5e.jpeg"><br><p><br>  APT Simulator is a framework for checking protective equipment and actions to investigate incidents in a Windows environment that simulates the activity of an infringer of an information system.  This is a good platform for training the Blue Team team to counter modern threats. </p><a name="habracut"></a><br><p>  The main purpose: </p><br><ul><li>  Check for threat detection / compromise assessments. </li><li>  Check for detecting security breaches. </li><li>  Check SOC / SIEM monitoring tools. </li><li>  Environment for exfiltration data for forensic analysis. </li></ul><br><p>  APT (Advanced Persistent Threat) These goals usually include establishing and expanding their presence within the information technology infrastructure of the target organization to pursue the intentions of extracting information, disrupting or  creating interference to critical aspects of a task, program or service, or to take a position that allows these intentions to be fulfilled in the future. APT, as a ‚Äúdeveloped sustainable threat‚Äù: it has repeatedly achieved its goals for a long time; resistance; has the ability to maintain the level of penetration in the target infrastructure required for the implementation of intentions. </p><br><img src="https://habrastorage.org/getpro/habr/post_images/35b/25f/2c2/35b25f2c279af48aff8f71a5481bf758.png" alt="image"><br><p>  Such attacks are the most "advanced" and, as a rule, technologically complex.  In contrast to the usual attacks - consolidation and hidden presence in the system, allowing attackers to interact with the hacked infrastructure and expand their area of ‚Äã‚Äãconcern in a corporate environment. </p><br><p>  The following table presents markers of compromise and expected detection results: </p><br><ul><li>  AV = Antivirus </li><li>  NIDS = Network Intrusion Detection System </li><li>  EDR = Agents on endpoints - AWS, servers (Endpoint Detection and Response) </li><li>  SM = Security Monitoring </li><li>  CA = Signs of Compromise (Compromise Assessment) </li></ul><br><table><thead><tr><th>  Test case </th><th>  AV </th><th>  NIDS </th><th>  Edr </th><th>  SM </th><th>  CA </th></tr></thead><tbody><tr><td>  Local file collection </td><td></td><td></td><td></td><td></td><td>  X </td></tr><tr><td>  Connection to C &amp; C servers </td><td>  X </td><td>  X </td><td>  X </td><td>  X </td><td></td></tr><tr><td>  DNS cache poisoning </td><td>  X </td><td>  X </td><td></td><td>  X </td><td>  X </td></tr><tr><td>  Malicious User-Agent (droppers, trojans) </td><td></td><td>  X </td><td>  X </td><td>  X </td><td></td></tr><tr><td>  Netcat backconnect </td><td>  X </td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  WMI backdoor </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  LSASS dump </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Mimikatz Employment </td><td>  X </td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Using WCE </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Activate Guest Access and Privilege escalation </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Substitute system files </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Hosts modification </td><td>  X </td><td></td><td>  X </td><td></td><td>  X </td></tr><tr><td>  Obfuscated JS Dropper </td><td>  X </td><td>  X </td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Obfuscated files (rar&gt; jpg) </td><td></td><td></td><td></td><td></td><td>  X </td></tr><tr><td>  C-class subnet scanning </td><td></td><td>  X </td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  System Information Collection Commands </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Run PsExec </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Malware Delivery </td><td>  X </td><td></td><td></td><td></td><td>  X </td></tr><tr><td>  At job to collect data </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Adding RUN parameters to the registry </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Creating tasks in the scheduler (can be used as backdoors) </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Stickykey backdoor </td><td></td><td></td><td>  X </td><td></td><td>  X </td></tr><tr><td>  Using the UserInitMprLogonScript registry key </td><td></td><td></td><td>  X </td><td>  X </td><td>  X </td></tr><tr><td>  Web shells </td><td>  X </td><td></td><td>  X </td><td></td><td>  X </td></tr><tr><td>  WMI backdoors </td><td></td><td></td><td>  X </td><td></td><td>  X </td></tr></tbody></table><br><p>  <strong>Caution: The framework contains tools and executables that can damage the integrity and stability of your system.</strong>  <strong>Use them only on test or demonstration systems or stands.</strong> <strong><br></strong> <br><img src="https://habrastorage.org/webt/f5/kg/_p/f5kg_pswhrowgdxjeu2k4rghwda.png"></p><br><p>  The system interface is a "classic" pseudographic shell, familiar to users of the Metasploit Framework, Empire, SET and many others. </p><br><p><img src="https://habrastorage.org/webt/fa/am/hw/faamhwoq6u7qlxbrew_le6lbeyu.png"></p><br><p>  The main tools are available from the program context menu.  There is a possibility of launching the toolkit from the context menu, as well as individual utilities. </p><br><p>  ‚Üí Project page on <a href="https://github.com/NextronSystems/APTSimulator">github</a> . </p><br><p>  For those who do not have their own monitoring environment of malicious activity, I suggest using HELK-Hunting ELK (Elasticsearch, Logstash, Kibana) - a monitoring environment for checking and visualizing data from compromised hosts. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/57b/cec/5f4/57bcec5f4a71070309de13e0781c8a09.png" alt="image"></p><br><p>  This system is a platform for detecting threats, a set of tools and utilities for analysis and visualization in the form of a docker container. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/13d/da2/ea2/13dda2ea2f55b87f6078ff7580d5b30b.png" alt="image"></p><br><p>  ‚Üí Project page on <a href="https://github.com/Cyb3rWard0g/HELK">github</a> . </p><br><p>  The use of these two tools will allow you to improve your skills in identifying modern threats, investigating incidents and developing means and measures to respond quickly. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/350066/">https://habr.com/ru/post/350066/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350056/index.html">RequireJS for Vue.js + Asp.NETCore + TypeScript applications</a></li>
<li><a href="../350058/index.html">How to finally release your first game</a></li>
<li><a href="../350060/index.html">Optimistic UI, CQRS and EventSourcing</a></li>
<li><a href="../350062/index.html">Tell us about yourself. How to do it during an interview</a></li>
<li><a href="../350064/index.html">From a box of matches to 411 stores: the history of the new IKEA museum</a></li>
<li><a href="../350068/index.html">Dependency injection</a></li>
<li><a href="../350070/index.html">Book sale</a></li>
<li><a href="../350072/index.html">"Dagger-Android & AAC" or "shove un-crammed"</a></li>
<li><a href="../350074/index.html">UPDATED: Amplified memcached 500 Gbps DDoS attacks swept across Europe</a></li>
<li><a href="../350076/index.html">We write our BitTorrent client based on the Bt library</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>