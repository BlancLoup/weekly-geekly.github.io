<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Preparing an ASP.NET Core: Creating Your Own Tag Helper</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue our column on the topic of ASP.NET Core publication from Stanislav Ushakov ( JustStas ) - team lead from DataArt. In the article, Stas tal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Preparing an ASP.NET Core: Creating Your Own Tag Helper</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <i>We continue our column on the topic of ASP.NET Core publication from Stanislav Ushakov ( <a href="https://habrahabr.ru/users/juststas/" class="user_link">JustStas</a> ) - team lead from DataArt.</i>  <i>In the article, Stas talks about how to create your own tag-helpers in ASP.NET Core.</i>  <i>Previous articles from the column can always be read on the link <a href="http://habrahabr.ru/search/%3Fq%3D%255B%2523aspnetcolumn%255D%26target_type%3Dposts">#aspnetcolumn</a> - Vladimir Yunev</i> </blockquote>  <a href="https://habrahabr.ru/post/276277/">Last time,</a> we looked at tag-helpers that already exist in ASP.NET Core 1.0.  This time we will consider creating your own tag-helper, which can simplify the generation of small reusable sections of HTML markup. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/57b/2c3/924/57b2c39241ed46259315ba7d0d5177b1.jpg"></div><br><h3>  Introduction </h3><br>  Formally, the tag-helper is any class that inherits from the <b>ITagHelper</b> interface. In practice, it is not necessary to inherit directly from <b>ITagHelper</b> , it is more convenient to inherit from the <b>TagHelper</b> class, overriding the Process / ProcessAsync method that we will look at in the course of the article. <br><a name="habracut"></a><br><blockquote> <a href="https://github.com/StanislavUshakov/CustomTagHelpers"><img title="aspnetcolumngithub" alt="aspnetcolumngithub" src="https://habrastorage.org/files/e5a/eff/108/e5aeff1080f44ada899062dee76a3e24.png" width="240" align="right" height="88"></a>  <b>Tip!</b>  You can try everything yourself or by downloading the source code from GitHub <a href="https://github.com/StanislavUshakov/CustomTagHelpers">https://github.com/StanislavUshakov/CustomTagHelpers</a> . </blockquote><br><h3>  Infrastructure </h3><br>  We will use Visual Studio 2015 Community Edition.  Create a new ASP.NET 5 site (Figure 1). <br><br><div style="text-align:center;"><img width="650" src="https://habrastorage.org/files/1c0/889/796/1c08897969e04070a0fc041490065287.png"></div><br>  Not to start with a completely empty project, select the ‚ÄúWebApplication‚Äù template (Figure 2), but remove the authentication: ‚ÄúChange Authentication‚Äù, then select ‚ÄúNo authentication‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img width="650" src="https://habrastorage.org/files/392/9fd/e0b/3929fde0ba114a5c8701d352db3bbdd9.png"></div><br>  As a result, we will get a project with MVC already connected, one controller and three actions: Index, About, Contact.  Add a new folder to the project, let's call it <b>TagHelpers</b> : it is not necessary to call it that way, but you can say that this is an agreement, and it is better to follow it - put all your own written tag-helper in this folder.  We obtain the following structure of the project (Figure 3). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/182/c9b/566/182c9b5664a6408194a611295ef4283c.png"></div><br><br><h3>  EmailTagHelper </h3><br>  In the view code of <b>Contact.cshtml,</b> you can see the following markup containing email addresses. <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>Support:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mailto:Support@example.com"</span></span></span><span class="hljs-tag">&gt;</span></span>Support@example.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>Marketing:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mailto:Marketing@example.com"</span></span></span><span class="hljs-tag">&gt;</span></span>Marketing@example.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Create a tag helper <b>email</b> , which will be used as follows: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">email</span></span></span><span class="hljs-tag">&gt;</span></span>Support<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">email</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Generating the following HTML markup: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mailto:Support@example.com "</span></span></span><span class="hljs-tag">&gt;</span></span>Support@example.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Such a tag-helper is useful if you need to generate a lot of links to email addresses of one domain.  Add a new file to the <b>TagHelpers</b> folder, let's call it <b>EmailTagHelper.cs</b> . <br><br><pre> <code class="cs hljs">usingMicrosoft.AspNet.Razor.TagHelpers; namespaceCustomTagHelpersAndViewComponents.TagHelpers { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailTagHelper</span></span> : <span class="hljs-title"><span class="hljs-title">TagHelper</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> MailTo { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Process</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TagHelperContext context, TagHelperOutput output</span></span></span><span class="hljs-function">)</span></span> { output.TagName = <span class="hljs-string"><span class="hljs-string">"a"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   &lt;email&gt;   &lt;a&gt; } } }</span></span></code> </pre><br>  Already on the example of this very simple tag-helper one can see the following: <br><ul><li>  Tag-helper follow the following default naming rule: a tag used in cshtml views is equal to the name of the tag-helper class minus <i>TagHelper</i> .  In our case, use the <b>email</b> tag.  Further it will be shown how to override this default behavior.  It would be possible to call our tag-helper and just <b>Email</b> , the mechanism of operation would remain the same, but according to the naming rule, the postfix <b>TagHelper</b> needs to be added. </li><li>  Overriding the <i>Process</i> method, we specify which code will be executed by our tag-helper.  Also, the <b>TagHelper</b> class defines the <i>ProcessAsync</i> method with the same parameters. </li><li>  The <i>context</i> parameter contains information about the execution context of the current HTML tag. </li><li>  The <i>output</i> parameter stores data about the original HTML element that was used in the view and its contents. </li></ul><br>  In order to use the tag-helper created by us, we will add a directive to the <b>Views / _ViewImports.cshtml</b> file to connect it. <br><br><pre> <code class="html hljs xml">@using CustomTagHelpersAndViewComponents @addTagHelper "*, Microsoft.AspNet.Mvc.TagHelpers" @addTagHelper "*, CustomTagHelpersAndViewComponents"</code> </pre><br>  We use the wildcard character to add all tag-helpers from the assembly to the scope at once.  The first argument to the <b>@addTagHelper</b> directive is the name of the tag-helper (or asterisk), the second is the assembly in which they are searched.  If we want to add one tag-helper, but not all at once, then we must indicate its full name (FQN - fully qualified name): <br><br><pre> <code class="html hljs xml">@using CustomTagHelpersAndViewComponents @addTagHelper "*, Microsoft.AspNet.Mvc.TagHelpers" @addTagHelper "CustomTagHelpersAndViewComponents.TagHelpers.EmailTagHelper, CustomTagHelpersAndViewComponents"</code> </pre><br>  Now update the <b>Views / Home / Contact.cshtml view code</b> by rewriting the email links: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>Support:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">email</span></span></span><span class="hljs-tag">&gt;</span></span>Support<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">email</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>Marketing:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">email</span></span></span><span class="hljs-tag">&gt;</span></span>Marketing<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">email</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Visual Studio 2015 perfectly highlights the tag-helpers, our newly created one is not an exception: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/729/e2a/11b/729e2a11b24746ab873bc143972ec3c6.png"></div><br>  Open the site in the browser and see that the <b>email</b> tag has been replaced with the <b>a</b> tag, it's time to add the necessary logic to generate the correct link to the email.  We will transmit the necessary information using the <i>email-to</i> attribute, the <i>email</i> domain will be set by a constant in the tag-helper. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.AspNet.Razor.TagHelpers; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">CustomTagHelpersAndViewComponents.TagHelpers</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailTagHelper</span></span> : <span class="hljs-title"><span class="hljs-title">TagHelper</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> EmailDomain = <span class="hljs-string"><span class="hljs-string">"example.com"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> MailTo { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Process</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TagHelperContext context, TagHelperOutput output</span></span></span><span class="hljs-function">)</span></span> { output.TagName = <span class="hljs-string"><span class="hljs-string">"a"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> address = MailTo + <span class="hljs-string"><span class="hljs-string">"@"</span></span> + EmailDomain; output.Attributes[<span class="hljs-string"><span class="hljs-string">"href"</span></span>] = <span class="hljs-string"><span class="hljs-string">"mailto:"</span></span> + address; output.Content.SetContent(address); } } }</code> </pre><br>  Note the interesting points of this code.  The first point: the <i>MailTo</i> property from PascalCase in C # code will become <a href="http://stackoverflow.com/questions/11273282/whats-the-name-for-hyphen-separated-case/12273101">low-kebab-case</a> in the presentation code: <i>email-to</i> , as is now accepted in front-end.  The last line of the method sets the contents of the created tag.  Along with the syntax for adding attributes <i>output.Attributes ["href"] = "mailto:" + address;</i>  You can use the <i>output.Attributes.Add</i> method. <br>  Now update the <b>Views / Home / Contact.cshtml view</b> : <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>Support:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">email</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mail-to</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Support"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">email</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>Marketing:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">email</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mail-to</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Marketing"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">email</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  As a result, the following HTML markup will be generated: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>Support:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mailto:Support@example.com"</span></span></span><span class="hljs-tag">&gt;</span></span>Support@example.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>Marketing:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mailto:Marketing@example.com"</span></span></span><span class="hljs-tag">&gt;</span></span>Marketing@example.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Note that now we cannot write <i>&lt;email mail-to = "Support" /&gt;</i> , for this we need to add a special attribute by connecting the <i>Microsoft.AspNet.Razor.TagHelpers</i> assembly: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">HtmlTargetElement(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"email"</span></span></span><span class="hljs-meta">, TagStructure = TagStructure.WithoutEndTag)</span></span>]</code> </pre><br>  Also, instead of <i>TagStructure.WithoutEndTag,</i> you can use the <i>TagStructure.NormalOrSelfClosing</i> value, in this case, you can write both <i>&lt;email&gt; &lt;/ email&gt;</i> and <i>&lt;email /&gt;</i> . <br><br><h3>  Tag-helper bold </h3><br>  Let's write a simple tag helper that can be applied to various HTML tags.  Let it turns the text into bold for all HTML tags to which it applies.  We will again need the <i>HtmlTargetElement</i> attribute.  Add a new <b>BoldTagHelper.cs</b> file to the <b>TagHelpers folder</b> with the following contents: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.AspNet.Razor.TagHelpers; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">CustomTagHelpersAndViewComponents.TagHelpers</span></span> { [HtmlTargetElement(Attributes = <span class="hljs-string"><span class="hljs-string">"bold"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BoldTagHelper</span></span> : <span class="hljs-title"><span class="hljs-title">TagHelper</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Process</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TagHelperContext context, TagHelperOutput output</span></span></span><span class="hljs-function">)</span></span> { output.Attributes.RemoveAll(<span class="hljs-string"><span class="hljs-string">"bold"</span></span>); output.PreContent.SetHtmlContent(<span class="hljs-string"><span class="hljs-string">"&lt;strong&gt;"</span></span>); output.PostContent.SetHtmlContent(<span class="hljs-string"><span class="hljs-string">"&lt;/strong&gt;"</span></span>); } } }</code> </pre><br>  Now in the <i>HtmlTargetElement</i> attribute we do not pass the name of the tag to which the helper tag is applied, but the name of the HTML attribute that can be added to different HTML tags.  Change the markup in the <b>About.cshtml view</b> : <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bold</span></span></span><span class="hljs-tag">&gt;</span></span>Use this area to provide additional information.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  As a result, the following HTML markup will be generated: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>Use this area to provide additional information.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  However, if we try to use <b>bold</b> not as an attribute, but as the name of an HTML tag, the tag-helper code will not be called.  This can be corrected by adding the HtmlTargetElement attribute to the tag-helper <i>class</i> again, only passing it the name of the <i>bold</i> tag: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">HtmlTargetElement(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"bold"</span></span></span><span class="hljs-meta">)</span></span>]</code> </pre><br>  Now in the submission we can write like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bold</span></span></span><span class="hljs-tag">&gt;</span></span>Use this area to provide additional information.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bold</span></span></span><span class="hljs-tag"> &gt;</span></span></code> </pre><br>  If we immediately add both <i>HtmlTargetElement</i> attributes to our tag-helper class: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">HtmlTargetElement(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"bold"</span></span></span><span class="hljs-meta">)</span></span>] [HtmlTargetElement(Attributes = <span class="hljs-string"><span class="hljs-string">"bold"</span></span>)]</code> </pre><br>  Then they will be linked with each other by logical OR: either the bold tag or the bold attribute.  You can combine more than two attributes <i>HtmlTargetElement</i> , they will all be linked through OR.  If we want to link them through an AND: apply to the bold tag with the bold attribute, we need to combine these conditions in one <i>HtmlTargetElement</i> attribute: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">HtmlTargetElement(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"bold"</span></span></span><span class="hljs-meta">, Attributes = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"bold"</span></span></span><span class="hljs-meta">)</span></span>]</code> </pre><br>  Now consider the code inside the <i>Process</i> method.  Method <i>output.Attributes.RemoveAll ("bold");</i>  removes the <i>bold</i> attribute from the HTML tag.  Then we need to frame the entire contents of the tag with a <b>strong</b> tag.  To do this, use the <i>PreContent</i> and <i>PostContent</i> properties of the <i>output</i> object.  They allow you to add new content inside the tag, but before and immediately after the main content.  Schematically, it looks like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bold</span></span></span><span class="hljs-tag">&gt;</span></span>PRECONTENT Use this area to provide additional information. POST_CONTENT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  If we want to add new content outside the tag, we need to use the <i>PreElement</i> and <i>PostElement properties</i> , then we get the following: <br><br><pre> <code class="html hljs xml">PRE_ELEMENT<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bold</span></span></span><span class="hljs-tag">&gt;</span></span>Use this area to provide additional information.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>POST_ELEMENT</code> </pre><br>  And do not forget to use the <i>SetHtmlContent</i> method, not <i>SetContent</i> , if we want to add HTML tags, otherwise the <i>SetContent</i> method recodes the transferred string and the <b>strong</b> tag will not be applied. <br><br><h3>  Asynchronous tag-helper copyright </h3><br>  Before we overloaded the <i>Process</i> method, now we will overload its asynchronous version: the <i>ProcessAsync</i> method.  Let's write a simple tag helper that will display this markup: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>¬© 2016 MyCompany<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Add a new file <b>CopyrightTagHelper.cs</b> to the <b>TagHelpers</b> folder: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.AspNet.Razor.TagHelpers; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">CustomTagHelpersAndViewComponents.TagHelpers</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Custom tag helper for generating copyright information. Content inside will be added after: ¬© Year </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> [HtmlTargetElement("copyright")] public class CopyrightTagHelper : TagHelper { public override async Task ProcessAsync(TagHelperContext context, TagHelperOutput output) { var content = await output.GetChildContentAsync(); string copyright = $"</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;p&gt;</span></span></span><span class="hljs-comment">¬© {DateTime.Now.Year} {content.GetContent()}</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/p&gt;</span></span></span><span class="hljs-comment">"; output.Content.SetHtmlContent(copyright); } } }</span></span></code> </pre><br>  Unlike the synchronous <i>Process</i> method, the <i>ProcessAsync</i> method returns an object of type <b>Task</b> .  We also added the <i>async</i> modifier to the method, because inside the method we get the contents of the tag using the <i>await output.GetChildContentAsync ();</i>  .  Then, using the new formatting string mechanism in C # 6, we <i>create the</i> contents of the tag and add it using the <i>output.Content.SetHtmlContent (copyright)</i> method <i>;</i>  .  In all other aspects, this simple asynchronous helper tag is no different from synchronous. <br><br><h3>  Best practices and conclusions </h3><br>  To write a good tag helper, you need to know how to write excellent.  To do this, look at the standard tag-helpers available in MVC: <a href="https://github.com/aspnet/Mvc/tree/dev/src/Microsoft.AspNetCore.Mvc.TagHelpers">Microsoft.AspNetCore.Mvc.TagHelpers</a> .  And add in your created tag-helper enough comments and checks. <br><br>  All source code of the project is available in GitHab at: <a href="https://github.com/StanislavUshakov/CustomTagHelpers">Custom Tag Helpers</a> . <br><br>  Own tag-helpers allow you to optimize frequently encountered tasks for generating small HTML markup.  If you want to encapsulate the more complex presentation logic, it‚Äôs better to use <a href="http://docs.asp.net/projects/mvc/en/latest/views/view-components.html">View Components</a> . <br><br>  Try ASP.NET Core 1.0, report bugs, add features! <br><br><h3>  To authors </h3><br>  Friends, if you are interested in supporting the column with your own material, please write to me at <a href="">vyunev@microsoft.com</a> to discuss all the details.  We are looking for authors who can interestingly tell about ASP.NET and other topics. <br><br><img align="right" width="250" src="https://habrastorage.org/files/142/321/7d4/1423217d48a24d688995ae9935c6f812.png"><br><h3>  about the author </h3><br>  <b>Stanislav Ushakov</b> <br>  Senior .Net Developer / Team lead in DataArt <br><br>  Born, studied in Voronezh.  .Net has been professionally engaged for more than 6 years, before that even MFC had seen.  I like to program (recently I got my hands on Arduino, I play), read books (especially paper ones), play WhatSheKogda (sports), learn and understand everything new.  I want to finally defend the written candidate. <br><br>  <a href="https://habrahabr.ru/users/juststas/" class="user_link">Juststas</a> <br><br><h3>  Announcement!  Deep Intense at the DevCon 2016 Conference </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/9c6/250/db7/9c6250db75fac2d4e28fac55d5eb951e.png" alt="image"><br><br>  We are pleased to announce the holding of a deep intensive course on ASP.NET Core at the [DevCon 2016 conference] (https://events.techdays.ru/DevCon/2016/registration).  This course will take place on the second day of the conference and will take a full day of the conference for 6 hours. <br><br>  <b>Development of modern web applications on the open platform ASP.NET 5</b> <br>  As part of this intense, participants will take part in an exciting and adventurous journey dedicated to developing web applications on the latest ASP.NET platform 5. We will go all the way from zero to a full-fledged application deployed in the cloud.  And on the way, participants will be able to stop to explore the internal structure of ASP.NET, work with relational and NoSQL databases using the Entity Framework 7, develop applications on the MVC framework, build models, views and business logic, create a REST API, and organize continuous development processes. and testing using Git and Visual Studio Online, as well as deploying using Azure and Docker containers.  At the end of the trip, all participants will pass the dedication and become deserved knights of ASP.NET. <br><br>  Registration for the DevCon 2016 conference is already open!  <a href="https://events.techdays.ru/DevCon/2016/registration">Sign up here</a> . </div><p>Source: <a href="https://habr.com/ru/post/278251/">https://habr.com/ru/post/278251/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278235/index.html">Rules of life of the sysadmin</a></li>
<li><a href="../278237/index.html">Pub-Sub implementation examples: Azure Topics, EventHub, ZeroMQ, microServiceBus, etc</a></li>
<li><a href="../278243/index.html">Tales of "engineering special forces", well, or just our fun work</a></li>
<li><a href="../278245/index.html">Stack chases with a stack, or bytecode conversion of a Java virtual machine into a Phantom OS bytecode.</a></li>
<li><a href="../278247/index.html">Preparing an ASP.NET Core: Creating Your Cross-Platform Modular Framework</a></li>
<li><a href="../278253/index.html">Zephyr Project - real-time open source OS</a></li>
<li><a href="../278255/index.html">Comparing SSL Certificates with Domain Verification</a></li>
<li><a href="../278257/index.html">Passport scanner do it yourself</a></li>
<li><a href="../278261/index.html">VMware NSX and Nutanix: build a fully software-defined data center (Software-Defined Datacenter)</a></li>
<li><a href="../278263/index.html">Ensuring the quality of business services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>