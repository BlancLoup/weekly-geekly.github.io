<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with monitors via WinAPI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Opportunities 
 Using the classes below, you can get information about the number of monitors, their parameters, as well as set work areas. 

 Why do ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with monitors via WinAPI</h1><div class="post__text post__text-html js-mediator-article"><h5>  Opportunities </h5><br>  Using the classes below, you can get information about the number of monitors, their parameters, as well as set work areas. <br><br><h5>  Why do you need </h5><br>  In particular, I needed this functionality to create my own dashboard in WPF, like a taskbar.  Collected information on the Internet and designed in a convenient form. <br><br><h5>  Using </h5><br>  In our program we write: <br><pre><code class="cs hljs">DisplayDispatcher dispatcher = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DisplayDispatcher();</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This automatically searches for monitors and determines their parameters.  Print the data in the ListBox: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; dispatcher.Count; i++) lbMonitors.Items.Add(String.Format(<span class="hljs-string"><span class="hljs-string">" #{0} ({1}x{2}) {3}"</span></span>, i, dispatcher[i].ScreenWidth, dispatcher[i].ScreenHeight, ((dispatcher[i].Availability) ? <span class="hljs-string"><span class="hljs-string">" "</span></span> : <span class="hljs-string"><span class="hljs-string">""</span></span>)));</code> </pre><br><br>  In addition to the width and height, data on the occupied area on the virtual desktop (MonitorArea) and the workspace on it (WorkArea) are also available. <br><a name="habracut"></a><br>  Now, for example, let's change the working area of ‚Äã‚Äãthe main monitor: <br><pre> <code class="cs hljs">Rect wa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rect { left = <span class="hljs-number"><span class="hljs-number">0</span></span>, right = <span class="hljs-number"><span class="hljs-number">0</span></span>, top = <span class="hljs-number"><span class="hljs-number">500</span></span>, bottom = <span class="hljs-number"><span class="hljs-number">500</span></span> }; dispatcher.GetMainDisplay().ApplyNewWorkArea(wa);</code> </pre><br><br>  If you then try to maximize any window on the main monitor, it will fit into a rectangle (0; 0) - (500; 500). <br><br><h5>  A bit of theory </h5><br>  The monitor, whose workspace will be changed, is determined automatically.  In order to change the area of ‚Äã‚Äãa specific monitor, the new dimensions must fit into the occupied position on the virtual desktop.  Those.  WorkArea must be entered in the MonitorArea. <br>  Specifically, in the proposed code, the working area is set by referring to the desired monitor, and the check is carried out before calling WinAPI functions. <br><br>  To extend WinAPI functionality, I recommend the site <a href="http://www.pinvoke.net/">www.pinvoke.net</a> . <br><br>  <a href="http://rghost.ru/5086685">Download sources (VS2010)</a> <br><br>  In addition to the one described in the program, you can outline the current work area of ‚Äã‚Äãthe selected monitor. <br><br>  PS I did not find the answer whether it is possible to cause automatic redrawing of active windows, taking into account the new size of the workspace, I will be grateful if someone writes how to do it (without using window enumeration through EnumWindows). </div><p>Source: <a href="https://habr.com/ru/post/116886/">https://habr.com/ru/post/116886/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116879/index.html">The second day of CloudConf 2011</a></li>
<li><a href="../116880/index.html">CSSO (CSS Optimizer) - structural minimization of CSS</a></li>
<li><a href="../116883/index.html">We are looking for talents - spring recruitment to the program of Microsoft partner students</a></li>
<li><a href="../116884/index.html">The rise in e-book spam</a></li>
<li><a href="../116885/index.html">Bluetooth rodent from Logitech</a></li>
<li><a href="../116887/index.html">Current state of high technology</a></li>
<li><a href="../116889/index.html">[Translation] Theft of data due to the latest features of Windows and Mac OS X</a></li>
<li><a href="../116890/index.html">Acoustics. Orthodynamic Emitters</a></li>
<li><a href="../116891/index.html">Boodler Sound Landscape Generator</a></li>
<li><a href="../116892/index.html">Multi-threaded application under Tornado</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>