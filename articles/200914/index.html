<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We decode GSM with RTL-SDR for $ 30</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good time of day, Habr! 

 We live in amazing pre-singular time. Technologies are developing rapidly. What seemed fantastical a few years ago is becom...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We decode GSM with RTL-SDR for $ 30</h1><div class="post__text post__text-html js-mediator-article">  Good time of day, Habr! <br><br>  We live in amazing pre-singular time.  Technologies are developing rapidly.  What seemed fantastical a few years ago is becoming a reality today.  Surprisingly, now, if you have a computer with a simple TV tuner, you can receive the coordinates of airplanes and ships, satellite imagery, and data from weather probes. <br>  I am not a specialist in information security, all operations have been done solely for the purpose of training.  This text will discuss how to decode (not decrypt) GSM traffic. <a name="habracut"></a>  By tradition, instead of an epigraph: <br><br><blockquote>  Article 138 of the Criminal Code.  Violation of the secrets of correspondence, telephone conversations, postal, telegraph or other communications <br>  1. Violation of the secrecy of correspondence, telephone conversations, postal, telegraph or other communications of citizens - is punishable by a fine of up to eighty thousand rubles or in the amount of the salary or other income of the convicted person for a period of up to six months, or compulsory work for up to three hundred and sixty hours, or correctional labor for up to one year. </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Milestones </h5><br><ul><li>  1991 - the first GSM standard specifications are published. </li><li>  2005 - the first mention <s>in the annals of</s> TV tuners on the E4000 chip. </li><li>  2008 - at the Black Hat conference, GSM <a href="http%253A%252F%252Fwww.blackhat.com%252Fpresentations%252Fbh-dc-08%252FSteve-DHulton%252FPresentation%252Fbh-dc-08-steve-dhulton.pdf%26ei%3Dw_B0Utr6MKWB4gSViIDYCg%26usg%3DAFQjCNF2YOCA7qugTRNFU23eYUcU4d-cig%26sig2%3Df30TrnnWFTQ-6bwbjIHdxA%26bvm%3Dbv.55819444,d.bGE">hacking was demonstrated</a> using a USRP SDR receiver priced at about $ 1,000. </li><li>  2008 - the first commit in the <a href="http://openbsc.osmocom.org/trac/wiki">Osmocom OpenBSC</a> public repository, which implements the GSM base station controller software. </li><li>  2008 - first commits in the <a href="https://svn.berlin.ccc.de/projects/airprobe/">Airprobe</a> project.  Attention, under the link problems with the certificate. </li><li>  2009 - Carsten Nol <a href="http://habrahabr.ru/post/79631/">demonstrates a way to break</a> the A5 / 1 encryption algorithm. </li><li>  2010 - the first commit in the public repository of the <a href="http://bb.osmocom.org/trac/">OsmocomBB</a> project, which implements the GSM protocol stack on <a href="http://bb.osmocom.org/trac/wiki/Hardware/Phones">ordinary phones</a> . </li><li>  2010 - <a href="http://habrahabr.ru/post/99804/">Kraken presentation</a> - software that allows you to decrypt GSM data encrypted using the A5 / 1 algorithm.  The demonstration was made using a regular phone. </li><li>  2013 - The RTL-SDR blog has published a <a href="http://www.rtl-sdr.com/rtl-sdr-tutorial-analyzing-gsm-with-airprobe-and-wireshark/">manual for decoding</a> GSM traffic. </li><li>  2013 - Domonkosh Tomchany published a <a href="http://domonkos.tomcsanyi.net/%3Fp%3D428">new</a> GSM hacking <a href="http://domonkos.tomcsanyi.net/%3Fp%3D428">method</a> . </li></ul><br><br><h5>  Intercept </h5><br>  For interception, we need: <br><ul><li>  The <a href="http://www.ebay.com/sch/i.html%3F_trksid%3Dp2050601.m570.l1313%26_nkw%3Delonics%2Be4000%26_sacat%3D0%26_from%3DR40">tuner</a> itself is based on the E4000.  The deposit of these chips has been exhausted, so the price of tuners on their base increases over time.  The remaining chips are also suitable, but they do not support the GSM1800 / 1900 range. </li><li>  75 Ohm antenna.  Go and regular from the tuner.  I placed the usual TV antenna on the windowsill in such an extravagant way, having thrown the USB extension cable. <br><img src="https://habrastorage.org/getpro/habr/post_images/07f/bdb/fd2/07fbdbfd2be148bccaa0184b85dc8b73.jpg" alt="image"><br></li><li>  A machine with an installed distribution of the Debian family.  Ubuntu will do.  I used an old laptop with Kali Linux, which I connected via ssh over Wi-Fi.  I did not succeed in setting up the software for Fedor from the first attempt of the software; I decided not to wrestle with anything and act like in the example.  <b>Rake number 0</b> : if you make an installation flash drive with Kali Linux - read <a href="http://ru.docs.kali.org/installation-ru/%25D1%2583%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B0-%25D1%2581-usb-%25D1%2584%25D0%25BB%25D1%258D%25D1%2588-%25D1%2581-kali-linux-live">this</a> .  Unetbootin will not create a working image. </li><li>  A fair amount of patience and this is the <a href="http://www.rtl-sdr.com/receiving-decoding-decrypting-gsm-signals-rtl-sdr/">instruction</a> . </li></ul><br><br>  All painted in some detail, I will only comment on only those rakes, which came on myself. <br>  <b>Rake number 1</b> : do not put the latest version of GNURadio.  Starting with version 3.7.0, the namespaces change, and software will not work.  Use version 3.6.5.  Also check the branches in the airprobe git repository.  Tags and comments there indicate with which version of GNURadio you need to build projects. <br>  <b>Rake number 2</b> : do not forget to put dev-packages in addition to all listed. <br>  <b>Rake number 3</b> : it is often not easy to find a GSM operating frequency using the SDRSharp.  Domonkos Tomchany offers for this purpose the <a href="https://github.com/steve-m/kalibrate-rtl">kalibrate-rtl program</a> .  It will give something like: <br><br><pre><code class="bash hljs">username@hostname:~$ kal -s GSM900 Found 1 device(s): 0: Terratec T Stick PLUS Using device 0: Terratec T Stick PLUS Found Elonics E4000 tuner Exact sample rate is: 270833.002142 Hz kal: Scanning <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> GSM-900 base stations. GSM-900: chan: 10 (937.0MHz - 20.572kHz) power: 1467419.20 chan: 12 (937.4MHz - 20.602kHz) power: 242714.33 chan: 25 (940.0MHz - 20.308kHz) power: 364373.98 chan: 32 (941.4MHz - 20.340kHz) power: 1562694.12 chan: 52 (945.4MHz - 20.100kHz) power: 206568.21 chan: 54 (945.8MHz - 20.184kHz) power: 628970.43 chan: 71 (949.2MHz - 20.052kHz) power: 396199.27 chan: 86 (952.2MHz - 20.081kHz) power: 1095374.22 chan: 112 (957.4MHz - 20.047kHz) power: 594273.38</code> </pre> <br>  Select a channel with a larger amplitude and launch the interception on it.  The GSM traffic will appear in the console: <br><br><pre> <code class="bash hljs">168815 0: 49 06 1b 0a 35 52 f0 10 00 e8 c8 02 28 13 65 45 bd 00 00 83 1f 40 1b 168819 0: 15 06 21 00 01 f0 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 168825 0: 41 06 21 a0 05 f4 44 46 03 b7 17 05 f4 16 4e <span class="hljs-built_in"><span class="hljs-built_in">fc</span></span> 29 2b 2b 2b 2b 2b 2b 168829 0: 41 06 21 a0 05 f4 41 4d ef 18 17 05 f4 1d 5c 2a 63 2b 2b 2b 2b 2b 2b 168835 0: 4d 06 24 a0 f6 ce c3 7a df d4 7e 21 <span class="hljs-built_in"><span class="hljs-built_in">fc</span></span> 80 0a 40 cb 25 e2 3c d3 2b 2b 168839 0: 49 06 22 a0 d1 6c 9f 44 11 40 57 92 17 05 f4 ef 59 34 1d cb 2b 2b 2b 168845 0: 41 06 21 a0 05 f4 35 4a 5b 9d 17 05 f4 20 4a 56 e2 2b 2b 2b 2b 2b 2b 168849 0: 25 06 21 20 05 f4 e8 24 47 7f 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 2b 168855 0: 49 06 22 a0 c8 9c 63 0a ee e8 45 0c 17 05 f4 d3 04 7f 49 cb 2b 2b 2b 168859 0: 41 06 21 a0 05 f4 d8 5f d2 1f 17 05 f4 51 42 81 53 2b 2b 2b 2b 2b 2b</code> </pre><br><br><h5>  findings </h5><br>  A couple of words about decryption.  For him, apparently, in addition to $ 30 per tuner, you will have to spend money on a double terabyte hard drive under rainbow tables.  The script for their generation was found in the Airprobe repository, it seems that Kraken will not find a problem. <br><br>  What exactly is this method interesting?  The fact that at its base you can build cheap, but rather serious <b>universal</b> interception <b>systems</b> .  After all, there is still a DECT (links will not, the site Osmocom DECT temporarily lies), which is widely used in offices.  Encryption is weaker there, and secrets are more serious. <br>  Well, two-factor authentication is now in question. <br><br>  ‚ÄúIs it really that bad?‚Äù You ask. <br>  Not really.  It <b>is</b> not possible to intercept 3G traffic in this way - the signal bandwidth is too wide.  But no one prohibits an attacker from intercepting in a place where there is no such coverage or with jamming.  And progress does not stand still.  When <a href="http://habrahabr.ru/company/dsec/blog/193618/">HackRF Jawbreaker</a> type iron becomes cheaper and more popular, interception of 3G on it will not take long to wait. <br><br>  Thank you for attention. </div><p>Source: <a href="https://habr.com/ru/post/200914/">https://habr.com/ru/post/200914/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../200904/index.html">Anatoly Wasserman approves Clouds</a></li>
<li><a href="../200906/index.html">How Groupon migrated from monolithic Rails applications to the new Node.js infrastructure</a></li>
<li><a href="../200908/index.html">Drupal 7. DIY subscription module</a></li>
<li><a href="../200910/index.html">Algorithm and advantages of CMS automatic update</a></li>
<li><a href="../200912/index.html">Linux - the story of one hacking</a></li>
<li><a href="../200916/index.html">Ajax file uploads using jQuery and CodeIgniter</a></li>
<li><a href="../200918/index.html">A simple way to assess the importance of search queries for the site</a></li>
<li><a href="../200920/index.html">Email marketing: 3 relevance lessons from the best companies</a></li>
<li><a href="../200922/index.html">SSD screw is turned off after 5 minutes of operation Or inconceivable SSD controller logic</a></li>
<li><a href="../200924/index.html">Effective implementation of Readers ‚Äì writer lock based on "Interlocked Variable Access"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>