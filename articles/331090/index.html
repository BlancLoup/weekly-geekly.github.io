<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Shallow immersion or data recovery from the hard drive after flooding the office</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The office of a small trading company was located on the ground floor of a residential building built in the seventies of the last century. During its...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Shallow immersion or data recovery from the hard drive after flooding the office</h1><div class="post__text post__text-html js-mediator-article">  The office of a small trading company was located on the ground floor of a residential building built in the seventies of the last century.  During its existence, the house has pretty much decayed, but continued to be used with minor cosmetic repairs.  Although the company complained about the inappropriate condition of pipes and plumbing equipment, it was not in a hurry to solve these problems at its own expense, believing that the coming major overhaul would reduce their potential costs.  But, as subsequent events have shown, you should not rely on bare economic calculation without taking risks. <br><br>  On a June morning, company employees discovered that the entrance to the office was flooded and steam was coming from the windows to the street.  As a matter of urgency, an emergency crew was called, which stopped the flow of water into the room and began pumping.  The cause of flooding was metal corrosion, which led to the destruction of one of the fittings on the hot water pipe. <br><br>  Damage was caused to walls, floors, furniture, paper documentation and office equipment.  The most affected were computers that were in the server-admin and remained on around the clock.  The storages, which had to work while immersed in hot water, were a very sad sight. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/web/186/6fb/214/1866fb2146594645ab2e06fca7b79942.jpg"></div><br>  <i>rice</i>  <i>one</i> <br><a name="habracut"></a><br>  After analyzing backup copies of data that were out of the office, it was decided to restore data from some drives.  One of them was the Samsung HD753LJ drive. <br><br>  Approximately in this state, the drive came to our data recovery laboratory (in Figure 1, the drive is already after the dust and impurities cleaning procedure).  It is known that the housing of the accumulator is not hermetic and it has an air filter for equalizing the pressure inside the accumulator with the environment. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/0f6/3f3/ad1/0f63f3ad1a4a40a3b3adbfa974efe135.jpg"></div><br>  <i>rice</i>  <i>2</i> <br><br>  The design of the accumulator is such that the axis of the BMG is screwed into the case into the threaded hole and is sealed from the outside of the case with a round sticker.  Unfortunately, in our case, the sticker was washed away under the influence of hot water. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/a3c/c04/213/a3cc042136f542e4b0bdf87c639b59b4.jpg"></div><br>  <i>rice</i>  <i>3</i> <br><br>  Considering that the accumulator was kept for many hours while it was immersed in water with a peeled off protective sticker, we assume that liquid may get inside the HDA.  In the conditions of laminar boxing we make opening of the store.  A primary visual inspection does not reveal any serious fluid ingress into the HDA. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/0e6/62a/c24/0e662ac2462741df8afcafe595ad49f4.jpg"></div><br>  <i>rice</i>  <i>four</i> <br><br>  We remove the magnetic heads unit (BMG) and examine the threaded hole in the housing of the drive and its surroundings, as well as the BMG itself under a microscope.  As a result of the inspection, small divorces were found near the threaded joint itself, which suggests that the liquid has fallen quite scarcely and at the time of the drive‚Äôs arrival to us it already had time to evaporate.  Deformations of suspensions and sliders were not detected, the switch-preamplifier visually without damage.  We carry out the operation of removing salts contained in the liquid, in order to avoid dispersion of dust on the HDA, both on the housing and on the BMG itself.  We also measure the resistance of all pins on the block from the switch-preamplifier and compare it with the resistance of a similar drive.  The result of the tests suggests the health of the switch-preamplifier.  Based on the fact that no serious contamination was found, there are no deformations of the suspensions and sliders, and there is also a reason to assume that the switch-preamplifier is working, we conclude that there is no need to transfer the disk pack to another case and there is no need to use BMG from the drive -donora  Putting the drive back. <br><br>  Based on the results of the initial visual inspection, it is obvious that the printed circuit board of the ‚Äúcontroller‚Äù of this drive has degraded as a result of electrochemical corrosion and cannot be used.  In this family (F1_3D), the ROM is located in the Marvell 88i8826E MCU.  Considering that it is not known whether this MCU is ‚Äúalive‚Äù, as well as the complexity of soldering BGA chips, the options for obtaining the original contents of the ROM will be excluded. <br><br>  In the case of Samsung drives of this family, the <a href="http://hddmasters.by/articles/method_of_data_recovery_by_hot_swap.html">Hot swap</a> technique is applicable.  After reading the firmware modules, you can install the original firmware version, and also understand whether the entire firmware code was placed in the microcontroller's ROM or were used for storing overlays in the service area for its storage. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/bcc/c26/45b/bccc2645b15949b3a241fea6d0df6757.png"></div><br>  <i>rice</i>  <i>five</i> <br><br>  After analyzing the FSI module, we installed the firmware version 1AG08ugB.d35.  Evaluating the contents of the modules 73_MOVLY, 19_BOVLY, we find that they are completely filled with zeros.  This observation allows us to conclude that almost any ROM with a compatible platform identifier that does not use modules 19 and 73 for storing executable code can be used for data recovery. <br><br>  We use the donor's fee, in which we write the nearest compatible ROM. The closest version available was 1AA18HuM.d35. <br><br>  A test run showed a log in the terminal with some error messages that are not critical when reading user data. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/986/d81/bea/986d81bea7d5409dae65d7fea8d74ce3.png"></div><br>  <i>rice</i>  <i>6</i> <br><br>  According to the registers, the drive also announced readiness for data exchange. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/51d/88c/045/51d88c045c09455db54e4c8e1e59edce.png"></div><br>  <i>rice</i>  <i>7</i> <br><br>  In the hard disk RAM, we modify the number of hardware repetitions from 100 read attempts to 2, in order not to provoke long delays on unreadable sections, and also partially disable offline scanning procedures. <br><br>  We create the task of a sector-by-sector copy to another drive and first of all build the zone distribution map. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/92b/0b6/071/92b0b607191f4d6281631748fa0b7f85.png"></div><br>  <i>rice</i>  <i>eight</i> <br><br>  We start reading in UDMA mode with a wait timeout of 300 milliseconds, with the interruption of the operation when instability is detected, a soft reset and a jump of 100,000 sectors ahead. <br><br>  UNC errors are detected on sectors 6 24x xxx and 89 36x xxx.  The remaining sections are read without difficulty. <br><br>  We send the drive to sleep mode and on the copies we make an analysis of zero sector. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/1fe/d78/166/1fed78166301450f8b6ed0463e8cf4c9.png"></div><br>  <i>rice</i>  <i>9</i> <br><br>  In fig.  9 shows that there are records of two sections.  The first section starts with sector 0x0000003F (63) and its length is 0x061A7927 (102,398,247) sectors.  The second section begins with sector 0x061A7966 (102 398 310), and its length is 0x446AF55B (1 147 860 315) sectors.  At offset 0x1BE is the value 0x80 - a sign of the activity of the partition (the partition is bootable).  According to the localization of defects, it is obvious that they fall on the first section. <br><br>  In sector 63 there is the boot sector of the first partition, in which, in addition to the bootloader code that transfers control to NTLDR, there are file system parameters. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/0ec/bd4/212/0ecbd421284d48228329b2b9aba42544.png"></div><br>  <i>rice</i>  <i>ten</i> <br><br>  Of the file system parameters, we note: the sector is 512 bytes, 8 sectors in a cluster, the size of the partition in the boot sector corresponds to the size described in the partition table. <br>  The first sector of the MFT is calculated by the formula: X * Y + Z, where X is the number of the first cluster of the MFT location, Y is the number of sectors in the cluster, Z is the offset before the start of the partition. <br><br>  0x00000000000C0000 * 0x08 + 0x3F = 0x000000000060003F (6 291 519) <br><br>  Since we have an unflattering fragment for this offset, we calculate the position of the MFT Mirror <br><br>  0x000000000061A792 * 0x08 + 0x3F = 0x00000000030D3CCF (51 199 183) <br><br>  There are no unread fragments for this offset.  Having determined the position of the MFT and having analyzed its location, we build a map. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/603/a5e/4c6/603a5e4c66a94ab98fb16c702948920b.png"></div><br>  <i>rice</i>  <i>eleven</i> <br><br>  We read partially unread first MFT fragment.  The operation passes without difficulty. <br><br>  Let's analyze the MFT records and compare them with the read card.  As a result, we find that defects fall on only two files. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/205/c64/083/205c640830f1489c9c2dd02ab6ab2698.png"></div><br>  <i>rice</i>  <i>12</i> <br><br>  The first is the NTFS service structure, which is noncritical. <br><br>  The second is a virtual memory file in Windows and is also of no value to the Customer. <br><br>  To clarify the nature of the defect, we read the unread fragments of these files, which will show the presence of completely unreadable sections of several thousand sectors, which indicates the incorrect operation of the drive in the last minutes. <br><br>  As a conclusion, I would like to remind everyone again of the need for backup and that it is desirable to keep copies not in the same places where drives with basic operating data are located, since in the case of such a fairly easily foreseeable force majeure, all existing information. <br><br>  <a href="https://habrahabr.ru/post/330642/">Previous publication: Is it always safe to encrypt or recover data from an external hard drive Prestigio Data Safe II</a> <br>  <a href="https://habrahabr.ru/post/331512/">Next post: Admin Sin or Data Recovery from Knocking Western Digital WD5000AAKX HDD</a> </div><p>Source: <a href="https://habr.com/ru/post/331090/">https://habr.com/ru/post/331090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331078/index.html">We are testing the capabilities of ARKit. Create a game with augmented reality</a></li>
<li><a href="../331080/index.html">Why connect under attack to DDoS neutralization service is too late</a></li>
<li><a href="../331082/index.html">Frequencies and network capacity - everything you wanted to ask</a></li>
<li><a href="../331086/index.html">What can go wrong on the meta-search site and what to do about it? Part 2</a></li>
<li><a href="../331088/index.html">Reduce the use of Redux code with React Apollo</a></li>
<li><a href="../331092/index.html">Cricket Lee and Paul Vixie's Webinar on Network Security with DNS RPZ</a></li>
<li><a href="../331094/index.html">Security Week 24: 95 fixes from Microsoft, the router merges the data with LEDs, for MacOS there is a runner service</a></li>
<li><a href="../331096/index.html">Better to hear once than read seven times</a></li>
<li><a href="../331098/index.html">Create applications using Firebird, jOOQ and Spring MVC</a></li>
<li><a href="../331100/index.html">Casual C ++: isolating the C-style API</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>