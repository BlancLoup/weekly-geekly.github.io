<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Neo4j VS MySQL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 As a third year student, I chose a topic for coursework: ‚ÄúGraph databases using the example of Neo4j‚Äù. Since until that time I had studied ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Neo4j VS MySQL</h1><div class="post__text post__text-html js-mediator-article"><h4>  Foreword </h4><br>  As a third year student, I chose a topic for coursework: ‚ÄúGraph databases using the example of Neo4j‚Äù.  Since until that time I had studied and used exclusively relational databases, I was wondering why the graph database would be at all, and when should its capabilities be better applied?  After viewing many sites on the Internet, I found only a theory and no more.  Since the theory is not always convincing and I would like to see some kind of statistics, I was curious and I decided that in my coursework I would do it, and I chose MySQL as the enemy of Neo4j. <br><br>  So who will win this standoff? <br><a name="habracut"></a><br><h4>  Briefly about Neo4j and graph databases </h4><br>  Neo4j is an open-source graph database, the story of which began with the investments of Neo Technology in 2003.  Since 2007, it has become publicly available.  Neo4j contains all database features, including adhering to ACID, maintaining clustering, and recovering from a system crash.  Today is the leader among database graphs. <br><br>  ACID (Atomicity, Consistency, Isolation, Durability) is a set of properties that ensure reliable operation of transactions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The components of a graph database are nodes and edges.  They can be supplemented with their own set of fields.  A model of such a database is schematically shown in the figure. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/4e7/85c/4d2/4e785c4d23e44db3a9ed5a62d8f2eeae"></div><br><br><h4>  Saving data in Neo4j </h4><br>  The nodestore.db file contains a certain size of records containing information about the Nodes: <br>  1. A label that indicates the record is active; <br>  2. Pointer to the first relation that this node contains; <br>  3. Pointer to the first property that this node contains. <br><br>  The node does not contain its own identifier.  Since each entry in nodestore.db occupies the same amount of space, you can calculate a pointer to a node. <br><br>  The relationshipstore.db file also contains records of the same size that describe relationships, but they consist of the following elements: <br><br>  1. A label that indicates the record is active; <br>  2. Pointer to the node that contains this relation; <br>  3. A pointer to the node to which this relationship is directed; <br>  4. Type of relationship; <br>  5. A pointer to the relationship that is ahead (within the limits of this node); <br>  6. A pointer to the relationship that is behind (within this node); <br>  7. A pointer to the relationship that is ahead (within the limits of the node in which this relationship is directed); <br>  8. A pointer to the relation that stands behind (within the limits of the node in which this relation is directed); <br>  9. A pointer to the first property of this relationship. <br><br><h4>  Filling data </h4><br>  In order to compare for efficiency, it is necessary to fill the database with the same content.  It is worth noting that this data should be large.  On small volumes, we will not see the difference.  Therefore, I set myself the goal to generate for the relational model no less than 300 megabytes. <br><br>  I have chosen a subject area - a social network.  I built an ER diagram, on the basis of which I created a relational and graph model. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/00c/dc9/c6a/00cdc9c6a4214d52a73bda9dab8a5111"></div><br><br>  After that, I filled MySQL with data, creating a class for generating this data and methods that contributed new data to the database. <br>  The amount of data that was entered in MySQL: <br><br>  addUsers (100,000);  - number of users. <br>  addGroups (200,000);  - number of groups. <br>  addPhotos (300,000);  - number of photos. <br>  addAudio (250,000);  - The number of audio recordings. <br>  addFriendships (1,000,000);  - number of friends. <br>  addMessages (4,000,000);  - number of messages. <br>  addUserAudio (350,000);  - The number of audio recordings. <br>  addUserGroups (400,000);  - the number of user groups. <br>  addUserPhoto (400,000);  - the number of photos of users. <br><br>  Then I converted this data to Neo4j.  It is worth noting that filling the database took me a lot of time.  If you decide to do something similar on your own, get ready for the fact that you either spend a lot of time or do not use text fields (I think it took a lot of time in my case).  After that, I compared the place that information occupies in Neo4j and MySQL.  There was a small shock; for a relational database, 351.5 MB was required, and for a graph database, 3.45 GB.  Now we will start experiments. <br><br><h4>  Experiment 1 </h4><br>  Experiment Description: measuring user search time by user ID. <br><br>  In this experiment, I searched for users by their ID a certain number of times.  For this, I wrote methods whose code is presented below. <br><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Database connection initialisation init(); int [] counts = {10, 100, 1000, 5000, 10000, 30000, 60000, 90000, 120000}; for(int i = 0; i &lt; counts.length; i++){ findUserByIDTest(counts[i]); } } static void findUserByIDTest(int count){ System.out.println("__________________________________"); System.out.println("STATISTIC FOR COUNT: " + count); { Random r = new Random(count); long time = - System.currentTimeMillis(); for (int i = 0; i &lt; count; i++) { int id = r.nextInt(100000); User u = MySQLDAO.getUserByID(id); } time += System.currentTimeMillis(); System.out.println("Time for MySQL:" + time); } { Random r = new Random(count); long time = - System.currentTimeMillis(); for (int i = 0; i &lt; count; i++) { int id = r.nextInt(100000); User u = Neo4jDAO.getUserByID(id);; } time += System.currentTimeMillis(); System.out.println("Time for Neo4j:" + time); } System.out.println("__________________________________"); }</span></span></code> </pre> <br>  After executing the program code, I made a table and drew a diagram for it.  The results pleased me.  Neo4j did a great job. <br><table border="1" width="632"><tbody><tr><td width="632" colspan="3">  User count = 100000 <br><br></td></tr><tr><td width="167">  Number of queries <br><br></td><td width="246">  Time for MySQL, ms <br><br></td><td width="219">  Time for Neo4j, ms <br><br></td></tr><tr><td width="167">  ten <br><br></td><td width="246">  four <br><br></td><td width="219">  9 <br><br></td></tr><tr><td width="167">  100 <br><br></td><td width="246">  34 <br><br></td><td width="219">  76 <br><br></td></tr><tr><td width="167">  1000 <br><br></td><td width="246">  286 <br><br></td><td width="219">  510 <br><br></td></tr><tr><td width="167">  5000 <br><br></td><td width="246">  1034 <br><br></td><td width="219">  1103 <br><br></td></tr><tr><td width="167">  10,000 <br><br></td><td width="246">  1340 <br><br></td><td width="219">  1187 <br><br></td></tr><tr><td width="167">  30,000 <br><br></td><td width="246">  3390 <br><br></td><td width="219">  1384 <br><br></td></tr><tr><td width="167">  60,000 <br><br></td><td width="246">  6876 <br><br></td><td width="219">  2102 <br><br></td></tr><tr><td width="167">  90000 <br><br></td><td width="246">  10537 <br><br></td><td width="219">  3175 <br><br></td></tr><tr><td width="167">  120,000 <br><br></td><td width="246">  14033 <br><br></td><td width="219">  3858 <br><br></td></tr></tbody></table><br><img src="//habrastorage.org/files/316/3f8/3b5/3163f83b5c9540e4956a13bf4e1a698f"><br><br><h4>  Experiment 2 </h4><br>  Experiment Description: measurement of the time spent by the user's friends with a change in the value of the interval of occurrence of identifiers for the search. <br><br>  In this experiment, I selected the range of valid identifier values ‚Äã‚Äãand searched for the user's friends with this identifier.  Then I changed this range and conducted the experiment again.  After that, I came out the corresponding table with the data on which I built the dependency graphs. <br><br><img src="//habrastorage.org/files/3ca/a4e/87b/3caa4e87b07448ae93bf23806cd935b9"><br><br>  In any case, the time of the graph base for searching for big data was less than that which is relative. <br><br><h4>  Experiment 3 </h4><br>  Experiment Description: measuring the time spent by the total number of photos for users who administer at least one group, depending on the range of values ‚Äã‚Äãof user IDs. <br><br>  This experiment is very similar to the previous one, but is more complex.  If the time values ‚Äã‚Äãin previous experiments with repetitions differed slightly, in this jumps much stronger.  Therefore, I conducted this experiment three times and compiled an appropriate table. <br><table border="1" width="672"><tbody><tr><td width="672" colspan="7">  User count = 100000, Photo count = 300000, User photo count = 400000 <br><br></td></tr><tr><td width="60"></td><td width="204" colspan="2">  experiment 1 <br><br></td><td width="204" colspan="2">  experiment 2 <br><br></td><td width="204" colspan="2">  experiment 3 <br><br></td></tr><tr><td width="60">  id range &lt; <br><br></td><td width="102">  Time for MySQL, ms <br><br></td><td width="102">  Time for Neo4j, ms <br><br></td><td width="102">  Time for MySQL, ms <br><br></td><td width="102">  Time for Neo4j, ms <br><br></td><td width="108">  Time for MySQL, ms <br><br></td><td width="96">  Time for Neo4j, ms <br><br></td></tr><tr><td width="60">  ten <br><br></td><td width="102">  299 <br><br></td><td width="102">  11339 <br><br></td><td width="102">  164 <br><br></td><td width="102">  92594 <br><br></td><td width="108">  456 <br><br></td><td width="96">  56575 <br><br></td></tr><tr><td width="60">  100 <br><br></td><td width="102">  10652 <br><br></td><td width="102">  2748 <br><br></td><td width="102">  674 <br><br></td><td width="102">  2400 <br><br></td><td width="108">  663 <br><br></td><td width="96">  2826 <br><br></td></tr><tr><td width="60">  1000 <br><br></td><td width="102">  7243 <br><br></td><td width="102">  4931 <br><br></td><td width="102">  5433 <br><br></td><td width="102">  2481 <br><br></td><td width="108">  5649 <br><br></td><td width="96">  1942 <br><br></td></tr><tr><td width="60">  5000 <br><br></td><td width="102">  22538 <br><br></td><td width="102">  5521 <br><br></td><td width="102">  23747 <br><br></td><td width="102">  2408 <br><br></td><td width="108">  23522 <br><br></td><td width="96">  3514 <br><br></td></tr><tr><td width="60">  10,000 <br><br></td><td width="102">  47755 <br><br></td><td width="102">  5627 <br><br></td><td width="102">  44917 <br><br></td><td width="102">  2650 <br><br></td><td width="108">  44992 <br><br></td><td width="96">  1844 <br><br></td></tr><tr><td width="60">  30,000 <br><br></td><td width="102">  137572 <br><br></td><td width="102">  8161 <br><br></td><td width="102">  33856 <br><br></td><td width="102">  3108 <br><br></td><td width="108">  136592 <br><br></td><td width="96">  3707 <br><br></td></tr><tr><td width="60">  60,000 <br><br></td><td width="102">  64002 <br><br></td><td width="102">  13577 <br><br></td><td width="102">  300814 <br><br></td><td width="102">  5004 <br><br></td><td width="108">  280672 <br><br></td><td width="96">  6029 <br><br></td></tr><tr><td width="60">  90000 <br><br></td><td width="102">  482329 <br><br></td><td width="102">  13475 <br><br></td><td width="102">  438875 <br><br></td><td width="102">  5102 <br><br></td><td width="108">  429304 <br><br></td><td width="96">  5631 <br><br></td></tr></tbody></table><br><br><div style="text-align:center;"><img src="//habrastorage.org/files/16c/3c3/fc7/16c3c3fc74b547bca04c37f8e39a4410"></div><br><div style="text-align:center;"><img src="//habrastorage.org/files/8b2/4f2/98d/8b24f298d53449d5aca537ccda2d1b89"></div><br><div style="text-align:center;"><img src="//habrastorage.org/files/861/3c3/2d1/8613c32d102f4c1d95eb5357ea95d959"></div><br><br>  After discussions on Habr√©, I tried changing the approach to the conditions of the experiment: corrected the query, for a simpler one, raised MySQL again before each experiment and maintained conditions that MySQL and Neo4j should not work at the same time.  The following happened: the MySQL graph became more stable, and the graph database began to lose a lot of relational data on small amounts of data. <br><br><table width="385"><tbody><tr><td width="117"></td><td colspan="2" width="268">  experiment 1 <br></td></tr><tr><td>  id range &lt; <br></td><td>  Time for MySQL, ms <br></td><td>  Time for Neo4j, ms <br></td></tr><tr><td>  ten <br></td><td>  120 <br></td><td>  10767 <br></td></tr><tr><td>  100 <br></td><td>  690 <br></td><td>  10706 <br></td></tr><tr><td>  1000 <br></td><td>  5879 <br></td><td>  10884 <br></td></tr><tr><td>  5000 <br></td><td>  24668 <br></td><td>  12245 <br></td></tr><tr><td>  10,000 <br></td><td>  52462 <br></td><td>  12280 <br></td></tr><tr><td>  30,000 <br></td><td>  154534 <br></td><td>  13352 <br></td></tr><tr><td>  60,000 <br></td><td>  296369 <br></td><td>  14545 <br></td></tr><tr><td>  90000 <br></td><td>  489830 <br></td><td>  18058 <br></td></tr></tbody></table><br><img src="//habrastorage.org/files/18e/1db/a52/18e1dba52bd34490bb215449e645dd46"><br><br><h4>  Modest conclusions </h4><br>  I can safely say that the graph database requires much less time in searching on large amounts of data, but it takes up much more space on the hard disk.  Therefore, for small systems, it is better to use a relational database or look for an alternative among other NoSQL databases. <br><br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/258179/">https://habr.com/ru/post/258179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258169/index.html">NeoQUEST-2015: HeartBleed, Android and a little bit of reverse</a></li>
<li><a href="../258171/index.html">Secrets of the Madrid court. Part 2.5: Answers to readers' questions on the previous part</a></li>
<li><a href="../258173/index.html">Launch of the Virtual Private Cloud service</a></li>
<li><a href="../258175/index.html">Multicellular microprocessor, "macrocycles" for working with arrays</a></li>
<li><a href="../258177/index.html">Roskomnadzor and his plans</a></li>
<li><a href="../258181/index.html">Minim bitcoin with paper and pen</a></li>
<li><a href="../258183/index.html">Certificate Authority AD + Smart Card = Authorization of the user in the domain</a></li>
<li><a href="../258185/index.html">About transferring a project from Objective-C to Swift</a></li>
<li><a href="../258189/index.html">The history and future of special features</a></li>
<li><a href="../258193/index.html">nanoCAD Plus 7: the development of CAD platform a year-long</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>