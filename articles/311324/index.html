<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to stop worrying and conquer Windows Update?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article talks about the new functionality of Parallels Desktop 12 , which allows you to control the installation of updates and the maintenance o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to stop worrying and conquer Windows Update?</h1><div class="post__text post__text-html js-mediator-article"><img width="180" height="180" src="https://habrastorage.org/files/d24/901/d0f/d24901d0f7bb49e4a19b8bf43eefc6c2.gif" alt="image" align="left">  This article talks about the new functionality of <a href="https://habrahabr.ru/company/parallels/blog/307996/">Parallels Desktop 12</a> , which allows you to control the installation of updates and the maintenance of Windows 10. Everyone remembers 1995, when Windows acquired the desktop with icons, taskbar, and the Start menu.  For some reason, far from everyone remembers the more significant 1998 year - and it was then that the Update Center appeared in Windows.  Now users have always had the most current and secure version of the operating system on their computers. <a name="habracut"></a><br><br>  The speed of Internet access was such that you did not clear things up, so at first, through the Windows Update website, add-ons and new technologies came to user computers only for the Windows operating system itself.  Then security fixes for other applications started shipping.  The more updates offered, the more files needed to be downloaded. <br><br><img src="https://habrastorage.org/files/314/06a/1d2/31406a1d254642c5866a4277449f5b29.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All versions of Windows prior to Windows 8, inclusive, allowed to choose which updates will be installed on this computer. <br><br><img src="https://habrastorage.org/files/c4b/0d5/b05/c4b0d5b053fd4da1b2a34f457bc0b21e.jpg"><br><br>  In the current version of Windows 10, there is no choice - the user can refuse to update other Microsoft products other than the operating system, postpone updates for several days and ask the system not to install updates without his knowledge.  But even updating the operating system alone in our time is far from a pound of raisins. <br><br><img src="https://habrastorage.org/files/caf/dd2/567/cafdd2567dd94953ab48cc8b68131349.png"><br><br>  The system is updated literally all the time.  Every day there are new signatures for the built-in antivirus, updates for Windows components and whole new versions, such as Windows 10 Anniversary Update.  On the one hand, the functionality of a Windows update that is transparent to the user, by definition, should be convenient if this process makes life easier for the user, rather than distracting him.  On the other hand, there are users who are very unhappy with Windows Update.  Look at popular searches in the search engine. <br><br><img src="https://habrastorage.org/files/74c/962/239/74c962239b5545dd8d353516b7a3664e.png"><br><br>  Some fundamentally do not like the fact that the system is constantly doing something without their knowledge, but most users experience discomfort for significantly more prosaic reasons - downloading and installing updates absorbs the traffic and computer resources.  On a PC, as a rule, this happens when the computer is not in use, and users will find out about the next update, after hearing the noise of the hard disk or the fan of the abandoned computer, or seeing something that seems to be an unprovoked suggestion to reboot. <br><br>  The Windows maintenance mechanism that works when the system is idle has appeared in Windows 8. It controls the frequency of starting most tasks from the scheduler, such as collecting various statistics, sending telemetry, defragmentation, anti-virus control sessions, etc. <br><br><h3>  <font color="#cc0000">What about the Mac?</font> </h3><br>  The Windows 10 virtual machine on the Mac ‚Äúlives‚Äù somewhat differently, and the Windows update script in it is different from the usual PC script.  The main difference is that it does not work exclusively. <br><br>  <b>Therefore, two unpleasant scenarios often arise:</b> <br>  1) While the virtual machine is running in the background, the user, as usual, works with the main system or another virtual machine.  The problem is that Windows in the first virtual machine does not know that the computer is used for other tasks, and begins to download and install updates, as well as run other tasks that must be performed while idle. <br><br>  2) The virtual machine is started for the first time after a long break.  And first of all, it starts looking for operating system updates on the Internet and launching missed tasks from the task scheduler.  The user is puzzled: he simply started Windows in order to disintegrate the ‚Äúkerchief‚Äù according to the old memory or pass through the minefield, and the system shamelessly slows down! <br><br><img width="450" height="450" src="https://habrastorage.org/files/344/c60/867/344c60867a9b4fd4bbc7f6baf5a093da.jpg" alt="image" align="left">  What does this lead to?  Many users who are working on a PC would not have noticed anything, complaining that the Windows virtual machine on the Mac constantly installs something, reboots the system, corrupts some settings, etc.  In actual fact, cases of non-performance of Windows after installing updates are known, but, of course, not on a catastrophic scale. <br><br>  The main problem lies in the fact that the Windows virtual machine running in the background believes that there is no one at the computer and takes on too much - it starts installing updates, defragmenting disks, etc. This creates a serious performance problem, increasing the load on disk and network ‚Äî especially if there are several virtual machines.  And all because Windows Update downloads hundreds of megabytes from the Internet every month, and every day it also downloads some updates, antiviruses for programs.  Computer performance decreases, it suddenly starts to make noise, heat up and quickly use up battery resources.  Negative user experience, as they say, is inevitable. <br><br>  It must be said that in the corporate environment, where the updating and maintenance of computer systems is put on stream, these problems are solved more easily.  If your company uses, for example, Windows 10 Enterprise and Windows Server Update Services, then even in Windows 10 you can configure the execution of all update, maintenance and reboot operations on a schedule.  But not all of our users work in corporate networks. <br><br><h3>  <font color="#cc0000">What did we do?</font> </h3><br>  After studying the problem, we made the inevitable conclusion - the virtual machine should be taught to correctly understand the state of the host computer (host).  We also decided to implement the traditional mechanism for launching maintenance procedures on a schedule, but without solving the main problem, this would be a half-measure. <br><br>  Therefore, the main thing that we have done is that we have taught our Parallels Desktop system to transfer idle state from a host to a virtual machine.  And if on the Mac there is input from the keyboard, mouse, etc., then the Windows virtual machine finds out about it and does not go into an idle state. <br><br>  The easiest way to do this would be to simulate device input from within the virtual machine ‚Äî so appreciate that we chose the less invasive, documented method SetThreadExecutionState (ES_DISPLAY_REQUIRED).  The function clears the display idle timer, so if you ever write a video player for Windows, this call will definitely come in handy. <br><br>  Of course, we have not forgotten about the option to manage Windows update and maintenance on a schedule.  Since no one on the market has yet implemented the correct way to disable automatic updates for Windows 10, we did it ourselves.  Parallels Desktop temporarily disables the maintenance mechanism for scheduled tasks of the Update Center.  The settings interface of the virtual machine with Windows 10, we added the tab "Maintenance", which allows you to configure the schedule for updates and maintenance of Windows.  Each virtual machine can be configured individually.  Thus, our functionality temporarily disables the maintenance and updating tasks of Windows, the Windows Store program, Microsoft Office, the built-in antivirus, and starts them only at the time that the user has assigned in the virtual machine settings.  And now the virtual machine only slows down when it should do so on a schedule. <br><br>  You can schedule maintenance periods at night or on weekends.  This is a more convenient solution than the version implemented in Windows 10. In our version, all Windows maintenance tasks ‚Äî updates, antivirus checks, defragmentation, telemetry collection, and so on ‚Äî are performed in one session in a fairly short amount of time.  Tasks are completed, the computer restarts, if necessary, and everything is ready - the virtual machine is updated and will not interfere with your work. <br><br>  Here you can remember that in corporate networks these problems have already been resolved, which means that our enterprise IT administrators seem to have no need for our functionality.  In fact, any complex administrative task can and should have more than one good solution, and since we have included our functionality in Parallels Desktop, this allows administrators to solve this problem in another way - through the massive introduction of Parallels Desktop with virtual machines, pre-configured to optimize system upgrades and maintenance. <br><br><h3>  <font color="#cc0000">Or maybe completely disable it?</font> </h3><br>  There are users - there are quite a lot of them, especially among non-professional users - who would not mind permanently disabling updates to Windows 10, leaving perhaps the possibility of updating the antivirus.  Let's be honest - we are against. <br><br><img width="260" height="260" src="https://habrastorage.org/files/756/eb9/c6f/756eb9c6f9a545368211aea0e5e00aea.png" alt="image" align="left">  Yes, in the case of the Windows 10 operating system, Microsoft has shown itself, so to speak, from positions of strength, but there is a reason for such a decision.  Updates are needed both in terms of security, and in terms of the relevance of technology, and in terms of the performance of software components.  If twenty years ago it was more or less indifferent, you work with the Windows version released this year, a year ago or five years ago, now every year in the world of technology there is a huge leap.  Even a browser, released just a year ago, can let you down when working with new websites, and the antivirus and network security system that has not been updated since last year will become a hotbed of viruses and a ‚Äúspyware find.‚Äù <br><br><h3>  <font color="#cc0000">Outsider tips</font> </h3><br>  The most important thing in the new functionality of Parallels Desktop 12 for Mac that we have implemented in terms of updating Windows is the possibility of personalizing it.  It is important for us that users know about it and can enable it.  By default, we do not run it, because this functionality is not in the standard Windows.  In addition, if we enable it by default, we will have to offer users a certain non-alternative mode of its operation.  It seems to us that this is wrong. <br><br>  Thus, at the moment, users who need to optimize the update and maintenance of the Windows virtual machine include and configure it themselves.  Statistics show that about 20% of our users do this - one can assume that these are the same 20% of professional users that can be identified from any community. <br><br><img src="https://habrastorage.org/files/45c/b9b/778/45cb9b7788d449b48f76288f9497eb92.gif"><br><br>  Perhaps in the future we will come up with an adaptive algorithm that will not require manual adjustment of the maintenance time, and then it will be possible to enable this functionality automatically.  For those who want to set up their virtual machines, but do not know at what time, we can suggest to start by trying daily maintenance at 24:00 and see what will come of it - very soon you will find the optimal mode for your case. </div><p>Source: <a href="https://habr.com/ru/post/311324/">https://habr.com/ru/post/311324/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311314/index.html">Purple screen videos and other 3 Dell abilities</a></li>
<li><a href="../311316/index.html">Reference algorithm in Excel by VF Shatalov</a></li>
<li><a href="../311318/index.html">Video Recording of the Data Scientist Tools Webinar</a></li>
<li><a href="../311320/index.html">VP8, VP9 and H265. Hardware accelerated video encoding and decoding in 6th generation Skylake processors</a></li>
<li><a href="../311322/index.html">Sunset stack overflow</a></li>
<li><a href="../311328/index.html">Artificial Intelligence in Excel predicts the gold medal winner in the men's tournament at Rio 2016</a></li>
<li><a href="../311330/index.html">We harness R for business service at "1-2-3"</a></li>
<li><a href="../311332/index.html">Moscow Droidcon 2016: a side view</a></li>
<li><a href="../311334/index.html">Manage dependencies in Swift iOS apps with peace of mind</a></li>
<li><a href="../311336/index.html">8 tips on lead generation from Khalisi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>