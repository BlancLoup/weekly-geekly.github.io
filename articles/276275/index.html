<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Genemba - code generator for iOS development</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL; DR 
 We wrote a cool code generator for iOS development, with the following advantages: 


- Swift and Objective-C support, 
- Using liquid markup...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Genemba - code generator for iOS development</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/a37/c38/ef9/a37c38ef9b23a0169b635dfc4f55956e.jpg" alt="image"><br><br>  <b>TL; DR</b> <br>  We wrote a <a href="https://github.com/rambler-ios/Generamba">cool code generator</a> for iOS development, with the following advantages: <br><ul><li>  <b>Swift and Objective-C</b> support, </li><li>  Using <b>liquid</b> markup language to create templates </li><li>  Flexible <b>template management system</b> </li><li>  Integration with <b>Cocoapods</b> dependency <b>manager</b> . </li></ul><br>  More details - under the cut. <br><a name="habracut"></a><br>  Serious decisions regarding the architecture of the project bear the need to make a certain compromise.  We stick to the <a href="https://en.wikipedia.org/wiki/Multitier_architecture">n-tier structure</a> - we get some amount of empty forwarding of information between the layers.  We parallelize tasks on several threads - spend a huge amount of time on solving non-obvious bugs.  In a similar situation requiring a compromise, we also encountered at <b>Rambler &amp; Co</b> , deciding to use <b>VIPER</b> as the standard of architecture for all our mobile applications.  Having received excellent modularity and a clear separation of component responsibilities, we acquired a headache in the form of the complexity and monotony of the process of creating new modules. <br><br>  The average iOS developer at the beginning of work on the new screen simply creates one class.  The one who made a willful decision to switch to VIPER, at this moment begins to suffer.  In most cases, he needs to create <b>five classes, six protocols and write five test cases</b> .  Suppose that to create new modules, our poor fellow will hire a professional secretary with a huge print speed - but even in this case, he is unlikely to go beyond 30 seconds to create and fill out one file.  Apply the small knowledge of mathematics, which has given the nature of mobile developers, multiply these numbers and get an answer <b>in the region of 10 minutes</b> .  During the same time, the average developer will have time to distribute a couple of hundred lines of the UITableViewDataSource, send several network requests and paint all the view's in a beautiful azure color.  Somehow unfair to the work of our VIPER-guru. <br><img src="https://habrastorage.org/files/f18/0a1/9d4/f180a19d47a64fed9df8c0a6e1c300dc.jpeg"><br>  But heavy and tedious manual labor is not the only problem.  Repetitive with every module misprints, which every day more and more drags the project to the muddy bottom of broken deadlines, are no less a headache. <br><img src="https://habrastorage.org/files/1bb/33f/171/1bb33f171ef149fca47d9be7eb1fbb38.jpeg"><br>  One of the ways to solve these problems, which we have used for a long time, is to create our own templates for Xcode.  Apart from the fact that such an approach is simply not sporty, for ourselves we identified a number of relatively serious flaws. <br><ul><li>  Xcode is <b>not the most stable IDE</b> , and periodically when it is updated, templates, plug-ins and other body kits can successfully fly. </li><li>  <b>There is no convenient mechanism for</b> adding new templates, let alone getting updates. </li><li>  Basically, there is no possibility of adding generated files to <b>different project targets</b> . </li><li>  <b>The syntax is infinitely inconvenient and complicated</b> , especially for someone who needs just ten to draw a template for a project in ten minutes. </li></ul><br>  But, of course, everyone understands that he was most upset by another, fatal, flaw - the solution was not written by us.  There is too little control over it, and extensibility for more specific tasks tends to zero.  That's why we decided to write our code generator - <b>Genembu</b> .  I will immediately clarify a very important thesis - even though we started the project in order to simplify the process of creating VIPER modules, but as a result we received a much more flexible utility that can help automate a wide range of code generation and standardization tasks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      From the moment of installing Genremba ( <i>gem install generamba</i> ) before creating your first module, you need to go through three steps: <br><ul><li>  <i>generamba setup</i> starts the process of setting up a genremba for working with a specific project.  At this point, set the standard paths for files, test settings, dependency managers and other infrastructure.  As a result of the command, we get the configuration file of the project - <i>Rambafile</i> . </li><li>  <i>generamba template install</i> launches the installation process of the <i>templates</i> specified in the <i>Rambafile</i> . </li><li>  <i>generamba gen HabrahabrModule rviper_controller</i> already directly creates a new <i>HabrahabrModule</i> module using the <i>rviper_controller</i> template. </li></ul><br>  For the work of Generamb uses several resources: <br><ul><li>  Rambafile is a configuration file containing everything that the user specified during the execution of the setup command, as well as links to the templates and their directories, </li><li>  One or more templates that can be specified when creating a new module, </li><li>  User settings (for example, the name of the author). </li></ul><br>  The first two points boldly fall under Git, and the settings tied to the user are in a project-independent directory. <br><div class="spoiler">  <b class="spoiler_title">Rambafile Example</b> <div class="spoiler_text"><pre><code class="hljs pgsql">### Headers settings company: Rambler&amp;Co ### Xcode project settings project_name: GenerambaSandbox prefix: RDS xcodeproj_path: GenerambaSandbox.xcodeproj ### Code generation settings section # The main project target <span class="hljs-type"><span class="hljs-type">name</span></span> project_target: GenerambaSandbox # The file <span class="hljs-type"><span class="hljs-type">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> modules project_file_path: GenerambaSandbox/Classes/Modules # The Xcode <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-type"><span class="hljs-type">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> modules project_group_path: GenerambaSandbox/Classes/Modules ### Tests generation settings section # The tests target <span class="hljs-type"><span class="hljs-type">name</span></span> test_target: GenerambaSandboxTests # The file <span class="hljs-type"><span class="hljs-type">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> tests test_file_path: GenerambaSandboxTests/Classes/Modules # The Xcode <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-type"><span class="hljs-type">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> tests test_group_path: GenerambaSandboxTests/Classes/Modules ### Dependencies settings section podfile_path: Podfile cartfile_path: Cartfile ### Templates catalogs: - <span class="hljs-string"><span class="hljs-string">'https://github.com/rambler-ios/generamba-catalog'</span></span> - <span class="hljs-string"><span class="hljs-string">'https://github.com/igrekde/my-own-catalog'</span></span> templates: - {<span class="hljs-type"><span class="hljs-type">name</span></span>: rviper_controller} - {<span class="hljs-type"><span class="hljs-type">name</span></span>: local_template_name, <span class="hljs-keyword"><span class="hljs-keyword">local</span></span>: <span class="hljs-string"><span class="hljs-string">'absolute/file/path'</span></span>} - {<span class="hljs-type"><span class="hljs-type">name</span></span>: remote_template_name, git: <span class="hljs-string"><span class="hljs-string">'https://github.com/igrekde/remote_template'</span></span>}</code> </pre> </div></div><br><br>  Special mention is worthy of working with templates.  Unlike many other generators, we do not sew templates into the utility itself - instead, we have built in a more flexible system, spied on by dependency managers (read, Cocoapods).  New templates can be installed using one of the following ways: <br><ul><li>  Local template (copied from the specified folder) </li><li>  Deleted template (cloned from specified repository) </li><li>  Template from the catalog (in the repositories with the used directories, a suitable template is searched for by name). </li></ul><br>  After several months of using Genermba on our projects, the most frequently used pattern emerged - a project catalog is created for the project, within which all, even the least frequently used templates are stored.  Over time, some of these solutions, sharpened for a specific project, after certain improvements, fall <a href="https://github.com/rambler-ios/generamba-catalog">into our public spec</a> . <br><br>  As I already mentioned, we were confused by the complexity of the markup of standard Xcode templates, and the <a href="https://github.com/Shopify/liquid">template engine liquid</a> was chosen as a tool to combat this problem - not only with a simple, convenient and understandable syntax, but also with a bunch of additional bonuses that can be found application not only in the frontend, but also during code generation. <br><br>  For comparison, the Xcode template: <br><div class="spoiler">  <b class="spoiler_title">InteractorTemplate.h</b> <div class="spoiler_text"><pre> <code class="hljs markdown">// // <span class="hljs-strong"><span class="hljs-strong">___VARIABLE_viperModuleName__</span></span><span class="hljs-strong"><span class="hljs-strong">____FILENAME__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_ // _</span></span><span class="hljs-strong"><span class="hljs-strong">__PROJECTNAME__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_ // // Created by _</span></span><span class="hljs-strong"><span class="hljs-strong">__FULLUSERNAME__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_ on _</span></span><span class="hljs-strong"><span class="hljs-strong">__DATE__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_ // Copyright _</span></span><span class="hljs-strong"><span class="hljs-strong">__YEAR__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_ _</span></span><span class="hljs-strong"><span class="hljs-strong">__ORGANIZATIONNAME__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_. All rights reserved. // #import "_</span></span><span class="hljs-strong"><span class="hljs-strong">__VARIABLE_viperModuleName:identifier__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_Interactor.h" #import "_</span></span><span class="hljs-strong"><span class="hljs-strong">__VARIABLE_viperModuleName:identifier__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_InteractorOutput.h" @implementation _</span></span><span class="hljs-strong"><span class="hljs-strong">__VARIABLE_viperModuleName:identifier__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_Interactor #pragma mark - _</span></span><span class="hljs-strong"><span class="hljs-strong">__VARIABLE_viperModuleName:identifier__</span></span>_InteractorInput @end</code> </pre> </div></div><br>  Liquid template for the same file: <br><div class="spoiler">  <b class="spoiler_title">InteractorTemplate.liquid</b> <div class="spoiler_text"><pre> <code class="hljs django"><span class="xml"><span class="xml">// // </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ module_info.name }}</span></span><span class="xml"></span><span class="hljs-template-variable"><span class="xml"></span><span class="hljs-template-variable">{{ module_info.file_name }}</span></span><span class="xml"><span class="xml"> // </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ module_info.project_name }}</span></span><span class="xml"><span class="xml"> // // Created by </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ developer.name }}</span></span><span class="xml"><span class="xml"> on </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ date }}</span></span><span class="xml"><span class="xml">. // Copyright </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ year }}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ developer.company }}</span></span><span class="xml"><span class="xml">. All rights reserved. // #import "</span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{module_info.name}}</span></span><span class="xml"><span class="xml">Interactor.h" #import "</span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{module_info.name}}</span></span><span class="xml"><span class="xml">InteractorOutput.h" @implementation </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{module_info.name}}</span></span><span class="xml"><span class="xml">Interactor #pragma mark - </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{module_info.name}}</span></span><span class="xml"><span class="xml">InteractorInput @end</span></span></code> </pre> </div></div><br><br>  We continue to actively develop the Genermbu.  In addition to everyday tasks, we also look at other areas: <br><ul><li>  <b>add GUI</b> , including in the form of plugins for IDE, </li><li>  support for <b>Android</b> projects </li><li>  fiction requiring work with an AST-tree - for example, <b>autogeneration of test cases</b> according to the described protocols or mocks for swift-classes. </li></ul><br>  As a conclusion, I would like to add that Generamba served as an excellent illustrative example of the benefits of automation of quite trivial tasks - we will transfer the experience gained to other areas of the department‚Äôs activities, which would not hurt to get rid of manual labor. <br><br>  Have you decided to start using Generamba?  Ask your questions and write about the issues found in the <a href="https://github.com/rambler-ios/Generamba/issues">issues</a> - our community, although small, is quite active. <br><br>  <b>Useful links:</b> <br><ul><li>  <a href="https://github.com/thoughtbot/liftoff">liftoff, for generating Xcode projects</a> , </li><li>  <a href="https://github.com/rambler-ios/The-Book-of-VIPER">VIPER Book</a> , </li><li>  <a href="https://github.com/rambler-ios/Generamba/wiki">Documentation of the Genamba</a> , </li><li>  Speech at Rambler.iOS V about Genembu: <a href="http://www.slideshare.net/Rambler-iOS/viper-56423582">slides</a> , <a href="http://www.youtube.com/watch%3Fv%3DNXNiN9FaUnY">video</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/276275/">https://habr.com/ru/post/276275/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276257/index.html">The "energy" Trojan BlackEnergy is introduced through a vulnerability in Microsoft Office 2013</a></li>
<li><a href="../276259/index.html">The digest of interesting materials for the mobile # 138 developer (January 24-31)</a></li>
<li><a href="../276269/index.html">Tor Browser 5.5 released</a></li>
<li><a href="../276271/index.html">Conceptual description of individuals</a></li>
<li><a href="../276273/index.html">XAML Developer Chips: Composite Converters</a></li>
<li><a href="../276277/index.html">The Complete Guide to Using ASP.NET Core 1.0 (aka ASP.NET 5) Tag Helpers</a></li>
<li><a href="../276281/index.html">Procedurally Generated World Maps on Unity C #, Part 2</a></li>
<li><a href="../276283/index.html">PHP Digest number 78 - interesting news, materials and tools (January 18 - 31, 2016)</a></li>
<li><a href="../276285/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ196 (January 25 - 31, 2016)</a></li>
<li><a href="../276289/index.html">Azure student offer adds support for SQL Azure and Mobile Apps</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>