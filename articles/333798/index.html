<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Stantinko: large-scale adware campaign, operating since 2012</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Adware is not the easiest type of malware to analyze. Having discovered the complex threat of Stantinko, we did not immediately understand what it was...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Stantinko: large-scale adware campaign, operating since 2012</h1><div class="post__text post__text-html js-mediator-article">  Adware is not the easiest type of malware to analyze.  Having discovered the complex threat of Stantinko, we did not immediately understand what it was: adware, malware or spyware.  It took time to identify its goals and patterns, as the threat leaves not many traces on the infected machine.  Understanding the Stantinko ecosystem is about how to assemble a puzzle. <br><br>  Stantinko specializes in advertising fraud, but stands out against the general background of technical complexity.  Code encryption and operational adaptation to protect against detection by antivirus allowed Stantinko operators to remain out of sight for at least five years.  In addition, attention is drawn to the scale of Stantinko - this is one of the most common cyber threats in Russia, with a botnet of about 500,000 devices. <br><br><img src="https://habrastorage.org/web/12b/f2b/7b8/12bf2b7b8b504c2a8ad8dee1380ad38d.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><h3>  Overview </h3><br>  To infect the system, Stantinko operators are misleading users who search for pirated software and download executable files, sometimes disguised as torrents.  Next FileTour, the initial infection vector, demonstratively installs a multitude of programs to divert the user's attention from the hidden installation of the first Stantinko service in the background.  Video 1 shows how a user launches a malicious .exe file. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OYncoW7X5wA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i>Video 1. The user downloads and runs a malicious file.</i> <br><br>  Stantinko operators control the botnet and monetize it, mainly by installing malicious browser extensions for the unauthorized introduction of advertising and clickfrood.  The problem is that they do not stop at that.  Malicious services allow you to execute anything on the infected system.  We watched sending a full-featured backdoor, a mass search bot on Google, as well as utilities for brute-force attacks on Joomla and WordPress control panels (designed for hacking and possible resale). <br><br>  The figure below shows the complete Stantinko cyber campaign, from the infection vector to permanent services and the corresponding plug-ins. <br><br><img src="https://habrastorage.org/web/dcb/e19/51f/dcbe1951f9864666bc393784f1c74c2e.png"><br>  <i>Figure 1. Complete Stantinko Threat Scheme</i> <br><br><h3>  Key parameters </h3><br>  A characteristic feature of Stantinko is antivirus detection bypass and counter-reverse engineering, which determines malicious behavior.  To conduct a comprehensive threat analysis, several components are needed - a bootloader and an encrypted component.  The malicious code is hidden in an encrypted component that is either on the disk or in the Windows registry.  The code is loaded and decoded by an executable file that is seemingly harmless at first glance.  A key is generated for each of the infections.  Some components use the bot ID, others use the serial number of the victim‚Äôs hard drive volume.  Detection by unencrypted components is an extremely difficult task, since artifacts stored on disk do not show malicious behavior prior to execution. <br><br>  In addition, Stantinko provides a recovery mechanism.  After a successful infection, two malicious services are installed on the victim's machine with the Widnows operating system and run together with the system.  Services can reinstall each other if one of them is deleted.  Thus, in order to successfully eliminate a threat, you must simultaneously remove two services.  Otherwise, the C &amp; C server will send a new version of a remote service that has not yet been discovered or contains a new configuration. <br><br>  The main functionality of Stantinko is the installation of <i>The Safe Surfing</i> and <i>Teddy Protection</i> browser extensions on the infected system.  At the time of analysis, both extensions were available in the Chrome Web Store.  At first glance, these are legitimate browser extensions that block unwanted URLs.  But when installed as part of the Stantinko scheme, extensions are given a different configuration, containing the rules for click-promotion and unauthorized advertising.  Video 2 shows the installation process for <i>The Safe Surfing</i> .  Clicking on the link, the user is redirected to the Rambler search engine. <br><br><img src="https://habrastorage.org/web/48e/c2d/275/48ec2d275e554fa6b2cc6a9b6c6fd26c.png"><br>  <i>Figure 2. Teddy Protection in the Chrome Web Store</i> <br><br><img src="https://habrastorage.org/web/71f/4ed/cf5/71f4edcf58eb4fff975e4d4633c04c1e.png"><br>  <i>Figure 3. The Safe Surfing in the Chrome Web Store</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/FirDn0O-PTY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i>Video 2. Forwarding traffic to the Rambler site</i> <br><br>  Stantinko - modular backdoor.  Its components include a bootloader that allows you to execute any executable Windows file that is transferred by the C &amp; C server directly into memory.  This feature is implemented as a flexible plug-in system that allows operators to do whatever they want on an infected system.  The table below provides a description of Stantinko plugins known to us. <br><br><img src="https://habrastorage.org/web/973/254/0e6/9732540e6335405b9c7eea1439d32c25.png"><br><br><h3>  Monetization </h3><br>  Stantinko developers use methods that are more common in APT campaigns.  However, their main goal is money.  Operators offer their services in the most profitable markets for computer crimes. <br><br>  First, the clickfrod today is a major source of income in the cybercriminal ecosystem.  <a href="https://www.ana.net/content/show/id/botfraud-2017">A study</a> conducted by White Ops and the National Association of Advertisers (USA), estimated the global cost of clickfrood in 2017 at 6.5 billion US dollars. <br><br>  As already described above, Stantinko installs two browser extensions - <i>The Safe Surfing</i> and <i>Teddy Protection</i> , which show ads or redirect.  This allows Stantinko operators to get paid for the traffic they provide to advertisers.  The figure below shows the redirection scheme. <br><br><img src="https://habrastorage.org/web/e2c/07c/6d8/e2c07c6d84874592b4ed1e21c5c1f4cb.png"><br>  <i>Figure 4. Clickfrod, redirection process</i> <br><br>  Traditional clickframe schemes are built on a series of redirections between several ad networks to ‚Äúlaunder‚Äù traffic.  But in the case of Stantinko, the operators are closer to the advertisers - in some cases (see Figure 4), the user gets to the advertiser's site immediately from the Stantinko network.  This means that the attackers behind the Stantinko campaign can not only effectively hide the malware, but also disrupt the traditional advertising economy, and this gets away with it. <br><br>  Secondly, the operators of Stantinko are trying to gain access to the control panels of sites on Joomla and WordPress.  The attack is built on brute-force with enumeration of logins and passwords in the list.  The goal is to guess the password by trying tens of thousands of combinations.  Hacked accounts can be resold and then used to redirect site visitors to a set of exploits or to post malicious content. <br><br>  Thirdly, our study revealed how Stantinko works in social networks.  We already described this type of fraud in <a href="https://www.welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf">a Linux / Moose report</a> .  The scheme really makes a profit - 1000 likes on Facebook cost about $ 15 (even if they are generated by fake accounts in the botnet). <br><br>  Operators Stantinko have developed a plugin that interacts with Facebook.  In addition, he can create accounts, like the page and add friends.  To bypass captcha on Facebook, he uses a special service (in Figure 5).  The scale of the Stantinko network is an advantage of the operators, because it allows them to distribute requests among all bots - this complicates Facebook‚Äôs task of recognizing fraud. <br><br><img src="https://habrastorage.org/web/0e3/e84/b9c/0e3e84b9c8344cf397e1067f1c7b3ff0.png"><br>  <i>Figure 5. Captcha bypass service used by Stantinko</i> <br><br><h3>  Conclusion </h3><br>  Stantinko is a botnet that specializes in advertising fraud.  Advanced technologies, including code encryption and code storage in the Windows registry, allowed operators to go unnoticed for five years. <br><br>  In addition, the operators of Stantinko managed to put in the Chrome Web Store two browser extensions that performed unauthorized advertising.  One of them first appeared in the Chrome Web Store in November 2015. <br><br>  The user is unlikely to notice the presence of Stantinko in the system, since the threat does not overload the CPU.  On the other hand, Stantinko brings losses to advertisers and significant revenue to operators.  In addition, the presence of a full-featured backdoor allows attackers to monitor all infected machines. <br><br>  Main conclusions: <br><br><ul><li>  About 500,000 computers compromised by Stantinko </li><li>  The main objectives are Russia (46%) and Ukraine (33%) </li><li>  Stantinko operators monetize the botnet by installing browser extensions for unauthorized advertisements </li><li>  The components remaining on the disk use a custom code obfuscator, which complicates the threat analysis process. </li><li>  In most Stantinko components, the malicious code is hidden inside legitimate free open source software that has been modified and recompiled. </li><li>  Stantinko installs several permanent services that can restore each other, preventing removal from the system. </li><li>  The most common use of Stantinko is advertising fraud.  However, its capabilities are much wider.  We‚Äôve watched sending a full-featured backdoor for remote administration, a mass search bot to Google and utilities for brute-force attacks on Joomla and WordPress dashboards </li></ul><br>  <i>Infection indicators are available in our account on <a href="https://github.com/eset/malware-ioc/tree/master/stantinko">GitHub</a> .</i>  <i>For any questions regarding Stantinko, including sample transfer, write to threatintel@eset.com.</i> </div><p>Source: <a href="https://habr.com/ru/post/333798/">https://habr.com/ru/post/333798/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../333788/index.html">MMO from scratch. Using Netty and the Unreal Engine. Part 1</a></li>
<li><a href="../333790/index.html">Asterisk func_odbc or strange ael</a></li>
<li><a href="../333792/index.html">Bluetooth SIG announces bluetooth mesh network</a></li>
<li><a href="../333794/index.html">The system of electronic queue in the banking business</a></li>
<li><a href="../333796/index.html">How to subconsciously encourage employees to comply with the project deadlines</a></li>
<li><a href="../333800/index.html">HPE Launches New HPE ProLiant Gen10 Servers</a></li>
<li><a href="../333802/index.html">Mobile Application Development with the SAP Cloud Platform SDK for iOS, Part 1</a></li>
<li><a href="../333804/index.html">Superjob PHP-meetup. Live broadcast</a></li>
<li><a href="../333806/index.html">Wi-Fi adapter via OTG</a></li>
<li><a href="../333808/index.html">Getsploit: search and download exploits on an aggregated database</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>