<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to easily start writing on PowerShell or simple automation to manage Active Directory</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Learn the basics of PowerShell 
 This article is a text version of the lesson from our free video course PowerShell and Active Directory Basics (for f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to easily start writing on PowerShell or simple automation to manage Active Directory</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/fn/vv/_q/fnvv_qgwykllpk93bnbm9hoilng.png" alt="image"><br><br><h3>  Learn the basics of PowerShell </h3><br>  This article is a text version of the lesson from our <a href="https://info.varonis.com/powershell%3Funlock_code%3Dblog">free video course PowerShell and Active Directory Basics</a> (for full access, use the secret word "blog"). <br><br>  This video course turned out to be extremely popular around the world and it will take you through all the steps to create a complete set of tools for managing the Active Directory directory service from the very beginning. <br><a name="habracut"></a><br><h3>  PowerShell Encoding </h3><br>  At first, this may seem like a difficult task to start working with PowerShell, especially if over the years you have become accustomed to working with the cmd.exe command line and the so-called batch files (files with the .bat and .cmd extensions).  In this article, written on the materials of the second lesson of our video course, we will explain how and why you should update your skills with PowerShell, as well as analyze the basics of launching the PowerShell editor, learn how to auto-complete commands and how to get up to date in any situation help and examples. <br><h3>  Team Execution </h3><br><img src="https://habrastorage.org/webt/1e/kx/-d/1ekx-dltbinfgzlsn7snkogn3qa.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      PowerShell is an interactive environment that allows you to run various commands in real time.  You do not need to edit the script in Notepad first and only then run it on the command line, which also saves you time. <br><br>  If you now work in any organization that does not exist for more than one day, then you probably already have several small scripts for each day that you run from the cmd.exe command line.  And this is great news!  So you can just as easily do all this from PowerShell.  It was truly a wise design decision from Microsoft, so they made the transition to a new solution easier for administrators. <br><br><img src="https://habrastorage.org/webt/cp/yx/bu/cpyxbuh87kcyt2ahponqkehwgtc.png" alt="image"><br><br>  In appearance, the PowerShell editor looks and functions exactly the same as the cmd.exe command line environment.  Techniques and skills that you already own will work without changes in PowerShell.  And if you also want to improve your skills and are working on the transition from performing one-time tasks, in order to provide more automated administration, then the habit of running PowerShell rather than the command line is a great way to start. <br><br>  All of your commonly used utilities, such as ping, ipconfig, nslookup, and so on, will work exactly as you expect. <br><br><img src="https://habrastorage.org/webt/oy/lr/xx/oylrxxcvj5fzuve0twq1ychaebi.png" alt="image"><br><br><h3>  How to find PowerShell commands </h3><br>  People love PowerShell because it‚Äôs so, well, powerful!  But this power comes from a completely insane amount of built-in features.  It's just not possible, but probably not practical, for someone to remember all sorts of commands, cmdlets, flags, filters, and other ways to tell PowerShell what to do and how. <br><br>  Fortunately, several tools are built right into the editor to help you cope with this. <br><br>  <u>Auto-completion of commands by pressing Tab</u> <br><br>  No need to memorize various commands or the exact spelling of a command.  Dial <br><br><pre><code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">c</span></span></code> </pre> <br>  Now by pressing the Tab key - you can go through all the available commands, starting with the characters that you have already entered.  And it works in any part of the body of the command to which you are trying to refer: in the names and flags of commands and even when auto-completing full paths on the file system. <br><br><img src="https://habrastorage.org/webt/6b/wp/8j/6bwp8jlb7pvfmw_2bqilsxgudau.gif" alt="image"><br><br>  <b>Get-Command</b> <br><br>  Even though Tab completion is excellent, what happens if you don‚Äôt know the correct command name you need?  In this case, you can use the command to find other available commands: Get-Command. <br><br>  In finding the name of a command, it is important to keep in mind that there is a syntax for them: Verb-Noun.  As a rule, Verbs such as - Get (Get), Set (Set), Add (Add), Clear (Clear), Read (Read) and Write (Write) and Nouns - files, servers or other entities in your network and applications . <br><br>  <u>Get-Command</u> is a tool for finding and learning the commands available on your computer. <br><br><img src="https://habrastorage.org/webt/f6/zn/4-/f6zn4-ckoywfxoga3xerf4r472a.png" alt="image"><br><br><h3>  Command Syntax in PowerShell </h3><br>  Someone once described Perl's scripting language as ‚Äúnoise from executable lines of code‚Äù (orig. ‚ÄúExecutable line noise‚Äù) is an incredibly useful tool, with a wildly opaque syntax and accordingly a high input threshold for learning. <br><br>  Although if you figure it out and the traditional command line in Windows is not so far gone from this.  Consider the general problem of how to find all the files in a directory whose names begin with 'foo'. <br><br><pre> <code class="hljs pgsql">CMD: <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> /D /R %G <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (‚ÄúFoo*‚Äù) <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> @ECHO %G</code> </pre> <br>  FOR and DO indicate that this is a loop. <br>  The / D flag indicates that this is a cycle across all folders. <br>  The / R flag indicates that all files and folders should be included, including subdirectories. <br>  A search pattern that identifies a set of files of interest to us is denoted by ‚ÄúIN‚Äù <br>  <a href="https://habrahabr.ru/users/echo/" class="user_link">ECHO</a> indicates that the script should display the result of each cycle and, finally, <br>  % G is a ‚Äúforced parameter‚Äù and is chosen because Microsoft programmers have previously used the letters A, D, F, N, P, S, T, and X when developing. Therefore, starting with G is a good tone, t. to.  this gives you the largest set of unused letters for the path formats of the variables returned (G, H, I, J, K, L, M) - in other words, it is a life hack. <br><br>  Compare now the equivalent on PowerShell: <br><br><pre> <code class="hljs pgsql">PowerShell: <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ChildItem -<span class="hljs-type"><span class="hljs-type">Path</span></span> C:\ -<span class="hljs-keyword"><span class="hljs-keyword">Filter</span></span> <span class="hljs-string"><span class="hljs-string">'Foo*'</span></span></code> </pre> <br>  The result is the same, but even with such a rather trivial example, it will be much easier to understand what is happening.  It becomes immediately obvious what each element in the team is doing and how they can be changed.  Well, except that the wildcard '*' is used in both examples, but I think that you already know very well that it means that all elements must begin with 'Foo' and at the end something else. <br><br>  Feel like your mood is gradually improving?  And now, what if you want to know how to select only files (and not folders) on the way?  Can you dig into the manuals, or your best friend Google to help you, or can try to figure out from the command line?  A small hint: if you are in PowerShell, enter ‚Äú-‚Äù and press the Tab key, go through the necessary flags until the obvious solution appears. <br><br><img src="https://habrastorage.org/webt/x_/n-/cm/x_n-cmxekoiqbuzwoijzdz7yeyy.gif" alt="image"><br><br><h3>  One Long Line vs. Object </h3><br>  Sites are not needed if they are not online.  That is why people spend a huge amount of time pretending that they are sonar operators on a submarine and ‚Äúping‚Äù the availability of their servers (yes, that's why it <a href="https://ru.wikipedia.org/wiki/Ping">is called that</a> ). <br><br>  Although the output of the Ping command is useful (and you can use ping with the same success in the PowerShell console), in the end it‚Äôs just a big and long line ‚Äî a series of letters and numbers with some breaks in between. <br><br>  PowerShell has a command that is similar to Ping, but returns data in a structured way.  This is the Test-Connection command. <br><br>  Below is the result of the work of this packet exchange command with the 'DC' server in a completely different, fully structured form: <br><br><img src="https://habrastorage.org/webt/1p/la/qa/1plaqafpmqer8ck5dymw0xulxha.png" alt="image"><br><br>  Not to mention the fact that it is much easier to read, but the main thing is that now you can pass this information to the entrance to another team, give it even greater utility (our full video course is designed for this purpose) or simply set it up so that it made more sense. <br><br><h3>  Built-in help </h3><br><img src="https://habrastorage.org/webt/8d/8o/ay/8d8oayjd5wuvsigcp8vimtvvhr8.png" alt="image"><br><br>  Up to this point, we have focused on executing certain commands using the Tab supplement, but as soon as you start working with PowerShell, more and more commands become more and more complex with even more complex parameters.  While the Verb-Noun syntax (Verb-Noun) helps, but the presence at hand helps: <br><br>  1. Current documentation <br>  2. Abundance of examples <br><br><h3>  Help by cmdlets </h3><br>  In practice, you should combine the Get-Command command (to find what you should use), and then use Get-Help to learn how to use this particular command. <br><br>  A practical example of how to do this: let's say you need to determine all the running Windows services on a computer. <br><br>  For starters, you can search for commands to interact with services: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Command service</code> </pre> <br>  Which will tell you immediately that you are on the right track.  When thinking about returning to the standard syntax of PowerShell Verb-Noun, you would like to find out how to use the 'Get-Service' command correctly. <br><br>  Microsoft Documentation on the Get-Service Command <br>  To do this, use the command 'Get-Help'.  Start typing <br>  ‚ÄúGet-Help -‚Äù and then press Tab <br>  You will quickly find the available options, most clearly one ‚ÄúName‚Äù fits, so it's worth a try: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Help -<span class="hljs-type"><span class="hljs-type">Name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Service</code> </pre> <br>  Here you will get the full syntax of the command (and that you can include or exclude from the options on the basis of filters). <br><br><img src="https://habrastorage.org/webt/zy/fg/sm/zyfgsmrms9lxwh4u7yktktfmxlq.png" alt="image"><br><br>  If you want to explore the command more deeply and detail it down to each parameter, then type: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Help -<span class="hljs-type"><span class="hljs-type">Name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Service - Parameter <span class="hljs-type"><span class="hljs-type">Name</span></span></code> </pre> <br><h3>  Help with PowerShell examples </h3><br>  We are all human and, without being offended by the Google bot, we all have our own psychological obstacles that we need to overcome when we learn something unfamiliar and bring it into a form that we can understand in order to accomplish what we need. <br><br>  Entering ‚Äú-examples‚Äù or adding the ‚Äú-detail‚Äù flag to the ‚ÄúGet-Help‚Äù command will give you a set of examples for using the command. <br>  Here, for example, the output for the command: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Help -<span class="hljs-type"><span class="hljs-type">Name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Service -Examples</code> </pre> <br><img src="https://habrastorage.org/webt/x-/iq/1_/x-iq1_qc9py7gzooegikjvnbxoy.png" alt="image"><br><br><h3>  Staying up to date </h3><br>  What could be more awful than a non-working example, or an example with an error in the documentation.  Often this happens either because of outdated documentation, or because of incorrect examples, or because of updated libraries. <br><br>  To get around these problems and at the same time get new examples and fixes, type: <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">help</span></span></code> </pre> <br>  and start the process of downloading the updated contextual help. </div><p>Source: <a href="https://habr.com/ru/post/348304/">https://habr.com/ru/post/348304/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348290/index.html">Timlides does not happen much</a></li>
<li><a href="../348294/index.html">Mobile devices from the inside. Study of tablet loading modes YB1-X90L</a></li>
<li><a href="../348298/index.html">Ternary operators and logical ‚ÄúAnd‚Äù in React.js</a></li>
<li><a href="../348300/index.html">Auto dial: a good way to enhance customer base</a></li>
<li><a href="../348302/index.html">Veeam Agent for Microsoft Windows Overview: Version 2.1</a></li>
<li><a href="../348306/index.html">Registration for NeoQUEST-2018 is open: steampunk expedition to Atlantis</a></li>
<li><a href="../348308/index.html">Digital events in Moscow from February 5 to 11</a></li>
<li><a href="../348310/index.html">‚ÄúVITAMIN ROSTA‚Äù: how LANIT attracts young people and how young professionals get into LANIT</a></li>
<li><a href="../348312/index.html">How to "learn to learn" - tips, advice and research</a></li>
<li><a href="../348314/index.html">Parsers, word processing. Just about the complicated. CFG, BNF, LL (k), LR (k), PEG and other scary words</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>