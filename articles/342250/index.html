<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Configure two-factor authentication in VMware Horizon View 7 using OTP and JAS server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In our last article, we talked about setting up two-factor authentication in VMware Horizon View based on the PKI infrastructure and x509 certificates...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Configure two-factor authentication in VMware Horizon View 7 using OTP and JAS server</h1><div class="post__text post__text-html js-mediator-article">  In our last <a href="https://habrahabr.ru/company/aladdinrd/blog/339824/">article,</a> we talked about setting up two-factor authentication in VMware Horizon View based on the PKI infrastructure and x509 certificates.  Today we will consider another version of 2FA authentication - one-time passwords (OTP).  Using PKI technology is probably more reliable, but in our age of universal mobility and BYOD trends, when users need to access information resources from any device, including mobile, using PKI technology is not always convenient, and sometimes impossible.  Therefore, one-time password authentication (OTP) is gaining increasing popularity. <br><a name="habracut"></a><br>  The implementation of OTP in our example is based on the product of our company.  This is an authentication server - <a href="https://www.aladdin-rd.ru/catalog/jas/index">JaCarta Authentication Server (JAS)</a> .  The authenticator (means of generating OTP) can be: <br><br><ul><li>  software token (google authenticator for smartphones running iOS, Android, Windows); <br></li><li>  physical token with USB port (JaCarta WebPass, Yubikey and others); <br></li><li>  physical token without USB port (eToken Pass and others). </li></ul><br>  The following OTP generation algorithms are supported: <br><br><ul><li>  RFC 4226 + HMAC-SHA-1 (6 characters); <br></li><li>  RFC 4226 + HMAC-SHA-256 (6 characters); <br></li><li>  RFC 4226 + HMAC-SHA-256 (7 characters); <br></li><li>  RFC 4226 + HMAC-SHA-256 (8 characters). </li></ul><br>  It is also possible to connect an SMS gateway and receive one-time passwords as SMS messages. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Like last time, it is assumed that VDI has already been deployed within VMware Horizon View and configured for simple password authentication.  Also already installed and configured JAS server and NTP-plugin for it.  And for users software or hardware tokens are got.  About installing and configuring JAS, we have a <a href="http://dms.aladdin-rd.ru/79c9a420-ca0d-4016-9fa1-8a57d1dad180">big boring document</a> included in the package. <br><br>  Next, we show how easy it is to connect an existing JAS server with a VMware Horizon View server and implement OTP authentication. <br><br><h2>  Setting progress </h2><br>  On the server where JAS and NPS plug-in is installed, go to the <b>Network Policy Server</b> snap-in and add a new <b>RADIUS Client</b> . <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/9i/vj/3k/9ivj3kjslaunw_zklureevspgro.png"></div><br>  Set the <b>Friendly name, the IP address of the</b> Horizon View Connection Server, and the shared <b>Shared secret</b> . <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/5y/v-/dx/5yv-dxh64camlrokrxr3ouhzmoi.png"></div><br>  Go to the VMware View server, open the View Connection Server administration console. <br><br>  Go to <b>View Configuration -&gt; Servers -&gt; Connection Servers</b> . <br><br>  Select the required authentication server and click the <b>Edit</b> button. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/pl/rb/tr/plrbtrmxycthtlvzpylqm5kcjsw.png"></div><br>  In the window that opens, go to the <b>Authentication</b> tab.  In the <b>Advanced Authentication 2-factor authentication</b> section, select <b>RADIUS</b> from the drop down menu. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/hj/pg/4g/hjpg4gtpjfokixcmrkf3v54h4hy.png"></div><br>  Uncheck checkboxes from <b>Enforce 2-factor and Windows user name matching matching</b> . <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/ca/ze/kq/cazekqza9b-kaorv5ezp41iid8q.png"></div><br>  Click the <b>Manage Authenticators</b> button.  In the new window, click on the <b>Add</b> button <b>...</b> <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/ss/oa/xa/ssoaxa-fzb7osf8frmjekwtcte8.png"></div><br>  Fill in the <b>Label</b> fields ‚Äî Server name displayed to the client, <b>Hostname / address</b> is the NPS server address with the OTP plug-in, <b>Shared Secret.</b>  <b>Authentication type</b> - PAP. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/tu/fw/p-/tufwp-bppvysqv1idb_q2doqg0k.png"></div><br>  Now the setup is complete, you need to run a check. <br><br><h2>  Laptop Health Check </h2><br>  Launch <b>VmWare Horizon Client</b> (it can be on Windows, Linux and MacOS) and connect to the server. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/yl/o3/yo/ylo3yofp7scelqnlmg7fqrkqwsc.png"></div><br>  After connecting to the server, a login dialog will be displayed asking you to enter a username and <b>OTP</b> ( <b>Passcode</b> field). <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/eb/yi/a2/ebyia22bmq-oe9ttr8owm8boi70.png"></div><br>  Open google authenticator to get the OTP value. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/mt/5f/q2/mt5fq2k8kgvbfqn9ifldvokczwg.png"></div><br>  After successful authentication via OTP, you will be prompted to log in using a username and password. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/9y/k7/ji/9yk7jis9pb3dv3nfvqpycensyak.png"></div><br>  The <b>OTP-&gt; Password</b> request happens exactly in this sequence, and not vice versa.  This is done to protect the password from the selection. <br><br><h2>  Mobile Health Check </h2><br>  From a mobile phone, everything will look similar.  Below is an example on iOS (Android is also supported). <br><br>  First, launch the Horizon application and connect to the server. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/lh/o4/9s/lho49sq496aomjsqtzjzsnpagac.png"></div><br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/ki/zr/2h/kizr2hkpg1wrfcyc-jadqyyese8.png"></div><br>  The server will request an OTP. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/qh/3l/9m/qh3l9mkq1d1h7gcbfvezfyyjrxq.png"></div><br>  Switch to Google authenticator, remember the OTP value. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/v5/sy/tz/v5sytzpn4gswba_cld_p3_jksa4.png"></div><br>  Switch to Horizon type OTP. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/_2/q7/sq/_2q7sq1aqdxinuwoaf2uomh6nwe.png"></div><br>  Next, enter the password. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/ng/wm/_6/ngwm_6afwbamvrq4qqna77xqufw.png"></div><br>  Select the desired desktop or application. <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/kh/7_/r0/kh7_r0s7roheb3jfz0961cjppoo.png"></div><br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/webt/r2/zr/d0/r2zrd03okbmebfncsemck9ve1ka.png"></div><br>  That's all. </div><p>Source: <a href="https://habr.com/ru/post/342250/">https://habr.com/ru/post/342250/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342238/index.html">Russia ranked first at the World Robot Olympiad</a></li>
<li><a href="../342240/index.html">Welcome to iOS-meetup SuperJob</a></li>
<li><a href="../342242/index.html">How to move to work in the United States: a selection of useful materials</a></li>
<li><a href="../342244/index.html">Code review humanly (part 2)</a></li>
<li><a href="../342248/index.html">Failure implementation in MS SQL Server 2017 Standard</a></li>
<li><a href="../342254/index.html">Using R for "industrial" development</a></li>
<li><a href="../342256/index.html">Mini benchmark home relay computers</a></li>
<li><a href="../342258/index.html">Rating of IT employers in St. Petersburg and Moscow: the results of a survey of developers</a></li>
<li><a href="../342260/index.html">5 success factors for effective implementation of account verification services</a></li>
<li><a href="../342262/index.html">Introduction to zk-SNARKs with examples (translation)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>