<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Object Reactive Programming</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Object Reactive Programming 


 Dmitry Karlovsky from SAPRUN represents ... mmm ... 
 This is the text version of the same-name speech at FrontendConf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Object Reactive Programming</h1><div class="post__text post__text-html js-mediator-article"><h1 id="obektnoe-reaktivnoe-programmirovanie">  Object Reactive Programming </h1><br><p>  <a href="https://github.com/nin-jin/">Dmitry Karlovsky</a> from <a href="http://www.saprun.com/">SAPRUN</a> represents ... mmm ... </p><br><blockquote>  This is the text version of the same-name speech at <a href="http://frontendconf.ru/2017">FrontendConf'17</a> .  You can <a href="">read it as an article</a> , or <a href="https://nin-jin.github.io/slides/orp/">open it in the presentation interface</a> , or <a href="https://www.youtube.com/watch%3Fv%3DDS6B_W9Lzgg">watch a video</a> . </blockquote><br><table><thead><tr><th>  I'm tired .. </th><th>  How will the ODP help? </th></tr></thead><tbody><tr><td>  ... write a lot, and do little? </td><td>  Write a little, do a lot! </td></tr><tr><td>  ... debug simple logic for hours? </td><td>  Reactive rules ensure consistency! </td></tr><tr><td>  ... asynchronous? </td><td>  Synchronous code can also be non-blocking! </td></tr><tr><td>  ... that everything is stupid by default? </td><td>  PIU optimizes data flows automatically! </td></tr><tr><td>  ... functional puzzles? </td><td>  Objects with properties - nowhere easier! </td></tr><tr><td>  ... that the application crashes entirely? </td><td>  Let the parts fall - the very rise! </td></tr><tr><td>  ... juggle waiting indicators? </td><td>  Indicators of expectations let them appear where necessary! </td></tr><tr><td>  ... two-way binding? </td><td>  Bilateral binding needs to be cooked properly! </td></tr><tr><td>  ... saw the reused components? </td><td>  Let components be reusable by default! </td></tr><tr><td>  ... always catch up? </td><td>  Get ahead and lead! </td></tr></tbody></table><a name="habracut"></a><br><h1 id="reklamnaya-pauza">  Commercial break </h1><br><p><img src="https://habrastorage.org/getpro/habr/post_images/923/e6c/9ed/923e6c9edb2ab66edb16804383e1c38d.png" alt="SAPRUN"></p><br><blockquote>  Hello everyone, my name is Dmitry Karlovsky.  I am the head of the web development group for SAPRAN.  Our company is the largest SAP integrator in Russia, but lately we have been actively looking towards developing our own software products. </blockquote><br><h1 id="mol---reaktivnyy-do-mozga-kostey">  $ mol - reactive to the bone </h1><br><blockquote>  One of them is a cross-platform open source web framework for quickly building responsive interfaces with a talking name <a href="https://github.com/eigenmethod/mol">"$ mol"</a> .  In it, we maximize the use of Object Reactive Programming, which I will discuss further ... </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/271/fe5/c07/271fe5c07b8d90c9ba425923ef6cf848.svg" alt="$ mol"></p><br><h1 id="chto-budem-delat-vecherom-poprobuem-zavoevat-riteyl">  What are we going to do in the evening?  Let's try to win retail! </h1><br><blockquote>  Let's imagine that we decided to open an online store selling toys.  And we want to do everything not as anything, but in a stylish, fashionable, youthful, fast, flexible and reliable way .. </blockquote><p> <a href="http://toys.hyoo.ru/"><img src="http://toys.hyoo.ru/" alt="toys.hyoo.ru"></a> </p><br><h1 id="katalog-tovarov">  Catalog </h1><br><blockquote>  We have a lot of toys, and we had to start selling yesterday.  Therefore, we want to do everything as quickly as possible, but not about ... losing the user experience. <br><br>  We can download the basic data of all the toys on the client device and allow the user to browse the catalog quickly, without network delays. </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/0c2/6e6/9c5/0c26e69c50b1b57b56eb438fa194a2dc.png" alt="Catalog of various toys"></p><br><h1 id="filtraciya">  Filtration </h1><br><blockquote>  Leafing through our catalog is, of course, an exciting activity, but the user would like to limit the selection to only those toys that are of particular interest to him at the moment.  Therefore, we add filtering. </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/23f/19d/22a/23f19d22a664389b0d5043a18c0535ee.png" alt="Catalog with filter"></p><br><blockquote>  For large amounts of data, a complex filter may overlap for a long time, so to ensure responsiveness, we would not want the filtering to repeat once again when it is not necessary. <br><br>  For example, if we filtered by size, then when the number of reviews changes, there is no point in re-filtering.  But if filtered by the number of reviews ... well, you understand, right? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It is important for us to know from which specific properties of which particular goods the result of filtering depends, in order to restart it when changing only those states that actually affect the result. </blockquote><br><h1 id="sortirovka">  Sorting </h1><br><blockquote>  The user usually wants to view the toys not in an arbitrary order, but in a particular one.  For example: in order of increasing prices or in order of decreasing relevance.  Therefore we add sorting.  Again, it can affect different properties of goods and be quite heavy on large amounts of data. </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/f42/855/704/f4285570487db6bd6e482b05a331ee5c.png" alt="Catalog with complex filter and complex sorting"></p><br><blockquote>  Obviously, the re-sorting will need to be done only when the sorting criterion is changed ... or the properties of the goods we sorted by.  But not any products, but only those that meet the filtering criteria.  And, accordingly, when changing this very criterion.  And also, when changing the properties of the goods for which we filtered.  AND... </blockquote><br><h1 id="uchyot-vseh-zavisimostey">  Accounting for all dependencies </h1><br><blockquote>  If you try to describe in the code all the dependencies between all the states, then a combinatorial explosion will occur and your hands will be torn off. </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/dee/d36/bcb/deed36bcb4019c2a312ecd794178703a.png" alt="Diagram of all dependencies between states"></p><br><blockquote>  Here we have described only 2 steps of transformations, but in a real application there can be more than a dozen. <br><br>  To curb this exponentially growing complexity, and Reactive Programming was invented.  Without it, you cannot make any complex application fast, stable and compact at the same time. </blockquote><br><h1 id="vsyo-li-renderit">  Is everything rendering? </h1><br><blockquote>  If you display all the data that you have prepared, then the algorithmic rendering complexity will be proportional to the amount of this data.  10 products are rendered instantly, 1000 - with a delay, and if 10,000, the user will have time to go and drink some tea. </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/47c/e32/b7f/47ce32b7f37bb09378c0d9809bd19175.png" alt="Graph with linear progression"></p><br><h1 id="ili-ne-vsyo">  Or not everything? </h1><br><blockquote> If a user has such a screen that no more than 10 products fit into it at the same time, then visually there will be no difference for him - whether you will render the whole 1000 or only 10 of them, and as you scroll, render the missing.  Therefore, no matter how fast you have <del>  React </del>  template engine, it will always play out for responsiveness to a lazy architecture, which is much less dependent on data volumes. </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/e8a/e76/889/e8ae7688920e29d5de6543d4dc7c9104.png" alt="Graph with logarithmic and linear progression"></p><br><h1 id="otobrazhenie-lish-vidimogo">  Display only visible </h1><br><blockquote>  If the sizes of the goods cards are known to us, then, knowing the height of the window, it is easy to understand which products are not exactly visible, and which can at least slightly, but fit into the visible area. </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/c15/969/d84/c15969d84fa7143092ba658774512b3b.png" alt="Cutting chart visible part of the list of goods"></p><br><blockquote>  Cut from the huge list of items from the first to the tenth - a smooth operation.  But only if this list is stored somewhere in the cached form.  If in each frame we get it from the source data by filtering and sorting, then there is no question of any smooth scrolling. </blockquote><br><h1 id="primerenie-izmeneniy-k-dom">  Applying changes to the DOM </h1><br><blockquote>  Ok, the data we have prepared, it remains to show them to the user.  The solution to the forehead is to remove the old DOM tree and grow a new one.  This is how all HTML template engines work. </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/544/abb/e47/544abbe477196e327549614099fd0f1d.png" alt="Redrawing the DOM is long"></p><br><blockquote>  It is not only slow, it also leads to a reset of the dynamic state of the nodes.  For example: the scrolling position and the open flag of the select.  Some of them can then be restored programmatically, but not all. <br><br>  In short, reality stubbornly does not want to be a pure function.  For the application to work as it should, you should, if possible, change the existing state, and not just create a new one.  And if you can not win - head! </blockquote><br><h1 id="virtualnyy-dom">  Virtual dom </h1><br><blockquote>  How to pull a snake on a hedgehog?  Right, let's generate a new DOM tree for the entire application, and then <del>  React </del>  the special library will compare its new and old versions, and apply the differences to the DOM tree that the user actually sees. </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/dab/ae4/e41/dabae4e4157bcd1cd17e2f0d2a60c990.png" alt="Virtual home for every sneeze - it's slow"></p><br><blockquote>  It sounds like a crutch, is not it?  How much work has to be done only in order to change the value of the text node, when the string property has changed in one of the models. </blockquote><br><h1 id="pryamye-zavisimosti">  Direct dependencies </h1><br><blockquote>  And what would the work of the most effective solution look like? </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/e6d/da8/d0c/e6dda8d0c2136d4a7fa5c80a564368b5.png" alt="Direct dependencies. What could be more effective?"></p><br><blockquote>  Everything is simple - direct links are established between the source data and their display.  When one state changes, only those dependent on it change.  And it works not only between the so-called "model" and "display", but between any dependent states, starting with a record in the database on the server, through a bunch of intermediate states and ending with a home-node in the browser.  This is the essence of Reactive Programming, and not in the template engine with a consonant name that is sold to us at each conference. </blockquote><br><h1 id="i-tak-soydyot">  And so come down! </h1><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a15/a3d/108/a15a3d10843a3b22b6392677622c749e.png" alt="And so come down!"></p><br><blockquote>  You can say that I exaggerate, and specifically in your project there will never be so much data and heavy processing, and you will run your application only on powerful workstations, and not on a sickly Chinese sneaker in power saving mode. </blockquote><br><h1 id="treugolnik-serpinskogo-na-reactjs">  Sierpinski Triangle on ReactJS </h1><br><blockquote>  But for this I have a simple consideration.  In order for the above application to work at a speed of 60 frames per second, it must have time to perform all operations, starting with data preparation and finishing with their rendering, in just 16 milliseconds.  And it is very easy to exceed them even in a trivial application on a powerful computer. </blockquote><p> <a href="http://nin-jin.github.io/sierpinski/stack.html"><img src="http://nin-jin.github.io/sierpinski/stack.html" alt="nin-jin.github.io/sierpinski/stack.html"></a> </p><br><blockquote>  Here is a well-known demo created by guys from Facebook, showing how hard the complex applications on React are stupid.  They are now trying to solve this by spreading out calculations over several frames, which gives the cherished 60 frames per second, but leads to visual artifacts.  The fundamental problem they have remains unchanged - the virtual DOM requires a heap of extra calculations for each other. </blockquote><br><h1 id="treugolnik-serpinskogo-s-ispolzovaniem-orp">  Sierpinski Triangle using the ODP </h1><br><blockquote>  The PPR, on the contrary, allows minimizing the amount of computation by automatically optimizing the data flows from their source to their consumer. </blockquote><p> <a href="http://mol.js.org/perf/sierp/"><img src="http://mol.js.org/perf/sierp/" alt="mol.js.org/perf/sierp/"></a> </p><br><blockquote>  As you can see, an equivalent implementation using reactive programming shows much better performance, even without blurring frame calculations. </blockquote><br><h1 id="paradigmy">  Paradigms </h1><br><blockquote>  Let's finally add some theory ... <br><br>  What is Object Programming?  Its main feature is the integration of data and functions for working with them within a single abstraction with a relatively simple interface - the object. <br><br>  What is Functional Programming?  Here the whole program is described as a heap of pure functions that do not depend on the variable state and do not change any states themselves. <br><br>  Finally, what is Reactive Programming?  Here you describe the rules for obtaining one state from another in such a way that a change in one state leads to a cascade change in dependent states. </blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/f72/a59/d83/f72a59d832d0d9af796200ef11e064c1.png" alt="Object, Functional and Reactive"></p><br><blockquote>  For many, Reactive Programming is strongly associated with Functional, however, it is much closer to Object Objective, as the main actors in Reactive Programming are mutable states. </blockquote><br><h1 id="protalkivaem-frp">  Push (FRP) </h1><br><blockquote>  There are two fundamentally different ways of implementing reactivity. <br><br>  The first is all sorts of <a href="https://baconjs.github.io/">bacons</a> , <a href="https://baconjs.github.io/">RXs</a> and other stream punk, also known as Functional Reactive Programming.  Its essence is that you explicitly get the so-called streams, on which your condition depends, add to them the function of calculating a new value.  And the value thus obtained is already pushed into all dependent streams, and they already decide what to do or not with this value. </blockquote><br><pre><code>const FilterSource = new Rx.BehaviorSubject( toy =&gt; toy.count &gt; 0 )
const Filter = FilterSource.distinctUntilChanged().debounce( 0 )

const ToysSource = new Rx.BehaviorSubject( [] )
const Toys = ToysSource.distinctUntilChanged().debounce( 0 )

const ToysFiltered = Filter
.select( filter =&gt; {
    if( !filter ) return Toys
    return Toys.map( toys =&gt; toys.filter( filter ) )
} )
.switch()
.distinctUntilChanged()
.debounce( 0 )</code></pre><br>
<blockquote>   -    ,     .     :    ,            .<br>
<br>
     .         :          ,      .    ,      ,     .<br>
<br>
    ,  .   .   .    .      ,  , ,      .</blockquote><br>
<h1 id="zatyagivaem-orp"> ()</h1><br>
<blockquote>      ,       ,    . , ,     ‚Äî <a href="https://github.com/eigenmethod/mol/tree/master/mem">$mol_mem</a>.</blockquote><br>
<pre><code>class $my_toys {

    @ $mol_mem
    filter( next ) {
        if( next === undefined ) return toy =&gt; toy.count() &gt; 0

        return next
    }

    @ $mol_mem
    toys( next = [] ){ return next }

    @ $mol_mem
    toys_filtered() {
        if( !this.filter() ) return this.toys()

        return this.toys().filter( this.filter() )
    }
}</code></pre><br>
<blockquote>   ORP   ,  ?    ,        ,     ,         ,       ,   .<br>
<br>
          ,           .</blockquote><br>
<h1 id="dobavlyaem-sortirovku"> </h1><br>
<blockquote>        ,       .</blockquote><br>
<pre><code>@ $mol_mem
sorter( next ) {
    if( next === undefined ) return ( a , b )=&gt; b.price() - a.price()

    return next
}

@ $mol_mem
toys_sorted() {
    if( !this.sorter() ) return this.toys_filtered()

    return this.toys_filtered().slice().sort( this.sorter() )
}</code></pre><br>
<blockquote>      ,           -    ,       .</blockquote><br>
<h1 id="otobrazhaem-lish-vidimoe">  </h1><br>
<blockquote>   ,        .               ,     .</blockquote><br>
<pre><code>@ $mol_mem
toys_visible() {
    return this.toys_sorted().slice( ... this.view_window() )
}</code></pre><br>
<blockquote>    <code>children</code>,    ,      .         .</blockquote><br>
<pre><code>children() {
    return this.toys_visible()
}</code></pre><br>
<h1 id="reaktivnyy-rendering"> </h1><br>
<blockquote>          <code>render</code>,   .</blockquote><br>
<pre><code>@ $mol_mem
render() {
    let node = document.getElementById( this.id() )

    if( !node ) {
        node = document.createElement( 'div' )
        node.id = this.id()
    }

    /// Node updating here

    return node
}</code></pre><br>
<blockquote>  ,       DOM-.    ,   .       .<br>
<br>
     .  ,       ,     ,           DOM-.</blockquote><br>
<h1 id="a-esli-isklyuchenie">  ?</h1><br>
<blockquote>    .    ,         . ,  ‚Äî    ,     .</blockquote><p><a href="http://toys.hyoo.ru/"><img src="http://toys.hyoo.ru/#luck=.9" alt="toys.hyoo.ru/#luck=.9"></a></p><br>
<blockquote>   -     ,        ,     .           ,       . </blockquote><br>
<h1 id="zaschischaem-prilozhenie-ot-padeniya-komponenta">    </h1><br>
<blockquote>    DOM-   <code>try-catch</code>     ,      .       ‚Äî  .</blockquote><br>
<pre><code>try {

    /// Node updating here

    node.removeAttribute( 'mol_view_error' )

} catch( error ) {

    console.error( error )

    node.setAttribute( 'mol_view_error' , error.name )
}</code></pre><br>
<h1 id="indikaciya-oshibki"> </h1><br>
<blockquote>   ?    CSS   ,  ,     . ,           .</blockquote><br>
<pre><code class="css">[mol_view_error] {
    opacity: .5 !important;
    pointer-events: none !important;
}</code></pre><br>
<h1 id="zagruzka-sinhronnaya-blokiruyuschaya">:  </h1><br>
<blockquote>         .    ,        . </blockquote><br>
<pre><code>namesakes_message() {

    /// Serial
    const user = this.user()
    const count = this.name_count( user.name )

    return this.texts().namesakes_message
    .replace( /\{count\}/g , count )
}</code></pre><br>
<blockquote>      ,        ,         .<br>
<br>
   ,   ?     :           ,     javascript ,        .</blockquote><br>
<h1 id="zagruzka-asinhronnaya-neblokiruyuschaya">:  </h1><br>
<blockquote>          .</blockquote><br>
<pre><code>namesakes_message() {

    /// Parallel
    return Promise.all([

        /// Serial
        this.user().then( user =&gt; this.name_count( user.name ) ,

        this.texts() ,

    ])
    .then( ([ count , texts ])=&gt; {
        return texts.namesakes_message.replace( /\{count\}/g , count )
    } )

}</code></pre><br>
<blockquote> ,           ,        .      ,       .</blockquote><br>
<h1 id="zagruzka-sinhronnaya-neblokiruyuschaya-s-ruchnoy-parallelnostyu">:     </h1><br>
<blockquote>     ,        ,     .</blockquote><br>
<pre><code>/// Serial
async namesakes_count() {
    const user = await this.user()
    return await this.name_count( user.name )
}

async namesakes_message() {

    /// Parallel
    const [ count, texts ] = await Promise.all([
        this.namesakes_count() ,
        this.texts() ,
    ])

    return texts.namesakes_message.replace( /\{count\}/g , count )
}</code></pre><br>
<blockquote>     "",         .<br>
<br>
 ,    ,           .</blockquote><br>
<h1 id="zagruzka-sinhronnaya-neblokiruyuschaya-bez-lishnego-shuma">:     </h1><br>
<blockquote>     ,              ,         ? </blockquote><br>
<pre><code>@ $mol_mem
namesakes_message() {

    /// Parallel
    const texts = this.texts()
    const user = this.user()

    /// Serial
    const count = this.namesakes_count( user.name )

    return texts.namesakes_message.replace( /\{count\}/g , count )
}</code></pre><br>
<blockquote>      .     ,    ‚Äî        . ,      ,     .    ,              ,      .</blockquote><br>
<h1 id="zagruzka-avtomaticheskoe-rasparallelivanie">:  </h1><br>
<blockquote>   ,      ,    ,     , - ,        ‚Äî    .<br>
<br>
  ,        <code>user.name</code>,          .</blockquote><br>
<pre><code>@ $mol_mem
namesakes_message() {

    /// Parallel
    const texts = this.texts()
    const user = this.user()

    /// Serial
    const count = this.namesakes_count( user.name ) /// &lt;-- first yield

    return texts.namesakes_message.replace( /\{count\}/g , count )
}</code></pre><br>
<h1 id="zagruzka-igrushki">: </h1><br>
<blockquote>     ,    .        .</blockquote><br>
<pre><code>/// Before
@ $mol_mem
toys(){ return [] }

/// After
toys_data() {
    return $mol_http.resource( '/toys.json' ).json()
}

@ $mol_mem
toys() {
    return Object.keys( this.toys_data() ).map( id =&gt; this.toy( id ) )
}</code></pre><br>
<blockquote> ,       ‚Äî     ,        ,     .</blockquote><br>
<h1 id="indikaciya-ozhidaniya"> </h1><br>
<blockquote>  .        ,          DOM-,    .         ,       .         .</blockquote><br>
<pre><code class="css">[mol_view_error="$mol_atom_wait"] {
    animation: my_waiting .25s steps(6) infinite;
}</code></pre><br>
<h1 id="dvizhenie-dannyh"> </h1><br>
<blockquote>           . ,        .</blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/5f5/04a/d37/5f504ad37a0c85f6d599f258467a8a3f.png" alt="     "></p><br>
<blockquote> ,   ‚Äî  ,    .  , ,       .       "".         " ,     ".<br>
<br>
  ,   ,     ,     ,     ,     ,  .<br>
<br>
   ,    . ,  ,         .     ,      ?</blockquote><br>
<h1 id="dvunapravlennye-zavisimosti"> </h1><br>
<blockquote>       ,    ,     ,   ?</blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/23d/7b6/cf4/23d7b6cf4b2a601d6719d8e71738f09e.png"></p><br>
<h1 id="dvunapravlennye-zavisimosti-menyaem-sostoyanie-vidzheta"> :   </h1><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/104/c4f/0ef/104c4f0efe6bbe157f24e8ef22b16bb3.png"></p><br>
<h1 id="dvunapravlennye-zavisimosti-menyaem-sostoyanie-stranicy"> :   </h1><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/0b4/6e2/7d6/0b46e27d67842ad6a71b0522eb3e826f.png"></p><br>
<h1 id="dvunapravlennye-zavisimosti-menyaem-sostoyanie-modeli"> :   </h1><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/6a8/344/cdb/6a8344cdb49e838c8961cfb831123e1f.png"></p><br>
<h1 id="dvunapravlennye-zavisimosti-prishyol-otvet-ot-servera"> :    </h1><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/04b/c7d/50d/04bc7d50d0aa73eee943478bfbfb6f3c.png"></p><br>
<blockquote> ,     ?<br>
<br>
    Angular.    ,   watcher-,      ,       -  .<br>
<br>
    ,   ,              "   ,    ".</blockquote><br>
<h1 id="odnonapravlennyy-potok-dannyh">  </h1><br>
<blockquote>      ?</blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/bc8/18e/690/bc818e690e7f7d12f71c7b01608f9b1e.png"></p><br>
<h1 id="odnona-chto-eto-u-nas">‚Ä¶    ?</h1><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/20a/af3/266/20aaf3266f57a215f73918f33316d34a.png"></p><br>
<h1 id="potoka-hot-i-dva-no-ne-peresekayutsya">   ,   </h1><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/ff2/1fd/a05/ff21fda05ddc7469ef6cb7948bdd5970.png"></p><br>
<blockquote>Facebook -   <a href="https://facebook.github.io/flux/">FLUX</a>,         ,   ‚Äî    ‚Äî   "". <br>
<br>
    ,    ‚Äî       .         ,           .<br>
<br>
            ,            .</blockquote><br>
<h1 id="dvustoronnie-kanaly-pryamoy-potok"> :  </h1><br>
<blockquote>       ,   ,   ,    ,    .      ,   ,      .       .    ?</blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/1d2/b18/62f/1d2b1862fbbee033611c6899769861ef.png"></p><br>
<h1 id="dvustoronnie-kanaly-obratnyy-potok"> :  </h1><br>
<blockquote>           ‚Äî     .          ‚Äî   "".          ,          ‚Äî    .</blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/fef/04f/84c/fef04f84c32dd5d4f8f4f45c46ed7411.png"></p><br>
<blockquote>   ,            . </blockquote><br>
<h1 id="dvustoronnie-kanaly-neprotivorechivyy-cikl"> :  </h1><br>
<blockquote>         ,     ,   .</blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/9bd/b6a/c13/9bdb6ac1320cc14c0da9f75940ad771f.png"></p><br>
<blockquote>       ,        .     FLUX-,             .</blockquote><br>
<h1 id="abstrakcii"></h1><br>
<pre><code>class $mol_string {

    hint() { return '' }

    @ $mol_mem
    value( next = '' ) { return next }

    // ...
}</code></pre><br>
<blockquote>  ‚Äî    .     : <code>hint</code> ‚Äî   ,     ;  <code>value</code> ‚Äî   .         value.   ,       .</blockquote><br>
<h1 id="odnostoronnee-pereopredelenie"> </h1><br>
<blockquote>           . ,  ,  <code>hint</code>    .</blockquote><br>
<pre><code>const Name = new $mol_string

Name.hint = ()=&gt; 'Batman'</code></pre><br>
<h1 id="dvustoronnee-pereopredelenie"> </h1><br>
<blockquote>      <code>value</code>     ,    .</blockquote><br>
<pre><code>let name = 'Jin'

Name.value = ( next = name )=&gt; {
    return name = next
}</code></pre><br>
<blockquote>   ,     <code>value</code>     <code>name</code>,    ‚Äî   <code>name</code>    .</blockquote><br>
<h1 id="eto-voobsche-zakonno">  ?</h1><br>
<blockquote>  ,    ,          ,    .</blockquote><p><img src="https://habrastorage.org/getpro/habr/post_images/a7e/7c2/0b8/a7e7c20b84ac4f15d29fe8179cd8beef.png" alt=" "></p><br>
<blockquote>          .<br>
<br>
         ,      .<br>
<br>
   ,    :                         .</blockquote><br>
<h1 id="kontrol-vremeni-zhizni">  </h1><br>
<blockquote>, ,          ,        . ,     ,      .</blockquote><br>
<pre><code>    @ $mol_mem
    Name() {
        const Name = new $mol_string

        /// Setup ```Name``` here

        return Name
    }</code></pre><br>
<blockquote>   ,   ,   - ,     .       .</blockquote><br>
<h1 id="svyazyvanie-vladelca-s-imuschestvom">   </h1><br>
<blockquote>           ,           ,      ,    .</blockquote><br>
<pre><code>        /// Setup ```Name```:

        /// One way binding
        Name.hint =  ()=&gt; this.name_hint()

        /// Two way binding
        Name.value = ( next )=&gt; this.name( next )</code></pre><br>
<blockquote> ,       ,       ,  .    ,    ,       ,    .</blockquote><br>
<h1 id="rezyume"></h1><br>
<p>  ‚Äî      .</p><br>
<p>  , ,   .</p><br>
<p>    .</p><br>
<p>        .</p><br>
<p>  ‚Äî .</p><br>
<p>    ‚Äî .</p><br>
<blockquote>    :    .        .     ‚Äî   "" ,    ,             ,     ‚Äî    ,       .<br>
<br>
      .      ,   ,      ,    ,    .        ,      .        .</blockquote><br>
<h1 id="voprosy">?</h1><br>
<blockquote>    .     - ,      .</blockquote><p> : <a href="https://github.com/eigenmethod/mol/tree/master/mem">$mol_mem</a>, <a href="http://vuejs.org/">VueJS</a>, <a href="https://mobx.js.org/">MobX</a>, <a href="https://github.com/Riim/cellx">CellX</a>, <a href="http://knockoutjs.com/">KnockOut</a></p><br>
<p> : <a href="http://toys.hyoo.ru/">toys.hyoo.ru</a></p><br>
<p> : <a href="">github.com/nin-jin/toys.hyoo.ru</a></p><br>
<p> : <a href="https://nin-jin.github.io/slides/orp/">nin-jin.github.io/slides/orp</a></p><br>
<p> : <a href="https://github.com/nin-jin/sierpinski">github.com/nin-jin/sierpinski</a></p></div><p>Source: <a href="https://habr.com/ru/post/330466/">https://habr.com/ru/post/330466/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330456/index.html">Ecosystem: more participants - more profit! Why does Skyeng open API</a></li>
<li><a href="../330458/index.html">Roskomnadzor white list: conclusions and losses</a></li>
<li><a href="../330460/index.html">10 tools for startups and startups</a></li>
<li><a href="../330462/index.html">How to adopt a law or data processing in distributed systems in an understandable language</a></li>
<li><a href="../330464/index.html">Free In-Memory Computing Summit 2017 - Europe Tickets</a></li>
<li><a href="../330468/index.html">PHDays 2017: how it was</a></li>
<li><a href="../330470/index.html">We write solitaire "Klondike"</a></li>
<li><a href="../330472/index.html">Form submission tracking with GTM</a></li>
<li><a href="../330474/index.html">All you need to know about Windows Server 2016</a></li>
<li><a href="../330480/index.html">Extending, modifying, and creating controls on the UWP platform. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>