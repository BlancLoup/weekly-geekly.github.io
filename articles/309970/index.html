<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we helped to return to the client 60 thousand dollars accrued for international communication</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This story happened to one large brand, operating in the domestic market of not the smallest southern country of the former USSR, let's call it simply...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we helped to return to the client 60 thousand dollars accrued for international communication</h1><div class="post__text post__text-html js-mediator-article">  This story happened to one large brand, operating in the domestic market of not the smallest southern country of the former USSR, let's call it simply - BRAND. <br><br>  - The network is built on Cisco with small patches of switches and servers from HP.  VPNs to headquarters and remote offices; <br>  - Internet on its own fiber from one of the leading providers of the capital; <br>  - ISDN-telephony from another very well-known international company.  An advertisement is attached to these numbers, so it‚Äôs impossible to refuse them! <br>  - Own staff of IT specialists at BRAND is small and constantly involved in solving current problems, therefore, it actively uses the services of IT outsourcing; <br>  - Monthly expenses of the BRAND only for communication services amount to about $ 3000, which is a very good indicator for us and leads to the VIP, and everything seems to be good, but <b>all of a sudden the bill comes first, at $ 20K, and then at $ 40K.</b> <br><a name="habracut"></a><br>  And then suddenly an understanding began to come that the evening was already no longer languid, and events began to unfold according to the classical scheme: <br><br>  1. Search for the guilty <br>  2. Punishment of the innocent <br>  3. And rewarding uncomplicated 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  The story itself </h3><br>  About a couple of months before the story, due to the crisis and in order to optimize costs, it was decided to abandon the monthly support of the IT-outsourcer, and go to pay on call. <br><br>  In principle, the solution is cost-effective, but suddenly one day, the telephony provider, (having received a <s>kick</s> from the international switch of the state telecom), informs BRAND that there are unusually many calls to previously non-specific destinations (Cuba, Nigeria and etc.) <br><br>  The IT department of BRAND, checking the billing on its internal PBX, did not find any records and, with a shrug, said that everything was fine with them.  The provider manager, yawning, went on to pursue his routine. <br><br>  And everything calmed down again for about a month, until the bills arrived, which were mentioned at the beginning of the story. <br><br>  <b>The IT specialists of BRAND</b> initially stated that <s>I was not me and the cow was not mine</s> ‚Äúsince there are no records in the internal billing, it means we didn‚Äôt make calls and would not pay,‚Äù but then changed the position that once among the conditions for obtaining a telecom license there is a mandatory point of the fight against fraud (which is true in our country), then the telephony provider itself is to blame for the origin of the account, so let him pay for it himself. <br><br>  <b>The supplier</b> reasonably objected that the client‚Äôs equipment was not responsible for the condition, the conversations were recorded not only by him, but also by the international communications center and were unambiguously carried out by the client, so the bill must be paid to the client. <br><br>  <b>The IT outsourcing company</b> conducted its research and concluded that ‚Äúthe client‚Äôs equipment was hacked‚Äù and, although by whom and when this unlawful act was committed, they cannot be installed ‚Äúdue to the absence of logs‚Äù, but the attackers, after seizing the rights, ‚Äúpoured‚Äù customer equipment voice international VoIP traffic. <br><br>  As a solution, the BRAND is an urgent need!  to buy additional equipment from them, services for the N-th sum, to hire another security specialist and work out rules for detecting such situations, etc.  etc. <br><br>  In general, as always, everyone tried to shift the blame from himself and, if possible, chop up the dough. <br><br>  Having experience, none of the parties wanted to go to law enforcement agencies. <br><br><blockquote>  <i>Here it is necessary to clarify: taking into account the practice that has developed in the field, usually in such cases we find out which article of the Criminal Code is violated and who is responsible for this field of activity of the victim.</i>  <i>Sentence is rendered to the specialist / head of the injured party, suppliers and persons involved, then the budget is replenished with the amount of fines issued and the case is considered successfully solved.</i>  <i>Of course, neither the money, nor the more, no one practically tries to look for the intruders themselves.</i> </blockquote><br>  Realizing that everything is in the same boat, the provider agreed to write off part of the amount for telephone conversations, eliminating all of their profit, but the client insisted on the division and the residual amount equally.  It came to inviting the team of "martial" lawyers, who, in turn, invited their technical specialists (that is, us) to negotiate. <br><br>  Several meetings of all interested parties made it possible to find out that, in fact, competent monitoring of events is absent both from the client and from service providers.  Ticker system at the outsourcer prematurely repaired.  Discussion of SLA from any side caused <s>thoughts of suicide as a</s> persistent feeling that none of those present, including us, understood how to ensure and control this. <br><br>  Well, we will work with the fact that in stock. <br><br>  <a href="http://www.cisco.com/c/en/us/support/docs/voice-unified-communications/unified-communications-manager-express/107626-cme-toll-fraud.html">As is well known</a> from time immemorial, Cisco has VoIP implementations, by default there is a bug that allows you to send VoIP traffic to the PSTN simply by specifying the <i>telephone number to call @ address number</i> and this must be closed by the appropriate rules via the <b>access-list.</b> <br><br>  Without becoming much to go into legal aspects, just to be convinced of the opposite, we wanted to familiarize ourselves with the current configuration of the network infrastructure, and in the process of familiarization, despite assurances from the IT outsourcer in the opposite, it turned out that the logs and configuration files were collected on the storage server data. <br>  Now fine. <br><br>  First of all, the outsourcers themselves were asked to provide us with the logs and configuration files for the hacked equipment that had been attacked for analysis. <br><br>  They began to look at the subject of errors and everything seemed to be true, but then we noticed that the dates did not fit between the later and earlier files.  Let's say it looked like this: <br><br>  <b>Early file:</b> <br><blockquote>  !  Last configuration change at 18:54:05 Tue Feb 10 2015 by it @ outsourcer <br>  ! NVRAM config last updated at 19:02:08 Tue Feb 10 2015 by it @ outsourcer </blockquote><br>  <b>Late file:</b> <br><blockquote>  !  Last configuration change at 13:38:58 Fri Jan 15 2016 by it @ outsourcer <br>  !  NVRAM config last updated at 13:38:59 Fri Jan 15 2016 by it @ outsourcer </blockquote><br>  In addition, both files have absolutely the same value in the properties of the time of creation and the last change, which in principle is impossible without external intervention. <br><br>  Having suspected something was wrong, we got access to the files directly through the head of the IT department and on his laptop, we opened the data storage server. <br><br>  <b>SUSE operating system (this is important!)</b> <br>  The logs are polished, but the analysis of the command history showed that the user, under the name of an outsourcer's employee, made changes to them before transferring files to us for research.  And also changed the values ‚Äã‚Äãof ‚Äúcreation time‚Äù and ‚Äúlast modification time‚Äù of the specified files, replacing further the originals on the server with their own alterations.  Then, apparently, in order to erase the traces of his actions, he deleted everything from the / var / log / directory. <br><br>  SUSE has one interesting feature about saving temporary files before sending them to a TFTP server.  I will not describe everything, who knows and understands what is meant, I recommend others to contact Google.  So, with very little effort, we got the originals of all the old configuration files, which revealed the following picture to us: <br><br>  <b>The IT outsourcing company had about a year as the main support engineer of the client changed, and the client just at that time decided to change the Internet provider.</b>  <b>In the process of setting up a new interface, the employee of the outsourcer for some reason left this hole open.</b> <br><br>  Hmm ... for some reason from the very beginning it seemed so to us.  Further, after the bill had already arrived and the company's own mistake became clear, the employees began to ‚Äúplay the fool‚Äù and tried to deceive the client.  Sad <br><br><h3>  Conclusion </h3><br>  The expert opinion of our company with technical and legal substantiations, as well as the server disk replica, with materials for the possibility of opening a criminal case, were issued to the BRAND management.  Further, the client‚Äôs management invited the management of an IT-outsourcer, where they were told what had happened and what they could be for. <br><br>  At first, of course, they made surprised people, but after 2 days, asking to sign the NDA, they promised to pay for everything. <br>  Since the leadership of the BRAND, to their credit, from the very beginning stated that they do not aim at criminal prosecution, but only want to find out what happened and what needs to be done to prevent this in the future, this incident is now considered to be settled. <br><br><h3>  Afterword </h3><br>  It was not the first and not the most significant experience of our participation in the investigation of IT crimes in monetary terms, but it is worth remembering that everywhere, where there is no order in accounting, there is a huge field for theft and deception. <br><br>  Indeed, in principle, if the outsourcer had the task of imitating a crime, and having organized sabotage, to impose his services, then with competent organization they could well succeed.  Therefore, we consider it necessary to collect logs of actions of all administrators and keep them in a place inaccessible to them.  For example, the head of his own Security Service.  Not because you do not trust, but in order to be sure in the event of an incident that it was not someone of your people who tried to ‚Äúthrow‚Äù you.  It's like a safe in the house to know for sure that your children have nothing to do with when the money was gone.  Or "black box" on the plane.  Not because we do not trust the pilot, but simply because he is hacking! <br><br>  We recommended to the client: <br><br>  ¬ªDeploy a server for collecting logs of actions of IT administrators with access only to the head of the Security Service. <br>  ¬ªEvent monitoring server for equipment inventory, status monitoring and quality control of received services (by SLA). <br>  ¬ªConfigure the methods and rules of automatic notification on triggers of unusual situations. <br><br>  But more about this in the following articles, if you are interested. </div><p>Source: <a href="https://habr.com/ru/post/309970/">https://habr.com/ru/post/309970/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309960/index.html">6 statistical indicators of IT outsourcing in 2016</a></li>
<li><a href="../309962/index.html">Functions of higher orders and monads for PHP`s</a></li>
<li><a href="../309964/index.html">Zabbix 3.2 released</a></li>
<li><a href="../309966/index.html">Trend Convergence: Dell PowerEdge FX Architecture</a></li>
<li><a href="../309968/index.html">Why I refused to Rust</a></li>
<li><a href="../309972/index.html">Communication opportunities of Internet projects</a></li>
<li><a href="../309974/index.html">Apple Pay will be available in Russia this fall.</a></li>
<li><a href="../309976/index.html">Difficult quest for habravchan: 25 levels</a></li>
<li><a href="../309978/index.html">One-way data binding with ECMAScript-2015 Proxy</a></li>
<li><a href="../309980/index.html">Automatic deployment of the ElasticBeanstalk application using Bitbucket Pipelines</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>