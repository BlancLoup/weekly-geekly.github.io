<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 26: ExPetr is not an extortionist, Intel PT allows you to bypass PatchGuard, in the Malware Protection Engine again RCE</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mimicry is extremely common in the animal world. To make it easier to hide from predators, or vice versa, it is easier to sneak up to prey undetected,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 26: ExPetr is not an extortionist, Intel PT allows you to bypass PatchGuard, in the Malware Protection Engine again RCE</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/d92/66c/517/d9266c517bb24775a8185329a288475f.jpg" align="right" width="300">  Mimicry is extremely common in the animal world.  To make it easier to hide from predators, or vice versa, it is easier to sneak up to prey undetected, animals, reptiles, birds and insects acquire a color similar to the surrounding terrain.  There is mimicry and under the objects, and, finally, under the animals of other species - more dangerous, or less tasty. <br><br>  In a similar way, the new <a href="https://threatpost.com/second-global-ransomware-outbreak-under-way/126549/">extortioner</a> ExPetr, which seems to be Petya, and not quite it, comes in.  Spreading like a plague, it caused a rustling in 150 countries.  One of the distribution vectors, but not the only one, is a sweet couple of EternalBlue and DoublePulsar, from which many have not bothered to patch after WannaCry. <br><br>  So, what I mean.  On closer examination, it turned out that ExPetr is no extortionist, and the most natural <a href="https://securelist.com/expetrpetyanotpetya-is-a-wiper-not-ransomware/78902/">data eraser</a> .  Restoring encrypted data is not provided and is impossible. <br><a name="habracut"></a><br><img src="https://habrastorage.org/web/a25/eb2/10e/a25eb210edff4179a99d61cc8e8b9650.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Good old Petya generated an identifier for each victim that should have been sent to the extortioners after paying the ransom.  It was from him that the fraudsters calculated the key that was returned to the victim so that she could recover her files.  And ExPetr shows the victim an identifier, that's just obviously useless - just a random set of numbers.  Nobody was going to decipher anything initially. <br><br>  Then a reasonable question arises, why was it necessary to fuss and demand disguise as a relatively peaceful Petya?  Perhaps this is not a particularly tricky attempt to hide the fact that behind the new epidemic there are not simple guys from Rana who are trying to earn extra money on a freebie exploit, but someone who is much more malicious and does not need money.  True, the ExPetr authors still earned some money. <br><br>  <b>A way to bypass Windows 10 kernel security has been developed.</b> <br><br>  <a href="https://threatpost.com/ghosthook-attack-bypasses-windows-10-patchguard/126462/">News</a>  <a href="https://www.cyberark.com/threat-research-blog/ghosthook-bypassing-patchguard-processor-trace-based-hooking/">Research</a>  As you know, Windows 10 has acquired a number of good, suitable protective functions.  One of them, PatchGuard, has worn out rootkits almost at the root.  But the guys from CyberArk argue that the wait is not long, as they have already invented a way to run code without a code in the Windows 10 kernel space. <br><br><img src="https://habrastorage.org/web/eec/784/8e5/eec7848e55624df1975efc21cb6b7595.jpg" align="right" width="300">  The problem lies in the remarkable technology of Intel PT (Processor Trace), which allows security products to track the flow of commands executed by the processor to instantly determine a possible attack.  The idea is great, but CyberArk could use PT to run its code in kernel space.  They, of course, reported it all to Microsoft, but received an answer that all this is nonsense, since admin rights are needed to exploit the vulnerability.  And if so, then it is no longer a vulnerability, because the admin is already allowed everything on the machine, and if the attacker has become such - light the carcasses, drain the water. <br><br>  And yet this is not entirely true.  Even a Trojan with admin rights can be detected and destroyed.  But the CyberArk exploit allows you to execute the code completely unnoticed by any security systems.  It is possible that something like some bad guys have been using for a long time, only to catch them will be very, very difficult. <br><br>  <b>Malware Protection Engine found RCE again</b> <br><br>  <a href="https://threatpost.com/another-rce-vulnerability-patched-in-microsoft-malware-protection-engine/126536/">News</a>  Researchers from Google Project Zero, it seems, liked to dissect the protective engine from Microsoft.  For the third time in recent months, a vulnerability has been found in it that allows arbitrary code to be run remotely. <br><br>  The problem lies in the x86-emulator, in which MsMpEng runs untrusted PE files.  It turned out that Microsoft developers left one of the emulator API calls to hang out, not accidentally, but ‚Äúfor a number of reasons‚Äù.  Sly Tevis Ormandy from Project Zero was able to use it in an elaborately coarse file, which, if scanned in the emulator, causes memory corruption, which, according to Microsoft, allows "to run code, install programs, change data, create new accounts". <br><br>  A typical attack scenario looks approximately the same as last time with the vulnerabilities of MsMpEng: the victim visits a site that pushes a tricky file to him, or receives this file by mail or via instant messenger.  MsMpEng automatically scans it, and those who do not need to manage the system. <br><br>  Let me remind you that the leaky MsMpEng is contained in Microsoft Endpoint Protection, Microsoft Forefront Endpoint Protection, Windows Defender and Microsoft Intune Endpoint Protection, but the vulnerability is present only in the 32-bit version of the engine. <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right"><h3>  Antiquities </h3><br>  "Astra-498, -510, -521" <br><br>  Resident non-dangerous viruses.  The SYS files of the current directory hit each time the DOS function is called FindFirst.  They are written to the end of files for which only the address of the interrupt routine is changed (interrupt).  Their TSR-copy is recorded in the vector table at addresses 0020: xxxx.  Intercepted int21h. <br><br>  They contain the text ‚Äú(5)‚Äù and, depending on the version of the virus, one of the lines: ‚Äú¬© AsTrA, 1990, JPN‚Äù, ‚Äú(C) AsTrA, 1990‚Äù, ‚Äú¬© AsTrA, JPN‚Äù.  The phrases ‚ÄúI like cold flavor!‚Äù, ‚ÄúI like fragrant smell of flower!‚Äù Or ‚ÄúI like a flower's smell!‚Äù Are displayed. <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 26.</i> <br><br>  <i><strong>Disclaimer:</strong> This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/332050/">https://habr.com/ru/post/332050/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../332030/index.html">It would not be happy, but sports programming helped</a></li>
<li><a href="../332032/index.html">Another way to put tails on a USB flash drive (and get your gigabytes back)</a></li>
<li><a href="../332034/index.html">Cyber ‚Äã‚Äãattacks on pharmacies, industrial espionage, insider and 4-year investigation. It would seem, what have the "Peter"?</a></li>
<li><a href="../332038/index.html">Native variables in CSS. It is time‚Ä¶</a></li>
<li><a href="../332042/index.html">Some thoughts on the Visitor pattern</a></li>
<li><a href="../332052/index.html">Symfony: Webpack Encore - plugin for resource management</a></li>
<li><a href="../332054/index.html">VK Streaming API Contest</a></li>
<li><a href="../332056/index.html">How to become a team leader and not explode</a></li>
<li><a href="../332058/index.html">Petya and others. ESET discloses cyber attacks on corporate networks</a></li>
<li><a href="../332060/index.html">Never write long ifs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>