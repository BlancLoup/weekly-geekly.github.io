<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A brief history of the evolution of proof-of-work in cryptocurrencies. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I bring to your attention a translation of the article ‚ÄúThe Proof-of-the-Work in Cryptocurrencies: Brief History. Part 1 ¬ª Ray Patterson (Ray Patterso...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A brief history of the evolution of proof-of-work in cryptocurrencies. Part 1</h1><div class="post__text post__text-html js-mediator-article">  <i>I bring to your attention a translation of the <a href="https://bytecoin.org/blog/proof-of-work/">article ‚ÄúThe Proof-of-the-Work in Cryptocurrencies: Brief History.</a></i>  <i><a href="https://bytecoin.org/blog/proof-of-work/">Part 1 ¬ª</a> Ray Patterson (Ray Patterson) from the site <a href="https://bytecoin.org/info/">Bytecoin.org</a> .</i> <br><br><img src="https://habrastorage.org/files/25f/e08/411/25fe08411e37431d8067c846372960ba.jpg" align="left"><h2>  Until the beginning of time </h2><br>  The concept of proof-of-work - ‚Äúproof of (completed) work‚Äù - first appeared in <a href="http://www.hashcash.org/papers/pvp.pdf">‚ÄúPricing via Processing or Combatting Junk Mail‚Äù</a> <s>in 16 before the birth of Bitcoin</s> in 1993. And although there is no such term in this article (there will be after 6 years), we will call it that way (PoW for short).  What idea did Cynthia Dwork and Moni Naor suggest in their work? <br><br>  <i>‚ÄúTo get access to a shared resource, the user must calculate a certain function: quite complicated, but feasible;</i>  <i>so you can protect the resource from abuse "</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To draw an analogy, the Fish Inspectorate requires <a href="https://ru.wikipedia.org/wiki/%25D0%25A3%25D1%258D%25D0%25B9%25D0%25B4,_%25D0%2594%25D0%25B6%25D0%25B5%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B8">Jeremy Wade</a> to work a little to gain access to the local pond ‚Äî for example, plant several trees and send photos of seedlings.  At the same time, Jeremy should be able to cope with it in a reasonable time: before all the fish are poisoned by substances released into the environment.  But, on the other hand, the work should not be elementary, otherwise the crowds of fishermen will quickly devastate the entire pond. <br><br>  In the digital world, to come up with an example of this kind of work is actually not so trivial. <br><a name="habracut"></a><br>  The server can, for example, prompt the user to multiply two random long numbers and then check the result.  The problem is obvious: the check is not much faster than the work itself, i.e.  the server simply cannot handle a large stream of clients. <br><br>  Next attempt: the server comes up with two long simple numbers, multiplies them and reports the result to the user.  The latter must perform a factorization, it is already more difficult.  There are nuances here, but in general, the scheme has become better: the ratio ‚Äútime of work / time of verification‚Äù has greatly increased.  This is the main requirement formulated in the article: <br><br>  <i>"The calculation of the function at a given input should be much more difficult than checking the result"</i> <br><br>  In addition, it was required that the function not be depreciable (read - not parallelized), i.e.  so that the time to solve several tasks is proportional to their number (If Jeremy wants to get a double quota for fishing, then you need to work twice as long: yesterday's or other people's photos will not work). <br><br>  As an example of such functions, (among others) the calculation of the square root modulo a prime number P was proposed: here we have log (P) multiplications per solution and only one multiplication for testing).  The input value can be issued as a server (generate x, issue x ^ 2), or be selected independently: select x, find sqrt (hash (x)).  In the latter case, a small file is needed: not every element in Z_p is a square.  But this is the little things. <br><br>  During the following years, other work appeared on the proof-of-work keywords.  Among them are two: <br><br><ol><li>  <a href="http://www.hashcash.org/papers/announce.txt">Hashcash project by Adam Beck</a> , dedicated to the same anti-spam protection.  The task was formulated as follows: ‚ÄúTo find such a value of x that the SHA (x) hash would contain N higher zero bits‚Äù.  That is, in fact, the work was reduced to hashing the same data (letters) with the enumerated part.  Since a persistent, irreversible hash function is used, there is nothing better than iteration;  and the average amount of work depends exponentially on N. A very simple scheme, yes? </li><li>  <a href="http://research.microsoft.com/pubs/54395/memory-longer-acm.pdf">‚ÄúModerately hard, memory-bound functions‚Äù</a> .  The key word here is memory-bound.  By the beginning of the zero, it became noticeable that the difference between low-end and high-end processors is too large for PoW-tasks to cut one size fits all.  The algorithm proposed in the article was the first to use relatively large (megabytes) memory in the calculations.  The bottleneck in such schemes was not the processor speed, but the delay in exchanging data with RAM or the amount of required memory, which varied in computers within narrower limits.  One of these algorithms was <a href="http://www.tarsnap.com/scrypt.html">scrypt</a> , but more on that later. </li></ol><br><h2>  Unicellular </h2><br>  It would be wrong to say that Satoshi was the first to invent PoW for electronic money.  The idea called <a href="http://cryptome.org/rpow.htm">‚Äúreusable proof-of-work‚Äù</a> was vital in crypto-anarchist circles (and even partially implemented), but did not gain popularity in its original form. <br><br>  The concept of RPoW from <b>Hal Finney</b> suggested that the ‚Äútokens-proofs‚Äù themselves would be an independent value (coins), while in Bitcoin the PoW mechanism was used as a means of achieving a distributed consensus (consensus about which version of the blockchain to be considered correct).  And this was the key idea of ‚Äã‚ÄãBitcoin, which ‚Äúshot‚Äù. <br><br>  The idea of ‚Äã‚ÄãHashcash was chosen as the proof-of-work scheme, and the calculated function was SHA-256, the most popular hash function at the time (2008).  Most likely, it was the simplicity of Hashcash and the ‚Äústandard‚Äù of SHA-256 that turned out to be the decisive factors.  Satoshi added a mechanism of varying complexity to Hashcash (reduce-increase N ‚Äî the required number of zeros ‚Äî depending on the total capacity of the participants), and this would seem to provide everyone with a cloudless, decentralized future.  But then something happened: GPU, FPGA, ASIC, and even cloud-based decentralized mining.  You can find <a href="http://habrahabr.ru/company/intel/blog/205524/">a</a> detailed history (in three volumes) of the development of mining in Bitcoin <a href="http://habrahabr.ru/company/intel/blog/205524/">here</a> . <br><br>  There is no consensus about whether ‚ÄúSatoshi had foreseen‚Äù all this disgrace or not, but the fact is this: already in September 2011, the first cryptocurrency with a fundamentally different PoW function appeared: <a href="https://bitcointalk.org/index.php%3Ftopic%3D45667.0">Tenebrix used scrypt instead of SHA-256</a> . <br><br><h2>  Mutation </h2><br>  So, why, instead of such useful and important changes in the Bitcoin code, such as, for example, the total number of coins, the crucial element ‚Äî the consensus algorithm ‚Äî began to be changed?  The reason is obvious: in 2011, GPU-farms were already working with might and main, pre-orders for FPGAs were being assembled, and ASICs were potentially looming - that is,  the contribution of the usual CPU user was almost zero.  But what is the reason? <br><br>  You can, of course, explain everything with the usual <a href="http://www.youtube.com/watch%3Fv%3D4bSGGKkyN2w">resentment</a> or the desire to ‚Äúcut the dough‚Äù: before Tenebrix, there were already forks, and premina, and pump'n'dump.  But the arguments of the supporters of the ‚ÄúASIC-resistance‚Äù functions are quite reasonable: <br><br><ol><li>  <b>Popularization</b> <br>  Since each computer (in theory) gives approximately the same hashrate, more people will participate in mining, even in the background.  Hundreds of millions of office machines, having slightly loaded their CPU, will contribute to the protection of the network, receive coins for this, which will then turn into circulation. </li><li>  <b>Decentralization.</b> <br>  There are even two aspects: first, iron producers.  Most of the ASICs are produced in several factories in China, and units are also competent in manufacturing.  Another thing is a general purpose PC.  Secondly, the geographical location of the miners.  If you do not take into account the pools, then the universal CPU-friendly algorithm has a larger area of ‚Äã‚Äãdistribution: anyone can afford to run the miner. </li><li>  <b>The high cost of attack 51%.</b> <br>  Of course, you can always design a special device that solves a specific task more efficiently (by time or by energy costs) than a regular PC.  Another question: how much will it cost to reseach + development of such a device, what scale of production should be, for the whole project to be economically beneficial, etc.?  It is believed that in any case it will be more expensive than in the current reality of Bitcoin.  (This is not an absolute estimate of the cost of an attack: a relatively, roughly speaking, level of maturity of the entire network. So, say, a network with even the most superlative ASIC-proof algorithm can be cheaply attacked if it only mines two dozen machines. ) </li></ol><br>  Of course, every point can always be objected to, but I just want to show that when choosing a PoW function, it makes sense to think about its ‚ÄúASIC security‚Äù.  In fact, this aspect was implicitly mentioned in the very first article!  It is precisely the non-depreciating function that can with a stretch be considered ASIC-protected. <br><br>  Now there are some technical details on how the scrypt algorithm, which formed the basis of Tenebrix, and later on Litecoin (which, as you may know, became the second most popular cryptocurrency), works. <br><br>  Strictly speaking, scrypt is not a cryptographic hash function, but a key generation function (KDF).  Such algorithms are used for exactly where you thought: to get the secret key from some data (passphrase, random bits, etc.).  Examples include PBKDF2 and bcrypt. <br><br>  The main task of KDF is to make it difficult to generate the final key: not much, so that it can be used in applied tasks, but enough to prevent cases of malicious use (for example, enumerating passwords).  The wording is very similar to something, isn't it?  No wonder they met - like Zita and Gita - PoW and KDF. <br><br><div class="spoiler">  <b class="spoiler_title">Scrypt work pattern</b> <div class="spoiler_text">  <b>The first layer:</b> <br><ol><li>  Input is passed through PBKDF2 </li><li>  They are divided into p blocks, each processed by the SMix function, </li><li>  The result is glued together again and passed through PBKDF2. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/files/306/1ee/689/3061ee6890f648feacf87d03141f6222.png"></div><br><br>  Note that here each of the p blocks can be processed separately.  Those.  scrypt in theory allows for parallelization (but by default, p = 1) <br><br>  <b>Second layer:</b> <br><ol><li>  The input block by successively applying the pseudo-random function BlockMix expands to an array of N blocks. </li><li>  Block X, obtained from the last element, is interpreted as an integer j, and element Vj is read from the array </li><li>  X = BlockMix (X xor Vj) </li><li>  Steps 2-3 are repeated N times. </li><li>  The result is the current value of the X block. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/files/36d/c17/62b/36dc1762b96d456dbf653fd6c2ac3ee7.png"></div><br><br>  Here the most interesting thing happens.  The larger the N value we choose, the more memory is required by the algorithm.  And although at each step 2-3 we need only one element from the entire array, we cannot free up memory until step 5: after all, this element is chosen pseudo-randomly, depending on the last result!  Thus, if the BlockMix function itself (see below) is executed quickly, latency becomes a bottleneck. <br><br>  <b>The third layer.</b> <br><ol><li>  The input is divided into 2r blocks </li><li>  Each block is xor-is with the previous one and is hashed by the function H </li><li>  The result is given in the rearranged order. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2f3/3b4/ce1/2f33b4ce1761431b93abb23b223e68ff.png"></div><br><br>  Salsa20 / 8 is used as a function of H.  Yes, this is not a hash function, but a stream cipher.  But for scrypt purposes, collision resistance is not required, but only a quick and pseudo-random result, so Salsa was very suitable.  By default, scrypt suggests r = 8, but in the cryptocurrency they chose r = 1 (most likely, for speed).  We will write about the consequences later. <br><br>  Details regarding the choice of certain parameters in the algorithm can be found <a href="http://www.tarsnap.com/scrypt.html">here</a> . <br></div></div><br>  The scrypt parameters for Tenebrix were chosen in such a way that the total amount of required memory would fit in 128 KB: so you can fit in the processor's L2 cache.  And the default is 16 MB!  The experiment turned out to be more than successful: CPU miners who were forgotten on the side of progress quickly got into the game.  The vast majority of new forks have sprung from Litecoin, inheriting scrypt instead of SHA256. <br><br>  Strangely enough, users were not embarrassed by the fact that the 128 KB parameters were completely in the teeth and video cards.  The optimized GPU miner appeared a few months later and gave an average of a tenfold increase in efficiency.  ‚ÄúBut not 100 times as in Bitcoin!‚Äù They said, ‚ÄúBut not 1000 times!‚Äù The increase in the ratio of GPU / CPU-capacities (displaced from Bitcoin by new ASICs) was not so sharp, probably because what was compensated for the forks boom: a new scrypt-cryptocurrency appeared almost once a week, putting off new capacities. <br><br>  And yet, the understanding that scrypt is far from an ideal PoW function appeared even earlier than the announcement of scrypt-ASIC.  The dizziness from successes passed, the cult of Satoshi subsided a bit, and ideas for new PoW candidates began to appear as after the rain. <br><br><h2>  <a href="http://habrahabr.ru/post/264067/">Read in the next series</a> : </h2><br>  ‚ÄúCross and multiply: X11 and Co. algorithms!‚Äù <br>  ‚ÄúAtavisms against rudiments: SHA3 or scrypt-jane?‚Äù <br>  ‚ÄúParadoxes of history: Momentum and birthday paradox‚Äù <br>  ‚ÄúWhere is the peak of evolution: in theoretical computer science or practical?  CuckooCycle and CryptoNight ¬ª </div><p>Source: <a href="https://habr.com/ru/post/263769/">https://habr.com/ru/post/263769/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263757/index.html">Skills of .NET-developer of Russia and the USA, what's the difference?</a></li>
<li><a href="../263759/index.html">Android found vulnerabilities that allow access to a smartphone via MMS</a></li>
<li><a href="../263761/index.html">GNS3 in the cloud</a></li>
<li><a href="../263763/index.html">How does this mysterious HTC Dot View work?</a></li>
<li><a href="../263765/index.html">Data structures Informal guide</a></li>
<li><a href="../263771/index.html">How to set up directory synchronization in IP PBX - search by ODBC</a></li>
<li><a href="../263773/index.html">How ITSM-System ServiceNow appeared in our cloud</a></li>
<li><a href="../263775/index.html">Algorithm for parsing arithmetic expressions</a></li>
<li><a href="../263777/index.html">VMware vSphere 5.5 and 6.0 performance - settings, considerations. Performance best practices</a></li>
<li><a href="../263779/index.html">Fujitsu PRIMEQUEST: standard platform with mainframe reliability</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>