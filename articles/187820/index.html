<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parsing NetFlow v.9 C # Packages</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="NetFlow is a network protocol created by Cisco Systems to account for network traffic. The most common versions of this protocol are 5 and 9. The nint...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parsing NetFlow v.9 C # Packages</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://ru.wikipedia.org/wiki/Netflow"><b>NetFlow</b></a> is a network protocol created by <b>Cisco Systems</b> to account for network traffic.  The most common versions of this protocol are 5 and 9. The <a href="http://netflow.caligare.com/netflow_v9.htm">ninth version is</a> more flexible because it uses templates according to which the data is sent.  <a href="http://netflow.caligare.com/netflow_v5.htm">In the fifth version of the</a> data are sent according to the specification. <br><img src="https://habrastorage.org/storage2/e47/cf8/f8f/e47cf8f8f4e4be033f3fbd70b1eaf3d3.png" alt="image"><br><br>  <b>NetFlow</b> 's traffic information collection system consists of the following components: <br><ul><li>  <b>Sensor</b>  A device (router, L3 switch) that collects statistics on traffic passing through it; </li><li>  <b>Collector</b> .  It collects data from the sensor and puts it in the storage; </li><li>  <b>Analyzer</b> .  Analyzes the data collected by the collector and generates reports. </li></ul><br><br>  I will tell you about the development of some functions of the analyzer in <b>C #</b> , and more precisely the analysis of <b>NetFlow</b> packets <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As the sensor was used <b>MikroTik</b> router. <br><br>  We <b>enable</b> <b>NetFlow</b> on it for <b>ether1</b> interface: <br> <code>/ip traffic-flow set enabled=yes interfaces=ether1</code> <br> <br>  And we add a collector (as a rule, the collector listens on port 2055, 9555 or 9995): <br> <code>/ip traffic-flow target add disabled=no version=9 address=192.168.0.100:9995</code> <br> <br>  Or the same thing through <b>WinBox</b> : <br><img src="https://habrastorage.org/storage2/ab8/7ca/b90/ab87cab903b8ccf5f5a28ee724739997.png" alt="image"><br><br>  Now, <b>NetFlow 9</b> version packets will come to the computer with IP address <b>192.168.0.100</b> on port <b>9995</b> via <b>UDP</b> (or <b>SCTP</b> ).  Packages come and have something to work with. <br><br><h4>  Parsing incoming packages </h4><br><br>  Having studied <a href="http://www.ietf.org/rfc/rfc3954.txt">the protocol specification,</a> we learn that each <b>NetFlow</b> packet (N bytes) consists of: <br><ol><li>  <b>Packet Header</b> (20 bytes) - packet header, in a single copy with the fields: <br><ul><li>  <b>Version Number</b> ( <b>UInt16</b> - 2 bytes) - the version number of <b>NetFlow</b> , we always have 9; </li><li>  <b>Count</b> ( <b>UInt16</b> - 2 bytes) - the total number of records.  Further, in the text of the articles with this field was an <a href="https://habr.com/ru/post/187820/">adventure</a> ; </li><li>  <b>sysUpTime</b> ( <b>UInt32</b> - 4 bytes) - time in milliseconds from the start of the device - UpTime; </li><li>  <b>UNIX Secs</b> ( <b>UInt32</b> - 4 bytes) - time in seconds since 0000 UTC 1970, at which the packet was sent; </li><li>  <b>Sequence Number</b> ( <b>UInt32</b> - 4 bytes) - the counter of transmitted packets, it is constantly increasing from packet to packet, thus you can check whether packets are lost between them; </li><li>  <b>Source ID</b> ( <b>UInt32</b> - 4 bytes) - the number of data stream, in fact, that from the side of the sensor there can be several data streams. </li></ul><br></li><li>  <b>FlowSet</b> (N-20 bytes) - templates, data ... <b>FlowSet`s</b> can be several or one.  In each <b>FlowSet</b> there are two unchanged fields of the type of data transmitted (template, data): <br><ul><li>  <b>FlowSet ID</b> ( <b>UInt16</b> 2 bytes) - for the template it is always 0, for the optional template 1, for data it is equal to the <b>Template ID</b> and therefore more than 255 (from 256 to 65535); </li><li>  <b>Length</b> ( <b>UInt16</b> 2 bytes) - the size of the entire <b>FlowSet</b> along with the <b>FlowSet ID</b> and <b>Length</b> fields; </li><li>  Other fields depending on the type of data transmitted. </li></ul><br></li></ol><br><br>  Look at the <b>FlowSet ID</b> containing the template, it starts with the fields <b>FlowSet ID</b> , then <b>Length</b> , then: <br><ul><li>  <b>Template ID</b> ( <b>UInt16</b> 2 bytes) - a unique ID for each template for which data is transmitted.  The number is from 256 to 65535; </li><li>  <b>Field Count</b> ( <b>UInt16</b> 2 bytes) - the number of fields in the pattern.  Next come alternately field type ( <b>Field Type</b> ) and size ( <b>Field Length</b> ); </li><li>  <b>Field Type</b> ( <b>UInt16</b> 2 bytes) - the number that determines the type of field.  All types are in <a href="http://www.ietf.org/rfc/rfc3954.txt">the protocol specification</a> ; </li><li>  <b>Field Length</b> - the length of the field in bytes. </li></ul><br><br>  We look at the <b>FlowSet ID</b> containing the data, start with the fields <b>FlowSet ID</b> , then <b>Length</b> , then: <br><ul><li>  Data ... data that correspond to the fields and their sizes; </li><li>  <b>Padding</b> - zeros up to the 4-byte border. </li></ul><br><br>  There is also a so-called optional template and data on it.  I will not consider them, they have not met me, for this reason there are no libraries in the library implementation, but everything can be added. <br><br>  Compiled <b>UML</b> class diagram (using <a href="http://nclass.sourceforge.net/">NClass</a> ): <br> <a href=""><img src="https://habrastorage.org/storage2/fe0/193/8f5/fe01938f59036861d924e4c45ca10f43.png" alt="image"></a> <br>  or in <a href="https://dl.dropboxusercontent.com/u/11287991/netflow.pdf">pdf</a> <br>  And wrote a library for parsing incoming packages. <br>  The main class that starts it all is <b>Packet</b> .  Its only constructor accepts an incoming NetFlow packet in bytes and an object of the <b>Templates</b> class, which is a list of current <b>Templates</b> . <br><br>  Next, in the constructor of the <b>Packet</b> class, the <b>Parse</b> function is called, which takes an object of the <b>Templates</b> class. <br>  In this function, the packet is divided into a header - 20 bytes and further work with it through the <b>Header</b> class;  on <b>FlowSet`s</b> and transfer of each <b>FlowSet`s</b> and processing to the appropriate class <b>FlowSet</b> . <br><br>  Due to the fact that <b>FlowSet`s</b> can be several, the second part of the packet (without 20 bytes of the header) has to be analyzed and divided into different <b>FlowSet`s</b> .  It is noteworthy that in <b>MikroTik</b> ` <b>FlowSet`s</b> in a single copy in the package, but using <b><a href="http://sourceforge.net/projects/netflowsim/">Netflow Simulator in C #</a></b> it was possible to work with packages with several <b>FlowSet`s</b> in the package.  In addition, thanks to him, a funny bug was found in the implementation of <b>NetFlow v9</b> on <b>MikroTik</b> `s, what more <a href="https://habr.com/ru/post/187820/">here</a> . <br><br>  <b>Netflow Simulator in C #</b> : <br><img src="https://habrastorage.org/storage2/40d/dcf/09a/40ddcf09a4a6ddd52442b61a1f7f2916.png" alt="image"><br><br>  Here is the code section breaking part of the package at <b>FlowSet`s</b> : <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._flowset = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;FlowSet&gt;(); Int32 length = _bytes.Length - <span class="hljs-number"><span class="hljs-number">20</span></span>; Byte[] flowset = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Byte[length]; Array.Copy(_bytes, <span class="hljs-number"><span class="hljs-number">20</span></span>, flowset, <span class="hljs-number"><span class="hljs-number">0</span></span>, length); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] reverse = flowset.Reverse().ToArray(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> templengh = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((templengh + <span class="hljs-number"><span class="hljs-number">2</span></span>) &lt; flowset.Length) { UInt16 lengths = BitConverter.ToUInt16(reverse, flowset.Length - <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(Int16) - (templengh+<span class="hljs-number"><span class="hljs-number">2</span></span>)); Byte[] bflowsets = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Byte[lengths]; Array.Copy(flowset, templengh, bflowsets, <span class="hljs-number"><span class="hljs-number">0</span></span>, lengths); FlowSet flowsets = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlowSet(bflowsets, templates); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._flowset.Add(flowsets); templengh += lengths; }</code> </pre><br><br>  In the <b>Header</b> class, the packet <b>header</b> is parsed into its fields.  Before you do this, the header is reversed: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._bytes.Reverse().ToArray();</code> </pre><br><br>  Next, convert the bits to the type of field it is, for example the version field: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._version = BitConverter.ToUInt16(reverse, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._bytes.Length - <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(Int16) - <span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br><br>  Yes, in the <b>Header of</b> the <b>sysUpTime</b> field, it has a <b>TimeSpan</b> type, we cast it to this type: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TimeSpan((<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._uptime * <span class="hljs-number"><span class="hljs-number">10000</span></span>); }</code> </pre><br><br>  and the <b>UNIX Secs</b> field is of type <b>DateTime</b> : <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(<span class="hljs-number"><span class="hljs-number">1970</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>).AddSeconds(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._secs); }</code> </pre><br><br>  Let us turn to processing <b>FlowSet`s</b> .  After receiving the <b>FlowSet ID</b> and <b>Length</b> fields, the remaining fields are parsed depending on the <b>FlowSet ID</b> .  If it is 0 or 1, then this is a pattern, and if it is a number from 256 to 65535, then this is data. <br><br>  If this is a template, then we transfer its processing to the <b>Template</b> class and then check our template storage (object of the <b>Templates</b> class) for the presence of a template with the same <b>ID</b> and replace it, otherwise we simply add the template. <br><br>  If this is data, then we check if there is such a template ( <b>FlowSet ID</b> == <b>Template ID</b> ) in the storage (object of the <b>Templates</b> class) and if there is, then copy this template with the <b>DeepClone</b> function and fill its fields - <b>Field</b> , otherwise we do nothing, because without a template it‚Äôs just set of bytes. <br><br>  <b>DeepClone</b> function: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DeepClone</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> obj</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> objResult = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MemoryStream ms = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MemoryStream()) { BinaryFormatter bf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryFormatter(); bf.Serialize(ms, obj); ms.Position = <span class="hljs-number"><span class="hljs-number">0</span></span>; objResult = bf.Deserialize(ms); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> objResult; }</code> </pre><br><br>  <b>Field</b> is a field, it has the following parameters: <br><ul><li>  <b>Type</b> - type; </li><li>  <b>Length</b> - size; </li><li>  <b>Value</b> - the value. </li></ul><br><br>  Moreover, the <b>Field</b> in <b>Template</b> in the repository is without <b>Value</b> parameters, i.e.  <b>Value is</b> empty, but when processing <b>Template</b> packages in a <b>FlowSet</b> in a <b>Packet</b> object, it already contains <b>Value</b> fields. <br><br>  Besides all this, there is also the <b>FieldType</b> enumeration - an enumeration in which the type name corresponds to the number of this type.  ( <b>Type</b> parameter in <b>Field</b> ) <br><br>  An example was written for the work of this library: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Net; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Net.NetFlow; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Net.Sockets; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Consoles</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { Templates _templates = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Templates(); Socket sock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp); IPEndPoint iep = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IPEndPoint(IPAddress.Any, <span class="hljs-number"><span class="hljs-number">9995</span></span>); sock.Bind(iep); EndPoint ep = (EndPoint)iep; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">2048</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> recv = sock.ReceiveFrom(data, <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> ep); Console.ReadKey(); Console.Clear(); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[recv]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; recv; i++) bytes[i] = data[i]; Packet packet = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Packet(bytes, _templates); Console.ForegroundColor = ConsoleColor.Yellow; Console.WriteLine(packet.ToString()); } sock.Close(); Console.ReadKey(); } } }</code> </pre><br><br>  We create a socket and listen on UDP port 9995 on our PC.  <b>_templates</b> is our template repository.  Each incoming packet we feed to the <b>packet</b> object of the <b>Packet</b> class passing also our template storage.  And then we execute <b>packet. ToString ()</b> This overloaded function outputs the contents of the packet to us and is only needed to check that everything <b>works</b> out for us. <br><br>  This is all with the library; now it can be used to further write the <b>NetFlow</b> traffic analyzer. <br><br>  Example with <b>MikroTik</b> : <br><br>  Received a package without a template in the repository: <br><img src="http://habrastorage.org/storage2/f4e/a0a/43b/f4ea0a43b508b69eb704a77db2aaffc9.png" alt="image"><br><br>  Received the template from the sensor: <br><img src="http://habrastorage.org/storage2/4fd/02e/82b/4fd02e82bb4b4230c60236931e4d9f47.png" alt="image"><br><br>  Received data for which there is a template in the repository: <br><img src="http://habrastorage.org/storage2/984/419/46d/98441946d5f1d7c9c862b7b013663b82.png" alt="image"><br><br><h4><a name="bag"></a>  Error implementing <b>NetFlow v9</b> in <b>MikroTik</b> `e </h4><br>  In the process of analyzing this topic, an error was found in the implementation of <b>NetFlow v9</b> in <b>MikroTik</b> `e.  The essence of the error: <br>  The <b>Count</b> field in the packet header ( <b>Packet Header</b> ) carries: <br><blockquote>  Count <br>  The total number of records in the Export Packet, which is <br>  sum of Options FlowSet records, Template FlowSet records, and <br>  Data FlowSet records. <br></blockquote><br>  those.  contains all records in all <b>FlowSets,</b> ah, and in <b>MicroTik</b> , this field is always 1 (see screenshots above), even if several templates or data are transmitted.  those.  according to the logic of <b>MikroTik</b> `and the <b>Count</b> field = the number of <b>FlowSet`s</b> (what they wrote to me in the letter and can be seen on the screen), but should be equal to the total number of all templates and data, as it sounds in the specification.  For this reason, the use of the <b>Count</b> field in packet parsing is fraught. <br><br>  Here is an example from <b>Netflow Simulator in C #</b> (I would like to receive data from <b>Cisco as well</b> , but I don‚Äôt have such an opportunity, can a reader check this): <br><br>  Received a package without a template in the repository (note the <b>Count</b> ): <br><img src="http://habrastorage.org/storage2/574/100/51e/57410051e888a062eac11a4d937511ce.png" alt="image"><br><br>  Received a template from the sensor (here at the same time two <b>FlowSet</b> `and it came that in <b>MikroTik`</b> e does not happen. Pay attention to the <b>Count</b> it is equal to 7 = 1 template and 6 data records. According to the logic of <b>MikroTik</b> `and the <b>Count</b> would have been equal to 2 = 2 <b>FlowSet</b> a): <br><img src="http://habrastorage.org/storage2/b43/238/a34/b43238a349864487aaeb228af733ff88.png" alt="image"><br><br>  Received data for which there is a template in the repository (note the <b>Count</b> ): <br><img src="http://habrastorage.org/storage2/3fb/f3c/8a4/3fbf3c8a44f3191203cf31587a21856e.png" alt="image"><br><br>  Well, once again the package in <b>Wireshark</b> Marked field <b>Count</b> : <br><img src="http://habrastorage.org/storage2/2c7/414/de4/2c7414de472f795e677567989d3fbefe.png" alt="image"><br><br>  Once again: I will be very grateful to everyone who will send a screen with <b>Wireshark</b> `from <b>Cisco</b> .  I'll put it in here. <br><br>  Source code is available <a href="https://github.com/chelaxe/NetFlow">here</a> . <br><br>  When creating guided: <br>  <a href="http://ru.wikipedia.org/wiki/Netflow">Wikipedia: Netflow</a> <br>  <a href="http://netflow.caligare.com/">Caligare: WHAT IS NETFLOW?</a> <br>  <a href="http://www.ietf.org/rfc/rfc3954.txt">Protocol Specification Version 9</a> <br><br><h5>  Today (19:05 07/30/2013) </h5><br>  <b>MikroTik</b> replied: <br><br>  <i>MikroTik support [Dzintars] support@mikrotik.com</i> <br><blockquote>  Hello, <br><br>  Thank you for reporting a problem. <br>  that count is not set correctly in the netflow packet header).  The <br>  problem will be fixed in the next version of RouterOS. <br><br>  Regards, <br>  Dzintars <br></blockquote><br><br>  <b>UPD:</b> This bug has been fixed in RouterOS 6.2. <br><h5>  Today (13:22 13/09/2013) </h5><br>  <b>MikroTik</b> wrote: <br><br>  <i>MikroTik support [Dzintars] support@mikrotik.com</i> <br><blockquote>  Hello, <br><br>  The NetFlow V9 count field problem was fixed in version 6.2 <br><br>  Regards, <br>  Dzintars </blockquote></div><p>Source: <a href="https://habr.com/ru/post/187820/">https://habr.com/ru/post/187820/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../187804/index.html">Ilya Segalovich, the founder of Yandex, died</a></li>
<li><a href="../187806/index.html">Canonical temporarily lowered prices for pre-order Ubuntu Edge</a></li>
<li><a href="../187808/index.html">AngularJS vs. Knockoutjs</a></li>
<li><a href="../187812/index.html">In August, it will be possible to purchase and rent textbooks on Google Play</a></li>
<li><a href="../187814/index.html">About RNA molecules</a></li>
<li><a href="../187822/index.html">Simple and scalable event subscription with WebSockets, STOMP, SockJS and Spring Framework 4.0</a></li>
<li><a href="../187826/index.html">Data recovery redis</a></li>
<li><a href="../187828/index.html">Proper understanding of gamification</a></li>
<li><a href="../187830/index.html">Tiny Thief - a cool mobile game made using Flash + Autodesk Scaleform Mobile SDK</a></li>
<li><a href="../187834/index.html">New for web designer for July 2013</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>