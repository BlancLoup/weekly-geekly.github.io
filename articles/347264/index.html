<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ATM Security: Application Control Application Difficulties</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Image: Pexels 

 In the past few years, in the field of information security, a new class of operating system protection tools has emerged - applicati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ATM Security: Application Control Application Difficulties</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/pt/blog/347264/"><img src="https://habrastorage.org/webt/ww/a7/cq/wwa7cqigfzjjkemzmh3hjgtqneq.jpeg"></a> <br><br>  <i>Image: <a href="https://www.pexels.com/photo/atm-dirty-machine-vandalism-53311/">Pexels</a></i> <br><br>  In the past few years, in the field of information security, a new class of operating system protection tools has emerged - application control.  The need for highly specialized tools exists in situations where malicious software cannot be detected using behavioral and signature analysis, or when the system does not have access to the Internet to download antivirus updates. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Theoretically, application control tools can be replaced with OS local security policies, but the software of this class helps to manage black and white list policies more flexibly.  Today we will talk about how to use such means of protection on a real example of ATM security. <a name="habracut"></a><br><br><h2>  What exactly do application control tools do? </h2><br>  There are a number of ways to check whether an application complies with a given white list - from checking the path to the executable file or its hash to analyzing the digital signature and extension.  Application control tools are most often used for additional protection of client computers - a ban on launching non-whitelist software - or securing isolated systems that do not imply constant operator intervention - for example, ATMs. <br><br>  In the first case, you need to protect the user, including from phishing attacks, when an attacker tries to convince him to launch a malicious application ‚Äî for example, using a letter with a special attachment.  In this case, the protection system simply prohibits the launch of the downloaded attachment, not on the basis of behavioral analysis or signatures (which hackers increasingly successfully bypass), but simply because such applications are prohibited in principle to the user. <br><br>  In the second scenario, it is assumed that the attacker somehow has already penetrated the system, that is, has physical or remote access to the system ‚Äî to the cmd.exe command console or explorer.  Here it is necessary to restrict the ability to run third-party software, which can be used to elevate privileges, or perform malicious actions (mimikatz, nmap, etc.). <br><br><h2>  What can go wrong here: 3 control problems </h2><br>  Since application control is a young direction, almost all the tools related to it have some kind of ‚Äúchildhood diseases‚Äù.  As a result, such products almost never work out of the box, they need to be customized, tested and adapted already in the course of use.  This is due, among other things, to the complexities of solving the very problem of monitoring launched applications ‚Äî we will list the main ones. <br><br><h3>  The white list is much more difficult to implement. </h3><br>  If the ‚Äúblack list‚Äù of extensions that should be blocked is more or less universal and easy to configure, then the ‚Äúwhite list‚Äù of what is allowed to run is redundant by default - it often includes all applications from the OS at the time of configuration. <br><br>  And this means that it is possible to execute an arbitrary code in an ATM in various ways, without violating the conditions of checks.  For example, using quite legitimate tools, like PowerShell (almost always ATMs are running Windows), as well as causing external code utilities.  Over the past few years, many methods have been described to bypass the application control using Microsoft Windows tools (for example, ‚Äúrundll32‚Äù, ‚Äúregsvr32‚Äù), a simple blocking of which disrupts the normal operation of the OS. <br><br>  This means that the application control system should monitor not only the fact of launching these utilities, but the whole set of conditions ‚Äî which processes use utilities (system or user), which rights are used, how the required library is called, etc. <br><br>  In a relatively short time, Positive Technologies experts were able to expand the list of OS utilities that allow executing third-party code by other means not mentioned before: ‚Äúdebug.exe‚Äù, ‚Äúntsd.exe‚Äù, ‚Äúrasautou.exe‚Äù, etc. <br><br>  Another direction of attack is interpreters of programming languages ‚Äã‚Äã(Java, .NET, PHP).  In most cases, the conditions for their launch on an ATM should be as detailed as possible.  In fact, this is not the case, which makes it possible to run arbitrary code.  An example of the possible consequences is the recently described .NET attack to bypass the <a href="https://www.blackhillsinfosec.com/powershell-without-powershell-how-to-bypass-application-whitelisting-environment-restrictions-av/">Microsoft Windows Applocker security features</a> . <br><br>  In our practice, there were also solutions that did not protect the extension control by simply renaming a 32-bit file extension to arbitrary or using 16-bit applications that are not checked because they do not contain a PE header, which is usually a condition for checking the file. before its launch. <br><br>  As you can see, there are so many configuration parameters that need to be properly configured.  It also makes sense to block applications by headers, not extensions, to prohibit not only 32-bit, but also 16-bit applications. <br><br><h3>  Vulnerabilities can also be found in protection tools. </h3><br>  Like any other software, protection tools may contain vulnerabilities.  Security errors in antiviruses and firewalls are regularly found by researchers - application control tools are in the same row. <br><br>  In their case, there are vulnerabilities that open up the possibility of carrying out network attacks - for example, disabling protection mechanisms by simply repeating an intercepted command or a buffer overflow error.  Another type of problem is logical errors in the application control system, their operation can <a href="https://www.ptsecurity.com/ww-en/about/news/283971/">bypass the protection mechanisms</a> . <br><br><h3>  Not all attacks are equally easy to repel. </h3><br>  Using application control tools has its own specifics and depending on the scope of application - for example, in the case of ATMs, it is important to protect against attacks of a different profile than when protecting the infrastructure of a nuclear power plant.  In the first case, in order to steal money, the attacker does not have to launch the malware that was brought with him. <br><br>  As our <a href="https://www.slideshare.net/a66at/launch-impossible-current-state-of-application-control-bypasses-on-atms">research</a> shows, sometimes it is enough to simply write or read a specific file.  And to protect against such ‚Äúattacks‚Äù, application control products are not designed in principle, although they can be configured to reduce the likelihood of a hacker's success.  For example, when running an activity analysis that is responsible for the interaction of the OS with the MSXFS ATM ATM periphery, it can interact with the same PowerShell, as well as Regedit and Notepad - a notebook is enough to read or write configuration files, so that such activity of illegitimate users should be is prohibited. <br><br><h2>  Conclusion: There is no silver bullet. </h2><br>  Application Control class tools can reduce the likelihood of a successful attack and make life difficult for attackers, but in essence they are not very suitable for protecting systems such as ATMs.  There are a number of limitations that make these tools not the most effective way to protect - from the need for very fine-tuning to the likelihood of having your own vulnerabilities that allow you to bypass even well-tuned application filtering rules. <br><br>  In order to protect their infrastructure, banks should not just implement the tools under the influence of current trends, but implement a comprehensive security strategy - in accordance with it, it will be possible to make a choice of a specific remedy.  Here are the steps you need to take to solve this problem: <br><br><ol><li>  Create a threat model and a violator model with the assistance of independent experts. </li><li>  Develop policies in conjunction with information security auditors and the vendor of application control solutions.  Adhere to the principle of least privilege (to prohibit everything that should not be explicitly allowed). </li><li>  Think about the introduction of other tools, the presence of which dramatically reduces the hacker's attack space: tools for controlling connected devices (device control), protection mechanisms against blackbox-attacks with a cryptographic signature on the side of the processing center. </li></ol><br>  <b>By</b> Timur Yunusov, Positive Technologies </div><p>Source: <a href="https://habr.com/ru/post/347264/">https://habr.com/ru/post/347264/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347254/index.html">Understanding Meltdown and Specter: What you need to know about new vulnerabilities found in almost all CPUs</a></li>
<li><a href="../347256/index.html">Making games in Python 3 and Pygame: Part 3</a></li>
<li><a href="../347258/index.html">Why salt HTTP callbacks</a></li>
<li><a href="../347260/index.html">How to find a good marketer?</a></li>
<li><a href="../347262/index.html">Che Burashka and hacking systems selling tickets to Moscow electric trains</a></li>
<li><a href="../347266/index.html">Making games in Python 3 and Pygame: Part 4</a></li>
<li><a href="../347268/index.html">As we inventories reduced. 500 million</a></li>
<li><a href="../347272/index.html">I hate constants in ruby</a></li>
<li><a href="../347274/index.html">Own DBMS for 3 weeks. You just need a little time every day ...</a></li>
<li><a href="../347276/index.html">Smart search: how artificial intelligence hh.ru selects jobs to resume</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>