<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Power supply of IT equipment: security or continuity? part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue the article, the purpose of which is to share experience and show the key features and frequent errors arising in the design and organizat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Power supply of IT equipment: security or continuity? part 2</h1><div class="post__text post__text-html js-mediator-article">  We continue the article, the purpose of which is to share experience and show the key features and frequent errors arising in the design and organization of power supply subsystems of the IT infrastructure and the data center as a whole.  But I would like to expand the audience a bit and devote several sections to the basic elements of electrical safety and protection of equipment and people. <br><br>  Those who missed the first part or want to remember the first part <a href="https://habr.com/company/open_technologies/blog/422459">can be passed here</a> . <br><br>  For those who understand what an automaton and RCDs are for, what they are needed for, what they protect against and what are they protected from - go to the section <a href="https://habr.com/company/open_technologies/blog/422459/">Do you need RCDs for IT equipment, server room, data center?</a>  . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Part two </h4><br>  Let's see what is the relationship between energy and the end IT equipment, we will understand the question of in what cases the power outages the operating system is guaranteed to work without failures. <br><br><img src="https://habrastorage.org/webt/ob/tb/hz/obtbhz0jnf_q6oq1zvaanw9mq9i.png"><br><a name="habracut"></a><br>  <b>Switching to a backup power supply</b> <br><br>  Power supply of information equipment is organized with redundancy.  Consider the organization of power supply in terms of SCHBP-BRP-BP (uninterruptible power supply shield-power distribution unit-power supply).  Backup types are of the following types: <br><br><ol><li>  Redundant cabling to the rack, equipment, using separate power distribution units, PDU (Figure 1) </li><li>  Redundant power buses in the power supply panel, using separate power distribution units, PDU (Figure 2) </li></ol><br>  Redundancy at the power supply level directly in the server, switch, IT device (Fig. 3) <br>  Redundancy using rack-mounted load switch, rack-mounted ATS (SPN, also known as ATS) (Fig.4) <br><br><img src="https://habrastorage.org/webt/js/2l/zc/js2lzctorndn9rr1pfds1f1gadq.png"><br><br>  To switch between primary and backup inputs can be used: <br><br><ul><li>  in the field of information systems: ABP / STS (Static Transfer Swith) cabinets for high-power systems, for switching to power from a backup UPS at the time of operation of a full-fledged 2N system or combinations of N + 1 systems; </li><li>  in the field of power supply systems of various types of circuit breaker circuit (on contactors, on controllers); </li><li>  at the server rack level: automatic high-speed rack-mount automatic transfer switch \ ATS (Automatic Transfer Switching); </li><li>  at the level of specific information equipment: duplicated power supplies. </li></ul><br>  As we <a href="https://habr.com/company/open_technologies/blog/422459/">quoted above</a> for IT equipment, ‚Äúa break in power supply is not allowed.‚Äù  And what is hidden under this phrase?  What is the "break" in the power supply of information equipment?  Now let's look at a live example. <br><br>  The customer implements the local server along with the IT infrastructure of two floors under the company's office.  At the discussion stage of the power supply system, he has a desire to put all the information equipment with one power supply (PSU), and leave the second slot for the server BPs free, and mount a single ATS rack-mount version for the entire rack.  (Fig.4, scheme). <br><br>  The appearance of the back side of the server with duplicated power supplies <img src="https://habrastorage.org/webt/0x/0v/lq/0x0vlqnxdee7rjkycqvqu9hawgk.jpeg"><br>  <u>How the customer argued his desire</u> : <br><br><ul><li>  Cost savings ($ 500-800 per device per rack) </li><li>  You can put two simple PDUs and apply them to power distribution after ATS </li><li>  Absolutely similar level of system reliability, compared to the classical distribution method </li></ul><br>  We took time out, studied in detail the desire of the Customer from various points of view, the reliability of services in general during the warranty and post-warranty period, as well as: <br><br><ul><li>  cost (savings) of capital costs in the implementation (CAPEX) </li><li>  the cost of depreciation, maintenance of spare parts, labor costs of client personnel ( <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25BF%25D0%25B5%25D1%2580%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B5_%25D0%25B7%25D0%25B0%25D1%2582%25D1%2580%25D0%25B0%25D1%2582%25D1%258B">OPEX</a> ) </li><li>  comparison of operation algorithms and switching time to the backup line in both variants, checking for ‚Äúsingle points of failure‚Äù </li><li>  the level of risks of lagging and / or rebooting the operating systems of information equipment, the fall of information services that run on them. </li></ul><br>  <b>And that's what turned out:</b> <br><br>  According to the regulatory framework <a href="http://docs.cntd.ru/document/1200104301">GOST 32144-2013</a> (Electrical Energy. Electromagnetic Compatibility of Technical Means. Power Quality Standards in General-Purpose Networks. Introduction Date - July 1, 2014), the main cause of failures in the work of information equipment can be voltage dips <blockquote>  usually occur due to faults in electrical networks or electrical installations of consumers, as well as when connecting a powerful load </blockquote><br>  We read further: <blockquote>  duration of voltage sags can be up to 1 minute </blockquote>  This phrase tells us that the information equipment should be provided by the UPS and / or high-speed AVR, since voltage dips of similar duration are acceptable and normal in terms of high energy, but will be fatal to IT equipment and services. <br><br>  By the way, it is worth noting that at the moment there are contradictions in the current regulatory framework of the Russian Federation in terms of measuring values ‚Äã‚Äãrelated to the quality of electricity, you can read more <a href="http://digitalsubstation.com/blog/2018/04/25/protivorechiya-trebovanij-standartov-pri-izmerenii-velichin-otnosyashhihsya-k-kachestvu-elektroenergii/">in the article of our company's technical director Viktor Cherdak</a> (source <a href="http://digitalsubstation.com/">digitalsubstation.com</a> ) <br><br><div class="spoiler">  <b class="spoiler_title">Some excerpts from the article</b> <div class="spoiler_text"><br><blockquote>  In recent years, state standards in the field of measuring parameters of electrical energy related to QE have been actively developed and have been repeatedly revised. </blockquote><br><img src="https://habrastorage.org/webt/8w/tk/0b/8wtk0bfp05tiweeaiq9ohsgg8xi.jpeg">  " <br><blockquote>  An important change was the replacement of GOST 13109-97 ‚ÄúElectric energy.  Electromagnetic compatibility of technical equipment.  Quality standards for electrical energy in general-purpose power supply systems ‚Äù[16], GOST 32144-2013.  These standards define a different range of power quality indicators. </blockquote><br></div></div><br>  But how fast?  How to determine that time in milliseconds, during which the service (and server) of the customer will not fall, and the operating system will not go into the "critical error"? <br><img src="https://habrastorage.org/webt/4i/g8/ao/4ig8aofumuyrreuro_rd2goxxbi.png"><br><br>  There is the CBEMA (Computer and Business Equipment Manufacturers Association) standard, which after some adjustments is now known as the ‚ÄúITIC curves‚Äù (Information Technology Industry Council), and its variants are included in the IEEE 446 ANSI standards.  According to these standards, electronic power supply circuits must remain operable for 20 ms (or 0.02 seconds, i.e. a period). <br><br><img src="https://habrastorage.org/webt/bs/ot/sm/bsotsm7mugmu6m3fzt5iiox1mai.png"><br>  <i>Those same ITIC curves</i> <br><br>  According to the requirements for the server system and computer systems, the <a href="https://xdevs.com/doc/xDevs.com/Neutron/pdf/eps_designguide_2.91.pdf">Server System Infrastructure</a> can be said that the <b>Tvout_holdup</b> parameter of the power supply <b>unit</b> during the power supply voltage failure provides the information equipment with a minimum of 21 ms.  That is, the full period of the network is the guaranteed time for normal operation of the server or switch.  The <b>Tpwok_holdup</b> parameter <b>is</b> specified at least 20ms. <br><br><div class="spoiler">  <b class="spoiler_title">Some details on the SSI parameters can be found here.</b> <div class="spoiler_text">  Reference: Hold-up time is the time period during which the power supply unit can maintain the output voltages within certain limits after the input voltage is lost at its input.  In most computer power supplies, the Hold-up time also characterizes the power good signal (PWR_OK) after which the time will tell the system that the voltages produced by the power supply are unstable (for computer power supplies, this parameter is usually more than 16 ms). <br><br><img src="https://habrastorage.org/webt/8z/f2/zu/8zf2zu6jh8hfurxa94ulp-jmt7o.jpeg"><br><br>  Here is one of the tables from the document. <br><br><img src="https://habrastorage.org/webt/l5/ua/xz/l5uaxzxqrxqazzbdd41rh4w_oiu.jpeg"><br><br>  And this is a diagram (time-line) with regulated BP operation algorithms. <br></div></div><br>  Now let's see how long the switching time is stated by APC, for example, for a rack-mounted load switch of the brand <a href="http://electroautomatica.ru/img/documentation/APC_ASTE-6Z6KBC_R4_RU.pdf">AP7721</a> .  We see that here we usually have 8-12 ms, but 18 ms is the maximum switching time. <br><br>  We can conclude that the switching time to the backup input for a rack load switch corresponds to the specification of the power supply unit of the server equipment.  It turns out that there will be no failures in the operation of information equipment. <br><br><div class="spoiler">  <b class="spoiler_title">Summary of the timings of the elements of the system</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dg/dz/pk/dgdzpktzp8rlkr9eizo7k8i1usg.jpeg"><br></div></div><br><h3>  And what about the economic component and which of the options is more profitable and fault tolerant? </h3><br>  Suppose we have three small servers in the rack, into which we can put two power supplies and three devices with non-duplicated power supplies.  All are critical and the failure of any device will lead to the failure of the customer‚Äôs entire system.  Rack load switch we need in any case.  It is about 18 thousand rubles. <br><br>  The customer declares that they do not need a PDU (PDU), which means that only the ATS value will be in the budget - the same 18 thousand rubles.  As a replacement for power distribution units (PDUs), the Customer suggests using on-board power distribution of a rack load switch.  Also, the Customer plans to buy servers with two slots for power supplies, but in a complete set with one power supply unit for the sake of economy.  <a href="https://habr.com/ru/company/open_technologies/blog/423801/">(picture 4)</a> <br><br>  The classic version <a href="https://habr.com/ru/company/open_technologies/blog/423801/">(Figure 3)</a> assumes a set of 2 PDUs - about 32,000 rubles, 3 additional power supplies to servers for $ 500 each for 84 thousand rubles in total.  ATS for the same 18 thousand rubles.  Having added everything, we understand that the classic solution will cost the customer <b>approximately 134 thousand rubles.</b> <br><br>  It seems that the customer is right, the money is completely different.  But let's look in terms of resiliency and ease of maintenance of both options: <br>  <b>Customer option:</b> <a href="http://cyclowiki.org/wiki/%25D0%2595%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2582%25D0%25BE%25D1%2587%25D0%25BA%25D0%25B0_%25D0%25BE%25D1%2582%25D0%25BA%25D0%25B0%25D0%25B7%25D0%25B0">Single point of failure</a> - rack load switch.  If something happens to him, then we lose the entire rack entirely.  So, you need to have a spare parts kit right on the site, which adds 18,000 rubles to the estimate.  The power supplies in the servers cost one at a time; they are also points of failure.  Therefore, it is desirable to have at least one, and preferably all three power supplies in reserve on the site.  Let us assume that we need three power supply units in spare parts and equipment - this is plus 36 thousand rubles.  You need to check the power that the rack-mount ATS can switch.  Now we assume that 3 kW or 16A will be enough for all the equipment in the rack.  If we need ATS for 32A (7kW), then it will be much more expensive (more than 100 thousand rubles).  That is, the budget option of the Customer with a detailed review of reliability <b>increases to 160 thousand rubles</b> .  In this case, in the case of emergency, despite the fact that spare parts will be on site, you will need down-time to replace the device. <br><blockquote>  Single Point Of Failure (SPOF, Single Point Of Failure) ‚Äîa node, link, or data accessibility system object, the failure of which can disable the entire system or cause data unavailability </blockquote>  <b>Open Technology Option</b> : As <a href="https://habr.com/ru/company/open_technologies/blog/423801/">per Figure 3</a> , but if necessary, add ATS for small network equipment with a single power supply. <br><br>  The point of failure is the same ATS.  If something happens to him, then we lose the entire rack entirely.  We agree that it is necessary to have a spare parts kit right on the site.  But in our case, if only ATS refuses, then this can only affect the operation of switches and auxiliary equipment.  The servers themselves will continue to work quietly.  Power supplies in the ZIP are not needed.  Since if one of the duplicated power supplies fails, the server will continue to work on the rest, and, most likely, it will wait for a new power supply from the vendor, regardless of the site distance. <br><br><div class="spoiler">  <b class="spoiler_title">Interpretation of the term SPOF as applied to IT systems</b> <div class="spoiler_text">  Single Point Of Failure (SPOF, Single Point Of Failure) is a node, device, or circuit point whose failure can disable the entire system and cause unavailability of data and services.  Considered when developing and designing any critical systems.  The complete absence of single points of failure leads to a significant increase in capital costs during implementation, so the criticality of a particular system, service is determined at the design stage based on the project budget, as well as the wishes and requirements of the Customer.  We always find the perfect solution for each customer, defining several options for the project, and offering them to the customer.  As a result, at the stage of project delivery, the customer receives exactly the solution he wanted to see in terms of price / quality / reliability. <br></div></div><br>  Thus, it is possible to connect all the equipment of the rack to a single ATS, but not rationally, since in this case we get a single point of failure on the power supply.  Purchase of servers with duplicated power supply units is preferable in any case, since the fault tolerance at the level of information equipment increases significantly. <br><br>  The rack-mounted load switch ensures correct and almost instantaneous switching to backup input, the information equipment will not even feel it, software products and operating systems will continue to operate correctly.  Rack-mount power distribution units in any case are needed and you do not need to save on them.  Visible savings in capital costs for power distribution can lead to unsolvable problems during operation, for example, the need to ‚Äúextinguish‚Äù the entire rack just to move the ATS to another unit or to revise the rack load switch.  <u>In any case, duplicate power supplies should have a spare parts kit, but it is not always possible or available.</u> <br><br>  Appearance of removable server power supply: <br><br><img src="https://habrastorage.org/webt/sa/k8/z7/sak8z7qec843lrdyomvuq69bhdw.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">The use of rack-mount AVR has its own characteristics</b> <div class="spoiler_text">  For example, the power of such AVR is limited, and it can switch the complex relatively weak in terms of power consumption loads.  Have questions about the number of output power connectors.  For example, the aforementioned ATS AP7721 is equipped with C14 connectors at the input, which means a maximum switching power of 2.5 kW.  For a large load power, there is a 2U model <a href="https://www.apc.com/shop/ru/ru/products/Rack-ATS-2U-230V-32A-IEC309-32A-In-16C13-2C19-Out/P-AP7724">AP7724</a> , which is equipped with a 32 A plug at the input, that is, the maximum power of the equipment can be up to 7 kW.  This means that a typical rack with equipment can be connected to this automatic transfer switch in full.  However, the price of such a decision will be more than 100 thousand rubles. <br></div></div><br>  The work of information equipment with two power supplies was well described in the <a href="https://habrahabr.ru/company/pc-administrator/blog/310698/">article by Vadim Sinitsky @ dimskiy</a> .  As you can see, there are advantages and disadvantages.  And the presence of redundant power supplies for information equipment in any case is necessary, especially if the object is outside the zone of fast delivery of the power supply from the vendor.  In addition, we want to note that online calculators for calculating the capacity of new servers from vendors can only be used as a guideline for system administrators and customer personnel. <br><br>  The real possibilities of connecting the new powerful server to the existing rack should be assessed taking into account the initial power supply design, current state and load of the rack, server, UPS, generator ....  In terms of connection to the rack, it is also worth considering: <br><br><ul><li>  current PDU capabilities, such as loose connectors in them </li><li>  ratings of automata in the boards and the cross section and the phase of the cable line to the rack. </li></ul><br>  Separate attention should be paid to the reliability of the server power supply system, if it is built on the system shown in <a href="https://habr.com/ru/company/open_technologies/blog/423801/">Fig. 2</a> (with two bus systems), the presence of a new powerful server may, in the case of repair work, lead to an overload of the entire power supply system, reduce the battery runtime of the <a href="https://habr.com/company/open_technologies/blog/421803/">UPS</a> , force the UPS to transfer to the bypass for overload and so on ... <br><br>  <i>And how is your distribution system built in the rack?</i> <i><br></i>  <i>What is the BP resource for IT equipment and the algorithm for their software redundancy?</i> <i><br></i>  <i>Which PDU do you prefer to use: basic, monitored?</i>  <i>How useful is the ‚Äúmanaged PDU / PDU‚Äù function in practice and has it ever helped you?</i> <br><br>  Author: Oleg Kulikov <br>  Lead Design Engineer <br>  Department of integration solutions <br>  "Open Technologies" <br>  okulikov@ot.ru <br>  Registration in the National Register of Specialists "NOPRIZ" P-045870 </div><p>Source: <a href="https://habr.com/ru/post/423801/">https://habr.com/ru/post/423801/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423787/index.html">TEST Labs 2018. Online MAP for testers. September 28 - 29</a></li>
<li><a href="../423791/index.html">We make a 3D configurator without programming and layout. Part two</a></li>
<li><a href="../423793/index.html">‚ÄúWe made this decision, damn it, on time!‚Äù - 10 questions to the programmer, issue 5</a></li>
<li><a href="../423797/index.html">Daring bird structures: development flow</a></li>
<li><a href="../423799/index.html">Briefing as an investment. Introduce intranet correctly</a></li>
<li><a href="../423803/index.html">Consumer-Driven Contracts as a way to develop a service</a></li>
<li><a href="../423805/index.html">Jeff Bezos Philosophy: "Day 1"</a></li>
<li><a href="../423807/index.html">How to use ‚ÄúTobii Eye Tracker 4C‚Äù to communicate with a child who cannot speak and move (SMA, Cerebral Palsy, ALS)</a></li>
<li><a href="../423809/index.html">Reducing AWS costs with Kubernetes Ingress with the classic ELB balancer</a></li>
<li><a href="../423811/index.html">Julia. Acquaintance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>