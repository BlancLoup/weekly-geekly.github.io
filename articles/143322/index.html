<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing complex interfaces with Spine.js</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction to Spine.js 
 Spine is a small framework that allows you to work on the MVC scheme, creating applications directly in the JavaScript lang...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing complex interfaces with Spine.js</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction to Spine.js </h4><br>  Spine is a small framework that allows you to work on the MVC scheme, creating applications directly in the JavaScript language, which provides a logical separation of code, model inheritance through classes and extensions.  Also, this tool is largely based on the Backbone.js API, so those developers who dealt with this framework will easily figure out Spine (however, there are a number of significant differences).  <a href="http://maccman.github.com/spine/">Spine.js</a> can work in conjunction with HTML5 and asynchronous server requests. <br><a name="habracut"></a><br>  Every day JavaScript frameworks appear more and more.  So what makes Spine.js so special? <br><ul><li>  Simple controller implementation (based on Backbone's API) </li><li>  Ajax and HTML5 Local Storage Support </li><li>  Asynchronous communication with the server </li><li>  Works in all modern browsers (Chrome, Safari, Firefox, IE&gt; = 7) </li><li>  <a href="http://spinejs.com/mobile/docs/index">Spine Mobile</a> extension </li><li>  Simple and easy </li><li>  Good documentation </li></ul><br>  Take a look at the source code of the <a href="http://spinejs.com/pages/examples">sample application</a> , and decide for yourself. <br><br><h4>  Spine Classes, Models and Views </h4><br>  The official <a href="http://maccman.github.com/spine/">Spine</a> documentation contains the most comprehensive guide I've ever seen.  It includes a lot of things: work with validation, serialization and a whole bunch of chips.  However, the goal of this lesson is to become familiar with the three largest features: <b>classes</b> , <b>models</b> and <b>views</b> . <br><br><img src="https://habrastorage.org/storage2/cee/029/1bd/cee0291bd50ff136adf6f4997262e71f.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Classes </h4><br>  At the heart of Spine, Object.create emulation is used to ensure that objects are created dynamically and can be used while the script is running.  The use of such classes can be seen in the following example: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> twitterClient = Spine.Class.create(); <span class="hljs-comment"><span class="hljs-comment">//or var twitterClientWithArgs = Spine.Class.create({ testMessage: "If it weren't for WebMD I would have never known what symptoms to mimic so I could get all these prescriptions from my doctor." });</span></span></code> </pre> <br>  To initialize classes, use the init () method.  Spine developers have decided not to exploit the constructor function, since using the keyword "new" can cause some problems when creating instances of a class. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> twitterClient = Spine.Class.create({ <span class="hljs-attr"><span class="hljs-attr">testMessage</span></span>: <span class="hljs-string"><span class="hljs-string">"Hello world"</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myclient = twitterClient.init();</code> </pre> <br>  All parameters that you want to use when initializing an object should be passed through the init () method.  Example: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> twitterClient = Spine.Class.create({ <span class="hljs-attr"><span class="hljs-attr">init</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">testMessage</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.testMessage = testMessage; } });</code> </pre> <br><h4>  Models </h4><br>  In the Spine model are used to store application data, as well as for any other logic associated with this data.  It should adhere to this idea, because  It is one of the requirements in an application that builds on MVC.  The data associated with the models is stored in the Model.records record, and can be created using the Spine setup () function. <br><br>  The following example sets the model name and attribute set to the setup () method: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Tweets = Spine.Model.setup(<span class="hljs-string"><span class="hljs-string">"Tweet"</span></span>, [<span class="hljs-string"><span class="hljs-string">"username"</span></span>,<span class="hljs-string"><span class="hljs-string">"tweet_message"</span></span>]);</code> </pre> <br>  The functionality of the models can be extended using the properties of a particular class as follows: <br><br><pre> <code class="javascript hljs">Tweets.include({ <span class="hljs-attr"><span class="hljs-attr">toTweetString</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(<span class="hljs-string"><span class="hljs-string">"@"</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.username + <span class="hljs-string"><span class="hljs-string">" "</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tweet_message); } });</code> </pre> <br>  Creating a model is carried out using the same simple .init () method: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mytweets = Tweets.init({<span class="hljs-attr"><span class="hljs-attr">username</span></span>: <span class="hljs-string"><span class="hljs-string">"addyosmani"</span></span>, <span class="hljs-attr"><span class="hljs-attr">tweet_message</span></span>: <span class="hljs-string"><span class="hljs-string">"hai twitter"</span></span>});</code> </pre> <br>  Spine and Backbone have various options for rendering templates and embedding them in the DOM model. <br><br><h4>  Controllers </h4><br>  Spine controllers extend Spine.Class, and also inherit all its properties.  An example of creating a controller in Spine: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> TweetController = Spine.Controller.create({ <span class="hljs-attr"><span class="hljs-attr">init</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//initial logic on instantiation } })</span></span></code> </pre> <br>  The initialization of the controllers is as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myTweetController = TweetController.init();</code> </pre> <br>  Each controller corresponds to a special element - 'el', which can be passed through an instance property.  Example: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myTweetController = TweetController.init({<span class="hljs-attr"><span class="hljs-attr">el</span></span>: $(<span class="hljs-string"><span class="hljs-string">'#tweets'</span></span>)});</code> </pre> <br><h4>  Documentation </h4><br>  You can read more about <a href="http://maccman.github.com/spine/">classes</a> , <a href="http://maccman.github.com/spine/">models</a> and <a href="http://maccman.github.com/spine/">controllers</a> in the Spine documentation. <br><br><h4>  The main differences between Spine and Backbone </h4><br>  Developers who have read the documentation for Backbone and Spine, in the first minutes will not be able to find fundamental differences.  However, in a real project, these differences may appear by themselves. <br><br>  1. Views in Backbone are more like traditional controllers in their application, and Backbone controllers are more responsible for handling URL routing.  In Spine, routing support was added quite recently (because it is a very necessary element), and controllers are very similar to the views in Backbone. <br><br>  2. Backbone uses constructor functions and prototypes, while Spine uses an emulated version of Object.create and a simulated class system - which allows you to achieve the same inheritance effect and is actually a very interesting technique.  This is one of the fundamental differences from Backbone.  Both approaches have the right to exist. <br><br>  3. A lot of developers pay attention to the difference in the size of files of this or that library: in this regard, we can note the fact that Spine does not include mapping, filtering, and many other functions that are included in Backbone.  If size matters to you, then you definitely need to choose Spine, because  in this regard, he wins in all respects. <br><br><h4>  Spine.js in practice </h4><br><h5>  Example: Bit.ly client </h5><br><img src="https://habrastorage.org/storage2/95b/275/51c/95b27551c2d294dd8fc5222d2b852e6f.jpg"><br><br><img src="https://habrastorage.org/storage2/008/c96/e1c/008c96e1c12b3f3b4c8cec5cc5f0776b.jpg"><br><br>  When you are working on a SPA, a lot of time is spent on work and interaction with external data (this can be your own data or data obtained from some API).  You would also like to use routing so that you can save the state of the application.  To do this, you may have to use localStorage, as well as process ajax requests. <br><br>  Considering all of the above, we are going to create a bit.ly client that will allow you to: <br><br><ul><li>  create attractive URLs directly from your browser; </li><li>  archive your bit.ly URLs so that you can easily access them at any time; </li><li>  provision of click statistics (this will be implemented via an additional 'view', to demonstrate routing). </li></ul><br><h4>  Prerequisites </h4><br><h5>  Creating a bit.ly plugin </h5><br>  Before we begin, we need to find a good way to access bit.ly services: 1. a shortened URL and 2. click statistics.  Instead of suffering with regular JavaScript, we will use jQuery to work with ajax requests in a more convenient and faster way.  This approach will also allow us to write a more readable and understandable application. <br><br><h5>  Additional support store.js </h5><br>  By default, Spine is focused on modern browsers and it is for this reason that such things as localStorage will not work equally in all browsers, so if you need cross-browser compatibility, then you should use older tools. <br><br>  However, this problem can be solved by using store.js (and what it is based on: json2.js).  Below is the content of the spine.model.local.js file, which you can update to use the repository by commenting on the lines that are marked below and replacing them with your own. <br><br><pre> <code class="javascript hljs">Spine.Model.Local = { <span class="hljs-attr"><span class="hljs-attr">extended</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sync(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.proxy(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.saveLocal)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fetch(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.proxy(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadLocal)); }, <span class="hljs-attr"><span class="hljs-attr">saveLocal</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-comment"><span class="hljs-comment">//localStorage[this.name] = result; store.set(this.name, result); }, loadLocal: function(){ //var result = localStorage[this.name]; var result = store.get(this.name); if ( !result ) return; var result = JSON.parse(result); this.refresh(result); } };</span></span></code> </pre> <br><h5>  JQuery template processing </h5><br>  Spine and Backbone frameworks can interact with several approaches (micro-pattern processing, mustache.js, and so on).  Which one to use, choose you.  The sample uses the jQuery tmpl plugin to present our abbreviated URL entries and click statistics using templates. <br><br><h4>  Development </h4><br>  A list of what needs to be implemented: <br><br><ul><li>  Model to present the data that will be contained in each shortened URL (Model Url); </li><li>  The controller to represent the individual entries and actions that can be performed by the application (exports.URL); </li><li>  The controller for displaying the view responsible for entering the bit.ly entry (exports.UrlsList); </li><li>  The controller to display the view responsible for the statistics of clicks on a particular entry (exports.Stats); </li><li>  A universal controller that will handle application routing (exports. UrlApp). </li></ul><br>  The example uses <a href="http://jquery.com/">jQuery</a> because it is ideal for working with the template and the plugin, but Spine can also work with <a href="http://zeptojs.com/">Zepto</a> or other JavaScript libraries.  Now let's look at the code for our application: <br><br><h4>  Initial caching </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> exports = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>;</code> </pre> <br><br><h4>  Simple jQuery plugin </h4><br><pre> <code class="javascript hljs">$.fn.toggleDisplay = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bool</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> bool == <span class="hljs-string"><span class="hljs-string">"undefined"</span></span> ) { bool = !$(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).filter(<span class="hljs-string"><span class="hljs-string">":first:visible"</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)[bool ? <span class="hljs-string"><span class="hljs-string">"show"</span></span> : <span class="hljs-string"><span class="hljs-string">"hide"</span></span>](); };</code> </pre> <br><h4>  Url models: </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Url = Spine.Model.setup(<span class="hljs-string"><span class="hljs-string">"Url"</span></span>, [<span class="hljs-string"><span class="hljs-string">"short_url"</span></span>, <span class="hljs-string"><span class="hljs-string">"long_url"</span></span>, <span class="hljs-string"><span class="hljs-string">"stats"</span></span>]); Url.extend(Spine.Model.Local); Url.include({ <span class="hljs-attr"><span class="hljs-attr">validate</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.long_url ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"long_url required"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.long_url.match(<span class="hljs-regexp"><span class="hljs-regexp">/:\/\//</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.long_url = <span class="hljs-string"><span class="hljs-string">"http://"</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.long_url }, <span class="hljs-attr"><span class="hljs-attr">fetchUrl</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.short_url ) $.bitly(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.long_url, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.proxy(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.updateAttributes({<span class="hljs-attr"><span class="hljs-attr">short_url</span></span>: result}); })); }, <span class="hljs-attr"><span class="hljs-attr">fetchStats</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.short_url ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; $.bitly.stats(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.short_url, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.proxy(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.updateAttributes({<span class="hljs-attr"><span class="hljs-attr">stats</span></span>: result}); })); } }); Url.bind(<span class="hljs-string"><span class="hljs-string">"create"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rec</span></span></span><span class="hljs-function">)</span></span>{ rec.fetchUrl(); });</code> </pre> <br><h4>  The exports.Urls controller: </h4><br><pre> <code class="javascript hljs">exports.Urls = Spine.Controller.create({ <span class="hljs-attr"><span class="hljs-attr">events</span></span>: { <span class="hljs-string"><span class="hljs-string">"click .destroy"</span></span>: <span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, <span class="hljs-string"><span class="hljs-string">"click .toggleStats"</span></span>: <span class="hljs-string"><span class="hljs-string">"toggleStats"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">proxied</span></span>: [<span class="hljs-string"><span class="hljs-string">"render"</span></span>, <span class="hljs-string"><span class="hljs-string">"remove"</span></span>], <span class="hljs-attr"><span class="hljs-attr">template</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">items</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $(<span class="hljs-string"><span class="hljs-string">"#urlTemplate"</span></span>).tmpl(items); }, <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.item.bind(<span class="hljs-string"><span class="hljs-string">"update"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.render); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.item.bind(<span class="hljs-string"><span class="hljs-string">"destroy"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.remove); }, <span class="hljs-attr"><span class="hljs-attr">render</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.el.html(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.template(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.item)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }, <span class="hljs-attr"><span class="hljs-attr">toggleStats</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.navigate(<span class="hljs-string"><span class="hljs-string">"/stats"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.item.id, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); }, <span class="hljs-attr"><span class="hljs-attr">remove</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.el.remove(); }, <span class="hljs-attr"><span class="hljs-attr">destroy</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.item.destroy(); } });</code> </pre> <br><h4>  The exports.UrlsList controller: </h4><br><pre> <code class="javascript hljs">exports.UrlsList = Spine.Controller.create({ <span class="hljs-attr"><span class="hljs-attr">elements</span></span>: { <span class="hljs-string"><span class="hljs-string">".items"</span></span>: <span class="hljs-string"><span class="hljs-string">"items"</span></span>, <span class="hljs-string"><span class="hljs-string">"form"</span></span>: <span class="hljs-string"><span class="hljs-string">"form"</span></span>, <span class="hljs-string"><span class="hljs-string">"input"</span></span>: <span class="hljs-string"><span class="hljs-string">"input"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">events</span></span>: { <span class="hljs-string"><span class="hljs-string">"submit form"</span></span>: <span class="hljs-string"><span class="hljs-string">"create"</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">proxied</span></span>: [<span class="hljs-string"><span class="hljs-string">"render"</span></span>, <span class="hljs-string"><span class="hljs-string">"addAll"</span></span>, <span class="hljs-string"><span class="hljs-string">"addOne"</span></span>], <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ Url.bind(<span class="hljs-string"><span class="hljs-string">"create"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addOne); Url.bind(<span class="hljs-string"><span class="hljs-string">"refresh"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addAll); }, <span class="hljs-attr"><span class="hljs-attr">addOne</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> view = Urls.init({<span class="hljs-attr"><span class="hljs-attr">item</span></span>: url}); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items.append(view.render().el); }, <span class="hljs-attr"><span class="hljs-attr">addAll</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ Url.each(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addOne); }, <span class="hljs-attr"><span class="hljs-attr">create</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">)</span></span>{ e.preventDefault(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.input.val(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value) Url.create({<span class="hljs-attr"><span class="hljs-attr">long_url</span></span>: value}); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.input.val(<span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.input.focus(); } });</code> </pre> <br><h4>  The exports.Stats controller: </h4><br><pre> <code class="javascript hljs">exports.Stats = Spine.Controller.create({ <span class="hljs-attr"><span class="hljs-attr">events</span></span>: { <span class="hljs-string"><span class="hljs-string">"click .back"</span></span>: <span class="hljs-string"><span class="hljs-string">"back"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">proxied</span></span>: [<span class="hljs-string"><span class="hljs-string">"change"</span></span>, <span class="hljs-string"><span class="hljs-string">"render"</span></span>], <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ Url.bind(<span class="hljs-string"><span class="hljs-string">"update"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.render); }, <span class="hljs-attr"><span class="hljs-attr">template</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">items</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $(<span class="hljs-string"><span class="hljs-string">"#statsTemplate"</span></span>).tmpl(items); }, <span class="hljs-attr"><span class="hljs-attr">render</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.item ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.el.html(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.template(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.item)); }, <span class="hljs-attr"><span class="hljs-attr">change</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.item = item; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.navigate(<span class="hljs-string"><span class="hljs-string">"/stats"</span></span>, item.id); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.item.fetchStats(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.render(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.active(); }, <span class="hljs-attr"><span class="hljs-attr">back</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.navigate(<span class="hljs-string"><span class="hljs-string">"/list"</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); } });</code> </pre> <br><h4>  Controller exports.UrlApp: </h4><br><pre> <code class="javascript hljs">exports.UrlApp = Spine.Controller.create({ <span class="hljs-attr"><span class="hljs-attr">el</span></span>: $(<span class="hljs-string"><span class="hljs-string">"body"</span></span>), <span class="hljs-attr"><span class="hljs-attr">elements</span></span>: { <span class="hljs-string"><span class="hljs-string">"#urls"</span></span>: <span class="hljs-string"><span class="hljs-string">"urlsEl"</span></span>, <span class="hljs-string"><span class="hljs-string">"#stats"</span></span>: <span class="hljs-string"><span class="hljs-string">"statsEl"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list = UrlsList.init({<span class="hljs-attr"><span class="hljs-attr">el</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.urlsEl}); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stats = Stats.init({<span class="hljs-attr"><span class="hljs-attr">el</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.statsEl}); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.manager = Spine.Controller.Manager.init(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.manager.addAll(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stats); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.routes({ <span class="hljs-string"><span class="hljs-string">""</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list.active() }, <span class="hljs-string"><span class="hljs-string">"/list"</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list.active() }, <span class="hljs-string"><span class="hljs-string">"/stats/:id"</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stats.change(Url.find(id)) } }); Url.fetch(); Spine.Route.setup(); } });</code> </pre> <br>  Finally, in order to complete the initialization of our app controller: <br><br><pre> <code class="javascript hljs">exports.App = UrlApp.init();</code> </pre> <br><h4>  Code to shorten the URL and click statistics for Bit.ly </h4><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> defaults = { <span class="hljs-attr"><span class="hljs-attr">version</span></span>: <span class="hljs-string"><span class="hljs-string">"3.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">login</span></span>: <span class="hljs-string"><span class="hljs-string">"legacye"</span></span>, <span class="hljs-attr"><span class="hljs-attr">apiKey</span></span>: <span class="hljs-string"><span class="hljs-string">"R_32f60d09cccde1f266bcba8c242bfb5a"</span></span>, <span class="hljs-attr"><span class="hljs-attr">history</span></span>: <span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">format</span></span>: <span class="hljs-string"><span class="hljs-string">"json"</span></span> }; $.bitly = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> url, callback, params </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !url || !callback ) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>(<span class="hljs-string"><span class="hljs-string">"url and callback required"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> params = $.extend( defaults, params ); params.longUrl = url; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.getJSON(<span class="hljs-string"><span class="hljs-string">"http://api.bit.ly/shorten?callback=?"</span></span>, params, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, status, xhr</span></span></span><span class="hljs-function">)</span></span>{ callback(data.results[params.longUrl].shortUrl, data.results[params.longUrl], data); }); }; $.bitly.stats = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> url, callback, params </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !url || !callback ) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>(<span class="hljs-string"><span class="hljs-string">"url and callback required"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> params = $.extend( defaults, params ); params.shortUrl = url; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.getJSON(<span class="hljs-string"><span class="hljs-string">"http://api.bitly.com/v3/clicks?callback=?"</span></span>, params, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, status, xhr</span></span></span><span class="hljs-function">)</span></span>{ callback(data.data.clicks[<span class="hljs-number"><span class="hljs-number">0</span></span>], data); }); }; })(jQuery);</code> </pre> <br><h4>  Application Index / HTML: </h4><br>  LABjs is used to control the application, but you can easily replace it with something you are used to working with. <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"css/application.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"lib/LAB.min.js"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> $LAB .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"lib/json.js"</span></span></span><span class="actionscript">) .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"lib/jquery.js"</span></span></span><span class="actionscript">) .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"lib/jquery.tmpl.js"</span></span></span><span class="actionscript">) .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"lib/jquery.bitly.js"</span></span></span><span class="actionscript">) .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"lib/store.min.js"</span></span></span><span class="actionscript">) .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"lib/spine.js"</span></span></span><span class="actionscript">) .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"lib/spine.model.local.js"</span></span></span><span class="actionscript">) .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"lib/spine.controller.manager.js"</span></span></span><span class="actionscript">) .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"lib/spine.route.js"</span></span></span><span class="actionscript">) .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"app/models/url.js"</span></span></span><span class="actionscript">) .script(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"app/application.js"</span></span></span><span class="actionscript">); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/x-jquery-tmpl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urlTemplate"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> &lt;div </span><span class="hljs-class"><span class="hljs-keyword"><span class="javascript"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span><span class="javascript">=</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"item"</span></span></span><span class="javascript">&gt; </span><span class="xml"><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag"> </span></span></span><span class="hljs-attr"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">=</span></span></span><span class="hljs-string"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"show"</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="javascript"><span class="xml"> </span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag"> </span></span></span><span class="hljs-attr"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">=</span></span></span><span class="hljs-string"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"short"</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="javascript"><span class="xml"> ${long_url} </span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="javascript"><span class="xml"> </span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag"> </span></span></span><span class="hljs-attr"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">=</span></span></span><span class="hljs-string"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"long"</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="javascript"><span class="xml"> {{if short_url}} </span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag"> </span></span></span><span class="hljs-attr"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">=</span></span></span><span class="hljs-string"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"${short_url}"</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="javascript"><span class="xml">${short_url}</span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="javascript"><span class="xml"> {{else}} Generating... {{/if}} </span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="javascript"><span class="xml"> </span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag"> </span></span></span><span class="hljs-attr"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">=</span></span></span><span class="hljs-string"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"toggleStats"</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="javascript"><span class="xml"> </span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag"> </span></span></span><span class="hljs-attr"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">=</span></span></span><span class="hljs-string"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"destroy"</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="javascript"><span class="xml"> </span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span><span class="javascript"> &lt;</span><span class="hljs-regexp"><span class="javascript"><span class="hljs-regexp">/div&gt; </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/x-jquery-tmpl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"statsTemplate"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"stats"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"back"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Back</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Click Statistics</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"longUrl"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">${long_url}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Short URL: {{if short_url}} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"${short_url}"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">${short_url}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {{else}} Generating... {{/if}} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {{if stats}} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Global clicks: ${stats.global_clicks}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">User clicks: ${stats.user_clicks}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {{else}} Fetching... {{/if}} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"views"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urls"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Bit.ly Client<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Enter a URL"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"items"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stats"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h4>  Note: </h4><br><ul><li>  For cross-browser compatibility, this example should be run on a live or local web server.  Use MAMP / WAMP if necessary; </li><li>  For checking click statistics, I recommend using the URLs of the sites that are most popular.  For example, information about the site <a href="http://www.google.com/">www.google.com is</a> certainly present in the Bit.ly database; </li><li>  The demo example uses my own Bit.ly API keys that need to be replaced. </li><li>  Pie charts are generated using the Google Chart API.  In order not to complicate the approach that is so new to you, I myself chose to change the image of the diagram, but you can easily switch to the Visualization API at any time; </li><li>  The application directory structure is completely up to you.  Some developers prefer the general structure - model / view / controller, while others prefer to have a universal application folder, where everything is contained in a single file.  The example uses the folder structure I‚Äôm used to. </li><li>  If you want to save unique ‚Äúviews‚Äù for content (for example, one view for # ui / dashboard, and another for # ui / stats), then you need to parse the work of spine.controller.manager.js, since  In this file there is a solution to this problem. </li></ul><br>  That's all! <br><br>  <a href="http://addyosmani.com/resources/spinebitly/">Result</a> <br>  <a href="https://github.com/addyosmani/spine.bitly/zipball/master">Sources</a> <br><br><h4>  Conclusion </h4><br>  Spine is a good alternative to Backbone.  The documentation is pretty good to continue self-study. <br><br>  Used materials: <br><ul><li>  <a href="http://www.addyosmani.com/blog/building-apps-spinejs/">www.addyosmani.com/blog/building-apps-spinejs</a> </li><li>  <a href="http://maccman.github.com/spine/">maccman.github.com/spine</a> </li><li>  <a href="http://shop.oreilly.com/product/0636920018421.do">JavaScript Web Applications</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/143322/">https://habr.com/ru/post/143322/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143315/index.html">We tame hotkeys with C # plugin system</a></li>
<li><a href="../143317/index.html">We write our API for the site using Apache, PHP and MySQL</a></li>
<li><a href="../143318/index.html">Multitasking in Continuation Based Microcontrollers</a></li>
<li><a href="../143320/index.html">Backing up Mikrotik to Subversion via SSH / SFTP</a></li>
<li><a href="../143321/index.html">Apple and Samsung share the revenue of almost the entire mobile market.</a></li>
<li><a href="../143323/index.html">Using the Microsoft Bing Translator API in Your Application</a></li>
<li><a href="../143324/index.html">Installing iOS 4.2 simulator in Xcode 4.3</a></li>
<li><a href="../143325/index.html">What does the Titanium SDK update to version 2.0 carry?</a></li>
<li><a href="../143327/index.html">A little paranoia for online storage</a></li>
<li><a href="../143330/index.html">I am looking for a team of like-minded people</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>