<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Video surveillance in the entrance on their own</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I read a relatively recent publication about video surveillance and decided to describe my experience. I consider my decision to be optimal in terms o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Video surveillance in the entrance on their own</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/fa/w0/x0/faw0x0rqm2xcjlp0hmo4fkuis-c.jpeg"><br><br>  I read a relatively recent publication about video surveillance and decided to describe my experience.  I consider my decision to be optimal in terms of price / functionality, but I‚Äôm happy to hear criticism from more experienced people. <br><br>  So, the task is to make video surveillance at the entrance in front of the entrance (apartment) door with minimal material and time resources.  It is advisable not to record round-the-clock ‚Äúempty‚Äù pictures, i.e.  Motion detection is required.  It would also be good to have remote access to the records. <br><a name="habracut"></a><br><h2>  Hardware </h2><br>  Immediately I will inform you that I took into account the requirements of the administration about restricting advertising in publications, so the name of the manufacturers where it does not matter, I do not quote. <br>  Even during the repair, he asked the builders to lay an Ethernet cable in the porch above the door.  There is no power supply, so I had to buy a PoE injector for 600 rubles.  Cable length - 10 meters. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I bought a dome anti-vandal camera for 5,000 rubles with PoE power supply, a Chinese company well-known in these circles.  Connecting a USB camera at the entrance is technically difficult. <br>  WiFi camera would not solve the problem because  food to her in any case must be kept. <br><br>  The DVR seemed very expensive, so I bought a single Odroid C2 computer for 3900 rubles.  But the most important thing in the choice was that I could not find an inexpensive DVR that would then allow me to write my own software on it to send files to the cloud storage and interact with Telegram (more on that later).  In addition, I had many other tasks for a single-board computer - weather monitoring, Telegram bot, etc.  In general, it was a universal solution for many problems.  RaspberryPi is also suitable.  It turns out that the money for the hardware did not exceed 10 thousand rubles. <br><br><h2>  Software </h2><br>  The operating system is Ubuntu for Odroid. <br><br>  I am not a programmer and have never been and will never be, but with Python I was able to figure out a few months of rare evening experiments.  I could write the simplest Telegram bot on the <a href="https://github.com/eternnoir/pyTelegramBotAPI">telebot</a> library.  Therefore, for complex scripts I use Python.  Glad I learned it because  I solved many other problems with the help of this language.  I need Python to send recorded files to Yandex Disk. <br><br>  By ‚Äúgoogling‚Äù you can learn how to build bash scripts from other solutions and I use them in simplified versions. <br><br>  And most importantly - the program Motion. <br><br><h2>  Motion </h2><br>  I will discuss below the shortcomings and problems of this solution, but still it is free and simple.  Motion allows you to solve the problem of motion detection and video recording in mjpeg format, when something happens in the stairwell. <br><br>  My publication is not a Motion manual.  I describe only the essential points, although the full configuration file will lead below. <br><br>  By the way, the camera itself can detect movement.  In this case, it uploads a set of pictures to the FTP server.  I also use this mode in case the motion for any reason misses the motion and does not record the video, essentially duplication. <br><br>  For those who are not familiar with Motion, I will inform you that this is a program whose purpose is to record video in cases if it (the program) determines that the picture from the camera has changed (something is moving in front of the camera).  To do this, it constantly compares the pictures and determines that the new picture is not equal to the previous one in some percentage (the percentage of discrepancy is specified in the configuration file).  The recording stops after the picture has ceased to change during a specified period of time (also specified in the configuration). <br><br>  At the entrance, the Management Company installed a lamp with motion sensors.  The lamp is constantly turned on / off even without moving.  Motion in this case starts recording video, so I use its setting <i>LIGHTSWITCH = 1</i> .  In this case, Motion skips 5 frames to re-adjust the sensitivity of the camera.  Unfortunately, this does not always work, but I'm sure this is my special case.  Sometimes I plan to turn off the motion sensors on the lamps in the stairwell, but may the total electricity be saved. <br><br>  The most important parameter is the number of frames per second that Motion takes for analysis and writes down ( <i>FRAMERATE</i> parameter). Let's say if the parameter is 5, as in the example, Motion ‚Äútakes‚Äù 5 frames per second - the video is intermittent, but quite sufficient to understand what's happening.  Increasing this parameter smoothes the recorded video, reduces the response time to movement, but increases the load on the processor.  5 frames per second, it seemed to me the most optimal. <br><br>  Motion records video itself, but if you want to make a recording with your own parameters (for example, with a different <i>FRAMERATE</i> ) you can configure the simplest recording: <br><br><pre><code class="bash hljs">on_event_start = vlc rtsp://admin:vova@192.168.0.100:554/Streaming/Channels/101 --sout=file/ps:/home/vova/Files/Camera/$(date +%m%d%H%M%S).mp4 on_event_end = pkill -f vlc</code> </pre> <br>  The used architecture allows using Motion version 3.2.12 + git20140228, specially assembled for it.  The old version is not updated, but it works fine.  Its main problem is that when working with WiFI (and Odroid is connected via WiFi to the local network), sometimes Motion loses connection with the camera and this connection is not restored by itself.  You have to restart Motion.  The loss of communication is manifested in the fact that Motion ‚Äúfreezes‚Äù on one picture.  In order to restart Motion, I wrote a special script: it writes several pictures from the Motion Web server (Motion allows you to watch videos from the embedded Web server), compares them to each other in size and if the size is the same, it means Motion is ‚Äúfrozen‚Äù on one picture.  Why in size?  I could compare them by content using the Python Pillow package, but this is an extra load on the processor - Pillow is very resource intensive, you need to compare all the pixels between them. <br><br>  The second solution is to connect odroid via Ethernet.  In this case, there is no problem. <br><br>  I wanted that if there is movement in front of my door, the photo would come to the Telegram-bot.  To do this, in the parameter set the execution of the simplest bash script.  But first you need to set the detection area: area_detect = 89. This means that Motion detects movement in squares 8 and 9. <br><br> <code>1 2 3 <br> 4 5 6 <br> 7 <b>8 9</b></code> <br> <br>  Next, create a script to send photos to Telegram <br><br><div class="spoiler">  <b class="spoiler_title">send_pix</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh # Token for Telegram TOKEN=1234567890abcdg # Get snapshot from Camera wget --user admin --password vova -O /home/vova/Files/output.jpg http://192.168.0.100/Streaming/channels/1/picture #Send snapshot to Telegram curl -s "https://api.telegram.org/bot${TOKEN}/sendPhoto" -F chat_id=12345678 -F photo="@/home/vova/Files/output.jpg" -F caption=$1</span></span></code> </pre><br></div></div><br>  That it worked when detecting in the configuration file we write the parameter <br><br><pre> <code class="bash hljs">on_area_detected = /home/vova/Core/scrypts/send_pix</code> </pre> <br>  So, in the Telegram looks like this <br><br><img src="https://habrastorage.org/webt/dw/pv/_2/dwpv_26wt214dxzxzhnklalznb0.jpeg"><br><br>  Here is my entire configuration file. <br><br><div class="spoiler">  <b class="spoiler_title">motion.cfg</b> <div class="spoiler_text"><pre> <code class="hljs vhdl"># /home/vova/Core/scrypts/motion/motion.conf # # This config <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> was generated by motion <span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">12</span></span>+git20140228 ############################################################ # Daemon ############################################################ # Start <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> daemon (background) mode <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">release</span></span> terminal (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) daemon <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">File</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> store the <span class="hljs-keyword"><span class="hljs-keyword">process</span></span> ID, also called pid <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>. (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) process_id_file /home/vova/Core/scrypts/pid/motion.pid ############################################################ # Basic Setup Mode ############################################################ # Start <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Setup-Mode, daemon disabled. (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) setup_mode off # <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> save logs messages, <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined stderr <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> syslog <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> used. (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) logfile /home/vova/Files/Logs/motion/motion.log # Level <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> log messages [<span class="hljs-number"><span class="hljs-number">1</span></span>..<span class="hljs-number"><span class="hljs-number">9</span></span>] (EMR, ALR, CRT, ERR, WRN, NTC, ERR, DBG, <span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span>). (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span> / NTC) log_level <span class="hljs-number"><span class="hljs-number">6</span></span> # Filter <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> log messages by <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> (COR, STR, ENC, NET, DBL, EVT, TRK, VID, <span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span>). (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span>) log_type <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> ########################################################### # Capture device options ############################################################ # Videodevice <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> capturing (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> /dev/video0) # <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> FreeBSD <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> /dev/bktr0 videodevice /dev/video0 # v4l2_palette allows <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> choose preferable palette <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> by motion # <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> capture from those supported by your videodevice. (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">17</span></span>) # Eg <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> your videodevice supports both V4L2_PIX_FMT_SBGGR8 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> # V4L2_PIX_FMT_MJPEG <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> motion will by <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> V4L2_PIX_FMT_MJPEG. # Setting v4l2_palette <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> forces motion <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> V4L2_PIX_FMT_SBGGR8 # instead. # # Values : # V4L2_PIX_FMT_SN9C10X : <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'S910</span></span>' # V4L2_PIX_FMT_SBGGR16 : <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'BYR2</span></span>' # V4L2_PIX_FMT_SBGGR8 : <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'BA81</span></span>' # V4L2_PIX_FMT_SPCA561 : <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'S561</span></span>' # V4L2_PIX_FMT_SGBRG8 : <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'GBRG</span></span>' # V4L2_PIX_FMT_SGRBG8 : <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'GRBG</span></span>' # V4L2_PIX_FMT_PAC207 : <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'P207</span></span>' # V4L2_PIX_FMT_PJPG : <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'PJPG</span></span>' # V4L2_PIX_FMT_MJPEG : <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'MJPEG</span></span>' # V4L2_PIX_FMT_JPEG : <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'JPEG</span></span>' # V4L2_PIX_FMT_RGB24 : <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'RGB3</span></span>' # V4L2_PIX_FMT_SPCA501 : <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'S501</span></span>' # V4L2_PIX_FMT_SPCA505 : <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'S505</span></span>' # V4L2_PIX_FMT_SPCA508 : <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'S508</span></span>' # V4L2_PIX_FMT_UYVY : <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'UYVY</span></span>' # V4L2_PIX_FMT_YUYV : <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'YUYV</span></span>' # V4L2_PIX_FMT_YUV422P : <span class="hljs-number"><span class="hljs-number">16</span></span> '<span class="hljs-number"><span class="hljs-number">422</span></span>P' # V4L2_PIX_FMT_YUV420 : <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'YU12</span></span>' # v4l2_palette <span class="hljs-number"><span class="hljs-number">17</span></span> # The video input <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be used (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: -<span class="hljs-number"><span class="hljs-number">1</span></span>) # Should normally be set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> video/TV cards, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> -<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> USB cameras input -<span class="hljs-number"><span class="hljs-number">1</span></span> # The video norm <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> (only <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> video capture <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> TV tuner cards) # Values: <span class="hljs-number"><span class="hljs-number">0</span></span> (PAL), <span class="hljs-number"><span class="hljs-number">1</span></span> (NTSC), <span class="hljs-number"><span class="hljs-number">2</span></span> (SECAM), <span class="hljs-number"><span class="hljs-number">3</span></span> (PAL NC no colour). <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> (PAL) norm <span class="hljs-number"><span class="hljs-number">0</span></span> # The frequency <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> set the tuner <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> (kHz) (only <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> TV tuner cards) (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) frequency <span class="hljs-number"><span class="hljs-number">0</span></span> # Rotate image this number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> degrees. The rotation affects <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> saved images as # well as movies. Valid values: <span class="hljs-number"><span class="hljs-number">0</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> = no rotation), <span class="hljs-number"><span class="hljs-number">90</span></span>, <span class="hljs-number"><span class="hljs-number">180</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">270</span></span>. rotate <span class="hljs-number"><span class="hljs-number">0</span></span> # Image <span class="hljs-literal"><span class="hljs-literal">width</span></span> (pixels). Valid <span class="hljs-keyword"><span class="hljs-keyword">range</span></span>: Camera dependent, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">352</span></span> <span class="hljs-literal"><span class="hljs-literal">width</span></span> <span class="hljs-number"><span class="hljs-number">1280</span></span> # Image height (pixels). Valid <span class="hljs-keyword"><span class="hljs-keyword">range</span></span>: Camera dependent, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">288</span></span> height <span class="hljs-number"><span class="hljs-number">960</span></span> # Maximum number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> frames <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be captured per second. # Valid <span class="hljs-keyword"><span class="hljs-keyword">range</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>-<span class="hljs-number"><span class="hljs-number">100</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span> (almost no limit). framerate <span class="hljs-number"><span class="hljs-number">5</span></span> # Minimum <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> seconds between capturing picture frames from the camera. # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled - the capture rate <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> given by the camera framerate. # This option <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> used <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> you want <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> capture images at a rate lower than <span class="hljs-number"><span class="hljs-number">2</span></span> per second. minimum_frame_time <span class="hljs-number"><span class="hljs-number">0</span></span> # URL <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you are using a network camera, size will be autodetected (incl http:// ftp:// mjpg:// <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>:///) # Must be a URL that returns single jpeg pictures <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> a raw mjpeg stream. <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> defined netcam_url rtsp://<span class="hljs-number"><span class="hljs-number">192.168</span></span>.<span class="hljs-number"><span class="hljs-number">0.100</span></span>:<span class="hljs-number"><span class="hljs-number">554</span></span> # Username <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> password <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> network camera (only <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> required). <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined # Syntax <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> user:password netcam_userpass admin:vova # The setting <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> keep-alive <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> network socket, should improve performance <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> compatible net cameras. # off: The historical implementation using HTTP/<span class="hljs-number"><span class="hljs-number">1.0</span></span>, closing the socket <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> each http request. # <span class="hljs-keyword"><span class="hljs-keyword">force</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.0</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> keep alive header <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> reuse the same connection. # <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> requests that support keep alive as <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>. # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: off netcam_keepalive <span class="hljs-keyword"><span class="hljs-keyword">force</span></span> # URL <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a netcam proxy server, <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> required, eg <span class="hljs-string"><span class="hljs-string">"http://myproxy"</span></span>. # <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">port</span></span> number other than <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> needed, <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-string"><span class="hljs-string">"http://myproxy:1234"</span></span>. # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined ; netcam_proxy value # Set less strict jpeg checks <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> network cameras <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> a poor/buggy firmware. # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: off netcam_tolerant_check <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> # Let motion regulate the brightness <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a video device (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off). # The auto_brightness feature uses the brightness option as its target value. # <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> brightness <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> zero auto_brightness will adjust <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> average brightness value <span class="hljs-number"><span class="hljs-number">128</span></span>. # Only recommended <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cameras without auto brightness auto_brightness off # Set the initial brightness <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a video device. # <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> auto_brightness <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> enabled, this value defines the average brightness level # which Motion will try <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> adjust <span class="hljs-keyword"><span class="hljs-keyword">to</span></span>. # Valid <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled brightness <span class="hljs-number"><span class="hljs-number">0</span></span> # Set the contrast <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a video device. # Valid <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled contrast <span class="hljs-number"><span class="hljs-number">0</span></span> # Set the saturation <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a video device. # Valid <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled saturation <span class="hljs-number"><span class="hljs-number">0</span></span> # Set the hue <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a video device (NTSC feature). # Valid <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled hue <span class="hljs-number"><span class="hljs-number">0</span></span> ############################################################ # Round Robin (multiple inputs <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> same video device name) ############################################################ # Number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> frames <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> capture <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> each roundrobin step (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>) roundrobin_frames <span class="hljs-number"><span class="hljs-number">1</span></span> # Number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> frames <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> skip before each roundrobin step (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>) roundrobin_skip <span class="hljs-number"><span class="hljs-number">1</span></span> # Try <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> filter <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> noise generated by roundrobin (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) switchfilter off ############################################################ # Motion Detection Settings: ############################################################ # Threshold <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> changed pixels <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> an image that # triggers motion detection (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">1500</span></span>) threshold <span class="hljs-number"><span class="hljs-number">400</span></span> # Automatically tune the threshold down <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> possible (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) threshold_tune off # Noise threshold <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the motion detection (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">32</span></span>) noise_level <span class="hljs-number"><span class="hljs-number">32</span></span> # Automatically tune the noise threshold (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>) noise_tune <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> # Despeckle motion image using (e)rode <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> (d)ilate <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> (l)abel (<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) # Recommended value <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> EedDl. Any combination (<span class="hljs-keyword"><span class="hljs-keyword">and</span></span> number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> E, e, d, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> D <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> valid. # (l)abeling must only be used once <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> the <span class="hljs-string"><span class="hljs-string">'l'</span></span> must be the last letter. # Comment <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> disable despeckle_filter EedDl # Detect motion <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> predefined areas (<span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-number"><span class="hljs-number">9</span></span>). Areas are numbered like that: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> # A script (on_area_detected) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> started immediately <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> # detected <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> one <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the given areas, but only once during an event. <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> # One <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> more areas can be specified <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> this option. Take care: This option # does <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">restrict</span></span> detection <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> these areas! (<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) area_detect <span class="hljs-number"><span class="hljs-number">589</span></span> # PGM <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> as a sensitivity mask. # Full path name <span class="hljs-keyword"><span class="hljs-keyword">to</span></span>. (<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) ; mask_file value # Dynamically create a mask <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> during operation (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) # Adjust speed <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> mask changes from <span class="hljs-number"><span class="hljs-number">0</span></span> (off) <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> (fast) smart_mask_speed <span class="hljs-number"><span class="hljs-number">0</span></span> # Ignore sudden massive light intensity changes given as a percentage <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the picture # area that changed intensity. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>, motion will do some kind <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> # auto-lightswitch. Valid <span class="hljs-keyword"><span class="hljs-keyword">range</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> - <span class="hljs-number"><span class="hljs-number">100</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled lightswitch <span class="hljs-number"><span class="hljs-number">1</span></span> # Picture frames must contain motion at least the specified number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> frames # <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a row before they are detected as <span class="hljs-literal"><span class="hljs-literal">true</span></span> motion. At the <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> # motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> detected. Valid <span class="hljs-keyword"><span class="hljs-keyword">range</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> thousands, recommended <span class="hljs-number"><span class="hljs-number">1</span></span>-<span class="hljs-number"><span class="hljs-number">5</span></span> minimum_motion_frames <span class="hljs-number"><span class="hljs-number">6</span></span> # Specifies the number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> pre-captured (buffered) pictures from before motion # was detected that will be output at motion detection. # Recommended <span class="hljs-keyword"><span class="hljs-keyword">range</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) # Do <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> large values! Large values will cause Motion <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> skip video frames <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> # cause unsmooth movies. <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> smooth movies <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> larger values <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> post_capture instead. pre_capture <span class="hljs-number"><span class="hljs-number">2</span></span> # Number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> frames <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> capture <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> no longer detected (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) post_capture <span class="hljs-number"><span class="hljs-number">0</span></span> # Event Gap <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the seconds <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> no motion detection that triggers the <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> an event. # An event <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> defined as a series <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> motion images taken within a short timeframe. # Recommended value <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">60</span></span> seconds (<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>). The value -<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> allowed <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> disables # events causing <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> Motion <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be written <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> one single movie <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> no pre_capture. # <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> running <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> gapless mode. Movies don<span class="hljs-symbol"><span class="hljs-symbol">'t</span></span> have gaps anymore. An # event ends right <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> no more motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> detected <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> post_capture <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> over. event_gap <span class="hljs-number"><span class="hljs-number">20</span></span> # Maximum length <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> seconds <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a movie # <span class="hljs-keyword"><span class="hljs-keyword">When</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> exceeded a <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> movie <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> created. (<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> = infinite) max_movie_time <span class="hljs-number"><span class="hljs-number">0</span></span> # Always save images even <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> there was no motion (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) emulate_motion off ############################################################ # Image <span class="hljs-keyword"><span class="hljs-keyword">File</span></span> Output ############################################################ # Output <span class="hljs-symbol"><span class="hljs-symbol">'normal</span></span>' pictures <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> detected (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>) # Valid values: <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>, off, first, best, center # <span class="hljs-keyword"><span class="hljs-keyword">When</span></span> set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'first</span></span>', only the first picture <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> an event <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> saved. # Picture <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> most motion <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> an event <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> saved <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'best</span></span>'. # Picture <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> motion nearest center <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> picture <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> saved <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'center</span></span>'. # Can be used as preview shot <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the corresponding movie. output_pictures off # Output pictures <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> only the pixels moving object (ghost images) (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) output_debug_pictures off # The quality (<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> percent) <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be used by the jpeg compression (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">75</span></span>) quality <span class="hljs-number"><span class="hljs-number">100</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> output images # Valid values: jpeg, ppm (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: jpeg) picture_type jpeg ############################################################ # FFMPEG related options # Film (movie) <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> output, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> deinterlacing <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the video input # The options movie_filename <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> timelapse_filename are also used # by the ffmpeg feature ############################################################ # <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> ffmpeg <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> encode movies <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> realtime (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) ffmpeg_output_movies <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> ffmpeg <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> make movies <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> only the pixels moving # object (ghost images) (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) ffmpeg_output_debug_movies off # <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> ffmpeg <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> encode a timelapse movie # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> value <span class="hljs-number"><span class="hljs-number">0</span></span> = off - <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> save frame every Nth second ffmpeg_timelapse <span class="hljs-number"><span class="hljs-number">0</span></span> # The <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> rollover mode <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the timelapse video # Valid values: hourly, daily (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>), weekly-sunday, weekly-monday, monthly, manual ffmpeg_timelapse_mode daily # Bitrate <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be used by the ffmpeg encoder (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">400000</span></span>) # This option <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> ignored <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ffmpeg_variable_bitrate <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> (disabled) ffmpeg_bps <span class="hljs-number"><span class="hljs-number">8100000</span></span> # Enables <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> defines <span class="hljs-keyword"><span class="hljs-keyword">variable</span></span> bitrate <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the ffmpeg encoder. # ffmpeg_bps <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> ignored <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">variable</span></span> bitrate <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> enabled. # Valid values: <span class="hljs-number"><span class="hljs-number">0</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>) = fixed bitrate defined by ffmpeg_bps, # <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">31</span></span> where <span class="hljs-number"><span class="hljs-number">2</span></span> means best quality <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">31</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> worst. ffmpeg_variable_bitrate <span class="hljs-number"><span class="hljs-number">0</span></span> # Codec <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> used by ffmpeg <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the video compression. # Timelapse movies are always made <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> mpeg1 format independent from this option. # Supported formats are: mpeg1 (ffmpeg-<span class="hljs-number"><span class="hljs-number">0.4</span></span>.<span class="hljs-number"><span class="hljs-number">8</span></span> only), mpeg4 (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> msmpeg4. # mpeg1 - gives you files <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> extension .mpg # mpeg4 <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> msmpeg4 - gives you files <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> extension .avi # msmpeg4 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> recommended <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> Windows Media Player because # it requires no installation <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> codec <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the Windows client. # swf - gives you a flash film <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> extension .swf # flv - gives you a flash video <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> extension .flv # ffv1 - FF video codec <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Lossless Encoding ( experimental ) # mov - QuickTime ( testing ) # ogg - Ogg/Theora ( testing ) ffmpeg_video_codec mpeg4 # <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> ffmpeg <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> deinterlace video. Necessary <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> an analog camera # <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> see horizontal combing <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> moving objects <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> video <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> pictures. # (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) ffmpeg_deinterlace off ############################################################ # SDL Window ############################################################ # Number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> motion thread <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> show <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> SDL Window (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled) sdl_threadnr <span class="hljs-number"><span class="hljs-number">0</span></span> ############################################################ # External pipe <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> video encoder # Replacement <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> FFMPEG builtin encoder <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ffmpeg_output_movies only. # The options movie_filename <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> timelapse_filename are also used # by the ffmpeg feature ############################################################ # Bool <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> enable <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> disable extpipe (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) use_extpipe off # External program (full path <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> opts) <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> pipe raw video <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> # Generally, <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-string"><span class="hljs-string">'-'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> STDIN... ; extpipe value ############################################################ # Snapshots (Traditional Periodic Webcam <span class="hljs-keyword"><span class="hljs-keyword">File</span></span> Output) ############################################################ # Make automated snapshot every N seconds (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled) snapshot_interval <span class="hljs-number"><span class="hljs-number">0</span></span> ############################################################ # <span class="hljs-literal"><span class="hljs-literal">Text</span></span> Display # %Y = year, %m = month, %d = date, # %H = hour, %M = minute, %S = second, %T = HH:MM:SS, # %v = event, %q = frame number, %t = thread (camera) number, # %D = changed pixels, %N = noise level, \n = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-literal"><span class="hljs-literal">line</span></span>, # %i <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> %J = <span class="hljs-literal"><span class="hljs-literal">width</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> height <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> motion area, # %K <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> %L = X <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Y coordinates <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> motion center # %C = value defined by text_event - do <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> text_event! # You can put quotation marks around the <span class="hljs-literal"><span class="hljs-literal">text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> allow # leading spaces ############################################################ # Locate <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> draw a box around the moving object. # Valid values: <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>, off, preview (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) # Set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'preview</span></span>' will only draw a box <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> preview_shot pictures. locate_motion_mode off # Set the look <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> style <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the locate box <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> enabled. # Valid values: box, redbox, cross, redcross (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: box) # Set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'box</span></span>' will draw the traditional box. # Set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'redbox</span></span>' will draw a red box. # Set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'cross</span></span>' will draw a little cross <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> mark center. # Set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'redcross</span></span>' will draw a little red cross <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> mark center. locate_motion_style box # Draws the timestamp using same options as C <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> strftime(<span class="hljs-number"><span class="hljs-number">3</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: %Y-%m-%d\n%T = date <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ISO format <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> hour clock # <span class="hljs-literal"><span class="hljs-literal">Text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> placed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> lower right corner text_right - # Draw a user defined <span class="hljs-literal"><span class="hljs-literal">text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the images using same options as C <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> strftime(<span class="hljs-number"><span class="hljs-number">3</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> defined = no <span class="hljs-literal"><span class="hljs-literal">text</span></span> # <span class="hljs-literal"><span class="hljs-literal">Text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> placed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> lower left corner ; text_left value # Draw the number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> changed pixed <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the images (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) # Will normally be set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> off except <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> you setup <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> adjust the motion settings # <span class="hljs-literal"><span class="hljs-literal">Text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> placed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> upper right corner text_changes off # This option defines the value <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the special event conversion specifier %C # You can <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> any conversion specifier <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> this option except %C. Date <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> # values are from the timestamp <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the first image <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the current event. # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: %Y%m%d%H%M%S # The idea <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> that %C can be used filenames <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> text_left/right <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> creating # a unique identifier <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> each event. text_event - # Draw characters at twice normal size <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> images. (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) text_double off # <span class="hljs-literal"><span class="hljs-literal">Text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> include <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a JPEG EXIF comment # May be any <span class="hljs-literal"><span class="hljs-literal">text</span></span>, including conversion specifiers. # The EXIF timestamp <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> included independent <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> this <span class="hljs-literal"><span class="hljs-literal">text</span></span>. ; exif_text value ############################################################ # Target Directories <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> filenames <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> Images <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> Films # <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> the options snapshot_, picture_, movie_ <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> timelapse_filename # you can <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> conversion specifiers # %Y = year, %m = month, %d = date, # %H = hour, %M = minute, %S = second, # %v = event, %q = frame number, %t = thread (camera) number, # %D = changed pixels, %N = noise level, # %i <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> %J = <span class="hljs-literal"><span class="hljs-literal">width</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> height <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> motion area, # %K <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> %L = X <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Y coordinates <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> motion center # %C = value defined by text_event # Quotation marks round <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> are allowed. ############################################################ # Target base directory <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> pictures <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> films # Recommended <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> absolute path. (<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: current working directory) target_dir /home/vova/Files/Camera/ # <span class="hljs-keyword"><span class="hljs-keyword">File</span></span> path <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> snapshots (jpeg <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> ppm) relative <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> target_dir # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: %v-%Y%m%d%H%M%S-snapshot # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> equivalent <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> legacy oldlayout option # <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> Motion <span class="hljs-number"><span class="hljs-number">3.0</span></span> compatible mode choose: %Y/%m/%d/%H/%M/%S-snapshot # <span class="hljs-keyword"><span class="hljs-keyword">File</span></span> extension .jpg <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> .ppm <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> automatically added so do <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> include this. # <span class="hljs-literal"><span class="hljs-literal">Note</span></span>: A symbolic link called lastsnap.jpg created <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the target_dir will always # point <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the latest snapshot, unless snapshot_filename <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> exactly <span class="hljs-symbol"><span class="hljs-symbol">'lastsnap</span></span>' snapshot_filename %Y%m%d%H%M%S-snapshot # <span class="hljs-keyword"><span class="hljs-keyword">File</span></span> path <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> motion triggered images (jpeg <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> ppm) relative <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> target_dir # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: %v-%Y%m%d%H%M%S-%q # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> equivalent <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> legacy oldlayout option # <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> Motion <span class="hljs-number"><span class="hljs-number">3.0</span></span> compatible mode choose: %Y/%m/%d/%H/%M/%S-%q # <span class="hljs-keyword"><span class="hljs-keyword">File</span></span> extension .jpg <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> .ppm <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> automatically added so do <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> include this # Set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'preview</span></span>' together <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> best-preview feature enables special naming # convention <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> preview shots. See motion guide <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> details picture_filename %Y%m%d%H%M%S-%q # <span class="hljs-keyword"><span class="hljs-keyword">File</span></span> path <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> motion triggered ffmpeg films (movies) relative <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> target_dir # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: %v-%Y%m%d%H%M%S # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> equivalent <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> legacy oldlayout option # <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> Motion <span class="hljs-number"><span class="hljs-number">3.0</span></span> compatible mode choose: %Y/%m/%d/%H%M%S # <span class="hljs-keyword"><span class="hljs-keyword">File</span></span> extension .mpg <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> .avi <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> automatically added so do <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> include this # This option was previously called ffmpeg_filename movie_filename %m%d_%H-%M-%S # <span class="hljs-keyword"><span class="hljs-keyword">File</span></span> path <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> timelapse movies relative <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> target_dir # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: %Y%m%d-timelapse # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> near equivalent <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> legacy oldlayout option # <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> Motion <span class="hljs-number"><span class="hljs-number">3.0</span></span> compatible mode choose: %Y/%m/%d-timelapse # <span class="hljs-keyword"><span class="hljs-keyword">File</span></span> extension .mpg <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> automatically added so do <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> include this timelapse_filename %Y%m%d-timelapse ############################################################ # Global Network Options ############################################################ # Enable <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> disable IPV6 <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> http control <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> stream (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) ipv6_enabled off ############################################################ # Live Stream Server ############################################################ # The mini-http server listens <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> this <span class="hljs-keyword"><span class="hljs-keyword">port</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> requests (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled) stream_port <span class="hljs-number"><span class="hljs-number">8082</span></span> # Quality <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the jpeg (<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> percent) images produced (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>) stream_quality <span class="hljs-number"><span class="hljs-number">50</span></span> # Output frames at <span class="hljs-number"><span class="hljs-number">1</span></span> fps <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> no motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> detected <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> increase <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the # rate given by stream_maxrate <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> detected (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) stream_motion off # Maximum framerate <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> streams (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>) stream_maxrate <span class="hljs-number"><span class="hljs-number">1</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">Restrict</span></span> stream connections <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> localhost only (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>) stream_localhost off # Limits the number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> images per connection (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> = unlimited) # Number can be defined by multiplying actual stream rate by desired number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> seconds # Actual stream rate <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the smallest <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the numbers framerate <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> stream_maxrate stream_limit <span class="hljs-number"><span class="hljs-number">0</span></span> # Set the authentication method (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) # <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled # <span class="hljs-number"><span class="hljs-number">1</span></span> = Basic authentication # <span class="hljs-number"><span class="hljs-number">2</span></span> = MD5 digest (the safer authentication) stream_auth_method <span class="hljs-number"><span class="hljs-number">0</span></span> # Authentication <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the stream. Syntax username:password # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined (Disabled) ; stream_authentication value ############################################################ # HTTP Based Control ############################################################ # TCP/IP <span class="hljs-keyword"><span class="hljs-keyword">port</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the http server <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> listen <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> = disabled) webcontrol_port <span class="hljs-number"><span class="hljs-number">8081</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">Restrict</span></span> control connections <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> localhost only (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>) webcontrol_localhost off # Output <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> http server, <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> off <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> choose raw <span class="hljs-literal"><span class="hljs-literal">text</span></span> plain (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>) webcontrol_html_output <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> # Authentication <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the http based control. Syntax username:password # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined (Disabled) ; webcontrol_authentication value ############################################################ # Tracking (Pan/Tilt) ############################################################ # <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> tracker (<span class="hljs-number"><span class="hljs-number">0</span></span>=none (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>=stepper, <span class="hljs-number"><span class="hljs-number">2</span></span>=iomojo, <span class="hljs-number"><span class="hljs-number">3</span></span>=pwc, <span class="hljs-number"><span class="hljs-number">4</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">generic</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>=uvcvideo, <span class="hljs-number"><span class="hljs-number">6</span></span>=servo) # The <span class="hljs-keyword"><span class="hljs-keyword">generic</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> enables the definition <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> motion center <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> motion size <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> # be used <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the conversion specifiers <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> options like on_motion_detected track_type <span class="hljs-number"><span class="hljs-number">0</span></span> # Enable auto tracking (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) track_auto off # Serial <span class="hljs-keyword"><span class="hljs-keyword">port</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> motor (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: none) ; track_port value # Motor number <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x-axis (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) track_motorx <span class="hljs-number"><span class="hljs-number">0</span></span> # Set motorx reverse (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) track_motorx_reverse off # Motor number <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> y-axis (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) track_motory <span class="hljs-number"><span class="hljs-number">0</span></span> # Set motory reverse (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) track_motory_reverse off # Maximum value <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> x-axis (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) track_maxx <span class="hljs-number"><span class="hljs-number">0</span></span> # Minimum value <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> x-axis (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) track_minx <span class="hljs-number"><span class="hljs-number">0</span></span> # Maximum value <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> y-axis (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) track_maxy <span class="hljs-number"><span class="hljs-number">0</span></span> # Minimum value <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> y-axis (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) track_miny <span class="hljs-number"><span class="hljs-number">0</span></span> # Center value <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> x-axis (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) track_homex <span class="hljs-number"><span class="hljs-number">128</span></span> # Center value <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> y-axis (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) track_homey <span class="hljs-number"><span class="hljs-number">128</span></span> # ID <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> an iomojo camera <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> used (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) track_iomojo_id <span class="hljs-number"><span class="hljs-number">0</span></span> # Angle <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> degrees the camera moves per step <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the X-axis # <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> auto-track (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>) # Currently only used <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pwc <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> cameras track_step_angle_x <span class="hljs-number"><span class="hljs-number">10</span></span> # Angle <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> degrees the camera moves per step <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the Y-axis # <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> auto-track (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>) # Currently only used <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pwc <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> cameras track_step_angle_y <span class="hljs-number"><span class="hljs-number">10</span></span> # Delay <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">wait</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> tracking movement as number # <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> picture frames (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>) track_move_wait <span class="hljs-number"><span class="hljs-number">10</span></span> # Speed <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> set the motor <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> (stepper motor option) (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">255</span></span>) track_speed <span class="hljs-number"><span class="hljs-number">255</span></span> # Number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> steps <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> make (stepper motor option) (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">40</span></span>) track_stepsize <span class="hljs-number"><span class="hljs-number">40</span></span> ############################################################ # External Commands, Warnings <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Logging: # You can <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> conversion specifiers <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the on_xxxx commands # %Y = year, %m = month, %d = date, # %H = hour, %M = minute, %S = second, # %v = event, %q = frame number, %t = thread (camera) number, # %D = changed pixels, %N = noise level, # %i <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> %J = <span class="hljs-literal"><span class="hljs-literal">width</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> height <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> motion area, # %K <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> %L = X <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Y coordinates <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> motion center # %C = value defined by text_event # %f = filename <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> full path # %n = number indicating filetype # Both %f <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> %n are only defined <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> on_picture_save, # on_movie_start <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> on_movie_end # Quotation marks round <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> are allowed. ############################################################ # Do <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> sound beeps <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> detecting motion (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>) # <span class="hljs-literal"><span class="hljs-literal">Note</span></span>: Motion never beeps <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> running <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> daemon mode. quiet <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> # Command <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be executed <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> an event starts. (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: none) # An event starts at first motion detected <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> a period <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> no motion defined by event_gap ; on_event_start value # Command <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be executed <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> an event ends <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> a period <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> no motion # (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: none). The period <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> no motion <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> defined by option event_gap. on_event_end pkill -f vlc # Command <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be executed <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> a picture (.ppm|.jpg) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> saved (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: none) # <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> give the filename as an argument <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> a command append it <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> %f ; on_picture_save value # Command <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be executed <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> a motion frame <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> detected (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: none) ; on_motion_detected value # Command <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be executed <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> motion <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a predefined area <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> detected # Check option <span class="hljs-symbol"><span class="hljs-symbol">'area_detect</span></span>'. (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: none) on_area_detected /home/vova/Core/scrypts/send_pix &gt; /home/vova/Files/Logs/motion/motion_area.log <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span> # Command <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be executed <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> a movie <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> (.mpg|.avi) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> created. (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: none) # <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> give the filename as an argument <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> a command append it <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> %f on_movie_start echo <span class="hljs-string"><span class="hljs-string">"1"</span></span> &gt; /home/vova/Core/scrypts/motion/motion_label # Command <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be executed <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> a movie <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> (.mpg|.avi) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> closed. (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: none) # <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> give the filename as an argument <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> a command append it <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> %f on_movie_end echo <span class="hljs-string"><span class="hljs-string">"0"</span></span> &gt; /home/vova/Core/scrypts/motion/motion_label # Command <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be executed <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> a camera can<span class="hljs-symbol"><span class="hljs-symbol">'t</span></span> be opened <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> it <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> lost # <span class="hljs-literal"><span class="hljs-literal">NOTE</span></span>: There <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> situations <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> motion don<span class="hljs-symbol"><span class="hljs-symbol">'t</span></span> detect a lost camera! # It depends <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the driver, some drivers dosn<span class="hljs-symbol"><span class="hljs-symbol">'t</span></span> detect a lost camera at <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> # Some hangs the motion thread. Some even hangs the PC! (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: none) on_camera_lost wget http://<span class="hljs-number"><span class="hljs-number">192.168</span></span>.<span class="hljs-number"><span class="hljs-number">0.205</span></span>:<span class="hljs-number"><span class="hljs-number">8000</span></span>/message/camera_lost ############################################################ # Common Options <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> database features. # Options require the database options <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be active also. ############################################################ # Log <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the database <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> creating motion triggered image <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>) sql_log_picture <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> # Log <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the database <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> creating a snapshot image <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>) sql_log_snapshot <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> # Log <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the database <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> creating motion triggered movie <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) sql_log_movie off # Log <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the database <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> creating timelapse movie <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: off) sql_log_timelapse off # SQL query <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> that <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> sent <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the database # <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> same conversion specifiers has <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-literal"><span class="hljs-literal">text</span></span> features # Additional special conversion specifiers are # %n = the number representing the file_type # %f = filename <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> full path # Create tables : ## # Mysql # CREATE TABLE security (camera int, filename char(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, frame int, file_type int, time_stamp timestamp(<span class="hljs-number"><span class="hljs-number">14</span></span>), event_time_stamp timestamp(<span class="hljs-number"><span class="hljs-number">14</span></span>)); # # Postgresql # CREATE TABLE security (camera int, filename char(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, frame int, file_type int, time_stamp timestamp without <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> zone, event_time_stamp timestamp without <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> zone); # # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> value: # insert into security(camera, filename, frame, file_type, time_stamp, text_event) values('%t', '%f', '%q', '%n', '%Y-%m-%d %T', '%C') sql_query sql_query insert into security(camera, filename, frame, file_type, time_stamp, event_time_stamp) values('%t', '%f', '%q', '%n', '%Y-%m-%d %T', '%C') ############################################################ # Database Options ############################################################ # database <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> : mysql, postgresql, sqlite3 (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) ; database_type value # database <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> log <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) ; database_dbname value # The host <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> which the database <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> located (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) database_host localhost # User account name <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> database (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) ; database_user value # User password <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> database (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) ; database_password value # <span class="hljs-keyword"><span class="hljs-keyword">Port</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> which the database <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> located (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) # mysql <span class="hljs-number"><span class="hljs-number">3306</span></span> , postgresql <span class="hljs-number"><span class="hljs-number">5432</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) database_port <span class="hljs-number"><span class="hljs-number">0</span></span> ############################################################ # Database Options <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> SQLite3 ############################################################ # SQLite3 database <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> log <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) ; sqlite3_db value ############################################################ # Video Loopback Device (vloopback project) ############################################################ # Output images <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> a video4linux loopback device # The value <span class="hljs-string"><span class="hljs-string">'-'</span></span> means <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> available (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) ; video_pipe value # Output motion images <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> a video4linux loopback device # The value <span class="hljs-string"><span class="hljs-string">'-'</span></span> means <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> available (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined) ; motion_video_pipe value ############################################################## # Thread config files - One <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> each camera. # Except <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> only one camera - You only need this config <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>. # <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> you have more than one camera you MUST define one thread # config <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> each camera <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> addition <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> this config <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>. ############################################################## ; thread /etc/motion/thread1.conf</code> </pre><br></div></div><br>  Motion can be configured via the web interface.  The default port is 8081 <br><br><h2>  Remote access to recorded video </h2><br>  For remote access, the recorded video fragments are transferred to Yandex Disk.  I myself wrote in Python a ‚Äúlight‚Äù program for accessing the disk. <br><br>  The cron created a schedule that runs it every 10 minutes.  Files are divided into folders in accordance with the recording time to make it easier to search for them. <br><br>  I wanted to give the program code here, then it will already be a topic about the Yandex Disk API in Python.  I will make it a separate article. <br><br><h2>  Conclusion </h2><br>  As a result, we received video surveillance with a minimum investment of funds.  Without the "laborious programming", but with the ability to customize for themselves.  Files are stored in the cloud storage and will not be lost.  In case there is activity near your door, the picture in the Telegram will come. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From the task for the future: when moving near the door, the picture from the camera appears on the Kodi media center, if at that time I watch something on it (otherwise it turns on the TV itself and it works until you turn it off manually). </font><font style="vertical-align: inherit;">Like a video intercom. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the title picture, the neighbor-neighbor ‚Äúrests.‚Äù </font><font style="vertical-align: inherit;">Print this photo and put it in the mailbox. </font><font style="vertical-align: inherit;">Became less eccentric in public places. </font><font style="vertical-align: inherit;">He knows that everything is recorded. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The second photo is an attempt to open my door. </font><font style="vertical-align: inherit;">But maybe they just made a mistake. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are a lot of records when strange people come, look at the camera, cover their face and leave. </font><font style="vertical-align: inherit;">Even after that I bought models and hung them on the porch.</font></font></div><p>Source: <a href="https://habr.com/ru/post/343672/">https://habr.com/ru/post/343672/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343656/index.html">Report from the Android Devs Meetup Meeting on September 22</a></li>
<li><a href="../343658/index.html">Dagger 2 for novice Android developers. The introduction of dependencies. Part 2</a></li>
<li><a href="../343660/index.html">Must-have documentation for a mobile developer. Part 1</a></li>
<li><a href="../343666/index.html">Must-have documentation for a mobile developer. Part 2</a></li>
<li><a href="../343670/index.html">Python typing</a></li>
<li><a href="../343674/index.html">Outbound call center call center: create a predictive dialer in 3CX Call Flow Designer</a></li>
<li><a href="../343676/index.html">Write your insurance agent: Ingosstrakh organizes hackathon</a></li>
<li><a href="../343678/index.html">Is it true that the future of CPaaS is for ‚ÄúServerless‚Äù technologies?</a></li>
<li><a href="../343680/index.html">Secrets of React and Redux in the development of web applications</a></li>
<li><a href="../343682/index.html">Administering Juniper Switches with Ansible</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>