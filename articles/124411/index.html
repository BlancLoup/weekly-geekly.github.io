<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The basics of IP telephony from Cisco or familiarity with Cisco CallManager Express</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most recently, a client came to our organization and asked to configure IP-ATS based on the Cisco 2921 platform and Cisco CallManager Express (CME) so...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The basics of IP telephony from Cisco or familiarity with Cisco CallManager Express</h1><div class="post__text post__text-html js-mediator-article">  Most recently, a client came to our organization and asked to configure IP-ATS based on the Cisco 2921 platform and Cisco CallManager Express (CME) software.  Customers scatter is not decent in our time, therefore, decided to provide this service. <br><br>  I undertook this business not so much with the goal of cutting the dough for the company, but with the goal of getting to know how this Cisco IP-telephony is arranged, for the purpose of self-development, I mean. <br><br>  Familiarized.  The topic is nice;  for me as for tsiskary, it is much more convenient to work, rather than with Asterisk. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You can write a lot about CME capabilities.  Today I will tell you about the very basics. <br>  Let's try to solve a simple problem: there are a couple of phones - one works on SIP, the other on SCCP, we need to make them call each other.  How to do it - under the cut. <br><a name="habracut"></a><br><h5>  Initial CME Setup </h5><br>  The zero point is the setting of the dhcp server on the router, since almost all phones by default are configured to receive an IP address in this way.  If someone forgot or did not know, then in Tsiski it is done like this: <br><br> <code>CME#conf t <br> CME#(config)ip dhcp pool voicepool <br> CME#(config-ip-dhcp)network 192.168.101.0 255.255.255.0 <br> CME#(config-ip-dhcp)default-router 192.168.101.1 <br> CME#(config-ip-dhcp)option 150 ip 192.168.101.1 <br> CME#(config-ip-dhcp)lease 0 0 30 <br></code> <br>  All settings seem to be obvious.  Except, probably the 150th option.  This option sends the address of the tftp server in the DHCP settings (I will not write about using the tftp server in this article, but the thing is very useful for working with phones) <br><br>  By default, Cisco is very good with understanding SCCP protocol (due to the fact that this protocol belongs to Cisco itself), and is not very friendly with the more common SIP.  So, for example, in order to simply allow calls between SIP phones connected to our PBX, you need to configure: <br><br> <code>CME#conf t <br> CME#(config)voice service voip <br> CME#(config-voice)allow-connections sip to sip <br></code> <br>  Next, configure the registration period for SIP phones: <br><br> <code>CME#conf t <br> CME#(config)voice service voip <br> CME#(config-voice)sip <br> CME#(config-voice-sip)registrar server expires max 3600 min 3600 <br></code> <br>  Now you need to create a so-called.  codec class - a set of codecs that you plan to use: <br><br> <code>CME#conf t <br> CME#(config)voice class codec 1 <br> CME#(config-voice)codec preference 1 g711alaw <br> CME#(config-voice)codec preference 2 g711ulaw <br> CME#(config-voice)codec preference 3 g729br8 <br></code> <br>  The first attempt will be made to use the 711alaw codec, if it fails, then g711ulaw, and then intuitively. <br><br>  These settings will be enough. <br><br><h6>  Setup for SCCP operation </h6><br>  All settings related to the operation of the SCCP protocol occur in the <b>telephony-service</b> section.  Here is the minimum we need: <br><br> <code>CME#conf t <br> CME#(config)telephony-service <br> CME#(config-telephony)max-ephones 10 <br> CME#(config-telephony)max-dn 10 <br> CME#(config-telephony)ip source-address 192.168.101.1 port 2000 <br></code> <br>  <b>An ephone</b> is such a thing, which, to put it simply, symbolizes the telephone, that is, the image of a telephone device in the concept of CME.  The <b>max-ephones parameter</b> is responsible, respectively, for how many SCCP phones can be registered on this PBX. <br><br>  <b>dn</b> - (directory number) is such a thing, which, to put it simply, symbolizes a telephone number.  By analogy, it is clear what parameter <b>max-dn</b> is responsible for. <br><br>  By the way, it is not very correct to specify too many <b>ephone</b> and <b>dn</b> , because CME will allocate random access memory for each of these ‚Äúunits‚Äù during initialization. <br><br>  Plus, the number of supported <b>ephone</b> and <b>dn</b> depends on the platform model and software version. <br>  <b>ip source-address</b> specifies the IP address (and therefore the interface) and the port on which requests from SCCP phones will be heard <br><br><h6>  Configure CME to work with SIP phones </h6><br>  All settings relating to the operation of the SIP protocol occur in the section <b>voice register global</b> .  Here is the minimum we need: <br><br> <code>CME#conf t <br> CME#(config)voice register global <br> CME#(config-voice)mode cme <br> CME#(config-voice)source-address 192.168.101.1 port 5060 <br> CME#(config-voice)max-dn 50 <br> CME#(config-voice)max-pool 36 <br></code> <br>  Two differences.  First, you need to execute the command <b>mode cme</b> , which seems to hint to the router that CME will now work with SIP phones (this is to the fact that not only the software described by us works with the SIP protocol from Cisco).  Second, now instead of <b>ephon,</b> we will operate with <b>voice-pools</b> <br><br><h5>  Registering phones </h5><br>  You can start setting up the numbering and registration parameters of phones. <br>  The technology in both protocols is the same and quite simple - <b>dn</b> is first created, then a ‚Äúphone‚Äù is created, and its number (or several) is attached to the phone. <br>  In our example, we will use their MAC addresses to authorize phone sets on the server.  This is logical, since in practice the same telephone and telephone number are assigned to a specific person, and a person usually rarely moves his workplace in the office, and if he does, he carries the telephone with him. <br><br><h6>  Registering a sccp phone </h6><br>  Create a phone number: <br><br> <code>CME#conf t <br> CME#(config)ephone-dn 1 <br> CME#(config-ephone-dn)number 100 <br> CME#(config-ephone-dn)description Beauty-User <br> CME#(config-ephone-dn)name The Real Man <br></code> <br>  We created the phone number 100, the description inside the CME is ‚ÄúBeauty-User‚Äù, the name displayed on the phone will be ‚ÄúThe Real Man‚Äù <br><br>  Create an image of the phone.  we bind it to the MAC address of the real device, we bind the number to it: <br><br> <code>CME#conf t <br> CME#(config)ephone 1 <br> CME#(config-ephone)mac-address B4A4.E328.BDEC <br> CME#(config-ephone)button 1:1 <br></code> <br>  The binding of the telephone set (or rather the telephone line of our apparatus) is performed by the <b>button 1: 1</b> command.  The format is as follows - first we type the key word <i>‚Äúbutton‚Äù</i> , then we indicate the number of this ‚Äúbutton‚Äù (the first one in our example), then we indicate the action that needs to be done (‚Äú:‚Äù - a colon means that now we will tie some phone number) and then the parameter corresponding to the action - in our case we indicate the phone number (that is, the number of the dn pre-configured). <br><br>  You probably saw a tsiskofon in life \ on the pictures?  Seen there are all sorts of buttons near the screen?  These are the very buttons.  In fact, each of these buttons is responsible for its own line.  And you can perform a lot of actions on them (not only to bind to any number).  But it is worthy of a separate article. <br><br>  In the meantime, we can safely turn on the phone with the specified MAC address to the network, wait for it to boot, see on its small screen near the first button the number 100 and the cherished name - ‚ÄúThe Real Man‚Äù.  If we pick up the phone, then we hear the coveted buzzer <br><br><h6>  We register SIP-phone </h6><br>  The directory number is created as follows: <br><br> <code>CME#conf t <br> CME#(config)voice register dn 1 <br> CME#(config-voice-register-dn)number 200 <br></code> <br>  I think everything is clear.  We describe further the parameters for the phone: <br><br> <code>CME#conf t <br> CME#(config)voice register pool 1 <br> CME#(config-voice-register-pool)id mac 1CDF.0F4A.152E <br> CME#(config-voice-register-pool)number 1 dn 1 <br> CME#(config-voice-register-pool)voice-class codec 1 <br> CME#(config-voice-register-pool)username test password test <br></code> <br>  Binding to the first line of the first number is the command <b>number 1 dn 1</b> . <br>  Using the <b>voice-class codec 1</b> command, we define a set of acceptable codecs for the phone (we described this set at the beginning). <br>  Next, use the <b>username \ password</b> command to set the authentication data. <br><br>  In order for the phone to register, you need to go to its web-muzzle and in the settings of the first line specify the server address - 192.168.101.1 and authentication data.  We save. <br>  Reboot. <br>  ... <br>  PROFIT! <br><br>  The IP address of the phone can be learned from the information from the dhcp-pool for Mac using the <code>show ip dhcp binding</code> command, either in the settings of the phone itself - voice-activated, or visually the menu. <br><br>  It seems to be all.  Were described the minimum CME settings so that it can register two phones (SIP and SCCP), having received the address via DHCP. <br><br><h5>  Sources of knowledge </h5><br>  The main source of knowledge for a start was a video course to CCNA Voice from Jeremy Cioara.  Quite a living language (English truth) tells about IP telephony in general and about the nuances of configuring this very CME.  True, there is not a word about the setting of SIP phones. <br><br>  A very good manual, of course, is on cisco.com.  It is called the Cisco Unified Communications Manager Express System Administration Guide.  Available <a href="http://www.cisco.com/en/US/docs/voice_ip_comm/cucme/admin/configuration/guide/cmeadm.html">here</a> .  There is also a link to download to PDF. <br><br>  In the future, I will try to talk about the various nuances of setting up IP telephony on Cisco in general, and on CME in particular - setting up a tftp server for uploading firmware to phones, connecting lines from PSTN, specifics of CME installation and other features. </div><p>Source: <a href="https://habr.com/ru/post/124411/">https://habr.com/ru/post/124411/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../124403/index.html">We pronounce correctly</a></li>
<li><a href="../124404/index.html">About the dangers of changeable significant types</a></li>
<li><a href="../124407/index.html">The shortest link from Google</a></li>
<li><a href="../124409/index.html">W3C Digest. What's new in CSS3. Release 1</a></li>
<li><a href="../124410/index.html">Ensuring uninterrupted client-server interaction (WEB)</a></li>
<li><a href="../124412/index.html">Lead Firebug Developer Moved to Google Chrome Team</a></li>
<li><a href="../124413/index.html">Abrakadabra - movie catalog ex.ua</a></li>
<li><a href="../124414/index.html">FreeNAS Legacy (0.7) is dead. Long live NAS4Free!</a></li>
<li><a href="../124415/index.html">Student plagiarism in essays is ineradicable, so we must abandon essays</a></li>
<li><a href="../124416/index.html">Infographics "Chinese: The New Dominant Language of the Internet"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>