<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sticky Attacks: when key sticking helps hackers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cyber ‚Äã‚Äãcriminals are always looking for new ways to overcome the protection systems installed on computers in order to avoid detection and steal user...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sticky Attacks: when key sticking helps hackers</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/cc4/566/87b/cc456687bc784f98a3e0811459e50900.jpg"><br><br>  Cyber ‚Äã‚Äãcriminals are always looking for new ways to overcome the protection systems installed on computers in order to avoid detection and steal user data.  In this sense, Black Hat hackers have always turned to malicious attacks (phishing, network worms or terrible Trojans with cryptographers as the scariest example) to achieve their goals: penetrate companies to steal accounts or huge amounts of data in exchange for a ransom ... By at least it has been so far. <br><br>  The PandaLabs anti-virus lab recently discovered a rather clever attack on one of the companies in Hungary.  What made this attack so special?  So, the attack does not use any malware at all, but it uses scripts and other tools belonging to the operating system itself to bypass the security scanners.  This is just another example of the growth of self-confidence and professionalism of hackers that we have seen among cyber criminals in recent months. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Malware Attack Analysis</b> <br><br>  First, as it has already become the norm in the latest security-related incidents analyzed in our laboratory, the attack begins with the hackers launching <a href="https://habrahabr.ru/company/panda/blog/322010/">a brute-force attack (password guessing) against a server with a remote desktop protocol enabled (Remote Desktop). Protocol, RDP)</a> .  After the criminals receive registration data to enter the computer system, they get full access to it. <br><br>  Then the first thing the hackers did was launch the sethc.exe file with parameter 211 from the computer window with the command line (CMD).  This allowed them to enable sticky keys (‚ÄúSticky Keys‚Äù) in the system.  We are sure that you have previously seen this message: <br><br><img src="https://habrastorage.org/files/ce9/644/0fc/ce96440fcd57459984136746c646478d.png"><br><br>  Further, they downloaded and launched the ‚ÄúTraffic Spirit‚Äù program.  This application is a traffic generator, which in this case is used to earn extra money with the help of infected computers. <br><br><img src="https://habrastorage.org/files/609/1d3/07e/6091d307e23b45e18184b5578fba3f7b.png"><br>  <i>Traffic Spirit website</i> <br><br>  Then a self-extracting file is launched, which unzips the following files in the% Windows% \ cmdacoBin folder: <br><br>  ‚Ä¢ registery.reg <br>  ‚Ä¢ SCracker.bat <br>  ‚Ä¢ sys.bat <br><br>  After that, hackers started running the Windows Registry Editor (Regedit.exe) to add the following key contained in the registery.reg file: <br><br><img src="https://habrastorage.org/files/85e/319/ff2/85e319ff22fc4d22ac4235db53a6d29d.png"><br><br>  This key is designed so that each time the key sticking function (sethc.exe) is used, a file called SCracker.bat is also launched.  This is a batch file that implements a very simple authentication system.  When you run the file, the following window is displayed: <br><br><img src="https://habrastorage.org/files/7a7/363/3b7/7a73633b78244b97a3fdacbc6b79ca9f.png"><br><br>  The username and password are extracted from two variables that are included in the sys.bat file: <br><br><img src="https://habrastorage.org/files/c52/85b/720/c5285b7206934a58922b4c2c4505c502.png"><br><br>  Thus, the hacker installs a backdoor on the infected machine.  With it, the hacker will be able to connect to this computer without having to enter any registration data, turn on the key sticking function (for example, by pressing the SHIFT key five times), and enter the appropriate username and password to open the command line: <br><br><img src="https://habrastorage.org/files/e42/10a/75c/e4210a75c13b4dfdb5c6a809b8c2853b.png"><br><br>  The hot keys on the command line will allow the hacker to access certain folders, change the color of the console, and use other standard commands for the command line. <br><br><img src="https://habrastorage.org/files/4fa/c46/e99/4fac46e991c94238a350e2df34cf0636.png"><br><br>  However, the attack did not stop there.  In their attempt to maximize profits from this company, hackers installed a bitcoin miner to benefit from each compromised computer to receive ‚Äúfree‚Äù money.  Bitcoin mining software is designed to use its computer resources to generate virtual currency without the victim‚Äôs knowledge.  Cheap and very effective way to monetize computer infections. <br><br>  <b>How does key sticking help cyber crooks?</b> <br><br>  If a hacker can really access the required computer through an RDP connection, then why do they need a backdoor?  The answer to this question is very simple: installing a backdoor on the affected machine, even if the victim understands that his system is compromised, and changes the registration data to connect to the remote desktop, all the hacker needs to do is press the SHIFT key five times to enable sticking keys and launch a backdoor, after which he will again be able to access the system.  And remember that all this is done without a single malicious program on the affected computer. <br><br>  Panda Security‚Äôs <a href="http://www.pandasecurity.com/russia/intelligence-platform/solutions.htm">Adaptive Defense 360</a> enhanced information security solution was able to stop this targeted attack by continuously monitoring the company's IT network, protecting it from serious financial and reputational damage. </div><p>Source: <a href="https://habr.com/ru/post/323602/">https://habr.com/ru/post/323602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323592/index.html">Recruitment to St. Petersburg Academic University</a></li>
<li><a href="../323594/index.html">Localization of Unity games in Hindi</a></li>
<li><a href="../323596/index.html">‚ÄúExclude cannot be used‚Äù - new risk management method</a></li>
<li><a href="../323598/index.html">Digitizing sound on STM32 (ADC + DMA) and encoding to Speex for transmission</a></li>
<li><a href="../323600/index.html">+500 free tools to launch your startup in 2017</a></li>
<li><a href="../323604/index.html">Magento BarCamp - the new season of reports. March 2017</a></li>
<li><a href="../323606/index.html">Check Point. What is it, what is it eaten with or briefly about the main thing</a></li>
<li><a href="../323608/index.html">Transition from DateTime to DateTimeOffset</a></li>
<li><a href="../323612/index.html">The story of how we translated the project into almost a quarter of a million lines in TypeScript and survived</a></li>
<li><a href="../323614/index.html">Pygest # 5. Releases, articles, interesting projects from the world of Python [February 28, 2017 - March 13, 2017]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>