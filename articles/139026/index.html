<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Custom assembly of plugins - we will go the other way</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All habra 

 A small (well, very small) note on how to let the plugin choose for itself - whether to build on this system or not. Of course, there is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Custom assembly of plugins - we will go the other way</h1><div class="post__text post__text-html js-mediator-article">  All habra <img src="https://habrastorage.org/storage2/1a8/584/f3c/1a8584f3cef4d1ee6ca3a6e1d3c282fd.png" align="right"><br><br>  A small (well, very small) note on how to let the plugin choose for itself - whether to build on this system or not.  Of course, there is a good old way - just to exclude the extra plugin from the assembly itself, for example, like this: <br><br><pre><code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># plugins.pro TEMPLATE=subdirs SUBDIRS+=common macx: SUBDIRS+=macplugin win32: SUBDIRS+=winplugin</span></span></code> </pre> <br>  But with this approach, when adding each new plug-in, you need to register it in plugins.pro and install for which systems it will be built.  If there are only 5 plug-ins and is no longer foreseen, then this is normal.  But if there are already 20 plug-ins, and another 30 are planned, and many of them should be built only for some platforms, then plugins.pro turns into a trash bin.  If there are several developers, this is even more confusing. <br><a name="habracut"></a><br>  Wouldn't it be more logical to transfer concern about the systems in which the plugin will assemble on the fragile shoulders of its developer?  Then the plugins.pro file becomes quite simple and clear: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># plugins.pro TEMPLATE=subdirs SUBDIRS+=common SUBDIRS+=macplugin SUBDIRS+=winplugin</span></span></code> </pre> <br>  But macplugin.pro will have to write something like this (it will be the same for winplugin.pro): <br><br><pre> <code class="hljs pgsql"># macplugin.pro macx: { # project <span class="hljs-keyword"><span class="hljs-keyword">configuration</span></span> here } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(../nobuild.inc) }</code> </pre> <br>  As you can see, the matter is now small - to make the file nobuild.inc in the root of the folder with the sources of plug-ins and write something into it so that it cancels the build of the plug-in.  At first it seems that it is better to leave it empty at all, but this will lead to an attempt by the plugin to compile - for Qt for empty .pro files tries to collect all the sources in the default settings folder.  So, the source code of the plugin will try to compile into an executable file, and even more so the source code not intended for this OS.  Of course, in this case, you will most likely see something similar to the picture at the beginning of the topic. <br><br>  Breaking the <a href="http://developer.qt.nokia.com/doc/qt-4.8/qmake-reference.html">qmake</a> documentation, I didn‚Äôt find a single function to skip the project build, so I had to do a dirty hack: change the compiler and linker!  For what?  Well, what program is in all systems, does not do anything destructive, takes any arguments and always returns 0? <br><br>  In general, we write this: <br><br><pre> <code class="hljs dos"># nobuild.inc QMAKE_CXX=<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> QMAKE_LINK=<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> win32: { CONFIG-=embed_manifest_exe CONFIG-=embed_manifest_dll TARGET= }</code> </pre> <br>  A Windows block is needed so that qmake does not attempt to inject a manifest into an unassembled binary. <br><img src="https://habrastorage.org/storage2/ac0/ecd/0f5/ac0ecd0f5ebbb6f4cbc1507b949f7c93.jpg" align="right"><br>  <b>"Conclusion" or something like that.</b> <br>  The method is dirty, an obvious crutch, but it works.  And then - what a program without crutches?  =) <br><br>  But if the respected Habram people offer a different, more adequate method for solving the problem, I will be only too happy. </div><p>Source: <a href="https://habr.com/ru/post/139026/">https://habr.com/ru/post/139026/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../139021/index.html">Why sql?</a></li>
<li><a href="../139022/index.html">Recommender systems: problem statement</a></li>
<li><a href="../139023/index.html">The second long-awaited Dropquest 2012 from Dropbox.com</a></li>
<li><a href="../139024/index.html">Twitter Screensaver</a></li>
<li><a href="../139025/index.html">How many laws do you need for happiness?</a></li>
<li><a href="../139027/index.html">Extend the functionality of standard WinForms TabControl</a></li>
<li><a href="../139028/index.html">SPH based Cocos2D water</a></li>
<li><a href="../139029/index.html">Mobilization: OMAX, SmartPay and Opera Mobile Store</a></li>
<li><a href="../139030/index.html">Video of the seminar "Information technologies as tools for profitable growth of the company"</a></li>
<li><a href="../139031/index.html">Duracell has released a "charging card" for wireless charging of mobile devices</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>