<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The challenge of a hundred boxes and the rescue of prisoners - the final chord</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The surest way to go down in history is to answer who wins in chess with the perfect game of both sides (white, black or friendship). Do grandmasters ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The challenge of a hundred boxes and the rescue of prisoners - the final chord</h1><div class="post__text post__text-html js-mediator-article">  The surest way to go down in history is to answer who wins in chess with the perfect game of both sides (white, black or friendship).  Do grandmasters and supercomputers need to know the truth?  Or enough pencil, paper and beautiful ideas? <br><br>  Mathematics gives hope, because you can prove the existence of an object without presenting it, find the answer, without explaining the deep reasons why it is such. <br><br>  In the problem of prisoners and a hundred boxes a similar situation.  A huge number of possible strategies of the game, one of which intuitively seemed to us the best.  But is it possible to substantiate its optimality without plunging into a mess of options? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the <a href="http://habrahabr.ru/post/250817/">post</a> itself <a href="http://habrahabr.ru/post/250817/">about the task of</a> such a question is not posed.  However, in the first comment to it, the user <a href="http://habrahabr.ru/users/mayorovp/" class="user_link">mayorovp</a> raises the topic, and slightly below <a href="http://habrahabr.ru/users/avfonarev/" class="user_link">avfonarev</a> reports about a wonderful <a href="http://www.cl.cam.ac.uk/~gw104/Locker_Puzzle.pdf">article</a> revealing a secret. <br><br>  This should be imbued, especially since the reasoning is simple and elegant.  On the whole, the main idea of ‚Äã‚Äãfasting is not in solving a specific problem (which is also interesting in itself), but rather in once again giving reason to wonder at the power or, as Wigner put it, the incomprehensible effectiveness of mathematics. <br><a name="habracut"></a><br><h4>  Briefly about the condition and solution of the problem </h4><br>  Let me remind you that a hundred players must find tokens with their numbers, arranged in a hundred boxes.  Everyone can peek no more than half of them in any order he pleases.  In the process of testing, all the boxes and tokens remain in place, players do not meet and cannot exchange information in any other way, the boxes, after looking into them, close again.  A team wins only if all participants manage to find their number. <br><br>  If players open the boxes at random, the probability of winning will be (50/100) <sup>100</sup> , that is, about 10 <sup>-29</sup> %.  However, once they agree in advance and (attention, spoiler!), The chances of winning are almost 31.2%! <br><br>  To do this, use the following strategy - each participant needs to start the search from the box with its own number, and then open the boxes with the number of the newly detected token. <br><br>  To remember more, you can read the original post about the task or watch the one and a half <a href="http://habrahabr.ru/users/andreymironov/" class="user_link">minute</a> <a href="http://www.youtube.com/watch%3Fv%3DC5-I0bAuEUE">video ‚Äú <i>Solution to The Impossible Bet</i> ‚Äù</a> , which was told <a href="http://habrahabr.ru/users/andreymironov/" class="user_link">andreymironov</a> . <br><br>  We want to understand why it is impossible (or possible) to win more often than in 31.2% of cases. <br><br><h4>  Workaround - consider a new game </h4><br>  The strategy described above (let's call it <b><i><u>baseline</u></i></b> ) is one of the order of 100,100 * 99,100 <sup>* 99</sup> * ... * 51,100 <sup>* 99 * ... * 51</sup> possible options for the players' actions (see the ‚ÄúCounting the number of strategies‚Äù section).  Therefore, simply compare head-on with the rest of the strategy. <br><br>  In the article " <i>The Locker Puzzle</i> " it is proposed to start off to explore another game (let's call it <i><u><b>new</b></u></i> or <i><u><b>second</b></u></i> ), in which the boxes are not closed back, and the players are looking for their numbers without restrictions on the number of attempts.  The exact rules are: <br><br>  - players pass the test in turn - first the first, then the second, the third, etc .; <br><br>  - the first player must open the boxes until he finds his number, no matter how many attempts it takes.  The opened boxes do not close; <br><br>  - the second, third and further players, first of all, try to find their number in all open boxes (to look into an open box is not considered an attempt).  If (and only if) this did not bring success, they should open the closed boxes until the necessary token is found.  Boxes opened by them also do not close; <br><br>  - the team wins only if none of the participants needed more than 50 attempts to find their number, that is, if no one had to open more than half of the total number of boxes. <br><br>  Since the boxes do not close, the more they are open, the easier it is for players to win.  For example, if the first participant had to open 35 boxes, then another 34 players would not have to look for numbers at all, and the rest will only have 65 options where their token can be located. <br><br>  In addition, if a player in search of his number opens, say, 20 boxes, the team will not be able to lose at all, as only 100 - 35 - 20 = 45 unopened boxes will remain, and more than 50 attempts will be spent is impossible. <br><br>  The victory condition is very interesting.  It would seem that you can simply interrupt the game, if someone opened more than 50 boxes.  However, for further reasoning, it is more profitable to allow players to open any number of boxes, even if it is clear that they have lost. <br><br><div class="spoiler">  <b class="spoiler_title">The original game, by the way, can also be reformulated in the light of this idea.</b> <div class="spoiler_text">  Each player searches for his number until he finds it, even if it takes more than 50 attempts.  However, the team wins only if no one has exceeded this limit, that is, in the process of searching more than half of the total number of boxes has not been opened.  The maximum probability of victory from such an adjustment of the rules will not change. </div></div><br>  The new game introduced by us has three interesting properties, which will be discussed further and will allow us to give a reasonable answer - whether the basic strategy provides the maximum probability of winning or not. <br><br><h4>  Property 1 - it's easier to win a new game. </h4><br>  Rightly it seems that since the boxes do not close, it is easier for the team to win in the new game than in the original one. <br><br>  Indeed, no matter how the participants adhere to the initial testing strategy, they can also adapt it for passing on a new one. <br><br>  To do this, those players who did not find the numbers in the open boxes, it is necessary to open the boxes as they would have done in the process of the original game.  Moreover, if the strategy tells them to open the already opened box, they simply save the attempt. <br><br>  It is clear that for the same arrangement of numbers on the boxes, if the players win the first game, they will win the second.  Thus, the maximum probability of successful completion of the initial test can not be more than the new. <br><br>  In other words, if the maximum probability of winning the first game were, say, 40%, then a new test could be successfully completed with the same or greater chances - let's call it <b><i><u>property 1</u></i></b> . <br><br><h4>  Property 2 - in the new game, nothing depends on the team‚Äôs strategy </h4><br>  If you think about it, then it does not matter to the first player, what strategy to follow - no matter how hard he tries, the probability of finding your number, while meeting the limit on the number of attempts, will be 50/100 = ¬Ω.  It does not depend on the algorithm chosen by him and on how many boxes he opens - one, two, thirty, or all one hundred. <br><br>  Players whose tokens have already been found by previous participants, according to the conditions of the game, find their number one hundred percent and for zero attempts - nothing can be improved in their algorithm of actions. <br><br>  Those team members who are forced to look for their numbers themselves are, in fact, in the same situation as the first player - the chances of success depend on the number of closed boxes, and not on the contents of the already opened or chosen strategy. <br><br>  There is a feeling that the probability of winning a new game does not depend on the algorithm of the team‚Äôs actions.  We call this <b><i><u>property 2</u></i></b> and justify it more formally. <br><br>  For convenience, we suppose that we have six boxes and players, and three attempts. <br><br>  Imagine that the participants began to pass the test under the new rules, and we want to outline their success.  It turns out that the game process can be described in sufficient detail with just one line of numbers, indicating the numbers of the tokens found by the team in the order in which they were found. <br><br>  For example, it is easy to decrypt a record (2, 5, 1, 3, 6, 4).  After all, according to the condition of the game, the first player had to open the boxes until he found 1. Therefore, it is possible to unequivocally restore that the first participant, having opened three boxes of some kind (not important), found numbers 2, 5 and 1 there. I didn't have to, his token was in the box already opened by the first player.  Then the third achieved success from the first attempt and, finally, the fourth one found 6 and 4. The fifth and sixth participants, as well as the second, did not need to work. <br><br>  Another example - let us assume that the results of passing the test are described by the line (6, 1, 5, 3, 4, 2).  It is easy to see that the first participant found his token already in the second open box, while the second player was not lucky, it took four attempts, so the team counted defeat. <br><br>  It turns out that the string of six numbers corresponding to the numbers of the tokens found by the players uniquely determines the result of the test - the team won or lost. <br><br>  By the way, strings of the type (2, 5, 1, 3, 6, 4) and (6, 1, 5, 3, 4, 2), that is, those that contain numbers from 1 to 6 without repetitions, are called permutations of numbers from 1 to 6. It is known that there are 6 such permutations in total!  = 6 * 5 * 4 * 3 * 2 * 1. <br><br>  Note that since the tokens are arranged in boxes randomly, each of the boxes with equal chances can be any of the six numbers.  Therefore, no matter what algorithm the first player sticks to (even if he makes a choice at random), in the first box opened by him with equal probability 1/6 any of six numbers may appear. <br><br>  In the second open command box (no matter who - the first or the second participant - and according to what considerations), one of the five remaining numbers may be with the same probability 1/5. <br><br>  Continuing the argument, we come to the fact that, writing down the numbers of tokens in the order in which they were found, you can with the same probability (1/6) * (1/5) * ... (1/2) * (1/1) = 1/6!  get any of 6!  possible permutations of numbers from 1 to 6. <br><br>  As shown above, some permutations, for example, (2, 5, 1, 3, 6, 4), indicate the gains of the players, others, in particular, (6, 1, 5, 3, 4, 2) - the loss.  Denote by <i>A the</i> set of all permutations that signify the victory of the team, and |  <i>A</i> |, respectively, the number of such permutations. <br><br>  Since all permutations can turn out to be equally likely as a result of the game, the chances of players winning are equal |  <i>A</i> | / 6!  and, apparently, do not depend on the strategy chosen by them.  Property 2 is proven. <br><br><h4>  Property 3 - the probability of winning when using the basic strategy is equal to the chances of winning a new game </h4><br>  Let's go back to the original game.  Recall that the probability of winning it using the basic strategy (the one in which the player must begin searching from the box with his own number, and then follow the numbers on the tokens found) is &lt;the number of permutations of numbers from 1 to 6 that do not contain cycles of length more than 3&gt; / 6!  (as before, it is assumed that there are six boxes and players, and three attempts). <br><br>  If we denote <i>B</i> , the set of permutations of numbers from 1 to 6 that do not contain cycles of length more than 3, and |  <i>B</i> |, respectively, the number of such permutations, then the formula described above takes the form |  <i>B</i> | / 6! <br><br><div class="spoiler">  <b class="spoiler_title">About cycles and how this formula is made ...</b> <div class="spoiler_text">  Suppose that the location of the tokens in the boxes is described by a permutation (2, 5, 3, 6, 1, 4), that is, in the first box is 2, in the second - 5, in the third - 3, etc. . <br><br>  If the players, applying the basic strategy, did not stop moving, having found their token, they would start walking in a circle.  For example, the first participant, looking into the first box, would move to the second, then the fifth, from there to the first again, and so on.  Between the same numbers would go the second and fifth players.  The third participant would open the third box all the time, and the fourth and sixth would rush between the fourth and sixth boxes. <br><br>  This means, in essence, that the permutation (2, 5, 3, 6, 1, 4) is divided into <i>cycles</i> [1, 2, 5], [3], [4, 6]. <br><br>  Moreover, the same cycle can be designated in several ways, say, [1, 2, 5] = [5, 1, 2] = [2, 5, 1], that is, a cyclic shift is allowed in the record. <br><br>  It is also said that the permutation is represented as a <i>product of disjoint cycles</i> : (2, 5, 3, 6, 1, 4) = [1, 2, 5] [3] [4, 6].  Such a representation is not unique, since the above stated that the cycles can be written differently, in addition, they can be rearranged among themselves, in particular, (2, 5, 3, 6, 1, 4) = [1, 2, 5] [3] [4, 6] = [3] [1, 2, 5] [4, 6] = [3] [5, 1, 2] [6, 4] and so on. <br><br>  However, if we fix the way of recording cycles (for example, use only the record in which the minimum element is located on the last place: not [1, 2, 5] or [5, 1, 2], namely [2, 5, 1]) and also fix the order of the cycles (for example, in ascending order of minimum elements (marked bold): not [6, <b>4</b> ] [ <b>3</b> ] [2, 5, <b>1</b> ], but [2, 5, <b>1</b> ] [ <b>3</b> ] [6, <b>4</b> ]), then the representation of the permutation in the form of a product of non-intersecting cycles will be unique.  For example: (2, 5, 3, 6, 1, 4) = [2, 5, <b>1</b> ] [ <b>3</b> ] [6, <b>4</b> ]. <br><br>  The basic strategy will bring players a win only if no one has to rush more than between three boxes, in other words, only if all cycles are 3 or less long.  Hence the probability of victory: &lt;the number of permutations that do not contain cycles of length greater than 3&gt; (that is, | <i>B</i> |) divided by the total number of permutations (6!). </div></div><br>  Let us also recall the reasoning just conducted in the previous section, according to which the maximum (and the only possible) probability of winning a new game is calculated using the formula &lt;the number of permutations meaning the players win&gt; / &lt;the total number of permutations&gt; or |  <i>A</i> | / 6!  in our notation. <br><br>  Note that the permutations included in the sets <i>A</i> and <i>B</i> are somewhat similar.  Both those and others, in particular, are broken "into pieces", containing not more than 3 numbers. <br><br>  So, the permutation (2, 5, 1, 3, 6, 4) from <i>A</i> can be divided into three parts &lt;2, 5, 1&gt;, &lt;3&gt;, &lt;6, 4&gt;, according to the principle that only those numbers that are open by one player (&lt;2, 5, 1&gt; found by the first participant, &lt;3&gt; by the third, &lt;6, 4&gt; by the fourth). <br><br>  A distinctive feature of such "pieces" is that the minimum element in them is always in last place, and the "pieces" themselves are arranged in ascending order of minimum elements.  We emphasize this by highlighting the minimal elements in bold: &lt;2, 5, <b>1</b> &gt;, &lt; <b>3</b> &gt;, &lt;6, <b>4</b> &gt;. <br><br>  In turn, the permutation of <i>B</i> , say, (2, 5, 3, 6, 1, 4), can be represented as a product of disjoint cycles: (2, 5, 3, 6, 1, 4) = [1, 2, 5] [3] [4, 6] = [3] [1, 2, 5] [4, 6] = [3] [5, 1, 2] [6, 4] = ... <br><br>  Of all the possible variants of such a representation, we choose the only one in which the minimal elements of the cycles are in the last place, and the cycles themselves are arranged in ascending order of their minimal elements, i.e.  (2, 5, 3, 6, 1, 4) = [2, 5, <b>1</b> ] [ <b>3</b> ] [6, <b>4</b> ]. <br><br>  It turns out that the permutation (2, 5, 3, 6, 1, 4) from <i>B is</i> conditionally divided into ‚Äúpieces‚Äù &lt;2, 5, <b>1</b> &gt;, &lt; <b>3</b> &gt;, &lt;6, <b>4</b> &gt;, exactly the same as the permutation (2, 5, 1, 3, 6, 4) of <i>A.</i>  This tells us an algorithm that allows us to turn any permutation from <i>A</i> into a permutation from <i>B</i> and vice versa. <br><br>  Indeed, take a permutation (2, 5, 1, 3, 6, 4) of <i>A</i> , divide it in the manner specified above into ‚Äúpieces‚Äù &lt;2, 5, <b>1</b> &gt;, &lt; <b>3</b> &gt;, &lt;6, <b>4</b> &gt;, replace in this writing the angle brackets into square brackets, and commas - by the multiplication symbol of the cycles (in our case by the space) and we get [2, 5, <b>1</b> ] [ <b>3</b> ] [6, <b>4</b> ] = (2, 5, 3, 6, 1, 4 ) of <i>B.</i> <br><br>  In the opposite direction also: (2, 5, 3, 6, 1, 4) from <i>B we</i> represent in the form [2, 5, <b>1</b> ] [ <b>3</b> ] [6, <b>4</b> ], change the brackets, add commas and ‚Äúglue‚Äù the resulting pieces &lt;2, 5, <b>1</b> &gt;, &lt; <b>3</b> &gt;, &lt;6, <b>4</b> &gt; into the permutation (2, 5, 1, 3, 6, 4) of <i>A.</i> <br><br>  Here is another example of mutual transformation: (6, 1, 4, 2, 3, 5) from <i>A</i> &lt;-&gt; &lt;6, <b>1</b> &gt;, &lt;4, <b>2</b> &gt;, &lt; <b>3</b> &gt;, &lt; <b>5</b> &gt; &lt;-&gt; [6, <b>1</b> ] [4, <b>2</b> ] [ <b>3</b> ] [ <b>5</b> ] = (6, 4, 3, 2, 5, 1) from <i>B.</i> <br><br>  Thus, the elements of the sets <i>A</i> and <i>B are</i> divided into pairs that turn into each other according to the above-mentioned permutation algorithm.  In the language of mathematics, this means that there is a bijection between sets <i>A</i> and <i>B</i> , therefore, they have the same number of elements, i.e.  |  <i>A</i> |  = |  <i>B</i> |. <br><br>  This means that the chances of successfully passing the initial test using the basic strategy (| <i>B</i> | / 6!) And the probability of winning a new game (| <i>A</i> | / 6!) Are equal.  We call this <b><i><u>property 3</u></i></b> . <br><br><h4>  Conclusions - the optimality of the basic strategy </h4><br>  For clarity, properties 1, 2 and 3 are proved by the example of a game with six boxes, six players and three attempts.  It is clear that exactly the same reasoning can be repeated in the general case, when there are <i>n</i> boxes and players (for example, 100 each), and <i>k</i> attempts (for example, 50). <br><br>  From the considered properties two statements follow: <br><br>  1) The probability of winning a new game does not depend on the team‚Äôs strategy (property 2) and is exactly equal to the chances of successfully passing the initial test using the basic strategy (property 3). <br><br>  2) <b>The basic strategy provides the maximum probability of winning the team in the original game</b> , as if any other strategy would provide a greater probability of victory, then a new test (property 1) could be passed with greater chances of success, which contradicts statement 1 ) above. <br><br>  Thus, if each player starts the search from the box with his own number, and then opens the boxes with the number of the newly detected token, the team will win with the greatest possible probability.  Nothing better for the participants to come up with.  Now this is not only an intuitive offer, but also a proven fact! <br><br>  Just think, the enormous number of possible strategies of the game just stood aside - we answered the question about the optimality of one of them, and did not understand what its fundamental difference from the others! <br><br>  We didn‚Äôt even have to calculate this very probability of victory, the maximum of which we proved!  We didn‚Äôt have to consider such issues at the core of the problem, like: what is a strategy and how many are there?  Is the basic strategy the only optimal one or are there others?  What formula is used to calculate the maximum probability of winning in the case of <i>n</i> boxes, <i>m</i> players and <i>k</i> attempts? <br><br>  That is why I wrote at the very beginning that mathematics instills hope - after all, one can make history simply by proving, for example, that in chess with an ideal game of both sides there will always be a draw or a victory of whites or blacks (it would be amazing to even whites from the very first move in zugzwang!).  It is possible that due to the "incomprehensible efficiency" of mathematics, its amazing ability to beautifully and accurately answer the questions posed, this does not need to penetrate deep into chess theory or use inconceivable computing power. <br><br>  Forward to new heights!  For those who are interested in finding out more deeply with the task of simply boxing and rescuing prisoners, bonus chapters are in store. <br><br><h4>  Bonus  Counting the number of strategies </h4><br>  The algorithm of the team's actions (let's call it the collective strategy of the players) is made up of the algorithms of actions of each player individually (let's call them the individual strategies of the players). <br><br>  We will assume that the participants choose the number of the next box, which they will open, uniquely, based on the prehistory, that is, they do not use a random mechanism (they cannot, for example, choose any of the remaining boxes randomly). <br><br>  Then the individual strategy of, say, the first player can be described by a line in the table of the following form: <br><br><table border="1"><tbody><tr><th>  Move 1 </th><th colspan="4">  Move 2 </th><th>  Move 3 </th></tr><tr><th></th><th>  2 </th><th>  3 </th><th>  ... </th><th>  <i>n</i> </th><th>  ... </th></tr></tbody></table><br>  The first column (‚ÄúMove 1‚Äù) records the number of the box from which the first player begins the search.  In columns 2, 3, ..., <i>n</i> (under the general heading ‚ÄúMove 2‚Äù) the number of the next box is recorded, which it will open if the counter with the number 2, 3, ..., <i>n is</i> found in the first box opened by it, respectively .  To specify move 2, <i>n</i> - 1 numbers are required (not <i>n</i> , since there is no column with name 1, because if participant found 1 token 1 (that is, his own token), then there is no need to continue the search). <br><br>  The columns under the general ‚ÄúTurn 3‚Äù header contain the numbers of the third box in which the player will search for his token, depending on what numbers he found in the first two opened boxes.  To set move 3, you will need to specify already ( <i>n</i> - 1) * ( <i>n</i> - 2) numbers (at move 1, one of <i>n</i> - 1 numbers can be detected, and at move 2: <i>n</i> - 2, since the number detected at move 1 no longer fall). <br><br>  The cap for "Move 3" looks like this: <br><table border="1"><tbody><tr><th colspan="7">  Move 3 </th></tr><tr><th colspan="4">  2 </th><th>  3 </th><th>  ... </th><th>  <i>n</i> </th></tr><tr><th>  3 </th><th>  four </th><th>  ... </th><th>  <i>n</i> </th><th>  ... </th><th>  ... </th><th>  ... </th></tr></tbody></table><br>  If you need to set the move <i>k, you</i> will need ( <i>n</i> - 1) * ( <i>n</i> - 2) * ... * ( <i>n</i> - <i>k</i> + 1) columns. <br><br>  Let us calculate how many ways you can fill a row of such a table. <br><br>  In the first column, you can write any of the <i>n</i> numbers.  The columns for the second attempt can be filled in ( <i>n</i> - 1) <sup><i>n</i> - 1</sup> ways, since in each of ( <i>n</i> - 1) cells you can enter any of the ( <i>n</i> - 1) numbers of the boxes that are not yet open. <br><br>  The options for filling the columns for the third attempt are already ( <i>n</i> - 2) <sup>( <i>n</i> - 1) * ( <i>n</i> - 2)</sup> , since in each of ( <i>n</i> - 1) * ( <i>n</i> - 2) cells you can substitute any of ( <i>n</i> - 2) non-open box numbers, etc. <br><br>  Columns corresponding to the <i>kth</i> attempt can be filled in ( <i>n</i> - <i>k</i> + 1) <sup>( <i>n</i> - 1) * ( <i>n</i> - 2) * ... * ( <i>n</i> - <i>k</i> + 1)</sup> ways. <br><br>  As a result, there is <i>n</i> * ( <i>n</i> - 1) <sup><i>n</i> - 1</sup> * ( <i>n</i> - 2) <sup>( <i>n</i> - 1) * ( <i>n</i> - 2)</sup> * ... * ( <i>n</i> - <i>k</i> + 1) <sup>( <i>n</i> - 1) * ( <i>n</i> - 2) * ... * ( <i>n</i> - <i>k</i> + 1)</sup> individual strategies of the first player.  It is clear that any other player has the same number of strategies. <br><br>  Players act independently of each other.  A collective strategy is a combination of individual strategies, so their total number is obtained by multiplying the number of individual strategies of each player: <br>  <i>n</i> * ( <i>n</i> - 1) <sup><i>n</i> - 1</sup> * ( <i>n</i> - 2) <sup>( <i>n</i> - 1) * ( <i>n</i> - 2)</sup> * ... * ( <i>n</i> - <i>k</i> + 1) <sup>( <i>n</i> - 1) * ( <i>n</i> - 2) * ... * ( <i>n</i> - <i>k</i> + 1)</sup> to the power of <i>n</i> is equal to <i>n</i> <sup><i>n</i></sup> * ( <i>n</i> - 1) <sup><i>n</i> * ( <i>n</i> - 1)</sup> * ( <i>n</i> - 2) <sup><i>n</i> * ( <i>n</i> - 1) * ( <i>n</i> - 2)</sup> * ... * (( <i>n</i> - <i>k</i> + 1) <sup><i>n</i> * ( <i>n</i> - 1) * ( <i>n</i> - 2) * ... * ( <i>n</i> - <i>k</i> + 1)</sup> . <br><br>  If there are not as many players as boxes, then it is necessary to build not to the power <i>n</i> , but to the power <i>m</i> , where <i>m</i> is the number of players. <br><br><h4>  Bonus  Uniqueness of optimal strategy </h4><br>  An interesting question is whether the basic strategy is the only optimal one.  Can, for example, players begin searches not from the box with their own number, but from some other? <br><br>  Imagine that before the very beginning of the test the box was renumbered.  It is clear that this will not affect the players' strategies or the probability of winning.  After all, to renumber the boxes is just the same as placing the tokens, but we already believe that they are laid out randomly. <br><br>  Players can themselves mentally renumber the boxes.  For example, count the fifth box as the seventh, seventh - the tenth, and the tenth - the fifth.  In this case, using the principle of the same basic strategy, say, the fifth player will start the search from the seventh box and if he finds a 7-k in the process of testing, he will go to look in the tenth, and having found 10-ku - in the fifth. <br><br>  If all players equally mentally re-number the boxes, then the probability of winning the team will remain exactly the same.  Along with the reasoning above, one can cite a formal, purely technical proof of this fact (I think it is not so interesting to rewrite it in this post). <br><br>  As a result, since <i>n</i> boxes can be <i>numbered n</i> !  in ways, then optimal strategies are at least <i>n</i> !, however, in essence, all these are variations of the same algorithm of actions.  Most likely, if there are as many players as there are boxes, there are no other optimal strategies that truly differ from the basic ones.  We have not yet found evidence of this fact with a friend. <br><br>  If there are fewer players than boxes, then other optimal strategies are possible, which really differ from the basic ones.  For example, if we have 4 boxes, 2 players and 2 attempts each, participants can act as follows. <br><br>  The first player strategy is described by the table row: <br><table border="1"><tbody><tr><th>  Move 1 </th><th colspan="3">  Move 2 </th></tr><tr><th></th><th>  2 </th><th>  3 </th><th>  four </th></tr><tr><td>  one </td><td>  2 </td><td>  3 </td><td>  3 </td></tr></tbody></table><br>  The second player strategy is described by the table row: <br><table border="1"><tbody><tr><th>  Move 1 </th><th colspan="3">  Move 2 </th></tr><tr><th></th><th>  one </th><th>  3 </th><th>  four </th></tr><tr><td>  2 </td><td>  one </td><td>  four </td><td>  four </td></tr></tbody></table><br>  In this case, the team will win with a probability of 10/24 (10 out of 4! = 24 possible locations of the tokens in the boxes), just as in the case of using the basic strategy. <br><br><h4>  About the decision in general </h4><br>  Taking into account the current understanding of the game, we can assume that the maximum probability of winning in the case of <i>n</i> boxes, <i>m</i> players and <i>k</i> attempts is calculated by the formula: <br>  &lt;the number of permutations in which the elements 1, 2, ..., <i>m are</i> not included in cycles of length greater than <i>k</i> &gt; / <i>n</i> ! <br><br>  In the simplest cases, for example, for <i>n</i> = <i>m</i> , <i>k</i> ‚â• <i>n</i> / 2, it is proved and looks quite nice: 1 - 1 / ( <i>k</i> +1) - 1 / ( <i>k</i> + 2) - ... - 1 / <i>n</i> . <br><br>  A formal proof of the formula and its derivation in explicit form for various values ‚Äã‚Äãof the parameters is an interesting problem.      ,          . </div><p>Source: <a href="https://habr.com/ru/post/256513/">https://habr.com/ru/post/256513/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../256497/index.html">Monitoring-as-a-service for infrastructures on the example of the Anturis service</a></li>
<li><a href="../256501/index.html">Apple Watch: how to make an application under the clock and not screw it up</a></li>
<li><a href="../256503/index.html">Write under that, I don‚Äôt know what: development features for Apple Watch using Mail.Ru Mail as an example</a></li>
<li><a href="../256505/index.html">Webix. The first acquaintance with the JavaScript framework</a></li>
<li><a href="../256509/index.html">Subject-event approach to modeling complex systems</a></li>
<li><a href="../256515/index.html">Script to backup EC2-instance to AMI</a></li>
<li><a href="../256517/index.html">Separate interfaces for unit testing</a></li>
<li><a href="../256521/index.html">Scientifically looking for errors in the cloud: an unexpected CEO adventure</a></li>
<li><a href="../256523/index.html">Sprockets 3 encoding problem when working with HTML files</a></li>
<li><a href="../256525/index.html">Checking the Haiku operating system (BeOS family) with PVS-Studio. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>