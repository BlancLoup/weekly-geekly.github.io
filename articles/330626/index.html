<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 23: EternalBlue ported to Win10, CIA attacks from file servers, marketers quietly infected the whole world</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The adventures of EternalBlue continue: now researchers from RiskSense have ported it to Windows 10. At first glance, this is a destructive achievemen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 23: EternalBlue ported to Win10, CIA attacks from file servers, marketers quietly infected the whole world</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/223/fbf/f4c/223fbff4cdc14eefb7d79f2b522a238a.jpg" width="300" align="right">  The adventures of EternalBlue continue: now researchers from RiskSense have <a href="https://threatpost.com/nsas-eternalblue-exploit-ported-to-windows-10/126087/">ported</a> it to Windows 10. At first glance, this is a destructive achievement, however, this is a considerable part of the work of the safe researcher.  To protect yourself from a future threat, you first need to create and test this threat, and it is highly desirable to do this before the ‚Äúblack hats‚Äù. <br><br>  Earlier, RiskSense developed the EternalBlue module for Metasploit, which differs from the original in that it is much worse detected by IDS.  The DoublePulsar implant was thrown out of it, which is too well studied and doesn‚Äôt really know how to hide on a machine by unmasking the attack.  Instead, the researchers developed their own shellcode, which is able to load the desired load directly. <br><br>  The original EternalBlue, like its module for Metasploit, works only on Windows 7 and Windows XP, as well as on Windows Server 2003/2008 R2.  In its <a href="http://risksense.com/download/datasets/4353/EternalBlue_RiskSense%2520Exploit%2520Analysis%2520and%2520Port%2520to%2520Microsoft%2520Windows%252010_v1_2.pdf">report, the</a> company analyzes in detail all the chain of bugs used by the exploit, and the document shows that all systems based on the NT kernel are vulnerable to such an attack ‚Äî however, defense technologies, some of which EternalBlue can bypass, some do not really help out. <br><a name="habracut"></a><br>  A senior analyst at the company, Sean Dillon, said that the heap spray attacks on the Windows kernel are ‚Äúalmost a miracle‚Äù, so time consuming to develop them, in the absence of available OS sources.  Therefore, it would be easier to develop the same attack for Linux. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The researchers also created a version successfully attacking Windows 10 x64 version 1511 (Threshold 2), for which it was necessary to develop a new way to bypass DEP.  It is especially noted that the new exploit does not work on other versions of Win10.  But the principle of attack is clear, understandable, and its wide applicability.  Waiting for the WannaCry wave under Windows 10? <br><br>  <b>Documentation published on CIA implant for infecting networks</b> <br><br>  <a href="https://threatpost.com/wikileaks-dumps-cia-patient-zero-windows-implant/126036/">News</a>  The American intelligence community is increasingly ‚Äúpleased‚Äù with the global information security community.  Whether the NSA is competing with the CIA in a tricky PR campaign, or if both organizations have Snowden‚Äôs followers, they are equally ideological, but, nevertheless, more cautious. <br><br>  Last Thursday, a publication appeared on WikiLeaks about an implant developed at the CIA that turns a Windows file server into a distribution point for malware over a local network.  The tool, modestly called Pandemic, replaces files requested by machines from the file server with Trojanized versions.  According to the documentation, Pandemic 1.1 can replace up to 20 different files up to 800 MB in size. <br><br>  The implant is extremely discreet, without directly accessing the file.  It installs an operating system driver filter that allows on-the-fly modification of drive I / O.  Actually, similarly, there are antiviruses that analyze files at startup and systems for transparent file encryption. <br><br>  Obviously, the infection of the client machine occurs if the file from the server is launched, that is, the executable files are dangerous in the first place.  However, it is impossible to exclude the use of Pandemic with exploits, for example, for Microsoft Office - in this case, the infection will spread through the documents. <br><img src="https://habrastorage.org/web/d1a/63b/139/d1a63b139e3347dcaa516e5f542a8cd4.png"><br><br>  <b>Chinese malware has infected 250 million computers worldwide</b> <br><br><img src="https://habrastorage.org/web/771/422/6cc/7714226ccd484d5aa211d3d668b4eb50.jpg" align="right" width="300">  <a href="https://threatpost.com/fireball-malware-infects-250-million-computers-worldwide/126027/">News</a>  <a href="http://blog.checkpoint.com/2017/06/01/fireball-chinese-malware-250-million-infection/">Research</a>  Beijing-based marketing agency Rafotech has demonstrated a brilliant example of merciless Chinese marketing.  Not by itself - he was helped by the guys from CheckPoint, who revealed the non-sickly Fireball campaign.  Modern marketing can not be without big dates - the client needs to know better than his mother.  Therefore, a bigdat needs to be collected as quickly as possible and more. <br><br>  Rafotech invented to collect it using a Trojan.  The Fireball malware infects the victim's computer with very simple methods - it is installed by more or less legitimate programs (called crapware) by Rafotech itself and its colleagues, and you can also get it in spam.  It would seem that not the most powerful distribution channels, however, according to CheckPoint, the Trojan infected more than 250 million computers around the world. <br><br>  First of all, Fireball replaces the search engine installed in the browser with a fake one, which redirects requests to Yahoo or Google, but at the same time diligently collects information for its owners.  In addition, Fireball is able to do everything that an honest Chinese marketer may need: run arbitrary code, download and install any software from the Internet, manipulate the user's web traffic in order to generate ad views.  Technically, Fireball is as advanced as the more famous botnets - it is perfectly able to avoid detection (which proves the scale of the spread), and has a flexible management and control infrastructure. <br><br><img src="https://habrastorage.org/web/5c8/845/e51/5c8845e519924b708ebabf5e5686d74f.png"><br><br>  On its website, Rafotech claims that it "covers more than 300 million users."  Well, now we know that this seems to be true.  Taki covered.  However, it is disturbing that it is not only about individual users - CheckPoint considered that 20% of corporate systems in the world were affected by Fireball.  Potentially, this gives martial marketers truly daunting opportunities, and not just advertising. <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right"><h3>  Antiquities </h3><br>  "Find-1575" <br><br>  Non-dangerous resident virus.  It is recorded in COM and EXE files when they are started and when searching for files in directories (DOS functions FindFirst and FindNext FCB).  Under some conditions, a ‚Äúgreen caterpillar‚Äù begins to crawl across the screen.  Intercepts int 1Ch, 21h <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 67.</i> <br><br>  <i><strong>Disclaimer:</strong> This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/330626/">https://habr.com/ru/post/330626/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330612/index.html">Xenoblade Chronicles - parsing game data</a></li>
<li><a href="../330614/index.html">Heisenbag 2.0: how was the testing conference in St. Petersburg</a></li>
<li><a href="../330616/index.html">We invite you to the official workshop on UE4 from Epic Games</a></li>
<li><a href="../330618/index.html">SQL Server Integration Services (SSIS) for Beginners - Part 1</a></li>
<li><a href="../330624/index.html">Russian language specification Java</a></li>
<li><a href="../330628/index.html">Postgres Tips for Rails Developers</a></li>
<li><a href="../330630/index.html">Naively. Super. Review of the book by Jean Zelazny "Speak in the language of diagrams"</a></li>
<li><a href="../330632/index.html">Solving linear diophantine equations with any number of unknowns.</a></li>
<li><a href="../330634/index.html">Redux: trying to get rid of the need to think during requests to the API, part 2</a></li>
<li><a href="../330636/index.html">Service of the future: opportunities and risks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>