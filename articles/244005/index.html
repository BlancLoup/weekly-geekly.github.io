<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hedgehog with a snake in one basket, and also a little about the lack of a scheme</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I often see articles about why you should use nosql or that you should never use it and rely only on relational repositories. However, in my...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hedgehog with a snake in one basket, and also a little about the lack of a scheme</h1><div class="post__text post__text-html js-mediator-article">  Recently, I often see articles about why you should use nosql or that you should never use it and rely only on relational repositories.  However, in my opinion, these excellent tools can get along together perfectly, allowing you to use their common virtues and avoiding their disadvantages. <br><img src="https://habrastorage.org/files/b7e/30d/c8e/b7e30dc8eaf0467ba02c4da1265cb10a.png" alt="image"><br><a name="habracut"></a><br><h4>  As a preface </h4><br>  About a year ago, our team had a great opportunity to work on the site of a new English TV channel.  Like most similar projects, it focuses on entertainment and information programs, news, and also interacts with visitors through social networks. <br><br>  The customer had two critical requirements that we followed when choosing the technologies used for the project: <br><ol><li>  It is very important that the data are consistent; </li><li>  The site should work with a sufficiently large number of simultaneous users. </li></ol><br>  To ensure the integrity of the data, we decided to save them in a relational form in MS SQL, and to ensure the speed of the user part of the site, we took mongodb.  For each type of page was created its own, denormalized collection of documents.  Thus, the data is first stored in MS SQL, and then published from there to all the necessary mongo DB collections. <br><br>  And why use Mongu, if you can do with SQL alone, you ask?  To justify the choice consider a few examples. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Example one </h4><br>  Let's start with an exemplary entity diagram of a TV show.  We have a table of programs, seasons, episodes, episodes and episodes: <br><br><img src="https://habrastorage.org/files/305/87f/124/30587f124ade446daeed6e71667b8d62.png" alt="Simplified diagram of TV show entities"><br><br>  The program page contains a program description, a list of program seasons, a list of episodes with a brief description of the episode, the release date of the episode, a link to its page.  We have 3 options for obtaining the necessary data from the relational database: <br><br><ol><li>  One big query with joins.  Good - one request per page.  Bad - a large amount of duplicate data and as a serious increase in the load on the database server; </li><li>  Four queries from ORM, one for each table.  Good - no extra information is retrieved or returned in any request.  Bad - actually four queries, for each of which work out the unit of work, which means four times the context of connecting to the database is created and deleted.  The variant is quite traditional and even quite good; the minuses are solved by screwing the cache; </li><li>  A stored procedure that performs four queries and returns four data sets.  Well - no extra data, one query to the database from the client.  Bad - it is quite difficult to find an ORM for .net, in which this possibility is implemented in some kind of digestible form. </li></ol><br>  In general, everything looks pretty good, but when using a denormalized collection of TV programs in Monga, you don‚Äôt need to think of anything - just make one request, pulling out the data by ID, and that's it. <br><br><h4>  Example two </h4><br>  The site has several pages displaying up-to-date information - news, programs, instagram and twitter posts, weather, advertisements, information about interruptions in the work of the metro, etc. <br><br><img src="https://habrastorage.org/files/ff5/11d/07a/ff511d07a8bc48b28e01889c0d418559.png" alt="Part of the main page, for example"><br><br>  These data, very fragmented in structure, are of a common nature and are displayed on the same pages - the most recent information is displayed on the main page, only events related to it are displayed on a page of a region, only articles are displayed on a news page.  In SQL, each type of tile is stored in a separate table, since their structure can be very different.  Such a sample from the relational database turns into a small local hell - the number of requests to the database grows with each type of tile added, and this does not take into account the complexity of writing such a sample directly in the code.  In order to somehow make life easier, it would be possible to use the table and metadata, this simplifies filtering the data, but adds the need to paste them into an object on the application side.  And for this situation, any nosql repository like Mongi becomes the perfect solution.  In the previously appeared articles about Monga on Habr√©, any mention of the absence of a scheme raised questions "how is that?  The scheme is always there. ‚Äù  Questions of this type are perfectly reasonable, but a little about that.  The absence of a scheme in this context is the ability to save data with a different scheme, but of the same nature within the same collection.  They can be used to build indexes and filter data, as well as easily deserialize them into an object with the correct and necessary type, which is easy to work with in the application. <br><br><h4>  What to pay? </h4><br>  Using sql and nosql in conjunction looks very attractive and convenient.  However, as we know, it is necessary to pay for convenience with something.  In our case, it is the need to write the functionality of publishing data from sql to mongodb.  In our opinion, this is an acceptable price. <br><br><h4>  Instead of conclusion </h4><br>  I tried not to get attached to the language in which the application was written and to the sql and nosql tools.  Instead of a monga, you can substitute any other non-relational storage. </div><p>Source: <a href="https://habr.com/ru/post/244005/">https://habr.com/ru/post/244005/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244/index.html">Underdog on Friends List</a></li>
<li><a href="../2440/index.html">German telecom operators are the most profitable</a></li>
<li><a href="../24400/index.html">jQuery File Tree - jQuery file browser</a></li>
<li><a href="../244001/index.html">AngularJs $ parse hacks</a></li>
<li><a href="../244003/index.html">Information Project Management Methodologies</a></li>
<li><a href="../244007/index.html">Polyphasic sleep: reviews, "theory", personal experience</a></li>
<li><a href="../244009/index.html">How I tortured Selenium tests for GAE Django and what came to the end</a></li>
<li><a href="../24401/index.html">Yandex was in the top ten most expensive startups</a></li>
<li><a href="../244011/index.html">How to increase the speed of communication and productivity: The introduction of Vim ideology in the messenger</a></li>
<li><a href="../244013/index.html">HungryBread - a startup about a lunch in a pleasant company</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>