<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We optimize the download of the ExtJS library to two queries</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to share the solution that I use to optimize admin loading, developed using the ExtJS library. This solution is applicable not only directly to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We optimize the download of the ExtJS library to two queries</h1><div class="post__text post__text-html js-mediator-article">  I want to share the solution that I use to optimize admin loading, developed using the ExtJS library.  This solution is applicable not only directly to ExtJS, but for this library, it is very important.  I warn you in advance that the solution is very bad, if not at all, working with a family of 60- and 70-year-old Internet explorer. <br><br><h4>  Problem: </h4><br>  Almost the first thing that immediately scares most developers and customers before starting to develop on extjs is ‚Äúdamn, but this is almost a megabyte of javascript!?!‚Äù.  In fact, the way it is, and if you include in the list for downloading files css styles and images, then you can get all a half or two.  We will spice up the dish with plug-ins, which is inevitable, because there are plus extjs in this - powerful plug-ins, then many scripts are attached for a snack, each one requiring a request to the server. <br><br>  As a result, each entry on the admin page requires that the client (received a free rosary) download all the scripts and scripts and design.  This, sadly affects the speed of the page in the browser.  And from the user requires additional patience, which does not add advantages to the karma of the developer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you thought that I would describe the way to load scripts ‚Äúon demand‚Äù, which also exists for ExtJS, then no.  My decision, though crude, gives me everything at once, although it imposes certain limitations. <br>  So‚Ä¶ <br><a name="habracut"></a><br><br><h4>  Decision: </h4><br><h5>  1. Merge multiple files into one. </h5><br>  We form the list of files that are necessary for full-fledged work and combine the files of libraries, plug-ins and helpers into one big javascript file.  We do the same for styles, and also form one file from them.  This will reduce the number of requests from the client to the server, but not enough. <br><br>  In the developer kit, ready-made all-in-one files are already attached, but it often happens that there are changes above the base library, for the most part these are styles, change fonts, then pictures.  And if there are changes to the javascript code, then I recommend to describe them as a plugin for ExtJS. <br><br><h5>  2. Inserting images into a style file. </h5><br>  Using the Data SRC URI ( <a href="http://en.wikipedia.org/wiki/Data_URI_scheme">http://en.wikipedia.org/wiki/Data_URI_scheme</a> ) allows you to insert the contents of the image directly into the style file.  This works well in almost all browsers, with the exception of 6/7 Internet Explorer, and in 8 Explorer there is a limit on data size.  <i>I'm lucky, I'm not like everyone else, my client scored on IE.</i>  The benefit of this decision is that the client receives all the style pictures at once and during the rendering process does not observe how gradually one or the other part of the visual components ‚Äúacquires‚Äù the design.  And also no extra requests to the server. <br><br>  Here is the data uri in css (taken from the wiki): <br> <code>ul.checklist &gt; li.complete { margin-left: 20px; background: <br> url('data:image/png;base64, <br> iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAABlBMVEUAAAD/ <br> //+l2Z/dAAAAM0lEQVR4nGP4/5/h/1+G/58ZDrAz3D/McH8yw83NDDeNGe4U <br> g9C9zwz3gVLMDA/A6P9/AFGGFyjOXZtQAAAAAElFTkSuQmCC') <br> top left no-repeat; } <br></code> <br><br>  And this is a good <s>topic for holivar</s> replacing css sprites, in the sense that it is also all-in-one, but at the same time, there are no restrictions like a sprite on colors (if it‚Äôs gif) or using a repeat-style picture as a background.  For example, in ExtJS (2.0), the checkbox picture is a sprite, with all checkbox states.  When you try to make in the grid, a column with checkboxes with a checkbox in the heading and an inscription in the heading, the sprite will show its true nature, filling the background along this caption.  When I divided the image from the sprite into components, this problem disappeared. <br><br><h5>  3. Compression. </h5><br>  The resulting files now need to be compressed.  For this, I personally use <a href="http://developer.yahoo.com/yui/compressor/">yuicompressor</a> .  You can use any other compression program. <br><br>  Usage example with yuicompressor <br> <code><br> java -jar yuicompressor.jar --type js extjs.js <br> java -jar yuicompressor.jar --type css extjs.css <br></code> <br><br>  This compression is good, but not enough.  The stunning effect is apache using mod_deflate. <br><br>  The results I have about these: <br>  After gluing: js - 1000kb, css - 1000kb (yes, yes, a lot of pictures in base64). <br>  After compression: js - 800kb, css - 700kb. <br>  After mod_deflate, this is what the client downloads: js - 170kb, css - 200kb. <br><br>  As you can see, the size of the files is still large, but there is a certainty that the client will receive all the extjs environment in two requests: one for the javascript and the second for the styles. <br><br><h5>  4. Caching and expiration date. </h5><br>  The solution is the most trivial, configure apache mod_expires for these two files, so that the client downloads them once, does not download again, then the size of 500kb for downloading will not be so noticeable.  And for compulsory invalidation, we will use the timestamp (type ext.1249090480.js) in the file name.  With a new deployment, just change the file number and the client downloads the new version when you next enter the admin area. <br><br> <code>link rel="stylesheet" type="text/css" href="extjs.1245678910.css" <br> script type="text/javascript" src="extjs.1245678910.js" <br></code> <br><br>  To automate, I wrote a script that performs steps 1 through 3. <br>  <a href="http://extjs.com/forum/showthread.php%3Ft%3D67474">Published</a> on the ExtJS forum and on <a href="http://pastebin.com/f77bcdac0">Pastebin</a> . </div><p>Source: <a href="https://habr.com/ru/post/65930/">https://habr.com/ru/post/65930/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../65920/index.html">iPhone 3.0.1</a></li>
<li><a href="../65922/index.html">Toolkit: NBehave</a></li>
<li><a href="../65924/index.html">Terrible and terrible SORM2: a bit of practice</a></li>
<li><a href="../65925/index.html">Made at 95%</a></li>
<li><a href="../65927/index.html">New-old pdf exploit</a></li>
<li><a href="../65933/index.html">How to ‚Äúget rid‚Äù of advertising links to Gmail ?!</a></li>
<li><a href="../65935/index.html">‚ÄúCheap‚Äù brutal fusion reactor</a></li>
<li><a href="../65936/index.html">Theories of motivation</a></li>
<li><a href="../65937/index.html">Supercomputers in Russia - catch up and overtake?</a></li>
<li><a href="../65940/index.html">Future robots hands</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>