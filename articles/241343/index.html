<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Computer vision: recognizing clothes in a photo using a mobile application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago we decided to make a project that would allow us to search for clothes in various online stores from the photo (picture). The idea is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Computer vision: recognizing clothes in a photo using a mobile application</h1><div class="post__text post__text-html js-mediator-article"> Not so long ago we decided to make a project that would allow us to search for clothes in various online stores from the photo (picture).  The idea is simple - the user uploads an image (photo), highlights the area of ‚Äã‚Äãinterest (t-shirt, pants, etc.), specifies (optional) the specifying parameters (gender, size, etc.), and the system looks for similar clothes in our catalogs , sorting it according to the degree of similarity with the original. <br><br>  The idea itself is not that new, but qualitatively unrealized by anyone.  There is a project on the market for several years already <a href="http://www.snapfashion.co.uk/">www.snapfashion.co.uk</a> , but the relevance of its search is very low, the selection is mainly based on the definition of the color of the image.  For example, he can find a red dress, but a dress with a certain style or pattern is no longer there.  The audience of this project, by the way, is not growing, we associate it with the fact that the search is definitely of low relevance and, in fact, is no different if you choose a color on the store's website when searching through their catalog. <br><br>  In 2013, the project <a href="http://www.asap54.com/">www.asap54.com</a> appeared, and here the search is slightly better.  The emphasis is on the color and some small options, indicated manually from a special catalog (short dress, long dress, dress of medium length).  This project, faced with the difficulties of visual search, slightly turned in the direction of social networks, where fashionistas can share their ‚Äúbows‚Äù in clothes, from ‚Äúclothes chasam‚Äù to ‚Äúfashion instagram‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Despite the fact that there are projects in this area, there is definitely an uncovered need to search by image, which is very relevant today.  And the solution to this problem by creating a mobile application, as SnapFashion and Asap54 did, most closely matches the trends of the e-commerce market: according to various forecasts, the share of mobile sales in the US from 11% in 2013 can grow by 25-50% in 2017. Such rapid growth Mobile commerce foreshadows the growing popularity of a wide variety of applications that help make purchases.  And most likely the stores themselves will invest in the development, promotion of such applications, as well as actively cooperate with them. <br><br>  After analyzing the competitors, we decided that we should try to deal with this topic ourselves and launched the project Sarafan <a href="http://getsarafan.com/">www.getsarafan.com</a> . <a name="habracut"></a><br>  Corporate identity originally wanted to make bright.  Worked many options: <br><img src="https://habrastorage.org/getpro/habr/post_images/410/02a/807/41002a807fdfbef27c9766c3591af5f1.jpg" alt="image"><br><br>  As a result, we stopped at the style with bright colors. <br><img src="https://habrastorage.org/getpro/habr/post_images/52a/09a/e3e/52a09ae3ecad0622591eac797f5c7ca7.jpg" alt="image"><br><br>  To start, choose a client for iOS (for iPhone).  Design in the form of paints, works through the Rest-service, on the main screen of the application there is a choice: take a photo or choose from the gallery. <br><img src="https://habrastorage.org/getpro/habr/post_images/73d/423/f8a/73d423f8ad410909818796ceda686526.jpg" alt="image"><br><br>  This was probably the easiest of the entire project.  Meanwhile, at the advanced backend-development, everything was not so rosy.  And here is the story of our searches: what we did and what we came to. <br><br>  <b>Visual search</b> <br><br>  We have tried several approaches, but none of them gave results that would allow us to make a highly relevant search.  In this article we will tell you what you tried, and what and how it worked on different data.  We hope that this experience will be useful to all readers. <br><br>  So, the main problem of our search is the so-called semantic gap (semantic gap).  Those.  the difference between what images (in this case, the images of clothes) are considered similar by a person and a car.  For example, a person wants to find a black short-sleeved T-shirt: <br><img src="https://habrastorage.org/getpro/habr/post_images/63b/d9b/7c3/63bd9b7c35781e9c1f36ac2ec474424d.jpg" alt="image"><br>  A person will easily say that in the list below this is the second image.  However, the machine is likely to select image 3, which is a women's T-shirt, but the scene has a very similar configuration and the same color distribution. <br><img src="https://habrastorage.org/getpro/habr/post_images/623/094/105/6230941054bcd43ed97bc4953e58ad44.jpg" alt="image"><br><br>  A person expects that the search result will be positions with the same type (t-shirt, jersey, jisa ...), approximately the same style and approximately with the same color distribution (color, texture or pattern).  But in practice, to ensure that all three conditions were met was problematic. <br><br>  Let's start with the simplest, image with a similar color.  For comparison of images by color most often use the method of color histograms.  The idea of ‚Äã‚Äãa color histogram method for comparing images is as follows.  The whole set of colors is divided into a set of non-intersecting subsets completely covering it.  For the image, a histogram is formed, reflecting the proportion of each subset of colors in the color gamut of the image.  For comparison of histograms, the concept of the distance between them is introduced.  There are many different methods for forming color subsets.  In our case, it would be reasonable to form them from our catalog of images.  However, even for such a simple comparison, the following conditions are required: <br>  - Images in the catalog should contain only one thing on a easily separable background; <br>  - We need to effectively distinguish the background and the area of ‚Äã‚Äãclothing that interests us in the user's photos. <br>  In practice, the first condition is never satisfied.  We will tell about attempts to solve this problem later.  With the second condition is relatively easier, because  the selection of the region of interest in the image of the user occurs with his active participation.  For example, there is a rather efficient background removal algorithm - GrabCut ( <a href="http://en.wikipedia.org/wiki/GrabCut">http://en.wikipedia.org/wiki/GrabCut</a> ).  We proceeded from the consideration that the area of ‚Äã‚Äãinterest in the image is closer to the center of the user-rounded area than to its border and the background in this area of ‚Äã‚Äãthe image will be relatively uniform in color.  Using GrabCut and some heuristics, we managed to get an algorithm that works correctly in most cases. <br><br>  Now about the selection of the area of ‚Äã‚Äãinterest to us in the images of the catalog.  The first thing that comes to mind is to segment the image by color.  For example, the watershed algorithm ( <a href="http://en.wikipedia.org/wiki/Watershed_(image_processing)">http://en.wikipedia.org/wiki/Watershed_(image_processing) is</a> suitable. <br>  However, the image of a red skirt in the catalog can have several options: <br><img src="https://habrastorage.org/getpro/habr/post_images/75c/a41/5c3/75ca415c37cae18b0baa21213cf9ca4f.jpg" alt="image"><br><br>  If in the first and second cases it is relatively easy to segment the area of ‚Äã‚Äãinterest, in the third case we will also single out the jacket.  For more complex cases, this method will not work, for example: <br><img src="https://habrastorage.org/getpro/habr/post_images/cb9/caa/b9c/cb9caab9c51a7ab380bff4aaca5719af.jpg" alt="image"><br><br>  It should be noted that the problem of image segmentation is not completely solved.  Those.  There are no methods that allow to select the region of interest in one fragment, as a person can do: <br><img src="https://habrastorage.org/getpro/habr/post_images/757/97c/c0c/75797cc0c5754bb4c46139e1538365f9.jpg" alt="image"><br><br>  Instead, the image is divided into superpixels, here it is worth looking in the direction of the n-cuts and turbopixel algorithms. <br><img src="https://habrastorage.org/getpro/habr/post_images/19a/63a/113/19a63a113b85273c9572d81c1033b4a9.jpg" alt="image"><br><br>  In the future, use some combination of them.  For example, the task of searching and localizing an object is reduced to finding a combination of superpixels belonging to the object, instead of searching for a bounding box. <br><img src="https://habrastorage.org/getpro/habr/post_images/a19/e54/7cb/a19e547cb7e6c0e77c39455ae7d944bd.jpg" alt="image"><br><br>  So, the task of marking catalog images has been reduced to finding a combination of superpixels that correspond to things of this type.  This is a machine learning task.  The idea was to take a lot of hand-marked images, train a classifier on it and classify various areas of a segmented image.  The region with the maximum response is considered to be the region of interest.  But here it is necessary to decide again how to compare the images, since  simple color matching is guaranteed not to work.  We'll have to compare the form or a certain image of the scene.  As it seemed at that time, the gist descriptor would be suitable for this purpose ( <a href="http://people.csail.mit.edu/torralba/code/spatialenvelope/">http://people.csail.mit.edu/torralba/code/spatialenvelope/</a> ).  The gist descriptor is a kind of histogram of the distribution of edges in an image.  The image is divided into equal parts by a grid of any size, the distribution of edges of different orientations and different sizes is considered and sampled in each cell.  The resulting n-dimensional vectors can be compared. <br><br>  A training set was created; many images of different classes (about 10) were manually marked up.  But, unfortunately, even with cross-validation, it was not possible to achieve classification accuracy above 50%, changing the parameters of the algorithm.  Part of the reason for this is that the shirt in terms of edge distribution will not be much different from the jacket, partly because the training sample was not large enough (usually gist is used to search for very large image collections), and partly because may not apply at all. <br><br>  Another method for comparing images is comparing local features.  His idea is to highlight significant points in the images (local features), in some way describe the neighborhoods of these points and compare the number of feature coincidences of the two images.  SIFT was used as a descriptor.  But the comparison of local features also gave poor results, mostly due to the fact that this method is designed to compare images of the same scene, taken from a different angle. <br><br>  Thus, it was not possible to mark the images from the catalog.  A search for unallocated images using the methods described above sometimes gave roughly similar results, but in most cases the result was nothing similar from a person‚Äôs point of view. <br><br>  When it became clear that we did not manage to partition the catalog, we tried to make a classifier for the user's images, i.e.  automatically determine the type of thing that the user wanted to find (t-shirt, jeans, etc.).  The main problem is the lack of a training set.  Images of the catalog are not suitable, firstly because they were not marked up, and secondly they are presented in a rather limited set of spatial representations and there is no guarantee that the user will provide images in a similar view.  To get a large set of spatial representations for the thing, we shot a person in this thing on the video, then cut out the thing and built a training sample on a set of frames.  In this case, the thing was a contrast and easily separated from the background. <br><img src="https://habrastorage.org/getpro/habr/post_images/1d4/ef4/dae/1d4ef4daef23ffd159d8f66c3793266e.jpg" alt="image"><br>  Unfortunately, this approach was quickly rejected when it became clear how much video to take and process to cover all possible styles of clothing. <br><br>  Computer vision is a very extensive segment, but we have (so far) failed to achieve the desired result with a highly relevant search.  We do not want to fold to the side, adding additional side functions, and we will fight, creating a search tool.  We will be happy to hear any advice and comments. </div><p>Source: <a href="https://habr.com/ru/post/241343/">https://habr.com/ru/post/241343/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../241331/index.html">Startup Marketing (continued): Nine Traffic Quality Levels</a></li>
<li><a href="../241333/index.html">Building a mirrored volume on Windows Server 2008 r2</a></li>
<li><a href="../241335/index.html">How to use the API of a site that does not have an API?</a></li>
<li><a href="../241339/index.html">Startup marketing: A client who disappeared at the bottom of a funnel and why pay too much attention to traffic is dangerous for your business</a></li>
<li><a href="../241341/index.html">About the state of affairs in OpenStack for service providers</a></li>
<li><a href="../241345/index.html">Pangu released iOS 8.1 jailbreak without Cydia</a></li>
<li><a href="../241347/index.html">Introduction to the home automation system HDL</a></li>
<li><a href="../241349/index.html">HDConf conference: photo-video-slide report</a></li>
<li><a href="../241353/index.html">Application Vulnerability Control</a></li>
<li><a href="../241355/index.html">Digital Media or Digital Signage - how to?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>