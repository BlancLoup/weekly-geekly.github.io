<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We connect a new chip from WIZnet: W5500. IP for small things</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It seems that Etherent and TCP / IP are still the most common way to communicate a wide variety of devices. Although WiFi has recently been slowly rep...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We connect a new chip from WIZnet: W5500. IP for small things</h1><div class="post__text post__text-html js-mediator-article">  It seems that Etherent and TCP / IP are still the most common way to communicate a wide variety of devices.  Although WiFi has recently been slowly replacing the wired ‚Äúcopper‚Äù Etherent, nevertheless, finding a port and ‚Äústicking to LAN‚Äù is still the easiest way to connect.  Such availability of Ethernet has not bypassed the smallest hardware: controllers, sensors, consumption counters, etc.  which are now called the fashionable marketing word " <b>Internet of Things *</b> " (Internet Of Things, IoT). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/867/42a/fdb/86742afdb5eba9c48f28b1c45e28b53a.jpg"></div><br><br>  And here we can great help Korean microcircuits from WIZnet.  WIZnet is a fairly active manufacturer of IOcP (Internet Offload co-Processor) class chips.  What is it?  Speaking in human terms, this is a chip that: on the one hand, has Etherent, inside contains its own tiny processor for handling TCP / IP, and on the other hand, a simple interface for communicating with our small piece of hardware. <br><a name="habracut"></a><br>  In the first part there will be a small theoretical overview of the connection of "small pieces of iron" and a bunch of links to different chips. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But the question immediately arises: <b>WHY</b> to introduce another processor into the system, if everything can be processed on the main one?  Let's try to answer. <br><br><h1>  Overview: Ethernet for trivia. </h1><br>  Let's try to go "down" on a scale of value (up to units of dollars or even lower) and consider various ways of including "little things" in the network. <br><br>  The simplest way to ‚Äúnetwork access‚Äù for microcontrollers is various kinds of converters <i>COMport-to-Telnet</i> , <a href="http://shop.wiznet.eu/serial-to-ethernet/s2e.html">Serial2Ethernet</a> sometimes called Reverse Telnet.  In this case, the converter ‚Äúcatches‚Äù the telnet session and ‚Äúdrives‚Äù it to the usual COM port of the microcontroller.  Then the operator enters the usual dialogue, only over the network.  Well what can I say?  First of all, there is a separate microcontroller there too, and the devices are not cheap at all (Articles about <a href="http://habrahabr.ru/post/137974/">homemade module</a> and <a href="http://habrahabr.ru/company/scancode/blog/206920/">Tibbo module</a> ).  For a simple ‚Äúchange / read one parameter‚Äù task, this may well be enough.  There are a lot of minuses too - a single session, a fixed protocol - it is difficult, for example, to screw SSL if it is not there, the complexity of configuring <i>the</i> converter <i>itself</i> , for example, changing its IP address or port, etc. <br><br>  Another option is microcontrollers with a real etherent on board, but they usually have only a MAC level and require an external PHY chip (KS8721BL, DM9161A, RTL8201).  Connection with such a chip, MII or RMII at least requires external pins.  To connect the PHY to the LAN, you still need to solder the transformer or MagJack.  Thus, by the ‚Äúnumber of components‚Äù there is no gain.  Surprisingly, the external Etherent PHY - quite expensive chips, a few dollars per case.  But about the same is the <b>entire</b> chip from WIZnet entirely, silicon, in mass production costs a penny.  Yes, a transformer for WIZnet is also required, but at the price, there will be no significant gain from the integrated MAC controller.  Second: software support for MAC / PHY is quite complex and voluminous.  For example, for the STM32Fxx7, the Ethernet source codes of the driver occupy approximately 100K of text in C. ( <a href="http://habrahabr.ru/post/138081/">an article about PICs and Ether</a> ).  In addition to the Etherent driver, you also need the TCP / IP stack ( <a href="https://en.wikipedia.org/wiki/LwIP">LwIP</a> or <a href="https://en.wikipedia.org/wiki/UIP_%2528micro_IP%2529">uIP</a> ).  In addition to the size, you should not forget about the speed of execution (although ... STM32 already exceeds the first Pentium in speed and you can forget about the performance limit). <br><br>  But what if the benefits of a ‚Äúfull‚Äù software IP stack on a microcontroller?  Of course have.  Consider them later, but for now we continue. <br><br>  The third option is the SPI Ethernet chip of the <a href="http://www.microchip.com/wwwproducts/Devices.aspx%3FdDocName%3Den022889">Microchip ENC28J60</a> controller (and the slightly less well-known <a href="http://www.silabs.com/products/interface/ethernetcontrollers/pages/default.aspx">Silabs CP2200</a> ), which is deeply loved by the embedderschiki.  Please note that these are real Ethernet <b>controllers</b> , not TCP / IP coprocessors.  All that a chip can do is receive and receive Etherent frames.  That is, the TCP / IP stack will still have to be done by yourself.  Yes, there are several ready-made stacks, from wonderful <a href="http://www.microchip.com/wwwproducts/Devices.aspx%3FdDocName%3Den022889">small ones</a> to classic LwIP and uIP. <br><br>  But still, such a solution is more likely to compete directly with the built-in MAC controller, and the chip price is the same few dollars and about $ 5.7 for a ready-made module (card with a chip, a transformer and an RJ45 socket) on ebay / aliexpress.  So back to the products of the company WIZnet. <br><br><h1>  WIZnet: the middle path. </h1><br>  The first W3100 device was released quite a long time ago, in 2001.  It was a full-fledged TCP / IP IOcP (coprocessor) that offered a middle path between the COM port and the MAC controller, implementing the idea of ‚Äã‚ÄãTCP / UDP ‚Äúsockets‚Äù inside the chip.  Physically, the W3100 was not a very convenient dual-chip MAC / PHY set, and the real popularity among the ‚ÄúArduinschikov‚Äù (AVR) and ‚Äúpicovods‚Äù came to the <a href="http://www.wiznet.co.kr/product-item/w5100/">W5100</a> device.  Suffice it to say that the ‚Äúofficial‚Äù <a href="http://arduino.cc/en/Main/ArduinoEthernetShield">Arduino Ethernet Shield is</a> built specifically on the W5100. <br><br>  A lot of time has passed since the W5100 became noticeable: the chip is pretty hot, the network speed is only 10Mbit / s, the chip has several glitches (documented in Errata), the case is quite large due to the presence of a parallel bus, a somewhat nontrivial implementation of SPI.  Not surprisingly, WIZnet soon introduced the following model: <a href="http://www.wiznet.co.kr/product-item/w5200/">W5200</a> .  This chip learned to work at 100Mbit, fall asleep and save electricity, lost a parallel connection, it remained purely SPI, which dramatically reduced the number of legs.  (He has a brother W5300 to support parallel bus). <br><br>  The introduction and development of the W5200 went off with a bang!  and continues to this day, modules are being released (starting with the native WizNET <a href="http://www.wiznet.co.kr/product-item/wiz820io/">WIZ820io</a> ) and ending with various Arduin shields, those who are interested can easily find them.  For example, slightly less ‚Äúofficial‚Äù <a href="">Ethernet Shield V2.0</a> from the Seeeduino project or Dfrobot's <a href="http://www.dfrobot.com/index.php%3Froute%3Dproduct/product%26product_id%3D1028">Ethernet Shield for Arduino</a> .  And here is a <a href="http://wizwiki.net/wiki/doku.php%3Fid%3Doshw_using_wiznet:ethernet">large list of</a> other modules (the list is really big, we shake down). <br><br>  And finally, in October 2013, WIZnet <a href="http://www.prweb.com/releases/2013/10/prweb11272428.htm">announced a</a> new <a href="http://www.wiznet.co.kr/product-item/w5500/">W5500</a> , which was actually planned to be covered in this article (sorry for such a prolonged preface).  The chip got a little more convenient. <br>  for LUT self-made builders, the 48LQFN package, a fast ‚Äúbatch‚Äù SPI and Cortex M0 inside, which reduced the technical process and power consumption.  In general, the chip looks like "W5200 on steroids."  <a href="http://wizwiki.net/wiki/doku.php%3Fid%3Dproducts:w5500:migration">Comparison of W5200 and W5500</a> . <br><br>  Next, WizNET released the WIZ550io module (there is also a diagram there), and in order not to stay away from ‚Äúarduinomanii‚Äù, WIZnet soon released the <a href="http://wizwiki.net/wiki/doku.php%3Fid%3Dosh:ioshield-a:start">Arduino Shield itself</a> (this is just a passive adapter from Arduino to WIZ550io). <br><br>  But let's <a href="http://habrahabr.ru/post/191054/">not</a> consider Arduino, it will be done without us (for example, right here, on Habr√©: <a href="http://habrahabr.ru/post/110610/">Ethernet thermometer based on Arduino</a> , etc.) and try to fasten the W5500 to some popular microcontroller, for example to the same STM32.  Even WizNET itself is aware of this remarkable family and released the <a href="http://www.wiznet.co.kr/product-item/w5200e01-m3/">W5200E01-M3</a> module on the previous W5200 (STM32F103C8 and FT232RQ for USB2Serial).  Soon the module on STM32 + W5500 came out: <a href="http://www.wiznet.co.kr/product-item/wiz550web/">WIZ550web</a> . <br><br>  By the way, in March 2014, Circuitcellar announced a contest called <a href="http://circuitcellar.com/wiznet2014/">Connect The Magic</a> (until August 2014) for development using the W5500, and WIZnet dropped prices for chips and modules ( <a href="http://shop.wiznet.eu/io/io-modules/wiz550io-ct.html">buy</a> ).  The competition could win up to 15.000 $.  Details on the site, there is also an excellent <a href="http://circuitcellar.com/wp-content/uploads/2014/01/WiznetPrimer2014.pdf">article</a> . <br><br>  In the second part (if I add it ...), we will try to fasten the W5500 (or rather WIZ550io) to a small <a href="http://www.lctech-inc.com/Hardware/Detail.aspx%3Fid%3D0172e854-77b0-43d5-b300-68e570c914fd">debugging board</a> from Shenzhen LC Technology Co., Ltd.  <s>and win $ 15,000</s> .  Scarves <a href="http://www.aliexpress.com/store/product/ARM-Cortex-M3-STM32F103C8T6-STM32-core-board-development-board/524881_1319507014.html">are sold</a> on Aliexpress for $ 7.99 and even mentioned several times in Habr√©. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ce5/386/b35/ce5386b35faee9d8b9cef2fc676204e4.jpg"></div><br><br>  PS The author has nothing to do with the respected WIZnet company, but gradually the list of links on the W5500 has grown and turned into such a habrapost. </div><p>Source: <a href="https://habr.com/ru/post/220723/">https://habr.com/ru/post/220723/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220707/index.html">Data based monitoring</a></li>
<li><a href="../220711/index.html">Intel¬Æ INDE beta Contest: The Original Android Application - Your IDF14 Pass!</a></li>
<li><a href="../220713/index.html">We build a web application in Java without JEE and Spring</a></li>
<li><a href="../220715/index.html">CSS 3 Timing Functions and what they eat</a></li>
<li><a href="../220717/index.html">Work with external device registers in C language, part 1</a></li>
<li><a href="../220725/index.html">Aggregators of online trading and the "gray" market</a></li>
<li><a href="../220727/index.html">Linux Foundation and major IT companies create a foundation to support critical open source software.</a></li>
<li><a href="../220749/index.html">Dev story of one .NET utility</a></li>
<li><a href="../220755/index.html">Unreal Engine 4.1 - support for XBox One, PlayStation 4, Linux, SteamOS and more</a></li>
<li><a href="../220761/index.html">Getting better: the thorny path of the programmer. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>