<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Documentation Development with DocBook</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It so happened that in our projects the maintenance of technical documentation completely lies on the shoulders of the developers, according to the pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Documentation Development with DocBook</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/f98/804/d5b/f98804d5b0d3905ec3cc291f20d55723.png" align="left"><br><br>  It so happened that in our projects the maintenance of technical documentation completely lies on the shoulders of the developers, according to the principle: made changes to the project code - updated the documentation.  The documentation itself was a collection of Word documents that was stored with the source code under VCS.  This approach to the organization of development has existed for a long time, but a couple of years ago we decided to attend to the possibility of maintaining project documentation using means other than MS Office. <br><a name="habracut"></a><br><br>  There were several reasons for this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  The first and probably the most important one is frequent conflicts when editing files together. </li><li>  The second reason - although there were a lot of documents, they all had a similar structure and in many respects overlapped in content (due to the nature of the project‚Äôs architecture).  And as true programmers, the ‚Äúduplication‚Äù of the text did not suit us. </li><li>  And finally, the eternal struggle with styles. </li></ul><br><br>  All these problems were superimposed on each other and they already made this, and so not very favorite, process of updating the documentation, a punishment unbearable by severity.  It happened that after a few hours of writing, you with a sense of accomplishment of your duty are trying to ‚Äúflood‚Äù your changes in SVN and receive sad news that someone turned out to be faster than you or you just simply forgot to upgrade before starting work.  In any case, this meant that a smoke break would have to be slightly postponed.  In addition to the text, it was necessary to pay attention to the design styles, which with rather enviable regularity for some reason ‚Äúbroke down‚Äù (for example, the numbering of the list started from the beginning, to the place where things would continue, etc.).  And not all of these ‚Äúbreakdowns‚Äù were easily eliminated, sometimes it began to seem that Word was living some kind of life and didn‚Äôt give a damn about your wishes for design. <br><br>  Thus, our alternative to MS Word should satisfy the following criteria: <br><ol><li>  Text format of document storage - for convenient work with it in VCS. </li><li>  Support for extensive design and styling of the document. </li><li>  The ability to decompose the final document into fragments - for reuse. </li><li>  The ability to publish the final document in various formats. </li></ol><br><br>  As a result of a long search, we realized that there are not so many solutions that meet our requirements: DITA and DocBook.  DITA immediately seemed to us too ‚Äúpowerful‚Äù and difficult to go, but we decided to stop at DocBook.  Generally speaking, the search for an alternative solution was very gradual and before we realized that ‚Äúit was impossible to continue this life‚Äù and the full transition to DocBook took more than one day and a lot of experiments were carried out on what we had at that moment.  First of all, we tried to store documents in WordML format, which to some extent solved the problem of merging changes - now the merger did not always end with a conflict, but manual resolution of conflicts in the markup was very uncomfortable.  We also tried to divide the documents into fragments, thereby reducing the possibility of conflicting changes and try to implement their reuse.  The idea was not very successful.  And so gradually, through trial and error, all the same decided to completely switch to DocBook, since in our opinion, it should have eliminated all our problems. <br><br><h4>  What is DocBook? </h4><br>  Ate suddenly, who does not know, <a href="http://ru.wikipedia.org/wiki/DocBook">DocBook</a> is a standard for describing a document and does nothing useful except for standardizing content.  Moreover, the standard is quite old, and many, for some reason, are considered already obsolete. <br><br>  Writing a document in DocBook format is very similar to working with HTML, only its own set of tags and rules for their use are used. <br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">book</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chapter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>First Chapter<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">para</span></span></span><span class="hljs-tag">&gt;</span></span>Hello world!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">para</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chapter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">book</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  This example demonstrates a one-chapter book description with the title ‚ÄúFirst Chapter‚Äù containing a paragraph with the text ‚ÄúHello Word!‚Äù.  A complete list of tags, as well as examples of their application, can be found on the project website <a href="http://www.docbook.org/">www.docbook.org</a> .  From myself I want to note that the set of tags for describing the content is very (even very very) large, but in our daily work we use about 20. <br><br><h4>  Convert DocBook Document </h4><br><br>  In order to bring our DocBook document into any readable or printable format, you must use a transformer (or even a conveyor of several transformers one after another), which will form the final document based on the content of the document and, usually, styles. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f6e/34f/4a8/f6e34f4a8aa098758ddea65cd506735f.png"></div><br><br>  As a rule, DocBook -xsl is used for transformation (although there are more exotic ways).  Out of the box, it already supports several document formats - html, xsl-fo, manpages, etc. If a different presentation format is required, then you can continue the chain of conversions.  So, to obtain a document in PDF, the following scheme is usually used: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/89b/eeb/12e/89beeb12e6a57a35a803f909ed1f488d.png"></div><br><br>  And here begins the most interesting.  Styles implemented in DocBook-xsl by default allow you to get a normal-looking document, but usually, they still require customization. <br><br>  The developers of docbook-xsl styles took care of this possibility and implemented special mechanisms for this: <br><br><ul><li>  The most common parameters for generating a document of each of the supported formats are in a separate param.xsl file and for each of them there is a more or less detailed description. </li><li>  There are special templates for the formation of custom templates. </li><li>  Presence of special, empty default templates for their further redefinition. </li></ul><br><br>  Most often, to control the process of document formation, we develop our own root XSL style, the so-called ‚ÄúDriver‚Äù, in which all other transformation parameters are already fine tuned.  Since each final format in DocBook-xsl is represented by its own set of templates, then the ‚Äúdriver‚Äù for each of them needs to be written separately.  For example, we use two final document presentation formats (xsl-fo and htmlhelp) and, accordingly, we have two ‚Äúdrivers‚Äù and two sets of redefined styles. <br><br><h5>  Choosing xslt and fo processor </h5><br><br>  To work with DocBook-xsl, you need an xslt processor that supports xslt version 1.0.  (There is a docbook-xsl implementation for version 2.0, but I don‚Äôt know how stable it is).  At the moment there are many working solutions for a variety of platforms - so there should be no problems with this.  In our projects, we use saxon, though the old version is Saxon 9.1.0.8J, since the last free support for EXSLT extensions was completely removed (necessary for profiling the document) and there was no certainty that the saxon extension to support syntax highlighting that comes with the styles will work in the new. <br><br>  For the formation of documents from xsl-fo, you need a fo processor.  Things are a little worse here - from the working processors, I personally tried two FOP (opensource) and XEP (RenderX XEP Engine - a bit paid).  There are some more working fo processors, but personally I have not tried working with them and cannot say anything about them. <br><br>  The main plus of FOP is that it is free, but there is also a minus - from the ‚Äúbox‚Äù it does not support the Russian language.  When we first met him, we never managed to get him to work with Cyrillic.  Strangely enough, there are many articles on the Internet about this, but all of them were either very old (where it was suggested to rebuild FOP with the necessary fonts) or contained errors that did not allow to achieve the desired result.  In the end, everything turned out to be very simple, but our choice has already fallen on XEP.  XEP works fine with Cyrillic immediately after installation and in principle does not require any additional configuration, but it costs $ 400 - and the desktop version.  I don‚Äôt try to judge the difference in rendering quality, but you can compare for your own interest (in the example there are files collected by both fo-processors). <br><br><h5>  Customize the style </h5><br><br>  For high-quality customization of styles, it is necessary to know a little xsl language of the transformation, as well as the markup language of the final document.  Unfortunately, we didn‚Äôt have such competence in the team at the time of the transition to DocBook, and therefore it took us enough time to set up - especially for the FO format.  Although there are a large number of websites with information on this subject in the network (in my opinion ‚Äú <a href="http://www.sagehill.net/docbookxsl/index.html">DocBook XSL: The Complete Guide</a> ‚Äù, which is especially valuable in my opinion), it is very difficult to get a complete picture right away.  Therefore, I decided to act according to the principle ‚Äúit is better to see once than hear a hundred times‚Äù and prepared an example of style for xsl-fo (about the same as we use in projects) along with the source text of this article and a customized FOP. <br><br>  The only time I want to stop and which at first can be confusing is the setting of the fonts and the language of the document.  By default, fonts that do not support Cyrillic are included in xsl-fo, and if you do not override these parameters or make a mistake in them (you must make sure that the fo processor is configured to work with the specified fonts), then you will most likely get unreadable output from the fo processor document.  The language of the document affects the creation of autotext for the names of the elements of the book (Chapter, Book, etc.).  In principle, setting only these parameters already allows you to get the "correct" document.  Also, most likely there will be a desire to change the appearance of the title page of the document.  This can be done with the help of a template specially prepared in docbook-xsl.  To do this, you need to define your own version of the file "/fo/titlepage.templates.xml" and use the xslt processor and the template "/fo/titlepage.templates.xsl" to get a customized design style for connecting to the "driver".  In some cases, the built-in configuration mechanisms are not enough, and then you have to explicitly override the original docbook-xsl styles in the driver. <br><br><h4>  Conclusion </h4><br><br>  It took us quite a long time to complete the transition to DocBook.  First, it was necessary to bring to it already written documentation.  Here we tried different utilities like AntiWord, but because of the large number of artifacts, it was decided to do it manually (artifacts were obtained both due to formatting errors in the source document, and due to the peculiarities of the translation scripts).  We also spent a lot of time developing our own design styles, searching for the environment for developing documents (eventually settled on NotePad ++) and environment settings.  It seemed a simple task, but with its implementation, we constantly ran into some problems.  Unfortunately, there is not much information on DocBook, and if we talk about the Russian-speaking segment, there is practically no information at all.  But in the end we were satisfied. <br><br>  Since our team moved to keeping technical documentation in DocBook more than one year has passed, and we no longer have any other option for ourselves.  All that we wanted to achieve the transition to DocBook - we have achieved: <br><br><ul><li>  I forgot what conflicts are in documentation when working in VCS, even when using GitFlow (with the same reservation as at the beginning of the article: made changes - reflected in the documentation). </li><li>  Almost completely got rid of duplication of the same text in different documents.  Thanks to the DocBook profiling, it was possible to make the document more flexible, and writing documentation less boring work.  Here the main sense of proportion, because in some ways the complex decomposition of the original document makes it very difficult to navigate and edit. </li><li>  Almost forgot how to format documents in Word, or rather just forgot how to format.  Now the development of documentation - only writing the text of the document. </li><li>  Great scope for creativity in terms of integration into the overall software development process. </li></ul><br><br>  Naturally, apart from the pros, there are also disadvantages: <br><br><ul><li>  The most pressing problem at the moment is the interaction with other departments of the company.  For obvious reasons, only our team switched to DocBook, all the rest use MS Word, and when we need to perform data interchange, we have to do it manually.  The benefit is very rare, and is usually limited to a couple of paragraphs of text. </li><li>  The complexity of implementing some non-standard for DocBook approaches to formatting documents, in particular, often arises the need to deploy several pages in landscape orientation, but so far they have not learned how to do this (to our shame) and we have to go around this point somehow differently.  But I am 100% sure that this can be done, and therefore the unresolved nature of this problem can be explained by a less urgent need.  For example, when we needed to insert formulas into a document, it took less than noon to do MathML. </li></ul><br><br>  And the purpose of this article is to bring to readers who are developing technical documentation in office programs that there are more suitable tools.  For those who have already glanced in the direction of DocBook or DITA for some time, to give some impetus and tips for the transition - after all, the most difficult thing to begin!  It would also be very interesting to hear what approaches are taken in other teams and their implementation experience. <br><br>  Bibliography: <br><ul><li>  <a href="http://docbook.sourceforge.net/">http://docbook.sourceforge.net/</a> </li><li>  <a href="http://www.sagehill.net/docbookxsl/index.html">DocBook XSL: The Complete Guide</a> <a href="http://www.sagehill.net/docbookxsl/index.html"><br></a> </li><li>  <a href="http://www.docbook.ru/">http://www.docbook.ru/</a> <a href="http://www.docbook.ru/"><br></a> </li></ul><br><br>  Example: <br><br><ul><li>  <a href="https://github.com/individym/HabrahabrArticle">https://github.com/</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/212881/">https://habr.com/ru/post/212881/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../212871/index.html">Masking the class under the Boost graph. Part 3: Finding the Way</a></li>
<li><a href="../212873/index.html">Mobile application development. Why is this business?</a></li>
<li><a href="../212875/index.html">How we test advertising technologies of Yandex, and how to learn it</a></li>
<li><a href="../212877/index.html">We use WEBKit instead of IE in Visual Basic.net applications.</a></li>
<li><a href="../212879/index.html">x3650 M4 - do you need HD?</a></li>
<li><a href="../212883/index.html">Declarative event binding / handling</a></li>
<li><a href="../212885/index.html">Problem 10 million connections</a></li>
<li><a href="../212887/index.html">Keep the roots (to the 80th anniversary of Nicklaus Wirth)</a></li>
<li><a href="../212889/index.html">Javascript: autocorrection timers</a></li>
<li><a href="../212891/index.html">Ubiquiti AirGrid M5 HP 27dBi - Expansion of a network bridge. Personal experience</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>