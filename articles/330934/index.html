<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>And terrible Russian firewall will burst</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After the ValdikSS article about blocking sites on rotten domains, the ILK was not bothered by the thought of what would happen if the registry starts...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>And terrible Russian firewall will burst</h1><div class="post__text post__text-html js-mediator-article"><p>  After the <a href="https://habrahabr.ru/users/valdikss/" class="user_link">ValdikSS</a> article <a href="https://geektimes.ru/post/289947/">about blocking sites on rotten domains, the ILK was</a> not bothered by the thought of what would happen if the registry starts resolving to a very large number of IPv4 addresses.  It seems to me a dubious undertaking of full-fledged "teachings" because  they may accidentally turn into a <em>deliberate violation of the runet's connectivity</em> .  Therefore, I limited myself to finding answers to two questions: </p><br><ul><li>  Do providers automatically add IPv4 addresses from DNS to routing tables? </li><li>  Do large DNS responses that contain thousands of records correctly handle such RIB-supplemented systems? </li></ul><br><p>  I <a href="https://github.com/darkk/where-is-resolver/tree/master/z-i">heated</a> and registered several free domains from the <a href="https://github.com/zapret-info/z-i/">list</a> , raised the DNS server and set the traffic to be written in pcap ... </p><a name="habracut"></a><br><p>  The domains for registration were selected as follows: two domains present in the upload with https-links, two domains with http links and two "bare" domains with no links.  This is done to test the hypothesis of equality of all domains before the filter.  The IPv4 addresses pointed to by these domains were chosen from the existing ones in the registry in order not to increase the load on the filters.  The addresses that are not in the registry are currently allocated to my virtual machines, so there are no DoS attacks in this experiment. </p><br><p>  You can go through the <a href="http://www.bgplookingglass.com/">open</a> <a href="https://archive.li/BhylY">lists of</a> <a href="https://ru.wikipedia.org/wiki/Looking_Glass">Looking Glass of</a> different providers and see which of the major Russian providers have routes with a mask / 32 to their addresses from the registry, because  these providers have the risk of being hit by a routing table overflow attack.  There are not so few of such providers: <a href="https://archive.li/i66ic">Equant aka GIN aka Orange Business Services</a> , <a href="https://archive.li/Vy5Ue">Beeline</a> , <a href="https://archive.li/8nK6U">Rostelecom</a> , <a href="https://archive.li/JM5If">Transtelecom</a> , <a href="https://archive.li/x05wg">Obit</a> and, what is a little funny, the <a href="https://archive.li/WBKUV">Federal University Computer Network of Russia</a> <del>  (joke about academic freedom and independence of universities) </del>  . </p><br><p>  Let's check that the IP address that we plan to add "under the block" is not present in the routing tables on the same LG: <a href="https://archive.li/m5JA9">1</a> , <a href="https://archive.li/zUoNP">2</a> , <a href="https://archive.li/MI30v">3</a> , <a href="https://archive.li/n8oBQ">4</a> , <a href="https://archive.li/AW3Ow">5</a> , <a href="https://archive.li/cmopR">6</a> .  If someone reproduces this experiment extremely purely, then it is also worth checking all the IPv4 and IP addresses that you plan to add to the table.  I assume that the situation with them is similar. </p><br><p>  On June 14 at 15:00 Moscow time, I added the addresses of some of my servers to the <a href="https://github.com/darkk/where-is-resolver/commit/d22e2debc3c10812dda68f3872e3c80917fcf57c">DNS zone files</a> and began to observe what is happening in the pcap files while the resolvers updated the records. </p><br><h2>  Diversity </h2><br><p>  A total of 16 hours in the logs were requests for resolvers from one and a half thousand autonomous systems.  In them, there is a fairly large variety of behaviors in terms of resolvable domains. </p><br><p>  From the network with a abuse-contact on <a href="https://stat.ripe.net/AS50317">netup.ru</a> , only those domains that are listed with the URL are resolved, while the domain with 2048 entries receives requests about 5 times more.  AS <a href="https://stat.ripe.net/AS57835">FGUP Telecommunications</a> with the same contact regularly goes to the DNS for all "small" domains every 8 minutes, but for some reason does not send a single request to the "large" domains, exactly like <a href="https://stat.ripe.net/AS38959">Izhevsk RadioLink</a> .  <a href="https://stat.ripe.net/AS39475">Tele2</a> resolves https and dumb, but doesn‚Äôt resolve http, presumably all http is wrapped in proxy.  <a href="https://stat.ripe.net/AS42514">Zheleznogorsk Signal</a> and <a href="https://stat.ripe.net/AS12668">Ekaterinburg Miralogic on the</a> contrary - only http.  <a href="https://stat.ripe.net/AS43826">SPNet from Sergiyev Posad</a> - URLs do not resolve at all, only "bare" domains.  <a href="https://stat.ripe.net/AS56705">Moscow citytelecom</a> - on the contrary, only https and, as FGUP Telecommunications, does not even try to cut the "big" domains, which suggests the existence of an alternative way of distributing blacklists with pre-resolved addresses. </p><br><pre><code class="hljs ruby"><span class="hljs-params"><span class="hljs-params">| HTTPS |</span></span> HTTP <span class="hljs-params"><span class="hljs-params">| Domain-only asn |</span></span> tiny <span class="hljs-params"><span class="hljs-params">| 2k/udp |</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>k/tcp <span class="hljs-params"><span class="hljs-params">| tiny |</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>k/udp <span class="hljs-params"><span class="hljs-params">| 2k/tcp |</span></span> tiny <span class="hljs-params"><span class="hljs-params">| 2k/udp |</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>k/tcp ------+------+--------+--------+------+--------+--------+------+--------+------- <span class="hljs-number"><span class="hljs-number">50317</span></span> <span class="hljs-params"><span class="hljs-params">| 903 |</span></span> <span class="hljs-number"><span class="hljs-number">1416</span></span> <span class="hljs-params"><span class="hljs-params">| 1030 |</span></span> <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-params"><span class="hljs-params">| 1295 |</span></span> <span class="hljs-number"><span class="hljs-number">1012</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 57835 |</span></span> <span class="hljs-number"><span class="hljs-number">207</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 200 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">38959</span></span> <span class="hljs-params"><span class="hljs-params">| 29 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">56</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 39 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 39475 |</span></span> <span class="hljs-number"><span class="hljs-number">155</span></span> <span class="hljs-params"><span class="hljs-params">| 217 |</span></span> <span class="hljs-number"><span class="hljs-number">217</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">151</span></span> <span class="hljs-params"><span class="hljs-params">| 209 |</span></span> <span class="hljs-number"><span class="hljs-number">209</span></span> <span class="hljs-number"><span class="hljs-number">42514</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">120</span></span> <span class="hljs-params"><span class="hljs-params">| 136 |</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 12668 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 95 |</span></span> <span class="hljs-number"><span class="hljs-number">103</span></span> <span class="hljs-params"><span class="hljs-params">| 18 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">43826</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 13 |</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-params"><span class="hljs-params">| 12 56705 |</span></span> <span class="hljs-number"><span class="hljs-number">415</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">| 0 |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><p>  The full statistics of the number of requests in the first 16 hours can be seen in the <a href="https://gist.github.com/darkk/e9c96ca11282493b03fe964b94a6fd59">gist</a> , I note that not all ASNs belong to Russian providers. </p><br><h2>  EDNS &amp; TFO </h2><br><p>  In pcap, almost no requests were found with the <a href="http://www.afasterinternet.com/howitworks.htm">EDNS Client Subnet</a> option, such requests are less than 1%.  This is not very surprising, because  google (almost the only ‚Äúprovider‚Äù of such requests) only discloses client addresses to those DNS servers that explicitly <a href="https://groups.google.com/forum/">announce support for this option</a> , but my DNS server did not.  The indicated small percentage of requests is, I suppose, those attempts to automatically detect support for the EDNS Client Subnet: every fourth request from <a href="https://stat.ripe.net/AS15169">Google AS</a> came with this option. </p><br><p>  In addition to Google, Client Subnet received 4 requests from Brazil from a resolver using a hack with <a href="https://tools.ietf.org/html/draft-vixie-dnsext-dns0x20-00">bit 0x20</a> : </p><br><pre> <code class="hljs nginx"> <span class="hljs-attribute"><span class="hljs-attribute">ts</span></span> | src | query | client4 ---------------------------+---------------+----------------------+-------------- <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span>.<span class="hljs-number"><span class="hljs-number">231796</span></span> | <span class="hljs-number"><span class="hljs-number">187.1.128.119</span></span> | udp A zenitbET66.CoM | <span class="hljs-number"><span class="hljs-number">200.248.248.0</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span>.<span class="hljs-number"><span class="hljs-number">748585</span></span> | <span class="hljs-number"><span class="hljs-number">187.1.128.119</span></span> | tcp A ZenItbET66.cOm | <span class="hljs-number"><span class="hljs-number">200.248.248.0</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">42</span></span>.<span class="hljs-number"><span class="hljs-number">274296</span></span> | <span class="hljs-number"><span class="hljs-number">187.1.128.119</span></span> | udp A zEnItbET66.coM | <span class="hljs-number"><span class="hljs-number">200.248.248.0</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">42</span></span>.<span class="hljs-number"><span class="hljs-number">798544</span></span> | <span class="hljs-number"><span class="hljs-number">187.1.128.119</span></span> | tcp A zeNitBET66.com | <span class="hljs-number"><span class="hljs-number">200.248.248.0</span></span></code> </pre> <br><p>  Hack with bit 0x20 is relatively popular - with it comes about 5% of requests from 2.5% resolvers (if you count the unique resolvers by ASN). </p><br><p>  Another interesting EDNS option is the <a href="https://tools.ietf.org/html/rfc6891">EDNS UDP payload size</a> , which announces the maximum DNS packet size that the client is ready to accept.  In addition to a quarter of requests that do not announce support for EDNS and 55% of requests that set this option to 4096 bytes, there are several other interesting values. </p><br><p>  2% of requests say that UDP packets of an increased size do not need anything and use the minimum allowable value of 512. An example of such a resolver is irc.kristel.ru from <a href="">Minusinsk</a> , which changes this option after the first "big" answer, which had to be received by TCP.  A similar behavior is observed on some other resolvers, including resetting the size back to 512 bytes after a while. </p><br><pre> <code class="hljs ruby"> ts <span class="hljs-params"><span class="hljs-params">| proto |</span></span> qtype <span class="hljs-params"><span class="hljs-params">| qname |</span></span> udpsz ---------------------------+-------+-------+--------------------+------ <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">41</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">59.678401</span></span> <span class="hljs-params"><span class="hljs-params">| udp |</span></span> A <span class="hljs-params"><span class="hljs-params">| zenitbet66.com |</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">41</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">59.898596</span></span> <span class="hljs-params"><span class="hljs-params">| tcp |</span></span> A <span class="hljs-params"><span class="hljs-params">| zenitbet66.com |</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">42</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">32.14485</span></span> <span class="hljs-params"><span class="hljs-params">| udp |</span></span> A <span class="hljs-params"><span class="hljs-params">| m.zenitbet66.com |</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">44</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">40.532815</span></span> <span class="hljs-params"><span class="hljs-params">| udp |</span></span> A <span class="hljs-params"><span class="hljs-params">| www.kisa54.com |</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">56</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">54.083849</span></span> <span class="hljs-params"><span class="hljs-params">| udp |</span></span> A <span class="hljs-params"><span class="hljs-params">| diplom-lipetsk.com |</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">56</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">54.311013</span></span> <span class="hljs-params"><span class="hljs-params">| tcp |</span></span> A <span class="hljs-params"><span class="hljs-params">| diplom-lipetsk.com |</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">06</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">38.524876</span></span> <span class="hljs-params"><span class="hljs-params">| udp |</span></span> A <span class="hljs-params"><span class="hljs-params">| www.cool-sino.com |</span></span> <span class="hljs-number"><span class="hljs-number">4096</span></span></code> </pre> <br><p>  Also, a couple of scanners got into the logs, which could search for DNS amplification, since  set the client size to 65527 bytes, which is the maximum value.  Interestingly, the "big" responses powerdns sends without any response to resource records, putting the flag truncated in the header, which causes the resolver to go to TCP.  So powerdns avoids DNS amplification when working with large UDP responses. </p><br><p>  I was a little surprised that <strong>not a single</strong> DNS request over TCP came through using <a href="https://en.wikipedia.org/wiki/TCP_Fast_Open">TCP Fast Open</a> .  Of course, the lack of this feature can be explained by the fact that if you worry about speed, then first of all you should not give large DNS responses that force the resolver to switch to TCP. </p><br><h2>  DNS and routing </h2><br><p>  For 10 hours on the above looking glass did not appear / 32 routes to any of the IPv4 addresses "added" to DNS, but after 20 hours at least on <a href="https://archive.li/75RPn">LG TTK</a> and the <a href="https://archive.li/Ck29u">university network</a> these routes appeared.  If you take measurements using RIPE Atlas, then you can find a number of transit providers who probably perform rezolving and enter routes to the filter, receiving 2049 <code>A</code> records in response: </p><br><ul><li>  <a href="https://stat.ripe.net/AS49063">DataLine</a> - in traceroute, filter01.dtln.ru starts to glow, </li><li>  <a href="https://stat.ripe.net/AS8997">Rostelecom</a> - <a href="https://stat.ripe.net/AS8997">Rostelecom</a> hops 188.254.78.25 and 95.167.93.150 are added to the traceroute at the exit from AS8997 on routed IP routes that are not observed on dozens of other traces to neighboring hosts from the same / 24 network, i.e.  hardly a balancing artifact </li><li>  <a href="https://stat.ripe.net/AS9002">ReTN</a> is a similar story with a three-hop route lengthening to "dedicated" hosts, and the filter on the ReTN network on the Habr√© has <a href="https://habrahabr.ru/post/192046/">already been written by @amarao</a> . </li></ul><br><p>  The list is incomplete, because  was compiled by the method of intent peering.  The presence of large providers in the list indicates that the question of the potential vulnerability of critical infrastructure to this attack is not closed.  Also remain open questions: </p><br><ul><li>  How does the effect of the DNS resource records in the response affect the special effects?  You can set it, for example, using the <code>sortlist</code> or directly generate a manual response in the LUA code </li><li>  How quickly is an IPv4 address that gets "resolved" added to routes? </li><li>  Is IPv6 address resolving performed? </li><li>  What other interesting conclusions can be drawn from such data? </li></ul><br><p>  If someone wants to look at the data on his own, then in RIPE Atlas these are measurements: <a href="https://atlas.ripe.net/measurements/8844224/">8844224</a> , <a href="https://atlas.ripe.net/measurements/8844225/">8844225</a> , <a href="https://atlas.ripe.net/measurements/8844226/">8844226</a> , <a href="https://atlas.ripe.net/measurements/8844227/">8844227</a> , <a href="https://atlas.ripe.net/measurements/8844228/">8844228</a> , <a href="https://atlas.ripe.net/measurements/8844229/">8844229</a> , <a href="https://atlas.ripe.net/measurements/8844230/">8844230</a> , <a href="https://atlas.ripe.net/measurements/8844231/">8844231</a> , <a href="https://atlas.ripe.net/measurements/8844232/">8844232</a> , <a href="https://atlas.ripe.net/measurements/8844233/">8844233</a> , <a href="https://atlas.ripe.net/measurements/8844234/">8844234</a> , <a href="https://atlas.ripe.net/measurements/8844235/">8844235</a> .  Requests for the first 16 hours of the experiment are available as a <a href="">postgres dump: 9.6</a> .  I can ship gigabytes of pcap by separate request. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/330934/">https://habr.com/ru/post/330934/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330922/index.html">Rich Notifications, utm-tags, webhook and other innovations PushAll</a></li>
<li><a href="../330926/index.html">Startup of the day (May 2017)</a></li>
<li><a href="../330928/index.html">IT Management: What ITSM is and the ServiceNow Platform</a></li>
<li><a href="../330930/index.html">It is a little about ServiceNow, ITSM and ServiceDesk in a format of selection of useful materials</a></li>
<li><a href="../330932/index.html">40 unusual questions asked at the interview at Apple</a></li>
<li><a href="../330936/index.html">Optical character recognition on the microcontroller</a></li>
<li><a href="../330938/index.html">Java: automatically generate SQL queries</a></li>
<li><a href="../330940/index.html">We compile, as if in the yard 1992</a></li>
<li><a href="../330942/index.html">The story of how cognitive technologies help preserve karma</a></li>
<li><a href="../330944/index.html">[Administrator's abstract] Domains, addresses and Windows: mix, but do not shake</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>