<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ImageLoaders: Continued</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous article, I compared the UniversalImageLoader (UIL) and Picasso libraries for optimal memory usage. Among the comments were some subtle...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ImageLoaders: Continued</h1><div class="post__text post__text-html js-mediator-article">  In the <a href="http://habrahabr.ru/post/218453/">previous article,</a> I compared the UniversalImageLoader (UIL) and Picasso libraries for optimal memory usage.  Among the comments were some subtleties of the use of libraries and requests to test other bootloaders.  These questions gave rise to the second part of the benchmark with the participation of 5 libraries. <br><a name="habracut"></a>  Results: <br>  So, libraries will take part in benchmark: <br>  <a href="https://github.com/nostra13/Android-Universal-Image-Loader">UIL</a> , <a href="https://github.com/square/picasso">Picasso</a> , <a href="https://github.com/bumptech/glide">Glide</a> , <a href="https://github.com/androidquery/androidquery">Query</a> , <a href="https://android.googlesource.com/platform/frameworks/volley/">Volley</a> <br><br>  Sources can be found <a href="https://github.com/artemmanaenko/ImageLoadersTest">here.</a> <br><br>  In the <b>first</b> part of the article I will conduct experiments with measuring the memory used with the participation of five libraries. <br>  In the <b>second</b> part I will compare the libraries in terms of their settings and visual characteristics. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Used memory </h5><br>  If someone is interested to get acquainted with the details of the experiment - they can be found in the <a href="http://habrahabr.ru/post/218453/">previous article</a> . <br>  I will say briefly: I will test libraries for loading images and measure the memory used by them on equal terms.  Graphs on the device were drawn using the <a href="https://github.com/jjoe64/GraphView">GraphView</a> library. <br><br><h5>  Download small images 240x240 </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/09a/f28/407/09af2840792d659b3a532f7692cda2a1.png" height="250"><br>  In this experiment, it is possible to note a decrease in the memory consumption of <b>UIL</b> due to the hack from the author of the library: <br><pre><code class="java hljs">imageView.post(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ imageLoader.displayImage(...); } });</code> </pre> <br><h5>  Download large images without format conversion </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/578/eab/927/578eab9272fecd1f79e2dd7f252c92cb.png" height="250"><br>  <b>Query</b> library behaves in a very interesting way.  I did not climb into the source, but I have an assumption that the cache is based on the list, and not the set.  Otherwise, I do not know how to explain the duplication of images on the backward scrolling grid. <br>  Just unpleasantly surprised <b>Volley</b> .  Very often the image in ImageView is not loaded.  Debug pointed out that sometimes attempts are made to set recycled Bitmap.  There is probably some problem with the choice of pictures to be cleaned. <br><br><h5>  Downloading large images with converting to RGB565 format and fitting the image to the size of the ImageView </h5><br>  As a rule, large images do not require a 24-bit format, in most cases RGB565 is sufficient. <br>  Most easily convert format allows <b>UIL</b> .  It is enough to specify the necessary Bitmap.Config in the image loading options.  For the rest of the libraries, the conversion had to be written. <br><img src="https://habrastorage.org/getpro/habr/post_images/12d/cc4/fda/12dcc4fda584daa88e19cfe9beb24f04.png" height="250"><br>  In this experiment, <b>Glide</b> stood out, taking more memory than <b>Volley</b> , <b>Query</b> and <b>Picasso</b> together.  At once I want to clarify: it was possible to limit the size of the cache, but in the experiment I wanted to see how the libraries work with memory in the basic configuration.  Each global cache limit cleaning is a noticeable plug in the work of the UI thread.  Therefore, from the library I would like some kind of gradual cleaning, so to speak. <br><br><h5>  Loading small images (240x240) with subsequent rounding </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/4c9/7fd/f74/4c97fdf74548c66eeaa90842e52c2b0e.png" height="250"><br><br>  Unfortunately, such successful results of <b>Volley</b> cannot be taken into account, since I did not see the pictures on the back pass.  They all turned out to be recycled, even considering that I didn‚Äôt cause the original to recycle () during the transformation.  <b>No good.</b> <br><br>  <b>Glide</b> , apparently, performs the conversion of all the pictures in RGB565, since the pictures have a black background instead of a transparent one.  <b>No good.</b> <br><br>  The easiest way to do the transformation is with <b>UIL</b> and <b>Query</b> .  <b>UIL</b> has a built-in class RoundBitmapDisplayer, which can be connected to download options. <br>  For <b>Query, it is</b> enough to specify in the options the radius of the image rounding. <br>  For <b>Picasso</b> and <b>Glide, the</b> inclusion of the transformation to the load looks like one of the steps in Builder-a. <br><pre> <code class="java hljs">Glide.load(url).centerCrop().transform(roundTransformation).into(imageView); Picasso.with(context).load(url).transform(picassoRoundTransformation).noFade().into(imageView);</code> </pre><br>  For <b>Volley,</b> I had to redefine ImageView and do Bitmap-a conversion in the setImageBitmap () method. <br>  If anyone has a better solution, offer your options. <br><br><h5>  Visual characteristics. </h5><br>  <b>Picasso is</b> inferior to other libraries in image loading speed.  I don‚Äôt know how to explain it, but it‚Äôs a fact: Picasso images appear a little later. <br><br>  <b>Glide</b> , as mentioned above, converts images into RGB565, which can cause trouble when transforming images. <br><br>  <b>UIL</b> loads images visually faster.  But you need to take into account one feature: when using FadeInBitmapDisplayer for a smooth display of pictures, it is better to use an advanced constructor. <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FadeInBitmapDisplayer(duration, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)</code> </pre><br>  In this configuration, the picture will only be animated for the first time (while the map is still in the cache), and when browsing it will not strain the eye with excessive animation.  This is IMHO. <br>  In <b>Picasso,</b> the fade in effect works by definition in this mode. <br><br>  <b>Volley,</b> in turn, often does not display converted images because they are already recycled ().  I am waiting in the comments for your suggestions for correcting this bug. <br><br>  <b>Query</b> visually surprised nothing.  Loading pictures looks intermittent.  The order in which the pictures were requested is rarely observed. <br><br><h5>  Bootloader configuration </h5><br>  <b>UIL</b> is the undisputed leader in the ability to tune boot parameters.  Thanks to the Builder-pattern of settings, you can easily get acquainted with the library's capabilities.  In principle, you can do without a manual.  UIL also allows you to connect OnScollListener to pause requests for a time scrolling list. <br><br>  <b>Glide</b> and <b>Picasso</b> are the easiest libraries to integrate.  <b>Picasso</b> has the advantage of having a maven repository.  If you need to quickly integrate the loading of images, while getting the optimal settings and economical consumption of memory - the choice for <b>Picasso</b> . <br><br>  <b>Picasso</b> and <b>UIL</b> provide interfaces that allow you to upload a picture anywhere. <br><br>  <b>Volley</b> requires a long preparation for use.  You need to create and configure the cache instance and boot queue yourself.  In the markup, you must use the NetworkImageView widget or its heirs.  For me, this is a significant inconvenience.  The only acceptable way to use this library for downloading images is if the Network of your project is built on Volley. <br><br>  <b>Query</b> , in principle, is not hard to configure.  But the use case offered by the authors in adapters confuses me a little.  To download each image, you need to create an instance of the AQuery class, which in itself is rather heavy.  This is not the best library if you want to save CPU time on garbage collection. <br><div class="spoiler">  <b class="spoiler_title">Query usage example</b> <div class="spoiler_text"><pre> <code class="java hljs">AQuery aq = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AQuery(convertView); ImageOptions options = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImageOptions(); options.ratio = <span class="hljs-number"><span class="hljs-number">1</span></span>; options.round = Integer.MAX_VALUE; aq.id(imageView).image(url, options);</code> </pre><br></div></div><br>  Often there is a need to use your HTTPClient to upload images.  <b>Volley</b> and <b>UIL</b> provide tools to configure the connection.  On the Internet, I also met the integration of the custom HttpClient in <b>Picasso</b> .  But as far as I understand, standard means will not do this. <br><br><h4>  findings </h4><br>  The more libraries - the harder it became to draw any conclusions.  I will try in one sentence to characterize each library. <br><br>  <b>Picasso</b> - if you need to quickly integrate and not worry about the memory used <br>  <b>UIL</b> - if your project requires a specific load setting, but at the same time allows you to perform this setting quickly and clearly <br>  <b>Glide</b> is a clone of <b>Picasso</b> (maybe the other way around), but consumes a bit more memory. <br>  <b>Volley</b> - use is justified if your Network is built on <b>Volley</b> , and the connection requires specific HttpClient configuration for the entire project <br>  <b>Query</b> is a difficult to understand and integrate library with poor documentation, yet it does show excellent results in saving device memory. <br><br>  Waiting for your comments and tips! </div><p>Source: <a href="https://habr.com/ru/post/219855/">https://habr.com/ru/post/219855/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../219841/index.html">New JIT available: now with SIMD support</a></li>
<li><a href="../219845/index.html">OpenVPN successfully compromised through Heartbleed</a></li>
<li><a href="../219847/index.html">NASA is testing an inflatable aerodynamic brake for landing humans on Mars</a></li>
<li><a href="../219849/index.html">NASA: a planet has been discovered on which water in a liquid state can potentially be</a></li>
<li><a href="../219851/index.html">First public performance of RTOS Systemicus + video</a></li>
<li><a href="../219857/index.html">Wireless power transmission at 5 meters</a></li>
<li><a href="../219859/index.html">GOST 34.11-2012 Stribog for flat assembler (x86)</a></li>
<li><a href="../219865/index.html">Features of the development of children's mobile applications. Practical advice</a></li>
<li><a href="../219867/index.html">Mobile phone based laboratory microscope</a></li>
<li><a href="../219869/index.html">Checking the Qt 5 framework</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>