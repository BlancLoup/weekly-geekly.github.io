<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Setting up e-mu 0204 usb in ubuntu GNU / linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A couple of days ago I bought myself an external sound card e-mu 0204. I bought it from my hands, for 2 tr. The owner was happy, I am the same. Both t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Setting up e-mu 0204 usb in ubuntu GNU / linux</h1><div class="post__text post__text-html js-mediator-article">  A couple of days ago I bought myself an external sound card e-mu 0204. I bought it from my hands, for 2 tr.  The owner was happy, I am the same.  Both thought they were cheating each other.  There is a piece of iron in the store 4.5 tr.  Brought home he knocked out, the sound is fabulous.  But, the jamb was found.  At unpredictable times, quiet clicks and interruptions of sound were heard.  I have great ATH-SJ55 headphones.  Corresponding to the card level, it is not clear why it suddenly began.  Understand how to fix.  Yes, I will immediately note that all these problems are described in the instructions !!!  So all the op around the card says only that the screaming just did not open it.  I did not have instructions in the kit, I later found it on the Internet.  All settings in the article will still be needed. <br><a name="habracut"></a><br>  Of course, I heard about the problems with the card and tried to use the method of playing a sound file with silence described in a bunch of places to occupy the channel and it seems like the clicks should disappear as ‚Äúthe card will no longer go into power saving mode‚Äù.  What I just did not read, even the fact that she does not have enough power and need to buy an external usb hub with a separate power supply.  All this did not help (the hub did not try, and in the later read instructions they are directly contraindicated). <br>  Crawled into the settings pulseaudio.  In the piece of iron there is a hardware buffer where data is put after digitization.  The computer's sound system needs to put sound into it, in general, the sound of the computer is communicating through it and the computer so that the sound is not interrupted (there it must be looked at). <br>  If the settings for working with the buffer are incorrectly configured on the computer, there will be clicks.  This I found out by picking the settings and reading the <a href="http://forums.linuxmint.com/viewtopic.php%3Ff%3D42%26t%3D44862">forums</a> with the calculation of the values ‚Äã‚Äãof these parameters.  The second of the options described here, the settings may be suitable for Windows, since there is an assembly jackd for it, it seems.  Although in Windows you can probably set up another way.  On Linux, everything is easier.  First, add yourself to the audio group: <br><pre><code class="bash hljs">usermod -a -G audio theusername</code> </pre> <br>  It is necessary to add the user theusername to the audio group, because without it the server jackd and pulsaudio will not be able to allocate memory and start in real time if configured with it.  Further settings may vary. <br><br><h4>  Option one, simple: </h4><br><br>  I broke my head before I managed to set it all up in Linux and generally understand what was going on, at first I started to get upset.  By the way, first, try to choose a simpler resampler and nothing else.  All the problems with artifacts in the sound rest against the performance of the computer and have absolutely nothing to do with sound.  The easiest way to make it so that the computer would be able to generate the sound is to change the resampler to a simpler one.  Although, what did it cost the manufacturer to include the instruction manual?  Maybe it was, I took the interface from my hands.  Those who want to configure, look in /etc/pulse/daemon.conf <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#       audio  .       ,  #,    . realtime-scheduling = yes #     realtime-priority = 10 #  ,     allow-exit = no exit-idle-time = -1 #       ,   ,   i7  ,   ,     #    src-sinc-best-quality              #    ! resample-method = src-sinc-medium-quality #    default-sample-format = s24le #     ,                #    default-sample-rate = 192000 alternate-sample-rate = 192000 #           ,      ,     (    ,  ) ;default-fragments = 4 ;default-fragment-size-msec = 3</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You may also need to go to: /etc/pulse/default.pa <br>  And put there: <br><pre> <code class="bash hljs">load-module module-udev-detect use_ucm=0 tsched=0</code> </pre> <br>  instead <br><pre> <code class="bash hljs">load-module module-udev-detect use_ucm=0</code> </pre> <br>  After installing a simpler resampler method, I didn't need these settings.  At first, it is worth trying without this parameter, since it will most likely work without it, but without it, the processor load even on the best resampler will be low.  Actually low load on the processor and this option is good overall settings.  Together with tsched = 0, everything works more stable, and it should be understood that with this parameter the load on the processor from pulseaudio will increase.  This, by the way, will kill all the advantages of the pulses over the alsa, but it is too lazy to tune my alsu, and the clicks without pulses are the same. <br><br>  The clicks will remain only at the start of the computer (when the card is turned on), small, and even when the next client is connected to the sound server.  I will not describe here the pulseaudio setting for a weak computer, the point is that the resampler needs to be simpler set and the priority of pulseaudio raised.  It should be noted that this method of tuning is highly dependent on the performance of the computer.  If your frequency is floating on the processor (ondemand scheduler), sometimes there may be a lack of performance and there will be artifacts in the sound.  There is a more interesting way to configure, according to my observations, it is much more stable and better. <br><br><h4>  Option two, kosher: </h4><br>  In /etc/pulse/daemon.conf <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#           resample-method = src-sinc-best-quality default-sample-format = s24le #     ,                #     default-sample-rate = 192000 alternate-sample-rate = 192000</span></span></code> </pre><br>  The rest is the default.  Even tsched = 0 do not set!  Skype users for whom he wheezes at the start, I think the same solution will do.  The problem with skype is that the sampling rate of the file, which it loses at the start, does not coincide with the frequency of the resampler, and there are wheezing on many cards.  Our card pretends to be an initial professional level, so it‚Äôs generally logical that it is designed for professional software.  In general, we go further. <br>  Put jackd, configure the number of samples in the buffer 1024 and the number of periods on buffer 2 (you can twist other variants of these values ‚Äã‚Äãif it clicks, since the buffer is adjusted depending on the specific computer and its capabilities).  The minimum number of samples is 128 for this map, and the number of periods per buffer 2 can be experimented with. <br>  Depending on whether you run jackd in real time or not, the buffer may be different.  In fact, these are the same buffer parameters as in pulseaudio, only in their original form, and not calculated.  It is possible to focus on fidelity on messages about desynchronization, they need to be 0, although in real time it is impossible to orient at all on this, and so not very reliable indicator, it remains just by ear.  You can find this in the qjackctl in the message window, the status tab, you need to set it as well, these numbers are also in the status window in the main panel. <br>  Also pay attention to the launch mode jackd, in real time or not, it is worth trying both and see how the sound will behave under the load of the computer.  If you set the real-time mode, do not forget to set the same real-time mode for pulseaudio (in the same daemon.conf): <br><pre> <code class="bash hljs">realtime-scheduling = yes realtime-priority = 5</code> </pre><br>  Only priority pulses should be less than the jackd.  By default, jackd starts up with a priority of 10. <br>  In general, the settings window looks like this for me: <br><img src="https://habrastorage.org/getpro/habr/post_images/3e7/d9c/cbc/3e7d9ccbc673b7a15986847c06a494c0.png" alt="image"><br>  Pay attention to the ‚ÄúTime out‚Äù option, if small artifacts irritate you when you re-connect clients (for example, if there was no sound for a long time, and then you turned on the music), then you can set the time while jackd will hold the channel.  For example, a minute.  This will lead to constant CPU usage, but it will have the same effect as playing a file with silence.  But, this is if the artifacts remain at all after the adjustment.  I compared, the built-in card on my laptop works in the same way, a little twitching when switching melodies in the player, which is quite logical, so just heard a sharp cessation of sound or the beginning of a new one not from zero volume (without fade in / out).  So do not make incredible demands where it is not necessary. <br>  Then you force pulseaudio to output sound through jackd, by adding a command that is executed after starting jackd. <br>  Team <pre> <code class="bash hljs">pacmd <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>-default-sink jack_out</code> </pre>  This is the same in the qjackctl parameters set.  Now pulsaudio works as a mixer and outputs the result to jackd, which directly pours sound into the alsa driver and through it into a piece of iron. <br>  In the end, I just took qjackctl and set it to autoload, setting all parameters in it.  Unlike pulseaudio, the parameters for working with the buffer are clear and do not require calculations, as well as obviously affect the operation. <br><br>  The clicks will disappear, the sound will be clear, silky.  And always, in any case, I have not heard any more clicks under load, anywhere, even when playing several sound sources from different places and connecting different clients to sound. <br><br>  <b>UPD ‚Ññ1:</b> I also twisted the latency of I / O, but did not get any sensible results, besides this I indicated specifically that two output channels are needed.  I did not go into detail, as if the latency I / O set some accounting for the delays inside the sound engineer itself, it is possible to drive much larger values ‚Äã‚Äãinto it.  But, this is just picking the settings out of curiosity.  It turned out that good sound and headphones have their flaws, I now hear even very small shoals in the sound, and the sound paranoia earned during the day of the proceedings with the settings leads to the fact that it is not clear whether this is in the original recording of the joint, or Does the buffer tweak.  Although the sound quality is superb all the time. <br><br>  <b>UPD ‚Ññ2:</b> I found an excellent <a href="http://personalaudio.ru/detail/e_mu_0204_usb/">review of the</a> card.  It has buffer parameters and delays for it.  What can serve as the basis for more accurate settings. <br><blockquote>  RightMark Audio Analyzer 6.2.3 PRO <br><br>  Device: ASIO E-MU 0204 |  USB <br><br>  Features: <br>  Input channels: 2 <br>  Output channels: 4 <br>  Input latency: 440 <br>  Output latency: 440 <br>  Min buffer size: 88 <br>  Max buffer size: 22000 <br>  Preferred buffer size: 440 <br>  Granularity: 44 <br></blockquote><br><br>  For comparison <br><br><blockquote>  Device: ASIO E-MU 0202 |  USB <br><br>  Features: <br>  Input channels: 2 <br>  Output channels: 2 <br>  Input latency: 2138 <br>  Output latency: 2714 <br>  Min buffer size: 384 <br>  Max buffer size: 96000 <br>  Preferred buffer size: 1920 <br>  Granularity: 192 <br></blockquote><br><br><blockquote>  Device: ASIO E-MU 0404 |  USB <br><br>  Features: <br>  Input channels: 4 <br>  Output channels: 4 <br>  Input latency: 22083 <br>  Output latency: 22216 <br>  Min buffer size: 88 <br>  Max buffer size: 22000 <br>  Preferred buffer size: 22000 <br>  Granularity: 44 <br></blockquote><br><br>  Pay attention to the size of the buffer!  That is why 0202, 0404 has no problems, but 0204 has it!  In the case of 0404, the buffer is the same as that of 0204, but it reports ‚ÄúPreferred buffer size: 22000‚Äù, that is, it itself says, according to the protocol, that the buffer must be used to the full extent at once, therefore the setting is not required.  That's why setting 0204 is required, in my amateur opinion, as it says the software on the computer is ‚ÄúPreferred buffer size: 440‚Äù.  But, again, but look at the latancy, it depends on the buffer parameters, so 0404 has such a delay because 22000 offers a buffer, and it offers it for reinsurance, as the pro will reconfigure in its own way if necessary.  Setting yourself quite leads the map in excellent condition.  The manufacturers of other cards (and this series as well) had a calculation that probably ‚Äúset the buffer to the maximum, if the user doesn‚Äôt notice the delay, fine, but there‚Äôs enough buffer, if he sees, he knows where to set up, he just noticed.‚Äù  The calculation, as it turns out, is correct. <br><br>  <b>UPD number 3:</b> Found a great <a href="http://www.soundonsound.com/sos/jan05/articles/pcmusician.htm">article</a> with the unfolding of all the shelves, which is associated with buffers.  Yes, and do not forget, the resampler spends CPU resources, so the type of resampler you choose will depend on the maximum load on the percent, if you overdo it, then when resampling several sources, the process is not enough and there will be out of sync, which means clicks.  In general, the measure must be known. <br><br>  <b>UPD ‚Ññ4:</b> <b>ATTENTION !!!</b>  I found a simple solution!  Read the instructions :) It is written about these buffers and about the hum that occurs in some (there are special switches on the bottom that would remove the hum).  In general, you do not know what to do, read the <a href="https://cloud.mail.ru/public/AC4h/PCmafa38t">instructions</a> !  :) I didn‚Äôt have it in the kit, so I was busy, otherwise I would have read it right away.  And those who yell about the shortcomings just did not read it !!!  :) True, I must admit, the software for Windows for the card is probably so-so, judging by the reviews, I did not see it myself. <br><br>  <b>UPD ‚Ññ5:</b> For Linux users, I‚Äôll additionally inform you that you can configure everything in a clean <a href="http://forum.ubuntu.ru/index.php%3Ftopic%3D12314.msg489397">version</a> and another <a href="http://forum.ubuntu.ru/index.php%3Ftopic%3D12314.msg492800">link</a> .  Since 0404 and 0204 are very similar, most likely the instruction will work in this case, but, I did not check, as I said, laziness is busy with me.  Plus, I am not so special that I can be mistaken, judging by the fact that the load on the processor at my settings varies depending on what the sampling rate of the original audio file, it means that the oversampling of the recording in 192000 does not work and the sound is output in this form to card.  This means that the instructions on the above links and the output through a clean alsa are not so perfect compared to the output using pulseaudio + jackd + alsa.  Imperfect with eyeglasses of ease of adjustment of course.  But, it's up to you.  However, it should be noted that since writing the instructions for these links, alsa has been improved and my device just automatically worked for me, just with clicks.  So, setting up dmix and buffers is probably easy and simple in alsa. <br><br>  <b>UPD number 6:</b> <br>  Found the easiest way to configure all of the above.  It is enough to set the sampling frequency of 88200 and everything plows with the usual pulseaudio.  The frequency is set in the above settings ... unless of course this suits you.  I arranged, the simpler the better. <br><br>  <b>UPD # 7:</b> <br>  In Ubunt 14.04, there are no more problems.  But.  I use sound normalization, maybe that's the thing.  Therefore, I will leave here the method of sound normalization in Pulseaudio: <br>  Install packages with ladspa plugins.  What exactly I do not know, I just put everything on the search, they are small and put in one folder. <br>  Add a few lines to the end of the /etc/pulse/default.pa file <br><br>  1. load-module module-ladspa-sink sink_name = ladspa_output.dysonCompress master = 0 sink_properties = device.description = "Compress" plugin = dyson_compress_1403 label = dysonCompress control = -9.0,1,0,5,0.7 <br>  This line loads the sound normalization module.  Normalization does not allow the sound volume to jump sharply and enrage me as a result :) <br><br>  2. set-default-sink 2 <br>  I have number 2 because I need to turn on the desired sound by default, so that I don‚Äôt do it with my hands. <br><br>  3. set-sink-volume 2 40000 <br>  Adjust the volume to the middle, again so as not to bounce when the first sound in the headphones sounds. <br><br>  As a result, it may therefore, perhaps because the software has grown, there are no jambs in the operation of sound, even without other settings, and normalization is probably not needed, but I am comfortable with it. </div><p>Source: <a href="https://habr.com/ru/post/194588/">https://habr.com/ru/post/194588/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../194576/index.html">About how the government hears society, or public discussion of the "Anti-piracy law"</a></li>
<li><a href="../194580/index.html">Align the horizon in gfranq.com photo service</a></li>
<li><a href="../194582/index.html">CentOS 5.x, 6.x and EJabberd v2.x + Win2008AD</a></li>
<li><a href="../194584/index.html">Updated Google Testing Framework</a></li>
<li><a href="../194586/index.html">Pro IT marketing with a human face</a></li>
<li><a href="../194590/index.html">Impressions from exploring Ultimate ++</a></li>
<li><a href="../194592/index.html">Render a landscape in WebGL</a></li>
<li><a href="../194596/index.html">DARPA is developing a reusable drone to deliver satellites into orbit</a></li>
<li><a href="../194602/index.html">Would you like to spend 70 days in bed? Nasa pays $ 18,000 for total idleness</a></li>
<li><a href="../194604/index.html">Quasar IV: Ninja's ‚ÄúChiffon‚Äù Who Is Too Good to Be True</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>