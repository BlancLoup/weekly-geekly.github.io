<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unit Test Definition</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On our Internet sites you have recently made a serious noise about whether TDD is still alive, whether it is needed, and in what form. It all started ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unit Test Definition</h1><div class="post__text post__text-html js-mediator-article">  On our Internet sites you have recently made a serious noise about whether TDD is still alive, whether it is needed, and in what form.  It all started with David Hanson <a href="http://david.heinemeierhansson.com/2014/tdd-is-dead-long-live-testing.html">‚Äôs</a> article <a href="http://david.heinemeierhansson.com/2014/tdd-is-dead-long-live-testing.html">‚ÄúTDD is dead.</a>  <a href="http://david.heinemeierhansson.com/2014/tdd-is-dead-long-live-testing.html">Long living testing ‚Äù</a> , followed by articles by many authors and lively discussions of this problem, including <a href="http://martinfowler.com/snips/201405071053.html">hangout</a> with David, Kent Beck and Martin Fowler (by the way, the next hangout will be tomorrow, May 16). <br><br>  But few know that a few days before that, all the same Martin Fowler tried to define the unit test ( <a href="http://martinfowler.com/bliki/UnitTest.html">bliki: UnitTest</a> ), the translation of which is presented below.  And after the translation, some of my thoughts are on this. <br><a name="habracut"></a><br>  - <br>  In the world of software development, they often speak of unit tests, and I am familiar with this concept throughout my programming career.  However, like many other terms from the software world, this term is defined very poorly, and I often come across confusion when developers think that it has a stricter definition than it actually is. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/808/32f/129/80832f129728dcca7a6c8909a70e44e4.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And although I very often used unit tests, my final commitment to them arose when I started working with Kent Beck and using the <a href="http://martinfowler.com/bliki/Xunit.html">xUnit</a> family of testing tools.  (It even sometimes seems to me that a more suitable term for this type of testing would be ‚Äúxunit testing‚Äù.) Unit testing also became an important activity in <a href="http://martinfowler.com/bliki/ExtremeProgramming.html">Extreme Programming</a> (XP - Extreme Programming), and quickly developed into <a href="http://martinfowler.com/bliki/TestDrivenDevelopment.html">development through testing</a> (TDD - Test-Driven Development). <br><br>  The role of unit tests in XP from the very beginning caused some concern.  I clearly remember the discussion in the usenet group, in which an expert on testing scolded XP advocates for the misuse of the term ‚Äúunit test‚Äù.  We asked for his definition, to which he replied with something like: ‚Äúat the very beginning of my training course on testing, I consider 24 different definitions of the unit test‚Äù. <br><br>  Despite the differences, in some aspects our points of view converged.  First, there is the notion that unit tests are low-level and concentrate only on a small part of the software system.  Secondly, unit tests today are usually written by developers using their usual tools, to which is added some testing framework (*).  Third, unit tests are expected to be significantly faster than other types of tests. <br>  But there were differences of opinion.  There are different points of view on what is considered a <i>module</i> .  In an object-oriented design, a module is considered to be a class, in a procedural and functional approach a function can be considered a module.  In fact, this is a situational concept: the team decides that it is reasonable to consider a module for understanding the system or testing it.  And although I start with the notion that a class is a module, I often begin to consider a set of closely related classes as a single module.  Less often, I can consider a subset of class methods as a module.  In fact, it does not really matter how you define this concept. <br><br><h5>  Insulation </h5><br>  A more important difference in approach is the question: should the module under test be separated from the interacting objects?  Suppose you are testing an order class calculation method.  The price calculation method calls some methods of the product and customer classes.  If you follow the principle of isolation of interacting objects, you do not want to use real classes of products and customers here, because errors in the customer class will lead to a drop in the tests of the order class.  Instead, you use the fakes ( <a href="http://martinfowler.com/bliki/TestDouble.html">Test Doubles</a> ) of all interacting objects. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e93/885/30a/e9388530a4f4ff988a3e65bb563286b5.png"><br><br>  But not all developers use isolation.  In fact, when xunit testing began in the 90s, we did not try to isolate the class being tested, unless communication with other objects was extremely inconvenient (such as interacting with a remote credit card verification system).  We had no difficulty in understanding the real cause of the failure, even if neighboring tests fell during this.  Therefore, from a practical point of view, we did not consider the lack of isolation a problem. <br>  Although it was the lack of isolation in our definition of ‚Äúmodular test‚Äù that was the reason for its criticism.  I think the definition of ‚Äúunit test‚Äù is appropriate because it tests the behavior of a single module.  We write a test, assuming that everything except this module works correctly. <br><br>  When xunit testing began to gain popularity in the 2000s, the idea of ‚Äã‚Äãisolation returned with a new force, at least for some.  We saw the rise of Mock Objects (Mock Objects) and frameworks to support mocking.  As a result, there are two schools of xunit testers, which <a href="http://martinfowler.com/articles/mocksArentStubs.html">I call the classical school and the school of mokists</a> (mockists).  The adherents of the classical school do not bother with isolation, as do the Mokist.  I know and respect the xunit-testers of both schools (although I myself belong to the classical school). <br><br>  Even representatives of the classical school (including me) in the presence of complex interactions use fakes (test doubles).  Counterfeits are invaluable for eliminating the <a href="http://martinfowler.com/articles/nonDeterminism.html">uncertainty of behavior when working with remote services</a> .  Some representatives of the classical school believe that any interaction with external resources, such as databases or the file system, should use fakes.  Part of this opinion is based on the risk of uncertain behavior, partly on problems with speed.  And although I think this is a useful recommendation, I do not see it as an absolute rule.  If a call to a resource is stable and fast enough for you, then there is no reason why it cannot be used from unit tests. <br><br><h5>  Speed </h5><br>  There are several common properties of unit tests: a small scope (small scope), they are written by developers, and they are quickly executed - which makes it possible to run them often during development.  Indeed, this is one of the key properties of the <a href="http://martinfowler.com/bliki/SelfTestingCode.html">Self-Testing Code</a> .  In this case, the programmer can run unit tests after any change in the code.  I can run unit tests several times a minute, every time I need to compile code.  This is useful, because if I accidentally break something, I want to immediately find out about it.  If I broke something with my recent changes, it is much easier to immediately find this error, since I don‚Äôt have to look for it very far. <br><br>  <b>Translator's note</b> <b><br></b>  Kent Beck developed the idea of ‚Äã‚Äãrunning tests at compilation (and sometimes even without it) and proposed the idea of ‚Äã‚Äãcontinuous testing (Continuous Testing).  Examples of such tools: <a href="http://www.continuoustests.com/">Mighty-Moose</a> and <a href="http://www.ncrunch.net/">NCrunch</a> for .NET, <a href="http://www.junitmax.com/">JUnit Max</a> for Java. <br><br>  When you run tests so often, you cannot run them all.  Usually, you only need to run the tests that work with the code you are currently working on.  In this case, you sacrifice the depth of testing in favor of the test run duration.  I call this test suite the ‚Äúcompile suite‚Äù because I run them every time I compile, even in interpreted languages ‚Äã‚Äãlike Ruby. <br><br>  If you are using Continuous Integration, you must run the tests as one of its steps.  This set of tests, which I call the <b>‚Äú</b> commit suite‚Äù, should include all unit tests.  It may also include some acceptance tests ( <a href="http://martinfowler.com/bliki/BroadStackTest.html">Broad-Stack Tests or End-to-End Tests</a> ).  As a developer, you must run this test suite several times a day, of course, before committing your changes to the version control system, as well as at any other time when you have such an opportunity - during a break or rally.  The faster the set of fixation tests is performed, the more often you can run them (**). <br><br>  Different people have different standards for the speed of execution of unit tests and their sets.  So, for David Hanson ( <a href="http://david.heinemeierhansson.com/2014/slow-database-test-fallacy.html">David Heinemeier Hansson</a> ) it is enough that the compile suite takes a few seconds to complete and the commit suite takes a few minutes.  Harry Bernhardt ( <a href="https://www.destroyallsoftware.com/blog/2014/tdd-straw-men-and-rhetoric">Gary Bernhardt</a> ) thinks it is too slow and insists that the compilation set be executed for about 300 ms, and <a href="http://dan.bodar.com/2012/02/28/crazy-fast-build-times-or-when-10-seconds-starts-to-make-you-nervous/">Dan Bodart</a> does not want to wait for the fix set to be executed for more than a few seconds. <br>  I do not think that there is a single correct answer to this question.  Personally, I did not see the difference when the compilation set is executed in a split second or a couple of seconds.  I like the Kent Beck rule that the commit set should not be executed for longer than 10 minutes.  The main idea here is that your test suite should be executed fast enough so as not to discourage you from running it often enough.  And ‚Äúquite often‚Äù means that when tests find a bug, you will have to dig a small amount of code and find it pretty quickly. <br><br><h5>  Notes </h5><br>  (*) I say "today", because it changed thanks to XP.  In the debates of the beginning of the new century, supporters of XP were subjected to serious criticism, since the generally accepted point of view said that programmers should not test their own code.  In some companies there were specialized ‚Äúunit testers‚Äù whose only task was to write unit tests for the developers code.  The reason for this view was the following: people have ‚Äúconceptual blindness‚Äù when testing their code;  programmers are bad testers, so it is useful to have some form of confrontation between programmers and testers.  The point of view of XP supporters was that programmers can learn to be good testers, at least at the level of a separate ‚Äúmodule‚Äù, and if we bring in an additional group for writing tests, the feedback provided by the tests will be incredibly slow.  XUnit tools played a very important role in this, since they were designed specifically to minimize the overhead of writing tests. <br><br>  (**) If you have useful tests whose execution duration exceeds the duration of the commit tests, you need to build a <a href="http://martinfowler.com/bliki/DeploymentPipeline.html">Deployment Pipeline</a> and place these tests in the later stages of the pipeline. <br><br>  - <br><br>  In this article, Martin deliberately does not address the questions of writing code and tests; instead, he tries only to define the unit test and show the existence of different points of view on the very concept of a module, on the need for isolation and speed of execution. <br><br>  I myself also quite often come across the opinion that the unit test should test the class in complete isolation from the rest of the world.  For example, it is this approach that Robert Martin describes in his book <a href="http://sergeyteplyakov.blogspot.co.uk/2013/04/blog-post.html">Principles, Patterns, and Techniques for Agile Development,</a> and I criticized him in the article <a href="http://sergeyteplyakov.blogspot.co.uk/2013/04/blog-post.html">‚ÄúA Critical Look at the Principle of Inversion of Dependencies‚Äù</a> . <br><br>  In my understanding, there is absolutely nothing wrong with using specific classes in unit tests if their behavior is deterministic and fast.  Separating extra dependencies can undermine class encapsulation and ultimately reduce the ease of understanding and maintaining the system.  Any stable dependencies can and should be used directly, and only <a href="http://sergeyteplyakov.blogspot.co.uk/2012/11/blog-post.html">‚Äúvolatile‚Äù dependencies</a> whose behavior is not deterministic should be distinguished. <br><br>  It turns out that I am a supporter of the classical unit testing school, and I believe that it is necessary to use real classes if they do not turn to non-deterministic external resources.  <b>The problem with the abundance of mocks in my understanding is that the obtained tests become too dependent on the test environment, which makes them fragile, and the abundance of interfaces and indirection worsens the ‚Äúunderstandability‚Äù of the system adding flexibility that is not needed in 99% of cases</b> . <br>  Of course, there are other points of view on the use of mocks.  So, Steve Freeman and Net Price in their book <a href="http://sergeyteplyakov.blogspot.co.uk/2014/04/about-development-testing.html">Growing Object-Oriented Software Guided by Tests</a> have a different point of view.  But at the same time, they very carefully follow the simple tests and do not allow the situation when each line of the test receives 5 lines of initialization of mocks. <br><br>  It is absolutely normal to stick to either of the two camps: the classics or the Mokkists.  The main thing is that your choice is conscious, and your tests simplify development and maintenance, and do not interfere with this. </div><p>Source: <a href="https://habr.com/ru/post/222963/">https://habr.com/ru/post/222963/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../222953/index.html">Experience one engineering investigation</a></li>
<li><a href="../222955/index.html">Brainstorming is not as effective as it seems</a></li>
<li><a href="../222957/index.html">How to speed up the program on Go</a></li>
<li><a href="../222959/index.html">Accurate video model of the evolution of the universe: Illustris (+ model of the birth of the galaxy and the end of the universe)</a></li>
<li><a href="../222961/index.html">Intel¬Æ License Manager Configuration</a></li>
<li><a href="../222965/index.html">What is wrong with the Habrahabr design</a></li>
<li><a href="../222967/index.html">The first Omsk geo-hakaton</a></li>
<li><a href="../222969/index.html">Say a word about poor junior</a></li>
<li><a href="../222975/index.html">Experience of transferring a virtual machine from someone else‚Äôs XEN hosting to your KVM</a></li>
<li><a href="../222977/index.html">Creating reports about testing Android applications using Spoon and Emma</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>