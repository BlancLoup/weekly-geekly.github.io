<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Inperfo - minimal network monitoring</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="First of all, Inperfo is intended for monitoring network interfaces on switches and routers. Of course, you can monitor network interfaces directly on...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Inperfo - minimal network monitoring</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://www.inperfo.ru/images/top.png" alt="image"></p><br><p>  First of all, <a href="https://www.inperfo.ru/">Inperfo is</a> intended for monitoring network interfaces on switches and routers.  Of course, you can monitor network interfaces directly on servers, for example, when you do not have access to network equipment, but there are dozens or hundreds of leased servers (physical or virtual). </p><a name="habracut"></a><br><p>  The service is designed to monitor <strong>physical</strong> Ethernet interfaces.  Which, by the way, allows you to see the traffic imbalances in the Port Channels when configured incorrectly or some other problems.  If you have other tasks, and you need to monitor other types of interfaces, then look towards Observium and fellows (LibreNMS, NetXMS, etc) or on SolarWind NPM. </p><br><p>  The main purpose of creating the service was to see the top-ups on loading interfaces, errors, so that all problematic or potentially problematic places were in full view.  In zabbix or cacti, to make such a dynamic screen, to put it mildly, is problematic.  In addition, I wanted to have a top history in a week, not the current moment - a week, the best option for many networks, when the load increases after the weekend and decreases by the end of the week, or vice versa - at the weekend peaks, and weekdays load is lower. </p><br><p>  And the second no less important goal is a minimalistic interface without unnecessary frills, complexities and finishes.  Come and enjoy not everyone, yes. </p><br><h4 id="servis-reshaet-3-zadachi">  <strong>Service solves 3 problems</strong> </h4><br><ol><li>  Shows network bottlenecks.  This may be overloaded at the peak of the uplink access switch at the distribution level.  Or overloaded port to backup or memcached-server.  You can individually assign interfaces as internal or external uplinks to view them in a separate top.  All graphs are based on maximums - weekly, monthly and annual graphs are not averaged. </li><li>  It shows errors on interfaces, for convenience, grouping data by hosts and data centers, displaying top errors from all devices.  Oshbiki in the table of hosts and interfaces - the amount per week, on the graphs - errors per second. </li><li>  It keeps track of the number of free and busy ports on the switches, which helps in time to solve the problems of network expansion. </li></ol><br><p>  And of course, automatically tracks changes - renaming interfaces, descriptions (ifDescr), changing the status of the interface, and so on.  The only manual work is adding new devices or servers to the agent's config.  In time, auto discovery will be added, but not yet. </p><br><p>  Inperfo is definitely not suitable for you if you need: </p><br><p>  - CPU / Memory monitoring <br>  - Monitoring hdd, temperature and other non-ethernet things <br>  - Ability to draw maps and network diagrams </p><br><h2 id="komponenty-sistemy">  <strong>System components</strong> </h2><br><p>  The service consists of two components: a server and an agent.  The agent collects snmp-data about the interfaces and sends them to the server.  The server processes (sorts, updates rrd-files and other) the received data and displays it via the web-interface. </p><br><h4 id="kak-rabotaet-server">  <strong>How the server works</strong> </h4><br><p>  The server is a docker-container with a "standard" set of software: nginx / php-fpm / memcached / mysql / rrdtool.  The server expects agents to send data every 5 minutes.  The data is stored in the database - according to the load of the interfaces and errors, a weekly history is maintained, according to which the 95th percentile and the top by max / avg are calculated.  This is done in order to "see" the network in different "cuts" - without rare bursts, or vice versa, when you only need to look at the bursts. </p><br><p>  Container data is stored on the host system for ease of updating, backup and transfer of the server to other hosts.  You can upgrade with just one command (idea taken from the docker, see <a href="https://get.docker.com/">https://get.docker.com</a> ) </p><br><h4 id="kak-rabotaet-agent">  <strong>How the agent works</strong> </h4><br><p>  The agent is also a docker-container in which, every 5 minutes a crown launches an agent that collects snmp-data about interfaces from network devices or servers.  So far, the update interval (polling) devices can not be changed. </p><br><p>  The client supports two versions of SNMP - v2 and v3. </p><br><p>  Agent configuration, logs, and data sent is stored on the host system.  This allows you to easily edit configs, transfer the agent to other hosts if necessary. </p><br><h2 id="scenarii-ispolzovaniya">  <strong>Usage scenarios</strong> </h2><br><h4 id="monitorim-setevoe-oborudovanie-">  <strong>Monitor network equipment</strong> </h4><br><p>  Ideally, we need to <a href="https://www.inperfo.ru/install/">install</a> and configure one agent for each of the data centers or remote offices so that the agent can locally poll devices inside the data center via snmp and send the collected data to a central server, which can be located in one of the data centers or anywhere in cloud (Amazon, DigitalOcean, Azure, etc). </p><br><p>  If you have one data center or have ‚Äúfast‚Äù links to other DCs, then it is enough to install the server and agent on the same linux machine, from which all network devices will be polled.  Or, for example, on the same machine where you already have cacti - you will not need to configure snmp-access on network equipment (if you have one :) </p><br><p>  The main "minus" of this scheme: you need snmp-access to network equipment. </p><br><h4 id="monitorim-setevye-interfeysy-na-serverah">  <strong>Monitor network interfaces on servers</strong> </h4><br><p>  To monitor network interfaces on servers, we need to install a snmp daemon on each of them, for example, via an <a href="https://github.com/inperfo/ansible-snmpd/">ansible-playbook</a> .  In this case, each linux server for the agent will look like a separate network device with one or more network connections. </p><br><p>  Pros: </p><br><ul><li>  You can do without access to network equipment </li><li><p>  We can quite easily automate the installation and setup of monitoring. <br>  Minuses: </p><br></li><li>  No capacity by ports (if needed) </li><li>  Manual addition of new servers to the agent's configuration will be required. </li></ul><br><h4 id="smeshanyy-rezhim">  <strong>Mixed mode</strong> </h4><br><p>  Everything is clear here, you can monitor both switches / routers and servers together - the agent does not distinguish the type of device, and takes information on the interfaces from the MIBv2-base.  By the way, this is another drawback - if you have a device that has information on interfaces given from "non-standard" MIBs (for example, BTI 7000), then Inperfo, at the moment, will not work for you. </p><br><h3 id="proizvoditelnost">  <strong>Performance</strong> </h3><br><p>  He feels good on the "middle" hardware (16CPU / 16GB) up to 100 devices (6000+ ports), and for a large number of days, there was no way to start and watch the work.  But since the agent for polling each device creates a separate process (fork), the golang with go-routines simply languishes and asks for this piece of code.  Similarly, the server works when receiving data. </p><br><h3 id="chto-dobavitsya-v-sleduyuschih-versiyah">  <strong>What will be added in the next versions</strong> </h3><br><p>  - Specify the maximum speed for the interface.  It is necessary in situations when you are connected to the provider via a 1GB link, but the paid channel is actually less, ala is limited to 500MB. <br>  - Weekly reports on tops by mail. <br>  - Notifications by mail. <br>  - Separate build docker-container with the server and agent.  For smaller networks, this is ideal.  Plus, it will be possible to add hosts via the web interface. <br>  - Tops / graphics by packs <br>  - Search by device name, by interface, by description and by alias <br>  - Rewrite the agent and part of the server on golang. </p><br><p>  At the moment the service does not send any alerts and other things, but by URI <a href="https://demo.inperfo.com/export/">/ export /</a> you can import data into the same zabbiks, and receive notifications.  The service is still a little damp, but it solves the tasks. </p><br><p>  <a href="https://www.inperfo.ru/install/">Install</a> &amp; enjoy. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/330188/">https://habr.com/ru/post/330188/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330176/index.html">When 2 + 2 = "4"</a></li>
<li><a href="../330178/index.html">‚ÄúSnooze a little bit‚Äù: check list for a short break for sleep</a></li>
<li><a href="../330180/index.html">Dell EMC Cloud for Microsoft Azure key features</a></li>
<li><a href="../330182/index.html">Pygest # 10. Releases, articles, interesting projects from the world of Python [May 23, 2017 - June 5, 2017]</a></li>
<li><a href="../330186/index.html">The digest of interesting materials for the mobile developer # 206 (May 29 - June 4)</a></li>
<li><a href="../330190/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ265 (May 29 - June 4, 2017)</a></li>
<li><a href="../330194/index.html">A review of research in the field of deep learning: natural language processing</a></li>
<li><a href="../330196/index.html">Concepts: set, type, attribute</a></li>
<li><a href="../330198/index.html">Useful utilities when working with Kubernetes</a></li>
<li><a href="../330204/index.html">Preventing Negative Impacts when Developing Artificial Intelligence Systems Beating the Human Mind</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>