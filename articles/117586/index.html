<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Anonymous networks and timing attacks: Tarzan and MorphMix</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction | Tor | Tarzan and MorphMix | Low-cost attack | Low-cost attack on Tarzan and Morphmix | Principles of building secure systems (conclusio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Anonymous networks and timing attacks: Tarzan and MorphMix</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/blogs/infosecurity/112860/">Introduction</a> |  <a href="http://habrahabr.ru/blogs/infosecurity/114974/">Tor</a> |  Tarzan and MorphMix |  <a href="http://habrahabr.ru/blogs/infosecurity/121078/">Low-cost attack</a> |  <a href="http://habrahabr.ru/blogs/infosecurity/121209/">Low-cost attack on Tarzan and Morphmix</a> |  <a href="http://habrahabr.ru/blogs/infosecurity/121210/">Principles of building secure systems (conclusion)</a> <br><br><h2>  Tarzan </h2><br>  Tarzan is another low latency anonymizing system.  It is also based on the ideas of Chaum and, like others, was created to ensure anonymity when using web applications and instant messengers.  Unlike Tor, Tarzan is based on peer-to-peer architecture.  Each Tarzan-node can be both a client and a transfer node.  This eliminates the timing of the analysis of traffic between the input and output nodes.  After all, at any moment, anyone can join or leave the network, and any node can be a potential flow initiator (client).  A protocol based on the gossip mechanism (similar to that described in the work (Harchol-Balter, Leighton &amp; Lewin 1999)) is used to disseminate information about the nodes available in the network.  Due to the peer-to-peer architecture, an attacker can pose as many Tarzan nodes as he wants.  Therefore, Tarzan has a mechanism for reducing the likelihood of choosing a malicious node.  The mechanism involves categorizing nodes based on the hashes of their IP addresses. <br><a name="habracut"></a><br>  The final recipient of an anonymous stream does not have to be a Tarzan node - access to the outside world is carried out using PNAT (see below).  Tarzan authors argue that their network is able to withstand a global observer.  This is achieved through a variety of covering traffic, which is called ‚Äúmimic traffic‚Äù.  To ensure that the fake traffic does not overload the network, each Tarzan node establishes a fake connection with only a few other nodes. <br><br>  Here's how it works: when a node connects to the network, after receiving a list of all other Tarzan nodes, it selects some of them to simulate traffic (generates a list of simulators).  One of these selected nodes will be used later, when an anonymous connection is required, as the next transfer node. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For example, Tarzan <i>a</i> wants to establish an anonymous connection with the <i>srv</i> web server.  At the same time, node <i>a</i> wants the length of the tunnel to be <i>l</i> + 1, where <i>l</i> is the number of nodes in the tunnel.  Then <i>a</i> performs the following actions: <br><ol><li>  <em>a</em> selects the first transmission node <em>n1</em> from among its simulators <br></li><li>  <em>a</em> asks <em>n1 for a</em> list of its simulators <em>l <sub>n1</sub></em> <br></li><li>  <em>a</em> selects the second transmission node <em>n2</em> from the list <em>l <sub>n1</sub></em> <br></li><li>  <em>a</em> asks <em>n2 for a</em> list of its simulators <em>l <sub>n2</sub></em> .  The request goes through <em>n1</em> , while <em>n1</em> does not know what exactly it sends. <br></li><li>  <em>a</em> selects the third transmission node <em>n3</em> from the list <em>l <sub>n2</sub></em> <br></li><li>  Thus, <em>a</em> tunnel grows until it has <em>l</em> nodes. <br></li><li>  In the end, <em>a</em> randomly selects the last node from among all the nodes in the network.  This last node in Tor is called the exit node, and in Tarzan - <em>PNAT</em> . </li></ol><br>  This results in the following way: <em>a</em> -&gt; <em>n1</em> -&gt; <em>n2</em> -&gt; ... -&gt; <em>nl</em> -&gt; <em>PNAT</em> -&gt; <em>svr</em> <br>  It is important that <em>PNAT</em> is selected from all nodes, and not just from among the <em>nl</em> node simulators.  Figure 2 shows the Tarzan network and the tunnel created.  In the example, each Tarzan node has 6 simulators. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4e3/902/a81/4e3902a81bfff399a3475c1db699eec5.png" alt="Tarzan"><br>  Figure 2. Tarzan architecture based on simulators <br><br><h2>  MorphMix <sup>*</sup> </h2><br>  MorphMix (Rennhard &amp; Plattner 2002, Rennhard &amp; Plattner 2004) is another system for anonymous communication with low latency.  MorphMix follows peer-to-peer architecture.  Like Tor, MorphMix uses chains of fixed-length transmission nodes and layer-by-layer encryption (each node can only deploy its own layer).  As in Tor, there is no cover traffic in MorphMix - it is considered that it is ineffective. <br><br>  MorphMix developers use the following terminology: <br>  chain of transmission nodes - <em>anonymous tunnel</em> ( <em>anonymous tunnel</em> ) <br>  the first node is the <em>initiator</em> <br>  the last node is the <em>last node</em> <br>  the nodes between the first and the last node are <em>intermediate nodes</em> <br><br>  Unlike Tor and Tarzan, where the initiator assigns nodes for the organization of the tunnel, in MorphMix each intermediate node chooses its own successor.  To confirm that the choice of the next node is honestly provided for the mechanism of witnesses.  Any node can be a witness. <br><br>  When the initiator node <em>a</em> wants to create an anonymous tunnel, it selects the first intermediate node <em>b</em> and the witness <em>w</em> from its list of neighbors.  Witness <em>w</em> acts as a third trusted party in the process of choosing the next tunnel node after <em>b</em> - let's call it <em>c</em> .  <em>w</em> allows initiator <em>a to</em> establish a common key with node <em>c</em> through <em>b</em> , without revealing key material to node <em>b</em> . <br><br>  Figure 3 (from Rennhard &amp; Plattner 2002) shows how the process of selecting the next tunnel node with the help of a witness takes place in MorphMix.  It is assumed that the connection between <i>a</i> and <i>b is</i> already established. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/089/8e4/25e/0898e425eccc1f60a2c3a22263d4149a.png" alt="Morphmix"><br>  Figure 3. The process of selecting the next (after <i>b</i> ) tunnel node in MorphMix. <br><br>  1. <em>a</em> selects a witness <em>w</em> from among the nodes known to him.  It then generates half of the key information <em>DH <sub>a</sub></em> , adds to it the value of the current time ( <em>nonce <sub>1</sub></em> ) and encrypts all this with the public key <em>w</em> - <em>{nonce <sub>1</sub> , DH <sub>a</sub> } <sub>PuKw</sub></em> .  Note that the indication of the current time <em>nonce <sub>1 is</sub></em> used to prevent <em>replay</em> <em>attacks</em> .  <em>s</em> - indicates <em>b</em> how many nodes it should select (from these nodes the next node for the tunnel will be selected).  <em>b</em> does not receive any information about key information <em>DH <sub>a</sub></em> , because  it is encrypted in the public key <em>w</em> . <br><br>  2. After <em>b</em> received the message, he forwards <em>DH <sub>a</sub></em> (as part of an encrypted message <em>{nonce <sub>1</sub> , DH <sub>a</sub> } <sub>PuKw</sub></em> ) to witness <em>w</em> along with the selected nodes and their public keys ( <em>{ip <sub>c</sub> , PuK <sub>c</sub> , ip <sub>d</sub> , PuK <sub>d</sub> , ip <sub>e</sub> , PuK <sub>e</sub> }</em> ). <br><br>  3. <em>w</em> performs two actions.  First, it decrypts <em>{nonce <sub>1</sub> , DH <sub>a</sub> } <sub>PuKw</sub></em> to get <em>DH <sub>a</sub></em> .  Then <em>w</em> randomly selects the next tunnel node <em>c</em> .  Next, <em>w</em> sends <em>DH <sub>a</sub></em> and information about node <em>b</em> and its public key <em>{ip <sub>b</sub> , PuK <sub>b</sub> } to</em> node <em>c</em> . <br><br>  4. If he agrees to become the next node of the tunnel, he sends <em>w the</em> message ‚ÄúOk‚Äù. <br><br>  5. <em>w</em> signs the list of selected <em>b</em> node along with <em>nonce <sub>1</sub></em> , with the selected node <em>c</em> indicated first after <em>nonce <sub>1</sub></em> .  And sends <em>b</em> . <br><br>  6. <em>b</em> receives the message from <em>w</em> .  He learns that the next node in the tunnel should be <em>with</em> .  It generates the <em>id of the</em> anonymous connection between <em>b</em> and <em>c</em> .  Then it sends the <em>id</em> and the new value of the current time <em>nonce <sub>2 to the</sub></em> node <em>c</em> . <br><br>  7. In response, <em>c</em> generates and sends <em>b</em> its half of the key information <em>DH <sub>with</sub></em> along with the indication of <em>id</em> . <br><br>  8. <em>b</em> sends <em>a</em> <em>DH <sub>with</sub></em> and a list of selected nodes signed by the witness <em>w</em> . <br><br>  In MorphMix, nodes do not have to know about all other nodes in the network. <br><br><hr><br>  <b>Translator Notes</b> <br><br>  <sup>*</sup> When translating, we encountered some inconsistencies in the description of the work of MorphMix.  We tried to level them with the help of a non-literal free translation, which gives a sufficient idea of ‚Äã‚Äãthe work of the network in this context, but cannot claim to be 100% accurate.  Therefore, if you need accurate information on how MorphMix works, refer to the relevant documents. </div><p>Source: <a href="https://habr.com/ru/post/117586/">https://habr.com/ru/post/117586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../117574/index.html">Create an application for Windows Phone 7 from start to finish. Part 4. Creating a new project, adding pages</a></li>
<li><a href="../117580/index.html">New feature in Google Analytics - multichannel sequences</a></li>
<li><a href="../117581/index.html">Milaba and Ogol</a></li>
<li><a href="../117583/index.html">Lingvo Cup will start next week.</a></li>
<li><a href="../117585/index.html">Russian nanotechnology in cardboard and pink color</a></li>
<li><a href="../117587/index.html">GitHub Reflog v1.4.12</a></li>
<li><a href="../117588/index.html">Invert page only by CSS</a></li>
<li><a href="../117589/index.html">How to maintain health while working at the computer?</a></li>
<li><a href="../117593/index.html">Packaging .NET applications for N900 on the example of Bless</a></li>
<li><a href="../117596/index.html">Such an elementary C / C ++: can-> is</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>