<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Content experiments in Google Analytics for the entire site at the same time</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most of us have a time when we need to run an experiment in Google Analytics in order to understand what works in the best way for our site. Perhaps, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Content experiments in Google Analytics for the entire site at the same time</h1><div class="post__text post__text-html js-mediator-article">  Most of us have a time when we need to run an <a href="https://support.google.com/analytics/answer/1745147%3Fhl%3Dru">experiment</a> in Google Analytics in order to understand what works in the best way for our site.  Perhaps, when it comes to content experiments, we often hear about the landing pages and the optimization of their elements (buttons, calls to action, and so on). <br><br>  How do we do it?  We simply take a piece of JavaScript code that Google Analytics kindly generates for us, and add our site‚Äôs tag to &lt;head&gt; &lt;/ head&gt;.  This code simply redirects a part of users to an alternative (tested) page, adding a certain parameter to the URL of this page.  This parameter allows Google Analytics to understand which of the users saw the original page and which alternative saw the original.  We all know that.  It is very simple. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/877/f92/57b/877f9257b68024c23a965a8ed4da2771.png" alt="image"></div><br>  And our disgusting parameter: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8de/5d6/e96/8de5d6e96de7f5bb7e48071806f7bed7.png" alt="image"></div><br>  Have you ever thought about how to conduct such experiments if we need to test an element that is present on other pages of the site? <br><br>  Let's imagine that you need to test the main menu of the site (its color, the number of elements in it, and so on).  We could create an alternative page with a new version of the menu and send a part of users there.  But what will the users who were sent to the alternative page see, and then they decide to go somewhere else?  They will still see the original menu.  Juggling the menu this way is not a very good tone and can only confuse. <br><a name="habracut"></a><br>  Here is a user trying to visit our site during an experiment: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/788/b18/7a1/788b187a1f29d137eaebe42d87f4a284.png" alt="image"></div><br>  ... and immediately redirected to an alternative version with a new menu: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/522/2fe/d7b/5222fed7bf74882932a5730e172815fa.png" alt="image"></div><br>  Then, the user decides to go to another section of the site, where he still sees the original menu: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/30e/3a7/1d0/30e3a71d06e4db29d6de0c66e7ea1404.png" alt="image"></div><br>  Fortunately, we have a way to avoid such incidents. <br><br><h2>  A few words about content experiments without redirects </h2><br>  If you are a seasoned Google Analytics expert with some technical skills, you may already be aware, through official documentation, of so-called <a href="https://developers.google.com/analytics/solutions/experiments-client-side">experiments without redirects</a> .  They allow us to test different elements on a page without having to redirect users to another page.  This "trick" can be performed with at least basic knowledge of Javascript and HTML.  This is the most elegant way to conduct such experiments. <br><br>  I recommend at least a superficial run through the <a href="https://developers.google.com/analytics/solutions/experiments-client-side">material</a> on this topic before we continue, but if you are not in the mood, I will try to briefly describe everything below. <br><br>  So, you set up an experiment through the Google Analytics interface, but instead of real pages on your site, you specify ‚Äúdummies‚Äù (since we will not have pages where the user will be redirected).  We definitely need to specify these dummies - GA will collect and assign data to these variations, as usual. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/846/603/83d/84660383da01852fdc42f394873deb2d.png" alt="image"></div><br>  Then, from the experiment settings, you copy the <b>Experiment Key</b> and use it to load the experiment library: <br><br><pre><code class="javascript hljs">&lt;script src=<span class="hljs-string"><span class="hljs-string">"//www.google-analytics.com/cx/api.js?experiment=YOUR_EXPERIMENT_ID"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Immediately under this load, you insert a small code that allows you to assign users to a specific experiment group: <br><br><pre> <code class="javascript hljs">&lt;script&gt; cxApi.setDomainName(<span class="hljs-string"><span class="hljs-string">'.sendpulse.com'</span></span>); cxApi.setCookiePath(<span class="hljs-string"><span class="hljs-string">'/'</span></span>); cxApi.chooseVariation(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> experiment_group = cxApi.getChosenVariation(); <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br>  When a user is assigned to a specific group, this information is stored in the experiment cookie and then it always shows one version of the element (regardless of the page).  Information about which group the user has been assigned to is sent to Google Analytics in a standard way, during a call to the server along with the <b>pageview</b> (page view). <br><br><h2>  What are the advantages of experiments without redirects </h2><br><ol><li>  You avoid vile redirects and nasty parameters in your URLs </li><li>  Such experiments have a better effect on page loading speed. </li><li>  This method allows you to experiment not on the same page, but on the entire site at the same time. </li></ol><br><h2>  What are the advantages of the experiment on the entire site at the same time? </h2><br><ol><li>  The ability to test items that are displayed on all pages of the site, while maintaining their consistency for one user </li><li>  The ability to collect data for the conclusions of the experiment is much faster, since we will experiment based on the <b>traffic of the entire site</b> , rather than individual pages </li></ol><br><h2>  Detailed step-by-step explanation of experiments on the entire site at the same time </h2><br>  All you need to do in order to conduct an experiment on the entire site is to add an experiment code without redirecting to all pages of the site.  Logical, isn't it? <br><br>  Usually, this is done by inserting the code into the site‚Äôs header template.  This code is absolutely indifferent on which page it is located - all it needs is to assign the user to a specific group and send data about this group to Google Analytics.  When a user first visits the site and sees one of the versions of the element under test, this information is stored in the cookie, and during all subsequent ‚Äúcontacts‚Äù with the element under test on any of the pages of the site, he will always see the version that he saw before. <br><br>  Let's go back to the machine, and I'll show you the practical application of this approach. <br><br><h2>  Configuring the experiment </h2><br>  We need to test the different colors of the registration button on our website (green, red, yellow).  The button is displayed at the very top of the site on all its pages.  Consequently, we should take care that the user sees the same button color everywhere and always.  The experiment criterion is clicking on the registration button. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a93/475/69a/a9347569af2a14111b68125f92e0bc86.png" alt="image"></div><br><h3>  Settings in the interface </h3><br>  So, create an experiment in Google Analytics. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/88f/8a8/7c2/88f8a87c28a51246656f535e36fd7efd.png" alt="image"></div><br>  As you can see, we indicated the addresses of non-existent pages, because GA obliges us to do this.  But do not worry - although these settings will not pass the verification, the experiment will work fine and fulfill its role. <br><br>  Do not forget to copy Experiment ID - we need it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8be/594/00a/8be59400a1dbcbef2ff061fd9ea5d7b1.png" alt="image"></div><br><h3>  Editing the source code of the site </h3><br>  Let's load the experiment library using our Experiment ID, and then call several functions of this library that will assign the user to the experiment group: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/144/c42/1bf/144c421bf8b5014ee27f90bc4430251e.png" alt="image"></div><br>  Now, add some logic code that will change the color of the button depending on the group to which the user has been assigned. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/42c/22c/b4d/42c22cb4d0ca1f6600a109f68b973915.png" alt="image"></div><br>  This code only changes the CSS class of the button, depending on the experiment group to which the user is assigned.  Naturally, you need to create two additional classes for the button. <br><br>  The most important thing you need to remember is that all the code should be added to the header template of your site so <b>that they are present on all pages</b> (within the &lt;head&gt; &lt;/ head&gt; tags, as is the case with the standard experiment code). <br><br>  Now the user who participates in the experiment will always see a button of the same color. <br><br>  Click "Start" in the experiment settings.  Remember, feel free to ignore the validation error messages (but make sure that you did everything correctly). <br><br>  That's all.  Have fun experimenting! </div><p>Source: <a href="https://habr.com/ru/post/313792/">https://habr.com/ru/post/313792/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../313782/index.html">Network security technologies at OSI level 2. Part 1</a></li>
<li><a href="../313784/index.html">The rules of bad and good tone in programming - expert opinions</a></li>
<li><a href="../313786/index.html">The minimum Hello Word limit on AVR is 0 bits.</a></li>
<li><a href="../313788/index.html">Collect cats in Android 7 Nougat (not only)</a></li>
<li><a href="../313790/index.html">Donald Knut: When will the fourth volume finally come out?</a></li>
<li><a href="../313794/index.html">Remotely turn on the computer for free, without SMS and without clouds, using Mikrotik</a></li>
<li><a href="../313796/index.html">Understanding SOLID: Inversion of Dependencies</a></li>
<li><a href="../313798/index.html">Paul Graham: how to cope with patent shackles without a state</a></li>
<li><a href="../313800/index.html">A simple way to understand digital trends and not go broke</a></li>
<li><a href="../313802/index.html">Multi-factor authentication in the data center - what should it be?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>