<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Applications for receiving digital broadcasting by means of DirectShow</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The application is written under Windows7, DirectX 9, tuner model - AverTV Duo Hybrid PCI-E2, C # language 

 Microsoft TV Technologies Internals . Th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Applications for receiving digital broadcasting by means of DirectShow</h1><div class="post__text post__text-html js-mediator-article">  The application is written under Windows7, DirectX 9, tuner model - AverTV Duo Hybrid PCI-E2, C # language <br><br>  <a href="http://msdn.microsoft.com/en-us/library/dd695085%2528v%3DVS.85%2529.aspx">Microsoft TV Technologies Internals</a> .  This article describes a graph for receiving digital TV broadcasting, as well as filters that are used when constructing a graph. <br><br>  To create an application you need: <br>  <u>1. Build a graph.</u> <br>  In my column I use the following filters: <br>  ‚Ä¢ Microsoft DVB-T Network Provider <br>  ‚Ä¢ AVerMedia 716x BDA DVBT Tuner (depending on your Tuner model) <br>  ‚Ä¢ AVerMedia 716x BDA Digital Capture (depending on your Tuner model) <br>  ‚Ä¢ MPEG2 Demultiplexer <br>  ‚Ä¢ BDA MPEG2 Transport Information Filter <br>  ‚Ä¢ MPEG-2 Sections and Tables <br>  ‚Ä¢ Microsoft DTV-DVD Video Decoder <br>  ‚Ä¢ Video Mixing Renderer 9 <br><a name="habracut"></a><br>  <u>2. Configure Network Provider:</u> <br>  Provider settings include creating an instance of the DVBTuningSpace class, setting up this object in accordance with the DVB-T standard.  Through an instance of the DVBTuningSpace class, a TuneRequest object is created, which must be transferred to the provider. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <u>3. Adjust the locator to the desired frequency.</u> <br>  Locator is an instance of the DVBTLocator class, which is used to set <br>  carrier frequency.  (Some tuners are able to independently scan frequencies and if you set the wrong carrier frequency, the graph will receive and display the channels). <br>  Now let's deal with each filter separately: <br>  1. BDA Network Provider is a filter source for graphs working with digital television.  There are several filters in this category: <br>  o For DVB-S (Satellite TV) standard: Microsoft DVB-S Network Provider <br>  o For DVB-T (Terrestrial TV) standard: Microsoft DVB-T Network Provider <br>  o For DVB-C (Cable TV) standard: Microsoft DVB-C Network Provider <br>  o For ATSC (American Standard Digital TV) standard: Microsoft ATSC Network Provider <br>  In our case, we use the filter Microsoft DVB-T Network Provider <br><br>  To obtain the channels corresponding to the carrier frequency, the MPEG-2 Sections and Tables filter is used.  Through it, you can get the PAT table, which contains the SIDs of the available channels. <br>  The IDVBTuneRequest interface is used to display a specific channel. Using the put_SID method, you can transfer the SID of the channel you need. <br>  <b>Note:</b> After updating the provider, for example, setting a new frequency, it is necessary to start the graph, if it is not already running.  If the graph is stopped, then when you try to get data from the filters, for example, getting the PAT table from the MPEG-2 Sections and Tables filter, you will get a result inconsistent with the new provider settings. <br><br>  <u>DVB-T graph in GraphEditPlus:</u> <br><img src="http://content.foto.mail.ru/mail/a_golovinskaya/_mypagephoto/i-8.jpg" alt="image"><br><br>  Add filters to graph: <br><br><pre><code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> add filters methods int IGraphDVBT.AddNetworkProvider() { pNetworkProvider = (IBaseFilter)Activator.CreateInstance(Type.GetTypeFromCLSID(typeof(DVBTNetworkProvider).GUID)); return pGraph.AddFilter(pNetworkProvider, "Network Provider"); } int IGraphDVBT.AddTuner() { pDVBTTuner = DirectShowTools.CreateFilter(FilterCategory.BDASourceFiltersCategory, "AVerMedia 716x BDA DVBT Tuner"); return pGraph.AddFilter(pDVBTTuner, "DVBT Tuner"); } int IGraphDVBT.AddCapture() { pDigitalCapture = DirectShowTools.CreateFilter(FilterCategory.BDAReceiverComponentsCategory, "AVerMedia 716x BDA Digital Capture"); return pGraph.AddFilter(pDigitalCapture, "Digital Capture"); } int IGraphDVBT.AddMPEG2Demultiplexer() { pMPEGDemux = (IBaseFilter)new MPEG2Demultiplexer(); return pGraph.AddFilter(pMPEGDemux, "MPEG2 Demultiplexer"); } int IGraphDVBT.AddBDAMPEG2TIF() { pBDAMPEGTIF = DirectShowTools.CreateFilter(FilterCategory.LegacyAmFilterCategory, "BDA MPEG2 Transport Information Filter"); return pGraph.AddFilter(pBDAMPEGTIF, "BDA MPEG2 TIF"); } int IGraphDVBT.AddMPEG2SectAndTables() { pMPEGSectAndTables = DirectShowTools.CreateFilter(FilterCategory.LegacyAmFilterCategory, "MPEG-2 Sections and Tables"); return pGraph.AddFilter(pMPEGSectAndTables, "MPEG2 Section and Tables"); } int IGraphDVBT.AddVideoDecoder() { pVideoDecoder = DirectShowTools.CreateFilter(FilterCategory.LegacyAmFilterCategory, "Microsoft DTV-DVD Video Decoder"); return pGraph.AddFilter(pVideoDecoder, "DTV-DVD Video Decode"); } int IGraphDVBT.AddVideoRenderer() { pVideoRenderer = (IBaseFilter)new VideoMixingRenderer9(); return pGraph.AddFilter(pVideoRenderer, "Video Renderer"); } int IGraphDVBT.AddAudioDecoder() { pAudioDecoder = DirectShowTools.CreateFilter(FilterCategory.LegacyAmFilterCategory, "Microsoft DTV-DVD Audio Decoder"); return pGraph.AddFilter(pAudioDecoder, "DTV-DVD Audio Decode"); } int IGraphDVBT.AddAudioRenderer() { pAudioRenderer = DirectShowTools.CreateFilter(FilterCategory.AudioRendererCategory, "Default DirectSound Device"); return pGraph.AddFilter(pAudioRenderer, "Audio Renderer"); } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span></span></code> </pre> <br><hr><br><br>  The filter <u>pins</u> must be interconnected <u>(Note that the pin names in your case may be completely different)</u> : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> IGraphDVBT.ConnectFilters() { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> hr; IPin outPin; IPin inPin; outPin = DirectShowTools.FindPin(pNetworkProvider, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"Antenna Out"</span></span> }); inPin = DirectShowTools.FindPin(pDVBTTuner, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"0"</span></span> }); hr = pGraph.Connect(outPin, inPin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; outPin = DirectShowTools.FindPin(pDVBTTuner, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"1"</span></span> }); inPin = DirectShowTools.FindPin(pDigitalCapture, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"0"</span></span> }); hr = pGraph.Connect(outPin, inPin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; outPin = DirectShowTools.FindPin(pDigitalCapture, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"1"</span></span> }); inPin = DirectShowTools.FindPin(pMPEGDemux, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"MPEG-2 Stream"</span></span> }); hr = pGraph.Connect(outPin, inPin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; outPin = DirectShowTools.FindPin(pMPEGDemux, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"001"</span></span> }); inPin = DirectShowTools.FindPin(pBDAMPEGTIF, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"IB Input"</span></span> }); hr = pGraph.Connect(outPin, inPin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; outPin = DirectShowTools.FindPin(pMPEGDemux, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"002"</span></span> }); inPin = DirectShowTools.FindPin(pMPEGSectAndTables, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"In"</span></span> }); hr = pGraph.Connect(outPin, inPin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; outPin = DirectShowTools.FindPin(pMPEGDemux, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"003"</span></span> }); inPin = DirectShowTools.FindPin(pVideoDecoder, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"Video Input"</span></span> }); hr = pGraph.Connect(outPin, inPin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; outPin = DirectShowTools.FindPin(pMPEGDemux, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"007"</span></span> }); inPin = DirectShowTools.FindPin(pAudioDecoder, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"In"</span></span> }); hr = pGraph.Connect(outPin, inPin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; outPin = DirectShowTools.FindPin(pVideoDecoder, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"Video Output 1"</span></span> }); inPin = DirectShowTools.FindPin(pVideoRenderer, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"VMR Input0"</span></span> }); hr = pGraph.Connect(outPin, inPin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; outPin = DirectShowTools.FindPin(pAudioDecoder, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"Out"</span></span> }); inPin = DirectShowTools.FindPin(pAudioRenderer, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"Audio Input pin (rendered)"</span></span> }); hr = pGraph.Connect(outPin, inPin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><br><hr><br><br>  Now we are setting up DVB-T Network Provider.  To do this, you must specify the appropriate DVB-T types for an instance of the DVBTuningSpace class.  By the method put_TuneRequest we activate the configured object in the provider. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> IGraphDVBT.SetNetworkProvider() { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> hr; IDVBTuningSpace tuningSpace = (IDVBTuningSpace)<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DVBTuningSpace(); hr = tuningSpace.put_UniqueName(<span class="hljs-string"><span class="hljs-string">"DVBT TuningSpace"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; hr = tuningSpace.put_FriendlyName(<span class="hljs-string"><span class="hljs-string">"DVBT TuningSpace"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; hr = tuningSpace.put_NetworkType(<span class="hljs-string"><span class="hljs-string">"{"</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(DVBTNetworkProvider).GUID.ToString() + <span class="hljs-string"><span class="hljs-string">"}"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; hr = tuningSpace.put_SystemType(DVBSystemType.Terrestrial); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; ITuneRequest tr; hr = tuningSpace.CreateTuneRequest(<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> tr); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; IDVBTuneRequest tuneRequest = (IDVBTuneRequest)tr; hr = (pNetworkProvider <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ITuner).put_TuneRequest(tuneRequest); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hr &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hr; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><br><hr><br><br>  In order for the connected graph to make it work, it must be tuned to the desired frequency.  For this, there is an IDVBTLocator interface, with which we will set the carrier frequency.  We do not need all the other parameters, so we give them the appropriate values: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetDVBTLocator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> frequency, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> IDVBTLocator locator</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> hr = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// -- LOCATOR -- locator = (IDVBTLocator)new DVBTLocator(); //set frequency hr = locator.put_CarrierFrequency(frequency); /* kGz */ if (hr &lt; 0) return hr; //Not set parameters hr = locator.put_Bandwidth(-1); /* in Mgz */ if (hr &lt; 0) return hr; hr = locator.put_SymbolRate(-1); if (hr &lt; 0) return hr; hr = locator.put_OtherFrequencyInUse(false); if (hr &lt; 0) return hr; hr = locator.put_LPInnerFEC(FECMethod.MethodNotSet); if (hr &lt; 0) return hr; hr = locator.put_LPInnerFECRate(BinaryConvolutionCodeRate.RateNotSet); if (hr &lt; 0) return hr; hr = locator.put_HAlpha(HierarchyAlpha.HAlphaNotSet); if (hr &lt; 0) return hr; hr = locator.put_Mode(TransmissionMode.ModeNotSet); if (hr &lt; 0) return hr; hr = locator.put_InnerFEC(FECMethod.MethodNotSet); if (hr &lt; 0) return hr; hr = locator.put_InnerFECRate(BinaryConvolutionCodeRate.RateNotSet); if (hr &lt; 0) return hr; hr = locator.put_OuterFEC(FECMethod.MethodNotSet); if (hr &lt; 0) return hr; hr = locator.put_OuterFECRate(BinaryConvolutionCodeRate.RateNotSet); if (hr &lt; 0) return hr; hr = locator.put_Modulation(ModulationType.ModNotSet); if (hr &lt; 0) return hr; return 0; }</span></span></code> </pre> <br><br><hr><br><br>  Now you can set the carrier frequency and see which channels are on it.  To do this, we get tuneRequest from the provider, set up our locator with the specified frequency, update our provider with new settings, and, through the IMpeg2Data interface, retrieve the PAT table from the MPEG-2 Sections and Tables filter, which will contain the corresponding carrier frequency .  If you choose the wrong frequency, the GetPAT method will return you a negative HRESULT. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetFrequency</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> frequency</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((IGraphDVBT)ConcreteGraph).NetworkProvider == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || ((IGraphDVBT)ConcreteGraph).TablesAndSections == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> hr = <span class="hljs-number"><span class="hljs-number">0</span></span>; IPAT PAT; <span class="hljs-comment"><span class="hljs-comment">//Table with SID IDVB_SDT SDT; IDVB_SIT SIT; int channelCount = 0; short pwVal = 0; ITuneRequest tuneRequest = null; //get tune request hr = (((IGraphDVBT)ConcreteGraph).NetworkProvider as ITuner).get_TuneRequest(out tuneRequest); if (hr &lt; 0 || tuneRequest == null) { return null; } IDVBTuneRequest DVBtuneRequest = tuneRequest as IDVBTuneRequest; IDVBTLocator locator; //set locator with necessary frequency hr = SetDVBTLocator(frequency, out locator); if (hr &lt; 0 || locator == null) { return null; } hr = DVBtuneRequest.put_Locator(locator); if (hr &lt; 0) { return null; } //mediaControl.Stop(); hr = (((IGraphDVBT)ConcreteGraph).NetworkProvider as ITuner).put_TuneRequest(DVBtuneRequest); if (hr &lt; 0) { return null; } //mediaControl.Run(); //value is channel SID IDvbSiParser parser = (IDvbSiParser)new DvbSiParser(); hr = parser.Initialize(((IGraphDVBT)ConcreteGraph).TablesAndSections as IMpeg2Data); if (hr &lt; 0) { return null; } //get table with channels hr = parser.GetPAT(out PAT); if (hr &lt; 0) { //DsError.ThrowExceptionForHR(hr); return null; } //get count of channels hr = PAT.GetCountOfRecords(out channelCount); if (hr &lt; 0) { return null; } string[] channelsDVBT = new string[channelCount]; //put channels number in the list for (int i = 0; i &lt; channelCount; i++) { PAT.GetRecordProgramNumber(i,out pwVal); channelsDVBT[i] = "Channel_" + pwVal.ToString(); } return channelsDVBT; }</span></span></code> </pre> <br><br><hr><br><br>  <u><b>Note:</b></u> After you update the provider, be sure to start the graph (if it is not already running).  This is done using the IMediaControl interface. <br>  To set up a provider for a specific channel, use the IDVBTuneRequest interface. Using the put_SID method, you can transfer the SID of the channel you need. <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Take tune request from Network Provider </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Set New SID and put tune request on the Network Provider </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;param name="SID"&gt;</span></span></span><span class="hljs-comment">channel SID</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/param&gt;</span></span></span><span class="hljs-comment"> public void SetDVBTChannels(int SID) { int hr = 0; ITuneRequest tuneRequest = null; //get tune request hr = (((IGraphDVBT)ConcreteGraph).NetworkProvider as ITuner).get_TuneRequest(out tuneRequest); if (tuneRequest == null) { return; } IDVBTuneRequest DVBtuneRequest = tuneRequest as IDVBTuneRequest; //set new channel hr = DVBtuneRequest.put_SID(SID); //put tune request hr = (((IGraphDVBT)ConcreteGraph).NetworkProvider as ITuner).put_TuneRequest(DVBtuneRequest); }</span></span></code> </pre> <br><br><br><br><img src="http://content.foto.mail.ru/mail/a_golovinskaya/_mypagephoto/i-7.jpg" alt="image"><br><br>  The full code of the program is available at the following link: <a href="http://files.mail.ru/ZZHWDF">Code</a> </div><p>Source: <a href="https://habr.com/ru/post/127913/">https://habr.com/ru/post/127913/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127908/index.html">Principles of writing applications on ExtJS 2.x / 3.x</a></li>
<li><a href="../127909/index.html">Using OpenFeint in Unity3d</a></li>
<li><a href="../127910/index.html">Video coding for web projects</a></li>
<li><a href="../127911/index.html">Diablo 3 Beta is available!</a></li>
<li><a href="../127912/index.html">Evernote for Android has been integrated with Skitch, offline search and more.</a></li>
<li><a href="../127916/index.html">We write the payment method for Magento on the example of Robokassa</a></li>
<li><a href="../127917/index.html">Call for applications for the competition continues</a></li>
<li><a href="../127918/index.html">Apple's social network</a></li>
<li><a href="../127919/index.html">What is a servo valve and what it eats</a></li>
<li><a href="../127921/index.html">A quick message button to the author of a typo / inaccuracy post</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>