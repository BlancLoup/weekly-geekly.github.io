<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SQL Server Stored Procedure Optimization</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, habrachelovek. Today I would like to discuss with you the topic of stored procedures in SQL Server 2000-2005. Recently, their writing took t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SQL Server Stored Procedure Optimization</h1><div class="post__text post__text-html js-mediator-article"> Good day, habrachelovek.  Today I would like to discuss with you the topic of stored procedures in SQL Server 2000-2005.  Recently, their writing took the lion‚Äôs share of my time at work and what‚Äôs there to hide - at the end of the work with this case there is enough information that I‚Äôll be happy to share with you% user%. <br>  The knowledge that I am going to share, unfortunately, (or fortunately) is not empirically gained by me, but is, to a greater extent, a free translation of some articles from the bourgeois Internet. <br>  So, as you can see from the title, it‚Äôs about optimization.  At once I will make a reservation that all the actions that I will describe now really give a significant (some bigger, some smaller) performance gain. <br>  This article does not pretend to fully disclose the topic of optimization; rather, it is a collection of practices that I use in my work and can vouch for their effectiveness.  Go! <br><a name="habracut"></a><br><br>  <b>1. Include a line in your procedures - SET NOCOUNT ON:</b> With each DML expression, the SQL server carefully returns to us a message containing the number of processed records.  This information may be useful to us during the debugging of the code, but after it will be completely useless.  By setting the SET NOCOUNT ON, we disable this feature.  For stored procedures containing several expressions or \ and cycles, this action can give a significant performance boost, because the amount of traffic will be significantly reduced. <br><br> <code>CREATE PROC dbo.ProcName <br> AS <br> SET NOCOUNT ON; <br> --   <br> SELECT column1 FROM dbo.TblTable1 <br> -- SET NOCOUNT    <br> SET NOCOUNT OFF; <br> GO <br></code> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>2. Use the name of the schema with the name of the object:</b> Well, then I think it is clear.  This operation tells the server where to search for objects, and instead of randomly rummaging through its bins, it will immediately know where it needs to go and what to take.  With a large number of databases, tables and stored procedures can significantly save our time and nerves. <br><br> <code>SELECT * FROM dbo.MyTable --    <br> --  <br> SELECT * FROM MyTable --    <br> --  <br> EXEC dbo.MyProc --   <br> -- <br> EXEC MyProc --! <br></code> <br>  <b>3. Do not use the ‚Äúsp_‚Äù prefix in the name of your stored procedures:</b> If the name of our procedure starts with ‚Äúsp_‚Äù, SQL Server will first look for it in its main database.  The fact is that this prefix is ‚Äã‚Äãused for personal internal stored procedures of the server.  Therefore, its use can lead to additional costs and even wrong results if the procedure with the same name as you will be found in its database. <br><br>  <b>4. Use IF EXISTS (SELECT 1) instead of IF EXISTS (SELECT *):</b> To check for an entry in another table, we use the expression IF EXISTS.  This expression returns true if at least one source is returned from the inner expression, it doesn‚Äôt matter "1", all columns or table.  Returned data is not used in principle.  Thus, it is more logical to use ‚Äú1‚Äù to compress traffic during data transfer, as shown below: <br><br> <code>IF EXISTS (SELECT 1 FROM sysobjects <br> WHERE name = 'MyTable' AND type = 'U') <br></code> <br><br>  <b>5. Use TRY-Catch to catch errors:</b> Before the 2005 server, after each request, a huge number of error checks were written in the procedure.  More code always consumes more resources and more time.  Since 2005, SQL Server has had a more correct and convenient way to solve this problem: <br><br> <code>BEGIN TRY <br> -- <br> END TRY <br> BEGIN CATCH <br> --   <br> END CATCH <br></code> <br><br>  <b>Conclusion</b> <br>  In principle, today I have everything.  Once again, here are only those techniques that I personally used in my practice, and I can vouch for their effectiveness. <br><br>  <b>PS</b> <br>  My first post, do not judge strictly. </div><p>Source: <a href="https://habr.com/ru/post/85370/">https://habr.com/ru/post/85370/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../85359/index.html">Ubuntu 9.10. Encrypted root FS, opening via SSH</a></li>
<li><a href="../85361/index.html">PyRoge regular debugger</a></li>
<li><a href="../85362/index.html">Alienware M11x Review</a></li>
<li><a href="../85367/index.html">Twitter is monetized for a month.</a></li>
<li><a href="../85368/index.html">Vedic approach to freelance work</a></li>
<li><a href="../85373/index.html">Trading Part 2</a></li>
<li><a href="../85374/index.html">DIY SSH / SUDO Monitoring script</a></li>
<li><a href="../85377/index.html">Freshtel provides WiMAX in Tula, as well as in the cities of two regions (Tula and Moscow)</a></li>
<li><a href="../85381/index.html">Curious displays - a screen that interacts with the environment</a></li>
<li><a href="../85382/index.html">Harvest @ GreenfieldProject Special Prizes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>