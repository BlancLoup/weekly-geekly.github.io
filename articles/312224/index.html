<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>GOST R 34.12 '15 on SSE2, or Not So Bad Grasshopper</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On Habr√©, at least twice the new domestic standard block encryption standard GOST R 34.12 2015 Grasshopper was mentioned , ru_crypt in his post review...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>GOST R 34.12 '15 on SSE2, or Not So Bad Grasshopper</h1><div class="post__text post__text-html js-mediator-article"><p>  On Habr√©, at least twice the new domestic standard block encryption standard GOST R 34.12 2015 Grasshopper was <a href="https://habrahabr.ru/users/ru_crypt/" class="user_link">mentioned</a> , <a href="https://habrahabr.ru/users/ru_crypt/" class="user_link">ru_crypt</a> in his post reviewed the basic mechanisms and transformations of the new standard, and <a href="https://habrahabr.ru/users/sebastian_mg/" class="user_link">sebastian_mg</a> dealt with step-by-step tracing of the basic transformation.  But many questions remained unanswered.  How fast is the new GOST?  Can it be optimized, effectively implemented, accelerated by hardware? </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/f92/0bc/2d1/f920bc2d148a4ace90609775e2b1d276.jpg" alt="GOST R 34.12 2015 with SSE2"></div><p></p><a name="habracut"></a><br><h2 id="o-standarte-gost-r-3412-15">  About standard GOST R 34.12 '15 </h2><br><p>  Order No. 749 of June 19, 2015 approved GOST R 34.12 2015 as a standard block encryption standard. The standard was developed by the Center for Information Protection and Special Communications of the Federal Security Service of Russia with the participation of InfoTex OJSC, introduced by the Technical Committee on Standardization TC 26 "Cryptographic Information Protection", and entered into force on January 1, 2016. </p><br><p>  The official pdf-edition of the standard is downloaded <a href="http://tc26.ru/standard/gost/GOST_R_3412-2015.pdf">here</a> , and the reference implementation is <a href="">here</a> (both links lead to the official website of TC 26). </p><br><p>  This standard contains descriptions of two block ciphers: ‚ÄúMagma‚Äù with a block length of 64 bits and ‚ÄúGrasshopper‚Äù with a block length of 128 bits;  ‚ÄúMagma‚Äù is just a new name for the old, well-known block cipher GOST 28147 '89 (in fact, not quite new, it was under this code name that the old standard block encryption was developed up to 1994) with fixed replacement nodes .  ‚ÄúFinally, history has taught us something,‚Äù you will say, and you will be right. </p><br><p>  In this article we will talk about another cipher having a block length of 128 bits and bearing the code name "Grasshopper".  According to the city land, the name of the cipher is not at all connected with the green insect, but is formed by the first syllables of the names of the authors of this cipher: <strong>Kuz</strong> Ymin, <strong>Nech</strong> Ayyev, <strong>and</strong> K. </p><br><h2 id="opisanie-kuznechika">  Description of "Grasshopper" </h2><br><h3 id="otlichiya-kuznechika-ot-magmy">  Differences "Grasshopper" from "Magma" </h3><br><p>  The new cipher is significantly different from the old one; </p><br><ul><li>  doubled block length ( <em>128 bits, or 16 bytes</em> , versus <del>  64 bits, or 8 bytes </del>  ), </li><li>  nontrivial key schedule ( <em>Feistel network as a key schedule</em> against <del>  using parts of the secret key as cyclic keys </del>  ), </li><li>  reduced number of cycles ( <em>10 cycles</em> against <del>  32 cycles </del>  ), </li><li>  fundamentally different device of the cipher itself ( <em>LSX cipher</em> against <del>  Feistel nets </del>  ). </li></ul><br><h3 id="bazovoe-preobrazovanie">  Base transform </h3><br><p>  The cipher belongs to the LSX cipher class: its basic transformation (block encryption function) is represented by ten cycles of consecutive conversions <em>L</em> (linear transformation), <em>S</em> (substitution) and <em>X</em> (mixing with the cyclic key): </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/583/582/ad3/583582ad31cc437c868029f97dd0d4d4.png" width="500"></div><br><p>  <i>Full cycle of basic conversion</i> </p><br><p>  Algebraically, the ciphertext <em>C</em> depends on plaintext <em>P</em> as follows: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AC%20%3D%20X_%7B9%7D%20%5Ccirc%20LSX_%7B8%7D%20%5Ccirc%20%5Cdots%20%5Ccirc%20LSX_%7B0%7D%20%5Cleft(%20P%20%5Cright)%2C%0A" alt="C = X_ {9} \ circ LSX_ {8} \ circ \ dots \ circ LSX_ {0} \ left (P \ right),"></div><p></p><br><p>  that is, nine complete cycles are followed by the last incomplete (only mixing with the key).  Transformation <em>X</em> mixes the intermediate text of the next cycle with the corresponding cyclic key by simple addition modulo 2: </p><br><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AX(M_i)%20%3D%20M_i%20%5Coplus%20K_i.%0A" alt="X (M_i) = M_i \ oplus K_i."></div><br><p>  Transformation <em>S</em> applies the same fixed substitution <img src="https://tex.s2cms.ru/svg/%0A%5Cpi" alt="\ pi">  to each byte of the intermediate text: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AS(M_i)%20%3D%20%5Coverline%7B%5Cpi(m_0)%20%5Cpi(m_1)%20%5Cdots%20%5Cpi(m_%7B15%7D)%7D%2C%20%5Ctext%7B%20%D0%B3%D0%B4%D0%B5%20%7D%20%5Cpi%20%5Ccolon%20%5Cmathbb%7BZ%7D_2%5E8%20%5Cmapsto%20%5Cmathbb%7BZ%7D_2%5E8%20%5Ctext%7B%20%D0%B8%20%7D%20M_i%20%3D%20%5Coverline%7Bm_0%20m_1%20%5Cdots%20m_%7B15%7D%7D.%0A" alt="S (M_i) = \ overline {\ pi (m_0) \ pi (m_1) \ dots \ pi (m_ {15})}, \ text {where} \ pi \ colon \ mathbb {Z} _2 ^ 8 \ mapsto \ mathbb {Z} _2 ^ 8 \ text {and} M_i = \ overline {m_0 m_1 \ dots m_ {15}}."></div><p></p><br><p>  The transformation <em>L</em> is a representable linear form over the field GF (256), constructed using an irreducible polynomial </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0Ap(x)%20%3D%20x%5E8%20%2B%20x%5E7%20%2B%20x%5E6%20%2B%20x%20%2B%201%2C%0A" alt="p (x) = x ^ 8 + x ^ 7 + x ^ 6 + x + 1,"></div><p></p><br><p>  and boils down to multiplying the vector ‚Äì line of the intermediate text by some matrix above this field (each byte of text and matrix is ‚Äã‚Äãa field polynomial represented by its coefficients): </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AL(M_i)%20%3D%20M_i%20%5Ctimes%20M_%7B16%20%5Ctimes%2016%7D.%0A" alt="L (M_i) = M_i \ times M_ {16 \ times 16}."></div><p></p><br><div class="spoiler">  <b class="spoiler_title">Sample code base conversion</b> <div class="spoiler_text"><pre><code class="hljs cpp"><span class="hljs-comment"><span class="hljs-comment">/*  S-  . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applySTransformation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *block )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> byteIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; byteIndex &lt; BlockLengthInBytes; byteIndex += <span class="hljs-number"><span class="hljs-number">8</span></span>) { block[byteIndex + <span class="hljs-number"><span class="hljs-number">0</span></span>] = Pi[block[byteIndex + <span class="hljs-number"><span class="hljs-number">0</span></span>]]; block[byteIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>] = Pi[block[byteIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>]]; block[byteIndex + <span class="hljs-number"><span class="hljs-number">2</span></span>] = Pi[block[byteIndex + <span class="hljs-number"><span class="hljs-number">2</span></span>]]; block[byteIndex + <span class="hljs-number"><span class="hljs-number">3</span></span>] = Pi[block[byteIndex + <span class="hljs-number"><span class="hljs-number">3</span></span>]]; block[byteIndex + <span class="hljs-number"><span class="hljs-number">4</span></span>] = Pi[block[byteIndex + <span class="hljs-number"><span class="hljs-number">4</span></span>]]; block[byteIndex + <span class="hljs-number"><span class="hljs-number">5</span></span>] = Pi[block[byteIndex + <span class="hljs-number"><span class="hljs-number">5</span></span>]]; block[byteIndex + <span class="hljs-number"><span class="hljs-number">6</span></span>] = Pi[block[byteIndex + <span class="hljs-number"><span class="hljs-number">6</span></span>]]; block[byteIndex + <span class="hljs-number"><span class="hljs-number">7</span></span>] = Pi[block[byteIndex + <span class="hljs-number"><span class="hljs-number">7</span></span>]]; } } <span class="hljs-comment"><span class="hljs-comment">/*  L-  . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applyLTransformation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *input, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *output )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> byteIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; byteIndex &lt; BlockLengthInBytes; ++byteIndex) { <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> cache = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> addendIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; addendIndex &lt; BlockLengthInBytes; ++addendIndex) { cache ^= multiplyInGF256(LTransformationMatrix[addendIndex][byteIndex], input[addendIndex]); } output[byteIndex] = cache; } } <span class="hljs-comment"><span class="hljs-comment">/*    . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applyXSLTransformation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *key, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *block, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *temporary )</span></span></span><span class="hljs-function"> </span></span>{ applyXTransformation(key, block, temporary); applySTransformation(temporary); applyLTransformation(temporary, block); } <span class="hljs-comment"><span class="hljs-comment">/*   ( ). */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">encryptBlock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">restrict</span></span></span></span><span class="hljs-function"><span class="hljs-params"> block, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">restrict</span></span></span></span><span class="hljs-function"><span class="hljs-params"> roundKeys )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> cache[BlockLengthInBytes] = {<span class="hljs-number"><span class="hljs-number">0</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> round = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; round &lt; NumberOfRounds - <span class="hljs-number"><span class="hljs-number">1</span></span>; ++round) { applyXSLTransformation(&amp;roundKeys[BlockLengthInBytes * round], block, cache); } applyXTransformation(&amp;roundKeys[BlockLengthInBytes * round], block, block); }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">The calculated transformation matrix L and its inverse in C-friendly form</b> <div class="spoiler_text"><pre> <code class="hljs go"><span class="hljs-comment"><span class="hljs-comment">/*   L. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> uint8_t LTransformationMatrix[<span class="hljs-number"><span class="hljs-number">16</span></span>][<span class="hljs-number"><span class="hljs-number">16</span></span>] = { <span class="hljs-number"><span class="hljs-number">0xcf</span></span>, <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0x72</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x7a</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0x5d</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0xbd</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x98</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0xc8</span></span>, <span class="hljs-number"><span class="hljs-number">0x33</span></span>, <span class="hljs-number"><span class="hljs-number">0xf2</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0xe6</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0x9f</span></span>, <span class="hljs-number"><span class="hljs-number">0x95</span></span>, <span class="hljs-number"><span class="hljs-number">0xe9</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x74</span></span>, <span class="hljs-number"><span class="hljs-number">0xc6</span></span>, <span class="hljs-number"><span class="hljs-number">0x87</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x6b</span></span>, <span class="hljs-number"><span class="hljs-number">0xec</span></span>, <span class="hljs-number"><span class="hljs-number">0x62</span></span>, <span class="hljs-number"><span class="hljs-number">0x4e</span></span>, <span class="hljs-number"><span class="hljs-number">0x87</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0xbe</span></span>, <span class="hljs-number"><span class="hljs-number">0x5e</span></span>, <span class="hljs-number"><span class="hljs-number">0xd0</span></span>, <span class="hljs-number"><span class="hljs-number">0x75</span></span>, <span class="hljs-number"><span class="hljs-number">0x74</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0xda</span></span>, <span class="hljs-number"><span class="hljs-number">0x70</span></span>, <span class="hljs-number"><span class="hljs-number">0x0c</span></span>, <span class="hljs-number"><span class="hljs-number">0xca</span></span>, <span class="hljs-number"><span class="hljs-number">0x0c</span></span>, <span class="hljs-number"><span class="hljs-number">0x17</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0x2f</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0xd9</span></span>, <span class="hljs-number"><span class="hljs-number">0xca</span></span>, <span class="hljs-number"><span class="hljs-number">0x96</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x93</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0xc5</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0xbb</span></span>, <span class="hljs-number"><span class="hljs-number">0xcb</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0xe9</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x97</span></span>, <span class="hljs-number"><span class="hljs-number">0x5d</span></span>, <span class="hljs-number"><span class="hljs-number">0xc2</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x43</span></span>, <span class="hljs-number"><span class="hljs-number">0x11</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0xbc</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0x2e</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0x7c</span></span>, <span class="hljs-number"><span class="hljs-number">0x60</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x77</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0xf2</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0xd6</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xaf</span></span>, <span class="hljs-number"><span class="hljs-number">0xc4</span></span>, <span class="hljs-number"><span class="hljs-number">0xf1</span></span>, <span class="hljs-number"><span class="hljs-number">0xab</span></span>, <span class="hljs-number"><span class="hljs-number">0xee</span></span>, <span class="hljs-number"><span class="hljs-number">0xad</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x3d</span></span>, <span class="hljs-number"><span class="hljs-number">0x5a</span></span>, <span class="hljs-number"><span class="hljs-number">0x6f</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x9c</span></span>, <span class="hljs-number"><span class="hljs-number">0x2b</span></span>, <span class="hljs-number"><span class="hljs-number">0x6a</span></span>, <span class="hljs-number"><span class="hljs-number">0xa4</span></span>, <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0xe7</span></span>, <span class="hljs-number"><span class="hljs-number">0xbe</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0xc9</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xaf</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>, <span class="hljs-number"><span class="hljs-number">0xde</span></span>, <span class="hljs-number"><span class="hljs-number">0xfb</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a</span></span>, <span class="hljs-number"><span class="hljs-number">0xc1</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0xa6</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0xa3</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0x09</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0xef</span></span>, <span class="hljs-number"><span class="hljs-number">0x7b</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0x54</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0x63</span></span>, <span class="hljs-number"><span class="hljs-number">0xd7</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0xe1</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0xaf</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0x54</span></span>, <span class="hljs-number"><span class="hljs-number">0x2f</span></span>, <span class="hljs-number"><span class="hljs-number">0x39</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xa6</span></span>, <span class="hljs-number"><span class="hljs-number">0xb4</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0xc4</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0x37</span></span>, <span class="hljs-number"><span class="hljs-number">0x2a</span></span>, <span class="hljs-number"><span class="hljs-number">0x0f</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0xec</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0x31</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0xc2</span></span>, <span class="hljs-number"><span class="hljs-number">0xa9</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0x6b</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x58</span></span>, <span class="hljs-number"><span class="hljs-number">0x78</span></span>, <span class="hljs-number"><span class="hljs-number">0xb1</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0xfe</span></span>, <span class="hljs-number"><span class="hljs-number">0x91</span></span>, <span class="hljs-number"><span class="hljs-number">0x91</span></span>, <span class="hljs-number"><span class="hljs-number">0xd3</span></span>, <span class="hljs-number"><span class="hljs-number">0xd1</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xea</span></span>, <span class="hljs-number"><span class="hljs-number">0x86</span></span>, <span class="hljs-number"><span class="hljs-number">0x9f</span></span>, <span class="hljs-number"><span class="hljs-number">0x07</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x0e</span></span>, <span class="hljs-number"><span class="hljs-number">0x52</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0x60</span></span>, <span class="hljs-number"><span class="hljs-number">0x98</span></span>, <span class="hljs-number"><span class="hljs-number">0xc6</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0x52</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xf5</span></span>, <span class="hljs-number"><span class="hljs-number">0x2a</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0xc8</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x3c</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x4d</span></span>, <span class="hljs-number"><span class="hljs-number">0xd0</span></span>, <span class="hljs-number"><span class="hljs-number">0xe3</span></span>, <span class="hljs-number"><span class="hljs-number">0xe8</span></span>, <span class="hljs-number"><span class="hljs-number">0x4c</span></span>, <span class="hljs-number"><span class="hljs-number">0xc3</span></span>, <span class="hljs-number"><span class="hljs-number">0x16</span></span>, <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0x4b</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0x0d</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0xa5</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0x72</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x7a</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0x5d</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0xbd</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, }; <span class="hljs-comment"><span class="hljs-comment">/* ,     L. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> uint8_t inversedLTransformationMatrix[<span class="hljs-number"><span class="hljs-number">16</span></span>][<span class="hljs-number"><span class="hljs-number">16</span></span>] = { <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xbd</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0x5d</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0x7a</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0x72</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0xa5</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0x0d</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0x4b</span></span>, <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0x16</span></span>, <span class="hljs-number"><span class="hljs-number">0xc3</span></span>, <span class="hljs-number"><span class="hljs-number">0x4c</span></span>, <span class="hljs-number"><span class="hljs-number">0xe8</span></span>, <span class="hljs-number"><span class="hljs-number">0xe3</span></span>, <span class="hljs-number"><span class="hljs-number">0xd0</span></span>, <span class="hljs-number"><span class="hljs-number">0x4d</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x3c</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0xc8</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0x2a</span></span>, <span class="hljs-number"><span class="hljs-number">0xf5</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0x52</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0xc6</span></span>, <span class="hljs-number"><span class="hljs-number">0x98</span></span>, <span class="hljs-number"><span class="hljs-number">0x60</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0x52</span></span>, <span class="hljs-number"><span class="hljs-number">0x0e</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x07</span></span>, <span class="hljs-number"><span class="hljs-number">0x9f</span></span>, <span class="hljs-number"><span class="hljs-number">0x86</span></span>, <span class="hljs-number"><span class="hljs-number">0xea</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xd1</span></span>, <span class="hljs-number"><span class="hljs-number">0xd3</span></span>, <span class="hljs-number"><span class="hljs-number">0x91</span></span>, <span class="hljs-number"><span class="hljs-number">0x91</span></span>, <span class="hljs-number"><span class="hljs-number">0xfe</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xb1</span></span>, <span class="hljs-number"><span class="hljs-number">0x78</span></span>, <span class="hljs-number"><span class="hljs-number">0x58</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0x6b</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0xa9</span></span>, <span class="hljs-number"><span class="hljs-number">0xc2</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0x31</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0xec</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0x0f</span></span>, <span class="hljs-number"><span class="hljs-number">0x2a</span></span>, <span class="hljs-number"><span class="hljs-number">0x37</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0xc4</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0xb4</span></span>, <span class="hljs-number"><span class="hljs-number">0xa6</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0x39</span></span>, <span class="hljs-number"><span class="hljs-number">0x2f</span></span>, <span class="hljs-number"><span class="hljs-number">0x54</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0xaf</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0xe1</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0xd7</span></span>, <span class="hljs-number"><span class="hljs-number">0x63</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x54</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0x7b</span></span>, <span class="hljs-number"><span class="hljs-number">0xef</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x09</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0xa3</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0xa6</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0xc1</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a</span></span>, <span class="hljs-number"><span class="hljs-number">0xfb</span></span>, <span class="hljs-number"><span class="hljs-number">0xde</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>, <span class="hljs-number"><span class="hljs-number">0xaf</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xc9</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0xbe</span></span>, <span class="hljs-number"><span class="hljs-number">0xe7</span></span>, <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0xa4</span></span>, <span class="hljs-number"><span class="hljs-number">0x6a</span></span>, <span class="hljs-number"><span class="hljs-number">0x2b</span></span>, <span class="hljs-number"><span class="hljs-number">0x9c</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x6f</span></span>, <span class="hljs-number"><span class="hljs-number">0x5a</span></span>, <span class="hljs-number"><span class="hljs-number">0x3d</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0xad</span></span>, <span class="hljs-number"><span class="hljs-number">0xee</span></span>, <span class="hljs-number"><span class="hljs-number">0xab</span></span>, <span class="hljs-number"><span class="hljs-number">0xf1</span></span>, <span class="hljs-number"><span class="hljs-number">0xc4</span></span>, <span class="hljs-number"><span class="hljs-number">0xaf</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xd6</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0xf2</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0x77</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x60</span></span>, <span class="hljs-number"><span class="hljs-number">0x7c</span></span>, <span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0x2e</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0xbc</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0x11</span></span>, <span class="hljs-number"><span class="hljs-number">0x43</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0xc2</span></span>, <span class="hljs-number"><span class="hljs-number">0x5d</span></span>, <span class="hljs-number"><span class="hljs-number">0x97</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0xe9</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0xcb</span></span>, <span class="hljs-number"><span class="hljs-number">0xbb</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0xc5</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0x93</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x96</span></span>, <span class="hljs-number"><span class="hljs-number">0xca</span></span>, <span class="hljs-number"><span class="hljs-number">0xd9</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x2f</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0x17</span></span>, <span class="hljs-number"><span class="hljs-number">0x0c</span></span>, <span class="hljs-number"><span class="hljs-number">0xca</span></span>, <span class="hljs-number"><span class="hljs-number">0x0c</span></span>, <span class="hljs-number"><span class="hljs-number">0x70</span></span>, <span class="hljs-number"><span class="hljs-number">0xda</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0x74</span></span>, <span class="hljs-number"><span class="hljs-number">0x75</span></span>, <span class="hljs-number"><span class="hljs-number">0xd0</span></span>, <span class="hljs-number"><span class="hljs-number">0x5e</span></span>, <span class="hljs-number"><span class="hljs-number">0xbe</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0x87</span></span>, <span class="hljs-number"><span class="hljs-number">0x4e</span></span>, <span class="hljs-number"><span class="hljs-number">0x62</span></span>, <span class="hljs-number"><span class="hljs-number">0xec</span></span>, <span class="hljs-number"><span class="hljs-number">0x6b</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x87</span></span>, <span class="hljs-number"><span class="hljs-number">0xc6</span></span>, <span class="hljs-number"><span class="hljs-number">0x74</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0xe9</span></span>, <span class="hljs-number"><span class="hljs-number">0x95</span></span>, <span class="hljs-number"><span class="hljs-number">0x9f</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0xe6</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0xf2</span></span>, <span class="hljs-number"><span class="hljs-number">0x33</span></span>, <span class="hljs-number"><span class="hljs-number">0xc8</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x98</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xbd</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0x5d</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0x7a</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0x72</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0xcf</span></span>, };</code> </pre> </div></div><br><h3 id="klyuchevoe-raspisanie">  Key Schedule </h3><br><p>  Indeed, many of the mistakes made when developing the older cipher were corrected, including the vulnerable key schedule.  Let me remind the reader that in the code GOST 28147 '89, eight 32-bit parts of the 256-bit secret key were used in right order on encryption cycles from the first to the eighth, from the ninth to the sixteenth, from the seventeenth to the twenty-fourth;  and in reverse order on cycles twenty-five to thirty-two: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AK_0%2C%20K_1%2C%20%5Cdots%2C%20K_6%2C%20K_7%2C%5C%5C%0AK_0%2C%20K_1%2C%20%5Cdots%2C%20K_6%2C%20K_7%2C%5C%5C%0AK_0%2C%20K_1%2C%20%5Cdots%2C%20K_6%2C%20K_7%2C%5C%5C%0AK_7%2C%20K_6%2C%20%5Cdots%2C%20K_1%2C%20K_0.%5C%5C%0A" alt="K_0, K_1, \ dots, K_6, K_7, \\ K_0, K_1, \ dots, K_6, K_7, \\ K_0, K_1, \ dots, K_6, K_7, \\ K_7, K_6, \ dots, K_1, K_0. \\"></div><p></p><br><p>  And it is just such a weak key schedule that allowed the attack to be reflected at full GOST, reducing its resistance from 256 bits to 225 bits (for any replacement nodes, from 2 ^ 32 materials on the same key; you can read about this attack <a href="https://www.iacr.org/archive/fse2011/67330297/67330297.pdf">here</a> ). </p><br><p>  In the new standard, the generation of cyclic keys is carried out according to the Feistel scheme, with the first two cyclic keys being half a 256-bit secret key, and each subsequent pair of cyclic keys is obtained by applying eight cycles of Feistel transformation to the previous pair of cyclic keys, where the cyclic function the LSX transform is used as in the base transform, and a fixed set of constants is used as the cyclic keys in the schema: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0A%5Cleft(%20K_%7B2i%20%2B%201%7D%2C%20K_%7B2i%20%2B%202%7D%20%5Cright)%20%3D%20%0AF%5E8%20%5Cleft(%20K_%7B2i%20-%201%7D%2C%20K_%7B2i%7D%20%5Cright)%3B%0A%5Ctext%7B%20%D0%B3%D0%B4%D0%B5%20%7D%0AF%20%5Cleft(%20x%2C%20y%20%5Cright)%20%3D%20%5Cleft(%20LSX_i(y)%20%5Coplus%20x%2C%20y%20%5Cright).%0A" alt="\ left (K_ {2i + 1}, K_ {2i + 2} \ right) = F ^ 8 \ left (K_ {2i - 1}, K_ {2i} \ right); \ text {where} F \ left (x, y \ right) = \ left (LSX_i (y) \ oplus x, y \ right)."></div><p></p><br><div class="spoiler">  <b class="spoiler_title">Sample code that implements such a key schedule.</b> <div class="spoiler_text"><pre> <code class="hljs cpp"><span class="hljs-comment"><span class="hljs-comment">/*         34.12 '15. */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scheduleRoundKeys</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">restrict</span></span></span></span><span class="hljs-function"><span class="hljs-params"> roundKeys, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">restrict</span></span></span></span><span class="hljs-function"><span class="hljs-params"> key, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">restrict</span></span></span></span><span class="hljs-function"><span class="hljs-params"> memory )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*     . */</span></span> <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(&amp;roundKeys[<span class="hljs-number"><span class="hljs-number">0</span></span>], key, BlockLengthInBytes * <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nextKeyIndex = <span class="hljs-number"><span class="hljs-number">2</span></span>, constantIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; nextKeyIndex != NumberOfRounds; nextKeyIndex += <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/*     . */</span></span> <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(&amp;roundKeys[BlockLengthInBytes * (nextKeyIndex)], &amp;roundKeys[BlockLengthInBytes * (nextKeyIndex - <span class="hljs-number"><span class="hljs-number">2</span></span>)], BlockLengthInBytes * <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">/*   . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> feistelRoundIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; feistelRoundIndex &lt; NumberOfRoundsInKeySchedule; ++feistelRoundIndex) { applyFTransformation(&amp;roundConstants[BlockLengthInBytes * constantIndex++], &amp;roundKeys[BlockLengthInBytes * (nextKeyIndex)], &amp;roundKeys[BlockLengthInBytes * (nextKeyIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>)], &amp;memory[<span class="hljs-number"><span class="hljs-number">0</span></span>], &amp;memory[BlockLengthInBytes]); } } }</code> </pre> <br><p>  <strong>Notes</strong> <br>  Here, 256 bits of auxiliary memory for cycle conversion are transferred by the <code>memory</code> pointer, but they can be allocated on the stack. <br>  Explicit array indexing with roundKeys cyclic keys <code>roundKeys</code> made for clarity and simplicity, and can be easily replaced with pointer arithmetic. <br>  The <code>applyFTransformation</code> function applies cyclic transformation to semi-blocks of the scheme and produces a swap of these semi-blocks, for example, like this: </p><br><pre> <code class="hljs cpp"><span class="hljs-comment"><span class="hljs-comment">/*       . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applyFTransformation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">restrict</span></span></span></span><span class="hljs-function"><span class="hljs-params"> key, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">restrict</span></span></span></span><span class="hljs-function"><span class="hljs-params"> left, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">restrict</span></span></span></span><span class="hljs-function"><span class="hljs-params"> right, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">restrict</span></span></span></span><span class="hljs-function"><span class="hljs-params"> temporary1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">restrict</span></span></span></span><span class="hljs-function"><span class="hljs-params"> temporary2 )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(temporary1, left, BlockLengthInBytes); applyXSLTransformation(key, temporary1, temporary2); applyXTransformation(temporary1, right, right); swapBlocks(left, right, temporary2); }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Computed cyclic keys in a key schedule in a C-friendly format</b> <div class="spoiler_text"><pre> <code class="hljs go"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> uint8_t roundConstants[<span class="hljs-number"><span class="hljs-number">512</span></span>] = { <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0x72</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x7a</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0x5d</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0xbd</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xdc</span></span>, <span class="hljs-number"><span class="hljs-number">0x87</span></span>, <span class="hljs-number"><span class="hljs-number">0xec</span></span>, <span class="hljs-number"><span class="hljs-number">0xe4</span></span>, <span class="hljs-number"><span class="hljs-number">0xd8</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0xf4</span></span>, <span class="hljs-number"><span class="hljs-number">0xb3</span></span>, <span class="hljs-number"><span class="hljs-number">0xba</span></span>, <span class="hljs-number"><span class="hljs-number">0x4e</span></span>, <span class="hljs-number"><span class="hljs-number">0xb9</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x79</span></span>, <span class="hljs-number"><span class="hljs-number">0xcb</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xb2</span></span>, <span class="hljs-number"><span class="hljs-number">0x25</span></span>, <span class="hljs-number"><span class="hljs-number">0x9a</span></span>, <span class="hljs-number"><span class="hljs-number">0x96</span></span>, <span class="hljs-number"><span class="hljs-number">0xb4</span></span>, <span class="hljs-number"><span class="hljs-number">0xd8</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0x0b</span></span>, <span class="hljs-number"><span class="hljs-number">0xe7</span></span>, <span class="hljs-number"><span class="hljs-number">0x69</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0xa4</span></span>, <span class="hljs-number"><span class="hljs-number">0x4f</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0x03</span></span>, <span class="hljs-number"><span class="hljs-number">0x7b</span></span>, <span class="hljs-number"><span class="hljs-number">0xcd</span></span>, <span class="hljs-number"><span class="hljs-number">0x1b</span></span>, <span class="hljs-number"><span class="hljs-number">0x0b</span></span>, <span class="hljs-number"><span class="hljs-number">0x73</span></span>, <span class="hljs-number"><span class="hljs-number">0xe3</span></span>, <span class="hljs-number"><span class="hljs-number">0x2b</span></span>, <span class="hljs-number"><span class="hljs-number">0xa5</span></span>, <span class="hljs-number"><span class="hljs-number">0xb7</span></span>, <span class="hljs-number"><span class="hljs-number">0x9c</span></span>, <span class="hljs-number"><span class="hljs-number">0xb1</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0xf2</span></span>, <span class="hljs-number"><span class="hljs-number">0x55</span></span>, <span class="hljs-number"><span class="hljs-number">0x15</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x15</span></span>, <span class="hljs-number"><span class="hljs-number">0x6f</span></span>, <span class="hljs-number"><span class="hljs-number">0x6d</span></span>, <span class="hljs-number"><span class="hljs-number">0x79</span></span>, <span class="hljs-number"><span class="hljs-number">0x1f</span></span>, <span class="hljs-number"><span class="hljs-number">0xab</span></span>, <span class="hljs-number"><span class="hljs-number">0x51</span></span>, <span class="hljs-number"><span class="hljs-number">0x1d</span></span>, <span class="hljs-number"><span class="hljs-number">0xea</span></span>, <span class="hljs-number"><span class="hljs-number">0xbb</span></span>, <span class="hljs-number"><span class="hljs-number">0x0c</span></span>, <span class="hljs-number"><span class="hljs-number">0x50</span></span>, <span class="hljs-number"><span class="hljs-number">0x2f</span></span>, <span class="hljs-number"><span class="hljs-number">0xd1</span></span>, <span class="hljs-number"><span class="hljs-number">0x81</span></span>, <span class="hljs-number"><span class="hljs-number">0x05</span></span>, <span class="hljs-number"><span class="hljs-number">0xa7</span></span>, <span class="hljs-number"><span class="hljs-number">0x4a</span></span>, <span class="hljs-number"><span class="hljs-number">0xf7</span></span>, <span class="hljs-number"><span class="hljs-number">0xef</span></span>, <span class="hljs-number"><span class="hljs-number">0xab</span></span>, <span class="hljs-number"><span class="hljs-number">0x73</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0x16</span></span>, <span class="hljs-number"><span class="hljs-number">0x0d</span></span>, <span class="hljs-number"><span class="hljs-number">0xd2</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x60</span></span>, <span class="hljs-number"><span class="hljs-number">0x8b</span></span>, <span class="hljs-number"><span class="hljs-number">0x9e</span></span>, <span class="hljs-number"><span class="hljs-number">0xfe</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0xc9</span></span>, <span class="hljs-number"><span class="hljs-number">0xe8</span></span>, <span class="hljs-number"><span class="hljs-number">0x81</span></span>, <span class="hljs-number"><span class="hljs-number">0x9d</span></span>, <span class="hljs-number"><span class="hljs-number">0xc7</span></span>, <span class="hljs-number"><span class="hljs-number">0x3b</span></span>, <span class="hljs-number"><span class="hljs-number">0xa5</span></span>, <span class="hljs-number"><span class="hljs-number">0xae</span></span>, <span class="hljs-number"><span class="hljs-number">0x50</span></span>, <span class="hljs-number"><span class="hljs-number">0xf5</span></span>, <span class="hljs-number"><span class="hljs-number">0xb5</span></span>, <span class="hljs-number"><span class="hljs-number">0x70</span></span>, <span class="hljs-number"><span class="hljs-number">0x56</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0x6a</span></span>, <span class="hljs-number"><span class="hljs-number">0x07</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0x59</span></span>, <span class="hljs-number"><span class="hljs-number">0x36</span></span>, <span class="hljs-number"><span class="hljs-number">0x16</span></span>, <span class="hljs-number"><span class="hljs-number">0xe6</span></span>, <span class="hljs-number"><span class="hljs-number">0x05</span></span>, <span class="hljs-number"><span class="hljs-number">0x56</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0xad</span></span>, <span class="hljs-number"><span class="hljs-number">0xfb</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0xaa</span></span>, <span class="hljs-number"><span class="hljs-number">0x2a</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x98</span></span>, <span class="hljs-number"><span class="hljs-number">0xfb</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0x8a</span></span>, <span class="hljs-number"><span class="hljs-number">0x4d</span></span>, <span class="hljs-number"><span class="hljs-number">0x2c</span></span>, <span class="hljs-number"><span class="hljs-number">0x31</span></span>, <span class="hljs-number"><span class="hljs-number">0xf0</span></span>, <span class="hljs-number"><span class="hljs-number">0xdc</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0xfa</span></span>, <span class="hljs-number"><span class="hljs-number">0x2e</span></span>, <span class="hljs-number"><span class="hljs-number">0xbe</span></span>, <span class="hljs-number"><span class="hljs-number">0x09</span></span>, <span class="hljs-number"><span class="hljs-number">0x2a</span></span>, <span class="hljs-number"><span class="hljs-number">0xde</span></span>, <span class="hljs-number"><span class="hljs-number">0xda</span></span>, <span class="hljs-number"><span class="hljs-number">0xf2</span></span>, <span class="hljs-number"><span class="hljs-number">0x3e</span></span>, <span class="hljs-number"><span class="hljs-number">0x95</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0x3a</span></span>, <span class="hljs-number"><span class="hljs-number">0x17</span></span>, <span class="hljs-number"><span class="hljs-number">0xb5</span></span>, <span class="hljs-number"><span class="hljs-number">0x18</span></span>, <span class="hljs-number"><span class="hljs-number">0xa0</span></span>, <span class="hljs-number"><span class="hljs-number">0x5e</span></span>, <span class="hljs-number"><span class="hljs-number">0x61</span></span>, <span class="hljs-number"><span class="hljs-number">0xc1</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x7c</span></span>, <span class="hljs-number"><span class="hljs-number">0xac</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x52</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0xd8</span></span>, <span class="hljs-number"><span class="hljs-number">0x82</span></span>, <span class="hljs-number"><span class="hljs-number">0x4a</span></span>, <span class="hljs-number"><span class="hljs-number">0x92</span></span>, <span class="hljs-number"><span class="hljs-number">0xa5</span></span>, <span class="hljs-number"><span class="hljs-number">0xb0</span></span>, <span class="hljs-number"><span class="hljs-number">0x83</span></span>, <span class="hljs-number"><span class="hljs-number">0xe5</span></span>, <span class="hljs-number"><span class="hljs-number">0x55</span></span>, <span class="hljs-number"><span class="hljs-number">0x0b</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0x1d</span></span>, <span class="hljs-number"><span class="hljs-number">0x95</span></span>, <span class="hljs-number"><span class="hljs-number">0xe6</span></span>, <span class="hljs-number"><span class="hljs-number">0x7d</span></span>, <span class="hljs-number"><span class="hljs-number">0x2c</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0x67</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0x3f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0c</span></span>, <span class="hljs-number"><span class="hljs-number">0xe3</span></span>, <span class="hljs-number"><span class="hljs-number">0x36</span></span>, <span class="hljs-number"><span class="hljs-number">0x5b</span></span>, <span class="hljs-number"><span class="hljs-number">0x6f</span></span>, <span class="hljs-number"><span class="hljs-number">0xf9</span></span>, <span class="hljs-number"><span class="hljs-number">0xae</span></span>, <span class="hljs-number"><span class="hljs-number">0x07</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x47</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0xad</span></span>, <span class="hljs-number"><span class="hljs-number">0xd0</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x7b</span></span>, <span class="hljs-number"><span class="hljs-number">0xab</span></span>, <span class="hljs-number"><span class="hljs-number">0x0d</span></span>, <span class="hljs-number"><span class="hljs-number">0x51</span></span>, <span class="hljs-number"><span class="hljs-number">0x13</span></span>, <span class="hljs-number"><span class="hljs-number">0xc1</span></span>, <span class="hljs-number"><span class="hljs-number">0xf9</span></span>, <span class="hljs-number"><span class="hljs-number">0x4d</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0x9f</span></span>, <span class="hljs-number"><span class="hljs-number">0xa0</span></span>, <span class="hljs-number"><span class="hljs-number">0x29</span></span>, <span class="hljs-number"><span class="hljs-number">0xa9</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>, <span class="hljs-number"><span class="hljs-number">0xac</span></span>, <span class="hljs-number"><span class="hljs-number">0x34</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0x0e</span></span>, <span class="hljs-number"><span class="hljs-number">0x3f</span></span>, <span class="hljs-number"><span class="hljs-number">0xb1</span></span>, <span class="hljs-number"><span class="hljs-number">0xb7</span></span>, <span class="hljs-number"><span class="hljs-number">0x8b</span></span>, <span class="hljs-number"><span class="hljs-number">0x21</span></span>, <span class="hljs-number"><span class="hljs-number">0x3e</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0xfd</span></span>, <span class="hljs-number"><span class="hljs-number">0x0e</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0xf0</span></span>, <span class="hljs-number"><span class="hljs-number">0x71</span></span>, <span class="hljs-number"><span class="hljs-number">0xb0</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x0f</span></span>, <span class="hljs-number"><span class="hljs-number">0x2f</span></span>, <span class="hljs-number"><span class="hljs-number">0xb2</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0x2c</span></span>, <span class="hljs-number"><span class="hljs-number">0x0f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a</span></span>, <span class="hljs-number"><span class="hljs-number">0xac</span></span>, <span class="hljs-number"><span class="hljs-number">0xd1</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0x35</span></span>, <span class="hljs-number"><span class="hljs-number">0x81</span></span>, <span class="hljs-number"><span class="hljs-number">0xc3</span></span>, <span class="hljs-number"><span class="hljs-number">0x4e</span></span>, <span class="hljs-number"><span class="hljs-number">0x97</span></span>, <span class="hljs-number"><span class="hljs-number">0x54</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x41</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0x5e</span></span>, <span class="hljs-number"><span class="hljs-number">0x63</span></span>, <span class="hljs-number"><span class="hljs-number">0x42</span></span>, <span class="hljs-number"><span class="hljs-number">0xd6</span></span>, <span class="hljs-number"><span class="hljs-number">0x69</span></span>, <span class="hljs-number"><span class="hljs-number">0xc4</span></span>, <span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0x3c</span></span>, <span class="hljs-number"><span class="hljs-number">0xd3</span></span>, <span class="hljs-number"><span class="hljs-number">0x93</span></span>, <span class="hljs-number"><span class="hljs-number">0x13</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0x11</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x35</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0xc8</span></span>, <span class="hljs-number"><span class="hljs-number">0xd7</span></span>, <span class="hljs-number"><span class="hljs-number">0x9a</span></span>, <span class="hljs-number"><span class="hljs-number">0x58</span></span>, <span class="hljs-number"><span class="hljs-number">0x62</span></span>, <span class="hljs-number"><span class="hljs-number">0x23</span></span>, <span class="hljs-number"><span class="hljs-number">0x7b</span></span>, <span class="hljs-number"><span class="hljs-number">0x38</span></span>, <span class="hljs-number"><span class="hljs-number">0xe3</span></span>, <span class="hljs-number"><span class="hljs-number">0x37</span></span>, <span class="hljs-number"><span class="hljs-number">0x5c</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0x9d</span></span>, <span class="hljs-number"><span class="hljs-number">0x97</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0xba</span></span>, <span class="hljs-number"><span class="hljs-number">0xbb</span></span>, <span class="hljs-number"><span class="hljs-number">0xd2</span></span>, <span class="hljs-number"><span class="hljs-number">0x22</span></span>, <span class="hljs-number"><span class="hljs-number">0xda</span></span>, <span class="hljs-number"><span class="hljs-number">0x7e</span></span>, <span class="hljs-number"><span class="hljs-number">0x5c</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0xea</span></span>, <span class="hljs-number"><span class="hljs-number">0xd8</span></span>, <span class="hljs-number"><span class="hljs-number">0x2b</span></span>, <span class="hljs-number"><span class="hljs-number">0x13</span></span>, <span class="hljs-number"><span class="hljs-number">0x54</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0x77</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0x7c</span></span>, <span class="hljs-number"><span class="hljs-number">0xe9</span></span>, <span class="hljs-number"><span class="hljs-number">0x87</span></span>, <span class="hljs-number"><span class="hljs-number">0x74</span></span>, <span class="hljs-number"><span class="hljs-number">0x2e</span></span>, <span class="hljs-number"><span class="hljs-number">0xa9</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0x83</span></span>, <span class="hljs-number"><span class="hljs-number">0xbc</span></span>, <span class="hljs-number"><span class="hljs-number">0xc2</span></span>, <span class="hljs-number"><span class="hljs-number">0x41</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0x3a</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x55</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0xfd</span></span>, <span class="hljs-number"><span class="hljs-number">0xcc</span></span>, <span class="hljs-number"><span class="hljs-number">0x73</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0x93</span></span>, <span class="hljs-number"><span class="hljs-number">0x61</span></span>, <span class="hljs-number"><span class="hljs-number">0x46</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0x15</span></span>, <span class="hljs-number"><span class="hljs-number">0x88</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x9b</span></span>, <span class="hljs-number"><span class="hljs-number">0xc3</span></span>, <span class="hljs-number"><span class="hljs-number">0xa4</span></span>, <span class="hljs-number"><span class="hljs-number">0x79</span></span>, <span class="hljs-number"><span class="hljs-number">0x73</span></span>, <span class="hljs-number"><span class="hljs-number">0xc7</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0xe7</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0xa3</span></span>, <span class="hljs-number"><span class="hljs-number">0xc5</span></span>, <span class="hljs-number"><span class="hljs-number">0x09</span></span>, <span class="hljs-number"><span class="hljs-number">0xaa</span></span>, <span class="hljs-number"><span class="hljs-number">0x16</span></span>, <span class="hljs-number"><span class="hljs-number">0xe6</span></span>, <span class="hljs-number"><span class="hljs-number">0x5a</span></span>, <span class="hljs-number"><span class="hljs-number">0xed</span></span>, <span class="hljs-number"><span class="hljs-number">0xb1</span></span>, <span class="hljs-number"><span class="hljs-number">0xc8</span></span>, <span class="hljs-number"><span class="hljs-number">0x31</span></span>, <span class="hljs-number"><span class="hljs-number">0x09</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0xc9</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0x34</span></span>, <span class="hljs-number"><span class="hljs-number">0xb3</span></span>, <span class="hljs-number"><span class="hljs-number">0x18</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0x3e</span></span>, <span class="hljs-number"><span class="hljs-number">0x17</span></span>, <span class="hljs-number"><span class="hljs-number">0xd9</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0x5a</span></span>, <span class="hljs-number"><span class="hljs-number">0x3a</span></span>, <span class="hljs-number"><span class="hljs-number">0xe9</span></span>, <span class="hljs-number"><span class="hljs-number">0x0f</span></span>, <span class="hljs-number"><span class="hljs-number">0xfa</span></span>, <span class="hljs-number"><span class="hljs-number">0x58</span></span>, <span class="hljs-number"><span class="hljs-number">0x34</span></span>, <span class="hljs-number"><span class="hljs-number">0xce</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x43</span></span>, <span class="hljs-number"><span class="hljs-number">0x69</span></span>, <span class="hljs-number"><span class="hljs-number">0x3d</span></span>, <span class="hljs-number"><span class="hljs-number">0x7e</span></span>, <span class="hljs-number"><span class="hljs-number">0x18</span></span>, <span class="hljs-number"><span class="hljs-number">0xb7</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0x2c</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0x47</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>, <span class="hljs-number"><span class="hljs-number">0x69</span></span>, <span class="hljs-number"><span class="hljs-number">0xe9</span></span>, <span class="hljs-number"><span class="hljs-number">0x9d</span></span>, <span class="hljs-number"><span class="hljs-number">0x53</span></span>, <span class="hljs-number"><span class="hljs-number">0xb4</span></span>, <span class="hljs-number"><span class="hljs-number">0xb9</span></span>, <span class="hljs-number"><span class="hljs-number">0xea</span></span>, <span class="hljs-number"><span class="hljs-number">0x19</span></span>, <span class="hljs-number"><span class="hljs-number">0x05</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0xb6</span></span>, <span class="hljs-number"><span class="hljs-number">0xde</span></span>, <span class="hljs-number"><span class="hljs-number">0x31</span></span>, <span class="hljs-number"><span class="hljs-number">0x9f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0e</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0x63</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0x95</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0x6b</span></span>, <span class="hljs-number"><span class="hljs-number">0xce</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0xac</span></span>, <span class="hljs-number"><span class="hljs-number">0x5d</span></span>, <span class="hljs-number"><span class="hljs-number">0xd7</span></span>, <span class="hljs-number"><span class="hljs-number">0x74</span></span>, <span class="hljs-number"><span class="hljs-number">0x53</span></span>, <span class="hljs-number"><span class="hljs-number">0xd3</span></span>, <span class="hljs-number"><span class="hljs-number">0xa7</span></span>, <span class="hljs-number"><span class="hljs-number">0x24</span></span>, <span class="hljs-number"><span class="hljs-number">0x73</span></span>, <span class="hljs-number"><span class="hljs-number">0xcd</span></span>, <span class="hljs-number"><span class="hljs-number">0x72</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x1b</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0x26</span></span>, <span class="hljs-number"><span class="hljs-number">0x41</span></span>, <span class="hljs-number"><span class="hljs-number">0x31</span></span>, <span class="hljs-number"><span class="hljs-number">0x9a</span></span>, <span class="hljs-number"><span class="hljs-number">0xec</span></span>, <span class="hljs-number"><span class="hljs-number">0xd1</span></span>, <span class="hljs-number"><span class="hljs-number">0xfd</span></span>, <span class="hljs-number"><span class="hljs-number">0x83</span></span>, <span class="hljs-number"><span class="hljs-number">0x52</span></span>, <span class="hljs-number"><span class="hljs-number">0x91</span></span>, <span class="hljs-number"><span class="hljs-number">0x03</span></span>, <span class="hljs-number"><span class="hljs-number">0x9b</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x6b</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0xcc</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0x37</span></span>, <span class="hljs-number"><span class="hljs-number">0x43</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0xa4</span></span>, <span class="hljs-number"><span class="hljs-number">0xab</span></span>, <span class="hljs-number"><span class="hljs-number">0x45</span></span>, <span class="hljs-number"><span class="hljs-number">0xde</span></span>, <span class="hljs-number"><span class="hljs-number">0x75</span></span>, <span class="hljs-number"><span class="hljs-number">0x2c</span></span>, <span class="hljs-number"><span class="hljs-number">0x13</span></span>, <span class="hljs-number"><span class="hljs-number">0x46</span></span>, <span class="hljs-number"><span class="hljs-number">0xec</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0x1d</span></span>, <span class="hljs-number"><span class="hljs-number">0x7e</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0xad</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0x42</span></span>, <span class="hljs-number"><span class="hljs-number">0x7c</span></span>, <span class="hljs-number"><span class="hljs-number">0x25</span></span>, <span class="hljs-number"><span class="hljs-number">0x4e</span></span>, <span class="hljs-number"><span class="hljs-number">0x39</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>, <span class="hljs-number"><span class="hljs-number">0x23</span></span>, <span class="hljs-number"><span class="hljs-number">0xe2</span></span>, <span class="hljs-number"><span class="hljs-number">0xa3</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x1e</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x03</span></span>, <span class="hljs-number"><span class="hljs-number">0xdb</span></span>, <span class="hljs-number"><span class="hljs-number">0xa7</span></span>, <span class="hljs-number"><span class="hljs-number">0x2e</span></span>, <span class="hljs-number"><span class="hljs-number">0x34</span></span>, <span class="hljs-number"><span class="hljs-number">0x5f</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0x3b</span></span>, <span class="hljs-number"><span class="hljs-number">0x95</span></span>, <span class="hljs-number"><span class="hljs-number">0x33</span></span>, <span class="hljs-number"><span class="hljs-number">0x3f</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0x1f</span></span>, <span class="hljs-number"><span class="hljs-number">0x5e</span></span>, <span class="hljs-number"><span class="hljs-number">0xa7</span></span>, <span class="hljs-number"><span class="hljs-number">0xd8</span></span>, <span class="hljs-number"><span class="hljs-number">0x58</span></span>, <span class="hljs-number"><span class="hljs-number">0x1e</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0x9b</span></span>, <span class="hljs-number"><span class="hljs-number">0x61</span></span>, <span class="hljs-number"><span class="hljs-number">0xf1</span></span>, <span class="hljs-number"><span class="hljs-number">0x6a</span></span>, <span class="hljs-number"><span class="hljs-number">0xc1</span></span>, <span class="hljs-number"><span class="hljs-number">0x45</span></span>, <span class="hljs-number"><span class="hljs-number">0x9c</span></span>, <span class="hljs-number"><span class="hljs-number">0xed</span></span>, <span class="hljs-number"><span class="hljs-number">0xa8</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, };</code> </pre> </div></div><br><h3 id="ustroystvo-uzla-zameny">  Replacement Unit Device </h3><br><p>  In the standard, the replacement node is specified in a table of values;  cipher developers claim that this table was obtained by iterating random tables of values ‚Äã‚Äãwith regard to the requirements for linear and differential properties. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/734/727/4cd/7347274cd4da4ef6a17031a54fbdf8fe.png" width="500"></div><br><p>  <i>Substitution layer, S-transform</i> </p><br><div class="spoiler">  <b class="spoiler_title">Replacement node and reverse to it in C-friendly form</b> <div class="spoiler_text"><pre> <code class="hljs go"><span class="hljs-comment"><span class="hljs-comment">/*   pi    34.12  2015. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> uint8_t Pi[<span class="hljs-number"><span class="hljs-number">256</span></span>] = { <span class="hljs-number"><span class="hljs-number">0xfc</span></span>, <span class="hljs-number"><span class="hljs-number">0xee</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0x11</span></span>, <span class="hljs-number"><span class="hljs-number">0xcf</span></span>, <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0x31</span></span>, <span class="hljs-number"><span class="hljs-number">0x16</span></span>, <span class="hljs-number"><span class="hljs-number">0xfb</span></span>, <span class="hljs-number"><span class="hljs-number">0xc4</span></span>, <span class="hljs-number"><span class="hljs-number">0xfa</span></span>, <span class="hljs-number"><span class="hljs-number">0xda</span></span>, <span class="hljs-number"><span class="hljs-number">0x23</span></span>, <span class="hljs-number"><span class="hljs-number">0xc5</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4d</span></span>, <span class="hljs-number"><span class="hljs-number">0xe9</span></span>, <span class="hljs-number"><span class="hljs-number">0x77</span></span>, <span class="hljs-number"><span class="hljs-number">0xf0</span></span>, <span class="hljs-number"><span class="hljs-number">0xdb</span></span>, <span class="hljs-number"><span class="hljs-number">0x93</span></span>, <span class="hljs-number"><span class="hljs-number">0x2e</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0xba</span></span>, <span class="hljs-number"><span class="hljs-number">0x17</span></span>, <span class="hljs-number"><span class="hljs-number">0x36</span></span>, <span class="hljs-number"><span class="hljs-number">0xf1</span></span>, <span class="hljs-number"><span class="hljs-number">0xbb</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0xcd</span></span>, <span class="hljs-number"><span class="hljs-number">0x5f</span></span>, <span class="hljs-number"><span class="hljs-number">0xc1</span></span>, <span class="hljs-number"><span class="hljs-number">0xf9</span></span>, <span class="hljs-number"><span class="hljs-number">0x18</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x5a</span></span>, <span class="hljs-number"><span class="hljs-number">0xe2</span></span>, <span class="hljs-number"><span class="hljs-number">0x5c</span></span>, <span class="hljs-number"><span class="hljs-number">0xef</span></span>, <span class="hljs-number"><span class="hljs-number">0x21</span></span>, <span class="hljs-number"><span class="hljs-number">0x81</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0x3c</span></span>, <span class="hljs-number"><span class="hljs-number">0x42</span></span>, <span class="hljs-number"><span class="hljs-number">0x8b</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0x4f</span></span>, <span class="hljs-number"><span class="hljs-number">0x05</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xae</span></span>, <span class="hljs-number"><span class="hljs-number">0xe3</span></span>, <span class="hljs-number"><span class="hljs-number">0x6a</span></span>, <span class="hljs-number"><span class="hljs-number">0x8f</span></span>, <span class="hljs-number"><span class="hljs-number">0xa0</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0x0b</span></span>, <span class="hljs-number"><span class="hljs-number">0xed</span></span>, <span class="hljs-number"><span class="hljs-number">0x98</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0xd3</span></span>, <span class="hljs-number"><span class="hljs-number">0x1f</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0x34</span></span>, <span class="hljs-number"><span class="hljs-number">0x2c</span></span>, <span class="hljs-number"><span class="hljs-number">0x51</span></span>, <span class="hljs-number"><span class="hljs-number">0xea</span></span>, <span class="hljs-number"><span class="hljs-number">0xc8</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0xab</span></span>, <span class="hljs-number"><span class="hljs-number">0xf2</span></span>, <span class="hljs-number"><span class="hljs-number">0x2a</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0xfd</span></span>, <span class="hljs-number"><span class="hljs-number">0x3a</span></span>, <span class="hljs-number"><span class="hljs-number">0xce</span></span>, <span class="hljs-number"><span class="hljs-number">0xcc</span></span>, <span class="hljs-number"><span class="hljs-number">0xb5</span></span>, <span class="hljs-number"><span class="hljs-number">0x70</span></span>, <span class="hljs-number"><span class="hljs-number">0x0e</span></span>, <span class="hljs-number"><span class="hljs-number">0x56</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x0c</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x72</span></span>, <span class="hljs-number"><span class="hljs-number">0x13</span></span>, <span class="hljs-number"><span class="hljs-number">0x47</span></span>, <span class="hljs-number"><span class="hljs-number">0x9c</span></span>, <span class="hljs-number"><span class="hljs-number">0xb7</span></span>, <span class="hljs-number"><span class="hljs-number">0x5d</span></span>, <span class="hljs-number"><span class="hljs-number">0x87</span></span>, <span class="hljs-number"><span class="hljs-number">0x15</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0x96</span></span>, <span class="hljs-number"><span class="hljs-number">0x29</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x7b</span></span>, <span class="hljs-number"><span class="hljs-number">0x9a</span></span>, <span class="hljs-number"><span class="hljs-number">0xc7</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x91</span></span>, <span class="hljs-number"><span class="hljs-number">0x78</span></span>, <span class="hljs-number"><span class="hljs-number">0x6f</span></span>, <span class="hljs-number"><span class="hljs-number">0x9d</span></span>, <span class="hljs-number"><span class="hljs-number">0x9e</span></span>, <span class="hljs-number"><span class="hljs-number">0xb2</span></span>, <span class="hljs-number"><span class="hljs-number">0xb1</span></span>, <span class="hljs-number"><span class="hljs-number">0x32</span></span>, <span class="hljs-number"><span class="hljs-number">0x75</span></span>, <span class="hljs-number"><span class="hljs-number">0x19</span></span>, <span class="hljs-number"><span class="hljs-number">0x3d</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0x35</span></span>, <span class="hljs-number"><span class="hljs-number">0x8a</span></span>, <span class="hljs-number"><span class="hljs-number">0x7e</span></span>, <span class="hljs-number"><span class="hljs-number">0x6d</span></span>, <span class="hljs-number"><span class="hljs-number">0x54</span></span>, <span class="hljs-number"><span class="hljs-number">0xc6</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0xc3</span></span>, <span class="hljs-number"><span class="hljs-number">0xbd</span></span>, <span class="hljs-number"><span class="hljs-number">0x0d</span></span>, <span class="hljs-number"><span class="hljs-number">0x57</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0xf5</span></span>, <span class="hljs-number"><span class="hljs-number">0x24</span></span>, <span class="hljs-number"><span class="hljs-number">0xa9</span></span>, <span class="hljs-number"><span class="hljs-number">0x3e</span></span>, <span class="hljs-number"><span class="hljs-number">0xa8</span></span>, <span class="hljs-number"><span class="hljs-number">0x43</span></span>, <span class="hljs-number"><span class="hljs-number">0xc9</span></span>, <span class="hljs-number"><span class="hljs-number">0xd7</span></span>, <span class="hljs-number"><span class="hljs-number">0x79</span></span>, <span class="hljs-number"><span class="hljs-number">0xd6</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0x7c</span></span>, <span class="hljs-number"><span class="hljs-number">0x22</span></span>, <span class="hljs-number"><span class="hljs-number">0xb9</span></span>, <span class="hljs-number"><span class="hljs-number">0x03</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0f</span></span>, <span class="hljs-number"><span class="hljs-number">0xec</span></span>, <span class="hljs-number"><span class="hljs-number">0xde</span></span>, <span class="hljs-number"><span class="hljs-number">0x7a</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0xb0</span></span>, <span class="hljs-number"><span class="hljs-number">0xbc</span></span>, <span class="hljs-number"><span class="hljs-number">0xdc</span></span>, <span class="hljs-number"><span class="hljs-number">0xe8</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>, <span class="hljs-number"><span class="hljs-number">0x50</span></span>, <span class="hljs-number"><span class="hljs-number">0x4e</span></span>, <span class="hljs-number"><span class="hljs-number">0x33</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a</span></span>, <span class="hljs-number"><span class="hljs-number">0x4a</span></span>, <span class="hljs-number"><span class="hljs-number">0xa7</span></span>, <span class="hljs-number"><span class="hljs-number">0x97</span></span>, <span class="hljs-number"><span class="hljs-number">0x60</span></span>, <span class="hljs-number"><span class="hljs-number">0x73</span></span>, <span class="hljs-number"><span class="hljs-number">0x1e</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x62</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0x38</span></span>, <span class="hljs-number"><span class="hljs-number">0x82</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0x9f</span></span>, <span class="hljs-number"><span class="hljs-number">0x26</span></span>, <span class="hljs-number"><span class="hljs-number">0x41</span></span>, <span class="hljs-number"><span class="hljs-number">0xad</span></span>, <span class="hljs-number"><span class="hljs-number">0x45</span></span>, <span class="hljs-number"><span class="hljs-number">0x46</span></span>, <span class="hljs-number"><span class="hljs-number">0x92</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0x5e</span></span>, <span class="hljs-number"><span class="hljs-number">0x55</span></span>, <span class="hljs-number"><span class="hljs-number">0x2f</span></span>, <span class="hljs-number"><span class="hljs-number">0x8c</span></span>, <span class="hljs-number"><span class="hljs-number">0xa3</span></span>, <span class="hljs-number"><span class="hljs-number">0xa5</span></span>, <span class="hljs-number"><span class="hljs-number">0x7d</span></span>, <span class="hljs-number"><span class="hljs-number">0x69</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0x95</span></span>, <span class="hljs-number"><span class="hljs-number">0x3b</span></span>, <span class="hljs-number"><span class="hljs-number">0x07</span></span>, <span class="hljs-number"><span class="hljs-number">0x58</span></span>, <span class="hljs-number"><span class="hljs-number">0xb3</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x86</span></span>, <span class="hljs-number"><span class="hljs-number">0xac</span></span>, <span class="hljs-number"><span class="hljs-number">0x1d</span></span>, <span class="hljs-number"><span class="hljs-number">0xf7</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0x37</span></span>, <span class="hljs-number"><span class="hljs-number">0x6b</span></span>, <span class="hljs-number"><span class="hljs-number">0xe4</span></span>, <span class="hljs-number"><span class="hljs-number">0x88</span></span>, <span class="hljs-number"><span class="hljs-number">0xd9</span></span>, <span class="hljs-number"><span class="hljs-number">0xe7</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0xe1</span></span>, <span class="hljs-number"><span class="hljs-number">0x1b</span></span>, <span class="hljs-number"><span class="hljs-number">0x83</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0x4c</span></span>, <span class="hljs-number"><span class="hljs-number">0x3f</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0xfe</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0x53</span></span>, <span class="hljs-number"><span class="hljs-number">0xaa</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0xca</span></span>, <span class="hljs-number"><span class="hljs-number">0xd8</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0x61</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x71</span></span>, <span class="hljs-number"><span class="hljs-number">0x67</span></span>, <span class="hljs-number"><span class="hljs-number">0xa4</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0x2b</span></span>, <span class="hljs-number"><span class="hljs-number">0x09</span></span>, <span class="hljs-number"><span class="hljs-number">0x5b</span></span>, <span class="hljs-number"><span class="hljs-number">0xcb</span></span>, <span class="hljs-number"><span class="hljs-number">0x9b</span></span>, <span class="hljs-number"><span class="hljs-number">0x25</span></span>, <span class="hljs-number"><span class="hljs-number">0xd0</span></span>, <span class="hljs-number"><span class="hljs-number">0xbe</span></span>, <span class="hljs-number"><span class="hljs-number">0xe5</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0x52</span></span>, <span class="hljs-number"><span class="hljs-number">0x59</span></span>, <span class="hljs-number"><span class="hljs-number">0xa6</span></span>, <span class="hljs-number"><span class="hljs-number">0x74</span></span>, <span class="hljs-number"><span class="hljs-number">0xd2</span></span>, <span class="hljs-number"><span class="hljs-number">0xe6</span></span>, <span class="hljs-number"><span class="hljs-number">0xf4</span></span>, <span class="hljs-number"><span class="hljs-number">0xb4</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0xd1</span></span>, <span class="hljs-number"><span class="hljs-number">0x66</span></span>, <span class="hljs-number"><span class="hljs-number">0xaf</span></span>, <span class="hljs-number"><span class="hljs-number">0xc2</span></span>, <span class="hljs-number"><span class="hljs-number">0x39</span></span>, <span class="hljs-number"><span class="hljs-number">0x4b</span></span>, <span class="hljs-number"><span class="hljs-number">0x63</span></span>, <span class="hljs-number"><span class="hljs-number">0xb6</span></span>, }; <span class="hljs-comment"><span class="hljs-comment">/*  ,   pi,    34.12  2015. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> uint8_t InversedPi[<span class="hljs-number"><span class="hljs-number">256</span></span>] = { <span class="hljs-number"><span class="hljs-number">0xa5</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0x32</span></span>, <span class="hljs-number"><span class="hljs-number">0x8f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0e</span></span>, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-number"><span class="hljs-number">0x38</span></span>, <span class="hljs-number"><span class="hljs-number">0xc0</span></span>, <span class="hljs-number"><span class="hljs-number">0x54</span></span>, <span class="hljs-number"><span class="hljs-number">0xe6</span></span>, <span class="hljs-number"><span class="hljs-number">0x9e</span></span>, <span class="hljs-number"><span class="hljs-number">0x39</span></span>, <span class="hljs-number"><span class="hljs-number">0x55</span></span>, <span class="hljs-number"><span class="hljs-number">0x7e</span></span>, <span class="hljs-number"><span class="hljs-number">0x52</span></span>, <span class="hljs-number"><span class="hljs-number">0x91</span></span>, <span class="hljs-number"><span class="hljs-number">0x64</span></span>, <span class="hljs-number"><span class="hljs-number">0x03</span></span>, <span class="hljs-number"><span class="hljs-number">0x57</span></span>, <span class="hljs-number"><span class="hljs-number">0x5a</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0x60</span></span>, <span class="hljs-number"><span class="hljs-number">0x07</span></span>, <span class="hljs-number"><span class="hljs-number">0x18</span></span>, <span class="hljs-number"><span class="hljs-number">0x21</span></span>, <span class="hljs-number"><span class="hljs-number">0x72</span></span>, <span class="hljs-number"><span class="hljs-number">0xa8</span></span>, <span class="hljs-number"><span class="hljs-number">0xd1</span></span>, <span class="hljs-number"><span class="hljs-number">0x29</span></span>, <span class="hljs-number"><span class="hljs-number">0xc6</span></span>, <span class="hljs-number"><span class="hljs-number">0xa4</span></span>, <span class="hljs-number"><span class="hljs-number">0x3f</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>, <span class="hljs-number"><span class="hljs-number">0x27</span></span>, <span class="hljs-number"><span class="hljs-number">0x8d</span></span>, <span class="hljs-number"><span class="hljs-number">0x0c</span></span>, <span class="hljs-number"><span class="hljs-number">0x82</span></span>, <span class="hljs-number"><span class="hljs-number">0xea</span></span>, <span class="hljs-number"><span class="hljs-number">0xae</span></span>, <span class="hljs-number"><span class="hljs-number">0xb4</span></span>, <span class="hljs-number"><span class="hljs-number">0x9a</span></span>, <span class="hljs-number"><span class="hljs-number">0x63</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0xe5</span></span>, <span class="hljs-number"><span class="hljs-number">0x42</span></span>, <span class="hljs-number"><span class="hljs-number">0xe4</span></span>, <span class="hljs-number"><span class="hljs-number">0x15</span></span>, <span class="hljs-number"><span class="hljs-number">0xb7</span></span>, <span class="hljs-number"><span class="hljs-number">0xc8</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0x70</span></span>, <span class="hljs-number"><span class="hljs-number">0x9d</span></span>, <span class="hljs-number"><span class="hljs-number">0x41</span></span>, <span class="hljs-number"><span class="hljs-number">0x75</span></span>, <span class="hljs-number"><span class="hljs-number">0x19</span></span>, <span class="hljs-number"><span class="hljs-number">0xc9</span></span>, <span class="hljs-number"><span class="hljs-number">0xaa</span></span>, <span class="hljs-number"><span class="hljs-number">0xfc</span></span>, <span class="hljs-number"><span class="hljs-number">0x4d</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x2a</span></span>, <span class="hljs-number"><span class="hljs-number">0x73</span></span>, <span class="hljs-number"><span class="hljs-number">0x84</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0xc3</span></span>, <span class="hljs-number"><span class="hljs-number">0xaf</span></span>, <span class="hljs-number"><span class="hljs-number">0x2b</span></span>, <span class="hljs-number"><span class="hljs-number">0x86</span></span>, <span class="hljs-number"><span class="hljs-number">0xa7</span></span>, <span class="hljs-number"><span class="hljs-number">0xb1</span></span>, <span class="hljs-number"><span class="hljs-number">0xb2</span></span>, <span class="hljs-number"><span class="hljs-number">0x5b</span></span>, <span class="hljs-number"><span class="hljs-number">0x46</span></span>, <span class="hljs-number"><span class="hljs-number">0xd3</span></span>, <span class="hljs-number"><span class="hljs-number">0x9f</span></span>, <span class="hljs-number"><span class="hljs-number">0xfd</span></span>, <span class="hljs-number"><span class="hljs-number">0xd4</span></span>, <span class="hljs-number"><span class="hljs-number">0x0f</span></span>, <span class="hljs-number"><span class="hljs-number">0x9c</span></span>, <span class="hljs-number"><span class="hljs-number">0x2f</span></span>, <span class="hljs-number"><span class="hljs-number">0x9b</span></span>, <span class="hljs-number"><span class="hljs-number">0x43</span></span>, <span class="hljs-number"><span class="hljs-number">0xef</span></span>, <span class="hljs-number"><span class="hljs-number">0xd9</span></span>, <span class="hljs-number"><span class="hljs-number">0x79</span></span>, <span class="hljs-number"><span class="hljs-number">0xb6</span></span>, <span class="hljs-number"><span class="hljs-number">0x53</span></span>, <span class="hljs-number"><span class="hljs-number">0x7f</span></span>, <span class="hljs-number"><span class="hljs-number">0xc1</span></span>, <span class="hljs-number"><span class="hljs-number">0xf0</span></span>, <span class="hljs-number"><span class="hljs-number">0x23</span></span>, <span class="hljs-number"><span class="hljs-number">0xe7</span></span>, <span class="hljs-number"><span class="hljs-number">0x25</span></span>, <span class="hljs-number"><span class="hljs-number">0x5e</span></span>, <span class="hljs-number"><span class="hljs-number">0xb5</span></span>, <span class="hljs-number"><span class="hljs-number">0x1e</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0xa6</span></span>, <span class="hljs-number"><span class="hljs-number">0xfe</span></span>, <span class="hljs-number"><span class="hljs-number">0xac</span></span>, <span class="hljs-number"><span class="hljs-number">0x22</span></span>, <span class="hljs-number"><span class="hljs-number">0xf9</span></span>, <span class="hljs-number"><span class="hljs-number">0xe2</span></span>, <span class="hljs-number"><span class="hljs-number">0x4a</span></span>, <span class="hljs-number"><span class="hljs-number">0xbc</span></span>, <span class="hljs-number"><span class="hljs-number">0x35</span></span>, <span class="hljs-number"><span class="hljs-number">0xca</span></span>, <span class="hljs-number"><span class="hljs-number">0xee</span></span>, <span class="hljs-number"><span class="hljs-number">0x78</span></span>, <span class="hljs-number"><span class="hljs-number">0x05</span></span>, <span class="hljs-number"><span class="hljs-number">0x6b</span></span>, <span class="hljs-number"><span class="hljs-number">0x51</span></span>, <span class="hljs-number"><span class="hljs-number">0xe1</span></span>, <span class="hljs-number"><span class="hljs-number">0x59</span></span>, <span class="hljs-number"><span class="hljs-number">0xa3</span></span>, <span class="hljs-number"><span class="hljs-number">0xf2</span></span>, <span class="hljs-number"><span class="hljs-number">0x71</span></span>, <span class="hljs-number"><span class="hljs-number">0x56</span></span>, <span class="hljs-number"><span class="hljs-number">0x11</span></span>, <span class="hljs-number"><span class="hljs-number">0x6a</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0x94</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x8c</span></span>, <span class="hljs-number"><span class="hljs-number">0xbb</span></span>, <span class="hljs-number"><span class="hljs-number">0x77</span></span>, <span class="hljs-number"><span class="hljs-number">0x3c</span></span>, <span class="hljs-number"><span class="hljs-number">0x7b</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>, <span class="hljs-number"><span class="hljs-number">0xab</span></span>, <span class="hljs-number"><span class="hljs-number">0xd2</span></span>, <span class="hljs-number"><span class="hljs-number">0x31</span></span>, <span class="hljs-number"><span class="hljs-number">0xde</span></span>, <span class="hljs-number"><span class="hljs-number">0xc4</span></span>, <span class="hljs-number"><span class="hljs-number">0x5f</span></span>, <span class="hljs-number"><span class="hljs-number">0xcc</span></span>, <span class="hljs-number"><span class="hljs-number">0xcf</span></span>, <span class="hljs-number"><span class="hljs-number">0x76</span></span>, <span class="hljs-number"><span class="hljs-number">0x2c</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0xd8</span></span>, <span class="hljs-number"><span class="hljs-number">0x2e</span></span>, <span class="hljs-number"><span class="hljs-number">0x36</span></span>, <span class="hljs-number"><span class="hljs-number">0xdb</span></span>, <span class="hljs-number"><span class="hljs-number">0x69</span></span>, <span class="hljs-number"><span class="hljs-number">0xb3</span></span>, <span class="hljs-number"><span class="hljs-number">0x14</span></span>, <span class="hljs-number"><span class="hljs-number">0x95</span></span>, <span class="hljs-number"><span class="hljs-number">0xbe</span></span>, <span class="hljs-number"><span class="hljs-number">0x62</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0x3b</span></span>, <span class="hljs-number"><span class="hljs-number">0x16</span></span>, <span class="hljs-number"><span class="hljs-number">0x66</span></span>, <span class="hljs-number"><span class="hljs-number">0xe9</span></span>, <span class="hljs-number"><span class="hljs-number">0x5c</span></span>, <span class="hljs-number"><span class="hljs-number">0x6c</span></span>, <span class="hljs-number"><span class="hljs-number">0x6d</span></span>, <span class="hljs-number"><span class="hljs-number">0xad</span></span>, <span class="hljs-number"><span class="hljs-number">0x37</span></span>, <span class="hljs-number"><span class="hljs-number">0x61</span></span>, <span class="hljs-number"><span class="hljs-number">0x4b</span></span>, <span class="hljs-number"><span class="hljs-number">0xb9</span></span>, <span class="hljs-number"><span class="hljs-number">0xe3</span></span>, <span class="hljs-number"><span class="hljs-number">0xba</span></span>, <span class="hljs-number"><span class="hljs-number">0xf1</span></span>, <span class="hljs-number"><span class="hljs-number">0xa0</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0x83</span></span>, <span class="hljs-number"><span class="hljs-number">0xda</span></span>, <span class="hljs-number"><span class="hljs-number">0x47</span></span>, <span class="hljs-number"><span class="hljs-number">0xc5</span></span>, <span class="hljs-number"><span class="hljs-number">0xb0</span></span>, <span class="hljs-number"><span class="hljs-number">0x33</span></span>, <span class="hljs-number"><span class="hljs-number">0xfa</span></span>, <span class="hljs-number"><span class="hljs-number">0x96</span></span>, <span class="hljs-number"><span class="hljs-number">0x6f</span></span>, <span class="hljs-number"><span class="hljs-number">0x6e</span></span>, <span class="hljs-number"><span class="hljs-number">0xc2</span></span>, <span class="hljs-number"><span class="hljs-number">0xf6</span></span>, <span class="hljs-number"><span class="hljs-number">0x50</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0x5d</span></span>, <span class="hljs-number"><span class="hljs-number">0xa9</span></span>, <span class="hljs-number"><span class="hljs-number">0x8e</span></span>, <span class="hljs-number"><span class="hljs-number">0x17</span></span>, <span class="hljs-number"><span class="hljs-number">0x1b</span></span>, <span class="hljs-number"><span class="hljs-number">0x97</span></span>, <span class="hljs-number"><span class="hljs-number">0x7d</span></span>, <span class="hljs-number"><span class="hljs-number">0xec</span></span>, <span class="hljs-number"><span class="hljs-number">0x58</span></span>, <span class="hljs-number"><span class="hljs-number">0xf7</span></span>, <span class="hljs-number"><span class="hljs-number">0x1f</span></span>, <span class="hljs-number"><span class="hljs-number">0xfb</span></span>, <span class="hljs-number"><span class="hljs-number">0x7c</span></span>, <span class="hljs-number"><span class="hljs-number">0x09</span></span>, <span class="hljs-number"><span class="hljs-number">0x0d</span></span>, <span class="hljs-number"><span class="hljs-number">0x7a</span></span>, <span class="hljs-number"><span class="hljs-number">0x67</span></span>, <span class="hljs-number"><span class="hljs-number">0x45</span></span>, <span class="hljs-number"><span class="hljs-number">0x87</span></span>, <span class="hljs-number"><span class="hljs-number">0xdc</span></span>, <span class="hljs-number"><span class="hljs-number">0xe8</span></span>, <span class="hljs-number"><span class="hljs-number">0x4f</span></span>, <span class="hljs-number"><span class="hljs-number">0x1d</span></span>, <span class="hljs-number"><span class="hljs-number">0x4e</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0xeb</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x3e</span></span>, <span class="hljs-number"><span class="hljs-number">0x3d</span></span>, <span class="hljs-number"><span class="hljs-number">0xbd</span></span>, <span class="hljs-number"><span class="hljs-number">0x8a</span></span>, <span class="hljs-number"><span class="hljs-number">0x88</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0xcd</span></span>, <span class="hljs-number"><span class="hljs-number">0x0b</span></span>, <span class="hljs-number"><span class="hljs-number">0x13</span></span>, <span class="hljs-number"><span class="hljs-number">0x98</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0x93</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0xd0</span></span>, <span class="hljs-number"><span class="hljs-number">0x24</span></span>, <span class="hljs-number"><span class="hljs-number">0x34</span></span>, <span class="hljs-number"><span class="hljs-number">0xcb</span></span>, <span class="hljs-number"><span class="hljs-number">0xed</span></span>, <span class="hljs-number"><span class="hljs-number">0xf4</span></span>, <span class="hljs-number"><span class="hljs-number">0xce</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>, <span class="hljs-number"><span class="hljs-number">0x92</span></span>, <span class="hljs-number"><span class="hljs-number">0x3a</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x26</span></span>, <span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0x1a</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0xf5</span></span>, <span class="hljs-number"><span class="hljs-number">0x81</span></span>, <span class="hljs-number"><span class="hljs-number">0x8b</span></span>, <span class="hljs-number"><span class="hljs-number">0xc7</span></span>, <span class="hljs-number"><span class="hljs-number">0xd6</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a</span></span>, <span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x4c</span></span>, <span class="hljs-number"><span class="hljs-number">0xd7</span></span>, <span class="hljs-number"><span class="hljs-number">0x74</span></span>, };</code> </pre> </div></div><br><p>  However, all secrets sooner or later becomes clear, and the method of selecting a replacement node is no exception.  A team of cryptographers from Luxembourg, headed by Alex Biryukov, was able to detect certain kinds of patterns in the statistical characteristics of the replacement node, which, in turn, allowed them to recover the method of obtaining it.  You can read more about this method in their <a href="https://eprint.iacr.org/2016/071.pdf">article</a> published on iacr.org. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8c4/666/cfd/8c4666cfd9184651a642307993fa4bc4.png" width="274"></div><br><p>  <i>Secret structure replacement node</i> </p><br><h2 id="algoritmicheskaya-optimizaciya">  Algorithmic optimization </h2><br><p>  A team of researchers from OAO InfoTeKS, specifically Mikhail Borodin and Andrey Rybkin, managed to borrow algorithmic optimization of vector multiplication by a column from the high-speed implementations of the AES (Rijndael) cipher, which allows replacing the classical multiplication implementation with O (n ^ 2) multiplications in the field by O (n) additions modulo two vectors of length O (n) using pre-calculated tables, and which was reported at the RusCrypto conference, in memory of me, in 2014. </p><br><p>  In short, the optimization is as follows: for example, as a result of the product of some vector <em>U</em> </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AU%20%3D%20%5Cleft(%20u_0%2C%20u_1%2C%20%5Cdots%2C%20u_%7Bn%20-%201%7D%20%5Cright)%20%5Cin%20%5Cleft(%5Cmathrm%7BGF%7D(256)%5Cright)%5En%0A" alt="U = \ left (u_0, u_1, \ dots, u_ {n - 1} \ right) \ in \ left (\ mathrm {GF} (256) \ right) ^ n"></div><p></p><br><p>  to matrix <em>A</em> </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AA%20%3D%20%0A%5Cbegin%7Bpmatrix%7D%0Aa_%7B0%2C%200%7D%20%20%20%26%20a_%7B0%2C%201%7D%20%20%20%26%20%5Ccdots%20%26%20a_%7B0%2C%20n-1%7D%20%5C%5C%0Aa_%7B1%2C%200%7D%20%20%20%26%20a_%7B1%2C%201%7D%20%20%20%26%20%5Ccdots%20%26%20a_%7B1%2C%20n-1%7D%20%5C%5C%0A%5Cvdots%20%20%20%20%20%26%20%5Cvdots%20%20%20%20%20%26%20%5Cddots%20%26%20%5Cvdots%20%5C%5C%0Aa_%7Bn-1%2C%200%7D%20%26%20a_%7Bn-1%2C%201%7D%20%26%20%5Ccdots%20%26%20a_%7Bn-1%2C%20n-1%7D%20%0A%5Cend%7Bpmatrix%7D_%7Bn%20%5Ctimes%20n%7D%20%5Cin%20%5Cleft(%20GF(256)%20%5Cright)%5E%7Bn%20%5Ctimes%20n%7D%0A" alt="A = \ begin {pmatrix} a_ {0, 0} &amp; amp; a_ {0, 1} &amp; amp; \ cdots &amp; amp; a_ {0, n-1} \\ a_ {1, 0} &amp; amp; a_ {1, 1} &amp; amp; \ cdots &amp; amp; a_ {1, n-1} \\ \ vdots &amp; amp; \ vdots &amp; amp; \ ddots &amp; amp; \ vdots \\ a_ {n-1, 0} &amp; amp; a_ {n-1, 1} &amp; amp; \ cdots &amp; amp; a_ {n-1, n-1} \ end {pmatrix} _ {n \ times n} \ in \ left (GF (256) \ right) ^ {n \ times n}"></div><p></p><br><p>  turned out vector <em>V</em> : </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AV%20%3D%20U%20%5Ctimes%20A%20%3D%20%5Cleft(%20v_0%2C%20v_1%2C%20%5Cdots%2C%20v_%7Bn-1%7D%20%5Cright).%0A" alt="V = U \ times A = \ left (v_0, v_1, \ dots, v_ {n-1} \ right)."></div><p></p><br><p>  The traditional way to calculate the components of this vector is to sequentially scalar multiply the rows of the vector <em>U</em> by the columns of the matrix <em>A</em> : </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0Av_i%20%3D%20%5Cbigoplus_%7Bj%20%3D%200%7D%5E%7Bn-1%7D%20u_j%20a_%7Bj%2C%20i%7D%0A" alt="v_i = \ bigoplus_ {j = 0} ^ {n-1} u_j a_ {j, i}"></div><p></p><br><p>  The calculation of each of the <em>n</em> components of the vector <em>V</em> implies <em>n</em> multiplication operations in the field and the <em>n-1</em> modulo-2 addition operation, so the complexity of calculating all the components is O (n ^ 2).  Yes, of course, you can not multiply in the field each time; you can calculate the logarithm tables and exponents in advance;  you can even calculate in advance the works of all possible bytes on the matrix elements (the matrix is ‚Äã‚Äãfixed and does not change during the encryption process), and store ~ ‚Äã‚Äã256 tables of 256 byte-products.  Are there identical elements in the matrix?  Well, the number of tables can be reduced, but the asymptotic complexity will not change. </p><br><p>  And you can go the other way.  Instead of calculating each component of a work vector as the sum of <em>n</em> single-byte projections, we use the feature of multiplying the vector by the matrix and calculate all the components of the vector at once as the sum of <em>n</em> vectors: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AV%20%3D%20%0A%5Cleft(%20%5Cbigoplus_j%20m_j%20a_%7Bj%2C%200%7D%2C%20%5Cbigoplus_j%20m_j%20a_%7Bj%2C%201%7D%2C%20%5Cdots%2C%20%5Cbigoplus_j%20m_j%20a_%7Bj%2C%20n-1%7D%20%5Cright)%20%3D%0A%5Cbigoplus_j%20m_j%20%5Cleft(%20a_%7Bj%2C%200%7D%2C%20a_%7Bj%2C%201%7D%2C%20%5Cdots%2C%20a_%7Bj%2C%20n-1%7D%20%5Cright).%0A" alt="V = \ left (\ bigoplus_j m_j a_ {j, 0}, \ bigoplus_j m_j a_ {j, 1}, \ dots, \ bigoplus_j m_j a_ {j, n-1} \ right) = \ bigoplus_j m_j \ left (a_ {j, 0}, a_ {j, 1}, \ dots, a_ {j, n-1} \ right)."></div><p></p><br><p>  It would seem that changed?  The same operations, but in a different order.  I note, however, that, firstly, the sum of the terms increased from one byte to <em>n</em> bytes, and such amounts can (and should) be calculated in long registers, and, secondly, each term is an component-wise product of one (!) Byte of the vector on a fixed row matrix. </p><br><p>  Here in more detail: you can calculate in advance the work of the form </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0Am_i%20%5Ctimes%20%5Cleft(%20a_%7Bi%2C%200%7D%2C%20a_%7Bi%2C%201%7D%2C%20%5Cdots%2C%20a_%7Bi%2C%20n-1%7D%20%5Cright)%20%5Cquad%20%5Cforall%20m_i%20%5Cin%20%5Cmathrm%7BGF%7D(256)%2C%0A" alt="m_i \ times \ left (a_ {i, 0}, a_ {i, 1}, \ dots, a_ {i, n-1} \ right) \ quad \ forall m_i \ in \ mathrm {GF} (256),"></div><p></p><br><p>  that is, multiply the known row <em>i of the</em> matrix <em>A</em> by all possible values ‚Äã‚Äãof byte <em>i of the</em> vector <em>U</em> , and instead of multiplying the next byte by this row, simply read the product from the table.  Then the multiplication of the vector by the matrix is ‚Äã‚Äãreduced to reading the <em>n</em> product lines from the previously calculated table and the bitwise addition of these lines to get the resultant vector <em>V.</em>  So, quite simply, you can greatly simplify the multiplication of a vector by a matrix to O (n), if the addition of vectors is considered elementary operations. </p><br><p>  In the case of GOST R 34.12 '15 <em>n</em> = 16, for example, vectors have lengths of 16 bytes, or 128 bits, and fit very well into long XMM registers, and for their addition additional processor instructions are provided, for example, <code>pxor</code> . </p><br><p>  Everything is very cool, but what about the replacement node?  The reader will certainly notice that in the presence of byte replacement nodes, which generally do not vectorize, all the algorithmic charms of such an <em>L</em> -transformation are leveled by the cost of loading vectors into registers before conversion and unloading after conversion.  Good question. </p><br><p>  Good, and very elegantly solved.  It turns out that the replacement nodes can simply be ‚Äúglued together‚Äù with the <em>L</em> -transform, replacing the pre-calculated lines of the product with </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0Am_i%20%5Ctimes%20%5Cleft(%20a_%7Bi%2C%200%7D%2C%20a_%7Bi%2C%201%7D%2C%20%5Cdots%2C%20a_%7Bi%2C%20n-1%7D%20%5Cright)%20%5Cquad%20%5Cforall%20m_i%20%5Cin%20%5Cmathrm%7BGF%7D(256)%2C%0A" alt="m_i \ times \ left (a_ {i, 0}, a_ {i, 1}, \ dots, a_ {i, n-1} \ right) \ quad \ forall m_i \ in \ mathrm {GF} (256),"></div><p></p><br><p>  on </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0A%5Cpi(m_i)%20%5Ctimes%20%5Cleft(%20a_%7Bi%2C%200%7D%2C%20a_%7Bi%2C%201%7D%2C%20%5Cdots%2C%20a_%7Bi%2C%20n-1%7D%20%5Cright)%20%5Cquad%20%5Cforall%20m_i%20%5Cin%20%5Cmathrm%7BGF%7D(256)%2C%0A" alt="\ pi (m_i) \ times \ left (a_ {i, 0}, a_ {i, 1}, \ dots, a_ {i, n-1} \ right) \ quad \ forall m_i \ in \ mathrm {GF} (256),"></div><p></p><br><p>  Then one full encryption cycle comes down to </p><br><ul><li>  blending with the key ( <code>pxor</code> ), </li><li>  using the glued <em>LS</em> transform (in the best case, these are 16 downloads of 128-bit vectors from the cache and 15 additions <code>pxor</code> ). </li></ul><br><p>  Of course, such optimizations are not free, to use them you will need, first, to compute and store in the cache one of the two tables with strings-works, each of which contains 256 * 16 * 16 bytes, or 64 KB.  Why are there two tables?  Because the inverse transformation used in decryption will require multiplication by the inverse of the <em>L</em> matrix, and will entail new works. </p><br><p>  Secondly, gluing replacement nodes with multiplication by a matrix is ‚Äã‚Äãpossible only if a block is first applied to the block, and then multiplied, so the decryption algorithm will have to be slightly modified.  The clear text is obtained from the ciphertext by simply reversing the whole scheme (all transformations are reversible): </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AP%20%3D%20X_0%20S%5E%7B-1%7D%20L%5E%7B-1%7D%20%5Ccirc%20%5Cdots%20%5Ccirc%20X_8%20S%5E%7B-1%7D%20L%5E%7B-1%7D%20%5Ccirc%20X_9%20(C).%0A" alt="P = X_0 S ^ {- 1} L ^ {- 1} \ circ \ dots \ circ X_8 S ^ {- 1} L ^ {- 1} \ circ X_9 (C)."></div><p></p><br><p>  Note that when deciphering "in the forehead" to the intermediate text, they first apply multiplication by the inverse matrix, and then the action by substitution, therefore, in order to glue these transformations even here, we will have to reorder the decryption algorithm. </p><br><p>  I note that the composition of the transformations </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AV%20%3D%20L%5E%7B-1%7D%20X_%7BK_i%7D%20S%5E%7B-1%7D%20(U)%20%3D%20L%5E%7B-1%7D%20%5Cleft(%20S%5E%7B-1%7D(U)%20%5Coplus%20K_i%20%5Cright)%0A" alt="V = L ^ {- 1} X_ {K_i} S ^ {- 1} (U) = L ^ {- 1} \ left (S ^ {- 1} (U) \ oplus K_i \ right)"></div><p></p><br><p>  identical composition </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AV%20%3D%20L%5E%7B-1%7D%20S%5E%7B-1%7D(U)%20%5Coplus%20L%5E%7B-1%7D%20%5Cleft(%20K_i%20%5Cright)%20%3D%20X_%7BL%5E%7B-1%7D%20(K_i)%7D%20L%5E%7B-1%7D%20S%5E%7B-1%7D%20(U)%0A" alt="V = L ^ {- 1} S ^ {- 1} (U) \ oplus L ^ {- 1} \ left (K_i \ right) = X_ {L ^ {- 1} (K_i)} L ^ {- 1 } S ^ {- 1} (U)"></div><p></p><br><p>  due to the linearity of the transform <em>l</em> .  Then decryption can be done as follows: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%0AP%20%3D%20%0AX_%7BK_0%7D%20S%5E%7B-1%7D%20%5Ccirc%20%0A%5Cleft(%20X_%7BL%5E%7B-1%7D%20(K_1)%7D%20L%5E%7B-1%7D%20S%5E%7B-1%7D%20%5Cright)%20%5Ccirc%20%0A%5Cdots%20%5Ccirc%0A%5Cleft(%20X_%7BL%5E%7B-1%7D%20(K_8)%7D%20L%5E%7B-1%7D%20S%5E%7B-1%7D%20%5Cright)%20%5Ccirc%20%0AX_%7BL%5E%7B-1%7D%20(K_9)%7D%20L%5E%7B-1%7D%20S%5E%7B-1%7D%20S%20(C)%0A" alt="P = X_ {K_0} S ^ {- 1} \ circ \ left (X_ {L ^ {- 1} (K_1)} L ^ {- 1} S ^ {- 1} \ right) \ circ \ dots \ circ \ left (X_ {L ^ {- 1} (K_8)} L ^ {- 1} S ^ {- 1} \ right) \ circ X_ {L ^ {- 1} (K_9)} L ^ {- 1} S ^ {- 1} S (C)"></div><p></p><br><p>  Here, each of the transformations inverse to <em>SL</em> can be carried out according to a scheme similar to that considered.  I will not post computed tables of product lines ‚Äî they are too large even for spoilers;  they can be found, for example, <a href="">here</a> . </p><br><h2 id="optimizaciya-s-ispolzovaniem-sse2">  Optimization using SSE2 </h2><br><p>  In principle, everything is clear with the basic transformations, it remains to put all these optimizations on asm. <br>  To work with blocks, I suggest using the SSE2 instruction set, we will use the <code>movdqu</code> and <code>movdqa</code> to load and unload data into registers, the <code>pxor</code> , <code>pand</code> , <code>pandn</code> for boolean operations, the <code>psrlw</code> and <code>psllw</code> for bitwise shifts, <code>pextrw</code> for unloading register bytes. </p><br><p>  Yes, there is another subtlety of the implementation of GOST R 34.12 '15.  In addition to general algorithmic optimizations like those described above, to further accelerate performance, you need to take into account the features of the assembler and the features of the scheduler, which instructions can be put on parallel execution on different executing devices. </p><br><h3 id="uchet-osobennostey-adresnoy-arifmetiki">  Consideration of the features of address arithmetic </h3><br><p>  The first feature of the implementation of the algorithm is related to the fact that, if you do not take into account the device of the pre-calculated table and indirect index addressing with offset, then when compiling you can get something like the following exhaust of addition with the next line-product: </p><br><pre> <code class="hljs matlab">pextrb xmmX, eax, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> ;   <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> (SSE <span class="hljs-number"><span class="hljs-number">4.1</span></span>)  <span class="hljs-number"><span class="hljs-number">32</span></span>--  eax movzxd rcx, eax ;     <span class="hljs-number"><span class="hljs-number">64</span></span>--  rcx add rcx, rcx ;    pxor xmmY, [rbx + <span class="hljs-number"><span class="hljs-number">8</span></span>*rcx + <span class="hljs-number"><span class="hljs-number">0</span></span>xi000] ;    </code> </pre> <br><p>  In registers at the same time are stored: </p><br><ul><li>  <code>rbx</code> contains the base offset address of the table, </li><li>  <code>xmmX</code> contains an input block, </li><li>  <code>xmmY</code> contains the output block (battery, amount), </li><li>  <code>eax</code> and <code>rcx</code> are used to highlight and double byte offset. </li></ul><br><p>  It should be borne in mind that the precomputed table is arranged as follows: </p><br><pre> <code class="hljs markdown">uint8_t table[<span class="hljs-string"><span class="hljs-string">16</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">256</span></span>][<span class="hljs-string"><span class="hljs-string">16</span></span>],</code> </pre> <br><p>  that is, the values ‚Äã‚Äãof the product lines are stored in this table continuously, one after another, the external index <em>i</em> corresponds to the <em>i-</em> th row of the <em>L</em> -transformation matrix, the average index <em>j</em> is equal to the <em>i-</em> th byte of the input block, and the internal index <em>k</em> corresponds to the byte index of the next addend: </p><br><pre> <code class="hljs markdown">Xi = table[<span class="hljs-string"><span class="hljs-string">i</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">input[i</span></span>]][<span class="hljs-symbol"><span class="hljs-symbol">0</span></span>] ... [16]</code> </pre> <br><p>  Thus, the address of the first byte of the next addend <code>Xi</code> is expressed as follows: </p><br><pre> <code class="hljs matlab">[Xi] = rbx + (<span class="hljs-number"><span class="hljs-number">0x1000</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>) + (<span class="hljs-number"><span class="hljs-number">16</span></span> * input[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]),</code> </pre> <br><p>  Where </p><br><ul><li>  <code>(0x1000 * i)</code> corresponds to the offset of the current row ( <code>table[i]</code> ), </li><li>  <code>(16 * input[i])</code> corresponds to the offset of the current addend <code>Xi</code> ( <code>table[i][input[i]]</code> ). </li></ul><br><p>  So, the value of the current byte has to be multiplied by 16, but address arithmetic allows you to use the maximum value of the coefficient factor equal to eight.  Therefore, the compiler has to shift the value of the byte in <code>rcx</code> , double it, and only then calculate the address <code>Xi</code> . </p><br><p>  In order to avoid such excesses, you can use the ideology of SIMD, and calculate the given displacements in advance, and not by means of address arithmetic. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/797/87c/649/79787c6493c643378d189a91e0f8b376.png" width="692"></div><br><p> <i>    (    <code>Xi</code> )</i> </p><br><p>   0..15     ,  <code>00</code>  <code>FF</code>      . </p><br><p>    <code>00FF 00FF 00FF 00FF 00FF 00FF 00FF 00FF</code>   <code>pand</code>  <code>pandn</code>              ;  c   <code>psrlw</code>  <code>psllw</code>   (  16)  ,      . <br> ,  <em>L</em> -   : </p><br><pre> <code class="hljs">pand xmmR, xmmZ ;    pandn xmmL, xmmZ ;    psllw xmmR, 4 ;    psrlw xmmL, 4 ;   </code> </pre> <br><p>       <code>xmmZ</code> .     <code>Xi</code>        : </p><br><pre> <code class="hljs matlab">pextrw eax, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> ;    <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> pxor xmmY, [rbx + rax + <span class="hljs-number"><span class="hljs-number">0</span></span>xi000] ;        </code> </pre> <br><h3 id="uchet-specifiki-mikroarhitektury">    </h3><br><p>    Intel  AMD  ,  ,  ,        ,  ,                . </p><br><p> ,  ,   ,      .  <em>LS</em> -      128-  <code>Xi</code> , ,  ,           (  )    :    . </p><br><div class="spoiler"> <b class="spoiler_title"> ,    ( )</b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-class"><span class="hljs-selector-class">.code</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">extern</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bitmask</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">extern</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">precomputedLSTable</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">encrypt_block</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">proc</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">initialising</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqu</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rcx]</span></span> ; <span class="hljs-selector-attr"><span class="hljs-selector-attr">[unaligned]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">loading</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">block</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lea</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r8</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[precomputedLSTable + 01000h]</span></span> ; <span class="hljs-selector-attr"><span class="hljs-selector-attr">[aligned]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">aliasing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">base</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">with</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">offset</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lea</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r11</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[precomputedLSTable]</span></span> ; <span class="hljs-selector-attr"><span class="hljs-selector-attr">[aligned]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">aliasing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">base</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm4</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[bitmask]</span></span> ; <span class="hljs-selector-attr"><span class="hljs-selector-attr">[aligned]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">loading</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bitmask</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r10d</span></span>, 9 ; <span class="hljs-selector-tag"><span class="hljs-selector-tag">number</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">of</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rounds</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">base</span></span> 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">round</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rdx]</span></span> ; <span class="hljs-selector-attr"><span class="hljs-selector-attr">[aligned]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mixing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">with</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">round</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">key</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movaps</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm4</span></span> ; <span class="hljs-selector-tag"><span class="hljs-selector-tag">securing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bitmask</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">from</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">xmm4</span></span> movaps xmm2, xmm4 ; <span class="hljs-selector-tag"><span class="hljs-selector-tag">securing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bitmask</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">from</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">xmm4</span></span> pand xmm2, xmm0 ; <span class="hljs-selector-tag"><span class="hljs-selector-tag">calculating</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">offsets</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pandn</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">psrlw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">psllw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> ; <span class="hljs-selector-tag"><span class="hljs-selector-tag">accumulating</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">caches</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r11 + rax + 00000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r8 + rax + 00000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, 1<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r11 + rax + 02000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, 1<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r8 + rax + 02000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, 2<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r11 + rax + 04000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, 2<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r8 + rax + 04000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, 3<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r11 + rax + 06000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, 3<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r8 + rax + 06000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, 4<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r11 + rax + 08000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, 4<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r8 + rax + 08000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, 5<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r11 + rax + 0a000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, 5<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r8 + rax + 0a000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, 6<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r11 + rax + 0c000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, 6<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r8 + rax + 0c000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, 7<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r11 + rax + 0e000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pextrw</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, 7<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r8 + rax + 0e000h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span> ; <span class="hljs-selector-tag"><span class="hljs-selector-tag">mixing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">caches</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span>, 10<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> ; <span class="hljs-selector-tag"><span class="hljs-selector-tag">advancing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">to</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">next</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">round</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">key</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">dec</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r10</span></span> ; <span class="hljs-selector-tag"><span class="hljs-selector-tag">decrementing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">round</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">index</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jnz</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">round</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">last_round</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">pxor</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rdx]</span></span> ; <span class="hljs-selector-attr"><span class="hljs-selector-attr">[aligned]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mixing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">with</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">round</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">key</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqu</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rcx]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span> ; <span class="hljs-selector-attr"><span class="hljs-selector-attr">[unaligned]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">storing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">block</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ret</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">encrypt_block</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">endp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">end</span></span></code> </pre> </div></div><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>           ;       ,     Intel Core i7-2677M Sandy Bridge @ 1.80 GHz,  120 /    SSE   1.3 /   . </p><br><p>  ‚Äî ,     : </p><br><ul><li>           (  ,     ); </li><li> ,             ,       . </li></ul><br><p>         34.12 '15 ,    <a href="https://github.com/aprelev/libgost15"> </a> .    C99,         ,       .    CMake 3.2.1+  ,  C99.     ,      ( <strong>compact</strong> ),  ,   SIMD  ( <strong>optimised</strong> )     SSE2 ( <strong>SIMD</strong> ). </p><br><p>        Travis CI   ,           ( ,    )  CTest        <code>std::chrono</code>  C++11. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/312224/">https://habr.com/ru/post/312224/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312210/index.html">‚ÄúWe train specialists of all levels‚Äù: EPAM about Java development and conferences</a></li>
<li><a href="../312212/index.html">Meeting Logeek Night for Java and QA specialists of Karaganda</a></li>
<li><a href="../312214/index.html">ASP.NET Core: An Example of Implementing Design Patterns Unit of Work and Repository</a></li>
<li><a href="../312216/index.html">Google presented free Noto font with support for 800 languages ‚Äã‚Äãand 110 thousand characters</a></li>
<li><a href="../312222/index.html">Meet the Telerik AppBuilder</a></li>
<li><a href="../312226/index.html">ASP.NET Core Path [Level 1] Basics</a></li>
<li><a href="../312228/index.html">Installing Canon LBP series printers in Ubuntu</a></li>
<li><a href="../312230/index.html">Intellect cards: 5 ways that helped me turn chaos into order</a></li>
<li><a href="../312232/index.html">4 main lessons that we learned when starting our first service</a></li>
<li><a href="../312234/index.html">Kryptonomicon: great accordion, hello from the 90s and the best book about techies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>