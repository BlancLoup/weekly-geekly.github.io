<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Twelve Factor App - The Twelve-Factor App</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dear readers! I present to your attention the translation of The Twelve-Factor App web application development methodology from the developers of the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Twelve Factor App - The Twelve-Factor App</h1><div class="post__text post__text-html js-mediator-article">  Dear readers!  I present to your attention the translation of <a href="http://12factor.net/">The Twelve-Factor App</a> web application development methodology from the developers of the Heroku platform.  My comments are hidden by spoilers in the course of the article. <br><br><h4>  Introduction </h4><br>  Nowadays, software is usually distributed in the form of services called <em>web applications</em> (web apps) or <em>software-as-a-service</em> (SaaS).  An appendix of twelve factors is a methodology for creating SaaS applications that: <br><br><ul><li>  Use a <strong>declarative</strong> format to describe the installation and configuration process, which minimizes the time and resources for new developers connected to the project; </li><li>  Have <strong>an agreement</strong> with the operating system that assumes <strong>maximum portability</strong> between runtime environments; </li><li>  Suitable for <strong>deployment</strong> on modern <strong>cloud platforms</strong> , eliminating the need for servers and system administration; </li><li>  <strong>Minimize discrepancies</strong> between the development environment and the runtime environment, which allows continuous deployment to maximize flexibility; </li><li>  And can <strong>scale</strong> without significant changes in the tools, architecture and development practices. </li></ul><br>  The methodology of the twelve factors can be applied to applications written in any programming language that use any combination of third-party services (backing services) (databases, message queues, cache memory, etc.). <br><a name="habracut"></a><br><h4>  Prerequisites </h4><br>  Contributors to this document were directly involved in the development and deployment of hundreds of applications and indirectly witnessed the development, implementation and scaling of hundreds of thousands of applications during our work on the <a href="http://www.heroku.com/">Heroku</a> platform. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This document summarizes our entire experience of using and observing a wide variety of SaaS applications in the wild.  The document is a combination of three ideal approaches to application development: focusing on the dynamics of organic growth of an application over time, the dynamics of cooperation between developers working on the application code base and the <a href="http://blog.heroku.com/archives/2011/6/28/the_new_heroku_4_erosion_resistance_explicit_contracts/">elimination of the effects of software erosion</a> . <br><br>  Our motivation is to raise awareness of some system problems that we have encountered in the practice of developing modern applications, as well as to provide common basic concepts for discussing these problems and propose a set of common conceptual solutions to these problems with associated terminology.  The format is inspired by the books of Martin Fowler (Martin Fowler) <em><a href="http://books.google.com/books/about/Patterns_of_enterprise_application_archi.html%3Fid%3DFyWZt5DdvFkC">Patterns of Enterprise Application Architecture</a></em> and <em><a href="http://books.google.com/books/about/Refactoring.html%3Fid%3D1MsETFPD3I0C">Refactoring</a></em> . <br><br><h4>  Who should read this document? </h4><br>  Developers who create SaaS applications.  Ops to engineers deploying and managing such applications. <br><br><h2>  Twelve factors </h2><br>  <a href="https://habr.com/ru/post/258739/">I. Code base</a> <br>  One code base tracked in a version control system - multiple deployments <br><br>  <a href="https://habr.com/ru/post/258739/">Ii.</a>  <a href="https://habr.com/ru/post/258739/">Dependencies</a> <br>  Explicitly declare and isolate dependencies <br><br>  <a href="https://habr.com/ru/post/258739/">Iii.</a>  <a href="https://habr.com/ru/post/258739/">Configuration</a> <br>  Save the configuration in runtime <br><br>  <a href="https://habr.com/ru/post/258739/">Iv.</a>  <a href="https://habr.com/ru/post/258739/">Third Party Services (Backing Services)</a> <br>  Consider third-party services (backing services) connected resources <br><br>  <a href="https://habr.com/ru/post/258739/">V. Build, Release, Execution</a> <br>  Strictly separate the assembly and execution stages <br><br>  <a href="https://habr.com/ru/post/258739/">Vi.</a>  <a href="https://habr.com/ru/post/258739/">Processes</a> <br>  Run the application as one or more non-stateless processes (stateless) <br><br>  <a href="https://habr.com/ru/post/258739/">VII.</a>  <a href="https://habr.com/ru/post/258739/">Port binding</a> <br>  Export services through port mapping <br><br>  <a href="https://habr.com/ru/post/258739/">Viii.</a>  <a href="https://habr.com/ru/post/258739/">Parallelism</a> <br>  Scale an application using processes <br><br>  <a href="https://habr.com/ru/post/258739/">Ix.</a>  <a href="https://habr.com/ru/post/258739/">Disposability</a> <br>  Maximize reliability with quick startup and proper shutdown <br><br>  <a href="https://habr.com/ru/post/258739/">X. Par development / application performance</a> <br>  Keep the development, staging and production deployment environments as similar as possible. <br><br>  <a href="https://habr.com/ru/post/258739/">Xi.</a>  <a href="https://habr.com/ru/post/258739/">Logging (Logs)</a> <br>  View the log as a stream of events. <br><br>  <a href="https://habr.com/ru/post/258739/">Xii.</a>  <a href="https://habr.com/ru/post/258739/">Admin Tasks</a> <br>  Perform administration / management tasks using one-time processes. <br><a name="codebase"></a><br><h2>  I. Code base </h2><br><blockquote>  One code base tracked in a version control system - multiple deployments </blockquote><br>  An application of twelve factors is always tracked in a version control system such as <a href="http://git-scm.com/">Git</a> , <a href="http://mercurial.selenic.com/">Mercurial</a> or <a href="http://subversion.apache.org/">Subversion</a> .  A copy of the database of monitored versions is called a <em>code repository</em> , which is often shortened to <em>code repo</em> or simply to <em>repository (repo)</em> <br><br>  <em>A codebase</em> is one repository (in centralized version control systems, like Subvertion), or multiple repositories that have common initial commits (in decentralized version control systems, like Git). <br><br><img src="https://habrastorage.org/files/381/63e/acd/38163eacddaa4c8aa1b87a3943d7dc78.png" alt="One Code Base Multiple Deployments"><br><br>  There is always a one-to-one correspondence between the code base and the application: <br><br><ul><li>  If there are several code bases, then this is not an application - it is a distributed system.  Each component in a distributed system is an application and each component can individually correspond to twelve factors. </li><li>  The fact that several applications share the same code is a violation of twelve factors.  The solution in this situation is the allocation of common code in the library, which can be connected through <a href="https://habr.com/ru/post/258739/">a dependency manager</a> . </li></ul><br>  There is only one code base for each application, but there can be multiple deployments of the same application.  <em>Deployed application (deploy)</em> is a running instance of the application.  As a rule, this is a working site deployment and one or more intermediate site deployments.  In addition, each developer has a copy of the application running in his local development environment, each of which also qualifies as an deployed application (deploy). <br><br>  The code base should be the same for all deployments, but different versions of the same code base can be executed in each of the deployments.  For example, a developer may have some changes that have not yet been added to a staged deployment;  intermediate deployment may have some changes that have not yet been added to the production deployment.  However, all these deployments use the same code base, so they can be identified as different deployments of the same application. <br><hr><a name="dependencies"></a><h2>  Ii.  Dependencies </h2><br><blockquote>  Explicitly declare and isolate dependencies </blockquote><br>  Most programming languages ‚Äã‚Äãcome with a package manager for distributing libraries, such as <a href="http://www.cpan.org/">CPAN</a> in Perl or <a href="http://rubygems.org/">Rubygems</a> in Ruby.  Libraries installed by the package manager can be installed accessible to the entire system (so-called ‚Äúsystem packages‚Äù) or available only to an application in the directory containing the application (so-called ‚Äúvendoring‚Äù and ‚Äúbundling‚Äù). <br><br>  <strong>The application of the twelve factors never depends on implicitly existing packages available to the whole system.</strong>  The application declares all its dependencies completely and accurately using the manifest of <em>the dependency declaration</em> .  In addition, it uses the <em>dependency isolation</em> tool at run time to ensure that implicit dependencies do not ‚Äúleak‚Äù from the surrounding system.  A complete and explicit specification of dependencies applies equally to both the development and operation of the application. <br><br>  For example, <a href="http://gembundler.com/">Gem Bundler</a> in Ruby uses <code>Gemfile</code> as a manifest format for declaring dependencies and <code>bundle exec</code> to isolate dependencies.  Python has two different tools for these tasks: <a href="http://www.pip-installer.org/en/latest/">Pip is</a> used for declarations and <a href="http://www.virtualenv.org/en/latest/">Virtualenv</a> for isolation.  Even C has <a href="http://www.gnu.org/s/autoconf/">Autoconf</a> for declaring dependencies, and static binding can provide dependency isolation.  Regardless of which toolset is used, the declaration and isolation of dependencies should always be used together ‚Äî only one of them is not enough to satisfy the twelve factors. <br><br>  One of the advantages of explicitly declaring dependencies is that it simplifies application customization for new developers.  The new developer can copy the application code base onto his machine, the only requirements for which are the presence of the language runtime environment and the package manager.  Everything you need to run the application code can be configured using a specific <em>configuration command</em> .  For example, for Ruby / Bundler, the configuration team is <code>bundle install</code> , for Clojure / <a href="https://github.com/technomancy/leiningen">Leiningen</a> this is <code>lein deps</code> . <br><br>  The application of the twelve factors also does not rely on the implicit existence of any system tools.  An example is the launch of the ImageMagick and <code>curl</code> programs.  Although these tools may be present in many or even most systems, there is no guarantee that they will be present on all systems where the application may work in the future, or whether the version found in another system is compatible with the application.  If an application needs to run a system tool, then this tool must be included in the application. <br><br><div class="spoiler">  <b class="spoiler_title">Translator Comments</b> <div class="spoiler_text">  More package managers: <br><ul><li>  <a href="https://www.npmjs.com/">NPM</a> to NodeJS </li><li>  <a href="https://getcomposer.org/">Composer</a> in PHP </li><li>  <a href="http://bower.io/">Bower</a> for client side dependencies </li></ul><br>  For insulation, you can also use: <br><ul><li>  <a href="https://rvm.io/">RVM</a> in Ruby </li><li>  <a href="https://github.com/creationix/nvm">NVM</a> in NodeJS </li><li>  And not to mention <a href="https://www.docker.com/">Docker</a> , which makes the whole system ‚Äúlocal‚Äù for the application and allows you to declare the necessary dependencies and isolate them at runtime. </li></ul><br></div></div><br><hr><br><a name="config"></a><br><h2>  Iii.  Configuration </h2><br><blockquote>  Save the configuration in runtime </blockquote><br>  Application <em>configuration</em> is all that can change between <a href="https://habr.com/ru/post/258739/">deployments</a> (development environment, intermediate and production deployment).  It includes: <br><br><ul><li>  Identifiers for connecting to database type resources, cache, and other <a href="https://habr.com/ru/post/258739/">third-party services</a> </li><li>  Registration data for connecting to external services, such as Amazon S3 or Twitter </li><li>  Values ‚Äã‚Äãdependent on the deployment environment such as the canonical name of the host </li></ul><br>  Sometimes applications store configurations as constants in code.  This is a violation of the methodology of the twelve factors, which requires a <strong>strict separation of configuration and code</strong> .  The configuration can vary significantly between deployments; the code should not differ. <br><br>  The litmus test of whether the configuration and application code are properly separated is the fact that the application code base can be freely available at any time without compromising any private data. <br><br>  Note that this ‚Äúconfiguration‚Äù definition <strong>does not</strong> include internal application configurations, such as 'config / routes.rb' in Rails, or how the <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/beans.html">main modules will be connected</a> in <a href="http://spring.io/">Spring</a> .  This type of configuration does not change between deployments and therefore it is best to keep it in code. <br><br>  Another approach to configuration is to use configuration files that are not saved to the version control system, for example, 'config / database.yml' in Rails.  This is a huge improvement before using constants that are saved in the code, but there are still some disadvantages to this method: it is easy to save the configuration file by mistake to the repository;  There is a tendency when configuration files are scattered in different places and in different formats, because of this it becomes difficult to view and manage all settings in one place.  In addition, the formats of these files are usually specific for a particular language or framework. <br><br>  <strong>An appendix of twelve factors stores configuration in <em>environment variables</em></strong> (often abbreviated to <em>env vars</em> or <em>env</em> ).  Environment variables are easy to change between deployments without changing code;  unlike configuration files, it is less likely to accidentally save them to the code repository;  and unlike custom configuration files or other configuration mechanisms, such as Java System Properties, they are a language and operating system independent standard. <br><br>  Another approach to configuration management is grouping.  Sometimes applications group configurations into named groups (often called ‚Äúenvironments‚Äù) named for a specific deployment, such as <code>development</code> , <code>test</code> and <code>production</code> environments in Rails.  This method is not scalable enough: the more different application deployments are created, the more new environment names are needed, such as <code>staging</code> and <code>qa</code> .  With the further growth of the project, developers can add their own special environments, such as <code>joes-staging</code> , resulting in a combinatorial explosion of configurations, which makes the management of application deployments very fragile. <br><br>  In the application of the twelve factors, environment variables are unrelated controls, where each environment variable is completely independent of the others.  They are never grouped together in an ‚Äúenvironment‚Äù, but instead are managed independently for each deployment.  This model is scaled gradually along with the natural appearance of more application deployments during its lifetime. <br><br><div class="spoiler">  <b class="spoiler_title">Translator Comments</b> <div class="spoiler_text">  Modules for working with environment variables: <br><ul><li>  <a href="https://github.com/bkeepers/dotenv">dotenv</a> for <a href="https://github.com/bkeepers/dotenv">ruby</a> </li><li>  <a href="https://github.com/vlucas/phpdotenv">Php dotenv</a> for php </li><li>  <a href="https://github.com/mozilla/node-convict">convict</a> for nodejs </li></ul><br></div></div><br><hr><br><a name="backing-services"></a><br><h2>  Iv.  Third Party Services (Backing Services) </h2><br><blockquote>  Consider third-party services (backing services) connected resources </blockquote><br>  <em>A third-party service</em> is any service that is available to an application over the network and is necessary as part of its normal operation.  For example, data stores (for example, <a href="http://dev.mysql.com/">MySQL</a> and <a href="http://couchdb.apache.org/">CouchDB</a> ), message queuing systems (for example, <a href="http://www.rabbitmq.com/">RabbitMQ</a> and <a href="http://kr.github.com/beanstalkd/">Beanstalkd</a> ), SMTP services for outgoing e-mail (for example, <a href="http://www.postfix.org/">Postfix</a> ), and caching systems (for example, <a href="http://memcached.org/">Memcached</a> ). <br><br>  Traditionally, third-party services, such as databases, are supported by the same system administrator who deploys the application.  In addition to local services, an application can use services provided and managed by a third party.  Examples include SMTP services (for example, <a href="http://postmarkapp.com/">Postmark</a> ), metrics collection services (such as <a href="http://newrelic.com/">New Relic</a> and <a href="http://www.loggly.com/">Loggly</a> ), binary data storages (eg <a href="http://aws.amazon.com/s3/">Amazon S3</a> ), and the use of various services APIs (such as <a href="http://dev.twitter.com/">Twitter</a> , <a href="http://code.google.com/apis/maps/index.html">Google Maps</a> and <a href="http://www.last.fm/api">Last.fm</a> ) . <br><br>  <strong>The application code of the twelve factors does not distinguish between local and third-party services.</strong>  For an application, each of them is a pluggable resource accessible by a URL or a different location / credential pair stored in the <a href="https://habr.com/ru/post/258739/">configuration</a> .  Each <a href="https://habr.com/ru/post/258739/">deployment of an</a> application of twelve factors should be able to replace the local MySQL database with any third-party managed (for example <a href="http://aws.amazon.com/rds/">Amazon RDS</a> ) without any changes to the application code.  Similarly, the local SMTP server can be replaced with a third-party (for example, Postmark) without changing the code.  In both cases, you only need to change the resource identifier in the configuration. <br><br>  Every different third-party service is a <em>resource</em> .  For example, a MySQL database is a resource; two MySQL databases (used for fragmentation at the application level) are qualified as two separate resources.  An appendix of twelve factors considers these databases to be <em>connected resources</em> , indicating that they are weakly linked to the deployment in which they are connected. <br><br><img alt="Working deployment of an application connected to 4 third-party services." src="https://habrastorage.org/files/68b/d61/4b3/68bd614b324c4a9583bfd3da34dcc7ab.png"><br><br>  Resources can optionally be connected to the deployment and disconnected from the deployment.  For example, if the application database is not functioning properly due to hardware problems, the administrator can start a new database server restored from the latest backup.  The current working database can be disabled, and the new database is connected - all this without any code changes. <br><hr><br><a name="build-release-run"></a><br><h2>  V. Build, Release, Execution </h2><br><blockquote>  Strictly separate the assembly and execution stages </blockquote><br>  <a href="https://habr.com/ru/post/258739/">The code base is</a> transformed into deployment (not taking into account the deployment for development) in three stages: <br><br><ul><li>  <em>The build phase</em> is a transformation that converts the code repository into an executable package called an <em>assembly</em> .  Using the code version of the commit specified by the deployment process, the build phase loads third-party <a href="https://habr.com/ru/post/258739/">dependencies</a> and compiles binaries and assets. </li><li>  <em>The release phase</em> accepts the build obtained during the build phase and combines it with the current deployment <a href="https://habr.com/ru/post/258739/">configuration</a> .  The resulting <em>release</em> contains the build and configuration and is ready for immediate launch in the runtime environment. </li><li>  <em>The execution phase</em> (also known as ‚Äúruntime‚Äù) launches the application in the runtime environment by running some set <a href="https://habr.com/ru/post/258739/">of</a> application <a href="https://habr.com/ru/post/258739/">processes</a> from a specific release. </li></ul><br><img src="https://habrastorage.org/files/163/15b/928/16315b928b0f4bd89e0c5bb268fe38d5.png" alt="The code becomes an assembly that combines with the configuration to create a release."><br><br>  <strong>The application of the twelve factors uses a strict separation between the stages of assembly, release and execution.</strong>  For example, it is not possible to make changes to the code at runtime, as there is no way to propagate these changes back to the build phase. <br><br>  Deployment tools, as a rule, are release management tools, and, importantly, give the opportunity to roll back to the previous release.  For example, the <a href="https://github.com/capistrano/capistrano/wiki">Capistrano</a> deployment tool stores releases in subdirectories of a directory named <code>releases</code> , where the current release is a symbolic link to the current release directory.  The Capistrano <code>rollback</code> command allows you to quickly roll back to the previous release. <br><br>  Each release must have a unique identifier, such as a release time stamp (for example <code>2015-04-06-15:42:17</code> ) or an increasing number (for example, <code>v100</code> ).  Releases can only be added and each release cannot be changed after its creation.  Any changes are required to create a new release. <br><br>  The build is initiated by the application developer every time a new code is deployed.  The execution phase, on the other hand, can occur automatically in such cases as a server restart, or a process manager restarting a fallen process.  Thus, the execution phase should be as technically simple as possible, since problems that can prevent an application from starting can occur in the middle of the night when there are no developers available.  The build phase may be more complicated, since possible errors are always visible to the developer who launched the deployment. <br><hr><br><a name="processes"></a><br><h2>  Vi.  Processes </h2><br><blockquote>  Run the application as one or more processes that do not save the internal state (stateless) </blockquote><br>  An application runs in the runtime as one or more <em>processes</em> . <br><br>  In the simplest case, the code is an independent script, the runtime is a developer‚Äôs laptop with the language runtime installed, and the process is started from the command line (for example, as <code>python my_script.py</code> ).  Another extreme option is a working deployment of a complex application that can use many <a href="https://habr.com/ru/post/258739/">types of processes, each of which is launched in the required number of instances</a> . <br><br>  <strong>The processes of application of the twelve factors do not preserve the internal state (stateless) and <a href="http://en.wikipedia.org/wiki/Shared_nothing_architecture">do not have shared data (share-nothing)</a> .</strong>  Any data that needs to be stored must be stored in a state <a href="https://habr.com/ru/post/258739/">-</a> storing <a href="https://habr.com/ru/post/258739/">third-party service</a> , usually in a database. <br><br>  The memory and file system of the process can be used as a temporary cache for a single transaction.  For example, loading, processing and saving a large file in a database.  The application of the twelve factors does not imply that something cached in memory or on disk will be available to the following requests or tasks ‚Äî with a large number of diverse processes, it is highly likely that the next request will be processed by another process.  Even with one process running, restarting (caused by deployment, changing configurations or transferring the process to another physical device) will result in the destruction of all local (memory, file system) states. <br><br>  <a href="http://documentcloud.github.com/jammit/">Asset packers</a> (for example, <a href="http://documentcloud.github.com/jammit/">Jammit</a> or <a href="http://django-compressor.readthedocs.org/">django-compressor</a> ) use the file system as a cache for compiled resources.  The application of the twelve factors prefers to do this compilation during the <a href="https://habr.com/ru/post/258739/">assembly stage</a> , for example, as in the <a href="http://guides.rubyonrails.org/asset_pipeline.html">Rails asset pipeline</a> , rather than at run time. <br><br>  Some web systems rely on <a href="http://en.wikipedia.org/wiki/Load_balancing_%2528computing%2529">‚Äústicky sessions‚Äù</a> - that is, they cache user session data in the application's process memory and expect subsequent requests from the same user to be redirected to the same process.  Sticky sessions are a violation of twelve factors and should never be used or relied on.  User session data are good candidates for a data warehouse that provides a function to limit storage time, for example, <a href="http://memcached.org/">Memcached</a> and <a href="http://redis.io/">Redis</a> . <br><hr><br><a name="port-binding"></a><br><h2>  VII.  Port binding </h2><br><blockquote>  Export services through port mapping </blockquote><br>  Sometimes web applications run inside a web server container.  For example, a PHP application can be launched as a module inside <a href="httpd.apache.org/">Apache HTTPD</a> , or a Java application can be launched inside <a href="http://tomcat.apache.org/">Tomcat</a> . <br><br>  <strong>The application of the twelve factors is completely self-sufficient</strong> and does not rely on the injection of a web server at run time in order to create a web service.  The web application <strong>exports the HTTP service by binding to a port</strong> and listens for requests arriving at this port. <br><br>  During local development, the developer follows the URL of the form <code><a href="http://localhost/"></a> localhost:5000/</code>  <code><a href="http://localhost/"></a> localhost:5000/</code> to access the service provided by its application.  When deployed, the routing layer processes requests to the public host and redirects them to the port-bound web application. <br><br>  This is typically implemented using <a href="https://habr.com/ru/post/258739/">dependency declarations</a> to add a web server library to an application such as <a href="http://www.tornadoweb.org/">Tornado</a> in Python, <a href="http://code.macournoyer.com/thin/">Thin</a> in Ruby, and <a href="http://jetty.codehaus.org/jetty/">Jetty</a> in Java and other JVM-based languages.  This happens entirely in <em>user space</em> , that is, in the application code.  The contract with the runtime environment is the binding of the application to the port for processing requests. <br><br>  HTTP is not the only service that can be exported via port mapping.  Almost any type of server software can be run as a process associated with a port and waiting for incoming requests.  Examples of this include <a href="http://www.ejabberd.im/">ejabberd</a> (provides the <a href="http://xmpp.org/">XMPP protocol</a> ) and <a href="http://redis.io/">Redis</a> (provides the <a href="http://redis.io/topics/protocol">Redis protocol</a> ). <br><br>  Also note that the port-binding approach means that one application can act as a <a href="https://habr.com/ru/post/258739/">third-party service</a> for another application by providing the URL of the third-party application as a resource identifier in the configuration of the consuming application. <br><hr><br><a name="concurrency"></a><br><h2>  Viii.  Parallelism </h2><br><blockquote>  Scale application with processes </blockquote><br>  Any computer program after launch represents one or more running processes.  Historically, web applications have taken different forms of process execution.  For example, PHP processes will run as Apache child processes and run on demand in the quantity required to service incoming requests.  Java processes use the opposite approach, the JVM is a single monolithic meta-process that reserves a large amount of system resources (processor and memory) at startup and manages parallelism within itself using execution threads.  In both cases, the running processes are only minimally visible to the application developer. <br><br><img src="https://habrastorage.org/files/3bb/8b6/400/3bb8b6400c5549cca9acf29d7c2d26fb.png" alt="Scaling is expressed in the number of running processes, the difference in workload is expressed in the types of processes."><br><br>  <strong>In an appendix of twelve factors, processes are first-class entities.</strong>  The processes in the appendix of twelve factors took strengths from <a href="http://adam.heroku.com/past/2011/5/9/applying_the_unix_process_model_to_web_apps/">the unix process model for running daemons</a> .  Using this model, the developer can design his application in such a way that for processing different workloads, it is necessary to assign each type of work to its own <em>type of process</em> .  For example, HTTP requests can be processed by a web process, and lengthy background tasks are processed by a workflow. <br><br>                 /    ,  <a href="http://rubyeventmachine.com/">EventMachine</a> , <a href="http://twistedmatrix.com/trac/">Twisted</a>  <a href="http://nodejs.org/">Node.js</a> .          ( ),              . <br><br> ,   ,  ,    . <a href="https://habr.com/ru/post/258739/">         </a> ,         .           <em>  (process formation)</em> . <br><br>     <a href="http://dustin.github.com/2010/02/28/running-processes.html">   </a>   PID .           (, <a href="http://upstart.ubuntu.com/">Upstart</a> ,      ,    <a href="http://blog.daviddollar.org/2011/05/06/introducing-foreman.html">Foreman</a>   )   <a href="https://habr.com/ru/post/258739/"> </a> ,            . <br><hr><br><a name="disposability"></a><br><h2>  Ix.  (Disposability) </h2><br><blockquote>           </blockquote><br> <strong><a href="https://habr.com/ru/post/258739/"></a>     <em></em> ,  ,          .</strong>      ,    <a href="https://habr.com/ru/post/258739/"></a>  <a href="https://habr.com/ru/post/258739/"></a>    . <br><br>    <strong>  </strong> .           ,    ,    ,         .        <a href="https://habr.com/ru/post/258739/"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and scaling. In addition, it is more reliable, since the process manager can freely transfer processes to new physical machines if necessary. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processes must </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">complete properly when they receive a </font></font><a href="http://en.wikipedia.org/wiki/SIGTERM"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIGTERM</font></font></a></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> signal from the process manager. For the web process, the correct shutdown is achieved by stopping listening to the service port (thus, abandoning any new requests), which allows you to complete current requests and then end. In this model, it is assumed that HTTP requests are short (no more than a few seconds); in the case of long requests, the client should smoothly try to reestablish the connection when the connection is lost.</font></font><br><br>  ,    (worker),            . ,  <a href="http://www.rabbitmq.com/">RabbitMQ</a>      <a href="http://www.rabbitmq.com/amqp-0-9-1-quickref.html"><code>NACK</code></a> ;  <a href="http://kr.github.com/beanstalkd/">Beanstalkd</a>     ,    . ,    ,  <a href="https://github.com/collectiveidea/delayed_job">Delayed Job</a>   ,    .    ,     <a href="http://en.wikipedia.org/wiki/Reentrant_%2528subroutine%2529"> </a> ,             <a href="http://en.wikipedia.org/wiki/Idempotence"></a> . <br><br>     <strong>   </strong>     .     ,      <code>SIGTERM</code> ,     .       ,   Beanstalkd,            .         ,      . <a href="http://lwn.net/Articles/191059/">    (Crash-only design)</a>      <a href="http://docs.couchdb.org/en/latest/intro/overview.html"> </a> . <br><hr><br><a name="dev-prod-parity"></a><br><h2> X.  /  </h2><br><blockquote>   ,   (staging)    (production)   </blockquote><br>       (      <a href="https://habr.com/ru/post/258739/"></a> )    (       ).      : <br><br><ul><li> <strong>  :</strong>     ,         ,    . </li><li> <strong> </strong> :   , OPS   . </li><li> <strong> </strong> :     ,   Nginx, SQLite,  OS X,         Apache, MySQL  Linux. </li></ul><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An application of twelve factors is designed for </font></font><a href="http://www.avc.com/a_vc/2011/02/continuous-deployment.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">continuous deployment</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by minimizing the differences between application development and operation. </font><font style="vertical-align: inherit;">Consider the three differences described above:</font></font></strong> <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Make the time difference small: a developer can write code, and it will be deployed in a few hours or even minutes. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Make small differences in personnel: the developer who wrote the code, actively participates in its deployment and monitors its behavior while the application is running. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Make the differences between tools small: keep the development environment and application work as similar as possible. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Summarizing the above table: </font></font><br><table><tbody><tr><th></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Traditional application </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Appendix twelve factors </font></font></th></tr><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Time between deployments </font></font></th><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Weeks </font></font></td><td>  Clock </td></tr><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The author of the code / the one who unfolds </font></font></th><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Different people </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Same people </font></font></td></tr><tr><th>  /  </th><td>  </td><td>   </td></tr></tbody></table><br> <a href="https://habr.com/ru/post/258739/"> </a> ,    ,     ,    ,          .    ,      ,  <em></em>      .  ,   . <br><table><tbody><tr><th>  Type of </th><th>  Tongue </th><th>  </th><th>  </th></tr><tr><td>  Database </td><td> Ruby/Rails </td><td> ActiveRecord </td><td> MySQL, PostgreSQL, SQLite </td></tr><tr><td>   </td><td> Python/Django </td><td> Celery </td><td> RabbitMQ, Beanstalkd, Redis </td></tr><tr><td>  Cache </td><td> Ruby/Rails </td><td> ActiveSupport::Cache </td><td> ,  , Memcached </td></tr></tbody></table><br>            ,               .   SQLite   PostgreSQL   ;         Memcached   . <br><br> <strong>                </strong> ,          .      ,     ,    ,  ,               .     ,     .           ,         . <br><br>       ,     .   ,   Memcached, PostgreSQL  RabbitMQ         ,   <a href="http://mxcl.github.com/homebrew/">Homebrew</a>  <a href="https://help.ubuntu.com/community/AptGet/Howto">apt-get</a> .  ,    ,   <a href="http://www.opscode.com/chef/">Chef</a>  <a href="http://docs.puppetlabs.com/">Puppet</a>      ,   <a href="http://vagrantup.com/">Vagrant</a>           .              /    . <br><br>      - ,             .     ( ,    )             . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">             <a href="https://www.docker.com/">Docker</a>    ,  <a href="https://docs.docker.com/compose/">Docker Compose</a> . <br></div></div><br><hr><br><a name="logs"></a><br><h2>  Xi.  (Logs) </h2><br><blockquote>      </blockquote><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logging</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> provides a visual representation of the behavior of a running application. Usually in a server environment, the log is written to a disk file (‚Äúlogfile‚Äù), but this is only one of the output formats. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A log is a </font></font><a href="http://adam.heroku.com/past/2011/4/1/logs_are_streams_not_files/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stream of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aggregated, time-ordered events, collected from the output streams of all running processes and auxiliary services. The log in its raw form is usually represented by a text format with one event per line (although exception traces may take several lines). The log has no fixed start and end, the message flow is continuous while the application is running. </font></font><br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The application of the twelve factors never deals with the routing and storage of its output stream.</font></font></strong>           .               <code>stdout</code> .            ,     . <br><br>             ,                      .            ,       .       (, <a href="https://github.com/heroku/logplex"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logplex</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://github.com/fluent/fluentd"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fluent</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) can be used for this purpose. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The event flow of the application can be redirected to a file or viewed in the terminal in real time. </font><font style="vertical-align: inherit;">Most importantly, the event stream can be sent to an indexing and analyzing system for logs, such as </font></font><a href="http://www.splunk.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Splunk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , or a general purpose storage system, such as </font></font><a href="http://hive.apache.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hadoop / Hive</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">These systems have great capabilities and flexibility for a thorough analysis of the behavior of the application over time, which includes:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Search for specific events in the past. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Large-scale trend charts (for example, requests per minute). </font></font></li><li>     ,   (, ,        ). </li></ul><br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">      : <br><ul><li> Papertrail <a href="https://papertrailapp.com/">papertrailapp.com</a> </li><li> Loggly <a href="https://www.loggly.com/">www.loggly.com</a> </li><li> Logentries <a href="https://logentries.com/">logentries.com</a> </li></ul><br>           : <a href="https://www.elastic.co/products/elasticsearch">Elasticsearch</a> , <a href="https://www.elastic.co/products/logstash">Logstash</a> , <a href="https://www.elastic.co/products/kibana">Kibana</a> (ELK). <br></div></div><br><br><hr><br><a name="admin-processes"></a><br><h2> XII.  Admin Tasks </h2><br><blockquote>   /     </blockquote><br> <a href="https://habr.com/ru/post/258739/"> </a>    ,        (   -),   .    ,          ,  : <br><br><ul><li>     ( <code>manage.py migrate</code>  Django, <code>rake db:migrate</code>  Rails). </li><li>   (    <a href="http://en.wikipedia.org/wiki/Read-eval-print_loop">REPL</a> ),            .    REPL     -  (, <code>python</code> or <code>perl</code> ),        ( <code>irb</code>  Ruby, <code>rails console</code>  Rails). </li><li>   ,     (, <code>php scripts/fix_bad_records.php</code> ). </li></ul><br>          <a href="https://habr.com/ru/post/258739/"> </a> .     <a href="https://habr.com/ru/post/258739/"></a> ,    <a href="https://habr.com/ru/post/258739/"> </a>  <a href="https://habr.com/ru/post/258739/"></a> ,     ,   .        ,    . <br><br>     <a href="https://habr.com/ru/post/258739/"> </a>       . ,  - Ruby   <code>bundle exec thin start</code> ,        <code>bundle exec rake db:migrate</code> .      Python   Virtualenv    <code>bin/python</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">both for starting the Tornado web server, and for starting any </font></font><code>manage.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">administration processes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The methodology of the twelve factors gives preference to languages ‚Äã‚Äãthat provide a REPL shell out of the box, and which make it easy to execute one-time scripts. </font><font style="vertical-align: inherit;">In a local deployment, developers perform a one-time administration process using a console command within the application directory. </font><font style="vertical-align: inherit;">In a working deployment, developers can use ssh or another remote command execution mechanism provided by the runtime to start such a process.</font></font><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bug fixes and more suitable translations can be sent: </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comment here </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Personal message </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pull rekvest on </font></font><a href="https://github.com/mahnunchik/12factor/tree/translations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a> </li><li>    <a href="https://github.com/heroku/12factor"> </a> (     ) </li></ul><br><br> <i> <a href="https://habrahabr.ru/users/amalinin/" class="user_link">amalinin</a>  <a href="https://habrahabr.ru/users/litchristina/" class="user_link">litchristina</a>     </i> </div><p>Source: <a href="https://habr.com/ru/post/258739/">https://habr.com/ru/post/258739/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258725/index.html">How Valera took a trainee team and started teaching him how to design</a></li>
<li><a href="../258727/index.html">Project "Oberon 2013"</a></li>
<li><a href="../258729/index.html">Registration is now open for the third annual championship for developers of the Russian Developers Cup</a></li>
<li><a href="../258731/index.html">Google WebFonts and FontFaceObserver. Use third-party fonts on your website</a></li>
<li><a href="../258735/index.html">Secure SSL / TLS Russian Internet Banking</a></li>
<li><a href="../258745/index.html">New data center Rackspace in the UK: photo tour and features of the new DC</a></li>
<li><a href="../258751/index.html">DevOps Zoo or like 500px serves more than 500TB images</a></li>
<li><a href="../258753/index.html">"Under the hood" Netflix: An analysis of world cinema</a></li>
<li><a href="../258755/index.html">China plans to invest $ 182 billion to modernize the Internet</a></li>
<li><a href="../258767/index.html">Why PHP is out of date</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>