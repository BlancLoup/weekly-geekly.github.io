<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating JS Modules</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 In this article I want to tell you about my approach to writing modules in JavaScript. Professionals are unlikely to find something new for ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating JS Modules</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br><br>  In this article I want to tell you about my approach to writing modules in JavaScript.  Professionals are unlikely to find something new for themselves, but for beginners, I think, it will be useful to get acquainted with the proposed approach and the arguments in its favor. <br><a name="habracut"></a><br><h4>  The module from scratch </h4><br>  In my favorite IDE, when creating a new js-file, the following code is immediately inserted into the editor window: <br><pre><code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">G, U</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-string"><span class="hljs-string">"use strict"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $ = G.jQuery, bool = <span class="hljs-string"><span class="hljs-string">"boolean"</span></span>, string = <span class="hljs-string"><span class="hljs-string">"string"</span></span>, number = <span class="hljs-string"><span class="hljs-string">"number"</span></span>, object = <span class="hljs-string"><span class="hljs-string">"object"</span></span>; }(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>));</code> </pre> <br><br>  Consider what exactly happens in these few lines. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  1. Creating a private namespace. </h5><br>  First of all, a closed namespace is created by placing the code in a self-invoking anonymous function.  In this case, two parameters <code>G</code> and <code>U</code> are passed to the anonymous function, which are assigned the values ‚Äã‚Äãof <code>this</code> and <code>undefined</code> respectively.  Question: what in this case will be equal to <code>this</code> ?  It depends on which platform you are working with, but in any case it will be a global namespace, such as in browsers, for example, the <code>window</code> object. <br><br><h5>  2. Use strict mode. </h5><br>  This line includes strict mode: <br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta"> "use strict"</span></span>;</code> </pre><br><br>  I use strict mode for many reasons.  Not only is its presence required for correct code validation using <a href="http://jslint.com/">JSLint</a> , it also blocks many unsafe constructs. <br>  It would seem a completely innocent piece: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; items.length; i += <span class="hljs-number"><span class="hljs-number">1</span></span>){ <span class="hljs-comment"><span class="hljs-comment">//-  }</span></span></code> </pre><br><br>  What could be the pitfalls here?  Everything is simple: somewhere in the code before, the variable <code>i</code> has already been declared, and this cycle is nested: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; myArr.length; i += <span class="hljs-number"><span class="hljs-number">1</span></span>){ <span class="hljs-comment"><span class="hljs-comment">// 50  ,  ,      for (i = 0; i &lt; myArr.length; i += 1){ //-  } }</span></span></code> </pre><br><br>  Such a check will force you not only to define all variables before use, but also force you to check the loop arguments once more. <br><br>  In addition, in strict mode, accessing an undeclared variable results in an execution error, while in normal mode the JavaScript interpreter will try to create this variable and assign it some value. <br><br>  For example: <br><br><pre> <code class="javascript hljs">alert(<span class="hljs-string"><span class="hljs-string">" : "</span></span>+ error);</code> </pre><br><br>  If the <code>error</code> variable has not been previously declared, in normal mode, the user will be able to admire the message <code>" : undefined"</code> .  In strict mode, this variable must be at least defined. <br><br>  What if the target browser does not support strict mode?  Nothing.  Code written for strict mode will work in a loose mode without any problems, and the JavaScript interpreter will simply ignore the <code>"use strict";</code>  . <br><br><h4>  Private module variables </h4><br>  After the instruction <code>"use strict";</code>  , including a strict mode, there is a description of several variables.  As you can see, I follow the <b>‚Äúone var statement‚Äù</b> pattern, which is also recommended for use.  Agree, the construction described above does not look as bad as the one below: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $ = G.jQuery; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bool = <span class="hljs-string"><span class="hljs-string">"boolean"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> string = <span class="hljs-string"><span class="hljs-string">"string"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> number = <span class="hljs-string"><span class="hljs-string">"number"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> object = <span class="hljs-string"><span class="hljs-string">"object"</span></span>;</code> </pre><br><br>  The variables <code>bool</code> , <code>string</code> , <code>number</code> and <code>object</code> further described below for more convenience: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (params.hasOwnProperty(<span class="hljs-string"><span class="hljs-string">"title"</span></span>) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> params.title === string){ <span class="hljs-comment"><span class="hljs-comment">//-   result.title = params.title; }</span></span></code> </pre><br><br>  In addition, when using tools such as YUICompressor or Google Closure Compiler, the names of these variables will be reduced to one or two letters: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (p.hasOwnProperty(<span class="hljs-string"><span class="hljs-string">"title"</span></span>) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> p.title === s){ r.title = p.title; }</code> </pre><br><br>  All variables declared here will be private and visible only within the module.  If we need to create a generator function for unique id elements, this will be very simple: <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">G, U</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-string"><span class="hljs-string">"use strict"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id = <span class="hljs-number"><span class="hljs-number">0</span></span>, PREFIX = <span class="hljs-string"><span class="hljs-string">"my-library-id-prefix-"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNewId</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ id += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> PREFIX + id.toString(); } G.createId = getNewId; <span class="hljs-comment"><span class="hljs-comment">//  getNewId()       createId }(this, undefined));</span></span></code> </pre><br><br>  But we can not send this function for export, but use it as a service inside the module: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Div</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">params</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//-    &lt;div&gt; var id = getId(); //id    ,      this.show = function(){ $("&lt;div /&gt;", { "id": id }); } }</span></span></code> </pre><br><br><h5>  Inclusion of the module in the library </h5><br>  Perhaps all of your modules will be designed as a single library, called, for example, JSui, and all functions should be called like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newDiv = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSui.Div({ <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-attr"><span class="hljs-attr">height</span></span>: <span class="hljs-number"><span class="hljs-number">150</span></span> });</code> </pre><br><br>  It would be possible to collect everything in one file, expanding a single object and exporting it to the global namespace, but debugging and editing several small modules is always easier than one big one.  Therefore, we will use only one global variable and, if necessary, expand it with necessary properties.  I do it like this: <br><br>  File <b>divs.js:</b> <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">G, U</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-string"><span class="hljs-string">"use strict"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> UI= G.JSui || {}; <span class="hljs-comment"><span class="hljs-comment">//  function Div(){ ... } UI.Div = Div; G.JSui = UI; }(this, undefined));</span></span></code> </pre><br><br>  File <b>labels.js:</b> <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">G, U</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-string"><span class="hljs-string">"use strict"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> UI= G.JSui || {}; <span class="hljs-comment"><span class="hljs-comment">//  function Label(){ ... } UI.Label = Label; G.JSui = UI; }(this, undefined));</span></span></code> </pre><br><br>  Some will say that the assignment is <code>G.JSui = UI;</code>  clearly too much.  But do not make hasty conclusions!  What if the specified module is connected first and the global <code>JSui</code> variable <code>JSui</code> not yet defined?  The local <code>UI</code> variable will be assigned an empty object <code>{}</code> .  Further, in the module code, we expand it, but export to the global namespace does not occur until the line is called: <br><br><pre> <code class="javascript hljs"> G.JSui = UI;</code> </pre><br><br>  If the global <code>JSui</code> object <code>JSui</code> already defined, the local <code>UI</code> variable receives a reference to it and expands it with new properties and methods.  In this case, indeed, the above assignment will be redundant, however, one should not forget the simple fact that in this case the object will be passed by reference and performance will not be affected. <br><br>  PS I did not touch on the topic of module dependency resolution, since  This is a separate topic that deserves a whole article. </div><p>Source: <a href="https://habr.com/ru/post/231883/">https://habr.com/ru/post/231883/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../231871/index.html">Alexander Zharov gave an interview for Vedomosti</a></li>
<li><a href="../231875/index.html">How to use .NET from LoadRunner</a></li>
<li><a href="../231877/index.html">AdSense money can now be withdrawn directly to a bank account.</a></li>
<li><a href="../231879/index.html">As I wrote my first technical task</a></li>
<li><a href="../231881/index.html">Study Abroad: Vietnam</a></li>
<li><a href="../231885/index.html">New technology adjusts the image on the display for people with visual impairments</a></li>
<li><a href="../231887/index.html">Pluso began to place scripts and images on third-party resources</a></li>
<li><a href="../231889/index.html">Launched the online course "Introduction to Linux" from the Linux Foundation</a></li>
<li><a href="../231891/index.html">Cisco Jabber Guest and the development of simple applications under IOS using AppArchitect</a></li>
<li><a href="../231897/index.html">Is HTML a programming language?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>